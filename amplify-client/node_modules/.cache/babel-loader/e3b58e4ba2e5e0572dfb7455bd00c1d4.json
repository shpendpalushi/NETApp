{"ast":null,"code":"/**\r\n * DevExtreme (ui/data_grid/ui.data_grid.grouping.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar _renderer = require(\"../../core/renderer\");\n\nvar _renderer2 = _interopRequireDefault(_renderer);\n\nvar _uiData_grid = require(\"./ui.data_grid.core\");\n\nvar _uiData_grid2 = _interopRequireDefault(_uiData_grid);\n\nvar _uiData_gridGrouping = require(\"./ui.data_grid.grouping.expanded\");\n\nvar _uiData_gridGrouping2 = require(\"./ui.data_grid.grouping.collapsed\");\n\nvar _message = require(\"../../localization/message\");\n\nvar _message2 = _interopRequireDefault(_message);\n\nvar _uiData_grid3 = require(\"./ui.data_grid.data_source_adapter\");\n\nvar _uiData_grid4 = _interopRequireDefault(_uiData_grid3);\n\nvar _type = require(\"../../core/utils/type\");\n\nvar _iterator = require(\"../../core/utils/iterator\");\n\nvar _devices = require(\"../../core/devices\");\n\nvar _devices2 = _interopRequireDefault(_devices);\n\nvar _deferred = require(\"../../core/utils/deferred\");\n\nvar _uiGrid_core = require(\"../grid_core/ui.grid_core.accessibility\");\n\nvar _accessibility = require(\"../shared/accessibility\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nvar DATAGRID_GROUP_PANEL_CLASS = \"dx-datagrid-group-panel\";\nvar DATAGRID_GROUP_PANEL_MESSAGE_CLASS = \"dx-group-panel-message\";\nvar DATAGRID_GROUP_PANEL_ITEM_CLASS = \"dx-group-panel-item\";\nvar DATAGRID_GROUP_PANEL_LABEL_CLASS = \"dx-toolbar-label\";\nvar DATAGRID_EXPAND_CLASS = \"dx-datagrid-expand\";\nvar DATAGRID_GROUP_ROW_CLASS = \"dx-group-row\";\nvar HEADER_FILTER_CLASS_SELECTOR = \".dx-header-filter\";\n\nvar GroupingDataSourceAdapterExtender = function () {\n  return {\n    init: function init() {\n      this.callBase.apply(this, arguments);\n\n      this._initGroupingHelper();\n    },\n    _initGroupingHelper: function _initGroupingHelper(options) {\n      var grouping = this._grouping;\n      var isAutoExpandAll = this.option(\"grouping.autoExpandAll\");\n      var isFocusedRowEnabled = this.option(\"focusedRowEnabled\");\n      var remoteOperations = options ? options.remoteOperations : this.remoteOperations();\n      var isODataRemoteOperations = remoteOperations.filtering && remoteOperations.sorting && remoteOperations.paging;\n\n      if (isODataRemoteOperations && !remoteOperations.grouping && (isAutoExpandAll || !isFocusedRowEnabled)) {\n        if (!grouping || grouping instanceof _uiData_gridGrouping2.GroupingHelper) {\n          this._grouping = new _uiData_gridGrouping.GroupingHelper(this);\n        }\n      } else {\n        if (!grouping || grouping instanceof _uiData_gridGrouping.GroupingHelper) {\n          this._grouping = new _uiData_gridGrouping2.GroupingHelper(this);\n        }\n      }\n    },\n    totalItemsCount: function totalItemsCount() {\n      var that = this;\n      var totalCount = that.callBase();\n      return totalCount > 0 && that._dataSource.group() && that._dataSource.requireTotalCount() ? totalCount + that._grouping.totalCountCorrection() : totalCount;\n    },\n    itemsCount: function itemsCount() {\n      return this._dataSource.group() ? this._grouping.itemsCount() || 0 : this.callBase.apply(this, arguments);\n    },\n    allowCollapseAll: function allowCollapseAll() {\n      return this._grouping.allowCollapseAll();\n    },\n    isGroupItemCountable: function isGroupItemCountable(item) {\n      return this._grouping.isGroupItemCountable(item);\n    },\n    isRowExpanded: function isRowExpanded(key) {\n      var groupInfo = this._grouping.findGroupInfo(key);\n\n      return groupInfo ? groupInfo.isExpanded : !this._grouping.allowCollapseAll();\n    },\n    collapseAll: function collapseAll(groupIndex) {\n      return this._collapseExpandAll(groupIndex, false);\n    },\n    expandAll: function expandAll(groupIndex) {\n      return this._collapseExpandAll(groupIndex, true);\n    },\n    _collapseExpandAll: function _collapseExpandAll(groupIndex, isExpand) {\n      var that = this;\n      var dataSource = that._dataSource;\n      var group = dataSource.group();\n\n      var groups = _uiData_grid2.default.normalizeSortingInfo(group || []);\n\n      var i;\n\n      if (groups.length) {\n        for (i = 0; i < groups.length; i++) {\n          if (void 0 === groupIndex || groupIndex === i) {\n            groups[i].isExpanded = isExpand;\n          } else {\n            if (group && group[i]) {\n              groups[i].isExpanded = group[i].isExpanded;\n            }\n          }\n        }\n\n        dataSource.group(groups);\n\n        that._grouping.foreachGroups(function (groupInfo, parents) {\n          if (void 0 === groupIndex || groupIndex === parents.length - 1) {\n            groupInfo.isExpanded = isExpand;\n          }\n        }, false, true);\n\n        that.resetPagesCache();\n      }\n\n      return true;\n    },\n    refresh: function refresh() {\n      this.callBase.apply(this, arguments);\n      return this._grouping.refresh.apply(this._grouping, arguments);\n    },\n    changeRowExpand: function changeRowExpand(path) {\n      var that = this;\n      var dataSource = that._dataSource;\n\n      if (dataSource.group()) {\n        dataSource.beginLoading();\n\n        if (that._lastLoadOptions) {\n          that._lastLoadOptions.groupExpand = true;\n        }\n\n        return that._changeRowExpandCore(path).always(function () {\n          dataSource.endLoading();\n        });\n      }\n    },\n    _changeRowExpandCore: function _changeRowExpandCore(path) {\n      return this._grouping.changeRowExpand(path);\n    },\n    _hasGroupLevelsExpandState: function _hasGroupLevelsExpandState(group, isExpanded) {\n      if (group && Array.isArray(group)) {\n        for (var i = 0; i < group.length; i++) {\n          if (group[i].isExpanded === isExpanded) {\n            return true;\n          }\n        }\n      }\n    },\n    _customizeRemoteOperations: function _customizeRemoteOperations(options, isReload, operationTypes) {\n      var remoteOperations = options.remoteOperations;\n\n      if (options.storeLoadOptions.group) {\n        if (remoteOperations.grouping && !options.isCustomLoading) {\n          if (!remoteOperations.groupPaging || this._hasGroupLevelsExpandState(options.storeLoadOptions.group, true)) {\n            remoteOperations.paging = false;\n          }\n        }\n\n        if (!remoteOperations.grouping && (!remoteOperations.sorting || !remoteOperations.filtering || options.isCustomLoading || this._hasGroupLevelsExpandState(options.storeLoadOptions.group, false))) {\n          remoteOperations.paging = false;\n        }\n      } else {\n        if (!options.isCustomLoading && remoteOperations.paging && operationTypes.grouping) {\n          this.resetCache();\n        }\n      }\n\n      this.callBase.apply(this, arguments);\n    },\n    _handleDataLoading: function _handleDataLoading(options) {\n      this.callBase(options);\n\n      this._initGroupingHelper(options);\n\n      return this._grouping.handleDataLoading(options);\n    },\n    _handleDataLoaded: function _handleDataLoaded(options) {\n      return this._grouping.handleDataLoaded(options, this.callBase.bind(this));\n    },\n    _handleDataLoadedCore: function _handleDataLoadedCore(options) {\n      return this._grouping.handleDataLoadedCore(options, this.callBase.bind(this));\n    }\n  };\n}();\n\n_uiData_grid4.default.extend(GroupingDataSourceAdapterExtender);\n\nvar GroupingDataControllerExtender = function () {\n  return {\n    init: function init() {\n      var that = this;\n      that.callBase();\n      that.createAction(\"onRowExpanding\");\n      that.createAction(\"onRowExpanded\");\n      that.createAction(\"onRowCollapsing\");\n      that.createAction(\"onRowCollapsed\");\n    },\n    _beforeProcessItems: function _beforeProcessItems(items) {\n      var groupColumns = this._columnsController.getGroupColumns();\n\n      items = this.callBase(items);\n\n      if (items.length && groupColumns.length) {\n        items = this._processGroupItems(items, groupColumns.length);\n      }\n\n      return items;\n    },\n    _processItem: function _processItem(item, options) {\n      if ((0, _type.isDefined)(item.groupIndex) && (0, _type.isString)(item.rowType) && 0 === item.rowType.indexOf(\"group\")) {\n        item = this._processGroupItem(item, options);\n        options.dataIndex = 0;\n      } else {\n        item = this.callBase.apply(this, arguments);\n      }\n\n      return item;\n    },\n    _processGroupItem: function _processGroupItem(item) {\n      return item;\n    },\n    _processGroupItems: function _processGroupItems(items, groupsCount, options) {\n      var that = this;\n\n      var groupedColumns = that._columnsController.getGroupColumns();\n\n      var column = groupedColumns[groupedColumns.length - groupsCount];\n      var scrollingMode;\n      var i;\n      var item;\n      var resultItems;\n\n      if (!options) {\n        scrollingMode = that.option(\"scrolling.mode\");\n        options = {\n          collectContinuationItems: \"virtual\" !== scrollingMode && \"infinite\" !== scrollingMode,\n          resultItems: [],\n          path: [],\n          values: []\n        };\n      }\n\n      resultItems = options.resultItems;\n\n      if (options.data) {\n        if (options.collectContinuationItems || !options.data.isContinuation) {\n          resultItems.push({\n            rowType: \"group\",\n            data: options.data,\n            groupIndex: options.path.length - 1,\n            isExpanded: !!options.data.items,\n            key: options.path.slice(0),\n            values: options.values.slice(0)\n          });\n        }\n      }\n\n      if (items) {\n        if (0 === groupsCount) {\n          resultItems.push.apply(resultItems, items);\n        } else {\n          for (i = 0; i < items.length; i++) {\n            item = items[i];\n\n            if (item && \"items\" in item) {\n              options.data = item;\n              options.path.push(item.key);\n              options.values.push(column && column.deserializeValue && !column.calculateDisplayValue ? column.deserializeValue(item.key) : item.key);\n\n              that._processGroupItems(item.items, groupsCount - 1, options);\n\n              options.data = void 0;\n              options.path.pop();\n              options.values.pop();\n            } else {\n              resultItems.push(item);\n            }\n          }\n        }\n      }\n\n      return resultItems;\n    },\n    publicMethods: function publicMethods() {\n      return this.callBase().concat([\"collapseAll\", \"expandAll\", \"isRowExpanded\", \"expandRow\", \"collapseRow\"]);\n    },\n    collapseAll: function collapseAll(groupIndex) {\n      var dataSource = this._dataSource;\n\n      if (dataSource && dataSource.collapseAll(groupIndex)) {\n        dataSource.pageIndex(0);\n        dataSource.reload();\n      }\n    },\n    expandAll: function expandAll(groupIndex) {\n      var dataSource = this._dataSource;\n\n      if (dataSource && dataSource.expandAll(groupIndex)) {\n        dataSource.pageIndex(0);\n        dataSource.reload();\n      }\n    },\n    changeRowExpand: function changeRowExpand(key) {\n      var that = this;\n      var expanded = that.isRowExpanded(key);\n      var args = {\n        key: key,\n        expanded: expanded\n      };\n      that.executeAction(expanded ? \"onRowCollapsing\" : \"onRowExpanding\", args);\n\n      if (!args.cancel) {\n        return (0, _deferred.when)(that._changeRowExpandCore(key)).done(function () {\n          args.expanded = !expanded;\n          that.executeAction(expanded ? \"onRowCollapsed\" : \"onRowExpanded\", args);\n        });\n      }\n\n      return new _deferred.Deferred().resolve();\n    },\n    _changeRowExpandCore: function _changeRowExpandCore(key) {\n      var that = this;\n      var dataSource = this._dataSource;\n      var d;\n\n      if (!dataSource) {\n        return;\n      }\n\n      d = new _deferred.Deferred();\n      (0, _deferred.when)(dataSource.changeRowExpand(key)).done(function () {\n        that.load().done(d.resolve).fail(d.reject);\n      }).fail(d.reject);\n      return d;\n    },\n    isRowExpanded: function isRowExpanded(key) {\n      var dataSource = this._dataSource;\n      return dataSource && dataSource.isRowExpanded(key);\n    },\n    expandRow: function expandRow(key) {\n      if (!this.isRowExpanded(key)) {\n        return this.changeRowExpand(key);\n      }\n\n      return new _deferred.Deferred().resolve();\n    },\n    collapseRow: function collapseRow(key) {\n      if (this.isRowExpanded(key)) {\n        return this.changeRowExpand(key);\n      }\n\n      return new _deferred.Deferred().resolve();\n    },\n    optionChanged: function optionChanged(args) {\n      if (\"grouping\" === args.name) {\n        args.name = \"dataSource\";\n      }\n\n      this.callBase(args);\n    }\n  };\n}();\n\nvar onGroupingMenuItemClick = function onGroupingMenuItemClick(column, params) {\n  var columnsController = this._columnsController;\n\n  switch (params.itemData.value) {\n    case \"group\":\n      var groups = columnsController._dataSource.group() || [];\n      columnsController.columnOption(column.dataField, \"groupIndex\", groups.length);\n      break;\n\n    case \"ungroup\":\n      columnsController.columnOption(column.dataField, \"groupIndex\", -1);\n      break;\n\n    case \"ungroupAll\":\n      this.component.clearGrouping();\n  }\n};\n\nvar GroupingHeaderPanelExtender = function () {\n  return {\n    _getToolbarItems: function _getToolbarItems() {\n      var items = this.callBase();\n      return this._appendGroupingItem(items);\n    },\n    _appendGroupingItem: function _appendGroupingItem(items) {\n      var that = this;\n      var isRendered = false;\n\n      var groupPanelRenderedCallback = function groupPanelRenderedCallback(e) {\n        var $groupPanel = (0, _renderer2.default)(e.itemElement).find(\".\" + DATAGRID_GROUP_PANEL_CLASS);\n\n        that._updateGroupPanelContent($groupPanel);\n\n        (0, _uiGrid_core.registerKeyboardAction)(\"groupPanel\", that, $groupPanel, void 0, that._handleActionKeyDown.bind(that));\n        isRendered && that.renderCompleted.fire();\n        isRendered = true;\n      };\n\n      if (that._isGroupPanelVisible()) {\n        var toolbarItem = {\n          html: \"<div class='\" + DATAGRID_GROUP_PANEL_CLASS + \"'></div>\",\n          name: \"groupPanel\",\n          onItemRendered: groupPanelRenderedCallback,\n          location: \"before\",\n          locateInMenu: \"never\",\n          sortIndex: 1\n        };\n        items.push(toolbarItem);\n      }\n\n      return items;\n    },\n    _handleActionKeyDown: function _handleActionKeyDown(args) {\n      var event = args.event;\n      var $target = (0, _renderer2.default)(event.target);\n      var groupColumnIndex = $target.closest(\".\".concat(DATAGRID_GROUP_PANEL_ITEM_CLASS)).index();\n\n      var column = this._columnsController.getGroupColumns()[groupColumnIndex];\n\n      var columnIndex = column && column.index;\n\n      if ($target.is(HEADER_FILTER_CLASS_SELECTOR)) {\n        this.getController(\"headerFilter\").showHeaderFilterMenu(columnIndex, true);\n      } else {\n        this._processGroupItemAction(columnIndex);\n      }\n\n      event.preventDefault();\n    },\n    _isGroupPanelVisible: function _isGroupPanelVisible() {\n      var groupPanelOptions = this.option(\"groupPanel\");\n      var isVisible;\n\n      if (groupPanelOptions) {\n        isVisible = groupPanelOptions.visible;\n\n        if (\"auto\" === isVisible) {\n          isVisible = \"desktop\" === _devices2.default.current().deviceType ? true : false;\n        }\n      }\n\n      return isVisible;\n    },\n    _renderGroupPanelItems: function _renderGroupPanelItems($groupPanel, groupColumns) {\n      var that = this;\n      $groupPanel.empty();\n      (0, _iterator.each)(groupColumns, function (index, groupColumn) {\n        that._createGroupPanelItem($groupPanel, groupColumn);\n      });\n      (0, _accessibility.restoreFocus)(this);\n    },\n    _createGroupPanelItem: function _createGroupPanelItem($rootElement, groupColumn) {\n      var $groupPanelItem = (0, _renderer2.default)(\"<div>\").addClass(groupColumn.cssClass).addClass(DATAGRID_GROUP_PANEL_ITEM_CLASS).data(\"columnData\", groupColumn).appendTo($rootElement).text(groupColumn.caption);\n      (0, _accessibility.setTabIndex)(this, $groupPanelItem);\n      return $groupPanelItem;\n    },\n    _columnOptionChanged: function _columnOptionChanged(e) {\n      if (!this._requireReady && !_uiData_grid2.default.checkChanges(e.optionNames, [\"width\", \"visibleWidth\"])) {\n        var $toolbarElement = this.element();\n        var $groupPanel = $toolbarElement && $toolbarElement.find(\".\" + DATAGRID_GROUP_PANEL_CLASS);\n\n        if ($groupPanel && $groupPanel.length) {\n          this._updateGroupPanelContent($groupPanel);\n\n          this.renderCompleted.fire();\n        }\n      }\n\n      this.callBase();\n    },\n    _updateGroupPanelContent: function _updateGroupPanelContent($groupPanel) {\n      var that = this;\n      var groupColumns = that.getController(\"columns\").getGroupColumns();\n      var groupPanelOptions = that.option(\"groupPanel\");\n\n      that._renderGroupPanelItems($groupPanel, groupColumns);\n\n      if (groupPanelOptions.allowColumnDragging && !groupColumns.length) {\n        (0, _renderer2.default)(\"<div>\").addClass(DATAGRID_GROUP_PANEL_MESSAGE_CLASS).text(groupPanelOptions.emptyPanelText).appendTo($groupPanel);\n        $groupPanel.closest(\".\" + DATAGRID_GROUP_PANEL_LABEL_CLASS).css(\"maxWidth\", \"none\");\n        that.updateToolbarDimensions();\n      }\n    },\n    allowDragging: function allowDragging(column) {\n      var groupPanelOptions = this.option(\"groupPanel\");\n      return this._isGroupPanelVisible() && groupPanelOptions.allowColumnDragging && column && column.allowGrouping;\n    },\n    getColumnElements: function getColumnElements() {\n      var $element = this.element();\n      return $element && $element.find(\".\" + DATAGRID_GROUP_PANEL_ITEM_CLASS);\n    },\n    getColumns: function getColumns() {\n      return this.getController(\"columns\").getGroupColumns();\n    },\n    getBoundingRect: function getBoundingRect() {\n      var that = this;\n      var $element = that.element();\n      var offset;\n\n      if ($element && $element.find(\".\" + DATAGRID_GROUP_PANEL_CLASS).length) {\n        offset = $element.offset();\n        return {\n          top: offset.top,\n          bottom: offset.top + $element.height()\n        };\n      }\n\n      return null;\n    },\n    getName: function getName() {\n      return \"group\";\n    },\n    getContextMenuItems: function getContextMenuItems(options) {\n      var that = this;\n      var contextMenuEnabled = that.option(\"grouping.contextMenuEnabled\");\n      var $groupedColumnElement = (0, _renderer2.default)(options.targetElement).closest(\".\" + DATAGRID_GROUP_PANEL_ITEM_CLASS);\n      var items;\n\n      if ($groupedColumnElement.length) {\n        options.column = $groupedColumnElement.data(\"columnData\");\n      }\n\n      if (contextMenuEnabled && options.column) {\n        var column = options.column;\n        var isGroupingAllowed = (0, _type.isDefined)(column.allowGrouping) ? column.allowGrouping : true;\n\n        if (isGroupingAllowed) {\n          var isColumnGrouped = (0, _type.isDefined)(column.groupIndex) && column.groupIndex > -1;\n          var groupingTexts = that.option(\"grouping.texts\");\n          var onItemClick = onGroupingMenuItemClick.bind(that, column);\n          items = [{\n            text: groupingTexts.ungroup,\n            value: \"ungroup\",\n            disabled: !isColumnGrouped,\n            onItemClick: onItemClick\n          }, {\n            text: groupingTexts.ungroupAll,\n            value: \"ungroupAll\",\n            onItemClick: onItemClick\n          }];\n        }\n      }\n\n      return items;\n    },\n    isVisible: function isVisible() {\n      return this.callBase() || this._isGroupPanelVisible();\n    },\n    optionChanged: function optionChanged(args) {\n      if (\"groupPanel\" === args.name) {\n        this._invalidate();\n\n        args.handled = true;\n      } else {\n        this.callBase(args);\n      }\n    }\n  };\n}();\n\nexports.GroupingHeaderPanelExtender = GroupingHeaderPanelExtender;\n\nvar GroupingRowsViewExtender = function () {\n  return {\n    getContextMenuItems: function getContextMenuItems(options) {\n      var that = this;\n      var contextMenuEnabled = that.option(\"grouping.contextMenuEnabled\");\n      var items;\n\n      if (contextMenuEnabled && options.row && \"group\" === options.row.rowType) {\n        var columnsController = that._columnsController;\n        var column = columnsController.columnOption(\"groupIndex:\" + options.row.groupIndex);\n\n        if (column && column.allowGrouping) {\n          var groupingTexts = that.option(\"grouping.texts\");\n          var onItemClick = onGroupingMenuItemClick.bind(that, column);\n          items = [];\n          items.push({\n            text: groupingTexts.ungroup,\n            value: \"ungroup\",\n            onItemClick: onItemClick\n          }, {\n            text: groupingTexts.ungroupAll,\n            value: \"ungroupAll\",\n            onItemClick: onItemClick\n          });\n        }\n      }\n\n      return items;\n    },\n    _rowClick: function _rowClick(e) {\n      var that = this;\n      var expandMode = that.option(\"grouping.expandMode\");\n      var scrollingMode = that.option(\"scrolling.mode\");\n      var isGroupRowStateChanged = \"infinite\" !== scrollingMode && \"rowClick\" === expandMode && (0, _renderer2.default)(e.event.target).closest(\".\" + DATAGRID_GROUP_ROW_CLASS).length;\n      var isExpandButtonClicked = (0, _renderer2.default)(e.event.target).closest(\".\" + DATAGRID_EXPAND_CLASS).length;\n\n      if (isGroupRowStateChanged || isExpandButtonClicked) {\n        that._changeGroupRowState(e);\n      }\n\n      that.callBase(e);\n    },\n    _changeGroupRowState: function _changeGroupRowState(e) {\n      var dataController = this.getController(\"data\");\n      var row = dataController.items()[e.rowIndex];\n\n      var allowCollapsing = this._columnsController.columnOption(\"groupIndex:\" + row.groupIndex, \"allowCollapsing\");\n\n      if (\"data\" === row.rowType || \"group\" === row.rowType && false !== allowCollapsing) {\n        dataController.changeRowExpand(row.key);\n        e.event.preventDefault();\n        e.handled = true;\n      }\n    }\n  };\n}();\n\nvar columnHeadersViewExtender = function () {\n  return {\n    getContextMenuItems: function getContextMenuItems(options) {\n      var that = this;\n      var contextMenuEnabled = that.option(\"grouping.contextMenuEnabled\");\n      var items = that.callBase(options);\n\n      if (contextMenuEnabled && options.row && (\"header\" === options.row.rowType || \"detailAdaptive\" === options.row.rowType)) {\n        var column = options.column;\n\n        if (!column.command && (!(0, _type.isDefined)(column.allowGrouping) || column.allowGrouping)) {\n          var groupingTexts = that.option(\"grouping.texts\");\n          var isColumnGrouped = (0, _type.isDefined)(column.groupIndex) && column.groupIndex > -1;\n          var onItemClick = onGroupingMenuItemClick.bind(that, column);\n          items = items || [];\n          items.push({\n            text: groupingTexts.groupByThisColumn,\n            value: \"group\",\n            beginGroup: true,\n            disabled: isColumnGrouped,\n            onItemClick: onItemClick\n          });\n\n          if (column.showWhenGrouped) {\n            items.push({\n              text: groupingTexts.ungroup,\n              value: \"ungroup\",\n              disabled: !isColumnGrouped,\n              onItemClick: onItemClick\n            });\n          }\n\n          items.push({\n            text: groupingTexts.ungroupAll,\n            value: \"ungroupAll\",\n            onItemClick: onItemClick\n          });\n        }\n      }\n\n      return items;\n    }\n  };\n}();\n\n_uiData_grid2.default.registerModule(\"grouping\", {\n  defaultOptions: function defaultOptions() {\n    return {\n      grouping: {\n        autoExpandAll: true,\n        allowCollapsing: true,\n        contextMenuEnabled: false,\n        expandMode: \"buttonClick\",\n        texts: {\n          groupContinuesMessage: _message2.default.format(\"dxDataGrid-groupContinuesMessage\"),\n          groupContinuedMessage: _message2.default.format(\"dxDataGrid-groupContinuedMessage\"),\n          groupByThisColumn: _message2.default.format(\"dxDataGrid-groupHeaderText\"),\n          ungroup: _message2.default.format(\"dxDataGrid-ungroupHeaderText\"),\n          ungroupAll: _message2.default.format(\"dxDataGrid-ungroupAllText\")\n        }\n      },\n      groupPanel: {\n        visible: false,\n        emptyPanelText: _message2.default.format(\"dxDataGrid-groupPanelEmptyText\"),\n        allowColumnDragging: true\n      }\n    };\n  },\n  extenders: {\n    controllers: {\n      data: GroupingDataControllerExtender,\n      columns: {\n        _getExpandColumnOptions: function _getExpandColumnOptions() {\n          var options = this.callBase.apply(this, arguments);\n          options.cellTemplate = _uiData_grid2.default.getExpandCellTemplate();\n          return options;\n        }\n      }\n    },\n    views: {\n      headerPanel: GroupingHeaderPanelExtender,\n      rowsView: GroupingRowsViewExtender,\n      columnHeadersView: columnHeadersViewExtender\n    }\n  }\n});","map":{"version":3,"sources":["C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/devextreme/ui/data_grid/ui.data_grid.grouping.js"],"names":["_renderer","require","_renderer2","_interopRequireDefault","_uiData_grid","_uiData_grid2","_uiData_gridGrouping","_uiData_gridGrouping2","_message","_message2","_uiData_grid3","_uiData_grid4","_type","_iterator","_devices","_devices2","_deferred","_uiGrid_core","_accessibility","obj","DATAGRID_GROUP_PANEL_CLASS","DATAGRID_GROUP_PANEL_MESSAGE_CLASS","DATAGRID_GROUP_PANEL_ITEM_CLASS","DATAGRID_GROUP_PANEL_LABEL_CLASS","DATAGRID_EXPAND_CLASS","DATAGRID_GROUP_ROW_CLASS","HEADER_FILTER_CLASS_SELECTOR","GroupingDataSourceAdapterExtender","init","_initGroupingHelper","grouping","isAutoExpandAll","isFocusedRowEnabled","remoteOperations","options","isODataRemoteOperations","totalItemsCount","that","totalCount","itemsCount","allowCollapseAll","isGroupItemCountable","isRowExpanded","groupInfo","collapseAll","expandAll","_collapseExpandAll","dataSource","group","groups","i","groupIndex","parents","refresh","changeRowExpand","_changeRowExpandCore","_hasGroupLevelsExpandState","Array","_customizeRemoteOperations","operationTypes","_handleDataLoading","_handleDataLoaded","_handleDataLoadedCore","GroupingDataControllerExtender","_beforeProcessItems","groupColumns","items","_processItem","item","_processGroupItem","_processGroupItems","groupedColumns","column","scrollingMode","collectContinuationItems","resultItems","path","values","rowType","data","isExpanded","key","groupsCount","publicMethods","expanded","args","d","expandRow","collapseRow","optionChanged","onGroupingMenuItemClick","columnsController","params","GroupingHeaderPanelExtender","_getToolbarItems","_appendGroupingItem","isRendered","groupPanelRenderedCallback","$groupPanel","e","toolbarItem","html","name","onItemRendered","location","locateInMenu","sortIndex","_handleActionKeyDown","event","$target","groupColumnIndex","columnIndex","_isGroupPanelVisible","groupPanelOptions","isVisible","_renderGroupPanelItems","_createGroupPanelItem","$groupPanelItem","groupColumn","_columnOptionChanged","$toolbarElement","_updateGroupPanelContent","allowDragging","getColumnElements","$element","getColumns","getBoundingRect","offset","top","bottom","getName","getContextMenuItems","contextMenuEnabled","$groupedColumnElement","isGroupingAllowed","isColumnGrouped","groupingTexts","onItemClick","text","value","disabled","exports","GroupingRowsViewExtender","_rowClick","expandMode","isGroupRowStateChanged","isExpandButtonClicked","_changeGroupRowState","dataController","row","allowCollapsing","columnHeadersViewExtender","beginGroup","defaultOptions","autoExpandAll","texts","groupContinuesMessage","groupContinuedMessage","groupByThisColumn","ungroup","ungroupAll","groupPanel","visible","emptyPanelText","allowColumnDragging","extenders","controllers","columns","_getExpandColumnOptions","views","headerPanel","rowsView","columnHeadersView"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/data_grid/ui.data_grid.grouping.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar _renderer = require(\"../../core/renderer\");\r\nvar _renderer2 = _interopRequireDefault(_renderer);\r\nvar _uiData_grid = require(\"./ui.data_grid.core\");\r\nvar _uiData_grid2 = _interopRequireDefault(_uiData_grid);\r\nvar _uiData_gridGrouping = require(\"./ui.data_grid.grouping.expanded\");\r\nvar _uiData_gridGrouping2 = require(\"./ui.data_grid.grouping.collapsed\");\r\nvar _message = require(\"../../localization/message\");\r\nvar _message2 = _interopRequireDefault(_message);\r\nvar _uiData_grid3 = require(\"./ui.data_grid.data_source_adapter\");\r\nvar _uiData_grid4 = _interopRequireDefault(_uiData_grid3);\r\nvar _type = require(\"../../core/utils/type\");\r\nvar _iterator = require(\"../../core/utils/iterator\");\r\nvar _devices = require(\"../../core/devices\");\r\nvar _devices2 = _interopRequireDefault(_devices);\r\nvar _deferred = require(\"../../core/utils/deferred\");\r\nvar _uiGrid_core = require(\"../grid_core/ui.grid_core.accessibility\");\r\nvar _accessibility = require(\"../shared/accessibility\");\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\nvar DATAGRID_GROUP_PANEL_CLASS = \"dx-datagrid-group-panel\";\r\nvar DATAGRID_GROUP_PANEL_MESSAGE_CLASS = \"dx-group-panel-message\";\r\nvar DATAGRID_GROUP_PANEL_ITEM_CLASS = \"dx-group-panel-item\";\r\nvar DATAGRID_GROUP_PANEL_LABEL_CLASS = \"dx-toolbar-label\";\r\nvar DATAGRID_EXPAND_CLASS = \"dx-datagrid-expand\";\r\nvar DATAGRID_GROUP_ROW_CLASS = \"dx-group-row\";\r\nvar HEADER_FILTER_CLASS_SELECTOR = \".dx-header-filter\";\r\nvar GroupingDataSourceAdapterExtender = function() {\r\n    return {\r\n        init: function() {\r\n            this.callBase.apply(this, arguments);\r\n            this._initGroupingHelper()\r\n        },\r\n        _initGroupingHelper: function(options) {\r\n            var grouping = this._grouping;\r\n            var isAutoExpandAll = this.option(\"grouping.autoExpandAll\");\r\n            var isFocusedRowEnabled = this.option(\"focusedRowEnabled\");\r\n            var remoteOperations = options ? options.remoteOperations : this.remoteOperations();\r\n            var isODataRemoteOperations = remoteOperations.filtering && remoteOperations.sorting && remoteOperations.paging;\r\n            if (isODataRemoteOperations && !remoteOperations.grouping && (isAutoExpandAll || !isFocusedRowEnabled)) {\r\n                if (!grouping || grouping instanceof _uiData_gridGrouping2.GroupingHelper) {\r\n                    this._grouping = new _uiData_gridGrouping.GroupingHelper(this)\r\n                }\r\n            } else {\r\n                if (!grouping || grouping instanceof _uiData_gridGrouping.GroupingHelper) {\r\n                    this._grouping = new _uiData_gridGrouping2.GroupingHelper(this)\r\n                }\r\n            }\r\n        },\r\n        totalItemsCount: function() {\r\n            var that = this;\r\n            var totalCount = that.callBase();\r\n            return totalCount > 0 && that._dataSource.group() && that._dataSource.requireTotalCount() ? totalCount + that._grouping.totalCountCorrection() : totalCount\r\n        },\r\n        itemsCount: function() {\r\n            return this._dataSource.group() ? this._grouping.itemsCount() || 0 : this.callBase.apply(this, arguments)\r\n        },\r\n        allowCollapseAll: function() {\r\n            return this._grouping.allowCollapseAll()\r\n        },\r\n        isGroupItemCountable: function(item) {\r\n            return this._grouping.isGroupItemCountable(item)\r\n        },\r\n        isRowExpanded: function(key) {\r\n            var groupInfo = this._grouping.findGroupInfo(key);\r\n            return groupInfo ? groupInfo.isExpanded : !this._grouping.allowCollapseAll()\r\n        },\r\n        collapseAll: function(groupIndex) {\r\n            return this._collapseExpandAll(groupIndex, false)\r\n        },\r\n        expandAll: function(groupIndex) {\r\n            return this._collapseExpandAll(groupIndex, true)\r\n        },\r\n        _collapseExpandAll: function(groupIndex, isExpand) {\r\n            var that = this;\r\n            var dataSource = that._dataSource;\r\n            var group = dataSource.group();\r\n            var groups = _uiData_grid2.default.normalizeSortingInfo(group || []);\r\n            var i;\r\n            if (groups.length) {\r\n                for (i = 0; i < groups.length; i++) {\r\n                    if (void 0 === groupIndex || groupIndex === i) {\r\n                        groups[i].isExpanded = isExpand\r\n                    } else {\r\n                        if (group && group[i]) {\r\n                            groups[i].isExpanded = group[i].isExpanded\r\n                        }\r\n                    }\r\n                }\r\n                dataSource.group(groups);\r\n                that._grouping.foreachGroups(function(groupInfo, parents) {\r\n                    if (void 0 === groupIndex || groupIndex === parents.length - 1) {\r\n                        groupInfo.isExpanded = isExpand\r\n                    }\r\n                }, false, true);\r\n                that.resetPagesCache()\r\n            }\r\n            return true\r\n        },\r\n        refresh: function() {\r\n            this.callBase.apply(this, arguments);\r\n            return this._grouping.refresh.apply(this._grouping, arguments)\r\n        },\r\n        changeRowExpand: function(path) {\r\n            var that = this;\r\n            var dataSource = that._dataSource;\r\n            if (dataSource.group()) {\r\n                dataSource.beginLoading();\r\n                if (that._lastLoadOptions) {\r\n                    that._lastLoadOptions.groupExpand = true\r\n                }\r\n                return that._changeRowExpandCore(path).always(function() {\r\n                    dataSource.endLoading()\r\n                })\r\n            }\r\n        },\r\n        _changeRowExpandCore: function(path) {\r\n            return this._grouping.changeRowExpand(path)\r\n        },\r\n        _hasGroupLevelsExpandState: function(group, isExpanded) {\r\n            if (group && Array.isArray(group)) {\r\n                for (var i = 0; i < group.length; i++) {\r\n                    if (group[i].isExpanded === isExpanded) {\r\n                        return true\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        _customizeRemoteOperations: function(options, isReload, operationTypes) {\r\n            var remoteOperations = options.remoteOperations;\r\n            if (options.storeLoadOptions.group) {\r\n                if (remoteOperations.grouping && !options.isCustomLoading) {\r\n                    if (!remoteOperations.groupPaging || this._hasGroupLevelsExpandState(options.storeLoadOptions.group, true)) {\r\n                        remoteOperations.paging = false\r\n                    }\r\n                }\r\n                if (!remoteOperations.grouping && (!remoteOperations.sorting || !remoteOperations.filtering || options.isCustomLoading || this._hasGroupLevelsExpandState(options.storeLoadOptions.group, false))) {\r\n                    remoteOperations.paging = false\r\n                }\r\n            } else {\r\n                if (!options.isCustomLoading && remoteOperations.paging && operationTypes.grouping) {\r\n                    this.resetCache()\r\n                }\r\n            }\r\n            this.callBase.apply(this, arguments)\r\n        },\r\n        _handleDataLoading: function(options) {\r\n            this.callBase(options);\r\n            this._initGroupingHelper(options);\r\n            return this._grouping.handleDataLoading(options)\r\n        },\r\n        _handleDataLoaded: function(options) {\r\n            return this._grouping.handleDataLoaded(options, this.callBase.bind(this))\r\n        },\r\n        _handleDataLoadedCore: function(options) {\r\n            return this._grouping.handleDataLoadedCore(options, this.callBase.bind(this))\r\n        }\r\n    }\r\n}();\r\n_uiData_grid4.default.extend(GroupingDataSourceAdapterExtender);\r\nvar GroupingDataControllerExtender = function() {\r\n    return {\r\n        init: function() {\r\n            var that = this;\r\n            that.callBase();\r\n            that.createAction(\"onRowExpanding\");\r\n            that.createAction(\"onRowExpanded\");\r\n            that.createAction(\"onRowCollapsing\");\r\n            that.createAction(\"onRowCollapsed\")\r\n        },\r\n        _beforeProcessItems: function(items) {\r\n            var groupColumns = this._columnsController.getGroupColumns();\r\n            items = this.callBase(items);\r\n            if (items.length && groupColumns.length) {\r\n                items = this._processGroupItems(items, groupColumns.length)\r\n            }\r\n            return items\r\n        },\r\n        _processItem: function(item, options) {\r\n            if ((0, _type.isDefined)(item.groupIndex) && (0, _type.isString)(item.rowType) && 0 === item.rowType.indexOf(\"group\")) {\r\n                item = this._processGroupItem(item, options);\r\n                options.dataIndex = 0\r\n            } else {\r\n                item = this.callBase.apply(this, arguments)\r\n            }\r\n            return item\r\n        },\r\n        _processGroupItem: function(item) {\r\n            return item\r\n        },\r\n        _processGroupItems: function(items, groupsCount, options) {\r\n            var that = this;\r\n            var groupedColumns = that._columnsController.getGroupColumns();\r\n            var column = groupedColumns[groupedColumns.length - groupsCount];\r\n            var scrollingMode;\r\n            var i;\r\n            var item;\r\n            var resultItems;\r\n            if (!options) {\r\n                scrollingMode = that.option(\"scrolling.mode\");\r\n                options = {\r\n                    collectContinuationItems: \"virtual\" !== scrollingMode && \"infinite\" !== scrollingMode,\r\n                    resultItems: [],\r\n                    path: [],\r\n                    values: []\r\n                }\r\n            }\r\n            resultItems = options.resultItems;\r\n            if (options.data) {\r\n                if (options.collectContinuationItems || !options.data.isContinuation) {\r\n                    resultItems.push({\r\n                        rowType: \"group\",\r\n                        data: options.data,\r\n                        groupIndex: options.path.length - 1,\r\n                        isExpanded: !!options.data.items,\r\n                        key: options.path.slice(0),\r\n                        values: options.values.slice(0)\r\n                    })\r\n                }\r\n            }\r\n            if (items) {\r\n                if (0 === groupsCount) {\r\n                    resultItems.push.apply(resultItems, items)\r\n                } else {\r\n                    for (i = 0; i < items.length; i++) {\r\n                        item = items[i];\r\n                        if (item && \"items\" in item) {\r\n                            options.data = item;\r\n                            options.path.push(item.key);\r\n                            options.values.push(column && column.deserializeValue && !column.calculateDisplayValue ? column.deserializeValue(item.key) : item.key);\r\n                            that._processGroupItems(item.items, groupsCount - 1, options);\r\n                            options.data = void 0;\r\n                            options.path.pop();\r\n                            options.values.pop()\r\n                        } else {\r\n                            resultItems.push(item)\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            return resultItems\r\n        },\r\n        publicMethods: function() {\r\n            return this.callBase().concat([\"collapseAll\", \"expandAll\", \"isRowExpanded\", \"expandRow\", \"collapseRow\"])\r\n        },\r\n        collapseAll: function(groupIndex) {\r\n            var dataSource = this._dataSource;\r\n            if (dataSource && dataSource.collapseAll(groupIndex)) {\r\n                dataSource.pageIndex(0);\r\n                dataSource.reload()\r\n            }\r\n        },\r\n        expandAll: function(groupIndex) {\r\n            var dataSource = this._dataSource;\r\n            if (dataSource && dataSource.expandAll(groupIndex)) {\r\n                dataSource.pageIndex(0);\r\n                dataSource.reload()\r\n            }\r\n        },\r\n        changeRowExpand: function(key) {\r\n            var that = this;\r\n            var expanded = that.isRowExpanded(key);\r\n            var args = {\r\n                key: key,\r\n                expanded: expanded\r\n            };\r\n            that.executeAction(expanded ? \"onRowCollapsing\" : \"onRowExpanding\", args);\r\n            if (!args.cancel) {\r\n                return (0, _deferred.when)(that._changeRowExpandCore(key)).done(function() {\r\n                    args.expanded = !expanded;\r\n                    that.executeAction(expanded ? \"onRowCollapsed\" : \"onRowExpanded\", args)\r\n                })\r\n            }\r\n            return (new _deferred.Deferred).resolve()\r\n        },\r\n        _changeRowExpandCore: function(key) {\r\n            var that = this;\r\n            var dataSource = this._dataSource;\r\n            var d;\r\n            if (!dataSource) {\r\n                return\r\n            }\r\n            d = new _deferred.Deferred;\r\n            (0, _deferred.when)(dataSource.changeRowExpand(key)).done(function() {\r\n                that.load().done(d.resolve).fail(d.reject)\r\n            }).fail(d.reject);\r\n            return d\r\n        },\r\n        isRowExpanded: function(key) {\r\n            var dataSource = this._dataSource;\r\n            return dataSource && dataSource.isRowExpanded(key)\r\n        },\r\n        expandRow: function(key) {\r\n            if (!this.isRowExpanded(key)) {\r\n                return this.changeRowExpand(key)\r\n            }\r\n            return (new _deferred.Deferred).resolve()\r\n        },\r\n        collapseRow: function(key) {\r\n            if (this.isRowExpanded(key)) {\r\n                return this.changeRowExpand(key)\r\n            }\r\n            return (new _deferred.Deferred).resolve()\r\n        },\r\n        optionChanged: function(args) {\r\n            if (\"grouping\" === args.name) {\r\n                args.name = \"dataSource\"\r\n            }\r\n            this.callBase(args)\r\n        }\r\n    }\r\n}();\r\nvar onGroupingMenuItemClick = function(column, params) {\r\n    var columnsController = this._columnsController;\r\n    switch (params.itemData.value) {\r\n        case \"group\":\r\n            var groups = columnsController._dataSource.group() || [];\r\n            columnsController.columnOption(column.dataField, \"groupIndex\", groups.length);\r\n            break;\r\n        case \"ungroup\":\r\n            columnsController.columnOption(column.dataField, \"groupIndex\", -1);\r\n            break;\r\n        case \"ungroupAll\":\r\n            this.component.clearGrouping()\r\n    }\r\n};\r\nvar GroupingHeaderPanelExtender = function() {\r\n    return {\r\n        _getToolbarItems: function() {\r\n            var items = this.callBase();\r\n            return this._appendGroupingItem(items)\r\n        },\r\n        _appendGroupingItem: function(items) {\r\n            var that = this;\r\n            var isRendered = false;\r\n            var groupPanelRenderedCallback = function(e) {\r\n                var $groupPanel = (0, _renderer2.default)(e.itemElement).find(\".\" + DATAGRID_GROUP_PANEL_CLASS);\r\n                that._updateGroupPanelContent($groupPanel);\r\n                (0, _uiGrid_core.registerKeyboardAction)(\"groupPanel\", that, $groupPanel, void 0, that._handleActionKeyDown.bind(that));\r\n                isRendered && that.renderCompleted.fire();\r\n                isRendered = true\r\n            };\r\n            if (that._isGroupPanelVisible()) {\r\n                var toolbarItem = {\r\n                    html: \"<div class='\" + DATAGRID_GROUP_PANEL_CLASS + \"'></div>\",\r\n                    name: \"groupPanel\",\r\n                    onItemRendered: groupPanelRenderedCallback,\r\n                    location: \"before\",\r\n                    locateInMenu: \"never\",\r\n                    sortIndex: 1\r\n                };\r\n                items.push(toolbarItem)\r\n            }\r\n            return items\r\n        },\r\n        _handleActionKeyDown: function(args) {\r\n            var event = args.event;\r\n            var $target = (0, _renderer2.default)(event.target);\r\n            var groupColumnIndex = $target.closest(\".\".concat(DATAGRID_GROUP_PANEL_ITEM_CLASS)).index();\r\n            var column = this._columnsController.getGroupColumns()[groupColumnIndex];\r\n            var columnIndex = column && column.index;\r\n            if ($target.is(HEADER_FILTER_CLASS_SELECTOR)) {\r\n                this.getController(\"headerFilter\").showHeaderFilterMenu(columnIndex, true)\r\n            } else {\r\n                this._processGroupItemAction(columnIndex)\r\n            }\r\n            event.preventDefault()\r\n        },\r\n        _isGroupPanelVisible: function() {\r\n            var groupPanelOptions = this.option(\"groupPanel\");\r\n            var isVisible;\r\n            if (groupPanelOptions) {\r\n                isVisible = groupPanelOptions.visible;\r\n                if (\"auto\" === isVisible) {\r\n                    isVisible = \"desktop\" === _devices2.default.current().deviceType ? true : false\r\n                }\r\n            }\r\n            return isVisible\r\n        },\r\n        _renderGroupPanelItems: function($groupPanel, groupColumns) {\r\n            var that = this;\r\n            $groupPanel.empty();\r\n            (0, _iterator.each)(groupColumns, function(index, groupColumn) {\r\n                that._createGroupPanelItem($groupPanel, groupColumn)\r\n            });\r\n            (0, _accessibility.restoreFocus)(this)\r\n        },\r\n        _createGroupPanelItem: function($rootElement, groupColumn) {\r\n            var $groupPanelItem = (0, _renderer2.default)(\"<div>\").addClass(groupColumn.cssClass).addClass(DATAGRID_GROUP_PANEL_ITEM_CLASS).data(\"columnData\", groupColumn).appendTo($rootElement).text(groupColumn.caption);\r\n            (0, _accessibility.setTabIndex)(this, $groupPanelItem);\r\n            return $groupPanelItem\r\n        },\r\n        _columnOptionChanged: function(e) {\r\n            if (!this._requireReady && !_uiData_grid2.default.checkChanges(e.optionNames, [\"width\", \"visibleWidth\"])) {\r\n                var $toolbarElement = this.element();\r\n                var $groupPanel = $toolbarElement && $toolbarElement.find(\".\" + DATAGRID_GROUP_PANEL_CLASS);\r\n                if ($groupPanel && $groupPanel.length) {\r\n                    this._updateGroupPanelContent($groupPanel);\r\n                    this.renderCompleted.fire()\r\n                }\r\n            }\r\n            this.callBase()\r\n        },\r\n        _updateGroupPanelContent: function($groupPanel) {\r\n            var that = this;\r\n            var groupColumns = that.getController(\"columns\").getGroupColumns();\r\n            var groupPanelOptions = that.option(\"groupPanel\");\r\n            that._renderGroupPanelItems($groupPanel, groupColumns);\r\n            if (groupPanelOptions.allowColumnDragging && !groupColumns.length) {\r\n                (0, _renderer2.default)(\"<div>\").addClass(DATAGRID_GROUP_PANEL_MESSAGE_CLASS).text(groupPanelOptions.emptyPanelText).appendTo($groupPanel);\r\n                $groupPanel.closest(\".\" + DATAGRID_GROUP_PANEL_LABEL_CLASS).css(\"maxWidth\", \"none\");\r\n                that.updateToolbarDimensions()\r\n            }\r\n        },\r\n        allowDragging: function(column) {\r\n            var groupPanelOptions = this.option(\"groupPanel\");\r\n            return this._isGroupPanelVisible() && groupPanelOptions.allowColumnDragging && column && column.allowGrouping\r\n        },\r\n        getColumnElements: function() {\r\n            var $element = this.element();\r\n            return $element && $element.find(\".\" + DATAGRID_GROUP_PANEL_ITEM_CLASS)\r\n        },\r\n        getColumns: function() {\r\n            return this.getController(\"columns\").getGroupColumns()\r\n        },\r\n        getBoundingRect: function() {\r\n            var that = this;\r\n            var $element = that.element();\r\n            var offset;\r\n            if ($element && $element.find(\".\" + DATAGRID_GROUP_PANEL_CLASS).length) {\r\n                offset = $element.offset();\r\n                return {\r\n                    top: offset.top,\r\n                    bottom: offset.top + $element.height()\r\n                }\r\n            }\r\n            return null\r\n        },\r\n        getName: function() {\r\n            return \"group\"\r\n        },\r\n        getContextMenuItems: function(options) {\r\n            var that = this;\r\n            var contextMenuEnabled = that.option(\"grouping.contextMenuEnabled\");\r\n            var $groupedColumnElement = (0, _renderer2.default)(options.targetElement).closest(\".\" + DATAGRID_GROUP_PANEL_ITEM_CLASS);\r\n            var items;\r\n            if ($groupedColumnElement.length) {\r\n                options.column = $groupedColumnElement.data(\"columnData\")\r\n            }\r\n            if (contextMenuEnabled && options.column) {\r\n                var column = options.column;\r\n                var isGroupingAllowed = (0, _type.isDefined)(column.allowGrouping) ? column.allowGrouping : true;\r\n                if (isGroupingAllowed) {\r\n                    var isColumnGrouped = (0, _type.isDefined)(column.groupIndex) && column.groupIndex > -1;\r\n                    var groupingTexts = that.option(\"grouping.texts\");\r\n                    var onItemClick = onGroupingMenuItemClick.bind(that, column);\r\n                    items = [{\r\n                        text: groupingTexts.ungroup,\r\n                        value: \"ungroup\",\r\n                        disabled: !isColumnGrouped,\r\n                        onItemClick: onItemClick\r\n                    }, {\r\n                        text: groupingTexts.ungroupAll,\r\n                        value: \"ungroupAll\",\r\n                        onItemClick: onItemClick\r\n                    }]\r\n                }\r\n            }\r\n            return items\r\n        },\r\n        isVisible: function() {\r\n            return this.callBase() || this._isGroupPanelVisible()\r\n        },\r\n        optionChanged: function(args) {\r\n            if (\"groupPanel\" === args.name) {\r\n                this._invalidate();\r\n                args.handled = true\r\n            } else {\r\n                this.callBase(args)\r\n            }\r\n        }\r\n    }\r\n}();\r\nexports.GroupingHeaderPanelExtender = GroupingHeaderPanelExtender;\r\nvar GroupingRowsViewExtender = function() {\r\n    return {\r\n        getContextMenuItems: function(options) {\r\n            var that = this;\r\n            var contextMenuEnabled = that.option(\"grouping.contextMenuEnabled\");\r\n            var items;\r\n            if (contextMenuEnabled && options.row && \"group\" === options.row.rowType) {\r\n                var columnsController = that._columnsController;\r\n                var column = columnsController.columnOption(\"groupIndex:\" + options.row.groupIndex);\r\n                if (column && column.allowGrouping) {\r\n                    var groupingTexts = that.option(\"grouping.texts\");\r\n                    var onItemClick = onGroupingMenuItemClick.bind(that, column);\r\n                    items = [];\r\n                    items.push({\r\n                        text: groupingTexts.ungroup,\r\n                        value: \"ungroup\",\r\n                        onItemClick: onItemClick\r\n                    }, {\r\n                        text: groupingTexts.ungroupAll,\r\n                        value: \"ungroupAll\",\r\n                        onItemClick: onItemClick\r\n                    })\r\n                }\r\n            }\r\n            return items\r\n        },\r\n        _rowClick: function(e) {\r\n            var that = this;\r\n            var expandMode = that.option(\"grouping.expandMode\");\r\n            var scrollingMode = that.option(\"scrolling.mode\");\r\n            var isGroupRowStateChanged = \"infinite\" !== scrollingMode && \"rowClick\" === expandMode && (0, _renderer2.default)(e.event.target).closest(\".\" + DATAGRID_GROUP_ROW_CLASS).length;\r\n            var isExpandButtonClicked = (0, _renderer2.default)(e.event.target).closest(\".\" + DATAGRID_EXPAND_CLASS).length;\r\n            if (isGroupRowStateChanged || isExpandButtonClicked) {\r\n                that._changeGroupRowState(e)\r\n            }\r\n            that.callBase(e)\r\n        },\r\n        _changeGroupRowState: function(e) {\r\n            var dataController = this.getController(\"data\");\r\n            var row = dataController.items()[e.rowIndex];\r\n            var allowCollapsing = this._columnsController.columnOption(\"groupIndex:\" + row.groupIndex, \"allowCollapsing\");\r\n            if (\"data\" === row.rowType || \"group\" === row.rowType && false !== allowCollapsing) {\r\n                dataController.changeRowExpand(row.key);\r\n                e.event.preventDefault();\r\n                e.handled = true\r\n            }\r\n        }\r\n    }\r\n}();\r\nvar columnHeadersViewExtender = function() {\r\n    return {\r\n        getContextMenuItems: function(options) {\r\n            var that = this;\r\n            var contextMenuEnabled = that.option(\"grouping.contextMenuEnabled\");\r\n            var items = that.callBase(options);\r\n            if (contextMenuEnabled && options.row && (\"header\" === options.row.rowType || \"detailAdaptive\" === options.row.rowType)) {\r\n                var column = options.column;\r\n                if (!column.command && (!(0, _type.isDefined)(column.allowGrouping) || column.allowGrouping)) {\r\n                    var groupingTexts = that.option(\"grouping.texts\");\r\n                    var isColumnGrouped = (0, _type.isDefined)(column.groupIndex) && column.groupIndex > -1;\r\n                    var onItemClick = onGroupingMenuItemClick.bind(that, column);\r\n                    items = items || [];\r\n                    items.push({\r\n                        text: groupingTexts.groupByThisColumn,\r\n                        value: \"group\",\r\n                        beginGroup: true,\r\n                        disabled: isColumnGrouped,\r\n                        onItemClick: onItemClick\r\n                    });\r\n                    if (column.showWhenGrouped) {\r\n                        items.push({\r\n                            text: groupingTexts.ungroup,\r\n                            value: \"ungroup\",\r\n                            disabled: !isColumnGrouped,\r\n                            onItemClick: onItemClick\r\n                        })\r\n                    }\r\n                    items.push({\r\n                        text: groupingTexts.ungroupAll,\r\n                        value: \"ungroupAll\",\r\n                        onItemClick: onItemClick\r\n                    })\r\n                }\r\n            }\r\n            return items\r\n        }\r\n    }\r\n}();\r\n_uiData_grid2.default.registerModule(\"grouping\", {\r\n    defaultOptions: function() {\r\n        return {\r\n            grouping: {\r\n                autoExpandAll: true,\r\n                allowCollapsing: true,\r\n                contextMenuEnabled: false,\r\n                expandMode: \"buttonClick\",\r\n                texts: {\r\n                    groupContinuesMessage: _message2.default.format(\"dxDataGrid-groupContinuesMessage\"),\r\n                    groupContinuedMessage: _message2.default.format(\"dxDataGrid-groupContinuedMessage\"),\r\n                    groupByThisColumn: _message2.default.format(\"dxDataGrid-groupHeaderText\"),\r\n                    ungroup: _message2.default.format(\"dxDataGrid-ungroupHeaderText\"),\r\n                    ungroupAll: _message2.default.format(\"dxDataGrid-ungroupAllText\")\r\n                }\r\n            },\r\n            groupPanel: {\r\n                visible: false,\r\n                emptyPanelText: _message2.default.format(\"dxDataGrid-groupPanelEmptyText\"),\r\n                allowColumnDragging: true\r\n            }\r\n        }\r\n    },\r\n    extenders: {\r\n        controllers: {\r\n            data: GroupingDataControllerExtender,\r\n            columns: {\r\n                _getExpandColumnOptions: function() {\r\n                    var options = this.callBase.apply(this, arguments);\r\n                    options.cellTemplate = _uiData_grid2.default.getExpandCellTemplate();\r\n                    return options\r\n                }\r\n            }\r\n        },\r\n        views: {\r\n            headerPanel: GroupingHeaderPanelExtender,\r\n            rowsView: GroupingRowsViewExtender,\r\n            columnHeadersView: columnHeadersViewExtender\r\n        }\r\n    }\r\n});\r\n"]},"metadata":{},"sourceType":"module"}