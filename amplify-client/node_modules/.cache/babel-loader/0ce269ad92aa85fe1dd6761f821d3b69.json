{"ast":null,"code":"import _inherits from \"C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/@babel/runtime/helpers/esm/createSuper\";\nimport _classCallCheck from \"C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport { async } from '../scheduler/async';\nimport { isDate } from '../util/isDate';\nimport { Subscriber } from '../Subscriber';\nimport { Notification } from '../Notification';\nexport function delay(delay) {\n  var scheduler = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : async;\n  var absoluteDelay = isDate(delay);\n  var delayFor = absoluteDelay ? +delay - scheduler.now() : Math.abs(delay);\n  return function (source) {\n    return source.lift(new DelayOperator(delayFor, scheduler));\n  };\n}\n\nvar DelayOperator = /*#__PURE__*/function () {\n  function DelayOperator(delay, scheduler) {\n    _classCallCheck(this, DelayOperator);\n\n    this.delay = delay;\n    this.scheduler = scheduler;\n  }\n\n  _createClass(DelayOperator, [{\n    key: \"call\",\n    value: function call(subscriber, source) {\n      return source.subscribe(new DelaySubscriber(subscriber, this.delay, this.scheduler));\n    }\n  }]);\n\n  return DelayOperator;\n}();\n\nvar DelaySubscriber = /*#__PURE__*/function (_Subscriber) {\n  _inherits(DelaySubscriber, _Subscriber);\n\n  var _super = _createSuper(DelaySubscriber);\n\n  function DelaySubscriber(destination, delay, scheduler) {\n    var _this;\n\n    _classCallCheck(this, DelaySubscriber);\n\n    _this = _super.call(this, destination);\n    _this.delay = delay;\n    _this.scheduler = scheduler;\n    _this.queue = [];\n    _this.active = false;\n    _this.errored = false;\n    return _this;\n  }\n\n  _createClass(DelaySubscriber, [{\n    key: \"_schedule\",\n    value: function _schedule(scheduler) {\n      this.active = true;\n      var destination = this.destination;\n      destination.add(scheduler.schedule(DelaySubscriber.dispatch, this.delay, {\n        source: this,\n        destination: this.destination,\n        scheduler: scheduler\n      }));\n    }\n  }, {\n    key: \"scheduleNotification\",\n    value: function scheduleNotification(notification) {\n      if (this.errored === true) {\n        return;\n      }\n\n      var scheduler = this.scheduler;\n      var message = new DelayMessage(scheduler.now() + this.delay, notification);\n      this.queue.push(message);\n\n      if (this.active === false) {\n        this._schedule(scheduler);\n      }\n    }\n  }, {\n    key: \"_next\",\n    value: function _next(value) {\n      this.scheduleNotification(Notification.createNext(value));\n    }\n  }, {\n    key: \"_error\",\n    value: function _error(err) {\n      this.errored = true;\n      this.queue = [];\n      this.destination.error(err);\n      this.unsubscribe();\n    }\n  }, {\n    key: \"_complete\",\n    value: function _complete() {\n      this.scheduleNotification(Notification.createComplete());\n      this.unsubscribe();\n    }\n  }], [{\n    key: \"dispatch\",\n    value: function dispatch(state) {\n      var source = state.source;\n      var queue = source.queue;\n      var scheduler = state.scheduler;\n      var destination = state.destination;\n\n      while (queue.length > 0 && queue[0].time - scheduler.now() <= 0) {\n        queue.shift().notification.observe(destination);\n      }\n\n      if (queue.length > 0) {\n        var _delay = Math.max(0, queue[0].time - scheduler.now());\n\n        this.schedule(state, _delay);\n      } else {\n        this.unsubscribe();\n        source.active = false;\n      }\n    }\n  }]);\n\n  return DelaySubscriber;\n}(Subscriber);\n\nvar DelayMessage = function DelayMessage(time, notification) {\n  _classCallCheck(this, DelayMessage);\n\n  this.time = time;\n  this.notification = notification;\n};","map":{"version":3,"sources":["../../../src/internal/operators/delay.ts"],"names":[],"mappings":"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","sourcesContent":["import { async } from '../scheduler/async';\r\nimport { isDate } from '../util/isDate';\r\nimport { Subscriber } from '../Subscriber';\r\nimport { Notification } from '../Notification';\r\nexport function delay(delay, scheduler = async) {\r\n    const absoluteDelay = isDate(delay);\r\n    const delayFor = absoluteDelay ? (+delay - scheduler.now()) : Math.abs(delay);\r\n    return (source) => source.lift(new DelayOperator(delayFor, scheduler));\r\n}\r\nclass DelayOperator {\r\n    constructor(delay, scheduler) {\r\n        this.delay = delay;\r\n        this.scheduler = scheduler;\r\n    }\r\n    call(subscriber, source) {\r\n        return source.subscribe(new DelaySubscriber(subscriber, this.delay, this.scheduler));\r\n    }\r\n}\r\nclass DelaySubscriber extends Subscriber {\r\n    constructor(destination, delay, scheduler) {\r\n        super(destination);\r\n        this.delay = delay;\r\n        this.scheduler = scheduler;\r\n        this.queue = [];\r\n        this.active = false;\r\n        this.errored = false;\r\n    }\r\n    static dispatch(state) {\r\n        const source = state.source;\r\n        const queue = source.queue;\r\n        const scheduler = state.scheduler;\r\n        const destination = state.destination;\r\n        while (queue.length > 0 && (queue[0].time - scheduler.now()) <= 0) {\r\n            queue.shift().notification.observe(destination);\r\n        }\r\n        if (queue.length > 0) {\r\n            const delay = Math.max(0, queue[0].time - scheduler.now());\r\n            this.schedule(state, delay);\r\n        }\r\n        else {\r\n            this.unsubscribe();\r\n            source.active = false;\r\n        }\r\n    }\r\n    _schedule(scheduler) {\r\n        this.active = true;\r\n        const destination = this.destination;\r\n        destination.add(scheduler.schedule(DelaySubscriber.dispatch, this.delay, {\r\n            source: this, destination: this.destination, scheduler: scheduler\r\n        }));\r\n    }\r\n    scheduleNotification(notification) {\r\n        if (this.errored === true) {\r\n            return;\r\n        }\r\n        const scheduler = this.scheduler;\r\n        const message = new DelayMessage(scheduler.now() + this.delay, notification);\r\n        this.queue.push(message);\r\n        if (this.active === false) {\r\n            this._schedule(scheduler);\r\n        }\r\n    }\r\n    _next(value) {\r\n        this.scheduleNotification(Notification.createNext(value));\r\n    }\r\n    _error(err) {\r\n        this.errored = true;\r\n        this.queue = [];\r\n        this.destination.error(err);\r\n        this.unsubscribe();\r\n    }\r\n    _complete() {\r\n        this.scheduleNotification(Notification.createComplete());\r\n        this.unsubscribe();\r\n    }\r\n}\r\nclass DelayMessage {\r\n    constructor(time, notification) {\r\n        this.time = time;\r\n        this.notification = notification;\r\n    }\r\n}\r\n//# sourceMappingURL=delay.js.map"]},"metadata":{},"sourceType":"module"}