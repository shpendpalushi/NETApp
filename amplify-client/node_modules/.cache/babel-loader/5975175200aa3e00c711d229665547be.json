{"ast":null,"code":"/**\r\n * DevExtreme (ui/scheduler/workspaces/ui.scheduler.work_space.indicator.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar _renderer = require(\"../../../core/renderer\");\n\nvar _renderer2 = _interopRequireDefault(_renderer);\n\nvar _uiScheduler = require(\"./ui.scheduler.work_space\");\n\nvar _uiScheduler2 = _interopRequireDefault(_uiScheduler);\n\nvar _component_registrator = require(\"../../../core/component_registrator\");\n\nvar _component_registrator2 = _interopRequireDefault(_component_registrator);\n\nvar _date = require(\"../../../core/utils/date\");\n\nvar _date2 = _interopRequireDefault(_date);\n\nvar _extend = require(\"../../../core/utils/extend\");\n\nvar _window = require(\"../../../core/utils/window\");\n\nvar _window2 = _interopRequireDefault(_window);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nvar toMs = _date2.default.dateToMilliseconds;\nvar SCHEDULER_DATE_TIME_INDICATOR_CLASS = \"dx-scheduler-date-time-indicator\";\nvar TIME_PANEL_CURRENT_TIME_CELL_CLASS = \"dx-scheduler-time-panel-current-time-cell\";\nvar HEADER_CURRENT_TIME_CELL_CLASS = \"dx-scheduler-header-panel-current-time-cell\";\n\nvar SchedulerWorkSpaceIndicator = _uiScheduler2.default.inherit({\n  _getToday: function _getToday() {\n    var date = this.option(\"indicatorTime\") || new Date();\n    return this.invoke(\"convertDateByTimezone\", date) || date;\n  },\n  _needRenderDateTimeIndicator: function _needRenderDateTimeIndicator() {\n    var today = this._getToday();\n\n    var endViewDate = _date2.default.trimTime(this.getEndViewDate());\n\n    return _date2.default.dateInRange(today, this._firstViewDate, new Date(endViewDate.getTime() + toMs(\"day\")));\n  },\n  needRenderDateTimeIndication: function needRenderDateTimeIndication() {\n    if (!_window2.default.hasWindow()) {\n      return false;\n    }\n\n    var today = this._getToday();\n\n    return today >= _date2.default.trimTime(new Date(this.getStartViewDate()));\n  },\n  _renderDateTimeIndication: function _renderDateTimeIndication() {\n    if (this.needRenderDateTimeIndication()) {\n      if (this.option(\"shadeUntilCurrentTime\")) {\n        this._shader.render(this);\n      }\n\n      if (this.option(\"showCurrentTimeIndicator\") && this._needRenderDateTimeIndicator()) {\n        var groupCount = this._getGroupCount() || 1;\n\n        var $container = this._dateTableScrollable.$content();\n\n        var height = this.getIndicationHeight();\n\n        var rtlOffset = this._getRtlOffset(this.getCellWidth());\n\n        if (height > 0) {\n          this._renderIndicator(height, rtlOffset, $container, groupCount);\n        }\n      }\n    }\n  },\n  _renderIndicator: function _renderIndicator(height, rtlOffset, $container, groupCount) {\n    for (var i = 0; i < groupCount; i++) {\n      var $indicator = this._createIndicator($container);\n\n      $indicator.width(this.getCellWidth());\n\n      this._groupedStrategy.shiftIndicator($indicator, height, rtlOffset, i);\n    }\n  },\n  _createIndicator: function _createIndicator($container) {\n    var $indicator = (0, _renderer2.default)(\"<div>\").addClass(SCHEDULER_DATE_TIME_INDICATOR_CLASS);\n    $container.append($indicator);\n    return $indicator;\n  },\n  _getRtlOffset: function _getRtlOffset(width) {\n    return this.option(\"rtlEnabled\") ? this._dateTableScrollable.$content().get(0).getBoundingClientRect().width - this.getTimePanelWidth() - width : 0;\n  },\n  _setIndicationUpdateInterval: function _setIndicationUpdateInterval() {\n    if (!this.option(\"showCurrentTimeIndicator\") || 0 === this.option(\"indicatorUpdateInterval\")) {\n      return;\n    }\n\n    this._clearIndicatorUpdateInterval();\n\n    this._indicatorInterval = setInterval(function () {\n      this._refreshDateTimeIndication();\n    }.bind(this), this.option(\"indicatorUpdateInterval\"));\n  },\n  _clearIndicatorUpdateInterval: function _clearIndicatorUpdateInterval() {\n    if (this._indicatorInterval) {\n      clearInterval(this._indicatorInterval);\n      delete this._indicatorInterval;\n    }\n  },\n  _isVerticalShader: function _isVerticalShader() {\n    return true;\n  },\n  getIndicationWidth: function getIndicationWidth(groupIndex) {\n    var maxWidth = this.getCellWidth() * this._getCellCount();\n\n    var difference = this._getIndicatorDuration();\n\n    if (difference > this._getCellCount()) {\n      difference = this._getCellCount();\n    }\n\n    var width = difference * this.getRoundedCellWidth(groupIndex, groupIndex * this._getCellCount(), difference);\n    return maxWidth < width ? maxWidth : width;\n  },\n  getIndicatorOffset: function getIndicatorOffset(groupIndex) {\n    var difference = this._getIndicatorDuration() - 1;\n    var offset = difference * this.getRoundedCellWidth(groupIndex, groupIndex * this._getCellCount(), difference);\n    return offset;\n  },\n  _getIndicatorDuration: function _getIndicatorDuration() {\n    var today = this._getToday();\n\n    var firstViewDate = new Date(this._firstViewDate);\n    var timeDiff = today.getTime() - firstViewDate.getTime();\n\n    if (\"workWeek\" === this.option(\"type\")) {\n      timeDiff -= this._getWeekendsCount(Math.round(timeDiff / toMs(\"day\"))) * toMs(\"day\");\n    }\n\n    return Math.ceil((timeDiff + 1) / toMs(\"day\"));\n  },\n  getIndicationHeight: function getIndicationHeight() {\n    var today = this._getToday();\n\n    var cellHeight = this.getCellHeight();\n    var date = new Date(this._firstViewDate);\n\n    if (this._needRenderDateTimeIndicator()) {\n      date.setFullYear(today.getFullYear(), today.getMonth(), today.getDate());\n    }\n\n    var duration = today.getTime() - date.getTime();\n    var cellCount = duration / this.getCellDuration();\n    return cellCount * cellHeight;\n  },\n  _dispose: function _dispose() {\n    this._clearIndicatorUpdateInterval();\n\n    this.callBase.apply(this, arguments);\n  },\n  _refreshDateTimeIndication: function _refreshDateTimeIndication() {\n    this._cleanDateTimeIndicator();\n\n    this._shader && this._shader.clean();\n\n    this._renderDateTimeIndication();\n  },\n  _isCurrentTime: function _isCurrentTime(date) {\n    if (this.option(\"showCurrentTimeIndicator\") && this._needRenderDateTimeIndicator()) {\n      var today = this._getToday();\n\n      var result = false;\n      date = new Date(date);\n      date.setFullYear(today.getFullYear(), today.getMonth(), today.getDate());\n      var startCellDate = new Date(date);\n      var endCellDate = new Date(date);\n\n      if (_date2.default.sameDate(today, date)) {\n        startCellDate = startCellDate.setMilliseconds(date.getMilliseconds() - this.getCellDuration() + 1);\n        endCellDate = endCellDate.setMilliseconds(date.getMilliseconds() + this.getCellDuration());\n        result = _date2.default.dateInRange(today, startCellDate, endCellDate);\n      }\n\n      return result;\n    }\n  },\n  _isCurrentTimeHeaderCell: function _isCurrentTimeHeaderCell(headerIndex) {\n    var result = false;\n\n    if (this.option(\"showCurrentTimeIndicator\") && this._needRenderDateTimeIndicator()) {\n      var date = this._getDateByIndex(headerIndex);\n\n      var now = this.option(\"indicatorTime\") || new Date();\n      result = _date2.default.sameDate(date, now);\n    }\n\n    return result;\n  },\n  _getTimeCellClass: function _getTimeCellClass(i) {\n    var startViewDate = this._getTimeCellDate(i);\n\n    var cellClass = this.callBase(i);\n\n    if (this._isCurrentTime(startViewDate)) {\n      return cellClass + \" \" + TIME_PANEL_CURRENT_TIME_CELL_CLASS;\n    }\n\n    return cellClass;\n  },\n  _getHeaderPanelCellClass: function _getHeaderPanelCellClass(i) {\n    var cellClass = this.callBase(i);\n\n    if (this._isCurrentTimeHeaderCell(i)) {\n      return cellClass + \" \" + HEADER_CURRENT_TIME_CELL_CLASS;\n    }\n\n    return cellClass;\n  },\n  _cleanView: function _cleanView() {\n    this.callBase();\n\n    this._cleanDateTimeIndicator();\n  },\n  _dimensionChanged: function _dimensionChanged() {\n    this.callBase();\n\n    this._refreshDateTimeIndication();\n  },\n  _cleanDateTimeIndicator: function _cleanDateTimeIndicator() {\n    this.$element().find(\".\" + SCHEDULER_DATE_TIME_INDICATOR_CLASS).remove();\n  },\n  _cleanWorkSpace: function _cleanWorkSpace() {\n    this.callBase();\n\n    this._renderDateTimeIndication();\n\n    this._setIndicationUpdateInterval();\n  },\n  _optionChanged: function _optionChanged(args) {\n    switch (args.name) {\n      case \"showCurrentTimeIndicator\":\n      case \"indicatorTime\":\n        this._cleanWorkSpace();\n\n        break;\n\n      case \"indicatorUpdateInterval\":\n        this._setIndicationUpdateInterval();\n\n        break;\n\n      case \"showAllDayPanel\":\n        this.callBase(args);\n\n        this._refreshDateTimeIndication();\n\n        break;\n\n      case \"allDayExpanded\":\n        this.callBase(args);\n\n        this._refreshDateTimeIndication();\n\n        break;\n\n      case \"crossScrollingEnabled\":\n        this.callBase(args);\n\n        this._refreshDateTimeIndication();\n\n        break;\n\n      case \"shadeUntilCurrentTime\":\n        this._refreshDateTimeIndication();\n\n        break;\n\n      default:\n        this.callBase(args);\n    }\n  },\n  _getDefaultOptions: function _getDefaultOptions() {\n    return (0, _extend.extend)(this.callBase(), {\n      showCurrentTimeIndicator: true,\n      indicatorTime: new Date(),\n      indicatorUpdateInterval: 5 * toMs(\"minute\"),\n      shadeUntilCurrentTime: true\n    });\n  }\n});\n\n(0, _component_registrator2.default)(\"dxSchedulerWorkSpace\", SchedulerWorkSpaceIndicator);\nmodule.exports = SchedulerWorkSpaceIndicator;","map":{"version":3,"sources":["C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/devextreme/ui/scheduler/workspaces/ui.scheduler.work_space.indicator.js"],"names":["_renderer","require","_renderer2","_interopRequireDefault","_uiScheduler","_uiScheduler2","_component_registrator","_component_registrator2","_date","_date2","_extend","_window","_window2","obj","toMs","SCHEDULER_DATE_TIME_INDICATOR_CLASS","TIME_PANEL_CURRENT_TIME_CELL_CLASS","HEADER_CURRENT_TIME_CELL_CLASS","SchedulerWorkSpaceIndicator","_getToday","date","_needRenderDateTimeIndicator","today","endViewDate","needRenderDateTimeIndication","_renderDateTimeIndication","groupCount","$container","height","rtlOffset","_renderIndicator","i","$indicator","_createIndicator","_getRtlOffset","_setIndicationUpdateInterval","setInterval","_clearIndicatorUpdateInterval","clearInterval","_isVerticalShader","getIndicationWidth","maxWidth","difference","width","groupIndex","getIndicatorOffset","offset","_getIndicatorDuration","firstViewDate","timeDiff","Math","getIndicationHeight","cellHeight","duration","cellCount","_dispose","_refreshDateTimeIndication","_isCurrentTime","result","startCellDate","endCellDate","_isCurrentTimeHeaderCell","now","_getTimeCellClass","startViewDate","cellClass","_getHeaderPanelCellClass","_cleanView","_dimensionChanged","_cleanDateTimeIndicator","_cleanWorkSpace","_optionChanged","args","_getDefaultOptions","showCurrentTimeIndicator","indicatorTime","indicatorUpdateInterval","shadeUntilCurrentTime","module"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/scheduler/workspaces/ui.scheduler.work_space.indicator.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar _renderer = require(\"../../../core/renderer\");\r\nvar _renderer2 = _interopRequireDefault(_renderer);\r\nvar _uiScheduler = require(\"./ui.scheduler.work_space\");\r\nvar _uiScheduler2 = _interopRequireDefault(_uiScheduler);\r\nvar _component_registrator = require(\"../../../core/component_registrator\");\r\nvar _component_registrator2 = _interopRequireDefault(_component_registrator);\r\nvar _date = require(\"../../../core/utils/date\");\r\nvar _date2 = _interopRequireDefault(_date);\r\nvar _extend = require(\"../../../core/utils/extend\");\r\nvar _window = require(\"../../../core/utils/window\");\r\nvar _window2 = _interopRequireDefault(_window);\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\nvar toMs = _date2.default.dateToMilliseconds;\r\nvar SCHEDULER_DATE_TIME_INDICATOR_CLASS = \"dx-scheduler-date-time-indicator\";\r\nvar TIME_PANEL_CURRENT_TIME_CELL_CLASS = \"dx-scheduler-time-panel-current-time-cell\";\r\nvar HEADER_CURRENT_TIME_CELL_CLASS = \"dx-scheduler-header-panel-current-time-cell\";\r\nvar SchedulerWorkSpaceIndicator = _uiScheduler2.default.inherit({\r\n    _getToday: function() {\r\n        var date = this.option(\"indicatorTime\") || new Date;\r\n        return this.invoke(\"convertDateByTimezone\", date) || date\r\n    },\r\n    _needRenderDateTimeIndicator: function() {\r\n        var today = this._getToday();\r\n        var endViewDate = _date2.default.trimTime(this.getEndViewDate());\r\n        return _date2.default.dateInRange(today, this._firstViewDate, new Date(endViewDate.getTime() + toMs(\"day\")))\r\n    },\r\n    needRenderDateTimeIndication: function() {\r\n        if (!_window2.default.hasWindow()) {\r\n            return false\r\n        }\r\n        var today = this._getToday();\r\n        return today >= _date2.default.trimTime(new Date(this.getStartViewDate()))\r\n    },\r\n    _renderDateTimeIndication: function() {\r\n        if (this.needRenderDateTimeIndication()) {\r\n            if (this.option(\"shadeUntilCurrentTime\")) {\r\n                this._shader.render(this)\r\n            }\r\n            if (this.option(\"showCurrentTimeIndicator\") && this._needRenderDateTimeIndicator()) {\r\n                var groupCount = this._getGroupCount() || 1;\r\n                var $container = this._dateTableScrollable.$content();\r\n                var height = this.getIndicationHeight();\r\n                var rtlOffset = this._getRtlOffset(this.getCellWidth());\r\n                if (height > 0) {\r\n                    this._renderIndicator(height, rtlOffset, $container, groupCount)\r\n                }\r\n            }\r\n        }\r\n    },\r\n    _renderIndicator: function(height, rtlOffset, $container, groupCount) {\r\n        for (var i = 0; i < groupCount; i++) {\r\n            var $indicator = this._createIndicator($container);\r\n            $indicator.width(this.getCellWidth());\r\n            this._groupedStrategy.shiftIndicator($indicator, height, rtlOffset, i)\r\n        }\r\n    },\r\n    _createIndicator: function($container) {\r\n        var $indicator = (0, _renderer2.default)(\"<div>\").addClass(SCHEDULER_DATE_TIME_INDICATOR_CLASS);\r\n        $container.append($indicator);\r\n        return $indicator\r\n    },\r\n    _getRtlOffset: function(width) {\r\n        return this.option(\"rtlEnabled\") ? this._dateTableScrollable.$content().get(0).getBoundingClientRect().width - this.getTimePanelWidth() - width : 0\r\n    },\r\n    _setIndicationUpdateInterval: function() {\r\n        if (!this.option(\"showCurrentTimeIndicator\") || 0 === this.option(\"indicatorUpdateInterval\")) {\r\n            return\r\n        }\r\n        this._clearIndicatorUpdateInterval();\r\n        this._indicatorInterval = setInterval(function() {\r\n            this._refreshDateTimeIndication()\r\n        }.bind(this), this.option(\"indicatorUpdateInterval\"))\r\n    },\r\n    _clearIndicatorUpdateInterval: function() {\r\n        if (this._indicatorInterval) {\r\n            clearInterval(this._indicatorInterval);\r\n            delete this._indicatorInterval\r\n        }\r\n    },\r\n    _isVerticalShader: function() {\r\n        return true\r\n    },\r\n    getIndicationWidth: function(groupIndex) {\r\n        var maxWidth = this.getCellWidth() * this._getCellCount();\r\n        var difference = this._getIndicatorDuration();\r\n        if (difference > this._getCellCount()) {\r\n            difference = this._getCellCount()\r\n        }\r\n        var width = difference * this.getRoundedCellWidth(groupIndex, groupIndex * this._getCellCount(), difference);\r\n        return maxWidth < width ? maxWidth : width\r\n    },\r\n    getIndicatorOffset: function(groupIndex) {\r\n        var difference = this._getIndicatorDuration() - 1;\r\n        var offset = difference * this.getRoundedCellWidth(groupIndex, groupIndex * this._getCellCount(), difference);\r\n        return offset\r\n    },\r\n    _getIndicatorDuration: function() {\r\n        var today = this._getToday();\r\n        var firstViewDate = new Date(this._firstViewDate);\r\n        var timeDiff = today.getTime() - firstViewDate.getTime();\r\n        if (\"workWeek\" === this.option(\"type\")) {\r\n            timeDiff -= this._getWeekendsCount(Math.round(timeDiff / toMs(\"day\"))) * toMs(\"day\")\r\n        }\r\n        return Math.ceil((timeDiff + 1) / toMs(\"day\"))\r\n    },\r\n    getIndicationHeight: function() {\r\n        var today = this._getToday();\r\n        var cellHeight = this.getCellHeight();\r\n        var date = new Date(this._firstViewDate);\r\n        if (this._needRenderDateTimeIndicator()) {\r\n            date.setFullYear(today.getFullYear(), today.getMonth(), today.getDate())\r\n        }\r\n        var duration = today.getTime() - date.getTime();\r\n        var cellCount = duration / this.getCellDuration();\r\n        return cellCount * cellHeight\r\n    },\r\n    _dispose: function() {\r\n        this._clearIndicatorUpdateInterval();\r\n        this.callBase.apply(this, arguments)\r\n    },\r\n    _refreshDateTimeIndication: function() {\r\n        this._cleanDateTimeIndicator();\r\n        this._shader && this._shader.clean();\r\n        this._renderDateTimeIndication()\r\n    },\r\n    _isCurrentTime: function(date) {\r\n        if (this.option(\"showCurrentTimeIndicator\") && this._needRenderDateTimeIndicator()) {\r\n            var today = this._getToday();\r\n            var result = false;\r\n            date = new Date(date);\r\n            date.setFullYear(today.getFullYear(), today.getMonth(), today.getDate());\r\n            var startCellDate = new Date(date);\r\n            var endCellDate = new Date(date);\r\n            if (_date2.default.sameDate(today, date)) {\r\n                startCellDate = startCellDate.setMilliseconds(date.getMilliseconds() - this.getCellDuration() + 1);\r\n                endCellDate = endCellDate.setMilliseconds(date.getMilliseconds() + this.getCellDuration());\r\n                result = _date2.default.dateInRange(today, startCellDate, endCellDate)\r\n            }\r\n            return result\r\n        }\r\n    },\r\n    _isCurrentTimeHeaderCell: function(headerIndex) {\r\n        var result = false;\r\n        if (this.option(\"showCurrentTimeIndicator\") && this._needRenderDateTimeIndicator()) {\r\n            var date = this._getDateByIndex(headerIndex);\r\n            var now = this.option(\"indicatorTime\") || new Date;\r\n            result = _date2.default.sameDate(date, now)\r\n        }\r\n        return result\r\n    },\r\n    _getTimeCellClass: function(i) {\r\n        var startViewDate = this._getTimeCellDate(i);\r\n        var cellClass = this.callBase(i);\r\n        if (this._isCurrentTime(startViewDate)) {\r\n            return cellClass + \" \" + TIME_PANEL_CURRENT_TIME_CELL_CLASS\r\n        }\r\n        return cellClass\r\n    },\r\n    _getHeaderPanelCellClass: function(i) {\r\n        var cellClass = this.callBase(i);\r\n        if (this._isCurrentTimeHeaderCell(i)) {\r\n            return cellClass + \" \" + HEADER_CURRENT_TIME_CELL_CLASS\r\n        }\r\n        return cellClass\r\n    },\r\n    _cleanView: function() {\r\n        this.callBase();\r\n        this._cleanDateTimeIndicator()\r\n    },\r\n    _dimensionChanged: function() {\r\n        this.callBase();\r\n        this._refreshDateTimeIndication()\r\n    },\r\n    _cleanDateTimeIndicator: function() {\r\n        this.$element().find(\".\" + SCHEDULER_DATE_TIME_INDICATOR_CLASS).remove()\r\n    },\r\n    _cleanWorkSpace: function() {\r\n        this.callBase();\r\n        this._renderDateTimeIndication();\r\n        this._setIndicationUpdateInterval()\r\n    },\r\n    _optionChanged: function(args) {\r\n        switch (args.name) {\r\n            case \"showCurrentTimeIndicator\":\r\n            case \"indicatorTime\":\r\n                this._cleanWorkSpace();\r\n                break;\r\n            case \"indicatorUpdateInterval\":\r\n                this._setIndicationUpdateInterval();\r\n                break;\r\n            case \"showAllDayPanel\":\r\n                this.callBase(args);\r\n                this._refreshDateTimeIndication();\r\n                break;\r\n            case \"allDayExpanded\":\r\n                this.callBase(args);\r\n                this._refreshDateTimeIndication();\r\n                break;\r\n            case \"crossScrollingEnabled\":\r\n                this.callBase(args);\r\n                this._refreshDateTimeIndication();\r\n                break;\r\n            case \"shadeUntilCurrentTime\":\r\n                this._refreshDateTimeIndication();\r\n                break;\r\n            default:\r\n                this.callBase(args)\r\n        }\r\n    },\r\n    _getDefaultOptions: function() {\r\n        return (0, _extend.extend)(this.callBase(), {\r\n            showCurrentTimeIndicator: true,\r\n            indicatorTime: new Date,\r\n            indicatorUpdateInterval: 5 * toMs(\"minute\"),\r\n            shadeUntilCurrentTime: true\r\n        })\r\n    }\r\n});\r\n(0, _component_registrator2.default)(\"dxSchedulerWorkSpace\", SchedulerWorkSpaceIndicator);\r\nmodule.exports = SchedulerWorkSpaceIndicator;\r\n"]},"metadata":{},"sourceType":"module"}