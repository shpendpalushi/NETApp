{"ast":null,"code":"/**\r\n * DevExtreme (ui/date_box/ui.date_box.mask.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar _utils = require(\"../../events/utils\");\n\nvar _type = require(\"../../core/utils/type\");\n\nvar _dom = require(\"../../core/utils/dom\");\n\nvar _extend = require(\"../../core/utils/extend\");\n\nvar _math = require(\"../../core/utils/math\");\n\nvar _events_engine = require(\"../../events/core/events_engine\");\n\nvar _events_engine2 = _interopRequireDefault(_events_engine);\n\nvar _uiDate_boxMask = require(\"./ui.date_box.mask.parts\");\n\nvar _date = require(\"../../localization/date\");\n\nvar _date2 = _interopRequireDefault(_date);\n\nvar _date3 = require(\"../../localization/ldml/date.parser\");\n\nvar _date4 = require(\"../../localization/ldml/date.format\");\n\nvar _uiDate_box = require(\"./ui.date_box.base\");\n\nvar _uiDate_box2 = _interopRequireDefault(_uiDate_box);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nvar MASK_EVENT_NAMESPACE = \"dateBoxMask\";\nvar FORWARD = 1;\nvar BACKWARD = -1;\n\nvar DateBoxMask = _uiDate_box2.default.inherit({\n  _supportedKeys: function _supportedKeys(e) {\n    var _this = this;\n\n    var originalHandlers = this.callBase(e);\n\n    var callOriginalHandler = function callOriginalHandler(e) {\n      var originalHandler = originalHandlers[(0, _utils.normalizeKeyName)(e)];\n      return originalHandler && originalHandler.apply(_this, [e]);\n    };\n\n    var applyHandler = function applyHandler(e, maskHandler) {\n      if (_this._shouldUseOriginalHandler(e)) {\n        return callOriginalHandler.apply(_this, [e]);\n      } else {\n        return maskHandler.apply(_this, [e]);\n      }\n    };\n\n    return (0, _extend.extend)({}, originalHandlers, {\n      del: function del(e) {\n        return applyHandler(e, function (event) {\n          _this._revertPart(FORWARD);\n\n          _this._isAllSelected() || event.preventDefault();\n        });\n      },\n      backspace: function backspace(e) {\n        return applyHandler(e, function (event) {\n          _this._revertPart(BACKWARD);\n\n          _this._isAllSelected() || event.preventDefault();\n        });\n      },\n      home: function home(e) {\n        return applyHandler(e, function (event) {\n          _this._selectFirstPart();\n\n          event.preventDefault();\n        });\n      },\n      end: function end(e) {\n        return applyHandler(e, function (event) {\n          _this._selectLastPart();\n\n          event.preventDefault();\n        });\n      },\n      escape: function escape(e) {\n        return applyHandler(e, function (event) {\n          _this._revertChanges(event);\n        });\n      },\n      enter: function enter(e) {\n        return applyHandler(e, function (event) {\n          _this._enterHandler(event);\n        });\n      },\n      leftArrow: function leftArrow(e) {\n        return applyHandler(e, function (event) {\n          _this._selectNextPart(BACKWARD);\n\n          event.preventDefault();\n        });\n      },\n      rightArrow: function rightArrow(e) {\n        return applyHandler(e, function (event) {\n          _this._selectNextPart(FORWARD);\n\n          event.preventDefault();\n        });\n      },\n      upArrow: function upArrow(e) {\n        return applyHandler(e, function (event) {\n          _this._upDownArrowHandler(FORWARD);\n\n          event.preventDefault();\n        });\n      },\n      downArrow: function downArrow(e) {\n        return applyHandler(e, function (event) {\n          _this._upDownArrowHandler(BACKWARD);\n\n          event.preventDefault();\n        });\n      }\n    });\n  },\n  _shouldUseOriginalHandler: function _shouldUseOriginalHandler(e) {\n    var keysToHandleByMask = [\"backspace\", \"del\"];\n    var isNotDeletingInCalendar = this.option(\"opened\") && e && keysToHandleByMask.indexOf((0, _utils.normalizeKeyName)(e)) === -1;\n    return !this._useMaskBehavior() || isNotDeletingInCalendar || e && e.altKey;\n  },\n  _upDownArrowHandler: function _upDownArrowHandler(step) {\n    this._setNewDateIfEmpty();\n\n    var originalValue = this._getActivePartValue(this._initialMaskValue);\n\n    var currentValue = this._getActivePartValue();\n\n    var delta = currentValue - originalValue;\n\n    this._loadMaskValue(this._initialMaskValue);\n\n    this._partIncrease(delta + step, true);\n  },\n  _getDefaultOptions: function _getDefaultOptions() {\n    return (0, _extend.extend)(this.callBase(), {\n      useMaskBehavior: false,\n      emptyDateValue: new Date(2e3, 0, 1, 0, 0, 0),\n      advanceCaret: true\n    });\n  },\n  _isSingleCharKey: function _isSingleCharKey(e) {\n    var key = e.originalEvent.key;\n    return \"string\" === typeof key && 1 === key.length && !e.ctrl && !e.alt;\n  },\n  _keyboardHandler: function _keyboardHandler(e) {\n    var key = e.originalEvent.key;\n    var result = this.callBase(e);\n\n    if (!this._useMaskBehavior() || !this._isSingleCharKey(e)) {\n      return result;\n    }\n\n    if (this._isAllSelected()) {\n      this._activePartIndex = 0;\n    }\n\n    this._setNewDateIfEmpty();\n\n    isNaN(parseInt(key)) ? this._searchString(key) : this._searchNumber(key);\n    e.originalEvent.preventDefault();\n    return result;\n  },\n  _isAllSelected: function _isAllSelected() {\n    var caret = this._caret();\n\n    return caret.end - caret.start === this.option(\"text\").length;\n  },\n  _getFormatPattern: function _getFormatPattern() {\n    if (this._formatPattern) {\n      return this._formatPattern;\n    }\n\n    var format = this._strategy.getDisplayFormat(this.option(\"displayFormat\"));\n\n    var isLDMLPattern = (0, _type.isString)(format) && !_date2.default._getPatternByFormat(format);\n\n    if (isLDMLPattern) {\n      this._formatPattern = format;\n    } else {\n      this._formatPattern = (0, _date4.getFormat)(function (value) {\n        return _date2.default.format(value, format);\n      });\n    }\n\n    return this._formatPattern;\n  },\n  _setNewDateIfEmpty: function _setNewDateIfEmpty() {\n    if (!this._maskValue) {\n      var value = \"time\" === this.option(\"type\") ? new Date(null) : new Date();\n      this._maskValue = value;\n      this._initialMaskValue = value;\n\n      this._renderDateParts();\n    }\n  },\n  _searchNumber: function _searchNumber(char) {\n    var _this$_getActivePartL = this._getActivePartLimits(),\n        max = _this$_getActivePartL.max;\n\n    var maxLimitLength = String(max).length;\n\n    var formatLength = this._getActivePartProp(\"pattern\").length;\n\n    this._searchValue = (this._searchValue + char).substr(-maxLimitLength);\n\n    if (isNaN(this._searchValue)) {\n      this._searchValue = char;\n    }\n\n    this._setActivePartValue(this._searchValue);\n\n    if (this.option(\"advanceCaret\")) {\n      var isShortFormat = 1 === formatLength;\n      var maxSearchLength = isShortFormat ? maxLimitLength : Math.min(formatLength, maxLimitLength);\n      var isLengthExceeded = this._searchValue.length === maxSearchLength;\n      var isValueOverflowed = parseInt(this._searchValue + \"0\") > max;\n\n      if (isLengthExceeded || isValueOverflowed) {\n        this._selectNextPart(FORWARD);\n      }\n    }\n  },\n  _searchString: function _searchString(char) {\n    if (!isNaN(parseInt(this._getActivePartProp(\"text\")))) {\n      return;\n    }\n\n    var limits = this._getActivePartProp(\"limits\")(this._maskValue);\n\n    var startString = this._searchValue + char.toLowerCase();\n    var endLimit = limits.max - limits.min;\n\n    for (var i = 0; i <= endLimit; i++) {\n      this._loadMaskValue(this._initialMaskValue);\n\n      this._partIncrease(i + 1);\n\n      if (0 === this._getActivePartProp(\"text\").toLowerCase().indexOf(startString)) {\n        this._searchValue = startString;\n        return;\n      }\n    }\n\n    this._setNewDateIfEmpty();\n\n    if (this._searchValue) {\n      this._clearSearchValue();\n\n      this._searchString(char);\n    }\n  },\n  _clearSearchValue: function _clearSearchValue() {\n    this._searchValue = \"\";\n  },\n  _revertPart: function _revertPart(direction) {\n    if (!this._isAllSelected()) {\n      var actual = this._getActivePartValue(this.option(\"emptyDateValue\"));\n\n      this._setActivePartValue(actual);\n\n      this._selectNextPart(direction);\n    }\n\n    this._clearSearchValue();\n  },\n  _useMaskBehavior: function _useMaskBehavior() {\n    return this.option(\"useMaskBehavior\") && \"text\" === this.option(\"mode\");\n  },\n  _initMaskState: function _initMaskState() {\n    this._activePartIndex = 0;\n    this._formatPattern = null;\n    this._regExpInfo = (0, _date3.getRegExpInfo)(this._getFormatPattern(), _date2.default);\n\n    this._loadMaskValue();\n  },\n  _renderMask: function _renderMask() {\n    this.callBase();\n\n    this._detachMaskEvents();\n\n    this._clearMaskState();\n\n    if (this._useMaskBehavior()) {\n      this._attachMaskEvents();\n\n      this._initMaskState();\n\n      this._renderDateParts();\n    }\n  },\n  _renderDateParts: function _renderDateParts() {\n    if (!this._useMaskBehavior()) {\n      return;\n    }\n\n    var text = this.option(\"text\") || this._getDisplayedText(this._maskValue);\n\n    if (text) {\n      this._dateParts = (0, _uiDate_boxMask.renderDateParts)(text, this._regExpInfo);\n\n      this._selectNextPart();\n    }\n  },\n  _detachMaskEvents: function _detachMaskEvents() {\n    _events_engine2.default.off(this._input(), \".\" + MASK_EVENT_NAMESPACE);\n  },\n  _attachMaskEvents: function _attachMaskEvents() {\n    var _this2 = this;\n\n    _events_engine2.default.on(this._input(), (0, _utils.addNamespace)(\"dxclick\", MASK_EVENT_NAMESPACE), this._maskClickHandler.bind(this));\n\n    _events_engine2.default.on(this._input(), (0, _utils.addNamespace)(\"paste\", MASK_EVENT_NAMESPACE), this._maskPasteHandler.bind(this));\n\n    _events_engine2.default.on(this._input(), (0, _utils.addNamespace)(\"drop\", MASK_EVENT_NAMESPACE), function () {\n      _this2._renderDisplayText(_this2._getDisplayedText(_this2._maskValue));\n\n      _this2._selectNextPart();\n    });\n  },\n  _selectLastPart: function _selectLastPart() {\n    if (this.option(\"text\")) {\n      this._activePartIndex = this._dateParts.length;\n\n      this._selectNextPart(BACKWARD);\n    }\n  },\n  _selectFirstPart: function _selectFirstPart() {\n    if (this.option(\"text\")) {\n      this._activePartIndex = -1;\n\n      this._selectNextPart(FORWARD);\n    }\n  },\n  _onMouseWheel: function _onMouseWheel(e) {\n    if (this._useMaskBehavior()) {\n      this._partIncrease(e.delta > 0 ? FORWARD : BACKWARD, e);\n    }\n  },\n  _selectNextPart: function _selectNextPart() {\n    var step = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : 0;\n\n    if (!this.option(\"text\") || this._disposed) {\n      return;\n    }\n\n    if (step) {\n      this._initialMaskValue = new Date(this._maskValue);\n    }\n\n    var index = (0, _math.fitIntoRange)(this._activePartIndex + step, 0, this._dateParts.length - 1);\n\n    if (this._dateParts[index].isStub) {\n      var isBoundaryIndex = 0 === index && step < 0 || index === this._dateParts.length - 1 && step > 0;\n\n      if (!isBoundaryIndex) {\n        this._selectNextPart(step >= 0 ? step + 1 : step - 1);\n\n        return;\n      } else {\n        index = this._activePartIndex;\n      }\n    }\n\n    if (this._activePartIndex !== index) {\n      this._clearSearchValue();\n    }\n\n    this._activePartIndex = index;\n\n    this._caret(this._getActivePartProp(\"caret\"));\n  },\n  _getRealLimitsPattern: function _getRealLimitsPattern() {\n    if (\"d\" === this._getActivePartProp(\"pattern\")[0]) {\n      return \"dM\";\n    }\n  },\n  _getActivePartLimits: function _getActivePartLimits(lockOtherParts) {\n    var limitFunction = this._getActivePartProp(\"limits\");\n\n    return limitFunction(this._maskValue, lockOtherParts && this._getRealLimitsPattern());\n  },\n  _getActivePartValue: function _getActivePartValue(dateValue) {\n    dateValue = dateValue || this._maskValue;\n\n    var getter = this._getActivePartProp(\"getter\");\n\n    return (0, _type.isFunction)(getter) ? getter(dateValue) : dateValue[getter]();\n  },\n  _addLeadingZeroes: function _addLeadingZeroes(value) {\n    var zeroes = this._searchValue.match(/^0+/);\n\n    var limits = this._getActivePartLimits();\n\n    var maxLimitLength = String(limits.max).length;\n    return ((zeroes && zeroes[0] || \"\") + String(value)).substr(-maxLimitLength);\n  },\n  _setActivePartValue: function _setActivePartValue(value, dateValue) {\n    dateValue = dateValue || this._maskValue;\n\n    var setter = this._getActivePartProp(\"setter\");\n\n    var limits = this._getActivePartLimits();\n\n    value = (0, _math.inRange)(value, limits.min, limits.max) ? value : value % 10;\n    value = this._addLeadingZeroes((0, _math.fitIntoRange)(value, limits.min, limits.max));\n    (0, _type.isFunction)(setter) ? setter(dateValue, value) : dateValue[setter](value);\n\n    this._renderDisplayText(this._getDisplayedText(dateValue));\n\n    this._renderDateParts();\n  },\n  _getActivePartProp: function _getActivePartProp(property) {\n    if (!this._dateParts || !this._dateParts[this._activePartIndex]) {\n      return;\n    }\n\n    return this._dateParts[this._activePartIndex][property];\n  },\n  _loadMaskValue: function _loadMaskValue() {\n    var value = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : this.dateOption(\"value\");\n    this._maskValue = value && new Date(value);\n    this._initialMaskValue = value && new Date(value);\n  },\n  _saveMaskValue: function _saveMaskValue() {\n    var value = this._maskValue && new Date(this._maskValue);\n    this._initialMaskValue = new Date(value);\n    this.dateOption(\"value\", value);\n  },\n  _revertChanges: function _revertChanges() {\n    this._loadMaskValue();\n\n    this._renderDisplayText(this._getDisplayedText(this._maskValue));\n\n    this._renderDateParts();\n  },\n  _renderDisplayText: function _renderDisplayText(text) {\n    this.callBase(text);\n\n    if (this._useMaskBehavior()) {\n      this.option(\"text\", text);\n    }\n  },\n  _partIncrease: function _partIncrease(step, lockOtherParts) {\n    this._setNewDateIfEmpty();\n\n    var _this$_getActivePartL2 = this._getActivePartLimits(lockOtherParts),\n        max = _this$_getActivePartL2.max,\n        min = _this$_getActivePartL2.min;\n\n    var limitDelta = max - min;\n\n    if (1 === limitDelta) {\n      limitDelta++;\n    }\n\n    var newValue = step + this._getActivePartValue();\n\n    if (newValue > max) {\n      newValue = this._applyLimits(newValue, {\n        limitBase: min,\n        limitClosest: max,\n        limitDelta: limitDelta\n      });\n    } else {\n      if (newValue < min) {\n        newValue = this._applyLimits(newValue, {\n          limitBase: max,\n          limitClosest: min,\n          limitDelta: limitDelta\n        });\n      }\n    }\n\n    this._setActivePartValue(newValue);\n  },\n  _applyLimits: function _applyLimits(newValue, _ref) {\n    var limitBase = _ref.limitBase,\n        limitClosest = _ref.limitClosest,\n        limitDelta = _ref.limitDelta;\n    var delta = (newValue - limitClosest) % limitDelta;\n    return delta ? limitBase + delta - 1 * (0, _math.sign)(delta) : limitClosest;\n  },\n  _maskClickHandler: function _maskClickHandler() {\n    if (this.option(\"text\")) {\n      this._activePartIndex = (0, _uiDate_boxMask.getDatePartIndexByPosition)(this._dateParts, this._caret().start);\n\n      this._caret(this._getActivePartProp(\"caret\"));\n    }\n  },\n  _maskPasteHandler: function _maskPasteHandler(e) {\n    var newText = this._replaceSelectedText(this.option(\"text\"), this._caret(), (0, _dom.clipboardText)(e));\n\n    var date = _date2.default.parse(newText, this._getFormatPattern());\n\n    if (date) {\n      this._maskValue = date;\n\n      this._renderDisplayText(this._getDisplayedText(this._maskValue));\n\n      this._renderDateParts();\n\n      this._selectNextPart();\n    }\n\n    e.preventDefault();\n  },\n  _isValueDirty: function _isValueDirty() {\n    var value = this.dateOption(\"value\");\n    return (this._maskValue && this._maskValue.getTime()) !== (value && value.getTime());\n  },\n  _fireChangeEvent: function _fireChangeEvent() {\n    this._clearSearchValue();\n\n    if (this._isValueDirty()) {\n      _events_engine2.default.trigger(this._input(), \"change\");\n    }\n  },\n  _enterHandler: function _enterHandler(e) {\n    this._fireChangeEvent();\n\n    this._selectNextPart(FORWARD);\n\n    e.preventDefault();\n  },\n  _focusOutHandler: function _focusOutHandler(e) {\n    this.callBase(e);\n\n    if (this._useMaskBehavior() && !e.isDefaultPrevented()) {\n      this._fireChangeEvent();\n\n      this._selectFirstPart(e);\n    }\n  },\n  _valueChangeEventHandler: function _valueChangeEventHandler(e) {\n    if (this._useMaskBehavior()) {\n      this._saveValueChangeEvent(e);\n\n      if (!this.option(\"text\")) {\n        this._maskValue = null;\n      }\n\n      this._saveMaskValue();\n    } else {\n      this.callBase(e);\n    }\n  },\n  _optionChanged: function _optionChanged(args) {\n    switch (args.name) {\n      case \"useMaskBehavior\":\n        this._renderMask();\n\n        break;\n\n      case \"displayFormat\":\n      case \"mode\":\n        this.callBase(args);\n\n        this._renderMask();\n\n        break;\n\n      case \"value\":\n        this._loadMaskValue();\n\n        this.callBase(args);\n\n        this._renderDateParts();\n\n        break;\n\n      case \"advanceCaret\":\n      case \"emptyDateValue\":\n        break;\n\n      default:\n        this.callBase(args);\n    }\n  },\n  _clearMaskState: function _clearMaskState() {\n    this._clearSearchValue();\n\n    delete this._dateParts;\n    delete this._activePartIndex;\n    delete this._maskValue;\n  },\n  reset: function reset() {\n    this.callBase();\n\n    this._clearMaskState();\n\n    this._activePartIndex = 0;\n  },\n  _clean: function _clean() {\n    this.callBase();\n\n    this._detachMaskEvents();\n\n    this._clearMaskState();\n  }\n});\n\nmodule.exports = DateBoxMask;","map":{"version":3,"sources":["C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/devextreme/ui/date_box/ui.date_box.mask.js"],"names":["_utils","require","_type","_dom","_extend","_math","_events_engine","_events_engine2","_interopRequireDefault","_uiDate_boxMask","_date","_date2","_date3","_date4","_uiDate_box","_uiDate_box2","obj","MASK_EVENT_NAMESPACE","FORWARD","BACKWARD","DateBoxMask","_supportedKeys","_this","originalHandlers","callOriginalHandler","originalHandler","applyHandler","maskHandler","del","event","backspace","home","end","escape","enter","leftArrow","rightArrow","upArrow","downArrow","_shouldUseOriginalHandler","keysToHandleByMask","isNotDeletingInCalendar","e","_upDownArrowHandler","originalValue","currentValue","delta","_getDefaultOptions","useMaskBehavior","emptyDateValue","advanceCaret","_isSingleCharKey","key","_keyboardHandler","result","isNaN","parseInt","_isAllSelected","caret","_getFormatPattern","format","isLDMLPattern","_setNewDateIfEmpty","value","_searchNumber","_this$_getActivePartL","max","maxLimitLength","String","formatLength","isShortFormat","maxSearchLength","Math","isLengthExceeded","isValueOverflowed","_searchString","limits","startString","char","endLimit","i","_clearSearchValue","_revertPart","actual","_useMaskBehavior","_initMaskState","_renderMask","_renderDateParts","text","_detachMaskEvents","_attachMaskEvents","_this2","_selectLastPart","_selectFirstPart","_onMouseWheel","_selectNextPart","step","arguments","index","isBoundaryIndex","_getRealLimitsPattern","_getActivePartLimits","limitFunction","lockOtherParts","_getActivePartValue","dateValue","getter","_addLeadingZeroes","zeroes","_setActivePartValue","setter","_getActivePartProp","_loadMaskValue","_saveMaskValue","_revertChanges","_renderDisplayText","_partIncrease","_this$_getActivePartL2","min","limitDelta","newValue","limitBase","limitClosest","_applyLimits","_ref","_maskClickHandler","_maskPasteHandler","newText","date","_isValueDirty","_fireChangeEvent","_enterHandler","_focusOutHandler","_valueChangeEventHandler","_optionChanged","args","_clearMaskState","reset","_clean","module"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/date_box/ui.date_box.mask.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar _utils = require(\"../../events/utils\");\r\nvar _type = require(\"../../core/utils/type\");\r\nvar _dom = require(\"../../core/utils/dom\");\r\nvar _extend = require(\"../../core/utils/extend\");\r\nvar _math = require(\"../../core/utils/math\");\r\nvar _events_engine = require(\"../../events/core/events_engine\");\r\nvar _events_engine2 = _interopRequireDefault(_events_engine);\r\nvar _uiDate_boxMask = require(\"./ui.date_box.mask.parts\");\r\nvar _date = require(\"../../localization/date\");\r\nvar _date2 = _interopRequireDefault(_date);\r\nvar _date3 = require(\"../../localization/ldml/date.parser\");\r\nvar _date4 = require(\"../../localization/ldml/date.format\");\r\nvar _uiDate_box = require(\"./ui.date_box.base\");\r\nvar _uiDate_box2 = _interopRequireDefault(_uiDate_box);\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\nvar MASK_EVENT_NAMESPACE = \"dateBoxMask\";\r\nvar FORWARD = 1;\r\nvar BACKWARD = -1;\r\nvar DateBoxMask = _uiDate_box2.default.inherit({\r\n    _supportedKeys: function(e) {\r\n        var _this = this;\r\n        var originalHandlers = this.callBase(e);\r\n        var callOriginalHandler = function(e) {\r\n            var originalHandler = originalHandlers[(0, _utils.normalizeKeyName)(e)];\r\n            return originalHandler && originalHandler.apply(_this, [e])\r\n        };\r\n        var applyHandler = function(e, maskHandler) {\r\n            if (_this._shouldUseOriginalHandler(e)) {\r\n                return callOriginalHandler.apply(_this, [e])\r\n            } else {\r\n                return maskHandler.apply(_this, [e])\r\n            }\r\n        };\r\n        return (0, _extend.extend)({}, originalHandlers, {\r\n            del: function(e) {\r\n                return applyHandler(e, function(event) {\r\n                    _this._revertPart(FORWARD);\r\n                    _this._isAllSelected() || event.preventDefault()\r\n                })\r\n            },\r\n            backspace: function(e) {\r\n                return applyHandler(e, function(event) {\r\n                    _this._revertPart(BACKWARD);\r\n                    _this._isAllSelected() || event.preventDefault()\r\n                })\r\n            },\r\n            home: function(e) {\r\n                return applyHandler(e, function(event) {\r\n                    _this._selectFirstPart();\r\n                    event.preventDefault()\r\n                })\r\n            },\r\n            end: function(e) {\r\n                return applyHandler(e, function(event) {\r\n                    _this._selectLastPart();\r\n                    event.preventDefault()\r\n                })\r\n            },\r\n            escape: function(e) {\r\n                return applyHandler(e, function(event) {\r\n                    _this._revertChanges(event)\r\n                })\r\n            },\r\n            enter: function(e) {\r\n                return applyHandler(e, function(event) {\r\n                    _this._enterHandler(event)\r\n                })\r\n            },\r\n            leftArrow: function(e) {\r\n                return applyHandler(e, function(event) {\r\n                    _this._selectNextPart(BACKWARD);\r\n                    event.preventDefault()\r\n                })\r\n            },\r\n            rightArrow: function(e) {\r\n                return applyHandler(e, function(event) {\r\n                    _this._selectNextPart(FORWARD);\r\n                    event.preventDefault()\r\n                })\r\n            },\r\n            upArrow: function(e) {\r\n                return applyHandler(e, function(event) {\r\n                    _this._upDownArrowHandler(FORWARD);\r\n                    event.preventDefault()\r\n                })\r\n            },\r\n            downArrow: function(e) {\r\n                return applyHandler(e, function(event) {\r\n                    _this._upDownArrowHandler(BACKWARD);\r\n                    event.preventDefault()\r\n                })\r\n            }\r\n        })\r\n    },\r\n    _shouldUseOriginalHandler: function(e) {\r\n        var keysToHandleByMask = [\"backspace\", \"del\"];\r\n        var isNotDeletingInCalendar = this.option(\"opened\") && e && keysToHandleByMask.indexOf((0, _utils.normalizeKeyName)(e)) === -1;\r\n        return !this._useMaskBehavior() || isNotDeletingInCalendar || e && e.altKey\r\n    },\r\n    _upDownArrowHandler: function(step) {\r\n        this._setNewDateIfEmpty();\r\n        var originalValue = this._getActivePartValue(this._initialMaskValue);\r\n        var currentValue = this._getActivePartValue();\r\n        var delta = currentValue - originalValue;\r\n        this._loadMaskValue(this._initialMaskValue);\r\n        this._partIncrease(delta + step, true)\r\n    },\r\n    _getDefaultOptions: function() {\r\n        return (0, _extend.extend)(this.callBase(), {\r\n            useMaskBehavior: false,\r\n            emptyDateValue: new Date(2e3, 0, 1, 0, 0, 0),\r\n            advanceCaret: true\r\n        })\r\n    },\r\n    _isSingleCharKey: function(e) {\r\n        var key = e.originalEvent.key;\r\n        return \"string\" === typeof key && 1 === key.length && !e.ctrl && !e.alt\r\n    },\r\n    _keyboardHandler: function(e) {\r\n        var key = e.originalEvent.key;\r\n        var result = this.callBase(e);\r\n        if (!this._useMaskBehavior() || !this._isSingleCharKey(e)) {\r\n            return result\r\n        }\r\n        if (this._isAllSelected()) {\r\n            this._activePartIndex = 0\r\n        }\r\n        this._setNewDateIfEmpty();\r\n        isNaN(parseInt(key)) ? this._searchString(key) : this._searchNumber(key);\r\n        e.originalEvent.preventDefault();\r\n        return result\r\n    },\r\n    _isAllSelected: function() {\r\n        var caret = this._caret();\r\n        return caret.end - caret.start === this.option(\"text\").length\r\n    },\r\n    _getFormatPattern: function() {\r\n        if (this._formatPattern) {\r\n            return this._formatPattern\r\n        }\r\n        var format = this._strategy.getDisplayFormat(this.option(\"displayFormat\"));\r\n        var isLDMLPattern = (0, _type.isString)(format) && !_date2.default._getPatternByFormat(format);\r\n        if (isLDMLPattern) {\r\n            this._formatPattern = format\r\n        } else {\r\n            this._formatPattern = (0, _date4.getFormat)(function(value) {\r\n                return _date2.default.format(value, format)\r\n            })\r\n        }\r\n        return this._formatPattern\r\n    },\r\n    _setNewDateIfEmpty: function() {\r\n        if (!this._maskValue) {\r\n            var value = \"time\" === this.option(\"type\") ? new Date(null) : new Date;\r\n            this._maskValue = value;\r\n            this._initialMaskValue = value;\r\n            this._renderDateParts()\r\n        }\r\n    },\r\n    _searchNumber: function(char) {\r\n        var _this$_getActivePartL = this._getActivePartLimits(),\r\n            max = _this$_getActivePartL.max;\r\n        var maxLimitLength = String(max).length;\r\n        var formatLength = this._getActivePartProp(\"pattern\").length;\r\n        this._searchValue = (this._searchValue + char).substr(-maxLimitLength);\r\n        if (isNaN(this._searchValue)) {\r\n            this._searchValue = char\r\n        }\r\n        this._setActivePartValue(this._searchValue);\r\n        if (this.option(\"advanceCaret\")) {\r\n            var isShortFormat = 1 === formatLength;\r\n            var maxSearchLength = isShortFormat ? maxLimitLength : Math.min(formatLength, maxLimitLength);\r\n            var isLengthExceeded = this._searchValue.length === maxSearchLength;\r\n            var isValueOverflowed = parseInt(this._searchValue + \"0\") > max;\r\n            if (isLengthExceeded || isValueOverflowed) {\r\n                this._selectNextPart(FORWARD)\r\n            }\r\n        }\r\n    },\r\n    _searchString: function(char) {\r\n        if (!isNaN(parseInt(this._getActivePartProp(\"text\")))) {\r\n            return\r\n        }\r\n        var limits = this._getActivePartProp(\"limits\")(this._maskValue);\r\n        var startString = this._searchValue + char.toLowerCase();\r\n        var endLimit = limits.max - limits.min;\r\n        for (var i = 0; i <= endLimit; i++) {\r\n            this._loadMaskValue(this._initialMaskValue);\r\n            this._partIncrease(i + 1);\r\n            if (0 === this._getActivePartProp(\"text\").toLowerCase().indexOf(startString)) {\r\n                this._searchValue = startString;\r\n                return\r\n            }\r\n        }\r\n        this._setNewDateIfEmpty();\r\n        if (this._searchValue) {\r\n            this._clearSearchValue();\r\n            this._searchString(char)\r\n        }\r\n    },\r\n    _clearSearchValue: function() {\r\n        this._searchValue = \"\"\r\n    },\r\n    _revertPart: function(direction) {\r\n        if (!this._isAllSelected()) {\r\n            var actual = this._getActivePartValue(this.option(\"emptyDateValue\"));\r\n            this._setActivePartValue(actual);\r\n            this._selectNextPart(direction)\r\n        }\r\n        this._clearSearchValue()\r\n    },\r\n    _useMaskBehavior: function() {\r\n        return this.option(\"useMaskBehavior\") && \"text\" === this.option(\"mode\")\r\n    },\r\n    _initMaskState: function() {\r\n        this._activePartIndex = 0;\r\n        this._formatPattern = null;\r\n        this._regExpInfo = (0, _date3.getRegExpInfo)(this._getFormatPattern(), _date2.default);\r\n        this._loadMaskValue()\r\n    },\r\n    _renderMask: function() {\r\n        this.callBase();\r\n        this._detachMaskEvents();\r\n        this._clearMaskState();\r\n        if (this._useMaskBehavior()) {\r\n            this._attachMaskEvents();\r\n            this._initMaskState();\r\n            this._renderDateParts()\r\n        }\r\n    },\r\n    _renderDateParts: function() {\r\n        if (!this._useMaskBehavior()) {\r\n            return\r\n        }\r\n        var text = this.option(\"text\") || this._getDisplayedText(this._maskValue);\r\n        if (text) {\r\n            this._dateParts = (0, _uiDate_boxMask.renderDateParts)(text, this._regExpInfo);\r\n            this._selectNextPart()\r\n        }\r\n    },\r\n    _detachMaskEvents: function() {\r\n        _events_engine2.default.off(this._input(), \".\" + MASK_EVENT_NAMESPACE)\r\n    },\r\n    _attachMaskEvents: function() {\r\n        var _this2 = this;\r\n        _events_engine2.default.on(this._input(), (0, _utils.addNamespace)(\"dxclick\", MASK_EVENT_NAMESPACE), this._maskClickHandler.bind(this));\r\n        _events_engine2.default.on(this._input(), (0, _utils.addNamespace)(\"paste\", MASK_EVENT_NAMESPACE), this._maskPasteHandler.bind(this));\r\n        _events_engine2.default.on(this._input(), (0, _utils.addNamespace)(\"drop\", MASK_EVENT_NAMESPACE), function() {\r\n            _this2._renderDisplayText(_this2._getDisplayedText(_this2._maskValue));\r\n            _this2._selectNextPart()\r\n        })\r\n    },\r\n    _selectLastPart: function() {\r\n        if (this.option(\"text\")) {\r\n            this._activePartIndex = this._dateParts.length;\r\n            this._selectNextPart(BACKWARD)\r\n        }\r\n    },\r\n    _selectFirstPart: function() {\r\n        if (this.option(\"text\")) {\r\n            this._activePartIndex = -1;\r\n            this._selectNextPart(FORWARD)\r\n        }\r\n    },\r\n    _onMouseWheel: function(e) {\r\n        if (this._useMaskBehavior()) {\r\n            this._partIncrease(e.delta > 0 ? FORWARD : BACKWARD, e)\r\n        }\r\n    },\r\n    _selectNextPart: function() {\r\n        var step = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : 0;\r\n        if (!this.option(\"text\") || this._disposed) {\r\n            return\r\n        }\r\n        if (step) {\r\n            this._initialMaskValue = new Date(this._maskValue)\r\n        }\r\n        var index = (0, _math.fitIntoRange)(this._activePartIndex + step, 0, this._dateParts.length - 1);\r\n        if (this._dateParts[index].isStub) {\r\n            var isBoundaryIndex = 0 === index && step < 0 || index === this._dateParts.length - 1 && step > 0;\r\n            if (!isBoundaryIndex) {\r\n                this._selectNextPart(step >= 0 ? step + 1 : step - 1);\r\n                return\r\n            } else {\r\n                index = this._activePartIndex\r\n            }\r\n        }\r\n        if (this._activePartIndex !== index) {\r\n            this._clearSearchValue()\r\n        }\r\n        this._activePartIndex = index;\r\n        this._caret(this._getActivePartProp(\"caret\"))\r\n    },\r\n    _getRealLimitsPattern: function() {\r\n        if (\"d\" === this._getActivePartProp(\"pattern\")[0]) {\r\n            return \"dM\"\r\n        }\r\n    },\r\n    _getActivePartLimits: function(lockOtherParts) {\r\n        var limitFunction = this._getActivePartProp(\"limits\");\r\n        return limitFunction(this._maskValue, lockOtherParts && this._getRealLimitsPattern())\r\n    },\r\n    _getActivePartValue: function(dateValue) {\r\n        dateValue = dateValue || this._maskValue;\r\n        var getter = this._getActivePartProp(\"getter\");\r\n        return (0, _type.isFunction)(getter) ? getter(dateValue) : dateValue[getter]()\r\n    },\r\n    _addLeadingZeroes: function(value) {\r\n        var zeroes = this._searchValue.match(/^0+/);\r\n        var limits = this._getActivePartLimits();\r\n        var maxLimitLength = String(limits.max).length;\r\n        return ((zeroes && zeroes[0] || \"\") + String(value)).substr(-maxLimitLength)\r\n    },\r\n    _setActivePartValue: function(value, dateValue) {\r\n        dateValue = dateValue || this._maskValue;\r\n        var setter = this._getActivePartProp(\"setter\");\r\n        var limits = this._getActivePartLimits();\r\n        value = (0, _math.inRange)(value, limits.min, limits.max) ? value : value % 10;\r\n        value = this._addLeadingZeroes((0, _math.fitIntoRange)(value, limits.min, limits.max));\r\n        (0, _type.isFunction)(setter) ? setter(dateValue, value): dateValue[setter](value);\r\n        this._renderDisplayText(this._getDisplayedText(dateValue));\r\n        this._renderDateParts()\r\n    },\r\n    _getActivePartProp: function(property) {\r\n        if (!this._dateParts || !this._dateParts[this._activePartIndex]) {\r\n            return\r\n        }\r\n        return this._dateParts[this._activePartIndex][property]\r\n    },\r\n    _loadMaskValue: function() {\r\n        var value = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : this.dateOption(\"value\");\r\n        this._maskValue = value && new Date(value);\r\n        this._initialMaskValue = value && new Date(value)\r\n    },\r\n    _saveMaskValue: function() {\r\n        var value = this._maskValue && new Date(this._maskValue);\r\n        this._initialMaskValue = new Date(value);\r\n        this.dateOption(\"value\", value)\r\n    },\r\n    _revertChanges: function() {\r\n        this._loadMaskValue();\r\n        this._renderDisplayText(this._getDisplayedText(this._maskValue));\r\n        this._renderDateParts()\r\n    },\r\n    _renderDisplayText: function(text) {\r\n        this.callBase(text);\r\n        if (this._useMaskBehavior()) {\r\n            this.option(\"text\", text)\r\n        }\r\n    },\r\n    _partIncrease: function(step, lockOtherParts) {\r\n        this._setNewDateIfEmpty();\r\n        var _this$_getActivePartL2 = this._getActivePartLimits(lockOtherParts),\r\n            max = _this$_getActivePartL2.max,\r\n            min = _this$_getActivePartL2.min;\r\n        var limitDelta = max - min;\r\n        if (1 === limitDelta) {\r\n            limitDelta++\r\n        }\r\n        var newValue = step + this._getActivePartValue();\r\n        if (newValue > max) {\r\n            newValue = this._applyLimits(newValue, {\r\n                limitBase: min,\r\n                limitClosest: max,\r\n                limitDelta: limitDelta\r\n            })\r\n        } else {\r\n            if (newValue < min) {\r\n                newValue = this._applyLimits(newValue, {\r\n                    limitBase: max,\r\n                    limitClosest: min,\r\n                    limitDelta: limitDelta\r\n                })\r\n            }\r\n        }\r\n        this._setActivePartValue(newValue)\r\n    },\r\n    _applyLimits: function(newValue, _ref) {\r\n        var limitBase = _ref.limitBase,\r\n            limitClosest = _ref.limitClosest,\r\n            limitDelta = _ref.limitDelta;\r\n        var delta = (newValue - limitClosest) % limitDelta;\r\n        return delta ? limitBase + delta - 1 * (0, _math.sign)(delta) : limitClosest\r\n    },\r\n    _maskClickHandler: function() {\r\n        if (this.option(\"text\")) {\r\n            this._activePartIndex = (0, _uiDate_boxMask.getDatePartIndexByPosition)(this._dateParts, this._caret().start);\r\n            this._caret(this._getActivePartProp(\"caret\"))\r\n        }\r\n    },\r\n    _maskPasteHandler: function(e) {\r\n        var newText = this._replaceSelectedText(this.option(\"text\"), this._caret(), (0, _dom.clipboardText)(e));\r\n        var date = _date2.default.parse(newText, this._getFormatPattern());\r\n        if (date) {\r\n            this._maskValue = date;\r\n            this._renderDisplayText(this._getDisplayedText(this._maskValue));\r\n            this._renderDateParts();\r\n            this._selectNextPart()\r\n        }\r\n        e.preventDefault()\r\n    },\r\n    _isValueDirty: function() {\r\n        var value = this.dateOption(\"value\");\r\n        return (this._maskValue && this._maskValue.getTime()) !== (value && value.getTime())\r\n    },\r\n    _fireChangeEvent: function() {\r\n        this._clearSearchValue();\r\n        if (this._isValueDirty()) {\r\n            _events_engine2.default.trigger(this._input(), \"change\")\r\n        }\r\n    },\r\n    _enterHandler: function(e) {\r\n        this._fireChangeEvent();\r\n        this._selectNextPart(FORWARD);\r\n        e.preventDefault()\r\n    },\r\n    _focusOutHandler: function(e) {\r\n        this.callBase(e);\r\n        if (this._useMaskBehavior() && !e.isDefaultPrevented()) {\r\n            this._fireChangeEvent();\r\n            this._selectFirstPart(e)\r\n        }\r\n    },\r\n    _valueChangeEventHandler: function(e) {\r\n        if (this._useMaskBehavior()) {\r\n            this._saveValueChangeEvent(e);\r\n            if (!this.option(\"text\")) {\r\n                this._maskValue = null\r\n            }\r\n            this._saveMaskValue()\r\n        } else {\r\n            this.callBase(e)\r\n        }\r\n    },\r\n    _optionChanged: function(args) {\r\n        switch (args.name) {\r\n            case \"useMaskBehavior\":\r\n                this._renderMask();\r\n                break;\r\n            case \"displayFormat\":\r\n            case \"mode\":\r\n                this.callBase(args);\r\n                this._renderMask();\r\n                break;\r\n            case \"value\":\r\n                this._loadMaskValue();\r\n                this.callBase(args);\r\n                this._renderDateParts();\r\n                break;\r\n            case \"advanceCaret\":\r\n            case \"emptyDateValue\":\r\n                break;\r\n            default:\r\n                this.callBase(args)\r\n        }\r\n    },\r\n    _clearMaskState: function() {\r\n        this._clearSearchValue();\r\n        delete this._dateParts;\r\n        delete this._activePartIndex;\r\n        delete this._maskValue\r\n    },\r\n    reset: function() {\r\n        this.callBase();\r\n        this._clearMaskState();\r\n        this._activePartIndex = 0\r\n    },\r\n    _clean: function() {\r\n        this.callBase();\r\n        this._detachMaskEvents();\r\n        this._clearMaskState()\r\n    }\r\n});\r\nmodule.exports = DateBoxMask;\r\n"]},"metadata":{},"sourceType":"module"}