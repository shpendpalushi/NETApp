{"ast":null,"code":"/**\r\n * DevExtreme (events/core/emitter_registrator.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar $ = require(\"../../core/renderer\");\n\nvar readyCallbacks = require(\"../../core/utils/ready_callbacks\");\n\nvar domAdapter = require(\"../../core/dom_adapter\");\n\nvar eventsEngine = require(\"../../events/core/events_engine\");\n\nvar dataUtils = require(\"../../core/element_data\");\n\nvar Class = require(\"../../core/class\");\n\nvar extend = require(\"../../core/utils/extend\").extend;\n\nvar inArray = require(\"../../core/utils/array\").inArray;\n\nvar each = require(\"../../core/utils/iterator\").each;\n\nvar registerEvent = require(\"./event_registrator\");\n\nvar eventUtils = require(\"../utils\");\n\nvar pointerEvents = require(\"../pointer\");\n\nvar wheelEvent = require(\"./wheel\");\n\nvar MANAGER_EVENT = \"dxEventManager\";\nvar EMITTER_DATA = \"dxEmitter\";\nvar EventManager = Class.inherit({\n  ctor: function ctor() {\n    this._attachHandlers();\n\n    this.reset();\n    this._proxiedCancelHandler = this._cancelHandler.bind(this);\n    this._proxiedAcceptHandler = this._acceptHandler.bind(this);\n  },\n  _attachHandlers: function _attachHandlers() {\n    readyCallbacks.add(function () {\n      var document = domAdapter.getDocument();\n      eventsEngine.subscribeGlobal(document, eventUtils.addNamespace(pointerEvents.down, MANAGER_EVENT), this._pointerDownHandler.bind(this));\n      eventsEngine.subscribeGlobal(document, eventUtils.addNamespace(pointerEvents.move, MANAGER_EVENT), this._pointerMoveHandler.bind(this));\n      eventsEngine.subscribeGlobal(document, eventUtils.addNamespace([pointerEvents.up, pointerEvents.cancel].join(\" \"), MANAGER_EVENT), this._pointerUpHandler.bind(this));\n      eventsEngine.subscribeGlobal(document, eventUtils.addNamespace(wheelEvent.name, MANAGER_EVENT), this._mouseWheelHandler.bind(this));\n    }.bind(this));\n  },\n  _eachEmitter: function _eachEmitter(callback) {\n    var activeEmitters = this._activeEmitters || [];\n    var i = 0;\n\n    while (activeEmitters.length > i) {\n      var emitter = activeEmitters[i];\n\n      if (false === callback(emitter)) {\n        break;\n      }\n\n      if (activeEmitters[i] === emitter) {\n        i++;\n      }\n    }\n  },\n  _applyToEmitters: function _applyToEmitters(method, arg) {\n    this._eachEmitter(function (emitter) {\n      emitter[method].call(emitter, arg);\n    });\n  },\n  reset: function reset() {\n    this._eachEmitter(this._proxiedCancelHandler);\n\n    this._activeEmitters = [];\n  },\n  resetEmitter: function resetEmitter(emitter) {\n    this._proxiedCancelHandler(emitter);\n  },\n  _pointerDownHandler: function _pointerDownHandler(e) {\n    if (eventUtils.isMouseEvent(e) && e.which > 1) {\n      return;\n    }\n\n    this._updateEmitters(e);\n  },\n  _updateEmitters: function _updateEmitters(e) {\n    if (!this._isSetChanged(e)) {\n      return;\n    }\n\n    this._cleanEmitters(e);\n\n    this._fetchEmitters(e);\n  },\n  _isSetChanged: function _isSetChanged(e) {\n    var currentSet = this._closestEmitter(e);\n\n    var previousSet = this._emittersSet || [];\n    var setChanged = currentSet.length !== previousSet.length;\n    each(currentSet, function (index, emitter) {\n      setChanged = setChanged || previousSet[index] !== emitter;\n      return !setChanged;\n    });\n    this._emittersSet = currentSet;\n    return setChanged;\n  },\n  _closestEmitter: function _closestEmitter(e) {\n    var that = this;\n    var result = [];\n    var $element = $(e.target);\n\n    function handleEmitter(_, emitter) {\n      if (!!emitter && emitter.validatePointers(e) && emitter.validate(e)) {\n        emitter.addCancelCallback(that._proxiedCancelHandler);\n        emitter.addAcceptCallback(that._proxiedAcceptHandler);\n        result.push(emitter);\n      }\n    }\n\n    while ($element.length) {\n      var emitters = dataUtils.data($element.get(0), EMITTER_DATA) || [];\n      each(emitters, handleEmitter);\n      $element = $element.parent();\n    }\n\n    return result;\n  },\n  _acceptHandler: function _acceptHandler(acceptedEmitter, e) {\n    var that = this;\n\n    this._eachEmitter(function (emitter) {\n      if (emitter !== acceptedEmitter) {\n        that._cancelEmitter(emitter, e);\n      }\n    });\n  },\n  _cancelHandler: function _cancelHandler(canceledEmitter, e) {\n    this._cancelEmitter(canceledEmitter, e);\n  },\n  _cancelEmitter: function _cancelEmitter(emitter, e) {\n    var activeEmitters = this._activeEmitters;\n\n    if (e) {\n      emitter.cancel(e);\n    } else {\n      emitter.reset();\n    }\n\n    emitter.removeCancelCallback();\n    emitter.removeAcceptCallback();\n    var emitterIndex = inArray(emitter, activeEmitters);\n\n    if (emitterIndex > -1) {\n      activeEmitters.splice(emitterIndex, 1);\n    }\n  },\n  _cleanEmitters: function _cleanEmitters(e) {\n    this._applyToEmitters(\"end\", e);\n\n    this.reset(e);\n  },\n  _fetchEmitters: function _fetchEmitters(e) {\n    this._activeEmitters = this._emittersSet.slice();\n\n    this._applyToEmitters(\"start\", e);\n  },\n  _pointerMoveHandler: function _pointerMoveHandler(e) {\n    this._applyToEmitters(\"move\", e);\n  },\n  _pointerUpHandler: function _pointerUpHandler(e) {\n    this._updateEmitters(e);\n  },\n  _mouseWheelHandler: function _mouseWheelHandler(e) {\n    if (!this._allowInterruptionByMouseWheel()) {\n      return;\n    }\n\n    e.pointers = [null];\n\n    this._pointerDownHandler(e);\n\n    this._adjustWheelEvent(e);\n\n    this._pointerMoveHandler(e);\n\n    e.pointers = [];\n\n    this._pointerUpHandler(e);\n  },\n  _allowInterruptionByMouseWheel: function _allowInterruptionByMouseWheel() {\n    var allowInterruption = true;\n\n    this._eachEmitter(function (emitter) {\n      allowInterruption = emitter.allowInterruptionByMouseWheel() && allowInterruption;\n      return allowInterruption;\n    });\n\n    return allowInterruption;\n  },\n  _adjustWheelEvent: function _adjustWheelEvent(e) {\n    var closestGestureEmitter = null;\n\n    this._eachEmitter(function (emitter) {\n      if (!emitter.gesture) {\n        return;\n      }\n\n      var direction = emitter.getDirection(e);\n\n      if (\"horizontal\" !== direction && !e.shiftKey || \"vertical\" !== direction && e.shiftKey) {\n        closestGestureEmitter = emitter;\n        return false;\n      }\n    });\n\n    if (!closestGestureEmitter) {\n      return;\n    }\n\n    var direction = closestGestureEmitter.getDirection(e);\n    var verticalGestureDirection = \"both\" === direction && !e.shiftKey || \"vertical\" === direction;\n    var prop = verticalGestureDirection ? \"pageY\" : \"pageX\";\n    e[prop] += e.delta;\n  },\n  isActive: function isActive(element) {\n    var result = false;\n\n    this._eachEmitter(function (emitter) {\n      result = result || emitter.getElement().is(element);\n    });\n\n    return result;\n  }\n});\nvar eventManager = new EventManager();\nvar EMITTER_SUBSCRIPTION_DATA = \"dxEmitterSubscription\";\n\nvar registerEmitter = function registerEmitter(emitterConfig) {\n  var emitterClass = emitterConfig.emitter;\n  var emitterName = emitterConfig.events[0];\n  var emitterEvents = emitterConfig.events;\n  each(emitterEvents, function (_, eventName) {\n    registerEvent(eventName, {\n      noBubble: !emitterConfig.bubble,\n      setup: function setup(element) {\n        var subscriptions = dataUtils.data(element, EMITTER_SUBSCRIPTION_DATA) || {};\n        var emitters = dataUtils.data(element, EMITTER_DATA) || {};\n        var emitter = emitters[emitterName] || new emitterClass(element);\n        subscriptions[eventName] = true;\n        emitters[emitterName] = emitter;\n        dataUtils.data(element, EMITTER_DATA, emitters);\n        dataUtils.data(element, EMITTER_SUBSCRIPTION_DATA, subscriptions);\n      },\n      add: function add(element, handleObj) {\n        var emitters = dataUtils.data(element, EMITTER_DATA);\n        var emitter = emitters[emitterName];\n        emitter.configure(extend({\n          delegateSelector: handleObj.selector\n        }, handleObj.data), handleObj.type);\n      },\n      teardown: function teardown(element) {\n        var subscriptions = dataUtils.data(element, EMITTER_SUBSCRIPTION_DATA);\n        var emitters = dataUtils.data(element, EMITTER_DATA);\n        var emitter = emitters[emitterName];\n        delete subscriptions[eventName];\n        var disposeEmitter = true;\n        each(emitterEvents, function (_, eventName) {\n          disposeEmitter = disposeEmitter && !subscriptions[eventName];\n          return disposeEmitter;\n        });\n\n        if (disposeEmitter) {\n          if (eventManager.isActive(element)) {\n            eventManager.resetEmitter(emitter);\n          }\n\n          emitter && emitter.dispose();\n          delete emitters[emitterName];\n        }\n      }\n    });\n  });\n};\n\nmodule.exports = registerEmitter;","map":{"version":3,"sources":["C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/devextreme/events/core/emitter_registrator.js"],"names":["$","require","readyCallbacks","domAdapter","eventsEngine","dataUtils","Class","extend","inArray","each","registerEvent","eventUtils","pointerEvents","wheelEvent","MANAGER_EVENT","EMITTER_DATA","EventManager","ctor","_attachHandlers","document","_eachEmitter","activeEmitters","i","emitter","callback","_applyToEmitters","reset","resetEmitter","_pointerDownHandler","e","_updateEmitters","_isSetChanged","currentSet","previousSet","setChanged","_closestEmitter","that","result","$element","emitters","_acceptHandler","_cancelHandler","_cancelEmitter","emitterIndex","_cleanEmitters","_fetchEmitters","_pointerMoveHandler","_pointerUpHandler","_mouseWheelHandler","_allowInterruptionByMouseWheel","allowInterruption","_adjustWheelEvent","closestGestureEmitter","direction","verticalGestureDirection","prop","isActive","eventManager","EMITTER_SUBSCRIPTION_DATA","registerEmitter","emitterClass","emitterConfig","emitterName","emitterEvents","noBubble","setup","subscriptions","add","delegateSelector","handleObj","selector","teardown","disposeEmitter","module"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (events/core/emitter_registrator.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar $ = require(\"../../core/renderer\");\r\nvar readyCallbacks = require(\"../../core/utils/ready_callbacks\");\r\nvar domAdapter = require(\"../../core/dom_adapter\");\r\nvar eventsEngine = require(\"../../events/core/events_engine\");\r\nvar dataUtils = require(\"../../core/element_data\");\r\nvar Class = require(\"../../core/class\");\r\nvar extend = require(\"../../core/utils/extend\").extend;\r\nvar inArray = require(\"../../core/utils/array\").inArray;\r\nvar each = require(\"../../core/utils/iterator\").each;\r\nvar registerEvent = require(\"./event_registrator\");\r\nvar eventUtils = require(\"../utils\");\r\nvar pointerEvents = require(\"../pointer\");\r\nvar wheelEvent = require(\"./wheel\");\r\nvar MANAGER_EVENT = \"dxEventManager\";\r\nvar EMITTER_DATA = \"dxEmitter\";\r\nvar EventManager = Class.inherit({\r\n    ctor: function() {\r\n        this._attachHandlers();\r\n        this.reset();\r\n        this._proxiedCancelHandler = this._cancelHandler.bind(this);\r\n        this._proxiedAcceptHandler = this._acceptHandler.bind(this)\r\n    },\r\n    _attachHandlers: function() {\r\n        readyCallbacks.add(function() {\r\n            var document = domAdapter.getDocument();\r\n            eventsEngine.subscribeGlobal(document, eventUtils.addNamespace(pointerEvents.down, MANAGER_EVENT), this._pointerDownHandler.bind(this));\r\n            eventsEngine.subscribeGlobal(document, eventUtils.addNamespace(pointerEvents.move, MANAGER_EVENT), this._pointerMoveHandler.bind(this));\r\n            eventsEngine.subscribeGlobal(document, eventUtils.addNamespace([pointerEvents.up, pointerEvents.cancel].join(\" \"), MANAGER_EVENT), this._pointerUpHandler.bind(this));\r\n            eventsEngine.subscribeGlobal(document, eventUtils.addNamespace(wheelEvent.name, MANAGER_EVENT), this._mouseWheelHandler.bind(this))\r\n        }.bind(this))\r\n    },\r\n    _eachEmitter: function(callback) {\r\n        var activeEmitters = this._activeEmitters || [];\r\n        var i = 0;\r\n        while (activeEmitters.length > i) {\r\n            var emitter = activeEmitters[i];\r\n            if (false === callback(emitter)) {\r\n                break\r\n            }\r\n            if (activeEmitters[i] === emitter) {\r\n                i++\r\n            }\r\n        }\r\n    },\r\n    _applyToEmitters: function(method, arg) {\r\n        this._eachEmitter(function(emitter) {\r\n            emitter[method].call(emitter, arg)\r\n        })\r\n    },\r\n    reset: function() {\r\n        this._eachEmitter(this._proxiedCancelHandler);\r\n        this._activeEmitters = []\r\n    },\r\n    resetEmitter: function(emitter) {\r\n        this._proxiedCancelHandler(emitter)\r\n    },\r\n    _pointerDownHandler: function(e) {\r\n        if (eventUtils.isMouseEvent(e) && e.which > 1) {\r\n            return\r\n        }\r\n        this._updateEmitters(e)\r\n    },\r\n    _updateEmitters: function(e) {\r\n        if (!this._isSetChanged(e)) {\r\n            return\r\n        }\r\n        this._cleanEmitters(e);\r\n        this._fetchEmitters(e)\r\n    },\r\n    _isSetChanged: function(e) {\r\n        var currentSet = this._closestEmitter(e);\r\n        var previousSet = this._emittersSet || [];\r\n        var setChanged = currentSet.length !== previousSet.length;\r\n        each(currentSet, function(index, emitter) {\r\n            setChanged = setChanged || previousSet[index] !== emitter;\r\n            return !setChanged\r\n        });\r\n        this._emittersSet = currentSet;\r\n        return setChanged\r\n    },\r\n    _closestEmitter: function(e) {\r\n        var that = this;\r\n        var result = [];\r\n        var $element = $(e.target);\r\n\r\n        function handleEmitter(_, emitter) {\r\n            if (!!emitter && emitter.validatePointers(e) && emitter.validate(e)) {\r\n                emitter.addCancelCallback(that._proxiedCancelHandler);\r\n                emitter.addAcceptCallback(that._proxiedAcceptHandler);\r\n                result.push(emitter)\r\n            }\r\n        }\r\n        while ($element.length) {\r\n            var emitters = dataUtils.data($element.get(0), EMITTER_DATA) || [];\r\n            each(emitters, handleEmitter);\r\n            $element = $element.parent()\r\n        }\r\n        return result\r\n    },\r\n    _acceptHandler: function(acceptedEmitter, e) {\r\n        var that = this;\r\n        this._eachEmitter(function(emitter) {\r\n            if (emitter !== acceptedEmitter) {\r\n                that._cancelEmitter(emitter, e)\r\n            }\r\n        })\r\n    },\r\n    _cancelHandler: function(canceledEmitter, e) {\r\n        this._cancelEmitter(canceledEmitter, e)\r\n    },\r\n    _cancelEmitter: function(emitter, e) {\r\n        var activeEmitters = this._activeEmitters;\r\n        if (e) {\r\n            emitter.cancel(e)\r\n        } else {\r\n            emitter.reset()\r\n        }\r\n        emitter.removeCancelCallback();\r\n        emitter.removeAcceptCallback();\r\n        var emitterIndex = inArray(emitter, activeEmitters);\r\n        if (emitterIndex > -1) {\r\n            activeEmitters.splice(emitterIndex, 1)\r\n        }\r\n    },\r\n    _cleanEmitters: function(e) {\r\n        this._applyToEmitters(\"end\", e);\r\n        this.reset(e)\r\n    },\r\n    _fetchEmitters: function(e) {\r\n        this._activeEmitters = this._emittersSet.slice();\r\n        this._applyToEmitters(\"start\", e)\r\n    },\r\n    _pointerMoveHandler: function(e) {\r\n        this._applyToEmitters(\"move\", e)\r\n    },\r\n    _pointerUpHandler: function(e) {\r\n        this._updateEmitters(e)\r\n    },\r\n    _mouseWheelHandler: function(e) {\r\n        if (!this._allowInterruptionByMouseWheel()) {\r\n            return\r\n        }\r\n        e.pointers = [null];\r\n        this._pointerDownHandler(e);\r\n        this._adjustWheelEvent(e);\r\n        this._pointerMoveHandler(e);\r\n        e.pointers = [];\r\n        this._pointerUpHandler(e)\r\n    },\r\n    _allowInterruptionByMouseWheel: function() {\r\n        var allowInterruption = true;\r\n        this._eachEmitter(function(emitter) {\r\n            allowInterruption = emitter.allowInterruptionByMouseWheel() && allowInterruption;\r\n            return allowInterruption\r\n        });\r\n        return allowInterruption\r\n    },\r\n    _adjustWheelEvent: function(e) {\r\n        var closestGestureEmitter = null;\r\n        this._eachEmitter(function(emitter) {\r\n            if (!emitter.gesture) {\r\n                return\r\n            }\r\n            var direction = emitter.getDirection(e);\r\n            if (\"horizontal\" !== direction && !e.shiftKey || \"vertical\" !== direction && e.shiftKey) {\r\n                closestGestureEmitter = emitter;\r\n                return false\r\n            }\r\n        });\r\n        if (!closestGestureEmitter) {\r\n            return\r\n        }\r\n        var direction = closestGestureEmitter.getDirection(e);\r\n        var verticalGestureDirection = \"both\" === direction && !e.shiftKey || \"vertical\" === direction;\r\n        var prop = verticalGestureDirection ? \"pageY\" : \"pageX\";\r\n        e[prop] += e.delta\r\n    },\r\n    isActive: function(element) {\r\n        var result = false;\r\n        this._eachEmitter(function(emitter) {\r\n            result = result || emitter.getElement().is(element)\r\n        });\r\n        return result\r\n    }\r\n});\r\nvar eventManager = new EventManager;\r\nvar EMITTER_SUBSCRIPTION_DATA = \"dxEmitterSubscription\";\r\nvar registerEmitter = function(emitterConfig) {\r\n    var emitterClass = emitterConfig.emitter;\r\n    var emitterName = emitterConfig.events[0];\r\n    var emitterEvents = emitterConfig.events;\r\n    each(emitterEvents, function(_, eventName) {\r\n        registerEvent(eventName, {\r\n            noBubble: !emitterConfig.bubble,\r\n            setup: function(element) {\r\n                var subscriptions = dataUtils.data(element, EMITTER_SUBSCRIPTION_DATA) || {};\r\n                var emitters = dataUtils.data(element, EMITTER_DATA) || {};\r\n                var emitter = emitters[emitterName] || new emitterClass(element);\r\n                subscriptions[eventName] = true;\r\n                emitters[emitterName] = emitter;\r\n                dataUtils.data(element, EMITTER_DATA, emitters);\r\n                dataUtils.data(element, EMITTER_SUBSCRIPTION_DATA, subscriptions)\r\n            },\r\n            add: function(element, handleObj) {\r\n                var emitters = dataUtils.data(element, EMITTER_DATA);\r\n                var emitter = emitters[emitterName];\r\n                emitter.configure(extend({\r\n                    delegateSelector: handleObj.selector\r\n                }, handleObj.data), handleObj.type)\r\n            },\r\n            teardown: function(element) {\r\n                var subscriptions = dataUtils.data(element, EMITTER_SUBSCRIPTION_DATA);\r\n                var emitters = dataUtils.data(element, EMITTER_DATA);\r\n                var emitter = emitters[emitterName];\r\n                delete subscriptions[eventName];\r\n                var disposeEmitter = true;\r\n                each(emitterEvents, function(_, eventName) {\r\n                    disposeEmitter = disposeEmitter && !subscriptions[eventName];\r\n                    return disposeEmitter\r\n                });\r\n                if (disposeEmitter) {\r\n                    if (eventManager.isActive(element)) {\r\n                        eventManager.resetEmitter(emitter)\r\n                    }\r\n                    emitter && emitter.dispose();\r\n                    delete emitters[emitterName]\r\n                }\r\n            }\r\n        })\r\n    })\r\n};\r\nmodule.exports = registerEmitter;\r\n"]},"metadata":{},"sourceType":"module"}