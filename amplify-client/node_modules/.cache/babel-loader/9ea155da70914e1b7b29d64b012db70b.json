{"ast":null,"code":"/**\r\n * DevExtreme (data/store_helper.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar grep = require(\"../core/utils/common\").grep;\n\nvar extend = require(\"../core/utils/extend\").extend;\n\nvar each = require(\"../core/utils/iterator\").each;\n\nvar arrayQuery = require(\"./array_query\");\n\nvar normalizeSortingInfo = require(\"./utils\").normalizeSortingInfo;\n\nfunction multiLevelGroup(query, groupInfo) {\n  query = query.groupBy(groupInfo[0].selector);\n\n  if (groupInfo.length > 1) {\n    query = query.select(function (g) {\n      return extend({}, g, {\n        items: multiLevelGroup(arrayQuery(g.items), groupInfo.slice(1)).toArray()\n      });\n    });\n  }\n\n  return query;\n}\n\nfunction arrangeSortingInfo(groupInfo, sortInfo) {\n  var filteredGroup = [];\n  each(groupInfo, function (_, group) {\n    var collision = grep(sortInfo, function (sort) {\n      return group.selector === sort.selector;\n    });\n\n    if (collision.length < 1) {\n      filteredGroup.push(group);\n    }\n  });\n  return filteredGroup.concat(sortInfo);\n}\n\nfunction queryByOptions(query, options, isCountQuery) {\n  options = options || {};\n  var filter = options.filter;\n\n  if (filter) {\n    query = query.filter(filter);\n  }\n\n  if (isCountQuery) {\n    return query;\n  }\n\n  var sort = options.sort;\n  var select = options.select;\n  var group = options.group;\n  var skip = options.skip;\n  var take = options.take;\n\n  if (group) {\n    group = normalizeSortingInfo(group);\n    group.keepInitialKeyOrder = !!options.group.keepInitialKeyOrder;\n  }\n\n  if (sort || group) {\n    sort = normalizeSortingInfo(sort || []);\n\n    if (group && !group.keepInitialKeyOrder) {\n      sort = arrangeSortingInfo(group, sort);\n    }\n\n    each(sort, function (index) {\n      query = query[index ? \"thenBy\" : \"sortBy\"](this.selector, this.desc, this.compare);\n    });\n  }\n\n  if (select) {\n    query = query.select(select);\n  }\n\n  if (group) {\n    query = multiLevelGroup(query, group);\n  }\n\n  if (take || skip) {\n    query = query.slice(skip || 0, take);\n  }\n\n  return query;\n}\n\nmodule.exports = {\n  multiLevelGroup: multiLevelGroup,\n  arrangeSortingInfo: arrangeSortingInfo,\n  queryByOptions: queryByOptions\n};","map":{"version":3,"sources":["C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/devextreme/data/store_helper.js"],"names":["grep","require","extend","each","arrayQuery","normalizeSortingInfo","query","groupInfo","items","multiLevelGroup","g","filteredGroup","collision","group","sort","options","filter","select","skip","take","arrangeSortingInfo","index","module","queryByOptions"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (data/store_helper.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar grep = require(\"../core/utils/common\").grep;\r\nvar extend = require(\"../core/utils/extend\").extend;\r\nvar each = require(\"../core/utils/iterator\").each;\r\nvar arrayQuery = require(\"./array_query\");\r\nvar normalizeSortingInfo = require(\"./utils\").normalizeSortingInfo;\r\n\r\nfunction multiLevelGroup(query, groupInfo) {\r\n    query = query.groupBy(groupInfo[0].selector);\r\n    if (groupInfo.length > 1) {\r\n        query = query.select(function(g) {\r\n            return extend({}, g, {\r\n                items: multiLevelGroup(arrayQuery(g.items), groupInfo.slice(1)).toArray()\r\n            })\r\n        })\r\n    }\r\n    return query\r\n}\r\n\r\nfunction arrangeSortingInfo(groupInfo, sortInfo) {\r\n    var filteredGroup = [];\r\n    each(groupInfo, function(_, group) {\r\n        var collision = grep(sortInfo, function(sort) {\r\n            return group.selector === sort.selector\r\n        });\r\n        if (collision.length < 1) {\r\n            filteredGroup.push(group)\r\n        }\r\n    });\r\n    return filteredGroup.concat(sortInfo)\r\n}\r\n\r\nfunction queryByOptions(query, options, isCountQuery) {\r\n    options = options || {};\r\n    var filter = options.filter;\r\n    if (filter) {\r\n        query = query.filter(filter)\r\n    }\r\n    if (isCountQuery) {\r\n        return query\r\n    }\r\n    var sort = options.sort;\r\n    var select = options.select;\r\n    var group = options.group;\r\n    var skip = options.skip;\r\n    var take = options.take;\r\n    if (group) {\r\n        group = normalizeSortingInfo(group);\r\n        group.keepInitialKeyOrder = !!options.group.keepInitialKeyOrder\r\n    }\r\n    if (sort || group) {\r\n        sort = normalizeSortingInfo(sort || []);\r\n        if (group && !group.keepInitialKeyOrder) {\r\n            sort = arrangeSortingInfo(group, sort)\r\n        }\r\n        each(sort, function(index) {\r\n            query = query[index ? \"thenBy\" : \"sortBy\"](this.selector, this.desc, this.compare)\r\n        })\r\n    }\r\n    if (select) {\r\n        query = query.select(select)\r\n    }\r\n    if (group) {\r\n        query = multiLevelGroup(query, group)\r\n    }\r\n    if (take || skip) {\r\n        query = query.slice(skip || 0, take)\r\n    }\r\n    return query\r\n}\r\nmodule.exports = {\r\n    multiLevelGroup: multiLevelGroup,\r\n    arrangeSortingInfo: arrangeSortingInfo,\r\n    queryByOptions: queryByOptions\r\n};\r\n"]},"metadata":{},"sourceType":"module"}