{"ast":null,"code":"/**\r\n * DevExtreme (ui/grid_core/ui.grid_core.virtual_scrolling.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar _renderer = require(\"../../core/renderer\");\n\nvar _renderer2 = _interopRequireDefault(_renderer);\n\nvar _window = require(\"../../core/utils/window\");\n\nvar _common = require(\"../../core/utils/common\");\n\nvar _uiGrid_core = require(\"./ui.grid_core.virtual_scrolling_core\");\n\nvar _uiGrid_core2 = _interopRequireDefault(_uiGrid_core);\n\nvar _uiGrid_core3 = require(\"./ui.grid_core.utils\");\n\nvar _uiGrid_core4 = _interopRequireDefault(_uiGrid_core3);\n\nvar _iterator = require(\"../../core/utils/iterator\");\n\nvar _deferred = require(\"../../core/utils/deferred\");\n\nvar _translator = require(\"../../animation/translator\");\n\nvar _translator2 = _interopRequireDefault(_translator);\n\nvar _load_indicator = require(\"../load_indicator\");\n\nvar _load_indicator2 = _interopRequireDefault(_load_indicator);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nvar TABLE_CLASS = \"table\";\nvar BOTTOM_LOAD_PANEL_CLASS = \"bottom-load-panel\";\nvar TABLE_CONTENT_CLASS = \"table-content\";\nvar GROUP_SPACE_CLASS = \"group-space\";\nvar CONTENT_CLASS = \"content\";\nvar ROW_CLASS = \"dx-row\";\nvar FREESPACE_CLASS = \"dx-freespace-row\";\nvar COLUMN_LINES_CLASS = \"dx-column-lines\";\nvar VIRTUAL_ROW_CLASS = \"dx-virtual-row\";\nvar SCROLLING_MODE_INFINITE = \"infinite\";\nvar SCROLLING_MODE_VIRTUAL = \"virtual\";\nvar SCROLLING_MODE_STANDARD = \"standard\";\nvar PIXELS_LIMIT = 25e4;\nvar LOAD_TIMEOUT = 300;\n\nvar isVirtualMode = function isVirtualMode(that) {\n  return that.option(\"scrolling.mode\") === SCROLLING_MODE_VIRTUAL;\n};\n\nvar isAppendMode = function isAppendMode(that) {\n  return that.option(\"scrolling.mode\") === SCROLLING_MODE_INFINITE;\n};\n\nvar isVirtualRowRendering = function isVirtualRowRendering(that) {\n  var rowRenderingMode = that.option(\"scrolling.rowRenderingMode\");\n\n  if (rowRenderingMode === SCROLLING_MODE_VIRTUAL) {\n    return true;\n  } else {\n    if (rowRenderingMode === SCROLLING_MODE_STANDARD) {\n      return false;\n    }\n  }\n};\n\nvar _correctCount = function _correctCount(items, count, fromEnd, isItemCountableFunc) {\n  var countCorrection = fromEnd ? 0 : 1;\n\n  for (var i = 0; i < count + countCorrection; i++) {\n    var item = items[fromEnd ? items.length - 1 - i : i];\n\n    if (item && !isItemCountableFunc(item, i === count)) {\n      count++;\n    }\n  }\n\n  return count;\n};\n\nvar VirtualScrollingDataSourceAdapterExtender = function () {\n  var _updateLoading = function _updateLoading(that) {\n    var beginPageIndex = that._virtualScrollController.beginPageIndex(-1);\n\n    if (isVirtualMode(that)) {\n      if (beginPageIndex < 0 || that.viewportSize() >= 0 && that.getViewportItemIndex() >= 0 && (beginPageIndex * that.pageSize() > that.getViewportItemIndex() || beginPageIndex * that.pageSize() + that.itemsCount() < that.getViewportItemIndex() + that.viewportSize()) && that._dataSource.isLoading()) {\n        if (!that._isLoading) {\n          that._isLoading = true;\n          that.loadingChanged.fire(true);\n        }\n      } else {\n        if (that._isLoading) {\n          that._isLoading = false;\n          that.loadingChanged.fire(false);\n        }\n      }\n    }\n  };\n\n  var result = {\n    init: function init(dataSource) {\n      var that = this;\n      that.callBase.apply(that, arguments);\n      that._items = [];\n      that._isLoaded = true;\n      that._virtualScrollController = new _uiGrid_core2.default.VirtualScrollController(that.component, {\n        pageSize: function pageSize() {\n          return that.pageSize();\n        },\n        totalItemsCount: function totalItemsCount() {\n          return that.totalItemsCount();\n        },\n        hasKnownLastPage: function hasKnownLastPage() {\n          return that.hasKnownLastPage();\n        },\n        pageIndex: function pageIndex(index) {\n          return dataSource.pageIndex(index);\n        },\n        isLoading: function isLoading() {\n          return dataSource.isLoading() && !that.isCustomLoading();\n        },\n        pageCount: function pageCount() {\n          return that.pageCount();\n        },\n        load: function load() {\n          return dataSource.load();\n        },\n        updateLoading: function updateLoading() {\n          _updateLoading(that);\n        },\n        itemsCount: function itemsCount() {\n          return that.itemsCount(true);\n        },\n        items: function items() {\n          return dataSource.items();\n        },\n        viewportItems: function viewportItems(items) {\n          if (items) {\n            that._items = items;\n          }\n\n          return that._items;\n        },\n        onChanged: function onChanged(e) {\n          that.changed.fire(e);\n        },\n        changingDuration: function changingDuration(e) {\n          if (that.isLoading()) {\n            return LOAD_TIMEOUT;\n          }\n\n          return that._renderTime || 0;\n        }\n      });\n    },\n    _handleLoadingChanged: function _handleLoadingChanged(isLoading) {\n      var that = this;\n\n      if (!isVirtualMode(that)) {\n        that._isLoading = isLoading;\n        that.callBase.apply(that, arguments);\n      }\n\n      if (isLoading) {\n        that._startLoadTime = new Date();\n      } else {\n        that._startLoadTime = void 0;\n      }\n    },\n    _handleLoadError: function _handleLoadError() {\n      var that = this;\n      that._isLoading = false;\n      that.loadingChanged.fire(false);\n      that.callBase.apply(that, arguments);\n    },\n    _handleDataChanged: function _handleDataChanged(e) {\n      var callBase = this.callBase.bind(this);\n\n      this._virtualScrollController.handleDataChanged(callBase, e);\n    },\n    _customizeRemoteOperations: function _customizeRemoteOperations(options, isReload, operationTypes) {\n      var that = this;\n\n      if (!that.option(\"legacyRendering\") && isVirtualMode(that) && !(operationTypes.reload || isReload) && operationTypes.skip && that._renderTime < that.option(\"scrolling.renderingThreshold\")) {\n        options.delay = void 0;\n      }\n\n      that.callBase.apply(that, arguments);\n    },\n    items: function items() {\n      return this._items;\n    },\n    itemsCount: function itemsCount(isBase) {\n      if (isBase) {\n        return this.callBase();\n      }\n\n      return this._virtualScrollController.itemsCount();\n    },\n    load: function load(loadOptions) {\n      if (loadOptions) {\n        return this.callBase(loadOptions);\n      }\n\n      return this._virtualScrollController.load();\n    },\n    isLoading: function isLoading() {\n      return this._isLoading;\n    },\n    isLoaded: function isLoaded() {\n      return this._dataSource.isLoaded() && this._isLoaded;\n    },\n    resetPagesCache: function resetPagesCache(isLiveUpdate) {\n      if (!isLiveUpdate) {\n        this._virtualScrollController.reset(true);\n      }\n\n      this.callBase.apply(this, arguments);\n    },\n    _changeRowExpandCore: function _changeRowExpandCore() {\n      var result = this.callBase.apply(this, arguments);\n      this.resetPagesCache();\n\n      _updateLoading(this);\n\n      return result;\n    },\n    reload: function reload() {\n      this._dataSource.pageIndex(this.pageIndex());\n\n      var virtualScrollController = this._virtualScrollController;\n\n      if (virtualScrollController) {\n        var d = new _deferred.Deferred();\n        this.callBase.apply(this, arguments).done(function (r) {\n          var delayDeferred = virtualScrollController._delayDeferred;\n\n          if (delayDeferred) {\n            delayDeferred.done(d.resolve).fail(d.reject);\n          } else {\n            d.resolve(r);\n          }\n        }).fail(d.reject);\n        return d;\n      } else {\n        return this.callBase.apply(this, arguments);\n      }\n    },\n    refresh: function refresh(options, isReload, operationTypes) {\n      var that = this;\n      var storeLoadOptions = options.storeLoadOptions;\n      var dataSource = that._dataSource;\n\n      if (isReload || operationTypes.reload) {\n        that._virtualScrollController.reset();\n\n        dataSource.items().length = 0;\n        that._isLoaded = false;\n\n        _updateLoading(that);\n\n        that._isLoaded = true;\n\n        if (isAppendMode(that)) {\n          that.pageIndex(0);\n          dataSource.pageIndex(0);\n          storeLoadOptions.pageIndex = 0;\n          options.pageIndex = 0;\n          storeLoadOptions.skip = 0;\n        } else {\n          dataSource.pageIndex(that.pageIndex());\n\n          if (dataSource.paginate()) {\n            options.pageIndex = that.pageIndex();\n            storeLoadOptions.skip = that.pageIndex() * that.pageSize();\n          }\n        }\n      }\n\n      return that.callBase.apply(that, arguments);\n    },\n    dispose: function dispose() {\n      this._virtualScrollController.dispose();\n\n      this.callBase.apply(this, arguments);\n    }\n  };\n  [\"virtualItemsCount\", \"getContentOffset\", \"getVirtualContentSize\", \"setContentSize\", \"setViewportPosition\", \"getViewportItemIndex\", \"setViewportItemIndex\", \"getItemIndexByPosition\", \"viewportSize\", \"viewportItemSize\", \"getItemSize\", \"getItemSizes\", \"pageIndex\", \"beginPageIndex\", \"endPageIndex\", \"loadIfNeed\"].forEach(function (name) {\n    result[name] = function () {\n      var virtualScrollController = this._virtualScrollController;\n      return virtualScrollController[name].apply(virtualScrollController, arguments);\n    };\n  });\n  return result;\n}();\n\nvar VirtualScrollingRowsViewExtender = function () {\n  var removeEmptyRows = function removeEmptyRows($emptyRows, className) {\n    var rowCount;\n\n    var getRowParent = function getRowParent(row) {\n      return (0, _renderer2.default)(row).parent(\".\" + className).get(0);\n    };\n\n    var tBodies = $emptyRows.toArray().map(getRowParent).filter(function (row) {\n      return row;\n    });\n\n    if (tBodies.length) {\n      $emptyRows = (0, _renderer2.default)(tBodies);\n    }\n\n    rowCount = className === FREESPACE_CLASS ? $emptyRows.length - 1 : $emptyRows.length;\n\n    for (var i = 0; i < rowCount; i++) {\n      $emptyRows.eq(i).remove();\n    }\n  };\n\n  return {\n    init: function init() {\n      var that = this;\n      var dataController = that.getController(\"data\");\n      that.callBase();\n      dataController.pageChanged.add(function () {\n        that.scrollToPage(dataController.pageIndex());\n      });\n\n      if (!that.option(\"legacyRendering\") && dataController.pageIndex() > 0) {\n        var resizeHandler = function resizeHandler() {\n          that.resizeCompleted.remove(resizeHandler);\n          that.scrollToPage(dataController.pageIndex());\n        };\n\n        that.resizeCompleted.add(resizeHandler);\n      }\n    },\n    scrollToPage: function scrollToPage(pageIndex) {\n      var that = this;\n      var dataController = that._dataController;\n      var pageSize = dataController ? dataController.pageSize() : 0;\n      var scrollPosition;\n\n      if (isVirtualMode(that) || isAppendMode(that)) {\n        var itemSize = dataController.getItemSize();\n        var itemSizes = dataController.getItemSizes();\n        var itemIndex = pageIndex * pageSize;\n        scrollPosition = itemIndex * itemSize;\n\n        for (var index in itemSizes) {\n          if (index <= itemIndex) {\n            scrollPosition += itemSizes[index] - itemSize;\n          }\n        }\n      } else {\n        scrollPosition = 0;\n      }\n\n      that.scrollTo({\n        y: scrollPosition,\n        x: that._scrollLeft\n      });\n    },\n    renderDelayedTemplates: function renderDelayedTemplates(e) {\n      this._updateContentPosition(true);\n\n      this.callBase.apply(this, arguments);\n    },\n    _renderCore: function _renderCore(e) {\n      var that = this;\n      var dataSource;\n      var startRenderTime = new Date();\n      that.callBase.apply(that, arguments);\n      dataSource = that._dataController._dataSource;\n\n      if (dataSource && e) {\n        var itemCount = e.items ? e.items.length : 20;\n        var viewportSize = that._dataController.viewportSize() || 20;\n\n        if (isVirtualRowRendering(that)) {\n          dataSource._renderTime = (new Date() - startRenderTime) * viewportSize / itemCount;\n        } else {\n          dataSource._renderTime = new Date() - startRenderTime;\n        }\n      }\n    },\n    _getRowElements: function _getRowElements(tableElement) {\n      var $rows = this.callBase(tableElement);\n      return $rows && $rows.not(\".\" + VIRTUAL_ROW_CLASS);\n    },\n    _renderContent: function _renderContent(contentElement, tableElement) {\n      var that = this;\n\n      var virtualItemsCount = that._dataController.virtualItemsCount();\n\n      if (virtualItemsCount && that.option(\"legacyRendering\")) {\n        if ((0, _window.hasWindow)()) {\n          tableElement.addClass(that.addWidgetPrefix(TABLE_CONTENT_CLASS));\n        }\n\n        if (!contentElement.children().length) {\n          contentElement.append(tableElement);\n        } else {\n          contentElement.children().first().replaceWith(tableElement);\n        }\n\n        if (1 === contentElement.children(\"table\").length) {\n          contentElement.append(that._createTable());\n          that._contentHeight = 0;\n        }\n\n        return contentElement;\n      }\n\n      return that.callBase.apply(that, arguments);\n    },\n    _removeRowsElements: function _removeRowsElements(contentTable, removeCount, changeType) {\n      var rowElements = this._getRowElements(contentTable).toArray();\n\n      if (\"append\" === changeType) {\n        rowElements = rowElements.slice(0, removeCount);\n      } else {\n        rowElements = rowElements.slice(-removeCount);\n      }\n\n      var errorHandlingController = this.getController(\"errorHandling\");\n      rowElements.map(function (rowElement) {\n        var $rowElement = (0, _renderer2.default)(rowElement);\n        errorHandlingController && errorHandlingController.removeErrorRow($rowElement.next());\n        $rowElement.remove();\n      });\n    },\n    _restoreErrorRow: function _restoreErrorRow(contentTable) {\n      var editingController = this.getController(\"editing\");\n      editingController && editingController.hasChanges() && this._getRowElements(contentTable).each(function (_, item) {\n        var rowOptions = (0, _renderer2.default)(item).data(\"options\");\n\n        if (rowOptions) {\n          var editData = editingController.getEditDataByKey(rowOptions.key);\n          editData && editingController._showErrorRow(editData);\n        }\n      });\n    },\n    _updateContent: function _updateContent(tableElement, change) {\n      var that = this;\n      var contentTable;\n      var $freeSpaceRowElements;\n\n      var contentElement = that._findContentElement();\n\n      var changeType = change && change.changeType;\n\n      if (\"append\" === changeType || \"prepend\" === changeType) {\n        contentTable = contentElement.children().first();\n\n        var $tBodies = that._getBodies(tableElement);\n\n        if (!that.option(\"legacyRendering\") && 1 === $tBodies.length) {\n          that._getBodies(contentTable)[\"append\" === changeType ? \"append\" : \"prepend\"]($tBodies.children());\n        } else {\n          $tBodies[\"append\" === changeType ? \"appendTo\" : \"prependTo\"](contentTable);\n        }\n\n        tableElement.remove();\n        $freeSpaceRowElements = that._getFreeSpaceRowElements(contentTable);\n        removeEmptyRows($freeSpaceRowElements, FREESPACE_CLASS);\n\n        if (change.removeCount) {\n          that._removeRowsElements(contentTable, change.removeCount, changeType);\n        }\n\n        that._restoreErrorRow(contentTable);\n      } else {\n        that.callBase.apply(that, arguments);\n      }\n\n      that._updateBottomLoading();\n    },\n    _addVirtualRow: function _addVirtualRow($table, isFixed, location, position) {\n      if (!position) {\n        return;\n      }\n\n      var $virtualRow = this._createEmptyRow(VIRTUAL_ROW_CLASS, isFixed, position);\n\n      $virtualRow = this._wrapRowIfNeed($table, $virtualRow);\n\n      this._appendEmptyRow($table, $virtualRow, location);\n    },\n    _updateContentPosition: function _updateContentPosition(isRender) {\n      var that = this;\n      var dataController = that._dataController;\n      var rowHeight = that._rowHeight || 20;\n      dataController.viewportItemSize(rowHeight);\n\n      if (!that.option(\"legacyRendering\") && (isVirtualMode(that) || isVirtualRowRendering(that))) {\n        if (!isRender) {\n          var rowHeights = that._getRowElements(that._tableElement).toArray().map(function (row) {\n            return row.getBoundingClientRect().height;\n          });\n\n          dataController.setContentSize(rowHeights);\n        }\n\n        var top = dataController.getContentOffset(\"begin\");\n        var bottom = dataController.getContentOffset(\"end\");\n        var $tables = that.getTableElements();\n        var $virtualRows = $tables.children(\"tbody\").children(\".\" + VIRTUAL_ROW_CLASS);\n        removeEmptyRows($virtualRows, VIRTUAL_ROW_CLASS);\n        $tables.each(function (index) {\n          var isFixed = index > 0;\n          that._isFixedTableRendering = isFixed;\n\n          that._addVirtualRow((0, _renderer2.default)(this), isFixed, \"top\", top);\n\n          that._addVirtualRow((0, _renderer2.default)(this), isFixed, \"bottom\", bottom);\n\n          that._isFixedTableRendering = false;\n        });\n        !isRender && that._updateScrollTopPosition(top);\n      } else {\n        (0, _common.deferUpdate)(function () {\n          that._updateContentPositionCore();\n        });\n      }\n    },\n    _updateScrollTopPosition: function _updateScrollTopPosition(top) {\n      if (this._scrollTop < top && !this._isScrollByEvent && this._dataController.pageIndex() > 0) {\n        this.scrollTo({\n          top: top,\n          left: this._scrollLeft\n        });\n      }\n    },\n    _updateContentPositionCore: function _updateContentPositionCore() {\n      var that = this;\n      var contentElement;\n      var contentHeight;\n      var top;\n      var $tables;\n      var $contentTable;\n      var virtualTable;\n      var rowHeight = that._rowHeight || 20;\n\n      var virtualItemsCount = that._dataController.virtualItemsCount();\n\n      var isRenderVirtualTableContentRequired;\n\n      if (virtualItemsCount) {\n        contentElement = that._findContentElement();\n        $tables = contentElement.children();\n        $contentTable = $tables.eq(0);\n        virtualTable = $tables.eq(1);\n        that._contentTableHeight = $contentTable[0].offsetHeight;\n\n        that._dataController.viewportItemSize(rowHeight);\n\n        that._dataController.setContentSize(that._contentTableHeight);\n\n        contentHeight = that._dataController.getVirtualContentSize();\n        top = that._dataController.getContentOffset();\n        (0, _common.deferRender)(function () {\n          _translator2.default.move($contentTable, {\n            left: 0,\n            top: top\n          });\n\n          isRenderVirtualTableContentRequired = that._contentHeight !== contentHeight || 0 === contentHeight || !that._isTableLinesDisplaysCorrect(virtualTable) || !that._isColumnElementsEqual($contentTable.find(\"col\"), virtualTable.find(\"col\"));\n\n          if (isRenderVirtualTableContentRequired) {\n            that._contentHeight = contentHeight;\n\n            that._renderVirtualTableContent(virtualTable, contentHeight);\n          }\n\n          that._updateScrollTopPosition(top);\n        });\n      }\n    },\n    _isTableLinesDisplaysCorrect: function _isTableLinesDisplaysCorrect(table) {\n      var hasColumnLines = table.find(\".\" + COLUMN_LINES_CLASS).length > 0;\n      return hasColumnLines === this.option(\"showColumnLines\");\n    },\n    _isColumnElementsEqual: function _isColumnElementsEqual($columns, $virtualColumns) {\n      var result = $columns.length === $virtualColumns.length;\n\n      if (result) {\n        (0, _iterator.each)($columns, function (index, element) {\n          if (element.style.width !== $virtualColumns[index].style.width) {\n            result = false;\n            return result;\n          }\n        });\n      }\n\n      return result;\n    },\n    _renderVirtualTableContent: function _renderVirtualTableContent(container, height) {\n      var that = this;\n\n      var columns = that._columnsController.getVisibleColumns();\n\n      var html = that._createColGroup(columns).prop(\"outerHTML\");\n\n      var freeSpaceCellsHtml = \"\";\n      var i;\n      var columnLinesClass = that.option(\"showColumnLines\") ? COLUMN_LINES_CLASS : \"\";\n\n      var createFreeSpaceRowHtml = function createFreeSpaceRowHtml(height) {\n        return \"<tr style='height:\" + height + \"px;' class='\" + FREESPACE_CLASS + \" \" + ROW_CLASS + \" \" + columnLinesClass + \"' >\" + freeSpaceCellsHtml + \"</tr>\";\n      };\n\n      for (i = 0; i < columns.length; i++) {\n        var classes = that._getCellClasses(columns[i]);\n\n        var classString = classes.length ? \" class='\" + classes.join(\" \") + \"'\" : \"\";\n        freeSpaceCellsHtml += \"<td\" + classString + \"/>\";\n      }\n\n      while (height > PIXELS_LIMIT) {\n        html += createFreeSpaceRowHtml(PIXELS_LIMIT);\n        height -= PIXELS_LIMIT;\n      }\n\n      html += createFreeSpaceRowHtml(height);\n      container.addClass(that.addWidgetPrefix(TABLE_CLASS));\n      container.html(html);\n    },\n    _getCellClasses: function _getCellClasses(column) {\n      var classes = [];\n      var cssClass = column.cssClass;\n      var isExpandColumn = \"expand\" === column.command;\n      cssClass && classes.push(cssClass);\n      isExpandColumn && classes.push(this.addWidgetPrefix(GROUP_SPACE_CLASS));\n      return classes;\n    },\n    _findBottomLoadPanel: function _findBottomLoadPanel($contentElement) {\n      var $element = $contentElement || this.element();\n      var $bottomLoadPanel = $element && $element.find(\".\" + this.addWidgetPrefix(BOTTOM_LOAD_PANEL_CLASS));\n\n      if ($bottomLoadPanel && $bottomLoadPanel.length) {\n        return $bottomLoadPanel;\n      }\n    },\n    _updateBottomLoading: function _updateBottomLoading() {\n      var that = this;\n      var scrollingMode = that.option(\"scrolling.mode\");\n      var virtualMode = scrollingMode === SCROLLING_MODE_VIRTUAL;\n      var appendMode = scrollingMode === SCROLLING_MODE_INFINITE;\n      var showBottomLoading = !that._dataController.hasKnownLastPage() && that._dataController.isLoaded() && (virtualMode || appendMode);\n\n      var $contentElement = that._findContentElement();\n\n      var bottomLoadPanelElement = that._findBottomLoadPanel($contentElement);\n\n      if (showBottomLoading) {\n        if (!bottomLoadPanelElement) {\n          (0, _renderer2.default)(\"<div>\").addClass(that.addWidgetPrefix(BOTTOM_LOAD_PANEL_CLASS)).append(that._createComponent((0, _renderer2.default)(\"<div>\"), _load_indicator2.default).$element()).appendTo($contentElement);\n        }\n      } else {\n        if (bottomLoadPanelElement) {\n          bottomLoadPanelElement.remove();\n        }\n      }\n    },\n    _handleScroll: function _handleScroll(e) {\n      var that = this;\n\n      if (that._hasHeight && that._rowHeight) {\n        that._dataController.setViewportPosition(e.scrollOffset.top);\n      }\n\n      that.callBase.apply(that, arguments);\n    },\n    _needUpdateRowHeight: function _needUpdateRowHeight(itemsCount) {\n      var that = this;\n      return that.callBase.apply(that, arguments) || itemsCount > 0 && that.option(\"scrolling.mode\") === SCROLLING_MODE_INFINITE && that.option(\"scrolling.rowRenderingMode\") !== SCROLLING_MODE_VIRTUAL;\n    },\n    _updateRowHeight: function _updateRowHeight() {\n      var that = this;\n      var viewportHeight;\n      that.callBase.apply(that, arguments);\n\n      if (that._rowHeight) {\n        that._updateContentPosition();\n\n        viewportHeight = that._hasHeight ? that.element().outerHeight() : (0, _renderer2.default)((0, _window.getWindow)()).outerHeight();\n\n        that._dataController.viewportSize(Math.ceil(viewportHeight / that._rowHeight));\n      }\n    },\n    updateFreeSpaceRowHeight: function updateFreeSpaceRowHeight() {\n      var result = this.callBase.apply(this, arguments);\n\n      if (result) {\n        this._updateContentPosition();\n      }\n\n      return result;\n    },\n    setLoading: function setLoading(isLoading, messageText) {\n      var that = this;\n      var callBase = that.callBase;\n      var dataController = that._dataController;\n      var hasBottomLoadPanel = dataController.pageIndex() > 0 && dataController.isLoaded() && !!that._findBottomLoadPanel();\n\n      if (hasBottomLoadPanel) {\n        isLoading = false;\n      }\n\n      callBase.call(that, isLoading, messageText);\n    },\n    _resizeCore: function _resizeCore() {\n      var that = this;\n      var $element = that.element();\n      that.callBase();\n\n      if (that.component.$element() && !that._windowScroll && $element.closest((0, _window.getWindow)().document).length) {\n        that._windowScroll = _uiGrid_core2.default.subscribeToExternalScrollers($element, function (scrollPos) {\n          if (!that._hasHeight && that._rowHeight) {\n            that._dataController.setViewportPosition(scrollPos);\n          }\n        }, that.component.$element());\n        that.on(\"disposing\", function () {\n          that._windowScroll.dispose();\n        });\n      }\n\n      that.loadIfNeed();\n    },\n    loadIfNeed: function loadIfNeed() {\n      var dataController = this._dataController;\n\n      if (dataController && dataController.loadIfNeed) {\n        dataController.loadIfNeed();\n      }\n    },\n    setColumnWidths: function setColumnWidths(widths) {\n      var scrollable = this.getScrollable();\n      var $content;\n      this.callBase.apply(this, arguments);\n\n      if (\"virtual\" === this.option(\"scrolling.mode\")) {\n        $content = scrollable ? scrollable.$content() : this.element();\n        this.callBase(widths, $content.children(\".\" + this.addWidgetPrefix(CONTENT_CLASS)).children(\":not(.\" + this.addWidgetPrefix(TABLE_CONTENT_CLASS) + \")\"));\n      }\n    },\n    dispose: function dispose() {\n      clearTimeout(this._scrollTimeoutID);\n      this.callBase();\n    }\n  };\n}();\n\nmodule.exports = {\n  defaultOptions: function defaultOptions() {\n    return {\n      scrolling: {\n        timeout: 300,\n        updateTimeout: 300,\n        minTimeout: 0,\n        renderingThreshold: 100,\n        removeInvisiblePages: true,\n        rowPageSize: 5,\n        mode: \"standard\",\n        preloadEnabled: false,\n        rowRenderingMode: \"standard\"\n      }\n    };\n  },\n  extenders: {\n    dataSourceAdapter: VirtualScrollingDataSourceAdapterExtender,\n    controllers: {\n      data: function () {\n        var members = {\n          _refreshDataSource: function _refreshDataSource() {\n            var baseResult = this.callBase.apply(this, arguments) || new _deferred.Deferred().resolve().promise();\n            baseResult.done(this.initVirtualRows.bind(this));\n            return baseResult;\n          },\n          getRowPageSize: function getRowPageSize() {\n            var rowPageSize = this.option(\"scrolling.rowPageSize\");\n            var pageSize = this.pageSize();\n            return pageSize && pageSize < rowPageSize ? pageSize : rowPageSize;\n          },\n          reload: function reload() {\n            var that = this;\n            var rowsScrollController = that._rowsScrollController || that._dataSource;\n            var itemIndex = rowsScrollController && rowsScrollController.getItemIndexByPosition();\n            var result = this.callBase.apply(this, arguments);\n            return result && result.done(function () {\n              if (isVirtualMode(that) || isVirtualRowRendering(that)) {\n                var rowIndexOffset = that.getRowIndexOffset();\n                var rowIndex = Math.floor(itemIndex) - rowIndexOffset;\n                var component = that.component;\n                var scrollable = component.getScrollable && component.getScrollable();\n\n                if (scrollable && !that.option(\"legacyRendering\")) {\n                  var rowElement = component.getRowElement(rowIndex);\n                  var $rowElement = rowElement && rowElement[0] && (0, _renderer2.default)(rowElement[0]);\n                  var top = $rowElement && $rowElement.position().top;\n\n                  if (top > 0) {\n                    top = Math.round(top + $rowElement.outerHeight() * (itemIndex % 1));\n                    scrollable.scrollTo({\n                      y: top\n                    });\n                  }\n                }\n              }\n            });\n          },\n          initVirtualRows: function initVirtualRows() {\n            var that = this;\n            var virtualRowsRendering = isVirtualRowRendering(that);\n\n            if (\"virtual\" !== that.option(\"scrolling.mode\") && true !== virtualRowsRendering || false === virtualRowsRendering || that.option(\"legacyRendering\") || !that.option(\"scrolling.rowPageSize\")) {\n              that._visibleItems = null;\n              that._rowsScrollController = null;\n              return;\n            }\n\n            that._rowPageIndex = Math.ceil(that.pageIndex() * that.pageSize() / that.getRowPageSize());\n            that._visibleItems = [];\n\n            var isItemCountable = function isItemCountable(item) {\n              return \"data\" === item.rowType && !item.isNewRow || \"group\" === item.rowType && that._dataSource.isGroupItemCountable(item.data);\n            };\n\n            that._rowsScrollController = new _uiGrid_core2.default.VirtualScrollController(that.component, {\n              pageSize: function pageSize() {\n                return that.getRowPageSize();\n              },\n              totalItemsCount: function totalItemsCount() {\n                return isVirtualMode(that) ? that.totalItemsCount() : that._items.filter(isItemCountable).length;\n              },\n              hasKnownLastPage: function hasKnownLastPage() {\n                return true;\n              },\n              pageIndex: function pageIndex(index) {\n                if (void 0 !== index) {\n                  that._rowPageIndex = index;\n                }\n\n                return that._rowPageIndex;\n              },\n              isLoading: function isLoading() {\n                return that.isLoading();\n              },\n              pageCount: function pageCount() {\n                var pageCount = Math.ceil(this.totalItemsCount() / this.pageSize());\n                return pageCount ? pageCount : 1;\n              },\n              load: function load() {\n                if (that._rowsScrollController.pageIndex() >= this.pageCount()) {\n                  that._rowPageIndex = this.pageCount() - 1;\n\n                  that._rowsScrollController.pageIndex(that._rowPageIndex);\n                }\n\n                if (!that._rowsScrollController._dataSource.items().length && this.totalItemsCount()) {\n                  return;\n                }\n\n                that._rowsScrollController.handleDataChanged(function (change) {\n                  change = change || {};\n                  change.changeType = change.changeType || \"refresh\";\n                  change.items = change.items || that._visibleItems;\n\n                  that._visibleItems.forEach(function (item, index) {\n                    item.rowIndex = index;\n                  });\n\n                  that._fireChanged(change);\n                });\n              },\n              updateLoading: function updateLoading() {},\n              itemsCount: function itemsCount() {\n                return that._rowsScrollController._dataSource.items().filter(isItemCountable).length;\n              },\n              correctCount: function correctCount(items, count, fromEnd) {\n                return _correctCount(items, count, fromEnd, isItemCountable);\n              },\n              items: function items(countableOnly) {\n                var dataSource = that.dataSource();\n                var virtualItemsCount = dataSource && dataSource.virtualItemsCount();\n                var begin = virtualItemsCount ? virtualItemsCount.begin : 0;\n                var rowPageSize = that.getRowPageSize();\n                var skip = that._rowPageIndex * rowPageSize - begin;\n                var take = rowPageSize;\n                var result = that._items;\n\n                if (skip < 0) {\n                  return [];\n                }\n\n                if (skip) {\n                  skip = this.correctCount(result, skip);\n                  result = result.slice(skip);\n                }\n\n                if (take) {\n                  take = this.correctCount(result, take);\n                  result = result.slice(0, take);\n                }\n\n                return countableOnly ? result.filter(isItemCountable) : result;\n              },\n              viewportItems: function viewportItems(items) {\n                if (items) {\n                  that._visibleItems = items;\n                }\n\n                return that._visibleItems;\n              },\n              onChanged: function onChanged() {},\n              changingDuration: function changingDuration(e) {\n                var dataSource = that.dataSource();\n\n                if (dataSource.isLoading()) {\n                  return LOAD_TIMEOUT;\n                }\n\n                return dataSource && dataSource._renderTime || 0;\n              }\n            }, true);\n\n            if (that.isLoaded()) {\n              that._rowsScrollController.load();\n            }\n          },\n          _updateItemsCore: function _updateItemsCore(change) {\n            var _this = this;\n\n            var delta = this.getRowIndexDelta();\n            this.callBase.apply(this, arguments);\n            var rowsScrollController = this._rowsScrollController;\n\n            if (rowsScrollController) {\n              var visibleItems = this._visibleItems;\n              var isRefresh = \"refresh\" === change.changeType || change.isLiveUpdate;\n\n              if (\"append\" === change.changeType && change.items && !change.items.length) {\n                return;\n              }\n\n              if (isRefresh || \"append\" === change.changeType || \"prepend\" === change.changeType) {\n                change.cancel = true;\n                isRefresh && rowsScrollController.reset(true);\n                rowsScrollController.load();\n              } else {\n                if (\"update\" === change.changeType) {\n                  change.rowIndices.forEach(function (rowIndex, index) {\n                    var changeType = change.changeTypes[index];\n                    var newItem = change.items[index];\n\n                    if (\"update\" === changeType) {\n                      visibleItems[rowIndex] = newItem;\n                    } else {\n                      if (\"insert\" === changeType) {\n                        visibleItems.splice(rowIndex, 0, newItem);\n                      } else {\n                        if (\"remove\" === changeType) {\n                          visibleItems.splice(rowIndex, 1);\n                        }\n                      }\n                    }\n                  });\n                } else {\n                  visibleItems.forEach(function (item, index) {\n                    visibleItems[index] = _this._items[index + delta] || visibleItems[index];\n                  });\n                  change.items = visibleItems;\n                }\n\n                visibleItems.forEach(function (item, index) {\n                  item.rowIndex = index;\n                });\n              }\n            }\n          },\n          _applyChange: function _applyChange(change) {\n            var that = this;\n            var items = change.items;\n            var changeType = change.changeType;\n            var removeCount = change.removeCount;\n\n            if (removeCount) {\n              var fromEnd = \"prepend\" === changeType;\n              removeCount = _correctCount(that._items, removeCount, fromEnd, function (item, isNextAfterLast) {\n                return \"data\" === item.rowType && !item.isNewRow || \"group\" === item.rowType && (that._dataSource.isGroupItemCountable(item.data) || isNextAfterLast);\n              });\n              change.removeCount = removeCount;\n            }\n\n            switch (changeType) {\n              case \"prepend\":\n                that._items.unshift.apply(that._items, items);\n\n                if (removeCount) {\n                  that._items.splice(-removeCount);\n                }\n\n                break;\n\n              case \"append\":\n                that._items.push.apply(that._items, items);\n\n                if (removeCount) {\n                  that._items.splice(0, removeCount);\n                }\n\n                break;\n\n              default:\n                that.callBase(change);\n            }\n          },\n          items: function items(allItems) {\n            return allItems ? this._items : this._visibleItems || this._items;\n          },\n          getRowIndexDelta: function getRowIndexDelta() {\n            var visibleItems = this._visibleItems;\n            var delta = 0;\n\n            if (visibleItems && visibleItems[0]) {\n              delta = this._items.indexOf(visibleItems[0]);\n            }\n\n            return delta < 0 ? 0 : delta;\n          },\n          getRowIndexOffset: function getRowIndexOffset() {\n            var offset = 0;\n            var dataSource = this.dataSource();\n            var rowsScrollController = this._rowsScrollController;\n\n            if (rowsScrollController) {\n              offset = rowsScrollController.beginPageIndex() * rowsScrollController._dataSource.pageSize();\n            } else {\n              if (\"virtual\" === this.option(\"scrolling.mode\") && dataSource) {\n                offset = dataSource.beginPageIndex() * dataSource.pageSize();\n              }\n            }\n\n            return offset;\n          },\n          viewportSize: function viewportSize() {\n            var rowsScrollController = this._rowsScrollController;\n            rowsScrollController && rowsScrollController.viewportSize.apply(rowsScrollController, arguments);\n            var dataSource = this._dataSource;\n            return dataSource && dataSource.viewportSize.apply(dataSource, arguments);\n          },\n          viewportItemSize: function viewportItemSize() {\n            var rowsScrollController = this._rowsScrollController;\n            rowsScrollController && rowsScrollController.viewportItemSize.apply(rowsScrollController, arguments);\n            var dataSource = this._dataSource;\n            return dataSource && dataSource.viewportItemSize.apply(dataSource, arguments);\n          },\n          setViewportPosition: function setViewportPosition() {\n            var rowsScrollController = this._rowsScrollController;\n            var dataSource = this._dataSource;\n\n            if (rowsScrollController) {\n              rowsScrollController.setViewportPosition.apply(rowsScrollController, arguments).done(function () {\n                dataSource && dataSource.setViewportItemIndex(rowsScrollController.getViewportItemIndex());\n              });\n            } else {\n              dataSource && dataSource.setViewportPosition.apply(dataSource, arguments);\n            }\n          },\n          setContentSize: function setContentSize(sizes) {\n            var rowsScrollController = this._rowsScrollController;\n            rowsScrollController && rowsScrollController.setContentSize(sizes);\n            var dataSource = this._dataSource;\n            return dataSource && dataSource.setContentSize(sizes);\n          },\n          loadIfNeed: function loadIfNeed() {\n            var rowsScrollController = this._rowsScrollController;\n            rowsScrollController && rowsScrollController.loadIfNeed();\n            var dataSource = this._dataSource;\n            return dataSource && dataSource.loadIfNeed();\n          },\n          getItemSize: function getItemSize() {\n            var rowsScrollController = this._rowsScrollController;\n\n            if (rowsScrollController) {\n              return rowsScrollController.getItemSize.apply(rowsScrollController, arguments);\n            }\n\n            var dataSource = this._dataSource;\n            return dataSource && dataSource.getItemSize.apply(dataSource, arguments);\n          },\n          getItemSizes: function getItemSizes() {\n            var rowsScrollController = this._rowsScrollController;\n\n            if (rowsScrollController) {\n              return rowsScrollController.getItemSizes.apply(rowsScrollController, arguments);\n            }\n\n            var dataSource = this._dataSource;\n            return dataSource && dataSource.getItemSizes.apply(dataSource, arguments);\n          },\n          getContentOffset: function getContentOffset() {\n            var rowsScrollController = this._rowsScrollController;\n\n            if (rowsScrollController) {\n              return rowsScrollController.getContentOffset.apply(rowsScrollController, arguments);\n            }\n\n            var dataSource = this._dataSource;\n            return dataSource && dataSource.getContentOffset.apply(dataSource, arguments);\n          },\n          dispose: function dispose() {\n            var rowsScrollController = this._rowsScrollController;\n            rowsScrollController && rowsScrollController.dispose();\n            this.callBase.apply(this, arguments);\n          }\n        };\n\n        _uiGrid_core4.default.proxyMethod(members, \"virtualItemsCount\");\n\n        _uiGrid_core4.default.proxyMethod(members, \"getVirtualContentSize\");\n\n        _uiGrid_core4.default.proxyMethod(members, \"setViewportItemIndex\");\n\n        return members;\n      }(),\n      resizing: {\n        resize: function resize() {\n          var that = this;\n          var callBase = that.callBase;\n          var result;\n\n          if (!that.option(\"legacyRendering\") && (isVirtualMode(that) || isVirtualRowRendering(that))) {\n            clearTimeout(that._resizeTimeout);\n            var diff = new Date() - that._lastTime;\n            var updateTimeout = that.option(\"scrolling.updateTimeout\");\n\n            if (that._lastTime && diff < updateTimeout) {\n              result = new _deferred.Deferred();\n              that._resizeTimeout = setTimeout(function () {\n                callBase.apply(that).done(result.resolve).fail(result.reject);\n                that._lastTime = new Date();\n              }, updateTimeout);\n              that._lastTime = new Date();\n            } else {\n              result = callBase.apply(that);\n\n              if (that._dataController.isLoaded()) {\n                that._lastTime = new Date();\n              }\n            }\n          } else {\n            result = callBase.apply(that);\n          }\n\n          return result;\n        },\n        dispose: function dispose() {\n          this.callBase.apply(this, arguments);\n          clearTimeout(this._resizeTimeout);\n        }\n      }\n    },\n    views: {\n      rowsView: VirtualScrollingRowsViewExtender\n    }\n  }\n};","map":{"version":3,"sources":["C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/devextreme/ui/grid_core/ui.grid_core.virtual_scrolling.js"],"names":["_renderer","require","_renderer2","_interopRequireDefault","_window","_common","_uiGrid_core","_uiGrid_core2","_uiGrid_core3","_uiGrid_core4","_iterator","_deferred","_translator","_translator2","_load_indicator","_load_indicator2","obj","TABLE_CLASS","BOTTOM_LOAD_PANEL_CLASS","TABLE_CONTENT_CLASS","GROUP_SPACE_CLASS","CONTENT_CLASS","ROW_CLASS","FREESPACE_CLASS","COLUMN_LINES_CLASS","VIRTUAL_ROW_CLASS","SCROLLING_MODE_INFINITE","SCROLLING_MODE_VIRTUAL","SCROLLING_MODE_STANDARD","PIXELS_LIMIT","LOAD_TIMEOUT","isVirtualMode","that","isAppendMode","isVirtualRowRendering","rowRenderingMode","_correctCount","countCorrection","fromEnd","i","count","item","items","isItemCountableFunc","VirtualScrollingDataSourceAdapterExtender","_updateLoading","beginPageIndex","result","init","pageSize","totalItemsCount","hasKnownLastPage","pageIndex","dataSource","isLoading","pageCount","load","updateLoading","itemsCount","viewportItems","onChanged","changingDuration","_handleLoadingChanged","_handleLoadError","_handleDataChanged","callBase","_customizeRemoteOperations","operationTypes","options","isLoaded","resetPagesCache","_changeRowExpandCore","reload","virtualScrollController","d","delayDeferred","refresh","storeLoadOptions","isReload","dispose","VirtualScrollingRowsViewExtender","removeEmptyRows","getRowParent","tBodies","$emptyRows","rowCount","className","dataController","resizeHandler","scrollToPage","itemSize","itemSizes","itemIndex","scrollPosition","index","y","x","_scrollLeft","renderDelayedTemplates","_renderCore","startRenderTime","itemCount","e","viewportSize","_getRowElements","$rows","_renderContent","virtualItemsCount","tableElement","contentElement","_removeRowsElements","rowElements","errorHandlingController","$rowElement","_restoreErrorRow","editingController","rowOptions","editData","_updateContent","changeType","change","contentTable","$tBodies","$freeSpaceRowElements","_addVirtualRow","$virtualRow","_updateContentPosition","rowHeight","rowHeights","row","top","bottom","$tables","$virtualRows","isFixed","_updateScrollTopPosition","left","_updateContentPositionCore","$contentTable","virtualTable","contentHeight","isRenderVirtualTableContentRequired","_isTableLinesDisplaysCorrect","hasColumnLines","table","_isColumnElementsEqual","$columns","$virtualColumns","element","_renderVirtualTableContent","columns","html","freeSpaceCellsHtml","columnLinesClass","createFreeSpaceRowHtml","classes","classString","height","container","_getCellClasses","cssClass","column","isExpandColumn","_findBottomLoadPanel","$element","$contentElement","$bottomLoadPanel","_updateBottomLoading","scrollingMode","virtualMode","appendMode","showBottomLoading","bottomLoadPanelElement","_handleScroll","_needUpdateRowHeight","_updateRowHeight","viewportHeight","Math","updateFreeSpaceRowHeight","setLoading","hasBottomLoadPanel","_resizeCore","loadIfNeed","setColumnWidths","scrollable","$content","clearTimeout","module","defaultOptions","scrolling","timeout","updateTimeout","minTimeout","renderingThreshold","removeInvisiblePages","rowPageSize","mode","preloadEnabled","extenders","dataSourceAdapter","controllers","data","members","_refreshDataSource","baseResult","getRowPageSize","rowsScrollController","rowIndexOffset","rowIndex","component","rowElement","initVirtualRows","virtualRowsRendering","isItemCountable","correctCount","begin","skip","take","countableOnly","_updateItemsCore","_this","delta","visibleItems","isRefresh","newItem","_applyChange","removeCount","allItems","getRowIndexDelta","getRowIndexOffset","offset","viewportItemSize","setViewportPosition","setContentSize","getItemSize","getItemSizes","getContentOffset","resizing","resize","diff","setTimeout","views","rowsView"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/grid_core/ui.grid_core.virtual_scrolling.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar _renderer = require(\"../../core/renderer\");\r\nvar _renderer2 = _interopRequireDefault(_renderer);\r\nvar _window = require(\"../../core/utils/window\");\r\nvar _common = require(\"../../core/utils/common\");\r\nvar _uiGrid_core = require(\"./ui.grid_core.virtual_scrolling_core\");\r\nvar _uiGrid_core2 = _interopRequireDefault(_uiGrid_core);\r\nvar _uiGrid_core3 = require(\"./ui.grid_core.utils\");\r\nvar _uiGrid_core4 = _interopRequireDefault(_uiGrid_core3);\r\nvar _iterator = require(\"../../core/utils/iterator\");\r\nvar _deferred = require(\"../../core/utils/deferred\");\r\nvar _translator = require(\"../../animation/translator\");\r\nvar _translator2 = _interopRequireDefault(_translator);\r\nvar _load_indicator = require(\"../load_indicator\");\r\nvar _load_indicator2 = _interopRequireDefault(_load_indicator);\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\nvar TABLE_CLASS = \"table\";\r\nvar BOTTOM_LOAD_PANEL_CLASS = \"bottom-load-panel\";\r\nvar TABLE_CONTENT_CLASS = \"table-content\";\r\nvar GROUP_SPACE_CLASS = \"group-space\";\r\nvar CONTENT_CLASS = \"content\";\r\nvar ROW_CLASS = \"dx-row\";\r\nvar FREESPACE_CLASS = \"dx-freespace-row\";\r\nvar COLUMN_LINES_CLASS = \"dx-column-lines\";\r\nvar VIRTUAL_ROW_CLASS = \"dx-virtual-row\";\r\nvar SCROLLING_MODE_INFINITE = \"infinite\";\r\nvar SCROLLING_MODE_VIRTUAL = \"virtual\";\r\nvar SCROLLING_MODE_STANDARD = \"standard\";\r\nvar PIXELS_LIMIT = 25e4;\r\nvar LOAD_TIMEOUT = 300;\r\nvar isVirtualMode = function(that) {\r\n    return that.option(\"scrolling.mode\") === SCROLLING_MODE_VIRTUAL\r\n};\r\nvar isAppendMode = function(that) {\r\n    return that.option(\"scrolling.mode\") === SCROLLING_MODE_INFINITE\r\n};\r\nvar isVirtualRowRendering = function(that) {\r\n    var rowRenderingMode = that.option(\"scrolling.rowRenderingMode\");\r\n    if (rowRenderingMode === SCROLLING_MODE_VIRTUAL) {\r\n        return true\r\n    } else {\r\n        if (rowRenderingMode === SCROLLING_MODE_STANDARD) {\r\n            return false\r\n        }\r\n    }\r\n};\r\nvar _correctCount = function(items, count, fromEnd, isItemCountableFunc) {\r\n    var countCorrection = fromEnd ? 0 : 1;\r\n    for (var i = 0; i < count + countCorrection; i++) {\r\n        var item = items[fromEnd ? items.length - 1 - i : i];\r\n        if (item && !isItemCountableFunc(item, i === count)) {\r\n            count++\r\n        }\r\n    }\r\n    return count\r\n};\r\nvar VirtualScrollingDataSourceAdapterExtender = function() {\r\n    var _updateLoading = function(that) {\r\n        var beginPageIndex = that._virtualScrollController.beginPageIndex(-1);\r\n        if (isVirtualMode(that)) {\r\n            if (beginPageIndex < 0 || that.viewportSize() >= 0 && that.getViewportItemIndex() >= 0 && (beginPageIndex * that.pageSize() > that.getViewportItemIndex() || beginPageIndex * that.pageSize() + that.itemsCount() < that.getViewportItemIndex() + that.viewportSize()) && that._dataSource.isLoading()) {\r\n                if (!that._isLoading) {\r\n                    that._isLoading = true;\r\n                    that.loadingChanged.fire(true)\r\n                }\r\n            } else {\r\n                if (that._isLoading) {\r\n                    that._isLoading = false;\r\n                    that.loadingChanged.fire(false)\r\n                }\r\n            }\r\n        }\r\n    };\r\n    var result = {\r\n        init: function(dataSource) {\r\n            var that = this;\r\n            that.callBase.apply(that, arguments);\r\n            that._items = [];\r\n            that._isLoaded = true;\r\n            that._virtualScrollController = new _uiGrid_core2.default.VirtualScrollController(that.component, {\r\n                pageSize: function() {\r\n                    return that.pageSize()\r\n                },\r\n                totalItemsCount: function() {\r\n                    return that.totalItemsCount()\r\n                },\r\n                hasKnownLastPage: function() {\r\n                    return that.hasKnownLastPage()\r\n                },\r\n                pageIndex: function(index) {\r\n                    return dataSource.pageIndex(index)\r\n                },\r\n                isLoading: function() {\r\n                    return dataSource.isLoading() && !that.isCustomLoading()\r\n                },\r\n                pageCount: function() {\r\n                    return that.pageCount()\r\n                },\r\n                load: function() {\r\n                    return dataSource.load()\r\n                },\r\n                updateLoading: function() {\r\n                    _updateLoading(that)\r\n                },\r\n                itemsCount: function() {\r\n                    return that.itemsCount(true)\r\n                },\r\n                items: function() {\r\n                    return dataSource.items()\r\n                },\r\n                viewportItems: function(items) {\r\n                    if (items) {\r\n                        that._items = items\r\n                    }\r\n                    return that._items\r\n                },\r\n                onChanged: function(e) {\r\n                    that.changed.fire(e)\r\n                },\r\n                changingDuration: function(e) {\r\n                    if (that.isLoading()) {\r\n                        return LOAD_TIMEOUT\r\n                    }\r\n                    return that._renderTime || 0\r\n                }\r\n            })\r\n        },\r\n        _handleLoadingChanged: function(isLoading) {\r\n            var that = this;\r\n            if (!isVirtualMode(that)) {\r\n                that._isLoading = isLoading;\r\n                that.callBase.apply(that, arguments)\r\n            }\r\n            if (isLoading) {\r\n                that._startLoadTime = new Date\r\n            } else {\r\n                that._startLoadTime = void 0\r\n            }\r\n        },\r\n        _handleLoadError: function() {\r\n            var that = this;\r\n            that._isLoading = false;\r\n            that.loadingChanged.fire(false);\r\n            that.callBase.apply(that, arguments)\r\n        },\r\n        _handleDataChanged: function(e) {\r\n            var callBase = this.callBase.bind(this);\r\n            this._virtualScrollController.handleDataChanged(callBase, e)\r\n        },\r\n        _customizeRemoteOperations: function(options, isReload, operationTypes) {\r\n            var that = this;\r\n            if (!that.option(\"legacyRendering\") && isVirtualMode(that) && !(operationTypes.reload || isReload) && operationTypes.skip && that._renderTime < that.option(\"scrolling.renderingThreshold\")) {\r\n                options.delay = void 0\r\n            }\r\n            that.callBase.apply(that, arguments)\r\n        },\r\n        items: function() {\r\n            return this._items\r\n        },\r\n        itemsCount: function(isBase) {\r\n            if (isBase) {\r\n                return this.callBase()\r\n            }\r\n            return this._virtualScrollController.itemsCount()\r\n        },\r\n        load: function(loadOptions) {\r\n            if (loadOptions) {\r\n                return this.callBase(loadOptions)\r\n            }\r\n            return this._virtualScrollController.load()\r\n        },\r\n        isLoading: function() {\r\n            return this._isLoading\r\n        },\r\n        isLoaded: function() {\r\n            return this._dataSource.isLoaded() && this._isLoaded\r\n        },\r\n        resetPagesCache: function(isLiveUpdate) {\r\n            if (!isLiveUpdate) {\r\n                this._virtualScrollController.reset(true)\r\n            }\r\n            this.callBase.apply(this, arguments)\r\n        },\r\n        _changeRowExpandCore: function() {\r\n            var result = this.callBase.apply(this, arguments);\r\n            this.resetPagesCache();\r\n            _updateLoading(this);\r\n            return result\r\n        },\r\n        reload: function() {\r\n            this._dataSource.pageIndex(this.pageIndex());\r\n            var virtualScrollController = this._virtualScrollController;\r\n            if (virtualScrollController) {\r\n                var d = new _deferred.Deferred;\r\n                this.callBase.apply(this, arguments).done(function(r) {\r\n                    var delayDeferred = virtualScrollController._delayDeferred;\r\n                    if (delayDeferred) {\r\n                        delayDeferred.done(d.resolve).fail(d.reject)\r\n                    } else {\r\n                        d.resolve(r)\r\n                    }\r\n                }).fail(d.reject);\r\n                return d\r\n            } else {\r\n                return this.callBase.apply(this, arguments)\r\n            }\r\n        },\r\n        refresh: function(options, isReload, operationTypes) {\r\n            var that = this;\r\n            var storeLoadOptions = options.storeLoadOptions;\r\n            var dataSource = that._dataSource;\r\n            if (isReload || operationTypes.reload) {\r\n                that._virtualScrollController.reset();\r\n                dataSource.items().length = 0;\r\n                that._isLoaded = false;\r\n                _updateLoading(that);\r\n                that._isLoaded = true;\r\n                if (isAppendMode(that)) {\r\n                    that.pageIndex(0);\r\n                    dataSource.pageIndex(0);\r\n                    storeLoadOptions.pageIndex = 0;\r\n                    options.pageIndex = 0;\r\n                    storeLoadOptions.skip = 0\r\n                } else {\r\n                    dataSource.pageIndex(that.pageIndex());\r\n                    if (dataSource.paginate()) {\r\n                        options.pageIndex = that.pageIndex();\r\n                        storeLoadOptions.skip = that.pageIndex() * that.pageSize()\r\n                    }\r\n                }\r\n            }\r\n            return that.callBase.apply(that, arguments)\r\n        },\r\n        dispose: function() {\r\n            this._virtualScrollController.dispose();\r\n            this.callBase.apply(this, arguments)\r\n        }\r\n    };\r\n    [\"virtualItemsCount\", \"getContentOffset\", \"getVirtualContentSize\", \"setContentSize\", \"setViewportPosition\", \"getViewportItemIndex\", \"setViewportItemIndex\", \"getItemIndexByPosition\", \"viewportSize\", \"viewportItemSize\", \"getItemSize\", \"getItemSizes\", \"pageIndex\", \"beginPageIndex\", \"endPageIndex\", \"loadIfNeed\"].forEach(function(name) {\r\n        result[name] = function() {\r\n            var virtualScrollController = this._virtualScrollController;\r\n            return virtualScrollController[name].apply(virtualScrollController, arguments)\r\n        }\r\n    });\r\n    return result\r\n}();\r\nvar VirtualScrollingRowsViewExtender = function() {\r\n    var removeEmptyRows = function($emptyRows, className) {\r\n        var rowCount;\r\n        var getRowParent = function(row) {\r\n            return (0, _renderer2.default)(row).parent(\".\" + className).get(0)\r\n        };\r\n        var tBodies = $emptyRows.toArray().map(getRowParent).filter(function(row) {\r\n            return row\r\n        });\r\n        if (tBodies.length) {\r\n            $emptyRows = (0, _renderer2.default)(tBodies)\r\n        }\r\n        rowCount = className === FREESPACE_CLASS ? $emptyRows.length - 1 : $emptyRows.length;\r\n        for (var i = 0; i < rowCount; i++) {\r\n            $emptyRows.eq(i).remove()\r\n        }\r\n    };\r\n    return {\r\n        init: function() {\r\n            var that = this;\r\n            var dataController = that.getController(\"data\");\r\n            that.callBase();\r\n            dataController.pageChanged.add(function() {\r\n                that.scrollToPage(dataController.pageIndex())\r\n            });\r\n            if (!that.option(\"legacyRendering\") && dataController.pageIndex() > 0) {\r\n                var resizeHandler = function resizeHandler() {\r\n                    that.resizeCompleted.remove(resizeHandler);\r\n                    that.scrollToPage(dataController.pageIndex())\r\n                };\r\n                that.resizeCompleted.add(resizeHandler)\r\n            }\r\n        },\r\n        scrollToPage: function(pageIndex) {\r\n            var that = this;\r\n            var dataController = that._dataController;\r\n            var pageSize = dataController ? dataController.pageSize() : 0;\r\n            var scrollPosition;\r\n            if (isVirtualMode(that) || isAppendMode(that)) {\r\n                var itemSize = dataController.getItemSize();\r\n                var itemSizes = dataController.getItemSizes();\r\n                var itemIndex = pageIndex * pageSize;\r\n                scrollPosition = itemIndex * itemSize;\r\n                for (var index in itemSizes) {\r\n                    if (index <= itemIndex) {\r\n                        scrollPosition += itemSizes[index] - itemSize\r\n                    }\r\n                }\r\n            } else {\r\n                scrollPosition = 0\r\n            }\r\n            that.scrollTo({\r\n                y: scrollPosition,\r\n                x: that._scrollLeft\r\n            })\r\n        },\r\n        renderDelayedTemplates: function(e) {\r\n            this._updateContentPosition(true);\r\n            this.callBase.apply(this, arguments)\r\n        },\r\n        _renderCore: function(e) {\r\n            var that = this;\r\n            var dataSource;\r\n            var startRenderTime = new Date;\r\n            that.callBase.apply(that, arguments);\r\n            dataSource = that._dataController._dataSource;\r\n            if (dataSource && e) {\r\n                var itemCount = e.items ? e.items.length : 20;\r\n                var viewportSize = that._dataController.viewportSize() || 20;\r\n                if (isVirtualRowRendering(that)) {\r\n                    dataSource._renderTime = (new Date - startRenderTime) * viewportSize / itemCount\r\n                } else {\r\n                    dataSource._renderTime = new Date - startRenderTime\r\n                }\r\n            }\r\n        },\r\n        _getRowElements: function(tableElement) {\r\n            var $rows = this.callBase(tableElement);\r\n            return $rows && $rows.not(\".\" + VIRTUAL_ROW_CLASS)\r\n        },\r\n        _renderContent: function(contentElement, tableElement) {\r\n            var that = this;\r\n            var virtualItemsCount = that._dataController.virtualItemsCount();\r\n            if (virtualItemsCount && that.option(\"legacyRendering\")) {\r\n                if ((0, _window.hasWindow)()) {\r\n                    tableElement.addClass(that.addWidgetPrefix(TABLE_CONTENT_CLASS))\r\n                }\r\n                if (!contentElement.children().length) {\r\n                    contentElement.append(tableElement)\r\n                } else {\r\n                    contentElement.children().first().replaceWith(tableElement)\r\n                }\r\n                if (1 === contentElement.children(\"table\").length) {\r\n                    contentElement.append(that._createTable());\r\n                    that._contentHeight = 0\r\n                }\r\n                return contentElement\r\n            }\r\n            return that.callBase.apply(that, arguments)\r\n        },\r\n        _removeRowsElements: function(contentTable, removeCount, changeType) {\r\n            var rowElements = this._getRowElements(contentTable).toArray();\r\n            if (\"append\" === changeType) {\r\n                rowElements = rowElements.slice(0, removeCount)\r\n            } else {\r\n                rowElements = rowElements.slice(-removeCount)\r\n            }\r\n            var errorHandlingController = this.getController(\"errorHandling\");\r\n            rowElements.map(function(rowElement) {\r\n                var $rowElement = (0, _renderer2.default)(rowElement);\r\n                errorHandlingController && errorHandlingController.removeErrorRow($rowElement.next());\r\n                $rowElement.remove()\r\n            })\r\n        },\r\n        _restoreErrorRow: function(contentTable) {\r\n            var editingController = this.getController(\"editing\");\r\n            editingController && editingController.hasChanges() && this._getRowElements(contentTable).each(function(_, item) {\r\n                var rowOptions = (0, _renderer2.default)(item).data(\"options\");\r\n                if (rowOptions) {\r\n                    var editData = editingController.getEditDataByKey(rowOptions.key);\r\n                    editData && editingController._showErrorRow(editData)\r\n                }\r\n            })\r\n        },\r\n        _updateContent: function(tableElement, change) {\r\n            var that = this;\r\n            var contentTable;\r\n            var $freeSpaceRowElements;\r\n            var contentElement = that._findContentElement();\r\n            var changeType = change && change.changeType;\r\n            if (\"append\" === changeType || \"prepend\" === changeType) {\r\n                contentTable = contentElement.children().first();\r\n                var $tBodies = that._getBodies(tableElement);\r\n                if (!that.option(\"legacyRendering\") && 1 === $tBodies.length) {\r\n                    that._getBodies(contentTable)[\"append\" === changeType ? \"append\" : \"prepend\"]($tBodies.children())\r\n                } else {\r\n                    $tBodies[\"append\" === changeType ? \"appendTo\" : \"prependTo\"](contentTable)\r\n                }\r\n                tableElement.remove();\r\n                $freeSpaceRowElements = that._getFreeSpaceRowElements(contentTable);\r\n                removeEmptyRows($freeSpaceRowElements, FREESPACE_CLASS);\r\n                if (change.removeCount) {\r\n                    that._removeRowsElements(contentTable, change.removeCount, changeType)\r\n                }\r\n                that._restoreErrorRow(contentTable)\r\n            } else {\r\n                that.callBase.apply(that, arguments)\r\n            }\r\n            that._updateBottomLoading()\r\n        },\r\n        _addVirtualRow: function($table, isFixed, location, position) {\r\n            if (!position) {\r\n                return\r\n            }\r\n            var $virtualRow = this._createEmptyRow(VIRTUAL_ROW_CLASS, isFixed, position);\r\n            $virtualRow = this._wrapRowIfNeed($table, $virtualRow);\r\n            this._appendEmptyRow($table, $virtualRow, location)\r\n        },\r\n        _updateContentPosition: function(isRender) {\r\n            var that = this;\r\n            var dataController = that._dataController;\r\n            var rowHeight = that._rowHeight || 20;\r\n            dataController.viewportItemSize(rowHeight);\r\n            if (!that.option(\"legacyRendering\") && (isVirtualMode(that) || isVirtualRowRendering(that))) {\r\n                if (!isRender) {\r\n                    var rowHeights = that._getRowElements(that._tableElement).toArray().map(function(row) {\r\n                        return row.getBoundingClientRect().height\r\n                    });\r\n                    dataController.setContentSize(rowHeights)\r\n                }\r\n                var top = dataController.getContentOffset(\"begin\");\r\n                var bottom = dataController.getContentOffset(\"end\");\r\n                var $tables = that.getTableElements();\r\n                var $virtualRows = $tables.children(\"tbody\").children(\".\" + VIRTUAL_ROW_CLASS);\r\n                removeEmptyRows($virtualRows, VIRTUAL_ROW_CLASS);\r\n                $tables.each(function(index) {\r\n                    var isFixed = index > 0;\r\n                    that._isFixedTableRendering = isFixed;\r\n                    that._addVirtualRow((0, _renderer2.default)(this), isFixed, \"top\", top);\r\n                    that._addVirtualRow((0, _renderer2.default)(this), isFixed, \"bottom\", bottom);\r\n                    that._isFixedTableRendering = false\r\n                });\r\n                !isRender && that._updateScrollTopPosition(top)\r\n            } else {\r\n                (0, _common.deferUpdate)(function() {\r\n                    that._updateContentPositionCore()\r\n                })\r\n            }\r\n        },\r\n        _updateScrollTopPosition: function(top) {\r\n            if (this._scrollTop < top && !this._isScrollByEvent && this._dataController.pageIndex() > 0) {\r\n                this.scrollTo({\r\n                    top: top,\r\n                    left: this._scrollLeft\r\n                })\r\n            }\r\n        },\r\n        _updateContentPositionCore: function() {\r\n            var that = this;\r\n            var contentElement;\r\n            var contentHeight;\r\n            var top;\r\n            var $tables;\r\n            var $contentTable;\r\n            var virtualTable;\r\n            var rowHeight = that._rowHeight || 20;\r\n            var virtualItemsCount = that._dataController.virtualItemsCount();\r\n            var isRenderVirtualTableContentRequired;\r\n            if (virtualItemsCount) {\r\n                contentElement = that._findContentElement();\r\n                $tables = contentElement.children();\r\n                $contentTable = $tables.eq(0);\r\n                virtualTable = $tables.eq(1);\r\n                that._contentTableHeight = $contentTable[0].offsetHeight;\r\n                that._dataController.viewportItemSize(rowHeight);\r\n                that._dataController.setContentSize(that._contentTableHeight);\r\n                contentHeight = that._dataController.getVirtualContentSize();\r\n                top = that._dataController.getContentOffset();\r\n                (0, _common.deferRender)(function() {\r\n                    _translator2.default.move($contentTable, {\r\n                        left: 0,\r\n                        top: top\r\n                    });\r\n                    isRenderVirtualTableContentRequired = that._contentHeight !== contentHeight || 0 === contentHeight || !that._isTableLinesDisplaysCorrect(virtualTable) || !that._isColumnElementsEqual($contentTable.find(\"col\"), virtualTable.find(\"col\"));\r\n                    if (isRenderVirtualTableContentRequired) {\r\n                        that._contentHeight = contentHeight;\r\n                        that._renderVirtualTableContent(virtualTable, contentHeight)\r\n                    }\r\n                    that._updateScrollTopPosition(top)\r\n                })\r\n            }\r\n        },\r\n        _isTableLinesDisplaysCorrect: function(table) {\r\n            var hasColumnLines = table.find(\".\" + COLUMN_LINES_CLASS).length > 0;\r\n            return hasColumnLines === this.option(\"showColumnLines\")\r\n        },\r\n        _isColumnElementsEqual: function($columns, $virtualColumns) {\r\n            var result = $columns.length === $virtualColumns.length;\r\n            if (result) {\r\n                (0, _iterator.each)($columns, function(index, element) {\r\n                    if (element.style.width !== $virtualColumns[index].style.width) {\r\n                        result = false;\r\n                        return result\r\n                    }\r\n                })\r\n            }\r\n            return result\r\n        },\r\n        _renderVirtualTableContent: function(container, height) {\r\n            var that = this;\r\n            var columns = that._columnsController.getVisibleColumns();\r\n            var html = that._createColGroup(columns).prop(\"outerHTML\");\r\n            var freeSpaceCellsHtml = \"\";\r\n            var i;\r\n            var columnLinesClass = that.option(\"showColumnLines\") ? COLUMN_LINES_CLASS : \"\";\r\n            var createFreeSpaceRowHtml = function(height) {\r\n                return \"<tr style='height:\" + height + \"px;' class='\" + FREESPACE_CLASS + \" \" + ROW_CLASS + \" \" + columnLinesClass + \"' >\" + freeSpaceCellsHtml + \"</tr>\"\r\n            };\r\n            for (i = 0; i < columns.length; i++) {\r\n                var classes = that._getCellClasses(columns[i]);\r\n                var classString = classes.length ? \" class='\" + classes.join(\" \") + \"'\" : \"\";\r\n                freeSpaceCellsHtml += \"<td\" + classString + \"/>\"\r\n            }\r\n            while (height > PIXELS_LIMIT) {\r\n                html += createFreeSpaceRowHtml(PIXELS_LIMIT);\r\n                height -= PIXELS_LIMIT\r\n            }\r\n            html += createFreeSpaceRowHtml(height);\r\n            container.addClass(that.addWidgetPrefix(TABLE_CLASS));\r\n            container.html(html)\r\n        },\r\n        _getCellClasses: function(column) {\r\n            var classes = [];\r\n            var cssClass = column.cssClass;\r\n            var isExpandColumn = \"expand\" === column.command;\r\n            cssClass && classes.push(cssClass);\r\n            isExpandColumn && classes.push(this.addWidgetPrefix(GROUP_SPACE_CLASS));\r\n            return classes\r\n        },\r\n        _findBottomLoadPanel: function($contentElement) {\r\n            var $element = $contentElement || this.element();\r\n            var $bottomLoadPanel = $element && $element.find(\".\" + this.addWidgetPrefix(BOTTOM_LOAD_PANEL_CLASS));\r\n            if ($bottomLoadPanel && $bottomLoadPanel.length) {\r\n                return $bottomLoadPanel\r\n            }\r\n        },\r\n        _updateBottomLoading: function() {\r\n            var that = this;\r\n            var scrollingMode = that.option(\"scrolling.mode\");\r\n            var virtualMode = scrollingMode === SCROLLING_MODE_VIRTUAL;\r\n            var appendMode = scrollingMode === SCROLLING_MODE_INFINITE;\r\n            var showBottomLoading = !that._dataController.hasKnownLastPage() && that._dataController.isLoaded() && (virtualMode || appendMode);\r\n            var $contentElement = that._findContentElement();\r\n            var bottomLoadPanelElement = that._findBottomLoadPanel($contentElement);\r\n            if (showBottomLoading) {\r\n                if (!bottomLoadPanelElement) {\r\n                    (0, _renderer2.default)(\"<div>\").addClass(that.addWidgetPrefix(BOTTOM_LOAD_PANEL_CLASS)).append(that._createComponent((0, _renderer2.default)(\"<div>\"), _load_indicator2.default).$element()).appendTo($contentElement)\r\n                }\r\n            } else {\r\n                if (bottomLoadPanelElement) {\r\n                    bottomLoadPanelElement.remove()\r\n                }\r\n            }\r\n        },\r\n        _handleScroll: function(e) {\r\n            var that = this;\r\n            if (that._hasHeight && that._rowHeight) {\r\n                that._dataController.setViewportPosition(e.scrollOffset.top)\r\n            }\r\n            that.callBase.apply(that, arguments)\r\n        },\r\n        _needUpdateRowHeight: function(itemsCount) {\r\n            var that = this;\r\n            return that.callBase.apply(that, arguments) || itemsCount > 0 && that.option(\"scrolling.mode\") === SCROLLING_MODE_INFINITE && that.option(\"scrolling.rowRenderingMode\") !== SCROLLING_MODE_VIRTUAL\r\n        },\r\n        _updateRowHeight: function() {\r\n            var that = this;\r\n            var viewportHeight;\r\n            that.callBase.apply(that, arguments);\r\n            if (that._rowHeight) {\r\n                that._updateContentPosition();\r\n                viewportHeight = that._hasHeight ? that.element().outerHeight() : (0, _renderer2.default)((0, _window.getWindow)()).outerHeight();\r\n                that._dataController.viewportSize(Math.ceil(viewportHeight / that._rowHeight))\r\n            }\r\n        },\r\n        updateFreeSpaceRowHeight: function() {\r\n            var result = this.callBase.apply(this, arguments);\r\n            if (result) {\r\n                this._updateContentPosition()\r\n            }\r\n            return result\r\n        },\r\n        setLoading: function(isLoading, messageText) {\r\n            var that = this;\r\n            var callBase = that.callBase;\r\n            var dataController = that._dataController;\r\n            var hasBottomLoadPanel = dataController.pageIndex() > 0 && dataController.isLoaded() && !!that._findBottomLoadPanel();\r\n            if (hasBottomLoadPanel) {\r\n                isLoading = false\r\n            }\r\n            callBase.call(that, isLoading, messageText)\r\n        },\r\n        _resizeCore: function() {\r\n            var that = this;\r\n            var $element = that.element();\r\n            that.callBase();\r\n            if (that.component.$element() && !that._windowScroll && $element.closest((0, _window.getWindow)().document).length) {\r\n                that._windowScroll = _uiGrid_core2.default.subscribeToExternalScrollers($element, function(scrollPos) {\r\n                    if (!that._hasHeight && that._rowHeight) {\r\n                        that._dataController.setViewportPosition(scrollPos)\r\n                    }\r\n                }, that.component.$element());\r\n                that.on(\"disposing\", function() {\r\n                    that._windowScroll.dispose()\r\n                })\r\n            }\r\n            that.loadIfNeed()\r\n        },\r\n        loadIfNeed: function() {\r\n            var dataController = this._dataController;\r\n            if (dataController && dataController.loadIfNeed) {\r\n                dataController.loadIfNeed()\r\n            }\r\n        },\r\n        setColumnWidths: function(widths) {\r\n            var scrollable = this.getScrollable();\r\n            var $content;\r\n            this.callBase.apply(this, arguments);\r\n            if (\"virtual\" === this.option(\"scrolling.mode\")) {\r\n                $content = scrollable ? scrollable.$content() : this.element();\r\n                this.callBase(widths, $content.children(\".\" + this.addWidgetPrefix(CONTENT_CLASS)).children(\":not(.\" + this.addWidgetPrefix(TABLE_CONTENT_CLASS) + \")\"))\r\n            }\r\n        },\r\n        dispose: function() {\r\n            clearTimeout(this._scrollTimeoutID);\r\n            this.callBase()\r\n        }\r\n    }\r\n}();\r\nmodule.exports = {\r\n    defaultOptions: function() {\r\n        return {\r\n            scrolling: {\r\n                timeout: 300,\r\n                updateTimeout: 300,\r\n                minTimeout: 0,\r\n                renderingThreshold: 100,\r\n                removeInvisiblePages: true,\r\n                rowPageSize: 5,\r\n                mode: \"standard\",\r\n                preloadEnabled: false,\r\n                rowRenderingMode: \"standard\"\r\n            }\r\n        }\r\n    },\r\n    extenders: {\r\n        dataSourceAdapter: VirtualScrollingDataSourceAdapterExtender,\r\n        controllers: {\r\n            data: function() {\r\n                var members = {\r\n                    _refreshDataSource: function() {\r\n                        var baseResult = this.callBase.apply(this, arguments) || (new _deferred.Deferred).resolve().promise();\r\n                        baseResult.done(this.initVirtualRows.bind(this));\r\n                        return baseResult\r\n                    },\r\n                    getRowPageSize: function() {\r\n                        var rowPageSize = this.option(\"scrolling.rowPageSize\");\r\n                        var pageSize = this.pageSize();\r\n                        return pageSize && pageSize < rowPageSize ? pageSize : rowPageSize\r\n                    },\r\n                    reload: function() {\r\n                        var that = this;\r\n                        var rowsScrollController = that._rowsScrollController || that._dataSource;\r\n                        var itemIndex = rowsScrollController && rowsScrollController.getItemIndexByPosition();\r\n                        var result = this.callBase.apply(this, arguments);\r\n                        return result && result.done(function() {\r\n                            if (isVirtualMode(that) || isVirtualRowRendering(that)) {\r\n                                var rowIndexOffset = that.getRowIndexOffset();\r\n                                var rowIndex = Math.floor(itemIndex) - rowIndexOffset;\r\n                                var component = that.component;\r\n                                var scrollable = component.getScrollable && component.getScrollable();\r\n                                if (scrollable && !that.option(\"legacyRendering\")) {\r\n                                    var rowElement = component.getRowElement(rowIndex);\r\n                                    var $rowElement = rowElement && rowElement[0] && (0, _renderer2.default)(rowElement[0]);\r\n                                    var top = $rowElement && $rowElement.position().top;\r\n                                    if (top > 0) {\r\n                                        top = Math.round(top + $rowElement.outerHeight() * (itemIndex % 1));\r\n                                        scrollable.scrollTo({\r\n                                            y: top\r\n                                        })\r\n                                    }\r\n                                }\r\n                            }\r\n                        })\r\n                    },\r\n                    initVirtualRows: function() {\r\n                        var that = this;\r\n                        var virtualRowsRendering = isVirtualRowRendering(that);\r\n                        if (\"virtual\" !== that.option(\"scrolling.mode\") && true !== virtualRowsRendering || false === virtualRowsRendering || that.option(\"legacyRendering\") || !that.option(\"scrolling.rowPageSize\")) {\r\n                            that._visibleItems = null;\r\n                            that._rowsScrollController = null;\r\n                            return\r\n                        }\r\n                        that._rowPageIndex = Math.ceil(that.pageIndex() * that.pageSize() / that.getRowPageSize());\r\n                        that._visibleItems = [];\r\n                        var isItemCountable = function(item) {\r\n                            return \"data\" === item.rowType && !item.isNewRow || \"group\" === item.rowType && that._dataSource.isGroupItemCountable(item.data)\r\n                        };\r\n                        that._rowsScrollController = new _uiGrid_core2.default.VirtualScrollController(that.component, {\r\n                            pageSize: function() {\r\n                                return that.getRowPageSize()\r\n                            },\r\n                            totalItemsCount: function() {\r\n                                return isVirtualMode(that) ? that.totalItemsCount() : that._items.filter(isItemCountable).length\r\n                            },\r\n                            hasKnownLastPage: function() {\r\n                                return true\r\n                            },\r\n                            pageIndex: function(index) {\r\n                                if (void 0 !== index) {\r\n                                    that._rowPageIndex = index\r\n                                }\r\n                                return that._rowPageIndex\r\n                            },\r\n                            isLoading: function() {\r\n                                return that.isLoading()\r\n                            },\r\n                            pageCount: function pageCount() {\r\n                                var pageCount = Math.ceil(this.totalItemsCount() / this.pageSize());\r\n                                return pageCount ? pageCount : 1\r\n                            },\r\n                            load: function() {\r\n                                if (that._rowsScrollController.pageIndex() >= this.pageCount()) {\r\n                                    that._rowPageIndex = this.pageCount() - 1;\r\n                                    that._rowsScrollController.pageIndex(that._rowPageIndex)\r\n                                }\r\n                                if (!that._rowsScrollController._dataSource.items().length && this.totalItemsCount()) {\r\n                                    return\r\n                                }\r\n                                that._rowsScrollController.handleDataChanged(function(change) {\r\n                                    change = change || {};\r\n                                    change.changeType = change.changeType || \"refresh\";\r\n                                    change.items = change.items || that._visibleItems;\r\n                                    that._visibleItems.forEach(function(item, index) {\r\n                                        item.rowIndex = index\r\n                                    });\r\n                                    that._fireChanged(change)\r\n                                })\r\n                            },\r\n                            updateLoading: function() {},\r\n                            itemsCount: function() {\r\n                                return that._rowsScrollController._dataSource.items().filter(isItemCountable).length\r\n                            },\r\n                            correctCount: function(items, count, fromEnd) {\r\n                                return _correctCount(items, count, fromEnd, isItemCountable)\r\n                            },\r\n                            items: function(countableOnly) {\r\n                                var dataSource = that.dataSource();\r\n                                var virtualItemsCount = dataSource && dataSource.virtualItemsCount();\r\n                                var begin = virtualItemsCount ? virtualItemsCount.begin : 0;\r\n                                var rowPageSize = that.getRowPageSize();\r\n                                var skip = that._rowPageIndex * rowPageSize - begin;\r\n                                var take = rowPageSize;\r\n                                var result = that._items;\r\n                                if (skip < 0) {\r\n                                    return []\r\n                                }\r\n                                if (skip) {\r\n                                    skip = this.correctCount(result, skip);\r\n                                    result = result.slice(skip)\r\n                                }\r\n                                if (take) {\r\n                                    take = this.correctCount(result, take);\r\n                                    result = result.slice(0, take)\r\n                                }\r\n                                return countableOnly ? result.filter(isItemCountable) : result\r\n                            },\r\n                            viewportItems: function(items) {\r\n                                if (items) {\r\n                                    that._visibleItems = items\r\n                                }\r\n                                return that._visibleItems\r\n                            },\r\n                            onChanged: function() {},\r\n                            changingDuration: function(e) {\r\n                                var dataSource = that.dataSource();\r\n                                if (dataSource.isLoading()) {\r\n                                    return LOAD_TIMEOUT\r\n                                }\r\n                                return dataSource && dataSource._renderTime || 0\r\n                            }\r\n                        }, true);\r\n                        if (that.isLoaded()) {\r\n                            that._rowsScrollController.load()\r\n                        }\r\n                    },\r\n                    _updateItemsCore: function(change) {\r\n                        var _this = this;\r\n                        var delta = this.getRowIndexDelta();\r\n                        this.callBase.apply(this, arguments);\r\n                        var rowsScrollController = this._rowsScrollController;\r\n                        if (rowsScrollController) {\r\n                            var visibleItems = this._visibleItems;\r\n                            var isRefresh = \"refresh\" === change.changeType || change.isLiveUpdate;\r\n                            if (\"append\" === change.changeType && change.items && !change.items.length) {\r\n                                return\r\n                            }\r\n                            if (isRefresh || \"append\" === change.changeType || \"prepend\" === change.changeType) {\r\n                                change.cancel = true;\r\n                                isRefresh && rowsScrollController.reset(true);\r\n                                rowsScrollController.load()\r\n                            } else {\r\n                                if (\"update\" === change.changeType) {\r\n                                    change.rowIndices.forEach(function(rowIndex, index) {\r\n                                        var changeType = change.changeTypes[index];\r\n                                        var newItem = change.items[index];\r\n                                        if (\"update\" === changeType) {\r\n                                            visibleItems[rowIndex] = newItem\r\n                                        } else {\r\n                                            if (\"insert\" === changeType) {\r\n                                                visibleItems.splice(rowIndex, 0, newItem)\r\n                                            } else {\r\n                                                if (\"remove\" === changeType) {\r\n                                                    visibleItems.splice(rowIndex, 1)\r\n                                                }\r\n                                            }\r\n                                        }\r\n                                    })\r\n                                } else {\r\n                                    visibleItems.forEach(function(item, index) {\r\n                                        visibleItems[index] = _this._items[index + delta] || visibleItems[index]\r\n                                    });\r\n                                    change.items = visibleItems\r\n                                }\r\n                                visibleItems.forEach(function(item, index) {\r\n                                    item.rowIndex = index\r\n                                })\r\n                            }\r\n                        }\r\n                    },\r\n                    _applyChange: function(change) {\r\n                        var that = this;\r\n                        var items = change.items;\r\n                        var changeType = change.changeType;\r\n                        var removeCount = change.removeCount;\r\n                        if (removeCount) {\r\n                            var fromEnd = \"prepend\" === changeType;\r\n                            removeCount = _correctCount(that._items, removeCount, fromEnd, function(item, isNextAfterLast) {\r\n                                return \"data\" === item.rowType && !item.isNewRow || \"group\" === item.rowType && (that._dataSource.isGroupItemCountable(item.data) || isNextAfterLast)\r\n                            });\r\n                            change.removeCount = removeCount\r\n                        }\r\n                        switch (changeType) {\r\n                            case \"prepend\":\r\n                                that._items.unshift.apply(that._items, items);\r\n                                if (removeCount) {\r\n                                    that._items.splice(-removeCount)\r\n                                }\r\n                                break;\r\n                            case \"append\":\r\n                                that._items.push.apply(that._items, items);\r\n                                if (removeCount) {\r\n                                    that._items.splice(0, removeCount)\r\n                                }\r\n                                break;\r\n                            default:\r\n                                that.callBase(change)\r\n                        }\r\n                    },\r\n                    items: function(allItems) {\r\n                        return allItems ? this._items : this._visibleItems || this._items\r\n                    },\r\n                    getRowIndexDelta: function() {\r\n                        var visibleItems = this._visibleItems;\r\n                        var delta = 0;\r\n                        if (visibleItems && visibleItems[0]) {\r\n                            delta = this._items.indexOf(visibleItems[0])\r\n                        }\r\n                        return delta < 0 ? 0 : delta\r\n                    },\r\n                    getRowIndexOffset: function() {\r\n                        var offset = 0;\r\n                        var dataSource = this.dataSource();\r\n                        var rowsScrollController = this._rowsScrollController;\r\n                        if (rowsScrollController) {\r\n                            offset = rowsScrollController.beginPageIndex() * rowsScrollController._dataSource.pageSize()\r\n                        } else {\r\n                            if (\"virtual\" === this.option(\"scrolling.mode\") && dataSource) {\r\n                                offset = dataSource.beginPageIndex() * dataSource.pageSize()\r\n                            }\r\n                        }\r\n                        return offset\r\n                    },\r\n                    viewportSize: function() {\r\n                        var rowsScrollController = this._rowsScrollController;\r\n                        rowsScrollController && rowsScrollController.viewportSize.apply(rowsScrollController, arguments);\r\n                        var dataSource = this._dataSource;\r\n                        return dataSource && dataSource.viewportSize.apply(dataSource, arguments)\r\n                    },\r\n                    viewportItemSize: function() {\r\n                        var rowsScrollController = this._rowsScrollController;\r\n                        rowsScrollController && rowsScrollController.viewportItemSize.apply(rowsScrollController, arguments);\r\n                        var dataSource = this._dataSource;\r\n                        return dataSource && dataSource.viewportItemSize.apply(dataSource, arguments)\r\n                    },\r\n                    setViewportPosition: function() {\r\n                        var rowsScrollController = this._rowsScrollController;\r\n                        var dataSource = this._dataSource;\r\n                        if (rowsScrollController) {\r\n                            rowsScrollController.setViewportPosition.apply(rowsScrollController, arguments).done(function() {\r\n                                dataSource && dataSource.setViewportItemIndex(rowsScrollController.getViewportItemIndex())\r\n                            })\r\n                        } else {\r\n                            dataSource && dataSource.setViewportPosition.apply(dataSource, arguments)\r\n                        }\r\n                    },\r\n                    setContentSize: function(sizes) {\r\n                        var rowsScrollController = this._rowsScrollController;\r\n                        rowsScrollController && rowsScrollController.setContentSize(sizes);\r\n                        var dataSource = this._dataSource;\r\n                        return dataSource && dataSource.setContentSize(sizes)\r\n                    },\r\n                    loadIfNeed: function() {\r\n                        var rowsScrollController = this._rowsScrollController;\r\n                        rowsScrollController && rowsScrollController.loadIfNeed();\r\n                        var dataSource = this._dataSource;\r\n                        return dataSource && dataSource.loadIfNeed()\r\n                    },\r\n                    getItemSize: function() {\r\n                        var rowsScrollController = this._rowsScrollController;\r\n                        if (rowsScrollController) {\r\n                            return rowsScrollController.getItemSize.apply(rowsScrollController, arguments)\r\n                        }\r\n                        var dataSource = this._dataSource;\r\n                        return dataSource && dataSource.getItemSize.apply(dataSource, arguments)\r\n                    },\r\n                    getItemSizes: function() {\r\n                        var rowsScrollController = this._rowsScrollController;\r\n                        if (rowsScrollController) {\r\n                            return rowsScrollController.getItemSizes.apply(rowsScrollController, arguments)\r\n                        }\r\n                        var dataSource = this._dataSource;\r\n                        return dataSource && dataSource.getItemSizes.apply(dataSource, arguments)\r\n                    },\r\n                    getContentOffset: function() {\r\n                        var rowsScrollController = this._rowsScrollController;\r\n                        if (rowsScrollController) {\r\n                            return rowsScrollController.getContentOffset.apply(rowsScrollController, arguments)\r\n                        }\r\n                        var dataSource = this._dataSource;\r\n                        return dataSource && dataSource.getContentOffset.apply(dataSource, arguments)\r\n                    },\r\n                    dispose: function() {\r\n                        var rowsScrollController = this._rowsScrollController;\r\n                        rowsScrollController && rowsScrollController.dispose();\r\n                        this.callBase.apply(this, arguments)\r\n                    }\r\n                };\r\n                _uiGrid_core4.default.proxyMethod(members, \"virtualItemsCount\");\r\n                _uiGrid_core4.default.proxyMethod(members, \"getVirtualContentSize\");\r\n                _uiGrid_core4.default.proxyMethod(members, \"setViewportItemIndex\");\r\n                return members\r\n            }(),\r\n            resizing: {\r\n                resize: function() {\r\n                    var that = this;\r\n                    var callBase = that.callBase;\r\n                    var result;\r\n                    if (!that.option(\"legacyRendering\") && (isVirtualMode(that) || isVirtualRowRendering(that))) {\r\n                        clearTimeout(that._resizeTimeout);\r\n                        var diff = new Date - that._lastTime;\r\n                        var updateTimeout = that.option(\"scrolling.updateTimeout\");\r\n                        if (that._lastTime && diff < updateTimeout) {\r\n                            result = new _deferred.Deferred;\r\n                            that._resizeTimeout = setTimeout(function() {\r\n                                callBase.apply(that).done(result.resolve).fail(result.reject);\r\n                                that._lastTime = new Date\r\n                            }, updateTimeout);\r\n                            that._lastTime = new Date\r\n                        } else {\r\n                            result = callBase.apply(that);\r\n                            if (that._dataController.isLoaded()) {\r\n                                that._lastTime = new Date\r\n                            }\r\n                        }\r\n                    } else {\r\n                        result = callBase.apply(that)\r\n                    }\r\n                    return result\r\n                },\r\n                dispose: function() {\r\n                    this.callBase.apply(this, arguments);\r\n                    clearTimeout(this._resizeTimeout)\r\n                }\r\n            }\r\n        },\r\n        views: {\r\n            rowsView: VirtualScrollingRowsViewExtender\r\n        }\r\n    }\r\n};\r\n"]},"metadata":{},"sourceType":"module"}