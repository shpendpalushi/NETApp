{"ast":null,"code":"/**\r\n * DevExtreme (ui/select_box.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar $ = require(\"../core/renderer\");\n\nvar commonUtils = require(\"../core/utils/common\");\n\nvar typeUtils = require(\"../core/utils/type\");\n\nvar isDefined = typeUtils.isDefined;\nvar isPromise = typeUtils.isPromise;\n\nvar extend = require(\"../core/utils/extend\").extend;\n\nvar inArray = require(\"../core/utils/array\").inArray;\n\nvar each = require(\"../core/utils/iterator\").each;\n\nvar deferredUtils = require(\"../core/utils/deferred\");\n\nvar getPublicElement = require(\"../core/utils/dom\").getPublicElement;\n\nvar Deferred = deferredUtils.Deferred;\n\nvar errors = require(\"../core/errors\");\n\nvar domAdapter = require(\"../core/dom_adapter\");\n\nvar inkRipple = require(\"./widget/utils.ink_ripple\");\n\nvar messageLocalization = require(\"../localization/message\");\n\nvar registerComponent = require(\"../core/component_registrator\");\n\nvar DropDownList = require(\"./drop_down_editor/ui.drop_down_list\");\n\nvar DISABLED_STATE_SELECTOR = \".dx-state-disabled\";\nvar SELECTBOX_CLASS = \"dx-selectbox\";\nvar SELECTBOX_POPUP_CLASS = \"dx-selectbox-popup\";\nvar SELECTBOX_CONTAINER_CLASS = \"dx-selectbox-container\";\nvar SELECTBOX_POPUP_WRAPPER_CLASS = \"dx-selectbox-popup-wrapper\";\nvar SelectBox = DropDownList.inherit({\n  _supportedKeys: function _supportedKeys() {\n    var that = this;\n    var parent = this.callBase();\n\n    var clearSelectBox = function clearSelectBox(e) {\n      var isEditable = this._isEditable();\n\n      if (!isEditable) {\n        if (this.option(\"showClearButton\")) {\n          e.preventDefault();\n          this.reset();\n        }\n      } else {\n        if (this._valueSubstituted()) {\n          this._preventFiltering = true;\n        }\n      }\n\n      this._preventSubstitution = true;\n    };\n\n    var searchIfNeeded = function searchIfNeeded() {\n      if (that.option(\"searchEnabled\") && that._valueSubstituted()) {\n        that._searchHandler();\n      }\n    };\n\n    return extend({}, parent, {\n      tab: function tab() {\n        if (this.option(\"opened\") && \"instantly\" === this.option(\"applyValueMode\")) {\n          this._cleanInputSelection();\n        }\n\n        if (this._wasSearch()) {\n          this._clearFilter();\n        }\n\n        parent.tab && parent.tab.apply(this, arguments);\n      },\n      upArrow: function upArrow(e) {\n        if (parent.upArrow && parent.upArrow.apply(this, arguments)) {\n          if (!this.option(\"opened\")) {\n            this._setNextValue(e);\n          }\n\n          return true;\n        }\n      },\n      downArrow: function downArrow(e) {\n        if (parent.downArrow && parent.downArrow.apply(this, arguments)) {\n          if (!this.option(\"opened\")) {\n            this._setNextValue(e);\n          }\n\n          return true;\n        }\n      },\n      leftArrow: function leftArrow() {\n        searchIfNeeded();\n        parent.leftArrow && parent.leftArrow.apply(this, arguments);\n      },\n      rightArrow: function rightArrow() {\n        searchIfNeeded();\n        parent.rightArrow && parent.rightArrow.apply(this, arguments);\n      },\n      home: function home() {\n        searchIfNeeded();\n        parent.home && parent.home.apply(this, arguments);\n      },\n      end: function end() {\n        searchIfNeeded();\n        parent.end && parent.end.apply(this, arguments);\n      },\n      escape: function escape() {\n        var result = parent.escape && parent.escape.apply(this, arguments);\n\n        this._cancelEditing();\n\n        return isDefined(result) ? result : true;\n      },\n      enter: function enter(e) {\n        var isOpened = this.option(\"opened\");\n\n        var inputText = this._input().val().trim();\n\n        var isCustomText = inputText && this._list && !this._list.option(\"focusedElement\");\n\n        if (!inputText && this.option(\"value\") && this.option(\"allowClearing\")) {\n          this.option({\n            selectedItem: null,\n            value: null\n          });\n          this.close();\n        } else {\n          if (this.option(\"acceptCustomValue\")) {\n            e.preventDefault();\n\n            if (isCustomText) {\n              this._valueChangeEventHandler(e);\n\n              if (isOpened) {\n                this._toggleOpenState();\n              }\n            }\n\n            return isOpened;\n          }\n\n          if (parent.enter && parent.enter.apply(this, arguments)) {\n            return isOpened;\n          }\n        }\n      },\n      space: function space(e) {\n        var isOpened = this.option(\"opened\");\n        var isSearchEnabled = this.option(\"searchEnabled\");\n        var acceptCustomValue = this.option(\"acceptCustomValue\");\n\n        if (!isOpened || isSearchEnabled || acceptCustomValue) {\n          return;\n        }\n\n        e.preventDefault();\n\n        this._valueChangeEventHandler(e);\n\n        return true;\n      },\n      backspace: clearSelectBox,\n      del: clearSelectBox\n    });\n  },\n  _getDefaultOptions: function _getDefaultOptions() {\n    return extend(this.callBase(), {\n      placeholder: messageLocalization.format(\"Select\"),\n      fieldTemplate: null,\n      valueChangeEvent: \"change\",\n      acceptCustomValue: false,\n      onCustomItemCreating: function onCustomItemCreating(e) {\n        if (!isDefined(e.customItem)) {\n          e.customItem = e.text;\n        }\n      },\n      showSelectionControls: false,\n      autocompletionEnabled: true,\n      allowClearing: true,\n      tooltipEnabled: false,\n      openOnFieldClick: true,\n      showDropDownButton: true,\n      displayCustomValue: false,\n      _isAdaptablePopupPosition: false,\n      useInkRipple: false,\n      useHiddenSubmitElement: true\n    });\n  },\n  _init: function _init() {\n    this.callBase();\n\n    this._initCustomItemCreatingAction();\n  },\n  _initMarkup: function _initMarkup() {\n    this.$element().addClass(SELECTBOX_CLASS);\n\n    this._renderTooltip();\n\n    this.option(\"useInkRipple\") && this._renderInkRipple();\n    this.callBase();\n\n    this._$container.addClass(SELECTBOX_CONTAINER_CLASS);\n  },\n  _renderInkRipple: function _renderInkRipple() {\n    this._inkRipple = inkRipple.render();\n  },\n  _toggleActiveState: function _toggleActiveState($element, value, e) {\n    this.callBase.apply(this, arguments);\n\n    if (!this._inkRipple || this._isEditable()) {\n      return;\n    }\n\n    var config = {\n      element: this._inputWrapper(),\n      event: e\n    };\n\n    if (value) {\n      this._inkRipple.showWave(config);\n    } else {\n      this._inkRipple.hideWave(config);\n    }\n  },\n  _createPopup: function _createPopup() {\n    this.callBase();\n\n    this._popup.$element().addClass(SELECTBOX_POPUP_CLASS);\n  },\n  _popupWrapperClass: function _popupWrapperClass() {\n    return this.callBase() + \" \" + SELECTBOX_POPUP_WRAPPER_CLASS;\n  },\n  _cancelEditing: function _cancelEditing() {\n    if (!this.option(\"searchEnabled\") && this._list) {\n      this._focusListElement(null);\n\n      this._updateField(this.option(\"selectedItem\"));\n    }\n  },\n  _renderOpenedState: function _renderOpenedState() {\n    this.callBase();\n\n    if (this.option(\"opened\")) {\n      this._scrollToSelectedItem();\n\n      this._focusSelectedElement();\n    }\n  },\n  _focusSelectedElement: function _focusSelectedElement() {\n    var searchValue = this._searchValue();\n\n    if (!searchValue) {\n      this._focusListElement(null);\n\n      return;\n    }\n\n    var $listItems = this._list._itemElements();\n\n    var index = inArray(this.option(\"selectedItem\"), this.option(\"items\"));\n    var focusedElement = index >= 0 && !this._isCustomItemSelected() ? $listItems.eq(index) : null;\n\n    this._focusListElement(focusedElement);\n  },\n  _renderFocusedElement: function _renderFocusedElement() {\n    if (!this._list) {\n      return;\n    }\n\n    var searchValue = this._searchValue();\n\n    if (!searchValue || this.option(\"acceptCustomValue\")) {\n      this._focusListElement(null);\n\n      return;\n    }\n\n    var $listItems = this._list._itemElements();\n\n    var focusedElement = $listItems.not(DISABLED_STATE_SELECTOR).eq(0);\n\n    this._focusListElement(focusedElement);\n  },\n  _focusListElement: function _focusListElement(element) {\n    this._preventInputValueRender = true;\n\n    this._list.option(\"focusedElement\", getPublicElement(element));\n\n    delete this._preventInputValueRender;\n  },\n  _scrollToSelectedItem: function _scrollToSelectedItem() {\n    this._list && this._list.scrollToItem(this._list.option(\"selectedItem\"));\n  },\n  _listContentReadyHandler: function _listContentReadyHandler() {\n    this.callBase();\n\n    var isPaginate = this._dataSource && this._dataSource.paginate();\n\n    if (isPaginate && this._needPopupRepaint()) {\n      return;\n    }\n\n    this._scrollToSelectedItem();\n  },\n  _renderValue: function _renderValue() {\n    this._renderInputValue();\n\n    this._setSubmitValue();\n\n    return new Deferred().resolve();\n  },\n  _renderInputValue: function _renderInputValue() {\n    return this.callBase().always(function () {\n      this._renderInputValueAsync();\n    }.bind(this));\n  },\n  _renderInputValueAsync: function _renderInputValueAsync() {\n    this._renderTooltip();\n\n    this._renderInputValueImpl().always(function () {\n      this._refreshSelected();\n    }.bind(this));\n  },\n  _renderInputValueImpl: function _renderInputValueImpl() {\n    this._renderField();\n\n    return new Deferred().resolve();\n  },\n  _setNextItem: function _setNextItem(step) {\n    var item = this._calcNextItem(step);\n\n    var value = this._valueGetter(item);\n\n    this._setValue(value);\n  },\n  _setNextValue: function _setNextValue(e) {\n    var dataSourceIsLoaded = this._dataSource.isLoaded() ? new Deferred().resolve() : this._dataSource.load();\n    dataSourceIsLoaded.done(function () {\n      var selectedIndex = this._getSelectedIndex();\n\n      var hasPages = this._dataSource.pageSize();\n\n      var isLastPage = this._dataSource.isLastPage();\n\n      var isLastItem = selectedIndex === this._items().length - 1;\n\n      this._saveValueChangeEvent(e);\n\n      var step = \"ArrowDown\" === e.key ? 1 : -1;\n\n      if (hasPages && !isLastPage && isLastItem && step > 0) {\n        if (!this._popup) {\n          this._createPopup();\n        }\n\n        this._list._loadNextPage().done(this._setNextItem.bind(this, step));\n      } else {\n        this._setNextItem(step);\n      }\n    }.bind(this));\n  },\n  _setSelectedItem: function _setSelectedItem(item) {\n    var isUnknownItem = !this._isCustomValueAllowed() && void 0 === item;\n    this.callBase(isUnknownItem ? null : item);\n\n    if (!isUnknownItem && (!this._isEditable() || this._isCustomItemSelected())) {\n      this._setListOption(\"selectedItem\", this.option(\"selectedItem\"));\n    }\n  },\n  _isCustomValueAllowed: function _isCustomValueAllowed() {\n    return this.option(\"acceptCustomValue\") || this.callBase();\n  },\n  _displayValue: function _displayValue(item) {\n    item = !isDefined(item) && this._isCustomValueAllowed() ? this.option(\"value\") : item;\n    return this.callBase(item);\n  },\n  _listConfig: function _listConfig() {\n    var result = extend(this.callBase(), {\n      pageLoadMode: \"scrollBottom\",\n      onSelectionChanged: this._getSelectionChangeHandler(),\n      selectedItem: this.option(\"selectedItem\"),\n      onFocusedItemChanged: this._listFocusedItemChangeHandler.bind(this)\n    });\n\n    if (this.option(\"showSelectionControls\")) {\n      extend(result, {\n        showSelectionControls: true,\n        selectionByClick: true\n      });\n    }\n\n    return result;\n  },\n  _listFocusedItemChangeHandler: function _listFocusedItemChangeHandler(e) {\n    if (this._preventInputValueRender) {\n      return;\n    }\n\n    var list = e.component;\n    var focusedElement = $(list.option(\"focusedElement\"));\n\n    var focusedItem = list._getItemData(focusedElement);\n\n    this._updateField(focusedItem);\n  },\n  _updateField: function _updateField(item) {\n    var fieldTemplate = this._getTemplateByOption(\"fieldTemplate\");\n\n    if (!(fieldTemplate && this.option(\"fieldTemplate\"))) {\n      this._renderDisplayText(this._displayGetter(item));\n\n      return;\n    }\n\n    this._renderField();\n  },\n  _getSelectionChangeHandler: function _getSelectionChangeHandler() {\n    return this.option(\"showSelectionControls\") ? this._selectionChangeHandler.bind(this) : commonUtils.noop;\n  },\n  _selectionChangeHandler: function _selectionChangeHandler(e) {\n    each(e.addedItems || [], function (_, addedItem) {\n      this._setValue(this._valueGetter(addedItem));\n    }.bind(this));\n  },\n  _getActualSearchValue: function _getActualSearchValue() {\n    return this._dataSource.searchValue();\n  },\n  _toggleOpenState: function _toggleOpenState(isVisible) {\n    if (this.option(\"disabled\")) {\n      return;\n    }\n\n    isVisible = arguments.length ? isVisible : !this.option(\"opened\");\n\n    if (!isVisible) {\n      this._restoreInputText(true);\n    }\n\n    if (this._wasSearch() && isVisible) {\n      this._wasSearch(false);\n\n      var showDataImmediately = this.option(\"showDataBeforeSearch\") || 0 === this.option(\"minSearchLength\");\n\n      if (showDataImmediately && this._dataSource) {\n        if (this._searchTimer) {\n          return;\n        }\n\n        var searchValue = this._getActualSearchValue();\n\n        searchValue && this._wasSearch(true);\n\n        this._filterDataSource(searchValue || null);\n      } else {\n        this._setListOption(\"items\", []);\n      }\n    }\n\n    if (isVisible) {\n      this._scrollToSelectedItem();\n    }\n\n    this.callBase(isVisible);\n  },\n  _renderTooltip: function _renderTooltip() {\n    if (this.option(\"tooltipEnabled\")) {\n      this.$element().attr(\"title\", this.option(\"displayValue\"));\n    }\n  },\n  _renderDimensions: function _renderDimensions() {\n    this.callBase();\n\n    this._setPopupOption(\"width\");\n  },\n  _isValueEqualInputText: function _isValueEqualInputText() {\n    var initialSelectedItem = this.option(\"selectedItem\");\n\n    var value = this._displayGetter(initialSelectedItem);\n\n    var displayValue = value ? String(value) : \"\";\n\n    var inputText = this._searchValue();\n\n    return displayValue === inputText;\n  },\n  _popupHidingHandler: function _popupHidingHandler() {\n    if (this._isValueEqualInputText()) {\n      this._cancelEditing();\n    }\n\n    this.callBase();\n  },\n  _restoreInputText: function _restoreInputText(saveEditingValue) {\n    if (this.option(\"readOnly\")) {\n      return;\n    }\n\n    this._loadItemDeferred && this._loadItemDeferred.always(function () {\n      var initialSelectedItem = this.option(\"selectedItem\");\n\n      if (this.option(\"acceptCustomValue\")) {\n        if (!saveEditingValue) {\n          this._updateField(initialSelectedItem);\n\n          this._clearFilter();\n        }\n\n        return;\n      }\n\n      if (this.option(\"searchEnabled\")) {\n        if (!this._searchValue() && this.option(\"allowClearing\")) {\n          this._clearTextValue();\n\n          return;\n        }\n      }\n\n      if (this._isValueEqualInputText()) {\n        return;\n      }\n\n      this._renderInputValue().always(function (selectedItem) {\n        var newSelectedItem = commonUtils.ensureDefined(selectedItem, initialSelectedItem);\n\n        this._setSelectedItem(newSelectedItem);\n\n        this._updateField(newSelectedItem);\n\n        this._clearFilter();\n      }.bind(this));\n    }.bind(this));\n  },\n  _focusOutHandler: function _focusOutHandler(e) {\n    if (!this._preventNestedFocusEvent(e)) {\n      this._clearSearchTimer();\n\n      this._restoreInputText();\n\n      if (!this.option(\"acceptCustomValue\") && this.option(\"searchEnabled\") && !this._isOverlayNestedTarget(e.relatedTarget)) {\n        this._searchCanceled();\n      }\n    }\n\n    this.callBase(e);\n  },\n  _isOverlayNestedTarget: function _isOverlayNestedTarget(target) {\n    return !!$(target).closest(\".\".concat(SELECTBOX_POPUP_WRAPPER_CLASS)).length;\n  },\n  _clearTextValue: function _clearTextValue() {\n    this.option(\"value\", null);\n  },\n  _shouldOpenPopup: function _shouldOpenPopup() {\n    return this._needPassDataSourceToList();\n  },\n  _isFocused: function _isFocused() {\n    var activeElement = domAdapter.getActiveElement();\n    return this.callBase() && $(activeElement).closest(this._input()).length > 0;\n  },\n  _renderValueChangeEvent: function _renderValueChangeEvent() {\n    if (this._isEditable()) {\n      this.callBase();\n    }\n  },\n  _isEditable: function _isEditable() {\n    return this.option(\"acceptCustomValue\") || this.option(\"searchEnabled\");\n  },\n  _fieldRenderData: function _fieldRenderData() {\n    var $listFocused = this._list && this.option(\"opened\") && $(this._list.option(\"focusedElement\"));\n\n    if ($listFocused && $listFocused.length) {\n      return this._list._getItemData($listFocused);\n    }\n\n    return this.option(\"selectedItem\");\n  },\n  _readOnlyPropValue: function _readOnlyPropValue() {\n    return !this._isEditable() || this.option(\"readOnly\");\n  },\n  _isSelectedValue: function _isSelectedValue(value) {\n    return this._isValueEquals(value, this.option(\"value\"));\n  },\n  _shouldCloseOnItemClick: function _shouldCloseOnItemClick() {\n    return !(this.option(\"showSelectionControls\") && \"single\" !== this.option(\"selectionMode\"));\n  },\n  _listItemClickHandler: function _listItemClickHandler(e) {\n    var previousValue = this._getCurrentValue();\n\n    this._focusListElement($(e.itemElement));\n\n    this._saveValueChangeEvent(e.event);\n\n    if (this._shouldClearFilter()) {\n      this._clearFilter();\n    }\n\n    this._completeSelection(this._valueGetter(e.itemData));\n\n    if (this._shouldCloseOnItemClick()) {\n      this.option(\"opened\", false);\n    }\n\n    if (this.option(\"searchEnabled\") && previousValue === this._valueGetter(e.itemData)) {\n      this._updateField(e.itemData);\n    }\n  },\n  _shouldClearFilter: function _shouldClearFilter() {\n    return this._wasSearch();\n  },\n  _completeSelection: function _completeSelection(value) {\n    this._setValue(value);\n  },\n  _loadItem: function _loadItem(value, cache) {\n    var that = this;\n    var deferred = new Deferred();\n    this.callBase(value, cache).done(function (item) {\n      deferred.resolve(item);\n    }.bind(this)).fail(function () {\n      var selectedItem = that.option(\"selectedItem\");\n\n      if (that.option(\"acceptCustomValue\") && value === that._valueGetter(selectedItem)) {\n        deferred.resolve(selectedItem);\n      } else {\n        deferred.reject();\n      }\n    }.bind(this));\n    return deferred.promise();\n  },\n  _loadInputValue: function _loadInputValue(value, callback) {\n    this._loadItemDeferred = this._loadItem(value).always(callback);\n    return this._loadItemDeferred;\n  },\n  _isCustomItemSelected: function _isCustomItemSelected() {\n    var selectedItem = this.option(\"selectedItem\");\n\n    var searchValue = this._searchValue();\n\n    var selectedItemText = this._displayGetter(selectedItem);\n\n    return !selectedItemText || searchValue !== selectedItemText.toString();\n  },\n  _valueChangeEventHandler: function _valueChangeEventHandler(e) {\n    if (this.option(\"acceptCustomValue\") && this._isCustomItemSelected()) {\n      this._customItemAddedHandler(e);\n    }\n  },\n  _initCustomItemCreatingAction: function _initCustomItemCreatingAction() {\n    this._customItemCreatingAction = this._createActionByOption(\"onCustomItemCreating\");\n  },\n  _createCustomItem: function _createCustomItem(text) {\n    var params = {\n      text: text\n    };\n\n    var actionResult = this._customItemCreatingAction(params);\n\n    var item = commonUtils.ensureDefined(actionResult, params.customItem);\n\n    if (isDefined(actionResult)) {\n      errors.log(\"W0015\", \"onCustomItemCreating\", \"customItem\");\n    }\n\n    return item;\n  },\n  _customItemAddedHandler: function _customItemAddedHandler(e) {\n    var searchValue = this._searchValue();\n\n    var item = this._createCustomItem(searchValue);\n\n    this._saveValueChangeEvent(e);\n\n    if (void 0 === item) {\n      this._renderValue();\n\n      throw errors.Error(\"E0121\");\n    }\n\n    if (isPromise(item)) {\n      deferredUtils.fromPromise(item).done(this._setCustomItem.bind(this)).fail(this._setCustomItem.bind(this, null));\n    } else {\n      this._setCustomItem(item);\n    }\n  },\n  _setCustomItem: function _setCustomItem(item) {\n    if (this._disposed) {\n      return;\n    }\n\n    item = item || null;\n    this.option(\"selectedItem\", item);\n\n    if (this._shouldClearFilter()) {\n      this._filterDataSource(null);\n    }\n\n    this._setValue(this._valueGetter(item));\n\n    this._renderDisplayText(this._displayGetter(item));\n  },\n  _clearValueHandler: function _clearValueHandler(e) {\n    this.callBase(e);\n    return false;\n  },\n  _wasSearch: function _wasSearch(value) {\n    if (!arguments.length) {\n      return this._wasSearchValue;\n    }\n\n    this._wasSearchValue = value;\n  },\n  _searchHandler: function _searchHandler(e) {\n    if (this._preventFiltering) {\n      delete this._preventFiltering;\n      return;\n    }\n\n    if (this._needPassDataSourceToList()) {\n      this._wasSearch(true);\n    }\n\n    this.callBase(e);\n  },\n  _dataSourceFiltered: function _dataSourceFiltered(searchValue) {\n    this.callBase();\n\n    if (null !== searchValue) {\n      this._renderInputSubstitution();\n\n      this._renderFocusedElement();\n    }\n  },\n  _valueSubstituted: function _valueSubstituted() {\n    var input = this._input().get(0);\n\n    var isAllSelected = 0 === input.selectionStart && input.selectionEnd === this._searchValue().length;\n\n    var inputHasSelection = input.selectionStart !== input.selectionEnd;\n    return this._wasSearch() && inputHasSelection && !isAllSelected;\n  },\n  _shouldSubstitutionBeRendered: function _shouldSubstitutionBeRendered() {\n    return this.option(\"autocompletionEnabled\") && !this._preventSubstitution && this.option(\"searchEnabled\") && !this.option(\"acceptCustomValue\") && \"startswith\" === this.option(\"searchMode\");\n  },\n  _renderInputSubstitution: function _renderInputSubstitution() {\n    if (!this._shouldSubstitutionBeRendered()) {\n      delete this._preventSubstitution;\n      return;\n    }\n\n    var item = this._list && this._getPlainItems(this._list.option(\"items\"))[0];\n\n    if (!item) {\n      return;\n    }\n\n    var $input = this._input();\n\n    var valueLength = $input.val().length;\n\n    if (0 === valueLength) {\n      return;\n    }\n\n    var inputElement = $input.get(0);\n\n    var displayValue = this._displayGetter(item).toString();\n\n    inputElement.value = displayValue;\n\n    this._caret({\n      start: valueLength,\n      end: displayValue.length\n    });\n  },\n  _cleanInputSelection: function _cleanInputSelection() {\n    var inputElement = this._input().get(0);\n\n    var endPosition = inputElement.value.length;\n    inputElement.selectionStart = endPosition;\n    inputElement.selectionEnd = endPosition;\n  },\n  _dispose: function _dispose() {\n    this._renderInputValueAsync = commonUtils.noop;\n    delete this._loadItemDeferred;\n    this.callBase();\n  },\n  _optionChanged: function _optionChanged(args) {\n    switch (args.name) {\n      case \"_isAdaptablePopupPosition\":\n      case \"autocompletionEnabled\":\n        break;\n\n      case \"onCustomItemCreating\":\n        this._initCustomItemCreatingAction();\n\n        break;\n\n      case \"tooltipEnabled\":\n        this._renderTooltip();\n\n        break;\n\n      case \"displayCustomValue\":\n      case \"acceptCustomValue\":\n      case \"showSelectionControls\":\n      case \"useInkRipple\":\n        this._invalidate();\n\n        break;\n\n      case \"selectedItem\":\n        if (args.previousValue !== args.value) {\n          this.callBase(args);\n        }\n\n        break;\n\n      case \"allowClearing\":\n        break;\n\n      default:\n        this.callBase(args);\n    }\n  },\n  _clean: function _clean() {\n    delete this._inkRipple;\n    this.callBase();\n  }\n});\nregisterComponent(\"dxSelectBox\", SelectBox);\nmodule.exports = SelectBox;\nmodule.exports.default = module.exports;","map":{"version":3,"sources":["C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/devextreme/ui/select_box.js"],"names":["$","require","commonUtils","typeUtils","isDefined","isPromise","extend","inArray","each","deferredUtils","getPublicElement","Deferred","errors","domAdapter","inkRipple","messageLocalization","registerComponent","DropDownList","DISABLED_STATE_SELECTOR","SELECTBOX_CLASS","SELECTBOX_POPUP_CLASS","SELECTBOX_CONTAINER_CLASS","SELECTBOX_POPUP_WRAPPER_CLASS","SelectBox","_supportedKeys","that","parent","clearSelectBox","isEditable","e","searchIfNeeded","tab","upArrow","downArrow","leftArrow","rightArrow","home","end","escape","result","enter","isOpened","inputText","isCustomText","selectedItem","value","space","isSearchEnabled","acceptCustomValue","backspace","del","_getDefaultOptions","placeholder","fieldTemplate","valueChangeEvent","onCustomItemCreating","showSelectionControls","autocompletionEnabled","allowClearing","tooltipEnabled","openOnFieldClick","showDropDownButton","displayCustomValue","_isAdaptablePopupPosition","useInkRipple","useHiddenSubmitElement","_init","_initMarkup","_renderInkRipple","_toggleActiveState","config","element","event","_createPopup","_popupWrapperClass","_cancelEditing","_renderOpenedState","_focusSelectedElement","searchValue","$listItems","index","focusedElement","_renderFocusedElement","_focusListElement","_scrollToSelectedItem","_listContentReadyHandler","isPaginate","_renderValue","_renderInputValue","_renderInputValueAsync","_renderInputValueImpl","_setNextItem","item","_setNextValue","dataSourceIsLoaded","selectedIndex","hasPages","isLastPage","isLastItem","step","_setSelectedItem","isUnknownItem","_isCustomValueAllowed","_displayValue","_listConfig","pageLoadMode","onSelectionChanged","onFocusedItemChanged","selectionByClick","_listFocusedItemChangeHandler","list","focusedItem","_updateField","_getSelectionChangeHandler","_selectionChangeHandler","_getActualSearchValue","_toggleOpenState","isVisible","arguments","showDataImmediately","_renderTooltip","_renderDimensions","_isValueEqualInputText","initialSelectedItem","displayValue","String","_popupHidingHandler","_restoreInputText","newSelectedItem","_focusOutHandler","_isOverlayNestedTarget","_clearTextValue","_shouldOpenPopup","_isFocused","activeElement","_renderValueChangeEvent","_isEditable","_fieldRenderData","$listFocused","_readOnlyPropValue","_isSelectedValue","_shouldCloseOnItemClick","_listItemClickHandler","previousValue","_shouldClearFilter","_completeSelection","_loadItem","deferred","_loadInputValue","_isCustomItemSelected","selectedItemText","_valueChangeEventHandler","_initCustomItemCreatingAction","_createCustomItem","params","text","actionResult","_customItemAddedHandler","_setCustomItem","_clearValueHandler","_wasSearch","_searchHandler","_dataSourceFiltered","_valueSubstituted","input","isAllSelected","inputHasSelection","_shouldSubstitutionBeRendered","_renderInputSubstitution","$input","valueLength","inputElement","start","length","_cleanInputSelection","endPosition","_dispose","_optionChanged","args","_clean","module"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/select_box.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar $ = require(\"../core/renderer\");\r\nvar commonUtils = require(\"../core/utils/common\");\r\nvar typeUtils = require(\"../core/utils/type\");\r\nvar isDefined = typeUtils.isDefined;\r\nvar isPromise = typeUtils.isPromise;\r\nvar extend = require(\"../core/utils/extend\").extend;\r\nvar inArray = require(\"../core/utils/array\").inArray;\r\nvar each = require(\"../core/utils/iterator\").each;\r\nvar deferredUtils = require(\"../core/utils/deferred\");\r\nvar getPublicElement = require(\"../core/utils/dom\").getPublicElement;\r\nvar Deferred = deferredUtils.Deferred;\r\nvar errors = require(\"../core/errors\");\r\nvar domAdapter = require(\"../core/dom_adapter\");\r\nvar inkRipple = require(\"./widget/utils.ink_ripple\");\r\nvar messageLocalization = require(\"../localization/message\");\r\nvar registerComponent = require(\"../core/component_registrator\");\r\nvar DropDownList = require(\"./drop_down_editor/ui.drop_down_list\");\r\nvar DISABLED_STATE_SELECTOR = \".dx-state-disabled\";\r\nvar SELECTBOX_CLASS = \"dx-selectbox\";\r\nvar SELECTBOX_POPUP_CLASS = \"dx-selectbox-popup\";\r\nvar SELECTBOX_CONTAINER_CLASS = \"dx-selectbox-container\";\r\nvar SELECTBOX_POPUP_WRAPPER_CLASS = \"dx-selectbox-popup-wrapper\";\r\nvar SelectBox = DropDownList.inherit({\r\n    _supportedKeys: function() {\r\n        var that = this;\r\n        var parent = this.callBase();\r\n        var clearSelectBox = function(e) {\r\n            var isEditable = this._isEditable();\r\n            if (!isEditable) {\r\n                if (this.option(\"showClearButton\")) {\r\n                    e.preventDefault();\r\n                    this.reset()\r\n                }\r\n            } else {\r\n                if (this._valueSubstituted()) {\r\n                    this._preventFiltering = true\r\n                }\r\n            }\r\n            this._preventSubstitution = true\r\n        };\r\n        var searchIfNeeded = function() {\r\n            if (that.option(\"searchEnabled\") && that._valueSubstituted()) {\r\n                that._searchHandler()\r\n            }\r\n        };\r\n        return extend({}, parent, {\r\n            tab: function() {\r\n                if (this.option(\"opened\") && \"instantly\" === this.option(\"applyValueMode\")) {\r\n                    this._cleanInputSelection()\r\n                }\r\n                if (this._wasSearch()) {\r\n                    this._clearFilter()\r\n                }\r\n                parent.tab && parent.tab.apply(this, arguments)\r\n            },\r\n            upArrow: function(e) {\r\n                if (parent.upArrow && parent.upArrow.apply(this, arguments)) {\r\n                    if (!this.option(\"opened\")) {\r\n                        this._setNextValue(e)\r\n                    }\r\n                    return true\r\n                }\r\n            },\r\n            downArrow: function(e) {\r\n                if (parent.downArrow && parent.downArrow.apply(this, arguments)) {\r\n                    if (!this.option(\"opened\")) {\r\n                        this._setNextValue(e)\r\n                    }\r\n                    return true\r\n                }\r\n            },\r\n            leftArrow: function() {\r\n                searchIfNeeded();\r\n                parent.leftArrow && parent.leftArrow.apply(this, arguments)\r\n            },\r\n            rightArrow: function() {\r\n                searchIfNeeded();\r\n                parent.rightArrow && parent.rightArrow.apply(this, arguments)\r\n            },\r\n            home: function() {\r\n                searchIfNeeded();\r\n                parent.home && parent.home.apply(this, arguments)\r\n            },\r\n            end: function() {\r\n                searchIfNeeded();\r\n                parent.end && parent.end.apply(this, arguments)\r\n            },\r\n            escape: function() {\r\n                var result = parent.escape && parent.escape.apply(this, arguments);\r\n                this._cancelEditing();\r\n                return isDefined(result) ? result : true\r\n            },\r\n            enter: function(e) {\r\n                var isOpened = this.option(\"opened\");\r\n                var inputText = this._input().val().trim();\r\n                var isCustomText = inputText && this._list && !this._list.option(\"focusedElement\");\r\n                if (!inputText && this.option(\"value\") && this.option(\"allowClearing\")) {\r\n                    this.option({\r\n                        selectedItem: null,\r\n                        value: null\r\n                    });\r\n                    this.close()\r\n                } else {\r\n                    if (this.option(\"acceptCustomValue\")) {\r\n                        e.preventDefault();\r\n                        if (isCustomText) {\r\n                            this._valueChangeEventHandler(e);\r\n                            if (isOpened) {\r\n                                this._toggleOpenState()\r\n                            }\r\n                        }\r\n                        return isOpened\r\n                    }\r\n                    if (parent.enter && parent.enter.apply(this, arguments)) {\r\n                        return isOpened\r\n                    }\r\n                }\r\n            },\r\n            space: function(e) {\r\n                var isOpened = this.option(\"opened\");\r\n                var isSearchEnabled = this.option(\"searchEnabled\");\r\n                var acceptCustomValue = this.option(\"acceptCustomValue\");\r\n                if (!isOpened || isSearchEnabled || acceptCustomValue) {\r\n                    return\r\n                }\r\n                e.preventDefault();\r\n                this._valueChangeEventHandler(e);\r\n                return true\r\n            },\r\n            backspace: clearSelectBox,\r\n            del: clearSelectBox\r\n        })\r\n    },\r\n    _getDefaultOptions: function() {\r\n        return extend(this.callBase(), {\r\n            placeholder: messageLocalization.format(\"Select\"),\r\n            fieldTemplate: null,\r\n            valueChangeEvent: \"change\",\r\n            acceptCustomValue: false,\r\n            onCustomItemCreating: function(e) {\r\n                if (!isDefined(e.customItem)) {\r\n                    e.customItem = e.text\r\n                }\r\n            },\r\n            showSelectionControls: false,\r\n            autocompletionEnabled: true,\r\n            allowClearing: true,\r\n            tooltipEnabled: false,\r\n            openOnFieldClick: true,\r\n            showDropDownButton: true,\r\n            displayCustomValue: false,\r\n            _isAdaptablePopupPosition: false,\r\n            useInkRipple: false,\r\n            useHiddenSubmitElement: true\r\n        })\r\n    },\r\n    _init: function() {\r\n        this.callBase();\r\n        this._initCustomItemCreatingAction()\r\n    },\r\n    _initMarkup: function() {\r\n        this.$element().addClass(SELECTBOX_CLASS);\r\n        this._renderTooltip();\r\n        this.option(\"useInkRipple\") && this._renderInkRipple();\r\n        this.callBase();\r\n        this._$container.addClass(SELECTBOX_CONTAINER_CLASS)\r\n    },\r\n    _renderInkRipple: function() {\r\n        this._inkRipple = inkRipple.render()\r\n    },\r\n    _toggleActiveState: function($element, value, e) {\r\n        this.callBase.apply(this, arguments);\r\n        if (!this._inkRipple || this._isEditable()) {\r\n            return\r\n        }\r\n        var config = {\r\n            element: this._inputWrapper(),\r\n            event: e\r\n        };\r\n        if (value) {\r\n            this._inkRipple.showWave(config)\r\n        } else {\r\n            this._inkRipple.hideWave(config)\r\n        }\r\n    },\r\n    _createPopup: function() {\r\n        this.callBase();\r\n        this._popup.$element().addClass(SELECTBOX_POPUP_CLASS)\r\n    },\r\n    _popupWrapperClass: function() {\r\n        return this.callBase() + \" \" + SELECTBOX_POPUP_WRAPPER_CLASS\r\n    },\r\n    _cancelEditing: function() {\r\n        if (!this.option(\"searchEnabled\") && this._list) {\r\n            this._focusListElement(null);\r\n            this._updateField(this.option(\"selectedItem\"))\r\n        }\r\n    },\r\n    _renderOpenedState: function() {\r\n        this.callBase();\r\n        if (this.option(\"opened\")) {\r\n            this._scrollToSelectedItem();\r\n            this._focusSelectedElement()\r\n        }\r\n    },\r\n    _focusSelectedElement: function() {\r\n        var searchValue = this._searchValue();\r\n        if (!searchValue) {\r\n            this._focusListElement(null);\r\n            return\r\n        }\r\n        var $listItems = this._list._itemElements();\r\n        var index = inArray(this.option(\"selectedItem\"), this.option(\"items\"));\r\n        var focusedElement = index >= 0 && !this._isCustomItemSelected() ? $listItems.eq(index) : null;\r\n        this._focusListElement(focusedElement)\r\n    },\r\n    _renderFocusedElement: function() {\r\n        if (!this._list) {\r\n            return\r\n        }\r\n        var searchValue = this._searchValue();\r\n        if (!searchValue || this.option(\"acceptCustomValue\")) {\r\n            this._focusListElement(null);\r\n            return\r\n        }\r\n        var $listItems = this._list._itemElements();\r\n        var focusedElement = $listItems.not(DISABLED_STATE_SELECTOR).eq(0);\r\n        this._focusListElement(focusedElement)\r\n    },\r\n    _focusListElement: function(element) {\r\n        this._preventInputValueRender = true;\r\n        this._list.option(\"focusedElement\", getPublicElement(element));\r\n        delete this._preventInputValueRender\r\n    },\r\n    _scrollToSelectedItem: function() {\r\n        this._list && this._list.scrollToItem(this._list.option(\"selectedItem\"))\r\n    },\r\n    _listContentReadyHandler: function() {\r\n        this.callBase();\r\n        var isPaginate = this._dataSource && this._dataSource.paginate();\r\n        if (isPaginate && this._needPopupRepaint()) {\r\n            return\r\n        }\r\n        this._scrollToSelectedItem()\r\n    },\r\n    _renderValue: function() {\r\n        this._renderInputValue();\r\n        this._setSubmitValue();\r\n        return (new Deferred).resolve()\r\n    },\r\n    _renderInputValue: function() {\r\n        return this.callBase().always(function() {\r\n            this._renderInputValueAsync()\r\n        }.bind(this))\r\n    },\r\n    _renderInputValueAsync: function() {\r\n        this._renderTooltip();\r\n        this._renderInputValueImpl().always(function() {\r\n            this._refreshSelected()\r\n        }.bind(this))\r\n    },\r\n    _renderInputValueImpl: function() {\r\n        this._renderField();\r\n        return (new Deferred).resolve()\r\n    },\r\n    _setNextItem: function(step) {\r\n        var item = this._calcNextItem(step);\r\n        var value = this._valueGetter(item);\r\n        this._setValue(value)\r\n    },\r\n    _setNextValue: function(e) {\r\n        var dataSourceIsLoaded = this._dataSource.isLoaded() ? (new Deferred).resolve() : this._dataSource.load();\r\n        dataSourceIsLoaded.done(function() {\r\n            var selectedIndex = this._getSelectedIndex();\r\n            var hasPages = this._dataSource.pageSize();\r\n            var isLastPage = this._dataSource.isLastPage();\r\n            var isLastItem = selectedIndex === this._items().length - 1;\r\n            this._saveValueChangeEvent(e);\r\n            var step = \"ArrowDown\" === e.key ? 1 : -1;\r\n            if (hasPages && !isLastPage && isLastItem && step > 0) {\r\n                if (!this._popup) {\r\n                    this._createPopup()\r\n                }\r\n                this._list._loadNextPage().done(this._setNextItem.bind(this, step))\r\n            } else {\r\n                this._setNextItem(step)\r\n            }\r\n        }.bind(this))\r\n    },\r\n    _setSelectedItem: function(item) {\r\n        var isUnknownItem = !this._isCustomValueAllowed() && void 0 === item;\r\n        this.callBase(isUnknownItem ? null : item);\r\n        if (!isUnknownItem && (!this._isEditable() || this._isCustomItemSelected())) {\r\n            this._setListOption(\"selectedItem\", this.option(\"selectedItem\"))\r\n        }\r\n    },\r\n    _isCustomValueAllowed: function() {\r\n        return this.option(\"acceptCustomValue\") || this.callBase()\r\n    },\r\n    _displayValue: function(item) {\r\n        item = !isDefined(item) && this._isCustomValueAllowed() ? this.option(\"value\") : item;\r\n        return this.callBase(item)\r\n    },\r\n    _listConfig: function() {\r\n        var result = extend(this.callBase(), {\r\n            pageLoadMode: \"scrollBottom\",\r\n            onSelectionChanged: this._getSelectionChangeHandler(),\r\n            selectedItem: this.option(\"selectedItem\"),\r\n            onFocusedItemChanged: this._listFocusedItemChangeHandler.bind(this)\r\n        });\r\n        if (this.option(\"showSelectionControls\")) {\r\n            extend(result, {\r\n                showSelectionControls: true,\r\n                selectionByClick: true\r\n            })\r\n        }\r\n        return result\r\n    },\r\n    _listFocusedItemChangeHandler: function(e) {\r\n        if (this._preventInputValueRender) {\r\n            return\r\n        }\r\n        var list = e.component;\r\n        var focusedElement = $(list.option(\"focusedElement\"));\r\n        var focusedItem = list._getItemData(focusedElement);\r\n        this._updateField(focusedItem)\r\n    },\r\n    _updateField: function(item) {\r\n        var fieldTemplate = this._getTemplateByOption(\"fieldTemplate\");\r\n        if (!(fieldTemplate && this.option(\"fieldTemplate\"))) {\r\n            this._renderDisplayText(this._displayGetter(item));\r\n            return\r\n        }\r\n        this._renderField()\r\n    },\r\n    _getSelectionChangeHandler: function() {\r\n        return this.option(\"showSelectionControls\") ? this._selectionChangeHandler.bind(this) : commonUtils.noop\r\n    },\r\n    _selectionChangeHandler: function(e) {\r\n        each(e.addedItems || [], function(_, addedItem) {\r\n            this._setValue(this._valueGetter(addedItem))\r\n        }.bind(this))\r\n    },\r\n    _getActualSearchValue: function() {\r\n        return this._dataSource.searchValue()\r\n    },\r\n    _toggleOpenState: function(isVisible) {\r\n        if (this.option(\"disabled\")) {\r\n            return\r\n        }\r\n        isVisible = arguments.length ? isVisible : !this.option(\"opened\");\r\n        if (!isVisible) {\r\n            this._restoreInputText(true)\r\n        }\r\n        if (this._wasSearch() && isVisible) {\r\n            this._wasSearch(false);\r\n            var showDataImmediately = this.option(\"showDataBeforeSearch\") || 0 === this.option(\"minSearchLength\");\r\n            if (showDataImmediately && this._dataSource) {\r\n                if (this._searchTimer) {\r\n                    return\r\n                }\r\n                var searchValue = this._getActualSearchValue();\r\n                searchValue && this._wasSearch(true);\r\n                this._filterDataSource(searchValue || null)\r\n            } else {\r\n                this._setListOption(\"items\", [])\r\n            }\r\n        }\r\n        if (isVisible) {\r\n            this._scrollToSelectedItem()\r\n        }\r\n        this.callBase(isVisible)\r\n    },\r\n    _renderTooltip: function() {\r\n        if (this.option(\"tooltipEnabled\")) {\r\n            this.$element().attr(\"title\", this.option(\"displayValue\"))\r\n        }\r\n    },\r\n    _renderDimensions: function() {\r\n        this.callBase();\r\n        this._setPopupOption(\"width\")\r\n    },\r\n    _isValueEqualInputText: function() {\r\n        var initialSelectedItem = this.option(\"selectedItem\");\r\n        var value = this._displayGetter(initialSelectedItem);\r\n        var displayValue = value ? String(value) : \"\";\r\n        var inputText = this._searchValue();\r\n        return displayValue === inputText\r\n    },\r\n    _popupHidingHandler: function() {\r\n        if (this._isValueEqualInputText()) {\r\n            this._cancelEditing()\r\n        }\r\n        this.callBase()\r\n    },\r\n    _restoreInputText: function(saveEditingValue) {\r\n        if (this.option(\"readOnly\")) {\r\n            return\r\n        }\r\n        this._loadItemDeferred && this._loadItemDeferred.always(function() {\r\n            var initialSelectedItem = this.option(\"selectedItem\");\r\n            if (this.option(\"acceptCustomValue\")) {\r\n                if (!saveEditingValue) {\r\n                    this._updateField(initialSelectedItem);\r\n                    this._clearFilter()\r\n                }\r\n                return\r\n            }\r\n            if (this.option(\"searchEnabled\")) {\r\n                if (!this._searchValue() && this.option(\"allowClearing\")) {\r\n                    this._clearTextValue();\r\n                    return\r\n                }\r\n            }\r\n            if (this._isValueEqualInputText()) {\r\n                return\r\n            }\r\n            this._renderInputValue().always(function(selectedItem) {\r\n                var newSelectedItem = commonUtils.ensureDefined(selectedItem, initialSelectedItem);\r\n                this._setSelectedItem(newSelectedItem);\r\n                this._updateField(newSelectedItem);\r\n                this._clearFilter()\r\n            }.bind(this))\r\n        }.bind(this))\r\n    },\r\n    _focusOutHandler: function(e) {\r\n        if (!this._preventNestedFocusEvent(e)) {\r\n            this._clearSearchTimer();\r\n            this._restoreInputText();\r\n            if (!this.option(\"acceptCustomValue\") && this.option(\"searchEnabled\") && !this._isOverlayNestedTarget(e.relatedTarget)) {\r\n                this._searchCanceled()\r\n            }\r\n        }\r\n        this.callBase(e)\r\n    },\r\n    _isOverlayNestedTarget: function(target) {\r\n        return !!$(target).closest(\".\".concat(SELECTBOX_POPUP_WRAPPER_CLASS)).length\r\n    },\r\n    _clearTextValue: function() {\r\n        this.option(\"value\", null)\r\n    },\r\n    _shouldOpenPopup: function() {\r\n        return this._needPassDataSourceToList()\r\n    },\r\n    _isFocused: function() {\r\n        var activeElement = domAdapter.getActiveElement();\r\n        return this.callBase() && $(activeElement).closest(this._input()).length > 0\r\n    },\r\n    _renderValueChangeEvent: function() {\r\n        if (this._isEditable()) {\r\n            this.callBase()\r\n        }\r\n    },\r\n    _isEditable: function() {\r\n        return this.option(\"acceptCustomValue\") || this.option(\"searchEnabled\")\r\n    },\r\n    _fieldRenderData: function() {\r\n        var $listFocused = this._list && this.option(\"opened\") && $(this._list.option(\"focusedElement\"));\r\n        if ($listFocused && $listFocused.length) {\r\n            return this._list._getItemData($listFocused)\r\n        }\r\n        return this.option(\"selectedItem\")\r\n    },\r\n    _readOnlyPropValue: function() {\r\n        return !this._isEditable() || this.option(\"readOnly\")\r\n    },\r\n    _isSelectedValue: function(value) {\r\n        return this._isValueEquals(value, this.option(\"value\"))\r\n    },\r\n    _shouldCloseOnItemClick: function() {\r\n        return !(this.option(\"showSelectionControls\") && \"single\" !== this.option(\"selectionMode\"))\r\n    },\r\n    _listItemClickHandler: function(e) {\r\n        var previousValue = this._getCurrentValue();\r\n        this._focusListElement($(e.itemElement));\r\n        this._saveValueChangeEvent(e.event);\r\n        if (this._shouldClearFilter()) {\r\n            this._clearFilter()\r\n        }\r\n        this._completeSelection(this._valueGetter(e.itemData));\r\n        if (this._shouldCloseOnItemClick()) {\r\n            this.option(\"opened\", false)\r\n        }\r\n        if (this.option(\"searchEnabled\") && previousValue === this._valueGetter(e.itemData)) {\r\n            this._updateField(e.itemData)\r\n        }\r\n    },\r\n    _shouldClearFilter: function() {\r\n        return this._wasSearch()\r\n    },\r\n    _completeSelection: function(value) {\r\n        this._setValue(value)\r\n    },\r\n    _loadItem: function(value, cache) {\r\n        var that = this;\r\n        var deferred = new Deferred;\r\n        this.callBase(value, cache).done(function(item) {\r\n            deferred.resolve(item)\r\n        }.bind(this)).fail(function() {\r\n            var selectedItem = that.option(\"selectedItem\");\r\n            if (that.option(\"acceptCustomValue\") && value === that._valueGetter(selectedItem)) {\r\n                deferred.resolve(selectedItem)\r\n            } else {\r\n                deferred.reject()\r\n            }\r\n        }.bind(this));\r\n        return deferred.promise()\r\n    },\r\n    _loadInputValue: function(value, callback) {\r\n        this._loadItemDeferred = this._loadItem(value).always(callback);\r\n        return this._loadItemDeferred\r\n    },\r\n    _isCustomItemSelected: function() {\r\n        var selectedItem = this.option(\"selectedItem\");\r\n        var searchValue = this._searchValue();\r\n        var selectedItemText = this._displayGetter(selectedItem);\r\n        return !selectedItemText || searchValue !== selectedItemText.toString()\r\n    },\r\n    _valueChangeEventHandler: function(e) {\r\n        if (this.option(\"acceptCustomValue\") && this._isCustomItemSelected()) {\r\n            this._customItemAddedHandler(e)\r\n        }\r\n    },\r\n    _initCustomItemCreatingAction: function() {\r\n        this._customItemCreatingAction = this._createActionByOption(\"onCustomItemCreating\")\r\n    },\r\n    _createCustomItem: function(text) {\r\n        var params = {\r\n            text: text\r\n        };\r\n        var actionResult = this._customItemCreatingAction(params);\r\n        var item = commonUtils.ensureDefined(actionResult, params.customItem);\r\n        if (isDefined(actionResult)) {\r\n            errors.log(\"W0015\", \"onCustomItemCreating\", \"customItem\")\r\n        }\r\n        return item\r\n    },\r\n    _customItemAddedHandler: function(e) {\r\n        var searchValue = this._searchValue();\r\n        var item = this._createCustomItem(searchValue);\r\n        this._saveValueChangeEvent(e);\r\n        if (void 0 === item) {\r\n            this._renderValue();\r\n            throw errors.Error(\"E0121\")\r\n        }\r\n        if (isPromise(item)) {\r\n            deferredUtils.fromPromise(item).done(this._setCustomItem.bind(this)).fail(this._setCustomItem.bind(this, null))\r\n        } else {\r\n            this._setCustomItem(item)\r\n        }\r\n    },\r\n    _setCustomItem: function(item) {\r\n        if (this._disposed) {\r\n            return\r\n        }\r\n        item = item || null;\r\n        this.option(\"selectedItem\", item);\r\n        if (this._shouldClearFilter()) {\r\n            this._filterDataSource(null)\r\n        }\r\n        this._setValue(this._valueGetter(item));\r\n        this._renderDisplayText(this._displayGetter(item))\r\n    },\r\n    _clearValueHandler: function(e) {\r\n        this.callBase(e);\r\n        return false\r\n    },\r\n    _wasSearch: function(value) {\r\n        if (!arguments.length) {\r\n            return this._wasSearchValue\r\n        }\r\n        this._wasSearchValue = value\r\n    },\r\n    _searchHandler: function(e) {\r\n        if (this._preventFiltering) {\r\n            delete this._preventFiltering;\r\n            return\r\n        }\r\n        if (this._needPassDataSourceToList()) {\r\n            this._wasSearch(true)\r\n        }\r\n        this.callBase(e)\r\n    },\r\n    _dataSourceFiltered: function(searchValue) {\r\n        this.callBase();\r\n        if (null !== searchValue) {\r\n            this._renderInputSubstitution();\r\n            this._renderFocusedElement()\r\n        }\r\n    },\r\n    _valueSubstituted: function() {\r\n        var input = this._input().get(0);\r\n        var isAllSelected = 0 === input.selectionStart && input.selectionEnd === this._searchValue().length;\r\n        var inputHasSelection = input.selectionStart !== input.selectionEnd;\r\n        return this._wasSearch() && inputHasSelection && !isAllSelected\r\n    },\r\n    _shouldSubstitutionBeRendered: function() {\r\n        return this.option(\"autocompletionEnabled\") && !this._preventSubstitution && this.option(\"searchEnabled\") && !this.option(\"acceptCustomValue\") && \"startswith\" === this.option(\"searchMode\")\r\n    },\r\n    _renderInputSubstitution: function() {\r\n        if (!this._shouldSubstitutionBeRendered()) {\r\n            delete this._preventSubstitution;\r\n            return\r\n        }\r\n        var item = this._list && this._getPlainItems(this._list.option(\"items\"))[0];\r\n        if (!item) {\r\n            return\r\n        }\r\n        var $input = this._input();\r\n        var valueLength = $input.val().length;\r\n        if (0 === valueLength) {\r\n            return\r\n        }\r\n        var inputElement = $input.get(0);\r\n        var displayValue = this._displayGetter(item).toString();\r\n        inputElement.value = displayValue;\r\n        this._caret({\r\n            start: valueLength,\r\n            end: displayValue.length\r\n        })\r\n    },\r\n    _cleanInputSelection: function() {\r\n        var inputElement = this._input().get(0);\r\n        var endPosition = inputElement.value.length;\r\n        inputElement.selectionStart = endPosition;\r\n        inputElement.selectionEnd = endPosition\r\n    },\r\n    _dispose: function() {\r\n        this._renderInputValueAsync = commonUtils.noop;\r\n        delete this._loadItemDeferred;\r\n        this.callBase()\r\n    },\r\n    _optionChanged: function(args) {\r\n        switch (args.name) {\r\n            case \"_isAdaptablePopupPosition\":\r\n            case \"autocompletionEnabled\":\r\n                break;\r\n            case \"onCustomItemCreating\":\r\n                this._initCustomItemCreatingAction();\r\n                break;\r\n            case \"tooltipEnabled\":\r\n                this._renderTooltip();\r\n                break;\r\n            case \"displayCustomValue\":\r\n            case \"acceptCustomValue\":\r\n            case \"showSelectionControls\":\r\n            case \"useInkRipple\":\r\n                this._invalidate();\r\n                break;\r\n            case \"selectedItem\":\r\n                if (args.previousValue !== args.value) {\r\n                    this.callBase(args)\r\n                }\r\n                break;\r\n            case \"allowClearing\":\r\n                break;\r\n            default:\r\n                this.callBase(args)\r\n        }\r\n    },\r\n    _clean: function() {\r\n        delete this._inkRipple;\r\n        this.callBase()\r\n    }\r\n});\r\nregisterComponent(\"dxSelectBox\", SelectBox);\r\nmodule.exports = SelectBox;\r\nmodule.exports.default = module.exports;\r\n"]},"metadata":{},"sourceType":"module"}