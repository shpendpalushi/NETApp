{"ast":null,"code":"/**\r\n * DevExtreme (viz/tree_map/tree_map.base.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar _common = require(\"./common\");\n\nvar _node = require(\"./node\");\n\nvar _node2 = _interopRequireDefault(_node);\n\nvar _tiling = require(\"./tiling\");\n\nvar _colorizing = require(\"./colorizing\");\n\nvar _utils = require(\"../core/utils\");\n\nvar _common2 = require(\"../../core/utils/common\");\n\nvar _type = require(\"../../core/utils/type\");\n\nvar _extend2 = require(\"../../core/utils/extend\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nvar _max = Math.max;\nvar directions = {\n  lefttoprightbottom: [1, 1],\n  leftbottomrighttop: [1, -1],\n  righttopleftbottom: [-1, 1],\n  rightbottomlefttop: [-1, -1]\n};\n\nrequire(\"./tiling.squarified\");\n\nrequire(\"./tiling\").setDefaultAlgorithm(\"squarified\");\n\nrequire(\"./colorizing.discrete\");\n\nrequire(\"./colorizing\").setDefaultColorizer(\"discrete\");\n\nfunction pickPositiveInteger(val) {\n  return val > 0 ? Math.round(val) : 0;\n}\n\nvar dxTreeMap = require(\"../core/base_widget\").inherit({\n  _handlers: {\n    beginBuildNodes: _common2.noop,\n    buildNode: _common2.noop,\n    endBuildNodes: _common2.noop,\n    setTrackerData: _common2.noop,\n    calculateState: function calculateState(options) {\n      return (0, _common.buildRectAppearance)(options);\n    }\n  },\n  _rootClass: \"dxtm-tree-map\",\n  _rootClassPrefix: \"dxtm\",\n  _getDefaultSize: function _getDefaultSize() {\n    return {\n      width: 400,\n      height: 400\n    };\n  },\n  _setDeprecatedOptions: function _setDeprecatedOptions() {\n    this.callBase.apply(this, arguments);\n    (0, _extend2.extend)(this._deprecatedOptions, {\n      resolveLabelOverflow: {\n        since: \"19.1\",\n        message: \"Use the 'tile.label.overflow' and 'group.label.textOverflow' option instead\"\n      }\n    });\n  },\n  _themeSection: \"treeMap\",\n  _fontFields: [\"tile.label.font\", \"group.label.font\"],\n  _init: function _init() {\n    var that = this;\n    that._rectOffsets = {};\n    that._handlers = Object.create(that._handlers);\n    that._context = {\n      suspend: function suspend() {\n        if (!that._applyingChanges) {\n          that._suspendChanges();\n        }\n      },\n      resume: function resume() {\n        if (!that._applyingChanges) {\n          that._resumeChanges();\n        }\n      },\n      change: function change(codes) {\n        that._change(codes);\n      },\n      settings: [{}, {}],\n      calculateState: that._handlers.calculateState,\n      calculateLabelState: _common.buildTextAppearance\n    };\n    that._root = that._topNode = {\n      nodes: []\n    };\n    that.callBase.apply(that, arguments);\n  },\n  _initialChanges: [\"DATA_SOURCE\"],\n  _initCore: function _initCore() {\n    var that = this;\n    var renderer = that._renderer;\n\n    that._createProxyType();\n\n    that._tilesGroup = renderer.g().linkOn(renderer.root, \"tiles\").linkAppend();\n    that._labelsGroup = renderer.g().linkOn(renderer.root, \"labels\").linkAppend();\n  },\n  _createProxyType: _common2.noop,\n  _disposeCore: function _disposeCore() {\n    var that = this;\n    that._filter && that._filter.dispose();\n\n    that._labelsGroup.linkOff();\n\n    that._tilesGroup.linkOff();\n  },\n  _applySize: function _applySize(rect) {\n    this._tilingRect = rect.slice();\n\n    this._change([\"TILING\"]);\n  },\n  _optionChangesMap: {\n    dataSource: \"DATA_SOURCE\",\n    valueField: \"NODES_CREATE\",\n    childrenField: \"NODES_CREATE\",\n    colorField: \"TILES\",\n    colorizer: \"TILES\",\n    labelField: \"LABELS\",\n    tile: \"TILE_SETTINGS\",\n    group: \"GROUP_SETTINGS\",\n    maxDepth: \"MAX_DEPTH\",\n    layoutAlgorithm: \"TILING\",\n    layoutDirection: \"TILING\",\n    resolveLabelOverflow: \"LABEL_OVERFLOW\"\n  },\n  _themeDependentChanges: [\"TILE_SETTINGS\", \"GROUP_SETTINGS\", \"MAX_DEPTH\"],\n  _changeDataSource: function _changeDataSource() {\n    var that = this;\n    that._isDataExpected = that._isSyncData = true;\n\n    that._updateDataSource();\n\n    that._isSyncData = false;\n\n    if (that._isDataExpected) {\n      that._suspendChanges();\n    }\n  },\n  _dataSourceChangedHandler: function _dataSourceChangedHandler() {\n    var that = this;\n\n    if (that._isDataExpected) {\n      that._isDataExpected = false;\n\n      that._change([\"NODES_CREATE\"]);\n\n      if (!that._isSyncData) {\n        that._resumeChanges();\n      }\n    } else {\n      that._requestChange([\"NODES_CREATE\"]);\n    }\n  },\n  _optionChangesOrder: [\"DATA_SOURCE\", \"TILE_SETTINGS\", \"GROUP_SETTINGS\", \"MAX_DEPTH\", \"LABEL_OVERFLOW\"],\n  _change_DATA_SOURCE: function _change_DATA_SOURCE() {\n    this._changeDataSource();\n  },\n  _change_TILE_SETTINGS: function _change_TILE_SETTINGS() {\n    this._changeTileSettings();\n  },\n  _change_GROUP_SETTINGS: function _change_GROUP_SETTINGS() {\n    this._changeGroupSettings();\n  },\n  _change_LABEL_OVERFLOW: function _change_LABEL_OVERFLOW() {\n    this._changeTileSettings();\n\n    this._changeGroupSettings();\n  },\n  _change_MAX_DEPTH: function _change_MAX_DEPTH() {\n    this._changeMaxDepth();\n  },\n  _customChangesOrder: [\"NODES_CREATE\", \"NODES_RESET\", \"TILES\", \"LABELS\", \"TILING\", \"LABELS_LAYOUT\"],\n  _change_NODES_CREATE: function _change_NODES_CREATE() {\n    this._buildNodes();\n  },\n  _change_NODES_RESET: function _change_NODES_RESET() {\n    this._resetNodes();\n  },\n  _change_TILES: function _change_TILES() {\n    this._applyTilesAppearance();\n  },\n  _change_LABELS: function _change_LABELS() {\n    this._applyLabelsAppearance();\n  },\n  _change_TILING: function _change_TILING() {\n    this._performTiling();\n  },\n  _change_LABELS_LAYOUT: function _change_LABELS_LAYOUT() {\n    this._performLabelsLayout();\n  },\n  _applyChanges: function _applyChanges() {\n    var that = this;\n    that.callBase.apply(that, arguments);\n\n    if (!that._isDataExpected) {\n      that._drawn();\n    }\n\n    that._context.forceReset = false;\n  },\n  _buildNodes: function _buildNodes() {\n    var that = this;\n    var root = that._root = that._topNode = new _node2.default();\n    var processedData;\n    root._id = 0;\n    root.parent = {};\n    root.data = {};\n    root.level = root.index = -1;\n    root.ctx = that._context;\n    root.label = null;\n    that._nodes = [root];\n\n    that._handlers.beginBuildNodes();\n\n    processedData = that._processDataSourceItems(that._dataSourceItems() || []);\n    traverseDataItems(root, processedData.items, 0, {\n      itemsField: !processedData.isPlain && that._getOption(\"childrenField\", true) || \"items\",\n      valueField: that._getOption(\"valueField\", true) || \"value\",\n      buildNode: that._handlers.buildNode,\n      ctx: that._context,\n      nodes: that._nodes\n    });\n\n    that._onNodesCreated();\n\n    that._handlers.endBuildNodes();\n\n    that._change([\"NODES_RESET\"]);\n  },\n  _onNodesCreated: _common2.noop,\n  _processDataSourceItems: function _processDataSourceItems(items) {\n    return {\n      items: items,\n      isPlain: false\n    };\n  },\n  _changeTileSettings: function _changeTileSettings() {\n    var that = this;\n\n    var options = that._getOption(\"tile\");\n\n    var offsets = that._rectOffsets;\n    var borderWidth = pickPositiveInteger(options.border.width);\n    var edgeOffset = borderWidth / 2;\n    var innerOffset = 1 & borderWidth ? .5 : 0;\n    var labelOptions = options.label;\n    var settings = that._context.settings[0];\n\n    that._change([\"TILES\", \"LABELS\"]);\n\n    settings.state = that._handlers.calculateState(options);\n    that._filter = that._filter || that._renderer.shadowFilter(\"-50%\", \"-50%\", \"200%\", \"200%\");\n\n    that._filter.attr(labelOptions.shadow);\n\n    that._calculateLabelSettings(settings, labelOptions, that._filter.id);\n\n    if (offsets.tileEdge !== edgeOffset || offsets.tileInner !== innerOffset) {\n      offsets.tileEdge = edgeOffset;\n      offsets.tileInner = innerOffset;\n\n      that._change([\"TILING\"]);\n    }\n  },\n  _changeGroupSettings: function _changeGroupSettings() {\n    var that = this;\n\n    var options = that._getOption(\"group\");\n\n    var labelOptions = options.label;\n    var offsets = that._rectOffsets;\n    var borderWidth = pickPositiveInteger(options.border.width);\n    var edgeOffset = borderWidth / 2;\n    var innerOffset = 1 & borderWidth ? .5 : 0;\n    var headerHeight = 0;\n    var groupPadding = pickPositiveInteger(options.padding);\n    var settings = that._context.settings[1];\n\n    that._change([\"TILES\", \"LABELS\"]);\n\n    settings.state = that._handlers.calculateState(options);\n\n    that._calculateLabelSettings(settings, labelOptions);\n\n    if (options.headerHeight >= 0) {\n      headerHeight = pickPositiveInteger(options.headerHeight);\n    } else {\n      headerHeight = settings.labelParams.height + 2 * pickPositiveInteger(labelOptions.paddingTopBottom);\n    }\n\n    if (that._headerHeight !== headerHeight) {\n      that._headerHeight = headerHeight;\n\n      that._change([\"TILING\"]);\n    }\n\n    if (that._groupPadding !== groupPadding) {\n      that._groupPadding = groupPadding;\n\n      that._change([\"TILING\"]);\n    }\n\n    if (offsets.headerEdge !== edgeOffset || offsets.headerInner !== innerOffset) {\n      offsets.headerEdge = edgeOffset;\n      offsets.headerInner = innerOffset;\n\n      that._change([\"TILING\"]);\n    }\n  },\n  _calculateLabelSettings: function _calculateLabelSettings(settings, options, filter) {\n    var bBox = this._getTextBBox(options.font);\n\n    var paddingLeftRight = pickPositiveInteger(options.paddingLeftRight);\n    var paddingTopBottom = pickPositiveInteger(options.paddingTopBottom);\n\n    var tileLabelOptions = this._getOption(\"tile.label\");\n\n    var groupLabelOptions = this._getOption(\"group.label\");\n\n    settings.labelState = (0, _common.buildTextAppearance)(options, filter);\n    settings.labelState.visible = !(\"visible\" in options) || !!options.visible;\n    settings.labelParams = {\n      height: bBox.height,\n      rtlEnabled: this._getOption(\"rtlEnabled\", true),\n      paddingTopBottom: paddingTopBottom,\n      paddingLeftRight: paddingLeftRight,\n      resolveLabelOverflow: this._getOptionByStealth(\"resolveLabelOverflow\"),\n      tileLabelWordWrap: tileLabelOptions.wordWrap,\n      tileLabelOverflow: tileLabelOptions.textOverflow,\n      groupLabelOverflow: groupLabelOptions.textOverflow\n    };\n  },\n  _changeMaxDepth: function _changeMaxDepth() {\n    var maxDepth = this._getOption(\"maxDepth\", true);\n\n    maxDepth = maxDepth >= 1 ? Math.round(maxDepth) : 1 / 0;\n\n    if (this._maxDepth !== maxDepth) {\n      this._maxDepth = maxDepth;\n\n      this._change([\"NODES_RESET\"]);\n    }\n  },\n  _resetNodes: function _resetNodes() {\n    var that = this;\n\n    that._tilesGroup.clear();\n\n    that._renderer.initHatching();\n\n    that._context.forceReset = true;\n    that._context.minLevel = that._topNode.level + 1;\n    that._context.maxLevel = that._context.minLevel + that._maxDepth - 1;\n\n    that._change([\"TILES\", \"LABELS\", \"TILING\"]);\n  },\n  _processNodes: function _processNodes(context, process) {\n    processNodes(context, this._topNode, process);\n  },\n  _applyTilesAppearance: function _applyTilesAppearance() {\n    var that = this;\n    var colorizer = (0, _colorizing.getColorizer)(that._getOption(\"colorizer\"), that._themeManager, that._topNode);\n\n    that._processNodes({\n      renderer: that._renderer,\n      group: that._tilesGroup,\n      setTrackerData: that._handlers.setTrackerData,\n      colorField: that._getOption(\"colorField\", true) || \"color\",\n      getColor: colorizer\n    }, processTileAppearance);\n  },\n  _applyLabelsAppearance: function _applyLabelsAppearance() {\n    var that = this;\n\n    that._labelsGroup.clear();\n\n    that._processNodes({\n      renderer: that._renderer,\n      group: that._labelsGroup,\n      setTrackerData: that._handlers.setTrackerData,\n      labelField: that._getOption(\"labelField\", true) || \"name\"\n    }, processLabelAppearance);\n\n    that._change([\"LABELS_LAYOUT\"]);\n  },\n  _performTiling: function _performTiling() {\n    var that = this;\n    var context = {\n      algorithm: (0, _tiling.getAlgorithm)(that._getOption(\"layoutAlgorithm\", true)),\n      directions: directions[String(that._getOption(\"layoutDirection\", true)).toLowerCase()] || directions.lefttoprightbottom,\n      headerHeight: that._headerHeight,\n      groupPadding: that._groupPadding,\n      rectOffsets: that._rectOffsets\n    };\n    that._topNode.innerRect = that._tilingRect;\n    calculateRects(context, that._topNode);\n\n    that._processNodes(context, processTiling);\n\n    that._change([\"LABELS_LAYOUT\"]);\n\n    that._onTilingPerformed();\n  },\n  _onTilingPerformed: _common2.noop,\n  _performLabelsLayout: function _performLabelsLayout() {\n    this._processNodes(null, processLabelsLayout);\n  },\n  _getTextBBox: function _getTextBBox(fontOptions) {\n    var renderer = this._renderer;\n    var text = this._textForCalculations || renderer.text(\"0\", 0, 0);\n    var bBox;\n    this._textForCalculations = text;\n    text.css((0, _utils.patchFontOptions)(fontOptions)).append(renderer.root);\n    bBox = text.getBBox();\n    text.remove();\n    return bBox;\n  }\n});\n\nfunction traverseDataItems(root, dataItems, level, params) {\n  var nodes = [];\n  var allNodes = params.nodes;\n  var node;\n  var i;\n  var ii = dataItems.length;\n  var dataItem;\n  var totalValue = 0;\n  var items;\n\n  for (i = 0; i < ii; ++i) {\n    dataItem = dataItems[i];\n    node = new _node2.default();\n    node._id = allNodes.length;\n    node.ctx = params.ctx;\n    node.parent = root;\n    node.level = level;\n    node.index = nodes.length;\n    node.data = dataItem;\n    params.buildNode(node);\n    allNodes.push(node);\n    nodes.push(node);\n    items = dataItem[params.itemsField];\n\n    if (items && items.length) {\n      traverseDataItems(node, items, level + 1, params);\n    }\n\n    if (dataItem[params.valueField] > 0) {\n      node.value = Number(dataItem[params.valueField]);\n    }\n\n    totalValue += node.value;\n  }\n\n  root.nodes = nodes;\n  root.value = totalValue;\n}\n\nfunction processNodes(context, root, process) {\n  var nodes = root.nodes;\n  var node;\n  var i;\n  var ii = nodes.length;\n\n  for (i = 0; i < ii; ++i) {\n    node = nodes[i];\n    process(context, node);\n\n    if (node.isNode()) {\n      processNodes(context, node, process);\n    }\n  }\n}\n\nfunction processTileAppearance(context, node) {\n  node.color = node.data[context.colorField] || context.getColor(node) || node.parent.color;\n  node.updateStyles();\n  node.tile = !node.ctx.forceReset && node.tile || createTile[Number(node.isNode())](context, node);\n  node.applyState();\n}\n\nvar createTile = [createLeaf, createGroup];\n\nfunction createLeaf(context, node) {\n  var tile = context.renderer.simpleRect().append(context.group);\n  context.setTrackerData(node, tile);\n  return tile;\n}\n\nfunction createGroup(context, node) {\n  var outer = context.renderer.simpleRect().append(context.group);\n  var inner = context.renderer.simpleRect().append(context.group);\n  context.setTrackerData(node, inner);\n  return {\n    outer: outer,\n    inner: inner\n  };\n}\n\nfunction processLabelAppearance(context, node) {\n  node.updateLabelStyle();\n\n  if (node.labelState.visible) {\n    createLabel(context, node, node.labelState, node.labelParams);\n  }\n}\n\nfunction createLabel(context, currentNode, settings, params) {\n  var textData = currentNode.data[context.labelField];\n  currentNode.label = textData ? String(textData) : null;\n  textData = currentNode.customLabel || currentNode.label;\n\n  if (textData) {\n    currentNode.text = context.renderer.text(textData).attr(settings.attr).css(settings.css).append(context.group);\n    context.setTrackerData(currentNode, currentNode.text);\n  }\n}\n\nvar emptyRect = [0, 0, 0, 0];\n\nfunction calculateRects(context, root) {\n  var nodes = root.nodes;\n  var items = [];\n  var rects = [];\n  var sum = 0;\n  var i;\n  var ii = items.length = rects.length = nodes.length;\n\n  for (i = 0; i < ii; ++i) {\n    sum += nodes[i].value;\n    items[i] = {\n      value: nodes[i].value,\n      i: i\n    };\n  }\n\n  if (sum > 0) {\n    context.algorithm({\n      items: items.slice(),\n      sum: sum,\n      rect: root.innerRect.slice(),\n      isRotated: 1 & nodes[0].level,\n      directions: context.directions\n    });\n  }\n\n  for (i = 0; i < ii; ++i) {\n    rects[i] = items[i].rect || emptyRect;\n  }\n\n  root.rects = rects;\n}\n\nfunction processTiling(context, node) {\n  var rect = node.parent.rects[node.index];\n  var rectOffsets = context.rectOffsets;\n  var headerHeight;\n\n  if (node.isNode()) {\n    setRectAttrs(node.tile.outer, buildTileRect(rect, node.parent.innerRect, rectOffsets.headerEdge, rectOffsets.headerInner));\n    rect = marginateRect(rect, context.groupPadding);\n    headerHeight = Math.min(context.headerHeight, rect[3] - rect[1]);\n    node.rect = [rect[0], rect[1], rect[2], rect[1] + headerHeight];\n    setRectAttrs(node.tile.inner, marginateRect(node.rect, rectOffsets.headerEdge));\n    rect[1] += headerHeight;\n    node.innerRect = rect;\n    calculateRects(context, node);\n  } else {\n    node.rect = rect;\n    setRectAttrs(node.tile, buildTileRect(rect, node.parent.innerRect, rectOffsets.tileEdge, rectOffsets.tileInner));\n  }\n}\n\nfunction marginateRect(rect, margin) {\n  return [rect[0] + margin, rect[1] + margin, rect[2] - margin, rect[3] - margin];\n}\n\nfunction buildTileRect(rect, outer, edgeOffset, innerOffset) {\n  return [rect[0] + (rect[0] === outer[0] ? edgeOffset : +innerOffset), rect[1] + (rect[1] === outer[1] ? edgeOffset : +innerOffset), rect[2] - (rect[2] === outer[2] ? edgeOffset : -innerOffset), rect[3] - (rect[3] === outer[3] ? edgeOffset : -innerOffset)];\n}\n\nfunction setRectAttrs(element, rect) {\n  element.attr({\n    x: rect[0],\n    y: rect[1],\n    width: _max(rect[2] - rect[0], 0),\n    height: _max(rect[3] - rect[1], 0)\n  });\n}\n\nfunction processLabelsLayout(context, node) {\n  if (node.text && node.labelState.visible) {\n    layoutTextNode(node, node.labelParams);\n  }\n}\n\nfunction layoutTextNode(node, params) {\n  var rect = node.rect;\n  var text = node.text;\n  var bBox = text.getBBox();\n  var paddingLeftRight = params.paddingLeftRight;\n  var paddingTopBottom = params.paddingTopBottom;\n  var effectiveWidth = rect[2] - rect[0] - 2 * paddingLeftRight;\n  var fitByHeight = bBox.height + paddingTopBottom <= rect[3] - rect[1];\n  var fitByWidth = bBox.width <= effectiveWidth;\n  var resolveLabelOverflow = params.resolveLabelOverflow;\n  var groupLabelOverflow = params.groupLabelOverflow;\n  var tileLabelOverflow = params.tileLabelOverflow;\n  var tileLabelWordWrap = params.tileLabelWordWrap;\n\n  if ((0, _type.isDefined)(resolveLabelOverflow)) {\n    if (\"ellipsis\" === resolveLabelOverflow && fitByHeight) {\n      text.setMaxSize(effectiveWidth, void 0, {\n        wordWrap: \"none\",\n        textOverflow: \"ellipsis\"\n      });\n\n      if (!fitByWidth) {\n        bBox = text.getBBox();\n        fitByWidth = bBox.width <= effectiveWidth;\n      }\n    }\n  } else {\n    fitByWidth = true;\n    fitByHeight = true;\n    text.setMaxSize(effectiveWidth, rect[3] - rect[1] - paddingTopBottom, node.isNode() ? {\n      textOverflow: groupLabelOverflow,\n      wordWrap: \"none\"\n    } : {\n      textOverflow: tileLabelOverflow,\n      wordWrap: tileLabelWordWrap,\n      hideOverflowEllipsis: true\n    });\n  }\n\n  text.attr({\n    visibility: fitByHeight && fitByWidth ? \"visible\" : \"hidden\"\n  });\n\n  if (fitByHeight && fitByWidth) {\n    text.move(params.rtlEnabled ? rect[2] - paddingLeftRight - bBox.x - bBox.width : rect[0] + paddingLeftRight - bBox.x, rect[1] + paddingTopBottom - bBox.y);\n  }\n}\n\nrequire(\"../../core/component_registrator\")(\"dxTreeMap\", dxTreeMap);\n\nmodule.exports = dxTreeMap;\ndxTreeMap.addPlugin(require(\"../core/data_source\").plugin);","map":{"version":3,"sources":["C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/devextreme/viz/tree_map/tree_map.base.js"],"names":["_common","require","_node","_node2","_interopRequireDefault","_tiling","_colorizing","_utils","_common2","_type","_extend2","obj","_max","Math","directions","lefttoprightbottom","leftbottomrighttop","righttopleftbottom","rightbottomlefttop","val","dxTreeMap","_handlers","beginBuildNodes","buildNode","endBuildNodes","setTrackerData","calculateState","_rootClass","_rootClassPrefix","_getDefaultSize","width","height","_setDeprecatedOptions","resolveLabelOverflow","since","message","_themeSection","_fontFields","_init","that","Object","suspend","resume","change","settings","calculateLabelState","buildTextAppearance","nodes","_initialChanges","_initCore","renderer","_createProxyType","_disposeCore","_applySize","rect","_optionChangesMap","dataSource","valueField","childrenField","colorField","colorizer","labelField","tile","group","maxDepth","layoutAlgorithm","layoutDirection","_themeDependentChanges","_changeDataSource","_dataSourceChangedHandler","_optionChangesOrder","_change_DATA_SOURCE","_change_TILE_SETTINGS","_change_GROUP_SETTINGS","_change_LABEL_OVERFLOW","_change_MAX_DEPTH","_customChangesOrder","_change_NODES_CREATE","_change_NODES_RESET","_change_TILES","_change_LABELS","_change_TILING","_change_LABELS_LAYOUT","_applyChanges","_buildNodes","root","processedData","traverseDataItems","itemsField","ctx","_nodes","_onNodesCreated","_processDataSourceItems","items","isPlain","_changeTileSettings","options","offsets","borderWidth","pickPositiveInteger","edgeOffset","innerOffset","labelOptions","_changeGroupSettings","headerHeight","groupPadding","_calculateLabelSettings","bBox","paddingLeftRight","paddingTopBottom","tileLabelOptions","groupLabelOptions","rtlEnabled","tileLabelWordWrap","tileLabelOverflow","groupLabelOverflow","textOverflow","_changeMaxDepth","_resetNodes","_processNodes","processNodes","_applyTilesAppearance","getColor","_applyLabelsAppearance","_performTiling","context","algorithm","String","rectOffsets","_rectOffsets","calculateRects","_onTilingPerformed","_performLabelsLayout","_getTextBBox","text","allNodes","params","ii","dataItems","totalValue","i","dataItem","node","level","Number","process","createTile","outer","inner","createLabel","textData","currentNode","emptyRect","rects","sum","value","isRotated","setRectAttrs","buildTileRect","marginateRect","element","x","y","layoutTextNode","effectiveWidth","fitByHeight","fitByWidth","wordWrap","hideOverflowEllipsis","visibility","module"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (viz/tree_map/tree_map.base.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar _common = require(\"./common\");\r\nvar _node = require(\"./node\");\r\nvar _node2 = _interopRequireDefault(_node);\r\nvar _tiling = require(\"./tiling\");\r\nvar _colorizing = require(\"./colorizing\");\r\nvar _utils = require(\"../core/utils\");\r\nvar _common2 = require(\"../../core/utils/common\");\r\nvar _type = require(\"../../core/utils/type\");\r\nvar _extend2 = require(\"../../core/utils/extend\");\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\nvar _max = Math.max;\r\nvar directions = {\r\n    lefttoprightbottom: [1, 1],\r\n    leftbottomrighttop: [1, -1],\r\n    righttopleftbottom: [-1, 1],\r\n    rightbottomlefttop: [-1, -1]\r\n};\r\nrequire(\"./tiling.squarified\");\r\nrequire(\"./tiling\").setDefaultAlgorithm(\"squarified\");\r\nrequire(\"./colorizing.discrete\");\r\nrequire(\"./colorizing\").setDefaultColorizer(\"discrete\");\r\n\r\nfunction pickPositiveInteger(val) {\r\n    return val > 0 ? Math.round(val) : 0\r\n}\r\nvar dxTreeMap = require(\"../core/base_widget\").inherit({\r\n    _handlers: {\r\n        beginBuildNodes: _common2.noop,\r\n        buildNode: _common2.noop,\r\n        endBuildNodes: _common2.noop,\r\n        setTrackerData: _common2.noop,\r\n        calculateState: function(options) {\r\n            return (0, _common.buildRectAppearance)(options)\r\n        }\r\n    },\r\n    _rootClass: \"dxtm-tree-map\",\r\n    _rootClassPrefix: \"dxtm\",\r\n    _getDefaultSize: function() {\r\n        return {\r\n            width: 400,\r\n            height: 400\r\n        }\r\n    },\r\n    _setDeprecatedOptions: function() {\r\n        this.callBase.apply(this, arguments);\r\n        (0, _extend2.extend)(this._deprecatedOptions, {\r\n            resolveLabelOverflow: {\r\n                since: \"19.1\",\r\n                message: \"Use the 'tile.label.overflow' and 'group.label.textOverflow' option instead\"\r\n            }\r\n        })\r\n    },\r\n    _themeSection: \"treeMap\",\r\n    _fontFields: [\"tile.label.font\", \"group.label.font\"],\r\n    _init: function() {\r\n        var that = this;\r\n        that._rectOffsets = {};\r\n        that._handlers = Object.create(that._handlers);\r\n        that._context = {\r\n            suspend: function() {\r\n                if (!that._applyingChanges) {\r\n                    that._suspendChanges()\r\n                }\r\n            },\r\n            resume: function() {\r\n                if (!that._applyingChanges) {\r\n                    that._resumeChanges()\r\n                }\r\n            },\r\n            change: function(codes) {\r\n                that._change(codes)\r\n            },\r\n            settings: [{}, {}],\r\n            calculateState: that._handlers.calculateState,\r\n            calculateLabelState: _common.buildTextAppearance\r\n        };\r\n        that._root = that._topNode = {\r\n            nodes: []\r\n        };\r\n        that.callBase.apply(that, arguments)\r\n    },\r\n    _initialChanges: [\"DATA_SOURCE\"],\r\n    _initCore: function() {\r\n        var that = this;\r\n        var renderer = that._renderer;\r\n        that._createProxyType();\r\n        that._tilesGroup = renderer.g().linkOn(renderer.root, \"tiles\").linkAppend();\r\n        that._labelsGroup = renderer.g().linkOn(renderer.root, \"labels\").linkAppend()\r\n    },\r\n    _createProxyType: _common2.noop,\r\n    _disposeCore: function() {\r\n        var that = this;\r\n        that._filter && that._filter.dispose();\r\n        that._labelsGroup.linkOff();\r\n        that._tilesGroup.linkOff()\r\n    },\r\n    _applySize: function(rect) {\r\n        this._tilingRect = rect.slice();\r\n        this._change([\"TILING\"])\r\n    },\r\n    _optionChangesMap: {\r\n        dataSource: \"DATA_SOURCE\",\r\n        valueField: \"NODES_CREATE\",\r\n        childrenField: \"NODES_CREATE\",\r\n        colorField: \"TILES\",\r\n        colorizer: \"TILES\",\r\n        labelField: \"LABELS\",\r\n        tile: \"TILE_SETTINGS\",\r\n        group: \"GROUP_SETTINGS\",\r\n        maxDepth: \"MAX_DEPTH\",\r\n        layoutAlgorithm: \"TILING\",\r\n        layoutDirection: \"TILING\",\r\n        resolveLabelOverflow: \"LABEL_OVERFLOW\"\r\n    },\r\n    _themeDependentChanges: [\"TILE_SETTINGS\", \"GROUP_SETTINGS\", \"MAX_DEPTH\"],\r\n    _changeDataSource: function() {\r\n        var that = this;\r\n        that._isDataExpected = that._isSyncData = true;\r\n        that._updateDataSource();\r\n        that._isSyncData = false;\r\n        if (that._isDataExpected) {\r\n            that._suspendChanges()\r\n        }\r\n    },\r\n    _dataSourceChangedHandler: function() {\r\n        var that = this;\r\n        if (that._isDataExpected) {\r\n            that._isDataExpected = false;\r\n            that._change([\"NODES_CREATE\"]);\r\n            if (!that._isSyncData) {\r\n                that._resumeChanges()\r\n            }\r\n        } else {\r\n            that._requestChange([\"NODES_CREATE\"])\r\n        }\r\n    },\r\n    _optionChangesOrder: [\"DATA_SOURCE\", \"TILE_SETTINGS\", \"GROUP_SETTINGS\", \"MAX_DEPTH\", \"LABEL_OVERFLOW\"],\r\n    _change_DATA_SOURCE: function() {\r\n        this._changeDataSource()\r\n    },\r\n    _change_TILE_SETTINGS: function() {\r\n        this._changeTileSettings()\r\n    },\r\n    _change_GROUP_SETTINGS: function() {\r\n        this._changeGroupSettings()\r\n    },\r\n    _change_LABEL_OVERFLOW: function() {\r\n        this._changeTileSettings();\r\n        this._changeGroupSettings()\r\n    },\r\n    _change_MAX_DEPTH: function() {\r\n        this._changeMaxDepth()\r\n    },\r\n    _customChangesOrder: [\"NODES_CREATE\", \"NODES_RESET\", \"TILES\", \"LABELS\", \"TILING\", \"LABELS_LAYOUT\"],\r\n    _change_NODES_CREATE: function() {\r\n        this._buildNodes()\r\n    },\r\n    _change_NODES_RESET: function() {\r\n        this._resetNodes()\r\n    },\r\n    _change_TILES: function() {\r\n        this._applyTilesAppearance()\r\n    },\r\n    _change_LABELS: function() {\r\n        this._applyLabelsAppearance()\r\n    },\r\n    _change_TILING: function() {\r\n        this._performTiling()\r\n    },\r\n    _change_LABELS_LAYOUT: function() {\r\n        this._performLabelsLayout()\r\n    },\r\n    _applyChanges: function() {\r\n        var that = this;\r\n        that.callBase.apply(that, arguments);\r\n        if (!that._isDataExpected) {\r\n            that._drawn()\r\n        }\r\n        that._context.forceReset = false\r\n    },\r\n    _buildNodes: function() {\r\n        var that = this;\r\n        var root = that._root = that._topNode = new _node2.default;\r\n        var processedData;\r\n        root._id = 0;\r\n        root.parent = {};\r\n        root.data = {};\r\n        root.level = root.index = -1;\r\n        root.ctx = that._context;\r\n        root.label = null;\r\n        that._nodes = [root];\r\n        that._handlers.beginBuildNodes();\r\n        processedData = that._processDataSourceItems(that._dataSourceItems() || []);\r\n        traverseDataItems(root, processedData.items, 0, {\r\n            itemsField: !processedData.isPlain && that._getOption(\"childrenField\", true) || \"items\",\r\n            valueField: that._getOption(\"valueField\", true) || \"value\",\r\n            buildNode: that._handlers.buildNode,\r\n            ctx: that._context,\r\n            nodes: that._nodes\r\n        });\r\n        that._onNodesCreated();\r\n        that._handlers.endBuildNodes();\r\n        that._change([\"NODES_RESET\"])\r\n    },\r\n    _onNodesCreated: _common2.noop,\r\n    _processDataSourceItems: function(items) {\r\n        return {\r\n            items: items,\r\n            isPlain: false\r\n        }\r\n    },\r\n    _changeTileSettings: function() {\r\n        var that = this;\r\n        var options = that._getOption(\"tile\");\r\n        var offsets = that._rectOffsets;\r\n        var borderWidth = pickPositiveInteger(options.border.width);\r\n        var edgeOffset = borderWidth / 2;\r\n        var innerOffset = 1 & borderWidth ? .5 : 0;\r\n        var labelOptions = options.label;\r\n        var settings = that._context.settings[0];\r\n        that._change([\"TILES\", \"LABELS\"]);\r\n        settings.state = that._handlers.calculateState(options);\r\n        that._filter = that._filter || that._renderer.shadowFilter(\"-50%\", \"-50%\", \"200%\", \"200%\");\r\n        that._filter.attr(labelOptions.shadow);\r\n        that._calculateLabelSettings(settings, labelOptions, that._filter.id);\r\n        if (offsets.tileEdge !== edgeOffset || offsets.tileInner !== innerOffset) {\r\n            offsets.tileEdge = edgeOffset;\r\n            offsets.tileInner = innerOffset;\r\n            that._change([\"TILING\"])\r\n        }\r\n    },\r\n    _changeGroupSettings: function() {\r\n        var that = this;\r\n        var options = that._getOption(\"group\");\r\n        var labelOptions = options.label;\r\n        var offsets = that._rectOffsets;\r\n        var borderWidth = pickPositiveInteger(options.border.width);\r\n        var edgeOffset = borderWidth / 2;\r\n        var innerOffset = 1 & borderWidth ? .5 : 0;\r\n        var headerHeight = 0;\r\n        var groupPadding = pickPositiveInteger(options.padding);\r\n        var settings = that._context.settings[1];\r\n        that._change([\"TILES\", \"LABELS\"]);\r\n        settings.state = that._handlers.calculateState(options);\r\n        that._calculateLabelSettings(settings, labelOptions);\r\n        if (options.headerHeight >= 0) {\r\n            headerHeight = pickPositiveInteger(options.headerHeight)\r\n        } else {\r\n            headerHeight = settings.labelParams.height + 2 * pickPositiveInteger(labelOptions.paddingTopBottom)\r\n        }\r\n        if (that._headerHeight !== headerHeight) {\r\n            that._headerHeight = headerHeight;\r\n            that._change([\"TILING\"])\r\n        }\r\n        if (that._groupPadding !== groupPadding) {\r\n            that._groupPadding = groupPadding;\r\n            that._change([\"TILING\"])\r\n        }\r\n        if (offsets.headerEdge !== edgeOffset || offsets.headerInner !== innerOffset) {\r\n            offsets.headerEdge = edgeOffset;\r\n            offsets.headerInner = innerOffset;\r\n            that._change([\"TILING\"])\r\n        }\r\n    },\r\n    _calculateLabelSettings: function(settings, options, filter) {\r\n        var bBox = this._getTextBBox(options.font);\r\n        var paddingLeftRight = pickPositiveInteger(options.paddingLeftRight);\r\n        var paddingTopBottom = pickPositiveInteger(options.paddingTopBottom);\r\n        var tileLabelOptions = this._getOption(\"tile.label\");\r\n        var groupLabelOptions = this._getOption(\"group.label\");\r\n        settings.labelState = (0, _common.buildTextAppearance)(options, filter);\r\n        settings.labelState.visible = !(\"visible\" in options) || !!options.visible;\r\n        settings.labelParams = {\r\n            height: bBox.height,\r\n            rtlEnabled: this._getOption(\"rtlEnabled\", true),\r\n            paddingTopBottom: paddingTopBottom,\r\n            paddingLeftRight: paddingLeftRight,\r\n            resolveLabelOverflow: this._getOptionByStealth(\"resolveLabelOverflow\"),\r\n            tileLabelWordWrap: tileLabelOptions.wordWrap,\r\n            tileLabelOverflow: tileLabelOptions.textOverflow,\r\n            groupLabelOverflow: groupLabelOptions.textOverflow\r\n        }\r\n    },\r\n    _changeMaxDepth: function() {\r\n        var maxDepth = this._getOption(\"maxDepth\", true);\r\n        maxDepth = maxDepth >= 1 ? Math.round(maxDepth) : 1 / 0;\r\n        if (this._maxDepth !== maxDepth) {\r\n            this._maxDepth = maxDepth;\r\n            this._change([\"NODES_RESET\"])\r\n        }\r\n    },\r\n    _resetNodes: function() {\r\n        var that = this;\r\n        that._tilesGroup.clear();\r\n        that._renderer.initHatching();\r\n        that._context.forceReset = true;\r\n        that._context.minLevel = that._topNode.level + 1;\r\n        that._context.maxLevel = that._context.minLevel + that._maxDepth - 1;\r\n        that._change([\"TILES\", \"LABELS\", \"TILING\"])\r\n    },\r\n    _processNodes: function(context, process) {\r\n        processNodes(context, this._topNode, process)\r\n    },\r\n    _applyTilesAppearance: function() {\r\n        var that = this;\r\n        var colorizer = (0, _colorizing.getColorizer)(that._getOption(\"colorizer\"), that._themeManager, that._topNode);\r\n        that._processNodes({\r\n            renderer: that._renderer,\r\n            group: that._tilesGroup,\r\n            setTrackerData: that._handlers.setTrackerData,\r\n            colorField: that._getOption(\"colorField\", true) || \"color\",\r\n            getColor: colorizer\r\n        }, processTileAppearance)\r\n    },\r\n    _applyLabelsAppearance: function() {\r\n        var that = this;\r\n        that._labelsGroup.clear();\r\n        that._processNodes({\r\n            renderer: that._renderer,\r\n            group: that._labelsGroup,\r\n            setTrackerData: that._handlers.setTrackerData,\r\n            labelField: that._getOption(\"labelField\", true) || \"name\"\r\n        }, processLabelAppearance);\r\n        that._change([\"LABELS_LAYOUT\"])\r\n    },\r\n    _performTiling: function() {\r\n        var that = this;\r\n        var context = {\r\n            algorithm: (0, _tiling.getAlgorithm)(that._getOption(\"layoutAlgorithm\", true)),\r\n            directions: directions[String(that._getOption(\"layoutDirection\", true)).toLowerCase()] || directions.lefttoprightbottom,\r\n            headerHeight: that._headerHeight,\r\n            groupPadding: that._groupPadding,\r\n            rectOffsets: that._rectOffsets\r\n        };\r\n        that._topNode.innerRect = that._tilingRect;\r\n        calculateRects(context, that._topNode);\r\n        that._processNodes(context, processTiling);\r\n        that._change([\"LABELS_LAYOUT\"]);\r\n        that._onTilingPerformed()\r\n    },\r\n    _onTilingPerformed: _common2.noop,\r\n    _performLabelsLayout: function() {\r\n        this._processNodes(null, processLabelsLayout)\r\n    },\r\n    _getTextBBox: function(fontOptions) {\r\n        var renderer = this._renderer;\r\n        var text = this._textForCalculations || renderer.text(\"0\", 0, 0);\r\n        var bBox;\r\n        this._textForCalculations = text;\r\n        text.css((0, _utils.patchFontOptions)(fontOptions)).append(renderer.root);\r\n        bBox = text.getBBox();\r\n        text.remove();\r\n        return bBox\r\n    }\r\n});\r\n\r\nfunction traverseDataItems(root, dataItems, level, params) {\r\n    var nodes = [];\r\n    var allNodes = params.nodes;\r\n    var node;\r\n    var i;\r\n    var ii = dataItems.length;\r\n    var dataItem;\r\n    var totalValue = 0;\r\n    var items;\r\n    for (i = 0; i < ii; ++i) {\r\n        dataItem = dataItems[i];\r\n        node = new _node2.default;\r\n        node._id = allNodes.length;\r\n        node.ctx = params.ctx;\r\n        node.parent = root;\r\n        node.level = level;\r\n        node.index = nodes.length;\r\n        node.data = dataItem;\r\n        params.buildNode(node);\r\n        allNodes.push(node);\r\n        nodes.push(node);\r\n        items = dataItem[params.itemsField];\r\n        if (items && items.length) {\r\n            traverseDataItems(node, items, level + 1, params)\r\n        }\r\n        if (dataItem[params.valueField] > 0) {\r\n            node.value = Number(dataItem[params.valueField])\r\n        }\r\n        totalValue += node.value\r\n    }\r\n    root.nodes = nodes;\r\n    root.value = totalValue\r\n}\r\n\r\nfunction processNodes(context, root, process) {\r\n    var nodes = root.nodes;\r\n    var node;\r\n    var i;\r\n    var ii = nodes.length;\r\n    for (i = 0; i < ii; ++i) {\r\n        node = nodes[i];\r\n        process(context, node);\r\n        if (node.isNode()) {\r\n            processNodes(context, node, process)\r\n        }\r\n    }\r\n}\r\n\r\nfunction processTileAppearance(context, node) {\r\n    node.color = node.data[context.colorField] || context.getColor(node) || node.parent.color;\r\n    node.updateStyles();\r\n    node.tile = !node.ctx.forceReset && node.tile || createTile[Number(node.isNode())](context, node);\r\n    node.applyState()\r\n}\r\nvar createTile = [createLeaf, createGroup];\r\n\r\nfunction createLeaf(context, node) {\r\n    var tile = context.renderer.simpleRect().append(context.group);\r\n    context.setTrackerData(node, tile);\r\n    return tile\r\n}\r\n\r\nfunction createGroup(context, node) {\r\n    var outer = context.renderer.simpleRect().append(context.group);\r\n    var inner = context.renderer.simpleRect().append(context.group);\r\n    context.setTrackerData(node, inner);\r\n    return {\r\n        outer: outer,\r\n        inner: inner\r\n    }\r\n}\r\n\r\nfunction processLabelAppearance(context, node) {\r\n    node.updateLabelStyle();\r\n    if (node.labelState.visible) {\r\n        createLabel(context, node, node.labelState, node.labelParams)\r\n    }\r\n}\r\n\r\nfunction createLabel(context, currentNode, settings, params) {\r\n    var textData = currentNode.data[context.labelField];\r\n    currentNode.label = textData ? String(textData) : null;\r\n    textData = currentNode.customLabel || currentNode.label;\r\n    if (textData) {\r\n        currentNode.text = context.renderer.text(textData).attr(settings.attr).css(settings.css).append(context.group);\r\n        context.setTrackerData(currentNode, currentNode.text)\r\n    }\r\n}\r\nvar emptyRect = [0, 0, 0, 0];\r\n\r\nfunction calculateRects(context, root) {\r\n    var nodes = root.nodes;\r\n    var items = [];\r\n    var rects = [];\r\n    var sum = 0;\r\n    var i;\r\n    var ii = items.length = rects.length = nodes.length;\r\n    for (i = 0; i < ii; ++i) {\r\n        sum += nodes[i].value;\r\n        items[i] = {\r\n            value: nodes[i].value,\r\n            i: i\r\n        }\r\n    }\r\n    if (sum > 0) {\r\n        context.algorithm({\r\n            items: items.slice(),\r\n            sum: sum,\r\n            rect: root.innerRect.slice(),\r\n            isRotated: 1 & nodes[0].level,\r\n            directions: context.directions\r\n        })\r\n    }\r\n    for (i = 0; i < ii; ++i) {\r\n        rects[i] = items[i].rect || emptyRect\r\n    }\r\n    root.rects = rects\r\n}\r\n\r\nfunction processTiling(context, node) {\r\n    var rect = node.parent.rects[node.index];\r\n    var rectOffsets = context.rectOffsets;\r\n    var headerHeight;\r\n    if (node.isNode()) {\r\n        setRectAttrs(node.tile.outer, buildTileRect(rect, node.parent.innerRect, rectOffsets.headerEdge, rectOffsets.headerInner));\r\n        rect = marginateRect(rect, context.groupPadding);\r\n        headerHeight = Math.min(context.headerHeight, rect[3] - rect[1]);\r\n        node.rect = [rect[0], rect[1], rect[2], rect[1] + headerHeight];\r\n        setRectAttrs(node.tile.inner, marginateRect(node.rect, rectOffsets.headerEdge));\r\n        rect[1] += headerHeight;\r\n        node.innerRect = rect;\r\n        calculateRects(context, node)\r\n    } else {\r\n        node.rect = rect;\r\n        setRectAttrs(node.tile, buildTileRect(rect, node.parent.innerRect, rectOffsets.tileEdge, rectOffsets.tileInner))\r\n    }\r\n}\r\n\r\nfunction marginateRect(rect, margin) {\r\n    return [rect[0] + margin, rect[1] + margin, rect[2] - margin, rect[3] - margin]\r\n}\r\n\r\nfunction buildTileRect(rect, outer, edgeOffset, innerOffset) {\r\n    return [rect[0] + (rect[0] === outer[0] ? edgeOffset : +innerOffset), rect[1] + (rect[1] === outer[1] ? edgeOffset : +innerOffset), rect[2] - (rect[2] === outer[2] ? edgeOffset : -innerOffset), rect[3] - (rect[3] === outer[3] ? edgeOffset : -innerOffset)]\r\n}\r\n\r\nfunction setRectAttrs(element, rect) {\r\n    element.attr({\r\n        x: rect[0],\r\n        y: rect[1],\r\n        width: _max(rect[2] - rect[0], 0),\r\n        height: _max(rect[3] - rect[1], 0)\r\n    })\r\n}\r\n\r\nfunction processLabelsLayout(context, node) {\r\n    if (node.text && node.labelState.visible) {\r\n        layoutTextNode(node, node.labelParams)\r\n    }\r\n}\r\n\r\nfunction layoutTextNode(node, params) {\r\n    var rect = node.rect;\r\n    var text = node.text;\r\n    var bBox = text.getBBox();\r\n    var paddingLeftRight = params.paddingLeftRight;\r\n    var paddingTopBottom = params.paddingTopBottom;\r\n    var effectiveWidth = rect[2] - rect[0] - 2 * paddingLeftRight;\r\n    var fitByHeight = bBox.height + paddingTopBottom <= rect[3] - rect[1];\r\n    var fitByWidth = bBox.width <= effectiveWidth;\r\n    var resolveLabelOverflow = params.resolveLabelOverflow;\r\n    var groupLabelOverflow = params.groupLabelOverflow;\r\n    var tileLabelOverflow = params.tileLabelOverflow;\r\n    var tileLabelWordWrap = params.tileLabelWordWrap;\r\n    if ((0, _type.isDefined)(resolveLabelOverflow)) {\r\n        if (\"ellipsis\" === resolveLabelOverflow && fitByHeight) {\r\n            text.setMaxSize(effectiveWidth, void 0, {\r\n                wordWrap: \"none\",\r\n                textOverflow: \"ellipsis\"\r\n            });\r\n            if (!fitByWidth) {\r\n                bBox = text.getBBox();\r\n                fitByWidth = bBox.width <= effectiveWidth\r\n            }\r\n        }\r\n    } else {\r\n        fitByWidth = true;\r\n        fitByHeight = true;\r\n        text.setMaxSize(effectiveWidth, rect[3] - rect[1] - paddingTopBottom, node.isNode() ? {\r\n            textOverflow: groupLabelOverflow,\r\n            wordWrap: \"none\"\r\n        } : {\r\n            textOverflow: tileLabelOverflow,\r\n            wordWrap: tileLabelWordWrap,\r\n            hideOverflowEllipsis: true\r\n        })\r\n    }\r\n    text.attr({\r\n        visibility: fitByHeight && fitByWidth ? \"visible\" : \"hidden\"\r\n    });\r\n    if (fitByHeight && fitByWidth) {\r\n        text.move(params.rtlEnabled ? rect[2] - paddingLeftRight - bBox.x - bBox.width : rect[0] + paddingLeftRight - bBox.x, rect[1] + paddingTopBottom - bBox.y)\r\n    }\r\n}\r\nrequire(\"../../core/component_registrator\")(\"dxTreeMap\", dxTreeMap);\r\nmodule.exports = dxTreeMap;\r\ndxTreeMap.addPlugin(require(\"../core/data_source\").plugin);\r\n"]},"metadata":{},"sourceType":"module"}