{"ast":null,"code":"/**\r\n * DevExtreme (ui/grid_core/ui.grid_core.columns_resizing_reordering.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar _renderer = require(\"../../core/renderer\");\n\nvar _renderer2 = _interopRequireDefault(_renderer);\n\nvar _dom_adapter = require(\"../../core/dom_adapter\");\n\nvar _dom_adapter2 = _interopRequireDefault(_dom_adapter);\n\nvar _events_engine = require(\"../../events/core/events_engine\");\n\nvar _events_engine2 = _interopRequireDefault(_events_engine);\n\nvar _callbacks = require(\"../../core/utils/callbacks\");\n\nvar _callbacks2 = _interopRequireDefault(_callbacks);\n\nvar _type = require(\"../../core/utils/type\");\n\nvar _type2 = _interopRequireDefault(_type);\n\nvar _iterator = require(\"../../core/utils/iterator\");\n\nvar _extend = require(\"../../core/utils/extend\");\n\nvar _utils = require(\"../../events/utils\");\n\nvar _pointer = require(\"../../events/pointer\");\n\nvar _pointer2 = _interopRequireDefault(_pointer);\n\nvar _drag = require(\"../../events/drag\");\n\nvar _drag2 = _interopRequireDefault(_drag);\n\nvar _uiGrid_core = require(\"./ui.grid_core.modules\");\n\nvar _uiGrid_core2 = _interopRequireDefault(_uiGrid_core);\n\nvar _uiGrid_core3 = require(\"./ui.grid_core.utils\");\n\nvar _uiGrid_core4 = _interopRequireDefault(_uiGrid_core3);\n\nvar _fx = require(\"../../animation/fx\");\n\nvar _fx2 = _interopRequireDefault(_fx);\n\nvar _swatch_container = require(\"../widget/swatch_container\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nvar COLUMNS_SEPARATOR_CLASS = \"columns-separator\";\nvar COLUMNS_SEPARATOR_TRANSPARENT = \"columns-separator-transparent\";\nvar DRAGGING_HEADER_CLASS = \"drag-header\";\nvar CELL_CONTENT_CLASS = \"text-content\";\nvar HEADERS_DRAG_ACTION_CLASS = \"drag-action\";\nvar TRACKER_CLASS = \"tracker\";\nvar HEADERS_DROP_HIGHLIGHT_CLASS = \"drop-highlight\";\nvar BLOCK_SEPARATOR_CLASS = \"dx-block-separator\";\nvar HEADER_ROW_CLASS = \"dx-header-row\";\nvar WIDGET_CLASS = \"dx-widget\";\nvar DRAGGING_COMMAND_CELL_CLASS = \"dx-drag-command-cell\";\nvar MODULE_NAMESPACE = \"dxDataGridResizingReordering\";\nvar COLUMNS_SEPARATOR_TOUCH_TRACKER_WIDTH = 10;\nvar DRAGGING_DELTA = 5;\nvar COLUMN_OPACITY = .5;\n\nvar allowResizing = function allowResizing(that) {\n  return that.option(\"allowColumnResizing\") || that.getController(\"columns\").isColumnOptionUsed(\"allowResizing\");\n};\n\nvar allowReordering = function allowReordering(that) {\n  return that.option(\"allowColumnReordering\") || that.getController(\"columns\").isColumnOptionUsed(\"allowReordering\");\n};\n\nvar TrackerView = _uiGrid_core2.default.View.inherit({\n  _renderCore: function _renderCore() {\n    this.callBase();\n    this.element().addClass(this.addWidgetPrefix(TRACKER_CLASS));\n    this.hide();\n  },\n  _unsubscribeFromCallback: function _unsubscribeFromCallback() {\n    if (this._positionChanged) {\n      this._tablePositionController.positionChanged.remove(this._positionChanged);\n    }\n  },\n  _subscribeToCallback: function _subscribeToCallback() {\n    var that = this;\n\n    that._positionChanged = function (position) {\n      var $element = that.element();\n\n      if ($element && $element.hasClass(that.addWidgetPrefix(TRACKER_CLASS))) {\n        $element.css({\n          top: position.top\n        });\n        $element.height(position.height);\n      }\n    };\n\n    this._tablePositionController.positionChanged.add(that._positionChanged);\n  },\n  optionChanged: function optionChanged(args) {\n    if (\"allowColumnResizing\" === args.name) {\n      this._unsubscribeFromCallback();\n\n      if (args.value) {\n        this._subscribeToCallback();\n\n        this._invalidate();\n      }\n    }\n\n    this.callBase(args);\n  },\n  init: function init() {\n    this.callBase();\n    this._tablePositionController = this.getController(\"tablePosition\");\n\n    this._subscribeToCallback();\n  },\n  isVisible: function isVisible() {\n    return allowResizing(this);\n  },\n  show: function show() {\n    this.element().show();\n  },\n  hide: function hide() {\n    this.element() && this.element().hide();\n  },\n  setHeight: function setHeight(value) {\n    this.element().height(value);\n  },\n  dispose: function dispose() {\n    this._unsubscribeFromCallback();\n\n    this.callBase();\n  }\n});\n\nvar SeparatorView = _uiGrid_core2.default.View.inherit({\n  _renderSeparator: function _renderSeparator() {},\n  _renderCore: function _renderCore(options) {\n    this.callBase(options);\n    this._isShown = true;\n\n    this._renderSeparator();\n\n    this.hide();\n  },\n  show: function show() {\n    this._isShown = true;\n  },\n  hide: function hide() {\n    this._isShown = false;\n  },\n  height: function height(value) {\n    var $element = this.element();\n\n    if ($element) {\n      if (_type2.default.isDefined(value)) {\n        $element.height(value);\n      } else {\n        return $element.height();\n      }\n    }\n  },\n  width: function width(value) {\n    var $element = this.element();\n\n    if ($element) {\n      if (_type2.default.isDefined(value)) {\n        $element.width(value);\n      } else {\n        return $element.width();\n      }\n    }\n  }\n});\n\nvar ColumnsSeparatorView = SeparatorView.inherit({\n  _renderSeparator: function _renderSeparator() {\n    this.callBase();\n    var $element = this.element();\n    $element.addClass(this.addWidgetPrefix(COLUMNS_SEPARATOR_CLASS));\n  },\n  _subscribeToCallback: function _subscribeToCallback() {\n    var that = this;\n    var $element;\n\n    that._positionChanged = function (position) {\n      $element = that.element();\n\n      if ($element) {\n        $element.css({\n          top: position.top\n        });\n        $element.height(position.height);\n      }\n    };\n\n    that._tablePositionController.positionChanged.add(that._positionChanged);\n  },\n  _unsubscribeFromCallback: function _unsubscribeFromCallback() {\n    this._positionChanged && this._tablePositionController.positionChanged.remove(this._positionChanged);\n  },\n  _init: function _init() {\n    this._isTransparent = allowResizing(this);\n\n    if (this.isVisible()) {\n      this._subscribeToCallback();\n    }\n  },\n  isVisible: function isVisible() {\n    return this.option(\"showColumnHeaders\") && (allowReordering(this) || allowResizing(this));\n  },\n  optionChanged: function optionChanged(args) {\n    if (\"allowColumnResizing\" === args.name) {\n      if (args.value) {\n        this._init();\n\n        this._invalidate();\n\n        this.hide(true);\n      } else {\n        this._unsubscribeFromCallback();\n\n        this._isTransparent = allowResizing(this);\n        this.hide(true);\n      }\n    }\n\n    this.callBase(args);\n  },\n  init: function init() {\n    this.callBase();\n    this._tablePositionController = this.getController(\"tablePosition\");\n\n    this._init();\n  },\n  show: function show() {\n    var that = this;\n    var $element = this.element();\n\n    if ($element && !that._isShown) {\n      if (that._isTransparent) {\n        $element.removeClass(that.addWidgetPrefix(COLUMNS_SEPARATOR_TRANSPARENT));\n      } else {\n        $element.show();\n      }\n    }\n\n    this.callBase();\n  },\n  hide: function hide(force) {\n    var $element = this.element();\n    var columnsSeparatorTransparent = this.addWidgetPrefix(COLUMNS_SEPARATOR_TRANSPARENT);\n\n    if ($element && (this._isShown || force)) {\n      if (this._isTransparent) {\n        $element.addClass(columnsSeparatorTransparent);\n        $element.css(\"left\", \"\");\n        $element.show();\n      } else {\n        if ($element.hasClass(columnsSeparatorTransparent)) {\n          $element.removeClass(columnsSeparatorTransparent);\n        }\n\n        $element.hide();\n      }\n    }\n\n    this.callBase();\n  },\n  moveByX: function moveByX(outerX) {\n    var $element = this.element();\n\n    if ($element) {\n      $element.css(\"left\", outerX - this._parentElement().offset().left);\n    }\n  },\n  changeCursor: function changeCursor(cursorName) {\n    cursorName = _type2.default.isDefined(cursorName) ? cursorName : \"\";\n    var $element = this.element();\n\n    if ($element) {\n      $element.css(\"cursor\", cursorName);\n    }\n  },\n  dispose: function dispose() {\n    this._unsubscribeFromCallback();\n\n    this.callBase();\n  }\n});\nvar BlockSeparatorView = SeparatorView.inherit({\n  init: function init() {\n    var that = this;\n    this.callBase();\n    this.getController(\"data\").loadingChanged.add(function (isLoading) {\n      if (!isLoading) {\n        that.hide();\n      }\n    });\n  },\n  _renderSeparator: function _renderSeparator() {\n    this.callBase();\n    this.element().addClass(BLOCK_SEPARATOR_CLASS).html(\"&nbsp;\");\n  },\n  hide: function hide() {\n    var that = this;\n\n    var $parent = this._parentElement();\n\n    var $element = this.element();\n\n    if ($element && this._isShown) {\n      $element.css(\"display\", \"none\");\n    }\n\n    if ($parent && !$parent.children(\".\" + BLOCK_SEPARATOR_CLASS).length) {\n      $parent.prepend(that.element());\n    }\n\n    that.callBase();\n  },\n  isVisible: function isVisible() {\n    var groupPanelOptions = this.option(\"groupPanel\");\n    var columnChooserOptions = this.option(\"columnChooser\");\n    return groupPanelOptions && groupPanelOptions.visible || columnChooserOptions && columnChooserOptions.enabled;\n  },\n  show: function show(targetLocation) {\n    var that = this;\n    var $element = this.element();\n\n    var startAnimate = function startAnimate(toOptions) {\n      _fx2.default.stop($element, true);\n\n      _fx2.default.animate($element, {\n        type: \"slide\",\n        from: {\n          width: 0,\n          display: toOptions.display\n        },\n        to: toOptions,\n        duration: 300,\n        easing: \"swing\"\n      });\n    };\n\n    if ($element && !that._isShown) {\n      switch (targetLocation) {\n        case \"group\":\n          startAnimate({\n            width: \"50px\",\n            display: \"inline-block\"\n          });\n          break;\n\n        case \"columnChooser\":\n          startAnimate({\n            width: \"100%\",\n            display: \"block\"\n          });\n          break;\n\n        default:\n          $element.css(\"display\", \"\");\n      }\n    }\n\n    that.callBase();\n  }\n});\n\nvar DraggingHeaderView = _uiGrid_core2.default.View.inherit({\n  _isDragging: false,\n  _getDraggingPanelByPos: function _getDraggingPanelByPos(pos) {\n    var that = this;\n    var result;\n    (0, _iterator.each)(that._dragOptions.draggingPanels, function (index, draggingPanel) {\n      if (draggingPanel) {\n        var boundingRect = draggingPanel.getBoundingRect();\n\n        if (boundingRect && (void 0 === boundingRect.bottom || pos.y < boundingRect.bottom) && (void 0 === boundingRect.top || pos.y > boundingRect.top) && (void 0 === boundingRect.left || pos.x > boundingRect.left) && (void 0 === boundingRect.right || pos.x < boundingRect.right)) {\n          result = draggingPanel;\n          return false;\n        }\n      }\n    });\n    return result;\n  },\n  _renderCore: function _renderCore() {\n    this.element().addClass(this.addWidgetPrefix(DRAGGING_HEADER_CLASS) + \" \" + this.addWidgetPrefix(CELL_CONTENT_CLASS) + \" \" + WIDGET_CLASS).hide();\n  },\n  _resetTargetColumnOptions: function _resetTargetColumnOptions() {\n    var params = this._dropOptions;\n    params.targetColumnIndex = -1;\n    delete params.targetColumnElement;\n    delete params.isLast;\n    delete params.posX;\n    delete params.posY;\n  },\n  _getVisibleIndexObject: function _getVisibleIndexObject(rowIndex, visibleIndex) {\n    if (_type2.default.isDefined(rowIndex)) {\n      return {\n        columnIndex: visibleIndex,\n        rowIndex: rowIndex\n      };\n    }\n\n    return visibleIndex;\n  },\n  dispose: function dispose() {\n    var element = this.element();\n    this._dragOptions = null;\n    element && element.parent().find(\".\" + this.addWidgetPrefix(DRAGGING_HEADER_CLASS)).remove();\n  },\n  isVisible: function isVisible() {\n    var columnsController = this.getController(\"columns\");\n    var commonColumnSettings = columnsController.getCommonSettings();\n    return this.option(\"showColumnHeaders\") && (allowReordering(this) || commonColumnSettings.allowGrouping || commonColumnSettings.allowHiding);\n  },\n  init: function init() {\n    var that = this;\n    this.callBase();\n    this._controller = this.getController(\"draggingHeader\");\n    this._columnsResizerViewController = this.getController(\"columnsResizer\");\n    this.getController(\"data\").loadingChanged.add(function (isLoading) {\n      var element = that.element();\n\n      if (!isLoading && element) {\n        element.hide();\n      }\n    });\n  },\n  dragHeader: function dragHeader(options) {\n    var that = this;\n    var columnElement = options.columnElement;\n    var isCommandColumn = !!options.sourceColumn.type;\n    that._isDragging = true;\n    that._dragOptions = options;\n    that._dropOptions = {\n      sourceIndex: options.index,\n      sourceColumnIndex: that._getVisibleIndexObject(options.rowIndex, options.columnIndex),\n      sourceColumnElement: options.columnElement,\n      sourceLocation: options.sourceLocation\n    };\n\n    var document = _dom_adapter2.default.getDocument();\n\n    that._onSelectStart = document.onselectstart;\n\n    document.onselectstart = function () {\n      return false;\n    };\n\n    that._controller.drag(that._dropOptions);\n\n    that.element().css({\n      textAlign: columnElement && columnElement.css(\"textAlign\"),\n      height: columnElement && (isCommandColumn && columnElement.get(0).clientHeight || columnElement.height()),\n      width: columnElement && (isCommandColumn && columnElement.get(0).clientWidth || columnElement.width()),\n      whiteSpace: columnElement && columnElement.css(\"whiteSpace\")\n    }).addClass(that.addWidgetPrefix(HEADERS_DRAG_ACTION_CLASS)).toggleClass(DRAGGING_COMMAND_CELL_CLASS, isCommandColumn).text(isCommandColumn ? \"\" : options.sourceColumn.caption);\n    that.element().appendTo((0, _swatch_container.getSwatchContainer)(columnElement));\n  },\n  moveHeader: function moveHeader(args) {\n    var e = args.event;\n    var that = e.data.that;\n    var newLeft;\n    var newTop;\n    var moveDeltaX;\n    var moveDeltaY;\n    var eventData = (0, _utils.eventData)(e);\n    var isResizing = that._columnsResizerViewController ? that._columnsResizerViewController.isResizing() : false;\n    var dragOptions = that._dragOptions;\n\n    if (that._isDragging && !isResizing) {\n      var $element = that.element();\n      moveDeltaX = Math.abs(eventData.x - dragOptions.columnElement.offset().left - dragOptions.deltaX);\n      moveDeltaY = Math.abs(eventData.y - dragOptions.columnElement.offset().top - dragOptions.deltaY);\n\n      if ($element.is(\":visible\") || moveDeltaX > DRAGGING_DELTA || moveDeltaY > DRAGGING_DELTA) {\n        $element.show();\n        newLeft = eventData.x - dragOptions.deltaX;\n        newTop = eventData.y - dragOptions.deltaY;\n        $element.css({\n          left: newLeft,\n          top: newTop\n        });\n        that.dockHeader(eventData);\n      }\n\n      e.preventDefault();\n    }\n  },\n  dockHeader: function dockHeader(eventData) {\n    var that = this;\n\n    var targetDraggingPanel = that._getDraggingPanelByPos(eventData);\n\n    var controller = that._controller;\n    var i;\n    var params = that._dropOptions;\n    var dragOptions = that._dragOptions;\n    var centerPosition;\n\n    if (targetDraggingPanel) {\n      var rtlEnabled = that.option(\"rtlEnabled\");\n      var isVerticalOrientation = \"columnChooser\" === targetDraggingPanel.getName();\n      var axisName = isVerticalOrientation ? \"y\" : \"x\";\n      var targetLocation = targetDraggingPanel.getName();\n      var rowIndex = \"headers\" === targetLocation ? dragOptions.rowIndex : void 0;\n      var sourceColumn = dragOptions.sourceColumn;\n      var columnElements = targetDraggingPanel.getColumnElements(rowIndex, sourceColumn && sourceColumn.ownerBand) || [];\n      var pointsByTarget = dragOptions.pointsByTarget = dragOptions.pointsByTarget || {};\n      var pointsByColumns = \"columnChooser\" === targetLocation ? [] : pointsByTarget[targetLocation] || controller._generatePointsByColumns((0, _extend.extend)({}, dragOptions, {\n        targetDraggingPanel: targetDraggingPanel,\n        columns: targetDraggingPanel.getColumns(rowIndex),\n        columnElements: columnElements,\n        isVerticalOrientation: isVerticalOrientation,\n        startColumnIndex: \"headers\" === targetLocation && (0, _renderer2.default)(columnElements[0]).index()\n      }));\n      pointsByTarget[targetLocation] = pointsByColumns;\n      params.targetLocation = targetLocation;\n\n      if (pointsByColumns.length > 0) {\n        for (i = 0; i < pointsByColumns.length; i++) {\n          centerPosition = pointsByColumns[i + 1] && (pointsByColumns[i][axisName] + pointsByColumns[i + 1][axisName]) / 2;\n\n          if (void 0 === centerPosition || (rtlEnabled && \"x\" === axisName ? eventData[axisName] > centerPosition : eventData[axisName] < centerPosition)) {\n            params.targetColumnIndex = that._getVisibleIndexObject(rowIndex, pointsByColumns[i].columnIndex);\n\n            if (columnElements[i]) {\n              params.targetColumnElement = columnElements.eq(i);\n              params.isLast = false;\n            } else {\n              params.targetColumnElement = columnElements.last();\n              params.isLast = true;\n            }\n\n            params.posX = pointsByColumns[i].x;\n            params.posY = pointsByColumns[i].y;\n            controller.dock(params);\n            break;\n          }\n        }\n      } else {\n        that._resetTargetColumnOptions();\n\n        controller.dock(params);\n      }\n    }\n  },\n  dropHeader: function dropHeader(args) {\n    var e = args.event;\n    var that = e.data.that;\n    var controller = that._controller;\n    that.element().hide();\n\n    if (controller && that._isDragging) {\n      controller.drop(that._dropOptions);\n    }\n\n    that.element().appendTo(that._parentElement());\n    that._dragOptions = null;\n    that._dropOptions = null;\n    that._isDragging = false;\n    _dom_adapter2.default.getDocument().onselectstart = that._onSelectStart || null;\n  }\n});\n\nvar isNextColumnResizingMode = function isNextColumnResizingMode(that) {\n  return \"widget\" !== that.option(\"columnResizingMode\");\n};\n\nvar ColumnsResizerViewController = _uiGrid_core2.default.ViewController.inherit({\n  _isHeadersRowArea: function _isHeadersRowArea(posY) {\n    if (this._columnHeadersView) {\n      var element = this._columnHeadersView.element();\n\n      var headersRowHeight;\n      var offsetTop;\n\n      if (element) {\n        offsetTop = element.offset().top;\n        headersRowHeight = this._columnHeadersView.getHeadersRowHeight();\n        return posY >= offsetTop && posY <= offsetTop + headersRowHeight;\n      }\n    }\n\n    return false;\n  },\n  _pointCreated: function _pointCreated(point, cellsLength, columns) {\n    var currentColumn;\n    var isNextColumnMode = isNextColumnResizingMode(this);\n    var rtlEnabled = this.option(\"rtlEnabled\");\n    var firstPointColumnIndex = !isNextColumnMode && rtlEnabled ? 0 : 1;\n    var nextColumn;\n\n    if (point.index >= firstPointColumnIndex && point.index < cellsLength + (!isNextColumnMode && !rtlEnabled ? 1 : 0)) {\n      point.columnIndex -= firstPointColumnIndex;\n      currentColumn = columns[point.columnIndex] || {};\n      nextColumn = columns[point.columnIndex + 1] || {};\n      return !(isNextColumnMode ? currentColumn.allowResizing && nextColumn.allowResizing : currentColumn.allowResizing);\n    }\n\n    return true;\n  },\n  _getTargetPoint: function _getTargetPoint(pointsByColumns, currentX, deltaX) {\n    if (pointsByColumns) {\n      for (var i = 0; i < pointsByColumns.length; i++) {\n        if (pointsByColumns[i].x === pointsByColumns[0].x && pointsByColumns[i + 1] && pointsByColumns[i].x === pointsByColumns[i + 1].x) {\n          continue;\n        }\n\n        if (pointsByColumns[i].x - deltaX <= currentX && currentX <= pointsByColumns[i].x + deltaX) {\n          return pointsByColumns[i];\n        }\n      }\n    }\n\n    return null;\n  },\n  _moveSeparator: function _moveSeparator(args) {\n    var e = args.event;\n    var that = e.data;\n\n    var columnsSeparatorWidth = that._columnsSeparatorView.width();\n\n    var isNextColumnMode = isNextColumnResizingMode(that);\n    var deltaX = columnsSeparatorWidth / 2;\n\n    var parentOffset = that._$parentContainer.offset();\n\n    var parentOffsetLeft = parentOffset.left;\n    var eventData = (0, _utils.eventData)(e);\n\n    if (that._isResizing && that._resizingInfo) {\n      if (parentOffsetLeft <= eventData.x && (!isNextColumnMode || eventData.x <= parentOffsetLeft + that._$parentContainer.width())) {\n        if (that._updateColumnsWidthIfNeeded(eventData.x)) {\n          var $cell = that._columnHeadersView.getColumnElements().eq(that._resizingInfo.currentColumnIndex);\n\n          that._columnsSeparatorView.moveByX($cell.offset().left + (isNextColumnMode && that.option(\"rtlEnabled\") ? 0 : $cell.outerWidth()));\n\n          that._tablePositionController.update(that._targetPoint.y);\n\n          e.preventDefault();\n        }\n      }\n    } else {\n      if (that._isHeadersRowArea(eventData.y)) {\n        if (that._previousParentOffset) {\n          if (that._previousParentOffset.left !== parentOffset.left || that._previousParentOffset.top !== parentOffset.top) {\n            that.pointsByColumns(null);\n          }\n        }\n\n        that._targetPoint = that._getTargetPoint(that.pointsByColumns(), eventData.x, columnsSeparatorWidth);\n        that._previousParentOffset = parentOffset;\n        that._isReadyResizing = false;\n\n        if (that._targetPoint) {\n          that._columnsSeparatorView.changeCursor(\"col-resize\");\n\n          that._columnsSeparatorView.moveByX(that._targetPoint.x - deltaX);\n\n          that._tablePositionController.update(that._targetPoint.y);\n\n          that._isReadyResizing = true;\n          e.preventDefault();\n        } else {\n          that._columnsSeparatorView.changeCursor();\n        }\n      } else {\n        that.pointsByColumns(null);\n        that._isReadyResizing = false;\n\n        that._columnsSeparatorView.changeCursor();\n      }\n    }\n  },\n  _endResizing: function _endResizing(args) {\n    var e = args.event;\n    var that = e.data;\n\n    if (that._isResizing) {\n      that.pointsByColumns(null);\n      that._resizingInfo = null;\n\n      that._columnsSeparatorView.hide();\n\n      that._columnsSeparatorView.changeCursor();\n\n      that._trackerView.hide();\n\n      if (!isNextColumnResizingMode(that)) {\n        var pageIndex = that.component.pageIndex();\n        that.component.updateDimensions();\n\n        if (that.option(\"wordWrapEnabled\") && \"virtual\" === that.option(\"scrolling.mode\")) {\n          var dataSource = that.component.getDataSource();\n          dataSource && dataSource.load().done(function () {\n            that._rowsView.scrollToPage(pageIndex);\n          });\n        }\n      }\n\n      that._isReadyResizing = false;\n      that._isResizing = false;\n    }\n  },\n  _getNextColumnIndex: function _getNextColumnIndex(currentColumnIndex) {\n    return currentColumnIndex + 1;\n  },\n  _setupResizingInfo: function _setupResizingInfo(posX) {\n    var that = this;\n    var currentColumnIndex = that._targetPoint.columnIndex;\n\n    var nextColumnIndex = that._getNextColumnIndex(currentColumnIndex);\n\n    var currentHeader = that._columnHeadersView.getHeaderElement(currentColumnIndex);\n\n    var nextHeader = that._columnHeadersView.getHeaderElement(nextColumnIndex);\n\n    that._resizingInfo = {\n      startPosX: posX,\n      currentColumnIndex: currentColumnIndex,\n      currentColumnWidth: currentHeader && currentHeader.length > 0 ? currentHeader[0].getBoundingClientRect().width : 0,\n      nextColumnIndex: nextColumnIndex,\n      nextColumnWidth: nextHeader && nextHeader.length > 0 ? nextHeader[0].getBoundingClientRect().width : 0\n    };\n  },\n  _startResizing: function _startResizing(args) {\n    var e = args.event;\n    var that = e.data;\n    var eventData = (0, _utils.eventData)(e);\n    var editingController = that.getController(\"editing\");\n    var editingMode = that.option(\"editing.mode\");\n    var isCellEditing = editingController.isEditing() && (\"batch\" === editingMode || \"cell\" === editingMode);\n\n    if ((0, _utils.isTouchEvent)(e)) {\n      if (that._isHeadersRowArea(eventData.y)) {\n        that._targetPoint = that._getTargetPoint(that.pointsByColumns(), eventData.x, COLUMNS_SEPARATOR_TOUCH_TRACKER_WIDTH);\n\n        if (that._targetPoint) {\n          that._columnsSeparatorView.moveByX(that._targetPoint.x - that._columnsSeparatorView.width() / 2);\n\n          that._isReadyResizing = true;\n        }\n      } else {\n        that._isReadyResizing = false;\n      }\n    }\n\n    if (that._isReadyResizing && !isCellEditing) {\n      that._setupResizingInfo(eventData.x);\n\n      that._isResizing = true;\n\n      that._tablePositionController.update(that._targetPoint.y);\n\n      that._columnsSeparatorView.show();\n\n      that._trackerView.show();\n\n      e.preventDefault();\n      e.stopPropagation();\n    }\n  },\n  _generatePointsByColumns: function _generatePointsByColumns() {\n    var that = this;\n    var columns = that._columnsController ? that._columnsController.getVisibleColumns() : [];\n\n    var cells = that._columnHeadersView.getColumnElements();\n\n    var pointsByColumns = [];\n\n    if (cells && cells.length > 0) {\n      pointsByColumns = _uiGrid_core4.default.getPointsByColumns(cells, function (point) {\n        return that._pointCreated(point, cells.length, columns);\n      });\n    }\n\n    that._pointsByColumns = pointsByColumns;\n  },\n  _unsubscribeFromEvents: function _unsubscribeFromEvents() {\n    this._moveSeparatorHandler && _events_engine2.default.off(_dom_adapter2.default.getDocument(), (0, _utils.addNamespace)(_pointer2.default.move, MODULE_NAMESPACE), this._moveSeparatorHandler);\n    this._startResizingHandler && _events_engine2.default.off(this._$parentContainer, (0, _utils.addNamespace)(_pointer2.default.down, MODULE_NAMESPACE), this._startResizingHandler);\n\n    if (this._endResizingHandler) {\n      _events_engine2.default.off(this._columnsSeparatorView.element(), (0, _utils.addNamespace)(_pointer2.default.up, MODULE_NAMESPACE), this._endResizingHandler);\n\n      _events_engine2.default.off(_dom_adapter2.default.getDocument(), (0, _utils.addNamespace)(_pointer2.default.up, MODULE_NAMESPACE), this._endResizingHandler);\n    }\n  },\n  _subscribeToEvents: function _subscribeToEvents() {\n    this._moveSeparatorHandler = this.createAction(this._moveSeparator);\n    this._startResizingHandler = this.createAction(this._startResizing);\n    this._endResizingHandler = this.createAction(this._endResizing);\n\n    _events_engine2.default.on(_dom_adapter2.default.getDocument(), (0, _utils.addNamespace)(_pointer2.default.move, MODULE_NAMESPACE), this, this._moveSeparatorHandler);\n\n    _events_engine2.default.on(this._$parentContainer, (0, _utils.addNamespace)(_pointer2.default.down, MODULE_NAMESPACE), this, this._startResizingHandler);\n\n    _events_engine2.default.on(this._columnsSeparatorView.element(), (0, _utils.addNamespace)(_pointer2.default.up, MODULE_NAMESPACE), this, this._endResizingHandler);\n\n    _events_engine2.default.on(_dom_adapter2.default.getDocument(), (0, _utils.addNamespace)(_pointer2.default.up, MODULE_NAMESPACE), this, this._endResizingHandler);\n  },\n  _updateColumnsWidthIfNeeded: function _updateColumnsWidthIfNeeded(posX) {\n    var deltaX;\n    var needUpdate = false;\n    var nextCellWidth;\n    var resizingInfo = this._resizingInfo;\n    var columnsController = this._columnsController;\n    var visibleColumns = columnsController.getVisibleColumns();\n\n    var columnsSeparatorWidth = this._columnsSeparatorView.width();\n\n    var contentWidth = this._rowsView.contentWidth();\n\n    var isNextColumnMode = isNextColumnResizingMode(this);\n    var adaptColumnWidthByRatio = isNextColumnMode && this.option(\"adaptColumnWidthByRatio\") && !this.option(\"columnAutoWidth\");\n    var column;\n    var minWidth;\n    var nextColumn;\n    var cellWidth;\n\n    function isPercentWidth(width) {\n      return _type2.default.isString(width) && \"%\" === width.slice(-1);\n    }\n\n    function setColumnWidth(column, columnWidth, contentWidth, adaptColumnWidthByRatio) {\n      if (column) {\n        var oldColumnWidth = column.width;\n\n        if (oldColumnWidth) {\n          adaptColumnWidthByRatio = isPercentWidth(oldColumnWidth);\n        }\n\n        if (adaptColumnWidthByRatio) {\n          column && columnsController.columnOption(column.index, \"visibleWidth\", columnWidth);\n          column && columnsController.columnOption(column.index, \"width\", (columnWidth / contentWidth * 100).toFixed(3) + \"%\");\n        } else {\n          column && columnsController.columnOption(column.index, \"visibleWidth\", null);\n          column && columnsController.columnOption(column.index, \"width\", columnWidth);\n        }\n      }\n    }\n\n    function correctContentWidth(contentWidth, visibleColumns) {\n      var allColumnsHaveWidth = visibleColumns.every(function (column) {\n        return column.width;\n      });\n      var totalPercent;\n\n      if (allColumnsHaveWidth) {\n        totalPercent = visibleColumns.reduce(function (sum, column) {\n          if (isPercentWidth(column.width)) {\n            sum += parseFloat(column.width);\n          }\n\n          return sum;\n        }, 0);\n\n        if (totalPercent > 100) {\n          contentWidth = contentWidth / totalPercent * 100;\n        }\n      }\n\n      return contentWidth;\n    }\n\n    deltaX = posX - resizingInfo.startPosX;\n\n    if (isNextColumnMode && this.option(\"rtlEnabled\")) {\n      deltaX = -deltaX;\n    }\n\n    cellWidth = resizingInfo.currentColumnWidth + deltaX;\n    column = visibleColumns[resizingInfo.currentColumnIndex];\n    minWidth = column && column.minWidth || columnsSeparatorWidth;\n    needUpdate = cellWidth >= minWidth;\n\n    if (isNextColumnMode) {\n      nextCellWidth = resizingInfo.nextColumnWidth - deltaX;\n      nextColumn = visibleColumns[resizingInfo.nextColumnIndex];\n      minWidth = nextColumn && nextColumn.minWidth || columnsSeparatorWidth;\n      needUpdate = needUpdate && nextCellWidth >= minWidth;\n    }\n\n    if (needUpdate) {\n      columnsController.beginUpdate();\n      cellWidth = Math.floor(cellWidth);\n      contentWidth = correctContentWidth(contentWidth, visibleColumns);\n      setColumnWidth(column, cellWidth, contentWidth, adaptColumnWidthByRatio);\n\n      if (isNextColumnMode) {\n        nextCellWidth = Math.floor(nextCellWidth);\n        setColumnWidth(nextColumn, nextCellWidth, contentWidth, adaptColumnWidthByRatio);\n      } else {\n        var columnWidths = this._columnHeadersView.getColumnWidths();\n\n        columnWidths[resizingInfo.currentColumnIndex] = cellWidth;\n\n        var hasScroll = columnWidths.reduce(function (totalWidth, width) {\n          return totalWidth + width;\n        }, 0) > this._rowsView.contentWidth();\n\n        if (!hasScroll) {\n          var lastColumnIndex = _uiGrid_core4.default.getLastResizableColumnIndex(visibleColumns);\n\n          if (lastColumnIndex >= 0) {\n            columnsController.columnOption(visibleColumns[lastColumnIndex].index, \"visibleWidth\", \"auto\");\n          }\n        }\n\n        for (var i = 0; i < columnWidths.length; i++) {\n          if (visibleColumns[i] && visibleColumns[i] !== column && void 0 === visibleColumns[i].width) {\n            columnsController.columnOption(visibleColumns[i].index, \"width\", columnWidths[i]);\n          }\n        }\n      }\n\n      columnsController.endUpdate();\n    }\n\n    return needUpdate;\n  },\n  _subscribeToCallback: function _subscribeToCallback(callback, handler) {\n    callback.add(handler);\n\n    this._subscribesToCallbacks.push({\n      callback: callback,\n      handler: handler\n    });\n  },\n  _unsubscribeFromCallbacks: function _unsubscribeFromCallbacks() {\n    var i;\n    var subscribe;\n\n    for (i = 0; i < this._subscribesToCallbacks.length; i++) {\n      subscribe = this._subscribesToCallbacks[i];\n      subscribe.callback.remove(subscribe.handler);\n    }\n\n    this._subscribesToCallbacks = [];\n  },\n  _unsubscribes: function _unsubscribes() {\n    this._unsubscribeFromEvents();\n\n    this._unsubscribeFromCallbacks();\n  },\n  _init: function _init() {\n    var that = this;\n\n    var generatePointsByColumnsHandler = function generatePointsByColumnsHandler() {\n      if (!that._isResizing) {\n        that.pointsByColumns(null);\n      }\n    };\n\n    var generatePointsByColumnsScrollHandler = function generatePointsByColumnsScrollHandler(offset) {\n      if (that._scrollLeft !== offset.left) {\n        that._scrollLeft = offset.left;\n        that.pointsByColumns(null);\n      }\n    };\n\n    that._columnsSeparatorView = that.getView(\"columnsSeparatorView\");\n    that._columnHeadersView = that.getView(\"columnHeadersView\");\n    that._trackerView = that.getView(\"trackerView\");\n    that._rowsView = that.getView(\"rowsView\");\n    that._columnsController = that.getController(\"columns\");\n    that._tablePositionController = that.getController(\"tablePosition\");\n    that._$parentContainer = that._columnsSeparatorView.component.$element();\n\n    that._subscribeToCallback(that._columnHeadersView.renderCompleted, generatePointsByColumnsHandler);\n\n    that._subscribeToCallback(that._columnHeadersView.resizeCompleted, generatePointsByColumnsHandler);\n\n    that._subscribeToCallback(that._columnsSeparatorView.renderCompleted, function () {\n      that._unsubscribeFromEvents();\n\n      that._subscribeToEvents();\n    });\n\n    that._subscribeToCallback(that._rowsView.renderCompleted, function () {\n      that._rowsView.scrollChanged.remove(generatePointsByColumnsScrollHandler);\n\n      that._rowsView.scrollChanged.add(generatePointsByColumnsScrollHandler);\n    });\n\n    var previousScrollbarVisibility = 0 !== that._rowsView.getScrollbarWidth();\n\n    var previousTableHeight = 0;\n\n    that._subscribeToCallback(that.getController(\"tablePosition\").positionChanged, function (e) {\n      if (that._isResizing && !that._rowsView.isResizing) {\n        var scrollbarVisibility = 0 !== that._rowsView.getScrollbarWidth();\n\n        if (previousScrollbarVisibility !== scrollbarVisibility || previousTableHeight && previousTableHeight !== e.height) {\n          previousScrollbarVisibility = scrollbarVisibility;\n          previousTableHeight = e.height;\n          that.component.updateDimensions();\n        } else {\n          that._rowsView.updateFreeSpaceRowHeight();\n        }\n      }\n\n      previousTableHeight = e.height;\n    });\n  },\n  optionChanged: function optionChanged(args) {\n    this.callBase(args);\n\n    if (\"allowColumnResizing\" === args.name) {\n      if (args.value) {\n        this._init();\n\n        this._subscribeToEvents();\n      } else {\n        this._unsubscribes();\n      }\n    }\n  },\n  isResizing: function isResizing() {\n    return this._isResizing;\n  },\n  init: function init() {\n    this._subscribesToCallbacks = [];\n\n    if (allowResizing(this)) {\n      this._init();\n    }\n  },\n  pointsByColumns: function pointsByColumns(value) {\n    if (void 0 !== value) {\n      this._pointsByColumns = value;\n    } else {\n      if (!this._pointsByColumns) {\n        this._generatePointsByColumns();\n      }\n\n      return this._pointsByColumns;\n    }\n  },\n  dispose: function dispose() {\n    this._unsubscribes();\n\n    this.callBase();\n  }\n});\n\nvar TablePositionViewController = _uiGrid_core2.default.ViewController.inherit({\n  update: function update(top) {\n    var that = this;\n    var params = {};\n\n    var $element = that._columnHeadersView.element();\n\n    var offset = $element && $element.offset();\n    var offsetTop = offset && offset.top || 0;\n    var diffOffsetTop = _type2.default.isDefined(top) ? Math.abs(top - offsetTop) : 0;\n    var columnsHeadersHeight = that._columnHeadersView ? that._columnHeadersView.getHeight() : 0;\n\n    var scrollBarWidth = that._rowsView.getScrollbarWidth(true);\n\n    var rowsHeight = that._rowsView ? that._rowsView.height() - scrollBarWidth : 0;\n    var columnsResizerController = that.component.getController(\"columnsResizer\");\n    params.height = columnsHeadersHeight;\n\n    if (false !== columnsResizerController.isResizing()) {\n      params.height += rowsHeight - diffOffsetTop;\n    }\n\n    if (null !== top && $element && $element.length) {\n      params.top = $element[0].offsetTop + diffOffsetTop;\n    }\n\n    that.positionChanged.fire(params);\n  },\n  init: function init() {\n    var that = this;\n    that.callBase();\n    that._columnHeadersView = this.getView(\"columnHeadersView\");\n    that._rowsView = this.getView(\"rowsView\");\n    that._pagerView = this.getView(\"pagerView\");\n\n    that._rowsView.resizeCompleted.add(function () {\n      if (that.option(\"allowColumnResizing\")) {\n        that.update(null);\n      }\n    });\n  },\n  ctor: function ctor(component) {\n    this.callBase(component);\n    this.positionChanged = (0, _callbacks2.default)();\n  }\n});\n\nvar DraggingHeaderViewController = _uiGrid_core2.default.ViewController.inherit({\n  _generatePointsByColumns: function _generatePointsByColumns(options) {\n    var that = this;\n    return _uiGrid_core4.default.getPointsByColumns(options.columnElements, function (point) {\n      return that._pointCreated(point, options.columns, options.targetDraggingPanel.getName(), options.sourceColumn);\n    }, options.isVerticalOrientation, options.startColumnIndex);\n  },\n  _pointCreated: function _pointCreated(point, columns, location, sourceColumn) {\n    var targetColumn = columns[point.columnIndex];\n    var prevColumn = columns[point.columnIndex - 1];\n\n    switch (location) {\n      case \"columnChooser\":\n        return true;\n\n      case \"headers\":\n        return sourceColumn && !sourceColumn.allowReordering || (!targetColumn || !targetColumn.allowReordering) && (!prevColumn || !prevColumn.allowReordering);\n\n      default:\n        return 0 === columns.length;\n    }\n  },\n  _subscribeToEvents: function _subscribeToEvents(draggingHeader, draggingPanels) {\n    var that = this;\n    (0, _iterator.each)(draggingPanels, function (_, draggingPanel) {\n      if (draggingPanel) {\n        var i;\n        var columns;\n        var columnElements;\n        var rowCount = draggingPanel.getRowCount ? draggingPanel.getRowCount() : 1;\n        var nameDraggingPanel = draggingPanel.getName();\n\n        var subscribeToEvents = function subscribeToEvents(index, columnElement) {\n          if (!columnElement) {\n            return;\n          }\n\n          var $columnElement = (0, _renderer2.default)(columnElement);\n          var column = columns[index];\n\n          if (draggingPanel.allowDragging(column, nameDraggingPanel, draggingPanels)) {\n            $columnElement.addClass(that.addWidgetPrefix(HEADERS_DRAG_ACTION_CLASS));\n\n            _events_engine2.default.on($columnElement, (0, _utils.addNamespace)(_drag2.default.start, MODULE_NAMESPACE), that.createAction(function (args) {\n              var e = args.event;\n              var eventData = (0, _utils.eventData)(e);\n              draggingHeader.dragHeader({\n                deltaX: eventData.x - (0, _renderer2.default)(e.currentTarget).offset().left,\n                deltaY: eventData.y - (0, _renderer2.default)(e.currentTarget).offset().top,\n                sourceColumn: column,\n                index: column.index,\n                columnIndex: index,\n                columnElement: $columnElement,\n                sourceLocation: nameDraggingPanel,\n                draggingPanels: draggingPanels,\n                rowIndex: that._columnsController.getRowIndex(column.index, true)\n              });\n            }));\n\n            _events_engine2.default.on($columnElement, (0, _utils.addNamespace)(_drag2.default.move, MODULE_NAMESPACE), {\n              that: draggingHeader\n            }, that.createAction(draggingHeader.moveHeader));\n\n            _events_engine2.default.on($columnElement, (0, _utils.addNamespace)(_drag2.default.end, MODULE_NAMESPACE), {\n              that: draggingHeader\n            }, that.createAction(draggingHeader.dropHeader));\n          }\n        };\n\n        for (i = 0; i < rowCount; i++) {\n          columnElements = draggingPanel.getColumnElements(i) || [];\n\n          if (columnElements.length) {\n            columns = draggingPanel.getColumns(i) || [];\n            (0, _iterator.each)(columnElements, subscribeToEvents);\n          }\n        }\n      }\n    });\n  },\n  _unsubscribeFromEvents: function _unsubscribeFromEvents(draggingHeader, draggingPanels) {\n    var that = this;\n    (0, _iterator.each)(draggingPanels, function (_, draggingPanel) {\n      if (draggingPanel) {\n        var columnElements = draggingPanel.getColumnElements() || [];\n        (0, _iterator.each)(columnElements, function (index, columnElement) {\n          var $columnElement = (0, _renderer2.default)(columnElement);\n\n          _events_engine2.default.off($columnElement, (0, _utils.addNamespace)(_drag2.default.start, MODULE_NAMESPACE));\n\n          _events_engine2.default.off($columnElement, (0, _utils.addNamespace)(_drag2.default.move, MODULE_NAMESPACE));\n\n          _events_engine2.default.off($columnElement, (0, _utils.addNamespace)(_drag2.default.end, MODULE_NAMESPACE));\n\n          $columnElement.removeClass(that.addWidgetPrefix(HEADERS_DRAG_ACTION_CLASS));\n        });\n      }\n    });\n  },\n  _getSeparator: function _getSeparator(targetLocation) {\n    return \"headers\" === targetLocation ? this._columnsSeparatorView : this._blockSeparatorView;\n  },\n  hideSeparators: function hideSeparators(type) {\n    var blockSeparator = this._blockSeparatorView;\n    var columnsSeparator = this._columnsSeparatorView;\n    this._animationColumnIndex = null;\n    blockSeparator && blockSeparator.hide();\n    \"block\" !== type && columnsSeparator && columnsSeparator.hide();\n  },\n  init: function init() {\n    var that = this;\n    var subscribeToEvents;\n    that.callBase();\n    that._columnsController = that.getController(\"columns\");\n    that._columnHeadersView = that.getView(\"columnHeadersView\");\n    that._columnsSeparatorView = that.getView(\"columnsSeparatorView\");\n    that._draggingHeaderView = that.getView(\"draggingHeaderView\");\n    that._rowsView = that.getView(\"rowsView\");\n    that._blockSeparatorView = that.getView(\"blockSeparatorView\");\n    that._headerPanelView = that.getView(\"headerPanel\");\n    that._columnChooserView = that.getView(\"columnChooserView\");\n\n    subscribeToEvents = function subscribeToEvents() {\n      if (that._draggingHeaderView) {\n        var draggingPanels = [that._columnChooserView, that._columnHeadersView, that._headerPanelView];\n\n        that._unsubscribeFromEvents(that._draggingHeaderView, draggingPanels);\n\n        that._subscribeToEvents(that._draggingHeaderView, draggingPanels);\n      }\n    };\n\n    that._columnHeadersView.renderCompleted.add(subscribeToEvents);\n\n    that._headerPanelView && that._headerPanelView.renderCompleted.add(subscribeToEvents);\n    that._columnChooserView && that._columnChooserView.renderCompleted.add(subscribeToEvents);\n  },\n  allowDrop: function allowDrop(parameters) {\n    return this._columnsController.allowMoveColumn(parameters.sourceColumnIndex, parameters.targetColumnIndex, parameters.sourceLocation, parameters.targetLocation);\n  },\n  drag: function drag(parameters) {\n    var sourceIndex = parameters.sourceIndex;\n    var sourceLocation = parameters.sourceLocation;\n    var sourceColumnElement = parameters.sourceColumnElement;\n    var headersView = this._columnHeadersView;\n    var rowsView = this._rowsView;\n\n    if (sourceColumnElement) {\n      sourceColumnElement.css({\n        opacity: COLUMN_OPACITY\n      });\n\n      if (\"headers\" === sourceLocation) {\n        headersView && headersView.setRowsOpacity(sourceIndex, COLUMN_OPACITY);\n        rowsView && rowsView.setRowsOpacity(sourceIndex, COLUMN_OPACITY);\n      }\n    }\n  },\n  dock: function dock(parameters) {\n    var that = this;\n    var targetColumnIndex = _type2.default.isObject(parameters.targetColumnIndex) ? parameters.targetColumnIndex.columnIndex : parameters.targetColumnIndex;\n    var sourceLocation = parameters.sourceLocation;\n    var targetLocation = parameters.targetLocation;\n\n    var separator = that._getSeparator(targetLocation);\n\n    var hasTargetVisibleIndex = targetColumnIndex >= 0;\n\n    var showSeparator = function showSeparator() {\n      if (that._animationColumnIndex !== targetColumnIndex) {\n        that.hideSeparators();\n        separator.element()[parameters.isLast ? \"insertAfter\" : \"insertBefore\"](parameters.targetColumnElement);\n        that._animationColumnIndex = targetColumnIndex;\n        separator.show(targetLocation);\n      }\n    };\n\n    that._columnHeadersView.element().find(\".\" + HEADER_ROW_CLASS).toggleClass(that.addWidgetPrefix(HEADERS_DROP_HIGHLIGHT_CLASS), \"headers\" !== sourceLocation && \"headers\" === targetLocation && !hasTargetVisibleIndex);\n\n    if (separator) {\n      if (that.allowDrop(parameters) && hasTargetVisibleIndex) {\n        if (\"group\" === targetLocation || \"columnChooser\" === targetLocation) {\n          showSeparator();\n        } else {\n          that.hideSeparators(\"block\");\n          that.getController(\"tablePosition\").update(parameters.posY);\n          separator.moveByX(parameters.posX - separator.width());\n          separator.show();\n        }\n      } else {\n        that.hideSeparators();\n      }\n    }\n  },\n  drop: function drop(parameters) {\n    var sourceColumnElement = parameters.sourceColumnElement;\n\n    if (sourceColumnElement) {\n      sourceColumnElement.css({\n        opacity: \"\"\n      });\n\n      this._columnHeadersView.setRowsOpacity(parameters.sourceIndex, \"\");\n\n      this._rowsView.setRowsOpacity(parameters.sourceIndex, \"\");\n\n      this._columnHeadersView.element().find(\".\" + HEADER_ROW_CLASS).removeClass(this.addWidgetPrefix(HEADERS_DROP_HIGHLIGHT_CLASS));\n    }\n\n    if (this.allowDrop(parameters)) {\n      var separator = this._getSeparator(parameters.targetLocation);\n\n      if (separator) {\n        separator.hide();\n      }\n\n      this._columnsController.moveColumn(parameters.sourceColumnIndex, parameters.targetColumnIndex, parameters.sourceLocation, parameters.targetLocation);\n    }\n  },\n  dispose: function dispose() {\n    if (this._draggingHeaderView) {\n      this._unsubscribeFromEvents(this._draggingHeaderView, [this._columnChooserView, this._columnHeadersView, this._headerPanelView]);\n    }\n  }\n});\n\nmodule.exports = {\n  views: {\n    columnsSeparatorView: ColumnsSeparatorView,\n    blockSeparatorView: BlockSeparatorView,\n    draggingHeaderView: DraggingHeaderView,\n    trackerView: TrackerView\n  },\n  controllers: {\n    draggingHeader: DraggingHeaderViewController,\n    tablePosition: TablePositionViewController,\n    columnsResizer: ColumnsResizerViewController\n  },\n  extenders: {\n    views: {\n      rowsView: {\n        _needUpdateRowHeight: function _needUpdateRowHeight(itemCount) {\n          var wordWrapEnabled = this.option(\"wordWrapEnabled\");\n          var columnsResizerController = this.getController(\"columnsResizer\");\n          var isResizing = columnsResizerController.isResizing();\n          return this.callBase.apply(this, arguments) || itemCount > 0 && wordWrapEnabled && isResizing;\n        }\n      }\n    }\n  }\n};","map":{"version":3,"sources":["C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/devextreme/ui/grid_core/ui.grid_core.columns_resizing_reordering.js"],"names":["_renderer","require","_renderer2","_interopRequireDefault","_dom_adapter","_dom_adapter2","_events_engine","_events_engine2","_callbacks","_callbacks2","_type","_type2","_iterator","_extend","_utils","_pointer","_pointer2","_drag","_drag2","_uiGrid_core","_uiGrid_core2","_uiGrid_core3","_uiGrid_core4","_fx","_fx2","_swatch_container","obj","COLUMNS_SEPARATOR_CLASS","COLUMNS_SEPARATOR_TRANSPARENT","DRAGGING_HEADER_CLASS","CELL_CONTENT_CLASS","HEADERS_DRAG_ACTION_CLASS","TRACKER_CLASS","HEADERS_DROP_HIGHLIGHT_CLASS","BLOCK_SEPARATOR_CLASS","HEADER_ROW_CLASS","WIDGET_CLASS","DRAGGING_COMMAND_CELL_CLASS","MODULE_NAMESPACE","COLUMNS_SEPARATOR_TOUCH_TRACKER_WIDTH","DRAGGING_DELTA","COLUMN_OPACITY","allowResizing","that","allowReordering","TrackerView","_renderCore","_unsubscribeFromCallback","_subscribeToCallback","$element","top","position","optionChanged","args","init","isVisible","show","hide","setHeight","dispose","SeparatorView","_renderSeparator","height","width","ColumnsSeparatorView","_init","columnsSeparatorTransparent","moveByX","outerX","changeCursor","cursorName","BlockSeparatorView","$parent","groupPanelOptions","columnChooserOptions","startAnimate","type","from","display","toOptions","to","duration","easing","DraggingHeaderView","_isDragging","_getDraggingPanelByPos","boundingRect","draggingPanel","pos","result","_resetTargetColumnOptions","params","_getVisibleIndexObject","columnIndex","rowIndex","element","columnsController","commonColumnSettings","dragHeader","columnElement","options","isCommandColumn","sourceIndex","sourceColumnIndex","sourceColumnElement","sourceLocation","document","textAlign","whiteSpace","moveHeader","e","eventData","isResizing","dragOptions","moveDeltaX","Math","moveDeltaY","newLeft","newTop","left","dockHeader","targetDraggingPanel","controller","rtlEnabled","isVerticalOrientation","axisName","targetLocation","sourceColumn","columnElements","pointsByTarget","pointsByColumns","columns","startColumnIndex","i","centerPosition","dropHeader","isNextColumnResizingMode","ColumnsResizerViewController","_isHeadersRowArea","offsetTop","headersRowHeight","posY","_pointCreated","isNextColumnMode","firstPointColumnIndex","point","cellsLength","currentColumn","nextColumn","_getTargetPoint","currentX","_moveSeparator","columnsSeparatorWidth","deltaX","parentOffset","parentOffsetLeft","$cell","_endResizing","pageIndex","dataSource","_getNextColumnIndex","currentColumnIndex","_setupResizingInfo","nextColumnIndex","currentHeader","nextHeader","startPosX","currentColumnWidth","nextColumnWidth","_startResizing","editingController","editingMode","isCellEditing","_generatePointsByColumns","cells","_unsubscribeFromEvents","_subscribeToEvents","_updateColumnsWidthIfNeeded","needUpdate","resizingInfo","visibleColumns","contentWidth","adaptColumnWidthByRatio","oldColumnWidth","column","isPercentWidth","columnWidth","allColumnsHaveWidth","totalPercent","sum","parseFloat","posX","cellWidth","minWidth","nextCellWidth","correctContentWidth","setColumnWidth","columnWidths","hasScroll","totalWidth","lastColumnIndex","callback","handler","_unsubscribeFromCallbacks","subscribe","_unsubscribes","generatePointsByColumnsHandler","generatePointsByColumnsScrollHandler","offset","previousScrollbarVisibility","previousTableHeight","scrollbarVisibility","TablePositionViewController","update","diffOffsetTop","columnsHeadersHeight","scrollBarWidth","rowsHeight","columnsResizerController","ctor","DraggingHeaderViewController","targetColumn","prevColumn","rowCount","nameDraggingPanel","subscribeToEvents","$columnElement","draggingHeader","deltaY","index","draggingPanels","_getSeparator","hideSeparators","blockSeparator","columnsSeparator","allowDrop","parameters","drag","headersView","rowsView","opacity","dock","targetColumnIndex","separator","hasTargetVisibleIndex","showSeparator","drop","module","views","columnsSeparatorView","blockSeparatorView","draggingHeaderView","trackerView","controllers","tablePosition","columnsResizer","extenders","_needUpdateRowHeight","wordWrapEnabled","itemCount"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,IAAIA,SAAS,GAAGC,OAAO,CAAvB,qBAAuB,CAAvB;;AACA,IAAIC,UAAU,GAAGC,sBAAsB,CAAvC,SAAuC,CAAvC;;AACA,IAAIC,YAAY,GAAGH,OAAO,CAA1B,wBAA0B,CAA1B;;AACA,IAAII,aAAa,GAAGF,sBAAsB,CAA1C,YAA0C,CAA1C;;AACA,IAAIG,cAAc,GAAGL,OAAO,CAA5B,iCAA4B,CAA5B;;AACA,IAAIM,eAAe,GAAGJ,sBAAsB,CAA5C,cAA4C,CAA5C;;AACA,IAAIK,UAAU,GAAGP,OAAO,CAAxB,4BAAwB,CAAxB;;AACA,IAAIQ,WAAW,GAAGN,sBAAsB,CAAxC,UAAwC,CAAxC;;AACA,IAAIO,KAAK,GAAGT,OAAO,CAAnB,uBAAmB,CAAnB;;AACA,IAAIU,MAAM,GAAGR,sBAAsB,CAAnC,KAAmC,CAAnC;;AACA,IAAIS,SAAS,GAAGX,OAAO,CAAvB,2BAAuB,CAAvB;;AACA,IAAIY,OAAO,GAAGZ,OAAO,CAArB,yBAAqB,CAArB;;AACA,IAAIa,MAAM,GAAGb,OAAO,CAApB,oBAAoB,CAApB;;AACA,IAAIc,QAAQ,GAAGd,OAAO,CAAtB,sBAAsB,CAAtB;;AACA,IAAIe,SAAS,GAAGb,sBAAsB,CAAtC,QAAsC,CAAtC;;AACA,IAAIc,KAAK,GAAGhB,OAAO,CAAnB,mBAAmB,CAAnB;;AACA,IAAIiB,MAAM,GAAGf,sBAAsB,CAAnC,KAAmC,CAAnC;;AACA,IAAIgB,YAAY,GAAGlB,OAAO,CAA1B,wBAA0B,CAA1B;;AACA,IAAImB,aAAa,GAAGjB,sBAAsB,CAA1C,YAA0C,CAA1C;;AACA,IAAIkB,aAAa,GAAGpB,OAAO,CAA3B,sBAA2B,CAA3B;;AACA,IAAIqB,aAAa,GAAGnB,sBAAsB,CAA1C,aAA0C,CAA1C;;AACA,IAAIoB,GAAG,GAAGtB,OAAO,CAAjB,oBAAiB,CAAjB;;AACA,IAAIuB,IAAI,GAAGrB,sBAAsB,CAAjC,GAAiC,CAAjC;;AACA,IAAIsB,iBAAiB,GAAGxB,OAAO,CAA/B,4BAA+B,CAA/B;;AAEA,SAAA,sBAAA,CAAA,GAAA,EAAqC;AACjC,SAAOyB,GAAG,IAAIA,GAAG,CAAVA,UAAAA,GAAAA,GAAAA,GAA8B;AACjC,eAAWA;AADsB,GAArC;AAGH;;AACD,IAAIC,uBAAuB,GAA3B,mBAAA;AACA,IAAIC,6BAA6B,GAAjC,+BAAA;AACA,IAAIC,qBAAqB,GAAzB,aAAA;AACA,IAAIC,kBAAkB,GAAtB,cAAA;AACA,IAAIC,yBAAyB,GAA7B,aAAA;AACA,IAAIC,aAAa,GAAjB,SAAA;AACA,IAAIC,4BAA4B,GAAhC,gBAAA;AACA,IAAIC,qBAAqB,GAAzB,oBAAA;AACA,IAAIC,gBAAgB,GAApB,eAAA;AACA,IAAIC,YAAY,GAAhB,WAAA;AACA,IAAIC,2BAA2B,GAA/B,sBAAA;AACA,IAAIC,gBAAgB,GAApB,8BAAA;AACA,IAAIC,qCAAqC,GAAzC,EAAA;AACA,IAAIC,cAAc,GAAlB,CAAA;AACA,IAAIC,cAAc,GAAlB,EAAA;;AACA,IAAIC,aAAa,GAAG,SAAhBA,aAAgB,CAAA,IAAA,EAAe;AAC/B,SAAOC,IAAI,CAAJA,MAAAA,CAAAA,qBAAAA,KAAsCA,IAAI,CAAJA,aAAAA,CAAAA,SAAAA,EAAAA,kBAAAA,CAA7C,eAA6CA,CAA7C;AADJ,CAAA;;AAGA,IAAIC,eAAe,GAAG,SAAlBA,eAAkB,CAAA,IAAA,EAAe;AACjC,SAAOD,IAAI,CAAJA,MAAAA,CAAAA,uBAAAA,KAAwCA,IAAI,CAAJA,aAAAA,CAAAA,SAAAA,EAAAA,kBAAAA,CAA/C,iBAA+CA,CAA/C;AADJ,CAAA;;AAGA,IAAIE,WAAW,GAAG,aAAa,CAAb,OAAA,CAAA,IAAA,CAAA,OAAA,CAAmC;AACjDC,EAAAA,WAAW,EAAE,SAAA,WAAA,GAAW;AACpB,SAAA,QAAA;AACA,SAAA,OAAA,GAAA,QAAA,CAAwB,KAAA,eAAA,CAAxB,aAAwB,CAAxB;AACA,SAAA,IAAA;AAJ6C,GAAA;AAMjDC,EAAAA,wBAAwB,EAAE,SAAA,wBAAA,GAAW;AACjC,QAAI,KAAJ,gBAAA,EAA2B;AACvB,WAAA,wBAAA,CAAA,eAAA,CAAA,MAAA,CAAqD,KAArD,gBAAA;AACH;AAT4C,GAAA;AAWjDC,EAAAA,oBAAoB,EAAE,SAAA,oBAAA,GAAW;AAC7B,QAAIL,IAAI,GAAR,IAAA;;AACAA,IAAAA,IAAI,CAAJA,gBAAAA,GAAwB,UAAA,QAAA,EAAmB;AACvC,UAAIM,QAAQ,GAAGN,IAAI,CAAnB,OAAeA,EAAf;;AACA,UAAIM,QAAQ,IAAIA,QAAQ,CAARA,QAAAA,CAAkBN,IAAI,CAAJA,eAAAA,CAAlC,aAAkCA,CAAlBM,CAAhB,EAAwE;AACpEA,QAAAA,QAAQ,CAARA,GAAAA,CAAa;AACTC,UAAAA,GAAG,EAAEC,QAAQ,CAACD;AADL,SAAbD;AAGAA,QAAAA,QAAQ,CAARA,MAAAA,CAAgBE,QAAQ,CAAxBF,MAAAA;AACH;AAPLN,KAAAA;;AASA,SAAA,wBAAA,CAAA,eAAA,CAAA,GAAA,CAAkDA,IAAI,CAAtD,gBAAA;AAtB6C,GAAA;AAwBjDS,EAAAA,aAAa,EAAE,SAAA,aAAA,CAAA,IAAA,EAAe;AAC1B,QAAI,0BAA0BC,IAAI,CAAlC,IAAA,EAAyC;AACrC,WAAA,wBAAA;;AACA,UAAIA,IAAI,CAAR,KAAA,EAAgB;AACZ,aAAA,oBAAA;;AACA,aAAA,WAAA;AACH;AACJ;;AACD,SAAA,QAAA,CAAA,IAAA;AAhC6C,GAAA;AAkCjDC,EAAAA,IAAI,EAAE,SAAA,IAAA,GAAW;AACb,SAAA,QAAA;AACA,SAAA,wBAAA,GAAgC,KAAA,aAAA,CAAhC,eAAgC,CAAhC;;AACA,SAAA,oBAAA;AArC6C,GAAA;AAuCjDC,EAAAA,SAAS,EAAE,SAAA,SAAA,GAAW;AAClB,WAAOb,aAAa,CAApB,IAAoB,CAApB;AAxC6C,GAAA;AA0CjDc,EAAAA,IAAI,EAAE,SAAA,IAAA,GAAW;AACb,SAAA,OAAA,GAAA,IAAA;AA3C6C,GAAA;AA6CjDC,EAAAA,IAAI,EAAE,SAAA,IAAA,GAAW;AACb,SAAA,OAAA,MAAkB,KAAA,OAAA,GAAlB,IAAkB,EAAlB;AA9C6C,GAAA;AAgDjDC,EAAAA,SAAS,EAAE,SAAA,SAAA,CAAA,KAAA,EAAgB;AACvB,SAAA,OAAA,GAAA,MAAA,CAAA,KAAA;AAjD6C,GAAA;AAmDjDC,EAAAA,OAAO,EAAE,SAAA,OAAA,GAAW;AAChB,SAAA,wBAAA;;AACA,SAAA,QAAA;AACH;AAtDgD,CAAnC,CAAlB;;AAwDA,IAAIC,aAAa,GAAG,aAAa,CAAb,OAAA,CAAA,IAAA,CAAA,OAAA,CAAmC;AACnDC,EAAAA,gBAAgB,EAAE,SAAA,gBAAA,GAAW,CADsB,CAAA;AAEnDf,EAAAA,WAAW,EAAE,SAAA,WAAA,CAAA,OAAA,EAAkB;AAC3B,SAAA,QAAA,CAAA,OAAA;AACA,SAAA,QAAA,GAAA,IAAA;;AACA,SAAA,gBAAA;;AACA,SAAA,IAAA;AAN+C,GAAA;AAQnDU,EAAAA,IAAI,EAAE,SAAA,IAAA,GAAW;AACb,SAAA,QAAA,GAAA,IAAA;AAT+C,GAAA;AAWnDC,EAAAA,IAAI,EAAE,SAAA,IAAA,GAAW;AACb,SAAA,QAAA,GAAA,KAAA;AAZ+C,GAAA;AAcnDK,EAAAA,MAAM,EAAE,SAAA,MAAA,CAAA,KAAA,EAAgB;AACpB,QAAIb,QAAQ,GAAG,KAAf,OAAe,EAAf;;AACA,QAAA,QAAA,EAAc;AACV,UAAItC,MAAM,CAANA,OAAAA,CAAAA,SAAAA,CAAJ,KAAIA,CAAJ,EAAqC;AACjCsC,QAAAA,QAAQ,CAARA,MAAAA,CAAAA,KAAAA;AADJ,OAAA,MAEO;AACH,eAAOA,QAAQ,CAAf,MAAOA,EAAP;AACH;AACJ;AAtB8C,GAAA;AAwBnDc,EAAAA,KAAK,EAAE,SAAA,KAAA,CAAA,KAAA,EAAgB;AACnB,QAAId,QAAQ,GAAG,KAAf,OAAe,EAAf;;AACA,QAAA,QAAA,EAAc;AACV,UAAItC,MAAM,CAANA,OAAAA,CAAAA,SAAAA,CAAJ,KAAIA,CAAJ,EAAqC;AACjCsC,QAAAA,QAAQ,CAARA,KAAAA,CAAAA,KAAAA;AADJ,OAAA,MAEO;AACH,eAAOA,QAAQ,CAAf,KAAOA,EAAP;AACH;AACJ;AACJ;AAjCkD,CAAnC,CAApB;;AAmCA,IAAIe,oBAAoB,GAAG,aAAa,CAAb,OAAA,CAAsB;AAC7CH,EAAAA,gBAAgB,EAAE,SAAA,gBAAA,GAAW;AACzB,SAAA,QAAA;AACA,QAAIZ,QAAQ,GAAG,KAAf,OAAe,EAAf;AACAA,IAAAA,QAAQ,CAARA,QAAAA,CAAkB,KAAA,eAAA,CAAlBA,uBAAkB,CAAlBA;AAJyC,GAAA;AAM7CD,EAAAA,oBAAoB,EAAE,SAAA,oBAAA,GAAW;AAC7B,QAAIL,IAAI,GAAR,IAAA;AACA,QAAA,QAAA;;AACAA,IAAAA,IAAI,CAAJA,gBAAAA,GAAwB,UAAA,QAAA,EAAmB;AACvCM,MAAAA,QAAQ,GAAGN,IAAI,CAAfM,OAAWN,EAAXM;;AACA,UAAA,QAAA,EAAc;AACVA,QAAAA,QAAQ,CAARA,GAAAA,CAAa;AACTC,UAAAA,GAAG,EAAEC,QAAQ,CAACD;AADL,SAAbD;AAGAA,QAAAA,QAAQ,CAARA,MAAAA,CAAgBE,QAAQ,CAAxBF,MAAAA;AACH;AAPLN,KAAAA;;AASAA,IAAAA,IAAI,CAAJA,wBAAAA,CAAAA,eAAAA,CAAAA,GAAAA,CAAkDA,IAAI,CAAtDA,gBAAAA;AAlByC,GAAA;AAoB7CI,EAAAA,wBAAwB,EAAE,SAAA,wBAAA,GAAW;AACjC,SAAA,gBAAA,IAAyB,KAAA,wBAAA,CAAA,eAAA,CAAA,MAAA,CAAqD,KAA9E,gBAAyB,CAAzB;AArByC,GAAA;AAuB7CkB,EAAAA,KAAK,EAAE,SAAA,KAAA,GAAW;AACd,SAAA,cAAA,GAAsBvB,aAAa,CAAnC,IAAmC,CAAnC;;AACA,QAAI,KAAJ,SAAI,EAAJ,EAAsB;AAClB,WAAA,oBAAA;AACH;AA3BwC,GAAA;AA6B7Ca,EAAAA,SAAS,EAAE,SAAA,SAAA,GAAW;AAClB,WAAO,KAAA,MAAA,CAAA,mBAAA,MAAqCX,eAAe,CAAfA,IAAe,CAAfA,IAAyBF,aAAa,CAAlF,IAAkF,CAA3E,CAAP;AA9ByC,GAAA;AAgC7CU,EAAAA,aAAa,EAAE,SAAA,aAAA,CAAA,IAAA,EAAe;AAC1B,QAAI,0BAA0BC,IAAI,CAAlC,IAAA,EAAyC;AACrC,UAAIA,IAAI,CAAR,KAAA,EAAgB;AACZ,aAAA,KAAA;;AACA,aAAA,WAAA;;AACA,aAAA,IAAA,CAAA,IAAA;AAHJ,OAAA,MAIO;AACH,aAAA,wBAAA;;AACA,aAAA,cAAA,GAAsBX,aAAa,CAAnC,IAAmC,CAAnC;AACA,aAAA,IAAA,CAAA,IAAA;AACH;AACJ;;AACD,SAAA,QAAA,CAAA,IAAA;AA5CyC,GAAA;AA8C7CY,EAAAA,IAAI,EAAE,SAAA,IAAA,GAAW;AACb,SAAA,QAAA;AACA,SAAA,wBAAA,GAAgC,KAAA,aAAA,CAAhC,eAAgC,CAAhC;;AACA,SAAA,KAAA;AAjDyC,GAAA;AAmD7CE,EAAAA,IAAI,EAAE,SAAA,IAAA,GAAW;AACb,QAAIb,IAAI,GAAR,IAAA;AACA,QAAIM,QAAQ,GAAG,KAAf,OAAe,EAAf;;AACA,QAAIA,QAAQ,IAAI,CAACN,IAAI,CAArB,QAAA,EAAgC;AAC5B,UAAIA,IAAI,CAAR,cAAA,EAAyB;AACrBM,QAAAA,QAAQ,CAARA,WAAAA,CAAqBN,IAAI,CAAJA,eAAAA,CAArBM,6BAAqBN,CAArBM;AADJ,OAAA,MAEO;AACHA,QAAAA,QAAQ,CAARA,IAAAA;AACH;AACJ;;AACD,SAAA,QAAA;AA7DyC,GAAA;AA+D7CQ,EAAAA,IAAI,EAAE,SAAA,IAAA,CAAA,KAAA,EAAgB;AAClB,QAAIR,QAAQ,GAAG,KAAf,OAAe,EAAf;AACA,QAAIiB,2BAA2B,GAAG,KAAA,eAAA,CAAlC,6BAAkC,CAAlC;;AACA,QAAIjB,QAAQ,KAAK,KAAA,QAAA,IAAjB,KAAY,CAAZ,EAA0C;AACtC,UAAI,KAAJ,cAAA,EAAyB;AACrBA,QAAAA,QAAQ,CAARA,QAAAA,CAAAA,2BAAAA;AACAA,QAAAA,QAAQ,CAARA,GAAAA,CAAAA,MAAAA,EAAAA,EAAAA;AACAA,QAAAA,QAAQ,CAARA,IAAAA;AAHJ,OAAA,MAIO;AACH,YAAIA,QAAQ,CAARA,QAAAA,CAAJ,2BAAIA,CAAJ,EAAoD;AAChDA,UAAAA,QAAQ,CAARA,WAAAA,CAAAA,2BAAAA;AACH;;AACDA,QAAAA,QAAQ,CAARA,IAAAA;AACH;AACJ;;AACD,SAAA,QAAA;AA9EyC,GAAA;AAgF7CkB,EAAAA,OAAO,EAAE,SAAA,OAAA,CAAA,MAAA,EAAiB;AACtB,QAAIlB,QAAQ,GAAG,KAAf,OAAe,EAAf;;AACA,QAAA,QAAA,EAAc;AACVA,MAAAA,QAAQ,CAARA,GAAAA,CAAAA,MAAAA,EAAqBmB,MAAM,GAAG,KAAA,cAAA,GAAA,MAAA,GAA9BnB,IAAAA;AACH;AApFwC,GAAA;AAsF7CoB,EAAAA,YAAY,EAAE,SAAA,YAAA,CAAA,UAAA,EAAqB;AAC/BC,IAAAA,UAAU,GAAG3D,MAAM,CAANA,OAAAA,CAAAA,SAAAA,CAAAA,UAAAA,IAAAA,UAAAA,GAAb2D,EAAAA;AACA,QAAIrB,QAAQ,GAAG,KAAf,OAAe,EAAf;;AACA,QAAA,QAAA,EAAc;AACVA,MAAAA,QAAQ,CAARA,GAAAA,CAAAA,QAAAA,EAAAA,UAAAA;AACH;AA3FwC,GAAA;AA6F7CU,EAAAA,OAAO,EAAE,SAAA,OAAA,GAAW;AAChB,SAAA,wBAAA;;AACA,SAAA,QAAA;AACH;AAhG4C,CAAtB,CAA3B;AAkGA,IAAIY,kBAAkB,GAAG,aAAa,CAAb,OAAA,CAAsB;AAC3CjB,EAAAA,IAAI,EAAE,SAAA,IAAA,GAAW;AACb,QAAIX,IAAI,GAAR,IAAA;AACA,SAAA,QAAA;AACA,SAAA,aAAA,CAAA,MAAA,EAAA,cAAA,CAAA,GAAA,CAA8C,UAAA,SAAA,EAAoB;AAC9D,UAAI,CAAJ,SAAA,EAAgB;AACZA,QAAAA,IAAI,CAAJA,IAAAA;AACH;AAHL,KAAA;AAJuC,GAAA;AAU3CkB,EAAAA,gBAAgB,EAAE,SAAA,gBAAA,GAAW;AACzB,SAAA,QAAA;AACA,SAAA,OAAA,GAAA,QAAA,CAAA,qBAAA,EAAA,IAAA,CAAA,QAAA;AAZuC,GAAA;AAc3CJ,EAAAA,IAAI,EAAE,SAAA,IAAA,GAAW;AACb,QAAId,IAAI,GAAR,IAAA;;AACA,QAAI6B,OAAO,GAAG,KAAd,cAAc,EAAd;;AACA,QAAIvB,QAAQ,GAAG,KAAf,OAAe,EAAf;;AACA,QAAIA,QAAQ,IAAI,KAAhB,QAAA,EAA+B;AAC3BA,MAAAA,QAAQ,CAARA,GAAAA,CAAAA,SAAAA,EAAAA,MAAAA;AACH;;AACD,QAAIuB,OAAO,IAAI,CAACA,OAAO,CAAPA,QAAAA,CAAiB,MAAjBA,qBAAAA,EAAhB,MAAA,EAAsE;AAClEA,MAAAA,OAAO,CAAPA,OAAAA,CAAgB7B,IAAI,CAApB6B,OAAgB7B,EAAhB6B;AACH;;AACD7B,IAAAA,IAAI,CAAJA,QAAAA;AAxBuC,GAAA;AA0B3CY,EAAAA,SAAS,EAAE,SAAA,SAAA,GAAW;AAClB,QAAIkB,iBAAiB,GAAG,KAAA,MAAA,CAAxB,YAAwB,CAAxB;AACA,QAAIC,oBAAoB,GAAG,KAAA,MAAA,CAA3B,eAA2B,CAA3B;AACA,WAAOD,iBAAiB,IAAIA,iBAAiB,CAAtCA,OAAAA,IAAkDC,oBAAoB,IAAIA,oBAAoB,CAArG,OAAA;AA7BuC,GAAA;AA+B3ClB,EAAAA,IAAI,EAAE,SAAA,IAAA,CAAA,cAAA,EAAyB;AAC3B,QAAIb,IAAI,GAAR,IAAA;AACA,QAAIM,QAAQ,GAAG,KAAf,OAAe,EAAf;;AACA,QAAI0B,YAAY,GAAG,SAAfA,YAAe,CAAA,SAAA,EAAoB;AACnCnD,MAAAA,IAAI,CAAJA,OAAAA,CAAAA,IAAAA,CAAAA,QAAAA,EAAAA,IAAAA;;AACAA,MAAAA,IAAI,CAAJA,OAAAA,CAAAA,OAAAA,CAAAA,QAAAA,EAA+B;AAC3BoD,QAAAA,IAAI,EADuB,OAAA;AAE3BC,QAAAA,IAAI,EAAE;AACFd,UAAAA,KAAK,EADH,CAAA;AAEFe,UAAAA,OAAO,EAAEC,SAAS,CAACD;AAFjB,SAFqB;AAM3BE,QAAAA,EAAE,EANyB,SAAA;AAO3BC,QAAAA,QAAQ,EAPmB,GAAA;AAQ3BC,QAAAA,MAAM,EAAE;AARmB,OAA/B1D;AAFJ,KAAA;;AAaA,QAAIyB,QAAQ,IAAI,CAACN,IAAI,CAArB,QAAA,EAAgC;AAC5B,cAAA,cAAA;AACI,aAAA,OAAA;AACIgC,UAAAA,YAAY,CAAC;AACTZ,YAAAA,KAAK,EADI,MAAA;AAETe,YAAAA,OAAO,EAAE;AAFA,WAAD,CAAZH;AAIA;;AACJ,aAAA,eAAA;AACIA,UAAAA,YAAY,CAAC;AACTZ,YAAAA,KAAK,EADI,MAAA;AAETe,YAAAA,OAAO,EAAE;AAFA,WAAD,CAAZH;AAIA;;AACJ;AACI1B,UAAAA,QAAQ,CAARA,GAAAA,CAAAA,SAAAA,EAAAA,EAAAA;AAdR;AAgBH;;AACDN,IAAAA,IAAI,CAAJA,QAAAA;AACH;AAlE0C,CAAtB,CAAzB;;AAoEA,IAAIwC,kBAAkB,GAAG,aAAa,CAAb,OAAA,CAAA,IAAA,CAAA,OAAA,CAAmC;AACxDC,EAAAA,WAAW,EAD6C,KAAA;AAExDC,EAAAA,sBAAsB,EAAE,SAAA,sBAAA,CAAA,GAAA,EAAc;AAClC,QAAI1C,IAAI,GAAR,IAAA;AACA,QAAA,MAAA;AACA,KAAC,GAAG/B,SAAS,CAAb,IAAA,EAAoB+B,IAAI,CAAJA,YAAAA,CAApB,cAAA,EAAsD,UAAA,KAAA,EAAA,aAAA,EAA+B;AACjF,UAAA,aAAA,EAAmB;AACf,YAAI2C,YAAY,GAAGC,aAAa,CAAhC,eAAmBA,EAAnB;;AACA,YAAID,YAAY,KAAK,KAAA,CAAA,KAAWA,YAAY,CAAvB,MAAA,IAAkCE,GAAG,CAAHA,CAAAA,GAAQF,YAAY,CAAvEA,MAAY,CAAZA,KAAoF,KAAA,CAAA,KAAWA,YAAY,CAAvB,GAAA,IAA+BE,GAAG,CAAHA,CAAAA,GAAQF,YAAY,CAAvIA,GAAAA,MAAiJ,KAAA,CAAA,KAAWA,YAAY,CAAvB,IAAA,IAAgCE,GAAG,CAAHA,CAAAA,GAAQF,YAAY,CAArMA,IAAAA,MAAgN,KAAA,CAAA,KAAWA,YAAY,CAAvB,KAAA,IAAiCE,GAAG,CAAHA,CAAAA,GAAQF,YAAY,CAAzQ,KAAIA,CAAJ,EAAkR;AAC9QG,UAAAA,MAAM,GAANA,aAAAA;AACA,iBAAA,KAAA;AACH;AACJ;AAPL,KAAA;AASA,WAAA,MAAA;AAdoD,GAAA;AAgBxD3C,EAAAA,WAAW,EAAE,SAAA,WAAA,GAAW;AACpB,SAAA,OAAA,GAAA,QAAA,CAAwB,KAAA,eAAA,CAAA,qBAAA,IAAA,GAAA,GAAoD,KAAA,eAAA,CAApD,kBAAoD,CAApD,GAAA,GAAA,GAAxB,YAAA,EAAA,IAAA;AAjBoD,GAAA;AAmBxD4C,EAAAA,yBAAyB,EAAE,SAAA,yBAAA,GAAW;AAClC,QAAIC,MAAM,GAAG,KAAb,YAAA;AACAA,IAAAA,MAAM,CAANA,iBAAAA,GAA2B,CAA3BA,CAAAA;AACA,WAAOA,MAAM,CAAb,mBAAA;AACA,WAAOA,MAAM,CAAb,MAAA;AACA,WAAOA,MAAM,CAAb,IAAA;AACA,WAAOA,MAAM,CAAb,IAAA;AAzBoD,GAAA;AA2BxDC,EAAAA,sBAAsB,EAAE,SAAA,sBAAA,CAAA,QAAA,EAAA,YAAA,EAAiC;AACrD,QAAIjF,MAAM,CAANA,OAAAA,CAAAA,SAAAA,CAAJ,QAAIA,CAAJ,EAAwC;AACpC,aAAO;AACHkF,QAAAA,WAAW,EADR,YAAA;AAEHC,QAAAA,QAAQ,EAAEA;AAFP,OAAP;AAIH;;AACD,WAAA,YAAA;AAlCoD,GAAA;AAoCxDnC,EAAAA,OAAO,EAAE,SAAA,OAAA,GAAW;AAChB,QAAIoC,OAAO,GAAG,KAAd,OAAc,EAAd;AACA,SAAA,YAAA,GAAA,IAAA;AACAA,IAAAA,OAAO,IAAIA,OAAO,CAAPA,MAAAA,GAAAA,IAAAA,CAAsB,MAAM,KAAA,eAAA,CAA5BA,qBAA4B,CAA5BA,EAAXA,MAAWA,EAAXA;AAvCoD,GAAA;AAyCxDxC,EAAAA,SAAS,EAAE,SAAA,SAAA,GAAW;AAClB,QAAIyC,iBAAiB,GAAG,KAAA,aAAA,CAAxB,SAAwB,CAAxB;AACA,QAAIC,oBAAoB,GAAGD,iBAAiB,CAA5C,iBAA2BA,EAA3B;AACA,WAAO,KAAA,MAAA,CAAA,mBAAA,MAAqCpD,eAAe,CAAfA,IAAe,CAAfA,IAAyBqD,oBAAoB,CAA7CrD,aAAAA,IAA+DqD,oBAAoB,CAA/H,WAAO,CAAP;AA5CoD,GAAA;AA8CxD3C,EAAAA,IAAI,EAAE,SAAA,IAAA,GAAW;AACb,QAAIX,IAAI,GAAR,IAAA;AACA,SAAA,QAAA;AACA,SAAA,WAAA,GAAmB,KAAA,aAAA,CAAnB,gBAAmB,CAAnB;AACA,SAAA,6BAAA,GAAqC,KAAA,aAAA,CAArC,gBAAqC,CAArC;AACA,SAAA,aAAA,CAAA,MAAA,EAAA,cAAA,CAAA,GAAA,CAA8C,UAAA,SAAA,EAAoB;AAC9D,UAAIoD,OAAO,GAAGpD,IAAI,CAAlB,OAAcA,EAAd;;AACA,UAAI,CAAA,SAAA,IAAJ,OAAA,EAA2B;AACvBoD,QAAAA,OAAO,CAAPA,IAAAA;AACH;AAJL,KAAA;AAnDoD,GAAA;AA0DxDG,EAAAA,UAAU,EAAE,SAAA,UAAA,CAAA,OAAA,EAAkB;AAC1B,QAAIvD,IAAI,GAAR,IAAA;AACA,QAAIwD,aAAa,GAAGC,OAAO,CAA3B,aAAA;AACA,QAAIC,eAAe,GAAG,CAAC,CAACD,OAAO,CAAPA,YAAAA,CAAxB,IAAA;AACAzD,IAAAA,IAAI,CAAJA,WAAAA,GAAAA,IAAAA;AACAA,IAAAA,IAAI,CAAJA,YAAAA,GAAAA,OAAAA;AACAA,IAAAA,IAAI,CAAJA,YAAAA,GAAoB;AAChB2D,MAAAA,WAAW,EAAEF,OAAO,CADJ,KAAA;AAEhBG,MAAAA,iBAAiB,EAAE5D,IAAI,CAAJA,sBAAAA,CAA4ByD,OAAO,CAAnCzD,QAAAA,EAA8CyD,OAAO,CAFxD,WAEGzD,CAFH;AAGhB6D,MAAAA,mBAAmB,EAAEJ,OAAO,CAHZ,aAAA;AAIhBK,MAAAA,cAAc,EAAEL,OAAO,CAACK;AAJR,KAApB9D;;AAMA,QAAI+D,QAAQ,GAAGrG,aAAa,CAAbA,OAAAA,CAAf,WAAeA,EAAf;;AACAsC,IAAAA,IAAI,CAAJA,cAAAA,GAAsB+D,QAAQ,CAA9B/D,aAAAA;;AACA+D,IAAAA,QAAQ,CAARA,aAAAA,GAAyB,YAAW;AAChC,aAAA,KAAA;AADJA,KAAAA;;AAGA/D,IAAAA,IAAI,CAAJA,WAAAA,CAAAA,IAAAA,CAAsBA,IAAI,CAA1BA,YAAAA;;AACAA,IAAAA,IAAI,CAAJA,OAAAA,GAAAA,GAAAA,CAAmB;AACfgE,MAAAA,SAAS,EAAER,aAAa,IAAIA,aAAa,CAAbA,GAAAA,CADb,WACaA,CADb;AAEfrC,MAAAA,MAAM,EAAEqC,aAAa,KAAKE,eAAe,IAAIF,aAAa,CAAbA,GAAAA,CAAAA,CAAAA,EAAnBE,YAAAA,IAAwDF,aAAa,CAFhF,MAEmEA,EAA7D,CAFN;AAGfpC,MAAAA,KAAK,EAAEoC,aAAa,KAAKE,eAAe,IAAIF,aAAa,CAAbA,GAAAA,CAAAA,CAAAA,EAAnBE,WAAAA,IAAuDF,aAAa,CAH9E,KAGiEA,EAA5D,CAHL;AAIfS,MAAAA,UAAU,EAAET,aAAa,IAAIA,aAAa,CAAbA,GAAAA,CAAAA,YAAAA;AAJd,KAAnBxD,EAAAA,QAAAA,CAKYA,IAAI,CAAJA,eAAAA,CALZA,yBAKYA,CALZA,EAAAA,WAAAA,CAAAA,2BAAAA,EAAAA,eAAAA,EAAAA,IAAAA,CAK4H0D,eAAe,GAAA,EAAA,GAAQD,OAAO,CAAPA,YAAAA,CALnJzD,OAAAA;AAMAA,IAAAA,IAAI,CAAJA,OAAAA,GAAAA,QAAAA,CAAwB,CAAC,GAAGlB,iBAAiB,CAArB,kBAAA,EAAxBkB,aAAwB,CAAxBA;AAlFoD,GAAA;AAoFxDkE,EAAAA,UAAU,EAAE,SAAA,UAAA,CAAA,IAAA,EAAe;AACvB,QAAIC,CAAC,GAAGzD,IAAI,CAAZ,KAAA;AACA,QAAIV,IAAI,GAAGmE,CAAC,CAADA,IAAAA,CAAX,IAAA;AACA,QAAA,OAAA;AACA,QAAA,MAAA;AACA,QAAA,UAAA;AACA,QAAA,UAAA;AACA,QAAIC,SAAS,GAAG,CAAC,GAAGjG,MAAM,CAAV,SAAA,EAAhB,CAAgB,CAAhB;AACA,QAAIkG,UAAU,GAAGrE,IAAI,CAAJA,6BAAAA,GAAqCA,IAAI,CAAJA,6BAAAA,CAArCA,UAAqCA,EAArCA,GAAjB,KAAA;AACA,QAAIsE,WAAW,GAAGtE,IAAI,CAAtB,YAAA;;AACA,QAAIA,IAAI,CAAJA,WAAAA,IAAoB,CAAxB,UAAA,EAAqC;AACjC,UAAIM,QAAQ,GAAGN,IAAI,CAAnB,OAAeA,EAAf;AACAuE,MAAAA,UAAU,GAAGC,IAAI,CAAJA,GAAAA,CAASJ,SAAS,CAATA,CAAAA,GAAcE,WAAW,CAAXA,aAAAA,CAAAA,MAAAA,GAAdF,IAAAA,GAAwDE,WAAW,CAAzFC,MAAaC,CAAbD;AACAE,MAAAA,UAAU,GAAGD,IAAI,CAAJA,GAAAA,CAASJ,SAAS,CAATA,CAAAA,GAAcE,WAAW,CAAXA,aAAAA,CAAAA,MAAAA,GAAdF,GAAAA,GAAuDE,WAAW,CAAxFG,MAAaD,CAAbC;;AACA,UAAInE,QAAQ,CAARA,EAAAA,CAAAA,UAAAA,KAA2BiE,UAAU,GAArCjE,cAAAA,IAA0DmE,UAAU,GAAxE,cAAA,EAA2F;AACvFnE,QAAAA,QAAQ,CAARA,IAAAA;AACAoE,QAAAA,OAAO,GAAGN,SAAS,CAATA,CAAAA,GAAcE,WAAW,CAAnCI,MAAAA;AACAC,QAAAA,MAAM,GAAGP,SAAS,CAATA,CAAAA,GAAcE,WAAW,CAAlCK,MAAAA;AACArE,QAAAA,QAAQ,CAARA,GAAAA,CAAa;AACTsE,UAAAA,IAAI,EADK,OAAA;AAETrE,UAAAA,GAAG,EAAEoE;AAFI,SAAbrE;AAIAN,QAAAA,IAAI,CAAJA,UAAAA,CAAAA,SAAAA;AACH;;AACDmE,MAAAA,CAAC,CAADA,cAAAA;AACH;AA7GmD,GAAA;AA+GxDU,EAAAA,UAAU,EAAE,SAAA,UAAA,CAAA,SAAA,EAAoB;AAC5B,QAAI7E,IAAI,GAAR,IAAA;;AACA,QAAI8E,mBAAmB,GAAG9E,IAAI,CAAJA,sBAAAA,CAA1B,SAA0BA,CAA1B;;AACA,QAAI+E,UAAU,GAAG/E,IAAI,CAArB,WAAA;AACA,QAAA,CAAA;AACA,QAAIgD,MAAM,GAAGhD,IAAI,CAAjB,YAAA;AACA,QAAIsE,WAAW,GAAGtE,IAAI,CAAtB,YAAA;AACA,QAAA,cAAA;;AACA,QAAA,mBAAA,EAAyB;AACrB,UAAIgF,UAAU,GAAGhF,IAAI,CAAJA,MAAAA,CAAjB,YAAiBA,CAAjB;AACA,UAAIiF,qBAAqB,GAAG,oBAAoBH,mBAAmB,CAAnE,OAAgDA,EAAhD;AACA,UAAII,QAAQ,GAAGD,qBAAqB,GAAA,GAAA,GAApC,GAAA;AACA,UAAIE,cAAc,GAAGL,mBAAmB,CAAxC,OAAqBA,EAArB;AACA,UAAI3B,QAAQ,GAAG,cAAA,cAAA,GAA+BmB,WAAW,CAA1C,QAAA,GAAsD,KAArE,CAAA;AACA,UAAIc,YAAY,GAAGd,WAAW,CAA9B,YAAA;AACA,UAAIe,cAAc,GAAGP,mBAAmB,CAAnBA,iBAAAA,CAAAA,QAAAA,EAAgDM,YAAY,IAAIA,YAAY,CAA5EN,SAAAA,KAArB,EAAA;AACA,UAAIQ,cAAc,GAAGhB,WAAW,CAAXA,cAAAA,GAA6BA,WAAW,CAAXA,cAAAA,IAAlD,EAAA;AACA,UAAIiB,eAAe,GAAG,oBAAA,cAAA,GAAA,EAAA,GAA0CD,cAAc,CAAdA,cAAc,CAAdA,IAAkC,UAAU,CAAV,wBAAA,CAAoC,CAAC,GAAGpH,OAAO,CAAX,MAAA,EAAA,EAAA,EAAA,WAAA,EAAqC;AACvK4G,QAAAA,mBAAmB,EADoJ,mBAAA;AAEvKU,QAAAA,OAAO,EAAEV,mBAAmB,CAAnBA,UAAAA,CAF8J,QAE9JA,CAF8J;AAGvKO,QAAAA,cAAc,EAHyJ,cAAA;AAIvKJ,QAAAA,qBAAqB,EAJkJ,qBAAA;AAKvKQ,QAAAA,gBAAgB,EAAE,cAAA,cAAA,IAAgC,CAAC,GAAGlI,UAAU,CAAd,OAAA,EAAwB8H,cAAc,CAAtC,CAAsC,CAAtC,EAAA,KAAA;AALqH,OAArC,CAApC,CAAlG;AAOAC,MAAAA,cAAc,CAAdA,cAAc,CAAdA,GAAAA,eAAAA;AACAtC,MAAAA,MAAM,CAANA,cAAAA,GAAAA,cAAAA;;AACA,UAAIuC,eAAe,CAAfA,MAAAA,GAAJ,CAAA,EAAgC;AAC5B,aAAKG,CAAC,GAAN,CAAA,EAAYA,CAAC,GAAGH,eAAe,CAA/B,MAAA,EAAwCG,CAAxC,EAAA,EAA6C;AACzCC,UAAAA,cAAc,GAAGJ,eAAe,CAACG,CAAC,GAAjBH,CAAe,CAAfA,IAA0B,CAACA,eAAe,CAAfA,CAAe,CAAfA,CAAAA,QAAAA,IAA+BA,eAAe,CAACG,CAAC,GAAjBH,CAAe,CAAfA,CAAhC,QAAgCA,CAAhC,IAA3CI,CAAAA;;AACA,cAAI,KAAA,CAAA,KAAA,cAAA,KAA8BX,UAAU,IAAI,QAAdA,QAAAA,GAAiCZ,SAAS,CAATA,QAAS,CAATA,GAAjCY,cAAAA,GAAwEZ,SAAS,CAATA,QAAS,CAATA,GAA1G,cAAI,CAAJ,EAAiJ;AAC7IpB,YAAAA,MAAM,CAANA,iBAAAA,GAA2BhD,IAAI,CAAJA,sBAAAA,CAAAA,QAAAA,EAAsCuF,eAAe,CAAfA,CAAe,CAAfA,CAAjEvC,WAA2BhD,CAA3BgD;;AACA,gBAAIqC,cAAc,CAAlB,CAAkB,CAAlB,EAAuB;AACnBrC,cAAAA,MAAM,CAANA,mBAAAA,GAA6BqC,cAAc,CAAdA,EAAAA,CAA7BrC,CAA6BqC,CAA7BrC;AACAA,cAAAA,MAAM,CAANA,MAAAA,GAAAA,KAAAA;AAFJ,aAAA,MAGO;AACHA,cAAAA,MAAM,CAANA,mBAAAA,GAA6BqC,cAAc,CAA3CrC,IAA6BqC,EAA7BrC;AACAA,cAAAA,MAAM,CAANA,MAAAA,GAAAA,IAAAA;AACH;;AACDA,YAAAA,MAAM,CAANA,IAAAA,GAAcuC,eAAe,CAAfA,CAAe,CAAfA,CAAdvC,CAAAA;AACAA,YAAAA,MAAM,CAANA,IAAAA,GAAcuC,eAAe,CAAfA,CAAe,CAAfA,CAAdvC,CAAAA;AACA+B,YAAAA,UAAU,CAAVA,IAAAA,CAAAA,MAAAA;AACA;AACH;AACJ;AAjBL,OAAA,MAkBO;AACH/E,QAAAA,IAAI,CAAJA,yBAAAA;;AACA+E,QAAAA,UAAU,CAAVA,IAAAA,CAAAA,MAAAA;AACH;AACJ;AA/JmD,GAAA;AAiKxDa,EAAAA,UAAU,EAAE,SAAA,UAAA,CAAA,IAAA,EAAe;AACvB,QAAIzB,CAAC,GAAGzD,IAAI,CAAZ,KAAA;AACA,QAAIV,IAAI,GAAGmE,CAAC,CAADA,IAAAA,CAAX,IAAA;AACA,QAAIY,UAAU,GAAG/E,IAAI,CAArB,WAAA;AACAA,IAAAA,IAAI,CAAJA,OAAAA,GAAAA,IAAAA;;AACA,QAAI+E,UAAU,IAAI/E,IAAI,CAAtB,WAAA,EAAoC;AAChC+E,MAAAA,UAAU,CAAVA,IAAAA,CAAgB/E,IAAI,CAApB+E,YAAAA;AACH;;AACD/E,IAAAA,IAAI,CAAJA,OAAAA,GAAAA,QAAAA,CAAwBA,IAAI,CAA5BA,cAAwBA,EAAxBA;AACAA,IAAAA,IAAI,CAAJA,YAAAA,GAAAA,IAAAA;AACAA,IAAAA,IAAI,CAAJA,YAAAA,GAAAA,IAAAA;AACAA,IAAAA,IAAI,CAAJA,WAAAA,GAAAA,KAAAA;AACAtC,IAAAA,aAAa,CAAbA,OAAAA,CAAAA,WAAAA,GAAAA,aAAAA,GAAoDsC,IAAI,CAAJA,cAAAA,IAApDtC,IAAAA;AACH;AA9KuD,CAAnC,CAAzB;;AAgLA,IAAImI,wBAAwB,GAAG,SAA3BA,wBAA2B,CAAA,IAAA,EAAe;AAC1C,SAAO,aAAa7F,IAAI,CAAJA,MAAAA,CAApB,oBAAoBA,CAApB;AADJ,CAAA;;AAGA,IAAI8F,4BAA4B,GAAG,aAAa,CAAb,OAAA,CAAA,cAAA,CAAA,OAAA,CAA6C;AAC5EC,EAAAA,iBAAiB,EAAE,SAAA,iBAAA,CAAA,IAAA,EAAe;AAC9B,QAAI,KAAJ,kBAAA,EAA6B;AACzB,UAAI3C,OAAO,GAAG,KAAA,kBAAA,CAAd,OAAc,EAAd;;AACA,UAAA,gBAAA;AACA,UAAA,SAAA;;AACA,UAAA,OAAA,EAAa;AACT4C,QAAAA,SAAS,GAAG5C,OAAO,CAAPA,MAAAA,GAAZ4C,GAAAA;AACAC,QAAAA,gBAAgB,GAAG,KAAA,kBAAA,CAAnBA,mBAAmB,EAAnBA;AACA,eAAOC,IAAI,IAAJA,SAAAA,IAAqBA,IAAI,IAAIF,SAAS,GAA7C,gBAAA;AACH;AACJ;;AACD,WAAA,KAAA;AAZwE,GAAA;AAc5EG,EAAAA,aAAa,EAAE,SAAA,aAAA,CAAA,KAAA,EAAA,WAAA,EAAA,OAAA,EAAsC;AACjD,QAAA,aAAA;AACA,QAAIC,gBAAgB,GAAGP,wBAAwB,CAA/C,IAA+C,CAA/C;AACA,QAAIb,UAAU,GAAG,KAAA,MAAA,CAAjB,YAAiB,CAAjB;AACA,QAAIqB,qBAAqB,GAAG,CAAA,gBAAA,IAAA,UAAA,GAAA,CAAA,GAA5B,CAAA;AACA,QAAA,UAAA;;AACA,QAAIC,KAAK,CAALA,KAAAA,IAAAA,qBAAAA,IAAwCA,KAAK,CAALA,KAAAA,GAAcC,WAAW,IAAI,CAAA,gBAAA,IAAqB,CAArB,UAAA,GAAA,CAAA,GAAzE,CAAqE,CAArE,EAAoH;AAChHD,MAAAA,KAAK,CAALA,WAAAA,IAAAA,qBAAAA;AACAE,MAAAA,aAAa,GAAGhB,OAAO,CAACc,KAAK,CAAbd,WAAO,CAAPA,IAAhBgB,EAAAA;AACAC,MAAAA,UAAU,GAAGjB,OAAO,CAACc,KAAK,CAALA,WAAAA,GAARd,CAAO,CAAPA,IAAbiB,EAAAA;AACA,aAAO,EAAEL,gBAAgB,GAAGI,aAAa,CAAbA,aAAAA,IAA+BC,UAAU,CAA5C,aAAA,GAA6DD,aAAa,CAAnG,aAAO,CAAP;AACH;;AACD,WAAA,IAAA;AA1BwE,GAAA;AA4B5EE,EAAAA,eAAe,EAAE,SAAA,eAAA,CAAA,eAAA,EAAA,QAAA,EAAA,MAAA,EAA4C;AACzD,QAAA,eAAA,EAAqB;AACjB,WAAK,IAAIhB,CAAC,GAAV,CAAA,EAAgBA,CAAC,GAAGH,eAAe,CAAnC,MAAA,EAA4CG,CAA5C,EAAA,EAAiD;AAC7C,YAAIH,eAAe,CAAfA,CAAe,CAAfA,CAAAA,CAAAA,KAAyBA,eAAe,CAAfA,CAAe,CAAfA,CAAzBA,CAAAA,IAAiDA,eAAe,CAACG,CAAC,GAAlEH,CAAgE,CAAhEA,IAA2EA,eAAe,CAAfA,CAAe,CAAfA,CAAAA,CAAAA,KAAyBA,eAAe,CAACG,CAAC,GAAjBH,CAAe,CAAfA,CAAxG,CAAA,EAAkI;AAC9H;AACH;;AACD,YAAIA,eAAe,CAAfA,CAAe,CAAfA,CAAAA,CAAAA,GAAAA,MAAAA,IAAAA,QAAAA,IAA6CoB,QAAQ,IAAIpB,eAAe,CAAfA,CAAe,CAAfA,CAAAA,CAAAA,GAA7D,MAAA,EAA4F;AACxF,iBAAOA,eAAe,CAAtB,CAAsB,CAAtB;AACH;AACJ;AACJ;;AACD,WAAA,IAAA;AAvCwE,GAAA;AAyC5EqB,EAAAA,cAAc,EAAE,SAAA,cAAA,CAAA,IAAA,EAAe;AAC3B,QAAIzC,CAAC,GAAGzD,IAAI,CAAZ,KAAA;AACA,QAAIV,IAAI,GAAGmE,CAAC,CAAZ,IAAA;;AACA,QAAI0C,qBAAqB,GAAG7G,IAAI,CAAJA,qBAAAA,CAA5B,KAA4BA,EAA5B;;AACA,QAAIoG,gBAAgB,GAAGP,wBAAwB,CAA/C,IAA+C,CAA/C;AACA,QAAIiB,MAAM,GAAGD,qBAAqB,GAAlC,CAAA;;AACA,QAAIE,YAAY,GAAG/G,IAAI,CAAJA,iBAAAA,CAAnB,MAAmBA,EAAnB;;AACA,QAAIgH,gBAAgB,GAAGD,YAAY,CAAnC,IAAA;AACA,QAAI3C,SAAS,GAAG,CAAC,GAAGjG,MAAM,CAAV,SAAA,EAAhB,CAAgB,CAAhB;;AACA,QAAI6B,IAAI,CAAJA,WAAAA,IAAoBA,IAAI,CAA5B,aAAA,EAA4C;AACxC,UAAIgH,gBAAgB,IAAI5C,SAAS,CAA7B4C,CAAAA,KAAoC,CAAA,gBAAA,IAAqB5C,SAAS,CAATA,CAAAA,IAAe4C,gBAAgB,GAAGhH,IAAI,CAAJA,iBAAAA,CAA/F,KAA+FA,EAA3FgH,CAAJ,EAAgI;AAC5H,YAAIhH,IAAI,CAAJA,2BAAAA,CAAiCoE,SAAS,CAA9C,CAAIpE,CAAJ,EAAmD;AAC/C,cAAIiH,KAAK,GAAGjH,IAAI,CAAJA,kBAAAA,CAAAA,iBAAAA,GAAAA,EAAAA,CAA+CA,IAAI,CAAJA,aAAAA,CAA3D,kBAAYA,CAAZ;;AACAA,UAAAA,IAAI,CAAJA,qBAAAA,CAAAA,OAAAA,CAAmCiH,KAAK,CAALA,MAAAA,GAAAA,IAAAA,IAAuBb,gBAAgB,IAAIpG,IAAI,CAAJA,MAAAA,CAApBoG,YAAoBpG,CAApBoG,GAAAA,CAAAA,GAAoDa,KAAK,CAAnHjH,UAA8GiH,EAA3EA,CAAnCjH;;AACAA,UAAAA,IAAI,CAAJA,wBAAAA,CAAAA,MAAAA,CAAqCA,IAAI,CAAJA,YAAAA,CAArCA,CAAAA;;AACAmE,UAAAA,CAAC,CAADA,cAAAA;AACH;AACJ;AARL,KAAA,MASO;AACH,UAAInE,IAAI,CAAJA,iBAAAA,CAAuBoE,SAAS,CAApC,CAAIpE,CAAJ,EAAyC;AACrC,YAAIA,IAAI,CAAR,qBAAA,EAAgC;AAC5B,cAAIA,IAAI,CAAJA,qBAAAA,CAAAA,IAAAA,KAAoC+G,YAAY,CAAhD/G,IAAAA,IAAyDA,IAAI,CAAJA,qBAAAA,CAAAA,GAAAA,KAAmC+G,YAAY,CAA5G,GAAA,EAAkH;AAC9G/G,YAAAA,IAAI,CAAJA,eAAAA,CAAAA,IAAAA;AACH;AACJ;;AACDA,QAAAA,IAAI,CAAJA,YAAAA,GAAoBA,IAAI,CAAJA,eAAAA,CAAqBA,IAAI,CAAzBA,eAAqBA,EAArBA,EAA6CoE,SAAS,CAAtDpE,CAAAA,EAApBA,qBAAoBA,CAApBA;AACAA,QAAAA,IAAI,CAAJA,qBAAAA,GAAAA,YAAAA;AACAA,QAAAA,IAAI,CAAJA,gBAAAA,GAAAA,KAAAA;;AACA,YAAIA,IAAI,CAAR,YAAA,EAAuB;AACnBA,UAAAA,IAAI,CAAJA,qBAAAA,CAAAA,YAAAA,CAAAA,YAAAA;;AACAA,UAAAA,IAAI,CAAJA,qBAAAA,CAAAA,OAAAA,CAAmCA,IAAI,CAAJA,YAAAA,CAAAA,CAAAA,GAAnCA,MAAAA;;AACAA,UAAAA,IAAI,CAAJA,wBAAAA,CAAAA,MAAAA,CAAqCA,IAAI,CAAJA,YAAAA,CAArCA,CAAAA;;AACAA,UAAAA,IAAI,CAAJA,gBAAAA,GAAAA,IAAAA;AACAmE,UAAAA,CAAC,CAADA,cAAAA;AALJ,SAAA,MAMO;AACHnE,UAAAA,IAAI,CAAJA,qBAAAA,CAAAA,YAAAA;AACH;AAjBL,OAAA,MAkBO;AACHA,QAAAA,IAAI,CAAJA,eAAAA,CAAAA,IAAAA;AACAA,QAAAA,IAAI,CAAJA,gBAAAA,GAAAA,KAAAA;;AACAA,QAAAA,IAAI,CAAJA,qBAAAA,CAAAA,YAAAA;AACH;AACJ;AAnFuE,GAAA;AAqF5EkH,EAAAA,YAAY,EAAE,SAAA,YAAA,CAAA,IAAA,EAAe;AACzB,QAAI/C,CAAC,GAAGzD,IAAI,CAAZ,KAAA;AACA,QAAIV,IAAI,GAAGmE,CAAC,CAAZ,IAAA;;AACA,QAAInE,IAAI,CAAR,WAAA,EAAsB;AAClBA,MAAAA,IAAI,CAAJA,eAAAA,CAAAA,IAAAA;AACAA,MAAAA,IAAI,CAAJA,aAAAA,GAAAA,IAAAA;;AACAA,MAAAA,IAAI,CAAJA,qBAAAA,CAAAA,IAAAA;;AACAA,MAAAA,IAAI,CAAJA,qBAAAA,CAAAA,YAAAA;;AACAA,MAAAA,IAAI,CAAJA,YAAAA,CAAAA,IAAAA;;AACA,UAAI,CAAC6F,wBAAwB,CAA7B,IAA6B,CAA7B,EAAqC;AACjC,YAAIsB,SAAS,GAAGnH,IAAI,CAAJA,SAAAA,CAAhB,SAAgBA,EAAhB;AACAA,QAAAA,IAAI,CAAJA,SAAAA,CAAAA,gBAAAA;;AACA,YAAIA,IAAI,CAAJA,MAAAA,CAAAA,iBAAAA,KAAkC,cAAcA,IAAI,CAAJA,MAAAA,CAApD,gBAAoDA,CAApD,EAAmF;AAC/E,cAAIoH,UAAU,GAAGpH,IAAI,CAAJA,SAAAA,CAAjB,aAAiBA,EAAjB;AACAoH,UAAAA,UAAU,IAAI,UAAU,CAAV,IAAA,GAAA,IAAA,CAAuB,YAAW;AAC5CpH,YAAAA,IAAI,CAAJA,SAAAA,CAAAA,YAAAA,CAAAA,SAAAA;AADJoH,WAAc,CAAdA;AAGH;AACJ;;AACDpH,MAAAA,IAAI,CAAJA,gBAAAA,GAAAA,KAAAA;AACAA,MAAAA,IAAI,CAAJA,WAAAA,GAAAA,KAAAA;AACH;AA1GuE,GAAA;AA4G5EqH,EAAAA,mBAAmB,EAAE,SAAA,mBAAA,CAAA,kBAAA,EAA6B;AAC9C,WAAOC,kBAAkB,GAAzB,CAAA;AA7GwE,GAAA;AA+G5EC,EAAAA,kBAAkB,EAAE,SAAA,kBAAA,CAAA,IAAA,EAAe;AAC/B,QAAIvH,IAAI,GAAR,IAAA;AACA,QAAIsH,kBAAkB,GAAGtH,IAAI,CAAJA,YAAAA,CAAzB,WAAA;;AACA,QAAIwH,eAAe,GAAGxH,IAAI,CAAJA,mBAAAA,CAAtB,kBAAsBA,CAAtB;;AACA,QAAIyH,aAAa,GAAGzH,IAAI,CAAJA,kBAAAA,CAAAA,gBAAAA,CAApB,kBAAoBA,CAApB;;AACA,QAAI0H,UAAU,GAAG1H,IAAI,CAAJA,kBAAAA,CAAAA,gBAAAA,CAAjB,eAAiBA,CAAjB;;AACAA,IAAAA,IAAI,CAAJA,aAAAA,GAAqB;AACjB2H,MAAAA,SAAS,EADQ,IAAA;AAEjBL,MAAAA,kBAAkB,EAFD,kBAAA;AAGjBM,MAAAA,kBAAkB,EAAEH,aAAa,IAAIA,aAAa,CAAbA,MAAAA,GAAjBA,CAAAA,GAA4CA,aAAa,CAAbA,CAAa,CAAbA,CAAAA,qBAAAA,GAA5CA,KAAAA,GAHH,CAAA;AAIjBD,MAAAA,eAAe,EAJE,eAAA;AAKjBK,MAAAA,eAAe,EAAEH,UAAU,IAAIA,UAAU,CAAVA,MAAAA,GAAdA,CAAAA,GAAsCA,UAAU,CAAVA,CAAU,CAAVA,CAAAA,qBAAAA,GAAtCA,KAAAA,GAAoF;AALpF,KAArB1H;AArHwE,GAAA;AA6H5E8H,EAAAA,cAAc,EAAE,SAAA,cAAA,CAAA,IAAA,EAAe;AAC3B,QAAI3D,CAAC,GAAGzD,IAAI,CAAZ,KAAA;AACA,QAAIV,IAAI,GAAGmE,CAAC,CAAZ,IAAA;AACA,QAAIC,SAAS,GAAG,CAAC,GAAGjG,MAAM,CAAV,SAAA,EAAhB,CAAgB,CAAhB;AACA,QAAI4J,iBAAiB,GAAG/H,IAAI,CAAJA,aAAAA,CAAxB,SAAwBA,CAAxB;AACA,QAAIgI,WAAW,GAAGhI,IAAI,CAAJA,MAAAA,CAAlB,cAAkBA,CAAlB;AACA,QAAIiI,aAAa,GAAGF,iBAAiB,CAAjBA,SAAAA,OAAkC,YAAA,WAAA,IAA2B,WAAjF,WAAoBA,CAApB;;AACA,QAAI,CAAC,GAAG5J,MAAM,CAAV,YAAA,EAAJ,CAAI,CAAJ,EAAiC;AAC7B,UAAI6B,IAAI,CAAJA,iBAAAA,CAAuBoE,SAAS,CAApC,CAAIpE,CAAJ,EAAyC;AACrCA,QAAAA,IAAI,CAAJA,YAAAA,GAAoBA,IAAI,CAAJA,eAAAA,CAAqBA,IAAI,CAAzBA,eAAqBA,EAArBA,EAA6CoE,SAAS,CAAtDpE,CAAAA,EAApBA,qCAAoBA,CAApBA;;AACA,YAAIA,IAAI,CAAR,YAAA,EAAuB;AACnBA,UAAAA,IAAI,CAAJA,qBAAAA,CAAAA,OAAAA,CAAmCA,IAAI,CAAJA,YAAAA,CAAAA,CAAAA,GAAsBA,IAAI,CAAJA,qBAAAA,CAAAA,KAAAA,KAAzDA,CAAAA;;AACAA,UAAAA,IAAI,CAAJA,gBAAAA,GAAAA,IAAAA;AACH;AALL,OAAA,MAMO;AACHA,QAAAA,IAAI,CAAJA,gBAAAA,GAAAA,KAAAA;AACH;AACJ;;AACD,QAAIA,IAAI,CAAJA,gBAAAA,IAAyB,CAA7B,aAAA,EAA6C;AACzCA,MAAAA,IAAI,CAAJA,kBAAAA,CAAwBoE,SAAS,CAAjCpE,CAAAA;;AACAA,MAAAA,IAAI,CAAJA,WAAAA,GAAAA,IAAAA;;AACAA,MAAAA,IAAI,CAAJA,wBAAAA,CAAAA,MAAAA,CAAqCA,IAAI,CAAJA,YAAAA,CAArCA,CAAAA;;AACAA,MAAAA,IAAI,CAAJA,qBAAAA,CAAAA,IAAAA;;AACAA,MAAAA,IAAI,CAAJA,YAAAA,CAAAA,IAAAA;;AACAmE,MAAAA,CAAC,CAADA,cAAAA;AACAA,MAAAA,CAAC,CAADA,eAAAA;AACH;AAvJuE,GAAA;AAyJ5E+D,EAAAA,wBAAwB,EAAE,SAAA,wBAAA,GAAW;AACjC,QAAIlI,IAAI,GAAR,IAAA;AACA,QAAIwF,OAAO,GAAGxF,IAAI,CAAJA,kBAAAA,GAA0BA,IAAI,CAAJA,kBAAAA,CAA1BA,iBAA0BA,EAA1BA,GAAd,EAAA;;AACA,QAAImI,KAAK,GAAGnI,IAAI,CAAJA,kBAAAA,CAAZ,iBAAYA,EAAZ;;AACA,QAAIuF,eAAe,GAAnB,EAAA;;AACA,QAAI4C,KAAK,IAAIA,KAAK,CAALA,MAAAA,GAAb,CAAA,EAA+B;AAC3B5C,MAAAA,eAAe,GAAG,aAAa,CAAb,OAAA,CAAA,kBAAA,CAAA,KAAA,EAAgD,UAAA,KAAA,EAAgB;AAC9E,eAAOvF,IAAI,CAAJA,aAAAA,CAAAA,KAAAA,EAA0BmI,KAAK,CAA/BnI,MAAAA,EAAP,OAAOA,CAAP;AADJuF,OAAkB,CAAlBA;AAGH;;AACDvF,IAAAA,IAAI,CAAJA,gBAAAA,GAAAA,eAAAA;AAnKwE,GAAA;AAqK5EoI,EAAAA,sBAAsB,EAAE,SAAA,sBAAA,GAAW;AAC/B,SAAA,qBAAA,IAA8BxK,eAAe,CAAfA,OAAAA,CAAAA,GAAAA,CAA4BF,aAAa,CAAbA,OAAAA,CAA5BE,WAA4BF,EAA5BE,EAAiE,CAAC,GAAGO,MAAM,CAAV,YAAA,EAAyBE,SAAS,CAATA,OAAAA,CAAzB,IAAA,EAAjET,gBAAiE,CAAjEA,EAAqI,KAAnK,qBAA8BA,CAA9B;AACA,SAAA,qBAAA,IAA8BA,eAAe,CAAfA,OAAAA,CAAAA,GAAAA,CAA4B,KAA5BA,iBAAAA,EAAoD,CAAC,GAAGO,MAAM,CAAV,YAAA,EAAyBE,SAAS,CAATA,OAAAA,CAAzB,IAAA,EAApDT,gBAAoD,CAApDA,EAAwH,KAAtJ,qBAA8BA,CAA9B;;AACA,QAAI,KAAJ,mBAAA,EAA8B;AAC1BA,MAAAA,eAAe,CAAfA,OAAAA,CAAAA,GAAAA,CAA4B,KAAA,qBAAA,CAA5BA,OAA4B,EAA5BA,EAAkE,CAAC,GAAGO,MAAM,CAAV,YAAA,EAAyBE,SAAS,CAATA,OAAAA,CAAzB,EAAA,EAAlET,gBAAkE,CAAlEA,EAAoI,KAApIA,mBAAAA;;AACAA,MAAAA,eAAe,CAAfA,OAAAA,CAAAA,GAAAA,CAA4BF,aAAa,CAAbA,OAAAA,CAA5BE,WAA4BF,EAA5BE,EAAiE,CAAC,GAAGO,MAAM,CAAV,YAAA,EAAyBE,SAAS,CAATA,OAAAA,CAAzB,EAAA,EAAjET,gBAAiE,CAAjEA,EAAmI,KAAnIA,mBAAAA;AACH;AA3KuE,GAAA;AA6K5EyK,EAAAA,kBAAkB,EAAE,SAAA,kBAAA,GAAW;AAC3B,SAAA,qBAAA,GAA6B,KAAA,YAAA,CAAkB,KAA/C,cAA6B,CAA7B;AACA,SAAA,qBAAA,GAA6B,KAAA,YAAA,CAAkB,KAA/C,cAA6B,CAA7B;AACA,SAAA,mBAAA,GAA2B,KAAA,YAAA,CAAkB,KAA7C,YAA2B,CAA3B;;AACAzK,IAAAA,eAAe,CAAfA,OAAAA,CAAAA,EAAAA,CAA2BF,aAAa,CAAbA,OAAAA,CAA3BE,WAA2BF,EAA3BE,EAAgE,CAAC,GAAGO,MAAM,CAAV,YAAA,EAAyBE,SAAS,CAATA,OAAAA,CAAzB,IAAA,EAAhET,gBAAgE,CAAhEA,EAAAA,IAAAA,EAA0I,KAA1IA,qBAAAA;;AACAA,IAAAA,eAAe,CAAfA,OAAAA,CAAAA,EAAAA,CAA2B,KAA3BA,iBAAAA,EAAmD,CAAC,GAAGO,MAAM,CAAV,YAAA,EAAyBE,SAAS,CAATA,OAAAA,CAAzB,IAAA,EAAnDT,gBAAmD,CAAnDA,EAAAA,IAAAA,EAA6H,KAA7HA,qBAAAA;;AACAA,IAAAA,eAAe,CAAfA,OAAAA,CAAAA,EAAAA,CAA2B,KAAA,qBAAA,CAA3BA,OAA2B,EAA3BA,EAAiE,CAAC,GAAGO,MAAM,CAAV,YAAA,EAAyBE,SAAS,CAATA,OAAAA,CAAzB,EAAA,EAAjET,gBAAiE,CAAjEA,EAAAA,IAAAA,EAAyI,KAAzIA,mBAAAA;;AACAA,IAAAA,eAAe,CAAfA,OAAAA,CAAAA,EAAAA,CAA2BF,aAAa,CAAbA,OAAAA,CAA3BE,WAA2BF,EAA3BE,EAAgE,CAAC,GAAGO,MAAM,CAAV,YAAA,EAAyBE,SAAS,CAATA,OAAAA,CAAzB,EAAA,EAAhET,gBAAgE,CAAhEA,EAAAA,IAAAA,EAAwI,KAAxIA,mBAAAA;AApLwE,GAAA;AAsL5E0K,EAAAA,2BAA2B,EAAE,SAAA,2BAAA,CAAA,IAAA,EAAe;AACxC,QAAA,MAAA;AACA,QAAIC,UAAU,GAAd,KAAA;AACA,QAAA,aAAA;AACA,QAAIC,YAAY,GAAG,KAAnB,aAAA;AACA,QAAInF,iBAAiB,GAAG,KAAxB,kBAAA;AACA,QAAIoF,cAAc,GAAGpF,iBAAiB,CAAtC,iBAAqBA,EAArB;;AACA,QAAIwD,qBAAqB,GAAG,KAAA,qBAAA,CAA5B,KAA4B,EAA5B;;AACA,QAAI6B,YAAY,GAAG,KAAA,SAAA,CAAnB,YAAmB,EAAnB;;AACA,QAAItC,gBAAgB,GAAGP,wBAAwB,CAA/C,IAA+C,CAA/C;AACA,QAAI8C,uBAAuB,GAAGvC,gBAAgB,IAAI,KAAA,MAAA,CAApBA,yBAAoB,CAApBA,IAA8D,CAAC,KAAA,MAAA,CAA7F,iBAA6F,CAA7F;AACA,QAAA,MAAA;AACA,QAAA,QAAA;AACA,QAAA,UAAA;AACA,QAAA,SAAA;;AAEA,aAAA,cAAA,CAAA,KAAA,EAA+B;AAC3B,aAAOpI,MAAM,CAANA,OAAAA,CAAAA,QAAAA,CAAAA,KAAAA,KAAkC,QAAQoD,KAAK,CAALA,KAAAA,CAAY,CAA7D,CAAiDA,CAAjD;AACH;;AAED,aAAA,cAAA,CAAA,MAAA,EAAA,WAAA,EAAA,YAAA,EAAA,uBAAA,EAAoF;AAChF,UAAA,MAAA,EAAY;AACR,YAAIwH,cAAc,GAAGC,MAAM,CAA3B,KAAA;;AACA,YAAA,cAAA,EAAoB;AAChBF,UAAAA,uBAAuB,GAAGG,cAAc,CAAxCH,cAAwC,CAAxCA;AACH;;AACD,YAAA,uBAAA,EAA6B;AACzBE,UAAAA,MAAM,IAAIxF,iBAAiB,CAAjBA,YAAAA,CAA+BwF,MAAM,CAArCxF,KAAAA,EAAAA,cAAAA,EAAVwF,WAAUxF,CAAVwF;AACAA,UAAAA,MAAM,IAAIxF,iBAAiB,CAAjBA,YAAAA,CAA+BwF,MAAM,CAArCxF,KAAAA,EAAAA,OAAAA,EAAsD,CAAC0F,WAAW,GAAXA,YAAAA,GAAD,GAAA,EAAA,OAAA,CAAA,CAAA,IAAhEF,GAAUxF,CAAVwF;AAFJ,SAAA,MAGO;AACHA,UAAAA,MAAM,IAAIxF,iBAAiB,CAAjBA,YAAAA,CAA+BwF,MAAM,CAArCxF,KAAAA,EAAAA,cAAAA,EAAVwF,IAAUxF,CAAVwF;AACAA,UAAAA,MAAM,IAAIxF,iBAAiB,CAAjBA,YAAAA,CAA+BwF,MAAM,CAArCxF,KAAAA,EAAAA,OAAAA,EAAVwF,WAAUxF,CAAVwF;AACH;AACJ;AACJ;;AAED,aAAA,mBAAA,CAAA,YAAA,EAAA,cAAA,EAA2D;AACvD,UAAIG,mBAAmB,GAAG,cAAc,CAAd,KAAA,CAAqB,UAAA,MAAA,EAAiB;AAC5D,eAAOH,MAAM,CAAb,KAAA;AADJ,OAA0B,CAA1B;AAGA,UAAA,YAAA;;AACA,UAAA,mBAAA,EAAyB;AACrBI,QAAAA,YAAY,GAAG,cAAc,CAAd,MAAA,CAAsB,UAAA,GAAA,EAAA,MAAA,EAAsB;AACvD,cAAIH,cAAc,CAACD,MAAM,CAAzB,KAAkB,CAAlB,EAAkC;AAC9BK,YAAAA,GAAG,IAAIC,UAAU,CAACN,MAAM,CAAxBK,KAAiB,CAAjBA;AACH;;AACD,iBAAA,GAAA;AAJW,SAAA,EAAfD,CAAe,CAAfA;;AAMA,YAAIA,YAAY,GAAhB,GAAA,EAAwB;AACpBP,UAAAA,YAAY,GAAGA,YAAY,GAAZA,YAAAA,GAAfA,GAAAA;AACH;AACJ;;AACD,aAAA,YAAA;AACH;;AACD5B,IAAAA,MAAM,GAAGsC,IAAI,GAAGZ,YAAY,CAA5B1B,SAAAA;;AACA,QAAIV,gBAAgB,IAAI,KAAA,MAAA,CAAxB,YAAwB,CAAxB,EAAmD;AAC/CU,MAAAA,MAAM,GAAG,CAATA,MAAAA;AACH;;AACDuC,IAAAA,SAAS,GAAGb,YAAY,CAAZA,kBAAAA,GAAZa,MAAAA;AACAR,IAAAA,MAAM,GAAGJ,cAAc,CAACD,YAAY,CAApCK,kBAAuB,CAAvBA;AACAS,IAAAA,QAAQ,GAAGT,MAAM,IAAIA,MAAM,CAAhBA,QAAAA,IAAXS,qBAAAA;AACAf,IAAAA,UAAU,GAAGc,SAAS,IAAtBd,QAAAA;;AACA,QAAA,gBAAA,EAAsB;AAClBgB,MAAAA,aAAa,GAAGf,YAAY,CAAZA,eAAAA,GAAhBe,MAAAA;AACA9C,MAAAA,UAAU,GAAGgC,cAAc,CAACD,YAAY,CAAxC/B,eAA2B,CAA3BA;AACA6C,MAAAA,QAAQ,GAAG7C,UAAU,IAAIA,UAAU,CAAxBA,QAAAA,IAAX6C,qBAAAA;AACAf,MAAAA,UAAU,GAAGA,UAAU,IAAIgB,aAAa,IAAxChB,QAAAA;AACH;;AACD,QAAA,UAAA,EAAgB;AACZlF,MAAAA,iBAAiB,CAAjBA,WAAAA;AACAgG,MAAAA,SAAS,GAAG7E,IAAI,CAAJA,KAAAA,CAAZ6E,SAAY7E,CAAZ6E;AACAX,MAAAA,YAAY,GAAGc,mBAAmB,CAAA,YAAA,EAAlCd,cAAkC,CAAlCA;AACAe,MAAAA,cAAc,CAAA,MAAA,EAAA,SAAA,EAAA,YAAA,EAAdA,uBAAc,CAAdA;;AACA,UAAA,gBAAA,EAAsB;AAClBF,QAAAA,aAAa,GAAG/E,IAAI,CAAJA,KAAAA,CAAhB+E,aAAgB/E,CAAhB+E;AACAE,QAAAA,cAAc,CAAA,UAAA,EAAA,aAAA,EAAA,YAAA,EAAdA,uBAAc,CAAdA;AAFJ,OAAA,MAGO;AACH,YAAIC,YAAY,GAAG,KAAA,kBAAA,CAAnB,eAAmB,EAAnB;;AACAA,QAAAA,YAAY,CAAClB,YAAY,CAAzBkB,kBAAY,CAAZA,GAAAA,SAAAA;;AACA,YAAIC,SAAS,GAAG,YAAY,CAAZ,MAAA,CAAoB,UAAA,UAAA,EAAA,KAAA,EAA4B;AAC5D,iBAAOC,UAAU,GAAjB,KAAA;AADY,SAAA,EAAA,CAAA,IAER,KAAA,SAAA,CAFR,YAEQ,EAFR;;AAGA,YAAI,CAAJ,SAAA,EAAgB;AACZ,cAAIC,eAAe,GAAGlL,aAAa,CAAbA,OAAAA,CAAAA,2BAAAA,CAAtB,cAAsBA,CAAtB;;AACA,cAAIkL,eAAe,IAAnB,CAAA,EAA0B;AACtBxG,YAAAA,iBAAiB,CAAjBA,YAAAA,CAA+BoF,cAAc,CAAdA,eAAc,CAAdA,CAA/BpF,KAAAA,EAAAA,cAAAA,EAAAA,MAAAA;AACH;AACJ;;AACD,aAAK,IAAIqC,CAAC,GAAV,CAAA,EAAgBA,CAAC,GAAGgE,YAAY,CAAhC,MAAA,EAAyChE,CAAzC,EAAA,EAA8C;AAC1C,cAAI+C,cAAc,CAAdA,CAAc,CAAdA,IAAqBA,cAAc,CAAdA,CAAc,CAAdA,KAArBA,MAAAA,IAAqD,KAAA,CAAA,KAAWA,cAAc,CAAdA,CAAc,CAAdA,CAApE,KAAA,EAA6F;AACzFpF,YAAAA,iBAAiB,CAAjBA,YAAAA,CAA+BoF,cAAc,CAAdA,CAAc,CAAdA,CAA/BpF,KAAAA,EAAAA,OAAAA,EAAiEqG,YAAY,CAA7ErG,CAA6E,CAA7EA;AACH;AACJ;AACJ;;AACDA,MAAAA,iBAAiB,CAAjBA,SAAAA;AACH;;AACD,WAAA,UAAA;AAtRwE,GAAA;AAwR5EhD,EAAAA,oBAAoB,EAAE,SAAA,oBAAA,CAAA,QAAA,EAAA,OAAA,EAA4B;AAC9CyJ,IAAAA,QAAQ,CAARA,GAAAA,CAAAA,OAAAA;;AACA,SAAA,sBAAA,CAAA,IAAA,CAAiC;AAC7BA,MAAAA,QAAQ,EADqB,QAAA;AAE7BC,MAAAA,OAAO,EAAEA;AAFoB,KAAjC;AA1RwE,GAAA;AA+R5EC,EAAAA,yBAAyB,EAAE,SAAA,yBAAA,GAAW;AAClC,QAAA,CAAA;AACA,QAAA,SAAA;;AACA,SAAKtE,CAAC,GAAN,CAAA,EAAYA,CAAC,GAAG,KAAA,sBAAA,CAAhB,MAAA,EAAoDA,CAApD,EAAA,EAAyD;AACrDuE,MAAAA,SAAS,GAAG,KAAA,sBAAA,CAAZA,CAAY,CAAZA;AACAA,MAAAA,SAAS,CAATA,QAAAA,CAAAA,MAAAA,CAA0BA,SAAS,CAAnCA,OAAAA;AACH;;AACD,SAAA,sBAAA,GAAA,EAAA;AAtSwE,GAAA;AAwS5EC,EAAAA,aAAa,EAAE,SAAA,aAAA,GAAW;AACtB,SAAA,sBAAA;;AACA,SAAA,yBAAA;AA1SwE,GAAA;AA4S5E5I,EAAAA,KAAK,EAAE,SAAA,KAAA,GAAW;AACd,QAAItB,IAAI,GAAR,IAAA;;AACA,QAAImK,8BAA8B,GAAG,SAAjCA,8BAAiC,GAAW;AAC5C,UAAI,CAACnK,IAAI,CAAT,WAAA,EAAuB;AACnBA,QAAAA,IAAI,CAAJA,eAAAA,CAAAA,IAAAA;AACH;AAHL,KAAA;;AAKA,QAAIoK,oCAAoC,GAAG,SAAvCA,oCAAuC,CAAA,MAAA,EAAiB;AACxD,UAAIpK,IAAI,CAAJA,WAAAA,KAAqBqK,MAAM,CAA/B,IAAA,EAAsC;AAClCrK,QAAAA,IAAI,CAAJA,WAAAA,GAAmBqK,MAAM,CAAzBrK,IAAAA;AACAA,QAAAA,IAAI,CAAJA,eAAAA,CAAAA,IAAAA;AACH;AAJL,KAAA;;AAMAA,IAAAA,IAAI,CAAJA,qBAAAA,GAA6BA,IAAI,CAAJA,OAAAA,CAA7BA,sBAA6BA,CAA7BA;AACAA,IAAAA,IAAI,CAAJA,kBAAAA,GAA0BA,IAAI,CAAJA,OAAAA,CAA1BA,mBAA0BA,CAA1BA;AACAA,IAAAA,IAAI,CAAJA,YAAAA,GAAoBA,IAAI,CAAJA,OAAAA,CAApBA,aAAoBA,CAApBA;AACAA,IAAAA,IAAI,CAAJA,SAAAA,GAAiBA,IAAI,CAAJA,OAAAA,CAAjBA,UAAiBA,CAAjBA;AACAA,IAAAA,IAAI,CAAJA,kBAAAA,GAA0BA,IAAI,CAAJA,aAAAA,CAA1BA,SAA0BA,CAA1BA;AACAA,IAAAA,IAAI,CAAJA,wBAAAA,GAAgCA,IAAI,CAAJA,aAAAA,CAAhCA,eAAgCA,CAAhCA;AACAA,IAAAA,IAAI,CAAJA,iBAAAA,GAAyBA,IAAI,CAAJA,qBAAAA,CAAAA,SAAAA,CAAzBA,QAAyBA,EAAzBA;;AACAA,IAAAA,IAAI,CAAJA,oBAAAA,CAA0BA,IAAI,CAAJA,kBAAAA,CAA1BA,eAAAA,EAAAA,8BAAAA;;AACAA,IAAAA,IAAI,CAAJA,oBAAAA,CAA0BA,IAAI,CAAJA,kBAAAA,CAA1BA,eAAAA,EAAAA,8BAAAA;;AACAA,IAAAA,IAAI,CAAJA,oBAAAA,CAA0BA,IAAI,CAAJA,qBAAAA,CAA1BA,eAAAA,EAAsE,YAAW;AAC7EA,MAAAA,IAAI,CAAJA,sBAAAA;;AACAA,MAAAA,IAAI,CAAJA,kBAAAA;AAFJA,KAAAA;;AAIAA,IAAAA,IAAI,CAAJA,oBAAAA,CAA0BA,IAAI,CAAJA,SAAAA,CAA1BA,eAAAA,EAA0D,YAAW;AACjEA,MAAAA,IAAI,CAAJA,SAAAA,CAAAA,aAAAA,CAAAA,MAAAA,CAAAA,oCAAAA;;AACAA,MAAAA,IAAI,CAAJA,SAAAA,CAAAA,aAAAA,CAAAA,GAAAA,CAAAA,oCAAAA;AAFJA,KAAAA;;AAIA,QAAIsK,2BAA2B,GAAG,MAAMtK,IAAI,CAAJA,SAAAA,CAAxC,iBAAwCA,EAAxC;;AACA,QAAIuK,mBAAmB,GAAvB,CAAA;;AACAvK,IAAAA,IAAI,CAAJA,oBAAAA,CAA0BA,IAAI,CAAJA,aAAAA,CAAAA,eAAAA,EAA1BA,eAAAA,EAA+E,UAAA,CAAA,EAAY;AACvF,UAAIA,IAAI,CAAJA,WAAAA,IAAoB,CAACA,IAAI,CAAJA,SAAAA,CAAzB,UAAA,EAAoD;AAChD,YAAIwK,mBAAmB,GAAG,MAAMxK,IAAI,CAAJA,SAAAA,CAAhC,iBAAgCA,EAAhC;;AACA,YAAIsK,2BAA2B,KAA3BA,mBAAAA,IAAuDC,mBAAmB,IAAIA,mBAAmB,KAAKpG,CAAC,CAA3G,MAAA,EAAoH;AAChHmG,UAAAA,2BAA2B,GAA3BA,mBAAAA;AACAC,UAAAA,mBAAmB,GAAGpG,CAAC,CAAvBoG,MAAAA;AACAvK,UAAAA,IAAI,CAAJA,SAAAA,CAAAA,gBAAAA;AAHJ,SAAA,MAIO;AACHA,UAAAA,IAAI,CAAJA,SAAAA,CAAAA,wBAAAA;AACH;AACJ;;AACDuK,MAAAA,mBAAmB,GAAGpG,CAAC,CAAvBoG,MAAAA;AAXJvK,KAAAA;AA5UwE,GAAA;AA0V5ES,EAAAA,aAAa,EAAE,SAAA,aAAA,CAAA,IAAA,EAAe;AAC1B,SAAA,QAAA,CAAA,IAAA;;AACA,QAAI,0BAA0BC,IAAI,CAAlC,IAAA,EAAyC;AACrC,UAAIA,IAAI,CAAR,KAAA,EAAgB;AACZ,aAAA,KAAA;;AACA,aAAA,kBAAA;AAFJ,OAAA,MAGO;AACH,aAAA,aAAA;AACH;AACJ;AAnWuE,GAAA;AAqW5E2D,EAAAA,UAAU,EAAE,SAAA,UAAA,GAAW;AACnB,WAAO,KAAP,WAAA;AAtWwE,GAAA;AAwW5E1D,EAAAA,IAAI,EAAE,SAAA,IAAA,GAAW;AACb,SAAA,sBAAA,GAAA,EAAA;;AACA,QAAIZ,aAAa,CAAjB,IAAiB,CAAjB,EAAyB;AACrB,WAAA,KAAA;AACH;AA5WuE,GAAA;AA8W5EwF,EAAAA,eAAe,EAAE,SAAA,eAAA,CAAA,KAAA,EAAgB;AAC7B,QAAI,KAAA,CAAA,KAAJ,KAAA,EAAsB;AAClB,WAAA,gBAAA,GAAA,KAAA;AADJ,KAAA,MAEO;AACH,UAAI,CAAC,KAAL,gBAAA,EAA4B;AACxB,aAAA,wBAAA;AACH;;AACD,aAAO,KAAP,gBAAA;AACH;AAtXuE,GAAA;AAwX5EvE,EAAAA,OAAO,EAAE,SAAA,OAAA,GAAW;AAChB,SAAA,aAAA;;AACA,SAAA,QAAA;AACH;AA3X2E,CAA7C,CAAnC;;AA6XA,IAAIyJ,2BAA2B,GAAG,aAAa,CAAb,OAAA,CAAA,cAAA,CAAA,OAAA,CAA6C;AAC3EC,EAAAA,MAAM,EAAE,SAAA,MAAA,CAAA,GAAA,EAAc;AAClB,QAAI1K,IAAI,GAAR,IAAA;AACA,QAAIgD,MAAM,GAAV,EAAA;;AACA,QAAI1C,QAAQ,GAAGN,IAAI,CAAJA,kBAAAA,CAAf,OAAeA,EAAf;;AACA,QAAIqK,MAAM,GAAG/J,QAAQ,IAAIA,QAAQ,CAAjC,MAAyBA,EAAzB;AACA,QAAI0F,SAAS,GAAGqE,MAAM,IAAIA,MAAM,CAAhBA,GAAAA,IAAhB,CAAA;AACA,QAAIM,aAAa,GAAG3M,MAAM,CAANA,OAAAA,CAAAA,SAAAA,CAAAA,GAAAA,IAAgCwG,IAAI,CAAJA,GAAAA,CAASjE,GAAG,GAA5CvC,SAAgCwG,CAAhCxG,GAApB,CAAA;AACA,QAAI4M,oBAAoB,GAAG5K,IAAI,CAAJA,kBAAAA,GAA0BA,IAAI,CAAJA,kBAAAA,CAA1BA,SAA0BA,EAA1BA,GAA3B,CAAA;;AACA,QAAI6K,cAAc,GAAG7K,IAAI,CAAJA,SAAAA,CAAAA,iBAAAA,CAArB,IAAqBA,CAArB;;AACA,QAAI8K,UAAU,GAAG9K,IAAI,CAAJA,SAAAA,GAAiBA,IAAI,CAAJA,SAAAA,CAAAA,MAAAA,KAAjBA,cAAAA,GAAjB,CAAA;AACA,QAAI+K,wBAAwB,GAAG/K,IAAI,CAAJA,SAAAA,CAAAA,aAAAA,CAA/B,gBAA+BA,CAA/B;AACAgD,IAAAA,MAAM,CAANA,MAAAA,GAAAA,oBAAAA;;AACA,QAAI,UAAU+H,wBAAwB,CAAtC,UAAcA,EAAd,EAAqD;AACjD/H,MAAAA,MAAM,CAANA,MAAAA,IAAiB8H,UAAU,GAA3B9H,aAAAA;AACH;;AACD,QAAI,SAAA,GAAA,IAAA,QAAA,IAA4B1C,QAAQ,CAAxC,MAAA,EAAiD;AAC7C0C,MAAAA,MAAM,CAANA,GAAAA,GAAa1C,QAAQ,CAARA,CAAQ,CAARA,CAAAA,SAAAA,GAAb0C,aAAAA;AACH;;AACDhD,IAAAA,IAAI,CAAJA,eAAAA,CAAAA,IAAAA,CAAAA,MAAAA;AAnBuE,GAAA;AAqB3EW,EAAAA,IAAI,EAAE,SAAA,IAAA,GAAW;AACb,QAAIX,IAAI,GAAR,IAAA;AACAA,IAAAA,IAAI,CAAJA,QAAAA;AACAA,IAAAA,IAAI,CAAJA,kBAAAA,GAA0B,KAAA,OAAA,CAA1BA,mBAA0B,CAA1BA;AACAA,IAAAA,IAAI,CAAJA,SAAAA,GAAiB,KAAA,OAAA,CAAjBA,UAAiB,CAAjBA;AACAA,IAAAA,IAAI,CAAJA,UAAAA,GAAkB,KAAA,OAAA,CAAlBA,WAAkB,CAAlBA;;AACAA,IAAAA,IAAI,CAAJA,SAAAA,CAAAA,eAAAA,CAAAA,GAAAA,CAAmC,YAAW;AAC1C,UAAIA,IAAI,CAAJA,MAAAA,CAAJ,qBAAIA,CAAJ,EAAwC;AACpCA,QAAAA,IAAI,CAAJA,MAAAA,CAAAA,IAAAA;AACH;AAHLA,KAAAA;AA3BuE,GAAA;AAiC3EgL,EAAAA,IAAI,EAAE,SAAA,IAAA,CAAA,SAAA,EAAoB;AACtB,SAAA,QAAA,CAAA,SAAA;AACA,SAAA,eAAA,GAAuB,CAAC,GAAGlN,WAAW,CAAtC,OAAuB,GAAvB;AACH;AApC0E,CAA7C,CAAlC;;AAsCA,IAAImN,4BAA4B,GAAG,aAAa,CAAb,OAAA,CAAA,cAAA,CAAA,OAAA,CAA6C;AAC5E/C,EAAAA,wBAAwB,EAAE,SAAA,wBAAA,CAAA,OAAA,EAAkB;AACxC,QAAIlI,IAAI,GAAR,IAAA;AACA,WAAO,aAAa,CAAb,OAAA,CAAA,kBAAA,CAAyCyD,OAAO,CAAhD,cAAA,EAAiE,UAAA,KAAA,EAAgB;AACpF,aAAOzD,IAAI,CAAJA,aAAAA,CAAAA,KAAAA,EAA0ByD,OAAO,CAAjCzD,OAAAA,EAA2CyD,OAAO,CAAPA,mBAAAA,CAA3CzD,OAA2CyD,EAA3CzD,EAAkFyD,OAAO,CAAhG,YAAOzD,CAAP;AADG,KAAA,EAEJyD,OAAO,CAFH,qBAAA,EAE2BA,OAAO,CAFzC,gBAAO,CAAP;AAHwE,GAAA;AAO5E0C,EAAAA,aAAa,EAAE,SAAA,aAAA,CAAA,KAAA,EAAA,OAAA,EAAA,QAAA,EAAA,YAAA,EAAiD;AAC5D,QAAI+E,YAAY,GAAG1F,OAAO,CAACc,KAAK,CAAhC,WAA0B,CAA1B;AACA,QAAI6E,UAAU,GAAG3F,OAAO,CAACc,KAAK,CAALA,WAAAA,GAAzB,CAAwB,CAAxB;;AACA,YAAA,QAAA;AACI,WAAA,eAAA;AACI,eAAA,IAAA;;AACJ,WAAA,SAAA;AACI,eAAOlB,YAAY,IAAI,CAACA,YAAY,CAA7BA,eAAAA,IAAiD,CAAC,CAAA,YAAA,IAAiB,CAAC8F,YAAY,CAA/B,eAAA,MAAqD,CAAA,UAAA,IAAe,CAACC,UAAU,CAAvI,eAAwD,CAAxD;;AACJ;AACI,eAAO,MAAM3F,OAAO,CAApB,MAAA;AANR;AAVwE,GAAA;AAmB5E6C,EAAAA,kBAAkB,EAAE,SAAA,kBAAA,CAAA,cAAA,EAAA,cAAA,EAAyC;AACzD,QAAIrI,IAAI,GAAR,IAAA;AACA,KAAC,GAAG/B,SAAS,CAAb,IAAA,EAAA,cAAA,EAAoC,UAAA,CAAA,EAAA,aAAA,EAA2B;AAC3D,UAAA,aAAA,EAAmB;AACf,YAAA,CAAA;AACA,YAAA,OAAA;AACA,YAAA,cAAA;AACA,YAAImN,QAAQ,GAAGxI,aAAa,CAAbA,WAAAA,GAA4BA,aAAa,CAAzCA,WAA4BA,EAA5BA,GAAf,CAAA;AACA,YAAIyI,iBAAiB,GAAGzI,aAAa,CAArC,OAAwBA,EAAxB;;AACA,YAAI0I,iBAAiB,GAAG,SAApBA,iBAAoB,CAAA,KAAA,EAAA,aAAA,EAA+B;AACnD,cAAI,CAAJ,aAAA,EAAoB;AAChB;AACH;;AACD,cAAIC,cAAc,GAAG,CAAC,GAAGhO,UAAU,CAAd,OAAA,EAArB,aAAqB,CAArB;AACA,cAAIsL,MAAM,GAAGrD,OAAO,CAApB,KAAoB,CAApB;;AACA,cAAI5C,aAAa,CAAbA,aAAAA,CAAAA,MAAAA,EAAAA,iBAAAA,EAAJ,cAAIA,CAAJ,EAA4E;AACxE2I,YAAAA,cAAc,CAAdA,QAAAA,CAAwBvL,IAAI,CAAJA,eAAAA,CAAxBuL,yBAAwBvL,CAAxBuL;;AACA3N,YAAAA,eAAe,CAAfA,OAAAA,CAAAA,EAAAA,CAAAA,cAAAA,EAA2C,CAAC,GAAGO,MAAM,CAAV,YAAA,EAAyBI,MAAM,CAANA,OAAAA,CAAzB,KAAA,EAA3CX,gBAA2C,CAA3CA,EAA6G,IAAI,CAAJ,YAAA,CAAkB,UAAA,IAAA,EAAe;AAC1I,kBAAIuG,CAAC,GAAGzD,IAAI,CAAZ,KAAA;AACA,kBAAI0D,SAAS,GAAG,CAAC,GAAGjG,MAAM,CAAV,SAAA,EAAhB,CAAgB,CAAhB;AACAqN,cAAAA,cAAc,CAAdA,UAAAA,CAA0B;AACtB1E,gBAAAA,MAAM,EAAE1C,SAAS,CAATA,CAAAA,GAAc,CAAC,GAAG7G,UAAU,CAAd,OAAA,EAAwB4G,CAAC,CAAzB,aAAA,EAAA,MAAA,GADA,IAAA;AAEtBsH,gBAAAA,MAAM,EAAErH,SAAS,CAATA,CAAAA,GAAc,CAAC,GAAG7G,UAAU,CAAd,OAAA,EAAwB4G,CAAC,CAAzB,aAAA,EAAA,MAAA,GAFA,GAAA;AAGtBiB,gBAAAA,YAAY,EAHU,MAAA;AAItBsG,gBAAAA,KAAK,EAAE7C,MAAM,CAJS,KAAA;AAKtB3F,gBAAAA,WAAW,EALW,KAAA;AAMtBM,gBAAAA,aAAa,EANS,cAAA;AAOtBM,gBAAAA,cAAc,EAPQ,iBAAA;AAQtB6H,gBAAAA,cAAc,EARQ,cAAA;AAStBxI,gBAAAA,QAAQ,EAAEnD,IAAI,CAAJA,kBAAAA,CAAAA,WAAAA,CAAoC6I,MAAM,CAA1C7I,KAAAA,EAAAA,IAAAA;AATY,eAA1BwL;AAHJ5N,aAA6G,CAA7GA;;AAeAA,YAAAA,eAAe,CAAfA,OAAAA,CAAAA,EAAAA,CAAAA,cAAAA,EAA2C,CAAC,GAAGO,MAAM,CAAV,YAAA,EAAyBI,MAAM,CAANA,OAAAA,CAAzB,IAAA,EAA3CX,gBAA2C,CAA3CA,EAA4G;AACxGoC,cAAAA,IAAI,EAAEwL;AADkG,aAA5G5N,EAEGoC,IAAI,CAAJA,YAAAA,CAAkBwL,cAAc,CAFnC5N,UAEGoC,CAFHpC;;AAGAA,YAAAA,eAAe,CAAfA,OAAAA,CAAAA,EAAAA,CAAAA,cAAAA,EAA2C,CAAC,GAAGO,MAAM,CAAV,YAAA,EAAyBI,MAAM,CAANA,OAAAA,CAAzB,GAAA,EAA3CX,gBAA2C,CAA3CA,EAA2G;AACvGoC,cAAAA,IAAI,EAAEwL;AADiG,aAA3G5N,EAEGoC,IAAI,CAAJA,YAAAA,CAAkBwL,cAAc,CAFnC5N,UAEGoC,CAFHpC;AAGH;AA7BL,SAAA;;AA+BA,aAAK8H,CAAC,GAAN,CAAA,EAAYA,CAAC,GAAb,QAAA,EAA0BA,CAA1B,EAAA,EAA+B;AAC3BL,UAAAA,cAAc,GAAGzC,aAAa,CAAbA,iBAAAA,CAAAA,CAAAA,KAAjByC,EAAAA;;AACA,cAAIA,cAAc,CAAlB,MAAA,EAA2B;AACvBG,YAAAA,OAAO,GAAG5C,aAAa,CAAbA,UAAAA,CAAAA,CAAAA,KAAV4C,EAAAA;AACA,aAAC,GAAGvH,SAAS,CAAb,IAAA,EAAA,cAAA,EAAA,iBAAA;AACH;AACJ;AACJ;AA7CL,KAAA;AArBwE,GAAA;AAqE5EmK,EAAAA,sBAAsB,EAAE,SAAA,sBAAA,CAAA,cAAA,EAAA,cAAA,EAAyC;AAC7D,QAAIpI,IAAI,GAAR,IAAA;AACA,KAAC,GAAG/B,SAAS,CAAb,IAAA,EAAA,cAAA,EAAoC,UAAA,CAAA,EAAA,aAAA,EAA2B;AAC3D,UAAA,aAAA,EAAmB;AACf,YAAIoH,cAAc,GAAGzC,aAAa,CAAbA,iBAAAA,MAArB,EAAA;AACA,SAAC,GAAG3E,SAAS,CAAb,IAAA,EAAA,cAAA,EAAoC,UAAA,KAAA,EAAA,aAAA,EAA+B;AAC/D,cAAIsN,cAAc,GAAG,CAAC,GAAGhO,UAAU,CAAd,OAAA,EAArB,aAAqB,CAArB;;AACAK,UAAAA,eAAe,CAAfA,OAAAA,CAAAA,GAAAA,CAAAA,cAAAA,EAA4C,CAAC,GAAGO,MAAM,CAAV,YAAA,EAAyBI,MAAM,CAANA,OAAAA,CAAzB,KAAA,EAA5CX,gBAA4C,CAA5CA;;AACAA,UAAAA,eAAe,CAAfA,OAAAA,CAAAA,GAAAA,CAAAA,cAAAA,EAA4C,CAAC,GAAGO,MAAM,CAAV,YAAA,EAAyBI,MAAM,CAANA,OAAAA,CAAzB,IAAA,EAA5CX,gBAA4C,CAA5CA;;AACAA,UAAAA,eAAe,CAAfA,OAAAA,CAAAA,GAAAA,CAAAA,cAAAA,EAA4C,CAAC,GAAGO,MAAM,CAAV,YAAA,EAAyBI,MAAM,CAANA,OAAAA,CAAzB,GAAA,EAA5CX,gBAA4C,CAA5CA;;AACA2N,UAAAA,cAAc,CAAdA,WAAAA,CAA2BvL,IAAI,CAAJA,eAAAA,CAA3BuL,yBAA2BvL,CAA3BuL;AALJ,SAAA;AAOH;AAVL,KAAA;AAvEwE,GAAA;AAoF5EK,EAAAA,aAAa,EAAE,SAAA,aAAA,CAAA,cAAA,EAAyB;AACpC,WAAO,cAAA,cAAA,GAA+B,KAA/B,qBAAA,GAA4D,KAAnE,mBAAA;AArFwE,GAAA;AAuF5EC,EAAAA,cAAc,EAAE,SAAA,cAAA,CAAA,IAAA,EAAe;AAC3B,QAAIC,cAAc,GAAG,KAArB,mBAAA;AACA,QAAIC,gBAAgB,GAAG,KAAvB,qBAAA;AACA,SAAA,qBAAA,GAAA,IAAA;AACAD,IAAAA,cAAc,IAAIA,cAAc,CAAhCA,IAAkBA,EAAlBA;AACA,gBAAA,IAAA,IAAA,gBAAA,IAAwCC,gBAAgB,CAAxD,IAAwCA,EAAxC;AA5FwE,GAAA;AA8F5EpL,EAAAA,IAAI,EAAE,SAAA,IAAA,GAAW;AACb,QAAIX,IAAI,GAAR,IAAA;AACA,QAAA,iBAAA;AACAA,IAAAA,IAAI,CAAJA,QAAAA;AACAA,IAAAA,IAAI,CAAJA,kBAAAA,GAA0BA,IAAI,CAAJA,aAAAA,CAA1BA,SAA0BA,CAA1BA;AACAA,IAAAA,IAAI,CAAJA,kBAAAA,GAA0BA,IAAI,CAAJA,OAAAA,CAA1BA,mBAA0BA,CAA1BA;AACAA,IAAAA,IAAI,CAAJA,qBAAAA,GAA6BA,IAAI,CAAJA,OAAAA,CAA7BA,sBAA6BA,CAA7BA;AACAA,IAAAA,IAAI,CAAJA,mBAAAA,GAA2BA,IAAI,CAAJA,OAAAA,CAA3BA,oBAA2BA,CAA3BA;AACAA,IAAAA,IAAI,CAAJA,SAAAA,GAAiBA,IAAI,CAAJA,OAAAA,CAAjBA,UAAiBA,CAAjBA;AACAA,IAAAA,IAAI,CAAJA,mBAAAA,GAA2BA,IAAI,CAAJA,OAAAA,CAA3BA,oBAA2BA,CAA3BA;AACAA,IAAAA,IAAI,CAAJA,gBAAAA,GAAwBA,IAAI,CAAJA,OAAAA,CAAxBA,aAAwBA,CAAxBA;AACAA,IAAAA,IAAI,CAAJA,kBAAAA,GAA0BA,IAAI,CAAJA,OAAAA,CAA1BA,mBAA0BA,CAA1BA;;AACAsL,IAAAA,iBAAiB,GAAG,SAAA,iBAAA,GAAW;AAC3B,UAAItL,IAAI,CAAR,mBAAA,EAA8B;AAC1B,YAAI2L,cAAc,GAAG,CAAC3L,IAAI,CAAL,kBAAA,EAA0BA,IAAI,CAA9B,kBAAA,EAAmDA,IAAI,CAA5E,gBAAqB,CAArB;;AACAA,QAAAA,IAAI,CAAJA,sBAAAA,CAA4BA,IAAI,CAAhCA,mBAAAA,EAAAA,cAAAA;;AACAA,QAAAA,IAAI,CAAJA,kBAAAA,CAAwBA,IAAI,CAA5BA,mBAAAA,EAAAA,cAAAA;AACH;AALLsL,KAAAA;;AAOAtL,IAAAA,IAAI,CAAJA,kBAAAA,CAAAA,eAAAA,CAAAA,GAAAA,CAAAA,iBAAAA;;AACAA,IAAAA,IAAI,CAAJA,gBAAAA,IAAyBA,IAAI,CAAJA,gBAAAA,CAAAA,eAAAA,CAAAA,GAAAA,CAAzBA,iBAAyBA,CAAzBA;AACAA,IAAAA,IAAI,CAAJA,kBAAAA,IAA2BA,IAAI,CAAJA,kBAAAA,CAAAA,eAAAA,CAAAA,GAAAA,CAA3BA,iBAA2BA,CAA3BA;AAnHwE,GAAA;AAqH5EgM,EAAAA,SAAS,EAAE,SAAA,SAAA,CAAA,UAAA,EAAqB;AAC5B,WAAO,KAAA,kBAAA,CAAA,eAAA,CAAwCC,UAAU,CAAlD,iBAAA,EAAsEA,UAAU,CAAhF,iBAAA,EAAoGA,UAAU,CAA9G,cAAA,EAA+HA,UAAU,CAAhJ,cAAO,CAAP;AAtHwE,GAAA;AAwH5EC,EAAAA,IAAI,EAAE,SAAA,IAAA,CAAA,UAAA,EAAqB;AACvB,QAAIvI,WAAW,GAAGsI,UAAU,CAA5B,WAAA;AACA,QAAInI,cAAc,GAAGmI,UAAU,CAA/B,cAAA;AACA,QAAIpI,mBAAmB,GAAGoI,UAAU,CAApC,mBAAA;AACA,QAAIE,WAAW,GAAG,KAAlB,kBAAA;AACA,QAAIC,QAAQ,GAAG,KAAf,SAAA;;AACA,QAAA,mBAAA,EAAyB;AACrBvI,MAAAA,mBAAmB,CAAnBA,GAAAA,CAAwB;AACpBwI,QAAAA,OAAO,EAAEvM;AADW,OAAxB+D;;AAGA,UAAI,cAAJ,cAAA,EAAkC;AAC9BsI,QAAAA,WAAW,IAAIA,WAAW,CAAXA,cAAAA,CAAAA,WAAAA,EAAfA,cAAeA,CAAfA;AACAC,QAAAA,QAAQ,IAAIA,QAAQ,CAARA,cAAAA,CAAAA,WAAAA,EAAZA,cAAYA,CAAZA;AACH;AACJ;AAtIuE,GAAA;AAwI5EE,EAAAA,IAAI,EAAE,SAAA,IAAA,CAAA,UAAA,EAAqB;AACvB,QAAItM,IAAI,GAAR,IAAA;AACA,QAAIuM,iBAAiB,GAAGvO,MAAM,CAANA,OAAAA,CAAAA,QAAAA,CAAwBiO,UAAU,CAAlCjO,iBAAAA,IAAwDiO,UAAU,CAAVA,iBAAAA,CAAxDjO,WAAAA,GAAmGiO,UAAU,CAArI,iBAAA;AACA,QAAInI,cAAc,GAAGmI,UAAU,CAA/B,cAAA;AACA,QAAI9G,cAAc,GAAG8G,UAAU,CAA/B,cAAA;;AACA,QAAIO,SAAS,GAAGxM,IAAI,CAAJA,aAAAA,CAAhB,cAAgBA,CAAhB;;AACA,QAAIyM,qBAAqB,GAAGF,iBAAiB,IAA7C,CAAA;;AACA,QAAIG,aAAa,GAAG,SAAhBA,aAAgB,GAAW;AAC3B,UAAI1M,IAAI,CAAJA,qBAAAA,KAAJ,iBAAA,EAAsD;AAClDA,QAAAA,IAAI,CAAJA,cAAAA;AACAwM,QAAAA,SAAS,CAATA,OAAAA,GAAoBP,UAAU,CAAVA,MAAAA,GAAAA,aAAAA,GAApBO,cAAAA,EAAwEP,UAAU,CAAlFO,mBAAAA;AACAxM,QAAAA,IAAI,CAAJA,qBAAAA,GAAAA,iBAAAA;AACAwM,QAAAA,SAAS,CAATA,IAAAA,CAAAA,cAAAA;AACH;AANL,KAAA;;AAQAxM,IAAAA,IAAI,CAAJA,kBAAAA,CAAAA,OAAAA,GAAAA,IAAAA,CAAuC,MAAvCA,gBAAAA,EAAAA,WAAAA,CAA2EA,IAAI,CAAJA,eAAAA,CAA3EA,4BAA2EA,CAA3EA,EAA+H,cAAA,cAAA,IAAgC,cAAhC,cAAA,IAAgE,CAA/LA,qBAAAA;;AACA,QAAA,SAAA,EAAe;AACX,UAAIA,IAAI,CAAJA,SAAAA,CAAAA,UAAAA,KAAJ,qBAAA,EAAyD;AACrD,YAAI,YAAA,cAAA,IAA8B,oBAAlC,cAAA,EAAsE;AAClE0M,UAAAA,aAAa;AADjB,SAAA,MAEO;AACH1M,UAAAA,IAAI,CAAJA,cAAAA,CAAAA,OAAAA;AACAA,UAAAA,IAAI,CAAJA,aAAAA,CAAAA,eAAAA,EAAAA,MAAAA,CAA2CiM,UAAU,CAArDjM,IAAAA;AACAwM,UAAAA,SAAS,CAATA,OAAAA,CAAkBP,UAAU,CAAVA,IAAAA,GAAkBO,SAAS,CAA7CA,KAAoCA,EAApCA;AACAA,UAAAA,SAAS,CAATA,IAAAA;AACH;AARL,OAAA,MASO;AACHxM,QAAAA,IAAI,CAAJA,cAAAA;AACH;AACJ;AArKuE,GAAA;AAuK5E2M,EAAAA,IAAI,EAAE,SAAA,IAAA,CAAA,UAAA,EAAqB;AACvB,QAAI9I,mBAAmB,GAAGoI,UAAU,CAApC,mBAAA;;AACA,QAAA,mBAAA,EAAyB;AACrBpI,MAAAA,mBAAmB,CAAnBA,GAAAA,CAAwB;AACpBwI,QAAAA,OAAO,EAAE;AADW,OAAxBxI;;AAGA,WAAA,kBAAA,CAAA,cAAA,CAAuCoI,UAAU,CAAjD,WAAA,EAAA,EAAA;;AACA,WAAA,SAAA,CAAA,cAAA,CAA8BA,UAAU,CAAxC,WAAA,EAAA,EAAA;;AACA,WAAA,kBAAA,CAAA,OAAA,GAAA,IAAA,CAAuC,MAAvC,gBAAA,EAAA,WAAA,CAA2E,KAAA,eAAA,CAA3E,4BAA2E,CAA3E;AACH;;AACD,QAAI,KAAA,SAAA,CAAJ,UAAI,CAAJ,EAAgC;AAC5B,UAAIO,SAAS,GAAG,KAAA,aAAA,CAAmBP,UAAU,CAA7C,cAAgB,CAAhB;;AACA,UAAA,SAAA,EAAe;AACXO,QAAAA,SAAS,CAATA,IAAAA;AACH;;AACD,WAAA,kBAAA,CAAA,UAAA,CAAmCP,UAAU,CAA7C,iBAAA,EAAiEA,UAAU,CAA3E,iBAAA,EAA+FA,UAAU,CAAzG,cAAA,EAA0HA,UAAU,CAApI,cAAA;AACH;AAvLuE,GAAA;AAyL5EjL,EAAAA,OAAO,EAAE,SAAA,OAAA,GAAW;AAChB,QAAI,KAAJ,mBAAA,EAA8B;AAC1B,WAAA,sBAAA,CAA4B,KAA5B,mBAAA,EAAsD,CAAC,KAAD,kBAAA,EAA0B,KAA1B,kBAAA,EAAmD,KAAzG,gBAAsD,CAAtD;AACH;AACJ;AA7L2E,CAA7C,CAAnC;;AA+LA4L,MAAM,CAANA,OAAAA,GAAiB;AACbC,EAAAA,KAAK,EAAE;AACHC,IAAAA,oBAAoB,EADjB,oBAAA;AAEHC,IAAAA,kBAAkB,EAFf,kBAAA;AAGHC,IAAAA,kBAAkB,EAHf,kBAAA;AAIHC,IAAAA,WAAW,EAAE/M;AAJV,GADM;AAObgN,EAAAA,WAAW,EAAE;AACT1B,IAAAA,cAAc,EADL,4BAAA;AAET2B,IAAAA,aAAa,EAFJ,2BAAA;AAGTC,IAAAA,cAAc,EAAEtH;AAHP,GAPA;AAYbuH,EAAAA,SAAS,EAAE;AACPR,IAAAA,KAAK,EAAE;AACHT,MAAAA,QAAQ,EAAE;AACNkB,QAAAA,oBAAoB,EAAE,SAAA,oBAAA,CAAA,SAAA,EAAoB;AACtC,cAAIC,eAAe,GAAG,KAAA,MAAA,CAAtB,iBAAsB,CAAtB;AACA,cAAIxC,wBAAwB,GAAG,KAAA,aAAA,CAA/B,gBAA+B,CAA/B;AACA,cAAI1G,UAAU,GAAG0G,wBAAwB,CAAzC,UAAiBA,EAAjB;AACA,iBAAO,KAAA,QAAA,CAAA,KAAA,CAAA,IAAA,EAAA,SAAA,KAAwCyC,SAAS,GAATA,CAAAA,IAAAA,eAAAA,IAA/C,UAAA;AACH;AANK;AADP;AADA;AAZE,CAAjBZ","sourcesContent":["/**\r\n * DevExtreme (ui/grid_core/ui.grid_core.columns_resizing_reordering.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar _renderer = require(\"../../core/renderer\");\r\nvar _renderer2 = _interopRequireDefault(_renderer);\r\nvar _dom_adapter = require(\"../../core/dom_adapter\");\r\nvar _dom_adapter2 = _interopRequireDefault(_dom_adapter);\r\nvar _events_engine = require(\"../../events/core/events_engine\");\r\nvar _events_engine2 = _interopRequireDefault(_events_engine);\r\nvar _callbacks = require(\"../../core/utils/callbacks\");\r\nvar _callbacks2 = _interopRequireDefault(_callbacks);\r\nvar _type = require(\"../../core/utils/type\");\r\nvar _type2 = _interopRequireDefault(_type);\r\nvar _iterator = require(\"../../core/utils/iterator\");\r\nvar _extend = require(\"../../core/utils/extend\");\r\nvar _utils = require(\"../../events/utils\");\r\nvar _pointer = require(\"../../events/pointer\");\r\nvar _pointer2 = _interopRequireDefault(_pointer);\r\nvar _drag = require(\"../../events/drag\");\r\nvar _drag2 = _interopRequireDefault(_drag);\r\nvar _uiGrid_core = require(\"./ui.grid_core.modules\");\r\nvar _uiGrid_core2 = _interopRequireDefault(_uiGrid_core);\r\nvar _uiGrid_core3 = require(\"./ui.grid_core.utils\");\r\nvar _uiGrid_core4 = _interopRequireDefault(_uiGrid_core3);\r\nvar _fx = require(\"../../animation/fx\");\r\nvar _fx2 = _interopRequireDefault(_fx);\r\nvar _swatch_container = require(\"../widget/swatch_container\");\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\nvar COLUMNS_SEPARATOR_CLASS = \"columns-separator\";\r\nvar COLUMNS_SEPARATOR_TRANSPARENT = \"columns-separator-transparent\";\r\nvar DRAGGING_HEADER_CLASS = \"drag-header\";\r\nvar CELL_CONTENT_CLASS = \"text-content\";\r\nvar HEADERS_DRAG_ACTION_CLASS = \"drag-action\";\r\nvar TRACKER_CLASS = \"tracker\";\r\nvar HEADERS_DROP_HIGHLIGHT_CLASS = \"drop-highlight\";\r\nvar BLOCK_SEPARATOR_CLASS = \"dx-block-separator\";\r\nvar HEADER_ROW_CLASS = \"dx-header-row\";\r\nvar WIDGET_CLASS = \"dx-widget\";\r\nvar DRAGGING_COMMAND_CELL_CLASS = \"dx-drag-command-cell\";\r\nvar MODULE_NAMESPACE = \"dxDataGridResizingReordering\";\r\nvar COLUMNS_SEPARATOR_TOUCH_TRACKER_WIDTH = 10;\r\nvar DRAGGING_DELTA = 5;\r\nvar COLUMN_OPACITY = .5;\r\nvar allowResizing = function(that) {\r\n    return that.option(\"allowColumnResizing\") || that.getController(\"columns\").isColumnOptionUsed(\"allowResizing\")\r\n};\r\nvar allowReordering = function(that) {\r\n    return that.option(\"allowColumnReordering\") || that.getController(\"columns\").isColumnOptionUsed(\"allowReordering\")\r\n};\r\nvar TrackerView = _uiGrid_core2.default.View.inherit({\r\n    _renderCore: function() {\r\n        this.callBase();\r\n        this.element().addClass(this.addWidgetPrefix(TRACKER_CLASS));\r\n        this.hide()\r\n    },\r\n    _unsubscribeFromCallback: function() {\r\n        if (this._positionChanged) {\r\n            this._tablePositionController.positionChanged.remove(this._positionChanged)\r\n        }\r\n    },\r\n    _subscribeToCallback: function() {\r\n        var that = this;\r\n        that._positionChanged = function(position) {\r\n            var $element = that.element();\r\n            if ($element && $element.hasClass(that.addWidgetPrefix(TRACKER_CLASS))) {\r\n                $element.css({\r\n                    top: position.top\r\n                });\r\n                $element.height(position.height)\r\n            }\r\n        };\r\n        this._tablePositionController.positionChanged.add(that._positionChanged)\r\n    },\r\n    optionChanged: function(args) {\r\n        if (\"allowColumnResizing\" === args.name) {\r\n            this._unsubscribeFromCallback();\r\n            if (args.value) {\r\n                this._subscribeToCallback();\r\n                this._invalidate()\r\n            }\r\n        }\r\n        this.callBase(args)\r\n    },\r\n    init: function() {\r\n        this.callBase();\r\n        this._tablePositionController = this.getController(\"tablePosition\");\r\n        this._subscribeToCallback()\r\n    },\r\n    isVisible: function() {\r\n        return allowResizing(this)\r\n    },\r\n    show: function() {\r\n        this.element().show()\r\n    },\r\n    hide: function() {\r\n        this.element() && this.element().hide()\r\n    },\r\n    setHeight: function(value) {\r\n        this.element().height(value)\r\n    },\r\n    dispose: function() {\r\n        this._unsubscribeFromCallback();\r\n        this.callBase()\r\n    }\r\n});\r\nvar SeparatorView = _uiGrid_core2.default.View.inherit({\r\n    _renderSeparator: function() {},\r\n    _renderCore: function(options) {\r\n        this.callBase(options);\r\n        this._isShown = true;\r\n        this._renderSeparator();\r\n        this.hide()\r\n    },\r\n    show: function() {\r\n        this._isShown = true\r\n    },\r\n    hide: function() {\r\n        this._isShown = false\r\n    },\r\n    height: function(value) {\r\n        var $element = this.element();\r\n        if ($element) {\r\n            if (_type2.default.isDefined(value)) {\r\n                $element.height(value)\r\n            } else {\r\n                return $element.height()\r\n            }\r\n        }\r\n    },\r\n    width: function(value) {\r\n        var $element = this.element();\r\n        if ($element) {\r\n            if (_type2.default.isDefined(value)) {\r\n                $element.width(value)\r\n            } else {\r\n                return $element.width()\r\n            }\r\n        }\r\n    }\r\n});\r\nvar ColumnsSeparatorView = SeparatorView.inherit({\r\n    _renderSeparator: function() {\r\n        this.callBase();\r\n        var $element = this.element();\r\n        $element.addClass(this.addWidgetPrefix(COLUMNS_SEPARATOR_CLASS))\r\n    },\r\n    _subscribeToCallback: function() {\r\n        var that = this;\r\n        var $element;\r\n        that._positionChanged = function(position) {\r\n            $element = that.element();\r\n            if ($element) {\r\n                $element.css({\r\n                    top: position.top\r\n                });\r\n                $element.height(position.height)\r\n            }\r\n        };\r\n        that._tablePositionController.positionChanged.add(that._positionChanged)\r\n    },\r\n    _unsubscribeFromCallback: function() {\r\n        this._positionChanged && this._tablePositionController.positionChanged.remove(this._positionChanged)\r\n    },\r\n    _init: function() {\r\n        this._isTransparent = allowResizing(this);\r\n        if (this.isVisible()) {\r\n            this._subscribeToCallback()\r\n        }\r\n    },\r\n    isVisible: function() {\r\n        return this.option(\"showColumnHeaders\") && (allowReordering(this) || allowResizing(this))\r\n    },\r\n    optionChanged: function(args) {\r\n        if (\"allowColumnResizing\" === args.name) {\r\n            if (args.value) {\r\n                this._init();\r\n                this._invalidate();\r\n                this.hide(true)\r\n            } else {\r\n                this._unsubscribeFromCallback();\r\n                this._isTransparent = allowResizing(this);\r\n                this.hide(true)\r\n            }\r\n        }\r\n        this.callBase(args)\r\n    },\r\n    init: function() {\r\n        this.callBase();\r\n        this._tablePositionController = this.getController(\"tablePosition\");\r\n        this._init()\r\n    },\r\n    show: function() {\r\n        var that = this;\r\n        var $element = this.element();\r\n        if ($element && !that._isShown) {\r\n            if (that._isTransparent) {\r\n                $element.removeClass(that.addWidgetPrefix(COLUMNS_SEPARATOR_TRANSPARENT))\r\n            } else {\r\n                $element.show()\r\n            }\r\n        }\r\n        this.callBase()\r\n    },\r\n    hide: function(force) {\r\n        var $element = this.element();\r\n        var columnsSeparatorTransparent = this.addWidgetPrefix(COLUMNS_SEPARATOR_TRANSPARENT);\r\n        if ($element && (this._isShown || force)) {\r\n            if (this._isTransparent) {\r\n                $element.addClass(columnsSeparatorTransparent);\r\n                $element.css(\"left\", \"\");\r\n                $element.show()\r\n            } else {\r\n                if ($element.hasClass(columnsSeparatorTransparent)) {\r\n                    $element.removeClass(columnsSeparatorTransparent)\r\n                }\r\n                $element.hide()\r\n            }\r\n        }\r\n        this.callBase()\r\n    },\r\n    moveByX: function(outerX) {\r\n        var $element = this.element();\r\n        if ($element) {\r\n            $element.css(\"left\", outerX - this._parentElement().offset().left)\r\n        }\r\n    },\r\n    changeCursor: function(cursorName) {\r\n        cursorName = _type2.default.isDefined(cursorName) ? cursorName : \"\";\r\n        var $element = this.element();\r\n        if ($element) {\r\n            $element.css(\"cursor\", cursorName)\r\n        }\r\n    },\r\n    dispose: function() {\r\n        this._unsubscribeFromCallback();\r\n        this.callBase()\r\n    }\r\n});\r\nvar BlockSeparatorView = SeparatorView.inherit({\r\n    init: function() {\r\n        var that = this;\r\n        this.callBase();\r\n        this.getController(\"data\").loadingChanged.add(function(isLoading) {\r\n            if (!isLoading) {\r\n                that.hide()\r\n            }\r\n        })\r\n    },\r\n    _renderSeparator: function() {\r\n        this.callBase();\r\n        this.element().addClass(BLOCK_SEPARATOR_CLASS).html(\"&nbsp;\")\r\n    },\r\n    hide: function() {\r\n        var that = this;\r\n        var $parent = this._parentElement();\r\n        var $element = this.element();\r\n        if ($element && this._isShown) {\r\n            $element.css(\"display\", \"none\")\r\n        }\r\n        if ($parent && !$parent.children(\".\" + BLOCK_SEPARATOR_CLASS).length) {\r\n            $parent.prepend(that.element())\r\n        }\r\n        that.callBase()\r\n    },\r\n    isVisible: function() {\r\n        var groupPanelOptions = this.option(\"groupPanel\");\r\n        var columnChooserOptions = this.option(\"columnChooser\");\r\n        return groupPanelOptions && groupPanelOptions.visible || columnChooserOptions && columnChooserOptions.enabled\r\n    },\r\n    show: function(targetLocation) {\r\n        var that = this;\r\n        var $element = this.element();\r\n        var startAnimate = function(toOptions) {\r\n            _fx2.default.stop($element, true);\r\n            _fx2.default.animate($element, {\r\n                type: \"slide\",\r\n                from: {\r\n                    width: 0,\r\n                    display: toOptions.display\r\n                },\r\n                to: toOptions,\r\n                duration: 300,\r\n                easing: \"swing\"\r\n            })\r\n        };\r\n        if ($element && !that._isShown) {\r\n            switch (targetLocation) {\r\n                case \"group\":\r\n                    startAnimate({\r\n                        width: \"50px\",\r\n                        display: \"inline-block\"\r\n                    });\r\n                    break;\r\n                case \"columnChooser\":\r\n                    startAnimate({\r\n                        width: \"100%\",\r\n                        display: \"block\"\r\n                    });\r\n                    break;\r\n                default:\r\n                    $element.css(\"display\", \"\")\r\n            }\r\n        }\r\n        that.callBase()\r\n    }\r\n});\r\nvar DraggingHeaderView = _uiGrid_core2.default.View.inherit({\r\n    _isDragging: false,\r\n    _getDraggingPanelByPos: function(pos) {\r\n        var that = this;\r\n        var result;\r\n        (0, _iterator.each)(that._dragOptions.draggingPanels, function(index, draggingPanel) {\r\n            if (draggingPanel) {\r\n                var boundingRect = draggingPanel.getBoundingRect();\r\n                if (boundingRect && (void 0 === boundingRect.bottom || pos.y < boundingRect.bottom) && (void 0 === boundingRect.top || pos.y > boundingRect.top) && (void 0 === boundingRect.left || pos.x > boundingRect.left) && (void 0 === boundingRect.right || pos.x < boundingRect.right)) {\r\n                    result = draggingPanel;\r\n                    return false\r\n                }\r\n            }\r\n        });\r\n        return result\r\n    },\r\n    _renderCore: function() {\r\n        this.element().addClass(this.addWidgetPrefix(DRAGGING_HEADER_CLASS) + \" \" + this.addWidgetPrefix(CELL_CONTENT_CLASS) + \" \" + WIDGET_CLASS).hide()\r\n    },\r\n    _resetTargetColumnOptions: function() {\r\n        var params = this._dropOptions;\r\n        params.targetColumnIndex = -1;\r\n        delete params.targetColumnElement;\r\n        delete params.isLast;\r\n        delete params.posX;\r\n        delete params.posY\r\n    },\r\n    _getVisibleIndexObject: function(rowIndex, visibleIndex) {\r\n        if (_type2.default.isDefined(rowIndex)) {\r\n            return {\r\n                columnIndex: visibleIndex,\r\n                rowIndex: rowIndex\r\n            }\r\n        }\r\n        return visibleIndex\r\n    },\r\n    dispose: function() {\r\n        var element = this.element();\r\n        this._dragOptions = null;\r\n        element && element.parent().find(\".\" + this.addWidgetPrefix(DRAGGING_HEADER_CLASS)).remove()\r\n    },\r\n    isVisible: function() {\r\n        var columnsController = this.getController(\"columns\");\r\n        var commonColumnSettings = columnsController.getCommonSettings();\r\n        return this.option(\"showColumnHeaders\") && (allowReordering(this) || commonColumnSettings.allowGrouping || commonColumnSettings.allowHiding)\r\n    },\r\n    init: function() {\r\n        var that = this;\r\n        this.callBase();\r\n        this._controller = this.getController(\"draggingHeader\");\r\n        this._columnsResizerViewController = this.getController(\"columnsResizer\");\r\n        this.getController(\"data\").loadingChanged.add(function(isLoading) {\r\n            var element = that.element();\r\n            if (!isLoading && element) {\r\n                element.hide()\r\n            }\r\n        })\r\n    },\r\n    dragHeader: function(options) {\r\n        var that = this;\r\n        var columnElement = options.columnElement;\r\n        var isCommandColumn = !!options.sourceColumn.type;\r\n        that._isDragging = true;\r\n        that._dragOptions = options;\r\n        that._dropOptions = {\r\n            sourceIndex: options.index,\r\n            sourceColumnIndex: that._getVisibleIndexObject(options.rowIndex, options.columnIndex),\r\n            sourceColumnElement: options.columnElement,\r\n            sourceLocation: options.sourceLocation\r\n        };\r\n        var document = _dom_adapter2.default.getDocument();\r\n        that._onSelectStart = document.onselectstart;\r\n        document.onselectstart = function() {\r\n            return false\r\n        };\r\n        that._controller.drag(that._dropOptions);\r\n        that.element().css({\r\n            textAlign: columnElement && columnElement.css(\"textAlign\"),\r\n            height: columnElement && (isCommandColumn && columnElement.get(0).clientHeight || columnElement.height()),\r\n            width: columnElement && (isCommandColumn && columnElement.get(0).clientWidth || columnElement.width()),\r\n            whiteSpace: columnElement && columnElement.css(\"whiteSpace\")\r\n        }).addClass(that.addWidgetPrefix(HEADERS_DRAG_ACTION_CLASS)).toggleClass(DRAGGING_COMMAND_CELL_CLASS, isCommandColumn).text(isCommandColumn ? \"\" : options.sourceColumn.caption);\r\n        that.element().appendTo((0, _swatch_container.getSwatchContainer)(columnElement))\r\n    },\r\n    moveHeader: function(args) {\r\n        var e = args.event;\r\n        var that = e.data.that;\r\n        var newLeft;\r\n        var newTop;\r\n        var moveDeltaX;\r\n        var moveDeltaY;\r\n        var eventData = (0, _utils.eventData)(e);\r\n        var isResizing = that._columnsResizerViewController ? that._columnsResizerViewController.isResizing() : false;\r\n        var dragOptions = that._dragOptions;\r\n        if (that._isDragging && !isResizing) {\r\n            var $element = that.element();\r\n            moveDeltaX = Math.abs(eventData.x - dragOptions.columnElement.offset().left - dragOptions.deltaX);\r\n            moveDeltaY = Math.abs(eventData.y - dragOptions.columnElement.offset().top - dragOptions.deltaY);\r\n            if ($element.is(\":visible\") || moveDeltaX > DRAGGING_DELTA || moveDeltaY > DRAGGING_DELTA) {\r\n                $element.show();\r\n                newLeft = eventData.x - dragOptions.deltaX;\r\n                newTop = eventData.y - dragOptions.deltaY;\r\n                $element.css({\r\n                    left: newLeft,\r\n                    top: newTop\r\n                });\r\n                that.dockHeader(eventData)\r\n            }\r\n            e.preventDefault()\r\n        }\r\n    },\r\n    dockHeader: function(eventData) {\r\n        var that = this;\r\n        var targetDraggingPanel = that._getDraggingPanelByPos(eventData);\r\n        var controller = that._controller;\r\n        var i;\r\n        var params = that._dropOptions;\r\n        var dragOptions = that._dragOptions;\r\n        var centerPosition;\r\n        if (targetDraggingPanel) {\r\n            var rtlEnabled = that.option(\"rtlEnabled\");\r\n            var isVerticalOrientation = \"columnChooser\" === targetDraggingPanel.getName();\r\n            var axisName = isVerticalOrientation ? \"y\" : \"x\";\r\n            var targetLocation = targetDraggingPanel.getName();\r\n            var rowIndex = \"headers\" === targetLocation ? dragOptions.rowIndex : void 0;\r\n            var sourceColumn = dragOptions.sourceColumn;\r\n            var columnElements = targetDraggingPanel.getColumnElements(rowIndex, sourceColumn && sourceColumn.ownerBand) || [];\r\n            var pointsByTarget = dragOptions.pointsByTarget = dragOptions.pointsByTarget || {};\r\n            var pointsByColumns = \"columnChooser\" === targetLocation ? [] : pointsByTarget[targetLocation] || controller._generatePointsByColumns((0, _extend.extend)({}, dragOptions, {\r\n                targetDraggingPanel: targetDraggingPanel,\r\n                columns: targetDraggingPanel.getColumns(rowIndex),\r\n                columnElements: columnElements,\r\n                isVerticalOrientation: isVerticalOrientation,\r\n                startColumnIndex: \"headers\" === targetLocation && (0, _renderer2.default)(columnElements[0]).index()\r\n            }));\r\n            pointsByTarget[targetLocation] = pointsByColumns;\r\n            params.targetLocation = targetLocation;\r\n            if (pointsByColumns.length > 0) {\r\n                for (i = 0; i < pointsByColumns.length; i++) {\r\n                    centerPosition = pointsByColumns[i + 1] && (pointsByColumns[i][axisName] + pointsByColumns[i + 1][axisName]) / 2;\r\n                    if (void 0 === centerPosition || (rtlEnabled && \"x\" === axisName ? eventData[axisName] > centerPosition : eventData[axisName] < centerPosition)) {\r\n                        params.targetColumnIndex = that._getVisibleIndexObject(rowIndex, pointsByColumns[i].columnIndex);\r\n                        if (columnElements[i]) {\r\n                            params.targetColumnElement = columnElements.eq(i);\r\n                            params.isLast = false\r\n                        } else {\r\n                            params.targetColumnElement = columnElements.last();\r\n                            params.isLast = true\r\n                        }\r\n                        params.posX = pointsByColumns[i].x;\r\n                        params.posY = pointsByColumns[i].y;\r\n                        controller.dock(params);\r\n                        break\r\n                    }\r\n                }\r\n            } else {\r\n                that._resetTargetColumnOptions();\r\n                controller.dock(params)\r\n            }\r\n        }\r\n    },\r\n    dropHeader: function(args) {\r\n        var e = args.event;\r\n        var that = e.data.that;\r\n        var controller = that._controller;\r\n        that.element().hide();\r\n        if (controller && that._isDragging) {\r\n            controller.drop(that._dropOptions)\r\n        }\r\n        that.element().appendTo(that._parentElement());\r\n        that._dragOptions = null;\r\n        that._dropOptions = null;\r\n        that._isDragging = false;\r\n        _dom_adapter2.default.getDocument().onselectstart = that._onSelectStart || null\r\n    }\r\n});\r\nvar isNextColumnResizingMode = function(that) {\r\n    return \"widget\" !== that.option(\"columnResizingMode\")\r\n};\r\nvar ColumnsResizerViewController = _uiGrid_core2.default.ViewController.inherit({\r\n    _isHeadersRowArea: function(posY) {\r\n        if (this._columnHeadersView) {\r\n            var element = this._columnHeadersView.element();\r\n            var headersRowHeight;\r\n            var offsetTop;\r\n            if (element) {\r\n                offsetTop = element.offset().top;\r\n                headersRowHeight = this._columnHeadersView.getHeadersRowHeight();\r\n                return posY >= offsetTop && posY <= offsetTop + headersRowHeight\r\n            }\r\n        }\r\n        return false\r\n    },\r\n    _pointCreated: function(point, cellsLength, columns) {\r\n        var currentColumn;\r\n        var isNextColumnMode = isNextColumnResizingMode(this);\r\n        var rtlEnabled = this.option(\"rtlEnabled\");\r\n        var firstPointColumnIndex = !isNextColumnMode && rtlEnabled ? 0 : 1;\r\n        var nextColumn;\r\n        if (point.index >= firstPointColumnIndex && point.index < cellsLength + (!isNextColumnMode && !rtlEnabled ? 1 : 0)) {\r\n            point.columnIndex -= firstPointColumnIndex;\r\n            currentColumn = columns[point.columnIndex] || {};\r\n            nextColumn = columns[point.columnIndex + 1] || {};\r\n            return !(isNextColumnMode ? currentColumn.allowResizing && nextColumn.allowResizing : currentColumn.allowResizing)\r\n        }\r\n        return true\r\n    },\r\n    _getTargetPoint: function(pointsByColumns, currentX, deltaX) {\r\n        if (pointsByColumns) {\r\n            for (var i = 0; i < pointsByColumns.length; i++) {\r\n                if (pointsByColumns[i].x === pointsByColumns[0].x && pointsByColumns[i + 1] && pointsByColumns[i].x === pointsByColumns[i + 1].x) {\r\n                    continue\r\n                }\r\n                if (pointsByColumns[i].x - deltaX <= currentX && currentX <= pointsByColumns[i].x + deltaX) {\r\n                    return pointsByColumns[i]\r\n                }\r\n            }\r\n        }\r\n        return null\r\n    },\r\n    _moveSeparator: function(args) {\r\n        var e = args.event;\r\n        var that = e.data;\r\n        var columnsSeparatorWidth = that._columnsSeparatorView.width();\r\n        var isNextColumnMode = isNextColumnResizingMode(that);\r\n        var deltaX = columnsSeparatorWidth / 2;\r\n        var parentOffset = that._$parentContainer.offset();\r\n        var parentOffsetLeft = parentOffset.left;\r\n        var eventData = (0, _utils.eventData)(e);\r\n        if (that._isResizing && that._resizingInfo) {\r\n            if (parentOffsetLeft <= eventData.x && (!isNextColumnMode || eventData.x <= parentOffsetLeft + that._$parentContainer.width())) {\r\n                if (that._updateColumnsWidthIfNeeded(eventData.x)) {\r\n                    var $cell = that._columnHeadersView.getColumnElements().eq(that._resizingInfo.currentColumnIndex);\r\n                    that._columnsSeparatorView.moveByX($cell.offset().left + (isNextColumnMode && that.option(\"rtlEnabled\") ? 0 : $cell.outerWidth()));\r\n                    that._tablePositionController.update(that._targetPoint.y);\r\n                    e.preventDefault()\r\n                }\r\n            }\r\n        } else {\r\n            if (that._isHeadersRowArea(eventData.y)) {\r\n                if (that._previousParentOffset) {\r\n                    if (that._previousParentOffset.left !== parentOffset.left || that._previousParentOffset.top !== parentOffset.top) {\r\n                        that.pointsByColumns(null)\r\n                    }\r\n                }\r\n                that._targetPoint = that._getTargetPoint(that.pointsByColumns(), eventData.x, columnsSeparatorWidth);\r\n                that._previousParentOffset = parentOffset;\r\n                that._isReadyResizing = false;\r\n                if (that._targetPoint) {\r\n                    that._columnsSeparatorView.changeCursor(\"col-resize\");\r\n                    that._columnsSeparatorView.moveByX(that._targetPoint.x - deltaX);\r\n                    that._tablePositionController.update(that._targetPoint.y);\r\n                    that._isReadyResizing = true;\r\n                    e.preventDefault()\r\n                } else {\r\n                    that._columnsSeparatorView.changeCursor()\r\n                }\r\n            } else {\r\n                that.pointsByColumns(null);\r\n                that._isReadyResizing = false;\r\n                that._columnsSeparatorView.changeCursor()\r\n            }\r\n        }\r\n    },\r\n    _endResizing: function(args) {\r\n        var e = args.event;\r\n        var that = e.data;\r\n        if (that._isResizing) {\r\n            that.pointsByColumns(null);\r\n            that._resizingInfo = null;\r\n            that._columnsSeparatorView.hide();\r\n            that._columnsSeparatorView.changeCursor();\r\n            that._trackerView.hide();\r\n            if (!isNextColumnResizingMode(that)) {\r\n                var pageIndex = that.component.pageIndex();\r\n                that.component.updateDimensions();\r\n                if (that.option(\"wordWrapEnabled\") && \"virtual\" === that.option(\"scrolling.mode\")) {\r\n                    var dataSource = that.component.getDataSource();\r\n                    dataSource && dataSource.load().done(function() {\r\n                        that._rowsView.scrollToPage(pageIndex)\r\n                    })\r\n                }\r\n            }\r\n            that._isReadyResizing = false;\r\n            that._isResizing = false\r\n        }\r\n    },\r\n    _getNextColumnIndex: function(currentColumnIndex) {\r\n        return currentColumnIndex + 1\r\n    },\r\n    _setupResizingInfo: function(posX) {\r\n        var that = this;\r\n        var currentColumnIndex = that._targetPoint.columnIndex;\r\n        var nextColumnIndex = that._getNextColumnIndex(currentColumnIndex);\r\n        var currentHeader = that._columnHeadersView.getHeaderElement(currentColumnIndex);\r\n        var nextHeader = that._columnHeadersView.getHeaderElement(nextColumnIndex);\r\n        that._resizingInfo = {\r\n            startPosX: posX,\r\n            currentColumnIndex: currentColumnIndex,\r\n            currentColumnWidth: currentHeader && currentHeader.length > 0 ? currentHeader[0].getBoundingClientRect().width : 0,\r\n            nextColumnIndex: nextColumnIndex,\r\n            nextColumnWidth: nextHeader && nextHeader.length > 0 ? nextHeader[0].getBoundingClientRect().width : 0\r\n        }\r\n    },\r\n    _startResizing: function(args) {\r\n        var e = args.event;\r\n        var that = e.data;\r\n        var eventData = (0, _utils.eventData)(e);\r\n        var editingController = that.getController(\"editing\");\r\n        var editingMode = that.option(\"editing.mode\");\r\n        var isCellEditing = editingController.isEditing() && (\"batch\" === editingMode || \"cell\" === editingMode);\r\n        if ((0, _utils.isTouchEvent)(e)) {\r\n            if (that._isHeadersRowArea(eventData.y)) {\r\n                that._targetPoint = that._getTargetPoint(that.pointsByColumns(), eventData.x, COLUMNS_SEPARATOR_TOUCH_TRACKER_WIDTH);\r\n                if (that._targetPoint) {\r\n                    that._columnsSeparatorView.moveByX(that._targetPoint.x - that._columnsSeparatorView.width() / 2);\r\n                    that._isReadyResizing = true\r\n                }\r\n            } else {\r\n                that._isReadyResizing = false\r\n            }\r\n        }\r\n        if (that._isReadyResizing && !isCellEditing) {\r\n            that._setupResizingInfo(eventData.x);\r\n            that._isResizing = true;\r\n            that._tablePositionController.update(that._targetPoint.y);\r\n            that._columnsSeparatorView.show();\r\n            that._trackerView.show();\r\n            e.preventDefault();\r\n            e.stopPropagation()\r\n        }\r\n    },\r\n    _generatePointsByColumns: function() {\r\n        var that = this;\r\n        var columns = that._columnsController ? that._columnsController.getVisibleColumns() : [];\r\n        var cells = that._columnHeadersView.getColumnElements();\r\n        var pointsByColumns = [];\r\n        if (cells && cells.length > 0) {\r\n            pointsByColumns = _uiGrid_core4.default.getPointsByColumns(cells, function(point) {\r\n                return that._pointCreated(point, cells.length, columns)\r\n            })\r\n        }\r\n        that._pointsByColumns = pointsByColumns\r\n    },\r\n    _unsubscribeFromEvents: function() {\r\n        this._moveSeparatorHandler && _events_engine2.default.off(_dom_adapter2.default.getDocument(), (0, _utils.addNamespace)(_pointer2.default.move, MODULE_NAMESPACE), this._moveSeparatorHandler);\r\n        this._startResizingHandler && _events_engine2.default.off(this._$parentContainer, (0, _utils.addNamespace)(_pointer2.default.down, MODULE_NAMESPACE), this._startResizingHandler);\r\n        if (this._endResizingHandler) {\r\n            _events_engine2.default.off(this._columnsSeparatorView.element(), (0, _utils.addNamespace)(_pointer2.default.up, MODULE_NAMESPACE), this._endResizingHandler);\r\n            _events_engine2.default.off(_dom_adapter2.default.getDocument(), (0, _utils.addNamespace)(_pointer2.default.up, MODULE_NAMESPACE), this._endResizingHandler)\r\n        }\r\n    },\r\n    _subscribeToEvents: function() {\r\n        this._moveSeparatorHandler = this.createAction(this._moveSeparator);\r\n        this._startResizingHandler = this.createAction(this._startResizing);\r\n        this._endResizingHandler = this.createAction(this._endResizing);\r\n        _events_engine2.default.on(_dom_adapter2.default.getDocument(), (0, _utils.addNamespace)(_pointer2.default.move, MODULE_NAMESPACE), this, this._moveSeparatorHandler);\r\n        _events_engine2.default.on(this._$parentContainer, (0, _utils.addNamespace)(_pointer2.default.down, MODULE_NAMESPACE), this, this._startResizingHandler);\r\n        _events_engine2.default.on(this._columnsSeparatorView.element(), (0, _utils.addNamespace)(_pointer2.default.up, MODULE_NAMESPACE), this, this._endResizingHandler);\r\n        _events_engine2.default.on(_dom_adapter2.default.getDocument(), (0, _utils.addNamespace)(_pointer2.default.up, MODULE_NAMESPACE), this, this._endResizingHandler)\r\n    },\r\n    _updateColumnsWidthIfNeeded: function(posX) {\r\n        var deltaX;\r\n        var needUpdate = false;\r\n        var nextCellWidth;\r\n        var resizingInfo = this._resizingInfo;\r\n        var columnsController = this._columnsController;\r\n        var visibleColumns = columnsController.getVisibleColumns();\r\n        var columnsSeparatorWidth = this._columnsSeparatorView.width();\r\n        var contentWidth = this._rowsView.contentWidth();\r\n        var isNextColumnMode = isNextColumnResizingMode(this);\r\n        var adaptColumnWidthByRatio = isNextColumnMode && this.option(\"adaptColumnWidthByRatio\") && !this.option(\"columnAutoWidth\");\r\n        var column;\r\n        var minWidth;\r\n        var nextColumn;\r\n        var cellWidth;\r\n\r\n        function isPercentWidth(width) {\r\n            return _type2.default.isString(width) && \"%\" === width.slice(-1)\r\n        }\r\n\r\n        function setColumnWidth(column, columnWidth, contentWidth, adaptColumnWidthByRatio) {\r\n            if (column) {\r\n                var oldColumnWidth = column.width;\r\n                if (oldColumnWidth) {\r\n                    adaptColumnWidthByRatio = isPercentWidth(oldColumnWidth)\r\n                }\r\n                if (adaptColumnWidthByRatio) {\r\n                    column && columnsController.columnOption(column.index, \"visibleWidth\", columnWidth);\r\n                    column && columnsController.columnOption(column.index, \"width\", (columnWidth / contentWidth * 100).toFixed(3) + \"%\")\r\n                } else {\r\n                    column && columnsController.columnOption(column.index, \"visibleWidth\", null);\r\n                    column && columnsController.columnOption(column.index, \"width\", columnWidth)\r\n                }\r\n            }\r\n        }\r\n\r\n        function correctContentWidth(contentWidth, visibleColumns) {\r\n            var allColumnsHaveWidth = visibleColumns.every(function(column) {\r\n                return column.width\r\n            });\r\n            var totalPercent;\r\n            if (allColumnsHaveWidth) {\r\n                totalPercent = visibleColumns.reduce(function(sum, column) {\r\n                    if (isPercentWidth(column.width)) {\r\n                        sum += parseFloat(column.width)\r\n                    }\r\n                    return sum\r\n                }, 0);\r\n                if (totalPercent > 100) {\r\n                    contentWidth = contentWidth / totalPercent * 100\r\n                }\r\n            }\r\n            return contentWidth\r\n        }\r\n        deltaX = posX - resizingInfo.startPosX;\r\n        if (isNextColumnMode && this.option(\"rtlEnabled\")) {\r\n            deltaX = -deltaX\r\n        }\r\n        cellWidth = resizingInfo.currentColumnWidth + deltaX;\r\n        column = visibleColumns[resizingInfo.currentColumnIndex];\r\n        minWidth = column && column.minWidth || columnsSeparatorWidth;\r\n        needUpdate = cellWidth >= minWidth;\r\n        if (isNextColumnMode) {\r\n            nextCellWidth = resizingInfo.nextColumnWidth - deltaX;\r\n            nextColumn = visibleColumns[resizingInfo.nextColumnIndex];\r\n            minWidth = nextColumn && nextColumn.minWidth || columnsSeparatorWidth;\r\n            needUpdate = needUpdate && nextCellWidth >= minWidth\r\n        }\r\n        if (needUpdate) {\r\n            columnsController.beginUpdate();\r\n            cellWidth = Math.floor(cellWidth);\r\n            contentWidth = correctContentWidth(contentWidth, visibleColumns);\r\n            setColumnWidth(column, cellWidth, contentWidth, adaptColumnWidthByRatio);\r\n            if (isNextColumnMode) {\r\n                nextCellWidth = Math.floor(nextCellWidth);\r\n                setColumnWidth(nextColumn, nextCellWidth, contentWidth, adaptColumnWidthByRatio)\r\n            } else {\r\n                var columnWidths = this._columnHeadersView.getColumnWidths();\r\n                columnWidths[resizingInfo.currentColumnIndex] = cellWidth;\r\n                var hasScroll = columnWidths.reduce(function(totalWidth, width) {\r\n                    return totalWidth + width\r\n                }, 0) > this._rowsView.contentWidth();\r\n                if (!hasScroll) {\r\n                    var lastColumnIndex = _uiGrid_core4.default.getLastResizableColumnIndex(visibleColumns);\r\n                    if (lastColumnIndex >= 0) {\r\n                        columnsController.columnOption(visibleColumns[lastColumnIndex].index, \"visibleWidth\", \"auto\")\r\n                    }\r\n                }\r\n                for (var i = 0; i < columnWidths.length; i++) {\r\n                    if (visibleColumns[i] && visibleColumns[i] !== column && void 0 === visibleColumns[i].width) {\r\n                        columnsController.columnOption(visibleColumns[i].index, \"width\", columnWidths[i])\r\n                    }\r\n                }\r\n            }\r\n            columnsController.endUpdate()\r\n        }\r\n        return needUpdate\r\n    },\r\n    _subscribeToCallback: function(callback, handler) {\r\n        callback.add(handler);\r\n        this._subscribesToCallbacks.push({\r\n            callback: callback,\r\n            handler: handler\r\n        })\r\n    },\r\n    _unsubscribeFromCallbacks: function() {\r\n        var i;\r\n        var subscribe;\r\n        for (i = 0; i < this._subscribesToCallbacks.length; i++) {\r\n            subscribe = this._subscribesToCallbacks[i];\r\n            subscribe.callback.remove(subscribe.handler)\r\n        }\r\n        this._subscribesToCallbacks = []\r\n    },\r\n    _unsubscribes: function() {\r\n        this._unsubscribeFromEvents();\r\n        this._unsubscribeFromCallbacks()\r\n    },\r\n    _init: function() {\r\n        var that = this;\r\n        var generatePointsByColumnsHandler = function() {\r\n            if (!that._isResizing) {\r\n                that.pointsByColumns(null)\r\n            }\r\n        };\r\n        var generatePointsByColumnsScrollHandler = function(offset) {\r\n            if (that._scrollLeft !== offset.left) {\r\n                that._scrollLeft = offset.left;\r\n                that.pointsByColumns(null)\r\n            }\r\n        };\r\n        that._columnsSeparatorView = that.getView(\"columnsSeparatorView\");\r\n        that._columnHeadersView = that.getView(\"columnHeadersView\");\r\n        that._trackerView = that.getView(\"trackerView\");\r\n        that._rowsView = that.getView(\"rowsView\");\r\n        that._columnsController = that.getController(\"columns\");\r\n        that._tablePositionController = that.getController(\"tablePosition\");\r\n        that._$parentContainer = that._columnsSeparatorView.component.$element();\r\n        that._subscribeToCallback(that._columnHeadersView.renderCompleted, generatePointsByColumnsHandler);\r\n        that._subscribeToCallback(that._columnHeadersView.resizeCompleted, generatePointsByColumnsHandler);\r\n        that._subscribeToCallback(that._columnsSeparatorView.renderCompleted, function() {\r\n            that._unsubscribeFromEvents();\r\n            that._subscribeToEvents()\r\n        });\r\n        that._subscribeToCallback(that._rowsView.renderCompleted, function() {\r\n            that._rowsView.scrollChanged.remove(generatePointsByColumnsScrollHandler);\r\n            that._rowsView.scrollChanged.add(generatePointsByColumnsScrollHandler)\r\n        });\r\n        var previousScrollbarVisibility = 0 !== that._rowsView.getScrollbarWidth();\r\n        var previousTableHeight = 0;\r\n        that._subscribeToCallback(that.getController(\"tablePosition\").positionChanged, function(e) {\r\n            if (that._isResizing && !that._rowsView.isResizing) {\r\n                var scrollbarVisibility = 0 !== that._rowsView.getScrollbarWidth();\r\n                if (previousScrollbarVisibility !== scrollbarVisibility || previousTableHeight && previousTableHeight !== e.height) {\r\n                    previousScrollbarVisibility = scrollbarVisibility;\r\n                    previousTableHeight = e.height;\r\n                    that.component.updateDimensions()\r\n                } else {\r\n                    that._rowsView.updateFreeSpaceRowHeight()\r\n                }\r\n            }\r\n            previousTableHeight = e.height\r\n        })\r\n    },\r\n    optionChanged: function(args) {\r\n        this.callBase(args);\r\n        if (\"allowColumnResizing\" === args.name) {\r\n            if (args.value) {\r\n                this._init();\r\n                this._subscribeToEvents()\r\n            } else {\r\n                this._unsubscribes()\r\n            }\r\n        }\r\n    },\r\n    isResizing: function() {\r\n        return this._isResizing\r\n    },\r\n    init: function() {\r\n        this._subscribesToCallbacks = [];\r\n        if (allowResizing(this)) {\r\n            this._init()\r\n        }\r\n    },\r\n    pointsByColumns: function(value) {\r\n        if (void 0 !== value) {\r\n            this._pointsByColumns = value\r\n        } else {\r\n            if (!this._pointsByColumns) {\r\n                this._generatePointsByColumns()\r\n            }\r\n            return this._pointsByColumns\r\n        }\r\n    },\r\n    dispose: function() {\r\n        this._unsubscribes();\r\n        this.callBase()\r\n    }\r\n});\r\nvar TablePositionViewController = _uiGrid_core2.default.ViewController.inherit({\r\n    update: function(top) {\r\n        var that = this;\r\n        var params = {};\r\n        var $element = that._columnHeadersView.element();\r\n        var offset = $element && $element.offset();\r\n        var offsetTop = offset && offset.top || 0;\r\n        var diffOffsetTop = _type2.default.isDefined(top) ? Math.abs(top - offsetTop) : 0;\r\n        var columnsHeadersHeight = that._columnHeadersView ? that._columnHeadersView.getHeight() : 0;\r\n        var scrollBarWidth = that._rowsView.getScrollbarWidth(true);\r\n        var rowsHeight = that._rowsView ? that._rowsView.height() - scrollBarWidth : 0;\r\n        var columnsResizerController = that.component.getController(\"columnsResizer\");\r\n        params.height = columnsHeadersHeight;\r\n        if (false !== columnsResizerController.isResizing()) {\r\n            params.height += rowsHeight - diffOffsetTop\r\n        }\r\n        if (null !== top && $element && $element.length) {\r\n            params.top = $element[0].offsetTop + diffOffsetTop\r\n        }\r\n        that.positionChanged.fire(params)\r\n    },\r\n    init: function() {\r\n        var that = this;\r\n        that.callBase();\r\n        that._columnHeadersView = this.getView(\"columnHeadersView\");\r\n        that._rowsView = this.getView(\"rowsView\");\r\n        that._pagerView = this.getView(\"pagerView\");\r\n        that._rowsView.resizeCompleted.add(function() {\r\n            if (that.option(\"allowColumnResizing\")) {\r\n                that.update(null)\r\n            }\r\n        })\r\n    },\r\n    ctor: function(component) {\r\n        this.callBase(component);\r\n        this.positionChanged = (0, _callbacks2.default)()\r\n    }\r\n});\r\nvar DraggingHeaderViewController = _uiGrid_core2.default.ViewController.inherit({\r\n    _generatePointsByColumns: function(options) {\r\n        var that = this;\r\n        return _uiGrid_core4.default.getPointsByColumns(options.columnElements, function(point) {\r\n            return that._pointCreated(point, options.columns, options.targetDraggingPanel.getName(), options.sourceColumn)\r\n        }, options.isVerticalOrientation, options.startColumnIndex)\r\n    },\r\n    _pointCreated: function(point, columns, location, sourceColumn) {\r\n        var targetColumn = columns[point.columnIndex];\r\n        var prevColumn = columns[point.columnIndex - 1];\r\n        switch (location) {\r\n            case \"columnChooser\":\r\n                return true;\r\n            case \"headers\":\r\n                return sourceColumn && !sourceColumn.allowReordering || (!targetColumn || !targetColumn.allowReordering) && (!prevColumn || !prevColumn.allowReordering);\r\n            default:\r\n                return 0 === columns.length\r\n        }\r\n    },\r\n    _subscribeToEvents: function(draggingHeader, draggingPanels) {\r\n        var that = this;\r\n        (0, _iterator.each)(draggingPanels, function(_, draggingPanel) {\r\n            if (draggingPanel) {\r\n                var i;\r\n                var columns;\r\n                var columnElements;\r\n                var rowCount = draggingPanel.getRowCount ? draggingPanel.getRowCount() : 1;\r\n                var nameDraggingPanel = draggingPanel.getName();\r\n                var subscribeToEvents = function(index, columnElement) {\r\n                    if (!columnElement) {\r\n                        return\r\n                    }\r\n                    var $columnElement = (0, _renderer2.default)(columnElement);\r\n                    var column = columns[index];\r\n                    if (draggingPanel.allowDragging(column, nameDraggingPanel, draggingPanels)) {\r\n                        $columnElement.addClass(that.addWidgetPrefix(HEADERS_DRAG_ACTION_CLASS));\r\n                        _events_engine2.default.on($columnElement, (0, _utils.addNamespace)(_drag2.default.start, MODULE_NAMESPACE), that.createAction(function(args) {\r\n                            var e = args.event;\r\n                            var eventData = (0, _utils.eventData)(e);\r\n                            draggingHeader.dragHeader({\r\n                                deltaX: eventData.x - (0, _renderer2.default)(e.currentTarget).offset().left,\r\n                                deltaY: eventData.y - (0, _renderer2.default)(e.currentTarget).offset().top,\r\n                                sourceColumn: column,\r\n                                index: column.index,\r\n                                columnIndex: index,\r\n                                columnElement: $columnElement,\r\n                                sourceLocation: nameDraggingPanel,\r\n                                draggingPanels: draggingPanels,\r\n                                rowIndex: that._columnsController.getRowIndex(column.index, true)\r\n                            })\r\n                        }));\r\n                        _events_engine2.default.on($columnElement, (0, _utils.addNamespace)(_drag2.default.move, MODULE_NAMESPACE), {\r\n                            that: draggingHeader\r\n                        }, that.createAction(draggingHeader.moveHeader));\r\n                        _events_engine2.default.on($columnElement, (0, _utils.addNamespace)(_drag2.default.end, MODULE_NAMESPACE), {\r\n                            that: draggingHeader\r\n                        }, that.createAction(draggingHeader.dropHeader))\r\n                    }\r\n                };\r\n                for (i = 0; i < rowCount; i++) {\r\n                    columnElements = draggingPanel.getColumnElements(i) || [];\r\n                    if (columnElements.length) {\r\n                        columns = draggingPanel.getColumns(i) || [];\r\n                        (0, _iterator.each)(columnElements, subscribeToEvents)\r\n                    }\r\n                }\r\n            }\r\n        })\r\n    },\r\n    _unsubscribeFromEvents: function(draggingHeader, draggingPanels) {\r\n        var that = this;\r\n        (0, _iterator.each)(draggingPanels, function(_, draggingPanel) {\r\n            if (draggingPanel) {\r\n                var columnElements = draggingPanel.getColumnElements() || [];\r\n                (0, _iterator.each)(columnElements, function(index, columnElement) {\r\n                    var $columnElement = (0, _renderer2.default)(columnElement);\r\n                    _events_engine2.default.off($columnElement, (0, _utils.addNamespace)(_drag2.default.start, MODULE_NAMESPACE));\r\n                    _events_engine2.default.off($columnElement, (0, _utils.addNamespace)(_drag2.default.move, MODULE_NAMESPACE));\r\n                    _events_engine2.default.off($columnElement, (0, _utils.addNamespace)(_drag2.default.end, MODULE_NAMESPACE));\r\n                    $columnElement.removeClass(that.addWidgetPrefix(HEADERS_DRAG_ACTION_CLASS))\r\n                })\r\n            }\r\n        })\r\n    },\r\n    _getSeparator: function(targetLocation) {\r\n        return \"headers\" === targetLocation ? this._columnsSeparatorView : this._blockSeparatorView\r\n    },\r\n    hideSeparators: function(type) {\r\n        var blockSeparator = this._blockSeparatorView;\r\n        var columnsSeparator = this._columnsSeparatorView;\r\n        this._animationColumnIndex = null;\r\n        blockSeparator && blockSeparator.hide();\r\n        \"block\" !== type && columnsSeparator && columnsSeparator.hide()\r\n    },\r\n    init: function() {\r\n        var that = this;\r\n        var subscribeToEvents;\r\n        that.callBase();\r\n        that._columnsController = that.getController(\"columns\");\r\n        that._columnHeadersView = that.getView(\"columnHeadersView\");\r\n        that._columnsSeparatorView = that.getView(\"columnsSeparatorView\");\r\n        that._draggingHeaderView = that.getView(\"draggingHeaderView\");\r\n        that._rowsView = that.getView(\"rowsView\");\r\n        that._blockSeparatorView = that.getView(\"blockSeparatorView\");\r\n        that._headerPanelView = that.getView(\"headerPanel\");\r\n        that._columnChooserView = that.getView(\"columnChooserView\");\r\n        subscribeToEvents = function() {\r\n            if (that._draggingHeaderView) {\r\n                var draggingPanels = [that._columnChooserView, that._columnHeadersView, that._headerPanelView];\r\n                that._unsubscribeFromEvents(that._draggingHeaderView, draggingPanels);\r\n                that._subscribeToEvents(that._draggingHeaderView, draggingPanels)\r\n            }\r\n        };\r\n        that._columnHeadersView.renderCompleted.add(subscribeToEvents);\r\n        that._headerPanelView && that._headerPanelView.renderCompleted.add(subscribeToEvents);\r\n        that._columnChooserView && that._columnChooserView.renderCompleted.add(subscribeToEvents)\r\n    },\r\n    allowDrop: function(parameters) {\r\n        return this._columnsController.allowMoveColumn(parameters.sourceColumnIndex, parameters.targetColumnIndex, parameters.sourceLocation, parameters.targetLocation)\r\n    },\r\n    drag: function(parameters) {\r\n        var sourceIndex = parameters.sourceIndex;\r\n        var sourceLocation = parameters.sourceLocation;\r\n        var sourceColumnElement = parameters.sourceColumnElement;\r\n        var headersView = this._columnHeadersView;\r\n        var rowsView = this._rowsView;\r\n        if (sourceColumnElement) {\r\n            sourceColumnElement.css({\r\n                opacity: COLUMN_OPACITY\r\n            });\r\n            if (\"headers\" === sourceLocation) {\r\n                headersView && headersView.setRowsOpacity(sourceIndex, COLUMN_OPACITY);\r\n                rowsView && rowsView.setRowsOpacity(sourceIndex, COLUMN_OPACITY)\r\n            }\r\n        }\r\n    },\r\n    dock: function(parameters) {\r\n        var that = this;\r\n        var targetColumnIndex = _type2.default.isObject(parameters.targetColumnIndex) ? parameters.targetColumnIndex.columnIndex : parameters.targetColumnIndex;\r\n        var sourceLocation = parameters.sourceLocation;\r\n        var targetLocation = parameters.targetLocation;\r\n        var separator = that._getSeparator(targetLocation);\r\n        var hasTargetVisibleIndex = targetColumnIndex >= 0;\r\n        var showSeparator = function() {\r\n            if (that._animationColumnIndex !== targetColumnIndex) {\r\n                that.hideSeparators();\r\n                separator.element()[parameters.isLast ? \"insertAfter\" : \"insertBefore\"](parameters.targetColumnElement);\r\n                that._animationColumnIndex = targetColumnIndex;\r\n                separator.show(targetLocation)\r\n            }\r\n        };\r\n        that._columnHeadersView.element().find(\".\" + HEADER_ROW_CLASS).toggleClass(that.addWidgetPrefix(HEADERS_DROP_HIGHLIGHT_CLASS), \"headers\" !== sourceLocation && \"headers\" === targetLocation && !hasTargetVisibleIndex);\r\n        if (separator) {\r\n            if (that.allowDrop(parameters) && hasTargetVisibleIndex) {\r\n                if (\"group\" === targetLocation || \"columnChooser\" === targetLocation) {\r\n                    showSeparator()\r\n                } else {\r\n                    that.hideSeparators(\"block\");\r\n                    that.getController(\"tablePosition\").update(parameters.posY);\r\n                    separator.moveByX(parameters.posX - separator.width());\r\n                    separator.show()\r\n                }\r\n            } else {\r\n                that.hideSeparators()\r\n            }\r\n        }\r\n    },\r\n    drop: function(parameters) {\r\n        var sourceColumnElement = parameters.sourceColumnElement;\r\n        if (sourceColumnElement) {\r\n            sourceColumnElement.css({\r\n                opacity: \"\"\r\n            });\r\n            this._columnHeadersView.setRowsOpacity(parameters.sourceIndex, \"\");\r\n            this._rowsView.setRowsOpacity(parameters.sourceIndex, \"\");\r\n            this._columnHeadersView.element().find(\".\" + HEADER_ROW_CLASS).removeClass(this.addWidgetPrefix(HEADERS_DROP_HIGHLIGHT_CLASS))\r\n        }\r\n        if (this.allowDrop(parameters)) {\r\n            var separator = this._getSeparator(parameters.targetLocation);\r\n            if (separator) {\r\n                separator.hide()\r\n            }\r\n            this._columnsController.moveColumn(parameters.sourceColumnIndex, parameters.targetColumnIndex, parameters.sourceLocation, parameters.targetLocation)\r\n        }\r\n    },\r\n    dispose: function() {\r\n        if (this._draggingHeaderView) {\r\n            this._unsubscribeFromEvents(this._draggingHeaderView, [this._columnChooserView, this._columnHeadersView, this._headerPanelView])\r\n        }\r\n    }\r\n});\r\nmodule.exports = {\r\n    views: {\r\n        columnsSeparatorView: ColumnsSeparatorView,\r\n        blockSeparatorView: BlockSeparatorView,\r\n        draggingHeaderView: DraggingHeaderView,\r\n        trackerView: TrackerView\r\n    },\r\n    controllers: {\r\n        draggingHeader: DraggingHeaderViewController,\r\n        tablePosition: TablePositionViewController,\r\n        columnsResizer: ColumnsResizerViewController\r\n    },\r\n    extenders: {\r\n        views: {\r\n            rowsView: {\r\n                _needUpdateRowHeight: function(itemCount) {\r\n                    var wordWrapEnabled = this.option(\"wordWrapEnabled\");\r\n                    var columnsResizerController = this.getController(\"columnsResizer\");\r\n                    var isResizing = columnsResizerController.isResizing();\r\n                    return this.callBase.apply(this, arguments) || itemCount > 0 && wordWrapEnabled && isResizing\r\n                }\r\n            }\r\n        }\r\n    }\r\n};\r\n"]},"metadata":{},"sourceType":"module"}