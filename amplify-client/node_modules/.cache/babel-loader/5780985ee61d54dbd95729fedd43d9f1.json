{"ast":null,"code":"/**\r\n * DevExtreme (ui/tag_box.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar _renderer = require(\"../core/renderer\");\n\nvar _renderer2 = _interopRequireDefault(_renderer);\n\nvar _devices = require(\"../core/devices\");\n\nvar _devices2 = _interopRequireDefault(_devices);\n\nvar _element_data = require(\"../core/element_data\");\n\nvar _element_data2 = _interopRequireDefault(_element_data);\n\nvar _events_engine = require(\"../events/core/events_engine\");\n\nvar _events_engine2 = _interopRequireDefault(_events_engine);\n\nvar _component_registrator = require(\"../core/component_registrator\");\n\nvar _component_registrator2 = _interopRequireDefault(_component_registrator);\n\nvar _browser = require(\"../core/utils/browser\");\n\nvar _browser2 = _interopRequireDefault(_browser);\n\nvar _common = require(\"../core/utils/common\");\n\nvar _selection_filter = require(\"../core/utils/selection_filter\");\n\nvar _deferred = require(\"../core/utils/deferred\");\n\nvar _dom = require(\"../core/utils/dom\");\n\nvar _type = require(\"../core/utils/type\");\n\nvar _window = require(\"../core/utils/window\");\n\nvar _extend = require(\"../core/utils/extend\");\n\nvar _array = require(\"../core/utils/array\");\n\nvar _iterator = require(\"../core/utils/iterator\");\n\nvar _message = require(\"../localization/message\");\n\nvar _message2 = _interopRequireDefault(_message);\n\nvar _utils = require(\"../events/utils\");\n\nvar _click = require(\"../events/click\");\n\nvar _utils2 = require(\"./text_box/utils.caret\");\n\nvar _utils3 = _interopRequireDefault(_utils2);\n\nvar _data_source = require(\"../data/data_source/data_source\");\n\nvar _select_box = require(\"./select_box\");\n\nvar _select_box2 = _interopRequireDefault(_select_box);\n\nvar _bindable_template = require(\"../core/templates/bindable_template\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nfunction _typeof(obj) {\n  if (\"function\" === typeof Symbol && \"symbol\" === typeof Symbol.iterator) {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && \"function\" === typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nvar TAGBOX_TAG_DATA_KEY = \"dxTagData\";\nvar TAGBOX_CLASS = \"dx-tagbox\";\nvar TAGBOX_TAG_CONTAINER_CLASS = \"dx-tag-container\";\nvar TAGBOX_TAG_CLASS = \"dx-tag\";\nvar TAGBOX_MULTI_TAG_CLASS = \"dx-tagbox-multi-tag\";\nvar TAGBOX_CUSTOM_TAG_CLASS = \"dx-tag-custom\";\nvar TAGBOX_TAG_REMOVE_BUTTON_CLASS = \"dx-tag-remove-button\";\nvar TAGBOX_ONLY_SELECT_CLASS = \"dx-tagbox-only-select\";\nvar TAGBOX_SINGLE_LINE_CLASS = \"dx-tagbox-single-line\";\nvar TAGBOX_POPUP_WRAPPER_CLASS = \"dx-tagbox-popup-wrapper\";\nvar TAGBOX_TAG_CONTENT_CLASS = \"dx-tag-content\";\nvar TAGBOX_DEFAULT_FIELD_TEMPLATE_CLASS = \"dx-tagbox-default-template\";\nvar TAGBOX_CUSTOM_FIELD_TEMPLATE_CLASS = \"dx-tagbox-custom-template\";\nvar NATIVE_CLICK_CLASS = \"dx-native-click\";\nvar TAGBOX_MOUSE_WHEEL_DELTA_MULTIPLIER = -.3;\n\nvar TagBox = _select_box2.default.inherit({\n  _supportedKeys: function _supportedKeys() {\n    var _this = this,\n        _arguments = arguments;\n\n    var parent = this.callBase();\n\n    var sendToList = function sendToList(e) {\n      return _this._list._keyboardProcessor.process(e);\n    };\n\n    return (0, _extend.extend)({}, parent, {\n      backspace: function backspace(e) {\n        if (!this._isCaretAtTheStart()) {\n          return;\n        }\n\n        e.preventDefault();\n        e.stopPropagation();\n        this._isTagRemoved = true;\n\n        var $tagToDelete = this._$focusedTag || this._tagElements().last();\n\n        if (this._$focusedTag) {\n          this._moveTagFocus(\"prev\", true);\n        }\n\n        if (0 === $tagToDelete.length) {\n          return;\n        }\n\n        this._preserveFocusedTag = true;\n\n        this._removeTagElement($tagToDelete);\n\n        delete this._preserveFocusedTag;\n      },\n      upArrow: function upArrow(e) {\n        var handler = e.altKey || !_this._list ? parent.upArrow : sendToList;\n        return handler.apply(_this, _arguments);\n      },\n      downArrow: function downArrow(e) {\n        var handler = e.altKey || !_this._list ? parent.downArrow : sendToList;\n        return handler.apply(_this, _arguments);\n      },\n      del: function del(e) {\n        if (!this._$focusedTag || !this._isCaretAtTheStart()) {\n          return;\n        }\n\n        e.preventDefault();\n        e.stopPropagation();\n        this._isTagRemoved = true;\n        var $tagToDelete = this._$focusedTag;\n\n        this._moveTagFocus(\"next\", true);\n\n        this._preserveFocusedTag = true;\n\n        this._removeTagElement($tagToDelete);\n\n        delete this._preserveFocusedTag;\n      },\n      enter: function enter(e) {\n        var isListItemFocused = this._list && null !== this._list.option(\"focusedElement\");\n\n        var isCustomItem = this.option(\"acceptCustomValue\") && !isListItemFocused;\n\n        if (isCustomItem) {\n          e.preventDefault();\n          \"\" !== this._searchValue() && this._customItemAddedHandler(e);\n          return;\n        }\n\n        if (this.option(\"opened\")) {\n          sendToList(e);\n          e.preventDefault();\n        }\n      },\n      space: function space(e) {\n        var isOpened = this.option(\"opened\");\n\n        var isInputActive = this._shouldRenderSearchEvent();\n\n        if (isOpened && !isInputActive) {\n          sendToList(e);\n          e.preventDefault();\n        }\n      },\n      leftArrow: function leftArrow(e) {\n        if (!this._isCaretAtTheStart()) {\n          return;\n        }\n\n        var rtlEnabled = this.option(\"rtlEnabled\");\n\n        if (this._isEditable() && rtlEnabled && !this._$focusedTag) {\n          return;\n        }\n\n        e.preventDefault();\n        var direction = rtlEnabled ? \"next\" : \"prev\";\n\n        this._moveTagFocus(direction);\n\n        !this.option(\"multiline\") && this._scrollContainer(direction);\n      },\n      rightArrow: function rightArrow(e) {\n        if (!this._isCaretAtTheStart()) {\n          return;\n        }\n\n        var rtlEnabled = this.option(\"rtlEnabled\");\n\n        if (this._isEditable() && !rtlEnabled && !this._$focusedTag) {\n          return;\n        }\n\n        e.preventDefault();\n        var direction = rtlEnabled ? \"prev\" : \"next\";\n\n        this._moveTagFocus(direction);\n\n        !this.option(\"multiline\") && this._scrollContainer(direction);\n      }\n    });\n  },\n  _allowSelectItemByTab: function _allowSelectItemByTab() {\n    return false;\n  },\n  _isCaretAtTheStart: function _isCaretAtTheStart() {\n    var position = (0, _utils3.default)(this._input());\n    return 0 === position.start && 0 === position.end;\n  },\n  _moveTagFocus: function _moveTagFocus(direction, clearOnBoundary) {\n    if (!this._$focusedTag) {\n      var tagElements = this._tagElements();\n\n      this._$focusedTag = \"next\" === direction ? tagElements.first() : tagElements.last();\n\n      this._toggleFocusClass(true, this._$focusedTag);\n\n      return;\n    }\n\n    var $nextFocusedTag = this._$focusedTag[direction](\".\".concat(TAGBOX_TAG_CLASS));\n\n    if ($nextFocusedTag.length > 0) {\n      this._replaceFocusedTag($nextFocusedTag);\n    } else {\n      if (clearOnBoundary || \"next\" === direction && this._isEditable()) {\n        this._clearTagFocus();\n      }\n    }\n  },\n  _replaceFocusedTag: function _replaceFocusedTag($nextFocusedTag) {\n    this._toggleFocusClass(false, this._$focusedTag);\n\n    this._$focusedTag = $nextFocusedTag;\n\n    this._toggleFocusClass(true, this._$focusedTag);\n  },\n  _clearTagFocus: function _clearTagFocus() {\n    if (!this._$focusedTag) {\n      return;\n    }\n\n    this._toggleFocusClass(false, this._$focusedTag);\n\n    delete this._$focusedTag;\n  },\n  _focusClassTarget: function _focusClassTarget($element) {\n    if ($element && $element.length && $element[0] !== this._focusTarget()[0]) {\n      return $element;\n    }\n\n    return this.callBase();\n  },\n  _scrollContainer: function _scrollContainer(direction) {\n    if (this.option(\"multiline\") || !(0, _window.hasWindow)()) {\n      return;\n    }\n\n    if (!this._$tagsContainer) {\n      return;\n    }\n\n    var scrollPosition = this._getScrollPosition(direction);\n\n    this._$tagsContainer.scrollLeft(scrollPosition);\n  },\n  _getScrollPosition: function _getScrollPosition(direction) {\n    if (\"start\" === direction || \"end\" === direction) {\n      return this._getBorderPosition(direction);\n    }\n\n    return this._$focusedTag ? this._getFocusedTagPosition(direction) : this._getBorderPosition(\"end\");\n  },\n  _getBorderPosition: function _getBorderPosition(direction) {\n    var rtlEnabled = this.option(\"rtlEnabled\");\n    var isScrollLeft = \"end\" === direction ^ rtlEnabled;\n    var isScrollReverted = rtlEnabled && !_browser2.default.webkit;\n    var scrollSign = !rtlEnabled || _browser2.default.webkit || _browser2.default.msie ? 1 : -1;\n    return isScrollLeft ^ !isScrollReverted ? 0 : scrollSign * (this._$tagsContainer.get(0).scrollWidth - this._$tagsContainer.outerWidth());\n  },\n  _getFocusedTagPosition: function _getFocusedTagPosition(direction) {\n    var rtlEnabled = this.option(\"rtlEnabled\");\n    var isScrollLeft = \"next\" === direction ^ rtlEnabled;\n\n    var _this$_$focusedTag$po = this._$focusedTag.position(),\n        scrollOffset = _this$_$focusedTag$po.left;\n\n    var scrollLeft = this._$tagsContainer.scrollLeft();\n\n    if (isScrollLeft) {\n      scrollOffset += this._$focusedTag.outerWidth(true) - this._$tagsContainer.outerWidth();\n    }\n\n    if (isScrollLeft ^ scrollOffset < 0) {\n      var scrollCorrection = rtlEnabled && _browser2.default.msie ? -1 : 1;\n      scrollLeft += scrollOffset * scrollCorrection;\n    }\n\n    return scrollLeft;\n  },\n  _setNextValue: _common.noop,\n  _getDefaultOptions: function _getDefaultOptions() {\n    return (0, _extend.extend)(this.callBase(), {\n      value: [],\n      showDropDownButton: false,\n      maxFilterLength: 1500,\n      tagTemplate: \"tag\",\n      selectAllText: _message2.default.format(\"dxList-selectAll\"),\n      hideSelectedItems: false,\n      selectedItems: [],\n      selectAllMode: \"page\",\n      onSelectAllValueChanged: null,\n      maxDisplayedTags: void 0,\n      showMultiTagOnly: true,\n      onMultiTagPreparing: null,\n      multiline: true,\n      useSubmitBehavior: true\n    });\n  },\n  _init: function _init() {\n    this.callBase();\n    this._selectedItems = [];\n\n    this._initSelectAllValueChangedAction();\n  },\n  _initActions: function _initActions() {\n    this.callBase();\n\n    this._initMultiTagPreparingAction();\n  },\n  _initMultiTagPreparingAction: function _initMultiTagPreparingAction() {\n    this._multiTagPreparingAction = this._createActionByOption(\"onMultiTagPreparing\", {\n      beforeExecute: function (e) {\n        this._multiTagPreparingHandler(e.args[0]);\n      }.bind(this),\n      excludeValidators: [\"disabled\", \"readOnly\"]\n    });\n  },\n  _multiTagPreparingHandler: function _multiTagPreparingHandler(args) {\n    var _this$_getValue = this._getValue(),\n        selectedCount = _this$_getValue.length;\n\n    if (!this.option(\"showMultiTagOnly\")) {\n      args.text = _message2.default.getFormatter(\"dxTagBox-moreSelected\")(selectedCount - this.option(\"maxDisplayedTags\") + 1);\n    } else {\n      args.text = _message2.default.getFormatter(\"dxTagBox-selected\")(selectedCount);\n    }\n  },\n  _initDynamicTemplates: function _initDynamicTemplates() {\n    this.callBase();\n    this._defaultTemplates.tag = new _bindable_template.BindableTemplate(function ($container, data) {\n      var $tagContent = (0, _renderer2.default)(\"<div>\").addClass(TAGBOX_TAG_CONTENT_CLASS);\n      (0, _renderer2.default)(\"<span>\").text(data.text || data).appendTo($tagContent);\n      (0, _renderer2.default)(\"<div>\").addClass(TAGBOX_TAG_REMOVE_BUTTON_CLASS).appendTo($tagContent);\n      $container.append($tagContent);\n    }, [\"text\"], this.option(\"integrationOptions.watchMethod\"), {\n      text: this._displayGetter\n    });\n  },\n  _toggleSubmitElement: function _toggleSubmitElement(enabled) {\n    if (enabled) {\n      this._renderSubmitElement();\n\n      this._setSubmitValue();\n    } else {\n      this._$submitElement && this._$submitElement.remove();\n      delete this._$submitElement;\n    }\n  },\n  _renderSubmitElement: function _renderSubmitElement() {\n    if (!this.option(\"useSubmitBehavior\")) {\n      return;\n    }\n\n    this._$submitElement = (0, _renderer2.default)(\"<select>\").attr(\"multiple\", \"multiple\").css(\"display\", \"none\").appendTo(this.$element());\n  },\n  _setSubmitValue: function _setSubmitValue() {\n    if (!this.option(\"useSubmitBehavior\")) {\n      return;\n    }\n\n    var value = this._getValue();\n\n    var $options = [];\n\n    for (var i = 0, n = value.length; i < n; i++) {\n      var useDisplayText = this._shouldUseDisplayValue(value[i]);\n\n      $options.push((0, _renderer2.default)(\"<option>\").val(useDisplayText ? this._displayGetter(value[i]) : value[i]).attr(\"selected\", \"selected\"));\n    }\n\n    this._getSubmitElement().empty().append($options);\n  },\n  _initMarkup: function _initMarkup() {\n    this._tagElementsCache = (0, _renderer2.default)();\n    var isSingleLineMode = !this.option(\"multiline\");\n    this.$element().addClass(TAGBOX_CLASS).toggleClass(TAGBOX_ONLY_SELECT_CLASS, !(this.option(\"searchEnabled\") || this.option(\"acceptCustomValue\"))).toggleClass(TAGBOX_SINGLE_LINE_CLASS, isSingleLineMode);\n\n    this._initTagTemplate();\n\n    this.callBase();\n  },\n  _render: function _render() {\n    this.callBase();\n\n    this._renderTagRemoveAction();\n\n    this._renderSingleLineScroll();\n\n    this._scrollContainer(\"start\");\n  },\n  _initTagTemplate: function _initTagTemplate() {\n    this._tagTemplate = this._getTemplateByOption(\"tagTemplate\");\n  },\n  _renderField: function _renderField() {\n    var isDefaultFieldTemplate = !(0, _type.isDefined)(this.option(\"fieldTemplate\"));\n    this.$element().toggleClass(TAGBOX_DEFAULT_FIELD_TEMPLATE_CLASS, isDefaultFieldTemplate).toggleClass(TAGBOX_CUSTOM_FIELD_TEMPLATE_CLASS, !isDefaultFieldTemplate);\n    this.callBase();\n  },\n  _renderTagRemoveAction: function _renderTagRemoveAction() {\n    var tagRemoveAction = this._createAction(this._removeTagHandler.bind(this));\n\n    var eventName = (0, _utils.addNamespace)(_click.name, \"dxTagBoxTagRemove\");\n\n    _events_engine2.default.off(this._$tagsContainer, eventName);\n\n    _events_engine2.default.on(this._$tagsContainer, eventName, \".\".concat(TAGBOX_TAG_REMOVE_BUTTON_CLASS), function (event) {\n      tagRemoveAction({\n        event: event\n      });\n    });\n\n    this._renderTypingEvent();\n  },\n  _renderSingleLineScroll: function _renderSingleLineScroll() {\n    var mouseWheelEvent = (0, _utils.addNamespace)(\"dxmousewheel\", this.NAME);\n    var $element = this.$element();\n    var isMultiline = this.option(\"multiline\");\n\n    _events_engine2.default.off($element, mouseWheelEvent);\n\n    if (\"desktop\" !== _devices2.default.real().deviceType) {\n      this._$tagsContainer && this._$tagsContainer.css(\"overflowX\", isMultiline ? \"\" : \"auto\");\n      return;\n    }\n\n    if (isMultiline) {\n      return;\n    }\n\n    _events_engine2.default.on($element, mouseWheelEvent, this._tagContainerMouseWheelHandler.bind(this));\n  },\n  _tagContainerMouseWheelHandler: function _tagContainerMouseWheelHandler(_ref) {\n    var delta = _ref.delta;\n\n    var scrollLeft = this._$tagsContainer.scrollLeft();\n\n    this._$tagsContainer.scrollLeft(scrollLeft + delta * TAGBOX_MOUSE_WHEEL_DELTA_MULTIPLIER);\n\n    return false;\n  },\n  _renderTypingEvent: function _renderTypingEvent() {\n    var _this2 = this;\n\n    _events_engine2.default.on(this._input(), (0, _utils.addNamespace)(\"keydown\", this.NAME), function (e) {\n      var keyName = (0, _utils.normalizeKeyName)(e);\n\n      if (!_this2._isControlKey(keyName) && _this2._isEditable()) {\n        _this2._clearTagFocus();\n      }\n    });\n  },\n  _popupWrapperClass: function _popupWrapperClass() {\n    return this.callBase() + \" \" + TAGBOX_POPUP_WRAPPER_CLASS;\n  },\n  _renderInput: function _renderInput() {\n    this.callBase();\n\n    this._renderPreventBlur(this._inputWrapper());\n  },\n  _renderInputValueImpl: function _renderInputValueImpl() {\n    return this._renderMultiSelect();\n  },\n  _loadInputValue: function _loadInputValue() {\n    return (0, _deferred.when)();\n  },\n  _clearTextValue: function _clearTextValue() {\n    this._input().val(\"\");\n\n    this._toggleEmptinessEventHandler();\n  },\n  _focusInHandler: function _focusInHandler(e) {\n    if (!this._preventNestedFocusEvent(e)) {\n      this._scrollContainer(\"end\");\n    }\n\n    this.callBase(e);\n  },\n  _restoreInputText: function _restoreInputText(saveEditingValue) {\n    if (!saveEditingValue) {\n      this._clearTextValue();\n    }\n  },\n  _focusOutHandler: function _focusOutHandler(e) {\n    if (!this._preventNestedFocusEvent(e)) {\n      this._clearTagFocus();\n\n      this._scrollContainer(\"start\");\n    }\n\n    this.callBase(e);\n  },\n  _getFirstPopupElement: function _getFirstPopupElement() {\n    return this.option(\"showSelectionControls\") ? this._list.$element() : this.callBase();\n  },\n  _initSelectAllValueChangedAction: function _initSelectAllValueChangedAction() {\n    this._selectAllValueChangeAction = this._createActionByOption(\"onSelectAllValueChanged\");\n  },\n  _renderList: function _renderList() {\n    var _this3 = this;\n\n    this.callBase();\n\n    this._setListDataSourceFilter();\n\n    if (this.option(\"showSelectionControls\")) {\n      this._list.registerKeyHandler(\"tab\", function (e) {\n        return _this3._popupElementTabHandler(e);\n      });\n\n      this._list.registerKeyHandler(\"escape\", function (e) {\n        return _this3._popupElementEscHandler(e);\n      });\n    }\n  },\n  _canListHaveFocus: function _canListHaveFocus() {\n    return \"useButtons\" === this.option(\"applyValueMode\");\n  },\n  _listConfig: function _listConfig() {\n    var _this4 = this;\n\n    var selectionMode = this.option(\"showSelectionControls\") ? \"all\" : \"multiple\";\n    return (0, _extend.extend)(this.callBase(), {\n      selectionMode: selectionMode,\n      selectAllText: this.option(\"selectAllText\"),\n      onSelectAllValueChanged: function onSelectAllValueChanged(_ref2) {\n        var value = _ref2.value;\n\n        _this4._selectAllValueChangeAction({\n          value: value\n        });\n      },\n      selectAllMode: this.option(\"selectAllMode\"),\n      selectedItems: this._selectedItems,\n      onFocusedItemChanged: null\n    });\n  },\n  _renderMultiSelect: function _renderMultiSelect() {\n    var _this5 = this;\n\n    var d = new _deferred.Deferred();\n    this._$tagsContainer = this._$textEditorInputContainer.addClass(TAGBOX_TAG_CONTAINER_CLASS).addClass(NATIVE_CLICK_CLASS);\n\n    this._$tagsContainer.parent().addClass(NATIVE_CLICK_CLASS);\n\n    this._renderInputSize();\n\n    this._renderTags().done(function () {\n      _this5._popup && _this5._popup.refreshPosition();\n      d.resolve();\n    }).fail(d.reject);\n\n    return d.promise();\n  },\n  _listItemClickHandler: function _listItemClickHandler(e) {\n    !this.option(\"showSelectionControls\") && this._clearTextValue();\n\n    if (\"useButtons\" === this.option(\"applyValueMode\")) {\n      return;\n    }\n\n    this.callBase(e);\n  },\n  _shouldClearFilter: function _shouldClearFilter() {\n    var shouldClearFilter = this.callBase();\n    var showSelectionControls = this.option(\"showSelectionControls\");\n    return !showSelectionControls && shouldClearFilter;\n  },\n  _renderInputSize: function _renderInputSize() {\n    var $input = this._input();\n\n    var value = $input.val();\n    var isEmptyInput = (0, _type.isString)(value) && value;\n    var cursorWidth = 5;\n    var width = \"\";\n    var size = \"\";\n    var canTypeText = this.option(\"searchEnabled\") || this.option(\"acceptCustomValue\");\n\n    if (isEmptyInput && canTypeText) {\n      var $calculationElement = (0, _dom.createTextElementHiddenCopy)($input, value, {\n        includePaddings: true\n      });\n      $calculationElement.insertAfter($input);\n      width = $calculationElement.outerWidth() + cursorWidth;\n      $calculationElement.remove();\n    } else {\n      if (!value) {\n        size = 1;\n      }\n    }\n\n    $input.css(\"width\", width);\n    $input.attr(\"size\", size);\n  },\n  _renderInputSubstitution: function _renderInputSubstitution() {\n    this.callBase();\n\n    this._renderInputSize();\n  },\n  _getValue: function _getValue() {\n    return this.option(\"value\") || [];\n  },\n  _multiTagRequired: function _multiTagRequired() {\n    var values = this._getValue();\n\n    var maxDisplayedTags = this.option(\"maxDisplayedTags\");\n    return (0, _type.isDefined)(maxDisplayedTags) && values.length > maxDisplayedTags;\n  },\n  _renderMultiTag: function _renderMultiTag($input) {\n    var $tag = (0, _renderer2.default)(\"<div>\").addClass(TAGBOX_TAG_CLASS).addClass(TAGBOX_MULTI_TAG_CLASS);\n    var args = {\n      multiTagElement: (0, _dom.getPublicElement)($tag),\n      selectedItems: this.option(\"selectedItems\")\n    };\n\n    this._multiTagPreparingAction(args);\n\n    if (args.cancel) {\n      return false;\n    }\n\n    $tag.data(TAGBOX_TAG_DATA_KEY, args.text);\n    $tag.insertBefore($input);\n\n    this._tagTemplate.render({\n      model: args.text,\n      container: (0, _dom.getPublicElement)($tag)\n    });\n\n    return $tag;\n  },\n  _getFilteredItems: function _getFilteredItems(values) {\n    var _this6 = this;\n\n    var creator = new _selection_filter.SelectionFilterCreator(values);\n    var selectedItems = this._list && this._list.option(\"selectedItems\") || this.option(\"selectedItems\");\n    var clientFilterFunction = creator.getLocalFilter(this._valueGetter);\n    var filteredItems = selectedItems.filter(clientFilterFunction);\n    var selectedItemsAlreadyLoaded = filteredItems.length === values.length;\n    var d = new _deferred.Deferred();\n\n    if (selectedItemsAlreadyLoaded) {\n      return d.resolve(filteredItems).promise();\n    } else {\n      var dataSource = this._dataSource;\n      var dataSourceFilter = dataSource.filter();\n      var filterExpr = creator.getCombinedFilter(this.option(\"valueExpr\"), dataSourceFilter);\n      var filterLength = encodeURI(JSON.stringify(filterExpr)).length;\n      var filter = filterLength > this.option(\"maxFilterLength\") ? void 0 : filterExpr;\n\n      var _dataSource$loadOptio = dataSource.loadOptions(),\n          customQueryParams = _dataSource$loadOptio.customQueryParams,\n          expand = _dataSource$loadOptio.expand;\n\n      dataSource.store().load({\n        filter: filter,\n        customQueryParams: customQueryParams,\n        expand: expand\n      }).done(function (data, extra) {\n        if (_this6._disposed) {\n          d.reject();\n          return;\n        }\n\n        var _normalizeLoadResult = (0, _data_source.normalizeLoadResult)(data, extra),\n            items = _normalizeLoadResult.data;\n\n        var mappedItems = dataSource._applyMapFunction(items);\n\n        d.resolve(mappedItems.filter(clientFilterFunction));\n      }).fail(d.reject);\n      return d.promise();\n    }\n  },\n  _createTagsData: function _createTagsData(values, filteredItems) {\n    var _this7 = this;\n\n    var items = [];\n    var cache = {};\n\n    var isValueExprSpecified = \"this\" === this._valueGetterExpr();\n\n    var filteredValues = {};\n    filteredItems.forEach(function (filteredItem) {\n      var filteredItemValue = isValueExprSpecified ? JSON.stringify(filteredItem) : _this7._valueGetter(filteredItem);\n      filteredValues[filteredItemValue] = filteredItem;\n    });\n    var loadItemPromises = [];\n    values.forEach(function (value, index) {\n      var currentItem = filteredValues[isValueExprSpecified ? JSON.stringify(value) : value];\n\n      if (isValueExprSpecified && !(0, _type.isDefined)(currentItem)) {\n        loadItemPromises.push(_this7._loadItem(value, cache).always(function (item) {\n          var newItem = _this7._createTagData(items, item, value, index);\n\n          items.splice(index, 0, newItem);\n        }));\n      } else {\n        var newItem = _this7._createTagData(items, currentItem, value, index);\n\n        items.splice(index, 0, newItem);\n      }\n    });\n    var d = new _deferred.Deferred();\n\n    _deferred.when.apply(this, loadItemPromises).always(function () {\n      d.resolve(items);\n    });\n\n    return d.promise();\n  },\n  _createTagData: function _createTagData(items, item, value, valueIndex) {\n    if ((0, _type.isDefined)(item)) {\n      this._selectedItems.push(item);\n\n      return item;\n    } else {\n      var selectedItem = this.option(\"selectedItem\");\n      var customItem = this._valueGetter(selectedItem) === value ? selectedItem : value;\n      return customItem;\n    }\n  },\n  _isGroupedData: function _isGroupedData() {\n    return this.option(\"grouped\") && !this._dataSource.group();\n  },\n  _getItemsByValues: function _getItemsByValues(values) {\n    var resultItems = [];\n    values.forEach(function (value) {\n      var item = this._getItemFromPlain(value);\n\n      if ((0, _type.isDefined)(item)) {\n        resultItems.push(item);\n      }\n    }.bind(this));\n    return resultItems;\n  },\n  _getFilteredGroupedItems: function _getFilteredGroupedItems(values) {\n    var selectedItems = new _deferred.Deferred();\n\n    if (!this._dataSource.items().length) {\n      this._dataSource.load().done(function () {\n        selectedItems.resolve(this._getItemsByValues(values));\n      }.bind(this)).fail(selectedItems.resolve([]));\n    } else {\n      selectedItems.resolve(this._getItemsByValues(values));\n    }\n\n    return selectedItems.promise();\n  },\n  _loadTagsData: function _loadTagsData() {\n    var _this8 = this;\n\n    var values = this._getValue();\n\n    var tagData = new _deferred.Deferred();\n    this._selectedItems = [];\n    var filteredItemsPromise = this._isGroupedData() ? this._getFilteredGroupedItems(values) : this._getFilteredItems(values);\n    filteredItemsPromise.done(function (filteredItems) {\n      var items = _this8._createTagsData(values, filteredItems);\n\n      items.always(function (data) {\n        tagData.resolve(data);\n      });\n    }).fail(tagData.reject.bind(this));\n    return tagData.promise();\n  },\n  _renderTags: function _renderTags() {\n    var _this9 = this;\n\n    var d = new _deferred.Deferred();\n\n    this._loadTagsData().always(function (items) {\n      if (_this9._disposed) {\n        d.reject();\n        return;\n      }\n\n      _this9._renderTagsCore(items);\n\n      _this9._renderEmptyState();\n\n      if (!_this9._preserveFocusedTag) {\n        _this9._clearTagFocus();\n      }\n\n      d.resolve();\n    });\n\n    return d.promise();\n  },\n  _renderTagsCore: function _renderTagsCore(items) {\n    var _this10 = this;\n\n    this._renderField();\n\n    this.option(\"selectedItems\", this._selectedItems.slice());\n\n    this._cleanTags();\n\n    var $multiTag = this._multiTagRequired() && this._renderMultiTag(this._input());\n\n    var showMultiTagOnly = this.option(\"showMultiTagOnly\");\n    var maxDisplayedTags = this.option(\"maxDisplayedTags\");\n    items.forEach(function (item, index) {\n      if ($multiTag && showMultiTagOnly || $multiTag && !showMultiTagOnly && index - maxDisplayedTags >= -1) {\n        return false;\n      }\n\n      _this10._renderTag(item, $multiTag || _this10._input());\n    });\n\n    this._scrollContainer(\"end\");\n\n    this._refreshTagElements();\n  },\n  _cleanTags: function _cleanTags() {\n    if (this._multiTagRequired()) {\n      this._tagElements().remove();\n    } else {\n      var $tags = this._tagElements();\n\n      var values = this._getValue();\n\n      (0, _iterator.each)($tags, function (_, tag) {\n        var $tag = (0, _renderer2.default)(tag);\n        var index = (0, _array.inArray)($tag.data(TAGBOX_TAG_DATA_KEY), values);\n\n        if (index < 0) {\n          $tag.remove();\n        }\n      });\n    }\n  },\n  _renderEmptyState: function _renderEmptyState() {\n    var isEmpty = !(this._getValue().length || this._selectedItems.length || this._searchValue());\n\n    this._toggleEmptiness(isEmpty);\n\n    this._renderDisplayText();\n  },\n  _renderDisplayText: function _renderDisplayText() {\n    this._renderInputSize();\n  },\n  _refreshTagElements: function _refreshTagElements() {\n    this._tagElementsCache = this.$element().find(\".\".concat(TAGBOX_TAG_CLASS));\n  },\n  _tagElements: function _tagElements() {\n    return this._tagElementsCache;\n  },\n  _applyTagTemplate: function _applyTagTemplate(item, $tag) {\n    this._tagTemplate.render({\n      model: item,\n      container: (0, _dom.getPublicElement)($tag)\n    });\n  },\n  _renderTag: function _renderTag(item, $input) {\n    var value = this._valueGetter(item);\n\n    if (!(0, _type.isDefined)(value)) {\n      return;\n    }\n\n    var $tag = this._getTag(value);\n\n    var displayValue = this._displayGetter(item);\n\n    var itemModel = this._getItemModel(item, displayValue);\n\n    if ($tag) {\n      if ((0, _type.isDefined)(displayValue)) {\n        $tag.empty();\n\n        this._applyTagTemplate(itemModel, $tag);\n      }\n\n      $tag.removeClass(TAGBOX_CUSTOM_TAG_CLASS);\n    } else {\n      $tag = this._createTag(value, $input);\n\n      if ((0, _type.isDefined)(item)) {\n        this._applyTagTemplate(itemModel, $tag);\n      } else {\n        $tag.addClass(TAGBOX_CUSTOM_TAG_CLASS);\n\n        this._applyTagTemplate(value, $tag);\n      }\n    }\n  },\n  _getItemModel: function _getItemModel(item, displayValue) {\n    if ((0, _type.isObject)(item) && displayValue) {\n      return item;\n    } else {\n      return (0, _common.ensureDefined)(displayValue, \"\");\n    }\n  },\n  _getTag: function _getTag(value) {\n    var $tags = this._tagElements();\n\n    var tagsLength = $tags.length;\n    var result = false;\n\n    for (var i = 0; i < tagsLength; i++) {\n      var $tag = $tags[i];\n\n      var tagData = _element_data2.default.data($tag, TAGBOX_TAG_DATA_KEY);\n\n      if (value === tagData || (0, _common.equalByValue)(value, tagData)) {\n        result = (0, _renderer2.default)($tag);\n        break;\n      }\n    }\n\n    return result;\n  },\n  _createTag: function _createTag(value, $input) {\n    return (0, _renderer2.default)(\"<div>\").addClass(TAGBOX_TAG_CLASS).data(TAGBOX_TAG_DATA_KEY, value).insertBefore($input);\n  },\n  _toggleEmptinessEventHandler: function _toggleEmptinessEventHandler() {\n    this._toggleEmptiness(!this._getValue().length && !this._searchValue().length);\n  },\n  _customItemAddedHandler: function _customItemAddedHandler(e) {\n    this.callBase(e);\n\n    this._input().val(\"\");\n  },\n  _removeTagHandler: function _removeTagHandler(args) {\n    var e = args.event;\n    e.stopPropagation();\n\n    this._saveValueChangeEvent(e);\n\n    var $tag = (0, _renderer2.default)(e.target).closest(\".\".concat(TAGBOX_TAG_CLASS));\n\n    this._removeTagElement($tag);\n  },\n  _removeTagElement: function _removeTagElement($tag) {\n    if ($tag.hasClass(TAGBOX_MULTI_TAG_CLASS)) {\n      if (!this.option(\"showMultiTagOnly\")) {\n        this.option(\"value\", this._getValue().slice(0, this.option(\"maxDisplayedTags\")));\n      } else {\n        this.reset();\n      }\n\n      return;\n    }\n\n    var itemValue = $tag.data(TAGBOX_TAG_DATA_KEY);\n\n    this._removeTagWithUpdate(itemValue);\n\n    this._refreshTagElements();\n  },\n  _updateField: _common.noop,\n  _removeTagWithUpdate: function _removeTagWithUpdate(itemValue) {\n    var value = this._getValue().slice();\n\n    this._removeTag(value, itemValue);\n\n    this.option(\"value\", value);\n\n    if (0 === value.length) {\n      this._clearTagFocus();\n    }\n  },\n  _getCurrentValue: function _getCurrentValue() {\n    return this._lastValue();\n  },\n  _selectionChangeHandler: function _selectionChangeHandler(e) {\n    var _this11 = this;\n\n    if (\"useButtons\" === this.option(\"applyValueMode\")) {\n      return;\n    }\n\n    var value = this._getValue().slice();\n\n    (0, _iterator.each)(e.removedItems || [], function (_, removedItem) {\n      _this11._removeTag(value, _this11._valueGetter(removedItem));\n    });\n    (0, _iterator.each)(e.addedItems || [], function (_, addedItem) {\n      _this11._addTag(value, _this11._valueGetter(addedItem));\n    });\n\n    this._updateWidgetHeight();\n\n    if (!(0, _common.equalByValue)(this._list.option(\"selectedItemKeys\"), this.option(\"value\"))) {\n      this.option(\"value\", value);\n    }\n  },\n  _removeTag: function _removeTag(value, item) {\n    var index = this._valueIndex(item, value);\n\n    if (index >= 0) {\n      value.splice(index, 1);\n    }\n  },\n  _addTag: function _addTag(value, item) {\n    var index = this._valueIndex(item);\n\n    if (index < 0) {\n      value.push(item);\n    }\n  },\n  _fieldRenderData: function _fieldRenderData() {\n    return this._selectedItems.slice();\n  },\n  _completeSelection: function _completeSelection(value) {\n    if (!this.option(\"showSelectionControls\")) {\n      this._setValue(value);\n    }\n  },\n  _setValue: function _setValue(value) {\n    if (null === value) {\n      return;\n    }\n\n    var useButtons = \"useButtons\" === this.option(\"applyValueMode\");\n\n    var valueIndex = this._valueIndex(value);\n\n    var values = (useButtons ? this._list.option(\"selectedItemKeys\") : this._getValue()).slice();\n\n    if (valueIndex >= 0) {\n      values.splice(valueIndex, 1);\n    } else {\n      values.push(value);\n    }\n\n    if (\"useButtons\" === this.option(\"applyValueMode\")) {\n      this._list.option(\"selectedItemKeys\", values);\n    } else {\n      this.option(\"value\", values);\n    }\n  },\n  _isSelectedValue: function _isSelectedValue(value, cache) {\n    return this._valueIndex(value, null, cache) > -1;\n  },\n  _valueIndex: function _valueIndex(value, values, cache) {\n    var _this12 = this;\n\n    var result = -1;\n\n    if (cache && \"object\" !== _typeof(value)) {\n      if (!cache.indexByValues) {\n        cache.indexByValues = {};\n        values = values || this._getValue();\n        values.forEach(function (value, index) {\n          cache.indexByValues[value] = index;\n        });\n      }\n\n      if (value in cache.indexByValues) {\n        return cache.indexByValues[value];\n      }\n    }\n\n    values = values || this._getValue();\n    (0, _iterator.each)(values, function (index, selectedValue) {\n      if (_this12._isValueEquals(value, selectedValue)) {\n        result = index;\n        return false;\n      }\n    });\n    return result;\n  },\n  _lastValue: function _lastValue() {\n    var values = this._getValue();\n\n    var lastValue = values[values.length - 1];\n    return (0, _type.isDefined)(lastValue) ? lastValue : null;\n  },\n  _valueChangeEventHandler: _common.noop,\n  _shouldRenderSearchEvent: function _shouldRenderSearchEvent() {\n    return this.option(\"searchEnabled\") || this.option(\"acceptCustomValue\");\n  },\n  _searchHandler: function _searchHandler(e) {\n    if (this.option(\"searchEnabled\") && !!e && !this._isTagRemoved) {\n      this.callBase(e);\n    }\n\n    this._updateWidgetHeight();\n\n    delete this._isTagRemoved;\n  },\n  _updateWidgetHeight: function _updateWidgetHeight() {\n    var element = this.$element();\n    var originalHeight = element.height();\n\n    this._renderInputSize();\n\n    var currentHeight = element.height();\n\n    if (this._popup && this.option(\"opened\") && this._isEditable() && currentHeight !== originalHeight) {\n      this._popup.repaint();\n    }\n  },\n  _refreshSelected: function _refreshSelected() {\n    this._list && this._list.option(\"selectedItems\", this._selectedItems);\n  },\n  _resetListDataSourceFilter: function _resetListDataSourceFilter() {\n    var dataSource = this._getDataSource();\n\n    if (!dataSource) {\n      return;\n    }\n\n    delete this._userFilter;\n    dataSource.filter(null);\n    dataSource.reload();\n  },\n  _setListDataSourceFilter: function _setListDataSourceFilter() {\n    if (!this.option(\"hideSelectedItems\") || !this._list) {\n      return;\n    }\n\n    var dataSource = this._getDataSource();\n\n    if (!dataSource) {\n      return;\n    }\n\n    var valueGetterExpr = this._valueGetterExpr();\n\n    if ((0, _type.isString)(valueGetterExpr) && \"this\" !== valueGetterExpr) {\n      var filter = this._dataSourceFilterExpr();\n\n      if (void 0 === this._userFilter) {\n        this._userFilter = dataSource.filter() || null;\n      }\n\n      this._userFilter && filter.push(this._userFilter);\n      filter.length ? dataSource.filter(filter) : dataSource.filter(null);\n    } else {\n      dataSource.filter(this._dataSourceFilterFunction.bind(this));\n    }\n\n    dataSource.load();\n  },\n  _dataSourceFilterExpr: function _dataSourceFilterExpr() {\n    var _this13 = this;\n\n    var filter = [];\n    (0, _iterator.each)(this._getValue(), function (index, value) {\n      filter.push([\"!\", [_this13._valueGetterExpr(), value]]);\n    });\n    return filter;\n  },\n  _dataSourceFilterFunction: function _dataSourceFilterFunction(itemData) {\n    var _this14 = this;\n\n    var itemValue = this._valueGetter(itemData);\n\n    var result = true;\n    (0, _iterator.each)(this._getValue(), function (index, value) {\n      if (_this14._isValueEquals(value, itemValue)) {\n        result = false;\n        return false;\n      }\n    });\n    return result;\n  },\n  _applyButtonHandler: function _applyButtonHandler() {\n    this.option(\"value\", this._getSortedListValues());\n\n    this._clearTextValue();\n\n    this._clearFilter();\n\n    this.callBase();\n  },\n  _getSortedListValues: function _getSortedListValues() {\n    var listValues = this._getListValues();\n\n    var currentValue = this.option(\"value\") || [];\n    var existedItems = listValues.length ? currentValue.filter(function (item) {\n      return listValues.indexOf(item) !== -1;\n    }) : [];\n    var newItems = existedItems.length ? listValues.filter(function (item) {\n      return currentValue.indexOf(item) === -1;\n    }) : listValues;\n    return existedItems.concat(newItems);\n  },\n  _getListValues: function _getListValues() {\n    var _this15 = this;\n\n    if (!this._list) {\n      return [];\n    }\n\n    var selectedItems = this._getPlainItems(this._list.option(\"selectedItems\"));\n\n    var result = [];\n    (0, _iterator.each)(selectedItems, function (index, item) {\n      result[index] = _this15._valueGetter(item);\n    });\n    return result;\n  },\n  _renderOpenedState: function _renderOpenedState() {\n    this.callBase();\n\n    if (\"useButtons\" === this.option(\"applyValueMode\") && !this.option(\"opened\")) {\n      this._refreshSelected();\n    }\n  },\n  reset: function reset() {\n    this._restoreInputText();\n\n    var defaultValue = this._getDefaultOptions().value;\n\n    var currentValue = this.option(\"value\");\n\n    if (defaultValue && 0 === defaultValue.length && currentValue && defaultValue.length === currentValue.length) {\n      return;\n    }\n\n    this.callBase();\n  },\n  _clean: function _clean() {\n    this.callBase();\n    delete this._defaultTagTemplate;\n    delete this._tagTemplate;\n  },\n  _removeDuplicates: function _removeDuplicates(from, what) {\n    var _this16 = this;\n\n    var result = [];\n    (0, _iterator.each)(from, function (_, value) {\n      var filteredItems = what.filter(function (item) {\n        return _this16._valueGetter(value) === _this16._valueGetter(item);\n      });\n\n      if (!filteredItems.length) {\n        result.push(value);\n      }\n    });\n    return result;\n  },\n  _optionChanged: function _optionChanged(args) {\n    switch (args.name) {\n      case \"onSelectAllValueChanged\":\n        this._initSelectAllValueChangedAction();\n\n        break;\n\n      case \"onMultiTagPreparing\":\n        this._initMultiTagPreparingAction();\n\n        this._renderTags();\n\n        break;\n\n      case \"hideSelectedItems\":\n        if (args.value) {\n          this._setListDataSourceFilter();\n        } else {\n          this._resetListDataSourceFilter();\n        }\n\n        break;\n\n      case \"useSubmitBehavior\":\n        this._toggleSubmitElement(args.value);\n\n        break;\n\n      case \"displayExpr\":\n        this.callBase(args);\n\n        this._initTemplates();\n\n        this._invalidate();\n\n        break;\n\n      case \"tagTemplate\":\n        this._initTagTemplate();\n\n        this._invalidate();\n\n        break;\n\n      case \"selectAllText\":\n        this._setListOption(\"selectAllText\", this.option(\"selectAllText\"));\n\n        break;\n\n      case \"value\":\n        this.callBase(args);\n\n        this._setListDataSourceFilter();\n\n        break;\n\n      case \"maxDisplayedTags\":\n      case \"showMultiTagOnly\":\n        this._renderTags();\n\n        break;\n\n      case \"selectAllMode\":\n        this._setListOption(args.name, args.value);\n\n        break;\n\n      case \"selectedItem\":\n        break;\n\n      case \"selectedItems\":\n        this._selectionChangedAction({\n          addedItems: this._removeDuplicates(args.value, args.previousValue),\n          removedItems: this._removeDuplicates(args.previousValue, args.value)\n        });\n\n        break;\n\n      case \"multiline\":\n        this.$element().toggleClass(TAGBOX_SINGLE_LINE_CLASS, !args.value);\n\n        this._renderSingleLineScroll();\n\n        break;\n\n      case \"maxFilterLength\":\n        break;\n\n      default:\n        this.callBase(args);\n    }\n  },\n  _getActualSearchValue: function _getActualSearchValue() {\n    return this.callBase() || this._searchValue();\n  },\n  _popupHidingHandler: function _popupHidingHandler() {\n    this.callBase();\n\n    this._clearFilter();\n  }\n});\n\n(0, _component_registrator2.default)(\"dxTagBox\", TagBox);\nmodule.exports = TagBox;\nmodule.exports.default = module.exports;","map":{"version":3,"sources":["C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/devextreme/ui/tag_box.js"],"names":["_renderer","require","_renderer2","_interopRequireDefault","_devices","_devices2","_element_data","_element_data2","_events_engine","_events_engine2","_component_registrator","_component_registrator2","_browser","_browser2","_common","_selection_filter","_deferred","_dom","_type","_window","_extend","_array","_iterator","_message","_message2","_utils","_click","_utils2","_utils3","_data_source","_select_box","_select_box2","_bindable_template","obj","Symbol","_typeof","TAGBOX_TAG_DATA_KEY","TAGBOX_CLASS","TAGBOX_TAG_CONTAINER_CLASS","TAGBOX_TAG_CLASS","TAGBOX_MULTI_TAG_CLASS","TAGBOX_CUSTOM_TAG_CLASS","TAGBOX_TAG_REMOVE_BUTTON_CLASS","TAGBOX_ONLY_SELECT_CLASS","TAGBOX_SINGLE_LINE_CLASS","TAGBOX_POPUP_WRAPPER_CLASS","TAGBOX_TAG_CONTENT_CLASS","TAGBOX_DEFAULT_FIELD_TEMPLATE_CLASS","TAGBOX_CUSTOM_FIELD_TEMPLATE_CLASS","NATIVE_CLICK_CLASS","TAGBOX_MOUSE_WHEEL_DELTA_MULTIPLIER","TagBox","_supportedKeys","_this","_arguments","parent","sendToList","backspace","e","$tagToDelete","upArrow","handler","downArrow","del","enter","isListItemFocused","isCustomItem","space","isOpened","isInputActive","leftArrow","rtlEnabled","direction","rightArrow","_allowSelectItemByTab","_isCaretAtTheStart","position","_moveTagFocus","tagElements","$nextFocusedTag","clearOnBoundary","_replaceFocusedTag","_clearTagFocus","_focusClassTarget","$element","_scrollContainer","scrollPosition","_getScrollPosition","_getBorderPosition","isScrollLeft","isScrollReverted","scrollSign","_getFocusedTagPosition","_this$_$focusedTag$po","scrollOffset","scrollLeft","scrollCorrection","_setNextValue","_getDefaultOptions","value","showDropDownButton","maxFilterLength","tagTemplate","selectAllText","hideSelectedItems","selectedItems","selectAllMode","onSelectAllValueChanged","maxDisplayedTags","showMultiTagOnly","onMultiTagPreparing","multiline","useSubmitBehavior","_init","_initActions","_initMultiTagPreparingAction","beforeExecute","excludeValidators","_multiTagPreparingHandler","_this$_getValue","selectedCount","args","_initDynamicTemplates","$tagContent","data","$container","text","_displayGetter","_toggleSubmitElement","_renderSubmitElement","_setSubmitValue","$options","i","n","useDisplayText","_initMarkup","isSingleLineMode","_render","_initTagTemplate","_renderField","isDefaultFieldTemplate","_renderTagRemoveAction","tagRemoveAction","eventName","event","_renderSingleLineScroll","mouseWheelEvent","isMultiline","_tagContainerMouseWheelHandler","delta","_ref","_renderTypingEvent","_this2","keyName","_popupWrapperClass","_renderInput","_renderInputValueImpl","_loadInputValue","_clearTextValue","_focusInHandler","_restoreInputText","_focusOutHandler","_getFirstPopupElement","_initSelectAllValueChangedAction","_renderList","_this3","_canListHaveFocus","_listConfig","_this4","selectionMode","_ref2","onFocusedItemChanged","_renderMultiSelect","_this5","d","_listItemClickHandler","_shouldClearFilter","shouldClearFilter","showSelectionControls","_renderInputSize","$input","isEmptyInput","cursorWidth","width","size","canTypeText","$calculationElement","includePaddings","_renderInputSubstitution","_getValue","_multiTagRequired","values","_renderMultiTag","$tag","multiTagElement","model","container","_getFilteredItems","_this6","creator","clientFilterFunction","filteredItems","selectedItemsAlreadyLoaded","dataSource","dataSourceFilter","filterExpr","filterLength","encodeURI","JSON","filter","_dataSource$loadOptio","customQueryParams","expand","_normalizeLoadResult","items","mappedItems","_createTagsData","_this7","cache","isValueExprSpecified","filteredValues","filteredItemValue","loadItemPromises","currentItem","newItem","_createTagData","selectedItem","customItem","_isGroupedData","_getItemsByValues","resultItems","item","_getFilteredGroupedItems","_loadTagsData","_this8","tagData","filteredItemsPromise","_renderTags","_this9","_renderTagsCore","_this10","$multiTag","index","_cleanTags","$tags","_renderEmptyState","isEmpty","_renderDisplayText","_refreshTagElements","_tagElements","_applyTagTemplate","_renderTag","displayValue","itemModel","_getItemModel","_getTag","tagsLength","result","_createTag","_toggleEmptinessEventHandler","_customItemAddedHandler","_removeTagHandler","_removeTagElement","itemValue","_updateField","_removeTagWithUpdate","_getCurrentValue","_selectionChangeHandler","_this11","_removeTag","_addTag","_fieldRenderData","_completeSelection","_setValue","useButtons","valueIndex","_isSelectedValue","_valueIndex","_this12","_lastValue","lastValue","_valueChangeEventHandler","_shouldRenderSearchEvent","_searchHandler","_updateWidgetHeight","element","originalHeight","currentHeight","_refreshSelected","_resetListDataSourceFilter","_setListDataSourceFilter","valueGetterExpr","_dataSourceFilterExpr","_this13","_dataSourceFilterFunction","_this14","_applyButtonHandler","_getSortedListValues","listValues","currentValue","existedItems","newItems","_getListValues","_this15","_renderOpenedState","reset","defaultValue","_clean","_removeDuplicates","_this16","_optionChanged","addedItems","removedItems","_getActualSearchValue","_popupHidingHandler","module"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/tag_box.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar _renderer = require(\"../core/renderer\");\r\nvar _renderer2 = _interopRequireDefault(_renderer);\r\nvar _devices = require(\"../core/devices\");\r\nvar _devices2 = _interopRequireDefault(_devices);\r\nvar _element_data = require(\"../core/element_data\");\r\nvar _element_data2 = _interopRequireDefault(_element_data);\r\nvar _events_engine = require(\"../events/core/events_engine\");\r\nvar _events_engine2 = _interopRequireDefault(_events_engine);\r\nvar _component_registrator = require(\"../core/component_registrator\");\r\nvar _component_registrator2 = _interopRequireDefault(_component_registrator);\r\nvar _browser = require(\"../core/utils/browser\");\r\nvar _browser2 = _interopRequireDefault(_browser);\r\nvar _common = require(\"../core/utils/common\");\r\nvar _selection_filter = require(\"../core/utils/selection_filter\");\r\nvar _deferred = require(\"../core/utils/deferred\");\r\nvar _dom = require(\"../core/utils/dom\");\r\nvar _type = require(\"../core/utils/type\");\r\nvar _window = require(\"../core/utils/window\");\r\nvar _extend = require(\"../core/utils/extend\");\r\nvar _array = require(\"../core/utils/array\");\r\nvar _iterator = require(\"../core/utils/iterator\");\r\nvar _message = require(\"../localization/message\");\r\nvar _message2 = _interopRequireDefault(_message);\r\nvar _utils = require(\"../events/utils\");\r\nvar _click = require(\"../events/click\");\r\nvar _utils2 = require(\"./text_box/utils.caret\");\r\nvar _utils3 = _interopRequireDefault(_utils2);\r\nvar _data_source = require(\"../data/data_source/data_source\");\r\nvar _select_box = require(\"./select_box\");\r\nvar _select_box2 = _interopRequireDefault(_select_box);\r\nvar _bindable_template = require(\"../core/templates/bindable_template\");\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\n\r\nfunction _typeof(obj) {\r\n    if (\"function\" === typeof Symbol && \"symbol\" === typeof Symbol.iterator) {\r\n        _typeof = function(obj) {\r\n            return typeof obj\r\n        }\r\n    } else {\r\n        _typeof = function(obj) {\r\n            return obj && \"function\" === typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj\r\n        }\r\n    }\r\n    return _typeof(obj)\r\n}\r\nvar TAGBOX_TAG_DATA_KEY = \"dxTagData\";\r\nvar TAGBOX_CLASS = \"dx-tagbox\";\r\nvar TAGBOX_TAG_CONTAINER_CLASS = \"dx-tag-container\";\r\nvar TAGBOX_TAG_CLASS = \"dx-tag\";\r\nvar TAGBOX_MULTI_TAG_CLASS = \"dx-tagbox-multi-tag\";\r\nvar TAGBOX_CUSTOM_TAG_CLASS = \"dx-tag-custom\";\r\nvar TAGBOX_TAG_REMOVE_BUTTON_CLASS = \"dx-tag-remove-button\";\r\nvar TAGBOX_ONLY_SELECT_CLASS = \"dx-tagbox-only-select\";\r\nvar TAGBOX_SINGLE_LINE_CLASS = \"dx-tagbox-single-line\";\r\nvar TAGBOX_POPUP_WRAPPER_CLASS = \"dx-tagbox-popup-wrapper\";\r\nvar TAGBOX_TAG_CONTENT_CLASS = \"dx-tag-content\";\r\nvar TAGBOX_DEFAULT_FIELD_TEMPLATE_CLASS = \"dx-tagbox-default-template\";\r\nvar TAGBOX_CUSTOM_FIELD_TEMPLATE_CLASS = \"dx-tagbox-custom-template\";\r\nvar NATIVE_CLICK_CLASS = \"dx-native-click\";\r\nvar TAGBOX_MOUSE_WHEEL_DELTA_MULTIPLIER = -.3;\r\nvar TagBox = _select_box2.default.inherit({\r\n    _supportedKeys: function() {\r\n        var _this = this,\r\n            _arguments = arguments;\r\n        var parent = this.callBase();\r\n        var sendToList = function(e) {\r\n            return _this._list._keyboardProcessor.process(e)\r\n        };\r\n        return (0, _extend.extend)({}, parent, {\r\n            backspace: function(e) {\r\n                if (!this._isCaretAtTheStart()) {\r\n                    return\r\n                }\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n                this._isTagRemoved = true;\r\n                var $tagToDelete = this._$focusedTag || this._tagElements().last();\r\n                if (this._$focusedTag) {\r\n                    this._moveTagFocus(\"prev\", true)\r\n                }\r\n                if (0 === $tagToDelete.length) {\r\n                    return\r\n                }\r\n                this._preserveFocusedTag = true;\r\n                this._removeTagElement($tagToDelete);\r\n                delete this._preserveFocusedTag\r\n            },\r\n            upArrow: function(e) {\r\n                var handler = e.altKey || !_this._list ? parent.upArrow : sendToList;\r\n                return handler.apply(_this, _arguments)\r\n            },\r\n            downArrow: function(e) {\r\n                var handler = e.altKey || !_this._list ? parent.downArrow : sendToList;\r\n                return handler.apply(_this, _arguments)\r\n            },\r\n            del: function(e) {\r\n                if (!this._$focusedTag || !this._isCaretAtTheStart()) {\r\n                    return\r\n                }\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n                this._isTagRemoved = true;\r\n                var $tagToDelete = this._$focusedTag;\r\n                this._moveTagFocus(\"next\", true);\r\n                this._preserveFocusedTag = true;\r\n                this._removeTagElement($tagToDelete);\r\n                delete this._preserveFocusedTag\r\n            },\r\n            enter: function(e) {\r\n                var isListItemFocused = this._list && null !== this._list.option(\"focusedElement\");\r\n                var isCustomItem = this.option(\"acceptCustomValue\") && !isListItemFocused;\r\n                if (isCustomItem) {\r\n                    e.preventDefault();\r\n                    \"\" !== this._searchValue() && this._customItemAddedHandler(e);\r\n                    return\r\n                }\r\n                if (this.option(\"opened\")) {\r\n                    sendToList(e);\r\n                    e.preventDefault()\r\n                }\r\n            },\r\n            space: function(e) {\r\n                var isOpened = this.option(\"opened\");\r\n                var isInputActive = this._shouldRenderSearchEvent();\r\n                if (isOpened && !isInputActive) {\r\n                    sendToList(e);\r\n                    e.preventDefault()\r\n                }\r\n            },\r\n            leftArrow: function(e) {\r\n                if (!this._isCaretAtTheStart()) {\r\n                    return\r\n                }\r\n                var rtlEnabled = this.option(\"rtlEnabled\");\r\n                if (this._isEditable() && rtlEnabled && !this._$focusedTag) {\r\n                    return\r\n                }\r\n                e.preventDefault();\r\n                var direction = rtlEnabled ? \"next\" : \"prev\";\r\n                this._moveTagFocus(direction);\r\n                !this.option(\"multiline\") && this._scrollContainer(direction)\r\n            },\r\n            rightArrow: function(e) {\r\n                if (!this._isCaretAtTheStart()) {\r\n                    return\r\n                }\r\n                var rtlEnabled = this.option(\"rtlEnabled\");\r\n                if (this._isEditable() && !rtlEnabled && !this._$focusedTag) {\r\n                    return\r\n                }\r\n                e.preventDefault();\r\n                var direction = rtlEnabled ? \"prev\" : \"next\";\r\n                this._moveTagFocus(direction);\r\n                !this.option(\"multiline\") && this._scrollContainer(direction)\r\n            }\r\n        })\r\n    },\r\n    _allowSelectItemByTab: function() {\r\n        return false\r\n    },\r\n    _isCaretAtTheStart: function() {\r\n        var position = (0, _utils3.default)(this._input());\r\n        return 0 === position.start && 0 === position.end\r\n    },\r\n    _moveTagFocus: function(direction, clearOnBoundary) {\r\n        if (!this._$focusedTag) {\r\n            var tagElements = this._tagElements();\r\n            this._$focusedTag = \"next\" === direction ? tagElements.first() : tagElements.last();\r\n            this._toggleFocusClass(true, this._$focusedTag);\r\n            return\r\n        }\r\n        var $nextFocusedTag = this._$focusedTag[direction](\".\".concat(TAGBOX_TAG_CLASS));\r\n        if ($nextFocusedTag.length > 0) {\r\n            this._replaceFocusedTag($nextFocusedTag)\r\n        } else {\r\n            if (clearOnBoundary || \"next\" === direction && this._isEditable()) {\r\n                this._clearTagFocus()\r\n            }\r\n        }\r\n    },\r\n    _replaceFocusedTag: function($nextFocusedTag) {\r\n        this._toggleFocusClass(false, this._$focusedTag);\r\n        this._$focusedTag = $nextFocusedTag;\r\n        this._toggleFocusClass(true, this._$focusedTag)\r\n    },\r\n    _clearTagFocus: function() {\r\n        if (!this._$focusedTag) {\r\n            return\r\n        }\r\n        this._toggleFocusClass(false, this._$focusedTag);\r\n        delete this._$focusedTag\r\n    },\r\n    _focusClassTarget: function($element) {\r\n        if ($element && $element.length && $element[0] !== this._focusTarget()[0]) {\r\n            return $element\r\n        }\r\n        return this.callBase()\r\n    },\r\n    _scrollContainer: function(direction) {\r\n        if (this.option(\"multiline\") || !(0, _window.hasWindow)()) {\r\n            return\r\n        }\r\n        if (!this._$tagsContainer) {\r\n            return\r\n        }\r\n        var scrollPosition = this._getScrollPosition(direction);\r\n        this._$tagsContainer.scrollLeft(scrollPosition)\r\n    },\r\n    _getScrollPosition: function(direction) {\r\n        if (\"start\" === direction || \"end\" === direction) {\r\n            return this._getBorderPosition(direction)\r\n        }\r\n        return this._$focusedTag ? this._getFocusedTagPosition(direction) : this._getBorderPosition(\"end\")\r\n    },\r\n    _getBorderPosition: function(direction) {\r\n        var rtlEnabled = this.option(\"rtlEnabled\");\r\n        var isScrollLeft = \"end\" === direction ^ rtlEnabled;\r\n        var isScrollReverted = rtlEnabled && !_browser2.default.webkit;\r\n        var scrollSign = !rtlEnabled || _browser2.default.webkit || _browser2.default.msie ? 1 : -1;\r\n        return isScrollLeft ^ !isScrollReverted ? 0 : scrollSign * (this._$tagsContainer.get(0).scrollWidth - this._$tagsContainer.outerWidth())\r\n    },\r\n    _getFocusedTagPosition: function(direction) {\r\n        var rtlEnabled = this.option(\"rtlEnabled\");\r\n        var isScrollLeft = \"next\" === direction ^ rtlEnabled;\r\n        var _this$_$focusedTag$po = this._$focusedTag.position(),\r\n            scrollOffset = _this$_$focusedTag$po.left;\r\n        var scrollLeft = this._$tagsContainer.scrollLeft();\r\n        if (isScrollLeft) {\r\n            scrollOffset += this._$focusedTag.outerWidth(true) - this._$tagsContainer.outerWidth()\r\n        }\r\n        if (isScrollLeft ^ scrollOffset < 0) {\r\n            var scrollCorrection = rtlEnabled && _browser2.default.msie ? -1 : 1;\r\n            scrollLeft += scrollOffset * scrollCorrection\r\n        }\r\n        return scrollLeft\r\n    },\r\n    _setNextValue: _common.noop,\r\n    _getDefaultOptions: function() {\r\n        return (0, _extend.extend)(this.callBase(), {\r\n            value: [],\r\n            showDropDownButton: false,\r\n            maxFilterLength: 1500,\r\n            tagTemplate: \"tag\",\r\n            selectAllText: _message2.default.format(\"dxList-selectAll\"),\r\n            hideSelectedItems: false,\r\n            selectedItems: [],\r\n            selectAllMode: \"page\",\r\n            onSelectAllValueChanged: null,\r\n            maxDisplayedTags: void 0,\r\n            showMultiTagOnly: true,\r\n            onMultiTagPreparing: null,\r\n            multiline: true,\r\n            useSubmitBehavior: true\r\n        })\r\n    },\r\n    _init: function() {\r\n        this.callBase();\r\n        this._selectedItems = [];\r\n        this._initSelectAllValueChangedAction()\r\n    },\r\n    _initActions: function() {\r\n        this.callBase();\r\n        this._initMultiTagPreparingAction()\r\n    },\r\n    _initMultiTagPreparingAction: function() {\r\n        this._multiTagPreparingAction = this._createActionByOption(\"onMultiTagPreparing\", {\r\n            beforeExecute: function(e) {\r\n                this._multiTagPreparingHandler(e.args[0])\r\n            }.bind(this),\r\n            excludeValidators: [\"disabled\", \"readOnly\"]\r\n        })\r\n    },\r\n    _multiTagPreparingHandler: function(args) {\r\n        var _this$_getValue = this._getValue(),\r\n            selectedCount = _this$_getValue.length;\r\n        if (!this.option(\"showMultiTagOnly\")) {\r\n            args.text = _message2.default.getFormatter(\"dxTagBox-moreSelected\")(selectedCount - this.option(\"maxDisplayedTags\") + 1)\r\n        } else {\r\n            args.text = _message2.default.getFormatter(\"dxTagBox-selected\")(selectedCount)\r\n        }\r\n    },\r\n    _initDynamicTemplates: function() {\r\n        this.callBase();\r\n        this._defaultTemplates.tag = new _bindable_template.BindableTemplate(function($container, data) {\r\n            var $tagContent = (0, _renderer2.default)(\"<div>\").addClass(TAGBOX_TAG_CONTENT_CLASS);\r\n            (0, _renderer2.default)(\"<span>\").text(data.text || data).appendTo($tagContent);\r\n            (0, _renderer2.default)(\"<div>\").addClass(TAGBOX_TAG_REMOVE_BUTTON_CLASS).appendTo($tagContent);\r\n            $container.append($tagContent)\r\n        }, [\"text\"], this.option(\"integrationOptions.watchMethod\"), {\r\n            text: this._displayGetter\r\n        })\r\n    },\r\n    _toggleSubmitElement: function(enabled) {\r\n        if (enabled) {\r\n            this._renderSubmitElement();\r\n            this._setSubmitValue()\r\n        } else {\r\n            this._$submitElement && this._$submitElement.remove();\r\n            delete this._$submitElement\r\n        }\r\n    },\r\n    _renderSubmitElement: function() {\r\n        if (!this.option(\"useSubmitBehavior\")) {\r\n            return\r\n        }\r\n        this._$submitElement = (0, _renderer2.default)(\"<select>\").attr(\"multiple\", \"multiple\").css(\"display\", \"none\").appendTo(this.$element())\r\n    },\r\n    _setSubmitValue: function() {\r\n        if (!this.option(\"useSubmitBehavior\")) {\r\n            return\r\n        }\r\n        var value = this._getValue();\r\n        var $options = [];\r\n        for (var i = 0, n = value.length; i < n; i++) {\r\n            var useDisplayText = this._shouldUseDisplayValue(value[i]);\r\n            $options.push((0, _renderer2.default)(\"<option>\").val(useDisplayText ? this._displayGetter(value[i]) : value[i]).attr(\"selected\", \"selected\"))\r\n        }\r\n        this._getSubmitElement().empty().append($options)\r\n    },\r\n    _initMarkup: function() {\r\n        this._tagElementsCache = (0, _renderer2.default)();\r\n        var isSingleLineMode = !this.option(\"multiline\");\r\n        this.$element().addClass(TAGBOX_CLASS).toggleClass(TAGBOX_ONLY_SELECT_CLASS, !(this.option(\"searchEnabled\") || this.option(\"acceptCustomValue\"))).toggleClass(TAGBOX_SINGLE_LINE_CLASS, isSingleLineMode);\r\n        this._initTagTemplate();\r\n        this.callBase()\r\n    },\r\n    _render: function() {\r\n        this.callBase();\r\n        this._renderTagRemoveAction();\r\n        this._renderSingleLineScroll();\r\n        this._scrollContainer(\"start\")\r\n    },\r\n    _initTagTemplate: function() {\r\n        this._tagTemplate = this._getTemplateByOption(\"tagTemplate\")\r\n    },\r\n    _renderField: function() {\r\n        var isDefaultFieldTemplate = !(0, _type.isDefined)(this.option(\"fieldTemplate\"));\r\n        this.$element().toggleClass(TAGBOX_DEFAULT_FIELD_TEMPLATE_CLASS, isDefaultFieldTemplate).toggleClass(TAGBOX_CUSTOM_FIELD_TEMPLATE_CLASS, !isDefaultFieldTemplate);\r\n        this.callBase()\r\n    },\r\n    _renderTagRemoveAction: function() {\r\n        var tagRemoveAction = this._createAction(this._removeTagHandler.bind(this));\r\n        var eventName = (0, _utils.addNamespace)(_click.name, \"dxTagBoxTagRemove\");\r\n        _events_engine2.default.off(this._$tagsContainer, eventName);\r\n        _events_engine2.default.on(this._$tagsContainer, eventName, \".\".concat(TAGBOX_TAG_REMOVE_BUTTON_CLASS), function(event) {\r\n            tagRemoveAction({\r\n                event: event\r\n            })\r\n        });\r\n        this._renderTypingEvent()\r\n    },\r\n    _renderSingleLineScroll: function() {\r\n        var mouseWheelEvent = (0, _utils.addNamespace)(\"dxmousewheel\", this.NAME);\r\n        var $element = this.$element();\r\n        var isMultiline = this.option(\"multiline\");\r\n        _events_engine2.default.off($element, mouseWheelEvent);\r\n        if (\"desktop\" !== _devices2.default.real().deviceType) {\r\n            this._$tagsContainer && this._$tagsContainer.css(\"overflowX\", isMultiline ? \"\" : \"auto\");\r\n            return\r\n        }\r\n        if (isMultiline) {\r\n            return\r\n        }\r\n        _events_engine2.default.on($element, mouseWheelEvent, this._tagContainerMouseWheelHandler.bind(this))\r\n    },\r\n    _tagContainerMouseWheelHandler: function(_ref) {\r\n        var delta = _ref.delta;\r\n        var scrollLeft = this._$tagsContainer.scrollLeft();\r\n        this._$tagsContainer.scrollLeft(scrollLeft + delta * TAGBOX_MOUSE_WHEEL_DELTA_MULTIPLIER);\r\n        return false\r\n    },\r\n    _renderTypingEvent: function() {\r\n        var _this2 = this;\r\n        _events_engine2.default.on(this._input(), (0, _utils.addNamespace)(\"keydown\", this.NAME), function(e) {\r\n            var keyName = (0, _utils.normalizeKeyName)(e);\r\n            if (!_this2._isControlKey(keyName) && _this2._isEditable()) {\r\n                _this2._clearTagFocus()\r\n            }\r\n        })\r\n    },\r\n    _popupWrapperClass: function() {\r\n        return this.callBase() + \" \" + TAGBOX_POPUP_WRAPPER_CLASS\r\n    },\r\n    _renderInput: function() {\r\n        this.callBase();\r\n        this._renderPreventBlur(this._inputWrapper())\r\n    },\r\n    _renderInputValueImpl: function() {\r\n        return this._renderMultiSelect()\r\n    },\r\n    _loadInputValue: function() {\r\n        return (0, _deferred.when)()\r\n    },\r\n    _clearTextValue: function() {\r\n        this._input().val(\"\");\r\n        this._toggleEmptinessEventHandler()\r\n    },\r\n    _focusInHandler: function(e) {\r\n        if (!this._preventNestedFocusEvent(e)) {\r\n            this._scrollContainer(\"end\")\r\n        }\r\n        this.callBase(e)\r\n    },\r\n    _restoreInputText: function(saveEditingValue) {\r\n        if (!saveEditingValue) {\r\n            this._clearTextValue()\r\n        }\r\n    },\r\n    _focusOutHandler: function(e) {\r\n        if (!this._preventNestedFocusEvent(e)) {\r\n            this._clearTagFocus();\r\n            this._scrollContainer(\"start\")\r\n        }\r\n        this.callBase(e)\r\n    },\r\n    _getFirstPopupElement: function() {\r\n        return this.option(\"showSelectionControls\") ? this._list.$element() : this.callBase()\r\n    },\r\n    _initSelectAllValueChangedAction: function() {\r\n        this._selectAllValueChangeAction = this._createActionByOption(\"onSelectAllValueChanged\")\r\n    },\r\n    _renderList: function() {\r\n        var _this3 = this;\r\n        this.callBase();\r\n        this._setListDataSourceFilter();\r\n        if (this.option(\"showSelectionControls\")) {\r\n            this._list.registerKeyHandler(\"tab\", function(e) {\r\n                return _this3._popupElementTabHandler(e)\r\n            });\r\n            this._list.registerKeyHandler(\"escape\", function(e) {\r\n                return _this3._popupElementEscHandler(e)\r\n            })\r\n        }\r\n    },\r\n    _canListHaveFocus: function() {\r\n        return \"useButtons\" === this.option(\"applyValueMode\")\r\n    },\r\n    _listConfig: function() {\r\n        var _this4 = this;\r\n        var selectionMode = this.option(\"showSelectionControls\") ? \"all\" : \"multiple\";\r\n        return (0, _extend.extend)(this.callBase(), {\r\n            selectionMode: selectionMode,\r\n            selectAllText: this.option(\"selectAllText\"),\r\n            onSelectAllValueChanged: function(_ref2) {\r\n                var value = _ref2.value;\r\n                _this4._selectAllValueChangeAction({\r\n                    value: value\r\n                })\r\n            },\r\n            selectAllMode: this.option(\"selectAllMode\"),\r\n            selectedItems: this._selectedItems,\r\n            onFocusedItemChanged: null\r\n        })\r\n    },\r\n    _renderMultiSelect: function() {\r\n        var _this5 = this;\r\n        var d = new _deferred.Deferred;\r\n        this._$tagsContainer = this._$textEditorInputContainer.addClass(TAGBOX_TAG_CONTAINER_CLASS).addClass(NATIVE_CLICK_CLASS);\r\n        this._$tagsContainer.parent().addClass(NATIVE_CLICK_CLASS);\r\n        this._renderInputSize();\r\n        this._renderTags().done(function() {\r\n            _this5._popup && _this5._popup.refreshPosition();\r\n            d.resolve()\r\n        }).fail(d.reject);\r\n        return d.promise()\r\n    },\r\n    _listItemClickHandler: function(e) {\r\n        !this.option(\"showSelectionControls\") && this._clearTextValue();\r\n        if (\"useButtons\" === this.option(\"applyValueMode\")) {\r\n            return\r\n        }\r\n        this.callBase(e)\r\n    },\r\n    _shouldClearFilter: function() {\r\n        var shouldClearFilter = this.callBase();\r\n        var showSelectionControls = this.option(\"showSelectionControls\");\r\n        return !showSelectionControls && shouldClearFilter\r\n    },\r\n    _renderInputSize: function() {\r\n        var $input = this._input();\r\n        var value = $input.val();\r\n        var isEmptyInput = (0, _type.isString)(value) && value;\r\n        var cursorWidth = 5;\r\n        var width = \"\";\r\n        var size = \"\";\r\n        var canTypeText = this.option(\"searchEnabled\") || this.option(\"acceptCustomValue\");\r\n        if (isEmptyInput && canTypeText) {\r\n            var $calculationElement = (0, _dom.createTextElementHiddenCopy)($input, value, {\r\n                includePaddings: true\r\n            });\r\n            $calculationElement.insertAfter($input);\r\n            width = $calculationElement.outerWidth() + cursorWidth;\r\n            $calculationElement.remove()\r\n        } else {\r\n            if (!value) {\r\n                size = 1\r\n            }\r\n        }\r\n        $input.css(\"width\", width);\r\n        $input.attr(\"size\", size)\r\n    },\r\n    _renderInputSubstitution: function() {\r\n        this.callBase();\r\n        this._renderInputSize()\r\n    },\r\n    _getValue: function() {\r\n        return this.option(\"value\") || []\r\n    },\r\n    _multiTagRequired: function() {\r\n        var values = this._getValue();\r\n        var maxDisplayedTags = this.option(\"maxDisplayedTags\");\r\n        return (0, _type.isDefined)(maxDisplayedTags) && values.length > maxDisplayedTags\r\n    },\r\n    _renderMultiTag: function($input) {\r\n        var $tag = (0, _renderer2.default)(\"<div>\").addClass(TAGBOX_TAG_CLASS).addClass(TAGBOX_MULTI_TAG_CLASS);\r\n        var args = {\r\n            multiTagElement: (0, _dom.getPublicElement)($tag),\r\n            selectedItems: this.option(\"selectedItems\")\r\n        };\r\n        this._multiTagPreparingAction(args);\r\n        if (args.cancel) {\r\n            return false\r\n        }\r\n        $tag.data(TAGBOX_TAG_DATA_KEY, args.text);\r\n        $tag.insertBefore($input);\r\n        this._tagTemplate.render({\r\n            model: args.text,\r\n            container: (0, _dom.getPublicElement)($tag)\r\n        });\r\n        return $tag\r\n    },\r\n    _getFilteredItems: function(values) {\r\n        var _this6 = this;\r\n        var creator = new _selection_filter.SelectionFilterCreator(values);\r\n        var selectedItems = this._list && this._list.option(\"selectedItems\") || this.option(\"selectedItems\");\r\n        var clientFilterFunction = creator.getLocalFilter(this._valueGetter);\r\n        var filteredItems = selectedItems.filter(clientFilterFunction);\r\n        var selectedItemsAlreadyLoaded = filteredItems.length === values.length;\r\n        var d = new _deferred.Deferred;\r\n        if (selectedItemsAlreadyLoaded) {\r\n            return d.resolve(filteredItems).promise()\r\n        } else {\r\n            var dataSource = this._dataSource;\r\n            var dataSourceFilter = dataSource.filter();\r\n            var filterExpr = creator.getCombinedFilter(this.option(\"valueExpr\"), dataSourceFilter);\r\n            var filterLength = encodeURI(JSON.stringify(filterExpr)).length;\r\n            var filter = filterLength > this.option(\"maxFilterLength\") ? void 0 : filterExpr;\r\n            var _dataSource$loadOptio = dataSource.loadOptions(),\r\n                customQueryParams = _dataSource$loadOptio.customQueryParams,\r\n                expand = _dataSource$loadOptio.expand;\r\n            dataSource.store().load({\r\n                filter: filter,\r\n                customQueryParams: customQueryParams,\r\n                expand: expand\r\n            }).done(function(data, extra) {\r\n                if (_this6._disposed) {\r\n                    d.reject();\r\n                    return\r\n                }\r\n                var _normalizeLoadResult = (0, _data_source.normalizeLoadResult)(data, extra),\r\n                    items = _normalizeLoadResult.data;\r\n                var mappedItems = dataSource._applyMapFunction(items);\r\n                d.resolve(mappedItems.filter(clientFilterFunction))\r\n            }).fail(d.reject);\r\n            return d.promise()\r\n        }\r\n    },\r\n    _createTagsData: function(values, filteredItems) {\r\n        var _this7 = this;\r\n        var items = [];\r\n        var cache = {};\r\n        var isValueExprSpecified = \"this\" === this._valueGetterExpr();\r\n        var filteredValues = {};\r\n        filteredItems.forEach(function(filteredItem) {\r\n            var filteredItemValue = isValueExprSpecified ? JSON.stringify(filteredItem) : _this7._valueGetter(filteredItem);\r\n            filteredValues[filteredItemValue] = filteredItem\r\n        });\r\n        var loadItemPromises = [];\r\n        values.forEach(function(value, index) {\r\n            var currentItem = filteredValues[isValueExprSpecified ? JSON.stringify(value) : value];\r\n            if (isValueExprSpecified && !(0, _type.isDefined)(currentItem)) {\r\n                loadItemPromises.push(_this7._loadItem(value, cache).always(function(item) {\r\n                    var newItem = _this7._createTagData(items, item, value, index);\r\n                    items.splice(index, 0, newItem)\r\n                }))\r\n            } else {\r\n                var newItem = _this7._createTagData(items, currentItem, value, index);\r\n                items.splice(index, 0, newItem)\r\n            }\r\n        });\r\n        var d = new _deferred.Deferred;\r\n        _deferred.when.apply(this, loadItemPromises).always(function() {\r\n            d.resolve(items)\r\n        });\r\n        return d.promise()\r\n    },\r\n    _createTagData: function(items, item, value, valueIndex) {\r\n        if ((0, _type.isDefined)(item)) {\r\n            this._selectedItems.push(item);\r\n            return item\r\n        } else {\r\n            var selectedItem = this.option(\"selectedItem\");\r\n            var customItem = this._valueGetter(selectedItem) === value ? selectedItem : value;\r\n            return customItem\r\n        }\r\n    },\r\n    _isGroupedData: function() {\r\n        return this.option(\"grouped\") && !this._dataSource.group()\r\n    },\r\n    _getItemsByValues: function(values) {\r\n        var resultItems = [];\r\n        values.forEach(function(value) {\r\n            var item = this._getItemFromPlain(value);\r\n            if ((0, _type.isDefined)(item)) {\r\n                resultItems.push(item)\r\n            }\r\n        }.bind(this));\r\n        return resultItems\r\n    },\r\n    _getFilteredGroupedItems: function(values) {\r\n        var selectedItems = new _deferred.Deferred;\r\n        if (!this._dataSource.items().length) {\r\n            this._dataSource.load().done(function() {\r\n                selectedItems.resolve(this._getItemsByValues(values))\r\n            }.bind(this)).fail(selectedItems.resolve([]))\r\n        } else {\r\n            selectedItems.resolve(this._getItemsByValues(values))\r\n        }\r\n        return selectedItems.promise()\r\n    },\r\n    _loadTagsData: function() {\r\n        var _this8 = this;\r\n        var values = this._getValue();\r\n        var tagData = new _deferred.Deferred;\r\n        this._selectedItems = [];\r\n        var filteredItemsPromise = this._isGroupedData() ? this._getFilteredGroupedItems(values) : this._getFilteredItems(values);\r\n        filteredItemsPromise.done(function(filteredItems) {\r\n            var items = _this8._createTagsData(values, filteredItems);\r\n            items.always(function(data) {\r\n                tagData.resolve(data)\r\n            })\r\n        }).fail(tagData.reject.bind(this));\r\n        return tagData.promise()\r\n    },\r\n    _renderTags: function() {\r\n        var _this9 = this;\r\n        var d = new _deferred.Deferred;\r\n        this._loadTagsData().always(function(items) {\r\n            if (_this9._disposed) {\r\n                d.reject();\r\n                return\r\n            }\r\n            _this9._renderTagsCore(items);\r\n            _this9._renderEmptyState();\r\n            if (!_this9._preserveFocusedTag) {\r\n                _this9._clearTagFocus()\r\n            }\r\n            d.resolve()\r\n        });\r\n        return d.promise()\r\n    },\r\n    _renderTagsCore: function(items) {\r\n        var _this10 = this;\r\n        this._renderField();\r\n        this.option(\"selectedItems\", this._selectedItems.slice());\r\n        this._cleanTags();\r\n        var $multiTag = this._multiTagRequired() && this._renderMultiTag(this._input());\r\n        var showMultiTagOnly = this.option(\"showMultiTagOnly\");\r\n        var maxDisplayedTags = this.option(\"maxDisplayedTags\");\r\n        items.forEach(function(item, index) {\r\n            if ($multiTag && showMultiTagOnly || $multiTag && !showMultiTagOnly && index - maxDisplayedTags >= -1) {\r\n                return false\r\n            }\r\n            _this10._renderTag(item, $multiTag || _this10._input())\r\n        });\r\n        this._scrollContainer(\"end\");\r\n        this._refreshTagElements()\r\n    },\r\n    _cleanTags: function() {\r\n        if (this._multiTagRequired()) {\r\n            this._tagElements().remove()\r\n        } else {\r\n            var $tags = this._tagElements();\r\n            var values = this._getValue();\r\n            (0, _iterator.each)($tags, function(_, tag) {\r\n                var $tag = (0, _renderer2.default)(tag);\r\n                var index = (0, _array.inArray)($tag.data(TAGBOX_TAG_DATA_KEY), values);\r\n                if (index < 0) {\r\n                    $tag.remove()\r\n                }\r\n            })\r\n        }\r\n    },\r\n    _renderEmptyState: function() {\r\n        var isEmpty = !(this._getValue().length || this._selectedItems.length || this._searchValue());\r\n        this._toggleEmptiness(isEmpty);\r\n        this._renderDisplayText()\r\n    },\r\n    _renderDisplayText: function() {\r\n        this._renderInputSize()\r\n    },\r\n    _refreshTagElements: function() {\r\n        this._tagElementsCache = this.$element().find(\".\".concat(TAGBOX_TAG_CLASS))\r\n    },\r\n    _tagElements: function() {\r\n        return this._tagElementsCache\r\n    },\r\n    _applyTagTemplate: function(item, $tag) {\r\n        this._tagTemplate.render({\r\n            model: item,\r\n            container: (0, _dom.getPublicElement)($tag)\r\n        })\r\n    },\r\n    _renderTag: function(item, $input) {\r\n        var value = this._valueGetter(item);\r\n        if (!(0, _type.isDefined)(value)) {\r\n            return\r\n        }\r\n        var $tag = this._getTag(value);\r\n        var displayValue = this._displayGetter(item);\r\n        var itemModel = this._getItemModel(item, displayValue);\r\n        if ($tag) {\r\n            if ((0, _type.isDefined)(displayValue)) {\r\n                $tag.empty();\r\n                this._applyTagTemplate(itemModel, $tag)\r\n            }\r\n            $tag.removeClass(TAGBOX_CUSTOM_TAG_CLASS)\r\n        } else {\r\n            $tag = this._createTag(value, $input);\r\n            if ((0, _type.isDefined)(item)) {\r\n                this._applyTagTemplate(itemModel, $tag)\r\n            } else {\r\n                $tag.addClass(TAGBOX_CUSTOM_TAG_CLASS);\r\n                this._applyTagTemplate(value, $tag)\r\n            }\r\n        }\r\n    },\r\n    _getItemModel: function(item, displayValue) {\r\n        if ((0, _type.isObject)(item) && displayValue) {\r\n            return item\r\n        } else {\r\n            return (0, _common.ensureDefined)(displayValue, \"\")\r\n        }\r\n    },\r\n    _getTag: function(value) {\r\n        var $tags = this._tagElements();\r\n        var tagsLength = $tags.length;\r\n        var result = false;\r\n        for (var i = 0; i < tagsLength; i++) {\r\n            var $tag = $tags[i];\r\n            var tagData = _element_data2.default.data($tag, TAGBOX_TAG_DATA_KEY);\r\n            if (value === tagData || (0, _common.equalByValue)(value, tagData)) {\r\n                result = (0, _renderer2.default)($tag);\r\n                break\r\n            }\r\n        }\r\n        return result\r\n    },\r\n    _createTag: function(value, $input) {\r\n        return (0, _renderer2.default)(\"<div>\").addClass(TAGBOX_TAG_CLASS).data(TAGBOX_TAG_DATA_KEY, value).insertBefore($input)\r\n    },\r\n    _toggleEmptinessEventHandler: function() {\r\n        this._toggleEmptiness(!this._getValue().length && !this._searchValue().length)\r\n    },\r\n    _customItemAddedHandler: function(e) {\r\n        this.callBase(e);\r\n        this._input().val(\"\")\r\n    },\r\n    _removeTagHandler: function(args) {\r\n        var e = args.event;\r\n        e.stopPropagation();\r\n        this._saveValueChangeEvent(e);\r\n        var $tag = (0, _renderer2.default)(e.target).closest(\".\".concat(TAGBOX_TAG_CLASS));\r\n        this._removeTagElement($tag)\r\n    },\r\n    _removeTagElement: function($tag) {\r\n        if ($tag.hasClass(TAGBOX_MULTI_TAG_CLASS)) {\r\n            if (!this.option(\"showMultiTagOnly\")) {\r\n                this.option(\"value\", this._getValue().slice(0, this.option(\"maxDisplayedTags\")))\r\n            } else {\r\n                this.reset()\r\n            }\r\n            return\r\n        }\r\n        var itemValue = $tag.data(TAGBOX_TAG_DATA_KEY);\r\n        this._removeTagWithUpdate(itemValue);\r\n        this._refreshTagElements()\r\n    },\r\n    _updateField: _common.noop,\r\n    _removeTagWithUpdate: function(itemValue) {\r\n        var value = this._getValue().slice();\r\n        this._removeTag(value, itemValue);\r\n        this.option(\"value\", value);\r\n        if (0 === value.length) {\r\n            this._clearTagFocus()\r\n        }\r\n    },\r\n    _getCurrentValue: function() {\r\n        return this._lastValue()\r\n    },\r\n    _selectionChangeHandler: function(e) {\r\n        var _this11 = this;\r\n        if (\"useButtons\" === this.option(\"applyValueMode\")) {\r\n            return\r\n        }\r\n        var value = this._getValue().slice();\r\n        (0, _iterator.each)(e.removedItems || [], function(_, removedItem) {\r\n            _this11._removeTag(value, _this11._valueGetter(removedItem))\r\n        });\r\n        (0, _iterator.each)(e.addedItems || [], function(_, addedItem) {\r\n            _this11._addTag(value, _this11._valueGetter(addedItem))\r\n        });\r\n        this._updateWidgetHeight();\r\n        if (!(0, _common.equalByValue)(this._list.option(\"selectedItemKeys\"), this.option(\"value\"))) {\r\n            this.option(\"value\", value)\r\n        }\r\n    },\r\n    _removeTag: function(value, item) {\r\n        var index = this._valueIndex(item, value);\r\n        if (index >= 0) {\r\n            value.splice(index, 1)\r\n        }\r\n    },\r\n    _addTag: function(value, item) {\r\n        var index = this._valueIndex(item);\r\n        if (index < 0) {\r\n            value.push(item)\r\n        }\r\n    },\r\n    _fieldRenderData: function() {\r\n        return this._selectedItems.slice()\r\n    },\r\n    _completeSelection: function(value) {\r\n        if (!this.option(\"showSelectionControls\")) {\r\n            this._setValue(value)\r\n        }\r\n    },\r\n    _setValue: function(value) {\r\n        if (null === value) {\r\n            return\r\n        }\r\n        var useButtons = \"useButtons\" === this.option(\"applyValueMode\");\r\n        var valueIndex = this._valueIndex(value);\r\n        var values = (useButtons ? this._list.option(\"selectedItemKeys\") : this._getValue()).slice();\r\n        if (valueIndex >= 0) {\r\n            values.splice(valueIndex, 1)\r\n        } else {\r\n            values.push(value)\r\n        }\r\n        if (\"useButtons\" === this.option(\"applyValueMode\")) {\r\n            this._list.option(\"selectedItemKeys\", values)\r\n        } else {\r\n            this.option(\"value\", values)\r\n        }\r\n    },\r\n    _isSelectedValue: function(value, cache) {\r\n        return this._valueIndex(value, null, cache) > -1\r\n    },\r\n    _valueIndex: function(value, values, cache) {\r\n        var _this12 = this;\r\n        var result = -1;\r\n        if (cache && \"object\" !== _typeof(value)) {\r\n            if (!cache.indexByValues) {\r\n                cache.indexByValues = {};\r\n                values = values || this._getValue();\r\n                values.forEach(function(value, index) {\r\n                    cache.indexByValues[value] = index\r\n                })\r\n            }\r\n            if (value in cache.indexByValues) {\r\n                return cache.indexByValues[value]\r\n            }\r\n        }\r\n        values = values || this._getValue();\r\n        (0, _iterator.each)(values, function(index, selectedValue) {\r\n            if (_this12._isValueEquals(value, selectedValue)) {\r\n                result = index;\r\n                return false\r\n            }\r\n        });\r\n        return result\r\n    },\r\n    _lastValue: function() {\r\n        var values = this._getValue();\r\n        var lastValue = values[values.length - 1];\r\n        return (0, _type.isDefined)(lastValue) ? lastValue : null\r\n    },\r\n    _valueChangeEventHandler: _common.noop,\r\n    _shouldRenderSearchEvent: function() {\r\n        return this.option(\"searchEnabled\") || this.option(\"acceptCustomValue\")\r\n    },\r\n    _searchHandler: function(e) {\r\n        if (this.option(\"searchEnabled\") && !!e && !this._isTagRemoved) {\r\n            this.callBase(e)\r\n        }\r\n        this._updateWidgetHeight();\r\n        delete this._isTagRemoved\r\n    },\r\n    _updateWidgetHeight: function() {\r\n        var element = this.$element();\r\n        var originalHeight = element.height();\r\n        this._renderInputSize();\r\n        var currentHeight = element.height();\r\n        if (this._popup && this.option(\"opened\") && this._isEditable() && currentHeight !== originalHeight) {\r\n            this._popup.repaint()\r\n        }\r\n    },\r\n    _refreshSelected: function() {\r\n        this._list && this._list.option(\"selectedItems\", this._selectedItems)\r\n    },\r\n    _resetListDataSourceFilter: function() {\r\n        var dataSource = this._getDataSource();\r\n        if (!dataSource) {\r\n            return\r\n        }\r\n        delete this._userFilter;\r\n        dataSource.filter(null);\r\n        dataSource.reload()\r\n    },\r\n    _setListDataSourceFilter: function() {\r\n        if (!this.option(\"hideSelectedItems\") || !this._list) {\r\n            return\r\n        }\r\n        var dataSource = this._getDataSource();\r\n        if (!dataSource) {\r\n            return\r\n        }\r\n        var valueGetterExpr = this._valueGetterExpr();\r\n        if ((0, _type.isString)(valueGetterExpr) && \"this\" !== valueGetterExpr) {\r\n            var filter = this._dataSourceFilterExpr();\r\n            if (void 0 === this._userFilter) {\r\n                this._userFilter = dataSource.filter() || null\r\n            }\r\n            this._userFilter && filter.push(this._userFilter);\r\n            filter.length ? dataSource.filter(filter) : dataSource.filter(null)\r\n        } else {\r\n            dataSource.filter(this._dataSourceFilterFunction.bind(this))\r\n        }\r\n        dataSource.load()\r\n    },\r\n    _dataSourceFilterExpr: function() {\r\n        var _this13 = this;\r\n        var filter = [];\r\n        (0, _iterator.each)(this._getValue(), function(index, value) {\r\n            filter.push([\"!\", [_this13._valueGetterExpr(), value]])\r\n        });\r\n        return filter\r\n    },\r\n    _dataSourceFilterFunction: function(itemData) {\r\n        var _this14 = this;\r\n        var itemValue = this._valueGetter(itemData);\r\n        var result = true;\r\n        (0, _iterator.each)(this._getValue(), function(index, value) {\r\n            if (_this14._isValueEquals(value, itemValue)) {\r\n                result = false;\r\n                return false\r\n            }\r\n        });\r\n        return result\r\n    },\r\n    _applyButtonHandler: function() {\r\n        this.option(\"value\", this._getSortedListValues());\r\n        this._clearTextValue();\r\n        this._clearFilter();\r\n        this.callBase()\r\n    },\r\n    _getSortedListValues: function() {\r\n        var listValues = this._getListValues();\r\n        var currentValue = this.option(\"value\") || [];\r\n        var existedItems = listValues.length ? currentValue.filter(function(item) {\r\n            return listValues.indexOf(item) !== -1\r\n        }) : [];\r\n        var newItems = existedItems.length ? listValues.filter(function(item) {\r\n            return currentValue.indexOf(item) === -1\r\n        }) : listValues;\r\n        return existedItems.concat(newItems)\r\n    },\r\n    _getListValues: function() {\r\n        var _this15 = this;\r\n        if (!this._list) {\r\n            return []\r\n        }\r\n        var selectedItems = this._getPlainItems(this._list.option(\"selectedItems\"));\r\n        var result = [];\r\n        (0, _iterator.each)(selectedItems, function(index, item) {\r\n            result[index] = _this15._valueGetter(item)\r\n        });\r\n        return result\r\n    },\r\n    _renderOpenedState: function() {\r\n        this.callBase();\r\n        if (\"useButtons\" === this.option(\"applyValueMode\") && !this.option(\"opened\")) {\r\n            this._refreshSelected()\r\n        }\r\n    },\r\n    reset: function() {\r\n        this._restoreInputText();\r\n        var defaultValue = this._getDefaultOptions().value;\r\n        var currentValue = this.option(\"value\");\r\n        if (defaultValue && 0 === defaultValue.length && currentValue && defaultValue.length === currentValue.length) {\r\n            return\r\n        }\r\n        this.callBase()\r\n    },\r\n    _clean: function() {\r\n        this.callBase();\r\n        delete this._defaultTagTemplate;\r\n        delete this._tagTemplate\r\n    },\r\n    _removeDuplicates: function(from, what) {\r\n        var _this16 = this;\r\n        var result = [];\r\n        (0, _iterator.each)(from, function(_, value) {\r\n            var filteredItems = what.filter(function(item) {\r\n                return _this16._valueGetter(value) === _this16._valueGetter(item)\r\n            });\r\n            if (!filteredItems.length) {\r\n                result.push(value)\r\n            }\r\n        });\r\n        return result\r\n    },\r\n    _optionChanged: function(args) {\r\n        switch (args.name) {\r\n            case \"onSelectAllValueChanged\":\r\n                this._initSelectAllValueChangedAction();\r\n                break;\r\n            case \"onMultiTagPreparing\":\r\n                this._initMultiTagPreparingAction();\r\n                this._renderTags();\r\n                break;\r\n            case \"hideSelectedItems\":\r\n                if (args.value) {\r\n                    this._setListDataSourceFilter()\r\n                } else {\r\n                    this._resetListDataSourceFilter()\r\n                }\r\n                break;\r\n            case \"useSubmitBehavior\":\r\n                this._toggleSubmitElement(args.value);\r\n                break;\r\n            case \"displayExpr\":\r\n                this.callBase(args);\r\n                this._initTemplates();\r\n                this._invalidate();\r\n                break;\r\n            case \"tagTemplate\":\r\n                this._initTagTemplate();\r\n                this._invalidate();\r\n                break;\r\n            case \"selectAllText\":\r\n                this._setListOption(\"selectAllText\", this.option(\"selectAllText\"));\r\n                break;\r\n            case \"value\":\r\n                this.callBase(args);\r\n                this._setListDataSourceFilter();\r\n                break;\r\n            case \"maxDisplayedTags\":\r\n            case \"showMultiTagOnly\":\r\n                this._renderTags();\r\n                break;\r\n            case \"selectAllMode\":\r\n                this._setListOption(args.name, args.value);\r\n                break;\r\n            case \"selectedItem\":\r\n                break;\r\n            case \"selectedItems\":\r\n                this._selectionChangedAction({\r\n                    addedItems: this._removeDuplicates(args.value, args.previousValue),\r\n                    removedItems: this._removeDuplicates(args.previousValue, args.value)\r\n                });\r\n                break;\r\n            case \"multiline\":\r\n                this.$element().toggleClass(TAGBOX_SINGLE_LINE_CLASS, !args.value);\r\n                this._renderSingleLineScroll();\r\n                break;\r\n            case \"maxFilterLength\":\r\n                break;\r\n            default:\r\n                this.callBase(args)\r\n        }\r\n    },\r\n    _getActualSearchValue: function() {\r\n        return this.callBase() || this._searchValue()\r\n    },\r\n    _popupHidingHandler: function() {\r\n        this.callBase();\r\n        this._clearFilter()\r\n    }\r\n});\r\n(0, _component_registrator2.default)(\"dxTagBox\", TagBox);\r\nmodule.exports = TagBox;\r\nmodule.exports.default = module.exports;\r\n"]},"metadata":{},"sourceType":"module"}