{"ast":null,"code":"/**\r\n * DevExtreme (ui/grid_core/ui.grid_core.validating.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar _renderer = require(\"../../core/renderer\");\n\nvar _renderer2 = _interopRequireDefault(_renderer);\n\nvar _events_engine = require(\"../../events/core/events_engine\");\n\nvar _events_engine2 = _interopRequireDefault(_events_engine);\n\nvar _uiGrid_core = require(\"./ui.grid_core.modules\");\n\nvar _uiGrid_core2 = _interopRequireDefault(_uiGrid_core);\n\nvar _uiGrid_core3 = require(\"./ui.grid_core.utils\");\n\nvar _common = require(\"../../core/utils/common\");\n\nvar _iterator = require(\"../../core/utils/iterator\");\n\nvar _type = require(\"../../core/utils/type\");\n\nvar _extend = require(\"../../core/utils/extend\");\n\nvar _selectors = require(\"../widget/selectors\");\n\nvar _message = require(\"../../localization/message\");\n\nvar _message2 = _interopRequireDefault(_message);\n\nvar _button = require(\"../button\");\n\nvar _button2 = _interopRequireDefault(_button);\n\nvar _pointer = require(\"../../events/pointer\");\n\nvar _pointer2 = _interopRequireDefault(_pointer);\n\nvar _validation_engine = require(\"../validation_engine\");\n\nvar _validation_engine2 = _interopRequireDefault(_validation_engine);\n\nvar _validator = require(\"../validator\");\n\nvar _validator2 = _interopRequireDefault(_validator);\n\nvar _tooltip = require(\"../tooltip\");\n\nvar _tooltip2 = _interopRequireDefault(_tooltip);\n\nvar _overlay = require(\"../overlay\");\n\nvar _overlay2 = _interopRequireDefault(_overlay);\n\nvar _themes = require(\"../themes\");\n\nvar _themes2 = _interopRequireDefault(_themes);\n\nvar _ui = require(\"../widget/ui.errors\");\n\nvar _ui2 = _interopRequireDefault(_ui);\n\nvar _deferred = require(\"../../core/utils/deferred\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance\");\n}\n\nfunction _iterableToArray(iter) {\n  if (Symbol.iterator in Object(iter) || \"[object Arguments]\" === Object.prototype.toString.call(iter)) {\n    return Array.from(iter);\n  }\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) {\n      arr2[i] = arr[i];\n    }\n\n    return arr2;\n  }\n}\n\nvar INVALIDATE_CLASS = \"invalid\";\nvar REVERT_TOOLTIP_CLASS = \"revert-tooltip\";\nvar ROWS_VIEW_CLASS = \"rowsview\";\nvar INVALID_MESSAGE_CLASS = \"dx-invalid-message\";\nvar WIDGET_INVALID_MESSAGE_CLASS = \"invalid-message\";\nvar INVALID_MESSAGE_ALWAYS_CLASS = \"dx-invalid-message-always\";\nvar REVERT_BUTTON_CLASS = \"dx-revert-button\";\nvar CELL_HIGHLIGHT_OUTLINE = \"dx-highlight-outline\";\nvar VALIDATOR_CLASS = \"validator\";\nvar INSERT_INDEX = \"__DX_INSERT_INDEX__\";\nvar PADDING_BETWEEN_TOOLTIPS = 2;\nvar EDIT_MODE_ROW = \"row\";\nvar EDIT_MODE_FORM = \"form\";\nvar EDIT_MODE_BATCH = \"batch\";\nvar EDIT_MODE_CELL = \"cell\";\nvar EDIT_MODE_POPUP = \"popup\";\nvar GROUP_CELL_CLASS = \"dx-group-cell\";\nvar FORM_BASED_MODES = [EDIT_MODE_POPUP, EDIT_MODE_FORM];\nvar COMMAND_TRANSPARENT = \"transparent\";\n\nvar ValidatingController = _uiGrid_core2.default.Controller.inherit(function () {\n  return {\n    init: function init() {\n      this._editingController = this.getController(\"editing\");\n      this.createAction(\"onRowValidating\");\n    },\n    _getBrokenRules: function _getBrokenRules(editData, validationResults) {\n      var brokenRules;\n\n      if (validationResults) {\n        brokenRules = validationResults.brokenRules || validationResults.brokenRule && [validationResults.brokenRule];\n      } else {\n        brokenRules = editData.brokenRules || [];\n      }\n\n      return brokenRules;\n    },\n    _rowValidating: function _rowValidating(editData, validationResults) {\n      var deferred = new _deferred.Deferred();\n\n      var brokenRules = this._getBrokenRules(editData, validationResults);\n\n      var isValid = validationResults ? validationResults.isValid : editData.isValid;\n      var parameters = {\n        brokenRules: brokenRules,\n        isValid: isValid,\n        key: editData.key,\n        newData: editData.data,\n        oldData: editData.oldData,\n        promise: null,\n        errorText: this.getHiddenValidatorsErrorText(brokenRules)\n      };\n      this.executeAction(\"onRowValidating\", parameters);\n      (0, _deferred.when)(parameters.promise).always(function () {\n        editData.isValid = parameters.isValid;\n        editData.errorText = parameters.errorText;\n        deferred.resolve(parameters);\n      });\n      return deferred.promise();\n    },\n    getHiddenValidatorsErrorText: function getHiddenValidatorsErrorText(brokenRules) {\n      var brokenRulesMessages = [];\n      (0, _iterator.each)(brokenRules, function (_, brokenRule) {\n        var column = brokenRule.column;\n        var isGroupExpandColumn = column && void 0 !== column.groupIndex && !column.showWhenGrouped;\n        var isVisibleColumn = column && column.visible;\n\n        if (!brokenRule.validator.$element().parent().length && (!isVisibleColumn || isGroupExpandColumn)) {\n          brokenRulesMessages.push(brokenRule.message);\n        }\n      });\n      return brokenRulesMessages.join(\", \");\n    },\n    validate: function validate(isFull) {\n      var _this = this;\n\n      var isValid = true;\n      var editingController = this._editingController;\n      var deferred = new _deferred.Deferred();\n      var completeList = [];\n      isFull = isFull || editingController.getEditMode() === EDIT_MODE_ROW;\n\n      if (this._isValidationInProgress) {\n        return deferred.resolve(false).promise();\n      }\n\n      this._isValidationInProgress = true;\n\n      if (isFull) {\n        (0, _iterator.each)(editingController._editData, function (index, editData) {\n          var validationResult;\n\n          if (editData.type && \"remove\" !== editData.type) {\n            validationResult = _this.validateGroup(editData);\n            completeList.push(validationResult);\n            validationResult.done(function (validationResult) {\n              if (!validationResult.isValid) {\n                (0, _iterator.each)(validationResult.brokenRules, function () {\n                  var value = this.validator.option(\"adapter\").getValue();\n\n                  if (void 0 === value) {\n                    value = null;\n                  }\n\n                  if (this.column) {\n                    editingController.updateFieldValue({\n                      key: editData.key,\n                      column: this.column\n                    }, value, null, true);\n                  }\n                });\n              }\n\n              isValid = isValid && validationResult.isValid;\n            });\n          }\n        });\n      } else {\n        if (this._currentCellValidator) {\n          var validationResult = this.validateGroup(this._currentCellValidator._findGroup());\n          completeList.push(validationResult);\n          validationResult.done(function (validationResult) {\n            isValid = validationResult.isValid;\n          });\n        }\n      }\n\n      this._isValidationInProgress = false;\n\n      _deferred.when.apply(void 0, completeList).done(function () {\n        deferred.resolve(isValid);\n      });\n\n      return deferred.promise();\n    },\n    validateGroup: function validateGroup(editData) {\n      var _this2 = this;\n\n      var result = new _deferred.Deferred();\n\n      var validateGroup = _validation_engine2.default.getGroupConfig(editData);\n\n      var validationResults;\n\n      if (validateGroup && validateGroup.validators.length) {\n        validationResults = _validation_engine2.default.validateGroup(editData);\n      }\n\n      (0, _deferred.when)(validationResults && validationResults.complete || validationResults).done(function (validationResults) {\n        (0, _deferred.when)(_this2._rowValidating(editData, validationResults)).done(result.resolve);\n      });\n      return result.promise();\n    },\n    updateEditData: function updateEditData(editData) {\n      var editMode = this._editingController.getEditMode();\n\n      if (FORM_BASED_MODES.indexOf(editMode) === -1) {\n        this.setDisableApplyValidationResults(true);\n\n        if (_validation_engine2.default.getGroupConfig(editData)) {\n          var validationResult = _validation_engine2.default.validateGroup(editData);\n\n          (0, _deferred.when)(validationResult.complete || validationResult).done(function (validationResult) {\n            editData.isValid = validationResult.isValid;\n            editData.brokenRules = validationResult.brokenRules;\n          });\n        } else {\n          if (!editData.brokenRules || !editData.brokenRules.length) {\n            editData.isValid = true;\n          }\n        }\n\n        this.setDisableApplyValidationResults(false);\n      } else {\n        editData.isValid = true;\n      }\n    },\n    setValidator: function setValidator(validator) {\n      this._currentCellValidator = validator;\n    },\n    getValidator: function getValidator() {\n      return this._currentCellValidator;\n    },\n    createValidator: function createValidator(parameters, $container) {\n      var that = this;\n      var editingController = that._editingController;\n      var column = parameters.column;\n      var editData;\n      var editIndex;\n\n      var defaultValidationResult = function defaultValidationResult(options) {\n        if (options.brokenRule) {\n          options.brokenRule.columnIndex = column.index;\n          options.brokenRule.column = column;\n        }\n\n        if ($container && !that.getDisableApplyValidationResults()) {\n          if (!options.isValid) {\n            var $focus = $container.find(\":focus\");\n            editingController.showHighlighting($container, true);\n\n            if (!(0, _selectors.focused)($focus)) {\n              _events_engine2.default.trigger($focus, \"focus\");\n\n              _events_engine2.default.trigger($focus, _pointer2.default.down);\n            }\n          }\n\n          $container.toggleClass(that.addWidgetPrefix(INVALIDATE_CLASS), !options.isValid);\n        }\n      };\n\n      var getValue = function getValue() {\n        var value = column.calculateCellValue(editData.data || {});\n        return void 0 !== value ? value : parameters.value;\n      };\n\n      var visibleColumns;\n      var columnsController;\n      var showEditorAlways = column.showEditorAlways;\n\n      if (!column.validationRules || !Array.isArray(column.validationRules) || !column.validationRules.length || (0, _type.isDefined)(column.command)) {\n        return;\n      }\n\n      editIndex = editingController.getIndexByKey(parameters.key, editingController._editData);\n\n      if (editIndex < 0) {\n        if (!showEditorAlways) {\n          columnsController = that.getController(\"columns\");\n          visibleColumns = columnsController && columnsController.getVisibleColumns() || [];\n          showEditorAlways = visibleColumns.some(function (column) {\n            return column.showEditorAlways;\n          });\n        }\n\n        if (showEditorAlways) {\n          editIndex = editingController._addEditData({\n            key: parameters.key,\n            oldData: parameters.data\n          });\n        }\n      }\n\n      if (editIndex >= 0) {\n        if ($container && !$container.length) {\n          _ui2.default.log(\"E1050\");\n\n          return;\n        }\n\n        editData = editingController._editData[editIndex];\n        var useDefaultValidator = $container && $container.hasClass(\"dx-widget\");\n        $container && $container.addClass(that.addWidgetPrefix(VALIDATOR_CLASS));\n        var validator = new _validator2.default($container || (0, _renderer2.default)(\"<div>\"), {\n          name: column.caption,\n          validationRules: (0, _extend.extend)(true, [], column.validationRules),\n          validationGroup: editData,\n          adapter: useDefaultValidator ? null : {\n            getValue: getValue,\n            applyValidationResults: defaultValidationResult\n          },\n          dataGetter: function dataGetter() {\n            return {\n              data: (0, _uiGrid_core3.createObjectWithChanges)(editData.oldData, editData.data),\n              column: column\n            };\n          }\n        });\n\n        if (useDefaultValidator) {\n          var adapter = validator.option(\"adapter\");\n\n          if (adapter) {\n            adapter.getValue = getValue;\n          }\n        }\n\n        return validator;\n      }\n    },\n    setDisableApplyValidationResults: function setDisableApplyValidationResults(flag) {\n      this._disableApplyValidationResults = flag;\n    },\n    getDisableApplyValidationResults: function getDisableApplyValidationResults() {\n      return this._disableApplyValidationResults;\n    }\n  };\n}());\n\nmodule.exports = {\n  defaultOptions: function defaultOptions() {\n    return {\n      editing: {\n        texts: {\n          validationCancelChanges: _message2.default.format(\"dxDataGrid-validationCancelChanges\")\n        }\n      }\n    };\n  },\n  controllers: {\n    validating: ValidatingController\n  },\n  extenders: {\n    controllers: {\n      editing: {\n        _addEditData: function _addEditData(options, row) {\n          var that = this;\n          var validatingController = that.getController(\"validating\");\n          var editDataIndex = that.callBase(options, row);\n          var editData;\n\n          if (editDataIndex >= 0) {\n            editData = that._editData[editDataIndex];\n            validatingController.updateEditData(editData);\n          }\n\n          return editDataIndex;\n        },\n        _updateRowAndPageIndices: function _updateRowAndPageIndices() {\n          var that = this;\n          var startInsertIndex = that.getView(\"rowsView\").getTopVisibleItemIndex();\n          var rowIndex = startInsertIndex;\n          (0, _iterator.each)(that._editData, function (_, editData) {\n            if (!editData.isValid && editData.pageIndex !== that._pageIndex) {\n              editData.pageIndex = that._pageIndex;\n\n              if (\"insert\" === editData.type) {\n                editData.rowIndex = startInsertIndex;\n              } else {\n                editData.rowIndex = rowIndex;\n              }\n\n              rowIndex++;\n            }\n          });\n        },\n        _needInsertItem: function _needInsertItem(editData) {\n          var result = this.callBase.apply(this, arguments);\n\n          if (result && !editData.isValid) {\n            result = editData.key.pageIndex === this._pageIndex;\n          }\n\n          return result;\n        },\n        processItems: function processItems(items, changeType) {\n          var that = this;\n          var i;\n          var itemsCount;\n          var editData = that._editData;\n          var dataController = that.getController(\"data\");\n\n          var getIndexByEditData = function getIndexByEditData(editData, items) {\n            var index = -1;\n            var isInsert = \"insert\" === editData.type;\n            var key = editData.key;\n            (0, _iterator.each)(items, function (i, item) {\n              if ((0, _common.equalByValue)(key, isInsert ? item : dataController.keyOf(item))) {\n                index = i;\n                return false;\n              }\n            });\n            return index;\n          };\n\n          var addInValidItem = function addInValidItem(editData) {\n            var data = {\n              key: editData.key\n            };\n            var index = getIndexByEditData(editData, items);\n            var rowIndex;\n\n            if (index >= 0) {\n              return;\n            }\n\n            editData.rowIndex = editData.rowIndex > itemsCount ? editData.rowIndex % itemsCount : editData.rowIndex;\n            rowIndex = editData.rowIndex;\n            data[INSERT_INDEX] = 1;\n            items.splice(rowIndex, 0, data);\n          };\n\n          items = that.callBase(items, changeType);\n          itemsCount = items.length;\n\n          if (that.getEditMode() === EDIT_MODE_BATCH && \"prepend\" !== changeType && \"append\" !== changeType) {\n            for (i = 0; i < editData.length; i++) {\n              if (editData[i].type && editData[i].pageIndex === that._pageIndex && editData[i].key.pageIndex !== that._pageIndex) {\n                addInValidItem(editData[i]);\n              }\n            }\n          }\n\n          return items;\n        },\n        processDataItem: function processDataItem(item) {\n          var that = this;\n          var editIndex;\n          var editData;\n          var isInserted = item.data[INSERT_INDEX];\n          var key = isInserted ? item.data.key : item.key;\n          var editMode = that.getEditMode();\n\n          if (editMode === EDIT_MODE_BATCH && isInserted && key) {\n            editIndex = (0, _uiGrid_core3.getIndexByKey)(key, that._editData);\n\n            if (editIndex >= 0) {\n              editData = that._editData[editIndex];\n\n              if (\"insert\" !== editData.type) {\n                item.data = (0, _extend.extend)(true, {}, editData.oldData, editData.data);\n                item.key = key;\n              }\n            }\n          }\n\n          that.callBase.apply(that, arguments);\n        },\n        _getInvisibleColumns: function _getInvisibleColumns(editData) {\n          var _this3 = this;\n\n          var columnsController = this.getController(\"columns\");\n          var hasInvisibleRows;\n          var invisibleColumns = columnsController.getInvisibleColumns();\n\n          if (this.isCellOrBatchEditMode()) {\n            hasInvisibleRows = editData.some(function (rowEditData) {\n              var rowIndex = _this3._dataController.getRowIndexByKey(rowEditData.key);\n\n              return rowIndex < 0;\n            });\n          }\n\n          return hasInvisibleRows ? columnsController.getColumns() : invisibleColumns;\n        },\n        _createInvisibleColumnValidators: function _createInvisibleColumnValidators(editData) {\n          var validatingController = this.getController(\"validating\");\n          var columnsController = this.getController(\"columns\");\n\n          var invisibleColumns = this._getInvisibleColumns(editData).filter(function (column) {\n            return !column.isBand;\n          });\n\n          var groupColumns = columnsController.getGroupColumns().filter(function (column) {\n            return !column.showWhenGrouped && invisibleColumns.indexOf(column) === -1;\n          });\n          var invisibleColumnValidators = [];\n          invisibleColumns.push.apply(invisibleColumns, _toConsumableArray(groupColumns));\n\n          if (FORM_BASED_MODES.indexOf(this.getEditMode()) === -1) {\n            (0, _iterator.each)(invisibleColumns, function (_, column) {\n              editData.forEach(function (options) {\n                var data;\n\n                if (\"insert\" === options.type) {\n                  data = options.data;\n                } else {\n                  if (\"update\" === options.type) {\n                    data = (0, _uiGrid_core3.createObjectWithChanges)(options.oldData, options.data);\n                  }\n                }\n\n                if (data) {\n                  var validator = validatingController.createValidator({\n                    column: column,\n                    key: options.key,\n                    value: column.calculateCellValue(data)\n                  });\n\n                  if (validator) {\n                    invisibleColumnValidators.push(validator);\n                  }\n                }\n              });\n            });\n          }\n\n          return function () {\n            invisibleColumnValidators.forEach(function (validator) {\n              validator._dispose();\n            });\n          };\n        },\n        _beforeSaveEditData: function _beforeSaveEditData(editData, editIndex) {\n          var _this4 = this;\n\n          var isValid;\n          var result = this.callBase.apply(this, arguments);\n          var validatingController = this.getController(\"validating\");\n\n          if (editData) {\n            isValid = \"remove\" === editData.type || editData.isValid;\n            result = result || !isValid;\n          } else {\n            var disposeValidators = this._createInvisibleColumnValidators(this._editData);\n\n            result = new _deferred.Deferred();\n            validatingController.validate(true).done(function (isFullValid) {\n              disposeValidators();\n\n              _this4._updateRowAndPageIndices();\n\n              switch (_this4.getEditMode()) {\n                case EDIT_MODE_CELL:\n                  if (!isFullValid) {\n                    _this4._focusEditingCell();\n                  }\n\n                  break;\n\n                case EDIT_MODE_BATCH:\n                  if (!isFullValid) {\n                    _this4._editRowIndex = -1;\n                    _this4._editColumnIndex = -1;\n\n                    _this4.getController(\"data\").updateItems();\n                  }\n\n              }\n\n              result.resolve(!isFullValid);\n            });\n          }\n\n          return result.promise ? result.promise() : result;\n        },\n        _beforeEditCell: function _beforeEditCell(rowIndex, columnIndex, item) {\n          var result = this.callBase(rowIndex, columnIndex, item);\n\n          var $cell = this._rowsView._getCellElement(rowIndex, columnIndex);\n\n          var validator = $cell && $cell.data(\"dxValidator\");\n          var value = validator && validator.option(\"adapter\").getValue();\n\n          if (this.getEditMode(this) === EDIT_MODE_CELL && (!validator || void 0 !== value && validator.validate().isValid)) {\n            return result;\n          }\n        },\n        _afterSaveEditData: function _afterSaveEditData() {\n          var that = this;\n          var $firstErrorRow;\n          (0, _iterator.each)(that._editData, function (_, editData) {\n            var $errorRow = that._showErrorRow(editData);\n\n            $firstErrorRow = $firstErrorRow || $errorRow;\n          });\n\n          if ($firstErrorRow) {\n            var scrollable = this._rowsView.getScrollable();\n\n            if (scrollable) {\n              scrollable.update();\n              scrollable.scrollToElement($firstErrorRow);\n            }\n          }\n        },\n        _showErrorRow: function _showErrorRow(editData) {\n          var $popupContent;\n          var errorHandling = this.getController(\"errorHandling\");\n          var items = this.getController(\"data\").items();\n          var rowIndex = this.getIndexByKey(editData.key, items);\n\n          if (!editData.isValid && editData.errorText && rowIndex >= 0) {\n            $popupContent = this.getPopupContent();\n            return errorHandling && errorHandling.renderErrorRow(editData.errorText, rowIndex, $popupContent);\n          }\n        },\n        updateFieldValue: function updateFieldValue(e) {\n          var that = this;\n          var editMode = that.getEditMode();\n          that.callBase.apply(that, arguments);\n\n          if (editMode === EDIT_MODE_ROW || editMode === EDIT_MODE_BATCH && e.column.showEditorAlways) {\n            var currentValidator = that.getController(\"validating\").getValidator();\n            currentValidator && currentValidator.validate();\n          }\n        },\n        showHighlighting: function showHighlighting($cell, skipValidation) {\n          var _this5 = this;\n\n          var isValid = true;\n          var callBase = this.callBase;\n          var validator;\n\n          if (!skipValidation) {\n            validator = $cell.data(\"dxValidator\");\n\n            if (validator) {\n              var validationResult = validator.validate();\n              (0, _deferred.when)(validationResult.complete || validationResult).done(function (validationResult) {\n                isValid = validationResult.isValid;\n\n                if (isValid) {\n                  callBase.call(_this5, $cell);\n                }\n              });\n              return;\n            }\n          }\n\n          if (isValid) {\n            callBase.call(this, $cell);\n          }\n        },\n        getEditDataByKey: function getEditDataByKey(key) {\n          return this._editData[(0, _uiGrid_core3.getIndexByKey)(key, this._editData)];\n        }\n      },\n      editorFactory: function () {\n        var getWidthOfVisibleCells = function getWidthOfVisibleCells(that, element) {\n          var rowIndex = (0, _renderer2.default)(element).closest(\"tr\").index();\n          var $cellElements = (0, _renderer2.default)(that._rowsView.getRowElement(rowIndex)).first().children().filter(\":not(.dx-hidden-cell)\");\n          return that._rowsView._getWidths($cellElements).reduce(function (w1, w2) {\n            return w1 + w2;\n          }, 0);\n        };\n\n        var getBoundaryNonFixedColumnsInfo = function getBoundaryNonFixedColumnsInfo(fixedColumns) {\n          var firstNonFixedColumnIndex;\n          var lastNonFixedColumnIndex;\n          fixedColumns.some(function (column, index) {\n            if (column.command === COMMAND_TRANSPARENT) {\n              firstNonFixedColumnIndex = 0 === index ? -1 : index;\n              lastNonFixedColumnIndex = index === fixedColumns.length - 1 ? -1 : index + column.colspan - 1;\n              return true;\n            }\n          });\n          return {\n            startColumnIndex: firstNonFixedColumnIndex,\n            endColumnIndex: lastNonFixedColumnIndex\n          };\n        };\n\n        return {\n          _showRevertButton: function _showRevertButton($container, $targetElement) {\n            var _this6 = this;\n\n            if (!$targetElement || !$targetElement.length) {\n              return;\n            }\n\n            var $tooltipElement = (0, _renderer2.default)(\"<div>\").addClass(this.addWidgetPrefix(REVERT_TOOLTIP_CLASS)).appendTo($container);\n            var tooltipOptions = {\n              animation: null,\n              visible: true,\n              target: $targetElement,\n              container: $container,\n              closeOnOutsideClick: false,\n              closeOnTargetScroll: false,\n              contentTemplate: function contentTemplate() {\n                var $buttonElement = (0, _renderer2.default)(\"<div>\").addClass(REVERT_BUTTON_CLASS);\n                var buttonOptions = {\n                  icon: \"revert\",\n                  hint: _this6.option(\"editing.texts.validationCancelChanges\"),\n                  onClick: function onClick() {\n                    _this6._editingController.cancelEditData();\n                  }\n                };\n                return new _button2.default($buttonElement, buttonOptions).$element();\n              },\n              position: {\n                my: \"left top\",\n                at: \"right top\",\n                of: $targetElement,\n                offset: \"1 0\",\n                collision: \"flip\",\n                boundary: this._rowsView.element()\n              },\n              onPositioned: this._positionedHandler.bind(this)\n            };\n            return new _tooltip2.default($tooltipElement, tooltipOptions);\n          },\n          _hideFixedGroupCell: function _hideFixedGroupCell($cell, overlayOptions) {\n            var nextRowOptions;\n            var $nextFixedRowElement;\n            var $groupCellElement;\n\n            var isFixedColumns = this._rowsView.isFixedColumns();\n\n            var isFormEditMode = this._editingController.isFormEditMode();\n\n            if (isFixedColumns && !isFormEditMode) {\n              nextRowOptions = $cell.closest(\".dx-row\").next().data(\"options\");\n\n              if (nextRowOptions && \"group\" === nextRowOptions.rowType) {\n                $nextFixedRowElement = (0, _renderer2.default)(this._rowsView.getRowElement(nextRowOptions.rowIndex)).last();\n                $groupCellElement = $nextFixedRowElement.find(\".\" + GROUP_CELL_CLASS);\n\n                if ($groupCellElement.length && \"hidden\" !== $groupCellElement.get(0).style.visibility) {\n                  $groupCellElement.css(\"visibility\", \"hidden\");\n\n                  overlayOptions.onDisposing = function () {\n                    $groupCellElement.css(\"visibility\", \"\");\n                  };\n                }\n              }\n            }\n          },\n          _positionedHandler: function _positionedHandler(e, isOverlayVisible) {\n            if (!e.component.__skipPositionProcessing) {\n              var isRevertButton = (0, _renderer2.default)(e.element).hasClass(this.addWidgetPrefix(REVERT_TOOLTIP_CLASS));\n\n              var needRepaint = !isRevertButton && this._rowsView.updateFreeSpaceRowHeight();\n\n              var normalizedPosition = this._normalizeValidationMessagePositionAndMaxWidth(e, isRevertButton, isOverlayVisible);\n\n              e.component.__skipPositionProcessing = !!(needRepaint || normalizedPosition);\n\n              if (normalizedPosition) {\n                e.component.option(normalizedPosition);\n              } else {\n                if (needRepaint) {\n                  e.component.repaint();\n                }\n              }\n            }\n          },\n          _showValidationMessage: function _showValidationMessage($cell, message, alignment, revertTooltip) {\n            var _this7 = this;\n\n            var $highlightContainer = $cell.find(\".\" + CELL_HIGHLIGHT_OUTLINE);\n\n            var isMaterial = _themes2.default.isMaterial();\n\n            var overlayTarget = $highlightContainer.length && !isMaterial ? $highlightContainer : $cell;\n            var editorPopup = $cell.find(\".dx-dropdowneditor-overlay\").data(\"dxPopup\");\n            var isOverlayVisible = editorPopup && editorPopup.option(\"visible\");\n            var myPosition = isOverlayVisible ? \"top right\" : \"top \" + alignment;\n            var atPosition = isOverlayVisible ? \"top left\" : \"bottom \" + alignment;\n            var $overlayElement = (0, _renderer2.default)(\"<div>\").addClass(INVALID_MESSAGE_CLASS).addClass(INVALID_MESSAGE_ALWAYS_CLASS).addClass(this.addWidgetPrefix(WIDGET_INVALID_MESSAGE_CLASS)).text(message).appendTo($cell);\n            var overlayOptions = {\n              target: overlayTarget,\n              container: $cell,\n              shading: false,\n              width: \"auto\",\n              height: \"auto\",\n              visible: true,\n              animation: false,\n              propagateOutsideClick: true,\n              closeOnOutsideClick: false,\n              closeOnTargetScroll: false,\n              position: {\n                collision: \"flip\",\n                boundary: this._rowsView.element(),\n                boundaryOffset: \"0 0\",\n                my: myPosition,\n                at: atPosition\n              },\n              onPositioned: function onPositioned(e) {\n                _this7._positionedHandler(e, isOverlayVisible);\n\n                _this7._shiftValidationMessageIfNeed(e.component.$content(), revertTooltip && revertTooltip.$content(), $cell);\n              }\n            };\n\n            this._hideFixedGroupCell($cell, overlayOptions);\n\n            new _overlay2.default($overlayElement, overlayOptions);\n          },\n          _normalizeValidationMessagePositionAndMaxWidth: function _normalizeValidationMessagePositionAndMaxWidth(options, isRevertButton, isOverlayVisible) {\n            var fixedColumns = this._columnsController.getFixedColumns();\n\n            if (!fixedColumns || !fixedColumns.length) {\n              return;\n            }\n\n            var position;\n            var visibleTableWidth = !isRevertButton && getWidthOfVisibleCells(this, options.element);\n            var $overlayContentElement = isRevertButton ? options.component.overlayContent() : options.component.$content();\n            var validationMessageWidth = $overlayContentElement.outerWidth(true);\n            var needMaxWidth = !isRevertButton && validationMessageWidth > visibleTableWidth;\n\n            var columnIndex = this._rowsView.getCellIndex((0, _renderer2.default)(options.element).closest(\"td\"));\n\n            var boundaryNonFixedColumnsInfo = getBoundaryNonFixedColumnsInfo(fixedColumns);\n\n            if (!isRevertButton && (columnIndex === boundaryNonFixedColumnsInfo.startColumnIndex || needMaxWidth)) {\n              position = {\n                collision: \"none flip\",\n                my: \"top left\",\n                at: isOverlayVisible ? \"top right\" : \"bottom left\"\n              };\n            } else {\n              if (columnIndex === boundaryNonFixedColumnsInfo.endColumnIndex) {\n                position = {\n                  collision: \"none flip\",\n                  my: \"top right\",\n                  at: isRevertButton || isOverlayVisible ? \"top left\" : \"bottom right\"\n                };\n\n                if (isRevertButton) {\n                  position.offset = \"-1 0\";\n                }\n              }\n            }\n\n            return position && {\n              position: position,\n              maxWidth: needMaxWidth ? visibleTableWidth - 2 : void 0\n            };\n          },\n          _shiftValidationMessageIfNeed: function _shiftValidationMessageIfNeed($content, $revertContent, $cell) {\n            if (!$revertContent) {\n              return;\n            }\n\n            var contentOffset = $content.offset();\n            var revertContentOffset = $revertContent.offset();\n\n            if (contentOffset.top === revertContentOffset.top && contentOffset.left + $content.width() > revertContentOffset.left) {\n              var left = $revertContent.width() + PADDING_BETWEEN_TOOLTIPS;\n              $content.css(\"left\", revertContentOffset.left < $cell.offset().left ? -left : left);\n            }\n          },\n          _getTooltipsSelector: function _getTooltipsSelector() {\n            var invalidMessageClass = this.addWidgetPrefix(WIDGET_INVALID_MESSAGE_CLASS);\n            var revertTooltipClass = this.addWidgetPrefix(REVERT_TOOLTIP_CLASS);\n            return \".dx-editor-cell .\" + revertTooltipClass + \", .dx-editor-cell .\" + invalidMessageClass + \", .dx-cell-modified .\" + invalidMessageClass;\n          },\n          init: function init() {\n            this.callBase();\n            this._editingController = this.getController(\"editing\");\n            this._columnsController = this.getController(\"columns\");\n            this._rowsView = this.getView(\"rowsView\");\n          },\n          loseFocus: function loseFocus(skipValidator) {\n            if (!skipValidator) {\n              this.getController(\"validating\").setValidator(null);\n            }\n\n            this.callBase();\n          },\n          focus: function focus($element, hideBorder) {\n            var that = this;\n            var $focus = $element && $element.closest(that._getFocusCellSelector());\n            var validator = $focus && ($focus.data(\"dxValidator\") || $element.find(\".\" + that.addWidgetPrefix(VALIDATOR_CLASS)).eq(0).data(\"dxValidator\"));\n            var rowOptions = $focus && $focus.closest(\".dx-row\").data(\"options\");\n            var editData = rowOptions ? that.getController(\"editing\").getEditDataByKey(rowOptions.key) : null;\n            var validationResult;\n            var $tooltips = $focus && $focus.closest(\".\" + that.addWidgetPrefix(ROWS_VIEW_CLASS)).find(that._getTooltipsSelector());\n            var $cell = $focus && $focus.is(\"td\") ? $focus : null;\n            var showValidationMessage = false;\n            var revertTooltip;\n            var column = $cell && that.getController(\"columns\").getVisibleColumns()[$cell.index()];\n\n            if (!arguments.length) {\n              return that.callBase();\n            }\n\n            $tooltips && $tooltips.remove();\n\n            if (validator) {\n              that.getController(\"validating\").setValidator(validator);\n\n              if (void 0 !== validator.option(\"adapter\").getValue()) {\n                validationResult = validator.validate();\n\n                if (!validationResult.isValid) {\n                  hideBorder = true;\n                  showValidationMessage = true;\n                }\n              }\n            }\n\n            if (validationResult && !validationResult.isValid || editData && \"update\" === editData.type && !that._editingController.isSaving()) {\n              if (that._editingController.getEditMode() === EDIT_MODE_CELL) {\n                revertTooltip = that._showRevertButton($focus, $cell ? $focus.find(\".\" + CELL_HIGHLIGHT_OUTLINE).first() : $focus);\n              }\n            }\n\n            if (showValidationMessage && $cell && column && validationResult.brokenRule.message) {\n              that._showValidationMessage($focus, validationResult.brokenRule.message, column.alignment || \"left\", revertTooltip);\n            }\n\n            !hideBorder && that._rowsView.element() && that._rowsView.updateFreeSpaceRowHeight();\n            return that.callBase($element, hideBorder);\n          }\n        };\n      }()\n    },\n    views: {\n      rowsView: {\n        updateFreeSpaceRowHeight: function updateFreeSpaceRowHeight($table) {\n          var that = this;\n          var $rowElements;\n          var $freeSpaceRowElement;\n          var $freeSpaceRowElements;\n          var $element = that.element();\n          var $tooltipContent = $element && $element.find(\".\" + that.addWidgetPrefix(WIDGET_INVALID_MESSAGE_CLASS) + \" .dx-overlay-content\");\n          that.callBase($table);\n\n          if ($tooltipContent && $tooltipContent.length) {\n            $rowElements = that._getRowElements();\n            $freeSpaceRowElements = that._getFreeSpaceRowElements($table);\n            $freeSpaceRowElement = $freeSpaceRowElements.first();\n\n            if ($freeSpaceRowElement && 1 === $rowElements.length && (!$freeSpaceRowElement.is(\":visible\") || $tooltipContent.outerHeight() > $freeSpaceRowElement.outerHeight())) {\n              $freeSpaceRowElements.show();\n              $freeSpaceRowElements.height($tooltipContent.outerHeight());\n              return true;\n            }\n          }\n        },\n        _formItemPrepared: function _formItemPrepared(cellOptions, $container) {\n          var _this8 = this;\n\n          this.callBase.apply(this, arguments);\n          (0, _common.deferUpdate)(function () {\n            var $editor = $container.find(\".dx-widget\").first();\n            var isEditorDisposed = $editor.length && !$editor.children().length;\n\n            if (!isEditorDisposed) {\n              _this8.getController(\"validating\").createValidator(cellOptions, $editor);\n            }\n          });\n        },\n        _cellPrepared: function _cellPrepared($cell, parameters) {\n          if (!this.getController(\"editing\").isFormEditMode()) {\n            this.getController(\"validating\").createValidator(parameters, $cell);\n          }\n\n          this.callBase.apply(this, arguments);\n        }\n      }\n    }\n  }\n};","map":{"version":3,"sources":["C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/devextreme/ui/grid_core/ui.grid_core.validating.js"],"names":["_renderer","require","_renderer2","_interopRequireDefault","_events_engine","_events_engine2","_uiGrid_core","_uiGrid_core2","_uiGrid_core3","_common","_iterator","_type","_extend","_selectors","_message","_message2","_button","_button2","_pointer","_pointer2","_validation_engine","_validation_engine2","_validator","_validator2","_tooltip","_tooltip2","_overlay","_overlay2","_themes","_themes2","_ui","_ui2","_deferred","obj","_arrayWithoutHoles","_iterableToArray","_nonIterableSpread","Symbol","Object","Array","i","arr2","arr","INVALIDATE_CLASS","REVERT_TOOLTIP_CLASS","ROWS_VIEW_CLASS","INVALID_MESSAGE_CLASS","WIDGET_INVALID_MESSAGE_CLASS","INVALID_MESSAGE_ALWAYS_CLASS","REVERT_BUTTON_CLASS","CELL_HIGHLIGHT_OUTLINE","VALIDATOR_CLASS","INSERT_INDEX","PADDING_BETWEEN_TOOLTIPS","EDIT_MODE_ROW","EDIT_MODE_FORM","EDIT_MODE_BATCH","EDIT_MODE_CELL","EDIT_MODE_POPUP","GROUP_CELL_CLASS","FORM_BASED_MODES","COMMAND_TRANSPARENT","ValidatingController","init","_getBrokenRules","brokenRules","validationResults","editData","_rowValidating","deferred","isValid","parameters","key","newData","oldData","promise","errorText","getHiddenValidatorsErrorText","brokenRulesMessages","column","brokenRule","isGroupExpandColumn","isVisibleColumn","validate","_this","editingController","completeList","isFull","validationResult","value","validateGroup","_this2","result","updateEditData","editMode","setValidator","getValidator","createValidator","that","defaultValidationResult","options","$container","$focus","getValue","showEditorAlways","editIndex","columnsController","visibleColumns","data","useDefaultValidator","validator","name","validationRules","validationGroup","adapter","applyValidationResults","dataGetter","setDisableApplyValidationResults","getDisableApplyValidationResults","module","defaultOptions","editing","texts","validationCancelChanges","controllers","validating","extenders","_addEditData","validatingController","editDataIndex","_updateRowAndPageIndices","startInsertIndex","rowIndex","_needInsertItem","processItems","dataController","getIndexByEditData","index","isInsert","addInValidItem","items","itemsCount","processDataItem","isInserted","item","_getInvisibleColumns","_this3","invisibleColumns","hasInvisibleRows","rowEditData","_createInvisibleColumnValidators","groupColumns","invisibleColumnValidators","_toConsumableArray","_beforeSaveEditData","_this4","disposeValidators","_beforeEditCell","$cell","_afterSaveEditData","$errorRow","$firstErrorRow","scrollable","_showErrorRow","errorHandling","$popupContent","updateFieldValue","e","currentValidator","showHighlighting","_this5","callBase","getEditDataByKey","editorFactory","getWidthOfVisibleCells","$cellElements","w1","getBoundaryNonFixedColumnsInfo","fixedColumns","firstNonFixedColumnIndex","lastNonFixedColumnIndex","startColumnIndex","endColumnIndex","_showRevertButton","_this6","$targetElement","$tooltipElement","tooltipOptions","animation","visible","target","container","closeOnOutsideClick","closeOnTargetScroll","contentTemplate","$buttonElement","buttonOptions","icon","hint","onClick","position","my","at","of","offset","collision","boundary","onPositioned","_hideFixedGroupCell","isFixedColumns","isFormEditMode","nextRowOptions","$nextFixedRowElement","$groupCellElement","overlayOptions","_positionedHandler","isRevertButton","needRepaint","normalizedPosition","_showValidationMessage","_this7","$highlightContainer","isMaterial","overlayTarget","editorPopup","isOverlayVisible","myPosition","atPosition","$overlayElement","shading","width","height","propagateOutsideClick","boundaryOffset","revertTooltip","_normalizeValidationMessagePositionAndMaxWidth","visibleTableWidth","$overlayContentElement","validationMessageWidth","needMaxWidth","columnIndex","boundaryNonFixedColumnsInfo","maxWidth","_shiftValidationMessageIfNeed","contentOffset","$content","revertContentOffset","$revertContent","left","_getTooltipsSelector","invalidMessageClass","revertTooltipClass","loseFocus","focus","$element","rowOptions","$tooltips","showValidationMessage","arguments","hideBorder","views","rowsView","updateFreeSpaceRowHeight","$tooltipContent","$rowElements","$freeSpaceRowElements","$freeSpaceRowElement","_formItemPrepared","_this8","$editor","isEditorDisposed","_cellPrepared"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/grid_core/ui.grid_core.validating.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar _renderer = require(\"../../core/renderer\");\r\nvar _renderer2 = _interopRequireDefault(_renderer);\r\nvar _events_engine = require(\"../../events/core/events_engine\");\r\nvar _events_engine2 = _interopRequireDefault(_events_engine);\r\nvar _uiGrid_core = require(\"./ui.grid_core.modules\");\r\nvar _uiGrid_core2 = _interopRequireDefault(_uiGrid_core);\r\nvar _uiGrid_core3 = require(\"./ui.grid_core.utils\");\r\nvar _common = require(\"../../core/utils/common\");\r\nvar _iterator = require(\"../../core/utils/iterator\");\r\nvar _type = require(\"../../core/utils/type\");\r\nvar _extend = require(\"../../core/utils/extend\");\r\nvar _selectors = require(\"../widget/selectors\");\r\nvar _message = require(\"../../localization/message\");\r\nvar _message2 = _interopRequireDefault(_message);\r\nvar _button = require(\"../button\");\r\nvar _button2 = _interopRequireDefault(_button);\r\nvar _pointer = require(\"../../events/pointer\");\r\nvar _pointer2 = _interopRequireDefault(_pointer);\r\nvar _validation_engine = require(\"../validation_engine\");\r\nvar _validation_engine2 = _interopRequireDefault(_validation_engine);\r\nvar _validator = require(\"../validator\");\r\nvar _validator2 = _interopRequireDefault(_validator);\r\nvar _tooltip = require(\"../tooltip\");\r\nvar _tooltip2 = _interopRequireDefault(_tooltip);\r\nvar _overlay = require(\"../overlay\");\r\nvar _overlay2 = _interopRequireDefault(_overlay);\r\nvar _themes = require(\"../themes\");\r\nvar _themes2 = _interopRequireDefault(_themes);\r\nvar _ui = require(\"../widget/ui.errors\");\r\nvar _ui2 = _interopRequireDefault(_ui);\r\nvar _deferred = require(\"../../core/utils/deferred\");\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\n\r\nfunction _toConsumableArray(arr) {\r\n    return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread()\r\n}\r\n\r\nfunction _nonIterableSpread() {\r\n    throw new TypeError(\"Invalid attempt to spread non-iterable instance\")\r\n}\r\n\r\nfunction _iterableToArray(iter) {\r\n    if (Symbol.iterator in Object(iter) || \"[object Arguments]\" === Object.prototype.toString.call(iter)) {\r\n        return Array.from(iter)\r\n    }\r\n}\r\n\r\nfunction _arrayWithoutHoles(arr) {\r\n    if (Array.isArray(arr)) {\r\n        for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) {\r\n            arr2[i] = arr[i]\r\n        }\r\n        return arr2\r\n    }\r\n}\r\nvar INVALIDATE_CLASS = \"invalid\";\r\nvar REVERT_TOOLTIP_CLASS = \"revert-tooltip\";\r\nvar ROWS_VIEW_CLASS = \"rowsview\";\r\nvar INVALID_MESSAGE_CLASS = \"dx-invalid-message\";\r\nvar WIDGET_INVALID_MESSAGE_CLASS = \"invalid-message\";\r\nvar INVALID_MESSAGE_ALWAYS_CLASS = \"dx-invalid-message-always\";\r\nvar REVERT_BUTTON_CLASS = \"dx-revert-button\";\r\nvar CELL_HIGHLIGHT_OUTLINE = \"dx-highlight-outline\";\r\nvar VALIDATOR_CLASS = \"validator\";\r\nvar INSERT_INDEX = \"__DX_INSERT_INDEX__\";\r\nvar PADDING_BETWEEN_TOOLTIPS = 2;\r\nvar EDIT_MODE_ROW = \"row\";\r\nvar EDIT_MODE_FORM = \"form\";\r\nvar EDIT_MODE_BATCH = \"batch\";\r\nvar EDIT_MODE_CELL = \"cell\";\r\nvar EDIT_MODE_POPUP = \"popup\";\r\nvar GROUP_CELL_CLASS = \"dx-group-cell\";\r\nvar FORM_BASED_MODES = [EDIT_MODE_POPUP, EDIT_MODE_FORM];\r\nvar COMMAND_TRANSPARENT = \"transparent\";\r\nvar ValidatingController = _uiGrid_core2.default.Controller.inherit(function() {\r\n    return {\r\n        init: function() {\r\n            this._editingController = this.getController(\"editing\");\r\n            this.createAction(\"onRowValidating\")\r\n        },\r\n        _getBrokenRules: function(editData, validationResults) {\r\n            var brokenRules;\r\n            if (validationResults) {\r\n                brokenRules = validationResults.brokenRules || validationResults.brokenRule && [validationResults.brokenRule]\r\n            } else {\r\n                brokenRules = editData.brokenRules || []\r\n            }\r\n            return brokenRules\r\n        },\r\n        _rowValidating: function(editData, validationResults) {\r\n            var deferred = new _deferred.Deferred;\r\n            var brokenRules = this._getBrokenRules(editData, validationResults);\r\n            var isValid = validationResults ? validationResults.isValid : editData.isValid;\r\n            var parameters = {\r\n                brokenRules: brokenRules,\r\n                isValid: isValid,\r\n                key: editData.key,\r\n                newData: editData.data,\r\n                oldData: editData.oldData,\r\n                promise: null,\r\n                errorText: this.getHiddenValidatorsErrorText(brokenRules)\r\n            };\r\n            this.executeAction(\"onRowValidating\", parameters);\r\n            (0, _deferred.when)(parameters.promise).always(function() {\r\n                editData.isValid = parameters.isValid;\r\n                editData.errorText = parameters.errorText;\r\n                deferred.resolve(parameters)\r\n            });\r\n            return deferred.promise()\r\n        },\r\n        getHiddenValidatorsErrorText: function(brokenRules) {\r\n            var brokenRulesMessages = [];\r\n            (0, _iterator.each)(brokenRules, function(_, brokenRule) {\r\n                var column = brokenRule.column;\r\n                var isGroupExpandColumn = column && void 0 !== column.groupIndex && !column.showWhenGrouped;\r\n                var isVisibleColumn = column && column.visible;\r\n                if (!brokenRule.validator.$element().parent().length && (!isVisibleColumn || isGroupExpandColumn)) {\r\n                    brokenRulesMessages.push(brokenRule.message)\r\n                }\r\n            });\r\n            return brokenRulesMessages.join(\", \")\r\n        },\r\n        validate: function(isFull) {\r\n            var _this = this;\r\n            var isValid = true;\r\n            var editingController = this._editingController;\r\n            var deferred = new _deferred.Deferred;\r\n            var completeList = [];\r\n            isFull = isFull || editingController.getEditMode() === EDIT_MODE_ROW;\r\n            if (this._isValidationInProgress) {\r\n                return deferred.resolve(false).promise()\r\n            }\r\n            this._isValidationInProgress = true;\r\n            if (isFull) {\r\n                (0, _iterator.each)(editingController._editData, function(index, editData) {\r\n                    var validationResult;\r\n                    if (editData.type && \"remove\" !== editData.type) {\r\n                        validationResult = _this.validateGroup(editData);\r\n                        completeList.push(validationResult);\r\n                        validationResult.done(function(validationResult) {\r\n                            if (!validationResult.isValid) {\r\n                                (0, _iterator.each)(validationResult.brokenRules, function() {\r\n                                    var value = this.validator.option(\"adapter\").getValue();\r\n                                    if (void 0 === value) {\r\n                                        value = null\r\n                                    }\r\n                                    if (this.column) {\r\n                                        editingController.updateFieldValue({\r\n                                            key: editData.key,\r\n                                            column: this.column\r\n                                        }, value, null, true)\r\n                                    }\r\n                                })\r\n                            }\r\n                            isValid = isValid && validationResult.isValid\r\n                        })\r\n                    }\r\n                })\r\n            } else {\r\n                if (this._currentCellValidator) {\r\n                    var validationResult = this.validateGroup(this._currentCellValidator._findGroup());\r\n                    completeList.push(validationResult);\r\n                    validationResult.done(function(validationResult) {\r\n                        isValid = validationResult.isValid\r\n                    })\r\n                }\r\n            }\r\n            this._isValidationInProgress = false;\r\n            _deferred.when.apply(void 0, completeList).done(function() {\r\n                deferred.resolve(isValid)\r\n            });\r\n            return deferred.promise()\r\n        },\r\n        validateGroup: function validateGroup(editData) {\r\n            var _this2 = this;\r\n            var result = new _deferred.Deferred;\r\n            var validateGroup = _validation_engine2.default.getGroupConfig(editData);\r\n            var validationResults;\r\n            if (validateGroup && validateGroup.validators.length) {\r\n                validationResults = _validation_engine2.default.validateGroup(editData)\r\n            }(0, _deferred.when)(validationResults && validationResults.complete || validationResults).done(function(validationResults) {\r\n                (0, _deferred.when)(_this2._rowValidating(editData, validationResults)).done(result.resolve)\r\n            });\r\n            return result.promise()\r\n        },\r\n        updateEditData: function(editData) {\r\n            var editMode = this._editingController.getEditMode();\r\n            if (FORM_BASED_MODES.indexOf(editMode) === -1) {\r\n                this.setDisableApplyValidationResults(true);\r\n                if (_validation_engine2.default.getGroupConfig(editData)) {\r\n                    var validationResult = _validation_engine2.default.validateGroup(editData);\r\n                    (0, _deferred.when)(validationResult.complete || validationResult).done(function(validationResult) {\r\n                        editData.isValid = validationResult.isValid;\r\n                        editData.brokenRules = validationResult.brokenRules\r\n                    })\r\n                } else {\r\n                    if (!editData.brokenRules || !editData.brokenRules.length) {\r\n                        editData.isValid = true\r\n                    }\r\n                }\r\n                this.setDisableApplyValidationResults(false)\r\n            } else {\r\n                editData.isValid = true\r\n            }\r\n        },\r\n        setValidator: function(validator) {\r\n            this._currentCellValidator = validator\r\n        },\r\n        getValidator: function() {\r\n            return this._currentCellValidator\r\n        },\r\n        createValidator: function(parameters, $container) {\r\n            var that = this;\r\n            var editingController = that._editingController;\r\n            var column = parameters.column;\r\n            var editData;\r\n            var editIndex;\r\n            var defaultValidationResult = function(options) {\r\n                if (options.brokenRule) {\r\n                    options.brokenRule.columnIndex = column.index;\r\n                    options.brokenRule.column = column\r\n                }\r\n                if ($container && !that.getDisableApplyValidationResults()) {\r\n                    if (!options.isValid) {\r\n                        var $focus = $container.find(\":focus\");\r\n                        editingController.showHighlighting($container, true);\r\n                        if (!(0, _selectors.focused)($focus)) {\r\n                            _events_engine2.default.trigger($focus, \"focus\");\r\n                            _events_engine2.default.trigger($focus, _pointer2.default.down)\r\n                        }\r\n                    }\r\n                    $container.toggleClass(that.addWidgetPrefix(INVALIDATE_CLASS), !options.isValid)\r\n                }\r\n            };\r\n            var getValue = function() {\r\n                var value = column.calculateCellValue(editData.data || {});\r\n                return void 0 !== value ? value : parameters.value\r\n            };\r\n            var visibleColumns;\r\n            var columnsController;\r\n            var showEditorAlways = column.showEditorAlways;\r\n            if (!column.validationRules || !Array.isArray(column.validationRules) || !column.validationRules.length || (0, _type.isDefined)(column.command)) {\r\n                return\r\n            }\r\n            editIndex = editingController.getIndexByKey(parameters.key, editingController._editData);\r\n            if (editIndex < 0) {\r\n                if (!showEditorAlways) {\r\n                    columnsController = that.getController(\"columns\");\r\n                    visibleColumns = columnsController && columnsController.getVisibleColumns() || [];\r\n                    showEditorAlways = visibleColumns.some(function(column) {\r\n                        return column.showEditorAlways\r\n                    })\r\n                }\r\n                if (showEditorAlways) {\r\n                    editIndex = editingController._addEditData({\r\n                        key: parameters.key,\r\n                        oldData: parameters.data\r\n                    })\r\n                }\r\n            }\r\n            if (editIndex >= 0) {\r\n                if ($container && !$container.length) {\r\n                    _ui2.default.log(\"E1050\");\r\n                    return\r\n                }\r\n                editData = editingController._editData[editIndex];\r\n                var useDefaultValidator = $container && $container.hasClass(\"dx-widget\");\r\n                $container && $container.addClass(that.addWidgetPrefix(VALIDATOR_CLASS));\r\n                var validator = new _validator2.default($container || (0, _renderer2.default)(\"<div>\"), {\r\n                    name: column.caption,\r\n                    validationRules: (0, _extend.extend)(true, [], column.validationRules),\r\n                    validationGroup: editData,\r\n                    adapter: useDefaultValidator ? null : {\r\n                        getValue: getValue,\r\n                        applyValidationResults: defaultValidationResult\r\n                    },\r\n                    dataGetter: function() {\r\n                        return {\r\n                            data: (0, _uiGrid_core3.createObjectWithChanges)(editData.oldData, editData.data),\r\n                            column: column\r\n                        }\r\n                    }\r\n                });\r\n                if (useDefaultValidator) {\r\n                    var adapter = validator.option(\"adapter\");\r\n                    if (adapter) {\r\n                        adapter.getValue = getValue\r\n                    }\r\n                }\r\n                return validator\r\n            }\r\n        },\r\n        setDisableApplyValidationResults: function(flag) {\r\n            this._disableApplyValidationResults = flag\r\n        },\r\n        getDisableApplyValidationResults: function() {\r\n            return this._disableApplyValidationResults\r\n        }\r\n    }\r\n}());\r\nmodule.exports = {\r\n    defaultOptions: function() {\r\n        return {\r\n            editing: {\r\n                texts: {\r\n                    validationCancelChanges: _message2.default.format(\"dxDataGrid-validationCancelChanges\")\r\n                }\r\n            }\r\n        }\r\n    },\r\n    controllers: {\r\n        validating: ValidatingController\r\n    },\r\n    extenders: {\r\n        controllers: {\r\n            editing: {\r\n                _addEditData: function(options, row) {\r\n                    var that = this;\r\n                    var validatingController = that.getController(\"validating\");\r\n                    var editDataIndex = that.callBase(options, row);\r\n                    var editData;\r\n                    if (editDataIndex >= 0) {\r\n                        editData = that._editData[editDataIndex];\r\n                        validatingController.updateEditData(editData)\r\n                    }\r\n                    return editDataIndex\r\n                },\r\n                _updateRowAndPageIndices: function() {\r\n                    var that = this;\r\n                    var startInsertIndex = that.getView(\"rowsView\").getTopVisibleItemIndex();\r\n                    var rowIndex = startInsertIndex;\r\n                    (0, _iterator.each)(that._editData, function(_, editData) {\r\n                        if (!editData.isValid && editData.pageIndex !== that._pageIndex) {\r\n                            editData.pageIndex = that._pageIndex;\r\n                            if (\"insert\" === editData.type) {\r\n                                editData.rowIndex = startInsertIndex\r\n                            } else {\r\n                                editData.rowIndex = rowIndex\r\n                            }\r\n                            rowIndex++\r\n                        }\r\n                    })\r\n                },\r\n                _needInsertItem: function(editData) {\r\n                    var result = this.callBase.apply(this, arguments);\r\n                    if (result && !editData.isValid) {\r\n                        result = editData.key.pageIndex === this._pageIndex\r\n                    }\r\n                    return result\r\n                },\r\n                processItems: function(items, changeType) {\r\n                    var that = this;\r\n                    var i;\r\n                    var itemsCount;\r\n                    var editData = that._editData;\r\n                    var dataController = that.getController(\"data\");\r\n                    var getIndexByEditData = function(editData, items) {\r\n                        var index = -1;\r\n                        var isInsert = \"insert\" === editData.type;\r\n                        var key = editData.key;\r\n                        (0, _iterator.each)(items, function(i, item) {\r\n                            if ((0, _common.equalByValue)(key, isInsert ? item : dataController.keyOf(item))) {\r\n                                index = i;\r\n                                return false\r\n                            }\r\n                        });\r\n                        return index\r\n                    };\r\n                    var addInValidItem = function(editData) {\r\n                        var data = {\r\n                            key: editData.key\r\n                        };\r\n                        var index = getIndexByEditData(editData, items);\r\n                        var rowIndex;\r\n                        if (index >= 0) {\r\n                            return\r\n                        }\r\n                        editData.rowIndex = editData.rowIndex > itemsCount ? editData.rowIndex % itemsCount : editData.rowIndex;\r\n                        rowIndex = editData.rowIndex;\r\n                        data[INSERT_INDEX] = 1;\r\n                        items.splice(rowIndex, 0, data)\r\n                    };\r\n                    items = that.callBase(items, changeType);\r\n                    itemsCount = items.length;\r\n                    if (that.getEditMode() === EDIT_MODE_BATCH && \"prepend\" !== changeType && \"append\" !== changeType) {\r\n                        for (i = 0; i < editData.length; i++) {\r\n                            if (editData[i].type && editData[i].pageIndex === that._pageIndex && editData[i].key.pageIndex !== that._pageIndex) {\r\n                                addInValidItem(editData[i])\r\n                            }\r\n                        }\r\n                    }\r\n                    return items\r\n                },\r\n                processDataItem: function(item) {\r\n                    var that = this;\r\n                    var editIndex;\r\n                    var editData;\r\n                    var isInserted = item.data[INSERT_INDEX];\r\n                    var key = isInserted ? item.data.key : item.key;\r\n                    var editMode = that.getEditMode();\r\n                    if (editMode === EDIT_MODE_BATCH && isInserted && key) {\r\n                        editIndex = (0, _uiGrid_core3.getIndexByKey)(key, that._editData);\r\n                        if (editIndex >= 0) {\r\n                            editData = that._editData[editIndex];\r\n                            if (\"insert\" !== editData.type) {\r\n                                item.data = (0, _extend.extend)(true, {}, editData.oldData, editData.data);\r\n                                item.key = key\r\n                            }\r\n                        }\r\n                    }\r\n                    that.callBase.apply(that, arguments)\r\n                },\r\n                _getInvisibleColumns: function(editData) {\r\n                    var _this3 = this;\r\n                    var columnsController = this.getController(\"columns\");\r\n                    var hasInvisibleRows;\r\n                    var invisibleColumns = columnsController.getInvisibleColumns();\r\n                    if (this.isCellOrBatchEditMode()) {\r\n                        hasInvisibleRows = editData.some(function(rowEditData) {\r\n                            var rowIndex = _this3._dataController.getRowIndexByKey(rowEditData.key);\r\n                            return rowIndex < 0\r\n                        })\r\n                    }\r\n                    return hasInvisibleRows ? columnsController.getColumns() : invisibleColumns\r\n                },\r\n                _createInvisibleColumnValidators: function(editData) {\r\n                    var validatingController = this.getController(\"validating\");\r\n                    var columnsController = this.getController(\"columns\");\r\n                    var invisibleColumns = this._getInvisibleColumns(editData).filter(function(column) {\r\n                        return !column.isBand\r\n                    });\r\n                    var groupColumns = columnsController.getGroupColumns().filter(function(column) {\r\n                        return !column.showWhenGrouped && invisibleColumns.indexOf(column) === -1\r\n                    });\r\n                    var invisibleColumnValidators = [];\r\n                    invisibleColumns.push.apply(invisibleColumns, _toConsumableArray(groupColumns));\r\n                    if (FORM_BASED_MODES.indexOf(this.getEditMode()) === -1) {\r\n                        (0, _iterator.each)(invisibleColumns, function(_, column) {\r\n                            editData.forEach(function(options) {\r\n                                var data;\r\n                                if (\"insert\" === options.type) {\r\n                                    data = options.data\r\n                                } else {\r\n                                    if (\"update\" === options.type) {\r\n                                        data = (0, _uiGrid_core3.createObjectWithChanges)(options.oldData, options.data)\r\n                                    }\r\n                                }\r\n                                if (data) {\r\n                                    var validator = validatingController.createValidator({\r\n                                        column: column,\r\n                                        key: options.key,\r\n                                        value: column.calculateCellValue(data)\r\n                                    });\r\n                                    if (validator) {\r\n                                        invisibleColumnValidators.push(validator)\r\n                                    }\r\n                                }\r\n                            })\r\n                        })\r\n                    }\r\n                    return function() {\r\n                        invisibleColumnValidators.forEach(function(validator) {\r\n                            validator._dispose()\r\n                        })\r\n                    }\r\n                },\r\n                _beforeSaveEditData: function(editData, editIndex) {\r\n                    var _this4 = this;\r\n                    var isValid;\r\n                    var result = this.callBase.apply(this, arguments);\r\n                    var validatingController = this.getController(\"validating\");\r\n                    if (editData) {\r\n                        isValid = \"remove\" === editData.type || editData.isValid;\r\n                        result = result || !isValid\r\n                    } else {\r\n                        var disposeValidators = this._createInvisibleColumnValidators(this._editData);\r\n                        result = new _deferred.Deferred;\r\n                        validatingController.validate(true).done(function(isFullValid) {\r\n                            disposeValidators();\r\n                            _this4._updateRowAndPageIndices();\r\n                            switch (_this4.getEditMode()) {\r\n                                case EDIT_MODE_CELL:\r\n                                    if (!isFullValid) {\r\n                                        _this4._focusEditingCell()\r\n                                    }\r\n                                    break;\r\n                                case EDIT_MODE_BATCH:\r\n                                    if (!isFullValid) {\r\n                                        _this4._editRowIndex = -1;\r\n                                        _this4._editColumnIndex = -1;\r\n                                        _this4.getController(\"data\").updateItems()\r\n                                    }\r\n                            }\r\n                            result.resolve(!isFullValid)\r\n                        })\r\n                    }\r\n                    return result.promise ? result.promise() : result\r\n                },\r\n                _beforeEditCell: function(rowIndex, columnIndex, item) {\r\n                    var result = this.callBase(rowIndex, columnIndex, item);\r\n                    var $cell = this._rowsView._getCellElement(rowIndex, columnIndex);\r\n                    var validator = $cell && $cell.data(\"dxValidator\");\r\n                    var value = validator && validator.option(\"adapter\").getValue();\r\n                    if (this.getEditMode(this) === EDIT_MODE_CELL && (!validator || void 0 !== value && validator.validate().isValid)) {\r\n                        return result\r\n                    }\r\n                },\r\n                _afterSaveEditData: function() {\r\n                    var that = this;\r\n                    var $firstErrorRow;\r\n                    (0, _iterator.each)(that._editData, function(_, editData) {\r\n                        var $errorRow = that._showErrorRow(editData);\r\n                        $firstErrorRow = $firstErrorRow || $errorRow\r\n                    });\r\n                    if ($firstErrorRow) {\r\n                        var scrollable = this._rowsView.getScrollable();\r\n                        if (scrollable) {\r\n                            scrollable.update();\r\n                            scrollable.scrollToElement($firstErrorRow)\r\n                        }\r\n                    }\r\n                },\r\n                _showErrorRow: function(editData) {\r\n                    var $popupContent;\r\n                    var errorHandling = this.getController(\"errorHandling\");\r\n                    var items = this.getController(\"data\").items();\r\n                    var rowIndex = this.getIndexByKey(editData.key, items);\r\n                    if (!editData.isValid && editData.errorText && rowIndex >= 0) {\r\n                        $popupContent = this.getPopupContent();\r\n                        return errorHandling && errorHandling.renderErrorRow(editData.errorText, rowIndex, $popupContent)\r\n                    }\r\n                },\r\n                updateFieldValue: function(e) {\r\n                    var that = this;\r\n                    var editMode = that.getEditMode();\r\n                    that.callBase.apply(that, arguments);\r\n                    if (editMode === EDIT_MODE_ROW || editMode === EDIT_MODE_BATCH && e.column.showEditorAlways) {\r\n                        var currentValidator = that.getController(\"validating\").getValidator();\r\n                        currentValidator && currentValidator.validate()\r\n                    }\r\n                },\r\n                showHighlighting: function($cell, skipValidation) {\r\n                    var _this5 = this;\r\n                    var isValid = true;\r\n                    var callBase = this.callBase;\r\n                    var validator;\r\n                    if (!skipValidation) {\r\n                        validator = $cell.data(\"dxValidator\");\r\n                        if (validator) {\r\n                            var validationResult = validator.validate();\r\n                            (0, _deferred.when)(validationResult.complete || validationResult).done(function(validationResult) {\r\n                                isValid = validationResult.isValid;\r\n                                if (isValid) {\r\n                                    callBase.call(_this5, $cell)\r\n                                }\r\n                            });\r\n                            return\r\n                        }\r\n                    }\r\n                    if (isValid) {\r\n                        callBase.call(this, $cell)\r\n                    }\r\n                },\r\n                getEditDataByKey: function(key) {\r\n                    return this._editData[(0, _uiGrid_core3.getIndexByKey)(key, this._editData)]\r\n                }\r\n            },\r\n            editorFactory: function() {\r\n                var getWidthOfVisibleCells = function(that, element) {\r\n                    var rowIndex = (0, _renderer2.default)(element).closest(\"tr\").index();\r\n                    var $cellElements = (0, _renderer2.default)(that._rowsView.getRowElement(rowIndex)).first().children().filter(\":not(.dx-hidden-cell)\");\r\n                    return that._rowsView._getWidths($cellElements).reduce(function(w1, w2) {\r\n                        return w1 + w2\r\n                    }, 0)\r\n                };\r\n                var getBoundaryNonFixedColumnsInfo = function(fixedColumns) {\r\n                    var firstNonFixedColumnIndex;\r\n                    var lastNonFixedColumnIndex;\r\n                    fixedColumns.some(function(column, index) {\r\n                        if (column.command === COMMAND_TRANSPARENT) {\r\n                            firstNonFixedColumnIndex = 0 === index ? -1 : index;\r\n                            lastNonFixedColumnIndex = index === fixedColumns.length - 1 ? -1 : index + column.colspan - 1;\r\n                            return true\r\n                        }\r\n                    });\r\n                    return {\r\n                        startColumnIndex: firstNonFixedColumnIndex,\r\n                        endColumnIndex: lastNonFixedColumnIndex\r\n                    }\r\n                };\r\n                return {\r\n                    _showRevertButton: function($container, $targetElement) {\r\n                        var _this6 = this;\r\n                        if (!$targetElement || !$targetElement.length) {\r\n                            return\r\n                        }\r\n                        var $tooltipElement = (0, _renderer2.default)(\"<div>\").addClass(this.addWidgetPrefix(REVERT_TOOLTIP_CLASS)).appendTo($container);\r\n                        var tooltipOptions = {\r\n                            animation: null,\r\n                            visible: true,\r\n                            target: $targetElement,\r\n                            container: $container,\r\n                            closeOnOutsideClick: false,\r\n                            closeOnTargetScroll: false,\r\n                            contentTemplate: function() {\r\n                                var $buttonElement = (0, _renderer2.default)(\"<div>\").addClass(REVERT_BUTTON_CLASS);\r\n                                var buttonOptions = {\r\n                                    icon: \"revert\",\r\n                                    hint: _this6.option(\"editing.texts.validationCancelChanges\"),\r\n                                    onClick: function() {\r\n                                        _this6._editingController.cancelEditData()\r\n                                    }\r\n                                };\r\n                                return new _button2.default($buttonElement, buttonOptions).$element()\r\n                            },\r\n                            position: {\r\n                                my: \"left top\",\r\n                                at: \"right top\",\r\n                                of: $targetElement,\r\n                                offset: \"1 0\",\r\n                                collision: \"flip\",\r\n                                boundary: this._rowsView.element()\r\n                            },\r\n                            onPositioned: this._positionedHandler.bind(this)\r\n                        };\r\n                        return new _tooltip2.default($tooltipElement, tooltipOptions)\r\n                    },\r\n                    _hideFixedGroupCell: function($cell, overlayOptions) {\r\n                        var nextRowOptions;\r\n                        var $nextFixedRowElement;\r\n                        var $groupCellElement;\r\n                        var isFixedColumns = this._rowsView.isFixedColumns();\r\n                        var isFormEditMode = this._editingController.isFormEditMode();\r\n                        if (isFixedColumns && !isFormEditMode) {\r\n                            nextRowOptions = $cell.closest(\".dx-row\").next().data(\"options\");\r\n                            if (nextRowOptions && \"group\" === nextRowOptions.rowType) {\r\n                                $nextFixedRowElement = (0, _renderer2.default)(this._rowsView.getRowElement(nextRowOptions.rowIndex)).last();\r\n                                $groupCellElement = $nextFixedRowElement.find(\".\" + GROUP_CELL_CLASS);\r\n                                if ($groupCellElement.length && \"hidden\" !== $groupCellElement.get(0).style.visibility) {\r\n                                    $groupCellElement.css(\"visibility\", \"hidden\");\r\n                                    overlayOptions.onDisposing = function() {\r\n                                        $groupCellElement.css(\"visibility\", \"\")\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    },\r\n                    _positionedHandler: function(e, isOverlayVisible) {\r\n                        if (!e.component.__skipPositionProcessing) {\r\n                            var isRevertButton = (0, _renderer2.default)(e.element).hasClass(this.addWidgetPrefix(REVERT_TOOLTIP_CLASS));\r\n                            var needRepaint = !isRevertButton && this._rowsView.updateFreeSpaceRowHeight();\r\n                            var normalizedPosition = this._normalizeValidationMessagePositionAndMaxWidth(e, isRevertButton, isOverlayVisible);\r\n                            e.component.__skipPositionProcessing = !!(needRepaint || normalizedPosition);\r\n                            if (normalizedPosition) {\r\n                                e.component.option(normalizedPosition)\r\n                            } else {\r\n                                if (needRepaint) {\r\n                                    e.component.repaint()\r\n                                }\r\n                            }\r\n                        }\r\n                    },\r\n                    _showValidationMessage: function($cell, message, alignment, revertTooltip) {\r\n                        var _this7 = this;\r\n                        var $highlightContainer = $cell.find(\".\" + CELL_HIGHLIGHT_OUTLINE);\r\n                        var isMaterial = _themes2.default.isMaterial();\r\n                        var overlayTarget = $highlightContainer.length && !isMaterial ? $highlightContainer : $cell;\r\n                        var editorPopup = $cell.find(\".dx-dropdowneditor-overlay\").data(\"dxPopup\");\r\n                        var isOverlayVisible = editorPopup && editorPopup.option(\"visible\");\r\n                        var myPosition = isOverlayVisible ? \"top right\" : \"top \" + alignment;\r\n                        var atPosition = isOverlayVisible ? \"top left\" : \"bottom \" + alignment;\r\n                        var $overlayElement = (0, _renderer2.default)(\"<div>\").addClass(INVALID_MESSAGE_CLASS).addClass(INVALID_MESSAGE_ALWAYS_CLASS).addClass(this.addWidgetPrefix(WIDGET_INVALID_MESSAGE_CLASS)).text(message).appendTo($cell);\r\n                        var overlayOptions = {\r\n                            target: overlayTarget,\r\n                            container: $cell,\r\n                            shading: false,\r\n                            width: \"auto\",\r\n                            height: \"auto\",\r\n                            visible: true,\r\n                            animation: false,\r\n                            propagateOutsideClick: true,\r\n                            closeOnOutsideClick: false,\r\n                            closeOnTargetScroll: false,\r\n                            position: {\r\n                                collision: \"flip\",\r\n                                boundary: this._rowsView.element(),\r\n                                boundaryOffset: \"0 0\",\r\n                                my: myPosition,\r\n                                at: atPosition\r\n                            },\r\n                            onPositioned: function(e) {\r\n                                _this7._positionedHandler(e, isOverlayVisible);\r\n                                _this7._shiftValidationMessageIfNeed(e.component.$content(), revertTooltip && revertTooltip.$content(), $cell)\r\n                            }\r\n                        };\r\n                        this._hideFixedGroupCell($cell, overlayOptions);\r\n                        new _overlay2.default($overlayElement, overlayOptions)\r\n                    },\r\n                    _normalizeValidationMessagePositionAndMaxWidth: function(options, isRevertButton, isOverlayVisible) {\r\n                        var fixedColumns = this._columnsController.getFixedColumns();\r\n                        if (!fixedColumns || !fixedColumns.length) {\r\n                            return\r\n                        }\r\n                        var position;\r\n                        var visibleTableWidth = !isRevertButton && getWidthOfVisibleCells(this, options.element);\r\n                        var $overlayContentElement = isRevertButton ? options.component.overlayContent() : options.component.$content();\r\n                        var validationMessageWidth = $overlayContentElement.outerWidth(true);\r\n                        var needMaxWidth = !isRevertButton && validationMessageWidth > visibleTableWidth;\r\n                        var columnIndex = this._rowsView.getCellIndex((0, _renderer2.default)(options.element).closest(\"td\"));\r\n                        var boundaryNonFixedColumnsInfo = getBoundaryNonFixedColumnsInfo(fixedColumns);\r\n                        if (!isRevertButton && (columnIndex === boundaryNonFixedColumnsInfo.startColumnIndex || needMaxWidth)) {\r\n                            position = {\r\n                                collision: \"none flip\",\r\n                                my: \"top left\",\r\n                                at: isOverlayVisible ? \"top right\" : \"bottom left\"\r\n                            }\r\n                        } else {\r\n                            if (columnIndex === boundaryNonFixedColumnsInfo.endColumnIndex) {\r\n                                position = {\r\n                                    collision: \"none flip\",\r\n                                    my: \"top right\",\r\n                                    at: isRevertButton || isOverlayVisible ? \"top left\" : \"bottom right\"\r\n                                };\r\n                                if (isRevertButton) {\r\n                                    position.offset = \"-1 0\"\r\n                                }\r\n                            }\r\n                        }\r\n                        return position && {\r\n                            position: position,\r\n                            maxWidth: needMaxWidth ? visibleTableWidth - 2 : void 0\r\n                        }\r\n                    },\r\n                    _shiftValidationMessageIfNeed: function($content, $revertContent, $cell) {\r\n                        if (!$revertContent) {\r\n                            return\r\n                        }\r\n                        var contentOffset = $content.offset();\r\n                        var revertContentOffset = $revertContent.offset();\r\n                        if (contentOffset.top === revertContentOffset.top && contentOffset.left + $content.width() > revertContentOffset.left) {\r\n                            var left = $revertContent.width() + PADDING_BETWEEN_TOOLTIPS;\r\n                            $content.css(\"left\", revertContentOffset.left < $cell.offset().left ? -left : left)\r\n                        }\r\n                    },\r\n                    _getTooltipsSelector: function() {\r\n                        var invalidMessageClass = this.addWidgetPrefix(WIDGET_INVALID_MESSAGE_CLASS);\r\n                        var revertTooltipClass = this.addWidgetPrefix(REVERT_TOOLTIP_CLASS);\r\n                        return \".dx-editor-cell .\" + revertTooltipClass + \", .dx-editor-cell .\" + invalidMessageClass + \", .dx-cell-modified .\" + invalidMessageClass\r\n                    },\r\n                    init: function() {\r\n                        this.callBase();\r\n                        this._editingController = this.getController(\"editing\");\r\n                        this._columnsController = this.getController(\"columns\");\r\n                        this._rowsView = this.getView(\"rowsView\")\r\n                    },\r\n                    loseFocus: function(skipValidator) {\r\n                        if (!skipValidator) {\r\n                            this.getController(\"validating\").setValidator(null)\r\n                        }\r\n                        this.callBase()\r\n                    },\r\n                    focus: function($element, hideBorder) {\r\n                        var that = this;\r\n                        var $focus = $element && $element.closest(that._getFocusCellSelector());\r\n                        var validator = $focus && ($focus.data(\"dxValidator\") || $element.find(\".\" + that.addWidgetPrefix(VALIDATOR_CLASS)).eq(0).data(\"dxValidator\"));\r\n                        var rowOptions = $focus && $focus.closest(\".dx-row\").data(\"options\");\r\n                        var editData = rowOptions ? that.getController(\"editing\").getEditDataByKey(rowOptions.key) : null;\r\n                        var validationResult;\r\n                        var $tooltips = $focus && $focus.closest(\".\" + that.addWidgetPrefix(ROWS_VIEW_CLASS)).find(that._getTooltipsSelector());\r\n                        var $cell = $focus && $focus.is(\"td\") ? $focus : null;\r\n                        var showValidationMessage = false;\r\n                        var revertTooltip;\r\n                        var column = $cell && that.getController(\"columns\").getVisibleColumns()[$cell.index()];\r\n                        if (!arguments.length) {\r\n                            return that.callBase()\r\n                        }\r\n                        $tooltips && $tooltips.remove();\r\n                        if (validator) {\r\n                            that.getController(\"validating\").setValidator(validator);\r\n                            if (void 0 !== validator.option(\"adapter\").getValue()) {\r\n                                validationResult = validator.validate();\r\n                                if (!validationResult.isValid) {\r\n                                    hideBorder = true;\r\n                                    showValidationMessage = true\r\n                                }\r\n                            }\r\n                        }\r\n                        if (validationResult && !validationResult.isValid || editData && \"update\" === editData.type && !that._editingController.isSaving()) {\r\n                            if (that._editingController.getEditMode() === EDIT_MODE_CELL) {\r\n                                revertTooltip = that._showRevertButton($focus, $cell ? $focus.find(\".\" + CELL_HIGHLIGHT_OUTLINE).first() : $focus)\r\n                            }\r\n                        }\r\n                        if (showValidationMessage && $cell && column && validationResult.brokenRule.message) {\r\n                            that._showValidationMessage($focus, validationResult.brokenRule.message, column.alignment || \"left\", revertTooltip)\r\n                        }!hideBorder && that._rowsView.element() && that._rowsView.updateFreeSpaceRowHeight();\r\n                        return that.callBase($element, hideBorder)\r\n                    }\r\n                }\r\n            }()\r\n        },\r\n        views: {\r\n            rowsView: {\r\n                updateFreeSpaceRowHeight: function($table) {\r\n                    var that = this;\r\n                    var $rowElements;\r\n                    var $freeSpaceRowElement;\r\n                    var $freeSpaceRowElements;\r\n                    var $element = that.element();\r\n                    var $tooltipContent = $element && $element.find(\".\" + that.addWidgetPrefix(WIDGET_INVALID_MESSAGE_CLASS) + \" .dx-overlay-content\");\r\n                    that.callBase($table);\r\n                    if ($tooltipContent && $tooltipContent.length) {\r\n                        $rowElements = that._getRowElements();\r\n                        $freeSpaceRowElements = that._getFreeSpaceRowElements($table);\r\n                        $freeSpaceRowElement = $freeSpaceRowElements.first();\r\n                        if ($freeSpaceRowElement && 1 === $rowElements.length && (!$freeSpaceRowElement.is(\":visible\") || $tooltipContent.outerHeight() > $freeSpaceRowElement.outerHeight())) {\r\n                            $freeSpaceRowElements.show();\r\n                            $freeSpaceRowElements.height($tooltipContent.outerHeight());\r\n                            return true\r\n                        }\r\n                    }\r\n                },\r\n                _formItemPrepared: function(cellOptions, $container) {\r\n                    var _this8 = this;\r\n                    this.callBase.apply(this, arguments);\r\n                    (0, _common.deferUpdate)(function() {\r\n                        var $editor = $container.find(\".dx-widget\").first();\r\n                        var isEditorDisposed = $editor.length && !$editor.children().length;\r\n                        if (!isEditorDisposed) {\r\n                            _this8.getController(\"validating\").createValidator(cellOptions, $editor)\r\n                        }\r\n                    })\r\n                },\r\n                _cellPrepared: function($cell, parameters) {\r\n                    if (!this.getController(\"editing\").isFormEditMode()) {\r\n                        this.getController(\"validating\").createValidator(parameters, $cell)\r\n                    }\r\n                    this.callBase.apply(this, arguments)\r\n                }\r\n            }\r\n        }\r\n    }\r\n};\r\n"]},"metadata":{},"sourceType":"module"}