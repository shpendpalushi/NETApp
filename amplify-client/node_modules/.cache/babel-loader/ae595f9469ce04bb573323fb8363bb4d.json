{"ast":null,"code":"import _get from \"C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/@babel/runtime/helpers/esm/get\";\nimport _getPrototypeOf from \"C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _classCallCheck from \"C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/@babel/runtime/helpers/esm/createSuper\";\nimport { SubjectSubscriber } from '../Subject';\nimport { Observable } from '../Observable';\nimport { Subscriber } from '../Subscriber';\nimport { Subscription } from '../Subscription';\nimport { refCount as higherOrderRefCount } from '../operators/refCount';\nexport var ConnectableObservable = /*#__PURE__*/function (_Observable) {\n  _inherits(ConnectableObservable, _Observable);\n\n  var _super = _createSuper(ConnectableObservable);\n\n  function ConnectableObservable(source, subjectFactory) {\n    var _this;\n\n    _classCallCheck(this, ConnectableObservable);\n\n    _this = _super.call(this);\n    _this.source = source;\n    _this.subjectFactory = subjectFactory;\n    _this._refCount = 0;\n    _this._isComplete = false;\n    return _this;\n  }\n\n  _createClass(ConnectableObservable, [{\n    key: \"_subscribe\",\n    value: function _subscribe(subscriber) {\n      return this.getSubject().subscribe(subscriber);\n    }\n  }, {\n    key: \"getSubject\",\n    value: function getSubject() {\n      var subject = this._subject;\n\n      if (!subject || subject.isStopped) {\n        this._subject = this.subjectFactory();\n      }\n\n      return this._subject;\n    }\n  }, {\n    key: \"connect\",\n    value: function connect() {\n      var connection = this._connection;\n\n      if (!connection) {\n        this._isComplete = false;\n        connection = this._connection = new Subscription();\n        connection.add(this.source.subscribe(new ConnectableSubscriber(this.getSubject(), this)));\n\n        if (connection.closed) {\n          this._connection = null;\n          connection = Subscription.EMPTY;\n        }\n      }\n\n      return connection;\n    }\n  }, {\n    key: \"refCount\",\n    value: function refCount() {\n      return higherOrderRefCount()(this);\n    }\n  }]);\n\n  return ConnectableObservable;\n}(Observable);\nexport var connectableObservableDescriptor = function () {\n  var connectableProto = ConnectableObservable.prototype;\n  return {\n    operator: {\n      value: null\n    },\n    _refCount: {\n      value: 0,\n      writable: true\n    },\n    _subject: {\n      value: null,\n      writable: true\n    },\n    _connection: {\n      value: null,\n      writable: true\n    },\n    _subscribe: {\n      value: connectableProto._subscribe\n    },\n    _isComplete: {\n      value: connectableProto._isComplete,\n      writable: true\n    },\n    getSubject: {\n      value: connectableProto.getSubject\n    },\n    connect: {\n      value: connectableProto.connect\n    },\n    refCount: {\n      value: connectableProto.refCount\n    }\n  };\n}();\n\nvar ConnectableSubscriber = /*#__PURE__*/function (_SubjectSubscriber) {\n  _inherits(ConnectableSubscriber, _SubjectSubscriber);\n\n  var _super2 = _createSuper(ConnectableSubscriber);\n\n  function ConnectableSubscriber(destination, connectable) {\n    var _this2;\n\n    _classCallCheck(this, ConnectableSubscriber);\n\n    _this2 = _super2.call(this, destination);\n    _this2.connectable = connectable;\n    return _this2;\n  }\n\n  _createClass(ConnectableSubscriber, [{\n    key: \"_error\",\n    value: function _error(err) {\n      this._unsubscribe();\n\n      _get(_getPrototypeOf(ConnectableSubscriber.prototype), \"_error\", this).call(this, err);\n    }\n  }, {\n    key: \"_complete\",\n    value: function _complete() {\n      this.connectable._isComplete = true;\n\n      this._unsubscribe();\n\n      _get(_getPrototypeOf(ConnectableSubscriber.prototype), \"_complete\", this).call(this);\n    }\n  }, {\n    key: \"_unsubscribe\",\n    value: function _unsubscribe() {\n      var connectable = this.connectable;\n\n      if (connectable) {\n        this.connectable = null;\n        var connection = connectable._connection;\n        connectable._refCount = 0;\n        connectable._subject = null;\n        connectable._connection = null;\n\n        if (connection) {\n          connection.unsubscribe();\n        }\n      }\n    }\n  }]);\n\n  return ConnectableSubscriber;\n}(SubjectSubscriber);\n\nvar RefCountOperator = /*#__PURE__*/function () {\n  function RefCountOperator(connectable) {\n    _classCallCheck(this, RefCountOperator);\n\n    this.connectable = connectable;\n  }\n\n  _createClass(RefCountOperator, [{\n    key: \"call\",\n    value: function call(subscriber, source) {\n      var connectable = this.connectable;\n      connectable._refCount++;\n      var refCounter = new RefCountSubscriber(subscriber, connectable);\n      var subscription = source.subscribe(refCounter);\n\n      if (!refCounter.closed) {\n        refCounter.connection = connectable.connect();\n      }\n\n      return subscription;\n    }\n  }]);\n\n  return RefCountOperator;\n}();\n\nvar RefCountSubscriber = /*#__PURE__*/function (_Subscriber) {\n  _inherits(RefCountSubscriber, _Subscriber);\n\n  var _super3 = _createSuper(RefCountSubscriber);\n\n  function RefCountSubscriber(destination, connectable) {\n    var _this3;\n\n    _classCallCheck(this, RefCountSubscriber);\n\n    _this3 = _super3.call(this, destination);\n    _this3.connectable = connectable;\n    return _this3;\n  }\n\n  _createClass(RefCountSubscriber, [{\n    key: \"_unsubscribe\",\n    value: function _unsubscribe() {\n      var connectable = this.connectable;\n\n      if (!connectable) {\n        this.connection = null;\n        return;\n      }\n\n      this.connectable = null;\n      var refCount = connectable._refCount;\n\n      if (refCount <= 0) {\n        this.connection = null;\n        return;\n      }\n\n      connectable._refCount = refCount - 1;\n\n      if (refCount > 1) {\n        this.connection = null;\n        return;\n      }\n\n      var connection = this.connection;\n      var sharedConnection = connectable._connection;\n      this.connection = null;\n\n      if (sharedConnection && (!connection || sharedConnection === connection)) {\n        sharedConnection.unsubscribe();\n      }\n    }\n  }]);\n\n  return RefCountSubscriber;\n}(Subscriber);","map":{"version":3,"sources":["../../../src/internal/observable/ConnectableObservable.ts"],"names":[],"mappings":"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","sourcesContent":["import { SubjectSubscriber } from '../Subject';\r\nimport { Observable } from '../Observable';\r\nimport { Subscriber } from '../Subscriber';\r\nimport { Subscription } from '../Subscription';\r\nimport { refCount as higherOrderRefCount } from '../operators/refCount';\r\nexport class ConnectableObservable extends Observable {\r\n    constructor(source, subjectFactory) {\r\n        super();\r\n        this.source = source;\r\n        this.subjectFactory = subjectFactory;\r\n        this._refCount = 0;\r\n        this._isComplete = false;\r\n    }\r\n    _subscribe(subscriber) {\r\n        return this.getSubject().subscribe(subscriber);\r\n    }\r\n    getSubject() {\r\n        const subject = this._subject;\r\n        if (!subject || subject.isStopped) {\r\n            this._subject = this.subjectFactory();\r\n        }\r\n        return this._subject;\r\n    }\r\n    connect() {\r\n        let connection = this._connection;\r\n        if (!connection) {\r\n            this._isComplete = false;\r\n            connection = this._connection = new Subscription();\r\n            connection.add(this.source\r\n                .subscribe(new ConnectableSubscriber(this.getSubject(), this)));\r\n            if (connection.closed) {\r\n                this._connection = null;\r\n                connection = Subscription.EMPTY;\r\n            }\r\n        }\r\n        return connection;\r\n    }\r\n    refCount() {\r\n        return higherOrderRefCount()(this);\r\n    }\r\n}\r\nexport const connectableObservableDescriptor = (() => {\r\n    const connectableProto = ConnectableObservable.prototype;\r\n    return {\r\n        operator: { value: null },\r\n        _refCount: { value: 0, writable: true },\r\n        _subject: { value: null, writable: true },\r\n        _connection: { value: null, writable: true },\r\n        _subscribe: { value: connectableProto._subscribe },\r\n        _isComplete: { value: connectableProto._isComplete, writable: true },\r\n        getSubject: { value: connectableProto.getSubject },\r\n        connect: { value: connectableProto.connect },\r\n        refCount: { value: connectableProto.refCount }\r\n    };\r\n})();\r\nclass ConnectableSubscriber extends SubjectSubscriber {\r\n    constructor(destination, connectable) {\r\n        super(destination);\r\n        this.connectable = connectable;\r\n    }\r\n    _error(err) {\r\n        this._unsubscribe();\r\n        super._error(err);\r\n    }\r\n    _complete() {\r\n        this.connectable._isComplete = true;\r\n        this._unsubscribe();\r\n        super._complete();\r\n    }\r\n    _unsubscribe() {\r\n        const connectable = this.connectable;\r\n        if (connectable) {\r\n            this.connectable = null;\r\n            const connection = connectable._connection;\r\n            connectable._refCount = 0;\r\n            connectable._subject = null;\r\n            connectable._connection = null;\r\n            if (connection) {\r\n                connection.unsubscribe();\r\n            }\r\n        }\r\n    }\r\n}\r\nclass RefCountOperator {\r\n    constructor(connectable) {\r\n        this.connectable = connectable;\r\n    }\r\n    call(subscriber, source) {\r\n        const { connectable } = this;\r\n        connectable._refCount++;\r\n        const refCounter = new RefCountSubscriber(subscriber, connectable);\r\n        const subscription = source.subscribe(refCounter);\r\n        if (!refCounter.closed) {\r\n            refCounter.connection = connectable.connect();\r\n        }\r\n        return subscription;\r\n    }\r\n}\r\nclass RefCountSubscriber extends Subscriber {\r\n    constructor(destination, connectable) {\r\n        super(destination);\r\n        this.connectable = connectable;\r\n    }\r\n    _unsubscribe() {\r\n        const { connectable } = this;\r\n        if (!connectable) {\r\n            this.connection = null;\r\n            return;\r\n        }\r\n        this.connectable = null;\r\n        const refCount = connectable._refCount;\r\n        if (refCount <= 0) {\r\n            this.connection = null;\r\n            return;\r\n        }\r\n        connectable._refCount = refCount - 1;\r\n        if (refCount > 1) {\r\n            this.connection = null;\r\n            return;\r\n        }\r\n        const { connection } = this;\r\n        const sharedConnection = connectable._connection;\r\n        this.connection = null;\r\n        if (sharedConnection && (!connection || sharedConnection === connection)) {\r\n            sharedConnection.unsubscribe();\r\n        }\r\n    }\r\n}\r\n//# sourceMappingURL=ConnectableObservable.js.map"]},"metadata":{},"sourceType":"module"}