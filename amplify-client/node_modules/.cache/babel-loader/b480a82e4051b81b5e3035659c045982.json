{"ast":null,"code":"import { Observable } from '../Observable';\nimport { identity } from '../util/identity';\nimport { isScheduler } from '../util/isScheduler';\nexport function generate(initialStateOrOptions, condition, iterate, resultSelectorOrObservable, scheduler) {\n  var resultSelector;\n  var initialState;\n\n  if (arguments.length == 1) {\n    var options = initialStateOrOptions;\n    initialState = options.initialState;\n    condition = options.condition;\n    iterate = options.iterate;\n    resultSelector = options.resultSelector || identity;\n    scheduler = options.scheduler;\n  } else if (resultSelectorOrObservable === undefined || isScheduler(resultSelectorOrObservable)) {\n    initialState = initialStateOrOptions;\n    resultSelector = identity;\n    scheduler = resultSelectorOrObservable;\n  } else {\n    initialState = initialStateOrOptions;\n    resultSelector = resultSelectorOrObservable;\n  }\n\n  return new Observable(function (subscriber) {\n    var state = initialState;\n\n    if (scheduler) {\n      return scheduler.schedule(dispatch, 0, {\n        subscriber: subscriber,\n        iterate: iterate,\n        condition: condition,\n        resultSelector: resultSelector,\n        state: state\n      });\n    }\n\n    do {\n      if (condition) {\n        var conditionResult = void 0;\n\n        try {\n          conditionResult = condition(state);\n        } catch (err) {\n          subscriber.error(err);\n          return undefined;\n        }\n\n        if (!conditionResult) {\n          subscriber.complete();\n          break;\n        }\n      }\n\n      var value = void 0;\n\n      try {\n        value = resultSelector(state);\n      } catch (err) {\n        subscriber.error(err);\n        return undefined;\n      }\n\n      subscriber.next(value);\n\n      if (subscriber.closed) {\n        break;\n      }\n\n      try {\n        state = iterate(state);\n      } catch (err) {\n        subscriber.error(err);\n        return undefined;\n      }\n    } while (true);\n\n    return undefined;\n  });\n}\n\nfunction dispatch(state) {\n  var subscriber = state.subscriber,\n      condition = state.condition;\n\n  if (subscriber.closed) {\n    return undefined;\n  }\n\n  if (state.needIterate) {\n    try {\n      state.state = state.iterate(state.state);\n    } catch (err) {\n      subscriber.error(err);\n      return undefined;\n    }\n  } else {\n    state.needIterate = true;\n  }\n\n  if (condition) {\n    var conditionResult;\n\n    try {\n      conditionResult = condition(state.state);\n    } catch (err) {\n      subscriber.error(err);\n      return undefined;\n    }\n\n    if (!conditionResult) {\n      subscriber.complete();\n      return undefined;\n    }\n\n    if (subscriber.closed) {\n      return undefined;\n    }\n  }\n\n  var value;\n\n  try {\n    value = state.resultSelector(state.state);\n  } catch (err) {\n    subscriber.error(err);\n    return undefined;\n  }\n\n  if (subscriber.closed) {\n    return undefined;\n  }\n\n  subscriber.next(value);\n\n  if (subscriber.closed) {\n    return undefined;\n  }\n\n  return this.schedule(state);\n}","map":{"version":3,"sources":["../../../src/internal/observable/generate.ts"],"names":[],"mappings":"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","sourcesContent":["import { Observable } from '../Observable';\r\nimport { identity } from '../util/identity';\r\nimport { isScheduler } from '../util/isScheduler';\r\nexport function generate(initialStateOrOptions, condition, iterate, resultSelectorOrObservable, scheduler) {\r\n    let resultSelector;\r\n    let initialState;\r\n    if (arguments.length == 1) {\r\n        const options = initialStateOrOptions;\r\n        initialState = options.initialState;\r\n        condition = options.condition;\r\n        iterate = options.iterate;\r\n        resultSelector = options.resultSelector || identity;\r\n        scheduler = options.scheduler;\r\n    }\r\n    else if (resultSelectorOrObservable === undefined || isScheduler(resultSelectorOrObservable)) {\r\n        initialState = initialStateOrOptions;\r\n        resultSelector = identity;\r\n        scheduler = resultSelectorOrObservable;\r\n    }\r\n    else {\r\n        initialState = initialStateOrOptions;\r\n        resultSelector = resultSelectorOrObservable;\r\n    }\r\n    return new Observable(subscriber => {\r\n        let state = initialState;\r\n        if (scheduler) {\r\n            return scheduler.schedule(dispatch, 0, {\r\n                subscriber,\r\n                iterate,\r\n                condition,\r\n                resultSelector,\r\n                state\r\n            });\r\n        }\r\n        do {\r\n            if (condition) {\r\n                let conditionResult;\r\n                try {\r\n                    conditionResult = condition(state);\r\n                }\r\n                catch (err) {\r\n                    subscriber.error(err);\r\n                    return undefined;\r\n                }\r\n                if (!conditionResult) {\r\n                    subscriber.complete();\r\n                    break;\r\n                }\r\n            }\r\n            let value;\r\n            try {\r\n                value = resultSelector(state);\r\n            }\r\n            catch (err) {\r\n                subscriber.error(err);\r\n                return undefined;\r\n            }\r\n            subscriber.next(value);\r\n            if (subscriber.closed) {\r\n                break;\r\n            }\r\n            try {\r\n                state = iterate(state);\r\n            }\r\n            catch (err) {\r\n                subscriber.error(err);\r\n                return undefined;\r\n            }\r\n        } while (true);\r\n        return undefined;\r\n    });\r\n}\r\nfunction dispatch(state) {\r\n    const { subscriber, condition } = state;\r\n    if (subscriber.closed) {\r\n        return undefined;\r\n    }\r\n    if (state.needIterate) {\r\n        try {\r\n            state.state = state.iterate(state.state);\r\n        }\r\n        catch (err) {\r\n            subscriber.error(err);\r\n            return undefined;\r\n        }\r\n    }\r\n    else {\r\n        state.needIterate = true;\r\n    }\r\n    if (condition) {\r\n        let conditionResult;\r\n        try {\r\n            conditionResult = condition(state.state);\r\n        }\r\n        catch (err) {\r\n            subscriber.error(err);\r\n            return undefined;\r\n        }\r\n        if (!conditionResult) {\r\n            subscriber.complete();\r\n            return undefined;\r\n        }\r\n        if (subscriber.closed) {\r\n            return undefined;\r\n        }\r\n    }\r\n    let value;\r\n    try {\r\n        value = state.resultSelector(state.state);\r\n    }\r\n    catch (err) {\r\n        subscriber.error(err);\r\n        return undefined;\r\n    }\r\n    if (subscriber.closed) {\r\n        return undefined;\r\n    }\r\n    subscriber.next(value);\r\n    if (subscriber.closed) {\r\n        return undefined;\r\n    }\r\n    return this.schedule(state);\r\n}\r\n//# sourceMappingURL=generate.js.map"]},"metadata":{},"sourceType":"module"}