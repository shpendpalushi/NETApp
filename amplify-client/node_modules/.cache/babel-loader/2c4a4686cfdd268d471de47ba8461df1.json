{"ast":null,"code":"/**\r\n * DevExtreme (data/array_utils.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar _type = require(\"../core/utils/type\");\n\nvar _config = require(\"../core/config\");\n\nvar _config2 = _interopRequireDefault(_config);\n\nvar _guid = require(\"../core/guid\");\n\nvar _guid2 = _interopRequireDefault(_guid);\n\nvar _extend = require(\"../core/utils/extend\");\n\nvar _errors = require(\"./errors\");\n\nvar _object = require(\"../core/utils/object\");\n\nvar _object2 = _interopRequireDefault(_object);\n\nvar _utils = require(\"./utils\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nfunction _typeof(obj) {\n  if (\"function\" === typeof Symbol && \"symbol\" === typeof Symbol.iterator) {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && \"function\" === typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction hasKey(target, keyOrKeys) {\n  var key;\n  var keys = \"string\" === typeof keyOrKeys ? keyOrKeys.split() : keyOrKeys.slice();\n\n  while (keys.length) {\n    key = keys.shift();\n\n    if (key in target) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nfunction findItems(keyInfo, items, key, groupCount) {\n  var childItems;\n  var result;\n\n  if (groupCount) {\n    for (var i = 0; i < items.length; i++) {\n      childItems = items[i].items || items[i].collapsedItems || [];\n      result = findItems(keyInfo, childItems || [], key, groupCount - 1);\n\n      if (result) {\n        return result;\n      }\n    }\n  } else {\n    if (indexByKey(keyInfo, items, key) >= 0) {\n      return items;\n    }\n  }\n}\n\nfunction getItems(keyInfo, items, key, groupCount) {\n  if (groupCount) {\n    return findItems(keyInfo, items, key, groupCount) || [];\n  }\n\n  return items;\n}\n\nfunction generateDataByKeyMap(keyInfo, array) {\n  if (keyInfo.key() && (!array._dataByKeyMap || array._dataByKeyMapLength !== array.length)) {\n    var dataByKeyMap = {};\n\n    for (var i = 0, arrayLength = array.length; i < arrayLength; i++) {\n      dataByKeyMap[JSON.stringify(keyInfo.keyOf(array[i]))] = array[i];\n    }\n\n    array._dataByKeyMap = dataByKeyMap;\n    array._dataByKeyMapLength = arrayLength;\n  }\n}\n\nfunction getCacheValue(array, key) {\n  if (array._dataByKeyMap) {\n    return array._dataByKeyMap[JSON.stringify(key)];\n  }\n}\n\nfunction getHasKeyCacheValue(array, key) {\n  if (array._dataByKeyMap) {\n    return array._dataByKeyMap[JSON.stringify(key)];\n  }\n\n  return true;\n}\n\nfunction setDataByKeyMapValue(array, key, data) {\n  if (array._dataByKeyMap) {\n    array._dataByKeyMap[JSON.stringify(key)] = data;\n  }\n}\n\nfunction applyBatch(keyInfo, array, batchData, groupCount, useInsertIndex) {\n  batchData.forEach(function (item) {\n    var items = \"insert\" === item.type ? array : getItems(keyInfo, array, item.key, groupCount);\n    generateDataByKeyMap(keyInfo, items);\n\n    switch (item.type) {\n      case \"update\":\n        update(keyInfo, items, item.key, item.data, true);\n        break;\n\n      case \"insert\":\n        insert(keyInfo, items, item.data, useInsertIndex && (0, _type.isDefined)(item.index) ? item.index : -1, true);\n        break;\n\n      case \"remove\":\n        remove(keyInfo, items, item.key, true);\n    }\n  });\n}\n\nfunction update(keyInfo, array, key, data, isBatch) {\n  var target;\n  var extendComplexObject = true;\n  var keyExpr = keyInfo.key();\n\n  if (keyExpr) {\n    if (hasKey(data, keyExpr) && !(0, _utils.keysEqual)(key, keyInfo.keyOf(data))) {\n      return !isBatch && (0, _utils.rejectedPromise)(_errors.errors.Error(\"E4017\"));\n    }\n\n    target = getCacheValue(array, key);\n\n    if (!target) {\n      var index = indexByKey(keyInfo, array, key);\n\n      if (index < 0) {\n        return !isBatch && (0, _utils.rejectedPromise)(_errors.errors.Error(\"E4009\"));\n      }\n\n      target = array[index];\n    }\n  } else {\n    target = key;\n  }\n\n  _object2.default.deepExtendArraySafe(target, data, extendComplexObject);\n\n  if (!isBatch) {\n    if ((0, _config2.default)().useLegacyStoreResult) {\n      return (0, _utils.trivialPromise)(key, data);\n    } else {\n      return (0, _utils.trivialPromise)(target, key);\n    }\n  }\n}\n\nfunction insert(keyInfo, array, data, index, isBatch) {\n  var keyValue;\n  var obj;\n  var keyExpr = keyInfo.key();\n  obj = (0, _type.isPlainObject)(data) ? (0, _extend.extend)({}, data) : data;\n\n  if (keyExpr) {\n    keyValue = keyInfo.keyOf(obj);\n\n    if (void 0 === keyValue || \"object\" === _typeof(keyValue) && (0, _type.isEmptyObject)(keyValue)) {\n      if (Array.isArray(keyExpr)) {\n        throw _errors.errors.Error(\"E4007\");\n      }\n\n      keyValue = obj[keyExpr] = String(new _guid2.default());\n    } else {\n      if (void 0 !== array[indexByKey(keyInfo, array, keyValue)]) {\n        return !isBatch && (0, _utils.rejectedPromise)(_errors.errors.Error(\"E4008\"));\n      }\n    }\n  } else {\n    keyValue = obj;\n  }\n\n  if (index >= 0) {\n    array.splice(index, 0, obj);\n  } else {\n    array.push(obj);\n  }\n\n  setDataByKeyMapValue(array, keyValue, obj);\n\n  if (!isBatch) {\n    return (0, _utils.trivialPromise)((0, _config2.default)().useLegacyStoreResult ? data : obj, keyValue);\n  }\n}\n\nfunction remove(keyInfo, array, key, isBatch) {\n  var index = indexByKey(keyInfo, array, key);\n\n  if (index > -1) {\n    array.splice(index, 1);\n  }\n\n  if (!isBatch) {\n    return (0, _utils.trivialPromise)(key);\n  }\n}\n\nfunction indexByKey(keyInfo, array, key) {\n  if (!getHasKeyCacheValue(array, key)) {\n    return -1;\n  }\n\n  for (var i = 0, arrayLength = array.length; i < arrayLength; i++) {\n    if ((0, _utils.keysEqual)(keyInfo.keyOf(array[i]), key)) {\n      return i;\n    }\n  }\n\n  return -1;\n}\n\nmodule.exports.applyBatch = applyBatch;\nmodule.exports.update = update;\nmodule.exports.insert = insert;\nmodule.exports.remove = remove;\nmodule.exports.indexByKey = indexByKey;","map":{"version":3,"sources":["C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/devextreme/data/array_utils.js"],"names":["_type","require","_config","_config2","_interopRequireDefault","_guid","_guid2","_extend","_errors","_object","_object2","_utils","obj","Symbol","_typeof","keys","keyOrKeys","key","i","items","childItems","result","findItems","groupCount","indexByKey","keyInfo","array","dataByKeyMap","arrayLength","JSON","batchData","item","getItems","generateDataByKeyMap","update","insert","useInsertIndex","remove","extendComplexObject","keyExpr","hasKey","target","getCacheValue","index","keyValue","Array","String","setDataByKeyMapValue","getHasKeyCacheValue","module"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (data/array_utils.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar _type = require(\"../core/utils/type\");\r\nvar _config = require(\"../core/config\");\r\nvar _config2 = _interopRequireDefault(_config);\r\nvar _guid = require(\"../core/guid\");\r\nvar _guid2 = _interopRequireDefault(_guid);\r\nvar _extend = require(\"../core/utils/extend\");\r\nvar _errors = require(\"./errors\");\r\nvar _object = require(\"../core/utils/object\");\r\nvar _object2 = _interopRequireDefault(_object);\r\nvar _utils = require(\"./utils\");\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\n\r\nfunction _typeof(obj) {\r\n    if (\"function\" === typeof Symbol && \"symbol\" === typeof Symbol.iterator) {\r\n        _typeof = function(obj) {\r\n            return typeof obj\r\n        }\r\n    } else {\r\n        _typeof = function(obj) {\r\n            return obj && \"function\" === typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj\r\n        }\r\n    }\r\n    return _typeof(obj)\r\n}\r\n\r\nfunction hasKey(target, keyOrKeys) {\r\n    var key;\r\n    var keys = \"string\" === typeof keyOrKeys ? keyOrKeys.split() : keyOrKeys.slice();\r\n    while (keys.length) {\r\n        key = keys.shift();\r\n        if (key in target) {\r\n            return true\r\n        }\r\n    }\r\n    return false\r\n}\r\n\r\nfunction findItems(keyInfo, items, key, groupCount) {\r\n    var childItems;\r\n    var result;\r\n    if (groupCount) {\r\n        for (var i = 0; i < items.length; i++) {\r\n            childItems = items[i].items || items[i].collapsedItems || [];\r\n            result = findItems(keyInfo, childItems || [], key, groupCount - 1);\r\n            if (result) {\r\n                return result\r\n            }\r\n        }\r\n    } else {\r\n        if (indexByKey(keyInfo, items, key) >= 0) {\r\n            return items\r\n        }\r\n    }\r\n}\r\n\r\nfunction getItems(keyInfo, items, key, groupCount) {\r\n    if (groupCount) {\r\n        return findItems(keyInfo, items, key, groupCount) || []\r\n    }\r\n    return items\r\n}\r\n\r\nfunction generateDataByKeyMap(keyInfo, array) {\r\n    if (keyInfo.key() && (!array._dataByKeyMap || array._dataByKeyMapLength !== array.length)) {\r\n        var dataByKeyMap = {};\r\n        for (var i = 0, arrayLength = array.length; i < arrayLength; i++) {\r\n            dataByKeyMap[JSON.stringify(keyInfo.keyOf(array[i]))] = array[i]\r\n        }\r\n        array._dataByKeyMap = dataByKeyMap;\r\n        array._dataByKeyMapLength = arrayLength\r\n    }\r\n}\r\n\r\nfunction getCacheValue(array, key) {\r\n    if (array._dataByKeyMap) {\r\n        return array._dataByKeyMap[JSON.stringify(key)]\r\n    }\r\n}\r\n\r\nfunction getHasKeyCacheValue(array, key) {\r\n    if (array._dataByKeyMap) {\r\n        return array._dataByKeyMap[JSON.stringify(key)]\r\n    }\r\n    return true\r\n}\r\n\r\nfunction setDataByKeyMapValue(array, key, data) {\r\n    if (array._dataByKeyMap) {\r\n        array._dataByKeyMap[JSON.stringify(key)] = data\r\n    }\r\n}\r\n\r\nfunction applyBatch(keyInfo, array, batchData, groupCount, useInsertIndex) {\r\n    batchData.forEach(function(item) {\r\n        var items = \"insert\" === item.type ? array : getItems(keyInfo, array, item.key, groupCount);\r\n        generateDataByKeyMap(keyInfo, items);\r\n        switch (item.type) {\r\n            case \"update\":\r\n                update(keyInfo, items, item.key, item.data, true);\r\n                break;\r\n            case \"insert\":\r\n                insert(keyInfo, items, item.data, useInsertIndex && (0, _type.isDefined)(item.index) ? item.index : -1, true);\r\n                break;\r\n            case \"remove\":\r\n                remove(keyInfo, items, item.key, true)\r\n        }\r\n    })\r\n}\r\n\r\nfunction update(keyInfo, array, key, data, isBatch) {\r\n    var target;\r\n    var extendComplexObject = true;\r\n    var keyExpr = keyInfo.key();\r\n    if (keyExpr) {\r\n        if (hasKey(data, keyExpr) && !(0, _utils.keysEqual)(key, keyInfo.keyOf(data))) {\r\n            return !isBatch && (0, _utils.rejectedPromise)(_errors.errors.Error(\"E4017\"))\r\n        }\r\n        target = getCacheValue(array, key);\r\n        if (!target) {\r\n            var index = indexByKey(keyInfo, array, key);\r\n            if (index < 0) {\r\n                return !isBatch && (0, _utils.rejectedPromise)(_errors.errors.Error(\"E4009\"))\r\n            }\r\n            target = array[index]\r\n        }\r\n    } else {\r\n        target = key\r\n    }\r\n    _object2.default.deepExtendArraySafe(target, data, extendComplexObject);\r\n    if (!isBatch) {\r\n        if ((0, _config2.default)().useLegacyStoreResult) {\r\n            return (0, _utils.trivialPromise)(key, data)\r\n        } else {\r\n            return (0, _utils.trivialPromise)(target, key)\r\n        }\r\n    }\r\n}\r\n\r\nfunction insert(keyInfo, array, data, index, isBatch) {\r\n    var keyValue;\r\n    var obj;\r\n    var keyExpr = keyInfo.key();\r\n    obj = (0, _type.isPlainObject)(data) ? (0, _extend.extend)({}, data) : data;\r\n    if (keyExpr) {\r\n        keyValue = keyInfo.keyOf(obj);\r\n        if (void 0 === keyValue || \"object\" === _typeof(keyValue) && (0, _type.isEmptyObject)(keyValue)) {\r\n            if (Array.isArray(keyExpr)) {\r\n                throw _errors.errors.Error(\"E4007\")\r\n            }\r\n            keyValue = obj[keyExpr] = String(new _guid2.default)\r\n        } else {\r\n            if (void 0 !== array[indexByKey(keyInfo, array, keyValue)]) {\r\n                return !isBatch && (0, _utils.rejectedPromise)(_errors.errors.Error(\"E4008\"))\r\n            }\r\n        }\r\n    } else {\r\n        keyValue = obj\r\n    }\r\n    if (index >= 0) {\r\n        array.splice(index, 0, obj)\r\n    } else {\r\n        array.push(obj)\r\n    }\r\n    setDataByKeyMapValue(array, keyValue, obj);\r\n    if (!isBatch) {\r\n        return (0, _utils.trivialPromise)((0, _config2.default)().useLegacyStoreResult ? data : obj, keyValue)\r\n    }\r\n}\r\n\r\nfunction remove(keyInfo, array, key, isBatch) {\r\n    var index = indexByKey(keyInfo, array, key);\r\n    if (index > -1) {\r\n        array.splice(index, 1)\r\n    }\r\n    if (!isBatch) {\r\n        return (0, _utils.trivialPromise)(key)\r\n    }\r\n}\r\n\r\nfunction indexByKey(keyInfo, array, key) {\r\n    if (!getHasKeyCacheValue(array, key)) {\r\n        return -1\r\n    }\r\n    for (var i = 0, arrayLength = array.length; i < arrayLength; i++) {\r\n        if ((0, _utils.keysEqual)(keyInfo.keyOf(array[i]), key)) {\r\n            return i\r\n        }\r\n    }\r\n    return -1\r\n}\r\nmodule.exports.applyBatch = applyBatch;\r\nmodule.exports.update = update;\r\nmodule.exports.insert = insert;\r\nmodule.exports.remove = remove;\r\nmodule.exports.indexByKey = indexByKey;\r\n"]},"metadata":{},"sourceType":"module"}