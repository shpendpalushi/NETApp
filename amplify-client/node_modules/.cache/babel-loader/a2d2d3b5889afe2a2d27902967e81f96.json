{"ast":null,"code":"/**\r\n * DevExtreme (ui/grid_core/ui.grid_core.grid_view.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar _renderer = require(\"../../core/renderer\");\n\nvar _renderer2 = _interopRequireDefault(_renderer);\n\nvar _uiGrid_core = require(\"./ui.grid_core.modules\");\n\nvar _uiGrid_core2 = _interopRequireDefault(_uiGrid_core);\n\nvar _common = require(\"../../core/utils/common\");\n\nvar _common2 = _interopRequireDefault(_common);\n\nvar _window = require(\"../../core/utils/window\");\n\nvar _window2 = _interopRequireDefault(_window);\n\nvar _iterator = require(\"../../core/utils/iterator\");\n\nvar _type = require(\"../../core/utils/type\");\n\nvar _type2 = _interopRequireDefault(_type);\n\nvar _uiGrid_core3 = require(\"./ui.grid_core.utils\");\n\nvar _uiGrid_core4 = _interopRequireDefault(_uiGrid_core3);\n\nvar _message = require(\"../../localization/message\");\n\nvar _message2 = _interopRequireDefault(_message);\n\nvar _deferred = require(\"../../core/utils/deferred\");\n\nvar _dom_adapter = require(\"../../core/dom_adapter\");\n\nvar _dom_adapter2 = _interopRequireDefault(_dom_adapter);\n\nvar _browser = require(\"../../core/utils/browser\");\n\nvar _browser2 = _interopRequireDefault(_browser);\n\nvar _accessibility = require(\"../shared/accessibility\");\n\nvar _accessibility2 = _interopRequireDefault(_accessibility);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nvar TABLE_CLASS = \"table\";\nvar BORDERS_CLASS = \"borders\";\nvar TABLE_FIXED_CLASS = \"table-fixed\";\nvar IMPORTANT_MARGIN_CLASS = \"important-margin\";\nvar TEXT_CONTENT_CLASS = \"text-content\";\nvar HIDDEN_CLASS = \"dx-hidden\";\nvar GRIDBASE_CONTAINER_CLASS = \"dx-gridbase-container\";\nvar HIDDEN_COLUMNS_WIDTH = \"adaptiveHidden\";\nvar EDITORS_INPUT_SELECTOR = \"input:not([type='hidden'])\";\nvar VIEW_NAMES = [\"columnsSeparatorView\", \"blockSeparatorView\", \"trackerView\", \"headerPanel\", \"columnHeadersView\", \"rowsView\", \"footerView\", \"columnChooserView\", \"filterPanelView\", \"pagerView\", \"draggingHeaderView\", \"contextMenuView\", \"errorView\", \"headerFilterView\", \"filterBuilderView\"];\n\nvar isPercentWidth = function isPercentWidth(width) {\n  return _type2.default.isString(width) && \"%\" === width.slice(-1);\n};\n\nvar isPixelWidth = function isPixelWidth(width) {\n  return _type2.default.isString(width) && \"px\" === width.slice(-2);\n};\n\nvar mergeArraysByMaxValue = function mergeArraysByMaxValue(values1, values2) {\n  var result = [];\n  var i;\n\n  if (values1 && values2 && values1.length && values1.length === values2.length) {\n    for (i = 0; i < values1.length; i++) {\n      result.push(values1[i] > values2[i] ? values1[i] : values2[i]);\n    }\n  } else {\n    if (values1 && values1.length) {\n      result = values1;\n    } else {\n      if (values2) {\n        result = values2;\n      }\n    }\n  }\n\n  return result;\n};\n\nvar getContainerHeight = function getContainerHeight($container) {\n  var clientHeight = $container.get(0).clientHeight;\n  var paddingTop = parseFloat($container.css(\"paddingTop\"));\n  var paddingBottom = parseFloat($container.css(\"paddingBottom\"));\n  return clientHeight - paddingTop - paddingBottom;\n};\n\nvar calculateFreeWidth = function calculateFreeWidth(that, widths) {\n  var contentWidth = that._rowsView.contentWidth();\n\n  var totalWidth = that._getTotalWidth(widths, contentWidth);\n\n  return contentWidth - totalWidth;\n};\n\nvar calculateFreeWidthWithCurrentMinWidth = function calculateFreeWidthWithCurrentMinWidth(that, columnIndex, currentMinWidth, widths) {\n  return calculateFreeWidth(that, widths.map(function (width, index) {\n    return index === columnIndex ? currentMinWidth : width;\n  }));\n};\n\nvar restoreFocus = function restoreFocus(focusedElement, selectionRange) {\n  _accessibility2.default.hiddenFocus(focusedElement);\n\n  _uiGrid_core4.default.setSelectionRange(focusedElement, selectionRange);\n};\n\nvar ResizingController = _uiGrid_core2.default.ViewController.inherit({\n  _initPostRenderHandlers: function _initPostRenderHandlers() {\n    var that = this;\n    var dataController = that._dataController;\n\n    if (!that._refreshSizesHandler) {\n      that._refreshSizesHandler = function (e) {\n        dataController.changed.remove(that._refreshSizesHandler);\n        var resizeDeferred;\n        var changeType = e && e.changeType;\n        var isDelayed = e && e.isDelayed;\n        var items = dataController.items();\n\n        if (!e || \"refresh\" === changeType || \"prepend\" === changeType || \"append\" === changeType) {\n          if (!isDelayed) {\n            resizeDeferred = that.resize();\n          }\n        } else {\n          if (\"update\" === changeType && e.changeTypes) {\n            if ((items.length > 1 || \"insert\" !== e.changeTypes[0]) && !(0 === items.length && \"remove\" === e.changeTypes[0]) && !e.needUpdateDimensions) {\n              _common2.default.deferUpdate(function () {\n                that._rowsView.resize();\n              });\n            } else {\n              resizeDeferred = that.resize();\n            }\n          }\n        }\n\n        if (changeType && \"updateSelection\" !== changeType && \"updateFocusedRow\" !== changeType && !isDelayed) {\n          (0, _deferred.when)(resizeDeferred).done(function () {\n            that._setAriaRowColCount();\n\n            that.fireContentReadyAction();\n          });\n        }\n      };\n\n      that._dataController.changed.add(function () {\n        that._dataController.changed.add(that._refreshSizesHandler);\n      });\n    }\n  },\n  fireContentReadyAction: function fireContentReadyAction() {\n    this.component._fireContentReadyAction();\n  },\n  _setAriaRowColCount: function _setAriaRowColCount() {\n    var component = this.component;\n    component.setAria({\n      rowCount: this._dataController.totalItemsCount(),\n      colCount: component.columnCount()\n    }, component.$element().children(\".\" + GRIDBASE_CONTAINER_CLASS));\n  },\n  _getBestFitWidths: function _getBestFitWidths() {\n    if (!this.option(\"legacyRendering\")) {\n      return this._rowsView.getColumnWidths();\n    }\n\n    var that = this;\n    var rowsColumnWidths;\n    var headerColumnWidths;\n    var footerColumnWidths;\n    var resultWidths;\n    rowsColumnWidths = that._rowsView.getColumnWidths();\n    headerColumnWidths = that._columnHeadersView && that._columnHeadersView.getColumnWidths();\n    footerColumnWidths = that._footerView && that._footerView.getColumnWidths();\n    resultWidths = mergeArraysByMaxValue(rowsColumnWidths, headerColumnWidths);\n    resultWidths = mergeArraysByMaxValue(resultWidths, footerColumnWidths);\n    return resultWidths;\n  },\n  _setVisibleWidths: function _setVisibleWidths(visibleColumns, widths) {\n    var columnsController = this._columnsController;\n    columnsController.beginUpdate();\n    (0, _iterator.each)(visibleColumns, function (index, column) {\n      var columnId = columnsController.getColumnId(column);\n      columnsController.columnOption(columnId, \"visibleWidth\", widths[index]);\n    });\n    columnsController.endUpdate();\n  },\n  _toggleBestFitModeForView: function _toggleBestFitModeForView(view, className, isBestFit) {\n    var _this = this;\n\n    if (!view || !view.isVisible()) {\n      return;\n    }\n\n    var $rowsTables = this._rowsView.getTableElements();\n\n    var $viewTables = view.getTableElements();\n    (0, _iterator.each)($rowsTables, function (index, tableElement) {\n      var $tableBody;\n      var $rowsTable = (0, _renderer2.default)(tableElement);\n      var $viewTable = $viewTables.eq(index);\n\n      if ($viewTable && $viewTable.length) {\n        if (isBestFit) {\n          $tableBody = $viewTable.children(\"tbody\").appendTo($rowsTable);\n        } else {\n          $tableBody = $rowsTable.children(\".\" + className).appendTo($viewTable);\n        }\n\n        $tableBody.toggleClass(className, isBestFit);\n        $tableBody.toggleClass(_this.addWidgetPrefix(\"best-fit\"), isBestFit);\n      }\n    });\n  },\n  _toggleBestFitMode: function _toggleBestFitMode(isBestFit) {\n    var $element = this.component.$element();\n    var that = this;\n\n    if (!that.option(\"legacyRendering\")) {\n      var $rowsTable = that._rowsView._getTableElement();\n\n      var $rowsFixedTable = that._rowsView.getTableElements().eq(1);\n\n      $rowsTable.css(\"tableLayout\", isBestFit ? \"auto\" : \"fixed\");\n      $rowsTable.children(\"colgroup\").css(\"display\", isBestFit ? \"none\" : \"\");\n      $rowsFixedTable.toggleClass(this.addWidgetPrefix(TABLE_FIXED_CLASS), !isBestFit);\n\n      that._toggleBestFitModeForView(that._columnHeadersView, \"dx-header\", isBestFit);\n\n      that._toggleBestFitModeForView(that._footerView, \"dx-footer\", isBestFit);\n\n      if (that._needStretch()) {\n        $rowsTable.get(0).style.width = isBestFit ? \"auto\" : \"\";\n      }\n\n      if (_browser2.default.msie && 11 === parseInt(_browser2.default.version)) {\n        $rowsTable.find(\".\" + this.addWidgetPrefix(TABLE_FIXED_CLASS)).each(function () {\n          this.style.width = isBestFit ? \"10px\" : \"\";\n        });\n      }\n    } else {\n      $element.find(\".\" + this.addWidgetPrefix(TABLE_CLASS)).toggleClass(this.addWidgetPrefix(TABLE_FIXED_CLASS), !isBestFit);\n      $element.find(EDITORS_INPUT_SELECTOR).toggleClass(HIDDEN_CLASS, isBestFit);\n      $element.find(\".dx-group-cell\").toggleClass(HIDDEN_CLASS, isBestFit);\n      $element.find(\".dx-header-row .\" + this.addWidgetPrefix(TEXT_CONTENT_CLASS)).css(\"maxWidth\", \"\");\n    }\n  },\n  _synchronizeColumns: function _synchronizeColumns() {\n    var that = this;\n    var columnsController = that._columnsController;\n    var visibleColumns = columnsController.getVisibleColumns();\n    var columnAutoWidth = that.option(\"columnAutoWidth\");\n    var legacyRendering = that.option(\"legacyRendering\");\n\n    var needBestFit = that._needBestFit();\n\n    var hasMinWidth = false;\n    var resetBestFitMode;\n    var isColumnWidthsCorrected = false;\n    var resultWidths = [];\n    var focusedElement;\n    var isFocusOutsideWindow;\n    var selectionRange;\n\n    var normalizeWidthsByExpandColumns = function normalizeWidthsByExpandColumns() {\n      var expandColumnWidth;\n      (0, _iterator.each)(visibleColumns, function (index, column) {\n        if (\"groupExpand\" === column.type) {\n          expandColumnWidth = resultWidths[index];\n        }\n      });\n      (0, _iterator.each)(visibleColumns, function (index, column) {\n        if (\"groupExpand\" === column.type && expandColumnWidth) {\n          resultWidths[index] = expandColumnWidth;\n        }\n      });\n    };\n\n    !needBestFit && (0, _iterator.each)(visibleColumns, function (index, column) {\n      if (\"auto\" === column.width || legacyRendering && column.fixed) {\n        needBestFit = true;\n        return false;\n      }\n    });\n    (0, _iterator.each)(visibleColumns, function (index, column) {\n      if (column.minWidth) {\n        hasMinWidth = true;\n        return false;\n      }\n    });\n\n    that._setVisibleWidths(visibleColumns, []);\n\n    if (needBestFit) {\n      focusedElement = _dom_adapter2.default.getActiveElement();\n      selectionRange = _uiGrid_core4.default.getSelectionRange(focusedElement);\n\n      that._toggleBestFitMode(true);\n\n      resetBestFitMode = true;\n    }\n\n    _common2.default.deferUpdate(function () {\n      if (needBestFit) {\n        resultWidths = that._getBestFitWidths();\n        (0, _iterator.each)(visibleColumns, function (index, column) {\n          var columnId = columnsController.getColumnId(column);\n          columnsController.columnOption(columnId, \"bestFitWidth\", resultWidths[index], true);\n        });\n      } else {\n        if (hasMinWidth) {\n          resultWidths = that._getBestFitWidths();\n        }\n      }\n\n      (0, _iterator.each)(visibleColumns, function (index) {\n        var width = this.width;\n\n        if (\"auto\" !== width) {\n          if (_type2.default.isDefined(width)) {\n            resultWidths[index] = _type2.default.isNumeric(width) || isPixelWidth(width) ? parseFloat(width) : width;\n          } else {\n            if (!columnAutoWidth) {\n              resultWidths[index] = void 0;\n            }\n          }\n        }\n      });\n\n      if (resetBestFitMode) {\n        that._toggleBestFitMode(false);\n\n        resetBestFitMode = false;\n\n        if (focusedElement && focusedElement !== _dom_adapter2.default.getActiveElement()) {\n          isFocusOutsideWindow = focusedElement.getBoundingClientRect().bottom < 0;\n\n          if (!isFocusOutsideWindow) {\n            if (_browser2.default.msie) {\n              setTimeout(function () {\n                restoreFocus(focusedElement, selectionRange);\n              });\n            } else {\n              restoreFocus(focusedElement, selectionRange);\n            }\n          }\n        }\n      }\n\n      isColumnWidthsCorrected = that._correctColumnWidths(resultWidths, visibleColumns);\n\n      if (columnAutoWidth) {\n        normalizeWidthsByExpandColumns();\n\n        if (that._needStretch()) {\n          that._processStretch(resultWidths, visibleColumns);\n        }\n      }\n\n      _common2.default.deferRender(function () {\n        if (needBestFit || isColumnWidthsCorrected) {\n          that._setVisibleWidths(visibleColumns, resultWidths);\n        }\n      });\n    });\n  },\n  _needBestFit: function _needBestFit() {\n    return this.option(\"columnAutoWidth\");\n  },\n  _needStretch: function _needStretch() {\n    return this.option(\"legacyRendering\") || this._columnsController.getVisibleColumns().some(function (c) {\n      return \"auto\" === c.width && !c.command;\n    });\n  },\n  _getAverageColumnsWidth: function _getAverageColumnsWidth(resultWidths) {\n    var freeWidth = calculateFreeWidth(this, resultWidths);\n    var columnCountWithoutWidth = resultWidths.filter(function (width) {\n      return void 0 === width;\n    }).length;\n    return freeWidth / columnCountWithoutWidth;\n  },\n  _correctColumnWidths: function _correctColumnWidths(resultWidths, visibleColumns) {\n    var that = this;\n    var i;\n    var hasPercentWidth = false;\n    var hasAutoWidth = false;\n    var isColumnWidthsCorrected = false;\n    var $element = that.component.$element();\n    var hasWidth = that._hasWidth;\n    var averageColumnsWidth;\n    var lastColumnIndex;\n\n    for (i = 0; i < visibleColumns.length; i++) {\n      var index = i;\n      var column = visibleColumns[index];\n      var isHiddenColumn = resultWidths[index] === HIDDEN_COLUMNS_WIDTH;\n      var width = resultWidths[index];\n      var minWidth = column.minWidth;\n\n      if (minWidth) {\n        if (void 0 === width) {\n          averageColumnsWidth = that._getAverageColumnsWidth(resultWidths);\n          width = averageColumnsWidth;\n        } else {\n          if (isPercentWidth(width)) {\n            var freeWidth = calculateFreeWidthWithCurrentMinWidth(that, index, minWidth, resultWidths);\n\n            if (freeWidth < 0) {\n              width = -1;\n            }\n          }\n        }\n      }\n\n      if (minWidth && that._getRealColumnWidth(width) < minWidth && !isHiddenColumn) {\n        resultWidths[index] = minWidth;\n        isColumnWidthsCorrected = true;\n        i = -1;\n      }\n\n      if (!_type2.default.isDefined(column.width)) {\n        hasAutoWidth = true;\n      }\n\n      if (isPercentWidth(column.width)) {\n        hasPercentWidth = true;\n      }\n    }\n\n    if ($element && that._maxWidth) {\n      delete that._maxWidth;\n      $element.css(\"maxWidth\", \"\");\n    }\n\n    if (!hasAutoWidth && resultWidths.length) {\n      var contentWidth = that._rowsView.contentWidth();\n\n      var scrollbarWidth = that._rowsView.getScrollbarWidth();\n\n      var totalWidth = that._getTotalWidth(resultWidths, contentWidth);\n\n      if (totalWidth < contentWidth) {\n        lastColumnIndex = _uiGrid_core4.default.getLastResizableColumnIndex(visibleColumns, resultWidths);\n\n        if (lastColumnIndex >= 0) {\n          resultWidths[lastColumnIndex] = \"auto\";\n          isColumnWidthsCorrected = true;\n\n          if (false === hasWidth && !hasPercentWidth) {\n            that._maxWidth = totalWidth + scrollbarWidth + (that.option(\"showBorders\") ? 2 : 0);\n            $element.css(\"maxWidth\", that._maxWidth);\n          }\n        }\n      }\n    }\n\n    return isColumnWidthsCorrected;\n  },\n  _processStretch: function _processStretch(resultSizes, visibleColumns) {\n    var groupSize = this._rowsView.contentWidth();\n\n    var tableSize = this._getTotalWidth(resultSizes, groupSize);\n\n    var unusedIndexes = {\n      length: 0\n    };\n    var diff;\n    var diffElement;\n    var onePixelElementsCount;\n    var i;\n\n    if (!resultSizes.length) {\n      return;\n    }\n\n    (0, _iterator.each)(visibleColumns, function (index) {\n      if (this.width || resultSizes[index] === HIDDEN_COLUMNS_WIDTH) {\n        unusedIndexes[index] = true;\n        unusedIndexes.length++;\n      }\n    });\n    diff = groupSize - tableSize;\n    diffElement = Math.floor(diff / (resultSizes.length - unusedIndexes.length));\n    onePixelElementsCount = diff - diffElement * (resultSizes.length - unusedIndexes.length);\n\n    if (diff >= 0) {\n      for (i = 0; i < resultSizes.length; i++) {\n        if (unusedIndexes[i]) {\n          continue;\n        }\n\n        resultSizes[i] += diffElement;\n\n        if (onePixelElementsCount > 0) {\n          if (onePixelElementsCount < 1) {\n            resultSizes[i] += onePixelElementsCount;\n            onePixelElementsCount = 0;\n          } else {\n            resultSizes[i]++;\n            onePixelElementsCount--;\n          }\n        }\n      }\n    }\n  },\n  _getRealColumnWidth: function _getRealColumnWidth(width, groupWidth) {\n    if (!isPercentWidth(width)) {\n      return parseFloat(width);\n    }\n\n    groupWidth = groupWidth || this._rowsView.contentWidth();\n    return parseFloat(width) * groupWidth / 100;\n  },\n  _getTotalWidth: function _getTotalWidth(widths, groupWidth) {\n    var result = 0;\n    var width;\n    var i;\n\n    for (i = 0; i < widths.length; i++) {\n      width = widths[i];\n\n      if (width && width !== HIDDEN_COLUMNS_WIDTH) {\n        result += this._getRealColumnWidth(width, groupWidth);\n      }\n    }\n\n    return result;\n  },\n  updateSize: function updateSize($rootElement) {\n    var that = this;\n    var $groupElement;\n    var width;\n    var importantMarginClass = that.addWidgetPrefix(IMPORTANT_MARGIN_CLASS);\n\n    if (void 0 === that._hasHeight && $rootElement && $rootElement.is(\":visible\") && $rootElement.width()) {\n      $groupElement = $rootElement.children(\".\" + that.getWidgetContainerClass());\n\n      if ($groupElement.length) {\n        $groupElement.detach();\n      }\n\n      that._hasHeight = !!getContainerHeight($rootElement);\n      width = $rootElement.width();\n      $rootElement.addClass(importantMarginClass);\n      that._hasWidth = $rootElement.width() === width;\n      $rootElement.removeClass(importantMarginClass);\n\n      if ($groupElement.length) {\n        $groupElement.appendTo($rootElement);\n      }\n    }\n  },\n  publicMethods: function publicMethods() {\n    return [\"resize\", \"updateDimensions\"];\n  },\n  resize: function resize() {\n    return !this.component._requireResize && this.updateDimensions();\n  },\n  updateDimensions: function updateDimensions(checkSize) {\n    var that = this;\n\n    that._initPostRenderHandlers();\n\n    if (!that._checkSize(checkSize)) {\n      return;\n    }\n\n    var prevResult = that._resizeDeferred;\n    var result = that._resizeDeferred = new _deferred.Deferred();\n    (0, _deferred.when)(prevResult).always(function () {\n      _common2.default.deferRender(function () {\n        if (that._dataController.isLoaded()) {\n          that._synchronizeColumns();\n        }\n\n        that._resetGroupElementHeight();\n\n        _common2.default.deferUpdate(function () {\n          _common2.default.deferRender(function () {\n            _common2.default.deferUpdate(function () {\n              that._updateDimensionsCore();\n            });\n          });\n        });\n      }).done(result.resolve).fail(result.reject);\n    });\n    return result.promise();\n  },\n  _resetGroupElementHeight: function _resetGroupElementHeight() {\n    var groupElement = this.component.$element().children().get(0);\n\n    var scrollable = this._rowsView.getScrollable();\n\n    if (groupElement && groupElement.style.height && (!scrollable || !scrollable.scrollTop())) {\n      groupElement.style.height = \"\";\n    }\n  },\n  _checkSize: function _checkSize(checkSize) {\n    var $rootElement = this.component.$element();\n\n    if (checkSize && (this._lastWidth === $rootElement.width() && this._lastHeight === $rootElement.height() || !$rootElement.is(\":visible\"))) {\n      return false;\n    }\n\n    return true;\n  },\n  _setScrollerSpacingCore: function _setScrollerSpacingCore(hasHeight) {\n    var that = this;\n    var vScrollbarWidth = hasHeight ? that._rowsView.getScrollbarWidth() : 0;\n\n    var hScrollbarWidth = that._rowsView.getScrollbarWidth(true);\n\n    _common2.default.deferRender(function () {\n      that._columnHeadersView && that._columnHeadersView.setScrollerSpacing(vScrollbarWidth);\n      that._footerView && that._footerView.setScrollerSpacing(vScrollbarWidth);\n\n      that._rowsView.setScrollerSpacing(vScrollbarWidth, hScrollbarWidth);\n    });\n  },\n  _setScrollerSpacing: function _setScrollerSpacing(hasHeight) {\n    var _this2 = this;\n\n    if (true === this.option(\"scrolling.useNative\")) {\n      _common2.default.deferRender(function () {\n        _common2.default.deferUpdate(function () {\n          _this2._setScrollerSpacingCore(hasHeight);\n        });\n      });\n    } else {\n      this._setScrollerSpacingCore(hasHeight);\n    }\n  },\n  _updateDimensionsCore: function _updateDimensionsCore() {\n    var that = this;\n    var hasHeight;\n    var dataController = that._dataController;\n    var rowsView = that._rowsView;\n    var $rootElement = that.component.$element();\n    var groupElement = $rootElement.children().get(0);\n    var rootElementHeight = $rootElement && ($rootElement.get(0).clientHeight || $rootElement.height());\n    var maxHeight = parseInt($rootElement.css(\"maxHeight\"));\n    var maxHeightHappened = maxHeight && rootElementHeight >= maxHeight;\n    var height = that.option(\"height\") || $rootElement.get(0).style.height;\n    var editorFactory = that.getController(\"editorFactory\");\n    var isMaxHeightApplied = maxHeightHappened && groupElement.scrollHeight === groupElement.offsetHeight;\n    var $testDiv;\n    that.updateSize($rootElement);\n    hasHeight = that._hasHeight || maxHeightHappened;\n\n    if (height && that._hasHeight ^ \"auto\" !== height) {\n      $testDiv = (0, _renderer2.default)(\"<div>\").height(height).appendTo($rootElement);\n      that._hasHeight = !!$testDiv.height();\n      $testDiv.remove();\n    }\n\n    _common2.default.deferRender(function () {\n      rowsView.height(null, hasHeight);\n\n      if (maxHeightHappened && !isMaxHeightApplied) {\n        (0, _renderer2.default)(groupElement).css(\"height\", maxHeight);\n      }\n\n      if (!dataController.isLoaded()) {\n        rowsView.setLoading(dataController.isLoading());\n        return;\n      }\n\n      _common2.default.deferUpdate(function () {\n        that._updateLastSizes($rootElement);\n\n        that._setScrollerSpacing(hasHeight);\n\n        (0, _iterator.each)(VIEW_NAMES, function (index, viewName) {\n          var view = that.getView(viewName);\n\n          if (view) {\n            view.resize();\n          }\n        });\n        editorFactory && editorFactory.resize();\n      });\n    });\n  },\n  _updateLastSizes: function _updateLastSizes($rootElement) {\n    this._lastWidth = $rootElement.width();\n    this._lastHeight = $rootElement.height();\n  },\n  optionChanged: function optionChanged(args) {\n    switch (args.name) {\n      case \"width\":\n      case \"height\":\n        this.component._renderDimensions();\n\n        this.resize();\n\n      case \"legacyRendering\":\n      case \"renderAsync\":\n        args.handled = true;\n        return;\n\n      default:\n        this.callBase(args);\n    }\n  },\n  init: function init() {\n    var that = this;\n    that._dataController = that.getController(\"data\");\n    that._columnsController = that.getController(\"columns\");\n    that._columnHeadersView = that.getView(\"columnHeadersView\");\n    that._footerView = that.getView(\"footerView\");\n    that._rowsView = that.getView(\"rowsView\");\n  }\n});\n\nvar SynchronizeScrollingController = _uiGrid_core2.default.ViewController.inherit({\n  _scrollChangedHandler: function _scrollChangedHandler(views, pos, viewName) {\n    for (var j = 0; j < views.length; j++) {\n      if (views[j] && views[j].name !== viewName) {\n        views[j].scrollTo({\n          left: pos.left,\n          top: pos.top\n        });\n      }\n    }\n  },\n  init: function init() {\n    var view;\n    var views = [this.getView(\"columnHeadersView\"), this.getView(\"footerView\"), this.getView(\"rowsView\")];\n    var i;\n\n    for (i = 0; i < views.length; i++) {\n      view = views[i];\n\n      if (view) {\n        view.scrollChanged.add(this._scrollChangedHandler.bind(this, views));\n      }\n    }\n  }\n});\n\nvar GridView = _uiGrid_core2.default.View.inherit({\n  _endUpdateCore: function _endUpdateCore() {\n    if (this.component._requireResize) {\n      this.component._requireResize = false;\n\n      this._resizingController.resize();\n    }\n  },\n  _getWidgetAriaLabel: function _getWidgetAriaLabel() {\n    return \"dxDataGrid-ariaDataGrid\";\n  },\n  init: function init() {\n    var that = this;\n    that._resizingController = that.getController(\"resizing\");\n    that._dataController = that.getController(\"data\");\n  },\n  getView: function getView(name) {\n    return this.component._views[name];\n  },\n  element: function element() {\n    return this._groupElement;\n  },\n  optionChanged: function optionChanged(args) {\n    var that = this;\n\n    if (_type2.default.isDefined(that._groupElement) && \"showBorders\" === args.name) {\n      that._groupElement.toggleClass(that.addWidgetPrefix(BORDERS_CLASS), !!args.value);\n\n      args.handled = true;\n    } else {\n      that.callBase(args);\n    }\n  },\n  _renderViews: function _renderViews($groupElement) {\n    var that = this;\n    (0, _iterator.each)(VIEW_NAMES, function (index, viewName) {\n      var view = that.getView(viewName);\n\n      if (view) {\n        view.render($groupElement);\n      }\n    });\n  },\n  _getTableRoleName: function _getTableRoleName() {\n    return \"grid\";\n  },\n  render: function render($rootElement) {\n    var that = this;\n    var isFirstRender = !that._groupElement;\n    var $groupElement = that._groupElement || (0, _renderer2.default)(\"<div>\").addClass(that.getWidgetContainerClass());\n    $groupElement.addClass(GRIDBASE_CONTAINER_CLASS);\n    $groupElement.toggleClass(that.addWidgetPrefix(BORDERS_CLASS), !!that.option(\"showBorders\"));\n    that.setAria(\"role\", \"presentation\", $rootElement);\n    that.component.setAria({\n      role: this._getTableRoleName(),\n      label: _message2.default.format(that._getWidgetAriaLabel())\n    }, $groupElement);\n    that._rootElement = $rootElement || that._rootElement;\n\n    if (isFirstRender) {\n      that._groupElement = $groupElement;\n      _window2.default.hasWindow() && that.getController(\"resizing\").updateSize($rootElement);\n      $groupElement.appendTo($rootElement);\n    }\n\n    that._renderViews($groupElement);\n  },\n  update: function update() {\n    var that = this;\n    var $rootElement = that._rootElement;\n    var $groupElement = that._groupElement;\n    var resizingController = that.getController(\"resizing\");\n\n    if ($rootElement && $groupElement) {\n      resizingController.resize();\n\n      if (that._dataController.isLoaded()) {\n        that._resizingController.fireContentReadyAction();\n      }\n    }\n  }\n});\n\nmodule.exports = {\n  defaultOptions: function defaultOptions() {\n    return {\n      showBorders: false,\n      renderAsync: false,\n      legacyRendering: false\n    };\n  },\n  controllers: {\n    resizing: ResizingController,\n    synchronizeScrolling: SynchronizeScrollingController\n  },\n  views: {\n    gridView: GridView\n  }\n};","map":{"version":3,"sources":["C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/devextreme/ui/grid_core/ui.grid_core.grid_view.js"],"names":["_renderer","require","_renderer2","_interopRequireDefault","_uiGrid_core","_uiGrid_core2","_common","_common2","_window","_window2","_iterator","_type","_type2","_uiGrid_core3","_uiGrid_core4","_message","_message2","_deferred","_dom_adapter","_dom_adapter2","_browser","_browser2","_accessibility","_accessibility2","obj","TABLE_CLASS","BORDERS_CLASS","TABLE_FIXED_CLASS","IMPORTANT_MARGIN_CLASS","TEXT_CONTENT_CLASS","HIDDEN_CLASS","GRIDBASE_CONTAINER_CLASS","HIDDEN_COLUMNS_WIDTH","EDITORS_INPUT_SELECTOR","VIEW_NAMES","isPercentWidth","width","isPixelWidth","mergeArraysByMaxValue","result","values1","values2","i","getContainerHeight","clientHeight","$container","paddingTop","parseFloat","paddingBottom","calculateFreeWidth","contentWidth","that","totalWidth","calculateFreeWidthWithCurrentMinWidth","index","restoreFocus","ResizingController","_initPostRenderHandlers","dataController","changeType","e","isDelayed","items","resizeDeferred","fireContentReadyAction","_setAriaRowColCount","component","rowCount","colCount","_getBestFitWidths","rowsColumnWidths","headerColumnWidths","footerColumnWidths","resultWidths","_setVisibleWidths","columnsController","columnId","widths","_toggleBestFitModeForView","_this","view","$rowsTables","$viewTables","$rowsTable","$viewTable","$tableBody","_toggleBestFitMode","$element","$rowsFixedTable","isBestFit","parseInt","_synchronizeColumns","visibleColumns","columnAutoWidth","legacyRendering","needBestFit","hasMinWidth","isColumnWidthsCorrected","normalizeWidthsByExpandColumns","column","expandColumnWidth","focusedElement","selectionRange","resetBestFitMode","isFocusOutsideWindow","setTimeout","_needBestFit","_needStretch","c","_getAverageColumnsWidth","freeWidth","columnCountWithoutWidth","_correctColumnWidths","hasPercentWidth","hasAutoWidth","hasWidth","isHiddenColumn","minWidth","averageColumnsWidth","scrollbarWidth","lastColumnIndex","_processStretch","groupSize","tableSize","unusedIndexes","length","resultSizes","diff","diffElement","Math","onePixelElementsCount","_getRealColumnWidth","groupWidth","_getTotalWidth","updateSize","importantMarginClass","$rootElement","$groupElement","publicMethods","resize","updateDimensions","prevResult","_resetGroupElementHeight","groupElement","scrollable","_checkSize","checkSize","_setScrollerSpacingCore","vScrollbarWidth","hasHeight","hScrollbarWidth","_setScrollerSpacing","_this2","_updateDimensionsCore","rowsView","rootElementHeight","maxHeight","maxHeightHappened","height","editorFactory","isMaxHeightApplied","$testDiv","_updateLastSizes","optionChanged","args","init","SynchronizeScrollingController","_scrollChangedHandler","j","views","left","pos","top","GridView","_endUpdateCore","_getWidgetAriaLabel","getView","element","_renderViews","_getTableRoleName","render","isFirstRender","role","label","update","resizingController","module","defaultOptions","showBorders","renderAsync","controllers","resizing","synchronizeScrolling","gridView"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/grid_core/ui.grid_core.grid_view.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar _renderer = require(\"../../core/renderer\");\r\nvar _renderer2 = _interopRequireDefault(_renderer);\r\nvar _uiGrid_core = require(\"./ui.grid_core.modules\");\r\nvar _uiGrid_core2 = _interopRequireDefault(_uiGrid_core);\r\nvar _common = require(\"../../core/utils/common\");\r\nvar _common2 = _interopRequireDefault(_common);\r\nvar _window = require(\"../../core/utils/window\");\r\nvar _window2 = _interopRequireDefault(_window);\r\nvar _iterator = require(\"../../core/utils/iterator\");\r\nvar _type = require(\"../../core/utils/type\");\r\nvar _type2 = _interopRequireDefault(_type);\r\nvar _uiGrid_core3 = require(\"./ui.grid_core.utils\");\r\nvar _uiGrid_core4 = _interopRequireDefault(_uiGrid_core3);\r\nvar _message = require(\"../../localization/message\");\r\nvar _message2 = _interopRequireDefault(_message);\r\nvar _deferred = require(\"../../core/utils/deferred\");\r\nvar _dom_adapter = require(\"../../core/dom_adapter\");\r\nvar _dom_adapter2 = _interopRequireDefault(_dom_adapter);\r\nvar _browser = require(\"../../core/utils/browser\");\r\nvar _browser2 = _interopRequireDefault(_browser);\r\nvar _accessibility = require(\"../shared/accessibility\");\r\nvar _accessibility2 = _interopRequireDefault(_accessibility);\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\nvar TABLE_CLASS = \"table\";\r\nvar BORDERS_CLASS = \"borders\";\r\nvar TABLE_FIXED_CLASS = \"table-fixed\";\r\nvar IMPORTANT_MARGIN_CLASS = \"important-margin\";\r\nvar TEXT_CONTENT_CLASS = \"text-content\";\r\nvar HIDDEN_CLASS = \"dx-hidden\";\r\nvar GRIDBASE_CONTAINER_CLASS = \"dx-gridbase-container\";\r\nvar HIDDEN_COLUMNS_WIDTH = \"adaptiveHidden\";\r\nvar EDITORS_INPUT_SELECTOR = \"input:not([type='hidden'])\";\r\nvar VIEW_NAMES = [\"columnsSeparatorView\", \"blockSeparatorView\", \"trackerView\", \"headerPanel\", \"columnHeadersView\", \"rowsView\", \"footerView\", \"columnChooserView\", \"filterPanelView\", \"pagerView\", \"draggingHeaderView\", \"contextMenuView\", \"errorView\", \"headerFilterView\", \"filterBuilderView\"];\r\nvar isPercentWidth = function(width) {\r\n    return _type2.default.isString(width) && \"%\" === width.slice(-1)\r\n};\r\nvar isPixelWidth = function(width) {\r\n    return _type2.default.isString(width) && \"px\" === width.slice(-2)\r\n};\r\nvar mergeArraysByMaxValue = function(values1, values2) {\r\n    var result = [];\r\n    var i;\r\n    if (values1 && values2 && values1.length && values1.length === values2.length) {\r\n        for (i = 0; i < values1.length; i++) {\r\n            result.push(values1[i] > values2[i] ? values1[i] : values2[i])\r\n        }\r\n    } else {\r\n        if (values1 && values1.length) {\r\n            result = values1\r\n        } else {\r\n            if (values2) {\r\n                result = values2\r\n            }\r\n        }\r\n    }\r\n    return result\r\n};\r\nvar getContainerHeight = function($container) {\r\n    var clientHeight = $container.get(0).clientHeight;\r\n    var paddingTop = parseFloat($container.css(\"paddingTop\"));\r\n    var paddingBottom = parseFloat($container.css(\"paddingBottom\"));\r\n    return clientHeight - paddingTop - paddingBottom\r\n};\r\nvar calculateFreeWidth = function(that, widths) {\r\n    var contentWidth = that._rowsView.contentWidth();\r\n    var totalWidth = that._getTotalWidth(widths, contentWidth);\r\n    return contentWidth - totalWidth\r\n};\r\nvar calculateFreeWidthWithCurrentMinWidth = function(that, columnIndex, currentMinWidth, widths) {\r\n    return calculateFreeWidth(that, widths.map(function(width, index) {\r\n        return index === columnIndex ? currentMinWidth : width\r\n    }))\r\n};\r\nvar restoreFocus = function(focusedElement, selectionRange) {\r\n    _accessibility2.default.hiddenFocus(focusedElement);\r\n    _uiGrid_core4.default.setSelectionRange(focusedElement, selectionRange)\r\n};\r\nvar ResizingController = _uiGrid_core2.default.ViewController.inherit({\r\n    _initPostRenderHandlers: function() {\r\n        var that = this;\r\n        var dataController = that._dataController;\r\n        if (!that._refreshSizesHandler) {\r\n            that._refreshSizesHandler = function(e) {\r\n                dataController.changed.remove(that._refreshSizesHandler);\r\n                var resizeDeferred;\r\n                var changeType = e && e.changeType;\r\n                var isDelayed = e && e.isDelayed;\r\n                var items = dataController.items();\r\n                if (!e || \"refresh\" === changeType || \"prepend\" === changeType || \"append\" === changeType) {\r\n                    if (!isDelayed) {\r\n                        resizeDeferred = that.resize()\r\n                    }\r\n                } else {\r\n                    if (\"update\" === changeType && e.changeTypes) {\r\n                        if ((items.length > 1 || \"insert\" !== e.changeTypes[0]) && !(0 === items.length && \"remove\" === e.changeTypes[0]) && !e.needUpdateDimensions) {\r\n                            _common2.default.deferUpdate(function() {\r\n                                that._rowsView.resize()\r\n                            })\r\n                        } else {\r\n                            resizeDeferred = that.resize()\r\n                        }\r\n                    }\r\n                }\r\n                if (changeType && \"updateSelection\" !== changeType && \"updateFocusedRow\" !== changeType && !isDelayed) {\r\n                    (0, _deferred.when)(resizeDeferred).done(function() {\r\n                        that._setAriaRowColCount();\r\n                        that.fireContentReadyAction()\r\n                    })\r\n                }\r\n            };\r\n            that._dataController.changed.add(function() {\r\n                that._dataController.changed.add(that._refreshSizesHandler)\r\n            })\r\n        }\r\n    },\r\n    fireContentReadyAction: function() {\r\n        this.component._fireContentReadyAction()\r\n    },\r\n    _setAriaRowColCount: function() {\r\n        var component = this.component;\r\n        component.setAria({\r\n            rowCount: this._dataController.totalItemsCount(),\r\n            colCount: component.columnCount()\r\n        }, component.$element().children(\".\" + GRIDBASE_CONTAINER_CLASS))\r\n    },\r\n    _getBestFitWidths: function() {\r\n        if (!this.option(\"legacyRendering\")) {\r\n            return this._rowsView.getColumnWidths()\r\n        }\r\n        var that = this;\r\n        var rowsColumnWidths;\r\n        var headerColumnWidths;\r\n        var footerColumnWidths;\r\n        var resultWidths;\r\n        rowsColumnWidths = that._rowsView.getColumnWidths();\r\n        headerColumnWidths = that._columnHeadersView && that._columnHeadersView.getColumnWidths();\r\n        footerColumnWidths = that._footerView && that._footerView.getColumnWidths();\r\n        resultWidths = mergeArraysByMaxValue(rowsColumnWidths, headerColumnWidths);\r\n        resultWidths = mergeArraysByMaxValue(resultWidths, footerColumnWidths);\r\n        return resultWidths\r\n    },\r\n    _setVisibleWidths: function(visibleColumns, widths) {\r\n        var columnsController = this._columnsController;\r\n        columnsController.beginUpdate();\r\n        (0, _iterator.each)(visibleColumns, function(index, column) {\r\n            var columnId = columnsController.getColumnId(column);\r\n            columnsController.columnOption(columnId, \"visibleWidth\", widths[index])\r\n        });\r\n        columnsController.endUpdate()\r\n    },\r\n    _toggleBestFitModeForView: function(view, className, isBestFit) {\r\n        var _this = this;\r\n        if (!view || !view.isVisible()) {\r\n            return\r\n        }\r\n        var $rowsTables = this._rowsView.getTableElements();\r\n        var $viewTables = view.getTableElements();\r\n        (0, _iterator.each)($rowsTables, function(index, tableElement) {\r\n            var $tableBody;\r\n            var $rowsTable = (0, _renderer2.default)(tableElement);\r\n            var $viewTable = $viewTables.eq(index);\r\n            if ($viewTable && $viewTable.length) {\r\n                if (isBestFit) {\r\n                    $tableBody = $viewTable.children(\"tbody\").appendTo($rowsTable)\r\n                } else {\r\n                    $tableBody = $rowsTable.children(\".\" + className).appendTo($viewTable)\r\n                }\r\n                $tableBody.toggleClass(className, isBestFit);\r\n                $tableBody.toggleClass(_this.addWidgetPrefix(\"best-fit\"), isBestFit)\r\n            }\r\n        })\r\n    },\r\n    _toggleBestFitMode: function(isBestFit) {\r\n        var $element = this.component.$element();\r\n        var that = this;\r\n        if (!that.option(\"legacyRendering\")) {\r\n            var $rowsTable = that._rowsView._getTableElement();\r\n            var $rowsFixedTable = that._rowsView.getTableElements().eq(1);\r\n            $rowsTable.css(\"tableLayout\", isBestFit ? \"auto\" : \"fixed\");\r\n            $rowsTable.children(\"colgroup\").css(\"display\", isBestFit ? \"none\" : \"\");\r\n            $rowsFixedTable.toggleClass(this.addWidgetPrefix(TABLE_FIXED_CLASS), !isBestFit);\r\n            that._toggleBestFitModeForView(that._columnHeadersView, \"dx-header\", isBestFit);\r\n            that._toggleBestFitModeForView(that._footerView, \"dx-footer\", isBestFit);\r\n            if (that._needStretch()) {\r\n                $rowsTable.get(0).style.width = isBestFit ? \"auto\" : \"\"\r\n            }\r\n            if (_browser2.default.msie && 11 === parseInt(_browser2.default.version)) {\r\n                $rowsTable.find(\".\" + this.addWidgetPrefix(TABLE_FIXED_CLASS)).each(function() {\r\n                    this.style.width = isBestFit ? \"10px\" : \"\"\r\n                })\r\n            }\r\n        } else {\r\n            $element.find(\".\" + this.addWidgetPrefix(TABLE_CLASS)).toggleClass(this.addWidgetPrefix(TABLE_FIXED_CLASS), !isBestFit);\r\n            $element.find(EDITORS_INPUT_SELECTOR).toggleClass(HIDDEN_CLASS, isBestFit);\r\n            $element.find(\".dx-group-cell\").toggleClass(HIDDEN_CLASS, isBestFit);\r\n            $element.find(\".dx-header-row .\" + this.addWidgetPrefix(TEXT_CONTENT_CLASS)).css(\"maxWidth\", \"\")\r\n        }\r\n    },\r\n    _synchronizeColumns: function() {\r\n        var that = this;\r\n        var columnsController = that._columnsController;\r\n        var visibleColumns = columnsController.getVisibleColumns();\r\n        var columnAutoWidth = that.option(\"columnAutoWidth\");\r\n        var legacyRendering = that.option(\"legacyRendering\");\r\n        var needBestFit = that._needBestFit();\r\n        var hasMinWidth = false;\r\n        var resetBestFitMode;\r\n        var isColumnWidthsCorrected = false;\r\n        var resultWidths = [];\r\n        var focusedElement;\r\n        var isFocusOutsideWindow;\r\n        var selectionRange;\r\n        var normalizeWidthsByExpandColumns = function() {\r\n            var expandColumnWidth;\r\n            (0, _iterator.each)(visibleColumns, function(index, column) {\r\n                if (\"groupExpand\" === column.type) {\r\n                    expandColumnWidth = resultWidths[index]\r\n                }\r\n            });\r\n            (0, _iterator.each)(visibleColumns, function(index, column) {\r\n                if (\"groupExpand\" === column.type && expandColumnWidth) {\r\n                    resultWidths[index] = expandColumnWidth\r\n                }\r\n            })\r\n        };\r\n        !needBestFit && (0, _iterator.each)(visibleColumns, function(index, column) {\r\n            if (\"auto\" === column.width || legacyRendering && column.fixed) {\r\n                needBestFit = true;\r\n                return false\r\n            }\r\n        });\r\n        (0, _iterator.each)(visibleColumns, function(index, column) {\r\n            if (column.minWidth) {\r\n                hasMinWidth = true;\r\n                return false\r\n            }\r\n        });\r\n        that._setVisibleWidths(visibleColumns, []);\r\n        if (needBestFit) {\r\n            focusedElement = _dom_adapter2.default.getActiveElement();\r\n            selectionRange = _uiGrid_core4.default.getSelectionRange(focusedElement);\r\n            that._toggleBestFitMode(true);\r\n            resetBestFitMode = true\r\n        }\r\n        _common2.default.deferUpdate(function() {\r\n            if (needBestFit) {\r\n                resultWidths = that._getBestFitWidths();\r\n                (0, _iterator.each)(visibleColumns, function(index, column) {\r\n                    var columnId = columnsController.getColumnId(column);\r\n                    columnsController.columnOption(columnId, \"bestFitWidth\", resultWidths[index], true)\r\n                })\r\n            } else {\r\n                if (hasMinWidth) {\r\n                    resultWidths = that._getBestFitWidths()\r\n                }\r\n            }(0, _iterator.each)(visibleColumns, function(index) {\r\n                var width = this.width;\r\n                if (\"auto\" !== width) {\r\n                    if (_type2.default.isDefined(width)) {\r\n                        resultWidths[index] = _type2.default.isNumeric(width) || isPixelWidth(width) ? parseFloat(width) : width\r\n                    } else {\r\n                        if (!columnAutoWidth) {\r\n                            resultWidths[index] = void 0\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n            if (resetBestFitMode) {\r\n                that._toggleBestFitMode(false);\r\n                resetBestFitMode = false;\r\n                if (focusedElement && focusedElement !== _dom_adapter2.default.getActiveElement()) {\r\n                    isFocusOutsideWindow = focusedElement.getBoundingClientRect().bottom < 0;\r\n                    if (!isFocusOutsideWindow) {\r\n                        if (_browser2.default.msie) {\r\n                            setTimeout(function() {\r\n                                restoreFocus(focusedElement, selectionRange)\r\n                            })\r\n                        } else {\r\n                            restoreFocus(focusedElement, selectionRange)\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            isColumnWidthsCorrected = that._correctColumnWidths(resultWidths, visibleColumns);\r\n            if (columnAutoWidth) {\r\n                normalizeWidthsByExpandColumns();\r\n                if (that._needStretch()) {\r\n                    that._processStretch(resultWidths, visibleColumns)\r\n                }\r\n            }\r\n            _common2.default.deferRender(function() {\r\n                if (needBestFit || isColumnWidthsCorrected) {\r\n                    that._setVisibleWidths(visibleColumns, resultWidths)\r\n                }\r\n            })\r\n        })\r\n    },\r\n    _needBestFit: function() {\r\n        return this.option(\"columnAutoWidth\")\r\n    },\r\n    _needStretch: function() {\r\n        return this.option(\"legacyRendering\") || this._columnsController.getVisibleColumns().some(function(c) {\r\n            return \"auto\" === c.width && !c.command\r\n        })\r\n    },\r\n    _getAverageColumnsWidth: function(resultWidths) {\r\n        var freeWidth = calculateFreeWidth(this, resultWidths);\r\n        var columnCountWithoutWidth = resultWidths.filter(function(width) {\r\n            return void 0 === width\r\n        }).length;\r\n        return freeWidth / columnCountWithoutWidth\r\n    },\r\n    _correctColumnWidths: function(resultWidths, visibleColumns) {\r\n        var that = this;\r\n        var i;\r\n        var hasPercentWidth = false;\r\n        var hasAutoWidth = false;\r\n        var isColumnWidthsCorrected = false;\r\n        var $element = that.component.$element();\r\n        var hasWidth = that._hasWidth;\r\n        var averageColumnsWidth;\r\n        var lastColumnIndex;\r\n        for (i = 0; i < visibleColumns.length; i++) {\r\n            var index = i;\r\n            var column = visibleColumns[index];\r\n            var isHiddenColumn = resultWidths[index] === HIDDEN_COLUMNS_WIDTH;\r\n            var width = resultWidths[index];\r\n            var minWidth = column.minWidth;\r\n            if (minWidth) {\r\n                if (void 0 === width) {\r\n                    averageColumnsWidth = that._getAverageColumnsWidth(resultWidths);\r\n                    width = averageColumnsWidth\r\n                } else {\r\n                    if (isPercentWidth(width)) {\r\n                        var freeWidth = calculateFreeWidthWithCurrentMinWidth(that, index, minWidth, resultWidths);\r\n                        if (freeWidth < 0) {\r\n                            width = -1\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            if (minWidth && that._getRealColumnWidth(width) < minWidth && !isHiddenColumn) {\r\n                resultWidths[index] = minWidth;\r\n                isColumnWidthsCorrected = true;\r\n                i = -1\r\n            }\r\n            if (!_type2.default.isDefined(column.width)) {\r\n                hasAutoWidth = true\r\n            }\r\n            if (isPercentWidth(column.width)) {\r\n                hasPercentWidth = true\r\n            }\r\n        }\r\n        if ($element && that._maxWidth) {\r\n            delete that._maxWidth;\r\n            $element.css(\"maxWidth\", \"\")\r\n        }\r\n        if (!hasAutoWidth && resultWidths.length) {\r\n            var contentWidth = that._rowsView.contentWidth();\r\n            var scrollbarWidth = that._rowsView.getScrollbarWidth();\r\n            var totalWidth = that._getTotalWidth(resultWidths, contentWidth);\r\n            if (totalWidth < contentWidth) {\r\n                lastColumnIndex = _uiGrid_core4.default.getLastResizableColumnIndex(visibleColumns, resultWidths);\r\n                if (lastColumnIndex >= 0) {\r\n                    resultWidths[lastColumnIndex] = \"auto\";\r\n                    isColumnWidthsCorrected = true;\r\n                    if (false === hasWidth && !hasPercentWidth) {\r\n                        that._maxWidth = totalWidth + scrollbarWidth + (that.option(\"showBorders\") ? 2 : 0);\r\n                        $element.css(\"maxWidth\", that._maxWidth)\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return isColumnWidthsCorrected\r\n    },\r\n    _processStretch: function(resultSizes, visibleColumns) {\r\n        var groupSize = this._rowsView.contentWidth();\r\n        var tableSize = this._getTotalWidth(resultSizes, groupSize);\r\n        var unusedIndexes = {\r\n            length: 0\r\n        };\r\n        var diff;\r\n        var diffElement;\r\n        var onePixelElementsCount;\r\n        var i;\r\n        if (!resultSizes.length) {\r\n            return\r\n        }(0, _iterator.each)(visibleColumns, function(index) {\r\n            if (this.width || resultSizes[index] === HIDDEN_COLUMNS_WIDTH) {\r\n                unusedIndexes[index] = true;\r\n                unusedIndexes.length++\r\n            }\r\n        });\r\n        diff = groupSize - tableSize;\r\n        diffElement = Math.floor(diff / (resultSizes.length - unusedIndexes.length));\r\n        onePixelElementsCount = diff - diffElement * (resultSizes.length - unusedIndexes.length);\r\n        if (diff >= 0) {\r\n            for (i = 0; i < resultSizes.length; i++) {\r\n                if (unusedIndexes[i]) {\r\n                    continue\r\n                }\r\n                resultSizes[i] += diffElement;\r\n                if (onePixelElementsCount > 0) {\r\n                    if (onePixelElementsCount < 1) {\r\n                        resultSizes[i] += onePixelElementsCount;\r\n                        onePixelElementsCount = 0\r\n                    } else {\r\n                        resultSizes[i]++;\r\n                        onePixelElementsCount--\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    _getRealColumnWidth: function(width, groupWidth) {\r\n        if (!isPercentWidth(width)) {\r\n            return parseFloat(width)\r\n        }\r\n        groupWidth = groupWidth || this._rowsView.contentWidth();\r\n        return parseFloat(width) * groupWidth / 100\r\n    },\r\n    _getTotalWidth: function(widths, groupWidth) {\r\n        var result = 0;\r\n        var width;\r\n        var i;\r\n        for (i = 0; i < widths.length; i++) {\r\n            width = widths[i];\r\n            if (width && width !== HIDDEN_COLUMNS_WIDTH) {\r\n                result += this._getRealColumnWidth(width, groupWidth)\r\n            }\r\n        }\r\n        return result\r\n    },\r\n    updateSize: function($rootElement) {\r\n        var that = this;\r\n        var $groupElement;\r\n        var width;\r\n        var importantMarginClass = that.addWidgetPrefix(IMPORTANT_MARGIN_CLASS);\r\n        if (void 0 === that._hasHeight && $rootElement && $rootElement.is(\":visible\") && $rootElement.width()) {\r\n            $groupElement = $rootElement.children(\".\" + that.getWidgetContainerClass());\r\n            if ($groupElement.length) {\r\n                $groupElement.detach()\r\n            }\r\n            that._hasHeight = !!getContainerHeight($rootElement);\r\n            width = $rootElement.width();\r\n            $rootElement.addClass(importantMarginClass);\r\n            that._hasWidth = $rootElement.width() === width;\r\n            $rootElement.removeClass(importantMarginClass);\r\n            if ($groupElement.length) {\r\n                $groupElement.appendTo($rootElement)\r\n            }\r\n        }\r\n    },\r\n    publicMethods: function() {\r\n        return [\"resize\", \"updateDimensions\"]\r\n    },\r\n    resize: function() {\r\n        return !this.component._requireResize && this.updateDimensions()\r\n    },\r\n    updateDimensions: function(checkSize) {\r\n        var that = this;\r\n        that._initPostRenderHandlers();\r\n        if (!that._checkSize(checkSize)) {\r\n            return\r\n        }\r\n        var prevResult = that._resizeDeferred;\r\n        var result = that._resizeDeferred = new _deferred.Deferred;\r\n        (0, _deferred.when)(prevResult).always(function() {\r\n            _common2.default.deferRender(function() {\r\n                if (that._dataController.isLoaded()) {\r\n                    that._synchronizeColumns()\r\n                }\r\n                that._resetGroupElementHeight();\r\n                _common2.default.deferUpdate(function() {\r\n                    _common2.default.deferRender(function() {\r\n                        _common2.default.deferUpdate(function() {\r\n                            that._updateDimensionsCore()\r\n                        })\r\n                    })\r\n                })\r\n            }).done(result.resolve).fail(result.reject)\r\n        });\r\n        return result.promise()\r\n    },\r\n    _resetGroupElementHeight: function() {\r\n        var groupElement = this.component.$element().children().get(0);\r\n        var scrollable = this._rowsView.getScrollable();\r\n        if (groupElement && groupElement.style.height && (!scrollable || !scrollable.scrollTop())) {\r\n            groupElement.style.height = \"\"\r\n        }\r\n    },\r\n    _checkSize: function(checkSize) {\r\n        var $rootElement = this.component.$element();\r\n        if (checkSize && (this._lastWidth === $rootElement.width() && this._lastHeight === $rootElement.height() || !$rootElement.is(\":visible\"))) {\r\n            return false\r\n        }\r\n        return true\r\n    },\r\n    _setScrollerSpacingCore: function(hasHeight) {\r\n        var that = this;\r\n        var vScrollbarWidth = hasHeight ? that._rowsView.getScrollbarWidth() : 0;\r\n        var hScrollbarWidth = that._rowsView.getScrollbarWidth(true);\r\n        _common2.default.deferRender(function() {\r\n            that._columnHeadersView && that._columnHeadersView.setScrollerSpacing(vScrollbarWidth);\r\n            that._footerView && that._footerView.setScrollerSpacing(vScrollbarWidth);\r\n            that._rowsView.setScrollerSpacing(vScrollbarWidth, hScrollbarWidth)\r\n        })\r\n    },\r\n    _setScrollerSpacing: function(hasHeight) {\r\n        var _this2 = this;\r\n        if (true === this.option(\"scrolling.useNative\")) {\r\n            _common2.default.deferRender(function() {\r\n                _common2.default.deferUpdate(function() {\r\n                    _this2._setScrollerSpacingCore(hasHeight)\r\n                })\r\n            })\r\n        } else {\r\n            this._setScrollerSpacingCore(hasHeight)\r\n        }\r\n    },\r\n    _updateDimensionsCore: function() {\r\n        var that = this;\r\n        var hasHeight;\r\n        var dataController = that._dataController;\r\n        var rowsView = that._rowsView;\r\n        var $rootElement = that.component.$element();\r\n        var groupElement = $rootElement.children().get(0);\r\n        var rootElementHeight = $rootElement && ($rootElement.get(0).clientHeight || $rootElement.height());\r\n        var maxHeight = parseInt($rootElement.css(\"maxHeight\"));\r\n        var maxHeightHappened = maxHeight && rootElementHeight >= maxHeight;\r\n        var height = that.option(\"height\") || $rootElement.get(0).style.height;\r\n        var editorFactory = that.getController(\"editorFactory\");\r\n        var isMaxHeightApplied = maxHeightHappened && groupElement.scrollHeight === groupElement.offsetHeight;\r\n        var $testDiv;\r\n        that.updateSize($rootElement);\r\n        hasHeight = that._hasHeight || maxHeightHappened;\r\n        if (height && that._hasHeight ^ \"auto\" !== height) {\r\n            $testDiv = (0, _renderer2.default)(\"<div>\").height(height).appendTo($rootElement);\r\n            that._hasHeight = !!$testDiv.height();\r\n            $testDiv.remove()\r\n        }\r\n        _common2.default.deferRender(function() {\r\n            rowsView.height(null, hasHeight);\r\n            if (maxHeightHappened && !isMaxHeightApplied) {\r\n                (0, _renderer2.default)(groupElement).css(\"height\", maxHeight)\r\n            }\r\n            if (!dataController.isLoaded()) {\r\n                rowsView.setLoading(dataController.isLoading());\r\n                return\r\n            }\r\n            _common2.default.deferUpdate(function() {\r\n                that._updateLastSizes($rootElement);\r\n                that._setScrollerSpacing(hasHeight);\r\n                (0, _iterator.each)(VIEW_NAMES, function(index, viewName) {\r\n                    var view = that.getView(viewName);\r\n                    if (view) {\r\n                        view.resize()\r\n                    }\r\n                });\r\n                editorFactory && editorFactory.resize()\r\n            })\r\n        })\r\n    },\r\n    _updateLastSizes: function($rootElement) {\r\n        this._lastWidth = $rootElement.width();\r\n        this._lastHeight = $rootElement.height()\r\n    },\r\n    optionChanged: function(args) {\r\n        switch (args.name) {\r\n            case \"width\":\r\n            case \"height\":\r\n                this.component._renderDimensions();\r\n                this.resize();\r\n            case \"legacyRendering\":\r\n            case \"renderAsync\":\r\n                args.handled = true;\r\n                return;\r\n            default:\r\n                this.callBase(args)\r\n        }\r\n    },\r\n    init: function() {\r\n        var that = this;\r\n        that._dataController = that.getController(\"data\");\r\n        that._columnsController = that.getController(\"columns\");\r\n        that._columnHeadersView = that.getView(\"columnHeadersView\");\r\n        that._footerView = that.getView(\"footerView\");\r\n        that._rowsView = that.getView(\"rowsView\")\r\n    }\r\n});\r\nvar SynchronizeScrollingController = _uiGrid_core2.default.ViewController.inherit({\r\n    _scrollChangedHandler: function(views, pos, viewName) {\r\n        for (var j = 0; j < views.length; j++) {\r\n            if (views[j] && views[j].name !== viewName) {\r\n                views[j].scrollTo({\r\n                    left: pos.left,\r\n                    top: pos.top\r\n                })\r\n            }\r\n        }\r\n    },\r\n    init: function() {\r\n        var view;\r\n        var views = [this.getView(\"columnHeadersView\"), this.getView(\"footerView\"), this.getView(\"rowsView\")];\r\n        var i;\r\n        for (i = 0; i < views.length; i++) {\r\n            view = views[i];\r\n            if (view) {\r\n                view.scrollChanged.add(this._scrollChangedHandler.bind(this, views))\r\n            }\r\n        }\r\n    }\r\n});\r\nvar GridView = _uiGrid_core2.default.View.inherit({\r\n    _endUpdateCore: function() {\r\n        if (this.component._requireResize) {\r\n            this.component._requireResize = false;\r\n            this._resizingController.resize()\r\n        }\r\n    },\r\n    _getWidgetAriaLabel: function() {\r\n        return \"dxDataGrid-ariaDataGrid\"\r\n    },\r\n    init: function() {\r\n        var that = this;\r\n        that._resizingController = that.getController(\"resizing\");\r\n        that._dataController = that.getController(\"data\")\r\n    },\r\n    getView: function(name) {\r\n        return this.component._views[name]\r\n    },\r\n    element: function() {\r\n        return this._groupElement\r\n    },\r\n    optionChanged: function(args) {\r\n        var that = this;\r\n        if (_type2.default.isDefined(that._groupElement) && \"showBorders\" === args.name) {\r\n            that._groupElement.toggleClass(that.addWidgetPrefix(BORDERS_CLASS), !!args.value);\r\n            args.handled = true\r\n        } else {\r\n            that.callBase(args)\r\n        }\r\n    },\r\n    _renderViews: function($groupElement) {\r\n        var that = this;\r\n        (0, _iterator.each)(VIEW_NAMES, function(index, viewName) {\r\n            var view = that.getView(viewName);\r\n            if (view) {\r\n                view.render($groupElement)\r\n            }\r\n        })\r\n    },\r\n    _getTableRoleName: function() {\r\n        return \"grid\"\r\n    },\r\n    render: function($rootElement) {\r\n        var that = this;\r\n        var isFirstRender = !that._groupElement;\r\n        var $groupElement = that._groupElement || (0, _renderer2.default)(\"<div>\").addClass(that.getWidgetContainerClass());\r\n        $groupElement.addClass(GRIDBASE_CONTAINER_CLASS);\r\n        $groupElement.toggleClass(that.addWidgetPrefix(BORDERS_CLASS), !!that.option(\"showBorders\"));\r\n        that.setAria(\"role\", \"presentation\", $rootElement);\r\n        that.component.setAria({\r\n            role: this._getTableRoleName(),\r\n            label: _message2.default.format(that._getWidgetAriaLabel())\r\n        }, $groupElement);\r\n        that._rootElement = $rootElement || that._rootElement;\r\n        if (isFirstRender) {\r\n            that._groupElement = $groupElement;\r\n            _window2.default.hasWindow() && that.getController(\"resizing\").updateSize($rootElement);\r\n            $groupElement.appendTo($rootElement)\r\n        }\r\n        that._renderViews($groupElement)\r\n    },\r\n    update: function() {\r\n        var that = this;\r\n        var $rootElement = that._rootElement;\r\n        var $groupElement = that._groupElement;\r\n        var resizingController = that.getController(\"resizing\");\r\n        if ($rootElement && $groupElement) {\r\n            resizingController.resize();\r\n            if (that._dataController.isLoaded()) {\r\n                that._resizingController.fireContentReadyAction()\r\n            }\r\n        }\r\n    }\r\n});\r\nmodule.exports = {\r\n    defaultOptions: function() {\r\n        return {\r\n            showBorders: false,\r\n            renderAsync: false,\r\n            legacyRendering: false\r\n        }\r\n    },\r\n    controllers: {\r\n        resizing: ResizingController,\r\n        synchronizeScrolling: SynchronizeScrollingController\r\n    },\r\n    views: {\r\n        gridView: GridView\r\n    }\r\n};\r\n"]},"metadata":{},"sourceType":"module"}