{"ast":null,"code":"/**\r\n * DevExtreme (ui/data_grid/ui.data_grid.summary.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar _renderer = require(\"../../core/renderer\");\n\nvar _renderer2 = _interopRequireDefault(_renderer);\n\nvar _common = require(\"../../core/utils/common\");\n\nvar _type = require(\"../../core/utils/type\");\n\nvar _iterator = require(\"../../core/utils/iterator\");\n\nvar _extend = require(\"../../core/utils/extend\");\n\nvar _data = require(\"../../core/utils/data\");\n\nvar _ui = require(\"../widget/ui.errors\");\n\nvar _ui2 = _interopRequireDefault(_ui);\n\nvar _uiData_grid = require(\"./ui.data_grid.core\");\n\nvar _uiData_grid2 = _interopRequireDefault(_uiData_grid);\n\nvar _message = require(\"../../localization/message\");\n\nvar _message2 = _interopRequireDefault(_message);\n\nvar _uiData_grid3 = require(\"./ui.data_grid.data_source_adapter\");\n\nvar _uiData_grid4 = _interopRequireDefault(_uiData_grid3);\n\nvar _uiGrid_core = require(\"../grid_core/ui.grid_core.columns_view\");\n\nvar _uiGrid_core2 = _interopRequireDefault(_uiGrid_core);\n\nvar _aggregate_calculator = require(\"./aggregate_calculator\");\n\nvar _aggregate_calculator2 = _interopRequireDefault(_aggregate_calculator);\n\nvar _query = require(\"../../data/query\");\n\nvar _query2 = _interopRequireDefault(_query);\n\nvar _store_helper = require(\"../../data/store_helper\");\n\nvar _utils = require(\"../../data/utils\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nvar DATAGRID_TOTAL_FOOTER_CLASS = \"dx-datagrid-total-footer\";\nvar DATAGRID_SUMMARY_ITEM_CLASS = \"dx-datagrid-summary-item\";\nvar DATAGRID_TEXT_CONTENT_CLASS = \"dx-datagrid-text-content\";\nvar DATAGRID_GROUP_FOOTER_CLASS = \"dx-datagrid-group-footer\";\nvar DATAGRID_GROUP_TEXT_CONTENT_CLASS = \"dx-datagrid-group-text-content\";\nvar DATAGRID_NOWRAP_CLASS = \"dx-datagrid-nowrap\";\nvar DATAGRID_GROUP_FOOTER_ROW_TYPE = \"groupFooter\";\n\nvar renderSummaryCell = function renderSummaryCell(cell, options) {\n  var i;\n  var $cell = (0, _renderer2.default)(cell);\n  var column = options.column;\n  var summaryItems = options.summaryItems;\n  var summaryItem;\n  var $summaryItems = [];\n\n  if (!column.command && summaryItems) {\n    for (i = 0; i < summaryItems.length; i++) {\n      summaryItem = summaryItems[i];\n      $summaryItems.push((0, _renderer2.default)(\"<div>\").css(\"textAlign\", summaryItem.alignment || column.alignment).addClass(DATAGRID_SUMMARY_ITEM_CLASS).addClass(DATAGRID_TEXT_CONTENT_CLASS).addClass(summaryItem.cssClass).toggleClass(DATAGRID_GROUP_TEXT_CONTENT_CLASS, \"group\" === options.rowType).text(_uiData_grid2.default.getSummaryText(summaryItem, options.summaryTexts)));\n    }\n\n    $cell.append($summaryItems);\n  }\n};\n\nvar getSummaryCellOptions = function getSummaryCellOptions(that, options) {\n  var summaryTexts = that.option(\"summary.texts\") || {};\n  return {\n    totalItem: options.row,\n    summaryItems: options.row.summaryCells[options.columnIndex],\n    summaryTexts: summaryTexts\n  };\n};\n\nvar getGroupAggregates = function getGroupAggregates(data) {\n  return data.summary || data.aggregates || [];\n};\n\nvar recalculateWhileEditing = function recalculateWhileEditing(that) {\n  return that.option(\"summary.recalculateWhileEditing\");\n};\n\nexports.FooterView = _uiGrid_core2.default.ColumnsView.inherit(function () {\n  return {\n    _getRows: function _getRows() {\n      return this._dataController.footerItems();\n    },\n    _getCellOptions: function _getCellOptions(options) {\n      return (0, _extend.extend)(this.callBase(options), getSummaryCellOptions(this, options));\n    },\n    _renderCellContent: function _renderCellContent($cell, options) {\n      renderSummaryCell($cell, options);\n      this.callBase($cell, options);\n    },\n    _renderCore: function _renderCore(change) {\n      var totalItem = this._dataController.footerItems()[0];\n\n      if (!change || !change.columnIndices) {\n        this.element().empty().addClass(DATAGRID_TOTAL_FOOTER_CLASS).toggleClass(DATAGRID_NOWRAP_CLASS, !this.option(\"wordWrapEnabled\"));\n      }\n\n      if (totalItem && totalItem.summaryCells && totalItem.summaryCells.length) {\n        this._updateContent(this._renderTable({\n          change: change\n        }), change);\n      }\n    },\n    _updateContent: function _updateContent($newTable, change) {\n      if (change && \"update\" === change.changeType && change.columnIndices) {\n        var $row = this._getTableElement().find(\".dx-row\");\n\n        var $newRow = $newTable.find(\".dx-row\");\n\n        this._updateCells($row, $newRow, change.columnIndices[0]);\n      } else {\n        return this.callBase.apply(this, arguments);\n      }\n    },\n    _rowClick: function _rowClick(e) {\n      var item = this._dataController.footerItems()[e.rowIndex] || {};\n      this.executeAction(\"onRowClick\", (0, _extend.extend)({}, e, item));\n    },\n    _columnOptionChanged: function _columnOptionChanged(e) {\n      var optionNames = e.optionNames;\n\n      if (e.changeTypes.grouping) {\n        return;\n      }\n\n      if (optionNames.width || optionNames.visibleWidth) {\n        this.callBase(e);\n      }\n    },\n    _handleDataChanged: function _handleDataChanged(e) {\n      var changeType = e.changeType;\n\n      if (\"update\" === e.changeType && e.repaintChangesOnly) {\n        if (!e.totalColumnIndices) {\n          this.render();\n        } else {\n          if (e.totalColumnIndices.length) {\n            this.render(null, {\n              changeType: \"update\",\n              columnIndices: [e.totalColumnIndices]\n            });\n          }\n        }\n      } else {\n        if (\"refresh\" === changeType || \"append\" === changeType || \"prepend\" === changeType) {\n          this.render();\n        }\n      }\n    },\n    getHeight: function getHeight() {\n      return this.getElementHeight();\n    },\n    isVisible: function isVisible() {\n      return !!this._dataController.footerItems().length;\n    }\n  };\n}());\n\nvar SummaryDataSourceAdapterExtender = function () {\n  function forEachGroup(groups, groupCount, callback, path) {\n    path = path || [];\n\n    for (var i = 0; i < groups.length; i++) {\n      path.push(groups[i].key);\n\n      if (1 === groupCount) {\n        callback(path, groups[i].items);\n      } else {\n        forEachGroup(groups[i].items, groupCount - 1, callback, path);\n      }\n\n      path.pop();\n    }\n  }\n\n  return {\n    init: function init() {\n      this.callBase.apply(this, arguments);\n      this._totalAggregates = [];\n      this._summaryGetter = _common.noop;\n    },\n    summaryGetter: function summaryGetter(_summaryGetter) {\n      if (!arguments.length) {\n        return this._summaryGetter;\n      }\n\n      if ((0, _type.isFunction)(_summaryGetter)) {\n        this._summaryGetter = _summaryGetter;\n      }\n    },\n    summary: function summary(_summary) {\n      if (!arguments.length) {\n        return this._summaryGetter();\n      }\n\n      this._summaryGetter = function () {\n        return _summary;\n      };\n    },\n    totalAggregates: function totalAggregates() {\n      return this._totalAggregates;\n    },\n    isLastLevelGroupItemsPagingLocal: function isLastLevelGroupItemsPagingLocal() {\n      var summary = this.summary();\n      var sortByGroupsInfo = summary && summary.sortByGroups();\n      return sortByGroupsInfo && sortByGroupsInfo.length;\n    },\n    sortLastLevelGroupItems: function sortLastLevelGroupItems(items, groups, paths) {\n      var groupedItems = (0, _store_helper.multiLevelGroup)((0, _query2.default)(items), groups).toArray();\n      var result = [];\n      paths.forEach(function (path) {\n        forEachGroup(groupedItems, groups.length, function (itemsPath, items) {\n          if (path.toString() === itemsPath.toString()) {\n            result = result.concat(items);\n          }\n        });\n      });\n      return result;\n    }\n  };\n}();\n\nvar SummaryDataSourceAdapterClientExtender = function () {\n  var applyAddedData = function applyAddedData(data, insertedData, groupLevel) {\n    if (groupLevel) {\n      return applyAddedData(data, insertedData.map(function (item) {\n        return {\n          items: [item]\n        };\n      }, groupLevel - 1));\n    }\n\n    return data.concat(insertedData);\n  };\n\n  var applyRemovedData = function applyRemovedData(data, removedData, groupLevel) {\n    if (groupLevel) {\n      return data.map(function (data) {\n        var updatedData = {};\n        var updatedItems = applyRemovedData(data.items || [], removedData, groupLevel - 1);\n        Object.defineProperty(updatedData, \"aggregates\", {\n          get: function get() {\n            return data.aggregates;\n          },\n          set: function set(value) {\n            data.aggregates = value;\n          }\n        });\n        return (0, _extend.extend)(updatedData, data, {\n          items: updatedItems\n        });\n      });\n    }\n\n    return data.filter(function (data) {\n      return removedData.indexOf(data) < 0;\n    });\n  };\n\n  var calculateAggregates = function calculateAggregates(that, summary, data, groupLevel) {\n    var calculator;\n\n    if (recalculateWhileEditing(that)) {\n      var editingController = that.getController(\"editing\");\n\n      if (editingController) {\n        var insertedData = editingController.getInsertedData();\n\n        if (insertedData.length) {\n          data = applyAddedData(data, insertedData, groupLevel);\n        }\n\n        var removedData = editingController.getRemovedData();\n\n        if (removedData.length) {\n          data = applyRemovedData(data, removedData, groupLevel);\n        }\n      }\n    }\n\n    if (summary) {\n      calculator = new _aggregate_calculator2.default({\n        totalAggregates: summary.totalAggregates,\n        groupAggregates: summary.groupAggregates,\n        data: data,\n        groupLevel: groupLevel\n      });\n      calculator.calculate();\n    }\n\n    return calculator ? calculator.totalAggregates() : [];\n  };\n\n  var sortGroupsBySummaryCore = function sortGroupsBySummaryCore(items, groups, sortByGroups) {\n    if (!items || !groups.length) {\n      return items;\n    }\n\n    var group = groups[0];\n    var sorts = sortByGroups[0];\n    var query;\n\n    if (group && sorts && sorts.length) {\n      query = (0, _query2.default)(items);\n      (0, _iterator.each)(sorts, function (index) {\n        if (0 === index) {\n          query = query.sortBy(this.selector, this.desc);\n        } else {\n          query = query.thenBy(this.selector, this.desc);\n        }\n      });\n      query.enumerate().done(function (sortedItems) {\n        items = sortedItems;\n      });\n    }\n\n    groups = groups.slice(1);\n    sortByGroups = sortByGroups.slice(1);\n\n    if (groups.length && sortByGroups.length) {\n      (0, _iterator.each)(items, function () {\n        this.items = sortGroupsBySummaryCore(this.items, groups, sortByGroups);\n      });\n    }\n\n    return items;\n  };\n\n  var sortGroupsBySummary = function sortGroupsBySummary(data, group, summary) {\n    var sortByGroups = summary && summary.sortByGroups && summary.sortByGroups();\n\n    if (sortByGroups && sortByGroups.length) {\n      return sortGroupsBySummaryCore(data, group, sortByGroups);\n    }\n\n    return data;\n  };\n\n  return {\n    _customizeRemoteOperations: function _customizeRemoteOperations(options) {\n      var summary = this.summary();\n\n      if (summary) {\n        if (options.remoteOperations.summary) {\n          if (!options.isCustomLoading || options.storeLoadOptions.isLoadingAll) {\n            if (options.storeLoadOptions.group) {\n              if (options.remoteOperations.grouping) {\n                options.storeLoadOptions.groupSummary = summary.groupAggregates;\n              } else {\n                if (summary.groupAggregates.length) {\n                  options.remoteOperations.paging = false;\n                }\n              }\n            }\n\n            options.storeLoadOptions.totalSummary = summary.totalAggregates;\n          }\n        } else {\n          if (summary.totalAggregates.length || summary.groupAggregates.length && options.storeLoadOptions.group) {\n            options.remoteOperations.paging = false;\n          }\n        }\n      }\n\n      this.callBase.apply(this, arguments);\n      var cachedExtra = options.cachedPagesData.extra;\n\n      if (cachedExtra && cachedExtra.summary && !options.isCustomLoading) {\n        options.storeLoadOptions.totalSummary = void 0;\n      }\n    },\n    _handleDataLoadedCore: function _handleDataLoadedCore(options) {\n      var that = this;\n      var groups = (0, _utils.normalizeSortingInfo)(options.storeLoadOptions.group || options.loadOptions.group || []);\n      var remoteOperations = options.remoteOperations || {};\n      var summary = that.summaryGetter()(remoteOperations);\n      var totalAggregates;\n\n      if (!options.isCustomLoading || options.storeLoadOptions.isLoadingAll) {\n        if (remoteOperations.summary) {\n          if (!remoteOperations.paging && groups.length && summary) {\n            if (!remoteOperations.grouping) {\n              calculateAggregates(that, {\n                groupAggregates: summary.groupAggregates\n              }, options.data, groups.length);\n            }\n\n            options.data = sortGroupsBySummary(options.data, groups, summary);\n          }\n        } else {\n          if (!remoteOperations.paging) {\n            totalAggregates = calculateAggregates(that, summary, options.data, groups.length);\n            options.data = sortGroupsBySummary(options.data, groups, summary);\n            options.extra = (0, _type.isPlainObject)(options.extra) ? options.extra : {};\n            options.extra.summary = totalAggregates;\n          }\n        }\n      }\n\n      if (!options.isCustomLoading) {\n        that._totalAggregates = options.extra && options.extra.summary || that._totalAggregates;\n      }\n\n      that.callBase(options);\n    }\n  };\n}();\n\n_uiData_grid4.default.extend(SummaryDataSourceAdapterExtender);\n\n_uiData_grid4.default.extend(SummaryDataSourceAdapterClientExtender);\n\nexports.renderSummaryCell = renderSummaryCell;\n\n_uiData_grid2.default.registerModule(\"summary\", {\n  defaultOptions: function defaultOptions() {\n    return {\n      summary: {\n        groupItems: void 0,\n        totalItems: void 0,\n        calculateCustomSummary: void 0,\n        skipEmptyValues: true,\n        recalculateWhileEditing: false,\n        texts: {\n          sum: _message2.default.getFormatter(\"dxDataGrid-summarySum\"),\n          sumOtherColumn: _message2.default.getFormatter(\"dxDataGrid-summarySumOtherColumn\"),\n          min: _message2.default.getFormatter(\"dxDataGrid-summaryMin\"),\n          minOtherColumn: _message2.default.getFormatter(\"dxDataGrid-summaryMinOtherColumn\"),\n          max: _message2.default.getFormatter(\"dxDataGrid-summaryMax\"),\n          maxOtherColumn: _message2.default.getFormatter(\"dxDataGrid-summaryMaxOtherColumn\"),\n          avg: _message2.default.getFormatter(\"dxDataGrid-summaryAvg\"),\n          avgOtherColumn: _message2.default.getFormatter(\"dxDataGrid-summaryAvgOtherColumn\"),\n          count: _message2.default.getFormatter(\"dxDataGrid-summaryCount\")\n        }\n      },\n      sortByGroupSummaryInfo: void 0\n    };\n  },\n  views: {\n    footerView: exports.FooterView\n  },\n  extenders: {\n    controllers: {\n      data: function () {\n        return {\n          _isDataColumn: function _isDataColumn(column) {\n            return column && (!(0, _type.isDefined)(column.groupIndex) || column.showWhenGrouped);\n          },\n          _isGroupFooterVisible: function _isGroupFooterVisible() {\n            var groupItems = this.option(\"summary.groupItems\") || [];\n            var groupItem;\n            var column;\n            var i;\n\n            for (i = 0; i < groupItems.length; i++) {\n              groupItem = groupItems[i];\n              column = this._columnsController.columnOption(groupItem.showInColumn || groupItem.column);\n\n              if (groupItem.showInGroupFooter && this._isDataColumn(column)) {\n                return true;\n              }\n            }\n\n            return false;\n          },\n          _processGroupItems: function _processGroupItems(items, groupCount, options) {\n            var data = options && options.data;\n            var result = this.callBase.apply(this, arguments);\n\n            if (options) {\n              if (void 0 === options.isGroupFooterVisible) {\n                options.isGroupFooterVisible = this._isGroupFooterVisible();\n              }\n\n              if (data && data.items && options.isGroupFooterVisible && (options.collectContinuationItems || !data.isContinuationOnNextPage)) {\n                result.push({\n                  rowType: DATAGRID_GROUP_FOOTER_ROW_TYPE,\n                  key: options.path.slice(),\n                  data: data,\n                  groupIndex: options.path.length - 1,\n                  values: []\n                });\n              }\n            }\n\n            return result;\n          },\n          _processGroupItem: function _processGroupItem(groupItem, options) {\n            var that = this;\n\n            if (!options.summaryGroupItems) {\n              options.summaryGroupItems = that.option(\"summary.groupItems\") || [];\n            }\n\n            if (\"group\" === groupItem.rowType) {\n              var groupColumnIndex = -1;\n              var afterGroupColumnIndex = -1;\n              (0, _iterator.each)(options.visibleColumns, function (visibleIndex) {\n                var prevColumn = options.visibleColumns[visibleIndex - 1];\n\n                if (groupItem.groupIndex === this.groupIndex) {\n                  groupColumnIndex = this.index;\n                }\n\n                if (visibleIndex > 0 && \"expand\" === prevColumn.command && \"expand\" !== this.command) {\n                  afterGroupColumnIndex = this.index;\n                }\n              });\n              groupItem.summaryCells = this._calculateSummaryCells(options.summaryGroupItems, getGroupAggregates(groupItem.data), options.visibleColumns, function (summaryItem, column) {\n                if (summaryItem.showInGroupFooter) {\n                  return -1;\n                }\n\n                if (summaryItem.alignByColumn && column && !(0, _type.isDefined)(column.groupIndex) && column.index !== afterGroupColumnIndex) {\n                  return column.index;\n                } else {\n                  return groupColumnIndex;\n                }\n              });\n            }\n\n            if (groupItem.rowType === DATAGRID_GROUP_FOOTER_ROW_TYPE) {\n              groupItem.summaryCells = this._calculateSummaryCells(options.summaryGroupItems, getGroupAggregates(groupItem.data), options.visibleColumns, function (summaryItem, column) {\n                return summaryItem.showInGroupFooter && that._isDataColumn(column) ? column.index : -1;\n              });\n            }\n\n            return groupItem;\n          },\n          _calculateSummaryCells: function _calculateSummaryCells(summaryItems, aggregates, visibleColumns, calculateTargetColumnIndex) {\n            var that = this;\n            var summaryCells = [];\n            var summaryCellsByColumns = {};\n            (0, _iterator.each)(summaryItems, function (summaryIndex, summaryItem) {\n              var column = that._columnsController.columnOption(summaryItem.column);\n\n              var showInColumn = summaryItem.showInColumn && that._columnsController.columnOption(summaryItem.showInColumn) || column;\n              var columnIndex = calculateTargetColumnIndex(summaryItem, showInColumn);\n              var aggregate;\n\n              if (columnIndex >= 0) {\n                if (!summaryCellsByColumns[columnIndex]) {\n                  summaryCellsByColumns[columnIndex] = [];\n                }\n\n                aggregate = aggregates[summaryIndex];\n\n                if (aggregate === aggregate) {\n                  var valueFormat;\n\n                  if ((0, _type.isDefined)(summaryItem.valueFormat)) {\n                    valueFormat = summaryItem.valueFormat;\n                  } else {\n                    if (\"count\" !== summaryItem.summaryType) {\n                      valueFormat = _uiData_grid2.default.getFormatByDataType(column && column.dataType);\n                    }\n                  }\n\n                  summaryCellsByColumns[columnIndex].push((0, _extend.extend)({}, summaryItem, {\n                    value: (0, _type.isString)(aggregate) && column && column.deserializeValue ? column.deserializeValue(aggregate) : aggregate,\n                    valueFormat: valueFormat,\n                    columnCaption: column && column.index !== columnIndex ? column.caption : void 0\n                  }));\n                }\n              }\n            });\n\n            if (!(0, _type.isEmptyObject)(summaryCellsByColumns)) {\n              (0, _iterator.each)(visibleColumns, function () {\n                summaryCells.push(summaryCellsByColumns[this.index] || []);\n              });\n            }\n\n            return summaryCells;\n          },\n          _getSummaryCells: function _getSummaryCells(summaryTotalItems, totalAggregates) {\n            var that = this;\n            var columnsController = that._columnsController;\n            return that._calculateSummaryCells(summaryTotalItems, totalAggregates, columnsController.getVisibleColumns(), function (summaryItem, column) {\n              return that._isDataColumn(column) ? column.index : -1;\n            });\n          },\n          _updateItemsCore: function _updateItemsCore(change) {\n            var that = this;\n            var summaryCells;\n            var totalAggregates;\n            var dataSource = that._dataSource;\n            var footerItems = that._footerItems;\n            var oldSummaryCells = footerItems && footerItems[0] && footerItems[0].summaryCells;\n            var summaryTotalItems = that.option(\"summary.totalItems\");\n            that._footerItems = [];\n\n            if (dataSource && summaryTotalItems && summaryTotalItems.length) {\n              totalAggregates = dataSource.totalAggregates();\n              summaryCells = that._getSummaryCells(summaryTotalItems, totalAggregates);\n\n              if (change && change.repaintChangesOnly && oldSummaryCells) {\n                change.totalColumnIndices = summaryCells.map(function (summaryCell, index) {\n                  if (JSON.stringify(summaryCell) !== JSON.stringify(oldSummaryCells[index])) {\n                    return index;\n                  }\n\n                  return -1;\n                }).filter(function (index) {\n                  return index >= 0;\n                });\n              }\n\n              if (summaryCells.length) {\n                that._footerItems.push({\n                  rowType: \"totalFooter\",\n                  summaryCells: summaryCells\n                });\n              }\n            }\n\n            that.callBase(change);\n          },\n          _prepareUnsavedDataSelector: function _prepareUnsavedDataSelector(selector) {\n            var that = this;\n\n            if (recalculateWhileEditing(that)) {\n              var editingController = that.getController(\"editing\");\n\n              if (editingController) {\n                return function (data) {\n                  data = editingController.getUpdatedData(data);\n                  return selector(data);\n                };\n              }\n            }\n\n            return selector;\n          },\n          _prepareAggregateSelector: function _prepareAggregateSelector(selector, aggregator) {\n            selector = this._prepareUnsavedDataSelector(selector);\n\n            if (\"avg\" === aggregator || \"sum\" === aggregator) {\n              return function (data) {\n                var value = selector(data);\n                return (0, _type.isDefined)(value) ? Number(value) : value;\n              };\n            }\n\n            return selector;\n          },\n          _getAggregates: function _getAggregates(summaryItems, remoteOperations) {\n            var that = this;\n            var columnsController = that.getController(\"columns\");\n            var calculateCustomSummary = that.option(\"summary.calculateCustomSummary\");\n            var commonSkipEmptyValues = that.option(\"summary.skipEmptyValues\");\n            return (0, _iterator.map)(summaryItems || [], function (summaryItem) {\n              var column = columnsController.columnOption(summaryItem.column);\n              var calculateCellValue = column && column.calculateCellValue ? column.calculateCellValue.bind(column) : (0, _data.compileGetter)(column ? column.dataField : summaryItem.column);\n              var aggregator = summaryItem.summaryType || \"count\";\n              var selector = summaryItem.column;\n              var skipEmptyValues = (0, _type.isDefined)(summaryItem.skipEmptyValues) ? summaryItem.skipEmptyValues : commonSkipEmptyValues;\n              var options;\n\n              if (remoteOperations) {\n                return {\n                  selector: summaryItem.column,\n                  summaryType: aggregator\n                };\n              } else {\n                selector = that._prepareAggregateSelector(calculateCellValue, aggregator);\n\n                if (\"custom\" === aggregator) {\n                  if (!calculateCustomSummary) {\n                    _ui2.default.log(\"E1026\");\n\n                    calculateCustomSummary = function calculateCustomSummary() {};\n                  }\n\n                  options = {\n                    component: that.component,\n                    name: summaryItem.name\n                  };\n                  calculateCustomSummary(options);\n                  options.summaryProcess = \"calculate\";\n                  aggregator = {\n                    seed: function seed(groupIndex) {\n                      options.summaryProcess = \"start\";\n                      options.totalValue = void 0;\n                      options.groupIndex = groupIndex;\n                      delete options.value;\n                      calculateCustomSummary(options);\n                      return options.totalValue;\n                    },\n                    step: function step(totalValue, value) {\n                      options.summaryProcess = \"calculate\";\n                      options.totalValue = totalValue;\n                      options.value = value;\n                      calculateCustomSummary(options);\n                      return options.totalValue;\n                    },\n                    finalize: function finalize(totalValue) {\n                      options.summaryProcess = \"finalize\";\n                      options.totalValue = totalValue;\n                      delete options.value;\n                      calculateCustomSummary(options);\n                      return options.totalValue;\n                    }\n                  };\n                }\n\n                return {\n                  selector: selector,\n                  aggregator: aggregator,\n                  skipEmptyValues: skipEmptyValues\n                };\n              }\n            });\n          },\n          _addSortInfo: function _addSortInfo(sortByGroups, groupColumn, selector, sortOrder) {\n            var groupIndex;\n\n            if (groupColumn) {\n              groupIndex = groupColumn.groupIndex;\n              sortOrder = sortOrder || groupColumn.sortOrder;\n\n              if ((0, _type.isDefined)(groupIndex)) {\n                sortByGroups[groupIndex] = sortByGroups[groupIndex] || [];\n                sortByGroups[groupIndex].push({\n                  selector: selector,\n                  desc: \"desc\" === sortOrder\n                });\n              }\n            }\n          },\n          _findSummaryItem: function _findSummaryItem(summaryItems, name) {\n            var summaryItemIndex = -1;\n\n            var getFullName = function getFullName(summaryItem) {\n              var summaryType = summaryItem.summaryType;\n              var column = summaryItem.column;\n              return summaryType && column && summaryType + \"_\" + column;\n            };\n\n            if ((0, _type.isDefined)(name)) {\n              (0, _iterator.each)(summaryItems || [], function (index) {\n                if (this.name === name || index === name || this.summaryType === name || this.column === name || getFullName(this) === name) {\n                  summaryItemIndex = index;\n                  return false;\n                }\n              });\n            }\n\n            return summaryItemIndex;\n          },\n          _getSummarySortByGroups: function _getSummarySortByGroups(sortByGroupSummaryInfo, groupSummaryItems) {\n            var that = this;\n            var columnsController = that._columnsController;\n            var groupColumns = columnsController.getGroupColumns();\n            var sortByGroups = [];\n\n            if (!groupSummaryItems || !groupSummaryItems.length) {\n              return;\n            }\n\n            (0, _iterator.each)(sortByGroupSummaryInfo || [], function () {\n              var sortOrder = this.sortOrder;\n              var groupColumn = this.groupColumn;\n\n              var summaryItemIndex = that._findSummaryItem(groupSummaryItems, this.summaryItem);\n\n              if (summaryItemIndex < 0) {\n                return;\n              }\n\n              var selector = function selector(data) {\n                return getGroupAggregates(data)[summaryItemIndex];\n              };\n\n              if ((0, _type.isDefined)(groupColumn)) {\n                groupColumn = columnsController.columnOption(groupColumn);\n\n                that._addSortInfo(sortByGroups, groupColumn, selector, sortOrder);\n              } else {\n                (0, _iterator.each)(groupColumns, function (groupIndex, groupColumn) {\n                  that._addSortInfo(sortByGroups, groupColumn, selector, sortOrder);\n                });\n              }\n            });\n            return sortByGroups;\n          },\n          _createDataSourceAdapterCore: function _createDataSourceAdapterCore(dataSource, remoteOperations) {\n            var that = this;\n            var dataSourceAdapter = this.callBase(dataSource, remoteOperations);\n            dataSourceAdapter.summaryGetter(function (currentRemoteOperations) {\n              return that._getSummaryOptions(currentRemoteOperations || remoteOperations);\n            });\n            return dataSourceAdapter;\n          },\n          _getSummaryOptions: function _getSummaryOptions(remoteOperations) {\n            var that = this;\n            var groupSummaryItems = that.option(\"summary.groupItems\");\n            var totalSummaryItems = that.option(\"summary.totalItems\");\n            var sortByGroupSummaryInfo = that.option(\"sortByGroupSummaryInfo\");\n\n            var groupAggregates = that._getAggregates(groupSummaryItems, remoteOperations && remoteOperations.grouping && remoteOperations.summary);\n\n            var totalAggregates = that._getAggregates(totalSummaryItems, remoteOperations && remoteOperations.summary);\n\n            var sortByGroups = function sortByGroups() {\n              return that._getSummarySortByGroups(sortByGroupSummaryInfo, groupSummaryItems);\n            };\n\n            if (groupAggregates.length || totalAggregates.length) {\n              return {\n                groupAggregates: groupAggregates,\n                totalAggregates: totalAggregates,\n                sortByGroups: sortByGroups\n              };\n            }\n          },\n          publicMethods: function publicMethods() {\n            var methods = this.callBase();\n            methods.push(\"getTotalSummaryValue\");\n            return methods;\n          },\n          getTotalSummaryValue: function getTotalSummaryValue(summaryItemName) {\n            var summaryItemIndex = this._findSummaryItem(this.option(\"summary.totalItems\"), summaryItemName);\n\n            var aggregates = this._dataSource.totalAggregates();\n\n            if (aggregates.length && summaryItemIndex > -1) {\n              return aggregates[summaryItemIndex];\n            }\n          },\n          optionChanged: function optionChanged(args) {\n            if (\"summary\" === args.name || \"sortByGroupSummaryInfo\" === args.name) {\n              args.name = \"dataSource\";\n            }\n\n            this.callBase(args);\n          },\n          init: function init() {\n            this._footerItems = [];\n            this.callBase();\n          },\n          footerItems: function footerItems() {\n            return this._footerItems;\n          }\n        };\n      }(),\n      editing: function () {\n        return {\n          _refreshSummary: function _refreshSummary() {\n            if (recalculateWhileEditing(this) && !this.isSaving()) {\n              this._dataController.refresh({\n                load: true,\n                changesOnly: true\n              });\n            }\n          },\n          _addEditData: function _addEditData(params) {\n            var result = this.callBase.apply(this, arguments);\n\n            if (params.type) {\n              this._refreshSummary();\n            }\n\n            return result;\n          },\n          _removeEditDataItem: function _removeEditDataItem() {\n            var result = this.callBase.apply(this, arguments);\n\n            this._refreshSummary();\n\n            return result;\n          },\n          cancelEditData: function cancelEditData() {\n            var result = this.callBase.apply(this, arguments);\n\n            this._refreshSummary();\n\n            return result;\n          }\n        };\n      }()\n    },\n    views: {\n      rowsView: function () {\n        return {\n          _createRow: function _createRow(row) {\n            var $row = this.callBase(row);\n            row && $row.addClass(row.rowType === DATAGRID_GROUP_FOOTER_ROW_TYPE ? DATAGRID_GROUP_FOOTER_CLASS : \"\");\n            return $row;\n          },\n          _renderCells: function _renderCells($row, options) {\n            this.callBase.apply(this, arguments);\n\n            if (\"group\" === options.row.rowType && options.row.summaryCells && options.row.summaryCells.length) {\n              this._renderGroupSummaryCells($row, options);\n            }\n          },\n          _hasAlignByColumnSummaryItems: function _hasAlignByColumnSummaryItems(columnIndex, options) {\n            return !(0, _type.isDefined)(options.columns[columnIndex].groupIndex) && options.row.summaryCells[columnIndex].length;\n          },\n          _getAlignByColumnCellCount: function _getAlignByColumnCellCount(groupCellColSpan, options) {\n            var alignByColumnCellCount = 0;\n            var columnIndex;\n\n            for (var i = 1; i < groupCellColSpan; i++) {\n              columnIndex = options.row.summaryCells.length - i;\n              alignByColumnCellCount = this._hasAlignByColumnSummaryItems(columnIndex, options) ? i : alignByColumnCellCount;\n            }\n\n            return alignByColumnCellCount;\n          },\n          _renderGroupSummaryCells: function _renderGroupSummaryCells($row, options) {\n            var $groupCell = $row.children().last();\n            var groupCellColSpan = Number($groupCell.attr(\"colSpan\")) || 1;\n\n            var alignByColumnCellCount = this._getAlignByColumnCellCount(groupCellColSpan, options);\n\n            this._renderGroupSummaryCellsCore($groupCell, options, groupCellColSpan, alignByColumnCellCount);\n          },\n          _renderGroupSummaryCellsCore: function _renderGroupSummaryCellsCore($groupCell, options, groupCellColSpan, alignByColumnCellCount) {\n            if (alignByColumnCellCount > 0) {\n              $groupCell.attr(\"colSpan\", groupCellColSpan - alignByColumnCellCount);\n\n              for (var i = 0; i < alignByColumnCellCount; i++) {\n                var columnIndex = options.columns.length - alignByColumnCellCount + i;\n\n                this._renderCell($groupCell.parent(), (0, _extend.extend)({\n                  column: options.columns[columnIndex],\n                  columnIndex: this._getSummaryCellIndex(columnIndex, options.columns)\n                }, options));\n              }\n            }\n          },\n          _getSummaryCellIndex: function _getSummaryCellIndex(columnIndex) {\n            return columnIndex;\n          },\n          _getCellTemplate: function _getCellTemplate(options) {\n            if (!options.column.command && !(0, _type.isDefined)(options.column.groupIndex) && options.summaryItems && options.summaryItems.length) {\n              return renderSummaryCell;\n            } else {\n              return this.callBase(options);\n            }\n          },\n          _getCellOptions: function _getCellOptions(options) {\n            var that = this;\n            var parameters = that.callBase(options);\n\n            if (options.row.summaryCells) {\n              return (0, _extend.extend)(parameters, getSummaryCellOptions(that, options));\n            } else {\n              return parameters;\n            }\n          }\n        };\n      }()\n    }\n  }\n});","map":{"version":3,"sources":["C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/devextreme/ui/data_grid/ui.data_grid.summary.js"],"names":["_renderer","require","_renderer2","_interopRequireDefault","_common","_type","_iterator","_extend","_data","_ui","_ui2","_uiData_grid","_uiData_grid2","_message","_message2","_uiData_grid3","_uiData_grid4","_uiGrid_core","_uiGrid_core2","_aggregate_calculator","_aggregate_calculator2","_query","_query2","_store_helper","_utils","obj","DATAGRID_TOTAL_FOOTER_CLASS","DATAGRID_SUMMARY_ITEM_CLASS","DATAGRID_TEXT_CONTENT_CLASS","DATAGRID_GROUP_FOOTER_CLASS","DATAGRID_GROUP_TEXT_CONTENT_CLASS","DATAGRID_NOWRAP_CLASS","DATAGRID_GROUP_FOOTER_ROW_TYPE","renderSummaryCell","$cell","column","options","summaryItems","$summaryItems","i","summaryItem","getSummaryCellOptions","summaryTexts","that","totalItem","getGroupAggregates","data","recalculateWhileEditing","exports","_getRows","_getCellOptions","_renderCellContent","_renderCore","change","_updateContent","$row","$newRow","$newTable","_rowClick","item","e","_columnOptionChanged","optionNames","_handleDataChanged","changeType","columnIndices","getHeight","isVisible","SummaryDataSourceAdapterExtender","path","groups","callback","forEachGroup","groupCount","init","summaryGetter","arguments","summary","totalAggregates","isLastLevelGroupItemsPagingLocal","sortByGroupsInfo","sortLastLevelGroupItems","groupedItems","result","paths","itemsPath","SummaryDataSourceAdapterClientExtender","applyAddedData","items","groupLevel","applyRemovedData","updatedData","updatedItems","Object","get","set","removedData","calculateAggregates","editingController","insertedData","calculator","groupAggregates","sortGroupsBySummaryCore","group","sorts","sortByGroups","query","sortGroupsBySummary","_customizeRemoteOperations","cachedExtra","_handleDataLoadedCore","remoteOperations","defaultOptions","groupItems","totalItems","calculateCustomSummary","skipEmptyValues","texts","sum","sumOtherColumn","min","minOtherColumn","max","maxOtherColumn","avg","avgOtherColumn","count","sortByGroupSummaryInfo","views","footerView","FooterView","extenders","controllers","_isDataColumn","_isGroupFooterVisible","groupItem","_processGroupItems","rowType","key","groupIndex","values","_processGroupItem","groupColumnIndex","afterGroupColumnIndex","prevColumn","visibleIndex","_calculateSummaryCells","summaryCells","summaryCellsByColumns","showInColumn","columnIndex","calculateTargetColumnIndex","aggregate","aggregates","valueFormat","value","columnCaption","_getSummaryCells","columnsController","_updateItemsCore","dataSource","footerItems","oldSummaryCells","summaryTotalItems","JSON","index","_prepareUnsavedDataSelector","selector","_prepareAggregateSelector","Number","_getAggregates","commonSkipEmptyValues","calculateCellValue","aggregator","summaryType","component","name","seed","step","finalize","_addSortInfo","groupColumn","sortOrder","desc","_findSummaryItem","summaryItemIndex","getFullName","_getSummarySortByGroups","groupColumns","groupSummaryItems","_createDataSourceAdapterCore","dataSourceAdapter","currentRemoteOperations","_getSummaryOptions","totalSummaryItems","publicMethods","methods","getTotalSummaryValue","optionChanged","args","editing","_refreshSummary","load","changesOnly","_addEditData","params","_removeEditDataItem","cancelEditData","rowsView","_createRow","row","_renderCells","_hasAlignByColumnSummaryItems","_getAlignByColumnCellCount","alignByColumnCellCount","_renderGroupSummaryCells","$groupCell","groupCellColSpan","_renderGroupSummaryCellsCore","_getSummaryCellIndex","_getCellTemplate","parameters"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/data_grid/ui.data_grid.summary.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar _renderer = require(\"../../core/renderer\");\r\nvar _renderer2 = _interopRequireDefault(_renderer);\r\nvar _common = require(\"../../core/utils/common\");\r\nvar _type = require(\"../../core/utils/type\");\r\nvar _iterator = require(\"../../core/utils/iterator\");\r\nvar _extend = require(\"../../core/utils/extend\");\r\nvar _data = require(\"../../core/utils/data\");\r\nvar _ui = require(\"../widget/ui.errors\");\r\nvar _ui2 = _interopRequireDefault(_ui);\r\nvar _uiData_grid = require(\"./ui.data_grid.core\");\r\nvar _uiData_grid2 = _interopRequireDefault(_uiData_grid);\r\nvar _message = require(\"../../localization/message\");\r\nvar _message2 = _interopRequireDefault(_message);\r\nvar _uiData_grid3 = require(\"./ui.data_grid.data_source_adapter\");\r\nvar _uiData_grid4 = _interopRequireDefault(_uiData_grid3);\r\nvar _uiGrid_core = require(\"../grid_core/ui.grid_core.columns_view\");\r\nvar _uiGrid_core2 = _interopRequireDefault(_uiGrid_core);\r\nvar _aggregate_calculator = require(\"./aggregate_calculator\");\r\nvar _aggregate_calculator2 = _interopRequireDefault(_aggregate_calculator);\r\nvar _query = require(\"../../data/query\");\r\nvar _query2 = _interopRequireDefault(_query);\r\nvar _store_helper = require(\"../../data/store_helper\");\r\nvar _utils = require(\"../../data/utils\");\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\nvar DATAGRID_TOTAL_FOOTER_CLASS = \"dx-datagrid-total-footer\";\r\nvar DATAGRID_SUMMARY_ITEM_CLASS = \"dx-datagrid-summary-item\";\r\nvar DATAGRID_TEXT_CONTENT_CLASS = \"dx-datagrid-text-content\";\r\nvar DATAGRID_GROUP_FOOTER_CLASS = \"dx-datagrid-group-footer\";\r\nvar DATAGRID_GROUP_TEXT_CONTENT_CLASS = \"dx-datagrid-group-text-content\";\r\nvar DATAGRID_NOWRAP_CLASS = \"dx-datagrid-nowrap\";\r\nvar DATAGRID_GROUP_FOOTER_ROW_TYPE = \"groupFooter\";\r\nvar renderSummaryCell = function(cell, options) {\r\n    var i;\r\n    var $cell = (0, _renderer2.default)(cell);\r\n    var column = options.column;\r\n    var summaryItems = options.summaryItems;\r\n    var summaryItem;\r\n    var $summaryItems = [];\r\n    if (!column.command && summaryItems) {\r\n        for (i = 0; i < summaryItems.length; i++) {\r\n            summaryItem = summaryItems[i];\r\n            $summaryItems.push((0, _renderer2.default)(\"<div>\").css(\"textAlign\", summaryItem.alignment || column.alignment).addClass(DATAGRID_SUMMARY_ITEM_CLASS).addClass(DATAGRID_TEXT_CONTENT_CLASS).addClass(summaryItem.cssClass).toggleClass(DATAGRID_GROUP_TEXT_CONTENT_CLASS, \"group\" === options.rowType).text(_uiData_grid2.default.getSummaryText(summaryItem, options.summaryTexts)))\r\n        }\r\n        $cell.append($summaryItems)\r\n    }\r\n};\r\nvar getSummaryCellOptions = function(that, options) {\r\n    var summaryTexts = that.option(\"summary.texts\") || {};\r\n    return {\r\n        totalItem: options.row,\r\n        summaryItems: options.row.summaryCells[options.columnIndex],\r\n        summaryTexts: summaryTexts\r\n    }\r\n};\r\nvar getGroupAggregates = function(data) {\r\n    return data.summary || data.aggregates || []\r\n};\r\nvar recalculateWhileEditing = function(that) {\r\n    return that.option(\"summary.recalculateWhileEditing\")\r\n};\r\nexports.FooterView = _uiGrid_core2.default.ColumnsView.inherit(function() {\r\n    return {\r\n        _getRows: function() {\r\n            return this._dataController.footerItems()\r\n        },\r\n        _getCellOptions: function(options) {\r\n            return (0, _extend.extend)(this.callBase(options), getSummaryCellOptions(this, options))\r\n        },\r\n        _renderCellContent: function($cell, options) {\r\n            renderSummaryCell($cell, options);\r\n            this.callBase($cell, options)\r\n        },\r\n        _renderCore: function(change) {\r\n            var totalItem = this._dataController.footerItems()[0];\r\n            if (!change || !change.columnIndices) {\r\n                this.element().empty().addClass(DATAGRID_TOTAL_FOOTER_CLASS).toggleClass(DATAGRID_NOWRAP_CLASS, !this.option(\"wordWrapEnabled\"))\r\n            }\r\n            if (totalItem && totalItem.summaryCells && totalItem.summaryCells.length) {\r\n                this._updateContent(this._renderTable({\r\n                    change: change\r\n                }), change)\r\n            }\r\n        },\r\n        _updateContent: function($newTable, change) {\r\n            if (change && \"update\" === change.changeType && change.columnIndices) {\r\n                var $row = this._getTableElement().find(\".dx-row\");\r\n                var $newRow = $newTable.find(\".dx-row\");\r\n                this._updateCells($row, $newRow, change.columnIndices[0])\r\n            } else {\r\n                return this.callBase.apply(this, arguments)\r\n            }\r\n        },\r\n        _rowClick: function(e) {\r\n            var item = this._dataController.footerItems()[e.rowIndex] || {};\r\n            this.executeAction(\"onRowClick\", (0, _extend.extend)({}, e, item))\r\n        },\r\n        _columnOptionChanged: function(e) {\r\n            var optionNames = e.optionNames;\r\n            if (e.changeTypes.grouping) {\r\n                return\r\n            }\r\n            if (optionNames.width || optionNames.visibleWidth) {\r\n                this.callBase(e)\r\n            }\r\n        },\r\n        _handleDataChanged: function(e) {\r\n            var changeType = e.changeType;\r\n            if (\"update\" === e.changeType && e.repaintChangesOnly) {\r\n                if (!e.totalColumnIndices) {\r\n                    this.render()\r\n                } else {\r\n                    if (e.totalColumnIndices.length) {\r\n                        this.render(null, {\r\n                            changeType: \"update\",\r\n                            columnIndices: [e.totalColumnIndices]\r\n                        })\r\n                    }\r\n                }\r\n            } else {\r\n                if (\"refresh\" === changeType || \"append\" === changeType || \"prepend\" === changeType) {\r\n                    this.render()\r\n                }\r\n            }\r\n        },\r\n        getHeight: function() {\r\n            return this.getElementHeight()\r\n        },\r\n        isVisible: function() {\r\n            return !!this._dataController.footerItems().length\r\n        }\r\n    }\r\n}());\r\nvar SummaryDataSourceAdapterExtender = function() {\r\n    function forEachGroup(groups, groupCount, callback, path) {\r\n        path = path || [];\r\n        for (var i = 0; i < groups.length; i++) {\r\n            path.push(groups[i].key);\r\n            if (1 === groupCount) {\r\n                callback(path, groups[i].items)\r\n            } else {\r\n                forEachGroup(groups[i].items, groupCount - 1, callback, path)\r\n            }\r\n            path.pop()\r\n        }\r\n    }\r\n    return {\r\n        init: function() {\r\n            this.callBase.apply(this, arguments);\r\n            this._totalAggregates = [];\r\n            this._summaryGetter = _common.noop\r\n        },\r\n        summaryGetter: function(_summaryGetter) {\r\n            if (!arguments.length) {\r\n                return this._summaryGetter\r\n            }\r\n            if ((0, _type.isFunction)(_summaryGetter)) {\r\n                this._summaryGetter = _summaryGetter\r\n            }\r\n        },\r\n        summary: function(_summary) {\r\n            if (!arguments.length) {\r\n                return this._summaryGetter()\r\n            }\r\n            this._summaryGetter = function() {\r\n                return _summary\r\n            }\r\n        },\r\n        totalAggregates: function() {\r\n            return this._totalAggregates\r\n        },\r\n        isLastLevelGroupItemsPagingLocal: function() {\r\n            var summary = this.summary();\r\n            var sortByGroupsInfo = summary && summary.sortByGroups();\r\n            return sortByGroupsInfo && sortByGroupsInfo.length\r\n        },\r\n        sortLastLevelGroupItems: function(items, groups, paths) {\r\n            var groupedItems = (0, _store_helper.multiLevelGroup)((0, _query2.default)(items), groups).toArray();\r\n            var result = [];\r\n            paths.forEach(function(path) {\r\n                forEachGroup(groupedItems, groups.length, function(itemsPath, items) {\r\n                    if (path.toString() === itemsPath.toString()) {\r\n                        result = result.concat(items)\r\n                    }\r\n                })\r\n            });\r\n            return result\r\n        }\r\n    }\r\n}();\r\nvar SummaryDataSourceAdapterClientExtender = function() {\r\n    var applyAddedData = function applyAddedData(data, insertedData, groupLevel) {\r\n        if (groupLevel) {\r\n            return applyAddedData(data, insertedData.map(function(item) {\r\n                return {\r\n                    items: [item]\r\n                }\r\n            }, groupLevel - 1))\r\n        }\r\n        return data.concat(insertedData)\r\n    };\r\n    var applyRemovedData = function applyRemovedData(data, removedData, groupLevel) {\r\n        if (groupLevel) {\r\n            return data.map(function(data) {\r\n                var updatedData = {};\r\n                var updatedItems = applyRemovedData(data.items || [], removedData, groupLevel - 1);\r\n                Object.defineProperty(updatedData, \"aggregates\", {\r\n                    get: function() {\r\n                        return data.aggregates\r\n                    },\r\n                    set: function(value) {\r\n                        data.aggregates = value\r\n                    }\r\n                });\r\n                return (0, _extend.extend)(updatedData, data, {\r\n                    items: updatedItems\r\n                })\r\n            })\r\n        }\r\n        return data.filter(function(data) {\r\n            return removedData.indexOf(data) < 0\r\n        })\r\n    };\r\n    var calculateAggregates = function(that, summary, data, groupLevel) {\r\n        var calculator;\r\n        if (recalculateWhileEditing(that)) {\r\n            var editingController = that.getController(\"editing\");\r\n            if (editingController) {\r\n                var insertedData = editingController.getInsertedData();\r\n                if (insertedData.length) {\r\n                    data = applyAddedData(data, insertedData, groupLevel)\r\n                }\r\n                var removedData = editingController.getRemovedData();\r\n                if (removedData.length) {\r\n                    data = applyRemovedData(data, removedData, groupLevel)\r\n                }\r\n            }\r\n        }\r\n        if (summary) {\r\n            calculator = new _aggregate_calculator2.default({\r\n                totalAggregates: summary.totalAggregates,\r\n                groupAggregates: summary.groupAggregates,\r\n                data: data,\r\n                groupLevel: groupLevel\r\n            });\r\n            calculator.calculate()\r\n        }\r\n        return calculator ? calculator.totalAggregates() : []\r\n    };\r\n    var sortGroupsBySummaryCore = function sortGroupsBySummaryCore(items, groups, sortByGroups) {\r\n        if (!items || !groups.length) {\r\n            return items\r\n        }\r\n        var group = groups[0];\r\n        var sorts = sortByGroups[0];\r\n        var query;\r\n        if (group && sorts && sorts.length) {\r\n            query = (0, _query2.default)(items);\r\n            (0, _iterator.each)(sorts, function(index) {\r\n                if (0 === index) {\r\n                    query = query.sortBy(this.selector, this.desc)\r\n                } else {\r\n                    query = query.thenBy(this.selector, this.desc)\r\n                }\r\n            });\r\n            query.enumerate().done(function(sortedItems) {\r\n                items = sortedItems\r\n            })\r\n        }\r\n        groups = groups.slice(1);\r\n        sortByGroups = sortByGroups.slice(1);\r\n        if (groups.length && sortByGroups.length) {\r\n            (0, _iterator.each)(items, function() {\r\n                this.items = sortGroupsBySummaryCore(this.items, groups, sortByGroups)\r\n            })\r\n        }\r\n        return items\r\n    };\r\n    var sortGroupsBySummary = function(data, group, summary) {\r\n        var sortByGroups = summary && summary.sortByGroups && summary.sortByGroups();\r\n        if (sortByGroups && sortByGroups.length) {\r\n            return sortGroupsBySummaryCore(data, group, sortByGroups)\r\n        }\r\n        return data\r\n    };\r\n    return {\r\n        _customizeRemoteOperations: function(options) {\r\n            var summary = this.summary();\r\n            if (summary) {\r\n                if (options.remoteOperations.summary) {\r\n                    if (!options.isCustomLoading || options.storeLoadOptions.isLoadingAll) {\r\n                        if (options.storeLoadOptions.group) {\r\n                            if (options.remoteOperations.grouping) {\r\n                                options.storeLoadOptions.groupSummary = summary.groupAggregates\r\n                            } else {\r\n                                if (summary.groupAggregates.length) {\r\n                                    options.remoteOperations.paging = false\r\n                                }\r\n                            }\r\n                        }\r\n                        options.storeLoadOptions.totalSummary = summary.totalAggregates\r\n                    }\r\n                } else {\r\n                    if (summary.totalAggregates.length || summary.groupAggregates.length && options.storeLoadOptions.group) {\r\n                        options.remoteOperations.paging = false\r\n                    }\r\n                }\r\n            }\r\n            this.callBase.apply(this, arguments);\r\n            var cachedExtra = options.cachedPagesData.extra;\r\n            if (cachedExtra && cachedExtra.summary && !options.isCustomLoading) {\r\n                options.storeLoadOptions.totalSummary = void 0\r\n            }\r\n        },\r\n        _handleDataLoadedCore: function(options) {\r\n            var that = this;\r\n            var groups = (0, _utils.normalizeSortingInfo)(options.storeLoadOptions.group || options.loadOptions.group || []);\r\n            var remoteOperations = options.remoteOperations || {};\r\n            var summary = that.summaryGetter()(remoteOperations);\r\n            var totalAggregates;\r\n            if (!options.isCustomLoading || options.storeLoadOptions.isLoadingAll) {\r\n                if (remoteOperations.summary) {\r\n                    if (!remoteOperations.paging && groups.length && summary) {\r\n                        if (!remoteOperations.grouping) {\r\n                            calculateAggregates(that, {\r\n                                groupAggregates: summary.groupAggregates\r\n                            }, options.data, groups.length)\r\n                        }\r\n                        options.data = sortGroupsBySummary(options.data, groups, summary)\r\n                    }\r\n                } else {\r\n                    if (!remoteOperations.paging) {\r\n                        totalAggregates = calculateAggregates(that, summary, options.data, groups.length);\r\n                        options.data = sortGroupsBySummary(options.data, groups, summary);\r\n                        options.extra = (0, _type.isPlainObject)(options.extra) ? options.extra : {};\r\n                        options.extra.summary = totalAggregates\r\n                    }\r\n                }\r\n            }\r\n            if (!options.isCustomLoading) {\r\n                that._totalAggregates = options.extra && options.extra.summary || that._totalAggregates\r\n            }\r\n            that.callBase(options)\r\n        }\r\n    }\r\n}();\r\n_uiData_grid4.default.extend(SummaryDataSourceAdapterExtender);\r\n_uiData_grid4.default.extend(SummaryDataSourceAdapterClientExtender);\r\nexports.renderSummaryCell = renderSummaryCell;\r\n_uiData_grid2.default.registerModule(\"summary\", {\r\n    defaultOptions: function() {\r\n        return {\r\n            summary: {\r\n                groupItems: void 0,\r\n                totalItems: void 0,\r\n                calculateCustomSummary: void 0,\r\n                skipEmptyValues: true,\r\n                recalculateWhileEditing: false,\r\n                texts: {\r\n                    sum: _message2.default.getFormatter(\"dxDataGrid-summarySum\"),\r\n                    sumOtherColumn: _message2.default.getFormatter(\"dxDataGrid-summarySumOtherColumn\"),\r\n                    min: _message2.default.getFormatter(\"dxDataGrid-summaryMin\"),\r\n                    minOtherColumn: _message2.default.getFormatter(\"dxDataGrid-summaryMinOtherColumn\"),\r\n                    max: _message2.default.getFormatter(\"dxDataGrid-summaryMax\"),\r\n                    maxOtherColumn: _message2.default.getFormatter(\"dxDataGrid-summaryMaxOtherColumn\"),\r\n                    avg: _message2.default.getFormatter(\"dxDataGrid-summaryAvg\"),\r\n                    avgOtherColumn: _message2.default.getFormatter(\"dxDataGrid-summaryAvgOtherColumn\"),\r\n                    count: _message2.default.getFormatter(\"dxDataGrid-summaryCount\")\r\n                }\r\n            },\r\n            sortByGroupSummaryInfo: void 0\r\n        }\r\n    },\r\n    views: {\r\n        footerView: exports.FooterView\r\n    },\r\n    extenders: {\r\n        controllers: {\r\n            data: function() {\r\n                return {\r\n                    _isDataColumn: function(column) {\r\n                        return column && (!(0, _type.isDefined)(column.groupIndex) || column.showWhenGrouped)\r\n                    },\r\n                    _isGroupFooterVisible: function() {\r\n                        var groupItems = this.option(\"summary.groupItems\") || [];\r\n                        var groupItem;\r\n                        var column;\r\n                        var i;\r\n                        for (i = 0; i < groupItems.length; i++) {\r\n                            groupItem = groupItems[i];\r\n                            column = this._columnsController.columnOption(groupItem.showInColumn || groupItem.column);\r\n                            if (groupItem.showInGroupFooter && this._isDataColumn(column)) {\r\n                                return true\r\n                            }\r\n                        }\r\n                        return false\r\n                    },\r\n                    _processGroupItems: function(items, groupCount, options) {\r\n                        var data = options && options.data;\r\n                        var result = this.callBase.apply(this, arguments);\r\n                        if (options) {\r\n                            if (void 0 === options.isGroupFooterVisible) {\r\n                                options.isGroupFooterVisible = this._isGroupFooterVisible()\r\n                            }\r\n                            if (data && data.items && options.isGroupFooterVisible && (options.collectContinuationItems || !data.isContinuationOnNextPage)) {\r\n                                result.push({\r\n                                    rowType: DATAGRID_GROUP_FOOTER_ROW_TYPE,\r\n                                    key: options.path.slice(),\r\n                                    data: data,\r\n                                    groupIndex: options.path.length - 1,\r\n                                    values: []\r\n                                })\r\n                            }\r\n                        }\r\n                        return result\r\n                    },\r\n                    _processGroupItem: function(groupItem, options) {\r\n                        var that = this;\r\n                        if (!options.summaryGroupItems) {\r\n                            options.summaryGroupItems = that.option(\"summary.groupItems\") || []\r\n                        }\r\n                        if (\"group\" === groupItem.rowType) {\r\n                            var groupColumnIndex = -1;\r\n                            var afterGroupColumnIndex = -1;\r\n                            (0, _iterator.each)(options.visibleColumns, function(visibleIndex) {\r\n                                var prevColumn = options.visibleColumns[visibleIndex - 1];\r\n                                if (groupItem.groupIndex === this.groupIndex) {\r\n                                    groupColumnIndex = this.index\r\n                                }\r\n                                if (visibleIndex > 0 && \"expand\" === prevColumn.command && \"expand\" !== this.command) {\r\n                                    afterGroupColumnIndex = this.index\r\n                                }\r\n                            });\r\n                            groupItem.summaryCells = this._calculateSummaryCells(options.summaryGroupItems, getGroupAggregates(groupItem.data), options.visibleColumns, function(summaryItem, column) {\r\n                                if (summaryItem.showInGroupFooter) {\r\n                                    return -1\r\n                                }\r\n                                if (summaryItem.alignByColumn && column && !(0, _type.isDefined)(column.groupIndex) && column.index !== afterGroupColumnIndex) {\r\n                                    return column.index\r\n                                } else {\r\n                                    return groupColumnIndex\r\n                                }\r\n                            })\r\n                        }\r\n                        if (groupItem.rowType === DATAGRID_GROUP_FOOTER_ROW_TYPE) {\r\n                            groupItem.summaryCells = this._calculateSummaryCells(options.summaryGroupItems, getGroupAggregates(groupItem.data), options.visibleColumns, function(summaryItem, column) {\r\n                                return summaryItem.showInGroupFooter && that._isDataColumn(column) ? column.index : -1\r\n                            })\r\n                        }\r\n                        return groupItem\r\n                    },\r\n                    _calculateSummaryCells: function(summaryItems, aggregates, visibleColumns, calculateTargetColumnIndex) {\r\n                        var that = this;\r\n                        var summaryCells = [];\r\n                        var summaryCellsByColumns = {};\r\n                        (0, _iterator.each)(summaryItems, function(summaryIndex, summaryItem) {\r\n                            var column = that._columnsController.columnOption(summaryItem.column);\r\n                            var showInColumn = summaryItem.showInColumn && that._columnsController.columnOption(summaryItem.showInColumn) || column;\r\n                            var columnIndex = calculateTargetColumnIndex(summaryItem, showInColumn);\r\n                            var aggregate;\r\n                            if (columnIndex >= 0) {\r\n                                if (!summaryCellsByColumns[columnIndex]) {\r\n                                    summaryCellsByColumns[columnIndex] = []\r\n                                }\r\n                                aggregate = aggregates[summaryIndex];\r\n                                if (aggregate === aggregate) {\r\n                                    var valueFormat;\r\n                                    if ((0, _type.isDefined)(summaryItem.valueFormat)) {\r\n                                        valueFormat = summaryItem.valueFormat\r\n                                    } else {\r\n                                        if (\"count\" !== summaryItem.summaryType) {\r\n                                            valueFormat = _uiData_grid2.default.getFormatByDataType(column && column.dataType)\r\n                                        }\r\n                                    }\r\n                                    summaryCellsByColumns[columnIndex].push((0, _extend.extend)({}, summaryItem, {\r\n                                        value: (0, _type.isString)(aggregate) && column && column.deserializeValue ? column.deserializeValue(aggregate) : aggregate,\r\n                                        valueFormat: valueFormat,\r\n                                        columnCaption: column && column.index !== columnIndex ? column.caption : void 0\r\n                                    }))\r\n                                }\r\n                            }\r\n                        });\r\n                        if (!(0, _type.isEmptyObject)(summaryCellsByColumns)) {\r\n                            (0, _iterator.each)(visibleColumns, function() {\r\n                                summaryCells.push(summaryCellsByColumns[this.index] || [])\r\n                            })\r\n                        }\r\n                        return summaryCells\r\n                    },\r\n                    _getSummaryCells: function(summaryTotalItems, totalAggregates) {\r\n                        var that = this;\r\n                        var columnsController = that._columnsController;\r\n                        return that._calculateSummaryCells(summaryTotalItems, totalAggregates, columnsController.getVisibleColumns(), function(summaryItem, column) {\r\n                            return that._isDataColumn(column) ? column.index : -1\r\n                        })\r\n                    },\r\n                    _updateItemsCore: function(change) {\r\n                        var that = this;\r\n                        var summaryCells;\r\n                        var totalAggregates;\r\n                        var dataSource = that._dataSource;\r\n                        var footerItems = that._footerItems;\r\n                        var oldSummaryCells = footerItems && footerItems[0] && footerItems[0].summaryCells;\r\n                        var summaryTotalItems = that.option(\"summary.totalItems\");\r\n                        that._footerItems = [];\r\n                        if (dataSource && summaryTotalItems && summaryTotalItems.length) {\r\n                            totalAggregates = dataSource.totalAggregates();\r\n                            summaryCells = that._getSummaryCells(summaryTotalItems, totalAggregates);\r\n                            if (change && change.repaintChangesOnly && oldSummaryCells) {\r\n                                change.totalColumnIndices = summaryCells.map(function(summaryCell, index) {\r\n                                    if (JSON.stringify(summaryCell) !== JSON.stringify(oldSummaryCells[index])) {\r\n                                        return index\r\n                                    }\r\n                                    return -1\r\n                                }).filter(function(index) {\r\n                                    return index >= 0\r\n                                })\r\n                            }\r\n                            if (summaryCells.length) {\r\n                                that._footerItems.push({\r\n                                    rowType: \"totalFooter\",\r\n                                    summaryCells: summaryCells\r\n                                })\r\n                            }\r\n                        }\r\n                        that.callBase(change)\r\n                    },\r\n                    _prepareUnsavedDataSelector: function(selector) {\r\n                        var that = this;\r\n                        if (recalculateWhileEditing(that)) {\r\n                            var editingController = that.getController(\"editing\");\r\n                            if (editingController) {\r\n                                return function(data) {\r\n                                    data = editingController.getUpdatedData(data);\r\n                                    return selector(data)\r\n                                }\r\n                            }\r\n                        }\r\n                        return selector\r\n                    },\r\n                    _prepareAggregateSelector: function(selector, aggregator) {\r\n                        selector = this._prepareUnsavedDataSelector(selector);\r\n                        if (\"avg\" === aggregator || \"sum\" === aggregator) {\r\n                            return function(data) {\r\n                                var value = selector(data);\r\n                                return (0, _type.isDefined)(value) ? Number(value) : value\r\n                            }\r\n                        }\r\n                        return selector\r\n                    },\r\n                    _getAggregates: function(summaryItems, remoteOperations) {\r\n                        var that = this;\r\n                        var columnsController = that.getController(\"columns\");\r\n                        var calculateCustomSummary = that.option(\"summary.calculateCustomSummary\");\r\n                        var commonSkipEmptyValues = that.option(\"summary.skipEmptyValues\");\r\n                        return (0, _iterator.map)(summaryItems || [], function(summaryItem) {\r\n                            var column = columnsController.columnOption(summaryItem.column);\r\n                            var calculateCellValue = column && column.calculateCellValue ? column.calculateCellValue.bind(column) : (0, _data.compileGetter)(column ? column.dataField : summaryItem.column);\r\n                            var aggregator = summaryItem.summaryType || \"count\";\r\n                            var selector = summaryItem.column;\r\n                            var skipEmptyValues = (0, _type.isDefined)(summaryItem.skipEmptyValues) ? summaryItem.skipEmptyValues : commonSkipEmptyValues;\r\n                            var options;\r\n                            if (remoteOperations) {\r\n                                return {\r\n                                    selector: summaryItem.column,\r\n                                    summaryType: aggregator\r\n                                }\r\n                            } else {\r\n                                selector = that._prepareAggregateSelector(calculateCellValue, aggregator);\r\n                                if (\"custom\" === aggregator) {\r\n                                    if (!calculateCustomSummary) {\r\n                                        _ui2.default.log(\"E1026\");\r\n                                        calculateCustomSummary = function() {}\r\n                                    }\r\n                                    options = {\r\n                                        component: that.component,\r\n                                        name: summaryItem.name\r\n                                    };\r\n                                    calculateCustomSummary(options);\r\n                                    options.summaryProcess = \"calculate\";\r\n                                    aggregator = {\r\n                                        seed: function(groupIndex) {\r\n                                            options.summaryProcess = \"start\";\r\n                                            options.totalValue = void 0;\r\n                                            options.groupIndex = groupIndex;\r\n                                            delete options.value;\r\n                                            calculateCustomSummary(options);\r\n                                            return options.totalValue\r\n                                        },\r\n                                        step: function(totalValue, value) {\r\n                                            options.summaryProcess = \"calculate\";\r\n                                            options.totalValue = totalValue;\r\n                                            options.value = value;\r\n                                            calculateCustomSummary(options);\r\n                                            return options.totalValue\r\n                                        },\r\n                                        finalize: function(totalValue) {\r\n                                            options.summaryProcess = \"finalize\";\r\n                                            options.totalValue = totalValue;\r\n                                            delete options.value;\r\n                                            calculateCustomSummary(options);\r\n                                            return options.totalValue\r\n                                        }\r\n                                    }\r\n                                }\r\n                                return {\r\n                                    selector: selector,\r\n                                    aggregator: aggregator,\r\n                                    skipEmptyValues: skipEmptyValues\r\n                                }\r\n                            }\r\n                        })\r\n                    },\r\n                    _addSortInfo: function(sortByGroups, groupColumn, selector, sortOrder) {\r\n                        var groupIndex;\r\n                        if (groupColumn) {\r\n                            groupIndex = groupColumn.groupIndex;\r\n                            sortOrder = sortOrder || groupColumn.sortOrder;\r\n                            if ((0, _type.isDefined)(groupIndex)) {\r\n                                sortByGroups[groupIndex] = sortByGroups[groupIndex] || [];\r\n                                sortByGroups[groupIndex].push({\r\n                                    selector: selector,\r\n                                    desc: \"desc\" === sortOrder\r\n                                })\r\n                            }\r\n                        }\r\n                    },\r\n                    _findSummaryItem: function(summaryItems, name) {\r\n                        var summaryItemIndex = -1;\r\n                        var getFullName = function(summaryItem) {\r\n                            var summaryType = summaryItem.summaryType;\r\n                            var column = summaryItem.column;\r\n                            return summaryType && column && summaryType + \"_\" + column\r\n                        };\r\n                        if ((0, _type.isDefined)(name)) {\r\n                            (0, _iterator.each)(summaryItems || [], function(index) {\r\n                                if (this.name === name || index === name || this.summaryType === name || this.column === name || getFullName(this) === name) {\r\n                                    summaryItemIndex = index;\r\n                                    return false\r\n                                }\r\n                            })\r\n                        }\r\n                        return summaryItemIndex\r\n                    },\r\n                    _getSummarySortByGroups: function(sortByGroupSummaryInfo, groupSummaryItems) {\r\n                        var that = this;\r\n                        var columnsController = that._columnsController;\r\n                        var groupColumns = columnsController.getGroupColumns();\r\n                        var sortByGroups = [];\r\n                        if (!groupSummaryItems || !groupSummaryItems.length) {\r\n                            return\r\n                        }(0, _iterator.each)(sortByGroupSummaryInfo || [], function() {\r\n                            var sortOrder = this.sortOrder;\r\n                            var groupColumn = this.groupColumn;\r\n                            var summaryItemIndex = that._findSummaryItem(groupSummaryItems, this.summaryItem);\r\n                            if (summaryItemIndex < 0) {\r\n                                return\r\n                            }\r\n                            var selector = function(data) {\r\n                                return getGroupAggregates(data)[summaryItemIndex]\r\n                            };\r\n                            if ((0, _type.isDefined)(groupColumn)) {\r\n                                groupColumn = columnsController.columnOption(groupColumn);\r\n                                that._addSortInfo(sortByGroups, groupColumn, selector, sortOrder)\r\n                            } else {\r\n                                (0, _iterator.each)(groupColumns, function(groupIndex, groupColumn) {\r\n                                    that._addSortInfo(sortByGroups, groupColumn, selector, sortOrder)\r\n                                })\r\n                            }\r\n                        });\r\n                        return sortByGroups\r\n                    },\r\n                    _createDataSourceAdapterCore: function(dataSource, remoteOperations) {\r\n                        var that = this;\r\n                        var dataSourceAdapter = this.callBase(dataSource, remoteOperations);\r\n                        dataSourceAdapter.summaryGetter(function(currentRemoteOperations) {\r\n                            return that._getSummaryOptions(currentRemoteOperations || remoteOperations)\r\n                        });\r\n                        return dataSourceAdapter\r\n                    },\r\n                    _getSummaryOptions: function(remoteOperations) {\r\n                        var that = this;\r\n                        var groupSummaryItems = that.option(\"summary.groupItems\");\r\n                        var totalSummaryItems = that.option(\"summary.totalItems\");\r\n                        var sortByGroupSummaryInfo = that.option(\"sortByGroupSummaryInfo\");\r\n                        var groupAggregates = that._getAggregates(groupSummaryItems, remoteOperations && remoteOperations.grouping && remoteOperations.summary);\r\n                        var totalAggregates = that._getAggregates(totalSummaryItems, remoteOperations && remoteOperations.summary);\r\n                        var sortByGroups = function() {\r\n                            return that._getSummarySortByGroups(sortByGroupSummaryInfo, groupSummaryItems)\r\n                        };\r\n                        if (groupAggregates.length || totalAggregates.length) {\r\n                            return {\r\n                                groupAggregates: groupAggregates,\r\n                                totalAggregates: totalAggregates,\r\n                                sortByGroups: sortByGroups\r\n                            }\r\n                        }\r\n                    },\r\n                    publicMethods: function() {\r\n                        var methods = this.callBase();\r\n                        methods.push(\"getTotalSummaryValue\");\r\n                        return methods\r\n                    },\r\n                    getTotalSummaryValue: function(summaryItemName) {\r\n                        var summaryItemIndex = this._findSummaryItem(this.option(\"summary.totalItems\"), summaryItemName);\r\n                        var aggregates = this._dataSource.totalAggregates();\r\n                        if (aggregates.length && summaryItemIndex > -1) {\r\n                            return aggregates[summaryItemIndex]\r\n                        }\r\n                    },\r\n                    optionChanged: function(args) {\r\n                        if (\"summary\" === args.name || \"sortByGroupSummaryInfo\" === args.name) {\r\n                            args.name = \"dataSource\"\r\n                        }\r\n                        this.callBase(args)\r\n                    },\r\n                    init: function() {\r\n                        this._footerItems = [];\r\n                        this.callBase()\r\n                    },\r\n                    footerItems: function() {\r\n                        return this._footerItems\r\n                    }\r\n                }\r\n            }(),\r\n            editing: function() {\r\n                return {\r\n                    _refreshSummary: function() {\r\n                        if (recalculateWhileEditing(this) && !this.isSaving()) {\r\n                            this._dataController.refresh({\r\n                                load: true,\r\n                                changesOnly: true\r\n                            })\r\n                        }\r\n                    },\r\n                    _addEditData: function(params) {\r\n                        var result = this.callBase.apply(this, arguments);\r\n                        if (params.type) {\r\n                            this._refreshSummary()\r\n                        }\r\n                        return result\r\n                    },\r\n                    _removeEditDataItem: function() {\r\n                        var result = this.callBase.apply(this, arguments);\r\n                        this._refreshSummary();\r\n                        return result\r\n                    },\r\n                    cancelEditData: function() {\r\n                        var result = this.callBase.apply(this, arguments);\r\n                        this._refreshSummary();\r\n                        return result\r\n                    }\r\n                }\r\n            }()\r\n        },\r\n        views: {\r\n            rowsView: function() {\r\n                return {\r\n                    _createRow: function(row) {\r\n                        var $row = this.callBase(row);\r\n                        row && $row.addClass(row.rowType === DATAGRID_GROUP_FOOTER_ROW_TYPE ? DATAGRID_GROUP_FOOTER_CLASS : \"\");\r\n                        return $row\r\n                    },\r\n                    _renderCells: function($row, options) {\r\n                        this.callBase.apply(this, arguments);\r\n                        if (\"group\" === options.row.rowType && options.row.summaryCells && options.row.summaryCells.length) {\r\n                            this._renderGroupSummaryCells($row, options)\r\n                        }\r\n                    },\r\n                    _hasAlignByColumnSummaryItems: function(columnIndex, options) {\r\n                        return !(0, _type.isDefined)(options.columns[columnIndex].groupIndex) && options.row.summaryCells[columnIndex].length\r\n                    },\r\n                    _getAlignByColumnCellCount: function(groupCellColSpan, options) {\r\n                        var alignByColumnCellCount = 0;\r\n                        var columnIndex;\r\n                        for (var i = 1; i < groupCellColSpan; i++) {\r\n                            columnIndex = options.row.summaryCells.length - i;\r\n                            alignByColumnCellCount = this._hasAlignByColumnSummaryItems(columnIndex, options) ? i : alignByColumnCellCount\r\n                        }\r\n                        return alignByColumnCellCount\r\n                    },\r\n                    _renderGroupSummaryCells: function($row, options) {\r\n                        var $groupCell = $row.children().last();\r\n                        var groupCellColSpan = Number($groupCell.attr(\"colSpan\")) || 1;\r\n                        var alignByColumnCellCount = this._getAlignByColumnCellCount(groupCellColSpan, options);\r\n                        this._renderGroupSummaryCellsCore($groupCell, options, groupCellColSpan, alignByColumnCellCount)\r\n                    },\r\n                    _renderGroupSummaryCellsCore: function($groupCell, options, groupCellColSpan, alignByColumnCellCount) {\r\n                        if (alignByColumnCellCount > 0) {\r\n                            $groupCell.attr(\"colSpan\", groupCellColSpan - alignByColumnCellCount);\r\n                            for (var i = 0; i < alignByColumnCellCount; i++) {\r\n                                var columnIndex = options.columns.length - alignByColumnCellCount + i;\r\n                                this._renderCell($groupCell.parent(), (0, _extend.extend)({\r\n                                    column: options.columns[columnIndex],\r\n                                    columnIndex: this._getSummaryCellIndex(columnIndex, options.columns)\r\n                                }, options))\r\n                            }\r\n                        }\r\n                    },\r\n                    _getSummaryCellIndex: function(columnIndex) {\r\n                        return columnIndex\r\n                    },\r\n                    _getCellTemplate: function(options) {\r\n                        if (!options.column.command && !(0, _type.isDefined)(options.column.groupIndex) && options.summaryItems && options.summaryItems.length) {\r\n                            return renderSummaryCell\r\n                        } else {\r\n                            return this.callBase(options)\r\n                        }\r\n                    },\r\n                    _getCellOptions: function(options) {\r\n                        var that = this;\r\n                        var parameters = that.callBase(options);\r\n                        if (options.row.summaryCells) {\r\n                            return (0, _extend.extend)(parameters, getSummaryCellOptions(that, options))\r\n                        } else {\r\n                            return parameters\r\n                        }\r\n                    }\r\n                }\r\n            }()\r\n        }\r\n    }\r\n});\r\n"]},"metadata":{},"sourceType":"module"}