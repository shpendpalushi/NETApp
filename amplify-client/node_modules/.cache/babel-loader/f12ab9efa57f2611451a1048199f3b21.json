{"ast":null,"code":"import _assertThisInitialized from \"C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _get from \"C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/@babel/runtime/helpers/esm/get\";\nimport _getPrototypeOf from \"C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/@babel/runtime/helpers/esm/createSuper\";\nimport _classCallCheck from \"C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport { Subject } from '../Subject';\nimport { async } from '../scheduler/async';\nimport { Subscriber } from '../Subscriber';\nimport { isNumeric } from '../util/isNumeric';\nimport { isScheduler } from '../util/isScheduler';\nexport function windowTime(windowTimeSpan) {\n  var scheduler = async;\n  var windowCreationInterval = null;\n  var maxWindowSize = Number.POSITIVE_INFINITY;\n\n  if (isScheduler(arguments[3])) {\n    scheduler = arguments[3];\n  }\n\n  if (isScheduler(arguments[2])) {\n    scheduler = arguments[2];\n  } else if (isNumeric(arguments[2])) {\n    maxWindowSize = arguments[2];\n  }\n\n  if (isScheduler(arguments[1])) {\n    scheduler = arguments[1];\n  } else if (isNumeric(arguments[1])) {\n    windowCreationInterval = arguments[1];\n  }\n\n  return function windowTimeOperatorFunction(source) {\n    return source.lift(new WindowTimeOperator(windowTimeSpan, windowCreationInterval, maxWindowSize, scheduler));\n  };\n}\n\nvar WindowTimeOperator = /*#__PURE__*/function () {\n  function WindowTimeOperator(windowTimeSpan, windowCreationInterval, maxWindowSize, scheduler) {\n    _classCallCheck(this, WindowTimeOperator);\n\n    this.windowTimeSpan = windowTimeSpan;\n    this.windowCreationInterval = windowCreationInterval;\n    this.maxWindowSize = maxWindowSize;\n    this.scheduler = scheduler;\n  }\n\n  _createClass(WindowTimeOperator, [{\n    key: \"call\",\n    value: function call(subscriber, source) {\n      return source.subscribe(new WindowTimeSubscriber(subscriber, this.windowTimeSpan, this.windowCreationInterval, this.maxWindowSize, this.scheduler));\n    }\n  }]);\n\n  return WindowTimeOperator;\n}();\n\nvar CountedSubject = /*#__PURE__*/function (_Subject) {\n  _inherits(CountedSubject, _Subject);\n\n  var _super = _createSuper(CountedSubject);\n\n  function CountedSubject() {\n    var _this;\n\n    _classCallCheck(this, CountedSubject);\n\n    _this = _super.apply(this, arguments);\n    _this._numberOfNextedValues = 0;\n    return _this;\n  }\n\n  _createClass(CountedSubject, [{\n    key: \"next\",\n    value: function next(value) {\n      this._numberOfNextedValues++;\n\n      _get(_getPrototypeOf(CountedSubject.prototype), \"next\", this).call(this, value);\n    }\n  }, {\n    key: \"numberOfNextedValues\",\n    get: function get() {\n      return this._numberOfNextedValues;\n    }\n  }]);\n\n  return CountedSubject;\n}(Subject);\n\nvar WindowTimeSubscriber = /*#__PURE__*/function (_Subscriber) {\n  _inherits(WindowTimeSubscriber, _Subscriber);\n\n  var _super2 = _createSuper(WindowTimeSubscriber);\n\n  function WindowTimeSubscriber(destination, windowTimeSpan, windowCreationInterval, maxWindowSize, scheduler) {\n    var _this2;\n\n    _classCallCheck(this, WindowTimeSubscriber);\n\n    _this2 = _super2.call(this, destination);\n    _this2.destination = destination;\n    _this2.windowTimeSpan = windowTimeSpan;\n    _this2.windowCreationInterval = windowCreationInterval;\n    _this2.maxWindowSize = maxWindowSize;\n    _this2.scheduler = scheduler;\n    _this2.windows = [];\n\n    var window = _this2.openWindow();\n\n    if (windowCreationInterval !== null && windowCreationInterval >= 0) {\n      var closeState = {\n        subscriber: _assertThisInitialized(_this2),\n        window: window,\n        context: null\n      };\n      var creationState = {\n        windowTimeSpan: windowTimeSpan,\n        windowCreationInterval: windowCreationInterval,\n        subscriber: _assertThisInitialized(_this2),\n        scheduler: scheduler\n      };\n\n      _this2.add(scheduler.schedule(dispatchWindowClose, windowTimeSpan, closeState));\n\n      _this2.add(scheduler.schedule(dispatchWindowCreation, windowCreationInterval, creationState));\n    } else {\n      var timeSpanOnlyState = {\n        subscriber: _assertThisInitialized(_this2),\n        window: window,\n        windowTimeSpan: windowTimeSpan\n      };\n\n      _this2.add(scheduler.schedule(dispatchWindowTimeSpanOnly, windowTimeSpan, timeSpanOnlyState));\n    }\n\n    return _this2;\n  }\n\n  _createClass(WindowTimeSubscriber, [{\n    key: \"_next\",\n    value: function _next(value) {\n      var windows = this.windows;\n      var len = windows.length;\n\n      for (var i = 0; i < len; i++) {\n        var window = windows[i];\n\n        if (!window.closed) {\n          window.next(value);\n\n          if (window.numberOfNextedValues >= this.maxWindowSize) {\n            this.closeWindow(window);\n          }\n        }\n      }\n    }\n  }, {\n    key: \"_error\",\n    value: function _error(err) {\n      var windows = this.windows;\n\n      while (windows.length > 0) {\n        windows.shift().error(err);\n      }\n\n      this.destination.error(err);\n    }\n  }, {\n    key: \"_complete\",\n    value: function _complete() {\n      var windows = this.windows;\n\n      while (windows.length > 0) {\n        var window = windows.shift();\n\n        if (!window.closed) {\n          window.complete();\n        }\n      }\n\n      this.destination.complete();\n    }\n  }, {\n    key: \"openWindow\",\n    value: function openWindow() {\n      var window = new CountedSubject();\n      this.windows.push(window);\n      var destination = this.destination;\n      destination.next(window);\n      return window;\n    }\n  }, {\n    key: \"closeWindow\",\n    value: function closeWindow(window) {\n      window.complete();\n      var windows = this.windows;\n      windows.splice(windows.indexOf(window), 1);\n    }\n  }]);\n\n  return WindowTimeSubscriber;\n}(Subscriber);\n\nfunction dispatchWindowTimeSpanOnly(state) {\n  var subscriber = state.subscriber,\n      windowTimeSpan = state.windowTimeSpan,\n      window = state.window;\n\n  if (window) {\n    subscriber.closeWindow(window);\n  }\n\n  state.window = subscriber.openWindow();\n  this.schedule(state, windowTimeSpan);\n}\n\nfunction dispatchWindowCreation(state) {\n  var windowTimeSpan = state.windowTimeSpan,\n      subscriber = state.subscriber,\n      scheduler = state.scheduler,\n      windowCreationInterval = state.windowCreationInterval;\n  var window = subscriber.openWindow();\n  var action = this;\n  var context = {\n    action: action,\n    subscription: null\n  };\n  var timeSpanState = {\n    subscriber: subscriber,\n    window: window,\n    context: context\n  };\n  context.subscription = scheduler.schedule(dispatchWindowClose, windowTimeSpan, timeSpanState);\n  action.add(context.subscription);\n  action.schedule(state, windowCreationInterval);\n}\n\nfunction dispatchWindowClose(state) {\n  var subscriber = state.subscriber,\n      window = state.window,\n      context = state.context;\n\n  if (context && context.action && context.subscription) {\n    context.action.remove(context.subscription);\n  }\n\n  subscriber.closeWindow(window);\n}","map":{"version":3,"sources":["../../../src/internal/operators/windowTime.ts"],"names":[],"mappings":"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","sourcesContent":["import { Subject } from '../Subject';\r\nimport { async } from '../scheduler/async';\r\nimport { Subscriber } from '../Subscriber';\r\nimport { isNumeric } from '../util/isNumeric';\r\nimport { isScheduler } from '../util/isScheduler';\r\nexport function windowTime(windowTimeSpan) {\r\n    let scheduler = async;\r\n    let windowCreationInterval = null;\r\n    let maxWindowSize = Number.POSITIVE_INFINITY;\r\n    if (isScheduler(arguments[3])) {\r\n        scheduler = arguments[3];\r\n    }\r\n    if (isScheduler(arguments[2])) {\r\n        scheduler = arguments[2];\r\n    }\r\n    else if (isNumeric(arguments[2])) {\r\n        maxWindowSize = arguments[2];\r\n    }\r\n    if (isScheduler(arguments[1])) {\r\n        scheduler = arguments[1];\r\n    }\r\n    else if (isNumeric(arguments[1])) {\r\n        windowCreationInterval = arguments[1];\r\n    }\r\n    return function windowTimeOperatorFunction(source) {\r\n        return source.lift(new WindowTimeOperator(windowTimeSpan, windowCreationInterval, maxWindowSize, scheduler));\r\n    };\r\n}\r\nclass WindowTimeOperator {\r\n    constructor(windowTimeSpan, windowCreationInterval, maxWindowSize, scheduler) {\r\n        this.windowTimeSpan = windowTimeSpan;\r\n        this.windowCreationInterval = windowCreationInterval;\r\n        this.maxWindowSize = maxWindowSize;\r\n        this.scheduler = scheduler;\r\n    }\r\n    call(subscriber, source) {\r\n        return source.subscribe(new WindowTimeSubscriber(subscriber, this.windowTimeSpan, this.windowCreationInterval, this.maxWindowSize, this.scheduler));\r\n    }\r\n}\r\nclass CountedSubject extends Subject {\r\n    constructor() {\r\n        super(...arguments);\r\n        this._numberOfNextedValues = 0;\r\n    }\r\n    next(value) {\r\n        this._numberOfNextedValues++;\r\n        super.next(value);\r\n    }\r\n    get numberOfNextedValues() {\r\n        return this._numberOfNextedValues;\r\n    }\r\n}\r\nclass WindowTimeSubscriber extends Subscriber {\r\n    constructor(destination, windowTimeSpan, windowCreationInterval, maxWindowSize, scheduler) {\r\n        super(destination);\r\n        this.destination = destination;\r\n        this.windowTimeSpan = windowTimeSpan;\r\n        this.windowCreationInterval = windowCreationInterval;\r\n        this.maxWindowSize = maxWindowSize;\r\n        this.scheduler = scheduler;\r\n        this.windows = [];\r\n        const window = this.openWindow();\r\n        if (windowCreationInterval !== null && windowCreationInterval >= 0) {\r\n            const closeState = { subscriber: this, window, context: null };\r\n            const creationState = { windowTimeSpan, windowCreationInterval, subscriber: this, scheduler };\r\n            this.add(scheduler.schedule(dispatchWindowClose, windowTimeSpan, closeState));\r\n            this.add(scheduler.schedule(dispatchWindowCreation, windowCreationInterval, creationState));\r\n        }\r\n        else {\r\n            const timeSpanOnlyState = { subscriber: this, window, windowTimeSpan };\r\n            this.add(scheduler.schedule(dispatchWindowTimeSpanOnly, windowTimeSpan, timeSpanOnlyState));\r\n        }\r\n    }\r\n    _next(value) {\r\n        const windows = this.windows;\r\n        const len = windows.length;\r\n        for (let i = 0; i < len; i++) {\r\n            const window = windows[i];\r\n            if (!window.closed) {\r\n                window.next(value);\r\n                if (window.numberOfNextedValues >= this.maxWindowSize) {\r\n                    this.closeWindow(window);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    _error(err) {\r\n        const windows = this.windows;\r\n        while (windows.length > 0) {\r\n            windows.shift().error(err);\r\n        }\r\n        this.destination.error(err);\r\n    }\r\n    _complete() {\r\n        const windows = this.windows;\r\n        while (windows.length > 0) {\r\n            const window = windows.shift();\r\n            if (!window.closed) {\r\n                window.complete();\r\n            }\r\n        }\r\n        this.destination.complete();\r\n    }\r\n    openWindow() {\r\n        const window = new CountedSubject();\r\n        this.windows.push(window);\r\n        const destination = this.destination;\r\n        destination.next(window);\r\n        return window;\r\n    }\r\n    closeWindow(window) {\r\n        window.complete();\r\n        const windows = this.windows;\r\n        windows.splice(windows.indexOf(window), 1);\r\n    }\r\n}\r\nfunction dispatchWindowTimeSpanOnly(state) {\r\n    const { subscriber, windowTimeSpan, window } = state;\r\n    if (window) {\r\n        subscriber.closeWindow(window);\r\n    }\r\n    state.window = subscriber.openWindow();\r\n    this.schedule(state, windowTimeSpan);\r\n}\r\nfunction dispatchWindowCreation(state) {\r\n    const { windowTimeSpan, subscriber, scheduler, windowCreationInterval } = state;\r\n    const window = subscriber.openWindow();\r\n    const action = this;\r\n    let context = { action, subscription: null };\r\n    const timeSpanState = { subscriber, window, context };\r\n    context.subscription = scheduler.schedule(dispatchWindowClose, windowTimeSpan, timeSpanState);\r\n    action.add(context.subscription);\r\n    action.schedule(state, windowCreationInterval);\r\n}\r\nfunction dispatchWindowClose(state) {\r\n    const { subscriber, window, context } = state;\r\n    if (context && context.action && context.subscription) {\r\n        context.action.remove(context.subscription);\r\n    }\r\n    subscriber.closeWindow(window);\r\n}\r\n//# sourceMappingURL=windowTime.js.map"]},"metadata":{},"sourceType":"module"}