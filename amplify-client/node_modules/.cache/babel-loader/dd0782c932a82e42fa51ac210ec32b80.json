{"ast":null,"code":"import _get from \"C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/@babel/runtime/helpers/esm/get\";\nimport _getPrototypeOf from \"C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/@babel/runtime/helpers/esm/createSuper\";\nimport _classCallCheck from \"C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport { Subscriber } from '../Subscriber';\nimport { Subscription } from '../Subscription';\nimport { Observable } from '../Observable';\nimport { Subject } from '../Subject';\nexport function groupBy(keySelector, elementSelector, durationSelector, subjectSelector) {\n  return function (source) {\n    return source.lift(new GroupByOperator(keySelector, elementSelector, durationSelector, subjectSelector));\n  };\n}\n\nvar GroupByOperator = /*#__PURE__*/function () {\n  function GroupByOperator(keySelector, elementSelector, durationSelector, subjectSelector) {\n    _classCallCheck(this, GroupByOperator);\n\n    this.keySelector = keySelector;\n    this.elementSelector = elementSelector;\n    this.durationSelector = durationSelector;\n    this.subjectSelector = subjectSelector;\n  }\n\n  _createClass(GroupByOperator, [{\n    key: \"call\",\n    value: function call(subscriber, source) {\n      return source.subscribe(new GroupBySubscriber(subscriber, this.keySelector, this.elementSelector, this.durationSelector, this.subjectSelector));\n    }\n  }]);\n\n  return GroupByOperator;\n}();\n\nvar GroupBySubscriber = /*#__PURE__*/function (_Subscriber) {\n  _inherits(GroupBySubscriber, _Subscriber);\n\n  var _super = _createSuper(GroupBySubscriber);\n\n  function GroupBySubscriber(destination, keySelector, elementSelector, durationSelector, subjectSelector) {\n    var _this;\n\n    _classCallCheck(this, GroupBySubscriber);\n\n    _this = _super.call(this, destination);\n    _this.keySelector = keySelector;\n    _this.elementSelector = elementSelector;\n    _this.durationSelector = durationSelector;\n    _this.subjectSelector = subjectSelector;\n    _this.groups = null;\n    _this.attemptedToUnsubscribe = false;\n    _this.count = 0;\n    return _this;\n  }\n\n  _createClass(GroupBySubscriber, [{\n    key: \"_next\",\n    value: function _next(value) {\n      var key;\n\n      try {\n        key = this.keySelector(value);\n      } catch (err) {\n        this.error(err);\n        return;\n      }\n\n      this._group(value, key);\n    }\n  }, {\n    key: \"_group\",\n    value: function _group(value, key) {\n      var groups = this.groups;\n\n      if (!groups) {\n        groups = this.groups = new Map();\n      }\n\n      var group = groups.get(key);\n      var element;\n\n      if (this.elementSelector) {\n        try {\n          element = this.elementSelector(value);\n        } catch (err) {\n          this.error(err);\n        }\n      } else {\n        element = value;\n      }\n\n      if (!group) {\n        group = this.subjectSelector ? this.subjectSelector() : new Subject();\n        groups.set(key, group);\n        var groupedObservable = new GroupedObservable(key, group, this);\n        this.destination.next(groupedObservable);\n\n        if (this.durationSelector) {\n          var duration;\n\n          try {\n            duration = this.durationSelector(new GroupedObservable(key, group));\n          } catch (err) {\n            this.error(err);\n            return;\n          }\n\n          this.add(duration.subscribe(new GroupDurationSubscriber(key, group, this)));\n        }\n      }\n\n      if (!group.closed) {\n        group.next(element);\n      }\n    }\n  }, {\n    key: \"_error\",\n    value: function _error(err) {\n      var groups = this.groups;\n\n      if (groups) {\n        groups.forEach(function (group, key) {\n          group.error(err);\n        });\n        groups.clear();\n      }\n\n      this.destination.error(err);\n    }\n  }, {\n    key: \"_complete\",\n    value: function _complete() {\n      var groups = this.groups;\n\n      if (groups) {\n        groups.forEach(function (group, key) {\n          group.complete();\n        });\n        groups.clear();\n      }\n\n      this.destination.complete();\n    }\n  }, {\n    key: \"removeGroup\",\n    value: function removeGroup(key) {\n      this.groups.delete(key);\n    }\n  }, {\n    key: \"unsubscribe\",\n    value: function unsubscribe() {\n      if (!this.closed) {\n        this.attemptedToUnsubscribe = true;\n\n        if (this.count === 0) {\n          _get(_getPrototypeOf(GroupBySubscriber.prototype), \"unsubscribe\", this).call(this);\n        }\n      }\n    }\n  }]);\n\n  return GroupBySubscriber;\n}(Subscriber);\n\nvar GroupDurationSubscriber = /*#__PURE__*/function (_Subscriber2) {\n  _inherits(GroupDurationSubscriber, _Subscriber2);\n\n  var _super2 = _createSuper(GroupDurationSubscriber);\n\n  function GroupDurationSubscriber(key, group, parent) {\n    var _this2;\n\n    _classCallCheck(this, GroupDurationSubscriber);\n\n    _this2 = _super2.call(this, group);\n    _this2.key = key;\n    _this2.group = group;\n    _this2.parent = parent;\n    return _this2;\n  }\n\n  _createClass(GroupDurationSubscriber, [{\n    key: \"_next\",\n    value: function _next(value) {\n      this.complete();\n    }\n  }, {\n    key: \"_unsubscribe\",\n    value: function _unsubscribe() {\n      var parent = this.parent,\n          key = this.key;\n      this.key = this.parent = null;\n\n      if (parent) {\n        parent.removeGroup(key);\n      }\n    }\n  }]);\n\n  return GroupDurationSubscriber;\n}(Subscriber);\n\nexport var GroupedObservable = /*#__PURE__*/function (_Observable) {\n  _inherits(GroupedObservable, _Observable);\n\n  var _super3 = _createSuper(GroupedObservable);\n\n  function GroupedObservable(key, groupSubject, refCountSubscription) {\n    var _this3;\n\n    _classCallCheck(this, GroupedObservable);\n\n    _this3 = _super3.call(this);\n    _this3.key = key;\n    _this3.groupSubject = groupSubject;\n    _this3.refCountSubscription = refCountSubscription;\n    return _this3;\n  }\n\n  _createClass(GroupedObservable, [{\n    key: \"_subscribe\",\n    value: function _subscribe(subscriber) {\n      var subscription = new Subscription();\n      var refCountSubscription = this.refCountSubscription,\n          groupSubject = this.groupSubject;\n\n      if (refCountSubscription && !refCountSubscription.closed) {\n        subscription.add(new InnerRefCountSubscription(refCountSubscription));\n      }\n\n      subscription.add(groupSubject.subscribe(subscriber));\n      return subscription;\n    }\n  }]);\n\n  return GroupedObservable;\n}(Observable);\n\nvar InnerRefCountSubscription = /*#__PURE__*/function (_Subscription) {\n  _inherits(InnerRefCountSubscription, _Subscription);\n\n  var _super4 = _createSuper(InnerRefCountSubscription);\n\n  function InnerRefCountSubscription(parent) {\n    var _this4;\n\n    _classCallCheck(this, InnerRefCountSubscription);\n\n    _this4 = _super4.call(this);\n    _this4.parent = parent;\n    parent.count++;\n    return _this4;\n  }\n\n  _createClass(InnerRefCountSubscription, [{\n    key: \"unsubscribe\",\n    value: function unsubscribe() {\n      var parent = this.parent;\n\n      if (!parent.closed && !this.closed) {\n        _get(_getPrototypeOf(InnerRefCountSubscription.prototype), \"unsubscribe\", this).call(this);\n\n        parent.count -= 1;\n\n        if (parent.count === 0 && parent.attemptedToUnsubscribe) {\n          parent.unsubscribe();\n        }\n      }\n    }\n  }]);\n\n  return InnerRefCountSubscription;\n}(Subscription);","map":{"version":3,"sources":["../../../src/internal/operators/groupBy.ts"],"names":[],"mappings":"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","sourcesContent":["import { Subscriber } from '../Subscriber';\r\nimport { Subscription } from '../Subscription';\r\nimport { Observable } from '../Observable';\r\nimport { Subject } from '../Subject';\r\nexport function groupBy(keySelector, elementSelector, durationSelector, subjectSelector) {\r\n    return (source) => source.lift(new GroupByOperator(keySelector, elementSelector, durationSelector, subjectSelector));\r\n}\r\nclass GroupByOperator {\r\n    constructor(keySelector, elementSelector, durationSelector, subjectSelector) {\r\n        this.keySelector = keySelector;\r\n        this.elementSelector = elementSelector;\r\n        this.durationSelector = durationSelector;\r\n        this.subjectSelector = subjectSelector;\r\n    }\r\n    call(subscriber, source) {\r\n        return source.subscribe(new GroupBySubscriber(subscriber, this.keySelector, this.elementSelector, this.durationSelector, this.subjectSelector));\r\n    }\r\n}\r\nclass GroupBySubscriber extends Subscriber {\r\n    constructor(destination, keySelector, elementSelector, durationSelector, subjectSelector) {\r\n        super(destination);\r\n        this.keySelector = keySelector;\r\n        this.elementSelector = elementSelector;\r\n        this.durationSelector = durationSelector;\r\n        this.subjectSelector = subjectSelector;\r\n        this.groups = null;\r\n        this.attemptedToUnsubscribe = false;\r\n        this.count = 0;\r\n    }\r\n    _next(value) {\r\n        let key;\r\n        try {\r\n            key = this.keySelector(value);\r\n        }\r\n        catch (err) {\r\n            this.error(err);\r\n            return;\r\n        }\r\n        this._group(value, key);\r\n    }\r\n    _group(value, key) {\r\n        let groups = this.groups;\r\n        if (!groups) {\r\n            groups = this.groups = new Map();\r\n        }\r\n        let group = groups.get(key);\r\n        let element;\r\n        if (this.elementSelector) {\r\n            try {\r\n                element = this.elementSelector(value);\r\n            }\r\n            catch (err) {\r\n                this.error(err);\r\n            }\r\n        }\r\n        else {\r\n            element = value;\r\n        }\r\n        if (!group) {\r\n            group = (this.subjectSelector ? this.subjectSelector() : new Subject());\r\n            groups.set(key, group);\r\n            const groupedObservable = new GroupedObservable(key, group, this);\r\n            this.destination.next(groupedObservable);\r\n            if (this.durationSelector) {\r\n                let duration;\r\n                try {\r\n                    duration = this.durationSelector(new GroupedObservable(key, group));\r\n                }\r\n                catch (err) {\r\n                    this.error(err);\r\n                    return;\r\n                }\r\n                this.add(duration.subscribe(new GroupDurationSubscriber(key, group, this)));\r\n            }\r\n        }\r\n        if (!group.closed) {\r\n            group.next(element);\r\n        }\r\n    }\r\n    _error(err) {\r\n        const groups = this.groups;\r\n        if (groups) {\r\n            groups.forEach((group, key) => {\r\n                group.error(err);\r\n            });\r\n            groups.clear();\r\n        }\r\n        this.destination.error(err);\r\n    }\r\n    _complete() {\r\n        const groups = this.groups;\r\n        if (groups) {\r\n            groups.forEach((group, key) => {\r\n                group.complete();\r\n            });\r\n            groups.clear();\r\n        }\r\n        this.destination.complete();\r\n    }\r\n    removeGroup(key) {\r\n        this.groups.delete(key);\r\n    }\r\n    unsubscribe() {\r\n        if (!this.closed) {\r\n            this.attemptedToUnsubscribe = true;\r\n            if (this.count === 0) {\r\n                super.unsubscribe();\r\n            }\r\n        }\r\n    }\r\n}\r\nclass GroupDurationSubscriber extends Subscriber {\r\n    constructor(key, group, parent) {\r\n        super(group);\r\n        this.key = key;\r\n        this.group = group;\r\n        this.parent = parent;\r\n    }\r\n    _next(value) {\r\n        this.complete();\r\n    }\r\n    _unsubscribe() {\r\n        const { parent, key } = this;\r\n        this.key = this.parent = null;\r\n        if (parent) {\r\n            parent.removeGroup(key);\r\n        }\r\n    }\r\n}\r\nexport class GroupedObservable extends Observable {\r\n    constructor(key, groupSubject, refCountSubscription) {\r\n        super();\r\n        this.key = key;\r\n        this.groupSubject = groupSubject;\r\n        this.refCountSubscription = refCountSubscription;\r\n    }\r\n    _subscribe(subscriber) {\r\n        const subscription = new Subscription();\r\n        const { refCountSubscription, groupSubject } = this;\r\n        if (refCountSubscription && !refCountSubscription.closed) {\r\n            subscription.add(new InnerRefCountSubscription(refCountSubscription));\r\n        }\r\n        subscription.add(groupSubject.subscribe(subscriber));\r\n        return subscription;\r\n    }\r\n}\r\nclass InnerRefCountSubscription extends Subscription {\r\n    constructor(parent) {\r\n        super();\r\n        this.parent = parent;\r\n        parent.count++;\r\n    }\r\n    unsubscribe() {\r\n        const parent = this.parent;\r\n        if (!parent.closed && !this.closed) {\r\n            super.unsubscribe();\r\n            parent.count -= 1;\r\n            if (parent.count === 0 && parent.attemptedToUnsubscribe) {\r\n                parent.unsubscribe();\r\n            }\r\n        }\r\n    }\r\n}\r\n//# sourceMappingURL=groupBy.js.map"]},"metadata":{},"sourceType":"module"}