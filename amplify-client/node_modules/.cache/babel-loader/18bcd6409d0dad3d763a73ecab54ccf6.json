{"ast":null,"code":"/**\r\n * DevExtreme (viz/core/renderers/renderer.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar _renderer = require(\"../../../core/renderer\");\n\nvar _renderer2 = _interopRequireDefault(_renderer);\n\nvar _dom_adapter = require(\"../../../core/dom_adapter\");\n\nvar _dom_adapter2 = _interopRequireDefault(_dom_adapter);\n\nvar _window = require(\"../../../core/utils/window\");\n\nvar _window2 = _interopRequireDefault(_window);\n\nvar _call_once = require(\"../../../core/utils/call_once\");\n\nvar _call_once2 = _interopRequireDefault(_call_once);\n\nvar _events_engine = require(\"../../../events/core/events_engine\");\n\nvar _events_engine2 = _interopRequireDefault(_events_engine);\n\nvar _browser = require(\"../../../core/utils/browser\");\n\nvar _browser2 = _interopRequireDefault(_browser);\n\nvar _svg = require(\"../../../core/utils/svg\");\n\nvar _animation = require(\"./animation\");\n\nvar _animation2 = _interopRequireDefault(_animation);\n\nvar _utils = require(\"../utils\");\n\nvar _type = require(\"../../../core/utils/type\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nfunction _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest();\n}\n\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n}\n\nfunction _iterableToArrayLimit(arr, i) {\n  if (!(Symbol.iterator in Object(arr) || \"[object Arguments]\" === Object.prototype.toString.call(arr))) {\n    return;\n  }\n\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n\n  var _e = void 0;\n\n  try {\n    for (var _s, _i = arr[Symbol.iterator](); !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) {\n        break;\n      }\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && null != _i.return) {\n        _i.return();\n      }\n    } finally {\n      if (_d) {\n        throw _e;\n      }\n    }\n  }\n\n  return _arr;\n}\n\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) {\n    return arr;\n  }\n}\n\nvar window = _window2.default.getWindow();\n\nvar max = Math.max,\n    min = Math.min,\n    floor = Math.floor,\n    round = Math.round,\n    sin = Math.sin,\n    cos = Math.cos,\n    abs = Math.abs,\n    PI = Math.PI;\nvar PI_DIV_180 = PI / 180;\nvar SHARPING_CORRECTION = .5;\nvar ARC_COORD_PREC = 5;\nvar pxAddingExceptions = {\n  \"column-count\": true,\n  \"fill-opacity\": true,\n  \"flex-grow\": true,\n  \"flex-shrink\": true,\n  \"font-weight\": true,\n  \"line-height\": true,\n  opacity: true,\n  order: true,\n  orphans: true,\n  widows: true,\n  \"z-index\": true,\n  zoom: true\n};\nvar KEY_TEXT = \"text\";\nvar KEY_STROKE = \"stroke\";\nvar KEY_STROKE_WIDTH = \"stroke-width\";\nvar KEY_STROKE_OPACITY = \"stroke-opacity\";\nvar KEY_FONT_SIZE = \"font-size\";\nvar KEY_FONT_STYLE = \"font-style\";\nvar KEY_FONT_WEIGHT = \"font-weight\";\nvar KEY_TEXT_DECORATION = \"text-decoration\";\nvar KEY_TEXTS_ALIGNMENT = \"textsAlignment\";\nvar NONE = \"none\";\nvar DEFAULT_FONT_SIZE = 12;\nvar ELLIPSIS = \"...\";\n\nvar objectCreate = function () {\n  if (!Object.create) {\n    return function (proto) {\n      var F = function F() {};\n\n      F.prototype = proto;\n      return new F();\n    };\n  } else {\n    return function (proto) {\n      return Object.create(proto);\n    };\n  }\n}();\n\nvar DEFAULTS = {\n  scaleX: 1,\n  scaleY: 1,\n  \"pointer-events\": null\n};\nvar getBackup = (0, _call_once2.default)(function () {\n  var backupContainer = _dom_adapter2.default.createElement(\"div\");\n\n  var backupCounter = 0;\n  backupContainer.style.left = \"-9999px\";\n  backupContainer.style.position = \"absolute\";\n  return {\n    backupContainer: backupContainer,\n    backupCounter: backupCounter\n  };\n});\n\nfunction backupRoot(root) {\n  if (0 === getBackup().backupCounter) {\n    _dom_adapter2.default.getBody().appendChild(getBackup().backupContainer);\n  }\n\n  ++getBackup().backupCounter;\n  root.append({\n    element: getBackup().backupContainer\n  });\n}\n\nfunction restoreRoot(root, container) {\n  root.append({\n    element: container\n  });\n  --getBackup().backupCounter;\n\n  if (0 === getBackup().backupCounter) {\n    _dom_adapter2.default.getBody().removeChild(getBackup().backupContainer);\n  }\n}\n\nvar getNextDefsSvgId = function () {\n  var numDefsSvgElements = 1;\n  return function () {\n    return \"DevExpress_\" + numDefsSvgElements++;\n  };\n}();\n\nfunction isObjectArgument(value) {\n  return value && \"string\" !== typeof value;\n}\n\nfunction createElement(tagName) {\n  return _dom_adapter2.default.createElementNS(\"http://www.w3.org/2000/svg\", tagName);\n}\n\nfunction getFuncIri(id, pathModified) {\n  return null !== id ? \"url(\" + (pathModified ? window.location.href.split(\"#\")[0] : \"\") + \"#\" + id + \")\" : id;\n}\n\nmodule.exports.getFuncIri = getFuncIri;\n\nfunction extend(target, source) {\n  var key;\n\n  for (key in source) {\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nfunction roundValue(value, exp) {\n  value = value.toString().split(\"e\");\n  value = round(+(value[0] + \"e\" + (value[1] ? +value[1] + exp : exp)));\n  value = value.toString().split(\"e\");\n  return +(value[0] + \"e\" + (value[1] ? +value[1] - exp : -exp));\n}\n\nfunction getBoundingClientRect(element) {\n  var box;\n\n  try {\n    box = element.getBoundingClientRect();\n  } catch (e) {}\n\n  return box || {\n    left: 0,\n    top: 0\n  };\n}\n\nvar preserveAspectRatioMap = {\n  full: NONE,\n  lefttop: \"xMinYMin\",\n  leftcenter: \"xMinYMid\",\n  leftbottom: \"xMinYMax\",\n  centertop: \"xMidYMin\",\n  center: \"xMidYMid\",\n  centerbottom: \"xMidYMax\",\n  righttop: \"xMaxYMin\",\n  rightcenter: \"xMaxYMid\",\n  rightbottom: \"xMaxYMax\"\n};\n\nfunction processHatchingAttrs(element, attrs) {\n  if (attrs.hatching && \"none\" !== (0, _utils.normalizeEnum)(attrs.hatching.direction)) {\n    attrs = extend({}, attrs);\n    attrs.fill = element._hatching = element.renderer.lockHatching(attrs.fill, attrs.hatching, element._hatching);\n    delete attrs.hatching;\n  } else {\n    if (element._hatching) {\n      element.renderer.releaseHatching(element._hatching);\n      element._hatching = null;\n    }\n  }\n\n  return attrs;\n}\n\nmodule.exports.processHatchingAttrs = processHatchingAttrs;\n\nfunction normalizeArcParams(x, y, innerR, outerR, startAngle, endAngle) {\n  var isCircle;\n  var noArc = true;\n  var angleDiff = roundValue(endAngle, 3) - roundValue(startAngle, 3);\n\n  if (angleDiff) {\n    if (abs(angleDiff) % 360 === 0) {\n      startAngle = 0;\n      endAngle = 360;\n      isCircle = true;\n      endAngle -= .01;\n    }\n\n    if (startAngle > 360) {\n      startAngle %= 360;\n    }\n\n    if (endAngle > 360) {\n      endAngle %= 360;\n    }\n\n    if (startAngle > endAngle) {\n      startAngle -= 360;\n    }\n\n    noArc = false;\n  }\n\n  startAngle *= PI_DIV_180;\n  endAngle *= PI_DIV_180;\n  return [x, y, min(outerR, innerR), max(outerR, innerR), cos(startAngle), sin(startAngle), cos(endAngle), sin(endAngle), isCircle, floor(abs(endAngle - startAngle) / PI) % 2 ? \"1\" : \"0\", noArc];\n}\n\nvar buildArcPath = function buildArcPath(x, y, innerR, outerR, startAngleCos, startAngleSin, endAngleCos, endAngleSin, isCircle, longFlag) {\n  return [\"M\", (x + outerR * startAngleCos).toFixed(ARC_COORD_PREC), (y - outerR * startAngleSin).toFixed(ARC_COORD_PREC), \"A\", outerR.toFixed(ARC_COORD_PREC), outerR.toFixed(ARC_COORD_PREC), 0, longFlag, 0, (x + outerR * endAngleCos).toFixed(ARC_COORD_PREC), (y - outerR * endAngleSin).toFixed(ARC_COORD_PREC), isCircle ? \"M\" : \"L\", (x + innerR * endAngleCos).toFixed(5), (y - innerR * endAngleSin).toFixed(ARC_COORD_PREC), \"A\", innerR.toFixed(ARC_COORD_PREC), innerR.toFixed(ARC_COORD_PREC), 0, longFlag, 1, (x + innerR * startAngleCos).toFixed(ARC_COORD_PREC), (y - innerR * startAngleSin).toFixed(ARC_COORD_PREC), \"Z\"].join(\" \");\n};\n\nfunction buildPathSegments(points, type) {\n  var list = [[\"M\", 0, 0]];\n\n  switch (type) {\n    case \"line\":\n      list = buildLineSegments(points);\n      break;\n\n    case \"area\":\n      list = buildLineSegments(points, true);\n      break;\n\n    case \"bezier\":\n      list = buildCurveSegments(points);\n      break;\n\n    case \"bezierarea\":\n      list = buildCurveSegments(points, true);\n  }\n\n  return list;\n}\n\nfunction buildLineSegments(points, close) {\n  return buildSegments(points, buildSimpleLineSegment, close);\n}\n\nfunction buildCurveSegments(points, close) {\n  return buildSegments(points, buildSimpleCurveSegment, close);\n}\n\nfunction buildSegments(points, buildSimpleSegment, close) {\n  var i;\n  var ii;\n  var list = [];\n\n  if (points[0] && points[0].length) {\n    for (i = 0, ii = points.length; i < ii; ++i) {\n      buildSimpleSegment(points[i], close, list);\n    }\n  } else {\n    buildSimpleSegment(points, close, list);\n  }\n\n  return list;\n}\n\nfunction buildSimpleLineSegment(points, close, list) {\n  var i = 0;\n  var k0 = list.length;\n  var k = k0;\n  var ii = (points || []).length;\n\n  if (ii) {\n    if (void 0 !== points[0].x) {\n      for (; i < ii;) {\n        list[k++] = [\"L\", points[i].x, points[i++].y];\n      }\n    } else {\n      for (; i < ii;) {\n        list[k++] = [\"L\", points[i++], points[i++]];\n      }\n    }\n\n    list[k0][0] = \"M\";\n  } else {\n    list[k] = [\"M\", 0, 0];\n  }\n\n  close && list.push([\"Z\"]);\n  return list;\n}\n\nfunction buildSimpleCurveSegment(points, close, list) {\n  var i;\n  var k = list.length;\n  var ii = (points || []).length;\n\n  if (ii) {\n    if (void 0 !== points[0].x) {\n      list[k++] = [\"M\", points[0].x, points[0].y];\n\n      for (i = 1; i < ii;) {\n        list[k++] = [\"C\", points[i].x, points[i++].y, points[i].x, points[i++].y, points[i].x, points[i++].y];\n      }\n    } else {\n      list[k++] = [\"M\", points[0], points[1]];\n\n      for (i = 2; i < ii;) {\n        list[k++] = [\"C\", points[i++], points[i++], points[i++], points[i++], points[i++], points[i++]];\n      }\n    }\n  } else {\n    list[k] = [\"M\", 0, 0];\n  }\n\n  close && list.push([\"Z\"]);\n  return list;\n}\n\nfunction combinePathParam(segments) {\n  var d = [];\n  var k = 0;\n  var i;\n  var ii = segments.length;\n  var segment;\n  var j;\n  var jj;\n\n  for (i = 0; i < ii; ++i) {\n    segment = segments[i];\n\n    for (j = 0, jj = segment.length; j < jj; ++j) {\n      d[k++] = segment[j];\n    }\n  }\n\n  return d.join(\" \");\n}\n\nfunction compensateSegments(oldSegments, newSegments, type) {\n  var oldLength = oldSegments.length;\n  var newLength = newSegments.length;\n  var i;\n  var originalNewSegments;\n  var makeEqualSegments = type.indexOf(\"area\") !== -1 ? makeEqualAreaSegments : makeEqualLineSegments;\n\n  if (0 === oldLength) {\n    for (i = 0; i < newLength; i++) {\n      oldSegments.push(newSegments[i].slice(0));\n    }\n  } else {\n    if (oldLength < newLength) {\n      makeEqualSegments(oldSegments, newSegments, type);\n    } else {\n      if (oldLength > newLength) {\n        originalNewSegments = newSegments.slice(0);\n        makeEqualSegments(newSegments, oldSegments, type);\n      }\n    }\n  }\n\n  return originalNewSegments;\n}\n\nfunction prepareConstSegment(constSeg, type) {\n  var x = constSeg[constSeg.length - 2];\n  var y = constSeg[constSeg.length - 1];\n\n  switch (type) {\n    case \"line\":\n    case \"area\":\n      constSeg[0] = \"L\";\n      break;\n\n    case \"bezier\":\n    case \"bezierarea\":\n      constSeg[0] = \"C\";\n      constSeg[1] = constSeg[3] = constSeg[5] = x;\n      constSeg[2] = constSeg[4] = constSeg[6] = y;\n  }\n}\n\nfunction makeEqualLineSegments(short, long, type) {\n  var constSeg = short[short.length - 1].slice();\n  var i = short.length;\n  prepareConstSegment(constSeg, type);\n\n  for (; i < long.length; i++) {\n    short[i] = constSeg.slice(0);\n  }\n}\n\nfunction makeEqualAreaSegments(short, long, type) {\n  var i;\n  var head;\n  var shortLength = short.length;\n  var longLength = long.length;\n  var constsSeg1;\n  var constsSeg2;\n\n  if ((shortLength - 1) % 2 === 0 && (longLength - 1) % 2 === 0) {\n    i = (shortLength - 1) / 2 - 1;\n    head = short.slice(0, i + 1);\n    constsSeg1 = head[head.length - 1].slice(0);\n    constsSeg2 = short.slice(i + 1)[0].slice(0);\n    prepareConstSegment(constsSeg1, type);\n    prepareConstSegment(constsSeg2, type);\n\n    for (var j = i; j < (longLength - 1) / 2 - 1; j++) {\n      short.splice(j + 1, 0, constsSeg1);\n      short.splice(j + 3, 0, constsSeg2);\n    }\n  }\n}\n\nfunction baseCss(that, styles) {\n  var elemStyles = that._styles;\n  var str = \"\";\n  var key;\n  var value;\n  styles = styles || {};\n\n  for (key in styles) {\n    value = styles[key];\n\n    if ((0, _type.isDefined)(value)) {\n      value += \"number\" === typeof value && !pxAddingExceptions[key] ? \"px\" : \"\";\n      elemStyles[key] = \"\" !== value ? value : null;\n    }\n  }\n\n  for (key in elemStyles) {\n    value = elemStyles[key];\n\n    if (value) {\n      str += key + \":\" + value + \";\";\n    }\n  }\n\n  str && that.element.setAttribute(\"style\", str);\n  return that;\n}\n\nfunction fixFuncIri(wrapper, attribute) {\n  var element = wrapper.element;\n  var id = wrapper.attr(attribute);\n\n  if (id && id.indexOf(\"DevExpress\") !== -1) {\n    element.removeAttribute(attribute);\n    element.setAttribute(attribute, getFuncIri(id, wrapper.renderer.pathModified));\n  }\n}\n\nfunction baseAttr(that, attrs) {\n  attrs = attrs || {};\n  var settings = that._settings;\n  var attributes = {};\n  var key;\n  var value;\n  var elem = that.element;\n  var renderer = that.renderer;\n  var rtl = renderer.rtl;\n  var hasTransformations;\n  var recalculateDashStyle;\n  var sw;\n  var i;\n\n  if (!isObjectArgument(attrs)) {\n    if (attrs in settings) {\n      return settings[attrs];\n    }\n\n    if (attrs in DEFAULTS) {\n      return DEFAULTS[attrs];\n    }\n\n    return 0;\n  }\n\n  extend(attributes, attrs);\n\n  for (key in attributes) {\n    value = attributes[key];\n\n    if (void 0 === value) {\n      continue;\n    }\n\n    settings[key] = value;\n\n    if (\"align\" === key) {\n      key = \"text-anchor\";\n      value = {\n        left: rtl ? \"end\" : \"start\",\n        center: \"middle\",\n        right: rtl ? \"start\" : \"end\"\n      }[value] || null;\n    } else {\n      if (\"dashStyle\" === key) {\n        recalculateDashStyle = true;\n        continue;\n      } else {\n        if (key === KEY_STROKE_WIDTH) {\n          recalculateDashStyle = true;\n        } else {\n          if (value && (\"fill\" === key || \"clip-path\" === key || \"filter\" === key) && 0 === value.indexOf(\"DevExpress\")) {\n            that._addFixIRICallback();\n\n            value = getFuncIri(value, renderer.pathModified);\n          } else {\n            if (/^(translate(X|Y)|rotate[XY]?|scale(X|Y)|sharp|sharpDirection)$/i.test(key)) {\n              hasTransformations = true;\n              continue;\n            } else {\n              if (/^(x|y|d)$/i.test(key)) {\n                hasTransformations = true;\n              }\n            }\n          }\n        }\n      }\n    }\n\n    if (null === value) {\n      elem.removeAttribute(key);\n    } else {\n      elem.setAttribute(key, value);\n    }\n  }\n\n  if (recalculateDashStyle && \"dashStyle\" in settings) {\n    value = settings.dashStyle;\n    sw = (\"_originalSW\" in that ? that._originalSW : settings[KEY_STROKE_WIDTH]) || 1;\n    key = \"stroke-dasharray\";\n    value = null === value ? \"\" : (0, _utils.normalizeEnum)(value);\n\n    if (\"\" === value || \"solid\" === value || value === NONE) {\n      that.element.removeAttribute(key);\n    } else {\n      value = value.replace(/longdash/g, \"8,3,\").replace(/dash/g, \"4,3,\").replace(/dot/g, \"1,3,\").replace(/,$/, \"\").split(\",\");\n      i = value.length;\n\n      while (i--) {\n        value[i] = parseInt(value[i]) * sw;\n      }\n\n      that.element.setAttribute(key, value.join(\",\"));\n    }\n  }\n\n  if (hasTransformations) {\n    that._applyTransformation();\n  }\n\n  return that;\n}\n\nfunction pathAttr(attrs) {\n  var that = this;\n  var segments;\n\n  if (isObjectArgument(attrs)) {\n    attrs = extend({}, attrs);\n    segments = attrs.segments;\n\n    if (\"points\" in attrs) {\n      segments = buildPathSegments(attrs.points, that.type);\n      delete attrs.points;\n    }\n\n    if (segments) {\n      attrs.d = combinePathParam(segments);\n      that.segments = segments;\n      delete attrs.segments;\n    }\n  }\n\n  return baseAttr(that, attrs);\n}\n\nfunction arcAttr(attrs) {\n  var settings = this._settings;\n  var x;\n  var y;\n  var innerRadius;\n  var outerRadius;\n  var startAngle;\n  var endAngle;\n\n  if (isObjectArgument(attrs)) {\n    attrs = extend({}, attrs);\n\n    if (\"x\" in attrs || \"y\" in attrs || \"innerRadius\" in attrs || \"outerRadius\" in attrs || \"startAngle\" in attrs || \"endAngle\" in attrs) {\n      settings.x = x = \"x\" in attrs ? attrs.x : settings.x;\n      delete attrs.x;\n      settings.y = y = \"y\" in attrs ? attrs.y : settings.y;\n      delete attrs.y;\n      settings.innerRadius = innerRadius = \"innerRadius\" in attrs ? attrs.innerRadius : settings.innerRadius;\n      delete attrs.innerRadius;\n      settings.outerRadius = outerRadius = \"outerRadius\" in attrs ? attrs.outerRadius : settings.outerRadius;\n      delete attrs.outerRadius;\n      settings.startAngle = startAngle = \"startAngle\" in attrs ? attrs.startAngle : settings.startAngle;\n      delete attrs.startAngle;\n      settings.endAngle = endAngle = \"endAngle\" in attrs ? attrs.endAngle : settings.endAngle;\n      delete attrs.endAngle;\n      attrs.d = buildArcPath.apply(null, normalizeArcParams(x, y, innerRadius, outerRadius, startAngle, endAngle));\n    }\n  }\n\n  return baseAttr(this, attrs);\n}\n\nfunction rectAttr(attrs) {\n  var that = this;\n  var x;\n  var y;\n  var width;\n  var height;\n  var sw;\n  var maxSW;\n  var newSW;\n\n  if (isObjectArgument(attrs)) {\n    attrs = extend({}, attrs);\n\n    if (void 0 !== attrs.x || void 0 !== attrs.y || void 0 !== attrs.width || void 0 !== attrs.height || void 0 !== attrs[KEY_STROKE_WIDTH]) {\n      void 0 !== attrs.x ? x = that._originalX = attrs.x : x = that._originalX || 0;\n      void 0 !== attrs.y ? y = that._originalY = attrs.y : y = that._originalY || 0;\n      void 0 !== attrs.width ? width = that._originalWidth = attrs.width : width = that._originalWidth || 0;\n      void 0 !== attrs.height ? height = that._originalHeight = attrs.height : height = that._originalHeight || 0;\n      void 0 !== attrs[KEY_STROKE_WIDTH] ? sw = that._originalSW = attrs[KEY_STROKE_WIDTH] : sw = that._originalSW;\n      maxSW = ~~((width < height ? width : height) / 2);\n      newSW = (sw || 0) < maxSW ? sw || 0 : maxSW;\n      attrs.x = x + newSW / 2;\n      attrs.y = y + newSW / 2;\n      attrs.width = width - newSW;\n      attrs.height = height - newSW;\n      ((sw || 0) !== newSW || !(0 === newSW && void 0 === sw)) && (attrs[KEY_STROKE_WIDTH] = newSW);\n    }\n\n    if (\"sharp\" in attrs) {\n      delete attrs.sharp;\n    }\n  }\n\n  return baseAttr(that, attrs);\n}\n\nfunction textAttr(attrs) {\n  var that = this;\n  var settings;\n  var isResetRequired;\n  var wasStroked;\n  var isStroked;\n\n  if (!isObjectArgument(attrs)) {\n    return baseAttr(that, attrs);\n  }\n\n  attrs = extend({}, attrs);\n  settings = that._settings;\n  wasStroked = (0, _type.isDefined)(settings[KEY_STROKE]) && (0, _type.isDefined)(settings[KEY_STROKE_WIDTH]);\n\n  if (void 0 !== attrs[KEY_TEXT]) {\n    settings[KEY_TEXT] = attrs[KEY_TEXT];\n    delete attrs[KEY_TEXT];\n    isResetRequired = true;\n  }\n\n  if (void 0 !== attrs[KEY_STROKE]) {\n    settings[KEY_STROKE] = attrs[KEY_STROKE];\n    delete attrs[KEY_STROKE];\n  }\n\n  if (void 0 !== attrs[KEY_STROKE_WIDTH]) {\n    settings[KEY_STROKE_WIDTH] = attrs[KEY_STROKE_WIDTH];\n    delete attrs[KEY_STROKE_WIDTH];\n  }\n\n  if (void 0 !== attrs[KEY_STROKE_OPACITY]) {\n    settings[KEY_STROKE_OPACITY] = attrs[KEY_STROKE_OPACITY];\n    delete attrs[KEY_STROKE_OPACITY];\n  }\n\n  if (void 0 !== attrs[KEY_TEXTS_ALIGNMENT]) {\n    alignTextNodes(that, attrs[KEY_TEXTS_ALIGNMENT]);\n    delete attrs[KEY_TEXTS_ALIGNMENT];\n  }\n\n  isStroked = (0, _type.isDefined)(settings[KEY_STROKE]) && (0, _type.isDefined)(settings[KEY_STROKE_WIDTH]);\n  baseAttr(that, attrs);\n  isResetRequired = isResetRequired || isStroked !== wasStroked && settings[KEY_TEXT];\n\n  if (isResetRequired) {\n    createTextNodes(that, settings.text, isStroked);\n    that._hasEllipsis = false;\n  }\n\n  if (isResetRequired || void 0 !== attrs.x || void 0 !== attrs.y) {\n    locateTextNodes(that);\n  }\n\n  if (isStroked) {\n    strokeTextNodes(that);\n  }\n\n  return that;\n}\n\nfunction textCss(styles) {\n  styles = styles || {};\n  baseCss(this, styles);\n\n  if (KEY_FONT_SIZE in styles) {\n    locateTextNodes(this);\n  }\n\n  return this;\n}\n\nfunction orderHtmlTree(list, line, node, parentStyle, parentClassName) {\n  var style;\n  var realStyle;\n  var i;\n  var ii;\n  var nodes;\n\n  if (void 0 !== node.wholeText) {\n    list.push({\n      value: node.wholeText,\n      style: parentStyle,\n      className: parentClassName,\n      line: line,\n      height: parentStyle[KEY_FONT_SIZE] || 0\n    });\n  } else {\n    if (\"BR\" === node.tagName) {\n      ++line;\n    } else {\n      if (_dom_adapter2.default.isElementNode(node)) {\n        extend(style = {}, parentStyle);\n\n        switch (node.tagName) {\n          case \"B\":\n          case \"STRONG\":\n            style[KEY_FONT_WEIGHT] = \"bold\";\n            break;\n\n          case \"I\":\n          case \"EM\":\n            style[KEY_FONT_STYLE] = \"italic\";\n            break;\n\n          case \"U\":\n            style[KEY_TEXT_DECORATION] = \"underline\";\n        }\n\n        realStyle = node.style;\n        realStyle.color && (style.fill = realStyle.color);\n        realStyle.fontSize && (style[KEY_FONT_SIZE] = realStyle.fontSize);\n        realStyle.fontStyle && (style[KEY_FONT_STYLE] = realStyle.fontStyle);\n        realStyle.fontWeight && (style[KEY_FONT_WEIGHT] = realStyle.fontWeight);\n        realStyle.textDecoration && (style[KEY_TEXT_DECORATION] = realStyle.textDecoration);\n\n        for (i = 0, nodes = node.childNodes, ii = nodes.length; i < ii; ++i) {\n          line = orderHtmlTree(list, line, nodes[i], style, node.className || parentClassName);\n        }\n      }\n    }\n  }\n\n  return line;\n}\n\nfunction adjustLineHeights(items) {\n  var i;\n  var ii;\n  var currentItem = items[0];\n  var item;\n\n  for (i = 1, ii = items.length; i < ii; ++i) {\n    item = items[i];\n\n    if (item.line === currentItem.line) {\n      currentItem.height = maxLengthFontSize(currentItem.height, item.height);\n      currentItem.inherits = currentItem.inherits || 0 === parseFloat(item.height);\n      item.height = NaN;\n    } else {\n      currentItem = item;\n    }\n  }\n}\n\nfunction removeExtraAttrs(html) {\n  var findTagAttrs = /(?:(<[a-z0-9]+\\s*))([\\s\\S]*?)(>|\\/>)/gi;\n  var findStyleAndClassAttrs = /(style|class)\\s*=\\s*([\"'])(?:(?!\\2).)*\\2\\s?/gi;\n  return html.replace(findTagAttrs, function (allTagAttrs, p1, p2, p3) {\n    p2 = (p2 && p2.match(findStyleAndClassAttrs) || []).map(function (str) {\n      return str;\n    }).join(\" \");\n    return p1 + p2 + p3;\n  });\n}\n\nfunction parseHTML(text) {\n  var items = [];\n\n  var div = _dom_adapter2.default.createElement(\"div\");\n\n  div.innerHTML = text.replace(/\\r/g, \"\").replace(/\\n/g, \"<br/>\");\n  orderHtmlTree(items, 0, div, {}, \"\");\n  adjustLineHeights(items);\n  return items;\n}\n\nfunction parseMultiline(text) {\n  var texts = text.replace(/\\r/g, \"\").split(/\\n/g);\n  var i = 0;\n  var items = [];\n\n  for (; i < texts.length; i++) {\n    items.push({\n      value: texts[i].trim(),\n      height: 0,\n      line: i\n    });\n  }\n\n  return items;\n}\n\nfunction createTspans(items, element, fieldName) {\n  var i;\n  var ii;\n  var item;\n\n  for (i = 0, ii = items.length; i < ii; ++i) {\n    item = items[i];\n    item[fieldName] = createElement(\"tspan\");\n    item[fieldName].appendChild(_dom_adapter2.default.createTextNode(item.value));\n    item.style && baseCss({\n      element: item[fieldName],\n      _styles: {}\n    }, item.style);\n    item.className && item[fieldName].setAttribute(\"class\", item.className);\n    element.appendChild(item[fieldName]);\n  }\n}\n\nfunction restoreText() {\n  if (this._hasEllipsis) {\n    this.attr({\n      text: this._settings.text\n    });\n  }\n}\n\nfunction applyEllipsis(maxWidth) {\n  var that = this;\n  var lines;\n  var hasEllipsis = false;\n  var i;\n  var ii;\n  var lineParts;\n  var j;\n  var jj;\n  var text;\n  var ellipsis;\n  var ellipsisWidth;\n  restoreText.call(that);\n  ellipsis = that.renderer.text(ELLIPSIS).attr(that._styles).append(that.renderer.root);\n  ellipsisWidth = ellipsis.getBBox().width;\n\n  if (that._getElementBBox().width > maxWidth) {\n    if (maxWidth - ellipsisWidth < 0) {\n      maxWidth = 0;\n    } else {\n      maxWidth -= ellipsisWidth;\n    }\n\n    lines = prepareLines(that.element, that._texts, maxWidth);\n\n    for (i = 0, ii = lines.length; i < ii; ++i) {\n      lineParts = lines[i].parts;\n\n      if (1 === lines[i].commonLength) {\n        continue;\n      }\n\n      for (j = 0, jj = lineParts.length; j < jj; ++j) {\n        text = lineParts[j];\n\n        if ((0, _type.isDefined)(text.endIndex)) {\n          setNewText(text, text.endIndex);\n          hasEllipsis = true;\n        } else {\n          if (text.startBox > maxWidth) {\n            removeTextSpan(text);\n          }\n        }\n      }\n    }\n  }\n\n  ellipsis.remove();\n  that._hasEllipsis = hasEllipsis;\n  return hasEllipsis;\n}\n\nfunction cloneAndRemoveAttrs(node) {\n  var clone;\n\n  if (node) {\n    clone = node.cloneNode();\n    clone.removeAttribute(\"y\");\n    clone.removeAttribute(\"x\");\n  }\n\n  return clone || node;\n}\n\nfunction detachAndStoreTitleElements(element) {\n  var titleElements = _dom_adapter2.default.querySelectorAll(element, \"title\");\n\n  for (var i = 0; i < titleElements.length; i++) {\n    element.removeChild(titleElements[i]);\n  }\n\n  return function () {\n    for (var _i = 0; _i < titleElements.length; _i++) {\n      element.appendChild(titleElements[_i]);\n    }\n  };\n}\n\nfunction setMaxSize(maxWidth, maxHeight) {\n  var options = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {};\n  var that = this;\n  var lines = [];\n  var textChanged = false;\n  var textIsEmpty = false;\n  var ellipsis;\n  var ellipsisWidth;\n  var ellipsisMaxWidth = maxWidth;\n  restoreText.call(that);\n  var restoreTitleElement = detachAndStoreTitleElements(this.element);\n  ellipsis = that.renderer.text(ELLIPSIS).attr(that._styles).append(that.renderer.root);\n  ellipsisWidth = ellipsis.getBBox().width;\n\n  var _that$_getElementBBox = that._getElementBBox(),\n      width = _that$_getElementBBox.width,\n      height = _that$_getElementBBox.height;\n\n  if ((width || height) && (width > maxWidth || maxHeight && height > maxHeight)) {\n    if (maxWidth - ellipsisWidth < 0) {\n      ellipsisMaxWidth = 0;\n    } else {\n      ellipsisMaxWidth -= ellipsisWidth;\n    }\n\n    lines = applyOverflowRules(that.element, that._texts, maxWidth, ellipsisMaxWidth, options, maxHeight);\n    lines = setMaxHeight(lines, ellipsisMaxWidth, options, maxHeight, parseFloat(this._getLineHeight()));\n    this._texts = lines.reduce(function (texts, line) {\n      return texts.concat(line.parts);\n    }, []).filter(function (t) {\n      return \"\" !== t.value;\n    }).map(function (t) {\n      t.stroke && t.tspan.parentNode.appendChild(t.stroke);\n      return t;\n    }).map(function (t) {\n      t.tspan.parentNode.appendChild(t.tspan);\n      return t;\n    });\n    !this._texts.length && (this._texts = null);\n    textChanged = true;\n\n    if (this._texts) {\n      locateTextNodes(this);\n    } else {\n      this.element.textContent = \"\";\n      textIsEmpty = true;\n    }\n  }\n\n  ellipsis.remove();\n  that._hasEllipsis = textChanged;\n  restoreTitleElement();\n  return {\n    rowCount: lines.length,\n    textChanged: textChanged,\n    textIsEmpty: textIsEmpty\n  };\n}\n\nfunction getIndexForEllipsis(text, maxWidth, startBox, endBox) {\n  var k;\n  var kk;\n\n  if (startBox <= maxWidth && endBox > maxWidth) {\n    for (k = 1, kk = text.value.length; k <= kk; ++k) {\n      if (startBox + text.tspan.getSubStringLength(0, k) > maxWidth) {\n        return k - 1;\n      }\n    }\n  }\n}\n\nfunction getTextWidth(text) {\n  return text.value.length ? text.tspan.getSubStringLength(0, text.value.length) : 0;\n}\n\nfunction prepareLines(element, texts, maxWidth) {\n  var lines = [];\n  var i;\n  var ii;\n  var text;\n  var startBox;\n  var endBox;\n\n  if (texts) {\n    for (i = 0, ii = texts.length; i < ii; ++i) {\n      text = texts[i];\n\n      if (!lines[text.line]) {\n        text.startBox = startBox = 0;\n        lines.push({\n          commonLength: text.value.length,\n          parts: [text]\n        });\n      } else {\n        text.startBox = startBox;\n        lines[text.line].parts.push(text);\n        lines[text.line].commonLength += text.value.length;\n      }\n\n      endBox = startBox + text.tspan.getSubStringLength(0, text.value.length);\n      text.endIndex = getIndexForEllipsis(text, maxWidth, startBox, endBox);\n      startBox = endBox;\n    }\n  } else {\n    text = {\n      value: element.textContent,\n      tspan: element\n    };\n    text.startBox = startBox = 0;\n    endBox = startBox + getTextWidth(text);\n    text.endIndex = getIndexForEllipsis(text, maxWidth, startBox, endBox);\n    lines = [{\n      commonLength: element.textContent.length,\n      parts: [text]\n    }];\n  }\n\n  return lines;\n}\n\nfunction getSpaceBreakIndex(text, maxWidth) {\n  var initialIndices = text.startBox > 0 ? [0] : [];\n  var spaceIndices = text.value.split(\"\").reduce(function (indices, char, index) {\n    if (\" \" === char) {\n      indices.push(index);\n    }\n\n    return indices;\n  }, initialIndices);\n  var spaceIndex = 0;\n\n  while (void 0 !== spaceIndices[spaceIndex + 1] && text.startBox + text.tspan.getSubStringLength(0, spaceIndices[spaceIndex + 1]) < maxWidth) {\n    spaceIndex++;\n  }\n\n  return spaceIndices[spaceIndex];\n}\n\nfunction getWordBreakIndex(text, maxWidth) {\n  for (var i = 0; i < text.value.length - 1; i++) {\n    if (text.startBox + text.tspan.getSubStringLength(0, i + 1) > maxWidth) {\n      return i;\n    }\n  }\n}\n\nfunction getEllipsisString(ellipsisMaxWidth, _ref) {\n  var hideOverflowEllipsis = _ref.hideOverflowEllipsis;\n  return hideOverflowEllipsis && 0 === ellipsisMaxWidth ? \"\" : ELLIPSIS;\n}\n\nfunction setEllipsis(text, ellipsisMaxWidth, options) {\n  var ellipsis = getEllipsisString(ellipsisMaxWidth, options);\n\n  if (text.value.length && text.tspan.parentNode) {\n    for (var i = text.value.length - 1; i >= 1; i--) {\n      if (text.startBox + text.tspan.getSubStringLength(0, i) < ellipsisMaxWidth) {\n        setNewText(text, i, ellipsis);\n        break;\n      } else {\n        if (1 === i) {\n          setNewText(text, 0, ellipsis);\n        }\n      }\n    }\n  }\n}\n\nfunction wordWrap(text, maxWidth, ellipsisMaxWidth, options) {\n  var wholeText = text.value;\n  var breakIndex;\n\n  if (\"none\" !== options.wordWrap) {\n    breakIndex = \"normal\" === options.wordWrap ? getSpaceBreakIndex(text, maxWidth) : getWordBreakIndex(text, maxWidth);\n  }\n\n  var restLines = [];\n  var restText;\n\n  if (isFinite(breakIndex)) {\n    setNewText(text, breakIndex, \"\");\n    var newTextOffset = \" \" === wholeText[breakIndex] ? 1 : 0;\n    var restString = wholeText.slice(breakIndex + newTextOffset);\n\n    if (restString.length) {\n      var restTspan = cloneAndRemoveAttrs(text.tspan);\n      restTspan.textContent = restString;\n      text.tspan.parentNode.appendChild(restTspan);\n      restText = extend(extend({}, text), {\n        value: restString,\n        startBox: 0,\n        height: 0,\n        tspan: restTspan,\n        stroke: cloneAndRemoveAttrs(text.stroke),\n        endBox: restTspan.getSubStringLength(0, restString.length)\n      });\n      restText.stroke && (restText.stroke.textContent = restString);\n\n      if (restText.endBox > maxWidth) {\n        restLines = wordWrap(restText, maxWidth, ellipsisMaxWidth, options);\n\n        if (!restLines.length) {\n          return [];\n        }\n      }\n    }\n  }\n\n  if (text.value.length) {\n    if (\"ellipsis\" === options.textOverflow && text.tspan.getSubStringLength(0, text.value.length) > maxWidth) {\n      setEllipsis(text, ellipsisMaxWidth, options);\n    }\n\n    if (\"hide\" === options.textOverflow && text.tspan.getSubStringLength(0, text.value.length) > maxWidth) {\n      return [];\n    }\n  } else {\n    text.tspan.parentNode.removeChild(text.tspan);\n  }\n\n  var parts = [];\n\n  if (restText) {\n    parts.push(restText);\n  }\n\n  return [{\n    commonLength: wholeText.length,\n    parts: parts\n  }].concat(restLines);\n}\n\nfunction calculateLineHeight(line, lineHeight) {\n  return line.parts.reduce(function (height, text) {\n    return max(height, getItemLineHeight(text, lineHeight));\n  }, 0);\n}\n\nfunction setMaxHeight(lines, ellipsisMaxWidth, options, maxHeight, lineHeight) {\n  var textOverflow = options.textOverflow;\n\n  if (!isFinite(maxHeight) || 0 === Number(maxHeight) || \"none\" === textOverflow) {\n    return lines;\n  }\n\n  var result = lines.reduce(function (_ref2, l, index, arr) {\n    var _ref3 = _slicedToArray(_ref2, 2),\n        lines = _ref3[0],\n        commonHeight = _ref3[1];\n\n    var height = calculateLineHeight(l, lineHeight);\n    commonHeight += height;\n\n    if (commonHeight < maxHeight) {\n      lines.push(l);\n    } else {\n      l.parts.forEach(function (item) {\n        removeTextSpan(item);\n      });\n\n      if (\"ellipsis\" === textOverflow) {\n        var prevLine = arr[index - 1];\n\n        if (prevLine) {\n          var text = prevLine.parts[prevLine.parts.length - 1];\n\n          if (!text.hasEllipsis) {\n            if (0 === ellipsisMaxWidth || text.endBox < ellipsisMaxWidth) {\n              setNewText(text, text.value.length, getEllipsisString(ellipsisMaxWidth, options));\n            } else {\n              setEllipsis(text, ellipsisMaxWidth, options);\n            }\n          }\n        }\n      }\n    }\n\n    return [lines, commonHeight];\n  }, [[], 0]);\n\n  if (\"hide\" === textOverflow && result[1] > maxHeight) {\n    result[0].forEach(function (l) {\n      l.parts.forEach(function (item) {\n        removeTextSpan(item);\n      });\n    });\n    return [];\n  }\n\n  return result[0];\n}\n\nfunction applyOverflowRules(element, texts, maxWidth, ellipsisMaxWidth, options) {\n  if (!texts) {\n    var textValue = element.textContent;\n    var text = {\n      value: textValue,\n      height: 0,\n      line: 0\n    };\n    element.textContent = \"\";\n    createTspans([text], element, \"tspan\");\n    texts = [text];\n  }\n\n  return texts.reduce(function (_ref4, text) {\n    var _ref5 = _slicedToArray(_ref4, 5),\n        lines = _ref5[0],\n        startBox = _ref5[1],\n        endBox = _ref5[2],\n        stop = _ref5[3],\n        lineNumber = _ref5[4];\n\n    var line = lines[lines.length - 1];\n\n    if (stop) {\n      return [lines, startBox, endBox, stop];\n    }\n\n    if (!line || text.line !== lineNumber) {\n      text.startBox = startBox = 0;\n      lines.push({\n        commonLength: text.value.length,\n        parts: [text]\n      });\n    } else {\n      text.startBox = startBox;\n\n      if (startBox > ellipsisMaxWidth && \"none\" === options.wordWrap && \"ellipsis\" === options.textOverflow) {\n        removeTextSpan(text);\n        return [lines, startBox, endBox, stop, lineNumber];\n      }\n\n      line.parts.push(text);\n      line.commonLength += text.value.length;\n    }\n\n    text.endBox = endBox = startBox + getTextWidth(text);\n    startBox = endBox;\n\n    if ((0, _type.isDefined)(maxWidth) && endBox > maxWidth) {\n      var wordWrapLines = wordWrap(text, maxWidth, ellipsisMaxWidth, options);\n\n      if (!wordWrapLines.length) {\n        lines = [];\n        stop = true;\n      } else {\n        lines = lines.concat(wordWrapLines.filter(function (l) {\n          return l.parts.length > 0;\n        }));\n      }\n    }\n\n    return [lines, startBox, endBox, stop, text.line];\n  }, [[], 0, 0, false, 0])[0];\n}\n\nfunction setNewText(text, index) {\n  var insertString = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : ELLIPSIS;\n  var newText = text.value.substr(0, index) + insertString;\n  text.value = text.tspan.textContent = newText;\n  text.stroke && (text.stroke.textContent = newText);\n\n  if (insertString === ELLIPSIS) {\n    text.hasEllipsis = true;\n  }\n}\n\nfunction removeTextSpan(text) {\n  text.tspan.parentNode && text.tspan.parentNode.removeChild(text.tspan);\n  text.stroke && text.stroke.parentNode && text.stroke.parentNode.removeChild(text.stroke);\n}\n\nfunction createTextNodes(wrapper, text, isStroked) {\n  var items;\n  var parsedHtml;\n  wrapper._texts = null;\n  wrapper.clear();\n\n  if (null === text) {\n    return;\n  }\n\n  text = \"\" + text;\n\n  if (!wrapper.renderer.encodeHtml && (/<[a-z][\\s\\S]*>/i.test(text) || text.indexOf(\"&\") !== -1)) {\n    parsedHtml = removeExtraAttrs(text);\n    items = parseHTML(parsedHtml);\n  } else {\n    if (/\\n/g.test(text)) {\n      items = parseMultiline(text);\n    } else {\n      if (isStroked) {\n        items = [{\n          value: text.trim(),\n          height: 0\n        }];\n      }\n    }\n  }\n\n  if (items) {\n    if (items.length) {\n      wrapper._texts = items;\n\n      if (isStroked) {\n        createTspans(items, wrapper.element, KEY_STROKE);\n      }\n\n      createTspans(items, wrapper.element, \"tspan\");\n    }\n  } else {\n    wrapper.element.appendChild(_dom_adapter2.default.createTextNode(text));\n  }\n}\n\nfunction setTextNodeAttribute(item, name, value) {\n  item.tspan.setAttribute(name, value);\n  item.stroke && item.stroke.setAttribute(name, value);\n}\n\nfunction getItemLineHeight(item, defaultValue) {\n  return item.inherits ? maxLengthFontSize(item.height, defaultValue) : item.height || defaultValue;\n}\n\nfunction locateTextNodes(wrapper) {\n  if (!wrapper._texts) {\n    return;\n  }\n\n  var items = wrapper._texts;\n  var x = wrapper._settings.x;\n\n  var lineHeight = wrapper._getLineHeight();\n\n  var i;\n  var ii;\n  var item = items[0];\n  setTextNodeAttribute(item, \"x\", x);\n  setTextNodeAttribute(item, \"y\", wrapper._settings.y);\n\n  for (i = 1, ii = items.length; i < ii; ++i) {\n    item = items[i];\n\n    if (parseFloat(item.height) >= 0) {\n      setTextNodeAttribute(item, \"x\", x);\n      var height = getItemLineHeight(item, lineHeight);\n      setTextNodeAttribute(item, \"dy\", height);\n    }\n  }\n}\n\nfunction alignTextNodes(wrapper, alignment) {\n  if (!wrapper._texts || \"center\" === alignment) {\n    return;\n  }\n\n  var items = wrapper._texts;\n  var direction = \"left\" === alignment ? -1 : 1;\n  var maxTextWidth = Math.max.apply(Math, items.map(function (t) {\n    return getTextWidth(t);\n  }));\n\n  for (var i = 0; i < items.length; i++) {\n    var item = items[i];\n    var textWidth = getTextWidth(item);\n\n    if (0 !== maxTextWidth && maxTextWidth !== textWidth) {\n      setTextNodeAttribute(item, \"dx\", direction * round((maxTextWidth - textWidth) / 2 * 10) / 10);\n    }\n  }\n}\n\nfunction maxLengthFontSize(fontSize1, fontSize2) {\n  var parsedHeight1 = parseFloat(fontSize1);\n  var parsedHeight2 = parseFloat(fontSize2);\n  var height1 = parsedHeight1 || DEFAULT_FONT_SIZE;\n  var height2 = parsedHeight2 || DEFAULT_FONT_SIZE;\n  return height1 > height2 ? !isNaN(parsedHeight1) ? fontSize1 : height1 : !isNaN(parsedHeight2) ? fontSize2 : height2;\n}\n\nfunction strokeTextNodes(wrapper) {\n  if (!wrapper._texts) {\n    return;\n  }\n\n  var items = wrapper._texts;\n  var stroke = wrapper._settings[KEY_STROKE];\n  var strokeWidth = wrapper._settings[KEY_STROKE_WIDTH];\n  var strokeOpacity = wrapper._settings[KEY_STROKE_OPACITY] || 1;\n  var tspan;\n  var i;\n  var ii;\n\n  for (i = 0, ii = items.length; i < ii; ++i) {\n    tspan = items[i].stroke;\n    tspan.setAttribute(KEY_STROKE, stroke);\n    tspan.setAttribute(KEY_STROKE_WIDTH, strokeWidth);\n    tspan.setAttribute(KEY_STROKE_OPACITY, strokeOpacity);\n    tspan.setAttribute(\"stroke-linejoin\", \"round\");\n  }\n}\n\nfunction baseAnimate(that, params, options, complete) {\n  options = options || {};\n  var key;\n  var value;\n  var renderer = that.renderer;\n  var settings = that._settings;\n  var animationParams = {};\n  var defaults = {\n    translateX: 0,\n    translateY: 0,\n    scaleX: 1,\n    scaleY: 1,\n    rotate: 0,\n    rotateX: 0,\n    rotateY: 0\n  };\n\n  if (complete) {\n    options.complete = complete;\n  }\n\n  if (renderer.animationEnabled()) {\n    for (key in params) {\n      value = params[key];\n\n      if (/^(translate(X|Y)|rotate[XY]?|scale(X|Y))$/i.test(key)) {\n        animationParams.transform = animationParams.transform || {\n          from: {},\n          to: {}\n        };\n        animationParams.transform.from[key] = key in settings ? Number(settings[key].toFixed(3)) : defaults[key];\n        animationParams.transform.to[key] = value;\n      } else {\n        if (\"arc\" === key || \"segments\" === key) {\n          animationParams[key] = value;\n        } else {\n          animationParams[key] = {\n            from: key in settings ? settings[key] : parseFloat(that.element.getAttribute(key) || 0),\n            to: value\n          };\n        }\n      }\n    }\n\n    renderer.animateElement(that, animationParams, extend(extend({}, renderer._animation), options));\n  } else {\n    options.step && options.step.call(that, 1, 1);\n    options.complete && options.complete.call(that);\n    that.attr(params);\n  }\n\n  return that;\n}\n\nfunction pathAnimate(params, options, complete) {\n  var that = this;\n  var curSegments = that.segments || [];\n  var newSegments;\n  var endSegments;\n\n  if (that.renderer.animationEnabled() && \"points\" in params) {\n    newSegments = buildPathSegments(params.points, that.type);\n    endSegments = compensateSegments(curSegments, newSegments, that.type);\n    params.segments = {\n      from: curSegments,\n      to: newSegments,\n      end: endSegments\n    };\n    delete params.points;\n  }\n\n  return baseAnimate(that, params, options, complete);\n}\n\nfunction arcAnimate(params, options, complete) {\n  var that = this;\n  var settings = that._settings;\n  var arcParams = {\n    from: {},\n    to: {}\n  };\n\n  if (that.renderer.animationEnabled() && (\"x\" in params || \"y\" in params || \"innerRadius\" in params || \"outerRadius\" in params || \"startAngle\" in params || \"endAngle\" in params)) {\n    arcParams.from.x = settings.x || 0;\n    arcParams.from.y = settings.y || 0;\n    arcParams.from.innerRadius = settings.innerRadius || 0;\n    arcParams.from.outerRadius = settings.outerRadius || 0;\n    arcParams.from.startAngle = settings.startAngle || 0;\n    arcParams.from.endAngle = settings.endAngle || 0;\n    arcParams.to.x = \"x\" in params ? params.x : settings.x;\n    delete params.x;\n    arcParams.to.y = \"y\" in params ? params.y : settings.y;\n    delete params.y;\n    arcParams.to.innerRadius = \"innerRadius\" in params ? params.innerRadius : settings.innerRadius;\n    delete params.innerRadius;\n    arcParams.to.outerRadius = \"outerRadius\" in params ? params.outerRadius : settings.outerRadius;\n    delete params.outerRadius;\n    arcParams.to.startAngle = \"startAngle\" in params ? params.startAngle : settings.startAngle;\n    delete params.startAngle;\n    arcParams.to.endAngle = \"endAngle\" in params ? params.endAngle : settings.endAngle;\n    delete params.endAngle;\n    params.arc = arcParams;\n  }\n\n  return baseAnimate(that, params, options, complete);\n}\n\nfunction buildLink(target, parameters) {\n  var obj = {\n    is: false,\n    name: parameters.name || parameters,\n    after: parameters.after\n  };\n\n  if (target) {\n    obj.to = target;\n  } else {\n    obj.virtual = true;\n  }\n\n  return obj;\n}\n\nfunction SvgElement(renderer, tagName, type) {\n  var that = this;\n  that.renderer = renderer;\n  that.element = createElement(tagName);\n  that._settings = {};\n  that._styles = {};\n\n  if (\"path\" === tagName) {\n    that.type = type || \"line\";\n  }\n}\n\nfunction removeFuncIriCallback(callback) {\n  fixFuncIriCallbacks.remove(callback);\n}\n\nexports.SvgElement = SvgElement;\nSvgElement.prototype = {\n  constructor: SvgElement,\n  _getJQElement: function _getJQElement() {\n    return this._$element || (this._$element = (0, _renderer2.default)(this.element));\n  },\n  _addFixIRICallback: function _addFixIRICallback() {\n    var that = this;\n\n    var fn = function fn() {\n      fixFuncIri(that, \"fill\");\n      fixFuncIri(that, \"clip-path\");\n      fixFuncIri(that, \"filter\");\n    };\n\n    that.element._fixFuncIri = fn;\n    fn.renderer = that.renderer;\n    fixFuncIriCallbacks.add(fn);\n\n    that._addFixIRICallback = function () {};\n  },\n  _clearChildrenFuncIri: function _clearChildrenFuncIri() {\n    var clearChildren = function clearChildren(element) {\n      var i;\n\n      for (i = 0; i < element.childNodes.length; i++) {\n        removeFuncIriCallback(element.childNodes[i]._fixFuncIri);\n        clearChildren(element.childNodes[i]);\n      }\n    };\n\n    clearChildren(this.element);\n  },\n  dispose: function dispose() {\n    removeFuncIriCallback(this.element._fixFuncIri);\n\n    this._clearChildrenFuncIri();\n\n    this._getJQElement().remove();\n\n    return this;\n  },\n  append: function append(parent) {\n    (parent || this.renderer.root).element.appendChild(this.element);\n    return this;\n  },\n  remove: function remove() {\n    var element = this.element;\n    element.parentNode && element.parentNode.removeChild(element);\n    return this;\n  },\n  enableLinks: function enableLinks() {\n    this._links = [];\n    return this;\n  },\n  virtualLink: function virtualLink(parameters) {\n    linkItem({\n      _link: buildLink(null, parameters)\n    }, this);\n    return this;\n  },\n  linkAfter: function linkAfter(name) {\n    this._linkAfter = name;\n    return this;\n  },\n  linkOn: function linkOn(target, parameters) {\n    this._link = buildLink(target, parameters);\n    linkItem(this, target);\n    return this;\n  },\n  linkOff: function linkOff() {\n    unlinkItem(this);\n    this._link = null;\n    return this;\n  },\n  linkAppend: function linkAppend() {\n    var link = this._link;\n    var items = link.to._links;\n    var i;\n    var next;\n\n    for (i = link.i + 1; (next = items[i]) && !next._link.is; ++i) {}\n\n    this._insert(link.to, next);\n\n    link.is = true;\n    return this;\n  },\n  _insert: function _insert(parent, next) {\n    parent.element.insertBefore(this.element, next ? next.element : null);\n  },\n  linkRemove: function linkRemove() {\n    this.remove();\n    this._link.is = false;\n    return this;\n  },\n  clear: function clear() {\n    this._clearChildrenFuncIri();\n\n    this._getJQElement().empty();\n\n    return this;\n  },\n  toBackground: function toBackground() {\n    var elem = this.element;\n    var parent = elem.parentNode;\n    parent && parent.insertBefore(elem, parent.firstChild);\n    return this;\n  },\n  toForeground: function toForeground() {\n    var elem = this.element;\n    var parent = elem.parentNode;\n    parent && parent.appendChild(elem);\n    return this;\n  },\n  attr: function attr(attrs) {\n    return baseAttr(this, attrs);\n  },\n  smartAttr: function smartAttr(attrs) {\n    return this.attr(processHatchingAttrs(this, attrs));\n  },\n  css: function css(styles) {\n    return baseCss(this, styles);\n  },\n  animate: function animate(params, options, complete) {\n    return baseAnimate(this, params, options, complete);\n  },\n  sharp: function sharp(pos, sharpDirection) {\n    return this.attr({\n      sharp: pos || true,\n      sharpDirection: sharpDirection\n    });\n  },\n  _applyTransformation: function _applyTransformation() {\n    var tr = this._settings;\n    var scaleXDefined;\n    var scaleYDefined;\n    var rotateX;\n    var rotateY;\n    var transformations = [];\n    var sharpMode = tr.sharp;\n    var trDirection = tr.sharpDirection || 1;\n    var strokeOdd = tr[KEY_STROKE_WIDTH] % 2;\n    var correctionX = strokeOdd && (\"h\" === sharpMode || true === sharpMode) ? SHARPING_CORRECTION * trDirection : 0;\n    var correctionY = strokeOdd && (\"v\" === sharpMode || true === sharpMode) ? SHARPING_CORRECTION * trDirection : 0;\n    transformations.push(\"translate(\" + ((tr.translateX || 0) + correctionX) + \",\" + ((tr.translateY || 0) + correctionY) + \")\");\n\n    if (tr.rotate) {\n      if (\"rotateX\" in tr) {\n        rotateX = tr.rotateX;\n      } else {\n        rotateX = tr.x;\n      }\n\n      if (\"rotateY\" in tr) {\n        rotateY = tr.rotateY;\n      } else {\n        rotateY = tr.y;\n      }\n\n      transformations.push(\"rotate(\" + tr.rotate + \",\" + (rotateX || 0) + \",\" + (rotateY || 0) + \")\");\n    }\n\n    scaleXDefined = (0, _type.isDefined)(tr.scaleX);\n    scaleYDefined = (0, _type.isDefined)(tr.scaleY);\n\n    if (scaleXDefined || scaleYDefined) {\n      transformations.push(\"scale(\" + (scaleXDefined ? tr.scaleX : 1) + \",\" + (scaleYDefined ? tr.scaleY : 1) + \")\");\n    }\n\n    if (transformations.length) {\n      this.element.setAttribute(\"transform\", transformations.join(\" \"));\n    }\n  },\n  move: function move(x, y, animate, animOptions) {\n    var obj = {};\n    (0, _type.isDefined)(x) && (obj.translateX = x);\n    (0, _type.isDefined)(y) && (obj.translateY = y);\n\n    if (!animate) {\n      this.attr(obj);\n    } else {\n      this.animate(obj, animOptions);\n    }\n\n    return this;\n  },\n  rotate: function rotate(angle, x, y, animate, animOptions) {\n    var obj = {\n      rotate: angle || 0\n    };\n    (0, _type.isDefined)(x) && (obj.rotateX = x);\n    (0, _type.isDefined)(y) && (obj.rotateY = y);\n\n    if (!animate) {\n      this.attr(obj);\n    } else {\n      this.animate(obj, animOptions);\n    }\n\n    return this;\n  },\n  _getElementBBox: function _getElementBBox() {\n    var elem = this.element;\n    var bBox;\n\n    try {\n      bBox = elem.getBBox && elem.getBBox();\n    } catch (e) {}\n\n    return bBox || {\n      x: 0,\n      y: 0,\n      width: elem.offsetWidth || 0,\n      height: elem.offsetHeight || 0\n    };\n  },\n  getBBox: function getBBox() {\n    var transformation = this._settings;\n\n    var bBox = this._getElementBBox();\n\n    if (transformation.rotate) {\n      bBox = (0, _utils.rotateBBox)(bBox, [(\"rotateX\" in transformation ? transformation.rotateX : transformation.x) || 0, (\"rotateY\" in transformation ? transformation.rotateY : transformation.y) || 0], -transformation.rotate);\n    } else {\n      bBox = (0, _utils.normalizeBBox)(bBox);\n    }\n\n    return bBox;\n  },\n  markup: function markup() {\n    return (0, _svg.getSvgMarkup)(this.element);\n  },\n  getOffset: function getOffset() {\n    return this._getJQElement().offset();\n  },\n  stopAnimation: function stopAnimation(disableComplete) {\n    var animation = this.animation;\n    animation && animation.stop(disableComplete);\n    return this;\n  },\n  setTitle: function setTitle(text) {\n    var titleElem = createElement(\"title\");\n    titleElem.textContent = text || \"\";\n    this.element.appendChild(titleElem);\n  },\n  data: function data(obj, val) {\n    var elem = this.element;\n    var key;\n\n    if (void 0 !== val) {\n      elem[obj] = val;\n    } else {\n      for (key in obj) {\n        elem[key] = obj[key];\n      }\n    }\n\n    return this;\n  },\n  on: function on() {\n    var args = [this._getJQElement()];\n    args.push.apply(args, arguments);\n\n    _events_engine2.default.on.apply(_events_engine2.default, args);\n\n    return this;\n  },\n  off: function off() {\n    var args = [this._getJQElement()];\n    args.push.apply(args, arguments);\n\n    _events_engine2.default.off.apply(_events_engine2.default, args);\n\n    return this;\n  },\n  trigger: function trigger() {\n    var args = [this._getJQElement()];\n    args.push.apply(args, arguments);\n\n    _events_engine2.default.trigger.apply(_events_engine2.default, args);\n\n    return this;\n  }\n};\n\nfunction PathSvgElement(renderer, type) {\n  SvgElement.call(this, renderer, \"path\", type);\n}\n\nexports.PathSvgElement = PathSvgElement;\nPathSvgElement.prototype = objectCreate(SvgElement.prototype);\nextend(PathSvgElement.prototype, {\n  constructor: PathSvgElement,\n  attr: pathAttr,\n  animate: pathAnimate\n});\n\nfunction ArcSvgElement(renderer) {\n  SvgElement.call(this, renderer, \"path\", \"arc\");\n}\n\nexports.ArcSvgElement = ArcSvgElement;\nArcSvgElement.prototype = objectCreate(SvgElement.prototype);\nextend(ArcSvgElement.prototype, {\n  constructor: ArcSvgElement,\n  attr: arcAttr,\n  animate: arcAnimate\n});\n\nfunction RectSvgElement(renderer) {\n  SvgElement.call(this, renderer, \"rect\");\n}\n\nexports.RectSvgElement = RectSvgElement;\nRectSvgElement.prototype = objectCreate(SvgElement.prototype);\nextend(RectSvgElement.prototype, {\n  constructor: RectSvgElement,\n  attr: rectAttr\n});\n\nfunction TextSvgElement(renderer) {\n  SvgElement.call(this, renderer, \"text\");\n  this.css({\n    \"white-space\": \"pre\"\n  });\n}\n\nexports.TextSvgElement = TextSvgElement;\nTextSvgElement.prototype = objectCreate(SvgElement.prototype);\nextend(TextSvgElement.prototype, {\n  constructor: TextSvgElement,\n  attr: textAttr,\n  css: textCss,\n  applyEllipsis: applyEllipsis,\n  setMaxSize: setMaxSize,\n  restoreText: restoreText,\n  _getLineHeight: function _getLineHeight() {\n    return !isNaN(parseFloat(this._styles[KEY_FONT_SIZE])) ? this._styles[KEY_FONT_SIZE] : DEFAULT_FONT_SIZE;\n  }\n});\n\nfunction updateIndexes(items, k) {\n  var i;\n  var item;\n\n  for (i = k; item = items[i]; ++i) {\n    item._link.i = i;\n  }\n}\n\nfunction linkItem(target, container) {\n  var items = container._links;\n  var key = target._link.after = target._link.after || container._linkAfter;\n  var i;\n  var item;\n\n  if (key) {\n    for (i = 0; (item = items[i]) && item._link.name !== key; ++i) {}\n\n    if (item) {\n      for (++i; (item = items[i]) && item._link.after === key; ++i) {}\n    }\n  } else {\n    i = items.length;\n  }\n\n  items.splice(i, 0, target);\n  updateIndexes(items, i);\n}\n\nfunction unlinkItem(target) {\n  var i;\n  var items = target._link.to._links;\n\n  for (i = 0; items[i] !== target; ++i) {}\n\n  items.splice(i, 1);\n  updateIndexes(items, i);\n}\n\nfunction Renderer(options) {\n  var that = this;\n  that.root = that._createElement(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    version: \"1.1\",\n    fill: NONE,\n    stroke: NONE,\n    \"stroke-width\": 0\n  }).attr({\n    \"class\": options.cssClass\n  }).css({\n    \"line-height\": \"normal\",\n    \"-ms-user-select\": NONE,\n    \"-moz-user-select\": NONE,\n    \"-webkit-user-select\": NONE,\n    \"-webkit-tap-highlight-color\": \"rgba(0, 0, 0, 0)\",\n    display: \"block\",\n    overflow: \"hidden\"\n  });\n\n  that._init();\n\n  that.pathModified = !!options.pathModified;\n  that._$container = (0, _renderer2.default)(options.container);\n  that.root.append({\n    element: options.container\n  });\n  that.fixPlacement();\n  that._locker = 0;\n  that._backed = false;\n}\n\nexports.Renderer = Renderer;\nRenderer.prototype = {\n  constructor: Renderer,\n  _init: function _init() {\n    var that = this;\n    that._defs = that._createElement(\"defs\").append(that.root);\n    that._animationController = new _animation2.default.AnimationController(that.root.element);\n    that._animation = {\n      enabled: true,\n      duration: 1e3,\n      easing: \"easeOutCubic\"\n    };\n  },\n  fixPlacement: function fixPlacement() {\n    if (!_browser2.default.mozilla && !_browser2.default.msie) {\n      return;\n    }\n\n    var box = getBoundingClientRect(this._$container.get(0));\n    var dx = roundValue(box.left % 1, 2);\n    var dy = roundValue(box.top % 1, 2);\n\n    if (_browser2.default.msie) {\n      this.root.css({\n        transform: \"translate(\" + -dx + \"px,\" + -dy + \"px)\"\n      });\n    } else {\n      if (_browser2.default.mozilla) {\n        this.root.move(-dx, -dy);\n      }\n    }\n  },\n  removePlacementFix: function removePlacementFix() {\n    if (!_browser2.default.mozilla && !_browser2.default.msie) {\n      return;\n    }\n\n    if (_browser2.default.msie) {\n      this.root.css({\n        transform: \"\"\n      });\n    } else {\n      if (_browser2.default.mozilla) {\n        this.root.attr({\n          transform: null\n        });\n      }\n    }\n  },\n  setOptions: function setOptions(options) {\n    var that = this;\n    that.rtl = !!options.rtl;\n    that.encodeHtml = !!options.encodeHtml;\n    that.updateAnimationOptions(options.animation || {});\n    that.root.attr({\n      direction: that.rtl ? \"rtl\" : \"ltr\"\n    });\n    return that;\n  },\n  _createElement: function _createElement(tagName, attr, type) {\n    var elem = new exports.SvgElement(this, tagName, type);\n    attr && elem.attr(attr);\n    return elem;\n  },\n  lock: function lock() {\n    var that = this;\n\n    if (0 === that._locker) {\n      that._backed = !that._$container.is(\":visible\");\n\n      if (that._backed) {\n        backupRoot(that.root);\n      }\n    }\n\n    ++that._locker;\n    return that;\n  },\n  unlock: function unlock() {\n    var that = this;\n    --that._locker;\n\n    if (0 === that._locker) {\n      if (that._backed) {\n        restoreRoot(that.root, that._$container[0]);\n        that.fixPlacement();\n      }\n\n      that._backed = false;\n    }\n\n    return that;\n  },\n  resize: function resize(width, height) {\n    if (width >= 0 && height >= 0) {\n      this.root.attr({\n        width: width,\n        height: height\n      });\n    }\n\n    return this;\n  },\n  dispose: function dispose() {\n    var that = this;\n    var key;\n    that.root.dispose();\n\n    that._defs.dispose();\n\n    that._animationController.dispose();\n\n    fixFuncIriCallbacks.removeByRenderer(that);\n\n    for (key in that) {\n      that[key] = null;\n    }\n\n    return that;\n  },\n  animationEnabled: function animationEnabled() {\n    return !!this._animation.enabled;\n  },\n  updateAnimationOptions: function updateAnimationOptions(newOptions) {\n    extend(this._animation, newOptions);\n    return this;\n  },\n  stopAllAnimations: function stopAllAnimations(lock) {\n    this._animationController[lock ? \"lock\" : \"stop\"]();\n\n    return this;\n  },\n  animateElement: function animateElement(element, params, options) {\n    this._animationController.animateElement(element, params, options);\n\n    return this;\n  },\n  svg: function svg() {\n    this.removePlacementFix();\n    var markup = this.root.markup();\n    this.fixPlacement();\n    return markup;\n  },\n  getRootOffset: function getRootOffset() {\n    return this.root.getOffset();\n  },\n  onEndAnimation: function onEndAnimation(endAnimation) {\n    this._animationController.onEndAnimation(endAnimation);\n  },\n  rect: function rect(x, y, width, height) {\n    var elem = new exports.RectSvgElement(this);\n    return elem.attr({\n      x: x || 0,\n      y: y || 0,\n      width: width || 0,\n      height: height || 0\n    });\n  },\n  simpleRect: function simpleRect() {\n    return this._createElement(\"rect\");\n  },\n  circle: function circle(x, y, r) {\n    return this._createElement(\"circle\", {\n      cx: x || 0,\n      cy: y || 0,\n      r: r || 0\n    });\n  },\n  g: function g() {\n    return this._createElement(\"g\");\n  },\n  image: function image(x, y, w, h, href, location) {\n    var image = this._createElement(\"image\", {\n      x: x || 0,\n      y: y || 0,\n      width: w || 0,\n      height: h || 0,\n      preserveAspectRatio: preserveAspectRatioMap[(0, _utils.normalizeEnum)(location)] || NONE\n    });\n\n    image.element.setAttributeNS(\"http://www.w3.org/1999/xlink\", \"href\", href || \"\");\n    return image;\n  },\n  path: function path(points, type) {\n    var elem = new exports.PathSvgElement(this, type);\n    return elem.attr({\n      points: points || []\n    });\n  },\n  arc: function arc(x, y, innerRadius, outerRadius, startAngle, endAngle) {\n    var elem = new exports.ArcSvgElement(this);\n    return elem.attr({\n      x: x || 0,\n      y: y || 0,\n      innerRadius: innerRadius || 0,\n      outerRadius: outerRadius || 0,\n      startAngle: startAngle || 0,\n      endAngle: endAngle || 0\n    });\n  },\n  text: function text(_text, x, y) {\n    var elem = new exports.TextSvgElement(this);\n    return elem.attr({\n      text: _text,\n      x: x || 0,\n      y: y || 0\n    });\n  },\n  linearGradient: function linearGradient(stops) {\n    var gradient;\n    var id = getNextDefsSvgId();\n    var that = this;\n    gradient = that._createElement(\"linearGradient\", {\n      id: id\n    }).append(that._defs);\n    gradient.id = id;\n    stops.forEach(function (stop) {\n      that._createElement(\"stop\", {\n        offset: stop.offset,\n        \"stop-color\": stop[\"stop-color\"]\n      }).append(gradient);\n    });\n    return gradient;\n  },\n  pattern: function pattern(color, hatching, _id) {\n    hatching = hatching || {};\n    var that = this;\n    var id;\n    var d;\n    var pattern;\n    var rect;\n    var path;\n    var step = hatching.step || 6;\n    var stepTo2 = step / 2;\n    var stepBy15 = 1.5 * step;\n    id = _id || getNextDefsSvgId();\n    d = \"right\" === (0, _utils.normalizeEnum)(hatching.direction) ? \"M \" + stepTo2 + \" \" + -stepTo2 + \" L \" + -stepTo2 + \" \" + stepTo2 + \" M 0 \" + step + \" L \" + step + \" 0 M \" + stepBy15 + \" \" + stepTo2 + \" L \" + stepTo2 + \" \" + stepBy15 : \"M 0 0 L \" + step + \" \" + step + \" M \" + -stepTo2 + \" \" + stepTo2 + \" L \" + stepTo2 + \" \" + stepBy15 + \" M \" + stepTo2 + \" \" + -stepTo2 + \" L \" + stepBy15 + \" \" + stepTo2;\n    pattern = that._createElement(\"pattern\", {\n      id: id,\n      width: step,\n      height: step,\n      patternUnits: \"userSpaceOnUse\"\n    }).append(that._defs);\n    pattern.id = id;\n    rect = that.rect(0, 0, step, step).attr({\n      fill: color,\n      opacity: hatching.opacity\n    }).append(pattern);\n    path = new exports.PathSvgElement(this).attr({\n      d: d,\n      \"stroke-width\": hatching.width || 1,\n      stroke: color\n    }).append(pattern);\n    return pattern;\n  },\n  _getPointsWithYOffset: function _getPointsWithYOffset(points, offset) {\n    return points.map(function (point, index) {\n      if (index % 2 !== 0) {\n        return point + offset;\n      }\n\n      return point;\n    });\n  },\n  clipShape: function clipShape(method, methodArgs) {\n    var that = this;\n    var id = getNextDefsSvgId();\n\n    var clipPath = that._createElement(\"clipPath\", {\n      id: id\n    }).append(that._defs);\n\n    var shape = method.apply(that, methodArgs).append(clipPath);\n    shape.id = id;\n\n    shape.remove = function () {\n      throw \"Not implemented\";\n    };\n\n    shape.dispose = function () {\n      clipPath.dispose();\n      clipPath = null;\n      return this;\n    };\n\n    return shape;\n  },\n  clipRect: function clipRect(x, y, width, height) {\n    return this.clipShape(this.rect, arguments);\n  },\n  clipCircle: function clipCircle(x, y, radius) {\n    return this.clipShape(this.circle, arguments);\n  },\n  shadowFilter: function shadowFilter(x, y, width, height, offsetX, offsetY, blur, color, opacity) {\n    var that = this;\n    var id = getNextDefsSvgId();\n\n    var filter = that._createElement(\"filter\", {\n      id: id,\n      x: x || 0,\n      y: y || 0,\n      width: width || 0,\n      height: height || 0\n    }).append(that._defs);\n\n    var gaussianBlur = that._createElement(\"feGaussianBlur\", {\n      \"in\": \"SourceGraphic\",\n      result: \"gaussianBlurResult\",\n      stdDeviation: blur || 0\n    }).append(filter);\n\n    var offset = that._createElement(\"feOffset\", {\n      \"in\": \"gaussianBlurResult\",\n      result: \"offsetResult\",\n      dx: offsetX || 0,\n      dy: offsetY || 0\n    }).append(filter);\n\n    var flood = that._createElement(\"feFlood\", {\n      result: \"floodResult\",\n      \"flood-color\": color || \"\",\n      \"flood-opacity\": opacity\n    }).append(filter);\n\n    var composite = that._createElement(\"feComposite\", {\n      \"in\": \"floodResult\",\n      in2: \"offsetResult\",\n      operator: \"in\",\n      result: \"compositeResult\"\n    }).append(filter);\n\n    var finalComposite = that._createElement(\"feComposite\", {\n      \"in\": \"SourceGraphic\",\n      in2: \"compositeResult\",\n      operator: \"over\"\n    }).append(filter);\n\n    filter.id = id;\n    filter.gaussianBlur = gaussianBlur;\n    filter.offset = offset;\n    filter.flood = flood;\n    filter.composite = composite;\n    filter.finalComposite = finalComposite;\n\n    filter.attr = function (attrs) {\n      var that = this;\n      var filterAttrs = {};\n      var offsetAttrs = {};\n      var floodAttrs = {};\n      \"x\" in attrs && (filterAttrs.x = attrs.x);\n      \"y\" in attrs && (filterAttrs.y = attrs.y);\n      \"width\" in attrs && (filterAttrs.width = attrs.width);\n      \"height\" in attrs && (filterAttrs.height = attrs.height);\n      baseAttr(that, filterAttrs);\n      \"blur\" in attrs && that.gaussianBlur.attr({\n        stdDeviation: attrs.blur\n      });\n      \"offsetX\" in attrs && (offsetAttrs.dx = attrs.offsetX);\n      \"offsetY\" in attrs && (offsetAttrs.dy = attrs.offsetY);\n      that.offset.attr(offsetAttrs);\n      \"color\" in attrs && (floodAttrs[\"flood-color\"] = attrs.color);\n      \"opacity\" in attrs && (floodAttrs[\"flood-opacity\"] = attrs.opacity);\n      that.flood.attr(floodAttrs);\n      return that;\n    };\n\n    return filter;\n  },\n  brightFilter: function brightFilter(type, slope) {\n    var that = this;\n    var id = getNextDefsSvgId();\n\n    var filter = that._createElement(\"filter\", {\n      id: id\n    }).append(that._defs);\n\n    var componentTransferElement = that._createElement(\"feComponentTransfer\").append(filter);\n\n    var attrs = {\n      type: type,\n      slope: slope\n    };\n    filter.id = id;\n\n    that._createElement(\"feFuncR\", attrs).append(componentTransferElement);\n\n    that._createElement(\"feFuncG\", attrs).append(componentTransferElement);\n\n    that._createElement(\"feFuncB\", attrs).append(componentTransferElement);\n\n    return filter;\n  },\n  getGrayScaleFilter: function getGrayScaleFilter() {\n    if (this._grayScaleFilter) {\n      return this._grayScaleFilter;\n    }\n\n    var that = this;\n    var id = getNextDefsSvgId();\n\n    var filter = that._createElement(\"filter\", {\n      id: id\n    }).append(that._defs);\n\n    that._createElement(\"feColorMatrix\").attr({\n      type: \"matrix\",\n      values: \"0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 0.6 0\"\n    }).append(filter);\n\n    filter.id = id;\n    that._grayScaleFilter = filter;\n    return filter;\n  },\n  initHatching: function initHatching() {\n    var storage = this._hatchingStorage = this._hatchingStorage || {\n      byHash: {},\n      baseId: getNextDefsSvgId()\n    };\n    var byHash = storage.byHash;\n    var name;\n\n    for (name in byHash) {\n      byHash[name].pattern.dispose();\n    }\n\n    storage.byHash = {};\n    storage.refToHash = {};\n    storage.nextId = 0;\n  },\n  lockHatching: function lockHatching(color, hatching, ref) {\n    var storage = this._hatchingStorage;\n    var hash = getHatchingHash(color, hatching);\n    var storageItem;\n    var pattern;\n\n    if (storage.refToHash[ref] !== hash) {\n      if (ref) {\n        this.releaseHatching(ref);\n      }\n\n      storageItem = storage.byHash[hash];\n\n      if (!storageItem) {\n        pattern = this.pattern(color, hatching, storage.baseId + \"-hatching-\" + storage.nextId++);\n        storageItem = storage.byHash[hash] = {\n          pattern: pattern,\n          count: 0\n        };\n        storage.refToHash[pattern.id] = hash;\n      }\n\n      ++storageItem.count;\n      ref = storageItem.pattern.id;\n    }\n\n    return ref;\n  },\n  releaseHatching: function releaseHatching(ref) {\n    var storage = this._hatchingStorage;\n    var hash = storage.refToHash[ref];\n    var storageItem = storage.byHash[hash];\n\n    if (storageItem && 0 === --storageItem.count) {\n      storageItem.pattern.dispose();\n      delete storage.byHash[hash];\n      delete storage.refToHash[ref];\n    }\n  }\n};\n\nfunction getHatchingHash(color, hatching) {\n  return \"@\" + color + \"::\" + hatching.step + \":\" + hatching.width + \":\" + hatching.opacity + \":\" + hatching.direction;\n}\n\nvar fixFuncIriCallbacks = function () {\n  var callbacks = [];\n  return {\n    add: function add(fn) {\n      callbacks.push(fn);\n    },\n    remove: function remove(fn) {\n      callbacks = callbacks.filter(function (el) {\n        return el !== fn;\n      });\n    },\n    removeByRenderer: function removeByRenderer(renderer) {\n      callbacks = callbacks.filter(function (el) {\n        return el.renderer !== renderer;\n      });\n    },\n    fire: function fire() {\n      callbacks.forEach(function (fn) {\n        fn();\n      });\n    }\n  };\n}();\n\nexports.refreshPaths = function () {\n  fixFuncIriCallbacks.fire();\n};","map":{"version":3,"sources":["C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/devextreme/viz/core/renderers/renderer.js"],"names":["_renderer","require","_renderer2","_interopRequireDefault","_dom_adapter","_dom_adapter2","_window","_window2","_call_once","_call_once2","_events_engine","_events_engine2","_browser","_browser2","_svg","_animation","_animation2","_utils","_type","obj","_arrayWithHoles","_iterableToArrayLimit","_nonIterableRest","Symbol","Object","_arr","_n","_d","_e","_i","arr","_s","i","Array","window","max","Math","min","floor","round","sin","cos","abs","PI","PI_DIV_180","SHARPING_CORRECTION","ARC_COORD_PREC","pxAddingExceptions","opacity","order","orphans","widows","zoom","KEY_TEXT","KEY_STROKE","KEY_STROKE_WIDTH","KEY_STROKE_OPACITY","KEY_FONT_SIZE","KEY_FONT_STYLE","KEY_FONT_WEIGHT","KEY_TEXT_DECORATION","KEY_TEXTS_ALIGNMENT","NONE","DEFAULT_FONT_SIZE","ELLIPSIS","objectCreate","F","DEFAULTS","scaleX","scaleY","getBackup","backupContainer","backupCounter","root","element","container","getNextDefsSvgId","numDefsSvgElements","value","pathModified","module","target","source","box","left","top","preserveAspectRatioMap","full","lefttop","leftcenter","leftbottom","centertop","center","centerbottom","righttop","rightcenter","rightbottom","attrs","extend","noArc","angleDiff","roundValue","startAngle","endAngle","isCircle","buildArcPath","x","outerR","y","innerR","list","buildLineSegments","buildCurveSegments","buildSegments","points","ii","buildSimpleSegment","k0","k","close","d","segments","segment","j","jj","oldLength","oldSegments","newLength","newSegments","makeEqualSegments","type","originalNewSegments","constSeg","short","prepareConstSegment","long","shortLength","longLength","head","constsSeg1","constsSeg2","elemStyles","that","str","styles","key","wrapper","id","getFuncIri","settings","attributes","elem","renderer","rtl","isObjectArgument","right","recalculateDashStyle","hasTransformations","sw","parseInt","buildPathSegments","combinePathParam","baseAttr","innerRadius","outerRadius","normalizeArcParams","width","height","maxSW","newSW","wasStroked","isResetRequired","alignTextNodes","isStroked","createTextNodes","locateTextNodes","strokeTextNodes","baseCss","node","style","className","line","parentStyle","realStyle","nodes","orderHtmlTree","currentItem","items","item","maxLengthFontSize","parseFloat","findTagAttrs","findStyleAndClassAttrs","p2","p1","div","text","adjustLineHeights","texts","createElement","_styles","hasEllipsis","restoreText","ellipsis","ellipsisWidth","maxWidth","lines","prepareLines","lineParts","setNewText","removeTextSpan","clone","titleElements","options","arguments","textChanged","textIsEmpty","ellipsisMaxWidth","restoreTitleElement","detachAndStoreTitleElements","_that$_getElementBBox","maxHeight","applyOverflowRules","setMaxHeight","t","rowCount","startBox","endBox","kk","commonLength","parts","getIndexForEllipsis","tspan","getTextWidth","initialIndices","spaceIndices","indices","spaceIndex","hideOverflowEllipsis","_ref","getEllipsisString","wholeText","breakIndex","getSpaceBreakIndex","getWordBreakIndex","restLines","isFinite","newTextOffset","restString","restTspan","cloneAndRemoveAttrs","restText","stroke","wordWrap","setEllipsis","getItemLineHeight","textOverflow","Number","result","_ref3","_slicedToArray","commonHeight","calculateLineHeight","l","prevLine","index","textValue","createTspans","_ref5","stop","lineNumber","wordWrapLines","insertString","newText","parsedHtml","removeExtraAttrs","parseHTML","parseMultiline","lineHeight","setTextNodeAttribute","direction","maxTextWidth","textWidth","parsedHeight1","parsedHeight2","height1","height2","isNaN","strokeWidth","strokeOpacity","animationParams","defaults","translateX","translateY","rotate","rotateX","rotateY","params","from","to","curSegments","endSegments","compensateSegments","end","baseAnimate","arcParams","is","name","parameters","after","fixFuncIriCallbacks","exports","SvgElement","constructor","_getJQElement","_addFixIRICallback","fn","fixFuncIri","_clearChildrenFuncIri","clearChildren","removeFuncIriCallback","dispose","append","parent","remove","enableLinks","virtualLink","linkItem","_link","buildLink","linkAfter","linkOn","linkOff","unlinkItem","linkAppend","link","next","_insert","linkRemove","clear","toBackground","toForeground","attr","smartAttr","processHatchingAttrs","css","animate","sharp","pos","sharpDirection","_applyTransformation","tr","transformations","sharpMode","trDirection","strokeOdd","correctionX","correctionY","scaleXDefined","scaleYDefined","move","angle","_getElementBBox","bBox","getBBox","transformation","markup","getOffset","stopAnimation","animation","setTitle","titleElem","data","on","args","off","trigger","PathSvgElement","pathAnimate","ArcSvgElement","arcAnimate","RectSvgElement","rectAttr","TextSvgElement","applyEllipsis","setMaxSize","_getLineHeight","updateIndexes","xmlns","version","fill","cssClass","display","overflow","Renderer","_init","enabled","duration","easing","fixPlacement","getBoundingClientRect","dx","dy","transform","removePlacementFix","setOptions","_createElement","lock","backupRoot","unlock","restoreRoot","resize","animationEnabled","updateAnimationOptions","stopAllAnimations","animateElement","svg","getRootOffset","onEndAnimation","rect","simpleRect","circle","cx","cy","r","g","image","w","h","preserveAspectRatio","href","path","arc","linearGradient","gradient","stops","offset","pattern","hatching","step","stepTo2","stepBy15","_id","patternUnits","color","_getPointsWithYOffset","point","clipShape","clipPath","shape","method","clipRect","clipCircle","shadowFilter","filter","gaussianBlur","stdDeviation","blur","offsetX","offsetY","flood","composite","in2","operator","finalComposite","filterAttrs","offsetAttrs","floodAttrs","brightFilter","componentTransferElement","slope","getGrayScaleFilter","values","initHatching","storage","byHash","baseId","lockHatching","hash","getHatchingHash","storageItem","count","ref","releaseHatching","callbacks","add","el","removeByRenderer","fire"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (viz/core/renderers/renderer.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar _renderer = require(\"../../../core/renderer\");\r\nvar _renderer2 = _interopRequireDefault(_renderer);\r\nvar _dom_adapter = require(\"../../../core/dom_adapter\");\r\nvar _dom_adapter2 = _interopRequireDefault(_dom_adapter);\r\nvar _window = require(\"../../../core/utils/window\");\r\nvar _window2 = _interopRequireDefault(_window);\r\nvar _call_once = require(\"../../../core/utils/call_once\");\r\nvar _call_once2 = _interopRequireDefault(_call_once);\r\nvar _events_engine = require(\"../../../events/core/events_engine\");\r\nvar _events_engine2 = _interopRequireDefault(_events_engine);\r\nvar _browser = require(\"../../../core/utils/browser\");\r\nvar _browser2 = _interopRequireDefault(_browser);\r\nvar _svg = require(\"../../../core/utils/svg\");\r\nvar _animation = require(\"./animation\");\r\nvar _animation2 = _interopRequireDefault(_animation);\r\nvar _utils = require(\"../utils\");\r\nvar _type = require(\"../../../core/utils/type\");\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\n\r\nfunction _slicedToArray(arr, i) {\r\n    return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest()\r\n}\r\n\r\nfunction _nonIterableRest() {\r\n    throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")\r\n}\r\n\r\nfunction _iterableToArrayLimit(arr, i) {\r\n    if (!(Symbol.iterator in Object(arr) || \"[object Arguments]\" === Object.prototype.toString.call(arr))) {\r\n        return\r\n    }\r\n    var _arr = [];\r\n    var _n = true;\r\n    var _d = false;\r\n    var _e = void 0;\r\n    try {\r\n        for (var _s, _i = arr[Symbol.iterator](); !(_n = (_s = _i.next()).done); _n = true) {\r\n            _arr.push(_s.value);\r\n            if (i && _arr.length === i) {\r\n                break\r\n            }\r\n        }\r\n    } catch (err) {\r\n        _d = true;\r\n        _e = err\r\n    } finally {\r\n        try {\r\n            if (!_n && null != _i.return) {\r\n                _i.return()\r\n            }\r\n        } finally {\r\n            if (_d) {\r\n                throw _e\r\n            }\r\n        }\r\n    }\r\n    return _arr\r\n}\r\n\r\nfunction _arrayWithHoles(arr) {\r\n    if (Array.isArray(arr)) {\r\n        return arr\r\n    }\r\n}\r\nvar window = _window2.default.getWindow();\r\nvar max = Math.max,\r\n    min = Math.min,\r\n    floor = Math.floor,\r\n    round = Math.round,\r\n    sin = Math.sin,\r\n    cos = Math.cos,\r\n    abs = Math.abs,\r\n    PI = Math.PI;\r\nvar PI_DIV_180 = PI / 180;\r\nvar SHARPING_CORRECTION = .5;\r\nvar ARC_COORD_PREC = 5;\r\nvar pxAddingExceptions = {\r\n    \"column-count\": true,\r\n    \"fill-opacity\": true,\r\n    \"flex-grow\": true,\r\n    \"flex-shrink\": true,\r\n    \"font-weight\": true,\r\n    \"line-height\": true,\r\n    opacity: true,\r\n    order: true,\r\n    orphans: true,\r\n    widows: true,\r\n    \"z-index\": true,\r\n    zoom: true\r\n};\r\nvar KEY_TEXT = \"text\";\r\nvar KEY_STROKE = \"stroke\";\r\nvar KEY_STROKE_WIDTH = \"stroke-width\";\r\nvar KEY_STROKE_OPACITY = \"stroke-opacity\";\r\nvar KEY_FONT_SIZE = \"font-size\";\r\nvar KEY_FONT_STYLE = \"font-style\";\r\nvar KEY_FONT_WEIGHT = \"font-weight\";\r\nvar KEY_TEXT_DECORATION = \"text-decoration\";\r\nvar KEY_TEXTS_ALIGNMENT = \"textsAlignment\";\r\nvar NONE = \"none\";\r\nvar DEFAULT_FONT_SIZE = 12;\r\nvar ELLIPSIS = \"...\";\r\nvar objectCreate = function() {\r\n    if (!Object.create) {\r\n        return function(proto) {\r\n            var F = function() {};\r\n            F.prototype = proto;\r\n            return new F\r\n        }\r\n    } else {\r\n        return function(proto) {\r\n            return Object.create(proto)\r\n        }\r\n    }\r\n}();\r\nvar DEFAULTS = {\r\n    scaleX: 1,\r\n    scaleY: 1,\r\n    \"pointer-events\": null\r\n};\r\nvar getBackup = (0, _call_once2.default)(function() {\r\n    var backupContainer = _dom_adapter2.default.createElement(\"div\");\r\n    var backupCounter = 0;\r\n    backupContainer.style.left = \"-9999px\";\r\n    backupContainer.style.position = \"absolute\";\r\n    return {\r\n        backupContainer: backupContainer,\r\n        backupCounter: backupCounter\r\n    }\r\n});\r\n\r\nfunction backupRoot(root) {\r\n    if (0 === getBackup().backupCounter) {\r\n        _dom_adapter2.default.getBody().appendChild(getBackup().backupContainer)\r\n    }++getBackup().backupCounter;\r\n    root.append({\r\n        element: getBackup().backupContainer\r\n    })\r\n}\r\n\r\nfunction restoreRoot(root, container) {\r\n    root.append({\r\n        element: container\r\n    });\r\n    --getBackup().backupCounter;\r\n    if (0 === getBackup().backupCounter) {\r\n        _dom_adapter2.default.getBody().removeChild(getBackup().backupContainer)\r\n    }\r\n}\r\nvar getNextDefsSvgId = function() {\r\n    var numDefsSvgElements = 1;\r\n    return function() {\r\n        return \"DevExpress_\" + numDefsSvgElements++\r\n    }\r\n}();\r\n\r\nfunction isObjectArgument(value) {\r\n    return value && \"string\" !== typeof value\r\n}\r\n\r\nfunction createElement(tagName) {\r\n    return _dom_adapter2.default.createElementNS(\"http://www.w3.org/2000/svg\", tagName)\r\n}\r\n\r\nfunction getFuncIri(id, pathModified) {\r\n    return null !== id ? \"url(\" + (pathModified ? window.location.href.split(\"#\")[0] : \"\") + \"#\" + id + \")\" : id\r\n}\r\nmodule.exports.getFuncIri = getFuncIri;\r\n\r\nfunction extend(target, source) {\r\n    var key;\r\n    for (key in source) {\r\n        target[key] = source[key]\r\n    }\r\n    return target\r\n}\r\n\r\nfunction roundValue(value, exp) {\r\n    value = value.toString().split(\"e\");\r\n    value = round(+(value[0] + \"e\" + (value[1] ? +value[1] + exp : exp)));\r\n    value = value.toString().split(\"e\");\r\n    return +(value[0] + \"e\" + (value[1] ? +value[1] - exp : -exp))\r\n}\r\n\r\nfunction getBoundingClientRect(element) {\r\n    var box;\r\n    try {\r\n        box = element.getBoundingClientRect()\r\n    } catch (e) {}\r\n    return box || {\r\n        left: 0,\r\n        top: 0\r\n    }\r\n}\r\nvar preserveAspectRatioMap = {\r\n    full: NONE,\r\n    lefttop: \"xMinYMin\",\r\n    leftcenter: \"xMinYMid\",\r\n    leftbottom: \"xMinYMax\",\r\n    centertop: \"xMidYMin\",\r\n    center: \"xMidYMid\",\r\n    centerbottom: \"xMidYMax\",\r\n    righttop: \"xMaxYMin\",\r\n    rightcenter: \"xMaxYMid\",\r\n    rightbottom: \"xMaxYMax\"\r\n};\r\n\r\nfunction processHatchingAttrs(element, attrs) {\r\n    if (attrs.hatching && \"none\" !== (0, _utils.normalizeEnum)(attrs.hatching.direction)) {\r\n        attrs = extend({}, attrs);\r\n        attrs.fill = element._hatching = element.renderer.lockHatching(attrs.fill, attrs.hatching, element._hatching);\r\n        delete attrs.hatching\r\n    } else {\r\n        if (element._hatching) {\r\n            element.renderer.releaseHatching(element._hatching);\r\n            element._hatching = null\r\n        }\r\n    }\r\n    return attrs\r\n}\r\nmodule.exports.processHatchingAttrs = processHatchingAttrs;\r\n\r\nfunction normalizeArcParams(x, y, innerR, outerR, startAngle, endAngle) {\r\n    var isCircle;\r\n    var noArc = true;\r\n    var angleDiff = roundValue(endAngle, 3) - roundValue(startAngle, 3);\r\n    if (angleDiff) {\r\n        if (abs(angleDiff) % 360 === 0) {\r\n            startAngle = 0;\r\n            endAngle = 360;\r\n            isCircle = true;\r\n            endAngle -= .01\r\n        }\r\n        if (startAngle > 360) {\r\n            startAngle %= 360\r\n        }\r\n        if (endAngle > 360) {\r\n            endAngle %= 360\r\n        }\r\n        if (startAngle > endAngle) {\r\n            startAngle -= 360\r\n        }\r\n        noArc = false\r\n    }\r\n    startAngle *= PI_DIV_180;\r\n    endAngle *= PI_DIV_180;\r\n    return [x, y, min(outerR, innerR), max(outerR, innerR), cos(startAngle), sin(startAngle), cos(endAngle), sin(endAngle), isCircle, floor(abs(endAngle - startAngle) / PI) % 2 ? \"1\" : \"0\", noArc]\r\n}\r\nvar buildArcPath = function(x, y, innerR, outerR, startAngleCos, startAngleSin, endAngleCos, endAngleSin, isCircle, longFlag) {\r\n    return [\"M\", (x + outerR * startAngleCos).toFixed(ARC_COORD_PREC), (y - outerR * startAngleSin).toFixed(ARC_COORD_PREC), \"A\", outerR.toFixed(ARC_COORD_PREC), outerR.toFixed(ARC_COORD_PREC), 0, longFlag, 0, (x + outerR * endAngleCos).toFixed(ARC_COORD_PREC), (y - outerR * endAngleSin).toFixed(ARC_COORD_PREC), isCircle ? \"M\" : \"L\", (x + innerR * endAngleCos).toFixed(5), (y - innerR * endAngleSin).toFixed(ARC_COORD_PREC), \"A\", innerR.toFixed(ARC_COORD_PREC), innerR.toFixed(ARC_COORD_PREC), 0, longFlag, 1, (x + innerR * startAngleCos).toFixed(ARC_COORD_PREC), (y - innerR * startAngleSin).toFixed(ARC_COORD_PREC), \"Z\"].join(\" \")\r\n};\r\n\r\nfunction buildPathSegments(points, type) {\r\n    var list = [\r\n        [\"M\", 0, 0]\r\n    ];\r\n    switch (type) {\r\n        case \"line\":\r\n            list = buildLineSegments(points);\r\n            break;\r\n        case \"area\":\r\n            list = buildLineSegments(points, true);\r\n            break;\r\n        case \"bezier\":\r\n            list = buildCurveSegments(points);\r\n            break;\r\n        case \"bezierarea\":\r\n            list = buildCurveSegments(points, true)\r\n    }\r\n    return list\r\n}\r\n\r\nfunction buildLineSegments(points, close) {\r\n    return buildSegments(points, buildSimpleLineSegment, close)\r\n}\r\n\r\nfunction buildCurveSegments(points, close) {\r\n    return buildSegments(points, buildSimpleCurveSegment, close)\r\n}\r\n\r\nfunction buildSegments(points, buildSimpleSegment, close) {\r\n    var i;\r\n    var ii;\r\n    var list = [];\r\n    if (points[0] && points[0].length) {\r\n        for (i = 0, ii = points.length; i < ii; ++i) {\r\n            buildSimpleSegment(points[i], close, list)\r\n        }\r\n    } else {\r\n        buildSimpleSegment(points, close, list)\r\n    }\r\n    return list\r\n}\r\n\r\nfunction buildSimpleLineSegment(points, close, list) {\r\n    var i = 0;\r\n    var k0 = list.length;\r\n    var k = k0;\r\n    var ii = (points || []).length;\r\n    if (ii) {\r\n        if (void 0 !== points[0].x) {\r\n            for (; i < ii;) {\r\n                list[k++] = [\"L\", points[i].x, points[i++].y]\r\n            }\r\n        } else {\r\n            for (; i < ii;) {\r\n                list[k++] = [\"L\", points[i++], points[i++]]\r\n            }\r\n        }\r\n        list[k0][0] = \"M\"\r\n    } else {\r\n        list[k] = [\"M\", 0, 0]\r\n    }\r\n    close && list.push([\"Z\"]);\r\n    return list\r\n}\r\n\r\nfunction buildSimpleCurveSegment(points, close, list) {\r\n    var i;\r\n    var k = list.length;\r\n    var ii = (points || []).length;\r\n    if (ii) {\r\n        if (void 0 !== points[0].x) {\r\n            list[k++] = [\"M\", points[0].x, points[0].y];\r\n            for (i = 1; i < ii;) {\r\n                list[k++] = [\"C\", points[i].x, points[i++].y, points[i].x, points[i++].y, points[i].x, points[i++].y]\r\n            }\r\n        } else {\r\n            list[k++] = [\"M\", points[0], points[1]];\r\n            for (i = 2; i < ii;) {\r\n                list[k++] = [\"C\", points[i++], points[i++], points[i++], points[i++], points[i++], points[i++]]\r\n            }\r\n        }\r\n    } else {\r\n        list[k] = [\"M\", 0, 0]\r\n    }\r\n    close && list.push([\"Z\"]);\r\n    return list\r\n}\r\n\r\nfunction combinePathParam(segments) {\r\n    var d = [];\r\n    var k = 0;\r\n    var i;\r\n    var ii = segments.length;\r\n    var segment;\r\n    var j;\r\n    var jj;\r\n    for (i = 0; i < ii; ++i) {\r\n        segment = segments[i];\r\n        for (j = 0, jj = segment.length; j < jj; ++j) {\r\n            d[k++] = segment[j]\r\n        }\r\n    }\r\n    return d.join(\" \")\r\n}\r\n\r\nfunction compensateSegments(oldSegments, newSegments, type) {\r\n    var oldLength = oldSegments.length;\r\n    var newLength = newSegments.length;\r\n    var i;\r\n    var originalNewSegments;\r\n    var makeEqualSegments = type.indexOf(\"area\") !== -1 ? makeEqualAreaSegments : makeEqualLineSegments;\r\n    if (0 === oldLength) {\r\n        for (i = 0; i < newLength; i++) {\r\n            oldSegments.push(newSegments[i].slice(0))\r\n        }\r\n    } else {\r\n        if (oldLength < newLength) {\r\n            makeEqualSegments(oldSegments, newSegments, type)\r\n        } else {\r\n            if (oldLength > newLength) {\r\n                originalNewSegments = newSegments.slice(0);\r\n                makeEqualSegments(newSegments, oldSegments, type)\r\n            }\r\n        }\r\n    }\r\n    return originalNewSegments\r\n}\r\n\r\nfunction prepareConstSegment(constSeg, type) {\r\n    var x = constSeg[constSeg.length - 2];\r\n    var y = constSeg[constSeg.length - 1];\r\n    switch (type) {\r\n        case \"line\":\r\n        case \"area\":\r\n            constSeg[0] = \"L\";\r\n            break;\r\n        case \"bezier\":\r\n        case \"bezierarea\":\r\n            constSeg[0] = \"C\";\r\n            constSeg[1] = constSeg[3] = constSeg[5] = x;\r\n            constSeg[2] = constSeg[4] = constSeg[6] = y\r\n    }\r\n}\r\n\r\nfunction makeEqualLineSegments(short, long, type) {\r\n    var constSeg = short[short.length - 1].slice();\r\n    var i = short.length;\r\n    prepareConstSegment(constSeg, type);\r\n    for (; i < long.length; i++) {\r\n        short[i] = constSeg.slice(0)\r\n    }\r\n}\r\n\r\nfunction makeEqualAreaSegments(short, long, type) {\r\n    var i;\r\n    var head;\r\n    var shortLength = short.length;\r\n    var longLength = long.length;\r\n    var constsSeg1;\r\n    var constsSeg2;\r\n    if ((shortLength - 1) % 2 === 0 && (longLength - 1) % 2 === 0) {\r\n        i = (shortLength - 1) / 2 - 1;\r\n        head = short.slice(0, i + 1);\r\n        constsSeg1 = head[head.length - 1].slice(0);\r\n        constsSeg2 = short.slice(i + 1)[0].slice(0);\r\n        prepareConstSegment(constsSeg1, type);\r\n        prepareConstSegment(constsSeg2, type);\r\n        for (var j = i; j < (longLength - 1) / 2 - 1; j++) {\r\n            short.splice(j + 1, 0, constsSeg1);\r\n            short.splice(j + 3, 0, constsSeg2)\r\n        }\r\n    }\r\n}\r\n\r\nfunction baseCss(that, styles) {\r\n    var elemStyles = that._styles;\r\n    var str = \"\";\r\n    var key;\r\n    var value;\r\n    styles = styles || {};\r\n    for (key in styles) {\r\n        value = styles[key];\r\n        if ((0, _type.isDefined)(value)) {\r\n            value += \"number\" === typeof value && !pxAddingExceptions[key] ? \"px\" : \"\";\r\n            elemStyles[key] = \"\" !== value ? value : null\r\n        }\r\n    }\r\n    for (key in elemStyles) {\r\n        value = elemStyles[key];\r\n        if (value) {\r\n            str += key + \":\" + value + \";\"\r\n        }\r\n    }\r\n    str && that.element.setAttribute(\"style\", str);\r\n    return that\r\n}\r\n\r\nfunction fixFuncIri(wrapper, attribute) {\r\n    var element = wrapper.element;\r\n    var id = wrapper.attr(attribute);\r\n    if (id && id.indexOf(\"DevExpress\") !== -1) {\r\n        element.removeAttribute(attribute);\r\n        element.setAttribute(attribute, getFuncIri(id, wrapper.renderer.pathModified))\r\n    }\r\n}\r\n\r\nfunction baseAttr(that, attrs) {\r\n    attrs = attrs || {};\r\n    var settings = that._settings;\r\n    var attributes = {};\r\n    var key;\r\n    var value;\r\n    var elem = that.element;\r\n    var renderer = that.renderer;\r\n    var rtl = renderer.rtl;\r\n    var hasTransformations;\r\n    var recalculateDashStyle;\r\n    var sw;\r\n    var i;\r\n    if (!isObjectArgument(attrs)) {\r\n        if (attrs in settings) {\r\n            return settings[attrs]\r\n        }\r\n        if (attrs in DEFAULTS) {\r\n            return DEFAULTS[attrs]\r\n        }\r\n        return 0\r\n    }\r\n    extend(attributes, attrs);\r\n    for (key in attributes) {\r\n        value = attributes[key];\r\n        if (void 0 === value) {\r\n            continue\r\n        }\r\n        settings[key] = value;\r\n        if (\"align\" === key) {\r\n            key = \"text-anchor\";\r\n            value = {\r\n                left: rtl ? \"end\" : \"start\",\r\n                center: \"middle\",\r\n                right: rtl ? \"start\" : \"end\"\r\n            } [value] || null\r\n        } else {\r\n            if (\"dashStyle\" === key) {\r\n                recalculateDashStyle = true;\r\n                continue\r\n            } else {\r\n                if (key === KEY_STROKE_WIDTH) {\r\n                    recalculateDashStyle = true\r\n                } else {\r\n                    if (value && (\"fill\" === key || \"clip-path\" === key || \"filter\" === key) && 0 === value.indexOf(\"DevExpress\")) {\r\n                        that._addFixIRICallback();\r\n                        value = getFuncIri(value, renderer.pathModified)\r\n                    } else {\r\n                        if (/^(translate(X|Y)|rotate[XY]?|scale(X|Y)|sharp|sharpDirection)$/i.test(key)) {\r\n                            hasTransformations = true;\r\n                            continue\r\n                        } else {\r\n                            if (/^(x|y|d)$/i.test(key)) {\r\n                                hasTransformations = true\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        if (null === value) {\r\n            elem.removeAttribute(key)\r\n        } else {\r\n            elem.setAttribute(key, value)\r\n        }\r\n    }\r\n    if (recalculateDashStyle && \"dashStyle\" in settings) {\r\n        value = settings.dashStyle;\r\n        sw = (\"_originalSW\" in that ? that._originalSW : settings[KEY_STROKE_WIDTH]) || 1;\r\n        key = \"stroke-dasharray\";\r\n        value = null === value ? \"\" : (0, _utils.normalizeEnum)(value);\r\n        if (\"\" === value || \"solid\" === value || value === NONE) {\r\n            that.element.removeAttribute(key)\r\n        } else {\r\n            value = value.replace(/longdash/g, \"8,3,\").replace(/dash/g, \"4,3,\").replace(/dot/g, \"1,3,\").replace(/,$/, \"\").split(\",\");\r\n            i = value.length;\r\n            while (i--) {\r\n                value[i] = parseInt(value[i]) * sw\r\n            }\r\n            that.element.setAttribute(key, value.join(\",\"))\r\n        }\r\n    }\r\n    if (hasTransformations) {\r\n        that._applyTransformation()\r\n    }\r\n    return that\r\n}\r\n\r\nfunction pathAttr(attrs) {\r\n    var that = this;\r\n    var segments;\r\n    if (isObjectArgument(attrs)) {\r\n        attrs = extend({}, attrs);\r\n        segments = attrs.segments;\r\n        if (\"points\" in attrs) {\r\n            segments = buildPathSegments(attrs.points, that.type);\r\n            delete attrs.points\r\n        }\r\n        if (segments) {\r\n            attrs.d = combinePathParam(segments);\r\n            that.segments = segments;\r\n            delete attrs.segments\r\n        }\r\n    }\r\n    return baseAttr(that, attrs)\r\n}\r\n\r\nfunction arcAttr(attrs) {\r\n    var settings = this._settings;\r\n    var x;\r\n    var y;\r\n    var innerRadius;\r\n    var outerRadius;\r\n    var startAngle;\r\n    var endAngle;\r\n    if (isObjectArgument(attrs)) {\r\n        attrs = extend({}, attrs);\r\n        if (\"x\" in attrs || \"y\" in attrs || \"innerRadius\" in attrs || \"outerRadius\" in attrs || \"startAngle\" in attrs || \"endAngle\" in attrs) {\r\n            settings.x = x = \"x\" in attrs ? attrs.x : settings.x;\r\n            delete attrs.x;\r\n            settings.y = y = \"y\" in attrs ? attrs.y : settings.y;\r\n            delete attrs.y;\r\n            settings.innerRadius = innerRadius = \"innerRadius\" in attrs ? attrs.innerRadius : settings.innerRadius;\r\n            delete attrs.innerRadius;\r\n            settings.outerRadius = outerRadius = \"outerRadius\" in attrs ? attrs.outerRadius : settings.outerRadius;\r\n            delete attrs.outerRadius;\r\n            settings.startAngle = startAngle = \"startAngle\" in attrs ? attrs.startAngle : settings.startAngle;\r\n            delete attrs.startAngle;\r\n            settings.endAngle = endAngle = \"endAngle\" in attrs ? attrs.endAngle : settings.endAngle;\r\n            delete attrs.endAngle;\r\n            attrs.d = buildArcPath.apply(null, normalizeArcParams(x, y, innerRadius, outerRadius, startAngle, endAngle))\r\n        }\r\n    }\r\n    return baseAttr(this, attrs)\r\n}\r\n\r\nfunction rectAttr(attrs) {\r\n    var that = this;\r\n    var x;\r\n    var y;\r\n    var width;\r\n    var height;\r\n    var sw;\r\n    var maxSW;\r\n    var newSW;\r\n    if (isObjectArgument(attrs)) {\r\n        attrs = extend({}, attrs);\r\n        if (void 0 !== attrs.x || void 0 !== attrs.y || void 0 !== attrs.width || void 0 !== attrs.height || void 0 !== attrs[KEY_STROKE_WIDTH]) {\r\n            void 0 !== attrs.x ? x = that._originalX = attrs.x : x = that._originalX || 0;\r\n            void 0 !== attrs.y ? y = that._originalY = attrs.y : y = that._originalY || 0;\r\n            void 0 !== attrs.width ? width = that._originalWidth = attrs.width : width = that._originalWidth || 0;\r\n            void 0 !== attrs.height ? height = that._originalHeight = attrs.height : height = that._originalHeight || 0;\r\n            void 0 !== attrs[KEY_STROKE_WIDTH] ? sw = that._originalSW = attrs[KEY_STROKE_WIDTH] : sw = that._originalSW;\r\n            maxSW = ~~((width < height ? width : height) / 2);\r\n            newSW = (sw || 0) < maxSW ? sw || 0 : maxSW;\r\n            attrs.x = x + newSW / 2;\r\n            attrs.y = y + newSW / 2;\r\n            attrs.width = width - newSW;\r\n            attrs.height = height - newSW;\r\n            ((sw || 0) !== newSW || !(0 === newSW && void 0 === sw)) && (attrs[KEY_STROKE_WIDTH] = newSW)\r\n        }\r\n        if (\"sharp\" in attrs) {\r\n            delete attrs.sharp\r\n        }\r\n    }\r\n    return baseAttr(that, attrs)\r\n}\r\n\r\nfunction textAttr(attrs) {\r\n    var that = this;\r\n    var settings;\r\n    var isResetRequired;\r\n    var wasStroked;\r\n    var isStroked;\r\n    if (!isObjectArgument(attrs)) {\r\n        return baseAttr(that, attrs)\r\n    }\r\n    attrs = extend({}, attrs);\r\n    settings = that._settings;\r\n    wasStroked = (0, _type.isDefined)(settings[KEY_STROKE]) && (0, _type.isDefined)(settings[KEY_STROKE_WIDTH]);\r\n    if (void 0 !== attrs[KEY_TEXT]) {\r\n        settings[KEY_TEXT] = attrs[KEY_TEXT];\r\n        delete attrs[KEY_TEXT];\r\n        isResetRequired = true\r\n    }\r\n    if (void 0 !== attrs[KEY_STROKE]) {\r\n        settings[KEY_STROKE] = attrs[KEY_STROKE];\r\n        delete attrs[KEY_STROKE]\r\n    }\r\n    if (void 0 !== attrs[KEY_STROKE_WIDTH]) {\r\n        settings[KEY_STROKE_WIDTH] = attrs[KEY_STROKE_WIDTH];\r\n        delete attrs[KEY_STROKE_WIDTH]\r\n    }\r\n    if (void 0 !== attrs[KEY_STROKE_OPACITY]) {\r\n        settings[KEY_STROKE_OPACITY] = attrs[KEY_STROKE_OPACITY];\r\n        delete attrs[KEY_STROKE_OPACITY]\r\n    }\r\n    if (void 0 !== attrs[KEY_TEXTS_ALIGNMENT]) {\r\n        alignTextNodes(that, attrs[KEY_TEXTS_ALIGNMENT]);\r\n        delete attrs[KEY_TEXTS_ALIGNMENT]\r\n    }\r\n    isStroked = (0, _type.isDefined)(settings[KEY_STROKE]) && (0, _type.isDefined)(settings[KEY_STROKE_WIDTH]);\r\n    baseAttr(that, attrs);\r\n    isResetRequired = isResetRequired || isStroked !== wasStroked && settings[KEY_TEXT];\r\n    if (isResetRequired) {\r\n        createTextNodes(that, settings.text, isStroked);\r\n        that._hasEllipsis = false\r\n    }\r\n    if (isResetRequired || void 0 !== attrs.x || void 0 !== attrs.y) {\r\n        locateTextNodes(that)\r\n    }\r\n    if (isStroked) {\r\n        strokeTextNodes(that)\r\n    }\r\n    return that\r\n}\r\n\r\nfunction textCss(styles) {\r\n    styles = styles || {};\r\n    baseCss(this, styles);\r\n    if (KEY_FONT_SIZE in styles) {\r\n        locateTextNodes(this)\r\n    }\r\n    return this\r\n}\r\n\r\nfunction orderHtmlTree(list, line, node, parentStyle, parentClassName) {\r\n    var style;\r\n    var realStyle;\r\n    var i;\r\n    var ii;\r\n    var nodes;\r\n    if (void 0 !== node.wholeText) {\r\n        list.push({\r\n            value: node.wholeText,\r\n            style: parentStyle,\r\n            className: parentClassName,\r\n            line: line,\r\n            height: parentStyle[KEY_FONT_SIZE] || 0\r\n        })\r\n    } else {\r\n        if (\"BR\" === node.tagName) {\r\n            ++line\r\n        } else {\r\n            if (_dom_adapter2.default.isElementNode(node)) {\r\n                extend(style = {}, parentStyle);\r\n                switch (node.tagName) {\r\n                    case \"B\":\r\n                    case \"STRONG\":\r\n                        style[KEY_FONT_WEIGHT] = \"bold\";\r\n                        break;\r\n                    case \"I\":\r\n                    case \"EM\":\r\n                        style[KEY_FONT_STYLE] = \"italic\";\r\n                        break;\r\n                    case \"U\":\r\n                        style[KEY_TEXT_DECORATION] = \"underline\"\r\n                }\r\n                realStyle = node.style;\r\n                realStyle.color && (style.fill = realStyle.color);\r\n                realStyle.fontSize && (style[KEY_FONT_SIZE] = realStyle.fontSize);\r\n                realStyle.fontStyle && (style[KEY_FONT_STYLE] = realStyle.fontStyle);\r\n                realStyle.fontWeight && (style[KEY_FONT_WEIGHT] = realStyle.fontWeight);\r\n                realStyle.textDecoration && (style[KEY_TEXT_DECORATION] = realStyle.textDecoration);\r\n                for (i = 0, nodes = node.childNodes, ii = nodes.length; i < ii; ++i) {\r\n                    line = orderHtmlTree(list, line, nodes[i], style, node.className || parentClassName)\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return line\r\n}\r\n\r\nfunction adjustLineHeights(items) {\r\n    var i;\r\n    var ii;\r\n    var currentItem = items[0];\r\n    var item;\r\n    for (i = 1, ii = items.length; i < ii; ++i) {\r\n        item = items[i];\r\n        if (item.line === currentItem.line) {\r\n            currentItem.height = maxLengthFontSize(currentItem.height, item.height);\r\n            currentItem.inherits = currentItem.inherits || 0 === parseFloat(item.height);\r\n            item.height = NaN\r\n        } else {\r\n            currentItem = item\r\n        }\r\n    }\r\n}\r\n\r\nfunction removeExtraAttrs(html) {\r\n    var findTagAttrs = /(?:(<[a-z0-9]+\\s*))([\\s\\S]*?)(>|\\/>)/gi;\r\n    var findStyleAndClassAttrs = /(style|class)\\s*=\\s*([\"'])(?:(?!\\2).)*\\2\\s?/gi;\r\n    return html.replace(findTagAttrs, function(allTagAttrs, p1, p2, p3) {\r\n        p2 = (p2 && p2.match(findStyleAndClassAttrs) || []).map(function(str) {\r\n            return str\r\n        }).join(\" \");\r\n        return p1 + p2 + p3\r\n    })\r\n}\r\n\r\nfunction parseHTML(text) {\r\n    var items = [];\r\n    var div = _dom_adapter2.default.createElement(\"div\");\r\n    div.innerHTML = text.replace(/\\r/g, \"\").replace(/\\n/g, \"<br/>\");\r\n    orderHtmlTree(items, 0, div, {}, \"\");\r\n    adjustLineHeights(items);\r\n    return items\r\n}\r\n\r\nfunction parseMultiline(text) {\r\n    var texts = text.replace(/\\r/g, \"\").split(/\\n/g);\r\n    var i = 0;\r\n    var items = [];\r\n    for (; i < texts.length; i++) {\r\n        items.push({\r\n            value: texts[i].trim(),\r\n            height: 0,\r\n            line: i\r\n        })\r\n    }\r\n    return items\r\n}\r\n\r\nfunction createTspans(items, element, fieldName) {\r\n    var i;\r\n    var ii;\r\n    var item;\r\n    for (i = 0, ii = items.length; i < ii; ++i) {\r\n        item = items[i];\r\n        item[fieldName] = createElement(\"tspan\");\r\n        item[fieldName].appendChild(_dom_adapter2.default.createTextNode(item.value));\r\n        item.style && baseCss({\r\n            element: item[fieldName],\r\n            _styles: {}\r\n        }, item.style);\r\n        item.className && item[fieldName].setAttribute(\"class\", item.className);\r\n        element.appendChild(item[fieldName])\r\n    }\r\n}\r\n\r\nfunction restoreText() {\r\n    if (this._hasEllipsis) {\r\n        this.attr({\r\n            text: this._settings.text\r\n        })\r\n    }\r\n}\r\n\r\nfunction applyEllipsis(maxWidth) {\r\n    var that = this;\r\n    var lines;\r\n    var hasEllipsis = false;\r\n    var i;\r\n    var ii;\r\n    var lineParts;\r\n    var j;\r\n    var jj;\r\n    var text;\r\n    var ellipsis;\r\n    var ellipsisWidth;\r\n    restoreText.call(that);\r\n    ellipsis = that.renderer.text(ELLIPSIS).attr(that._styles).append(that.renderer.root);\r\n    ellipsisWidth = ellipsis.getBBox().width;\r\n    if (that._getElementBBox().width > maxWidth) {\r\n        if (maxWidth - ellipsisWidth < 0) {\r\n            maxWidth = 0\r\n        } else {\r\n            maxWidth -= ellipsisWidth\r\n        }\r\n        lines = prepareLines(that.element, that._texts, maxWidth);\r\n        for (i = 0, ii = lines.length; i < ii; ++i) {\r\n            lineParts = lines[i].parts;\r\n            if (1 === lines[i].commonLength) {\r\n                continue\r\n            }\r\n            for (j = 0, jj = lineParts.length; j < jj; ++j) {\r\n                text = lineParts[j];\r\n                if ((0, _type.isDefined)(text.endIndex)) {\r\n                    setNewText(text, text.endIndex);\r\n                    hasEllipsis = true\r\n                } else {\r\n                    if (text.startBox > maxWidth) {\r\n                        removeTextSpan(text)\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    ellipsis.remove();\r\n    that._hasEllipsis = hasEllipsis;\r\n    return hasEllipsis\r\n}\r\n\r\nfunction cloneAndRemoveAttrs(node) {\r\n    var clone;\r\n    if (node) {\r\n        clone = node.cloneNode();\r\n        clone.removeAttribute(\"y\");\r\n        clone.removeAttribute(\"x\")\r\n    }\r\n    return clone || node\r\n}\r\n\r\nfunction detachAndStoreTitleElements(element) {\r\n    var titleElements = _dom_adapter2.default.querySelectorAll(element, \"title\");\r\n    for (var i = 0; i < titleElements.length; i++) {\r\n        element.removeChild(titleElements[i])\r\n    }\r\n    return function() {\r\n        for (var _i = 0; _i < titleElements.length; _i++) {\r\n            element.appendChild(titleElements[_i])\r\n        }\r\n    }\r\n}\r\n\r\nfunction setMaxSize(maxWidth, maxHeight) {\r\n    var options = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {};\r\n    var that = this;\r\n    var lines = [];\r\n    var textChanged = false;\r\n    var textIsEmpty = false;\r\n    var ellipsis;\r\n    var ellipsisWidth;\r\n    var ellipsisMaxWidth = maxWidth;\r\n    restoreText.call(that);\r\n    var restoreTitleElement = detachAndStoreTitleElements(this.element);\r\n    ellipsis = that.renderer.text(ELLIPSIS).attr(that._styles).append(that.renderer.root);\r\n    ellipsisWidth = ellipsis.getBBox().width;\r\n    var _that$_getElementBBox = that._getElementBBox(),\r\n        width = _that$_getElementBBox.width,\r\n        height = _that$_getElementBBox.height;\r\n    if ((width || height) && (width > maxWidth || maxHeight && height > maxHeight)) {\r\n        if (maxWidth - ellipsisWidth < 0) {\r\n            ellipsisMaxWidth = 0\r\n        } else {\r\n            ellipsisMaxWidth -= ellipsisWidth\r\n        }\r\n        lines = applyOverflowRules(that.element, that._texts, maxWidth, ellipsisMaxWidth, options, maxHeight);\r\n        lines = setMaxHeight(lines, ellipsisMaxWidth, options, maxHeight, parseFloat(this._getLineHeight()));\r\n        this._texts = lines.reduce(function(texts, line) {\r\n            return texts.concat(line.parts)\r\n        }, []).filter(function(t) {\r\n            return \"\" !== t.value\r\n        }).map(function(t) {\r\n            t.stroke && t.tspan.parentNode.appendChild(t.stroke);\r\n            return t\r\n        }).map(function(t) {\r\n            t.tspan.parentNode.appendChild(t.tspan);\r\n            return t\r\n        });\r\n        !this._texts.length && (this._texts = null);\r\n        textChanged = true;\r\n        if (this._texts) {\r\n            locateTextNodes(this)\r\n        } else {\r\n            this.element.textContent = \"\";\r\n            textIsEmpty = true\r\n        }\r\n    }\r\n    ellipsis.remove();\r\n    that._hasEllipsis = textChanged;\r\n    restoreTitleElement();\r\n    return {\r\n        rowCount: lines.length,\r\n        textChanged: textChanged,\r\n        textIsEmpty: textIsEmpty\r\n    }\r\n}\r\n\r\nfunction getIndexForEllipsis(text, maxWidth, startBox, endBox) {\r\n    var k;\r\n    var kk;\r\n    if (startBox <= maxWidth && endBox > maxWidth) {\r\n        for (k = 1, kk = text.value.length; k <= kk; ++k) {\r\n            if (startBox + text.tspan.getSubStringLength(0, k) > maxWidth) {\r\n                return k - 1\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nfunction getTextWidth(text) {\r\n    return text.value.length ? text.tspan.getSubStringLength(0, text.value.length) : 0\r\n}\r\n\r\nfunction prepareLines(element, texts, maxWidth) {\r\n    var lines = [];\r\n    var i;\r\n    var ii;\r\n    var text;\r\n    var startBox;\r\n    var endBox;\r\n    if (texts) {\r\n        for (i = 0, ii = texts.length; i < ii; ++i) {\r\n            text = texts[i];\r\n            if (!lines[text.line]) {\r\n                text.startBox = startBox = 0;\r\n                lines.push({\r\n                    commonLength: text.value.length,\r\n                    parts: [text]\r\n                })\r\n            } else {\r\n                text.startBox = startBox;\r\n                lines[text.line].parts.push(text);\r\n                lines[text.line].commonLength += text.value.length\r\n            }\r\n            endBox = startBox + text.tspan.getSubStringLength(0, text.value.length);\r\n            text.endIndex = getIndexForEllipsis(text, maxWidth, startBox, endBox);\r\n            startBox = endBox\r\n        }\r\n    } else {\r\n        text = {\r\n            value: element.textContent,\r\n            tspan: element\r\n        };\r\n        text.startBox = startBox = 0;\r\n        endBox = startBox + getTextWidth(text);\r\n        text.endIndex = getIndexForEllipsis(text, maxWidth, startBox, endBox);\r\n        lines = [{\r\n            commonLength: element.textContent.length,\r\n            parts: [text]\r\n        }]\r\n    }\r\n    return lines\r\n}\r\n\r\nfunction getSpaceBreakIndex(text, maxWidth) {\r\n    var initialIndices = text.startBox > 0 ? [0] : [];\r\n    var spaceIndices = text.value.split(\"\").reduce(function(indices, char, index) {\r\n        if (\" \" === char) {\r\n            indices.push(index)\r\n        }\r\n        return indices\r\n    }, initialIndices);\r\n    var spaceIndex = 0;\r\n    while (void 0 !== spaceIndices[spaceIndex + 1] && text.startBox + text.tspan.getSubStringLength(0, spaceIndices[spaceIndex + 1]) < maxWidth) {\r\n        spaceIndex++\r\n    }\r\n    return spaceIndices[spaceIndex]\r\n}\r\n\r\nfunction getWordBreakIndex(text, maxWidth) {\r\n    for (var i = 0; i < text.value.length - 1; i++) {\r\n        if (text.startBox + text.tspan.getSubStringLength(0, i + 1) > maxWidth) {\r\n            return i\r\n        }\r\n    }\r\n}\r\n\r\nfunction getEllipsisString(ellipsisMaxWidth, _ref) {\r\n    var hideOverflowEllipsis = _ref.hideOverflowEllipsis;\r\n    return hideOverflowEllipsis && 0 === ellipsisMaxWidth ? \"\" : ELLIPSIS\r\n}\r\n\r\nfunction setEllipsis(text, ellipsisMaxWidth, options) {\r\n    var ellipsis = getEllipsisString(ellipsisMaxWidth, options);\r\n    if (text.value.length && text.tspan.parentNode) {\r\n        for (var i = text.value.length - 1; i >= 1; i--) {\r\n            if (text.startBox + text.tspan.getSubStringLength(0, i) < ellipsisMaxWidth) {\r\n                setNewText(text, i, ellipsis);\r\n                break\r\n            } else {\r\n                if (1 === i) {\r\n                    setNewText(text, 0, ellipsis)\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nfunction wordWrap(text, maxWidth, ellipsisMaxWidth, options) {\r\n    var wholeText = text.value;\r\n    var breakIndex;\r\n    if (\"none\" !== options.wordWrap) {\r\n        breakIndex = \"normal\" === options.wordWrap ? getSpaceBreakIndex(text, maxWidth) : getWordBreakIndex(text, maxWidth)\r\n    }\r\n    var restLines = [];\r\n    var restText;\r\n    if (isFinite(breakIndex)) {\r\n        setNewText(text, breakIndex, \"\");\r\n        var newTextOffset = \" \" === wholeText[breakIndex] ? 1 : 0;\r\n        var restString = wholeText.slice(breakIndex + newTextOffset);\r\n        if (restString.length) {\r\n            var restTspan = cloneAndRemoveAttrs(text.tspan);\r\n            restTspan.textContent = restString;\r\n            text.tspan.parentNode.appendChild(restTspan);\r\n            restText = extend(extend({}, text), {\r\n                value: restString,\r\n                startBox: 0,\r\n                height: 0,\r\n                tspan: restTspan,\r\n                stroke: cloneAndRemoveAttrs(text.stroke),\r\n                endBox: restTspan.getSubStringLength(0, restString.length)\r\n            });\r\n            restText.stroke && (restText.stroke.textContent = restString);\r\n            if (restText.endBox > maxWidth) {\r\n                restLines = wordWrap(restText, maxWidth, ellipsisMaxWidth, options);\r\n                if (!restLines.length) {\r\n                    return []\r\n                }\r\n            }\r\n        }\r\n    }\r\n    if (text.value.length) {\r\n        if (\"ellipsis\" === options.textOverflow && text.tspan.getSubStringLength(0, text.value.length) > maxWidth) {\r\n            setEllipsis(text, ellipsisMaxWidth, options)\r\n        }\r\n        if (\"hide\" === options.textOverflow && text.tspan.getSubStringLength(0, text.value.length) > maxWidth) {\r\n            return []\r\n        }\r\n    } else {\r\n        text.tspan.parentNode.removeChild(text.tspan)\r\n    }\r\n    var parts = [];\r\n    if (restText) {\r\n        parts.push(restText)\r\n    }\r\n    return [{\r\n        commonLength: wholeText.length,\r\n        parts: parts\r\n    }].concat(restLines)\r\n}\r\n\r\nfunction calculateLineHeight(line, lineHeight) {\r\n    return line.parts.reduce(function(height, text) {\r\n        return max(height, getItemLineHeight(text, lineHeight))\r\n    }, 0)\r\n}\r\n\r\nfunction setMaxHeight(lines, ellipsisMaxWidth, options, maxHeight, lineHeight) {\r\n    var textOverflow = options.textOverflow;\r\n    if (!isFinite(maxHeight) || 0 === Number(maxHeight) || \"none\" === textOverflow) {\r\n        return lines\r\n    }\r\n    var result = lines.reduce(function(_ref2, l, index, arr) {\r\n        var _ref3 = _slicedToArray(_ref2, 2),\r\n            lines = _ref3[0],\r\n            commonHeight = _ref3[1];\r\n        var height = calculateLineHeight(l, lineHeight);\r\n        commonHeight += height;\r\n        if (commonHeight < maxHeight) {\r\n            lines.push(l)\r\n        } else {\r\n            l.parts.forEach(function(item) {\r\n                removeTextSpan(item)\r\n            });\r\n            if (\"ellipsis\" === textOverflow) {\r\n                var prevLine = arr[index - 1];\r\n                if (prevLine) {\r\n                    var text = prevLine.parts[prevLine.parts.length - 1];\r\n                    if (!text.hasEllipsis) {\r\n                        if (0 === ellipsisMaxWidth || text.endBox < ellipsisMaxWidth) {\r\n                            setNewText(text, text.value.length, getEllipsisString(ellipsisMaxWidth, options))\r\n                        } else {\r\n                            setEllipsis(text, ellipsisMaxWidth, options)\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return [lines, commonHeight]\r\n    }, [\r\n        [], 0\r\n    ]);\r\n    if (\"hide\" === textOverflow && result[1] > maxHeight) {\r\n        result[0].forEach(function(l) {\r\n            l.parts.forEach(function(item) {\r\n                removeTextSpan(item)\r\n            })\r\n        });\r\n        return []\r\n    }\r\n    return result[0]\r\n}\r\n\r\nfunction applyOverflowRules(element, texts, maxWidth, ellipsisMaxWidth, options) {\r\n    if (!texts) {\r\n        var textValue = element.textContent;\r\n        var text = {\r\n            value: textValue,\r\n            height: 0,\r\n            line: 0\r\n        };\r\n        element.textContent = \"\";\r\n        createTspans([text], element, \"tspan\");\r\n        texts = [text]\r\n    }\r\n    return texts.reduce(function(_ref4, text) {\r\n        var _ref5 = _slicedToArray(_ref4, 5),\r\n            lines = _ref5[0],\r\n            startBox = _ref5[1],\r\n            endBox = _ref5[2],\r\n            stop = _ref5[3],\r\n            lineNumber = _ref5[4];\r\n        var line = lines[lines.length - 1];\r\n        if (stop) {\r\n            return [lines, startBox, endBox, stop]\r\n        }\r\n        if (!line || text.line !== lineNumber) {\r\n            text.startBox = startBox = 0;\r\n            lines.push({\r\n                commonLength: text.value.length,\r\n                parts: [text]\r\n            })\r\n        } else {\r\n            text.startBox = startBox;\r\n            if (startBox > ellipsisMaxWidth && \"none\" === options.wordWrap && \"ellipsis\" === options.textOverflow) {\r\n                removeTextSpan(text);\r\n                return [lines, startBox, endBox, stop, lineNumber]\r\n            }\r\n            line.parts.push(text);\r\n            line.commonLength += text.value.length\r\n        }\r\n        text.endBox = endBox = startBox + getTextWidth(text);\r\n        startBox = endBox;\r\n        if ((0, _type.isDefined)(maxWidth) && endBox > maxWidth) {\r\n            var wordWrapLines = wordWrap(text, maxWidth, ellipsisMaxWidth, options);\r\n            if (!wordWrapLines.length) {\r\n                lines = [];\r\n                stop = true\r\n            } else {\r\n                lines = lines.concat(wordWrapLines.filter(function(l) {\r\n                    return l.parts.length > 0\r\n                }))\r\n            }\r\n        }\r\n        return [lines, startBox, endBox, stop, text.line]\r\n    }, [\r\n        [], 0, 0, false, 0\r\n    ])[0]\r\n}\r\n\r\nfunction setNewText(text, index) {\r\n    var insertString = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : ELLIPSIS;\r\n    var newText = text.value.substr(0, index) + insertString;\r\n    text.value = text.tspan.textContent = newText;\r\n    text.stroke && (text.stroke.textContent = newText);\r\n    if (insertString === ELLIPSIS) {\r\n        text.hasEllipsis = true\r\n    }\r\n}\r\n\r\nfunction removeTextSpan(text) {\r\n    text.tspan.parentNode && text.tspan.parentNode.removeChild(text.tspan);\r\n    text.stroke && text.stroke.parentNode && text.stroke.parentNode.removeChild(text.stroke)\r\n}\r\n\r\nfunction createTextNodes(wrapper, text, isStroked) {\r\n    var items;\r\n    var parsedHtml;\r\n    wrapper._texts = null;\r\n    wrapper.clear();\r\n    if (null === text) {\r\n        return\r\n    }\r\n    text = \"\" + text;\r\n    if (!wrapper.renderer.encodeHtml && (/<[a-z][\\s\\S]*>/i.test(text) || text.indexOf(\"&\") !== -1)) {\r\n        parsedHtml = removeExtraAttrs(text);\r\n        items = parseHTML(parsedHtml)\r\n    } else {\r\n        if (/\\n/g.test(text)) {\r\n            items = parseMultiline(text)\r\n        } else {\r\n            if (isStroked) {\r\n                items = [{\r\n                    value: text.trim(),\r\n                    height: 0\r\n                }]\r\n            }\r\n        }\r\n    }\r\n    if (items) {\r\n        if (items.length) {\r\n            wrapper._texts = items;\r\n            if (isStroked) {\r\n                createTspans(items, wrapper.element, KEY_STROKE)\r\n            }\r\n            createTspans(items, wrapper.element, \"tspan\")\r\n        }\r\n    } else {\r\n        wrapper.element.appendChild(_dom_adapter2.default.createTextNode(text))\r\n    }\r\n}\r\n\r\nfunction setTextNodeAttribute(item, name, value) {\r\n    item.tspan.setAttribute(name, value);\r\n    item.stroke && item.stroke.setAttribute(name, value)\r\n}\r\n\r\nfunction getItemLineHeight(item, defaultValue) {\r\n    return item.inherits ? maxLengthFontSize(item.height, defaultValue) : item.height || defaultValue\r\n}\r\n\r\nfunction locateTextNodes(wrapper) {\r\n    if (!wrapper._texts) {\r\n        return\r\n    }\r\n    var items = wrapper._texts;\r\n    var x = wrapper._settings.x;\r\n    var lineHeight = wrapper._getLineHeight();\r\n    var i;\r\n    var ii;\r\n    var item = items[0];\r\n    setTextNodeAttribute(item, \"x\", x);\r\n    setTextNodeAttribute(item, \"y\", wrapper._settings.y);\r\n    for (i = 1, ii = items.length; i < ii; ++i) {\r\n        item = items[i];\r\n        if (parseFloat(item.height) >= 0) {\r\n            setTextNodeAttribute(item, \"x\", x);\r\n            var height = getItemLineHeight(item, lineHeight);\r\n            setTextNodeAttribute(item, \"dy\", height)\r\n        }\r\n    }\r\n}\r\n\r\nfunction alignTextNodes(wrapper, alignment) {\r\n    if (!wrapper._texts || \"center\" === alignment) {\r\n        return\r\n    }\r\n    var items = wrapper._texts;\r\n    var direction = \"left\" === alignment ? -1 : 1;\r\n    var maxTextWidth = Math.max.apply(Math, items.map(function(t) {\r\n        return getTextWidth(t)\r\n    }));\r\n    for (var i = 0; i < items.length; i++) {\r\n        var item = items[i];\r\n        var textWidth = getTextWidth(item);\r\n        if (0 !== maxTextWidth && maxTextWidth !== textWidth) {\r\n            setTextNodeAttribute(item, \"dx\", direction * round((maxTextWidth - textWidth) / 2 * 10) / 10)\r\n        }\r\n    }\r\n}\r\n\r\nfunction maxLengthFontSize(fontSize1, fontSize2) {\r\n    var parsedHeight1 = parseFloat(fontSize1);\r\n    var parsedHeight2 = parseFloat(fontSize2);\r\n    var height1 = parsedHeight1 || DEFAULT_FONT_SIZE;\r\n    var height2 = parsedHeight2 || DEFAULT_FONT_SIZE;\r\n    return height1 > height2 ? !isNaN(parsedHeight1) ? fontSize1 : height1 : !isNaN(parsedHeight2) ? fontSize2 : height2\r\n}\r\n\r\nfunction strokeTextNodes(wrapper) {\r\n    if (!wrapper._texts) {\r\n        return\r\n    }\r\n    var items = wrapper._texts;\r\n    var stroke = wrapper._settings[KEY_STROKE];\r\n    var strokeWidth = wrapper._settings[KEY_STROKE_WIDTH];\r\n    var strokeOpacity = wrapper._settings[KEY_STROKE_OPACITY] || 1;\r\n    var tspan;\r\n    var i;\r\n    var ii;\r\n    for (i = 0, ii = items.length; i < ii; ++i) {\r\n        tspan = items[i].stroke;\r\n        tspan.setAttribute(KEY_STROKE, stroke);\r\n        tspan.setAttribute(KEY_STROKE_WIDTH, strokeWidth);\r\n        tspan.setAttribute(KEY_STROKE_OPACITY, strokeOpacity);\r\n        tspan.setAttribute(\"stroke-linejoin\", \"round\")\r\n    }\r\n}\r\n\r\nfunction baseAnimate(that, params, options, complete) {\r\n    options = options || {};\r\n    var key;\r\n    var value;\r\n    var renderer = that.renderer;\r\n    var settings = that._settings;\r\n    var animationParams = {};\r\n    var defaults = {\r\n        translateX: 0,\r\n        translateY: 0,\r\n        scaleX: 1,\r\n        scaleY: 1,\r\n        rotate: 0,\r\n        rotateX: 0,\r\n        rotateY: 0\r\n    };\r\n    if (complete) {\r\n        options.complete = complete\r\n    }\r\n    if (renderer.animationEnabled()) {\r\n        for (key in params) {\r\n            value = params[key];\r\n            if (/^(translate(X|Y)|rotate[XY]?|scale(X|Y))$/i.test(key)) {\r\n                animationParams.transform = animationParams.transform || {\r\n                    from: {},\r\n                    to: {}\r\n                };\r\n                animationParams.transform.from[key] = key in settings ? Number(settings[key].toFixed(3)) : defaults[key];\r\n                animationParams.transform.to[key] = value\r\n            } else {\r\n                if (\"arc\" === key || \"segments\" === key) {\r\n                    animationParams[key] = value\r\n                } else {\r\n                    animationParams[key] = {\r\n                        from: key in settings ? settings[key] : parseFloat(that.element.getAttribute(key) || 0),\r\n                        to: value\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        renderer.animateElement(that, animationParams, extend(extend({}, renderer._animation), options))\r\n    } else {\r\n        options.step && options.step.call(that, 1, 1);\r\n        options.complete && options.complete.call(that);\r\n        that.attr(params)\r\n    }\r\n    return that\r\n}\r\n\r\nfunction pathAnimate(params, options, complete) {\r\n    var that = this;\r\n    var curSegments = that.segments || [];\r\n    var newSegments;\r\n    var endSegments;\r\n    if (that.renderer.animationEnabled() && \"points\" in params) {\r\n        newSegments = buildPathSegments(params.points, that.type);\r\n        endSegments = compensateSegments(curSegments, newSegments, that.type);\r\n        params.segments = {\r\n            from: curSegments,\r\n            to: newSegments,\r\n            end: endSegments\r\n        };\r\n        delete params.points\r\n    }\r\n    return baseAnimate(that, params, options, complete)\r\n}\r\n\r\nfunction arcAnimate(params, options, complete) {\r\n    var that = this;\r\n    var settings = that._settings;\r\n    var arcParams = {\r\n        from: {},\r\n        to: {}\r\n    };\r\n    if (that.renderer.animationEnabled() && (\"x\" in params || \"y\" in params || \"innerRadius\" in params || \"outerRadius\" in params || \"startAngle\" in params || \"endAngle\" in params)) {\r\n        arcParams.from.x = settings.x || 0;\r\n        arcParams.from.y = settings.y || 0;\r\n        arcParams.from.innerRadius = settings.innerRadius || 0;\r\n        arcParams.from.outerRadius = settings.outerRadius || 0;\r\n        arcParams.from.startAngle = settings.startAngle || 0;\r\n        arcParams.from.endAngle = settings.endAngle || 0;\r\n        arcParams.to.x = \"x\" in params ? params.x : settings.x;\r\n        delete params.x;\r\n        arcParams.to.y = \"y\" in params ? params.y : settings.y;\r\n        delete params.y;\r\n        arcParams.to.innerRadius = \"innerRadius\" in params ? params.innerRadius : settings.innerRadius;\r\n        delete params.innerRadius;\r\n        arcParams.to.outerRadius = \"outerRadius\" in params ? params.outerRadius : settings.outerRadius;\r\n        delete params.outerRadius;\r\n        arcParams.to.startAngle = \"startAngle\" in params ? params.startAngle : settings.startAngle;\r\n        delete params.startAngle;\r\n        arcParams.to.endAngle = \"endAngle\" in params ? params.endAngle : settings.endAngle;\r\n        delete params.endAngle;\r\n        params.arc = arcParams\r\n    }\r\n    return baseAnimate(that, params, options, complete)\r\n}\r\n\r\nfunction buildLink(target, parameters) {\r\n    var obj = {\r\n        is: false,\r\n        name: parameters.name || parameters,\r\n        after: parameters.after\r\n    };\r\n    if (target) {\r\n        obj.to = target\r\n    } else {\r\n        obj.virtual = true\r\n    }\r\n    return obj\r\n}\r\n\r\nfunction SvgElement(renderer, tagName, type) {\r\n    var that = this;\r\n    that.renderer = renderer;\r\n    that.element = createElement(tagName);\r\n    that._settings = {};\r\n    that._styles = {};\r\n    if (\"path\" === tagName) {\r\n        that.type = type || \"line\"\r\n    }\r\n}\r\n\r\nfunction removeFuncIriCallback(callback) {\r\n    fixFuncIriCallbacks.remove(callback)\r\n}\r\nexports.SvgElement = SvgElement;\r\nSvgElement.prototype = {\r\n    constructor: SvgElement,\r\n    _getJQElement: function() {\r\n        return this._$element || (this._$element = (0, _renderer2.default)(this.element))\r\n    },\r\n    _addFixIRICallback: function() {\r\n        var that = this;\r\n        var fn = function() {\r\n            fixFuncIri(that, \"fill\");\r\n            fixFuncIri(that, \"clip-path\");\r\n            fixFuncIri(that, \"filter\")\r\n        };\r\n        that.element._fixFuncIri = fn;\r\n        fn.renderer = that.renderer;\r\n        fixFuncIriCallbacks.add(fn);\r\n        that._addFixIRICallback = function() {}\r\n    },\r\n    _clearChildrenFuncIri: function() {\r\n        var clearChildren = function clearChildren(element) {\r\n            var i;\r\n            for (i = 0; i < element.childNodes.length; i++) {\r\n                removeFuncIriCallback(element.childNodes[i]._fixFuncIri);\r\n                clearChildren(element.childNodes[i])\r\n            }\r\n        };\r\n        clearChildren(this.element)\r\n    },\r\n    dispose: function() {\r\n        removeFuncIriCallback(this.element._fixFuncIri);\r\n        this._clearChildrenFuncIri();\r\n        this._getJQElement().remove();\r\n        return this\r\n    },\r\n    append: function(parent) {\r\n        (parent || this.renderer.root).element.appendChild(this.element);\r\n        return this\r\n    },\r\n    remove: function() {\r\n        var element = this.element;\r\n        element.parentNode && element.parentNode.removeChild(element);\r\n        return this\r\n    },\r\n    enableLinks: function() {\r\n        this._links = [];\r\n        return this\r\n    },\r\n    virtualLink: function(parameters) {\r\n        linkItem({\r\n            _link: buildLink(null, parameters)\r\n        }, this);\r\n        return this\r\n    },\r\n    linkAfter: function(name) {\r\n        this._linkAfter = name;\r\n        return this\r\n    },\r\n    linkOn: function(target, parameters) {\r\n        this._link = buildLink(target, parameters);\r\n        linkItem(this, target);\r\n        return this\r\n    },\r\n    linkOff: function() {\r\n        unlinkItem(this);\r\n        this._link = null;\r\n        return this\r\n    },\r\n    linkAppend: function() {\r\n        var link = this._link;\r\n        var items = link.to._links;\r\n        var i;\r\n        var next;\r\n        for (i = link.i + 1;\r\n            (next = items[i]) && !next._link.is; ++i) {}\r\n        this._insert(link.to, next);\r\n        link.is = true;\r\n        return this\r\n    },\r\n    _insert: function(parent, next) {\r\n        parent.element.insertBefore(this.element, next ? next.element : null)\r\n    },\r\n    linkRemove: function() {\r\n        this.remove();\r\n        this._link.is = false;\r\n        return this\r\n    },\r\n    clear: function() {\r\n        this._clearChildrenFuncIri();\r\n        this._getJQElement().empty();\r\n        return this\r\n    },\r\n    toBackground: function() {\r\n        var elem = this.element;\r\n        var parent = elem.parentNode;\r\n        parent && parent.insertBefore(elem, parent.firstChild);\r\n        return this\r\n    },\r\n    toForeground: function() {\r\n        var elem = this.element;\r\n        var parent = elem.parentNode;\r\n        parent && parent.appendChild(elem);\r\n        return this\r\n    },\r\n    attr: function(attrs) {\r\n        return baseAttr(this, attrs)\r\n    },\r\n    smartAttr: function(attrs) {\r\n        return this.attr(processHatchingAttrs(this, attrs))\r\n    },\r\n    css: function(styles) {\r\n        return baseCss(this, styles)\r\n    },\r\n    animate: function(params, options, complete) {\r\n        return baseAnimate(this, params, options, complete)\r\n    },\r\n    sharp: function(pos, sharpDirection) {\r\n        return this.attr({\r\n            sharp: pos || true,\r\n            sharpDirection: sharpDirection\r\n        })\r\n    },\r\n    _applyTransformation: function() {\r\n        var tr = this._settings;\r\n        var scaleXDefined;\r\n        var scaleYDefined;\r\n        var rotateX;\r\n        var rotateY;\r\n        var transformations = [];\r\n        var sharpMode = tr.sharp;\r\n        var trDirection = tr.sharpDirection || 1;\r\n        var strokeOdd = tr[KEY_STROKE_WIDTH] % 2;\r\n        var correctionX = strokeOdd && (\"h\" === sharpMode || true === sharpMode) ? SHARPING_CORRECTION * trDirection : 0;\r\n        var correctionY = strokeOdd && (\"v\" === sharpMode || true === sharpMode) ? SHARPING_CORRECTION * trDirection : 0;\r\n        transformations.push(\"translate(\" + ((tr.translateX || 0) + correctionX) + \",\" + ((tr.translateY || 0) + correctionY) + \")\");\r\n        if (tr.rotate) {\r\n            if (\"rotateX\" in tr) {\r\n                rotateX = tr.rotateX\r\n            } else {\r\n                rotateX = tr.x\r\n            }\r\n            if (\"rotateY\" in tr) {\r\n                rotateY = tr.rotateY\r\n            } else {\r\n                rotateY = tr.y\r\n            }\r\n            transformations.push(\"rotate(\" + tr.rotate + \",\" + (rotateX || 0) + \",\" + (rotateY || 0) + \")\")\r\n        }\r\n        scaleXDefined = (0, _type.isDefined)(tr.scaleX);\r\n        scaleYDefined = (0, _type.isDefined)(tr.scaleY);\r\n        if (scaleXDefined || scaleYDefined) {\r\n            transformations.push(\"scale(\" + (scaleXDefined ? tr.scaleX : 1) + \",\" + (scaleYDefined ? tr.scaleY : 1) + \")\")\r\n        }\r\n        if (transformations.length) {\r\n            this.element.setAttribute(\"transform\", transformations.join(\" \"))\r\n        }\r\n    },\r\n    move: function(x, y, animate, animOptions) {\r\n        var obj = {};\r\n        (0, _type.isDefined)(x) && (obj.translateX = x);\r\n        (0, _type.isDefined)(y) && (obj.translateY = y);\r\n        if (!animate) {\r\n            this.attr(obj)\r\n        } else {\r\n            this.animate(obj, animOptions)\r\n        }\r\n        return this\r\n    },\r\n    rotate: function(angle, x, y, animate, animOptions) {\r\n        var obj = {\r\n            rotate: angle || 0\r\n        };\r\n        (0, _type.isDefined)(x) && (obj.rotateX = x);\r\n        (0, _type.isDefined)(y) && (obj.rotateY = y);\r\n        if (!animate) {\r\n            this.attr(obj)\r\n        } else {\r\n            this.animate(obj, animOptions)\r\n        }\r\n        return this\r\n    },\r\n    _getElementBBox: function() {\r\n        var elem = this.element;\r\n        var bBox;\r\n        try {\r\n            bBox = elem.getBBox && elem.getBBox()\r\n        } catch (e) {}\r\n        return bBox || {\r\n            x: 0,\r\n            y: 0,\r\n            width: elem.offsetWidth || 0,\r\n            height: elem.offsetHeight || 0\r\n        }\r\n    },\r\n    getBBox: function() {\r\n        var transformation = this._settings;\r\n        var bBox = this._getElementBBox();\r\n        if (transformation.rotate) {\r\n            bBox = (0, _utils.rotateBBox)(bBox, [(\"rotateX\" in transformation ? transformation.rotateX : transformation.x) || 0, (\"rotateY\" in transformation ? transformation.rotateY : transformation.y) || 0], -transformation.rotate)\r\n        } else {\r\n            bBox = (0, _utils.normalizeBBox)(bBox)\r\n        }\r\n        return bBox\r\n    },\r\n    markup: function() {\r\n        return (0, _svg.getSvgMarkup)(this.element)\r\n    },\r\n    getOffset: function() {\r\n        return this._getJQElement().offset()\r\n    },\r\n    stopAnimation: function(disableComplete) {\r\n        var animation = this.animation;\r\n        animation && animation.stop(disableComplete);\r\n        return this\r\n    },\r\n    setTitle: function(text) {\r\n        var titleElem = createElement(\"title\");\r\n        titleElem.textContent = text || \"\";\r\n        this.element.appendChild(titleElem)\r\n    },\r\n    data: function(obj, val) {\r\n        var elem = this.element;\r\n        var key;\r\n        if (void 0 !== val) {\r\n            elem[obj] = val\r\n        } else {\r\n            for (key in obj) {\r\n                elem[key] = obj[key]\r\n            }\r\n        }\r\n        return this\r\n    },\r\n    on: function() {\r\n        var args = [this._getJQElement()];\r\n        args.push.apply(args, arguments);\r\n        _events_engine2.default.on.apply(_events_engine2.default, args);\r\n        return this\r\n    },\r\n    off: function() {\r\n        var args = [this._getJQElement()];\r\n        args.push.apply(args, arguments);\r\n        _events_engine2.default.off.apply(_events_engine2.default, args);\r\n        return this\r\n    },\r\n    trigger: function() {\r\n        var args = [this._getJQElement()];\r\n        args.push.apply(args, arguments);\r\n        _events_engine2.default.trigger.apply(_events_engine2.default, args);\r\n        return this\r\n    }\r\n};\r\n\r\nfunction PathSvgElement(renderer, type) {\r\n    SvgElement.call(this, renderer, \"path\", type)\r\n}\r\nexports.PathSvgElement = PathSvgElement;\r\nPathSvgElement.prototype = objectCreate(SvgElement.prototype);\r\nextend(PathSvgElement.prototype, {\r\n    constructor: PathSvgElement,\r\n    attr: pathAttr,\r\n    animate: pathAnimate\r\n});\r\n\r\nfunction ArcSvgElement(renderer) {\r\n    SvgElement.call(this, renderer, \"path\", \"arc\")\r\n}\r\nexports.ArcSvgElement = ArcSvgElement;\r\nArcSvgElement.prototype = objectCreate(SvgElement.prototype);\r\nextend(ArcSvgElement.prototype, {\r\n    constructor: ArcSvgElement,\r\n    attr: arcAttr,\r\n    animate: arcAnimate\r\n});\r\n\r\nfunction RectSvgElement(renderer) {\r\n    SvgElement.call(this, renderer, \"rect\")\r\n}\r\nexports.RectSvgElement = RectSvgElement;\r\nRectSvgElement.prototype = objectCreate(SvgElement.prototype);\r\nextend(RectSvgElement.prototype, {\r\n    constructor: RectSvgElement,\r\n    attr: rectAttr\r\n});\r\n\r\nfunction TextSvgElement(renderer) {\r\n    SvgElement.call(this, renderer, \"text\");\r\n    this.css({\r\n        \"white-space\": \"pre\"\r\n    })\r\n}\r\nexports.TextSvgElement = TextSvgElement;\r\nTextSvgElement.prototype = objectCreate(SvgElement.prototype);\r\nextend(TextSvgElement.prototype, {\r\n    constructor: TextSvgElement,\r\n    attr: textAttr,\r\n    css: textCss,\r\n    applyEllipsis: applyEllipsis,\r\n    setMaxSize: setMaxSize,\r\n    restoreText: restoreText,\r\n    _getLineHeight: function() {\r\n        return !isNaN(parseFloat(this._styles[KEY_FONT_SIZE])) ? this._styles[KEY_FONT_SIZE] : DEFAULT_FONT_SIZE\r\n    }\r\n});\r\n\r\nfunction updateIndexes(items, k) {\r\n    var i;\r\n    var item;\r\n    for (i = k; item = items[i]; ++i) {\r\n        item._link.i = i\r\n    }\r\n}\r\n\r\nfunction linkItem(target, container) {\r\n    var items = container._links;\r\n    var key = target._link.after = target._link.after || container._linkAfter;\r\n    var i;\r\n    var item;\r\n    if (key) {\r\n        for (i = 0;\r\n            (item = items[i]) && item._link.name !== key; ++i) {}\r\n        if (item) {\r\n            for (++i;\r\n                (item = items[i]) && item._link.after === key; ++i) {}\r\n        }\r\n    } else {\r\n        i = items.length\r\n    }\r\n    items.splice(i, 0, target);\r\n    updateIndexes(items, i)\r\n}\r\n\r\nfunction unlinkItem(target) {\r\n    var i;\r\n    var items = target._link.to._links;\r\n    for (i = 0; items[i] !== target; ++i) {}\r\n    items.splice(i, 1);\r\n    updateIndexes(items, i)\r\n}\r\n\r\nfunction Renderer(options) {\r\n    var that = this;\r\n    that.root = that._createElement(\"svg\", {\r\n        xmlns: \"http://www.w3.org/2000/svg\",\r\n        version: \"1.1\",\r\n        fill: NONE,\r\n        stroke: NONE,\r\n        \"stroke-width\": 0\r\n    }).attr({\r\n        \"class\": options.cssClass\r\n    }).css({\r\n        \"line-height\": \"normal\",\r\n        \"-ms-user-select\": NONE,\r\n        \"-moz-user-select\": NONE,\r\n        \"-webkit-user-select\": NONE,\r\n        \"-webkit-tap-highlight-color\": \"rgba(0, 0, 0, 0)\",\r\n        display: \"block\",\r\n        overflow: \"hidden\"\r\n    });\r\n    that._init();\r\n    that.pathModified = !!options.pathModified;\r\n    that._$container = (0, _renderer2.default)(options.container);\r\n    that.root.append({\r\n        element: options.container\r\n    });\r\n    that.fixPlacement();\r\n    that._locker = 0;\r\n    that._backed = false\r\n}\r\nexports.Renderer = Renderer;\r\nRenderer.prototype = {\r\n    constructor: Renderer,\r\n    _init: function() {\r\n        var that = this;\r\n        that._defs = that._createElement(\"defs\").append(that.root);\r\n        that._animationController = new _animation2.default.AnimationController(that.root.element);\r\n        that._animation = {\r\n            enabled: true,\r\n            duration: 1e3,\r\n            easing: \"easeOutCubic\"\r\n        }\r\n    },\r\n    fixPlacement: function() {\r\n        if (!_browser2.default.mozilla && !_browser2.default.msie) {\r\n            return\r\n        }\r\n        var box = getBoundingClientRect(this._$container.get(0));\r\n        var dx = roundValue(box.left % 1, 2);\r\n        var dy = roundValue(box.top % 1, 2);\r\n        if (_browser2.default.msie) {\r\n            this.root.css({\r\n                transform: \"translate(\" + -dx + \"px,\" + -dy + \"px)\"\r\n            })\r\n        } else {\r\n            if (_browser2.default.mozilla) {\r\n                this.root.move(-dx, -dy)\r\n            }\r\n        }\r\n    },\r\n    removePlacementFix: function() {\r\n        if (!_browser2.default.mozilla && !_browser2.default.msie) {\r\n            return\r\n        }\r\n        if (_browser2.default.msie) {\r\n            this.root.css({\r\n                transform: \"\"\r\n            })\r\n        } else {\r\n            if (_browser2.default.mozilla) {\r\n                this.root.attr({\r\n                    transform: null\r\n                })\r\n            }\r\n        }\r\n    },\r\n    setOptions: function(options) {\r\n        var that = this;\r\n        that.rtl = !!options.rtl;\r\n        that.encodeHtml = !!options.encodeHtml;\r\n        that.updateAnimationOptions(options.animation || {});\r\n        that.root.attr({\r\n            direction: that.rtl ? \"rtl\" : \"ltr\"\r\n        });\r\n        return that\r\n    },\r\n    _createElement: function(tagName, attr, type) {\r\n        var elem = new exports.SvgElement(this, tagName, type);\r\n        attr && elem.attr(attr);\r\n        return elem\r\n    },\r\n    lock: function() {\r\n        var that = this;\r\n        if (0 === that._locker) {\r\n            that._backed = !that._$container.is(\":visible\");\r\n            if (that._backed) {\r\n                backupRoot(that.root)\r\n            }\r\n        }++that._locker;\r\n        return that\r\n    },\r\n    unlock: function() {\r\n        var that = this;\r\n        --that._locker;\r\n        if (0 === that._locker) {\r\n            if (that._backed) {\r\n                restoreRoot(that.root, that._$container[0]);\r\n                that.fixPlacement()\r\n            }\r\n            that._backed = false\r\n        }\r\n        return that\r\n    },\r\n    resize: function(width, height) {\r\n        if (width >= 0 && height >= 0) {\r\n            this.root.attr({\r\n                width: width,\r\n                height: height\r\n            })\r\n        }\r\n        return this\r\n    },\r\n    dispose: function() {\r\n        var that = this;\r\n        var key;\r\n        that.root.dispose();\r\n        that._defs.dispose();\r\n        that._animationController.dispose();\r\n        fixFuncIriCallbacks.removeByRenderer(that);\r\n        for (key in that) {\r\n            that[key] = null\r\n        }\r\n        return that\r\n    },\r\n    animationEnabled: function() {\r\n        return !!this._animation.enabled\r\n    },\r\n    updateAnimationOptions: function(newOptions) {\r\n        extend(this._animation, newOptions);\r\n        return this\r\n    },\r\n    stopAllAnimations: function(lock) {\r\n        this._animationController[lock ? \"lock\" : \"stop\"]();\r\n        return this\r\n    },\r\n    animateElement: function(element, params, options) {\r\n        this._animationController.animateElement(element, params, options);\r\n        return this\r\n    },\r\n    svg: function() {\r\n        this.removePlacementFix();\r\n        var markup = this.root.markup();\r\n        this.fixPlacement();\r\n        return markup\r\n    },\r\n    getRootOffset: function() {\r\n        return this.root.getOffset()\r\n    },\r\n    onEndAnimation: function(endAnimation) {\r\n        this._animationController.onEndAnimation(endAnimation)\r\n    },\r\n    rect: function(x, y, width, height) {\r\n        var elem = new exports.RectSvgElement(this);\r\n        return elem.attr({\r\n            x: x || 0,\r\n            y: y || 0,\r\n            width: width || 0,\r\n            height: height || 0\r\n        })\r\n    },\r\n    simpleRect: function() {\r\n        return this._createElement(\"rect\")\r\n    },\r\n    circle: function(x, y, r) {\r\n        return this._createElement(\"circle\", {\r\n            cx: x || 0,\r\n            cy: y || 0,\r\n            r: r || 0\r\n        })\r\n    },\r\n    g: function() {\r\n        return this._createElement(\"g\")\r\n    },\r\n    image: function image(x, y, w, h, href, location) {\r\n        var image = this._createElement(\"image\", {\r\n            x: x || 0,\r\n            y: y || 0,\r\n            width: w || 0,\r\n            height: h || 0,\r\n            preserveAspectRatio: preserveAspectRatioMap[(0, _utils.normalizeEnum)(location)] || NONE\r\n        });\r\n        image.element.setAttributeNS(\"http://www.w3.org/1999/xlink\", \"href\", href || \"\");\r\n        return image\r\n    },\r\n    path: function(points, type) {\r\n        var elem = new exports.PathSvgElement(this, type);\r\n        return elem.attr({\r\n            points: points || []\r\n        })\r\n    },\r\n    arc: function(x, y, innerRadius, outerRadius, startAngle, endAngle) {\r\n        var elem = new exports.ArcSvgElement(this);\r\n        return elem.attr({\r\n            x: x || 0,\r\n            y: y || 0,\r\n            innerRadius: innerRadius || 0,\r\n            outerRadius: outerRadius || 0,\r\n            startAngle: startAngle || 0,\r\n            endAngle: endAngle || 0\r\n        })\r\n    },\r\n    text: function(_text, x, y) {\r\n        var elem = new exports.TextSvgElement(this);\r\n        return elem.attr({\r\n            text: _text,\r\n            x: x || 0,\r\n            y: y || 0\r\n        })\r\n    },\r\n    linearGradient: function(stops) {\r\n        var gradient;\r\n        var id = getNextDefsSvgId();\r\n        var that = this;\r\n        gradient = that._createElement(\"linearGradient\", {\r\n            id: id\r\n        }).append(that._defs);\r\n        gradient.id = id;\r\n        stops.forEach(function(stop) {\r\n            that._createElement(\"stop\", {\r\n                offset: stop.offset,\r\n                \"stop-color\": stop[\"stop-color\"]\r\n            }).append(gradient)\r\n        });\r\n        return gradient\r\n    },\r\n    pattern: function pattern(color, hatching, _id) {\r\n        hatching = hatching || {};\r\n        var that = this;\r\n        var id;\r\n        var d;\r\n        var pattern;\r\n        var rect;\r\n        var path;\r\n        var step = hatching.step || 6;\r\n        var stepTo2 = step / 2;\r\n        var stepBy15 = 1.5 * step;\r\n        id = _id || getNextDefsSvgId();\r\n        d = \"right\" === (0, _utils.normalizeEnum)(hatching.direction) ? \"M \" + stepTo2 + \" \" + -stepTo2 + \" L \" + -stepTo2 + \" \" + stepTo2 + \" M 0 \" + step + \" L \" + step + \" 0 M \" + stepBy15 + \" \" + stepTo2 + \" L \" + stepTo2 + \" \" + stepBy15 : \"M 0 0 L \" + step + \" \" + step + \" M \" + -stepTo2 + \" \" + stepTo2 + \" L \" + stepTo2 + \" \" + stepBy15 + \" M \" + stepTo2 + \" \" + -stepTo2 + \" L \" + stepBy15 + \" \" + stepTo2;\r\n        pattern = that._createElement(\"pattern\", {\r\n            id: id,\r\n            width: step,\r\n            height: step,\r\n            patternUnits: \"userSpaceOnUse\"\r\n        }).append(that._defs);\r\n        pattern.id = id;\r\n        rect = that.rect(0, 0, step, step).attr({\r\n            fill: color,\r\n            opacity: hatching.opacity\r\n        }).append(pattern);\r\n        path = new exports.PathSvgElement(this).attr({\r\n            d: d,\r\n            \"stroke-width\": hatching.width || 1,\r\n            stroke: color\r\n        }).append(pattern);\r\n        return pattern\r\n    },\r\n    _getPointsWithYOffset: function(points, offset) {\r\n        return points.map(function(point, index) {\r\n            if (index % 2 !== 0) {\r\n                return point + offset\r\n            }\r\n            return point\r\n        })\r\n    },\r\n    clipShape: function(method, methodArgs) {\r\n        var that = this;\r\n        var id = getNextDefsSvgId();\r\n        var clipPath = that._createElement(\"clipPath\", {\r\n            id: id\r\n        }).append(that._defs);\r\n        var shape = method.apply(that, methodArgs).append(clipPath);\r\n        shape.id = id;\r\n        shape.remove = function() {\r\n            throw \"Not implemented\"\r\n        };\r\n        shape.dispose = function() {\r\n            clipPath.dispose();\r\n            clipPath = null;\r\n            return this\r\n        };\r\n        return shape\r\n    },\r\n    clipRect: function(x, y, width, height) {\r\n        return this.clipShape(this.rect, arguments)\r\n    },\r\n    clipCircle: function(x, y, radius) {\r\n        return this.clipShape(this.circle, arguments)\r\n    },\r\n    shadowFilter: function(x, y, width, height, offsetX, offsetY, blur, color, opacity) {\r\n        var that = this;\r\n        var id = getNextDefsSvgId();\r\n        var filter = that._createElement(\"filter\", {\r\n            id: id,\r\n            x: x || 0,\r\n            y: y || 0,\r\n            width: width || 0,\r\n            height: height || 0\r\n        }).append(that._defs);\r\n        var gaussianBlur = that._createElement(\"feGaussianBlur\", {\r\n            \"in\": \"SourceGraphic\",\r\n            result: \"gaussianBlurResult\",\r\n            stdDeviation: blur || 0\r\n        }).append(filter);\r\n        var offset = that._createElement(\"feOffset\", {\r\n            \"in\": \"gaussianBlurResult\",\r\n            result: \"offsetResult\",\r\n            dx: offsetX || 0,\r\n            dy: offsetY || 0\r\n        }).append(filter);\r\n        var flood = that._createElement(\"feFlood\", {\r\n            result: \"floodResult\",\r\n            \"flood-color\": color || \"\",\r\n            \"flood-opacity\": opacity\r\n        }).append(filter);\r\n        var composite = that._createElement(\"feComposite\", {\r\n            \"in\": \"floodResult\",\r\n            in2: \"offsetResult\",\r\n            operator: \"in\",\r\n            result: \"compositeResult\"\r\n        }).append(filter);\r\n        var finalComposite = that._createElement(\"feComposite\", {\r\n            \"in\": \"SourceGraphic\",\r\n            in2: \"compositeResult\",\r\n            operator: \"over\"\r\n        }).append(filter);\r\n        filter.id = id;\r\n        filter.gaussianBlur = gaussianBlur;\r\n        filter.offset = offset;\r\n        filter.flood = flood;\r\n        filter.composite = composite;\r\n        filter.finalComposite = finalComposite;\r\n        filter.attr = function(attrs) {\r\n            var that = this;\r\n            var filterAttrs = {};\r\n            var offsetAttrs = {};\r\n            var floodAttrs = {};\r\n            \"x\" in attrs && (filterAttrs.x = attrs.x);\r\n            \"y\" in attrs && (filterAttrs.y = attrs.y);\r\n            \"width\" in attrs && (filterAttrs.width = attrs.width);\r\n            \"height\" in attrs && (filterAttrs.height = attrs.height);\r\n            baseAttr(that, filterAttrs);\r\n            \"blur\" in attrs && that.gaussianBlur.attr({\r\n                stdDeviation: attrs.blur\r\n            });\r\n            \"offsetX\" in attrs && (offsetAttrs.dx = attrs.offsetX);\r\n            \"offsetY\" in attrs && (offsetAttrs.dy = attrs.offsetY);\r\n            that.offset.attr(offsetAttrs);\r\n            \"color\" in attrs && (floodAttrs[\"flood-color\"] = attrs.color);\r\n            \"opacity\" in attrs && (floodAttrs[\"flood-opacity\"] = attrs.opacity);\r\n            that.flood.attr(floodAttrs);\r\n            return that\r\n        };\r\n        return filter\r\n    },\r\n    brightFilter: function(type, slope) {\r\n        var that = this;\r\n        var id = getNextDefsSvgId();\r\n        var filter = that._createElement(\"filter\", {\r\n            id: id\r\n        }).append(that._defs);\r\n        var componentTransferElement = that._createElement(\"feComponentTransfer\").append(filter);\r\n        var attrs = {\r\n            type: type,\r\n            slope: slope\r\n        };\r\n        filter.id = id;\r\n        that._createElement(\"feFuncR\", attrs).append(componentTransferElement);\r\n        that._createElement(\"feFuncG\", attrs).append(componentTransferElement);\r\n        that._createElement(\"feFuncB\", attrs).append(componentTransferElement);\r\n        return filter\r\n    },\r\n    getGrayScaleFilter: function() {\r\n        if (this._grayScaleFilter) {\r\n            return this._grayScaleFilter\r\n        }\r\n        var that = this;\r\n        var id = getNextDefsSvgId();\r\n        var filter = that._createElement(\"filter\", {\r\n            id: id\r\n        }).append(that._defs);\r\n        that._createElement(\"feColorMatrix\").attr({\r\n            type: \"matrix\",\r\n            values: \"0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 0.6 0\"\r\n        }).append(filter);\r\n        filter.id = id;\r\n        that._grayScaleFilter = filter;\r\n        return filter\r\n    },\r\n    initHatching: function() {\r\n        var storage = this._hatchingStorage = this._hatchingStorage || {\r\n            byHash: {},\r\n            baseId: getNextDefsSvgId()\r\n        };\r\n        var byHash = storage.byHash;\r\n        var name;\r\n        for (name in byHash) {\r\n            byHash[name].pattern.dispose()\r\n        }\r\n        storage.byHash = {};\r\n        storage.refToHash = {};\r\n        storage.nextId = 0\r\n    },\r\n    lockHatching: function(color, hatching, ref) {\r\n        var storage = this._hatchingStorage;\r\n        var hash = getHatchingHash(color, hatching);\r\n        var storageItem;\r\n        var pattern;\r\n        if (storage.refToHash[ref] !== hash) {\r\n            if (ref) {\r\n                this.releaseHatching(ref)\r\n            }\r\n            storageItem = storage.byHash[hash];\r\n            if (!storageItem) {\r\n                pattern = this.pattern(color, hatching, storage.baseId + \"-hatching-\" + storage.nextId++);\r\n                storageItem = storage.byHash[hash] = {\r\n                    pattern: pattern,\r\n                    count: 0\r\n                };\r\n                storage.refToHash[pattern.id] = hash\r\n            }++storageItem.count;\r\n            ref = storageItem.pattern.id\r\n        }\r\n        return ref\r\n    },\r\n    releaseHatching: function(ref) {\r\n        var storage = this._hatchingStorage;\r\n        var hash = storage.refToHash[ref];\r\n        var storageItem = storage.byHash[hash];\r\n        if (storageItem && 0 === --storageItem.count) {\r\n            storageItem.pattern.dispose();\r\n            delete storage.byHash[hash];\r\n            delete storage.refToHash[ref]\r\n        }\r\n    }\r\n};\r\n\r\nfunction getHatchingHash(color, hatching) {\r\n    return \"@\" + color + \"::\" + hatching.step + \":\" + hatching.width + \":\" + hatching.opacity + \":\" + hatching.direction\r\n}\r\nvar fixFuncIriCallbacks = function() {\r\n    var callbacks = [];\r\n    return {\r\n        add: function(fn) {\r\n            callbacks.push(fn)\r\n        },\r\n        remove: function(fn) {\r\n            callbacks = callbacks.filter(function(el) {\r\n                return el !== fn\r\n            })\r\n        },\r\n        removeByRenderer: function(renderer) {\r\n            callbacks = callbacks.filter(function(el) {\r\n                return el.renderer !== renderer\r\n            })\r\n        },\r\n        fire: function() {\r\n            callbacks.forEach(function(fn) {\r\n                fn()\r\n            })\r\n        }\r\n    }\r\n}();\r\nexports.refreshPaths = function() {\r\n    fixFuncIriCallbacks.fire()\r\n};\r\n"]},"metadata":{},"sourceType":"module"}