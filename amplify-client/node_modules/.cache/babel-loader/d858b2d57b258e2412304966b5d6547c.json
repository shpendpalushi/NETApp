{"ast":null,"code":"/**\r\n * DevExtreme (ui/pivot_grid/ui.pivot_grid.field_chooser.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar _renderer = require(\"../../core/renderer\");\n\nvar _renderer2 = _interopRequireDefault(_renderer);\n\nvar _icon = require(\"../../core/utils/icon\");\n\nvar _window = require(\"../../core/utils/window\");\n\nvar _type = require(\"../../core/utils/type\");\n\nvar _extend = require(\"../../core/utils/extend\");\n\nvar _array = require(\"../../core/utils/array\");\n\nvar _iterator = require(\"../../core/utils/iterator\");\n\nvar _message = require(\"../../localization/message\");\n\nvar _component_registrator = require(\"../../core/component_registrator\");\n\nvar _component_registrator2 = _interopRequireDefault(_component_registrator);\n\nvar _uiPivot_grid = require(\"./ui.pivot_grid.utils\");\n\nvar _tree_view = require(\"../tree_view\");\n\nvar _tree_view2 = _interopRequireDefault(_tree_view);\n\nvar _context_menu = require(\"../context_menu\");\n\nvar _context_menu2 = _interopRequireDefault(_context_menu);\n\nvar _uiPivot_grid2 = require(\"./ui.pivot_grid.field_chooser_base\");\n\nvar _uiPivot_grid3 = _interopRequireDefault(_uiPivot_grid2);\n\nrequire(\"./data_source\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nvar DIV = \"<div>\";\nvar hasWindow = (0, _window.hasWindow)();\nvar FIELDCHOOSER_CLASS = \"dx-pivotgridfieldchooser\";\nvar FIELDCHOOSER_CONTAINER_CLASS = \"dx-pivotgridfieldchooser-container\";\nvar FIELDS_CONTAINER_CLASS = \"dx-pivotgrid-fields-container\";\nvar AREA_DRAG_CLASS = \"dx-pivotgrid-drag-action\";\n\nfunction getDimensionFields(item, fields) {\n  var result = [];\n\n  if (item.items) {\n    for (var i = 0; i < item.items.length; i++) {\n      result.push.apply(result, getDimensionFields(item.items[i], fields));\n    }\n  } else {\n    if ((0, _type.isDefined)(item.index)) {\n      result.push(fields[item.index]);\n    }\n  }\n\n  return result;\n}\n\nfunction getFirstItem(item, condition) {\n  if (item.items) {\n    for (var i = 0; i < item.items.length; i++) {\n      var childrenItem = getFirstItem(item.items[i], condition);\n\n      if (childrenItem) {\n        return childrenItem;\n      }\n    }\n  }\n\n  if (condition(item)) {\n    return item;\n  }\n}\n\nvar compareOrder = [function (a, b) {\n  var aValue = -!!a.isMeasure;\n  var bValue = +!!b.isMeasure;\n  return aValue + bValue;\n}, function (a, b) {\n  var aValue = -!!(a.items && a.items.length);\n  var bValue = +!!(b.items && b.items.length);\n  return aValue + bValue;\n}, function (a, b) {\n  var aValue = +!!(false === a.isMeasure && a.field && a.field.levels && a.field.levels.length);\n  var bValue = -!!(false === b.isMeasure && b.field && b.field.levels && b.field.levels.length);\n  return aValue + bValue;\n}, (0, _uiPivot_grid.getCompareFunction)(function (item) {\n  return item.text;\n})];\n\nfunction compareItems(a, b) {\n  var result = 0;\n  var i = 0;\n\n  while (!result && compareOrder[i]) {\n    result = compareOrder[i++](a, b);\n  }\n\n  return result;\n}\n\nfunction getScrollable(container) {\n  return container.find(\".dx-scrollable\").dxScrollable(\"instance\");\n}\n\nvar FieldChooser = _uiPivot_grid3.default.inherit({\n  _getDefaultOptions: function _getDefaultOptions() {\n    return (0, _extend.extend)(this.callBase(), {\n      height: 400,\n      layout: 0,\n      dataSource: null,\n      onContextMenuPreparing: null,\n      allowSearch: false,\n      searchTimeout: 500,\n      texts: {\n        columnFields: (0, _message.format)(\"dxPivotGrid-columnFields\"),\n        rowFields: (0, _message.format)(\"dxPivotGrid-rowFields\"),\n        dataFields: (0, _message.format)(\"dxPivotGrid-dataFields\"),\n        filterFields: (0, _message.format)(\"dxPivotGrid-filterFields\"),\n        allFields: (0, _message.format)(\"dxPivotGrid-allFields\")\n      }\n    });\n  },\n  _refreshDataSource: function _refreshDataSource() {\n    var that = this;\n    that._expandedPaths = [];\n\n    that._changedHandler = that._changedHandler || function () {\n      (0, _iterator.each)(that._dataChangedHandlers, function (_, func) {\n        func();\n      });\n\n      that._fireContentReadyAction();\n\n      that._skipStateChange = true;\n      that.option(\"state\", that._dataSource.state());\n      that._skipStateChange = false;\n    };\n\n    that._disposeDataSource();\n\n    that.callBase();\n    that._dataSource && that._dataSource.on(\"changed\", that._changedHandler);\n  },\n  _disposeDataSource: function _disposeDataSource() {\n    var that = this;\n    var dataSource = that._dataSource;\n\n    if (dataSource) {\n      dataSource.off(\"changed\", that._changedHandler);\n      that._dataSource = void 0;\n    }\n  },\n  _dispose: function _dispose() {\n    this._disposeDataSource();\n\n    this.callBase.apply(this, arguments);\n  },\n  _init: function _init() {\n    this.callBase();\n\n    this._refreshDataSource();\n\n    this._dataChangedHandlers = [];\n\n    this._initActions();\n  },\n  _initActions: function _initActions() {\n    this._actions = {\n      onContextMenuPreparing: this._createActionByOption(\"onContextMenuPreparing\")\n    };\n  },\n  _trigger: function _trigger(eventName, eventArg) {\n    this._actions[eventName](eventArg);\n  },\n  _setOptionsByReference: function _setOptionsByReference() {\n    this.callBase();\n    (0, _extend.extend)(this._optionsByReference, {\n      dataSource: true\n    });\n  },\n  _optionChanged: function _optionChanged(args) {\n    var that = this;\n\n    switch (args.name) {\n      case \"dataSource\":\n        that._refreshDataSource();\n\n        that._invalidate();\n\n        break;\n\n      case \"layout\":\n      case \"texts\":\n      case \"allowSearch\":\n      case \"searchTimeout\":\n        that._invalidate();\n\n        break;\n\n      case \"onContextMenuPreparing\":\n        that._actions[args.name] = that._createActionByOption(args.name);\n        break;\n\n      default:\n        that.callBase(args);\n    }\n  },\n  _clean: function _clean(skipStateSetting) {\n    !skipStateSetting && this._dataSource && this.option(\"state\", this._dataSource.state());\n    this.$element().children(\".\" + FIELDCHOOSER_CONTAINER_CLASS).remove();\n  },\n  _renderLayout0: function _renderLayout0($container) {\n    var that = this;\n    $container.addClass(\"dx-layout-0\");\n    var $row1 = (0, _renderer2.default)(DIV).addClass(\"dx-row\").appendTo($container);\n    var $row2 = (0, _renderer2.default)(DIV).addClass(\"dx-row\").appendTo($container);\n    var $col1 = (0, _renderer2.default)(DIV).addClass(\"dx-col\").appendTo($row1);\n    var $col2 = (0, _renderer2.default)(DIV).addClass(\"dx-col\").appendTo($row1);\n    var $col3 = (0, _renderer2.default)(DIV).addClass(\"dx-col\").appendTo($row2);\n    var $col4 = (0, _renderer2.default)(DIV).addClass(\"dx-col\").appendTo($row2);\n\n    that._renderArea($col1, \"all\");\n\n    that._renderArea($col2, \"row\");\n\n    that._renderArea($col2, \"column\");\n\n    that._renderArea($col3, \"filter\");\n\n    that._renderArea($col4, \"data\");\n  },\n  _renderLayout1: function _renderLayout1($container) {\n    var that = this;\n    var $col1 = (0, _renderer2.default)(DIV).addClass(\"dx-col\").appendTo($container);\n    var $col2 = (0, _renderer2.default)(DIV).addClass(\"dx-col\").appendTo($container);\n\n    that._renderArea($col1, \"all\");\n\n    that._renderArea($col2, \"filter\");\n\n    that._renderArea($col2, \"row\");\n\n    that._renderArea($col2, \"column\");\n\n    that._renderArea($col2, \"data\");\n  },\n  _renderLayout2: function _renderLayout2($container) {\n    var that = this;\n    $container.addClass(\"dx-layout-2\");\n    var $row1 = (0, _renderer2.default)(DIV).addClass(\"dx-row\").appendTo($container);\n\n    that._renderArea($row1, \"all\");\n\n    var $row2 = (0, _renderer2.default)(DIV).addClass(\"dx-row\").appendTo($container);\n    var $col1 = (0, _renderer2.default)(DIV).addClass(\"dx-col\").appendTo($row2);\n    var $col2 = (0, _renderer2.default)(DIV).addClass(\"dx-col\").appendTo($row2);\n\n    that._renderArea($col1, \"filter\");\n\n    that._renderArea($col1, \"row\");\n\n    that._renderArea($col2, \"column\");\n\n    that._renderArea($col2, \"data\");\n  },\n  _initMarkup: function _initMarkup() {\n    var that = this;\n    var $element = this.$element();\n    var $container = (0, _renderer2.default)(DIV).addClass(FIELDCHOOSER_CONTAINER_CLASS).appendTo($element);\n    var layout = that.option(\"layout\");\n    that.callBase();\n    $element.addClass(FIELDCHOOSER_CLASS).addClass(FIELDS_CONTAINER_CLASS);\n    that._dataChangedHandlers = [];\n    var dataSource = this._dataSource;\n    var currentState = \"instantly\" !== that.option(\"applyChangesMode\") && dataSource && dataSource.state();\n    currentState && that.option(\"state\") && dataSource.state(that.option(\"state\"), true);\n\n    if (0 === layout) {\n      that._renderLayout0($container);\n    } else {\n      if (1 === layout) {\n        that._renderLayout1($container);\n      } else {\n        that._renderLayout2($container);\n      }\n    }\n\n    currentState && dataSource.state(currentState, true);\n  },\n  _renderContentImpl: function _renderContentImpl() {\n    this.callBase();\n    this.renderSortable();\n\n    this._renderContextMenu();\n\n    this.updateDimensions();\n  },\n  _fireContentReadyAction: function _fireContentReadyAction() {\n    if (!this._dataSource || !this._dataSource.isLoading()) {\n      this.callBase();\n    }\n  },\n  _getContextMenuArgs: function _getContextMenuArgs(dxEvent) {\n    var targetFieldElement = (0, _renderer2.default)(dxEvent.target).closest(\".dx-area-field\");\n    var targetGroupElement = (0, _renderer2.default)(dxEvent.target).closest(\".dx-area-fields\");\n    var field;\n    var area;\n\n    if (targetFieldElement.length) {\n      var fieldCopy = targetFieldElement.data(\"field\");\n\n      if (fieldCopy) {\n        field = this.getDataSource().field(fieldCopy.index) || fieldCopy;\n      }\n    }\n\n    if (targetGroupElement.length) {\n      area = targetGroupElement.attr(\"group\");\n    }\n\n    return {\n      event: dxEvent,\n      field: field,\n      area: area,\n      items: []\n    };\n  },\n  _renderContextMenu: function _renderContextMenu() {\n    var that = this;\n    var $container = that.$element();\n\n    if (that._contextMenu) {\n      that._contextMenu.$element().remove();\n    }\n\n    that._contextMenu = that._createComponent((0, _renderer2.default)(DIV).appendTo($container), _context_menu2.default, {\n      onPositioning: function onPositioning(actionArgs) {\n        var event = actionArgs.event;\n\n        if (!event) {\n          return;\n        }\n\n        var args = that._getContextMenuArgs(event);\n\n        that._trigger(\"onContextMenuPreparing\", args);\n\n        if (args.items && args.items.length) {\n          actionArgs.component.option(\"items\", args.items);\n        } else {\n          actionArgs.cancel = true;\n        }\n      },\n      target: $container,\n      onItemClick: function onItemClick(params) {\n        params.itemData.onItemClick && params.itemData.onItemClick(params);\n      },\n      cssClass: \"dx-pivotgridfieldchooser-context-menu\"\n    });\n  },\n  _createTreeItems: function _createTreeItems(fields, groupFieldNames, path) {\n    var that = this;\n    var isMeasure;\n    var resultItems = [];\n    var groupedItems = [];\n    var groupFieldName = groupFieldNames[0];\n    var fieldsByGroup = {};\n\n    if (!groupFieldName) {\n      (0, _iterator.each)(fields, function (index, field) {\n        var icon;\n\n        if (true === field.isMeasure) {\n          icon = \"measure\";\n        }\n\n        if (false === field.isMeasure) {\n          icon = field.groupName ? \"hierarchy\" : \"dimension\";\n        }\n\n        resultItems.push({\n          index: field.index,\n          field: field,\n          key: field.dataField,\n          selected: (0, _type.isDefined)(field.area),\n          text: field.caption || field.dataField,\n          icon: icon,\n          isMeasure: field.isMeasure,\n          isDefault: field.isDefault\n        });\n      });\n    } else {\n      (0, _iterator.each)(fields, function (index, field) {\n        var groupName = field[groupFieldName] || \"\";\n        fieldsByGroup[groupName] = fieldsByGroup[groupName] || [];\n        fieldsByGroup[groupName].push(field);\n\n        if (void 0 === isMeasure) {\n          isMeasure = true;\n        }\n\n        isMeasure = isMeasure && true === field.isMeasure;\n      });\n      (0, _iterator.each)(fieldsByGroup, function (groupName, fields) {\n        var currentPath = path ? path + \".\" + groupName : groupName;\n\n        var items = that._createTreeItems(fields, groupFieldNames.slice(1), currentPath);\n\n        if (groupName) {\n          groupedItems.push({\n            key: groupName,\n            text: groupName,\n            path: currentPath,\n            isMeasure: items.isMeasure,\n            expanded: (0, _array.inArray)(currentPath, that._expandedPaths) >= 0,\n            items: items\n          });\n        } else {\n          resultItems = items;\n        }\n      });\n      resultItems = groupedItems.concat(resultItems);\n      resultItems.isMeasure = isMeasure;\n    }\n\n    return resultItems;\n  },\n  _createFieldsDataSource: function _createFieldsDataSource(dataSource) {\n    var fields = dataSource && dataSource.fields() || [];\n    fields = fields.filter(function (field) {\n      return false !== field.visible && !(0, _type.isDefined)(field.groupIndex);\n    });\n\n    var treeItems = this._createTreeItems(fields, [\"dimension\", \"displayFolder\"]);\n\n    (0, _uiPivot_grid.foreachDataLevel)(treeItems, function (items) {\n      items.sort(compareItems);\n    }, 0, \"items\");\n    return treeItems;\n  },\n  _renderFieldsTreeView: function _renderFieldsTreeView(container) {\n    var that = this;\n    var dataSource = that._dataSource;\n\n    var treeView = that._createComponent(container, _tree_view2.default, {\n      dataSource: that._createFieldsDataSource(dataSource),\n      showCheckBoxesMode: \"normal\",\n      searchEnabled: that.option(\"allowSearch\"),\n      searchTimeout: that.option(\"searchTimeout\"),\n      itemTemplate: function itemTemplate(itemData, itemIndex, itemElement) {\n        if (itemData.icon) {\n          (0, _icon.getImageContainer)(itemData.icon).appendTo(itemElement);\n        }\n\n        (0, _renderer2.default)(\"<span>\").toggleClass(\"dx-area-field\", !itemData.items).data(\"field\", itemData.field).text(itemData.text).appendTo(itemElement);\n      },\n      onItemCollapsed: function onItemCollapsed(e) {\n        var index = (0, _array.inArray)(e.itemData.path, that._expandedPaths);\n\n        if (index >= 0) {\n          that._expandedPaths.splice(index, 1);\n        }\n      },\n      onItemExpanded: function onItemExpanded(e) {\n        var index = (0, _array.inArray)(e.itemData.path, that._expandedPaths);\n\n        if (index < 0) {\n          that._expandedPaths.push(e.itemData.path);\n        }\n      },\n      onItemSelectionChanged: function onItemSelectionChanged(e) {\n        var data = e.itemData;\n        var field;\n        var fields;\n        var needSelectDefaultItem = true;\n        var area;\n\n        if (data.items) {\n          if (data.selected) {\n            treeView.unselectItem(data);\n            return;\n          }\n\n          that._processDemandState(function () {\n            fields = getDimensionFields(data, dataSource.fields());\n\n            for (var i = 0; i < fields.length; i++) {\n              if (fields[i].area) {\n                needSelectDefaultItem = false;\n                break;\n              }\n            }\n          });\n\n          if (needSelectDefaultItem) {\n            var item = getFirstItem(data, function (item) {\n              return item.isDefault;\n            }) || getFirstItem(data, function (item) {\n              return (0, _type.isDefined)(item.index);\n            });\n            item && treeView.selectItem(item);\n            return;\n          }\n        } else {\n          field = dataSource.fields()[data.index];\n\n          if (data.selected) {\n            area = field.isMeasure ? \"data\" : \"column\";\n          }\n\n          if (field) {\n            fields = [field];\n          }\n        }\n\n        that._applyChanges(fields, {\n          area: area,\n          areaIndex: void 0\n        });\n      }\n    });\n\n    var dataChanged = function dataChanged() {\n      var scrollable = getScrollable(container);\n      var scrollTop = scrollable ? scrollable.scrollTop() : 0;\n      treeView.option({\n        dataSource: that._createFieldsDataSource(dataSource)\n      });\n      scrollable = getScrollable(container);\n\n      if (scrollable) {\n        scrollable.scrollTo({\n          y: scrollTop\n        });\n        scrollable.update();\n      }\n    };\n\n    that._dataChangedHandlers.push(dataChanged);\n  },\n  _renderAreaFields: function _renderAreaFields($container, area) {\n    var that = this;\n    var dataSource = that._dataSource;\n    var fields = dataSource ? (0, _extend.extend)(true, [], dataSource.getAreaFields(area, true)) : [];\n    $container.empty();\n    (0, _iterator.each)(fields, function (_, field) {\n      if (false !== field.visible) {\n        that.renderField(field, true).appendTo($container);\n      }\n    });\n  },\n  _renderArea: function _renderArea(container, area) {\n    var that = this;\n    var $areaContainer = (0, _renderer2.default)(DIV).addClass(\"dx-area\").appendTo(container);\n    var $fieldsHeaderContainer = (0, _renderer2.default)(DIV).addClass(\"dx-area-fields-header\").appendTo($areaContainer);\n    var caption = that.option(\"texts.\" + area + \"Fields\");\n    var $fieldsContent;\n    var render;\n    (0, _renderer2.default)(\"<span>\").addClass(\"dx-area-icon\").addClass(\"dx-area-icon-\" + area).appendTo($fieldsHeaderContainer);\n    (0, _renderer2.default)(\"<span>\").html(\"&nbsp;\").appendTo($fieldsHeaderContainer);\n    (0, _renderer2.default)(\"<span>\").addClass(\"dx-area-caption\").text(caption).appendTo($fieldsHeaderContainer);\n    var $fieldsContainer = (0, _renderer2.default)(DIV).addClass(\"dx-area-fields\").addClass(AREA_DRAG_CLASS).appendTo($areaContainer);\n\n    if (\"all\" !== area) {\n      $fieldsContainer.attr(\"group\", area).attr(\"allow-scrolling\", true);\n      $fieldsContent = (0, _renderer2.default)(DIV).addClass(\"dx-area-field-container\").appendTo($fieldsContainer);\n\n      render = function render() {\n        that._renderAreaFields($fieldsContent, area);\n      };\n\n      that._dataChangedHandlers.push(render);\n\n      render();\n      $fieldsContainer.dxScrollable();\n    } else {\n      $areaContainer.addClass(\"dx-all-fields\");\n      $fieldsContainer.addClass(\"dx-treeview-border-visible\");\n\n      that._renderFieldsTreeView($fieldsContainer);\n    }\n  },\n  _getSortableOptions: function _getSortableOptions() {\n    return {};\n  },\n  _adjustSortableOnChangedArgs: function _adjustSortableOnChangedArgs() {},\n  resetTreeView: function resetTreeView() {\n    var treeView = this.$element().find(\".dx-treeview\").dxTreeView(\"instance\");\n\n    if (treeView) {\n      treeView.option(\"searchValue\", \"\");\n      treeView.collapseAll();\n    }\n  },\n  applyChanges: function applyChanges() {\n    var state = this.option(\"state\");\n\n    if ((0, _type.isDefined)(state)) {\n      this._dataSource.state(state);\n    }\n  },\n  cancelChanges: function cancelChanges() {\n    var dataSource = this._dataSource;\n\n    if (!dataSource.isLoading()) {\n      this.option(\"state\", dataSource.state());\n      return true;\n    }\n\n    return false;\n  },\n  getDataSource: function getDataSource() {\n    return this._dataSource;\n  },\n  updateDimensions: function updateDimensions() {\n    var $scrollableElements = this.$element().find(\".dx-area .dx-scrollable\");\n    $scrollableElements.dxScrollable(\"update\");\n  },\n  _visibilityChanged: function _visibilityChanged(visible) {\n    if (visible && hasWindow) {\n      this.updateDimensions();\n    }\n  }\n});\n\n(0, _component_registrator2.default)(\"dxPivotGridFieldChooser\", FieldChooser);\nmodule.exports = FieldChooser;","map":{"version":3,"sources":["C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/devextreme/ui/pivot_grid/ui.pivot_grid.field_chooser.js"],"names":["_renderer","require","_renderer2","_interopRequireDefault","_icon","_window","_type","_extend","_array","_iterator","_message","_component_registrator","_component_registrator2","_uiPivot_grid","_tree_view","_tree_view2","_context_menu","_context_menu2","_uiPivot_grid2","_uiPivot_grid3","obj","DIV","hasWindow","FIELDCHOOSER_CLASS","FIELDCHOOSER_CONTAINER_CLASS","FIELDS_CONTAINER_CLASS","AREA_DRAG_CLASS","result","item","i","getDimensionFields","fields","childrenItem","getFirstItem","condition","compareOrder","aValue","a","bValue","b","container","FieldChooser","_getDefaultOptions","height","layout","dataSource","onContextMenuPreparing","allowSearch","searchTimeout","texts","columnFields","rowFields","dataFields","filterFields","allFields","_refreshDataSource","that","func","_disposeDataSource","_dispose","_init","_initActions","_trigger","_setOptionsByReference","_optionChanged","args","_clean","_renderLayout0","$container","$row1","$row2","$col1","$col2","$col3","$col4","_renderLayout1","_renderLayout2","_initMarkup","$element","currentState","_renderContentImpl","_fireContentReadyAction","_getContextMenuArgs","targetFieldElement","dxEvent","targetGroupElement","fieldCopy","field","area","event","items","_renderContextMenu","onPositioning","actionArgs","target","onItemClick","params","cssClass","_createTreeItems","resultItems","groupedItems","groupFieldName","groupFieldNames","fieldsByGroup","icon","index","key","selected","text","isMeasure","isDefault","groupName","currentPath","path","expanded","_createFieldsDataSource","treeItems","_renderFieldsTreeView","treeView","showCheckBoxesMode","searchEnabled","itemTemplate","itemData","onItemCollapsed","e","onItemExpanded","onItemSelectionChanged","data","needSelectDefaultItem","areaIndex","dataChanged","scrollable","getScrollable","scrollTop","y","_renderAreaFields","_renderArea","$areaContainer","$fieldsHeaderContainer","caption","$fieldsContainer","$fieldsContent","render","_getSortableOptions","_adjustSortableOnChangedArgs","resetTreeView","applyChanges","state","cancelChanges","getDataSource","updateDimensions","$scrollableElements","_visibilityChanged","visible","module"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/pivot_grid/ui.pivot_grid.field_chooser.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar _renderer = require(\"../../core/renderer\");\r\nvar _renderer2 = _interopRequireDefault(_renderer);\r\nvar _icon = require(\"../../core/utils/icon\");\r\nvar _window = require(\"../../core/utils/window\");\r\nvar _type = require(\"../../core/utils/type\");\r\nvar _extend = require(\"../../core/utils/extend\");\r\nvar _array = require(\"../../core/utils/array\");\r\nvar _iterator = require(\"../../core/utils/iterator\");\r\nvar _message = require(\"../../localization/message\");\r\nvar _component_registrator = require(\"../../core/component_registrator\");\r\nvar _component_registrator2 = _interopRequireDefault(_component_registrator);\r\nvar _uiPivot_grid = require(\"./ui.pivot_grid.utils\");\r\nvar _tree_view = require(\"../tree_view\");\r\nvar _tree_view2 = _interopRequireDefault(_tree_view);\r\nvar _context_menu = require(\"../context_menu\");\r\nvar _context_menu2 = _interopRequireDefault(_context_menu);\r\nvar _uiPivot_grid2 = require(\"./ui.pivot_grid.field_chooser_base\");\r\nvar _uiPivot_grid3 = _interopRequireDefault(_uiPivot_grid2);\r\nrequire(\"./data_source\");\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\nvar DIV = \"<div>\";\r\nvar hasWindow = (0, _window.hasWindow)();\r\nvar FIELDCHOOSER_CLASS = \"dx-pivotgridfieldchooser\";\r\nvar FIELDCHOOSER_CONTAINER_CLASS = \"dx-pivotgridfieldchooser-container\";\r\nvar FIELDS_CONTAINER_CLASS = \"dx-pivotgrid-fields-container\";\r\nvar AREA_DRAG_CLASS = \"dx-pivotgrid-drag-action\";\r\n\r\nfunction getDimensionFields(item, fields) {\r\n    var result = [];\r\n    if (item.items) {\r\n        for (var i = 0; i < item.items.length; i++) {\r\n            result.push.apply(result, getDimensionFields(item.items[i], fields))\r\n        }\r\n    } else {\r\n        if ((0, _type.isDefined)(item.index)) {\r\n            result.push(fields[item.index])\r\n        }\r\n    }\r\n    return result\r\n}\r\n\r\nfunction getFirstItem(item, condition) {\r\n    if (item.items) {\r\n        for (var i = 0; i < item.items.length; i++) {\r\n            var childrenItem = getFirstItem(item.items[i], condition);\r\n            if (childrenItem) {\r\n                return childrenItem\r\n            }\r\n        }\r\n    }\r\n    if (condition(item)) {\r\n        return item\r\n    }\r\n}\r\nvar compareOrder = [function(a, b) {\r\n    var aValue = -!!a.isMeasure;\r\n    var bValue = +!!b.isMeasure;\r\n    return aValue + bValue\r\n}, function(a, b) {\r\n    var aValue = -!!(a.items && a.items.length);\r\n    var bValue = +!!(b.items && b.items.length);\r\n    return aValue + bValue\r\n}, function(a, b) {\r\n    var aValue = +!!(false === a.isMeasure && a.field && a.field.levels && a.field.levels.length);\r\n    var bValue = -!!(false === b.isMeasure && b.field && b.field.levels && b.field.levels.length);\r\n    return aValue + bValue\r\n}, (0, _uiPivot_grid.getCompareFunction)(function(item) {\r\n    return item.text\r\n})];\r\n\r\nfunction compareItems(a, b) {\r\n    var result = 0;\r\n    var i = 0;\r\n    while (!result && compareOrder[i]) {\r\n        result = compareOrder[i++](a, b)\r\n    }\r\n    return result\r\n}\r\n\r\nfunction getScrollable(container) {\r\n    return container.find(\".dx-scrollable\").dxScrollable(\"instance\")\r\n}\r\nvar FieldChooser = _uiPivot_grid3.default.inherit({\r\n    _getDefaultOptions: function() {\r\n        return (0, _extend.extend)(this.callBase(), {\r\n            height: 400,\r\n            layout: 0,\r\n            dataSource: null,\r\n            onContextMenuPreparing: null,\r\n            allowSearch: false,\r\n            searchTimeout: 500,\r\n            texts: {\r\n                columnFields: (0, _message.format)(\"dxPivotGrid-columnFields\"),\r\n                rowFields: (0, _message.format)(\"dxPivotGrid-rowFields\"),\r\n                dataFields: (0, _message.format)(\"dxPivotGrid-dataFields\"),\r\n                filterFields: (0, _message.format)(\"dxPivotGrid-filterFields\"),\r\n                allFields: (0, _message.format)(\"dxPivotGrid-allFields\")\r\n            }\r\n        })\r\n    },\r\n    _refreshDataSource: function() {\r\n        var that = this;\r\n        that._expandedPaths = [];\r\n        that._changedHandler = that._changedHandler || function() {\r\n            (0, _iterator.each)(that._dataChangedHandlers, function(_, func) {\r\n                func()\r\n            });\r\n            that._fireContentReadyAction();\r\n            that._skipStateChange = true;\r\n            that.option(\"state\", that._dataSource.state());\r\n            that._skipStateChange = false\r\n        };\r\n        that._disposeDataSource();\r\n        that.callBase();\r\n        that._dataSource && that._dataSource.on(\"changed\", that._changedHandler)\r\n    },\r\n    _disposeDataSource: function() {\r\n        var that = this;\r\n        var dataSource = that._dataSource;\r\n        if (dataSource) {\r\n            dataSource.off(\"changed\", that._changedHandler);\r\n            that._dataSource = void 0\r\n        }\r\n    },\r\n    _dispose: function() {\r\n        this._disposeDataSource();\r\n        this.callBase.apply(this, arguments)\r\n    },\r\n    _init: function() {\r\n        this.callBase();\r\n        this._refreshDataSource();\r\n        this._dataChangedHandlers = [];\r\n        this._initActions()\r\n    },\r\n    _initActions: function() {\r\n        this._actions = {\r\n            onContextMenuPreparing: this._createActionByOption(\"onContextMenuPreparing\")\r\n        }\r\n    },\r\n    _trigger: function(eventName, eventArg) {\r\n        this._actions[eventName](eventArg)\r\n    },\r\n    _setOptionsByReference: function() {\r\n        this.callBase();\r\n        (0, _extend.extend)(this._optionsByReference, {\r\n            dataSource: true\r\n        })\r\n    },\r\n    _optionChanged: function(args) {\r\n        var that = this;\r\n        switch (args.name) {\r\n            case \"dataSource\":\r\n                that._refreshDataSource();\r\n                that._invalidate();\r\n                break;\r\n            case \"layout\":\r\n            case \"texts\":\r\n            case \"allowSearch\":\r\n            case \"searchTimeout\":\r\n                that._invalidate();\r\n                break;\r\n            case \"onContextMenuPreparing\":\r\n                that._actions[args.name] = that._createActionByOption(args.name);\r\n                break;\r\n            default:\r\n                that.callBase(args)\r\n        }\r\n    },\r\n    _clean: function(skipStateSetting) {\r\n        !skipStateSetting && this._dataSource && this.option(\"state\", this._dataSource.state());\r\n        this.$element().children(\".\" + FIELDCHOOSER_CONTAINER_CLASS).remove()\r\n    },\r\n    _renderLayout0: function($container) {\r\n        var that = this;\r\n        $container.addClass(\"dx-layout-0\");\r\n        var $row1 = (0, _renderer2.default)(DIV).addClass(\"dx-row\").appendTo($container);\r\n        var $row2 = (0, _renderer2.default)(DIV).addClass(\"dx-row\").appendTo($container);\r\n        var $col1 = (0, _renderer2.default)(DIV).addClass(\"dx-col\").appendTo($row1);\r\n        var $col2 = (0, _renderer2.default)(DIV).addClass(\"dx-col\").appendTo($row1);\r\n        var $col3 = (0, _renderer2.default)(DIV).addClass(\"dx-col\").appendTo($row2);\r\n        var $col4 = (0, _renderer2.default)(DIV).addClass(\"dx-col\").appendTo($row2);\r\n        that._renderArea($col1, \"all\");\r\n        that._renderArea($col2, \"row\");\r\n        that._renderArea($col2, \"column\");\r\n        that._renderArea($col3, \"filter\");\r\n        that._renderArea($col4, \"data\")\r\n    },\r\n    _renderLayout1: function($container) {\r\n        var that = this;\r\n        var $col1 = (0, _renderer2.default)(DIV).addClass(\"dx-col\").appendTo($container);\r\n        var $col2 = (0, _renderer2.default)(DIV).addClass(\"dx-col\").appendTo($container);\r\n        that._renderArea($col1, \"all\");\r\n        that._renderArea($col2, \"filter\");\r\n        that._renderArea($col2, \"row\");\r\n        that._renderArea($col2, \"column\");\r\n        that._renderArea($col2, \"data\")\r\n    },\r\n    _renderLayout2: function($container) {\r\n        var that = this;\r\n        $container.addClass(\"dx-layout-2\");\r\n        var $row1 = (0, _renderer2.default)(DIV).addClass(\"dx-row\").appendTo($container);\r\n        that._renderArea($row1, \"all\");\r\n        var $row2 = (0, _renderer2.default)(DIV).addClass(\"dx-row\").appendTo($container);\r\n        var $col1 = (0, _renderer2.default)(DIV).addClass(\"dx-col\").appendTo($row2);\r\n        var $col2 = (0, _renderer2.default)(DIV).addClass(\"dx-col\").appendTo($row2);\r\n        that._renderArea($col1, \"filter\");\r\n        that._renderArea($col1, \"row\");\r\n        that._renderArea($col2, \"column\");\r\n        that._renderArea($col2, \"data\")\r\n    },\r\n    _initMarkup: function() {\r\n        var that = this;\r\n        var $element = this.$element();\r\n        var $container = (0, _renderer2.default)(DIV).addClass(FIELDCHOOSER_CONTAINER_CLASS).appendTo($element);\r\n        var layout = that.option(\"layout\");\r\n        that.callBase();\r\n        $element.addClass(FIELDCHOOSER_CLASS).addClass(FIELDS_CONTAINER_CLASS);\r\n        that._dataChangedHandlers = [];\r\n        var dataSource = this._dataSource;\r\n        var currentState = \"instantly\" !== that.option(\"applyChangesMode\") && dataSource && dataSource.state();\r\n        currentState && that.option(\"state\") && dataSource.state(that.option(\"state\"), true);\r\n        if (0 === layout) {\r\n            that._renderLayout0($container)\r\n        } else {\r\n            if (1 === layout) {\r\n                that._renderLayout1($container)\r\n            } else {\r\n                that._renderLayout2($container)\r\n            }\r\n        }\r\n        currentState && dataSource.state(currentState, true)\r\n    },\r\n    _renderContentImpl: function() {\r\n        this.callBase();\r\n        this.renderSortable();\r\n        this._renderContextMenu();\r\n        this.updateDimensions()\r\n    },\r\n    _fireContentReadyAction: function() {\r\n        if (!this._dataSource || !this._dataSource.isLoading()) {\r\n            this.callBase()\r\n        }\r\n    },\r\n    _getContextMenuArgs: function(dxEvent) {\r\n        var targetFieldElement = (0, _renderer2.default)(dxEvent.target).closest(\".dx-area-field\");\r\n        var targetGroupElement = (0, _renderer2.default)(dxEvent.target).closest(\".dx-area-fields\");\r\n        var field;\r\n        var area;\r\n        if (targetFieldElement.length) {\r\n            var fieldCopy = targetFieldElement.data(\"field\");\r\n            if (fieldCopy) {\r\n                field = this.getDataSource().field(fieldCopy.index) || fieldCopy\r\n            }\r\n        }\r\n        if (targetGroupElement.length) {\r\n            area = targetGroupElement.attr(\"group\")\r\n        }\r\n        return {\r\n            event: dxEvent,\r\n            field: field,\r\n            area: area,\r\n            items: []\r\n        }\r\n    },\r\n    _renderContextMenu: function() {\r\n        var that = this;\r\n        var $container = that.$element();\r\n        if (that._contextMenu) {\r\n            that._contextMenu.$element().remove()\r\n        }\r\n        that._contextMenu = that._createComponent((0, _renderer2.default)(DIV).appendTo($container), _context_menu2.default, {\r\n            onPositioning: function(actionArgs) {\r\n                var event = actionArgs.event;\r\n                if (!event) {\r\n                    return\r\n                }\r\n                var args = that._getContextMenuArgs(event);\r\n                that._trigger(\"onContextMenuPreparing\", args);\r\n                if (args.items && args.items.length) {\r\n                    actionArgs.component.option(\"items\", args.items)\r\n                } else {\r\n                    actionArgs.cancel = true\r\n                }\r\n            },\r\n            target: $container,\r\n            onItemClick: function(params) {\r\n                params.itemData.onItemClick && params.itemData.onItemClick(params)\r\n            },\r\n            cssClass: \"dx-pivotgridfieldchooser-context-menu\"\r\n        })\r\n    },\r\n    _createTreeItems: function(fields, groupFieldNames, path) {\r\n        var that = this;\r\n        var isMeasure;\r\n        var resultItems = [];\r\n        var groupedItems = [];\r\n        var groupFieldName = groupFieldNames[0];\r\n        var fieldsByGroup = {};\r\n        if (!groupFieldName) {\r\n            (0, _iterator.each)(fields, function(index, field) {\r\n                var icon;\r\n                if (true === field.isMeasure) {\r\n                    icon = \"measure\"\r\n                }\r\n                if (false === field.isMeasure) {\r\n                    icon = field.groupName ? \"hierarchy\" : \"dimension\"\r\n                }\r\n                resultItems.push({\r\n                    index: field.index,\r\n                    field: field,\r\n                    key: field.dataField,\r\n                    selected: (0, _type.isDefined)(field.area),\r\n                    text: field.caption || field.dataField,\r\n                    icon: icon,\r\n                    isMeasure: field.isMeasure,\r\n                    isDefault: field.isDefault\r\n                })\r\n            })\r\n        } else {\r\n            (0, _iterator.each)(fields, function(index, field) {\r\n                var groupName = field[groupFieldName] || \"\";\r\n                fieldsByGroup[groupName] = fieldsByGroup[groupName] || [];\r\n                fieldsByGroup[groupName].push(field);\r\n                if (void 0 === isMeasure) {\r\n                    isMeasure = true\r\n                }\r\n                isMeasure = isMeasure && true === field.isMeasure\r\n            });\r\n            (0, _iterator.each)(fieldsByGroup, function(groupName, fields) {\r\n                var currentPath = path ? path + \".\" + groupName : groupName;\r\n                var items = that._createTreeItems(fields, groupFieldNames.slice(1), currentPath);\r\n                if (groupName) {\r\n                    groupedItems.push({\r\n                        key: groupName,\r\n                        text: groupName,\r\n                        path: currentPath,\r\n                        isMeasure: items.isMeasure,\r\n                        expanded: (0, _array.inArray)(currentPath, that._expandedPaths) >= 0,\r\n                        items: items\r\n                    })\r\n                } else {\r\n                    resultItems = items\r\n                }\r\n            });\r\n            resultItems = groupedItems.concat(resultItems);\r\n            resultItems.isMeasure = isMeasure\r\n        }\r\n        return resultItems\r\n    },\r\n    _createFieldsDataSource: function(dataSource) {\r\n        var fields = dataSource && dataSource.fields() || [];\r\n        fields = fields.filter(function(field) {\r\n            return false !== field.visible && !(0, _type.isDefined)(field.groupIndex)\r\n        });\r\n        var treeItems = this._createTreeItems(fields, [\"dimension\", \"displayFolder\"]);\r\n        (0, _uiPivot_grid.foreachDataLevel)(treeItems, function(items) {\r\n            items.sort(compareItems)\r\n        }, 0, \"items\");\r\n        return treeItems\r\n    },\r\n    _renderFieldsTreeView: function(container) {\r\n        var that = this;\r\n        var dataSource = that._dataSource;\r\n        var treeView = that._createComponent(container, _tree_view2.default, {\r\n            dataSource: that._createFieldsDataSource(dataSource),\r\n            showCheckBoxesMode: \"normal\",\r\n            searchEnabled: that.option(\"allowSearch\"),\r\n            searchTimeout: that.option(\"searchTimeout\"),\r\n            itemTemplate: function(itemData, itemIndex, itemElement) {\r\n                if (itemData.icon) {\r\n                    (0, _icon.getImageContainer)(itemData.icon).appendTo(itemElement)\r\n                }(0, _renderer2.default)(\"<span>\").toggleClass(\"dx-area-field\", !itemData.items).data(\"field\", itemData.field).text(itemData.text).appendTo(itemElement)\r\n            },\r\n            onItemCollapsed: function(e) {\r\n                var index = (0, _array.inArray)(e.itemData.path, that._expandedPaths);\r\n                if (index >= 0) {\r\n                    that._expandedPaths.splice(index, 1)\r\n                }\r\n            },\r\n            onItemExpanded: function(e) {\r\n                var index = (0, _array.inArray)(e.itemData.path, that._expandedPaths);\r\n                if (index < 0) {\r\n                    that._expandedPaths.push(e.itemData.path)\r\n                }\r\n            },\r\n            onItemSelectionChanged: function(e) {\r\n                var data = e.itemData;\r\n                var field;\r\n                var fields;\r\n                var needSelectDefaultItem = true;\r\n                var area;\r\n                if (data.items) {\r\n                    if (data.selected) {\r\n                        treeView.unselectItem(data);\r\n                        return\r\n                    }\r\n                    that._processDemandState(function() {\r\n                        fields = getDimensionFields(data, dataSource.fields());\r\n                        for (var i = 0; i < fields.length; i++) {\r\n                            if (fields[i].area) {\r\n                                needSelectDefaultItem = false;\r\n                                break\r\n                            }\r\n                        }\r\n                    });\r\n                    if (needSelectDefaultItem) {\r\n                        var item = getFirstItem(data, function(item) {\r\n                            return item.isDefault\r\n                        }) || getFirstItem(data, function(item) {\r\n                            return (0, _type.isDefined)(item.index)\r\n                        });\r\n                        item && treeView.selectItem(item);\r\n                        return\r\n                    }\r\n                } else {\r\n                    field = dataSource.fields()[data.index];\r\n                    if (data.selected) {\r\n                        area = field.isMeasure ? \"data\" : \"column\"\r\n                    }\r\n                    if (field) {\r\n                        fields = [field]\r\n                    }\r\n                }\r\n                that._applyChanges(fields, {\r\n                    area: area,\r\n                    areaIndex: void 0\r\n                })\r\n            }\r\n        });\r\n        var dataChanged = function() {\r\n            var scrollable = getScrollable(container);\r\n            var scrollTop = scrollable ? scrollable.scrollTop() : 0;\r\n            treeView.option({\r\n                dataSource: that._createFieldsDataSource(dataSource)\r\n            });\r\n            scrollable = getScrollable(container);\r\n            if (scrollable) {\r\n                scrollable.scrollTo({\r\n                    y: scrollTop\r\n                });\r\n                scrollable.update()\r\n            }\r\n        };\r\n        that._dataChangedHandlers.push(dataChanged)\r\n    },\r\n    _renderAreaFields: function($container, area) {\r\n        var that = this;\r\n        var dataSource = that._dataSource;\r\n        var fields = dataSource ? (0, _extend.extend)(true, [], dataSource.getAreaFields(area, true)) : [];\r\n        $container.empty();\r\n        (0, _iterator.each)(fields, function(_, field) {\r\n            if (false !== field.visible) {\r\n                that.renderField(field, true).appendTo($container)\r\n            }\r\n        })\r\n    },\r\n    _renderArea: function(container, area) {\r\n        var that = this;\r\n        var $areaContainer = (0, _renderer2.default)(DIV).addClass(\"dx-area\").appendTo(container);\r\n        var $fieldsHeaderContainer = (0, _renderer2.default)(DIV).addClass(\"dx-area-fields-header\").appendTo($areaContainer);\r\n        var caption = that.option(\"texts.\" + area + \"Fields\");\r\n        var $fieldsContent;\r\n        var render;\r\n        (0, _renderer2.default)(\"<span>\").addClass(\"dx-area-icon\").addClass(\"dx-area-icon-\" + area).appendTo($fieldsHeaderContainer);\r\n        (0, _renderer2.default)(\"<span>\").html(\"&nbsp;\").appendTo($fieldsHeaderContainer);\r\n        (0, _renderer2.default)(\"<span>\").addClass(\"dx-area-caption\").text(caption).appendTo($fieldsHeaderContainer);\r\n        var $fieldsContainer = (0, _renderer2.default)(DIV).addClass(\"dx-area-fields\").addClass(AREA_DRAG_CLASS).appendTo($areaContainer);\r\n        if (\"all\" !== area) {\r\n            $fieldsContainer.attr(\"group\", area).attr(\"allow-scrolling\", true);\r\n            $fieldsContent = (0, _renderer2.default)(DIV).addClass(\"dx-area-field-container\").appendTo($fieldsContainer);\r\n            render = function() {\r\n                that._renderAreaFields($fieldsContent, area)\r\n            };\r\n            that._dataChangedHandlers.push(render);\r\n            render();\r\n            $fieldsContainer.dxScrollable()\r\n        } else {\r\n            $areaContainer.addClass(\"dx-all-fields\");\r\n            $fieldsContainer.addClass(\"dx-treeview-border-visible\");\r\n            that._renderFieldsTreeView($fieldsContainer)\r\n        }\r\n    },\r\n    _getSortableOptions: function() {\r\n        return {}\r\n    },\r\n    _adjustSortableOnChangedArgs: function() {},\r\n    resetTreeView: function() {\r\n        var treeView = this.$element().find(\".dx-treeview\").dxTreeView(\"instance\");\r\n        if (treeView) {\r\n            treeView.option(\"searchValue\", \"\");\r\n            treeView.collapseAll()\r\n        }\r\n    },\r\n    applyChanges: function() {\r\n        var state = this.option(\"state\");\r\n        if ((0, _type.isDefined)(state)) {\r\n            this._dataSource.state(state)\r\n        }\r\n    },\r\n    cancelChanges: function() {\r\n        var dataSource = this._dataSource;\r\n        if (!dataSource.isLoading()) {\r\n            this.option(\"state\", dataSource.state());\r\n            return true\r\n        }\r\n        return false\r\n    },\r\n    getDataSource: function() {\r\n        return this._dataSource\r\n    },\r\n    updateDimensions: function() {\r\n        var $scrollableElements = this.$element().find(\".dx-area .dx-scrollable\");\r\n        $scrollableElements.dxScrollable(\"update\")\r\n    },\r\n    _visibilityChanged: function(visible) {\r\n        if (visible && hasWindow) {\r\n            this.updateDimensions()\r\n        }\r\n    }\r\n});\r\n(0, _component_registrator2.default)(\"dxPivotGridFieldChooser\", FieldChooser);\r\nmodule.exports = FieldChooser;\r\n"]},"metadata":{},"sourceType":"module"}