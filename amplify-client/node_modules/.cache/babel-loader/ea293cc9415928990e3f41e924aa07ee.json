{"ast":null,"code":"import _assertThisInitialized from \"C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _get from \"C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/@babel/runtime/helpers/esm/get\";\nimport _getPrototypeOf from \"C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/@babel/runtime/helpers/esm/createSuper\";\nimport _classCallCheck from \"C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport { Subject } from '../Subject';\nimport { Subscription } from '../Subscription';\nimport { OuterSubscriber } from '../OuterSubscriber';\nimport { subscribeToResult } from '../util/subscribeToResult';\nexport function windowToggle(openings, closingSelector) {\n  return function (source) {\n    return source.lift(new WindowToggleOperator(openings, closingSelector));\n  };\n}\n\nvar WindowToggleOperator = /*#__PURE__*/function () {\n  function WindowToggleOperator(openings, closingSelector) {\n    _classCallCheck(this, WindowToggleOperator);\n\n    this.openings = openings;\n    this.closingSelector = closingSelector;\n  }\n\n  _createClass(WindowToggleOperator, [{\n    key: \"call\",\n    value: function call(subscriber, source) {\n      return source.subscribe(new WindowToggleSubscriber(subscriber, this.openings, this.closingSelector));\n    }\n  }]);\n\n  return WindowToggleOperator;\n}();\n\nvar WindowToggleSubscriber = /*#__PURE__*/function (_OuterSubscriber) {\n  _inherits(WindowToggleSubscriber, _OuterSubscriber);\n\n  var _super = _createSuper(WindowToggleSubscriber);\n\n  function WindowToggleSubscriber(destination, openings, closingSelector) {\n    var _this;\n\n    _classCallCheck(this, WindowToggleSubscriber);\n\n    _this = _super.call(this, destination);\n    _this.openings = openings;\n    _this.closingSelector = closingSelector;\n    _this.contexts = [];\n\n    _this.add(_this.openSubscription = subscribeToResult(_assertThisInitialized(_this), openings, openings));\n\n    return _this;\n  }\n\n  _createClass(WindowToggleSubscriber, [{\n    key: \"_next\",\n    value: function _next(value) {\n      var contexts = this.contexts;\n\n      if (contexts) {\n        var len = contexts.length;\n\n        for (var i = 0; i < len; i++) {\n          contexts[i].window.next(value);\n        }\n      }\n    }\n  }, {\n    key: \"_error\",\n    value: function _error(err) {\n      var contexts = this.contexts;\n      this.contexts = null;\n\n      if (contexts) {\n        var len = contexts.length;\n        var index = -1;\n\n        while (++index < len) {\n          var context = contexts[index];\n          context.window.error(err);\n          context.subscription.unsubscribe();\n        }\n      }\n\n      _get(_getPrototypeOf(WindowToggleSubscriber.prototype), \"_error\", this).call(this, err);\n    }\n  }, {\n    key: \"_complete\",\n    value: function _complete() {\n      var contexts = this.contexts;\n      this.contexts = null;\n\n      if (contexts) {\n        var len = contexts.length;\n        var index = -1;\n\n        while (++index < len) {\n          var context = contexts[index];\n          context.window.complete();\n          context.subscription.unsubscribe();\n        }\n      }\n\n      _get(_getPrototypeOf(WindowToggleSubscriber.prototype), \"_complete\", this).call(this);\n    }\n  }, {\n    key: \"_unsubscribe\",\n    value: function _unsubscribe() {\n      var contexts = this.contexts;\n      this.contexts = null;\n\n      if (contexts) {\n        var len = contexts.length;\n        var index = -1;\n\n        while (++index < len) {\n          var context = contexts[index];\n          context.window.unsubscribe();\n          context.subscription.unsubscribe();\n        }\n      }\n    }\n  }, {\n    key: \"notifyNext\",\n    value: function notifyNext(outerValue, innerValue, outerIndex, innerIndex, innerSub) {\n      if (outerValue === this.openings) {\n        var closingNotifier;\n\n        try {\n          var closingSelector = this.closingSelector;\n          closingNotifier = closingSelector(innerValue);\n        } catch (e) {\n          return this.error(e);\n        }\n\n        var window = new Subject();\n        var subscription = new Subscription();\n        var context = {\n          window: window,\n          subscription: subscription\n        };\n        this.contexts.push(context);\n        var innerSubscription = subscribeToResult(this, closingNotifier, context);\n\n        if (innerSubscription.closed) {\n          this.closeWindow(this.contexts.length - 1);\n        } else {\n          innerSubscription.context = context;\n          subscription.add(innerSubscription);\n        }\n\n        this.destination.next(window);\n      } else {\n        this.closeWindow(this.contexts.indexOf(outerValue));\n      }\n    }\n  }, {\n    key: \"notifyError\",\n    value: function notifyError(err) {\n      this.error(err);\n    }\n  }, {\n    key: \"notifyComplete\",\n    value: function notifyComplete(inner) {\n      if (inner !== this.openSubscription) {\n        this.closeWindow(this.contexts.indexOf(inner.context));\n      }\n    }\n  }, {\n    key: \"closeWindow\",\n    value: function closeWindow(index) {\n      if (index === -1) {\n        return;\n      }\n\n      var contexts = this.contexts;\n      var context = contexts[index];\n      var window = context.window,\n          subscription = context.subscription;\n      contexts.splice(index, 1);\n      window.complete();\n      subscription.unsubscribe();\n    }\n  }]);\n\n  return WindowToggleSubscriber;\n}(OuterSubscriber);","map":{"version":3,"sources":["../../../src/internal/operators/windowToggle.ts"],"names":[],"mappings":"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","sourcesContent":["import { Subject } from '../Subject';\r\nimport { Subscription } from '../Subscription';\r\nimport { OuterSubscriber } from '../OuterSubscriber';\r\nimport { subscribeToResult } from '../util/subscribeToResult';\r\nexport function windowToggle(openings, closingSelector) {\r\n    return (source) => source.lift(new WindowToggleOperator(openings, closingSelector));\r\n}\r\nclass WindowToggleOperator {\r\n    constructor(openings, closingSelector) {\r\n        this.openings = openings;\r\n        this.closingSelector = closingSelector;\r\n    }\r\n    call(subscriber, source) {\r\n        return source.subscribe(new WindowToggleSubscriber(subscriber, this.openings, this.closingSelector));\r\n    }\r\n}\r\nclass WindowToggleSubscriber extends OuterSubscriber {\r\n    constructor(destination, openings, closingSelector) {\r\n        super(destination);\r\n        this.openings = openings;\r\n        this.closingSelector = closingSelector;\r\n        this.contexts = [];\r\n        this.add(this.openSubscription = subscribeToResult(this, openings, openings));\r\n    }\r\n    _next(value) {\r\n        const { contexts } = this;\r\n        if (contexts) {\r\n            const len = contexts.length;\r\n            for (let i = 0; i < len; i++) {\r\n                contexts[i].window.next(value);\r\n            }\r\n        }\r\n    }\r\n    _error(err) {\r\n        const { contexts } = this;\r\n        this.contexts = null;\r\n        if (contexts) {\r\n            const len = contexts.length;\r\n            let index = -1;\r\n            while (++index < len) {\r\n                const context = contexts[index];\r\n                context.window.error(err);\r\n                context.subscription.unsubscribe();\r\n            }\r\n        }\r\n        super._error(err);\r\n    }\r\n    _complete() {\r\n        const { contexts } = this;\r\n        this.contexts = null;\r\n        if (contexts) {\r\n            const len = contexts.length;\r\n            let index = -1;\r\n            while (++index < len) {\r\n                const context = contexts[index];\r\n                context.window.complete();\r\n                context.subscription.unsubscribe();\r\n            }\r\n        }\r\n        super._complete();\r\n    }\r\n    _unsubscribe() {\r\n        const { contexts } = this;\r\n        this.contexts = null;\r\n        if (contexts) {\r\n            const len = contexts.length;\r\n            let index = -1;\r\n            while (++index < len) {\r\n                const context = contexts[index];\r\n                context.window.unsubscribe();\r\n                context.subscription.unsubscribe();\r\n            }\r\n        }\r\n    }\r\n    notifyNext(outerValue, innerValue, outerIndex, innerIndex, innerSub) {\r\n        if (outerValue === this.openings) {\r\n            let closingNotifier;\r\n            try {\r\n                const { closingSelector } = this;\r\n                closingNotifier = closingSelector(innerValue);\r\n            }\r\n            catch (e) {\r\n                return this.error(e);\r\n            }\r\n            const window = new Subject();\r\n            const subscription = new Subscription();\r\n            const context = { window, subscription };\r\n            this.contexts.push(context);\r\n            const innerSubscription = subscribeToResult(this, closingNotifier, context);\r\n            if (innerSubscription.closed) {\r\n                this.closeWindow(this.contexts.length - 1);\r\n            }\r\n            else {\r\n                innerSubscription.context = context;\r\n                subscription.add(innerSubscription);\r\n            }\r\n            this.destination.next(window);\r\n        }\r\n        else {\r\n            this.closeWindow(this.contexts.indexOf(outerValue));\r\n        }\r\n    }\r\n    notifyError(err) {\r\n        this.error(err);\r\n    }\r\n    notifyComplete(inner) {\r\n        if (inner !== this.openSubscription) {\r\n            this.closeWindow(this.contexts.indexOf(inner.context));\r\n        }\r\n    }\r\n    closeWindow(index) {\r\n        if (index === -1) {\r\n            return;\r\n        }\r\n        const { contexts } = this;\r\n        const context = contexts[index];\r\n        const { window, subscription } = context;\r\n        contexts.splice(index, 1);\r\n        window.complete();\r\n        subscription.unsubscribe();\r\n    }\r\n}\r\n//# sourceMappingURL=windowToggle.js.map"]},"metadata":{},"sourceType":"module"}