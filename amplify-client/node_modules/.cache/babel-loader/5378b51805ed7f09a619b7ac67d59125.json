{"ast":null,"code":"import _inherits from \"C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/@babel/runtime/helpers/esm/createSuper\";\nimport _classCallCheck from \"C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport { Subscriber } from '../Subscriber';\nimport { Subject } from '../Subject';\nexport function windowCount(windowSize) {\n  var startWindowEvery = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n  return function windowCountOperatorFunction(source) {\n    return source.lift(new WindowCountOperator(windowSize, startWindowEvery));\n  };\n}\n\nvar WindowCountOperator = /*#__PURE__*/function () {\n  function WindowCountOperator(windowSize, startWindowEvery) {\n    _classCallCheck(this, WindowCountOperator);\n\n    this.windowSize = windowSize;\n    this.startWindowEvery = startWindowEvery;\n  }\n\n  _createClass(WindowCountOperator, [{\n    key: \"call\",\n    value: function call(subscriber, source) {\n      return source.subscribe(new WindowCountSubscriber(subscriber, this.windowSize, this.startWindowEvery));\n    }\n  }]);\n\n  return WindowCountOperator;\n}();\n\nvar WindowCountSubscriber = /*#__PURE__*/function (_Subscriber) {\n  _inherits(WindowCountSubscriber, _Subscriber);\n\n  var _super = _createSuper(WindowCountSubscriber);\n\n  function WindowCountSubscriber(destination, windowSize, startWindowEvery) {\n    var _this;\n\n    _classCallCheck(this, WindowCountSubscriber);\n\n    _this = _super.call(this, destination);\n    _this.destination = destination;\n    _this.windowSize = windowSize;\n    _this.startWindowEvery = startWindowEvery;\n    _this.windows = [new Subject()];\n    _this.count = 0;\n    destination.next(_this.windows[0]);\n    return _this;\n  }\n\n  _createClass(WindowCountSubscriber, [{\n    key: \"_next\",\n    value: function _next(value) {\n      var startWindowEvery = this.startWindowEvery > 0 ? this.startWindowEvery : this.windowSize;\n      var destination = this.destination;\n      var windowSize = this.windowSize;\n      var windows = this.windows;\n      var len = windows.length;\n\n      for (var i = 0; i < len && !this.closed; i++) {\n        windows[i].next(value);\n      }\n\n      var c = this.count - windowSize + 1;\n\n      if (c >= 0 && c % startWindowEvery === 0 && !this.closed) {\n        windows.shift().complete();\n      }\n\n      if (++this.count % startWindowEvery === 0 && !this.closed) {\n        var window = new Subject();\n        windows.push(window);\n        destination.next(window);\n      }\n    }\n  }, {\n    key: \"_error\",\n    value: function _error(err) {\n      var windows = this.windows;\n\n      if (windows) {\n        while (windows.length > 0 && !this.closed) {\n          windows.shift().error(err);\n        }\n      }\n\n      this.destination.error(err);\n    }\n  }, {\n    key: \"_complete\",\n    value: function _complete() {\n      var windows = this.windows;\n\n      if (windows) {\n        while (windows.length > 0 && !this.closed) {\n          windows.shift().complete();\n        }\n      }\n\n      this.destination.complete();\n    }\n  }, {\n    key: \"_unsubscribe\",\n    value: function _unsubscribe() {\n      this.count = 0;\n      this.windows = null;\n    }\n  }]);\n\n  return WindowCountSubscriber;\n}(Subscriber);","map":{"version":3,"sources":["../../../src/internal/operators/windowCount.ts"],"names":[],"mappings":"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","sourcesContent":["import { Subscriber } from '../Subscriber';\r\nimport { Subject } from '../Subject';\r\nexport function windowCount(windowSize, startWindowEvery = 0) {\r\n    return function windowCountOperatorFunction(source) {\r\n        return source.lift(new WindowCountOperator(windowSize, startWindowEvery));\r\n    };\r\n}\r\nclass WindowCountOperator {\r\n    constructor(windowSize, startWindowEvery) {\r\n        this.windowSize = windowSize;\r\n        this.startWindowEvery = startWindowEvery;\r\n    }\r\n    call(subscriber, source) {\r\n        return source.subscribe(new WindowCountSubscriber(subscriber, this.windowSize, this.startWindowEvery));\r\n    }\r\n}\r\nclass WindowCountSubscriber extends Subscriber {\r\n    constructor(destination, windowSize, startWindowEvery) {\r\n        super(destination);\r\n        this.destination = destination;\r\n        this.windowSize = windowSize;\r\n        this.startWindowEvery = startWindowEvery;\r\n        this.windows = [new Subject()];\r\n        this.count = 0;\r\n        destination.next(this.windows[0]);\r\n    }\r\n    _next(value) {\r\n        const startWindowEvery = (this.startWindowEvery > 0) ? this.startWindowEvery : this.windowSize;\r\n        const destination = this.destination;\r\n        const windowSize = this.windowSize;\r\n        const windows = this.windows;\r\n        const len = windows.length;\r\n        for (let i = 0; i < len && !this.closed; i++) {\r\n            windows[i].next(value);\r\n        }\r\n        const c = this.count - windowSize + 1;\r\n        if (c >= 0 && c % startWindowEvery === 0 && !this.closed) {\r\n            windows.shift().complete();\r\n        }\r\n        if (++this.count % startWindowEvery === 0 && !this.closed) {\r\n            const window = new Subject();\r\n            windows.push(window);\r\n            destination.next(window);\r\n        }\r\n    }\r\n    _error(err) {\r\n        const windows = this.windows;\r\n        if (windows) {\r\n            while (windows.length > 0 && !this.closed) {\r\n                windows.shift().error(err);\r\n            }\r\n        }\r\n        this.destination.error(err);\r\n    }\r\n    _complete() {\r\n        const windows = this.windows;\r\n        if (windows) {\r\n            while (windows.length > 0 && !this.closed) {\r\n                windows.shift().complete();\r\n            }\r\n        }\r\n        this.destination.complete();\r\n    }\r\n    _unsubscribe() {\r\n        this.count = 0;\r\n        this.windows = null;\r\n    }\r\n}\r\n//# sourceMappingURL=windowCount.js.map"]},"metadata":{},"sourceType":"module"}