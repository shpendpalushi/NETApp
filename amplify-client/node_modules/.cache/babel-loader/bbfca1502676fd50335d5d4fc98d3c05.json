{"ast":null,"code":"/**\r\n * DevExtreme (viz/series/points/label.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar _format_helper = require(\"../../../format_helper\");\n\nvar _utils = require(\"../../core/utils\");\n\nvar _iterator = require(\"../../../core/utils/iterator\");\n\nvar _extend = require(\"../../../core/utils/extend\");\n\nvar _math = Math;\nvar _round = _math.round;\nvar _floor = _math.floor;\nvar _abs = _math.abs;\nvar CONNECTOR_LENGTH = 12;\nvar LABEL_BACKGROUND_PADDING_X = 8;\nvar LABEL_BACKGROUND_PADDING_Y = 4;\n\nfunction getClosestCoord(point, coords) {\n  var closestDistance = 1 / 0;\n  var closestCoord;\n  (0, _iterator.each)(coords, function (_, coord) {\n    var x = point[0] - coord[0];\n    var y = point[1] - coord[1];\n    var distance = x * x + y * y;\n\n    if (distance < closestDistance) {\n      closestDistance = distance;\n      closestCoord = coord;\n    }\n  });\n  return [_floor(closestCoord[0]), _floor(closestCoord[1])];\n}\n\nfunction getCrossCoord(rect, coord, indexOffset) {\n  return (coord - rect[0 + indexOffset]) / (rect[2 + indexOffset] - rect[0 + indexOffset]) * (rect[3 - indexOffset] - rect[1 - indexOffset]) + rect[1 - indexOffset];\n}\n\nvar barPointStrategy = {\n  isLabelInside: function isLabelInside(labelPoint, figure) {\n    var xc = labelPoint.x + labelPoint.width / 2;\n    var yc = labelPoint.y + labelPoint.height / 2;\n    return figure.x <= xc && xc <= figure.x + figure.width && figure.y <= yc && yc <= figure.y + figure.height;\n  },\n  prepareLabelPoints: function prepareLabelPoints(bBox, rotatedBBox, isHorizontal, angle, figureCenter) {\n    var x1 = rotatedBBox.x;\n    var xc = x1 + rotatedBBox.width / 2;\n    var x2 = x1 + rotatedBBox.width - 1;\n    var y1 = rotatedBBox.y;\n    var yc = y1 + rotatedBBox.height / 2;\n    var y2 = y1 + rotatedBBox.height - 1;\n    var labelPoints;\n    var isRectangular = _abs(angle) % 90 === 0;\n\n    if (figureCenter[0] > x1 && figureCenter[0] < x2) {\n      if (isRectangular) {\n        labelPoints = [[figureCenter[0], _abs(figureCenter[1] - y1) < _abs(figureCenter[1] - y2) ? y1 : y2]];\n      } else {\n        labelPoints = [[figureCenter[0], getCrossCoord([x1, y1, x2, y2], figureCenter[0], 0)]];\n      }\n    } else {\n      if (figureCenter[1] > y1 && figureCenter[1] < y2) {\n        if (isRectangular) {\n          labelPoints = [[_abs(figureCenter[0] - x1) < _abs(figureCenter[0] - x2) ? x1 : x2, figureCenter[1]]];\n        } else {\n          labelPoints = [[getCrossCoord([x1, y1, x2, y2], figureCenter[1], 1), figureCenter[1]]];\n        }\n      } else {\n        if (isRectangular) {\n          labelPoints = [[x1, y1], [isHorizontal ? x1 : xc, isHorizontal ? yc : y1], [x2, y1], [x1, y2], [isHorizontal ? x2 : xc, isHorizontal ? yc : y2], [x2, y2]];\n        } else {\n          labelPoints = [[xc, yc]];\n        }\n      }\n    }\n\n    return labelPoints;\n  },\n  isHorizontal: function isHorizontal(bBox, figure) {\n    return bBox.x > figure.x + figure.width || bBox.x + bBox.width < figure.x;\n  },\n  getFigureCenter: function getFigureCenter(figure) {\n    return [_floor(figure.x + figure.width / 2), _floor(figure.y + figure.height / 2)];\n  },\n  findFigurePoint: function findFigurePoint(figure, labelPoint) {\n    var figureCenter = barPointStrategy.getFigureCenter(figure);\n    var point = getClosestCoord(labelPoint, [[figure.x, figureCenter[1]], [figureCenter[0], figure.y + figure.height], [figure.x + figure.width, figureCenter[1]], [figureCenter[0], figure.y]]);\n    return point;\n  },\n  adjustPoints: function adjustPoints(points) {\n    var lineIsVertical = _abs(points[1] - points[3]) <= 1;\n    var lineIsHorizontal = _abs(points[0] - points[2]) <= 1;\n\n    if (lineIsHorizontal) {\n      points[0] = points[2];\n    }\n\n    if (lineIsVertical) {\n      points[1] = points[3];\n    }\n\n    return points;\n  }\n};\nvar symbolPointStrategy = {\n  isLabelInside: function isLabelInside() {\n    return false;\n  },\n  prepareLabelPoints: barPointStrategy.prepareLabelPoints,\n  isHorizontal: function isHorizontal(bBox, figure) {\n    return bBox.x > figure.x + figure.r || bBox.x + bBox.width < figure.x - figure.r;\n  },\n  getFigureCenter: function getFigureCenter(figure) {\n    return [figure.x, figure.y];\n  },\n  findFigurePoint: function findFigurePoint(figure, labelPoint) {\n    var angle = Math.atan2(figure.y - labelPoint[1], labelPoint[0] - figure.x);\n    return [_round(figure.x + figure.r * Math.cos(angle)), _round(figure.y - figure.r * Math.sin(angle))];\n  },\n  adjustPoints: barPointStrategy.adjustPoints\n};\nvar piePointStrategy = {\n  isLabelInside: function isLabelInside(_0, _1, isOutside) {\n    return !isOutside;\n  },\n  prepareLabelPoints: function prepareLabelPoints(bBox, rotatedBBox, isHorizontal, angle) {\n    var xl = bBox.x;\n    var xr = xl + bBox.width;\n\n    var xc = xl + _round(bBox.width / 2);\n\n    var yt = bBox.y;\n    var yb = yt + bBox.height;\n\n    var yc = yt + _round(bBox.height / 2);\n\n    var points = [[[xl, yt], [xr, yt]], [[xr, yt], [xr, yb]], [[xr, yb], [xl, yb]], [[xl, yb], [xl, yt]]];\n    var cosSin = (0, _utils.getCosAndSin)(angle);\n\n    if (0 === angle) {\n      points = isHorizontal ? [[xl, yc], [xr, yc]] : [[xc, yt], [xc, yb]];\n    } else {\n      points = points.map(function (pair) {\n        return pair.map(function (point) {\n          return [_round((point[0] - xc) * cosSin.cos + (point[1] - yc) * cosSin.sin + xc), _round(-(point[0] - xc) * cosSin.sin + (point[1] - yc) * cosSin.cos + yc)];\n        });\n      }).reduce(function (r, pair) {\n        var point1x = pair[0][0];\n        var point1y = pair[0][1];\n        var point2x = pair[1][0];\n        var point2y = pair[1][1];\n\n        if (isHorizontal) {\n          if (point1y >= yc && yc >= point2y || point1y <= yc && yc <= point2y) {\n            r.push([(yc - point1y) * (point2x - point1x) / (point2y - point1y) + point1x, yc]);\n          }\n        } else {\n          if (point1x >= xc && xc >= point2x || point1x <= xc && xc <= point2x) {\n            r.push([xc, (xc - point1x) * (point2y - point1y) / (point2x - point1x) + point1y]);\n          }\n        }\n\n        return r;\n      }, []);\n    }\n\n    return points;\n  },\n  isHorizontal: function isHorizontal(bBox, figure) {\n    return bBox.x > figure.x || figure.x > bBox.x + bBox.width;\n  },\n  getFigureCenter: symbolPointStrategy.getFigureCenter,\n  findFigurePoint: function findFigurePoint(figure, labelPoint, isHorizontal) {\n    if (!isHorizontal) {\n      return [figure.x, figure.y];\n    }\n\n    var labelX = labelPoint[0];\n\n    var x = _round(figure.x + (figure.y - labelPoint[1]) / Math.tan((0, _utils.degreesToRadians)(figure.angle)));\n\n    var points = [figure.x, figure.y, x, labelPoint[1]];\n\n    if (!(figure.x <= x && x <= labelX) && !(labelX <= x && x <= figure.x)) {\n      if (_abs(figure.x - labelX) < CONNECTOR_LENGTH) {\n        points = [figure.x, figure.y];\n      } else {\n        if (figure.x <= labelX) {\n          points[2] = figure.x + CONNECTOR_LENGTH;\n        } else {\n          points[2] = figure.x - CONNECTOR_LENGTH;\n        }\n      }\n    }\n\n    return points;\n  },\n  adjustPoints: function adjustPoints(points) {\n    return points;\n  }\n};\n\nfunction selectStrategy(figure) {\n  return void 0 !== figure.angle && piePointStrategy || void 0 !== figure.r && symbolPointStrategy || barPointStrategy;\n}\n\nfunction disposeItem(obj, field) {\n  obj[field] && obj[field].dispose();\n  obj[field] = null;\n}\n\nfunction checkBackground(background) {\n  return background && (background.fill && \"none\" !== background.fill || background[\"stroke-width\"] > 0 && background.stroke && \"none\" !== background.stroke);\n}\n\nfunction checkConnector(connector) {\n  return connector && connector[\"stroke-width\"] > 0 && connector.stroke && \"none\" !== connector.stroke;\n}\n\nfunction formatText(data, options) {\n  var format = options.format;\n  data.valueText = (0, _format_helper.format)(data.value, format);\n  data.argumentText = (0, _format_helper.format)(data.argument, options.argumentFormat);\n\n  if (void 0 !== data.percent) {\n    data.percentText = (0, _format_helper.format)(data.percent, {\n      type: \"percent\",\n      precision: format && format.percentPrecision\n    });\n  }\n\n  if (void 0 !== data.total) {\n    data.totalText = (0, _format_helper.format)(data.total, format);\n  }\n\n  if (void 0 !== data.openValue) {\n    data.openValueText = (0, _format_helper.format)(data.openValue, format);\n  }\n\n  if (void 0 !== data.closeValue) {\n    data.closeValueText = (0, _format_helper.format)(data.closeValue, format);\n  }\n\n  if (void 0 !== data.lowValue) {\n    data.lowValueText = (0, _format_helper.format)(data.lowValue, format);\n  }\n\n  if (void 0 !== data.highValue) {\n    data.highValueText = (0, _format_helper.format)(data.highValue, format);\n  }\n\n  if (void 0 !== data.reductionValue) {\n    data.reductionValueText = (0, _format_helper.format)(data.reductionValue, format);\n  }\n\n  return options.customizeText ? options.customizeText.call(data, data) : data.valueText;\n}\n\nfunction Label(renderSettings) {\n  this._renderer = renderSettings.renderer;\n  this._container = renderSettings.labelsGroup;\n  this._point = renderSettings.point;\n  this._strategy = renderSettings.strategy;\n  this._rowCount = 1;\n}\n\nLabel.prototype = {\n  constructor: Label,\n  setColor: function setColor(color) {\n    this._color = color;\n  },\n  setOptions: function setOptions(options) {\n    this._options = options;\n  },\n  setData: function setData(data) {\n    this._data = data;\n  },\n  setDataField: function setDataField(fieldName, fieldValue) {\n    this._data = this._data || {};\n    this._data[fieldName] = fieldValue;\n  },\n  getData: function getData() {\n    return this._data;\n  },\n  setFigureToDrawConnector: function setFigureToDrawConnector(figure) {\n    this._figure = figure;\n  },\n  dispose: function dispose() {\n    var that = this;\n    disposeItem(that, \"_group\");\n    that._data = that._options = that._textContent = that._visible = that._insideGroup = that._text = that._background = that._connector = that._figure = null;\n  },\n  _setVisibility: function _setVisibility(value, state) {\n    this._group && this._group.attr({\n      visibility: value\n    });\n    this._visible = state;\n  },\n  isVisible: function isVisible() {\n    return this._visible;\n  },\n  hide: function hide(holdInvisible) {\n    this._holdVisibility = !!holdInvisible;\n\n    this._hide();\n  },\n  _hide: function _hide() {\n    this._setVisibility(\"hidden\", false);\n  },\n  show: function show(holdVisible) {\n    var correctPosition = !this._drawn;\n\n    if (this._point.hasValue()) {\n      this._holdVisibility = !!holdVisible;\n\n      this._show();\n\n      correctPosition && this._point.correctLabelPosition(this);\n    }\n  },\n  _show: function _show() {\n    var that = this;\n    var renderer = that._renderer;\n    var container = that._container;\n    var options = that._options || {};\n    var text = that._textContent = formatText(that._data, that._options) || null;\n\n    if (text) {\n      if (!that._group) {\n        that._group = renderer.g().append(container);\n        that._insideGroup = renderer.g().append(that._group);\n        that._text = renderer.text(\"\", 0, 0).append(that._insideGroup);\n      }\n\n      that._text.css(options.attributes ? (0, _utils.patchFontOptions)(options.attributes.font) : {});\n\n      if (checkBackground(options.background)) {\n        that._background = that._background || renderer.rect().append(that._insideGroup).toBackground();\n\n        that._background.attr(options.background);\n\n        that._color && that._background.attr({\n          fill: that._color\n        });\n      } else {\n        disposeItem(that, \"_background\");\n      }\n\n      if (checkConnector(options.connector)) {\n        that._connector = that._connector || renderer.path([], \"line\").sharp().append(that._group).toBackground();\n\n        that._connector.attr(options.connector);\n\n        that._color && that._connector.attr({\n          stroke: that._color\n        });\n      } else {\n        disposeItem(that, \"_connector\");\n      }\n\n      that._text.attr({\n        text: text,\n        align: options.textAlignment,\n        \"class\": options.cssClass\n      });\n\n      that._updateBackground(that._text.getBBox());\n\n      that._setVisibility(\"visible\", true);\n\n      that._drawn = true;\n    } else {\n      that._hide();\n    }\n  },\n  _getLabelVisibility: function _getLabelVisibility(isVisible) {\n    return this._holdVisibility ? this.isVisible() : isVisible;\n  },\n  draw: function draw(isVisible) {\n    if (this._getLabelVisibility(isVisible)) {\n      this._show();\n\n      this._point && this._point.correctLabelPosition(this);\n    } else {\n      this._drawn = false;\n\n      this._hide();\n    }\n\n    return this;\n  },\n  _updateBackground: function _updateBackground(bBox) {\n    var that = this;\n\n    if (that._background) {\n      bBox.x -= LABEL_BACKGROUND_PADDING_X;\n      bBox.y -= LABEL_BACKGROUND_PADDING_Y;\n      bBox.width += 2 * LABEL_BACKGROUND_PADDING_X;\n      bBox.height += 2 * LABEL_BACKGROUND_PADDING_Y;\n\n      that._background.attr(bBox);\n    }\n\n    that._bBoxWithoutRotation = (0, _extend.extend)({}, bBox);\n    var rotationAngle = that._options.rotationAngle || 0;\n\n    that._insideGroup.rotate(rotationAngle, bBox.x + bBox.width / 2, bBox.y + bBox.height / 2);\n\n    bBox = (0, _utils.rotateBBox)(bBox, [bBox.x + bBox.width / 2, bBox.y + bBox.height / 2], -rotationAngle);\n    that._bBox = bBox;\n  },\n  getFigureCenter: function getFigureCenter() {\n    var figure = this._figure;\n    var strategy = this._strategy || selectStrategy(figure);\n    return strategy.getFigureCenter(figure);\n  },\n  _getConnectorPoints: function _getConnectorPoints() {\n    var that = this;\n    var figure = that._figure;\n    var options = that._options;\n    var strategy = that._strategy || selectStrategy(figure);\n\n    var bBox = that._shiftBBox(that._bBoxWithoutRotation);\n\n    var rotatedBBox = that.getBoundingRect();\n    var labelPoint;\n    var points = [];\n    var isHorizontal;\n\n    if (!strategy.isLabelInside(bBox, figure, \"inside\" !== options.position)) {\n      isHorizontal = strategy.isHorizontal(bBox, figure);\n      var figureCenter = that.getFigureCenter();\n      points = strategy.prepareLabelPoints(bBox, rotatedBBox, isHorizontal, -options.rotationAngle || 0, figureCenter);\n      labelPoint = getClosestCoord(figureCenter, points);\n      points = strategy.findFigurePoint(figure, labelPoint, isHorizontal);\n      points = points.concat(labelPoint);\n    }\n\n    return strategy.adjustPoints(points);\n  },\n  fit: function fit(maxWidth) {\n    var padding = this._background ? 2 * LABEL_BACKGROUND_PADDING_X : 0;\n    var rowCountChanged = false;\n\n    if (this._text) {\n      var _this$_text$setMaxSiz = this._text.setMaxSize(maxWidth - padding, void 0, this._options),\n          rowCount = _this$_text$setMaxSiz.rowCount,\n          textIsEmpty = _this$_text$setMaxSiz.textIsEmpty;\n\n      if (0 === rowCount) {\n        rowCount = 1;\n      }\n\n      if (rowCount !== this._rowCount) {\n        rowCountChanged = true;\n        this._rowCount = rowCount;\n      }\n\n      textIsEmpty && disposeItem(this, \"_background\");\n    }\n\n    this._updateBackground(this._text.getBBox());\n\n    return rowCountChanged;\n  },\n  resetEllipsis: function resetEllipsis() {\n    this._text && this._text.restoreText();\n\n    this._updateBackground(this._text.getBBox());\n  },\n  setTrackerData: function setTrackerData(point) {\n    this._text.data({\n      \"chart-data-point\": point\n    });\n\n    this._background && this._background.data({\n      \"chart-data-point\": point\n    });\n  },\n  hideInsideLabel: function hideInsideLabel(coords) {\n    return this._point.hideInsideLabel(this, coords);\n  },\n  getPoint: function getPoint() {\n    return this._point;\n  },\n  shift: function shift(x, y) {\n    var that = this;\n\n    if (that._textContent) {\n      that._insideGroup.attr({\n        translateX: that._x = _round(x - that._bBox.x),\n        translateY: that._y = _round(y - that._bBox.y)\n      });\n\n      if (that._connector) {\n        that._connector.attr({\n          points: that._getConnectorPoints()\n        });\n      }\n    }\n\n    return that;\n  },\n  getBoundingRect: function getBoundingRect() {\n    return this._shiftBBox(this._bBox);\n  },\n  _shiftBBox: function _shiftBBox(bBox) {\n    return this._textContent ? {\n      x: bBox.x + this._x,\n      y: bBox.y + this._y,\n      width: bBox.width,\n      height: bBox.height\n    } : {};\n  },\n  getLayoutOptions: function getLayoutOptions() {\n    var options = this._options;\n    return {\n      alignment: options.alignment,\n      background: checkBackground(options.background),\n      horizontalOffset: options.horizontalOffset,\n      verticalOffset: options.verticalOffset,\n      radialOffset: options.radialOffset,\n      position: options.position,\n      connectorOffset: (checkConnector(options.connector) ? CONNECTOR_LENGTH : 0) + (checkBackground(options.background) ? LABEL_BACKGROUND_PADDING_X : 0)\n    };\n  }\n};\nexports.Label = Label;","map":{"version":3,"sources":["C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/devextreme/viz/series/points/label.js"],"names":["_format_helper","require","_utils","_iterator","_extend","_math","_round","_floor","_abs","CONNECTOR_LENGTH","LABEL_BACKGROUND_PADDING_X","LABEL_BACKGROUND_PADDING_Y","closestDistance","x","point","coord","y","distance","closestCoord","rect","barPointStrategy","isLabelInside","xc","labelPoint","yc","figure","prepareLabelPoints","x1","rotatedBBox","x2","y1","y2","isRectangular","figureCenter","labelPoints","getCrossCoord","isHorizontal","bBox","getFigureCenter","findFigurePoint","getClosestCoord","adjustPoints","lineIsVertical","points","lineIsHorizontal","symbolPointStrategy","angle","Math","piePointStrategy","xl","xr","yt","yb","cosSin","point1x","pair","point1y","point2x","point2y","r","labelX","obj","background","connector","format","options","data","type","precision","percentPrecision","renderSettings","Label","constructor","setColor","setOptions","setData","setDataField","getData","setFigureToDrawConnector","dispose","that","disposeItem","_setVisibility","visibility","value","isVisible","hide","_hide","show","correctPosition","_show","renderer","container","text","formatText","checkBackground","fill","_color","checkConnector","stroke","align","cssClass","_getLabelVisibility","draw","_updateBackground","rotationAngle","strategy","selectStrategy","_getConnectorPoints","fit","padding","rowCountChanged","_this$_text$setMaxSiz","maxWidth","rowCount","textIsEmpty","resetEllipsis","setTrackerData","hideInsideLabel","getPoint","shift","translateX","translateY","getBoundingRect","_shiftBBox","width","height","getLayoutOptions","alignment","horizontalOffset","verticalOffset","radialOffset","position","connectorOffset","exports"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (viz/series/points/label.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar _format_helper = require(\"../../../format_helper\");\r\nvar _utils = require(\"../../core/utils\");\r\nvar _iterator = require(\"../../../core/utils/iterator\");\r\nvar _extend = require(\"../../../core/utils/extend\");\r\nvar _math = Math;\r\nvar _round = _math.round;\r\nvar _floor = _math.floor;\r\nvar _abs = _math.abs;\r\nvar CONNECTOR_LENGTH = 12;\r\nvar LABEL_BACKGROUND_PADDING_X = 8;\r\nvar LABEL_BACKGROUND_PADDING_Y = 4;\r\n\r\nfunction getClosestCoord(point, coords) {\r\n    var closestDistance = 1 / 0;\r\n    var closestCoord;\r\n    (0, _iterator.each)(coords, function(_, coord) {\r\n        var x = point[0] - coord[0];\r\n        var y = point[1] - coord[1];\r\n        var distance = x * x + y * y;\r\n        if (distance < closestDistance) {\r\n            closestDistance = distance;\r\n            closestCoord = coord\r\n        }\r\n    });\r\n    return [_floor(closestCoord[0]), _floor(closestCoord[1])]\r\n}\r\n\r\nfunction getCrossCoord(rect, coord, indexOffset) {\r\n    return (coord - rect[0 + indexOffset]) / (rect[2 + indexOffset] - rect[0 + indexOffset]) * (rect[3 - indexOffset] - rect[1 - indexOffset]) + rect[1 - indexOffset]\r\n}\r\nvar barPointStrategy = {\r\n    isLabelInside: function(labelPoint, figure) {\r\n        var xc = labelPoint.x + labelPoint.width / 2;\r\n        var yc = labelPoint.y + labelPoint.height / 2;\r\n        return figure.x <= xc && xc <= figure.x + figure.width && figure.y <= yc && yc <= figure.y + figure.height\r\n    },\r\n    prepareLabelPoints: function(bBox, rotatedBBox, isHorizontal, angle, figureCenter) {\r\n        var x1 = rotatedBBox.x;\r\n        var xc = x1 + rotatedBBox.width / 2;\r\n        var x2 = x1 + rotatedBBox.width - 1;\r\n        var y1 = rotatedBBox.y;\r\n        var yc = y1 + rotatedBBox.height / 2;\r\n        var y2 = y1 + rotatedBBox.height - 1;\r\n        var labelPoints;\r\n        var isRectangular = _abs(angle) % 90 === 0;\r\n        if (figureCenter[0] > x1 && figureCenter[0] < x2) {\r\n            if (isRectangular) {\r\n                labelPoints = [\r\n                    [figureCenter[0], _abs(figureCenter[1] - y1) < _abs(figureCenter[1] - y2) ? y1 : y2]\r\n                ]\r\n            } else {\r\n                labelPoints = [\r\n                    [figureCenter[0], getCrossCoord([x1, y1, x2, y2], figureCenter[0], 0)]\r\n                ]\r\n            }\r\n        } else {\r\n            if (figureCenter[1] > y1 && figureCenter[1] < y2) {\r\n                if (isRectangular) {\r\n                    labelPoints = [\r\n                        [_abs(figureCenter[0] - x1) < _abs(figureCenter[0] - x2) ? x1 : x2, figureCenter[1]]\r\n                    ]\r\n                } else {\r\n                    labelPoints = [\r\n                        [getCrossCoord([x1, y1, x2, y2], figureCenter[1], 1), figureCenter[1]]\r\n                    ]\r\n                }\r\n            } else {\r\n                if (isRectangular) {\r\n                    labelPoints = [\r\n                        [x1, y1],\r\n                        [isHorizontal ? x1 : xc, isHorizontal ? yc : y1],\r\n                        [x2, y1],\r\n                        [x1, y2],\r\n                        [isHorizontal ? x2 : xc, isHorizontal ? yc : y2],\r\n                        [x2, y2]\r\n                    ]\r\n                } else {\r\n                    labelPoints = [\r\n                        [xc, yc]\r\n                    ]\r\n                }\r\n            }\r\n        }\r\n        return labelPoints\r\n    },\r\n    isHorizontal: function(bBox, figure) {\r\n        return bBox.x > figure.x + figure.width || bBox.x + bBox.width < figure.x\r\n    },\r\n    getFigureCenter: function(figure) {\r\n        return [_floor(figure.x + figure.width / 2), _floor(figure.y + figure.height / 2)]\r\n    },\r\n    findFigurePoint: function(figure, labelPoint) {\r\n        var figureCenter = barPointStrategy.getFigureCenter(figure);\r\n        var point = getClosestCoord(labelPoint, [\r\n            [figure.x, figureCenter[1]],\r\n            [figureCenter[0], figure.y + figure.height],\r\n            [figure.x + figure.width, figureCenter[1]],\r\n            [figureCenter[0], figure.y]\r\n        ]);\r\n        return point\r\n    },\r\n    adjustPoints: function(points) {\r\n        var lineIsVertical = _abs(points[1] - points[3]) <= 1;\r\n        var lineIsHorizontal = _abs(points[0] - points[2]) <= 1;\r\n        if (lineIsHorizontal) {\r\n            points[0] = points[2]\r\n        }\r\n        if (lineIsVertical) {\r\n            points[1] = points[3]\r\n        }\r\n        return points\r\n    }\r\n};\r\nvar symbolPointStrategy = {\r\n    isLabelInside: function() {\r\n        return false\r\n    },\r\n    prepareLabelPoints: barPointStrategy.prepareLabelPoints,\r\n    isHorizontal: function(bBox, figure) {\r\n        return bBox.x > figure.x + figure.r || bBox.x + bBox.width < figure.x - figure.r\r\n    },\r\n    getFigureCenter: function(figure) {\r\n        return [figure.x, figure.y]\r\n    },\r\n    findFigurePoint: function(figure, labelPoint) {\r\n        var angle = Math.atan2(figure.y - labelPoint[1], labelPoint[0] - figure.x);\r\n        return [_round(figure.x + figure.r * Math.cos(angle)), _round(figure.y - figure.r * Math.sin(angle))]\r\n    },\r\n    adjustPoints: barPointStrategy.adjustPoints\r\n};\r\nvar piePointStrategy = {\r\n    isLabelInside: function(_0, _1, isOutside) {\r\n        return !isOutside\r\n    },\r\n    prepareLabelPoints: function(bBox, rotatedBBox, isHorizontal, angle) {\r\n        var xl = bBox.x;\r\n        var xr = xl + bBox.width;\r\n        var xc = xl + _round(bBox.width / 2);\r\n        var yt = bBox.y;\r\n        var yb = yt + bBox.height;\r\n        var yc = yt + _round(bBox.height / 2);\r\n        var points = [\r\n            [\r\n                [xl, yt],\r\n                [xr, yt]\r\n            ],\r\n            [\r\n                [xr, yt],\r\n                [xr, yb]\r\n            ],\r\n            [\r\n                [xr, yb],\r\n                [xl, yb]\r\n            ],\r\n            [\r\n                [xl, yb],\r\n                [xl, yt]\r\n            ]\r\n        ];\r\n        var cosSin = (0, _utils.getCosAndSin)(angle);\r\n        if (0 === angle) {\r\n            points = isHorizontal ? [\r\n                [xl, yc],\r\n                [xr, yc]\r\n            ] : [\r\n                [xc, yt],\r\n                [xc, yb]\r\n            ]\r\n        } else {\r\n            points = points.map(function(pair) {\r\n                return pair.map(function(point) {\r\n                    return [_round((point[0] - xc) * cosSin.cos + (point[1] - yc) * cosSin.sin + xc), _round(-(point[0] - xc) * cosSin.sin + (point[1] - yc) * cosSin.cos + yc)]\r\n                })\r\n            }).reduce(function(r, pair) {\r\n                var point1x = pair[0][0];\r\n                var point1y = pair[0][1];\r\n                var point2x = pair[1][0];\r\n                var point2y = pair[1][1];\r\n                if (isHorizontal) {\r\n                    if (point1y >= yc && yc >= point2y || point1y <= yc && yc <= point2y) {\r\n                        r.push([(yc - point1y) * (point2x - point1x) / (point2y - point1y) + point1x, yc])\r\n                    }\r\n                } else {\r\n                    if (point1x >= xc && xc >= point2x || point1x <= xc && xc <= point2x) {\r\n                        r.push([xc, (xc - point1x) * (point2y - point1y) / (point2x - point1x) + point1y])\r\n                    }\r\n                }\r\n                return r\r\n            }, [])\r\n        }\r\n        return points\r\n    },\r\n    isHorizontal: function(bBox, figure) {\r\n        return bBox.x > figure.x || figure.x > bBox.x + bBox.width\r\n    },\r\n    getFigureCenter: symbolPointStrategy.getFigureCenter,\r\n    findFigurePoint: function(figure, labelPoint, isHorizontal) {\r\n        if (!isHorizontal) {\r\n            return [figure.x, figure.y]\r\n        }\r\n        var labelX = labelPoint[0];\r\n        var x = _round(figure.x + (figure.y - labelPoint[1]) / Math.tan((0, _utils.degreesToRadians)(figure.angle)));\r\n        var points = [figure.x, figure.y, x, labelPoint[1]];\r\n        if (!(figure.x <= x && x <= labelX) && !(labelX <= x && x <= figure.x)) {\r\n            if (_abs(figure.x - labelX) < CONNECTOR_LENGTH) {\r\n                points = [figure.x, figure.y]\r\n            } else {\r\n                if (figure.x <= labelX) {\r\n                    points[2] = figure.x + CONNECTOR_LENGTH\r\n                } else {\r\n                    points[2] = figure.x - CONNECTOR_LENGTH\r\n                }\r\n            }\r\n        }\r\n        return points\r\n    },\r\n    adjustPoints: function(points) {\r\n        return points\r\n    }\r\n};\r\n\r\nfunction selectStrategy(figure) {\r\n    return void 0 !== figure.angle && piePointStrategy || void 0 !== figure.r && symbolPointStrategy || barPointStrategy\r\n}\r\n\r\nfunction disposeItem(obj, field) {\r\n    obj[field] && obj[field].dispose();\r\n    obj[field] = null\r\n}\r\n\r\nfunction checkBackground(background) {\r\n    return background && (background.fill && \"none\" !== background.fill || background[\"stroke-width\"] > 0 && background.stroke && \"none\" !== background.stroke)\r\n}\r\n\r\nfunction checkConnector(connector) {\r\n    return connector && connector[\"stroke-width\"] > 0 && connector.stroke && \"none\" !== connector.stroke\r\n}\r\n\r\nfunction formatText(data, options) {\r\n    var format = options.format;\r\n    data.valueText = (0, _format_helper.format)(data.value, format);\r\n    data.argumentText = (0, _format_helper.format)(data.argument, options.argumentFormat);\r\n    if (void 0 !== data.percent) {\r\n        data.percentText = (0, _format_helper.format)(data.percent, {\r\n            type: \"percent\",\r\n            precision: format && format.percentPrecision\r\n        })\r\n    }\r\n    if (void 0 !== data.total) {\r\n        data.totalText = (0, _format_helper.format)(data.total, format)\r\n    }\r\n    if (void 0 !== data.openValue) {\r\n        data.openValueText = (0, _format_helper.format)(data.openValue, format)\r\n    }\r\n    if (void 0 !== data.closeValue) {\r\n        data.closeValueText = (0, _format_helper.format)(data.closeValue, format)\r\n    }\r\n    if (void 0 !== data.lowValue) {\r\n        data.lowValueText = (0, _format_helper.format)(data.lowValue, format)\r\n    }\r\n    if (void 0 !== data.highValue) {\r\n        data.highValueText = (0, _format_helper.format)(data.highValue, format)\r\n    }\r\n    if (void 0 !== data.reductionValue) {\r\n        data.reductionValueText = (0, _format_helper.format)(data.reductionValue, format)\r\n    }\r\n    return options.customizeText ? options.customizeText.call(data, data) : data.valueText\r\n}\r\n\r\nfunction Label(renderSettings) {\r\n    this._renderer = renderSettings.renderer;\r\n    this._container = renderSettings.labelsGroup;\r\n    this._point = renderSettings.point;\r\n    this._strategy = renderSettings.strategy;\r\n    this._rowCount = 1\r\n}\r\nLabel.prototype = {\r\n    constructor: Label,\r\n    setColor: function(color) {\r\n        this._color = color\r\n    },\r\n    setOptions: function(options) {\r\n        this._options = options\r\n    },\r\n    setData: function(data) {\r\n        this._data = data\r\n    },\r\n    setDataField: function(fieldName, fieldValue) {\r\n        this._data = this._data || {};\r\n        this._data[fieldName] = fieldValue\r\n    },\r\n    getData: function() {\r\n        return this._data\r\n    },\r\n    setFigureToDrawConnector: function(figure) {\r\n        this._figure = figure\r\n    },\r\n    dispose: function() {\r\n        var that = this;\r\n        disposeItem(that, \"_group\");\r\n        that._data = that._options = that._textContent = that._visible = that._insideGroup = that._text = that._background = that._connector = that._figure = null\r\n    },\r\n    _setVisibility: function(value, state) {\r\n        this._group && this._group.attr({\r\n            visibility: value\r\n        });\r\n        this._visible = state\r\n    },\r\n    isVisible: function() {\r\n        return this._visible\r\n    },\r\n    hide: function(holdInvisible) {\r\n        this._holdVisibility = !!holdInvisible;\r\n        this._hide()\r\n    },\r\n    _hide: function() {\r\n        this._setVisibility(\"hidden\", false)\r\n    },\r\n    show: function(holdVisible) {\r\n        var correctPosition = !this._drawn;\r\n        if (this._point.hasValue()) {\r\n            this._holdVisibility = !!holdVisible;\r\n            this._show();\r\n            correctPosition && this._point.correctLabelPosition(this)\r\n        }\r\n    },\r\n    _show: function() {\r\n        var that = this;\r\n        var renderer = that._renderer;\r\n        var container = that._container;\r\n        var options = that._options || {};\r\n        var text = that._textContent = formatText(that._data, that._options) || null;\r\n        if (text) {\r\n            if (!that._group) {\r\n                that._group = renderer.g().append(container);\r\n                that._insideGroup = renderer.g().append(that._group);\r\n                that._text = renderer.text(\"\", 0, 0).append(that._insideGroup)\r\n            }\r\n            that._text.css(options.attributes ? (0, _utils.patchFontOptions)(options.attributes.font) : {});\r\n            if (checkBackground(options.background)) {\r\n                that._background = that._background || renderer.rect().append(that._insideGroup).toBackground();\r\n                that._background.attr(options.background);\r\n                that._color && that._background.attr({\r\n                    fill: that._color\r\n                })\r\n            } else {\r\n                disposeItem(that, \"_background\")\r\n            }\r\n            if (checkConnector(options.connector)) {\r\n                that._connector = that._connector || renderer.path([], \"line\").sharp().append(that._group).toBackground();\r\n                that._connector.attr(options.connector);\r\n                that._color && that._connector.attr({\r\n                    stroke: that._color\r\n                })\r\n            } else {\r\n                disposeItem(that, \"_connector\")\r\n            }\r\n            that._text.attr({\r\n                text: text,\r\n                align: options.textAlignment,\r\n                \"class\": options.cssClass\r\n            });\r\n            that._updateBackground(that._text.getBBox());\r\n            that._setVisibility(\"visible\", true);\r\n            that._drawn = true\r\n        } else {\r\n            that._hide()\r\n        }\r\n    },\r\n    _getLabelVisibility: function(isVisible) {\r\n        return this._holdVisibility ? this.isVisible() : isVisible\r\n    },\r\n    draw: function(isVisible) {\r\n        if (this._getLabelVisibility(isVisible)) {\r\n            this._show();\r\n            this._point && this._point.correctLabelPosition(this)\r\n        } else {\r\n            this._drawn = false;\r\n            this._hide()\r\n        }\r\n        return this\r\n    },\r\n    _updateBackground: function(bBox) {\r\n        var that = this;\r\n        if (that._background) {\r\n            bBox.x -= LABEL_BACKGROUND_PADDING_X;\r\n            bBox.y -= LABEL_BACKGROUND_PADDING_Y;\r\n            bBox.width += 2 * LABEL_BACKGROUND_PADDING_X;\r\n            bBox.height += 2 * LABEL_BACKGROUND_PADDING_Y;\r\n            that._background.attr(bBox)\r\n        }\r\n        that._bBoxWithoutRotation = (0, _extend.extend)({}, bBox);\r\n        var rotationAngle = that._options.rotationAngle || 0;\r\n        that._insideGroup.rotate(rotationAngle, bBox.x + bBox.width / 2, bBox.y + bBox.height / 2);\r\n        bBox = (0, _utils.rotateBBox)(bBox, [bBox.x + bBox.width / 2, bBox.y + bBox.height / 2], -rotationAngle);\r\n        that._bBox = bBox\r\n    },\r\n    getFigureCenter: function() {\r\n        var figure = this._figure;\r\n        var strategy = this._strategy || selectStrategy(figure);\r\n        return strategy.getFigureCenter(figure)\r\n    },\r\n    _getConnectorPoints: function() {\r\n        var that = this;\r\n        var figure = that._figure;\r\n        var options = that._options;\r\n        var strategy = that._strategy || selectStrategy(figure);\r\n        var bBox = that._shiftBBox(that._bBoxWithoutRotation);\r\n        var rotatedBBox = that.getBoundingRect();\r\n        var labelPoint;\r\n        var points = [];\r\n        var isHorizontal;\r\n        if (!strategy.isLabelInside(bBox, figure, \"inside\" !== options.position)) {\r\n            isHorizontal = strategy.isHorizontal(bBox, figure);\r\n            var figureCenter = that.getFigureCenter();\r\n            points = strategy.prepareLabelPoints(bBox, rotatedBBox, isHorizontal, -options.rotationAngle || 0, figureCenter);\r\n            labelPoint = getClosestCoord(figureCenter, points);\r\n            points = strategy.findFigurePoint(figure, labelPoint, isHorizontal);\r\n            points = points.concat(labelPoint)\r\n        }\r\n        return strategy.adjustPoints(points)\r\n    },\r\n    fit: function(maxWidth) {\r\n        var padding = this._background ? 2 * LABEL_BACKGROUND_PADDING_X : 0;\r\n        var rowCountChanged = false;\r\n        if (this._text) {\r\n            var _this$_text$setMaxSiz = this._text.setMaxSize(maxWidth - padding, void 0, this._options),\r\n                rowCount = _this$_text$setMaxSiz.rowCount,\r\n                textIsEmpty = _this$_text$setMaxSiz.textIsEmpty;\r\n            if (0 === rowCount) {\r\n                rowCount = 1\r\n            }\r\n            if (rowCount !== this._rowCount) {\r\n                rowCountChanged = true;\r\n                this._rowCount = rowCount\r\n            }\r\n            textIsEmpty && disposeItem(this, \"_background\")\r\n        }\r\n        this._updateBackground(this._text.getBBox());\r\n        return rowCountChanged\r\n    },\r\n    resetEllipsis: function() {\r\n        this._text && this._text.restoreText();\r\n        this._updateBackground(this._text.getBBox())\r\n    },\r\n    setTrackerData: function(point) {\r\n        this._text.data({\r\n            \"chart-data-point\": point\r\n        });\r\n        this._background && this._background.data({\r\n            \"chart-data-point\": point\r\n        })\r\n    },\r\n    hideInsideLabel: function(coords) {\r\n        return this._point.hideInsideLabel(this, coords)\r\n    },\r\n    getPoint: function() {\r\n        return this._point\r\n    },\r\n    shift: function(x, y) {\r\n        var that = this;\r\n        if (that._textContent) {\r\n            that._insideGroup.attr({\r\n                translateX: that._x = _round(x - that._bBox.x),\r\n                translateY: that._y = _round(y - that._bBox.y)\r\n            });\r\n            if (that._connector) {\r\n                that._connector.attr({\r\n                    points: that._getConnectorPoints()\r\n                })\r\n            }\r\n        }\r\n        return that\r\n    },\r\n    getBoundingRect: function() {\r\n        return this._shiftBBox(this._bBox)\r\n    },\r\n    _shiftBBox: function(bBox) {\r\n        return this._textContent ? {\r\n            x: bBox.x + this._x,\r\n            y: bBox.y + this._y,\r\n            width: bBox.width,\r\n            height: bBox.height\r\n        } : {}\r\n    },\r\n    getLayoutOptions: function() {\r\n        var options = this._options;\r\n        return {\r\n            alignment: options.alignment,\r\n            background: checkBackground(options.background),\r\n            horizontalOffset: options.horizontalOffset,\r\n            verticalOffset: options.verticalOffset,\r\n            radialOffset: options.radialOffset,\r\n            position: options.position,\r\n            connectorOffset: (checkConnector(options.connector) ? CONNECTOR_LENGTH : 0) + (checkBackground(options.background) ? LABEL_BACKGROUND_PADDING_X : 0)\r\n        }\r\n    }\r\n};\r\nexports.Label = Label;\r\n"]},"metadata":{},"sourceType":"module"}