{"ast":null,"code":"/**\r\n * DevExtreme (ui/drop_down_editor/ui.drop_down_list.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nfunction _typeof(obj) {\n  if (\"function\" === typeof Symbol && \"symbol\" === typeof Symbol.iterator) {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && \"function\" === typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nvar $ = require(\"../../core/renderer\");\n\nvar window = require(\"../../core/utils/window\").getWindow();\n\nvar eventsEngine = require(\"../../events/core/events_engine\");\n\nvar Guid = require(\"../../core/guid\");\n\nvar registerComponent = require(\"../../core/component_registrator\");\n\nvar commonUtils = require(\"../../core/utils/common\");\n\nvar typeUtils = require(\"../../core/utils/type\");\n\nvar extend = require(\"../../core/utils/extend\").extend;\n\nvar inArray = require(\"../../core/utils/array\").inArray;\n\nvar DropDownEditor = require(\"./ui.drop_down_editor\");\n\nvar List = require(\"../list\");\n\nvar errors = require(\"../widget/ui.errors\");\n\nvar eventUtils = require(\"../../events/utils\");\n\nvar devices = require(\"../../core/devices\");\n\nvar dataQuery = require(\"../../data/query\");\n\nvar each = require(\"../../core/utils/iterator\").each;\n\nvar DataExpressionMixin = require(\"../editor/ui.data_expression\");\n\nvar messageLocalization = require(\"../../localization/message\");\n\nvar ChildDefaultTemplate = require(\"../../core/templates/child_default_template\").ChildDefaultTemplate;\n\nvar Deferred = require(\"../../core/utils/deferred\").Deferred;\n\nvar DataConverterMixin = require(\"../shared/grouped_data_converter_mixin\").default;\n\nvar LIST_ITEM_SELECTOR = \".dx-list-item\";\nvar LIST_ITEM_DATA_KEY = \"dxListItemData\";\nvar DROPDOWNLIST_POPUP_WRAPPER_CLASS = \"dx-dropdownlist-popup-wrapper\";\nvar SKIP_GESTURE_EVENT_CLASS = \"dx-skip-gesture-event\";\nvar SEARCH_EVENT = \"input\";\nvar SEARCH_MODES = [\"startswith\", \"contains\", \"endwith\", \"notcontains\"];\nvar DropDownList = DropDownEditor.inherit({\n  _supportedKeys: function _supportedKeys() {\n    var parent = this.callBase();\n    return extend({}, parent, {\n      tab: function tab(e) {\n        if (this._allowSelectItemByTab()) {\n          this._saveValueChangeEvent(e);\n\n          var $focusedItem = $(this._list.option(\"focusedElement\"));\n          $focusedItem.length && this._setSelectedElement($focusedItem);\n        }\n\n        parent.tab.apply(this, arguments);\n      },\n      space: commonUtils.noop,\n      home: commonUtils.noop,\n      end: commonUtils.noop\n    });\n  },\n  _allowSelectItemByTab: function _allowSelectItemByTab() {\n    return this.option(\"opened\") && \"instantly\" === this.option(\"applyValueMode\");\n  },\n  _setSelectedElement: function _setSelectedElement($element) {\n    var value = this._valueGetter(this._list._getItemData($element));\n\n    this._setValue(value);\n  },\n  _setValue: function _setValue(value) {\n    this.option(\"value\", value);\n  },\n  _getDefaultOptions: function _getDefaultOptions() {\n    return extend(this.callBase(), extend(DataExpressionMixin._dataExpressionDefaultOptions(), {\n      displayValue: void 0,\n      searchEnabled: false,\n      searchMode: \"contains\",\n      searchTimeout: 500,\n      minSearchLength: 0,\n      searchExpr: null,\n      valueChangeEvent: \"input change keyup\",\n      selectedItem: null,\n      noDataText: messageLocalization.format(\"dxCollectionWidget-noDataText\"),\n      onSelectionChanged: null,\n      onItemClick: commonUtils.noop,\n      showDataBeforeSearch: false,\n      grouped: false,\n      groupTemplate: \"group\",\n      popupPosition: {\n        my: \"left top\",\n        at: \"left bottom\",\n        offset: {\n          h: 0,\n          v: 0\n        },\n        collision: \"flip\"\n      },\n      wrapItemText: false,\n      popupWidthExtension: 0\n    }));\n  },\n  _defaultOptionsRules: function _defaultOptionsRules() {\n    return this.callBase().concat([{\n      device: {\n        platform: \"ios\"\n      },\n      options: {\n        popupPosition: {\n          offset: {\n            v: -1\n          }\n        }\n      }\n    }, {\n      device: {\n        platform: \"generic\"\n      },\n      options: {\n        buttonsLocation: \"bottom center\"\n      }\n    }]);\n  },\n  _setOptionsByReference: function _setOptionsByReference() {\n    this.callBase();\n    extend(this._optionsByReference, {\n      value: true,\n      selectedItem: true,\n      displayValue: true\n    });\n  },\n  _init: function _init() {\n    this.callBase();\n\n    this._initDataExpressions();\n\n    this._initActions();\n\n    this._setListDataSource();\n\n    this._validateSearchMode();\n\n    this._clearSelectedItem();\n\n    this._initItems();\n  },\n  _initItems: function _initItems() {\n    var items = this.option().items;\n\n    if (items && !items.length && this._dataSource) {\n      this.option().items = this._dataSource.items();\n    }\n  },\n  _initActions: function _initActions() {\n    this._initContentReadyAction();\n\n    this._initSelectionChangedAction();\n\n    this._initItemClickAction();\n  },\n  _initContentReadyAction: function _initContentReadyAction() {\n    this._contentReadyAction = this._createActionByOption(\"onContentReady\", {\n      excludeValidators: [\"disabled\", \"readOnly\"]\n    });\n  },\n  _initSelectionChangedAction: function _initSelectionChangedAction() {\n    this._selectionChangedAction = this._createActionByOption(\"onSelectionChanged\", {\n      excludeValidators: [\"disabled\", \"readOnly\"]\n    });\n  },\n  _initItemClickAction: function _initItemClickAction() {\n    this._itemClickAction = this._createActionByOption(\"onItemClick\");\n  },\n  _initTemplates: function _initTemplates() {\n    this.callBase();\n    this._defaultTemplates.item = new ChildDefaultTemplate(\"item\");\n  },\n  _saveFocusOnWidget: function _saveFocusOnWidget(e) {\n    if (this._list && this._list.initialOption(\"focusStateEnabled\")) {\n      this._focusInput();\n    }\n  },\n  _fitIntoRange: function _fitIntoRange(value, start, end) {\n    if (value > end) {\n      return start;\n    }\n\n    if (value < start) {\n      return end;\n    }\n\n    return value;\n  },\n  _items: function _items() {\n    var items = this._getPlainItems(!this._list && this._dataSource.items());\n\n    var availableItems = new dataQuery(items).filter(\"disabled\", \"<>\", true).toArray();\n    return availableItems;\n  },\n  _calcNextItem: function _calcNextItem(step) {\n    var items = this._items();\n\n    var nextIndex = this._fitIntoRange(this._getSelectedIndex() + step, 0, items.length - 1);\n\n    return items[nextIndex];\n  },\n  _getSelectedIndex: function _getSelectedIndex() {\n    var items = this._items();\n\n    var selectedItem = this.option(\"selectedItem\");\n    var result = -1;\n    each(items, function (index, item) {\n      if (this._isValueEquals(item, selectedItem)) {\n        result = index;\n        return false;\n      }\n    }.bind(this));\n    return result;\n  },\n  _createPopup: function _createPopup() {\n    this.callBase();\n\n    this._updateCustomBoundaryContainer();\n\n    this._popup._wrapper().addClass(this._popupWrapperClass());\n\n    var $popupContent = this._popup.$content();\n\n    eventsEngine.off($popupContent, \"mouseup\");\n    eventsEngine.on($popupContent, \"mouseup\", this._saveFocusOnWidget.bind(this));\n  },\n  _updateCustomBoundaryContainer: function _updateCustomBoundaryContainer() {\n    var customContainer = this.option(\"dropDownOptions.container\");\n    var $container = customContainer && $(customContainer);\n\n    if ($container && $container.length && !typeUtils.isWindow($container.get(0))) {\n      var $containerWithParents = [].slice.call($container.parents());\n      $containerWithParents.unshift($container.get(0));\n      each($containerWithParents, function (i, parent) {\n        if (parent === $(\"body\").get(0)) {\n          return false;\n        } else {\n          if (\"hidden\" === window.getComputedStyle(parent).overflowY) {\n            this._$customBoundaryContainer = $(parent);\n            return false;\n          }\n        }\n      }.bind(this));\n    }\n  },\n  _popupWrapperClass: function _popupWrapperClass() {\n    return DROPDOWNLIST_POPUP_WRAPPER_CLASS;\n  },\n  _renderInputValue: function _renderInputValue() {\n    var value = this._getCurrentValue();\n\n    return this._loadInputValue(value, this._setSelectedItem.bind(this)).always(this.callBase.bind(this, value));\n  },\n  _loadInputValue: function _loadInputValue(value, callback) {\n    return this._loadItem(value).always(callback);\n  },\n  _getItemFromPlain: function _getItemFromPlain(value, cache) {\n    var plainItems;\n    var selectedItem;\n\n    if (cache && \"object\" !== _typeof(value)) {\n      if (!cache.itemByValue) {\n        cache.itemByValue = {};\n        plainItems = this._getPlainItems();\n        plainItems.forEach(function (item) {\n          cache.itemByValue[this._valueGetter(item)] = item;\n        }, this);\n      }\n\n      selectedItem = cache.itemByValue[value];\n    }\n\n    if (!selectedItem) {\n      plainItems = this._getPlainItems();\n      selectedItem = commonUtils.grep(plainItems, function (item) {\n        return this._isValueEquals(this._valueGetter(item), value);\n      }.bind(this))[0];\n    }\n\n    return selectedItem;\n  },\n  _loadItem: function _loadItem(value, cache) {\n    var selectedItem = this._getItemFromPlain(value, cache);\n\n    return void 0 !== selectedItem ? new Deferred().resolve(selectedItem).promise() : this._loadValue(value);\n  },\n  _getPlainItems: function _getPlainItems(items) {\n    var plainItems = [];\n    items = items || this.option(\"items\") || this._dataSource.items() || [];\n\n    for (var i = 0; i < items.length; i++) {\n      if (items[i] && items[i].items) {\n        plainItems = plainItems.concat(items[i].items);\n      } else {\n        plainItems.push(items[i]);\n      }\n    }\n\n    return plainItems;\n  },\n  _setSelectedItem: function _setSelectedItem(item) {\n    var displayValue = this._displayValue(item);\n\n    this.option(\"selectedItem\", commonUtils.ensureDefined(item, null));\n    this.option(\"displayValue\", displayValue);\n  },\n  _displayValue: function _displayValue(item) {\n    return this._displayGetter(item);\n  },\n  _refreshSelected: function _refreshSelected() {\n    var cache = {};\n\n    this._listItemElements().each(function (_, itemElement) {\n      var $itemElement = $(itemElement);\n\n      var itemValue = this._valueGetter($itemElement.data(LIST_ITEM_DATA_KEY));\n\n      var isItemSelected = this._isSelectedValue(itemValue, cache);\n\n      if (isItemSelected) {\n        this._list.selectItem($itemElement);\n      } else {\n        this._list.unselectItem($itemElement);\n      }\n    }.bind(this));\n  },\n  _popupShownHandler: function _popupShownHandler() {\n    this.callBase();\n\n    this._setFocusPolicy();\n  },\n  _setFocusPolicy: function _setFocusPolicy() {\n    if (!this.option(\"focusStateEnabled\") || !this._list) {\n      return;\n    }\n\n    this._list.option(\"focusedElement\", null);\n  },\n  _isSelectedValue: function _isSelectedValue(value) {\n    return this._isValueEquals(value, this.option(\"value\"));\n  },\n  _validateSearchMode: function _validateSearchMode() {\n    var searchMode = this.option(\"searchMode\");\n    var normalizedSearchMode = searchMode.toLowerCase();\n\n    if (inArray(normalizedSearchMode, SEARCH_MODES) < 0) {\n      throw errors.Error(\"E1019\", searchMode);\n    }\n  },\n  _clearSelectedItem: function _clearSelectedItem() {\n    this.option(\"selectedItem\", null);\n  },\n  _processDataSourceChanging: function _processDataSourceChanging() {\n    this._setListDataSource();\n\n    this._renderInputValue().fail(function () {\n      if (this._isCustomValueAllowed()) {\n        return;\n      }\n\n      this._clearSelectedItem();\n    }.bind(this));\n  },\n  _isCustomValueAllowed: function _isCustomValueAllowed() {\n    return this.option(\"displayCustomValue\");\n  },\n  reset: function reset() {\n    this.callBase();\n\n    this._clearFilter();\n\n    this._clearSelectedItem();\n  },\n  _listItemElements: function _listItemElements() {\n    return this._$list ? this._$list.find(LIST_ITEM_SELECTOR) : $();\n  },\n  _popupConfig: function _popupConfig() {\n    var that = this;\n    return extend(this.callBase(), {\n      templatesRenderAsynchronously: false,\n      width: this.option(\"width\"),\n      onShowing: function onShowing() {\n        that.$element().addClass(SKIP_GESTURE_EVENT_CLASS);\n      },\n      onHidden: function onHidden() {\n        that.$element().removeClass(SKIP_GESTURE_EVENT_CLASS);\n      },\n      height: \"auto\",\n      autoResizeEnabled: false,\n      maxHeight: this._getMaxHeight.bind(this)\n    });\n  },\n  _renderPopupContent: function _renderPopupContent() {\n    this._renderList();\n  },\n  _attachChildKeyboardEvents: function _attachChildKeyboardEvents() {\n    if (!this._canListHaveFocus()) {\n      this._childKeyboardProcessor = this._keyboardProcessor.attachChildProcessor();\n\n      this._setListOption(\"_keyboardProcessor\", this._childKeyboardProcessor);\n    }\n  },\n  _fireContentReadyAction: commonUtils.noop,\n  _setAriaTargetForList: function _setAriaTargetForList() {\n    this._list._getAriaTarget = this._getAriaTarget.bind(this);\n  },\n  _renderList: function _renderList() {\n    this._listId = \"dx-\" + new Guid()._value;\n    var $list = this._$list = $(\"<div>\").attr(\"id\", this._listId).appendTo(this._popup.$content());\n    this._list = this._createComponent($list, List, this._listConfig());\n\n    this._refreshList();\n\n    this._setAriaTargetForList();\n\n    this._list.option(\"_listAttributes\", {\n      role: \"combobox\"\n    });\n\n    this._renderPreventBlur(this._$list);\n  },\n  _renderPreventBlur: function _renderPreventBlur($target) {\n    var eventName = eventUtils.addNamespace(\"mousedown\", \"dxDropDownList\");\n    eventsEngine.off($target, eventName);\n    eventsEngine.on($target, eventName, function (e) {\n      e.preventDefault();\n    }.bind(this));\n  },\n  _renderOpenedState: function _renderOpenedState() {\n    this.callBase();\n    var opened = this.option(\"opened\") || void 0;\n    this.setAria({\n      activedescendant: opened && this._list.getFocusedItemId(),\n      controls: opened && this._listId\n    });\n  },\n  _setDefaultAria: function _setDefaultAria() {\n    this.setAria({\n      haspopup: \"listbox\",\n      autocomplete: \"list\"\n    });\n  },\n  _refreshList: function _refreshList() {\n    if (this._list && this._shouldRefreshDataSource()) {\n      this._setListDataSource();\n    }\n  },\n  _shouldRefreshDataSource: function _shouldRefreshDataSource() {\n    var dataSourceProvided = !!this._list.option(\"dataSource\");\n    return dataSourceProvided !== this._needPassDataSourceToList();\n  },\n  _isDesktopDevice: function _isDesktopDevice() {\n    return \"desktop\" === devices.real().deviceType;\n  },\n  _listConfig: function _listConfig() {\n    var options = {\n      selectionMode: \"single\",\n      _templates: this.option(\"_templates\"),\n      templateProvider: this.option(\"templateProvider\"),\n      noDataText: this.option(\"noDataText\"),\n      grouped: this.option(\"grouped\"),\n      wrapItemText: this.option(\"wrapItemText\"),\n      onContentReady: this._listContentReadyHandler.bind(this),\n      itemTemplate: this.option(\"itemTemplate\"),\n      indicateLoading: false,\n      keyExpr: this._getCollectionKeyExpr(),\n      displayExpr: this._displayGetterExpr(),\n      groupTemplate: this.option(\"groupTemplate\"),\n      onItemClick: this._listItemClickAction.bind(this),\n      dataSource: this._getDataSource(),\n      _keyboardProcessor: this._childKeyboardProcessor,\n      hoverStateEnabled: this._isDesktopDevice() ? this.option(\"hoverStateEnabled\") : false,\n      focusStateEnabled: this._isDesktopDevice() ? this.option(\"focusStateEnabled\") : false\n    };\n\n    if (!this._canListHaveFocus()) {\n      options.tabIndex = null;\n      options._keyboardProcessor = this._childKeyboardProcessor;\n    }\n\n    return options;\n  },\n  _canListHaveFocus: function _canListHaveFocus() {\n    return false;\n  },\n  _getDataSource: function _getDataSource() {\n    return this._needPassDataSourceToList() ? this._dataSource : null;\n  },\n  _dataSourceOptions: function _dataSourceOptions() {\n    return {\n      paginate: false\n    };\n  },\n  _getGroupedOption: function _getGroupedOption() {\n    return this.option(\"grouped\");\n  },\n  _dataSourceFromUrlLoadMode: function _dataSourceFromUrlLoadMode() {\n    return \"raw\";\n  },\n  _listContentReadyHandler: function _listContentReadyHandler() {\n    this._list = this._list || this._$list.dxList(\"instance\");\n\n    if (!this.option(\"deferRendering\")) {\n      this._refreshSelected();\n    }\n\n    this._dimensionChanged();\n\n    this._contentReadyAction();\n  },\n  _setListOption: function _setListOption(optionName, value) {\n    this._setWidgetOption(\"_list\", arguments);\n  },\n  _listItemClickAction: function _listItemClickAction(e) {\n    this._listItemClickHandler(e);\n\n    this._itemClickAction(e);\n  },\n  _listItemClickHandler: commonUtils.noop,\n  _setListDataSource: function _setListDataSource() {\n    if (!this._list) {\n      return;\n    }\n\n    this._setListOption(\"dataSource\", this._getDataSource());\n\n    if (!this._needPassDataSourceToList()) {\n      this._setListOption(\"items\", []);\n    }\n  },\n  _needPassDataSourceToList: function _needPassDataSourceToList() {\n    return this.option(\"showDataBeforeSearch\") || this._isMinSearchLengthExceeded();\n  },\n  _isMinSearchLengthExceeded: function _isMinSearchLengthExceeded() {\n    return this._searchValue().toString().length >= this.option(\"minSearchLength\");\n  },\n  _searchValue: function _searchValue() {\n    return this._input().val() || \"\";\n  },\n  _getSearchEvent: function _getSearchEvent() {\n    return eventUtils.addNamespace(SEARCH_EVENT, this.NAME + \"Search\");\n  },\n  _getSetFocusPolicyEvent: function _getSetFocusPolicyEvent() {\n    return eventUtils.addNamespace(\"input\", this.NAME + \"FocusPolicy\");\n  },\n  _renderEvents: function _renderEvents() {\n    this.callBase();\n    eventsEngine.on(this._input(), this._getSetFocusPolicyEvent(), this._setFocusPolicy.bind(this));\n\n    if (this._shouldRenderSearchEvent()) {\n      eventsEngine.on(this._input(), this._getSearchEvent(), this._searchHandler.bind(this));\n    }\n  },\n  _shouldRenderSearchEvent: function _shouldRenderSearchEvent() {\n    return this.option(\"searchEnabled\");\n  },\n  _refreshEvents: function _refreshEvents() {\n    eventsEngine.off(this._input(), this._getSearchEvent());\n    eventsEngine.off(this._input(), this._getSetFocusPolicyEvent());\n    this.callBase();\n  },\n  _searchHandler: function _searchHandler() {\n    if (!this._isMinSearchLengthExceeded()) {\n      this._searchCanceled();\n\n      return;\n    }\n\n    var searchTimeout = this.option(\"searchTimeout\");\n\n    if (searchTimeout) {\n      this._clearSearchTimer();\n\n      this._searchTimer = setTimeout(this._searchDataSource.bind(this), searchTimeout);\n    } else {\n      this._searchDataSource();\n    }\n  },\n  _searchCanceled: function _searchCanceled() {\n    this._clearSearchTimer();\n\n    if (this._needPassDataSourceToList()) {\n      this._filterDataSource(null);\n    }\n\n    this._refreshList();\n  },\n  _searchDataSource: function _searchDataSource() {\n    this._filterDataSource(this._searchValue());\n  },\n  _filterDataSource: function _filterDataSource(searchValue) {\n    this._clearSearchTimer();\n\n    var dataSource = this._dataSource;\n    dataSource.searchExpr(this.option(\"searchExpr\") || this._displayGetterExpr());\n    dataSource.searchOperation(this.option(\"searchMode\"));\n    dataSource.searchValue(searchValue);\n    return dataSource.load().done(this._dataSourceFiltered.bind(this, searchValue));\n  },\n  _clearFilter: function _clearFilter() {\n    var dataSource = this._dataSource;\n    dataSource && dataSource.searchValue() && dataSource.searchValue(null);\n  },\n  _dataSourceFiltered: function _dataSourceFiltered() {\n    this._refreshList();\n\n    this._refreshPopupVisibility();\n  },\n  _shouldOpenPopup: function _shouldOpenPopup() {\n    return this._hasItemsToShow();\n  },\n  _refreshPopupVisibility: function _refreshPopupVisibility() {\n    if (this.option(\"readOnly\") || !this._searchValue()) {\n      return;\n    }\n\n    var shouldOpenPopup = this._shouldOpenPopup();\n\n    if (shouldOpenPopup && !this._isFocused()) {\n      return;\n    }\n\n    this.option(\"opened\", shouldOpenPopup);\n\n    if (shouldOpenPopup) {\n      this._dimensionChanged();\n    }\n  },\n  _dataSourceChangedHandler: function _dataSourceChangedHandler(newItems) {\n    if (0 === this._dataSource.pageIndex()) {\n      this.option().items = newItems;\n    } else {\n      this.option().items = this.option().items.concat(newItems);\n    }\n  },\n  _hasItemsToShow: function _hasItemsToShow() {\n    var resultItems = this._dataSource && this._dataSource.items() || [];\n    var resultAmount = resultItems.length;\n\n    var isMinSearchLengthExceeded = this._needPassDataSourceToList();\n\n    return !!(isMinSearchLengthExceeded && resultAmount);\n  },\n  _clearSearchTimer: function _clearSearchTimer() {\n    clearTimeout(this._searchTimer);\n    delete this._searchTimer;\n  },\n  _popupShowingHandler: function _popupShowingHandler() {\n    this._dimensionChanged();\n  },\n  _dimensionChanged: function _dimensionChanged() {\n    this._popup && this._updatePopupDimensions();\n  },\n  _updatePopupDimensions: function _updatePopupDimensions() {\n    this._updatePopupWidth();\n\n    this._updatePopupHeight();\n  },\n  _updatePopupWidth: function _updatePopupWidth() {\n    this._setPopupOption(\"width\", this.$element().outerWidth() + this.option(\"popupWidthExtension\"));\n  },\n  _needPopupRepaint: function _needPopupRepaint() {\n    if (!this._dataSource) {\n      return false;\n    }\n\n    var currentPageIndex = this._dataSource.pageIndex();\n\n    var needRepaint = typeUtils.isDefined(this._pageIndex) && currentPageIndex <= this._pageIndex;\n\n    this._pageIndex = currentPageIndex;\n    return needRepaint;\n  },\n  _updatePopupHeight: function _updatePopupHeight() {\n    if (this._needPopupRepaint()) {\n      this._popup.repaint();\n    }\n\n    this._list && this._list.updateDimensions();\n  },\n  _getMaxHeight: function _getMaxHeight() {\n    var $element = this.$element();\n    var $customBoundaryContainer = this._$customBoundaryContainer;\n    var offsetTop = $element.offset().top - ($customBoundaryContainer ? $customBoundaryContainer.offset().top : 0);\n    var containerHeight = ($customBoundaryContainer || $(window)).outerHeight();\n    var maxHeight = Math.max(offsetTop, containerHeight - offsetTop - $element.outerHeight());\n    return Math.min(.5 * containerHeight, maxHeight);\n  },\n  _clean: function _clean() {\n    if (this._list) {\n      delete this._list;\n    }\n\n    this.callBase();\n  },\n  _dispose: function _dispose() {\n    this._clearSearchTimer();\n\n    this.callBase();\n  },\n  _setCollectionWidgetOption: function _setCollectionWidgetOption() {\n    this._setListOption.apply(this, arguments);\n  },\n  _setSubmitValue: function _setSubmitValue() {\n    var value = this.option(\"value\");\n    var submitValue = this._shouldUseDisplayValue(value) ? this._displayGetter(value) : value;\n\n    this._getSubmitElement().val(submitValue);\n  },\n  _shouldUseDisplayValue: function _shouldUseDisplayValue(value) {\n    return \"this\" === this.option(\"valueExpr\") && typeUtils.isObject(value);\n  },\n  _optionChanged: function _optionChanged(args) {\n    this._dataExpressionOptionChanged(args);\n\n    switch (args.name) {\n      case \"hoverStateEnabled\":\n      case \"focusStateEnabled\":\n        this._isDesktopDevice() && this._setListOption(args.name, args.value);\n        this.callBase(args);\n        break;\n\n      case \"items\":\n        if (!this.option(\"dataSource\")) {\n          this._processDataSourceChanging();\n        }\n\n        break;\n\n      case \"dataSource\":\n        this._processDataSourceChanging();\n\n        break;\n\n      case \"valueExpr\":\n        this._renderValue();\n\n        this._setListOption(\"keyExpr\", this._getCollectionKeyExpr());\n\n        break;\n\n      case \"displayExpr\":\n        this._renderValue();\n\n        this._setListOption(\"displayExpr\", this._displayGetterExpr());\n\n        break;\n\n      case \"searchMode\":\n        this._validateSearchMode();\n\n        break;\n\n      case \"minSearchLength\":\n        this._refreshList();\n\n        break;\n\n      case \"searchEnabled\":\n      case \"showDataBeforeSearch\":\n      case \"searchExpr\":\n        this._invalidate();\n\n        break;\n\n      case \"onContentReady\":\n        this._initContentReadyAction();\n\n        break;\n\n      case \"onSelectionChanged\":\n        this._initSelectionChangedAction();\n\n        break;\n\n      case \"onItemClick\":\n        this._initItemClickAction();\n\n        break;\n\n      case \"grouped\":\n      case \"groupTemplate\":\n      case \"wrapItemText\":\n      case \"noDataText\":\n        this._setListOption(args.name);\n\n        break;\n\n      case \"displayValue\":\n        this.option(\"text\", args.value);\n        break;\n\n      case \"itemTemplate\":\n      case \"searchTimeout\":\n      case \"popupWidthExtension\":\n        break;\n\n      case \"selectedItem\":\n        this._selectionChangedAction({\n          selectedItem: args.value\n        });\n\n        break;\n\n      default:\n        this.callBase(args);\n    }\n  }\n}).include(DataExpressionMixin, DataConverterMixin);\nregisterComponent(\"dxDropDownList\", DropDownList);\nmodule.exports = DropDownList;","map":{"version":3,"sources":["C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/devextreme/ui/drop_down_editor/ui.drop_down_list.js"],"names":["Symbol","_typeof","obj","$","require","window","eventsEngine","Guid","registerComponent","commonUtils","typeUtils","extend","inArray","DropDownEditor","List","errors","eventUtils","devices","dataQuery","each","DataExpressionMixin","messageLocalization","ChildDefaultTemplate","Deferred","DataConverterMixin","LIST_ITEM_SELECTOR","LIST_ITEM_DATA_KEY","DROPDOWNLIST_POPUP_WRAPPER_CLASS","SKIP_GESTURE_EVENT_CLASS","SEARCH_EVENT","SEARCH_MODES","DropDownList","_supportedKeys","parent","tab","$focusedItem","space","home","end","noop","_allowSelectItemByTab","_setSelectedElement","value","_setValue","_getDefaultOptions","displayValue","searchEnabled","searchMode","searchTimeout","minSearchLength","searchExpr","valueChangeEvent","selectedItem","noDataText","onSelectionChanged","onItemClick","showDataBeforeSearch","grouped","groupTemplate","popupPosition","my","at","offset","h","v","collision","wrapItemText","popupWidthExtension","_defaultOptionsRules","device","platform","options","buttonsLocation","_setOptionsByReference","_init","_initItems","items","_initActions","_initContentReadyAction","excludeValidators","_initSelectionChangedAction","_initItemClickAction","_initTemplates","_saveFocusOnWidget","_fitIntoRange","_items","availableItems","_calcNextItem","nextIndex","_getSelectedIndex","result","_createPopup","$popupContent","_updateCustomBoundaryContainer","customContainer","$container","$containerWithParents","_popupWrapperClass","_renderInputValue","_loadInputValue","_getItemFromPlain","cache","plainItems","_loadItem","_getPlainItems","i","_setSelectedItem","_displayValue","_refreshSelected","$itemElement","itemValue","isItemSelected","_popupShownHandler","_setFocusPolicy","_isSelectedValue","_validateSearchMode","normalizedSearchMode","_clearSelectedItem","_processDataSourceChanging","_isCustomValueAllowed","reset","_listItemElements","_popupConfig","that","templatesRenderAsynchronously","width","onShowing","onHidden","height","autoResizeEnabled","maxHeight","_renderPopupContent","_attachChildKeyboardEvents","_fireContentReadyAction","_setAriaTargetForList","_renderList","$list","role","_renderPreventBlur","eventName","e","_renderOpenedState","opened","activedescendant","controls","_listId","_setDefaultAria","haspopup","autocomplete","_refreshList","_shouldRefreshDataSource","dataSourceProvided","_isDesktopDevice","_listConfig","selectionMode","_templates","templateProvider","onContentReady","itemTemplate","indicateLoading","keyExpr","displayExpr","dataSource","_keyboardProcessor","hoverStateEnabled","focusStateEnabled","_canListHaveFocus","_getDataSource","_dataSourceOptions","paginate","_getGroupedOption","_dataSourceFromUrlLoadMode","_listContentReadyHandler","_setListOption","_listItemClickAction","_listItemClickHandler","_setListDataSource","_needPassDataSourceToList","_isMinSearchLengthExceeded","_searchValue","_getSearchEvent","_getSetFocusPolicyEvent","_renderEvents","_shouldRenderSearchEvent","_refreshEvents","_searchHandler","setTimeout","_searchCanceled","_searchDataSource","_filterDataSource","_clearFilter","_dataSourceFiltered","_shouldOpenPopup","_refreshPopupVisibility","shouldOpenPopup","_dataSourceChangedHandler","_hasItemsToShow","resultItems","resultAmount","isMinSearchLengthExceeded","_clearSearchTimer","clearTimeout","_popupShowingHandler","_dimensionChanged","_updatePopupDimensions","_updatePopupWidth","_needPopupRepaint","currentPageIndex","needRepaint","_updatePopupHeight","_getMaxHeight","$element","$customBoundaryContainer","offsetTop","containerHeight","Math","_clean","_dispose","_setCollectionWidgetOption","_setSubmitValue","submitValue","_shouldUseDisplayValue","_optionChanged","args","module"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/drop_down_editor/ui.drop_down_list.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\n\r\nfunction _typeof(obj) {\r\n    if (\"function\" === typeof Symbol && \"symbol\" === typeof Symbol.iterator) {\r\n        _typeof = function(obj) {\r\n            return typeof obj\r\n        }\r\n    } else {\r\n        _typeof = function(obj) {\r\n            return obj && \"function\" === typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj\r\n        }\r\n    }\r\n    return _typeof(obj)\r\n}\r\nvar $ = require(\"../../core/renderer\");\r\nvar window = require(\"../../core/utils/window\").getWindow();\r\nvar eventsEngine = require(\"../../events/core/events_engine\");\r\nvar Guid = require(\"../../core/guid\");\r\nvar registerComponent = require(\"../../core/component_registrator\");\r\nvar commonUtils = require(\"../../core/utils/common\");\r\nvar typeUtils = require(\"../../core/utils/type\");\r\nvar extend = require(\"../../core/utils/extend\").extend;\r\nvar inArray = require(\"../../core/utils/array\").inArray;\r\nvar DropDownEditor = require(\"./ui.drop_down_editor\");\r\nvar List = require(\"../list\");\r\nvar errors = require(\"../widget/ui.errors\");\r\nvar eventUtils = require(\"../../events/utils\");\r\nvar devices = require(\"../../core/devices\");\r\nvar dataQuery = require(\"../../data/query\");\r\nvar each = require(\"../../core/utils/iterator\").each;\r\nvar DataExpressionMixin = require(\"../editor/ui.data_expression\");\r\nvar messageLocalization = require(\"../../localization/message\");\r\nvar ChildDefaultTemplate = require(\"../../core/templates/child_default_template\").ChildDefaultTemplate;\r\nvar Deferred = require(\"../../core/utils/deferred\").Deferred;\r\nvar DataConverterMixin = require(\"../shared/grouped_data_converter_mixin\").default;\r\nvar LIST_ITEM_SELECTOR = \".dx-list-item\";\r\nvar LIST_ITEM_DATA_KEY = \"dxListItemData\";\r\nvar DROPDOWNLIST_POPUP_WRAPPER_CLASS = \"dx-dropdownlist-popup-wrapper\";\r\nvar SKIP_GESTURE_EVENT_CLASS = \"dx-skip-gesture-event\";\r\nvar SEARCH_EVENT = \"input\";\r\nvar SEARCH_MODES = [\"startswith\", \"contains\", \"endwith\", \"notcontains\"];\r\nvar DropDownList = DropDownEditor.inherit({\r\n    _supportedKeys: function() {\r\n        var parent = this.callBase();\r\n        return extend({}, parent, {\r\n            tab: function(e) {\r\n                if (this._allowSelectItemByTab()) {\r\n                    this._saveValueChangeEvent(e);\r\n                    var $focusedItem = $(this._list.option(\"focusedElement\"));\r\n                    $focusedItem.length && this._setSelectedElement($focusedItem)\r\n                }\r\n                parent.tab.apply(this, arguments)\r\n            },\r\n            space: commonUtils.noop,\r\n            home: commonUtils.noop,\r\n            end: commonUtils.noop\r\n        })\r\n    },\r\n    _allowSelectItemByTab: function() {\r\n        return this.option(\"opened\") && \"instantly\" === this.option(\"applyValueMode\")\r\n    },\r\n    _setSelectedElement: function($element) {\r\n        var value = this._valueGetter(this._list._getItemData($element));\r\n        this._setValue(value)\r\n    },\r\n    _setValue: function(value) {\r\n        this.option(\"value\", value)\r\n    },\r\n    _getDefaultOptions: function() {\r\n        return extend(this.callBase(), extend(DataExpressionMixin._dataExpressionDefaultOptions(), {\r\n            displayValue: void 0,\r\n            searchEnabled: false,\r\n            searchMode: \"contains\",\r\n            searchTimeout: 500,\r\n            minSearchLength: 0,\r\n            searchExpr: null,\r\n            valueChangeEvent: \"input change keyup\",\r\n            selectedItem: null,\r\n            noDataText: messageLocalization.format(\"dxCollectionWidget-noDataText\"),\r\n            onSelectionChanged: null,\r\n            onItemClick: commonUtils.noop,\r\n            showDataBeforeSearch: false,\r\n            grouped: false,\r\n            groupTemplate: \"group\",\r\n            popupPosition: {\r\n                my: \"left top\",\r\n                at: \"left bottom\",\r\n                offset: {\r\n                    h: 0,\r\n                    v: 0\r\n                },\r\n                collision: \"flip\"\r\n            },\r\n            wrapItemText: false,\r\n            popupWidthExtension: 0\r\n        }))\r\n    },\r\n    _defaultOptionsRules: function() {\r\n        return this.callBase().concat([{\r\n            device: {\r\n                platform: \"ios\"\r\n            },\r\n            options: {\r\n                popupPosition: {\r\n                    offset: {\r\n                        v: -1\r\n                    }\r\n                }\r\n            }\r\n        }, {\r\n            device: {\r\n                platform: \"generic\"\r\n            },\r\n            options: {\r\n                buttonsLocation: \"bottom center\"\r\n            }\r\n        }])\r\n    },\r\n    _setOptionsByReference: function() {\r\n        this.callBase();\r\n        extend(this._optionsByReference, {\r\n            value: true,\r\n            selectedItem: true,\r\n            displayValue: true\r\n        })\r\n    },\r\n    _init: function() {\r\n        this.callBase();\r\n        this._initDataExpressions();\r\n        this._initActions();\r\n        this._setListDataSource();\r\n        this._validateSearchMode();\r\n        this._clearSelectedItem();\r\n        this._initItems()\r\n    },\r\n    _initItems: function() {\r\n        var items = this.option().items;\r\n        if (items && !items.length && this._dataSource) {\r\n            this.option().items = this._dataSource.items()\r\n        }\r\n    },\r\n    _initActions: function() {\r\n        this._initContentReadyAction();\r\n        this._initSelectionChangedAction();\r\n        this._initItemClickAction()\r\n    },\r\n    _initContentReadyAction: function() {\r\n        this._contentReadyAction = this._createActionByOption(\"onContentReady\", {\r\n            excludeValidators: [\"disabled\", \"readOnly\"]\r\n        })\r\n    },\r\n    _initSelectionChangedAction: function() {\r\n        this._selectionChangedAction = this._createActionByOption(\"onSelectionChanged\", {\r\n            excludeValidators: [\"disabled\", \"readOnly\"]\r\n        })\r\n    },\r\n    _initItemClickAction: function() {\r\n        this._itemClickAction = this._createActionByOption(\"onItemClick\")\r\n    },\r\n    _initTemplates: function() {\r\n        this.callBase();\r\n        this._defaultTemplates.item = new ChildDefaultTemplate(\"item\")\r\n    },\r\n    _saveFocusOnWidget: function(e) {\r\n        if (this._list && this._list.initialOption(\"focusStateEnabled\")) {\r\n            this._focusInput()\r\n        }\r\n    },\r\n    _fitIntoRange: function(value, start, end) {\r\n        if (value > end) {\r\n            return start\r\n        }\r\n        if (value < start) {\r\n            return end\r\n        }\r\n        return value\r\n    },\r\n    _items: function() {\r\n        var items = this._getPlainItems(!this._list && this._dataSource.items());\r\n        var availableItems = new dataQuery(items).filter(\"disabled\", \"<>\", true).toArray();\r\n        return availableItems\r\n    },\r\n    _calcNextItem: function(step) {\r\n        var items = this._items();\r\n        var nextIndex = this._fitIntoRange(this._getSelectedIndex() + step, 0, items.length - 1);\r\n        return items[nextIndex]\r\n    },\r\n    _getSelectedIndex: function() {\r\n        var items = this._items();\r\n        var selectedItem = this.option(\"selectedItem\");\r\n        var result = -1;\r\n        each(items, function(index, item) {\r\n            if (this._isValueEquals(item, selectedItem)) {\r\n                result = index;\r\n                return false\r\n            }\r\n        }.bind(this));\r\n        return result\r\n    },\r\n    _createPopup: function() {\r\n        this.callBase();\r\n        this._updateCustomBoundaryContainer();\r\n        this._popup._wrapper().addClass(this._popupWrapperClass());\r\n        var $popupContent = this._popup.$content();\r\n        eventsEngine.off($popupContent, \"mouseup\");\r\n        eventsEngine.on($popupContent, \"mouseup\", this._saveFocusOnWidget.bind(this))\r\n    },\r\n    _updateCustomBoundaryContainer: function() {\r\n        var customContainer = this.option(\"dropDownOptions.container\");\r\n        var $container = customContainer && $(customContainer);\r\n        if ($container && $container.length && !typeUtils.isWindow($container.get(0))) {\r\n            var $containerWithParents = [].slice.call($container.parents());\r\n            $containerWithParents.unshift($container.get(0));\r\n            each($containerWithParents, function(i, parent) {\r\n                if (parent === $(\"body\").get(0)) {\r\n                    return false\r\n                } else {\r\n                    if (\"hidden\" === window.getComputedStyle(parent).overflowY) {\r\n                        this._$customBoundaryContainer = $(parent);\r\n                        return false\r\n                    }\r\n                }\r\n            }.bind(this))\r\n        }\r\n    },\r\n    _popupWrapperClass: function() {\r\n        return DROPDOWNLIST_POPUP_WRAPPER_CLASS\r\n    },\r\n    _renderInputValue: function() {\r\n        var value = this._getCurrentValue();\r\n        return this._loadInputValue(value, this._setSelectedItem.bind(this)).always(this.callBase.bind(this, value))\r\n    },\r\n    _loadInputValue: function(value, callback) {\r\n        return this._loadItem(value).always(callback)\r\n    },\r\n    _getItemFromPlain: function(value, cache) {\r\n        var plainItems;\r\n        var selectedItem;\r\n        if (cache && \"object\" !== _typeof(value)) {\r\n            if (!cache.itemByValue) {\r\n                cache.itemByValue = {};\r\n                plainItems = this._getPlainItems();\r\n                plainItems.forEach(function(item) {\r\n                    cache.itemByValue[this._valueGetter(item)] = item\r\n                }, this)\r\n            }\r\n            selectedItem = cache.itemByValue[value]\r\n        }\r\n        if (!selectedItem) {\r\n            plainItems = this._getPlainItems();\r\n            selectedItem = commonUtils.grep(plainItems, function(item) {\r\n                return this._isValueEquals(this._valueGetter(item), value)\r\n            }.bind(this))[0]\r\n        }\r\n        return selectedItem\r\n    },\r\n    _loadItem: function(value, cache) {\r\n        var selectedItem = this._getItemFromPlain(value, cache);\r\n        return void 0 !== selectedItem ? (new Deferred).resolve(selectedItem).promise() : this._loadValue(value)\r\n    },\r\n    _getPlainItems: function(items) {\r\n        var plainItems = [];\r\n        items = items || this.option(\"items\") || this._dataSource.items() || [];\r\n        for (var i = 0; i < items.length; i++) {\r\n            if (items[i] && items[i].items) {\r\n                plainItems = plainItems.concat(items[i].items)\r\n            } else {\r\n                plainItems.push(items[i])\r\n            }\r\n        }\r\n        return plainItems\r\n    },\r\n    _setSelectedItem: function(item) {\r\n        var displayValue = this._displayValue(item);\r\n        this.option(\"selectedItem\", commonUtils.ensureDefined(item, null));\r\n        this.option(\"displayValue\", displayValue)\r\n    },\r\n    _displayValue: function(item) {\r\n        return this._displayGetter(item)\r\n    },\r\n    _refreshSelected: function() {\r\n        var cache = {};\r\n        this._listItemElements().each(function(_, itemElement) {\r\n            var $itemElement = $(itemElement);\r\n            var itemValue = this._valueGetter($itemElement.data(LIST_ITEM_DATA_KEY));\r\n            var isItemSelected = this._isSelectedValue(itemValue, cache);\r\n            if (isItemSelected) {\r\n                this._list.selectItem($itemElement)\r\n            } else {\r\n                this._list.unselectItem($itemElement)\r\n            }\r\n        }.bind(this))\r\n    },\r\n    _popupShownHandler: function() {\r\n        this.callBase();\r\n        this._setFocusPolicy()\r\n    },\r\n    _setFocusPolicy: function() {\r\n        if (!this.option(\"focusStateEnabled\") || !this._list) {\r\n            return\r\n        }\r\n        this._list.option(\"focusedElement\", null)\r\n    },\r\n    _isSelectedValue: function(value) {\r\n        return this._isValueEquals(value, this.option(\"value\"))\r\n    },\r\n    _validateSearchMode: function() {\r\n        var searchMode = this.option(\"searchMode\");\r\n        var normalizedSearchMode = searchMode.toLowerCase();\r\n        if (inArray(normalizedSearchMode, SEARCH_MODES) < 0) {\r\n            throw errors.Error(\"E1019\", searchMode)\r\n        }\r\n    },\r\n    _clearSelectedItem: function() {\r\n        this.option(\"selectedItem\", null)\r\n    },\r\n    _processDataSourceChanging: function() {\r\n        this._setListDataSource();\r\n        this._renderInputValue().fail(function() {\r\n            if (this._isCustomValueAllowed()) {\r\n                return\r\n            }\r\n            this._clearSelectedItem()\r\n        }.bind(this))\r\n    },\r\n    _isCustomValueAllowed: function() {\r\n        return this.option(\"displayCustomValue\")\r\n    },\r\n    reset: function() {\r\n        this.callBase();\r\n        this._clearFilter();\r\n        this._clearSelectedItem()\r\n    },\r\n    _listItemElements: function() {\r\n        return this._$list ? this._$list.find(LIST_ITEM_SELECTOR) : $()\r\n    },\r\n    _popupConfig: function() {\r\n        var that = this;\r\n        return extend(this.callBase(), {\r\n            templatesRenderAsynchronously: false,\r\n            width: this.option(\"width\"),\r\n            onShowing: function() {\r\n                that.$element().addClass(SKIP_GESTURE_EVENT_CLASS)\r\n            },\r\n            onHidden: function() {\r\n                that.$element().removeClass(SKIP_GESTURE_EVENT_CLASS)\r\n            },\r\n            height: \"auto\",\r\n            autoResizeEnabled: false,\r\n            maxHeight: this._getMaxHeight.bind(this)\r\n        })\r\n    },\r\n    _renderPopupContent: function() {\r\n        this._renderList()\r\n    },\r\n    _attachChildKeyboardEvents: function() {\r\n        if (!this._canListHaveFocus()) {\r\n            this._childKeyboardProcessor = this._keyboardProcessor.attachChildProcessor();\r\n            this._setListOption(\"_keyboardProcessor\", this._childKeyboardProcessor)\r\n        }\r\n    },\r\n    _fireContentReadyAction: commonUtils.noop,\r\n    _setAriaTargetForList: function() {\r\n        this._list._getAriaTarget = this._getAriaTarget.bind(this)\r\n    },\r\n    _renderList: function() {\r\n        this._listId = \"dx-\" + (new Guid)._value;\r\n        var $list = this._$list = $(\"<div>\").attr(\"id\", this._listId).appendTo(this._popup.$content());\r\n        this._list = this._createComponent($list, List, this._listConfig());\r\n        this._refreshList();\r\n        this._setAriaTargetForList();\r\n        this._list.option(\"_listAttributes\", {\r\n            role: \"combobox\"\r\n        });\r\n        this._renderPreventBlur(this._$list)\r\n    },\r\n    _renderPreventBlur: function($target) {\r\n        var eventName = eventUtils.addNamespace(\"mousedown\", \"dxDropDownList\");\r\n        eventsEngine.off($target, eventName);\r\n        eventsEngine.on($target, eventName, function(e) {\r\n            e.preventDefault()\r\n        }.bind(this))\r\n    },\r\n    _renderOpenedState: function() {\r\n        this.callBase();\r\n        var opened = this.option(\"opened\") || void 0;\r\n        this.setAria({\r\n            activedescendant: opened && this._list.getFocusedItemId(),\r\n            controls: opened && this._listId\r\n        })\r\n    },\r\n    _setDefaultAria: function() {\r\n        this.setAria({\r\n            haspopup: \"listbox\",\r\n            autocomplete: \"list\"\r\n        })\r\n    },\r\n    _refreshList: function() {\r\n        if (this._list && this._shouldRefreshDataSource()) {\r\n            this._setListDataSource()\r\n        }\r\n    },\r\n    _shouldRefreshDataSource: function() {\r\n        var dataSourceProvided = !!this._list.option(\"dataSource\");\r\n        return dataSourceProvided !== this._needPassDataSourceToList()\r\n    },\r\n    _isDesktopDevice: function() {\r\n        return \"desktop\" === devices.real().deviceType\r\n    },\r\n    _listConfig: function() {\r\n        var options = {\r\n            selectionMode: \"single\",\r\n            _templates: this.option(\"_templates\"),\r\n            templateProvider: this.option(\"templateProvider\"),\r\n            noDataText: this.option(\"noDataText\"),\r\n            grouped: this.option(\"grouped\"),\r\n            wrapItemText: this.option(\"wrapItemText\"),\r\n            onContentReady: this._listContentReadyHandler.bind(this),\r\n            itemTemplate: this.option(\"itemTemplate\"),\r\n            indicateLoading: false,\r\n            keyExpr: this._getCollectionKeyExpr(),\r\n            displayExpr: this._displayGetterExpr(),\r\n            groupTemplate: this.option(\"groupTemplate\"),\r\n            onItemClick: this._listItemClickAction.bind(this),\r\n            dataSource: this._getDataSource(),\r\n            _keyboardProcessor: this._childKeyboardProcessor,\r\n            hoverStateEnabled: this._isDesktopDevice() ? this.option(\"hoverStateEnabled\") : false,\r\n            focusStateEnabled: this._isDesktopDevice() ? this.option(\"focusStateEnabled\") : false\r\n        };\r\n        if (!this._canListHaveFocus()) {\r\n            options.tabIndex = null;\r\n            options._keyboardProcessor = this._childKeyboardProcessor\r\n        }\r\n        return options\r\n    },\r\n    _canListHaveFocus: function() {\r\n        return false\r\n    },\r\n    _getDataSource: function() {\r\n        return this._needPassDataSourceToList() ? this._dataSource : null\r\n    },\r\n    _dataSourceOptions: function() {\r\n        return {\r\n            paginate: false\r\n        }\r\n    },\r\n    _getGroupedOption: function() {\r\n        return this.option(\"grouped\")\r\n    },\r\n    _dataSourceFromUrlLoadMode: function() {\r\n        return \"raw\"\r\n    },\r\n    _listContentReadyHandler: function() {\r\n        this._list = this._list || this._$list.dxList(\"instance\");\r\n        if (!this.option(\"deferRendering\")) {\r\n            this._refreshSelected()\r\n        }\r\n        this._dimensionChanged();\r\n        this._contentReadyAction()\r\n    },\r\n    _setListOption: function(optionName, value) {\r\n        this._setWidgetOption(\"_list\", arguments)\r\n    },\r\n    _listItemClickAction: function(e) {\r\n        this._listItemClickHandler(e);\r\n        this._itemClickAction(e)\r\n    },\r\n    _listItemClickHandler: commonUtils.noop,\r\n    _setListDataSource: function() {\r\n        if (!this._list) {\r\n            return\r\n        }\r\n        this._setListOption(\"dataSource\", this._getDataSource());\r\n        if (!this._needPassDataSourceToList()) {\r\n            this._setListOption(\"items\", [])\r\n        }\r\n    },\r\n    _needPassDataSourceToList: function() {\r\n        return this.option(\"showDataBeforeSearch\") || this._isMinSearchLengthExceeded()\r\n    },\r\n    _isMinSearchLengthExceeded: function() {\r\n        return this._searchValue().toString().length >= this.option(\"minSearchLength\")\r\n    },\r\n    _searchValue: function() {\r\n        return this._input().val() || \"\"\r\n    },\r\n    _getSearchEvent: function() {\r\n        return eventUtils.addNamespace(SEARCH_EVENT, this.NAME + \"Search\")\r\n    },\r\n    _getSetFocusPolicyEvent: function() {\r\n        return eventUtils.addNamespace(\"input\", this.NAME + \"FocusPolicy\")\r\n    },\r\n    _renderEvents: function() {\r\n        this.callBase();\r\n        eventsEngine.on(this._input(), this._getSetFocusPolicyEvent(), this._setFocusPolicy.bind(this));\r\n        if (this._shouldRenderSearchEvent()) {\r\n            eventsEngine.on(this._input(), this._getSearchEvent(), this._searchHandler.bind(this))\r\n        }\r\n    },\r\n    _shouldRenderSearchEvent: function() {\r\n        return this.option(\"searchEnabled\")\r\n    },\r\n    _refreshEvents: function() {\r\n        eventsEngine.off(this._input(), this._getSearchEvent());\r\n        eventsEngine.off(this._input(), this._getSetFocusPolicyEvent());\r\n        this.callBase()\r\n    },\r\n    _searchHandler: function() {\r\n        if (!this._isMinSearchLengthExceeded()) {\r\n            this._searchCanceled();\r\n            return\r\n        }\r\n        var searchTimeout = this.option(\"searchTimeout\");\r\n        if (searchTimeout) {\r\n            this._clearSearchTimer();\r\n            this._searchTimer = setTimeout(this._searchDataSource.bind(this), searchTimeout)\r\n        } else {\r\n            this._searchDataSource()\r\n        }\r\n    },\r\n    _searchCanceled: function() {\r\n        this._clearSearchTimer();\r\n        if (this._needPassDataSourceToList()) {\r\n            this._filterDataSource(null)\r\n        }\r\n        this._refreshList()\r\n    },\r\n    _searchDataSource: function() {\r\n        this._filterDataSource(this._searchValue())\r\n    },\r\n    _filterDataSource: function(searchValue) {\r\n        this._clearSearchTimer();\r\n        var dataSource = this._dataSource;\r\n        dataSource.searchExpr(this.option(\"searchExpr\") || this._displayGetterExpr());\r\n        dataSource.searchOperation(this.option(\"searchMode\"));\r\n        dataSource.searchValue(searchValue);\r\n        return dataSource.load().done(this._dataSourceFiltered.bind(this, searchValue))\r\n    },\r\n    _clearFilter: function() {\r\n        var dataSource = this._dataSource;\r\n        dataSource && dataSource.searchValue() && dataSource.searchValue(null)\r\n    },\r\n    _dataSourceFiltered: function() {\r\n        this._refreshList();\r\n        this._refreshPopupVisibility()\r\n    },\r\n    _shouldOpenPopup: function() {\r\n        return this._hasItemsToShow()\r\n    },\r\n    _refreshPopupVisibility: function() {\r\n        if (this.option(\"readOnly\") || !this._searchValue()) {\r\n            return\r\n        }\r\n        var shouldOpenPopup = this._shouldOpenPopup();\r\n        if (shouldOpenPopup && !this._isFocused()) {\r\n            return\r\n        }\r\n        this.option(\"opened\", shouldOpenPopup);\r\n        if (shouldOpenPopup) {\r\n            this._dimensionChanged()\r\n        }\r\n    },\r\n    _dataSourceChangedHandler: function(newItems) {\r\n        if (0 === this._dataSource.pageIndex()) {\r\n            this.option().items = newItems\r\n        } else {\r\n            this.option().items = this.option().items.concat(newItems)\r\n        }\r\n    },\r\n    _hasItemsToShow: function() {\r\n        var resultItems = this._dataSource && this._dataSource.items() || [];\r\n        var resultAmount = resultItems.length;\r\n        var isMinSearchLengthExceeded = this._needPassDataSourceToList();\r\n        return !!(isMinSearchLengthExceeded && resultAmount)\r\n    },\r\n    _clearSearchTimer: function() {\r\n        clearTimeout(this._searchTimer);\r\n        delete this._searchTimer\r\n    },\r\n    _popupShowingHandler: function() {\r\n        this._dimensionChanged()\r\n    },\r\n    _dimensionChanged: function() {\r\n        this._popup && this._updatePopupDimensions()\r\n    },\r\n    _updatePopupDimensions: function() {\r\n        this._updatePopupWidth();\r\n        this._updatePopupHeight()\r\n    },\r\n    _updatePopupWidth: function() {\r\n        this._setPopupOption(\"width\", this.$element().outerWidth() + this.option(\"popupWidthExtension\"))\r\n    },\r\n    _needPopupRepaint: function() {\r\n        if (!this._dataSource) {\r\n            return false\r\n        }\r\n        var currentPageIndex = this._dataSource.pageIndex();\r\n        var needRepaint = typeUtils.isDefined(this._pageIndex) && currentPageIndex <= this._pageIndex;\r\n        this._pageIndex = currentPageIndex;\r\n        return needRepaint\r\n    },\r\n    _updatePopupHeight: function() {\r\n        if (this._needPopupRepaint()) {\r\n            this._popup.repaint()\r\n        }\r\n        this._list && this._list.updateDimensions()\r\n    },\r\n    _getMaxHeight: function() {\r\n        var $element = this.$element();\r\n        var $customBoundaryContainer = this._$customBoundaryContainer;\r\n        var offsetTop = $element.offset().top - ($customBoundaryContainer ? $customBoundaryContainer.offset().top : 0);\r\n        var containerHeight = ($customBoundaryContainer || $(window)).outerHeight();\r\n        var maxHeight = Math.max(offsetTop, containerHeight - offsetTop - $element.outerHeight());\r\n        return Math.min(.5 * containerHeight, maxHeight)\r\n    },\r\n    _clean: function() {\r\n        if (this._list) {\r\n            delete this._list\r\n        }\r\n        this.callBase()\r\n    },\r\n    _dispose: function() {\r\n        this._clearSearchTimer();\r\n        this.callBase()\r\n    },\r\n    _setCollectionWidgetOption: function() {\r\n        this._setListOption.apply(this, arguments)\r\n    },\r\n    _setSubmitValue: function() {\r\n        var value = this.option(\"value\");\r\n        var submitValue = this._shouldUseDisplayValue(value) ? this._displayGetter(value) : value;\r\n        this._getSubmitElement().val(submitValue)\r\n    },\r\n    _shouldUseDisplayValue: function(value) {\r\n        return \"this\" === this.option(\"valueExpr\") && typeUtils.isObject(value)\r\n    },\r\n    _optionChanged: function(args) {\r\n        this._dataExpressionOptionChanged(args);\r\n        switch (args.name) {\r\n            case \"hoverStateEnabled\":\r\n            case \"focusStateEnabled\":\r\n                this._isDesktopDevice() && this._setListOption(args.name, args.value);\r\n                this.callBase(args);\r\n                break;\r\n            case \"items\":\r\n                if (!this.option(\"dataSource\")) {\r\n                    this._processDataSourceChanging()\r\n                }\r\n                break;\r\n            case \"dataSource\":\r\n                this._processDataSourceChanging();\r\n                break;\r\n            case \"valueExpr\":\r\n                this._renderValue();\r\n                this._setListOption(\"keyExpr\", this._getCollectionKeyExpr());\r\n                break;\r\n            case \"displayExpr\":\r\n                this._renderValue();\r\n                this._setListOption(\"displayExpr\", this._displayGetterExpr());\r\n                break;\r\n            case \"searchMode\":\r\n                this._validateSearchMode();\r\n                break;\r\n            case \"minSearchLength\":\r\n                this._refreshList();\r\n                break;\r\n            case \"searchEnabled\":\r\n            case \"showDataBeforeSearch\":\r\n            case \"searchExpr\":\r\n                this._invalidate();\r\n                break;\r\n            case \"onContentReady\":\r\n                this._initContentReadyAction();\r\n                break;\r\n            case \"onSelectionChanged\":\r\n                this._initSelectionChangedAction();\r\n                break;\r\n            case \"onItemClick\":\r\n                this._initItemClickAction();\r\n                break;\r\n            case \"grouped\":\r\n            case \"groupTemplate\":\r\n            case \"wrapItemText\":\r\n            case \"noDataText\":\r\n                this._setListOption(args.name);\r\n                break;\r\n            case \"displayValue\":\r\n                this.option(\"text\", args.value);\r\n                break;\r\n            case \"itemTemplate\":\r\n            case \"searchTimeout\":\r\n            case \"popupWidthExtension\":\r\n                break;\r\n            case \"selectedItem\":\r\n                this._selectionChangedAction({\r\n                    selectedItem: args.value\r\n                });\r\n                break;\r\n            default:\r\n                this.callBase(args)\r\n        }\r\n    }\r\n}).include(DataExpressionMixin, DataConverterMixin);\r\nregisterComponent(\"dxDropDownList\", DropDownList);\r\nmodule.exports = DropDownList;\r\n"]},"metadata":{},"sourceType":"module"}