{"ast":null,"code":"/**\r\n * DevExtreme (exporter/svg_creator.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar $ = require(\"../core/renderer\");\n\nvar ajax = require(\"../core/utils/ajax\");\n\nvar window = require(\"../core/utils/window\").getWindow();\n\nvar isFunction = require(\"../core/utils/type\").isFunction;\n\nvar each = require(\"../core/utils/iterator\").each;\n\nvar svgUtils = require(\"../core/utils/svg\");\n\nvar deferredUtils = require(\"../core/utils/deferred\");\n\nvar when = deferredUtils.when;\nvar Deferred = deferredUtils.Deferred;\nexports.svgCreator = {\n  _markup: \"\",\n  _imageArray: {},\n  _imageDeferreds: [],\n  _getBinaryFile: function _getBinaryFile(src, callback) {\n    ajax.sendRequest({\n      url: src,\n      method: \"GET\",\n      responseType: \"arraybuffer\"\n    }).done(callback).fail(function () {\n      callback(false);\n    });\n  },\n  _loadImages: function _loadImages() {\n    var that = this;\n    each(that._imageArray, function (src) {\n      var deferred = new Deferred();\n\n      that._imageDeferreds.push(deferred);\n\n      that._getBinaryFile(src, function (response) {\n        if (!response) {\n          delete that._imageArray[src];\n          deferred.resolve();\n          return;\n        }\n\n        var i;\n        var binary = \"\";\n        var bytes = new Uint8Array(response);\n        var length = bytes.byteLength;\n\n        for (i = 0; i < length; i++) {\n          binary += String.fromCharCode(bytes[i]);\n        }\n\n        that._imageArray[src] = \"data:image/png;base64,\" + window.btoa(binary);\n        deferred.resolve();\n      });\n    });\n  },\n  _parseImages: function _parseImages(element) {\n    var href;\n    var that = this;\n\n    if (\"image\" === element.tagName) {\n      href = $(element).attr(\"href\") || $(element).attr(\"xlink:href\");\n\n      if (!that._imageArray[href]) {\n        that._imageArray[href] = \"\";\n      }\n    }\n\n    each(element.childNodes, function (_, element) {\n      that._parseImages(element);\n    });\n  },\n  _prepareImages: function _prepareImages(svgElem) {\n    this._parseImages(svgElem);\n\n    this._loadImages();\n\n    return when.apply($, this._imageDeferreds);\n  },\n  getData: function getData(data, options) {\n    var markup;\n    var that = this;\n    var xmlVersion = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\" ?>';\n    var svgElem = svgUtils.getSvgElement(data);\n    var $svgObject = $(svgElem);\n    markup = xmlVersion + svgUtils.getSvgMarkup($svgObject.get(0), options.backgroundColor);\n    return that._prepareImages(svgElem).then(function () {\n      each(that._imageArray, function (href, dataURI) {\n        var regexpString = \"href=['|\\\"]\".concat(href, \"['|\\\"]\");\n        markup = markup.replace(new RegExp(regexpString, \"gi\"), 'href=\"'.concat(dataURI, '\"'));\n      });\n      return isFunction(window.Blob) ? that._getBlob(markup) : that._getBase64(markup);\n    });\n  },\n  _getBlob: function _getBlob(markup) {\n    return new window.Blob([markup], {\n      type: \"image/svg+xml\"\n    });\n  },\n  _getBase64: function _getBase64(markup) {\n    return window.btoa(markup);\n  }\n};\n\nexports.getData = function (data, options) {\n  return exports.svgCreator.getData(data, options);\n};","map":{"version":3,"sources":["C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/devextreme/exporter/svg_creator.js"],"names":["$","require","ajax","window","isFunction","each","svgUtils","deferredUtils","when","Deferred","exports","_markup","_imageArray","_imageDeferreds","_getBinaryFile","url","method","responseType","callback","_loadImages","that","deferred","binary","bytes","length","i","String","_parseImages","element","href","_prepareImages","getData","xmlVersion","svgElem","$svgObject","markup","options","regexpString","_getBlob","type","_getBase64"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (exporter/svg_creator.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar $ = require(\"../core/renderer\");\r\nvar ajax = require(\"../core/utils/ajax\");\r\nvar window = require(\"../core/utils/window\").getWindow();\r\nvar isFunction = require(\"../core/utils/type\").isFunction;\r\nvar each = require(\"../core/utils/iterator\").each;\r\nvar svgUtils = require(\"../core/utils/svg\");\r\nvar deferredUtils = require(\"../core/utils/deferred\");\r\nvar when = deferredUtils.when;\r\nvar Deferred = deferredUtils.Deferred;\r\nexports.svgCreator = {\r\n    _markup: \"\",\r\n    _imageArray: {},\r\n    _imageDeferreds: [],\r\n    _getBinaryFile: function(src, callback) {\r\n        ajax.sendRequest({\r\n            url: src,\r\n            method: \"GET\",\r\n            responseType: \"arraybuffer\"\r\n        }).done(callback).fail(function() {\r\n            callback(false)\r\n        })\r\n    },\r\n    _loadImages: function() {\r\n        var that = this;\r\n        each(that._imageArray, function(src) {\r\n            var deferred = new Deferred;\r\n            that._imageDeferreds.push(deferred);\r\n            that._getBinaryFile(src, function(response) {\r\n                if (!response) {\r\n                    delete that._imageArray[src];\r\n                    deferred.resolve();\r\n                    return\r\n                }\r\n                var i;\r\n                var binary = \"\";\r\n                var bytes = new Uint8Array(response);\r\n                var length = bytes.byteLength;\r\n                for (i = 0; i < length; i++) {\r\n                    binary += String.fromCharCode(bytes[i])\r\n                }\r\n                that._imageArray[src] = \"data:image/png;base64,\" + window.btoa(binary);\r\n                deferred.resolve()\r\n            })\r\n        })\r\n    },\r\n    _parseImages: function(element) {\r\n        var href;\r\n        var that = this;\r\n        if (\"image\" === element.tagName) {\r\n            href = $(element).attr(\"href\") || $(element).attr(\"xlink:href\");\r\n            if (!that._imageArray[href]) {\r\n                that._imageArray[href] = \"\"\r\n            }\r\n        }\r\n        each(element.childNodes, function(_, element) {\r\n            that._parseImages(element)\r\n        })\r\n    },\r\n    _prepareImages: function(svgElem) {\r\n        this._parseImages(svgElem);\r\n        this._loadImages();\r\n        return when.apply($, this._imageDeferreds)\r\n    },\r\n    getData: function(data, options) {\r\n        var markup;\r\n        var that = this;\r\n        var xmlVersion = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\" ?>';\r\n        var svgElem = svgUtils.getSvgElement(data);\r\n        var $svgObject = $(svgElem);\r\n        markup = xmlVersion + svgUtils.getSvgMarkup($svgObject.get(0), options.backgroundColor);\r\n        return that._prepareImages(svgElem).then(function() {\r\n            each(that._imageArray, function(href, dataURI) {\r\n                var regexpString = \"href=['|\\\"]\".concat(href, \"['|\\\"]\");\r\n                markup = markup.replace(new RegExp(regexpString, \"gi\"), 'href=\"'.concat(dataURI, '\"'))\r\n            });\r\n            return isFunction(window.Blob) ? that._getBlob(markup) : that._getBase64(markup)\r\n        })\r\n    },\r\n    _getBlob: function(markup) {\r\n        return new window.Blob([markup], {\r\n            type: \"image/svg+xml\"\r\n        })\r\n    },\r\n    _getBase64: function(markup) {\r\n        return window.btoa(markup)\r\n    }\r\n};\r\nexports.getData = function(data, options) {\r\n    return exports.svgCreator.getData(data, options)\r\n};\r\n"]},"metadata":{},"sourceType":"module"}