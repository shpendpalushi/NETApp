{"ast":null,"code":"/**\r\n * DevExtreme (ui/scheduler/ui.scheduler.subscribes.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar _renderer = require(\"../../core/renderer\");\n\nvar _renderer2 = _interopRequireDefault(_renderer);\n\nvar _array = require(\"../../core/utils/array\");\n\nvar _array2 = _interopRequireDefault(_array);\n\nvar _utils = require(\"./utils.recurrence\");\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nvar _type = require(\"../../core/utils/type\");\n\nvar _type2 = _interopRequireDefault(_type);\n\nvar _date = require(\"../../core/utils/date\");\n\nvar _date2 = _interopRequireDefault(_date);\n\nvar _iterator = require(\"../../core/utils/iterator\");\n\nvar _translator = require(\"../../animation/translator\");\n\nvar _translator2 = _interopRequireDefault(_translator);\n\nvar _common = require(\"../../core/utils/common\");\n\nvar _extend = require(\"../../core/utils/extend\");\n\nvar _uiScheduler = require(\"./timezones/ui.scheduler.timezones\");\n\nvar _uiScheduler2 = _interopRequireDefault(_uiScheduler);\n\nvar _deferred = require(\"../../core/utils/deferred\");\n\nvar _date3 = require(\"../../localization/date\");\n\nvar _date4 = _interopRequireDefault(_date3);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nvar MINUTES_IN_HOUR = 60;\nvar toMs = _date2.default.dateToMilliseconds;\nvar subscribes = {\n  isCurrentViewAgenda: function isCurrentViewAgenda() {\n    return \"agenda\" === this.option(\"currentView\");\n  },\n  currentViewUpdated: function currentViewUpdated(currentView) {\n    this.option(\"currentView\", currentView);\n  },\n  currentDateUpdated: function currentDateUpdated(date) {\n    this.option(\"currentDate\", date);\n  },\n  setCellDataCacheAlias: function setCellDataCacheAlias(appointment, geometry) {\n    this._workSpace.setCellDataCacheAlias(appointment, geometry);\n  },\n  needCoordinates: function needCoordinates(options) {\n    var _this = this;\n\n    var appointmentData = options.appointmentData;\n    var startDate = options.startDate;\n\n    var endDate = this._getEndDate(appointmentData);\n\n    var recurrenceRule = this.fire(\"getField\", \"recurrenceRule\", appointmentData);\n\n    var recurrenceException = this._getRecurrenceException(appointmentData);\n\n    var dateRange = this._workSpace.getDateRange();\n\n    var allDay = this.appointmentTakesAllDay(appointmentData);\n    var startViewDate = this.appointmentTakesAllDay(appointmentData) ? _date2.default.trimTime(new Date(dateRange[0])) : dateRange[0];\n    var originalStartDate = options.originalStartDate || startDate;\n    var renderingStrategy = this.getLayoutManager().getRenderingStrategyInstance();\n    var firstDayOfWeek = this.getFirstDayOfWeek();\n    var recurrenceOptions = {\n      rule: recurrenceRule,\n      exception: recurrenceException,\n      start: originalStartDate,\n      end: endDate,\n      min: startViewDate,\n      max: dateRange[1],\n      firstDayOfWeek: firstDayOfWeek\n    };\n\n    var dates = _utils2.default.getDatesByRecurrence(recurrenceOptions);\n\n    var initialDates;\n\n    if (!dates.length) {\n      dates.push(startDate);\n      initialDates = dates;\n    } else {\n      initialDates = dates;\n      dates = dates.map(function (date) {\n        return _date2.default.roundDateByStartDayHour(date, _this._getCurrentViewOption(\"startDayHour\"));\n      });\n    }\n\n    if (renderingStrategy.needSeparateAppointment(allDay)) {\n      var datesLength = dates.length;\n      var longParts = [];\n      var resultDates = [];\n\n      var _loop = function _loop(i) {\n        var endDateOfPart = renderingStrategy.endDate(appointmentData, {\n          startDate: dates[i]\n        }, !!recurrenceRule);\n        longParts = _date2.default.getDatesOfInterval(dates[i], endDateOfPart, {\n          milliseconds: _this.getWorkSpace().getIntervalDuration(allDay)\n        });\n        var maxDate = new Date(dateRange[1]);\n        resultDates = resultDates.concat(longParts.filter(function (el) {\n          return new Date(el) < maxDate;\n        }));\n      };\n\n      for (var i = 0; i < datesLength; i++) {\n        _loop(i);\n      }\n\n      dates = resultDates;\n    }\n\n    var itemResources = this._resourcesManager.getResourcesFromItem(appointmentData);\n\n    allDay = this.appointmentTakesAllDay(appointmentData) && this._workSpace.supportAllDayRow();\n    return this._getCoordinates(initialDates, dates, itemResources, allDay);\n  },\n  isGroupedByDate: function isGroupedByDate() {\n    return this.getWorkSpace().isGroupedByDate();\n  },\n  showAppointmentTooltip: function showAppointmentTooltip(options) {\n    var appointmentData = options.data;\n    var targetData = this.fire(\"getTargetedAppointmentData\", appointmentData, (0, _renderer2.default)(options.target));\n    this.showAppointmentTooltip(appointmentData, options.target, targetData);\n  },\n  hideAppointmentTooltip: function hideAppointmentTooltip() {\n    this.hideAppointmentTooltip();\n  },\n  showAddAppointmentPopup: function showAddAppointmentPopup(appointmentData) {\n    var processedData = {};\n    (0, _iterator.each)([\"startDate\", \"endDate\", \"allDay\"], function (_, field) {\n      if (void 0 !== appointmentData[field]) {\n        this.fire(\"setField\", field, processedData, appointmentData[field]);\n        delete appointmentData[field];\n      }\n    }.bind(this));\n    this.showAppointmentPopup((0, _extend.extend)(processedData, appointmentData), true);\n  },\n  showEditAppointmentPopup: function showEditAppointmentPopup(options) {\n    var appointmentData = options.data;\n    options.$appointment = (0, _renderer2.default)(options.target);\n    options.skipHoursProcessing = true;\n\n    var singleAppointmentData = this._getSingleAppointmentData(appointmentData, options);\n\n    var startDate = this.fire(\"getField\", \"startDate\", singleAppointmentData);\n    this.showAppointmentPopup(appointmentData, false, singleAppointmentData, startDate);\n  },\n  updateAppointmentAfterResize: function updateAppointmentAfterResize(options) {\n    var targetAppointment = options.target;\n    options.isAppointmentResized = true;\n\n    var singleAppointment = this._getSingleAppointmentData(targetAppointment, options);\n\n    var startDate = this.fire(\"getField\", \"startDate\", singleAppointment);\n    var updatedData = (0, _extend.extend)(true, {}, options.data);\n\n    this._convertDatesByTimezoneBack(true, updatedData);\n\n    this._checkRecurringAppointment(targetAppointment, singleAppointment, startDate, function () {\n      this._updateAppointment(targetAppointment, updatedData, function () {\n        this._appointments.moveAppointmentBack();\n      });\n    }.bind(this));\n  },\n  getUpdatedData: function getUpdatedData(options) {\n    return this._getUpdatedData({\n      data: options.data\n    });\n  },\n  updateAppointmentAfterDrag: function updateAppointmentAfterDrag(options) {\n    var target = options.data;\n\n    var updatedData = this._getUpdatedData(options);\n\n    var newCellIndex = this._workSpace.getDroppableCellIndex();\n\n    var oldCellIndex = this._workSpace.getCellIndexByCoordinates(options.coordinates);\n\n    var becomeAllDay = this.fire(\"getField\", \"allDay\", updatedData);\n    var wasAllDay = this.fire(\"getField\", \"allDay\", target);\n    var dragEvent = options.event;\n    var appointment = (0, _extend.extend)({}, target, updatedData);\n    var movedToAllDay = this._workSpace.supportAllDayRow() && becomeAllDay;\n\n    var cellData = this._workSpace.getCellDataByCoordinates(options.coordinates, movedToAllDay);\n\n    var movedBetweenAllDayAndSimple = this._workSpace.supportAllDayRow() && (wasAllDay && !becomeAllDay || !wasAllDay && becomeAllDay);\n\n    if (newCellIndex !== oldCellIndex || movedBetweenAllDayAndSimple) {\n      this._checkRecurringAppointment(target, appointment, cellData.startDate, function () {\n        this._convertDatesByTimezoneBack(true, updatedData, appointment);\n\n        this._updateAppointment(target, appointment, function () {\n          this._appointments.moveAppointmentBack(dragEvent);\n        }, dragEvent);\n      }.bind(this), void 0, void 0, dragEvent);\n    } else {\n      this._appointments.moveAppointmentBack(dragEvent);\n    }\n  },\n  deleteAppointment: function deleteAppointment(options) {\n    options.$appointment = (0, _renderer2.default)(options.target);\n    var appointmentData = options.data;\n\n    var singleAppointmentData = this._getSingleAppointmentData(appointmentData, options);\n\n    this.checkAndDeleteAppointment(appointmentData, singleAppointmentData);\n  },\n  getAppointmentColor: function getAppointmentColor(options) {\n    var resourcesManager = this._resourcesManager;\n    var resourceForPainting = resourcesManager.getResourceForPainting(this._getCurrentViewOption(\"groups\"));\n    var response = new _deferred.Deferred().resolve().promise();\n\n    if (resourceForPainting) {\n      var field = resourcesManager.getField(resourceForPainting);\n      var groupIndex = options.groupIndex;\n\n      var groups = this._workSpace._getCellGroups(groupIndex);\n\n      var resourceValues = _array2.default.wrapToArray(resourcesManager.getDataAccessors(field, \"getter\")(options.itemData));\n\n      var groupId = resourceValues.length ? resourceValues[0] : void 0;\n\n      for (var i = 0; i < groups.length; i++) {\n        if (groups[i].name === field) {\n          groupId = groups[i].id;\n          break;\n        }\n      }\n\n      response = resourcesManager.getResourceColor(field, groupId);\n    }\n\n    return response;\n  },\n  getHeaderHeight: function getHeaderHeight() {\n    return this._header._$element && parseInt(this._header._$element.outerHeight(), 10);\n  },\n  getResourcesFromItem: function getResourcesFromItem(itemData) {\n    return this._resourcesManager.getResourcesFromItem(itemData);\n  },\n  getBoundOffset: function getBoundOffset() {\n    return {\n      top: -this.getWorkSpaceAllDayHeight()\n    };\n  },\n  appointmentTakesSeveralDays: function appointmentTakesSeveralDays(appointment) {\n    return this._appointmentModel.appointmentTakesSeveralDays(appointment);\n  },\n  appointmentFocused: function appointmentFocused() {\n    this._workSpace.restoreScrollTop();\n  },\n  getTextAndFormatDate: function getTextAndFormatDate(data, currentData, format) {\n    var fields = [\"startDate\", \"endDate\", \"startDateTimeZone\", \"endDateTimeZone\", \"allDay\", \"text\"];\n    var appointmentFields = this.fire(\"_getAppointmentFields\", (0, _extend.extend)({}, data, currentData), fields);\n    var startDate = this.fire(\"convertDateByTimezone\", appointmentFields.startDate, appointmentFields.startDateTimeZone);\n    var endDate = this.fire(\"convertDateByTimezone\", appointmentFields.endDate, appointmentFields.endDateTimeZone);\n    return {\n      text: this.fire(\"createAppointmentTitle\", appointmentFields),\n      formatDate: this.fire(\"_formatDates\", startDate, endDate, appointmentFields.allDay, format)\n    };\n  },\n  createAppointmentTitle: function createAppointmentTitle(data) {\n    if (_type2.default.isPlainObject(data)) {\n      return data.text;\n    }\n\n    return String(data);\n  },\n  _getAppointmentFields: function _getAppointmentFields(data, arrayOfFields) {\n    var _this2 = this;\n\n    return arrayOfFields.reduce(function (accumulator, field) {\n      accumulator[field] = _this2.fire(\"getField\", field, data);\n      return accumulator;\n    }, {});\n  },\n  _formatDates: function _formatDates(startDate, endDate, isAllDay, format) {\n    var formatType = format || this.fire(\"_getTypeFormat\", startDate, endDate, isAllDay);\n    var formatTypes = {\n      DATETIME: function DATETIME() {\n        var dateTimeFormat = \"mediumdatemediumtime\";\n        var startDateString = _date4.default.format(startDate, dateTimeFormat) + \" - \";\n        var endDateString = startDate.getDate() === endDate.getDate() ? _date4.default.format(endDate, \"shorttime\") : _date4.default.format(endDate, dateTimeFormat);\n        return startDateString + endDateString;\n      },\n      TIME: function TIME() {\n        return _date4.default.format(startDate, \"shorttime\") + \" - \" + _date4.default.format(endDate, \"shorttime\");\n      },\n      DATE: function DATE() {\n        var dateTimeFormat = \"monthAndDay\";\n\n        var startDateString = _date4.default.format(startDate, dateTimeFormat);\n\n        var isDurationMoreThanDay = endDate.getTime() - startDate.getTime() > toMs(\"day\");\n        var endDateString = isDurationMoreThanDay || endDate.getDate() !== startDate.getDate() ? \" - \" + _date4.default.format(endDate, dateTimeFormat) : \"\";\n        return startDateString + endDateString;\n      }\n    };\n    return formatTypes[formatType]();\n  },\n  _getTypeFormat: function _getTypeFormat(startDate, endDate, isAllDay) {\n    if (isAllDay) {\n      return \"DATE\";\n    }\n\n    if (\"month\" !== this.option(\"currentView\") && _date2.default.sameDate(startDate, endDate)) {\n      return \"TIME\";\n    }\n\n    return \"DATETIME\";\n  },\n  getResizableAppointmentArea: function getResizableAppointmentArea(options) {\n    var allDay = options.allDay;\n\n    var groups = this._getCurrentViewOption(\"groups\");\n\n    if (groups && groups.length) {\n      if (allDay || this.getLayoutManager().getRenderingStrategyInstance()._needHorizontalGroupBounds()) {\n        var horizontalGroupBounds = this._workSpace.getGroupBounds(options.coordinates);\n\n        return {\n          left: horizontalGroupBounds.left,\n          right: horizontalGroupBounds.right,\n          top: 0,\n          bottom: 0\n        };\n      }\n\n      if (this.getLayoutManager().getRenderingStrategyInstance()._needVerticalGroupBounds(allDay) && this._workSpace._isVerticalGroupedWorkSpace()) {\n        var verticalGroupBounds = this._workSpace.getGroupBounds(options.coordinates);\n\n        return {\n          left: 0,\n          right: 0,\n          top: verticalGroupBounds.top,\n          bottom: verticalGroupBounds.bottom\n        };\n      }\n    }\n  },\n  needRecalculateResizableArea: function needRecalculateResizableArea() {\n    return this.getWorkSpace().needRecalculateResizableArea();\n  },\n  getAppointmentGeometry: function getAppointmentGeometry(settings) {\n    return this.getLayoutManager().getRenderingStrategyInstance().getAppointmentGeometry(settings);\n  },\n  isAllDay: function isAllDay(appointmentData) {\n    return this.getLayoutManager().getRenderingStrategyInstance().isAllDay(appointmentData);\n  },\n  getDeltaTime: function getDeltaTime(e, initialSize, itemData) {\n    return this.getLayoutManager().getRenderingStrategyInstance().getDeltaTime(e, initialSize, itemData);\n  },\n  getDropDownAppointmentWidth: function getDropDownAppointmentWidth(isAllDay) {\n    return this.getLayoutManager().getRenderingStrategyInstance().getDropDownAppointmentWidth(this._getViewCountConfig().intervalCount, isAllDay);\n  },\n  getDropDownAppointmentHeight: function getDropDownAppointmentHeight() {\n    return this.getLayoutManager().getRenderingStrategyInstance().getDropDownAppointmentHeight();\n  },\n  getStartDate: function getStartDate(appointmentData, skipNormalize) {\n    return this._getStartDate(appointmentData, skipNormalize);\n  },\n  getCellWidth: function getCellWidth() {\n    return this._cellWidth;\n  },\n  getCellHeight: function getCellHeight() {\n    return this._cellHeight;\n  },\n  getResizableStep: function getResizableStep() {\n    var cellWidth = this._cellWidth;\n    var workSpace = this.getWorkSpace();\n\n    if (workSpace.isGroupedByDate()) {\n      return workSpace._getGroupCount() * cellWidth;\n    }\n\n    return cellWidth;\n  },\n  getEndDate: function getEndDate(appointmentData, skipNormalize) {\n    return this._getEndDate(appointmentData, skipNormalize);\n  },\n  getRenderingStrategy: function getRenderingStrategy() {\n    return this._getAppointmentsRenderingStrategy();\n  },\n  getMaxAppointmentCountPerCellByType: function getMaxAppointmentCountPerCellByType(isAllDay) {\n    return this.getRenderingStrategyInstance()._getMaxAppointmentCountPerCellByType(isAllDay);\n  },\n  needCorrectAppointmentDates: function needCorrectAppointmentDates() {\n    return this.getRenderingStrategyInstance().needCorrectAppointmentDates();\n  },\n  getRenderingStrategyDirection: function getRenderingStrategyDirection() {\n    return this.getRenderingStrategyInstance().getDirection();\n  },\n  getWorkSpaceDateTableOffset: function getWorkSpaceDateTableOffset() {\n    return this.getWorkSpaceDateTableOffset();\n  },\n  getFullWeekAppointmentWidth: function getFullWeekAppointmentWidth(options) {\n    var groupIndex = options.groupIndex;\n    return this._workSpace.getGroupWidth(groupIndex);\n  },\n  getMaxAppointmentWidth: function getMaxAppointmentWidth(options) {\n    var workSpace = this._workSpace;\n    return workSpace.getCellCountToLastViewDate(options.date) * workSpace.getCellWidth();\n  },\n  updateAppointmentStartDate: function updateAppointmentStartDate(options) {\n    var appointment = options.appointment;\n\n    var firstViewDate = this._workSpace.getStartViewDate();\n\n    var startDate = new Date(options.startDate);\n\n    var startDayHour = this._getCurrentViewOption(\"startDayHour\");\n\n    var updatedStartDate;\n\n    if (this.appointmentTakesAllDay(appointment)) {\n      updatedStartDate = _date2.default.normalizeDate(startDate, firstViewDate);\n    } else {\n      if (startDate < firstViewDate) {\n        startDate = firstViewDate;\n      }\n\n      updatedStartDate = _date2.default.normalizeDate(options.startDate, new Date(startDate));\n    }\n\n    return _date2.default.roundDateByStartDayHour(updatedStartDate, startDayHour);\n  },\n  updateAppointmentEndDate: function updateAppointmentEndDate(options) {\n    var endDate = options.endDate;\n\n    var endDayHour = this._getCurrentViewOption(\"endDayHour\");\n\n    var startDayHour = this._getCurrentViewOption(\"startDayHour\");\n\n    var updatedEndDate = endDate;\n\n    if (endDate.getHours() >= endDayHour) {\n      updatedEndDate.setHours(endDayHour, 0, 0, 0);\n    } else {\n      if (!options.isSameDate && startDayHour > 0 && 60 * endDate.getHours() + endDate.getMinutes() < 60 * startDayHour) {\n        updatedEndDate = new Date(updatedEndDate.getTime() - toMs(\"day\"));\n        updatedEndDate.setHours(endDayHour, 0, 0, 0);\n      }\n    }\n\n    return updatedEndDate;\n  },\n  renderCompactAppointments: function renderCompactAppointments(options) {\n    this._compactAppointmentsHelper.render(options);\n  },\n  clearCompactAppointments: function clearCompactAppointments() {\n    this._compactAppointmentsHelper.clear();\n  },\n  supportCompactDropDownAppointments: function supportCompactDropDownAppointments() {\n    return this._workSpace._supportCompactDropDownAppointments();\n  },\n  isApplyCompactAppointmentOffset: function isApplyCompactAppointmentOffset() {\n    return this._workSpace._isApplyCompactAppointmentOffset();\n  },\n  getGroupCount: function getGroupCount() {\n    return this._workSpace._getGroupCount();\n  },\n  mapAppointmentFields: function mapAppointmentFields(config) {\n    return {\n      appointmentData: config.itemData,\n      appointmentElement: config.itemElement,\n      targetedAppointmentData: this.fire(\"getTargetedAppointmentData\", config.itemData, config.itemElement)\n    };\n  },\n  getOffsetByAllDayPanel: function getOffsetByAllDayPanel(groupIndex) {\n    return this._workSpace._getOffsetByAllDayPanel(groupIndex);\n  },\n  getGroupTop: function getGroupTop(groupIndex) {\n    return this._workSpace._getGroupTop(groupIndex);\n  },\n  updateResizableArea: function updateResizableArea() {\n    var $allResizableElements = this.$element().find(\".dx-scheduler-appointment.dx-resizable\");\n    var horizontalResizables = (0, _common.grep)($allResizableElements, function (el) {\n      var $el = (0, _renderer2.default)(el);\n      var resizableInst = $el.dxResizable(\"instance\");\n      var area = resizableInst.option(\"area\");\n      return (0, _array.inArray)(resizableInst.option(\"handles\"), [\"right left\", \"left right\"]) > -1 && _type2.default.isPlainObject(area);\n    });\n    (0, _iterator.each)(horizontalResizables, function (_, el) {\n      var $el = (0, _renderer2.default)(el);\n\n      var position = _translator2.default.locate($el);\n\n      var appointmentData = this._appointments._getItemData($el);\n\n      var area = this._appointments._calculateResizableArea({\n        left: position.left\n      }, appointmentData);\n\n      $el.dxResizable(\"instance\").option(\"area\", area);\n    }.bind(this));\n  },\n  recurrenceEditorVisibilityChanged: function recurrenceEditorVisibilityChanged(visible) {\n    this.recurrenceEditorVisibilityChanged(visible);\n  },\n  resizePopup: function resizePopup() {\n    this.resizePopup();\n  },\n  getField: function getField(field, obj) {\n    if (!_type2.default.isDefined(this._dataAccessors.getter[field])) {\n      return;\n    }\n\n    return this._dataAccessors.getter[field](obj);\n  },\n  setField: function setField(field, obj, value) {\n    if (!_type2.default.isDefined(this._dataAccessors.setter[field])) {\n      return;\n    }\n\n    var splitExprStr = this.option(field + \"Expr\").split(\".\");\n    var rootField = splitExprStr[0];\n\n    if (void 0 === obj[rootField] && splitExprStr.length > 1) {\n      var emptyChain = function (arr) {\n        var result = {};\n        var tmp = result;\n        var arrLength = arr.length - 1;\n\n        for (var i = 1; i < arrLength; i++) {\n          tmp = tmp[arr[i]] = {};\n        }\n\n        return result;\n      }(splitExprStr);\n\n      obj[rootField] = emptyChain;\n    }\n\n    this._dataAccessors.setter[field](obj, value);\n\n    return obj;\n  },\n  prerenderFilter: function prerenderFilter() {\n    var dateRange = this.getWorkSpace().getDateRange();\n\n    var resources = this._resourcesManager.getResourcesData();\n\n    var allDay;\n\n    if (!this.option(\"showAllDayPanel\") && this._workSpace.supportAllDayRow()) {\n      allDay = false;\n    }\n\n    return this._appointmentModel.filterLoadedAppointments({\n      startDayHour: this._getCurrentViewOption(\"startDayHour\"),\n      endDayHour: this._getCurrentViewOption(\"endDayHour\"),\n      min: dateRange[0],\n      max: dateRange[1],\n      resources: resources,\n      allDay: allDay,\n      firstDayOfWeek: this.getFirstDayOfWeek(),\n      recurrenceException: this._getRecurrenceException.bind(this)\n    }, this._subscribes.convertDateByTimezone.bind(this));\n  },\n  dayHasAppointment: function dayHasAppointment(day, appointment, trimTime) {\n    return this.dayHasAppointment(day, appointment, trimTime);\n  },\n  createResourcesTree: function createResourcesTree() {\n    return this._resourcesManager.createResourcesTree(this._loadedResources);\n  },\n  getResourceTreeLeaves: function getResourceTreeLeaves(tree, appointmentResources) {\n    return this._resourcesManager.getResourceTreeLeaves(tree, appointmentResources);\n  },\n  createReducedResourcesTree: function createReducedResourcesTree() {\n    var tree = this._resourcesManager.createResourcesTree(this._loadedResources);\n\n    return this._resourcesManager.reduceResourcesTree(tree, this.getFilteredItems());\n  },\n  groupAppointmentsByResources: function groupAppointmentsByResources(appointments) {\n    var result = {\n      0: appointments\n    };\n\n    var groups = this._getCurrentViewOption(\"groups\");\n\n    if (groups && groups.length && this._resourcesManager.getResourcesData().length) {\n      result = this._resourcesManager.groupAppointmentsByResources(appointments, this._loadedResources);\n    }\n\n    var totalResourceCount = 0;\n    (0, _iterator.each)(this._loadedResources, function (i, resource) {\n      if (!i) {\n        totalResourceCount = resource.items.length;\n      } else {\n        totalResourceCount *= resource.items.length;\n      }\n    });\n\n    for (var j = 0; j < totalResourceCount; j++) {\n      var index = j.toString();\n\n      if (result[index]) {\n        continue;\n      }\n\n      result[index] = [];\n    }\n\n    return result;\n  },\n  getAgendaRows: function getAgendaRows(options) {\n    var renderingStrategy = this._layoutManager.getRenderingStrategyInstance();\n\n    var calculateRows = renderingStrategy.calculateRows.bind(renderingStrategy);\n    var d = new _deferred.Deferred();\n\n    function rowsCalculated(appointments) {\n      var result = calculateRows(appointments, options.agendaDuration, options.currentDate);\n\n      this._dataSourceLoadedCallback.remove(rowsCalculated);\n\n      d.resolve(result);\n    }\n\n    this._dataSourceLoadedCallback.add(rowsCalculated);\n\n    return d.promise();\n  },\n  getAgendaVerticalStepHeight: function getAgendaVerticalStepHeight() {\n    return this.getWorkSpace().getAgendaVerticalStepHeight();\n  },\n  getAgendaDuration: function getAgendaDuration() {\n    return this._getCurrentViewOption(\"agendaDuration\");\n  },\n  getStartViewDate: function getStartViewDate() {\n    return this.getStartViewDate();\n  },\n  getEndViewDate: function getEndViewDate() {\n    return this.getEndViewDate();\n  },\n  getMaxAppointmentsPerCell: function getMaxAppointmentsPerCell() {\n    return this.getMaxAppointmentsPerCell();\n  },\n  forceMaxAppointmentPerCell: function forceMaxAppointmentPerCell() {\n    return this.forceMaxAppointmentPerCell();\n  },\n  agendaIsReady: function agendaIsReady(rows, innerRowOffset, outerRowOffset) {\n    var $appts = this.getAppointmentsInstance()._itemElements();\n\n    var total = 0;\n    $appts.css(\"marginBottom\", innerRowOffset);\n\n    var applyOffset = function applyOffset(_, count) {\n      var index = count + total - 1;\n      $appts.eq(index).css(\"marginBottom\", outerRowOffset);\n      total += count;\n    };\n\n    for (var i = 0; i < rows.length; i++) {\n      (0, _iterator.each)(rows[i], applyOffset);\n    }\n  },\n  getTimezone: function getTimezone() {\n    return this._getTimezoneOffsetByOption();\n  },\n  getClientTimezoneOffset: function getClientTimezoneOffset(date) {\n    date = date || new Date();\n    return _uiScheduler2.default.getClientTimezoneOffset(date);\n  },\n  convertDateByTimezone: function convertDateByTimezone(date, appointmentTimezone) {\n    date = new Date(date);\n\n    var tzOffsets = this._subscribes.getComplexOffsets(this, date, appointmentTimezone);\n\n    date = this._subscribes.translateDateToAppointmentTimeZone(date, tzOffsets);\n    date = this._subscribes.translateDateToCommonTimeZone(date, tzOffsets);\n    return date;\n  },\n  convertDateByTimezoneBack: function convertDateByTimezoneBack(date, appointmentTimezone) {\n    date = new Date(date);\n\n    var tzOffsets = this._subscribes.getComplexOffsets(this, date, appointmentTimezone);\n\n    date = this._subscribes.translateDateToAppointmentTimeZone(date, tzOffsets, true);\n    date = this._subscribes.translateDateToCommonTimeZone(date, tzOffsets, true);\n    return date;\n  },\n  translateDateToAppointmentTimeZone: function translateDateToAppointmentTimeZone(date, offsets, back) {\n    var operation = back ? -1 : 1;\n    var dateInUTC = date.getTime() - operation * offsets.client * toMs(\"hour\");\n    return new Date(dateInUTC + operation * offsets.appointment * toMs(\"hour\"));\n  },\n  translateDateToCommonTimeZone: function translateDateToCommonTimeZone(date, offsets, back) {\n    var operation = back ? -1 : 1;\n\n    if (\"number\" === typeof offsets.common) {\n      var offset = offsets.common - offsets.appointment;\n      var hoursOffset = (offset < 0 ? -1 : 1) * Math.floor(Math.abs(offset));\n      var minutesOffset = offset % 1;\n      date.setHours(date.getHours() + operation * hoursOffset);\n      date.setMinutes(date.getMinutes() + operation * minutesOffset * MINUTES_IN_HOUR);\n    }\n\n    return date;\n  },\n  getComplexOffsets: function getComplexOffsets(scheduler, date, appointmentTimezone) {\n    var clientTimezoneOffset = -this.getClientTimezoneOffset(date) / toMs(\"hour\");\n\n    var commonTimezoneOffset = scheduler._getTimezoneOffsetByOption(date);\n\n    var appointmentTimezoneOffset = scheduler._calculateTimezoneByValue(appointmentTimezone, date);\n\n    if (\"number\" !== typeof appointmentTimezoneOffset) {\n      appointmentTimezoneOffset = clientTimezoneOffset;\n    }\n\n    return {\n      client: clientTimezoneOffset,\n      common: commonTimezoneOffset,\n      appointment: appointmentTimezoneOffset\n    };\n  },\n  getDaylightOffset: function getDaylightOffset(startDate, endDate) {\n    return startDate.getTimezoneOffset() - endDate.getTimezoneOffset();\n  },\n  getTimezonesDisplayName: function getTimezonesDisplayName() {\n    return _uiScheduler2.default.getTimezonesDisplayName();\n  },\n  getTimezoneDisplayNameById: function getTimezoneDisplayNameById(id) {\n    return _uiScheduler2.default.getTimezoneDisplayNameById(id);\n  },\n  getSimilarTimezones: function getSimilarTimezones(id) {\n    return _uiScheduler2.default.getSimilarTimezones(id);\n  },\n  getTimezonesIdsByDisplayName: function getTimezonesIdsByDisplayName(displayName) {\n    return _uiScheduler2.default.getTimezonesIdsByDisplayName(displayName);\n  },\n  getTargetedAppointmentData: function getTargetedAppointmentData(appointmentData, appointmentElement, skipTimezoneConvert) {\n    var $appointmentElement = (0, _renderer2.default)(appointmentElement);\n    var appointmentIndex = $appointmentElement.data(this._appointments._itemIndexKey());\n\n    var recurringData = this._getSingleAppointmentData(appointmentData, {\n      skipDateCalculation: true,\n      $appointment: $appointmentElement,\n      skipHoursProcessing: true\n    });\n\n    var result = {};\n    (0, _extend.extend)(true, result, appointmentData, recurringData);\n\n    if (this._isAppointmentRecurrence(appointmentData) && !skipTimezoneConvert) {\n      this._convertDatesByTimezoneBack(false, result);\n    }\n\n    appointmentElement && this.setTargetedAppointmentResources(result, appointmentElement, appointmentIndex);\n    return result;\n  },\n  getAppointmentDurationInMs: function getAppointmentDurationInMs(options) {\n    var startDate = options.startDate;\n    var endDate = options.endDate;\n    var allDay = options.allDay;\n    var appointmentDuration = endDate.getTime() - startDate.getTime();\n    var dayDuration = toMs(\"day\");\n\n    var visibleDayDuration = this._workSpace.getVisibleDayDuration();\n\n    var result = 0;\n\n    if (allDay) {\n      var ceilQuantityOfDays = Math.ceil(appointmentDuration / dayDuration);\n      result = ceilQuantityOfDays * visibleDayDuration;\n    } else {\n      var isDifferentDate = !_date2.default.sameDate(startDate, new Date(endDate.getTime() - 1));\n      var floorQuantityOfDays = Math.floor(appointmentDuration / dayDuration);\n      var tailDuration;\n\n      if (isDifferentDate) {\n        var startDateEndHour = new Date(new Date(startDate).setHours(this.option(\"endDayHour\"), 0, 0));\n        var hiddenDayDuration = dayDuration - visibleDayDuration - (startDate.getTime() > startDateEndHour.getTime() ? startDate.getTime() - startDateEndHour.getTime() : 0);\n        tailDuration = appointmentDuration - (floorQuantityOfDays ? floorQuantityOfDays * dayDuration : hiddenDayDuration);\n        var startDayTime = this.option(\"startDayHour\") * toMs(\"hour\");\n\n        var endPartDuration = endDate - _date2.default.trimTime(endDate);\n\n        if (endPartDuration < startDayTime) {\n          if (floorQuantityOfDays) {\n            tailDuration -= hiddenDayDuration;\n          }\n\n          tailDuration += startDayTime - endPartDuration;\n        }\n      } else {\n        tailDuration = appointmentDuration % dayDuration;\n      }\n\n      if (tailDuration > visibleDayDuration) {\n        tailDuration = visibleDayDuration;\n      }\n\n      result = floorQuantityOfDays * visibleDayDuration + tailDuration || toMs(\"minute\");\n    }\n\n    return result;\n  },\n  fixWrongEndDate: function fixWrongEndDate(appointment, startDate, endDate) {\n    return this._appointmentModel.fixWrongEndDate(appointment, startDate, endDate);\n  },\n  getEndDayHour: function getEndDayHour() {\n    return this._workSpace.option(\"endDayHour\") || this.option(\"endDayHour\");\n  },\n  getStartDayHour: function getStartDayHour() {\n    return this._workSpace.option(\"startDayHour\") || this.option(\"startDayHour\");\n  },\n  isAdaptive: function isAdaptive() {\n    return this.option(\"adaptivityEnabled\");\n  },\n  moveBack: function moveBack() {\n    var dragBehavior = this.getWorkSpace().dragBehavior;\n    dragBehavior && dragBehavior.moveBack();\n  }\n};\nmodule.exports = subscribes;","map":{"version":3,"sources":["C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/devextreme/ui/scheduler/ui.scheduler.subscribes.js"],"names":["_renderer","require","_renderer2","_interopRequireDefault","_array","_array2","_utils","_utils2","_type","_type2","_date","_date2","_iterator","_translator","_translator2","_common","_extend","_uiScheduler","_uiScheduler2","_deferred","_date3","_date4","obj","MINUTES_IN_HOUR","toMs","subscribes","isCurrentViewAgenda","currentViewUpdated","currentDateUpdated","setCellDataCacheAlias","needCoordinates","_this","appointmentData","options","startDate","endDate","recurrenceRule","recurrenceException","dateRange","allDay","startViewDate","originalStartDate","renderingStrategy","firstDayOfWeek","recurrenceOptions","rule","exception","start","end","min","max","dates","initialDates","datesLength","longParts","resultDates","_loop","endDateOfPart","milliseconds","maxDate","i","itemResources","isGroupedByDate","showAppointmentTooltip","targetData","hideAppointmentTooltip","showAddAppointmentPopup","processedData","showEditAppointmentPopup","singleAppointmentData","updateAppointmentAfterResize","targetAppointment","singleAppointment","updatedData","getUpdatedData","data","updateAppointmentAfterDrag","target","newCellIndex","oldCellIndex","becomeAllDay","wasAllDay","dragEvent","appointment","movedToAllDay","cellData","movedBetweenAllDayAndSimple","deleteAppointment","getAppointmentColor","resourcesManager","resourceForPainting","response","field","groupIndex","groups","resourceValues","groupId","getHeaderHeight","parseInt","getResourcesFromItem","getBoundOffset","top","appointmentTakesSeveralDays","appointmentFocused","getTextAndFormatDate","fields","appointmentFields","text","formatDate","createAppointmentTitle","String","_getAppointmentFields","_this2","accumulator","_formatDates","formatType","format","formatTypes","DATETIME","dateTimeFormat","startDateString","endDateString","TIME","DATE","isDurationMoreThanDay","_getTypeFormat","getResizableAppointmentArea","horizontalGroupBounds","left","right","bottom","verticalGroupBounds","needRecalculateResizableArea","getAppointmentGeometry","isAllDay","getDeltaTime","getDropDownAppointmentWidth","getDropDownAppointmentHeight","getStartDate","getCellWidth","getCellHeight","getResizableStep","cellWidth","workSpace","getEndDate","getRenderingStrategy","getMaxAppointmentCountPerCellByType","needCorrectAppointmentDates","getRenderingStrategyDirection","getWorkSpaceDateTableOffset","getFullWeekAppointmentWidth","getMaxAppointmentWidth","updateAppointmentStartDate","firstViewDate","startDayHour","updatedStartDate","updateAppointmentEndDate","endDayHour","updatedEndDate","renderCompactAppointments","clearCompactAppointments","supportCompactDropDownAppointments","isApplyCompactAppointmentOffset","getGroupCount","mapAppointmentFields","config","appointmentElement","targetedAppointmentData","getOffsetByAllDayPanel","getGroupTop","updateResizableArea","$allResizableElements","horizontalResizables","$el","resizableInst","area","position","recurrenceEditorVisibilityChanged","resizePopup","getField","setField","splitExprStr","rootField","emptyChain","result","tmp","arrLength","arr","prerenderFilter","resources","dayHasAppointment","createResourcesTree","getResourceTreeLeaves","createReducedResourcesTree","tree","groupAppointmentsByResources","appointments","totalResourceCount","resource","j","index","getAgendaRows","calculateRows","d","getAgendaVerticalStepHeight","getAgendaDuration","getStartViewDate","getEndViewDate","getMaxAppointmentsPerCell","forceMaxAppointmentPerCell","agendaIsReady","$appts","total","applyOffset","count","rows","getTimezone","getClientTimezoneOffset","date","convertDateByTimezone","tzOffsets","convertDateByTimezoneBack","translateDateToAppointmentTimeZone","operation","back","dateInUTC","offsets","translateDateToCommonTimeZone","offset","hoursOffset","Math","minutesOffset","getComplexOffsets","clientTimezoneOffset","commonTimezoneOffset","scheduler","appointmentTimezoneOffset","client","common","getDaylightOffset","getTimezonesDisplayName","getTimezoneDisplayNameById","getSimilarTimezones","getTimezonesIdsByDisplayName","getTargetedAppointmentData","$appointmentElement","appointmentIndex","recurringData","skipDateCalculation","$appointment","skipHoursProcessing","getAppointmentDurationInMs","appointmentDuration","dayDuration","visibleDayDuration","ceilQuantityOfDays","isDifferentDate","floorQuantityOfDays","startDateEndHour","hiddenDayDuration","tailDuration","startDayTime","endPartDuration","fixWrongEndDate","getEndDayHour","getStartDayHour","isAdaptive","moveBack","dragBehavior","module"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/scheduler/ui.scheduler.subscribes.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar _renderer = require(\"../../core/renderer\");\r\nvar _renderer2 = _interopRequireDefault(_renderer);\r\nvar _array = require(\"../../core/utils/array\");\r\nvar _array2 = _interopRequireDefault(_array);\r\nvar _utils = require(\"./utils.recurrence\");\r\nvar _utils2 = _interopRequireDefault(_utils);\r\nvar _type = require(\"../../core/utils/type\");\r\nvar _type2 = _interopRequireDefault(_type);\r\nvar _date = require(\"../../core/utils/date\");\r\nvar _date2 = _interopRequireDefault(_date);\r\nvar _iterator = require(\"../../core/utils/iterator\");\r\nvar _translator = require(\"../../animation/translator\");\r\nvar _translator2 = _interopRequireDefault(_translator);\r\nvar _common = require(\"../../core/utils/common\");\r\nvar _extend = require(\"../../core/utils/extend\");\r\nvar _uiScheduler = require(\"./timezones/ui.scheduler.timezones\");\r\nvar _uiScheduler2 = _interopRequireDefault(_uiScheduler);\r\nvar _deferred = require(\"../../core/utils/deferred\");\r\nvar _date3 = require(\"../../localization/date\");\r\nvar _date4 = _interopRequireDefault(_date3);\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\nvar MINUTES_IN_HOUR = 60;\r\nvar toMs = _date2.default.dateToMilliseconds;\r\nvar subscribes = {\r\n    isCurrentViewAgenda: function() {\r\n        return \"agenda\" === this.option(\"currentView\")\r\n    },\r\n    currentViewUpdated: function(currentView) {\r\n        this.option(\"currentView\", currentView)\r\n    },\r\n    currentDateUpdated: function(date) {\r\n        this.option(\"currentDate\", date)\r\n    },\r\n    setCellDataCacheAlias: function(appointment, geometry) {\r\n        this._workSpace.setCellDataCacheAlias(appointment, geometry)\r\n    },\r\n    needCoordinates: function(options) {\r\n        var _this = this;\r\n        var appointmentData = options.appointmentData;\r\n        var startDate = options.startDate;\r\n        var endDate = this._getEndDate(appointmentData);\r\n        var recurrenceRule = this.fire(\"getField\", \"recurrenceRule\", appointmentData);\r\n        var recurrenceException = this._getRecurrenceException(appointmentData);\r\n        var dateRange = this._workSpace.getDateRange();\r\n        var allDay = this.appointmentTakesAllDay(appointmentData);\r\n        var startViewDate = this.appointmentTakesAllDay(appointmentData) ? _date2.default.trimTime(new Date(dateRange[0])) : dateRange[0];\r\n        var originalStartDate = options.originalStartDate || startDate;\r\n        var renderingStrategy = this.getLayoutManager().getRenderingStrategyInstance();\r\n        var firstDayOfWeek = this.getFirstDayOfWeek();\r\n        var recurrenceOptions = {\r\n            rule: recurrenceRule,\r\n            exception: recurrenceException,\r\n            start: originalStartDate,\r\n            end: endDate,\r\n            min: startViewDate,\r\n            max: dateRange[1],\r\n            firstDayOfWeek: firstDayOfWeek\r\n        };\r\n        var dates = _utils2.default.getDatesByRecurrence(recurrenceOptions);\r\n        var initialDates;\r\n        if (!dates.length) {\r\n            dates.push(startDate);\r\n            initialDates = dates\r\n        } else {\r\n            initialDates = dates;\r\n            dates = dates.map(function(date) {\r\n                return _date2.default.roundDateByStartDayHour(date, _this._getCurrentViewOption(\"startDayHour\"))\r\n            })\r\n        }\r\n        if (renderingStrategy.needSeparateAppointment(allDay)) {\r\n            var datesLength = dates.length;\r\n            var longParts = [];\r\n            var resultDates = [];\r\n            var _loop = function(i) {\r\n                var endDateOfPart = renderingStrategy.endDate(appointmentData, {\r\n                    startDate: dates[i]\r\n                }, !!recurrenceRule);\r\n                longParts = _date2.default.getDatesOfInterval(dates[i], endDateOfPart, {\r\n                    milliseconds: _this.getWorkSpace().getIntervalDuration(allDay)\r\n                });\r\n                var maxDate = new Date(dateRange[1]);\r\n                resultDates = resultDates.concat(longParts.filter(function(el) {\r\n                    return new Date(el) < maxDate\r\n                }))\r\n            };\r\n            for (var i = 0; i < datesLength; i++) {\r\n                _loop(i)\r\n            }\r\n            dates = resultDates\r\n        }\r\n        var itemResources = this._resourcesManager.getResourcesFromItem(appointmentData);\r\n        allDay = this.appointmentTakesAllDay(appointmentData) && this._workSpace.supportAllDayRow();\r\n        return this._getCoordinates(initialDates, dates, itemResources, allDay)\r\n    },\r\n    isGroupedByDate: function() {\r\n        return this.getWorkSpace().isGroupedByDate()\r\n    },\r\n    showAppointmentTooltip: function(options) {\r\n        var appointmentData = options.data;\r\n        var targetData = this.fire(\"getTargetedAppointmentData\", appointmentData, (0, _renderer2.default)(options.target));\r\n        this.showAppointmentTooltip(appointmentData, options.target, targetData)\r\n    },\r\n    hideAppointmentTooltip: function() {\r\n        this.hideAppointmentTooltip()\r\n    },\r\n    showAddAppointmentPopup: function(appointmentData) {\r\n        var processedData = {};\r\n        (0, _iterator.each)([\"startDate\", \"endDate\", \"allDay\"], function(_, field) {\r\n            if (void 0 !== appointmentData[field]) {\r\n                this.fire(\"setField\", field, processedData, appointmentData[field]);\r\n                delete appointmentData[field]\r\n            }\r\n        }.bind(this));\r\n        this.showAppointmentPopup((0, _extend.extend)(processedData, appointmentData), true)\r\n    },\r\n    showEditAppointmentPopup: function(options) {\r\n        var appointmentData = options.data;\r\n        options.$appointment = (0, _renderer2.default)(options.target);\r\n        options.skipHoursProcessing = true;\r\n        var singleAppointmentData = this._getSingleAppointmentData(appointmentData, options);\r\n        var startDate = this.fire(\"getField\", \"startDate\", singleAppointmentData);\r\n        this.showAppointmentPopup(appointmentData, false, singleAppointmentData, startDate)\r\n    },\r\n    updateAppointmentAfterResize: function(options) {\r\n        var targetAppointment = options.target;\r\n        options.isAppointmentResized = true;\r\n        var singleAppointment = this._getSingleAppointmentData(targetAppointment, options);\r\n        var startDate = this.fire(\"getField\", \"startDate\", singleAppointment);\r\n        var updatedData = (0, _extend.extend)(true, {}, options.data);\r\n        this._convertDatesByTimezoneBack(true, updatedData);\r\n        this._checkRecurringAppointment(targetAppointment, singleAppointment, startDate, function() {\r\n            this._updateAppointment(targetAppointment, updatedData, function() {\r\n                this._appointments.moveAppointmentBack()\r\n            })\r\n        }.bind(this))\r\n    },\r\n    getUpdatedData: function(options) {\r\n        return this._getUpdatedData({\r\n            data: options.data\r\n        })\r\n    },\r\n    updateAppointmentAfterDrag: function(options) {\r\n        var target = options.data;\r\n        var updatedData = this._getUpdatedData(options);\r\n        var newCellIndex = this._workSpace.getDroppableCellIndex();\r\n        var oldCellIndex = this._workSpace.getCellIndexByCoordinates(options.coordinates);\r\n        var becomeAllDay = this.fire(\"getField\", \"allDay\", updatedData);\r\n        var wasAllDay = this.fire(\"getField\", \"allDay\", target);\r\n        var dragEvent = options.event;\r\n        var appointment = (0, _extend.extend)({}, target, updatedData);\r\n        var movedToAllDay = this._workSpace.supportAllDayRow() && becomeAllDay;\r\n        var cellData = this._workSpace.getCellDataByCoordinates(options.coordinates, movedToAllDay);\r\n        var movedBetweenAllDayAndSimple = this._workSpace.supportAllDayRow() && (wasAllDay && !becomeAllDay || !wasAllDay && becomeAllDay);\r\n        if (newCellIndex !== oldCellIndex || movedBetweenAllDayAndSimple) {\r\n            this._checkRecurringAppointment(target, appointment, cellData.startDate, function() {\r\n                this._convertDatesByTimezoneBack(true, updatedData, appointment);\r\n                this._updateAppointment(target, appointment, function() {\r\n                    this._appointments.moveAppointmentBack(dragEvent)\r\n                }, dragEvent)\r\n            }.bind(this), void 0, void 0, dragEvent)\r\n        } else {\r\n            this._appointments.moveAppointmentBack(dragEvent)\r\n        }\r\n    },\r\n    deleteAppointment: function(options) {\r\n        options.$appointment = (0, _renderer2.default)(options.target);\r\n        var appointmentData = options.data;\r\n        var singleAppointmentData = this._getSingleAppointmentData(appointmentData, options);\r\n        this.checkAndDeleteAppointment(appointmentData, singleAppointmentData)\r\n    },\r\n    getAppointmentColor: function(options) {\r\n        var resourcesManager = this._resourcesManager;\r\n        var resourceForPainting = resourcesManager.getResourceForPainting(this._getCurrentViewOption(\"groups\"));\r\n        var response = (new _deferred.Deferred).resolve().promise();\r\n        if (resourceForPainting) {\r\n            var field = resourcesManager.getField(resourceForPainting);\r\n            var groupIndex = options.groupIndex;\r\n            var groups = this._workSpace._getCellGroups(groupIndex);\r\n            var resourceValues = _array2.default.wrapToArray(resourcesManager.getDataAccessors(field, \"getter\")(options.itemData));\r\n            var groupId = resourceValues.length ? resourceValues[0] : void 0;\r\n            for (var i = 0; i < groups.length; i++) {\r\n                if (groups[i].name === field) {\r\n                    groupId = groups[i].id;\r\n                    break\r\n                }\r\n            }\r\n            response = resourcesManager.getResourceColor(field, groupId)\r\n        }\r\n        return response\r\n    },\r\n    getHeaderHeight: function() {\r\n        return this._header._$element && parseInt(this._header._$element.outerHeight(), 10)\r\n    },\r\n    getResourcesFromItem: function(itemData) {\r\n        return this._resourcesManager.getResourcesFromItem(itemData)\r\n    },\r\n    getBoundOffset: function() {\r\n        return {\r\n            top: -this.getWorkSpaceAllDayHeight()\r\n        }\r\n    },\r\n    appointmentTakesSeveralDays: function(appointment) {\r\n        return this._appointmentModel.appointmentTakesSeveralDays(appointment)\r\n    },\r\n    appointmentFocused: function() {\r\n        this._workSpace.restoreScrollTop()\r\n    },\r\n    getTextAndFormatDate: function(data, currentData, format) {\r\n        var fields = [\"startDate\", \"endDate\", \"startDateTimeZone\", \"endDateTimeZone\", \"allDay\", \"text\"];\r\n        var appointmentFields = this.fire(\"_getAppointmentFields\", (0, _extend.extend)({}, data, currentData), fields);\r\n        var startDate = this.fire(\"convertDateByTimezone\", appointmentFields.startDate, appointmentFields.startDateTimeZone);\r\n        var endDate = this.fire(\"convertDateByTimezone\", appointmentFields.endDate, appointmentFields.endDateTimeZone);\r\n        return {\r\n            text: this.fire(\"createAppointmentTitle\", appointmentFields),\r\n            formatDate: this.fire(\"_formatDates\", startDate, endDate, appointmentFields.allDay, format)\r\n        }\r\n    },\r\n    createAppointmentTitle: function(data) {\r\n        if (_type2.default.isPlainObject(data)) {\r\n            return data.text\r\n        }\r\n        return String(data)\r\n    },\r\n    _getAppointmentFields: function(data, arrayOfFields) {\r\n        var _this2 = this;\r\n        return arrayOfFields.reduce(function(accumulator, field) {\r\n            accumulator[field] = _this2.fire(\"getField\", field, data);\r\n            return accumulator\r\n        }, {})\r\n    },\r\n    _formatDates: function(startDate, endDate, isAllDay, format) {\r\n        var formatType = format || this.fire(\"_getTypeFormat\", startDate, endDate, isAllDay);\r\n        var formatTypes = {\r\n            DATETIME: function() {\r\n                var dateTimeFormat = \"mediumdatemediumtime\";\r\n                var startDateString = _date4.default.format(startDate, dateTimeFormat) + \" - \";\r\n                var endDateString = startDate.getDate() === endDate.getDate() ? _date4.default.format(endDate, \"shorttime\") : _date4.default.format(endDate, dateTimeFormat);\r\n                return startDateString + endDateString\r\n            },\r\n            TIME: function() {\r\n                return _date4.default.format(startDate, \"shorttime\") + \" - \" + _date4.default.format(endDate, \"shorttime\")\r\n            },\r\n            DATE: function() {\r\n                var dateTimeFormat = \"monthAndDay\";\r\n                var startDateString = _date4.default.format(startDate, dateTimeFormat);\r\n                var isDurationMoreThanDay = endDate.getTime() - startDate.getTime() > toMs(\"day\");\r\n                var endDateString = isDurationMoreThanDay || endDate.getDate() !== startDate.getDate() ? \" - \" + _date4.default.format(endDate, dateTimeFormat) : \"\";\r\n                return startDateString + endDateString\r\n            }\r\n        };\r\n        return formatTypes[formatType]()\r\n    },\r\n    _getTypeFormat: function(startDate, endDate, isAllDay) {\r\n        if (isAllDay) {\r\n            return \"DATE\"\r\n        }\r\n        if (\"month\" !== this.option(\"currentView\") && _date2.default.sameDate(startDate, endDate)) {\r\n            return \"TIME\"\r\n        }\r\n        return \"DATETIME\"\r\n    },\r\n    getResizableAppointmentArea: function(options) {\r\n        var allDay = options.allDay;\r\n        var groups = this._getCurrentViewOption(\"groups\");\r\n        if (groups && groups.length) {\r\n            if (allDay || this.getLayoutManager().getRenderingStrategyInstance()._needHorizontalGroupBounds()) {\r\n                var horizontalGroupBounds = this._workSpace.getGroupBounds(options.coordinates);\r\n                return {\r\n                    left: horizontalGroupBounds.left,\r\n                    right: horizontalGroupBounds.right,\r\n                    top: 0,\r\n                    bottom: 0\r\n                }\r\n            }\r\n            if (this.getLayoutManager().getRenderingStrategyInstance()._needVerticalGroupBounds(allDay) && this._workSpace._isVerticalGroupedWorkSpace()) {\r\n                var verticalGroupBounds = this._workSpace.getGroupBounds(options.coordinates);\r\n                return {\r\n                    left: 0,\r\n                    right: 0,\r\n                    top: verticalGroupBounds.top,\r\n                    bottom: verticalGroupBounds.bottom\r\n                }\r\n            }\r\n        }\r\n    },\r\n    needRecalculateResizableArea: function() {\r\n        return this.getWorkSpace().needRecalculateResizableArea()\r\n    },\r\n    getAppointmentGeometry: function(settings) {\r\n        return this.getLayoutManager().getRenderingStrategyInstance().getAppointmentGeometry(settings)\r\n    },\r\n    isAllDay: function(appointmentData) {\r\n        return this.getLayoutManager().getRenderingStrategyInstance().isAllDay(appointmentData)\r\n    },\r\n    getDeltaTime: function(e, initialSize, itemData) {\r\n        return this.getLayoutManager().getRenderingStrategyInstance().getDeltaTime(e, initialSize, itemData)\r\n    },\r\n    getDropDownAppointmentWidth: function(isAllDay) {\r\n        return this.getLayoutManager().getRenderingStrategyInstance().getDropDownAppointmentWidth(this._getViewCountConfig().intervalCount, isAllDay)\r\n    },\r\n    getDropDownAppointmentHeight: function() {\r\n        return this.getLayoutManager().getRenderingStrategyInstance().getDropDownAppointmentHeight()\r\n    },\r\n    getStartDate: function(appointmentData, skipNormalize) {\r\n        return this._getStartDate(appointmentData, skipNormalize)\r\n    },\r\n    getCellWidth: function() {\r\n        return this._cellWidth\r\n    },\r\n    getCellHeight: function() {\r\n        return this._cellHeight\r\n    },\r\n    getResizableStep: function() {\r\n        var cellWidth = this._cellWidth;\r\n        var workSpace = this.getWorkSpace();\r\n        if (workSpace.isGroupedByDate()) {\r\n            return workSpace._getGroupCount() * cellWidth\r\n        }\r\n        return cellWidth\r\n    },\r\n    getEndDate: function(appointmentData, skipNormalize) {\r\n        return this._getEndDate(appointmentData, skipNormalize)\r\n    },\r\n    getRenderingStrategy: function() {\r\n        return this._getAppointmentsRenderingStrategy()\r\n    },\r\n    getMaxAppointmentCountPerCellByType: function(isAllDay) {\r\n        return this.getRenderingStrategyInstance()._getMaxAppointmentCountPerCellByType(isAllDay)\r\n    },\r\n    needCorrectAppointmentDates: function() {\r\n        return this.getRenderingStrategyInstance().needCorrectAppointmentDates()\r\n    },\r\n    getRenderingStrategyDirection: function() {\r\n        return this.getRenderingStrategyInstance().getDirection()\r\n    },\r\n    getWorkSpaceDateTableOffset: function() {\r\n        return this.getWorkSpaceDateTableOffset()\r\n    },\r\n    getFullWeekAppointmentWidth: function(options) {\r\n        var groupIndex = options.groupIndex;\r\n        return this._workSpace.getGroupWidth(groupIndex)\r\n    },\r\n    getMaxAppointmentWidth: function(options) {\r\n        var workSpace = this._workSpace;\r\n        return workSpace.getCellCountToLastViewDate(options.date) * workSpace.getCellWidth()\r\n    },\r\n    updateAppointmentStartDate: function(options) {\r\n        var appointment = options.appointment;\r\n        var firstViewDate = this._workSpace.getStartViewDate();\r\n        var startDate = new Date(options.startDate);\r\n        var startDayHour = this._getCurrentViewOption(\"startDayHour\");\r\n        var updatedStartDate;\r\n        if (this.appointmentTakesAllDay(appointment)) {\r\n            updatedStartDate = _date2.default.normalizeDate(startDate, firstViewDate)\r\n        } else {\r\n            if (startDate < firstViewDate) {\r\n                startDate = firstViewDate\r\n            }\r\n            updatedStartDate = _date2.default.normalizeDate(options.startDate, new Date(startDate))\r\n        }\r\n        return _date2.default.roundDateByStartDayHour(updatedStartDate, startDayHour)\r\n    },\r\n    updateAppointmentEndDate: function(options) {\r\n        var endDate = options.endDate;\r\n        var endDayHour = this._getCurrentViewOption(\"endDayHour\");\r\n        var startDayHour = this._getCurrentViewOption(\"startDayHour\");\r\n        var updatedEndDate = endDate;\r\n        if (endDate.getHours() >= endDayHour) {\r\n            updatedEndDate.setHours(endDayHour, 0, 0, 0)\r\n        } else {\r\n            if (!options.isSameDate && startDayHour > 0 && 60 * endDate.getHours() + endDate.getMinutes() < 60 * startDayHour) {\r\n                updatedEndDate = new Date(updatedEndDate.getTime() - toMs(\"day\"));\r\n                updatedEndDate.setHours(endDayHour, 0, 0, 0)\r\n            }\r\n        }\r\n        return updatedEndDate\r\n    },\r\n    renderCompactAppointments: function(options) {\r\n        this._compactAppointmentsHelper.render(options)\r\n    },\r\n    clearCompactAppointments: function() {\r\n        this._compactAppointmentsHelper.clear()\r\n    },\r\n    supportCompactDropDownAppointments: function() {\r\n        return this._workSpace._supportCompactDropDownAppointments()\r\n    },\r\n    isApplyCompactAppointmentOffset: function() {\r\n        return this._workSpace._isApplyCompactAppointmentOffset()\r\n    },\r\n    getGroupCount: function() {\r\n        return this._workSpace._getGroupCount()\r\n    },\r\n    mapAppointmentFields: function(config) {\r\n        return {\r\n            appointmentData: config.itemData,\r\n            appointmentElement: config.itemElement,\r\n            targetedAppointmentData: this.fire(\"getTargetedAppointmentData\", config.itemData, config.itemElement)\r\n        }\r\n    },\r\n    getOffsetByAllDayPanel: function(groupIndex) {\r\n        return this._workSpace._getOffsetByAllDayPanel(groupIndex)\r\n    },\r\n    getGroupTop: function(groupIndex) {\r\n        return this._workSpace._getGroupTop(groupIndex)\r\n    },\r\n    updateResizableArea: function() {\r\n        var $allResizableElements = this.$element().find(\".dx-scheduler-appointment.dx-resizable\");\r\n        var horizontalResizables = (0, _common.grep)($allResizableElements, function(el) {\r\n            var $el = (0, _renderer2.default)(el);\r\n            var resizableInst = $el.dxResizable(\"instance\");\r\n            var area = resizableInst.option(\"area\");\r\n            return (0, _array.inArray)(resizableInst.option(\"handles\"), [\"right left\", \"left right\"]) > -1 && _type2.default.isPlainObject(area)\r\n        });\r\n        (0, _iterator.each)(horizontalResizables, function(_, el) {\r\n            var $el = (0, _renderer2.default)(el);\r\n            var position = _translator2.default.locate($el);\r\n            var appointmentData = this._appointments._getItemData($el);\r\n            var area = this._appointments._calculateResizableArea({\r\n                left: position.left\r\n            }, appointmentData);\r\n            $el.dxResizable(\"instance\").option(\"area\", area)\r\n        }.bind(this))\r\n    },\r\n    recurrenceEditorVisibilityChanged: function(visible) {\r\n        this.recurrenceEditorVisibilityChanged(visible)\r\n    },\r\n    resizePopup: function() {\r\n        this.resizePopup()\r\n    },\r\n    getField: function(field, obj) {\r\n        if (!_type2.default.isDefined(this._dataAccessors.getter[field])) {\r\n            return\r\n        }\r\n        return this._dataAccessors.getter[field](obj)\r\n    },\r\n    setField: function(field, obj, value) {\r\n        if (!_type2.default.isDefined(this._dataAccessors.setter[field])) {\r\n            return\r\n        }\r\n        var splitExprStr = this.option(field + \"Expr\").split(\".\");\r\n        var rootField = splitExprStr[0];\r\n        if (void 0 === obj[rootField] && splitExprStr.length > 1) {\r\n            var emptyChain = function(arr) {\r\n                var result = {};\r\n                var tmp = result;\r\n                var arrLength = arr.length - 1;\r\n                for (var i = 1; i < arrLength; i++) {\r\n                    tmp = tmp[arr[i]] = {}\r\n                }\r\n                return result\r\n            }(splitExprStr);\r\n            obj[rootField] = emptyChain\r\n        }\r\n        this._dataAccessors.setter[field](obj, value);\r\n        return obj\r\n    },\r\n    prerenderFilter: function() {\r\n        var dateRange = this.getWorkSpace().getDateRange();\r\n        var resources = this._resourcesManager.getResourcesData();\r\n        var allDay;\r\n        if (!this.option(\"showAllDayPanel\") && this._workSpace.supportAllDayRow()) {\r\n            allDay = false\r\n        }\r\n        return this._appointmentModel.filterLoadedAppointments({\r\n            startDayHour: this._getCurrentViewOption(\"startDayHour\"),\r\n            endDayHour: this._getCurrentViewOption(\"endDayHour\"),\r\n            min: dateRange[0],\r\n            max: dateRange[1],\r\n            resources: resources,\r\n            allDay: allDay,\r\n            firstDayOfWeek: this.getFirstDayOfWeek(),\r\n            recurrenceException: this._getRecurrenceException.bind(this)\r\n        }, this._subscribes.convertDateByTimezone.bind(this))\r\n    },\r\n    dayHasAppointment: function(day, appointment, trimTime) {\r\n        return this.dayHasAppointment(day, appointment, trimTime)\r\n    },\r\n    createResourcesTree: function() {\r\n        return this._resourcesManager.createResourcesTree(this._loadedResources)\r\n    },\r\n    getResourceTreeLeaves: function(tree, appointmentResources) {\r\n        return this._resourcesManager.getResourceTreeLeaves(tree, appointmentResources)\r\n    },\r\n    createReducedResourcesTree: function() {\r\n        var tree = this._resourcesManager.createResourcesTree(this._loadedResources);\r\n        return this._resourcesManager.reduceResourcesTree(tree, this.getFilteredItems())\r\n    },\r\n    groupAppointmentsByResources: function(appointments) {\r\n        var result = {\r\n            0: appointments\r\n        };\r\n        var groups = this._getCurrentViewOption(\"groups\");\r\n        if (groups && groups.length && this._resourcesManager.getResourcesData().length) {\r\n            result = this._resourcesManager.groupAppointmentsByResources(appointments, this._loadedResources)\r\n        }\r\n        var totalResourceCount = 0;\r\n        (0, _iterator.each)(this._loadedResources, function(i, resource) {\r\n            if (!i) {\r\n                totalResourceCount = resource.items.length\r\n            } else {\r\n                totalResourceCount *= resource.items.length\r\n            }\r\n        });\r\n        for (var j = 0; j < totalResourceCount; j++) {\r\n            var index = j.toString();\r\n            if (result[index]) {\r\n                continue\r\n            }\r\n            result[index] = []\r\n        }\r\n        return result\r\n    },\r\n    getAgendaRows: function(options) {\r\n        var renderingStrategy = this._layoutManager.getRenderingStrategyInstance();\r\n        var calculateRows = renderingStrategy.calculateRows.bind(renderingStrategy);\r\n        var d = new _deferred.Deferred;\r\n\r\n        function rowsCalculated(appointments) {\r\n            var result = calculateRows(appointments, options.agendaDuration, options.currentDate);\r\n            this._dataSourceLoadedCallback.remove(rowsCalculated);\r\n            d.resolve(result)\r\n        }\r\n        this._dataSourceLoadedCallback.add(rowsCalculated);\r\n        return d.promise()\r\n    },\r\n    getAgendaVerticalStepHeight: function() {\r\n        return this.getWorkSpace().getAgendaVerticalStepHeight()\r\n    },\r\n    getAgendaDuration: function() {\r\n        return this._getCurrentViewOption(\"agendaDuration\")\r\n    },\r\n    getStartViewDate: function() {\r\n        return this.getStartViewDate()\r\n    },\r\n    getEndViewDate: function() {\r\n        return this.getEndViewDate()\r\n    },\r\n    getMaxAppointmentsPerCell: function() {\r\n        return this.getMaxAppointmentsPerCell()\r\n    },\r\n    forceMaxAppointmentPerCell: function() {\r\n        return this.forceMaxAppointmentPerCell()\r\n    },\r\n    agendaIsReady: function(rows, innerRowOffset, outerRowOffset) {\r\n        var $appts = this.getAppointmentsInstance()._itemElements();\r\n        var total = 0;\r\n        $appts.css(\"marginBottom\", innerRowOffset);\r\n        var applyOffset = function(_, count) {\r\n            var index = count + total - 1;\r\n            $appts.eq(index).css(\"marginBottom\", outerRowOffset);\r\n            total += count\r\n        };\r\n        for (var i = 0; i < rows.length; i++) {\r\n            (0, _iterator.each)(rows[i], applyOffset)\r\n        }\r\n    },\r\n    getTimezone: function() {\r\n        return this._getTimezoneOffsetByOption()\r\n    },\r\n    getClientTimezoneOffset: function(date) {\r\n        date = date || new Date;\r\n        return _uiScheduler2.default.getClientTimezoneOffset(date)\r\n    },\r\n    convertDateByTimezone: function(date, appointmentTimezone) {\r\n        date = new Date(date);\r\n        var tzOffsets = this._subscribes.getComplexOffsets(this, date, appointmentTimezone);\r\n        date = this._subscribes.translateDateToAppointmentTimeZone(date, tzOffsets);\r\n        date = this._subscribes.translateDateToCommonTimeZone(date, tzOffsets);\r\n        return date\r\n    },\r\n    convertDateByTimezoneBack: function(date, appointmentTimezone) {\r\n        date = new Date(date);\r\n        var tzOffsets = this._subscribes.getComplexOffsets(this, date, appointmentTimezone);\r\n        date = this._subscribes.translateDateToAppointmentTimeZone(date, tzOffsets, true);\r\n        date = this._subscribes.translateDateToCommonTimeZone(date, tzOffsets, true);\r\n        return date\r\n    },\r\n    translateDateToAppointmentTimeZone: function(date, offsets, back) {\r\n        var operation = back ? -1 : 1;\r\n        var dateInUTC = date.getTime() - operation * offsets.client * toMs(\"hour\");\r\n        return new Date(dateInUTC + operation * offsets.appointment * toMs(\"hour\"))\r\n    },\r\n    translateDateToCommonTimeZone: function(date, offsets, back) {\r\n        var operation = back ? -1 : 1;\r\n        if (\"number\" === typeof offsets.common) {\r\n            var offset = offsets.common - offsets.appointment;\r\n            var hoursOffset = (offset < 0 ? -1 : 1) * Math.floor(Math.abs(offset));\r\n            var minutesOffset = offset % 1;\r\n            date.setHours(date.getHours() + operation * hoursOffset);\r\n            date.setMinutes(date.getMinutes() + operation * minutesOffset * MINUTES_IN_HOUR)\r\n        }\r\n        return date\r\n    },\r\n    getComplexOffsets: function(scheduler, date, appointmentTimezone) {\r\n        var clientTimezoneOffset = -this.getClientTimezoneOffset(date) / toMs(\"hour\");\r\n        var commonTimezoneOffset = scheduler._getTimezoneOffsetByOption(date);\r\n        var appointmentTimezoneOffset = scheduler._calculateTimezoneByValue(appointmentTimezone, date);\r\n        if (\"number\" !== typeof appointmentTimezoneOffset) {\r\n            appointmentTimezoneOffset = clientTimezoneOffset\r\n        }\r\n        return {\r\n            client: clientTimezoneOffset,\r\n            common: commonTimezoneOffset,\r\n            appointment: appointmentTimezoneOffset\r\n        }\r\n    },\r\n    getDaylightOffset: function(startDate, endDate) {\r\n        return startDate.getTimezoneOffset() - endDate.getTimezoneOffset()\r\n    },\r\n    getTimezonesDisplayName: function() {\r\n        return _uiScheduler2.default.getTimezonesDisplayName()\r\n    },\r\n    getTimezoneDisplayNameById: function(id) {\r\n        return _uiScheduler2.default.getTimezoneDisplayNameById(id)\r\n    },\r\n    getSimilarTimezones: function(id) {\r\n        return _uiScheduler2.default.getSimilarTimezones(id)\r\n    },\r\n    getTimezonesIdsByDisplayName: function(displayName) {\r\n        return _uiScheduler2.default.getTimezonesIdsByDisplayName(displayName)\r\n    },\r\n    getTargetedAppointmentData: function(appointmentData, appointmentElement, skipTimezoneConvert) {\r\n        var $appointmentElement = (0, _renderer2.default)(appointmentElement);\r\n        var appointmentIndex = $appointmentElement.data(this._appointments._itemIndexKey());\r\n        var recurringData = this._getSingleAppointmentData(appointmentData, {\r\n            skipDateCalculation: true,\r\n            $appointment: $appointmentElement,\r\n            skipHoursProcessing: true\r\n        });\r\n        var result = {};\r\n        (0, _extend.extend)(true, result, appointmentData, recurringData);\r\n        if (this._isAppointmentRecurrence(appointmentData) && !skipTimezoneConvert) {\r\n            this._convertDatesByTimezoneBack(false, result)\r\n        }\r\n        appointmentElement && this.setTargetedAppointmentResources(result, appointmentElement, appointmentIndex);\r\n        return result\r\n    },\r\n    getAppointmentDurationInMs: function(options) {\r\n        var startDate = options.startDate;\r\n        var endDate = options.endDate;\r\n        var allDay = options.allDay;\r\n        var appointmentDuration = endDate.getTime() - startDate.getTime();\r\n        var dayDuration = toMs(\"day\");\r\n        var visibleDayDuration = this._workSpace.getVisibleDayDuration();\r\n        var result = 0;\r\n        if (allDay) {\r\n            var ceilQuantityOfDays = Math.ceil(appointmentDuration / dayDuration);\r\n            result = ceilQuantityOfDays * visibleDayDuration\r\n        } else {\r\n            var isDifferentDate = !_date2.default.sameDate(startDate, new Date(endDate.getTime() - 1));\r\n            var floorQuantityOfDays = Math.floor(appointmentDuration / dayDuration);\r\n            var tailDuration;\r\n            if (isDifferentDate) {\r\n                var startDateEndHour = new Date(new Date(startDate).setHours(this.option(\"endDayHour\"), 0, 0));\r\n                var hiddenDayDuration = dayDuration - visibleDayDuration - (startDate.getTime() > startDateEndHour.getTime() ? startDate.getTime() - startDateEndHour.getTime() : 0);\r\n                tailDuration = appointmentDuration - (floorQuantityOfDays ? floorQuantityOfDays * dayDuration : hiddenDayDuration);\r\n                var startDayTime = this.option(\"startDayHour\") * toMs(\"hour\");\r\n                var endPartDuration = endDate - _date2.default.trimTime(endDate);\r\n                if (endPartDuration < startDayTime) {\r\n                    if (floorQuantityOfDays) {\r\n                        tailDuration -= hiddenDayDuration\r\n                    }\r\n                    tailDuration += startDayTime - endPartDuration\r\n                }\r\n            } else {\r\n                tailDuration = appointmentDuration % dayDuration\r\n            }\r\n            if (tailDuration > visibleDayDuration) {\r\n                tailDuration = visibleDayDuration\r\n            }\r\n            result = floorQuantityOfDays * visibleDayDuration + tailDuration || toMs(\"minute\")\r\n        }\r\n        return result\r\n    },\r\n    fixWrongEndDate: function(appointment, startDate, endDate) {\r\n        return this._appointmentModel.fixWrongEndDate(appointment, startDate, endDate)\r\n    },\r\n    getEndDayHour: function() {\r\n        return this._workSpace.option(\"endDayHour\") || this.option(\"endDayHour\")\r\n    },\r\n    getStartDayHour: function() {\r\n        return this._workSpace.option(\"startDayHour\") || this.option(\"startDayHour\")\r\n    },\r\n    isAdaptive: function() {\r\n        return this.option(\"adaptivityEnabled\")\r\n    },\r\n    moveBack: function() {\r\n        var dragBehavior = this.getWorkSpace().dragBehavior;\r\n        dragBehavior && dragBehavior.moveBack()\r\n    }\r\n};\r\nmodule.exports = subscribes;\r\n"]},"metadata":{},"sourceType":"module"}