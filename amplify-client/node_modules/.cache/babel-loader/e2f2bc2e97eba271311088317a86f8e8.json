{"ast":null,"code":"/**\r\n * DevExtreme (exporter/excel_creator.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar _class = require(\"../core/class\");\n\nvar _class2 = _interopRequireDefault(_class);\n\nvar _window = require(\"../core/utils/window\");\n\nvar _type = require(\"../core/utils/type\");\n\nvar _extend = require(\"../core/utils/extend\");\n\nvar _ui = require(\"../ui/widget/ui.errors\");\n\nvar _ui2 = _interopRequireDefault(_ui);\n\nvar _string = require(\"../core/utils/string\");\n\nvar _string2 = _interopRequireDefault(_string);\n\nvar _jszip = require(\"jszip\");\n\nvar _jszip2 = _interopRequireDefault(_jszip);\n\nvar _file_saver = require(\"./file_saver\");\n\nvar _file_saver2 = _interopRequireDefault(_file_saver);\n\nvar _excel_format_converter = require(\"./excel_format_converter\");\n\nvar _excel_format_converter2 = _interopRequireDefault(_excel_format_converter);\n\nvar _excel = require(\"./excel/excel.file\");\n\nvar _excel2 = _interopRequireDefault(_excel);\n\nvar _deferred = require(\"../core/utils/deferred\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nfunction _typeof(obj) {\n  if (\"function\" === typeof Symbol && \"symbol\" === typeof Symbol.iterator) {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && \"function\" === typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nvar XML_TAG = '<?xml version=\"1.0\" encoding=\"utf-8\"?>';\nvar GROUP_SHEET_PR_XML = '<sheetPr><outlinePr summaryBelow=\"0\"/></sheetPr>';\nvar SINGLE_SHEET_PR_XML = \"<sheetPr/>\";\nvar BASE_STYLE_XML2 = '<borders count=\"1\"><border><left style=\"thin\"><color rgb=\"FFD3D3D3\"/></left><right style=\"thin\"><color rgb=\"FFD3D3D3\"/></right><top style=\"thin\"><color rgb=\"FFD3D3D3\"/></top><bottom style=\"thin\"><color rgb=\"FFD3D3D3\"/></bottom></border></borders><cellStyleXfs count=\"1\"><xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\"/></cellStyleXfs>';\nvar OPEN_XML_FORMAT_URL = \"http://schemas.openxmlformats.org\";\nvar RELATIONSHIP_PART_NAME = \"rels\";\nvar XL_FOLDER_NAME = \"xl\";\nvar WORKBOOK_FILE_NAME = \"workbook.xml\";\nvar CONTENTTYPES_FILE_NAME = \"[Content_Types].xml\";\nvar SHAREDSTRING_FILE_NAME = \"sharedStrings.xml\";\nvar STYLE_FILE_NAME = \"styles.xml\";\nvar WORKSHEETS_FOLDER = \"worksheets\";\nvar WORKSHEET_FILE_NAME = \"sheet1.xml\";\nvar WORKSHEET_HEADER_XML = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><worksheet xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" mc:Ignorable=\"x14ac\" xmlns:x14ac=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac\">';\nvar VALID_TYPES = {\n  \"boolean\": \"b\",\n  date: \"d\",\n  number: \"n\",\n  string: \"s\"\n};\nvar EXCEL_START_TIME = Date.UTC(1899, 11, 30);\nvar DAYS_COUNT_BEFORE_29_FEB_1900 = 60;\nvar MAX_DIGIT_WIDTH_IN_PIXELS = 7;\nvar UNSUPPORTED_FORMAT_MAPPING = {\n  quarter: \"shortDate\",\n  quarterAndYear: \"shortDate\",\n  minute: \"longTime\",\n  millisecond: \"longTime\"\n};\n\nvar ExcelCreator = _class2.default.inherit({\n  _getXMLTag: function _getXMLTag(tagName, attributes, content) {\n    var result = \"<\" + tagName;\n    var i;\n    var length = attributes.length;\n    var attr;\n\n    for (i = 0; i < length; i++) {\n      attr = attributes[i];\n\n      if (void 0 !== attr.value) {\n        result = result + \" \" + attr.name + '=\"' + attr.value + '\"';\n      }\n    }\n\n    return (0, _type.isDefined)(content) ? result + \">\" + content + \"</\" + tagName + \">\" : result + \" />\";\n  },\n  _convertToExcelCellRef: function _convertToExcelCellRef(zeroBasedRowIndex, zeroBasedCellIndex) {\n    var columnName = \"\";\n    var max = 26;\n    var charCode;\n    var isCellIndexFound;\n\n    while (!isCellIndexFound) {\n      charCode = 65 + (zeroBasedCellIndex >= max ? zeroBasedCellIndex % max : Math.ceil(zeroBasedCellIndex));\n      columnName = String.fromCharCode(charCode) + columnName;\n\n      if (zeroBasedCellIndex >= max) {\n        zeroBasedCellIndex = Math.floor(zeroBasedCellIndex / max) - 1;\n      } else {\n        isCellIndexFound = true;\n      }\n    }\n\n    return columnName + (zeroBasedRowIndex + 1);\n  },\n  _convertToExcelCellRefAndTrackMaxIndex: function _convertToExcelCellRefAndTrackMaxIndex(rowIndex, cellIndex) {\n    if (this._maxRowIndex < Number(rowIndex)) {\n      this._maxRowIndex = Number(rowIndex);\n    }\n\n    if (this._maxColumnIndex < Number(cellIndex)) {\n      this._maxColumnIndex = Number(cellIndex);\n    }\n\n    return this._convertToExcelCellRef(rowIndex, cellIndex);\n  },\n  _getDataType: function _getDataType(dataType) {\n    return VALID_TYPES[dataType] || VALID_TYPES.string;\n  },\n  _tryGetExcelCellDataType: function _tryGetExcelCellDataType(object) {\n    if ((0, _type.isDefined)(object)) {\n      if (\"number\" === typeof object) {\n        if (isFinite(object)) {\n          return VALID_TYPES.number;\n        } else {\n          return VALID_TYPES.string;\n        }\n      } else {\n        if ((0, _type.isString)(object)) {\n          return VALID_TYPES.string;\n        } else {\n          if ((0, _type.isDate)(object)) {\n            return VALID_TYPES.number;\n          } else {\n            if ((0, _type.isBoolean)(object)) {\n              return VALID_TYPES.boolean;\n            }\n          }\n        }\n      }\n    }\n  },\n  _formatObjectConverter: function _formatObjectConverter(format, dataType) {\n    var result = {\n      format: format,\n      precision: format && format.precision,\n      dataType: dataType\n    };\n\n    if ((0, _type.isObject)(format)) {\n      return (0, _extend.extend)(result, format, {\n        format: format.formatter || format.type,\n        currency: format.currency\n      });\n    }\n\n    return result;\n  },\n  _tryConvertToExcelNumberFormat: function _tryConvertToExcelNumberFormat(format, dataType) {\n    var currency;\n\n    var newFormat = this._formatObjectConverter(format, dataType);\n\n    format = newFormat.format;\n    currency = newFormat.currency;\n    dataType = newFormat.dataType;\n\n    if ((0, _type.isDefined)(format) && \"date\" === dataType) {\n      format = UNSUPPORTED_FORMAT_MAPPING[format && format.type || format] || format;\n    }\n\n    return _excel_format_converter2.default.convertFormat(format, newFormat.precision, dataType, currency);\n  },\n  _appendString: function _appendString(value) {\n    if ((0, _type.isDefined)(value)) {\n      value = String(value);\n\n      if (value.length) {\n        value = _string2.default.encodeHtml(value);\n\n        if (void 0 === this._stringHash[value]) {\n          this._stringHash[value] = this._stringArray.length;\n\n          this._stringArray.push(value);\n        }\n\n        return this._stringHash[value];\n      }\n    }\n  },\n  _tryGetExcelDateValue: function _tryGetExcelDateValue(date) {\n    var days;\n    var totalTime;\n\n    if ((0, _type.isDate)(date)) {\n      days = Math.floor((Date.UTC(date.getFullYear(), date.getMonth(), date.getDate()) - EXCEL_START_TIME) / 864e5);\n\n      if (days < DAYS_COUNT_BEFORE_29_FEB_1900) {\n        days--;\n      }\n\n      totalTime = (3600 * date.getHours() + 60 * date.getMinutes() + date.getSeconds()) / 86400;\n      return days + totalTime;\n    }\n  },\n  _prepareValue: function _prepareValue(rowIndex, cellIndex) {\n    var dataProvider = this._dataProvider;\n\n    var _ref = dataProvider.getCellData(rowIndex, cellIndex) || {},\n        value = _ref.value,\n        cellSourceData = _ref.cellSourceData;\n\n    var sourceValue;\n\n    var type = this._getDataType(dataProvider.getCellType(rowIndex, cellIndex));\n\n    if (type === VALID_TYPES.date && !(0, _type.isDate)(value)) {\n      type = VALID_TYPES.string;\n    }\n\n    switch (type) {\n      case VALID_TYPES.string:\n        sourceValue = value;\n        value = this._appendString(value);\n        break;\n\n      case VALID_TYPES.date:\n        sourceValue = value;\n        value = this._tryGetExcelDateValue(value);\n        type = VALID_TYPES.number;\n    }\n\n    return {\n      value: value,\n      type: type,\n      sourceValue: sourceValue,\n      cellSourceData: cellSourceData\n    };\n  },\n  _callCustomizeExcelCell: function _callCustomizeExcelCell(_ref2) {\n    var dataProvider = _ref2.dataProvider,\n        value = _ref2.value,\n        style = _ref2.style,\n        sourceData = _ref2.sourceData;\n\n    var styleCopy = _excel2.default.copyCellFormat(style);\n\n    var args = {\n      value: value,\n      numberFormat: styleCopy.numberFormat,\n      clearStyle: function clearStyle() {\n        this.horizontalAlignment = null;\n        this.verticalAlignment = null;\n        this.wrapTextEnabled = null;\n        this.font = null;\n        this.numberFormat = null;\n      }\n    };\n\n    if ((0, _type.isDefined)(styleCopy)) {\n      if ((0, _type.isDefined)(styleCopy.alignment)) {\n        args.horizontalAlignment = styleCopy.alignment.horizontal;\n        args.verticalAlignment = styleCopy.alignment.vertical;\n        args.wrapTextEnabled = styleCopy.alignment.wrapText;\n      }\n\n      args.backgroundColor = styleCopy.backgroundColor;\n      args.fillPatternType = styleCopy.fillPatternType;\n      args.fillPatternColor = styleCopy.fillPatternColor;\n      args.font = styleCopy.font;\n    }\n\n    dataProvider.customizeExcelCell(args, sourceData);\n    var newStyle = styleCopy || {};\n    newStyle.font = args.font;\n    newStyle.alignment = newStyle.alignment || {};\n    newStyle.alignment.horizontal = args.horizontalAlignment;\n    newStyle.alignment.vertical = args.verticalAlignment;\n    newStyle.alignment.wrapText = args.wrapTextEnabled;\n    newStyle.backgroundColor = args.backgroundColor;\n    newStyle.fillPatternType = args.fillPatternType;\n    newStyle.fillPatternColor = args.fillPatternColor;\n    newStyle.numberFormat = args.numberFormat;\n    return {\n      value: args.value,\n      style: newStyle\n    };\n  },\n  _getDataArray: function _getDataArray() {\n    var that = this;\n    var rowIndex;\n    var cellIndex;\n    var cellsArray;\n    var cellData;\n    var result = [];\n    var dataProvider = that._dataProvider;\n    var rowsLength = dataProvider.getRowsCount();\n    var columns = dataProvider.getColumns();\n    var cellsLength;\n\n    for (rowIndex = 0; rowIndex < rowsLength; rowIndex++) {\n      cellsArray = [];\n      cellsLength = columns.length;\n\n      for (cellIndex = 0; cellIndex !== cellsLength; cellIndex++) {\n        cellData = that._prepareValue(rowIndex, cellIndex);\n        var styleArrayIndex = dataProvider.getStyleId(rowIndex, cellIndex);\n        var cellStyleId = this._styleArrayIndexToCellStyleIdMap[styleArrayIndex];\n\n        if (dataProvider.hasCustomizeExcelCell && dataProvider.hasCustomizeExcelCell()) {\n          var value = cellData.sourceValue || cellData.value;\n\n          var modifiedExcelCell = this._callCustomizeExcelCell({\n            dataProvider: dataProvider,\n            value: value,\n            style: that._styleArray[styleArrayIndex],\n            sourceData: cellData.cellSourceData\n          });\n\n          if (modifiedExcelCell.value !== value) {\n            if (_typeof(modifiedExcelCell.value) !== _typeof(value) || \"number\" === typeof modifiedExcelCell.value && !isFinite(modifiedExcelCell.value)) {\n              var cellDataType = this._tryGetExcelCellDataType(modifiedExcelCell.value);\n\n              if ((0, _type.isDefined)(cellDataType)) {\n                cellData.type = cellDataType;\n              }\n            }\n\n            switch (cellData.type) {\n              case VALID_TYPES.string:\n                cellData.value = this._appendString(modifiedExcelCell.value);\n                break;\n\n              case VALID_TYPES.date:\n                cellData.value = modifiedExcelCell.value;\n                break;\n\n              case VALID_TYPES.number:\n                var newValue = modifiedExcelCell.value;\n\n                var excelDateValue = this._tryGetExcelDateValue(newValue);\n\n                if ((0, _type.isDefined)(excelDateValue)) {\n                  newValue = excelDateValue;\n                }\n\n                cellData.value = newValue;\n                break;\n\n              default:\n                cellData.value = modifiedExcelCell.value;\n            }\n          }\n\n          cellStyleId = this._excelFile.registerCellFormat(modifiedExcelCell.style);\n        }\n\n        cellsArray.push({\n          style: cellStyleId,\n          value: cellData.value,\n          type: cellData.type\n        });\n      }\n\n      if (!that._needSheetPr && dataProvider.getGroupLevel(rowIndex) > 0) {\n        that._needSheetPr = true;\n      }\n\n      result.push(cellsArray);\n    }\n\n    return result;\n  },\n  _calculateWidth: function _calculateWidth(pixelsWidth) {\n    pixelsWidth = parseInt(pixelsWidth, 10);\n\n    if (!pixelsWidth || pixelsWidth < 5) {\n      pixelsWidth = 100;\n    }\n\n    return Math.min(255, Math.floor((pixelsWidth - 5) / MAX_DIGIT_WIDTH_IN_PIXELS * 100 + .5) / 100);\n  },\n  _prepareStyleData: function _prepareStyleData() {\n    var _this = this;\n\n    var that = this;\n\n    var styles = that._dataProvider.getStyles();\n\n    that._dataProvider.getColumns().forEach(function (column) {\n      that._colsArray.push(that._calculateWidth(column.width));\n    });\n\n    var fonts = [{\n      size: 11,\n      color: {\n        theme: 1\n      },\n      name: \"Calibri\",\n      family: 2,\n      scheme: \"minor\",\n      bold: false\n    }, {\n      size: 11,\n      color: {\n        theme: 1\n      },\n      name: \"Calibri\",\n      family: 2,\n      scheme: \"minor\",\n      bold: true\n    }];\n\n    this._excelFile.registerFont(fonts[0]);\n\n    this._excelFile.registerFont(fonts[1]);\n\n    styles.forEach(function (style) {\n      var numberFormat = that._tryConvertToExcelNumberFormat(style.format, style.dataType);\n\n      if (!(0, _type.isDefined)(numberFormat)) {\n        numberFormat = 0;\n      }\n\n      that._styleArray.push({\n        font: fonts[Number(!!style.bold)],\n        numberFormat: numberFormat,\n        alignment: {\n          vertical: \"top\",\n          wrapText: !!style.wrapText,\n          horizontal: style.alignment || \"left\"\n        }\n      });\n    });\n    that._styleArrayIndexToCellStyleIdMap = that._styleArray.map(function (item) {\n      return _this._excelFile.registerCellFormat(item);\n    });\n  },\n  _prepareCellData: function _prepareCellData() {\n    this._cellsArray = this._getDataArray();\n  },\n  _createXMLRelationships: function _createXMLRelationships(xmlRelationships) {\n    return this._getXMLTag(\"Relationships\", [{\n      name: \"xmlns\",\n      value: OPEN_XML_FORMAT_URL + \"/package/2006/relationships\"\n    }], xmlRelationships);\n  },\n  _createXMLRelationship: function _createXMLRelationship(id, type, target) {\n    return this._getXMLTag(\"Relationship\", [{\n      name: \"Id\",\n      value: \"rId\" + id\n    }, {\n      name: \"Type\",\n      value: OPEN_XML_FORMAT_URL + \"/officeDocument/2006/relationships/\" + type\n    }, {\n      name: \"Target\",\n      value: target\n    }]);\n  },\n  _getWorkbookContent: function _getWorkbookContent() {\n    var content = '<bookViews><workbookView xWindow=\"0\" yWindow=\"0\" windowWidth=\"0\" windowHeight=\"0\"/></bookViews><sheets><sheet name=\"Sheet\" sheetId=\"1\" r:id=\"rId1\" /></sheets><definedNames><definedName name=\"_xlnm.Print_Titles\" localSheetId=\"0\">Sheet!$1:$1</definedName><definedName name=\"_xlnm._FilterDatabase\" hidden=\"0\" localSheetId=\"0\">Sheet!$A$1:$F$6332</definedName></definedNames>';\n    return XML_TAG + this._getXMLTag(\"workbook\", [{\n      name: \"xmlns:r\",\n      value: OPEN_XML_FORMAT_URL + \"/officeDocument/2006/relationships\"\n    }, {\n      name: \"xmlns\",\n      value: OPEN_XML_FORMAT_URL + \"/spreadsheetml/2006/main\"\n    }], content);\n  },\n  _getContentTypesContent: function _getContentTypesContent() {\n    return XML_TAG + '<Types xmlns=\"' + OPEN_XML_FORMAT_URL + '/package/2006/content-types\"><Default Extension=\"rels\" ContentType=\"application/vnd.openxmlformats-package.relationships+xml\" /><Default Extension=\"xml\" ContentType=\"application/xml\" /><Override PartName=\"/xl/worksheets/sheet1.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml\" /><Override PartName=\"/xl/styles.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml\" /><Override PartName=\"/xl/sharedStrings.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml\" /><Override PartName=\"/xl/workbook.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml\" /></Types>';\n  },\n  _generateStylesXML: function _generateStylesXML() {\n    var that = this;\n\n    var folder = that._zip.folder(XL_FOLDER_NAME);\n\n    var XML = \"\";\n    XML += this._excelFile.generateNumberFormatsXml();\n    XML += this._excelFile.generateFontsXml();\n    XML += this._excelFile.generateFillsXml();\n    XML += BASE_STYLE_XML2;\n    XML += this._excelFile.generateCellFormatsXml();\n    XML += that._getXMLTag(\"cellStyles\", [{\n      name: \"count\",\n      value: 1\n    }], that._getXMLTag(\"cellStyle\", [{\n      name: \"name\",\n      value: \"Normal\"\n    }, {\n      name: \"xfId\",\n      value: 0\n    }, {\n      name: \"builtinId\",\n      value: 0\n    }]));\n    XML = XML_TAG + that._getXMLTag(\"styleSheet\", [{\n      name: \"xmlns\",\n      value: OPEN_XML_FORMAT_URL + \"/spreadsheetml/2006/main\"\n    }], XML);\n    folder.file(STYLE_FILE_NAME, XML);\n    that._styleArray = [];\n  },\n  _generateStringsXML: function _generateStringsXML() {\n    var folder = this._zip.folder(XL_FOLDER_NAME);\n\n    var stringIndex;\n    var stringsLength = this._stringArray.length;\n    var sharedStringXml = XML_TAG;\n\n    for (stringIndex = 0; stringIndex < stringsLength; stringIndex++) {\n      this._stringArray[stringIndex] = this._getXMLTag(\"si\", [], this._getXMLTag(\"t\", [], this._stringArray[stringIndex]));\n    }\n\n    sharedStringXml += this._getXMLTag(\"sst\", [{\n      name: \"xmlns\",\n      value: OPEN_XML_FORMAT_URL + \"/spreadsheetml/2006/main\"\n    }, {\n      name: \"count\",\n      value: this._stringArray.length\n    }, {\n      name: \"uniqueCount\",\n      value: this._stringArray.length\n    }], this._stringArray.join(\"\"));\n    folder.file(SHAREDSTRING_FILE_NAME, sharedStringXml);\n    this._stringArray = [];\n  },\n  _getPaneXML: function _getPaneXML() {\n    var attributes = [{\n      name: \"activePane\",\n      value: \"bottomLeft\"\n    }, {\n      name: \"state\",\n      value: \"frozen\"\n    }];\n\n    var frozenArea = this._dataProvider.getFrozenArea();\n\n    if (!(frozenArea.x || frozenArea.y)) {\n      return \"\";\n    }\n\n    if (frozenArea.x) {\n      attributes.push({\n        name: \"xSplit\",\n        value: frozenArea.x\n      });\n    }\n\n    if (frozenArea.y) {\n      attributes.push({\n        name: \"ySplit\",\n        value: frozenArea.y\n      });\n    }\n\n    attributes.push({\n      name: \"topLeftCell\",\n      value: this._convertToExcelCellRefAndTrackMaxIndex(frozenArea.y, frozenArea.x)\n    });\n    return this._getXMLTag(\"pane\", attributes);\n  },\n  _getAutoFilterXML: function _getAutoFilterXML(maxCellIndex) {\n    if (this._options.autoFilterEnabled) {\n      return '<autoFilter ref=\"A' + this._dataProvider.getHeaderRowCount() + \":\" + maxCellIndex + '\" />';\n    }\n\n    return \"\";\n  },\n  _getIgnoredErrorsXML: function _getIgnoredErrorsXML(maxCellIndex) {\n    if (this._options.ignoreErrors) {\n      return '<ignoredErrors><ignoredError sqref=\"A1:' + maxCellIndex + '\" numberStoredAsText=\"1\" /></ignoredErrors>';\n    }\n\n    return \"\";\n  },\n  _generateWorksheetXML: function _generateWorksheetXML() {\n    var colIndex;\n    var rowIndex;\n    var cellData;\n    var xmlCells;\n    var rightBottomCellRef;\n    var xmlRows = [];\n    var rowsLength = this._cellsArray.length;\n    var cellsLength;\n    var colsLength = this._colsArray.length;\n    var rSpans = \"1:\" + colsLength;\n    var headerRowCount = this._dataProvider.getHeaderRowCount ? this._dataProvider.getHeaderRowCount() : 1;\n    var xmlResult = [WORKSHEET_HEADER_XML];\n    xmlResult.push(this._needSheetPr ? GROUP_SHEET_PR_XML : SINGLE_SHEET_PR_XML);\n    xmlResult.push('<dimension ref=\"A1:C1\"/>');\n    xmlResult.push(\"<sheetViews><sheetView \");\n    xmlResult.push(this._rtlEnabled ? 'rightToLeft=\"1\" ' : \"\");\n    xmlResult.push('tabSelected=\"1\" workbookViewId=\"0\">');\n    xmlResult.push(this._getPaneXML());\n    xmlResult.push(\"</sheetView></sheetViews>\");\n    xmlResult.push('<sheetFormatPr defaultRowHeight=\"15\"');\n    xmlResult.push(' outlineLevelRow=\"' + (this._dataProvider.getRowsCount() > 0 ? this._dataProvider.getGroupLevel(0) : 0) + '\"');\n    xmlResult.push(' x14ac:dyDescent=\"0.25\"/>');\n\n    for (colIndex = 0; colIndex < colsLength; colIndex++) {\n      this._colsArray[colIndex] = this._getXMLTag(\"col\", [{\n        name: \"width\",\n        value: this._colsArray[colIndex]\n      }, {\n        name: \"min\",\n        value: Number(colIndex) + 1\n      }, {\n        name: \"max\",\n        value: Number(colIndex) + 1\n      }]);\n    }\n\n    xmlResult.push(this._getXMLTag(\"cols\", [], this._colsArray.join(\"\")) + \"<sheetData>\");\n\n    for (rowIndex = 0; rowIndex < rowsLength; rowIndex++) {\n      xmlCells = [];\n      cellsLength = this._cellsArray[rowIndex].length;\n\n      for (colIndex = 0; colIndex < cellsLength; colIndex++) {\n        rowIndex = Number(rowIndex);\n        cellData = this._cellsArray[rowIndex][colIndex];\n        xmlCells.push(this._getXMLTag(\"c\", [{\n          name: \"r\",\n          value: this._convertToExcelCellRefAndTrackMaxIndex(rowIndex, colIndex)\n        }, {\n          name: \"s\",\n          value: cellData.style\n        }, {\n          name: \"t\",\n          value: cellData.type\n        }], (0, _type.isDefined)(cellData.value) ? this._getXMLTag(\"v\", [], cellData.value) : null));\n      }\n\n      xmlRows.push(this._getXMLTag(\"row\", [{\n        name: \"r\",\n        value: Number(rowIndex) + 1\n      }, {\n        name: \"spans\",\n        value: rSpans\n      }, {\n        name: \"outlineLevel\",\n        value: rowIndex >= headerRowCount ? this._dataProvider.getGroupLevel(rowIndex) : 0\n      }, {\n        name: \"x14ac:dyDescent\",\n        value: \"0.25\"\n      }], xmlCells.join(\"\")));\n      this._cellsArray[rowIndex] = null;\n\n      if (xmlRows.length > 1e4) {\n        xmlResult.push(xmlRows.join(\"\"));\n        xmlRows = [];\n      }\n    }\n\n    xmlResult.push(xmlRows.join(\"\"));\n    xmlRows = [];\n    rightBottomCellRef = this._convertToExcelCellRef(this._maxRowIndex, this._maxColumnIndex);\n    xmlResult.push(\"</sheetData>\" + this._getAutoFilterXML(rightBottomCellRef) + this._generateMergingXML() + this._getIgnoredErrorsXML(rightBottomCellRef) + \"</worksheet>\");\n\n    this._zip.folder(XL_FOLDER_NAME).folder(WORKSHEETS_FOLDER).file(WORKSHEET_FILE_NAME, xmlResult.join(\"\"));\n\n    this._colsArray = [];\n    this._cellsArray = [];\n    xmlResult = [];\n  },\n  _generateMergingXML: function _generateMergingXML() {\n    var k;\n    var l;\n    var cellIndex;\n    var rowIndex;\n    var rowsLength = (0, _type.isDefined)(this._dataProvider.getHeaderRowCount) ? this._dataProvider.getHeaderRowCount() : this._dataProvider.getRowsCount();\n\n    var columnsLength = this._dataProvider.getColumns().length;\n\n    var usedArea = [];\n    var mergeArray = [];\n    var mergeArrayLength;\n    var mergeIndex;\n    var mergeXML = \"\";\n\n    for (rowIndex = 0; rowIndex < rowsLength; rowIndex++) {\n      for (cellIndex = 0; cellIndex !== columnsLength; cellIndex++) {\n        if (!(0, _type.isDefined)(usedArea[rowIndex]) || !(0, _type.isDefined)(usedArea[rowIndex][cellIndex])) {\n          var cellMerge = this._dataProvider.getCellMerging(rowIndex, cellIndex);\n\n          if (cellMerge.colspan || cellMerge.rowspan) {\n            mergeArray.push({\n              start: this._convertToExcelCellRefAndTrackMaxIndex(rowIndex, cellIndex),\n              end: this._convertToExcelCellRefAndTrackMaxIndex(rowIndex + (cellMerge.rowspan || 0), cellIndex + (cellMerge.colspan || 0))\n            });\n\n            for (k = rowIndex; k <= rowIndex + cellMerge.rowspan || 0; k++) {\n              for (l = cellIndex; l <= cellIndex + cellMerge.colspan || 0; l++) {\n                if (!(0, _type.isDefined)(usedArea[k])) {\n                  usedArea[k] = [];\n                }\n\n                usedArea[k][l] = true;\n              }\n            }\n          }\n        }\n      }\n    }\n\n    mergeArrayLength = mergeArray.length;\n\n    for (mergeIndex = 0; mergeIndex < mergeArrayLength; mergeIndex++) {\n      mergeXML += this._getXMLTag(\"mergeCell\", [{\n        name: \"ref\",\n        value: mergeArray[mergeIndex].start + \":\" + mergeArray[mergeIndex].end\n      }]);\n    }\n\n    return mergeXML.length ? this._getXMLTag(\"mergeCells\", [{\n      name: \"count\",\n      value: mergeArrayLength\n    }], mergeXML) : \"\";\n  },\n  _generateCommonXML: function _generateCommonXML() {\n    var relsFileContent = XML_TAG + this._createXMLRelationships(this._createXMLRelationship(1, \"officeDocument\", \"xl/\" + WORKBOOK_FILE_NAME));\n\n    var xmlRelationships;\n\n    var folder = this._zip.folder(XL_FOLDER_NAME);\n\n    var relsXML = XML_TAG;\n\n    this._zip.folder(\"_\" + RELATIONSHIP_PART_NAME).file(\".\" + RELATIONSHIP_PART_NAME, relsFileContent);\n\n    xmlRelationships = this._createXMLRelationship(1, \"worksheet\", \"worksheets/\" + WORKSHEET_FILE_NAME) + this._createXMLRelationship(2, \"styles\", STYLE_FILE_NAME) + this._createXMLRelationship(3, \"sharedStrings\", SHAREDSTRING_FILE_NAME);\n    relsXML += this._createXMLRelationships(xmlRelationships);\n    folder.folder(\"_\" + RELATIONSHIP_PART_NAME).file(WORKBOOK_FILE_NAME + \".rels\", relsXML);\n    folder.file(WORKBOOK_FILE_NAME, this._getWorkbookContent());\n\n    this._zip.file(CONTENTTYPES_FILE_NAME, this._getContentTypesContent());\n  },\n  _generateContent: function _generateContent() {\n    this._prepareStyleData();\n\n    this._prepareCellData();\n\n    this._generateWorkXML();\n\n    this._generateCommonXML();\n  },\n  _generateWorkXML: function _generateWorkXML() {\n    this._generateStylesXML();\n\n    this._generateStringsXML();\n\n    this._generateWorksheetXML();\n  },\n  ctor: function ctor(dataProvider, options) {\n    this._rtlEnabled = options && !!options.rtlEnabled;\n    this._options = options;\n    this._maxRowIndex = 0;\n    this._maxColumnIndex = 0;\n    this._stringArray = [];\n    this._stringHash = {};\n    this._styleArray = [];\n    this._colsArray = [];\n    this._cellsArray = [];\n    this._needSheetPr = false;\n    this._dataProvider = dataProvider;\n    this._excelFile = new _excel2.default();\n\n    if ((0, _type.isDefined)(ExcelCreator.JSZip)) {\n      this._zip = new ExcelCreator.JSZip();\n    } else {\n      this._zip = null;\n    }\n  },\n  _checkZipState: function _checkZipState() {\n    if (!this._zip) {\n      throw _ui2.default.Error(\"E1041\", \"JSZip\");\n    }\n  },\n  ready: function ready() {\n    return this._dataProvider.ready();\n  },\n  getData: function getData(isBlob) {\n    var options = {\n      type: isBlob ? \"blob\" : \"base64\",\n      compression: \"DEFLATE\",\n      mimeType: _file_saver2.default.MIME_TYPES.EXCEL\n    };\n    var deferred = new _deferred.Deferred();\n\n    this._checkZipState();\n\n    this._generateContent();\n\n    if (this._zip.generateAsync) {\n      this._zip.generateAsync(options).then(deferred.resolve);\n    } else {\n      deferred.resolve(this._zip.generate(options));\n    }\n\n    return deferred;\n  }\n});\n\nExcelCreator.JSZip = _jszip2.default;\nexports.ExcelCreator = ExcelCreator;\n\nexports.getData = function (data, options) {\n  var excelCreator = new exports.ExcelCreator(data, options);\n\n  excelCreator._checkZipState();\n\n  return excelCreator.ready().then(function () {\n    return excelCreator.getData((0, _type.isFunction)((0, _window.getWindow)().Blob));\n  });\n};","map":{"version":3,"sources":["C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/devextreme/exporter/excel_creator.js"],"names":["_class","require","_class2","_interopRequireDefault","_window","_type","_extend","_ui","_ui2","_string","_string2","_jszip","_jszip2","_file_saver","_file_saver2","_excel_format_converter","_excel_format_converter2","_excel","_excel2","_deferred","obj","Symbol","_typeof","XML_TAG","GROUP_SHEET_PR_XML","SINGLE_SHEET_PR_XML","BASE_STYLE_XML2","OPEN_XML_FORMAT_URL","RELATIONSHIP_PART_NAME","XL_FOLDER_NAME","WORKBOOK_FILE_NAME","CONTENTTYPES_FILE_NAME","SHAREDSTRING_FILE_NAME","STYLE_FILE_NAME","WORKSHEETS_FOLDER","WORKSHEET_FILE_NAME","WORKSHEET_HEADER_XML","VALID_TYPES","date","number","string","EXCEL_START_TIME","Date","DAYS_COUNT_BEFORE_29_FEB_1900","MAX_DIGIT_WIDTH_IN_PIXELS","UNSUPPORTED_FORMAT_MAPPING","quarter","quarterAndYear","minute","millisecond","ExcelCreator","_getXMLTag","result","length","attributes","i","attr","_convertToExcelCellRef","columnName","max","charCode","zeroBasedCellIndex","Math","String","isCellIndexFound","zeroBasedRowIndex","_convertToExcelCellRefAndTrackMaxIndex","Number","_getDataType","_tryGetExcelCellDataType","isFinite","_formatObjectConverter","format","precision","dataType","currency","_tryConvertToExcelNumberFormat","newFormat","_appendString","value","_tryGetExcelDateValue","days","totalTime","_prepareValue","dataProvider","_ref","cellSourceData","type","sourceValue","_callCustomizeExcelCell","_ref2","style","sourceData","styleCopy","args","numberFormat","clearStyle","newStyle","_getDataArray","that","rowsLength","columns","rowIndex","cellsArray","cellsLength","cellIndex","cellData","styleArrayIndex","cellStyleId","modifiedExcelCell","cellDataType","newValue","excelDateValue","_calculateWidth","pixelsWidth","parseInt","_prepareStyleData","_this","styles","column","fonts","size","color","theme","name","family","scheme","bold","font","alignment","vertical","wrapText","horizontal","_prepareCellData","_createXMLRelationships","_createXMLRelationship","id","target","_getWorkbookContent","content","_getContentTypesContent","_generateStylesXML","folder","XML","_generateStringsXML","stringsLength","sharedStringXml","stringIndex","_getPaneXML","frozenArea","x","y","_getAutoFilterXML","_getIgnoredErrorsXML","_generateWorksheetXML","xmlRows","colsLength","rSpans","headerRowCount","xmlResult","colIndex","xmlCells","rightBottomCellRef","_generateMergingXML","columnsLength","usedArea","mergeArray","mergeXML","cellMerge","start","end","k","l","mergeArrayLength","mergeIndex","_generateCommonXML","relsFileContent","relsXML","xmlRelationships","_generateContent","_generateWorkXML","ctor","options","_checkZipState","ready","getData","isBlob","compression","mimeType","EXCEL","deferred","exports","excelCreator"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (exporter/excel_creator.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar _class = require(\"../core/class\");\r\nvar _class2 = _interopRequireDefault(_class);\r\nvar _window = require(\"../core/utils/window\");\r\nvar _type = require(\"../core/utils/type\");\r\nvar _extend = require(\"../core/utils/extend\");\r\nvar _ui = require(\"../ui/widget/ui.errors\");\r\nvar _ui2 = _interopRequireDefault(_ui);\r\nvar _string = require(\"../core/utils/string\");\r\nvar _string2 = _interopRequireDefault(_string);\r\nvar _jszip = require(\"jszip\");\r\nvar _jszip2 = _interopRequireDefault(_jszip);\r\nvar _file_saver = require(\"./file_saver\");\r\nvar _file_saver2 = _interopRequireDefault(_file_saver);\r\nvar _excel_format_converter = require(\"./excel_format_converter\");\r\nvar _excel_format_converter2 = _interopRequireDefault(_excel_format_converter);\r\nvar _excel = require(\"./excel/excel.file\");\r\nvar _excel2 = _interopRequireDefault(_excel);\r\nvar _deferred = require(\"../core/utils/deferred\");\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\n\r\nfunction _typeof(obj) {\r\n    if (\"function\" === typeof Symbol && \"symbol\" === typeof Symbol.iterator) {\r\n        _typeof = function(obj) {\r\n            return typeof obj\r\n        }\r\n    } else {\r\n        _typeof = function(obj) {\r\n            return obj && \"function\" === typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj\r\n        }\r\n    }\r\n    return _typeof(obj)\r\n}\r\nvar XML_TAG = '<?xml version=\"1.0\" encoding=\"utf-8\"?>';\r\nvar GROUP_SHEET_PR_XML = '<sheetPr><outlinePr summaryBelow=\"0\"/></sheetPr>';\r\nvar SINGLE_SHEET_PR_XML = \"<sheetPr/>\";\r\nvar BASE_STYLE_XML2 = '<borders count=\"1\"><border><left style=\"thin\"><color rgb=\"FFD3D3D3\"/></left><right style=\"thin\"><color rgb=\"FFD3D3D3\"/></right><top style=\"thin\"><color rgb=\"FFD3D3D3\"/></top><bottom style=\"thin\"><color rgb=\"FFD3D3D3\"/></bottom></border></borders><cellStyleXfs count=\"1\"><xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\"/></cellStyleXfs>';\r\nvar OPEN_XML_FORMAT_URL = \"http://schemas.openxmlformats.org\";\r\nvar RELATIONSHIP_PART_NAME = \"rels\";\r\nvar XL_FOLDER_NAME = \"xl\";\r\nvar WORKBOOK_FILE_NAME = \"workbook.xml\";\r\nvar CONTENTTYPES_FILE_NAME = \"[Content_Types].xml\";\r\nvar SHAREDSTRING_FILE_NAME = \"sharedStrings.xml\";\r\nvar STYLE_FILE_NAME = \"styles.xml\";\r\nvar WORKSHEETS_FOLDER = \"worksheets\";\r\nvar WORKSHEET_FILE_NAME = \"sheet1.xml\";\r\nvar WORKSHEET_HEADER_XML = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><worksheet xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" mc:Ignorable=\"x14ac\" xmlns:x14ac=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac\">';\r\nvar VALID_TYPES = {\r\n    \"boolean\": \"b\",\r\n    date: \"d\",\r\n    number: \"n\",\r\n    string: \"s\"\r\n};\r\nvar EXCEL_START_TIME = Date.UTC(1899, 11, 30);\r\nvar DAYS_COUNT_BEFORE_29_FEB_1900 = 60;\r\nvar MAX_DIGIT_WIDTH_IN_PIXELS = 7;\r\nvar UNSUPPORTED_FORMAT_MAPPING = {\r\n    quarter: \"shortDate\",\r\n    quarterAndYear: \"shortDate\",\r\n    minute: \"longTime\",\r\n    millisecond: \"longTime\"\r\n};\r\nvar ExcelCreator = _class2.default.inherit({\r\n    _getXMLTag: function(tagName, attributes, content) {\r\n        var result = \"<\" + tagName;\r\n        var i;\r\n        var length = attributes.length;\r\n        var attr;\r\n        for (i = 0; i < length; i++) {\r\n            attr = attributes[i];\r\n            if (void 0 !== attr.value) {\r\n                result = result + \" \" + attr.name + '=\"' + attr.value + '\"'\r\n            }\r\n        }\r\n        return (0, _type.isDefined)(content) ? result + \">\" + content + \"</\" + tagName + \">\" : result + \" />\"\r\n    },\r\n    _convertToExcelCellRef: function(zeroBasedRowIndex, zeroBasedCellIndex) {\r\n        var columnName = \"\";\r\n        var max = 26;\r\n        var charCode;\r\n        var isCellIndexFound;\r\n        while (!isCellIndexFound) {\r\n            charCode = 65 + (zeroBasedCellIndex >= max ? zeroBasedCellIndex % max : Math.ceil(zeroBasedCellIndex));\r\n            columnName = String.fromCharCode(charCode) + columnName;\r\n            if (zeroBasedCellIndex >= max) {\r\n                zeroBasedCellIndex = Math.floor(zeroBasedCellIndex / max) - 1\r\n            } else {\r\n                isCellIndexFound = true\r\n            }\r\n        }\r\n        return columnName + (zeroBasedRowIndex + 1)\r\n    },\r\n    _convertToExcelCellRefAndTrackMaxIndex: function(rowIndex, cellIndex) {\r\n        if (this._maxRowIndex < Number(rowIndex)) {\r\n            this._maxRowIndex = Number(rowIndex)\r\n        }\r\n        if (this._maxColumnIndex < Number(cellIndex)) {\r\n            this._maxColumnIndex = Number(cellIndex)\r\n        }\r\n        return this._convertToExcelCellRef(rowIndex, cellIndex)\r\n    },\r\n    _getDataType: function(dataType) {\r\n        return VALID_TYPES[dataType] || VALID_TYPES.string\r\n    },\r\n    _tryGetExcelCellDataType: function(object) {\r\n        if ((0, _type.isDefined)(object)) {\r\n            if (\"number\" === typeof object) {\r\n                if (isFinite(object)) {\r\n                    return VALID_TYPES.number\r\n                } else {\r\n                    return VALID_TYPES.string\r\n                }\r\n            } else {\r\n                if ((0, _type.isString)(object)) {\r\n                    return VALID_TYPES.string\r\n                } else {\r\n                    if ((0, _type.isDate)(object)) {\r\n                        return VALID_TYPES.number\r\n                    } else {\r\n                        if ((0, _type.isBoolean)(object)) {\r\n                            return VALID_TYPES.boolean\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    _formatObjectConverter: function(format, dataType) {\r\n        var result = {\r\n            format: format,\r\n            precision: format && format.precision,\r\n            dataType: dataType\r\n        };\r\n        if ((0, _type.isObject)(format)) {\r\n            return (0, _extend.extend)(result, format, {\r\n                format: format.formatter || format.type,\r\n                currency: format.currency\r\n            })\r\n        }\r\n        return result\r\n    },\r\n    _tryConvertToExcelNumberFormat: function(format, dataType) {\r\n        var currency;\r\n        var newFormat = this._formatObjectConverter(format, dataType);\r\n        format = newFormat.format;\r\n        currency = newFormat.currency;\r\n        dataType = newFormat.dataType;\r\n        if ((0, _type.isDefined)(format) && \"date\" === dataType) {\r\n            format = UNSUPPORTED_FORMAT_MAPPING[format && format.type || format] || format\r\n        }\r\n        return _excel_format_converter2.default.convertFormat(format, newFormat.precision, dataType, currency)\r\n    },\r\n    _appendString: function(value) {\r\n        if ((0, _type.isDefined)(value)) {\r\n            value = String(value);\r\n            if (value.length) {\r\n                value = _string2.default.encodeHtml(value);\r\n                if (void 0 === this._stringHash[value]) {\r\n                    this._stringHash[value] = this._stringArray.length;\r\n                    this._stringArray.push(value)\r\n                }\r\n                return this._stringHash[value]\r\n            }\r\n        }\r\n    },\r\n    _tryGetExcelDateValue: function(date) {\r\n        var days;\r\n        var totalTime;\r\n        if ((0, _type.isDate)(date)) {\r\n            days = Math.floor((Date.UTC(date.getFullYear(), date.getMonth(), date.getDate()) - EXCEL_START_TIME) / 864e5);\r\n            if (days < DAYS_COUNT_BEFORE_29_FEB_1900) {\r\n                days--\r\n            }\r\n            totalTime = (3600 * date.getHours() + 60 * date.getMinutes() + date.getSeconds()) / 86400;\r\n            return days + totalTime\r\n        }\r\n    },\r\n    _prepareValue: function(rowIndex, cellIndex) {\r\n        var dataProvider = this._dataProvider;\r\n        var _ref = dataProvider.getCellData(rowIndex, cellIndex) || {},\r\n            value = _ref.value,\r\n            cellSourceData = _ref.cellSourceData;\r\n        var sourceValue;\r\n        var type = this._getDataType(dataProvider.getCellType(rowIndex, cellIndex));\r\n        if (type === VALID_TYPES.date && !(0, _type.isDate)(value)) {\r\n            type = VALID_TYPES.string\r\n        }\r\n        switch (type) {\r\n            case VALID_TYPES.string:\r\n                sourceValue = value;\r\n                value = this._appendString(value);\r\n                break;\r\n            case VALID_TYPES.date:\r\n                sourceValue = value;\r\n                value = this._tryGetExcelDateValue(value);\r\n                type = VALID_TYPES.number\r\n        }\r\n        return {\r\n            value: value,\r\n            type: type,\r\n            sourceValue: sourceValue,\r\n            cellSourceData: cellSourceData\r\n        }\r\n    },\r\n    _callCustomizeExcelCell: function(_ref2) {\r\n        var dataProvider = _ref2.dataProvider,\r\n            value = _ref2.value,\r\n            style = _ref2.style,\r\n            sourceData = _ref2.sourceData;\r\n        var styleCopy = _excel2.default.copyCellFormat(style);\r\n        var args = {\r\n            value: value,\r\n            numberFormat: styleCopy.numberFormat,\r\n            clearStyle: function() {\r\n                this.horizontalAlignment = null;\r\n                this.verticalAlignment = null;\r\n                this.wrapTextEnabled = null;\r\n                this.font = null;\r\n                this.numberFormat = null\r\n            }\r\n        };\r\n        if ((0, _type.isDefined)(styleCopy)) {\r\n            if ((0, _type.isDefined)(styleCopy.alignment)) {\r\n                args.horizontalAlignment = styleCopy.alignment.horizontal;\r\n                args.verticalAlignment = styleCopy.alignment.vertical;\r\n                args.wrapTextEnabled = styleCopy.alignment.wrapText\r\n            }\r\n            args.backgroundColor = styleCopy.backgroundColor;\r\n            args.fillPatternType = styleCopy.fillPatternType;\r\n            args.fillPatternColor = styleCopy.fillPatternColor;\r\n            args.font = styleCopy.font\r\n        }\r\n        dataProvider.customizeExcelCell(args, sourceData);\r\n        var newStyle = styleCopy || {};\r\n        newStyle.font = args.font;\r\n        newStyle.alignment = newStyle.alignment || {};\r\n        newStyle.alignment.horizontal = args.horizontalAlignment;\r\n        newStyle.alignment.vertical = args.verticalAlignment;\r\n        newStyle.alignment.wrapText = args.wrapTextEnabled;\r\n        newStyle.backgroundColor = args.backgroundColor;\r\n        newStyle.fillPatternType = args.fillPatternType;\r\n        newStyle.fillPatternColor = args.fillPatternColor;\r\n        newStyle.numberFormat = args.numberFormat;\r\n        return {\r\n            value: args.value,\r\n            style: newStyle\r\n        }\r\n    },\r\n    _getDataArray: function() {\r\n        var that = this;\r\n        var rowIndex;\r\n        var cellIndex;\r\n        var cellsArray;\r\n        var cellData;\r\n        var result = [];\r\n        var dataProvider = that._dataProvider;\r\n        var rowsLength = dataProvider.getRowsCount();\r\n        var columns = dataProvider.getColumns();\r\n        var cellsLength;\r\n        for (rowIndex = 0; rowIndex < rowsLength; rowIndex++) {\r\n            cellsArray = [];\r\n            cellsLength = columns.length;\r\n            for (cellIndex = 0; cellIndex !== cellsLength; cellIndex++) {\r\n                cellData = that._prepareValue(rowIndex, cellIndex);\r\n                var styleArrayIndex = dataProvider.getStyleId(rowIndex, cellIndex);\r\n                var cellStyleId = this._styleArrayIndexToCellStyleIdMap[styleArrayIndex];\r\n                if (dataProvider.hasCustomizeExcelCell && dataProvider.hasCustomizeExcelCell()) {\r\n                    var value = cellData.sourceValue || cellData.value;\r\n                    var modifiedExcelCell = this._callCustomizeExcelCell({\r\n                        dataProvider: dataProvider,\r\n                        value: value,\r\n                        style: that._styleArray[styleArrayIndex],\r\n                        sourceData: cellData.cellSourceData\r\n                    });\r\n                    if (modifiedExcelCell.value !== value) {\r\n                        if (_typeof(modifiedExcelCell.value) !== _typeof(value) || \"number\" === typeof modifiedExcelCell.value && !isFinite(modifiedExcelCell.value)) {\r\n                            var cellDataType = this._tryGetExcelCellDataType(modifiedExcelCell.value);\r\n                            if ((0, _type.isDefined)(cellDataType)) {\r\n                                cellData.type = cellDataType\r\n                            }\r\n                        }\r\n                        switch (cellData.type) {\r\n                            case VALID_TYPES.string:\r\n                                cellData.value = this._appendString(modifiedExcelCell.value);\r\n                                break;\r\n                            case VALID_TYPES.date:\r\n                                cellData.value = modifiedExcelCell.value;\r\n                                break;\r\n                            case VALID_TYPES.number:\r\n                                var newValue = modifiedExcelCell.value;\r\n                                var excelDateValue = this._tryGetExcelDateValue(newValue);\r\n                                if ((0, _type.isDefined)(excelDateValue)) {\r\n                                    newValue = excelDateValue\r\n                                }\r\n                                cellData.value = newValue;\r\n                                break;\r\n                            default:\r\n                                cellData.value = modifiedExcelCell.value\r\n                        }\r\n                    }\r\n                    cellStyleId = this._excelFile.registerCellFormat(modifiedExcelCell.style)\r\n                }\r\n                cellsArray.push({\r\n                    style: cellStyleId,\r\n                    value: cellData.value,\r\n                    type: cellData.type\r\n                })\r\n            }\r\n            if (!that._needSheetPr && dataProvider.getGroupLevel(rowIndex) > 0) {\r\n                that._needSheetPr = true\r\n            }\r\n            result.push(cellsArray)\r\n        }\r\n        return result\r\n    },\r\n    _calculateWidth: function(pixelsWidth) {\r\n        pixelsWidth = parseInt(pixelsWidth, 10);\r\n        if (!pixelsWidth || pixelsWidth < 5) {\r\n            pixelsWidth = 100\r\n        }\r\n        return Math.min(255, Math.floor((pixelsWidth - 5) / MAX_DIGIT_WIDTH_IN_PIXELS * 100 + .5) / 100)\r\n    },\r\n    _prepareStyleData: function() {\r\n        var _this = this;\r\n        var that = this;\r\n        var styles = that._dataProvider.getStyles();\r\n        that._dataProvider.getColumns().forEach(function(column) {\r\n            that._colsArray.push(that._calculateWidth(column.width))\r\n        });\r\n        var fonts = [{\r\n            size: 11,\r\n            color: {\r\n                theme: 1\r\n            },\r\n            name: \"Calibri\",\r\n            family: 2,\r\n            scheme: \"minor\",\r\n            bold: false\r\n        }, {\r\n            size: 11,\r\n            color: {\r\n                theme: 1\r\n            },\r\n            name: \"Calibri\",\r\n            family: 2,\r\n            scheme: \"minor\",\r\n            bold: true\r\n        }];\r\n        this._excelFile.registerFont(fonts[0]);\r\n        this._excelFile.registerFont(fonts[1]);\r\n        styles.forEach(function(style) {\r\n            var numberFormat = that._tryConvertToExcelNumberFormat(style.format, style.dataType);\r\n            if (!(0, _type.isDefined)(numberFormat)) {\r\n                numberFormat = 0\r\n            }\r\n            that._styleArray.push({\r\n                font: fonts[Number(!!style.bold)],\r\n                numberFormat: numberFormat,\r\n                alignment: {\r\n                    vertical: \"top\",\r\n                    wrapText: !!style.wrapText,\r\n                    horizontal: style.alignment || \"left\"\r\n                }\r\n            })\r\n        });\r\n        that._styleArrayIndexToCellStyleIdMap = that._styleArray.map(function(item) {\r\n            return _this._excelFile.registerCellFormat(item)\r\n        })\r\n    },\r\n    _prepareCellData: function() {\r\n        this._cellsArray = this._getDataArray()\r\n    },\r\n    _createXMLRelationships: function(xmlRelationships) {\r\n        return this._getXMLTag(\"Relationships\", [{\r\n            name: \"xmlns\",\r\n            value: OPEN_XML_FORMAT_URL + \"/package/2006/relationships\"\r\n        }], xmlRelationships)\r\n    },\r\n    _createXMLRelationship: function(id, type, target) {\r\n        return this._getXMLTag(\"Relationship\", [{\r\n            name: \"Id\",\r\n            value: \"rId\" + id\r\n        }, {\r\n            name: \"Type\",\r\n            value: OPEN_XML_FORMAT_URL + \"/officeDocument/2006/relationships/\" + type\r\n        }, {\r\n            name: \"Target\",\r\n            value: target\r\n        }])\r\n    },\r\n    _getWorkbookContent: function() {\r\n        var content = '<bookViews><workbookView xWindow=\"0\" yWindow=\"0\" windowWidth=\"0\" windowHeight=\"0\"/></bookViews><sheets><sheet name=\"Sheet\" sheetId=\"1\" r:id=\"rId1\" /></sheets><definedNames><definedName name=\"_xlnm.Print_Titles\" localSheetId=\"0\">Sheet!$1:$1</definedName><definedName name=\"_xlnm._FilterDatabase\" hidden=\"0\" localSheetId=\"0\">Sheet!$A$1:$F$6332</definedName></definedNames>';\r\n        return XML_TAG + this._getXMLTag(\"workbook\", [{\r\n            name: \"xmlns:r\",\r\n            value: OPEN_XML_FORMAT_URL + \"/officeDocument/2006/relationships\"\r\n        }, {\r\n            name: \"xmlns\",\r\n            value: OPEN_XML_FORMAT_URL + \"/spreadsheetml/2006/main\"\r\n        }], content)\r\n    },\r\n    _getContentTypesContent: function() {\r\n        return XML_TAG + '<Types xmlns=\"' + OPEN_XML_FORMAT_URL + '/package/2006/content-types\"><Default Extension=\"rels\" ContentType=\"application/vnd.openxmlformats-package.relationships+xml\" /><Default Extension=\"xml\" ContentType=\"application/xml\" /><Override PartName=\"/xl/worksheets/sheet1.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml\" /><Override PartName=\"/xl/styles.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml\" /><Override PartName=\"/xl/sharedStrings.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml\" /><Override PartName=\"/xl/workbook.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml\" /></Types>'\r\n    },\r\n    _generateStylesXML: function() {\r\n        var that = this;\r\n        var folder = that._zip.folder(XL_FOLDER_NAME);\r\n        var XML = \"\";\r\n        XML += this._excelFile.generateNumberFormatsXml();\r\n        XML += this._excelFile.generateFontsXml();\r\n        XML += this._excelFile.generateFillsXml();\r\n        XML += BASE_STYLE_XML2;\r\n        XML += this._excelFile.generateCellFormatsXml();\r\n        XML += that._getXMLTag(\"cellStyles\", [{\r\n            name: \"count\",\r\n            value: 1\r\n        }], that._getXMLTag(\"cellStyle\", [{\r\n            name: \"name\",\r\n            value: \"Normal\"\r\n        }, {\r\n            name: \"xfId\",\r\n            value: 0\r\n        }, {\r\n            name: \"builtinId\",\r\n            value: 0\r\n        }]));\r\n        XML = XML_TAG + that._getXMLTag(\"styleSheet\", [{\r\n            name: \"xmlns\",\r\n            value: OPEN_XML_FORMAT_URL + \"/spreadsheetml/2006/main\"\r\n        }], XML);\r\n        folder.file(STYLE_FILE_NAME, XML);\r\n        that._styleArray = []\r\n    },\r\n    _generateStringsXML: function() {\r\n        var folder = this._zip.folder(XL_FOLDER_NAME);\r\n        var stringIndex;\r\n        var stringsLength = this._stringArray.length;\r\n        var sharedStringXml = XML_TAG;\r\n        for (stringIndex = 0; stringIndex < stringsLength; stringIndex++) {\r\n            this._stringArray[stringIndex] = this._getXMLTag(\"si\", [], this._getXMLTag(\"t\", [], this._stringArray[stringIndex]))\r\n        }\r\n        sharedStringXml += this._getXMLTag(\"sst\", [{\r\n            name: \"xmlns\",\r\n            value: OPEN_XML_FORMAT_URL + \"/spreadsheetml/2006/main\"\r\n        }, {\r\n            name: \"count\",\r\n            value: this._stringArray.length\r\n        }, {\r\n            name: \"uniqueCount\",\r\n            value: this._stringArray.length\r\n        }], this._stringArray.join(\"\"));\r\n        folder.file(SHAREDSTRING_FILE_NAME, sharedStringXml);\r\n        this._stringArray = []\r\n    },\r\n    _getPaneXML: function() {\r\n        var attributes = [{\r\n            name: \"activePane\",\r\n            value: \"bottomLeft\"\r\n        }, {\r\n            name: \"state\",\r\n            value: \"frozen\"\r\n        }];\r\n        var frozenArea = this._dataProvider.getFrozenArea();\r\n        if (!(frozenArea.x || frozenArea.y)) {\r\n            return \"\"\r\n        }\r\n        if (frozenArea.x) {\r\n            attributes.push({\r\n                name: \"xSplit\",\r\n                value: frozenArea.x\r\n            })\r\n        }\r\n        if (frozenArea.y) {\r\n            attributes.push({\r\n                name: \"ySplit\",\r\n                value: frozenArea.y\r\n            })\r\n        }\r\n        attributes.push({\r\n            name: \"topLeftCell\",\r\n            value: this._convertToExcelCellRefAndTrackMaxIndex(frozenArea.y, frozenArea.x)\r\n        });\r\n        return this._getXMLTag(\"pane\", attributes)\r\n    },\r\n    _getAutoFilterXML: function(maxCellIndex) {\r\n        if (this._options.autoFilterEnabled) {\r\n            return '<autoFilter ref=\"A' + this._dataProvider.getHeaderRowCount() + \":\" + maxCellIndex + '\" />'\r\n        }\r\n        return \"\"\r\n    },\r\n    _getIgnoredErrorsXML: function(maxCellIndex) {\r\n        if (this._options.ignoreErrors) {\r\n            return '<ignoredErrors><ignoredError sqref=\"A1:' + maxCellIndex + '\" numberStoredAsText=\"1\" /></ignoredErrors>'\r\n        }\r\n        return \"\"\r\n    },\r\n    _generateWorksheetXML: function() {\r\n        var colIndex;\r\n        var rowIndex;\r\n        var cellData;\r\n        var xmlCells;\r\n        var rightBottomCellRef;\r\n        var xmlRows = [];\r\n        var rowsLength = this._cellsArray.length;\r\n        var cellsLength;\r\n        var colsLength = this._colsArray.length;\r\n        var rSpans = \"1:\" + colsLength;\r\n        var headerRowCount = this._dataProvider.getHeaderRowCount ? this._dataProvider.getHeaderRowCount() : 1;\r\n        var xmlResult = [WORKSHEET_HEADER_XML];\r\n        xmlResult.push(this._needSheetPr ? GROUP_SHEET_PR_XML : SINGLE_SHEET_PR_XML);\r\n        xmlResult.push('<dimension ref=\"A1:C1\"/>');\r\n        xmlResult.push(\"<sheetViews><sheetView \");\r\n        xmlResult.push(this._rtlEnabled ? 'rightToLeft=\"1\" ' : \"\");\r\n        xmlResult.push('tabSelected=\"1\" workbookViewId=\"0\">');\r\n        xmlResult.push(this._getPaneXML());\r\n        xmlResult.push(\"</sheetView></sheetViews>\");\r\n        xmlResult.push('<sheetFormatPr defaultRowHeight=\"15\"');\r\n        xmlResult.push(' outlineLevelRow=\"' + (this._dataProvider.getRowsCount() > 0 ? this._dataProvider.getGroupLevel(0) : 0) + '\"');\r\n        xmlResult.push(' x14ac:dyDescent=\"0.25\"/>');\r\n        for (colIndex = 0; colIndex < colsLength; colIndex++) {\r\n            this._colsArray[colIndex] = this._getXMLTag(\"col\", [{\r\n                name: \"width\",\r\n                value: this._colsArray[colIndex]\r\n            }, {\r\n                name: \"min\",\r\n                value: Number(colIndex) + 1\r\n            }, {\r\n                name: \"max\",\r\n                value: Number(colIndex) + 1\r\n            }])\r\n        }\r\n        xmlResult.push(this._getXMLTag(\"cols\", [], this._colsArray.join(\"\")) + \"<sheetData>\");\r\n        for (rowIndex = 0; rowIndex < rowsLength; rowIndex++) {\r\n            xmlCells = [];\r\n            cellsLength = this._cellsArray[rowIndex].length;\r\n            for (colIndex = 0; colIndex < cellsLength; colIndex++) {\r\n                rowIndex = Number(rowIndex);\r\n                cellData = this._cellsArray[rowIndex][colIndex];\r\n                xmlCells.push(this._getXMLTag(\"c\", [{\r\n                    name: \"r\",\r\n                    value: this._convertToExcelCellRefAndTrackMaxIndex(rowIndex, colIndex)\r\n                }, {\r\n                    name: \"s\",\r\n                    value: cellData.style\r\n                }, {\r\n                    name: \"t\",\r\n                    value: cellData.type\r\n                }], (0, _type.isDefined)(cellData.value) ? this._getXMLTag(\"v\", [], cellData.value) : null))\r\n            }\r\n            xmlRows.push(this._getXMLTag(\"row\", [{\r\n                name: \"r\",\r\n                value: Number(rowIndex) + 1\r\n            }, {\r\n                name: \"spans\",\r\n                value: rSpans\r\n            }, {\r\n                name: \"outlineLevel\",\r\n                value: rowIndex >= headerRowCount ? this._dataProvider.getGroupLevel(rowIndex) : 0\r\n            }, {\r\n                name: \"x14ac:dyDescent\",\r\n                value: \"0.25\"\r\n            }], xmlCells.join(\"\")));\r\n            this._cellsArray[rowIndex] = null;\r\n            if (xmlRows.length > 1e4) {\r\n                xmlResult.push(xmlRows.join(\"\"));\r\n                xmlRows = []\r\n            }\r\n        }\r\n        xmlResult.push(xmlRows.join(\"\"));\r\n        xmlRows = [];\r\n        rightBottomCellRef = this._convertToExcelCellRef(this._maxRowIndex, this._maxColumnIndex);\r\n        xmlResult.push(\"</sheetData>\" + this._getAutoFilterXML(rightBottomCellRef) + this._generateMergingXML() + this._getIgnoredErrorsXML(rightBottomCellRef) + \"</worksheet>\");\r\n        this._zip.folder(XL_FOLDER_NAME).folder(WORKSHEETS_FOLDER).file(WORKSHEET_FILE_NAME, xmlResult.join(\"\"));\r\n        this._colsArray = [];\r\n        this._cellsArray = [];\r\n        xmlResult = []\r\n    },\r\n    _generateMergingXML: function() {\r\n        var k;\r\n        var l;\r\n        var cellIndex;\r\n        var rowIndex;\r\n        var rowsLength = (0, _type.isDefined)(this._dataProvider.getHeaderRowCount) ? this._dataProvider.getHeaderRowCount() : this._dataProvider.getRowsCount();\r\n        var columnsLength = this._dataProvider.getColumns().length;\r\n        var usedArea = [];\r\n        var mergeArray = [];\r\n        var mergeArrayLength;\r\n        var mergeIndex;\r\n        var mergeXML = \"\";\r\n        for (rowIndex = 0; rowIndex < rowsLength; rowIndex++) {\r\n            for (cellIndex = 0; cellIndex !== columnsLength; cellIndex++) {\r\n                if (!(0, _type.isDefined)(usedArea[rowIndex]) || !(0, _type.isDefined)(usedArea[rowIndex][cellIndex])) {\r\n                    var cellMerge = this._dataProvider.getCellMerging(rowIndex, cellIndex);\r\n                    if (cellMerge.colspan || cellMerge.rowspan) {\r\n                        mergeArray.push({\r\n                            start: this._convertToExcelCellRefAndTrackMaxIndex(rowIndex, cellIndex),\r\n                            end: this._convertToExcelCellRefAndTrackMaxIndex(rowIndex + (cellMerge.rowspan || 0), cellIndex + (cellMerge.colspan || 0))\r\n                        });\r\n                        for (k = rowIndex; k <= rowIndex + cellMerge.rowspan || 0; k++) {\r\n                            for (l = cellIndex; l <= cellIndex + cellMerge.colspan || 0; l++) {\r\n                                if (!(0, _type.isDefined)(usedArea[k])) {\r\n                                    usedArea[k] = []\r\n                                }\r\n                                usedArea[k][l] = true\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        mergeArrayLength = mergeArray.length;\r\n        for (mergeIndex = 0; mergeIndex < mergeArrayLength; mergeIndex++) {\r\n            mergeXML += this._getXMLTag(\"mergeCell\", [{\r\n                name: \"ref\",\r\n                value: mergeArray[mergeIndex].start + \":\" + mergeArray[mergeIndex].end\r\n            }])\r\n        }\r\n        return mergeXML.length ? this._getXMLTag(\"mergeCells\", [{\r\n            name: \"count\",\r\n            value: mergeArrayLength\r\n        }], mergeXML) : \"\"\r\n    },\r\n    _generateCommonXML: function() {\r\n        var relsFileContent = XML_TAG + this._createXMLRelationships(this._createXMLRelationship(1, \"officeDocument\", \"xl/\" + WORKBOOK_FILE_NAME));\r\n        var xmlRelationships;\r\n        var folder = this._zip.folder(XL_FOLDER_NAME);\r\n        var relsXML = XML_TAG;\r\n        this._zip.folder(\"_\" + RELATIONSHIP_PART_NAME).file(\".\" + RELATIONSHIP_PART_NAME, relsFileContent);\r\n        xmlRelationships = this._createXMLRelationship(1, \"worksheet\", \"worksheets/\" + WORKSHEET_FILE_NAME) + this._createXMLRelationship(2, \"styles\", STYLE_FILE_NAME) + this._createXMLRelationship(3, \"sharedStrings\", SHAREDSTRING_FILE_NAME);\r\n        relsXML += this._createXMLRelationships(xmlRelationships);\r\n        folder.folder(\"_\" + RELATIONSHIP_PART_NAME).file(WORKBOOK_FILE_NAME + \".rels\", relsXML);\r\n        folder.file(WORKBOOK_FILE_NAME, this._getWorkbookContent());\r\n        this._zip.file(CONTENTTYPES_FILE_NAME, this._getContentTypesContent())\r\n    },\r\n    _generateContent: function() {\r\n        this._prepareStyleData();\r\n        this._prepareCellData();\r\n        this._generateWorkXML();\r\n        this._generateCommonXML()\r\n    },\r\n    _generateWorkXML: function() {\r\n        this._generateStylesXML();\r\n        this._generateStringsXML();\r\n        this._generateWorksheetXML()\r\n    },\r\n    ctor: function(dataProvider, options) {\r\n        this._rtlEnabled = options && !!options.rtlEnabled;\r\n        this._options = options;\r\n        this._maxRowIndex = 0;\r\n        this._maxColumnIndex = 0;\r\n        this._stringArray = [];\r\n        this._stringHash = {};\r\n        this._styleArray = [];\r\n        this._colsArray = [];\r\n        this._cellsArray = [];\r\n        this._needSheetPr = false;\r\n        this._dataProvider = dataProvider;\r\n        this._excelFile = new _excel2.default;\r\n        if ((0, _type.isDefined)(ExcelCreator.JSZip)) {\r\n            this._zip = new ExcelCreator.JSZip\r\n        } else {\r\n            this._zip = null\r\n        }\r\n    },\r\n    _checkZipState: function() {\r\n        if (!this._zip) {\r\n            throw _ui2.default.Error(\"E1041\", \"JSZip\")\r\n        }\r\n    },\r\n    ready: function() {\r\n        return this._dataProvider.ready()\r\n    },\r\n    getData: function(isBlob) {\r\n        var options = {\r\n            type: isBlob ? \"blob\" : \"base64\",\r\n            compression: \"DEFLATE\",\r\n            mimeType: _file_saver2.default.MIME_TYPES.EXCEL\r\n        };\r\n        var deferred = new _deferred.Deferred;\r\n        this._checkZipState();\r\n        this._generateContent();\r\n        if (this._zip.generateAsync) {\r\n            this._zip.generateAsync(options).then(deferred.resolve)\r\n        } else {\r\n            deferred.resolve(this._zip.generate(options))\r\n        }\r\n        return deferred\r\n    }\r\n});\r\nExcelCreator.JSZip = _jszip2.default;\r\nexports.ExcelCreator = ExcelCreator;\r\nexports.getData = function(data, options) {\r\n    var excelCreator = new exports.ExcelCreator(data, options);\r\n    excelCreator._checkZipState();\r\n    return excelCreator.ready().then(function() {\r\n        return excelCreator.getData((0, _type.isFunction)((0, _window.getWindow)().Blob))\r\n    })\r\n};\r\n"]},"metadata":{},"sourceType":"module"}