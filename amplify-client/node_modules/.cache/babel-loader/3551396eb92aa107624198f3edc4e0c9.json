{"ast":null,"code":"/**\r\n * DevExtreme (ui/tree_view/ui.tree_view.base.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar _renderer = require(\"../../core/renderer\");\n\nvar _renderer2 = _interopRequireDefault(_renderer);\n\nvar _dom_adapter = require(\"../../core/dom_adapter\");\n\nvar _events_engine = require(\"../../events/core/events_engine\");\n\nvar _message = require(\"../../localization/message\");\n\nvar _message2 = _interopRequireDefault(_message);\n\nvar _click = require(\"../../events/click\");\n\nvar _click2 = _interopRequireDefault(_click);\n\nvar _common = require(\"../../core/utils/common\");\n\nvar _common2 = _interopRequireDefault(_common);\n\nvar _window = require(\"../../core/utils/window\");\n\nvar _window2 = _interopRequireDefault(_window);\n\nvar _type = require(\"../../core/utils/type\");\n\nvar _extend = require(\"../../core/utils/extend\");\n\nvar _iterator = require(\"../../core/utils/iterator\");\n\nvar _dom = require(\"../../core/utils/dom\");\n\nvar _check_box = require(\"../check_box\");\n\nvar _check_box2 = _interopRequireDefault(_check_box);\n\nvar _ui = require(\"../hierarchical_collection/ui.hierarchical_collection_widget\");\n\nvar _ui2 = _interopRequireDefault(_ui);\n\nvar _utils = require(\"../../events/utils\");\n\nvar _pointer = require(\"../../events/pointer\");\n\nvar _double_click = require(\"../../events/double_click\");\n\nvar _double_click2 = _interopRequireDefault(_double_click);\n\nvar _fx = require(\"../../animation/fx\");\n\nvar _fx2 = _interopRequireDefault(_fx);\n\nvar _ui3 = require(\"../scroll_view/ui.scrollable\");\n\nvar _ui4 = _interopRequireDefault(_ui3);\n\nvar _load_indicator = require(\"../load_indicator\");\n\nvar _load_indicator2 = _interopRequireDefault(_load_indicator);\n\nvar _deferred = require(\"../../core/utils/deferred\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nvar WIDGET_CLASS = \"dx-treeview\";\nvar NODE_CLASS = \"\".concat(WIDGET_CLASS, \"-node\");\nvar NODE_CONTAINER_CLASS = \"\".concat(NODE_CLASS, \"-container\");\nvar NODE_LOAD_INDICATOR_CLASS = \"\".concat(NODE_CLASS, \"-loadindicator\");\nvar OPENED_NODE_CONTAINER_CLASS = \"\".concat(NODE_CLASS, \"-container-opened\");\nvar IS_LEAF = \"\".concat(NODE_CLASS, \"-is-leaf\");\nvar ITEM_CLASS = \"\".concat(WIDGET_CLASS, \"-item\");\nvar ITEM_WITH_CHECKBOX_CLASS = \"\".concat(ITEM_CLASS, \"-with-checkbox\");\nvar ITEM_WITHOUT_CHECKBOX_CLASS = \"\".concat(ITEM_CLASS, \"-without-checkbox\");\nvar ITEM_DATA_KEY = \"\".concat(ITEM_CLASS, \"-data\");\nvar TOGGLE_ITEM_VISIBILITY_CLASS = \"\".concat(WIDGET_CLASS, \"-toggle-item-visibility\");\nvar LOAD_INDICATOR_CLASS = \"\".concat(WIDGET_CLASS, \"-loadindicator\");\nvar LOAD_INDICATOR_WRAPPER_CLASS = \"\".concat(WIDGET_CLASS, \"-loadindicator-wrapper\");\nvar TOGGLE_ITEM_VISIBILITY_OPENED_CLASS = \"\".concat(WIDGET_CLASS, \"-toggle-item-visibility-opened\");\nvar SELECT_ALL_ITEM_CLASS = \"\".concat(WIDGET_CLASS, \"-select-all-item\");\nvar INVISIBLE_STATE_CLASS = \"dx-state-invisible\";\nvar DISABLED_STATE_CLASS = \"dx-state-disabled\";\nvar SELECTED_ITEM_CLASS = \"dx-state-selected\";\nvar EXPAND_EVENT_NAMESPACE = \"dxTreeView_expand\";\nvar DATA_ITEM_ID = \"data-item-id\";\n\nvar TreeViewBase = _ui2.default.inherit({\n  _supportedKeys: function _supportedKeys(e) {\n    var _this = this;\n\n    var click = function click(e) {\n      var $itemElement = (0, _renderer2.default)(_this.option(\"focusedElement\"));\n\n      if (!$itemElement.length) {\n        return;\n      }\n\n      e.target = $itemElement;\n      e.currentTarget = $itemElement;\n\n      _this._itemClickHandler(e, $itemElement.children(\".\" + ITEM_CLASS));\n\n      var expandEventName = _this._getEventNameByOption(_this.option(\"expandEvent\"));\n\n      var expandByClick = expandEventName === (0, _utils.addNamespace)(_click2.default.name, EXPAND_EVENT_NAMESPACE);\n\n      if (expandByClick) {\n        _this._expandEventHandler(e);\n      }\n    };\n\n    var select = function select(e) {\n      e.preventDefault();\n\n      _this._changeCheckBoxState((0, _renderer2.default)(_this.option(\"focusedElement\")));\n    };\n\n    var toggleExpandedNestedItems = function toggleExpandedNestedItems(state, e) {\n      if (!this.option(\"expandAllEnabled\")) {\n        return;\n      }\n\n      e.preventDefault();\n      var $rootElement = (0, _renderer2.default)(this.option(\"focusedElement\"));\n\n      if (!$rootElement.length) {\n        return;\n      }\n\n      var rootItem = this._getItemData($rootElement.find(\".\".concat(ITEM_CLASS)));\n\n      this._toggleExpandedNestedItems([rootItem], state);\n    };\n\n    return (0, _extend.extend)(this.callBase(), {\n      enter: this._showCheckboxes() ? select : click,\n      space: this._showCheckboxes() ? select : click,\n      asterisk: toggleExpandedNestedItems.bind(this, true),\n      minus: toggleExpandedNestedItems.bind(this, false)\n    });\n  },\n  _changeCheckBoxState: function _changeCheckBoxState($element) {\n    var checkboxInstance = this._getCheckBoxInstance($element);\n\n    var currentState = checkboxInstance.option(\"value\");\n\n    if (!checkboxInstance.option(\"disabled\")) {\n      this._updateItemSelection(!currentState, $element.find(\".\" + ITEM_CLASS).get(0), true, $element);\n    }\n  },\n  _toggleExpandedNestedItems: function _toggleExpandedNestedItems(items, state) {\n    if (!items) {\n      return;\n    }\n\n    for (var i = 0, len = items.length; i < len; i++) {\n      var item = items[i];\n\n      var node = this._dataAdapter.getNodeByItem(item);\n\n      this._toggleExpandedState(node, state);\n\n      this._toggleExpandedNestedItems(item.items, state);\n    }\n  },\n  _getNodeElement: function _getNodeElement(node, cache) {\n    var key = this._encodeString(node.internalFields.key);\n\n    if (cache) {\n      if (!cache.$nodeByKey) {\n        cache.$nodeByKey = {};\n        this.$element().find(\".\".concat(NODE_CLASS)).each(function () {\n          var $node = (0, _renderer2.default)(this);\n          var key = $node.attr(DATA_ITEM_ID);\n          cache.$nodeByKey[key] = $node;\n        });\n      }\n\n      return cache.$nodeByKey[key] || (0, _renderer2.default)();\n    }\n\n    var element = this.$element().get(0).querySelector(\"[\".concat(DATA_ITEM_ID, '=\"').concat(key, '\"]'));\n    return (0, _renderer2.default)(element);\n  },\n  _activeStateUnit: \".\" + ITEM_CLASS,\n  _widgetClass: function _widgetClass() {\n    return WIDGET_CLASS;\n  },\n  _getDefaultOptions: function _getDefaultOptions() {\n    return (0, _extend.extend)(this.callBase(), {\n      animationEnabled: true,\n      dataStructure: \"tree\",\n      deferRendering: true,\n      expandAllEnabled: false,\n      hasItemsExpr: \"hasItems\",\n      selectNodesRecursive: true,\n      expandNodesRecursive: true,\n      showCheckBoxesMode: \"none\",\n      selectAllText: _message2.default.format(\"dxList-selectAll\"),\n      onItemSelectionChanged: null,\n      onItemExpanded: null,\n      onItemCollapsed: null,\n      scrollDirection: \"vertical\",\n      virtualModeEnabled: false,\n      rootValue: 0,\n      focusStateEnabled: false,\n      selectionMode: \"multiple\",\n      expandEvent: \"dblclick\",\n      selectByClick: false,\n      createChildren: null,\n      onSelectAllValueChanged: null\n    });\n  },\n  _initSelectedItems: _common2.default.noop,\n  _syncSelectionOptions: _common2.default.asyncNoop,\n  _fireSelectionChanged: function _fireSelectionChanged() {\n    var selectionChangePromise = this._selectionChangePromise;\n    (0, _deferred.when)(selectionChangePromise).done(function () {\n      this._createActionByOption(\"onSelectionChanged\", {\n        excludeValidators: [\"disabled\", \"readOnly\"]\n      })();\n    }.bind(this));\n  },\n  _createSelectAllValueChangedAction: function _createSelectAllValueChangedAction() {\n    this._selectAllValueChangedAction = this._createActionByOption(\"onSelectAllValueChanged\", {\n      excludeValidators: [\"disabled\", \"readOnly\"]\n    });\n  },\n  _fireSelectAllValueChanged: function _fireSelectAllValueChanged(value) {\n    this._selectAllValueChangedAction({\n      value: value\n    });\n  },\n  _checkBoxModeChange: function _checkBoxModeChange(value, previousValue) {\n    if (\"none\" === previousValue || \"none\" === value) {\n      this.repaint();\n      return;\n    }\n\n    var selectAllExists = this._$selectAllItem && this._$selectAllItem.length;\n\n    switch (value) {\n      case \"selectAll\":\n        !selectAllExists && this._renderSelectAllItem();\n        break;\n\n      case \"normal\":\n        if (selectAllExists) {\n          this._$selectAllItem.remove();\n\n          delete this._$selectAllItem;\n        }\n\n    }\n  },\n  _removeSelection: function _removeSelection() {\n    var that = this;\n    (0, _iterator.each)(this._dataAdapter.getFullData(), function (_, node) {\n      if (!that._hasChildren(node)) {\n        return;\n      }\n\n      that._dataAdapter.toggleSelection(node.internalFields.key, false, true);\n    });\n  },\n  _optionChanged: function _optionChanged(args) {\n    var name = args.name,\n        value = args.value,\n        previousValue = args.previousValue;\n\n    switch (name) {\n      case \"selectAllText\":\n        if (this._$selectAllItem) {\n          this._$selectAllItem.dxCheckBox(\"instance\").option(\"text\", value);\n        }\n\n        break;\n\n      case \"showCheckBoxesMode\":\n        this._checkBoxModeChange(value, previousValue);\n\n        break;\n\n      case \"scrollDirection\":\n        this._scrollableContainer.option(\"direction\", value);\n\n        break;\n\n      case \"items\":\n        delete this._$selectAllItem;\n        this.callBase(args);\n        break;\n\n      case \"dataSource\":\n        this.callBase(args);\n\n        this._initDataAdapter();\n\n        this._filter = {};\n        break;\n\n      case \"hasItemsExpr\":\n        this._initAccessors();\n\n        this.repaint();\n        break;\n\n      case \"expandEvent\":\n        this._initExpandEvent();\n\n        break;\n\n      case \"deferRendering\":\n      case \"dataStructure\":\n      case \"rootValue\":\n      case \"createChildren\":\n      case \"expandNodesRecursive\":\n      case \"onItemSelectionChanged\":\n      case \"onItemExpanded\":\n      case \"onItemCollapsed\":\n      case \"expandAllEnabled\":\n      case \"animationEnabled\":\n      case \"virtualModeEnabled\":\n      case \"selectByClick\":\n        break;\n\n      case \"selectionMode\":\n        this._initDataAdapter();\n\n        this.callBase(args);\n        break;\n\n      case \"onSelectAllValueChanged\":\n        this._createSelectAllValueChangedAction();\n\n        break;\n\n      case \"selectNodesRecursive\":\n        this._dataAdapter.setOption(\"recursiveSelection\", args.value);\n\n        this.repaint();\n        break;\n\n      default:\n        this.callBase(args);\n    }\n  },\n  _initDataSource: function _initDataSource() {\n    if (this._useCustomChildrenLoader()) {\n      this._loadChildrenByCustomLoader(null).done(function (newItems) {\n        if (newItems && newItems.length) {\n          this.option(\"items\", newItems);\n        }\n      }.bind(this));\n    } else {\n      this.callBase();\n      this._isVirtualMode() && this._initVirtualMode();\n    }\n  },\n  _initVirtualMode: function _initVirtualMode() {\n    var filter = this._filter;\n\n    if (!filter.custom) {\n      filter.custom = this._dataSource.filter();\n    }\n\n    if (!filter.internal) {\n      filter.internal = [this.option(\"parentIdExpr\"), this.option(\"rootValue\")];\n    }\n  },\n  _useCustomChildrenLoader: function _useCustomChildrenLoader() {\n    return (0, _type.isFunction)(this.option(\"createChildren\")) && this._isDataStructurePlain();\n  },\n  _loadChildrenByCustomLoader: function _loadChildrenByCustomLoader(parentNode) {\n    var invocationResult = this.option(\"createChildren\").call(this, parentNode);\n\n    if (Array.isArray(invocationResult)) {\n      return new _deferred.Deferred().resolve(invocationResult).promise();\n    }\n\n    if (invocationResult && (0, _type.isFunction)(invocationResult.then)) {\n      return (0, _deferred.fromPromise)(invocationResult);\n    }\n\n    return new _deferred.Deferred().resolve([]).promise();\n  },\n  _combineFilter: function _combineFilter() {\n    if (!this._filter.custom || !this._filter.custom.length) {\n      return this._filter.internal;\n    }\n\n    return [this._filter.custom, this._filter.internal];\n  },\n  _dataSourceLoadErrorHandler: function _dataSourceLoadErrorHandler() {\n    this._renderEmptyMessage();\n  },\n  _init: function _init() {\n    this._filter = {};\n    this.callBase();\n\n    this._initStoreChangeHandlers();\n  },\n  _dataSourceChangedHandler: function _dataSourceChangedHandler(newItems) {\n    var items = this.option(\"items\");\n\n    if (this._initialized && this._isVirtualMode() && items.length) {\n      return;\n    }\n\n    this.option(\"items\", newItems);\n  },\n  _removeTreeViewLoadIndicator: function _removeTreeViewLoadIndicator() {\n    if (!this._treeViewLoadIndicator) {\n      return;\n    }\n\n    this._treeViewLoadIndicator.remove();\n\n    this._treeViewLoadIndicator = null;\n  },\n  _createTreeViewLoadIndicator: function _createTreeViewLoadIndicator() {\n    this._treeViewLoadIndicator = (0, _renderer2.default)(\"<div>\").addClass(LOAD_INDICATOR_CLASS);\n\n    this._createComponent(this._treeViewLoadIndicator, _load_indicator2.default, {});\n\n    return this._treeViewLoadIndicator;\n  },\n  _dataSourceLoadingChangedHandler: function _dataSourceLoadingChangedHandler(isLoading) {\n    var resultFilter;\n\n    if (this._isVirtualMode()) {\n      resultFilter = this._combineFilter();\n\n      this._dataSource.filter(resultFilter);\n    }\n\n    if (isLoading && !this._dataSource.isLoaded()) {\n      this.option(\"items\", []);\n      var $wrapper = (0, _renderer2.default)(\"<div>\").addClass(LOAD_INDICATOR_WRAPPER_CLASS);\n\n      this._createTreeViewLoadIndicator().appendTo($wrapper);\n\n      this.itemsContainer().append($wrapper);\n\n      if (this._isVirtualMode() && this._dataSource.filter() !== resultFilter) {\n        this._dataSource.filter([]);\n      }\n    } else {\n      this._removeTreeViewLoadIndicator();\n    }\n  },\n  _initStoreChangeHandlers: function _initStoreChangeHandlers() {\n    var _this2 = this;\n\n    if (\"plain\" !== this.option(\"dataStructure\")) {\n      return;\n    }\n\n    this._dataSource && this._dataSource.store().on(\"inserted\", function (newItem) {\n      _this2.option().items = _this2.option(\"items\").concat(newItem);\n\n      _this2._dataAdapter.addItem(newItem);\n\n      if (!_this2._dataAdapter.isFiltered(newItem)) {\n        return;\n      }\n\n      _this2._updateLevel(_this2._parentIdGetter(newItem));\n    }).on(\"removed\", function (removedKey) {\n      var node = _this2._dataAdapter.getNodeByKey(removedKey);\n\n      _this2.option(\"items\")[_this2._dataAdapter.getIndexByKey(node.internalFields.key)] = 0;\n\n      _this2._markChildrenItemsToRemove(node);\n\n      _this2._removeItems();\n\n      _this2._dataAdapter.removeItem(removedKey);\n\n      _this2._updateLevel(_this2._parentIdGetter(node));\n    });\n  },\n  _markChildrenItemsToRemove: function _markChildrenItemsToRemove(node) {\n    var _this3 = this;\n\n    var keys = node.internalFields.childrenKeys;\n    (0, _iterator.each)(keys, function (_, key) {\n      _this3.option(\"items\")[_this3._dataAdapter.getIndexByKey(key)] = 0;\n\n      _this3._markChildrenItemsToRemove(_this3._dataAdapter.getNodeByKey(key));\n    });\n  },\n  _removeItems: function _removeItems() {\n    var _this4 = this;\n\n    var items = (0, _extend.extend)(true, [], this.option(\"items\"));\n    var counter = 0;\n    (0, _iterator.each)(items, function (index, item) {\n      if (!item) {\n        _this4.option(\"items\").splice(index - counter, 1);\n\n        counter++;\n      }\n    });\n  },\n  _updateLevel: function _updateLevel(parentId) {\n    var $container = this._getContainerByParentKey(parentId);\n\n    this._renderItems($container, this._dataAdapter.getChildrenNodes(parentId));\n  },\n  _getOldContainer: function _getOldContainer($itemElement) {\n    if ($itemElement.length) {\n      return $itemElement.children(\".\".concat(NODE_CONTAINER_CLASS));\n    }\n\n    if (this._scrollableContainer) {\n      return this._scrollableContainer.$content().children();\n    }\n\n    return (0, _renderer2.default)();\n  },\n  _getContainerByParentKey: function _getContainerByParentKey(parentId) {\n    var node = this._dataAdapter.getNodeByKey(parentId);\n\n    var $itemElement = node ? this._getNodeElement(node) : [];\n\n    this._getOldContainer($itemElement).remove();\n\n    var $container = this._renderNodeContainer($itemElement);\n\n    if (this._isRootLevel(parentId)) {\n      if (!this._scrollableContainer) {\n        this._renderScrollableContainer();\n      }\n\n      this._scrollableContainer.$content().append($container);\n    }\n\n    return $container;\n  },\n  _isRootLevel: function _isRootLevel(parentId) {\n    return parentId === this.option(\"rootValue\");\n  },\n  _getAccessors: function _getAccessors() {\n    var accessors = this.callBase();\n    accessors.push(\"hasItems\");\n    return accessors;\n  },\n  _getDataAdapterOptions: function _getDataAdapterOptions() {\n    return {\n      rootValue: this.option(\"rootValue\"),\n      multipleSelection: !this._isSingleSelection(),\n      recursiveSelection: this._isRecursiveSelection(),\n      recursiveExpansion: this.option(\"expandNodesRecursive\"),\n      selectionRequired: this.option(\"selectionRequired\"),\n      dataType: this.option(\"dataStructure\"),\n      sort: this._dataSource && this._dataSource.sort()\n    };\n  },\n  _initMarkup: function _initMarkup() {\n    this._renderScrollableContainer();\n\n    this._renderEmptyMessage(this._dataAdapter.getRootNodes());\n\n    this.callBase();\n    this.setAria(\"role\", \"tree\");\n  },\n  _renderContentImpl: function _renderContentImpl() {\n    var $nodeContainer = this._renderNodeContainer();\n\n    this._scrollableContainer.$content().append($nodeContainer);\n\n    if (!this.option(\"items\") || !this.option(\"items\").length) {\n      return;\n    }\n\n    this._renderItems($nodeContainer, this._dataAdapter.getRootNodes());\n\n    this._initExpandEvent();\n\n    if (this._selectAllEnabled()) {\n      this._createSelectAllValueChangedAction();\n\n      this._renderSelectAllItem($nodeContainer);\n    }\n  },\n  _isVirtualMode: function _isVirtualMode() {\n    return this.option(\"virtualModeEnabled\") && this._isDataStructurePlain() && !!this.option(\"dataSource\");\n  },\n  _isDataStructurePlain: function _isDataStructurePlain() {\n    return \"plain\" === this.option(\"dataStructure\");\n  },\n  _fireContentReadyAction: function _fireContentReadyAction() {\n    var dataSource = this.getDataSource();\n    var skipContentReadyAction = dataSource && !dataSource.isLoaded();\n\n    if (!skipContentReadyAction) {\n      this.callBase();\n    }\n\n    if (this._scrollableContainer && _window2.default.hasWindow()) {\n      this._scrollableContainer.update();\n    }\n  },\n  _renderScrollableContainer: function _renderScrollableContainer() {\n    this._scrollableContainer = this._createComponent((0, _renderer2.default)(\"<div>\").appendTo(this.$element()), _ui4.default, {\n      direction: this.option(\"scrollDirection\"),\n      useKeyboard: false\n    });\n  },\n  _renderNodeContainer: function _renderNodeContainer($parent) {\n    var $container = (0, _renderer2.default)(\"<ul>\").addClass(NODE_CONTAINER_CLASS);\n    this.setAria(\"role\", \"group\", $container);\n\n    if ($parent && $parent.length) {\n      var itemData = this._getItemData($parent.children(\".\" + ITEM_CLASS));\n\n      if (this._expandedGetter(itemData)) {\n        $container.addClass(OPENED_NODE_CONTAINER_CLASS);\n      }\n\n      $container.appendTo($parent);\n    }\n\n    return $container;\n  },\n  _createDOMElement: function _createDOMElement($nodeContainer, node) {\n    var $node = (0, _renderer2.default)(\"<li>\").addClass(NODE_CLASS).attr(DATA_ITEM_ID, this._encodeString(node.internalFields.key)).prependTo($nodeContainer);\n    this.setAria({\n      role: \"treeitem\",\n      label: this._displayGetter(node.internalFields.item) || \"\",\n      expanded: node.internalFields.expanded || false,\n      level: this._getLevel($nodeContainer)\n    }, $node);\n    return $node;\n  },\n  _getLevel: function _getLevel($nodeContainer) {\n    var parent = $nodeContainer.parent();\n    return parent.hasClass(\"dx-scrollable-content\") ? 1 : parseInt(parent.attr(\"aria-level\")) + 1;\n  },\n  _showCheckboxes: function _showCheckboxes() {\n    return \"none\" !== this.option(\"showCheckBoxesMode\");\n  },\n  _selectAllEnabled: function _selectAllEnabled() {\n    return \"selectAll\" === this.option(\"showCheckBoxesMode\") && !this._isSingleSelection();\n  },\n  _renderItems: function _renderItems($nodeContainer, nodes) {\n    var length = nodes.length - 1;\n\n    for (var i = length; i >= 0; i--) {\n      this._renderItem(i, nodes[i], $nodeContainer);\n    }\n\n    this._renderedItemsCount += nodes.length;\n  },\n  _renderItem: function _renderItem(nodeIndex, node, $nodeContainer) {\n    var $node = this._createDOMElement($nodeContainer, node);\n\n    var nodeData = node.internalFields;\n\n    var showCheckBox = this._showCheckboxes();\n\n    $node.addClass(showCheckBox ? ITEM_WITH_CHECKBOX_CLASS : ITEM_WITHOUT_CHECKBOX_CLASS);\n    showCheckBox && this._renderCheckBox($node, node);\n    this.setAria(\"selected\", nodeData.selected, $node);\n\n    this._toggleSelectedClass($node, nodeData.selected);\n\n    this.callBase(this._renderedItemsCount + nodeIndex, nodeData.item, $node);\n\n    if (false !== nodeData.item.visible) {\n      this._renderChildren($node, node);\n    }\n  },\n  _setAriaSelected: function _setAriaSelected() {},\n  _renderChildren: function _renderChildren($node, node) {\n    var _this5 = this;\n\n    if (!this._hasChildren(node)) {\n      this._addLeafClass($node);\n\n      return;\n    }\n\n    this._renderToggleItemVisibilityIcon($node, node);\n\n    if (this.option(\"deferRendering\") && !node.internalFields.expanded) {\n      return;\n    }\n\n    this._loadSublevel(node).done(function (childNodes) {\n      _this5._renderSublevel($node, _this5._getActualNode(node), childNodes);\n    });\n  },\n  _getActualNode: function _getActualNode(cachedNode) {\n    return this._dataAdapter.getNodeByKey(cachedNode.internalFields.key);\n  },\n  _hasChildren: function _hasChildren(node) {\n    if (this._isVirtualMode() || this._useCustomChildrenLoader()) {\n      return false !== this._hasItemsGetter(node.internalFields.item);\n    }\n\n    return this.callBase(node);\n  },\n  _loadSublevel: function _loadSublevel(node) {\n    var _this6 = this;\n\n    var deferred = new _deferred.Deferred();\n\n    var childrenNodes = this._getChildNodes(node);\n\n    if (childrenNodes.length) {\n      deferred.resolve(childrenNodes);\n    } else {\n      this._loadNestedItems(node).done(function (items) {\n        deferred.resolve(_this6._dataAdapter.getNodesByItems(items));\n      });\n    }\n\n    return deferred.promise();\n  },\n  _renderSublevel: function _renderSublevel($node, node, childNodes) {\n    var $nestedNodeContainer = this._renderNodeContainer($node, node);\n\n    var childNodesByChildrenKeys = childNodes.filter(function (childNode) {\n      return node.internalFields.childrenKeys.indexOf(childNode.internalFields.key) !== -1;\n    });\n\n    this._renderItems($nestedNodeContainer, childNodesByChildrenKeys);\n\n    if (childNodesByChildrenKeys.length && !node.internalFields.selected) {\n      var firstChild = childNodesByChildrenKeys[0];\n\n      this._updateParentsState(firstChild, this._getNodeElement(firstChild));\n    }\n\n    this._normalizeIconState($node, childNodesByChildrenKeys.length);\n\n    if (node.internalFields.expanded) {\n      $nestedNodeContainer.addClass(OPENED_NODE_CONTAINER_CLASS);\n    }\n  },\n  _executeItemRenderAction: function _executeItemRenderAction(itemIndex, itemData, itemElement) {\n    var node = this._getNode(itemElement);\n\n    this._getItemRenderAction()({\n      itemElement: itemElement,\n      itemIndex: itemIndex,\n      itemData: itemData,\n      node: this._dataAdapter.getPublicNode(node)\n    });\n  },\n  _addLeafClass: function _addLeafClass($node) {\n    $node.addClass(IS_LEAF);\n  },\n  _expandEventHandler: function _expandEventHandler(e) {\n    var $nodeElement = (0, _renderer2.default)(e.currentTarget.parentNode);\n\n    if (!$nodeElement.hasClass(IS_LEAF)) {\n      this._toggleExpandedState(e.currentTarget, void 0, e);\n    }\n  },\n  _initExpandEvent: function _initExpandEvent() {\n    var expandedEventName = this._getEventNameByOption(this.option(\"expandEvent\"));\n\n    var $itemsContainer = this._itemContainer();\n\n    var itemSelector = this._itemSelector();\n\n    (0, _events_engine.off)($itemsContainer, \".\" + EXPAND_EVENT_NAMESPACE, itemSelector);\n    (0, _events_engine.on)($itemsContainer, expandedEventName, itemSelector, this._expandEventHandler.bind(this));\n  },\n  _getEventNameByOption: function _getEventNameByOption(name) {\n    var event = \"click\" === name ? _click2.default : _double_click2.default;\n    return (0, _utils.addNamespace)(event.name, EXPAND_EVENT_NAMESPACE);\n  },\n  _getNode: function _getNode(identifier) {\n    if (!(0, _type.isDefined)(identifier)) {\n      return null;\n    }\n\n    if (identifier.internalFields) {\n      return identifier;\n    }\n\n    if ((0, _type.isPrimitive)(identifier)) {\n      return this._dataAdapter.getNodeByKey(identifier);\n    }\n\n    var itemElement = (0, _renderer2.default)(identifier).get(0);\n\n    if (!itemElement) {\n      return null;\n    }\n\n    if ((0, _dom_adapter.isElementNode)(itemElement)) {\n      return this._getNodeByElement(itemElement);\n    }\n\n    return this._dataAdapter.getNodeByItem(itemElement);\n  },\n  _getNodeByElement: function _getNodeByElement(itemElement) {\n    var $node = (0, _renderer2.default)(itemElement).closest(\".\" + NODE_CLASS);\n\n    var key = this._decodeString($node.attr(DATA_ITEM_ID));\n\n    return this._dataAdapter.getNodeByKey(key);\n  },\n  _toggleExpandedState: function _toggleExpandedState(itemElement, state, e) {\n    var node = this._getNode(itemElement);\n\n    var currentState = node.internalFields.expanded;\n\n    if (node.internalFields.disabled || currentState === state) {\n      return;\n    }\n\n    if (this._hasChildren(node)) {\n      var $node = this._getNodeElement(node);\n\n      if ($node.find(\".\".concat(NODE_LOAD_INDICATOR_CLASS, \":not(.\").concat(INVISIBLE_STATE_CLASS, \")\")).length) {\n        return;\n      }\n\n      this._createLoadIndicator($node);\n    }\n\n    if (!(0, _type.isDefined)(state)) {\n      state = !currentState;\n    }\n\n    this._dataAdapter.toggleExpansion(node.internalFields.key, state);\n\n    this._updateExpandedItemsUI(node, state, e);\n  },\n  _createLoadIndicator: function _createLoadIndicator($node) {\n    var $icon = $node.children(\".\" + TOGGLE_ITEM_VISIBILITY_CLASS);\n    var $nodeContainer = $node.children(\".\".concat(NODE_CONTAINER_CLASS));\n\n    if ($icon.hasClass(TOGGLE_ITEM_VISIBILITY_OPENED_CLASS) || $nodeContainer.not(\":empty\").length) {\n      return;\n    }\n\n    this._createComponent((0, _renderer2.default)(\"<div>\").addClass(NODE_LOAD_INDICATOR_CLASS), _load_indicator2.default, {}).$element().appendTo($node);\n\n    $icon.hide();\n  },\n  _renderToggleItemVisibilityIcon: function _renderToggleItemVisibilityIcon($node, node) {\n    var $icon = (0, _renderer2.default)(\"<div>\").addClass(TOGGLE_ITEM_VISIBILITY_CLASS).appendTo($node);\n\n    if (node.internalFields.expanded) {\n      $icon.addClass(TOGGLE_ITEM_VISIBILITY_OPENED_CLASS);\n      $node.parent().addClass(OPENED_NODE_CONTAINER_CLASS);\n    }\n\n    if (node.internalFields.disabled) {\n      $icon.addClass(DISABLED_STATE_CLASS);\n    }\n\n    this._renderToggleItemVisibilityIconClick($icon, node);\n  },\n  _renderToggleItemVisibilityIconClick: function _renderToggleItemVisibilityIconClick($icon, node) {\n    var _this7 = this;\n\n    var eventName = (0, _utils.addNamespace)(_click2.default.name, this.NAME);\n    (0, _events_engine.off)($icon, eventName);\n    (0, _events_engine.on)($icon, eventName, function (e) {\n      _this7._toggleExpandedState(node.internalFields.key, void 0, e);\n    });\n  },\n  _updateExpandedItemsUI: function _updateExpandedItemsUI(node, state, e) {\n    var $node = this._getNodeElement(node);\n\n    var isHiddenNode = !$node.length || state && $node.is(\":hidden\");\n\n    if (this.option(\"expandNodesRecursive\") && isHiddenNode) {\n      var parentNode = this._getNode(node.internalFields.parentKey);\n\n      if (parentNode) {\n        this._updateExpandedItemsUI(parentNode, state, e);\n      }\n    }\n\n    var $icon = $node.children(\".\" + TOGGLE_ITEM_VISIBILITY_CLASS);\n    var $nodeContainer = $node.children(\".\".concat(NODE_CONTAINER_CLASS));\n    $icon.toggleClass(TOGGLE_ITEM_VISIBILITY_OPENED_CLASS, state);\n    var nodeContainerExists = $nodeContainer.length > 0;\n\n    if (!state || nodeContainerExists && !$nodeContainer.is(\":empty\")) {\n      this._updateExpandedItem(node, state, e);\n\n      return;\n    }\n\n    if (this._isVirtualMode() || this._useCustomChildrenLoader()) {\n      this._loadNestedItemsWithUpdate(node, state, e);\n\n      return;\n    }\n\n    this._renderSublevel($node, node, this._getChildNodes(node));\n\n    this._fireContentReadyAction();\n\n    this._updateExpandedItem(node, state, e);\n  },\n  _loadNestedItemsWithUpdate: function _loadNestedItemsWithUpdate(node, state, e) {\n    var _this8 = this;\n\n    var $node = this._getNodeElement(node);\n\n    this._loadNestedItems(node).done(function (items) {\n      var actualNodeData = _this8._getActualNode(node);\n\n      _this8._renderSublevel($node, actualNodeData, _this8._dataAdapter.getNodesByItems(items));\n\n      if (!items || !items.length) {\n        return;\n      }\n\n      _this8._fireContentReadyAction();\n\n      _this8._updateExpandedItem(actualNodeData, state, e);\n    });\n  },\n  _loadNestedItems: function _loadNestedItems(node) {\n    var _this9 = this;\n\n    if (this._useCustomChildrenLoader()) {\n      var publicNode = this._dataAdapter.getPublicNode(node);\n\n      return this._loadChildrenByCustomLoader(publicNode).done(function (newItems) {\n        if (!_this9._areNodesExists(newItems)) {\n          _this9._appendItems(newItems);\n        }\n      });\n    }\n\n    if (!this._isVirtualMode()) {\n      return new _deferred.Deferred().resolve([]).promise();\n    }\n\n    this._filter.internal = [this.option(\"parentIdExpr\"), node.internalFields.key];\n\n    this._dataSource.filter(this._combineFilter());\n\n    return this._dataSource.load().done(function (newItems) {\n      if (!_this9._areNodesExists(newItems)) {\n        _this9._appendItems(newItems);\n      }\n    });\n  },\n  _areNodesExists: function _areNodesExists(newItems, items) {\n    var keyOfRootItem = this.keyOf(newItems[0]);\n\n    var fullData = this._dataAdapter.getFullData();\n\n    return !!this._dataAdapter.getNodeByKey(keyOfRootItem, fullData);\n  },\n  _appendItems: function _appendItems(newItems) {\n    this.option().items = this.option(\"items\").concat(newItems);\n\n    this._initDataAdapter();\n  },\n  _updateExpandedItem: function _updateExpandedItem(node, state, e) {\n    this._animateNodeContainer(node, state, e);\n  },\n  _animateNodeContainer: function _animateNodeContainer(node, state, e) {\n    var $node = this._getNodeElement(node);\n\n    var $nodeContainer = $node.children(\".\".concat(NODE_CONTAINER_CLASS));\n    var nodeHeight;\n    $nodeContainer.addClass(OPENED_NODE_CONTAINER_CLASS);\n    nodeHeight = $nodeContainer.height();\n\n    _fx2.default.stop($nodeContainer, true);\n\n    _fx2.default.animate($nodeContainer, {\n      type: \"custom\",\n      duration: this.option(\"animationEnabled\") ? 400 : 0,\n      from: {\n        maxHeight: state ? 0 : nodeHeight\n      },\n      to: {\n        maxHeight: state ? nodeHeight : 0\n      },\n      complete: function () {\n        $nodeContainer.css(\"maxHeight\", \"none\");\n        $nodeContainer.toggleClass(OPENED_NODE_CONTAINER_CLASS, state);\n        this.setAria(\"expanded\", state, $node);\n\n        this._scrollableContainer.update();\n\n        this._fireExpandedStateUpdatedEvent(state, node, e);\n      }.bind(this)\n    });\n  },\n  _fireExpandedStateUpdatedEvent: function _fireExpandedStateUpdatedEvent(isExpanded, node, e) {\n    if (!this._hasChildren(node)) {\n      return;\n    }\n\n    var optionName = isExpanded ? \"onItemExpanded\" : \"onItemCollapsed\";\n\n    if ((0, _type.isDefined)(e)) {\n      this._itemDXEventHandler(e, optionName, {\n        node: this._dataAdapter.getPublicNode(node)\n      });\n    } else {\n      var target = this._getNodeElement(node);\n\n      this._itemEventHandler(target, optionName, {\n        event: e,\n        node: this._dataAdapter.getPublicNode(node)\n      });\n    }\n  },\n  _normalizeIconState: function _normalizeIconState($node, hasNewItems) {\n    var $loadIndicator = $node.find(\".dx-loadindicator\");\n    $loadIndicator.length && _load_indicator2.default.getInstance($loadIndicator).option(\"visible\", false);\n\n    if (hasNewItems) {\n      var $icon = $node.find(\".\" + TOGGLE_ITEM_VISIBILITY_CLASS);\n      $icon.show();\n      return;\n    }\n\n    $node.find(\".\" + TOGGLE_ITEM_VISIBILITY_CLASS).removeClass(TOGGLE_ITEM_VISIBILITY_CLASS);\n    $node.addClass(IS_LEAF);\n  },\n  _emptyMessageContainer: function _emptyMessageContainer() {\n    return this._scrollableContainer ? this._scrollableContainer.content() : this.callBase();\n  },\n  _renderContent: function _renderContent() {\n    var items = this.option(\"items\");\n\n    if (items && items.length) {\n      this._contentAlreadyRendered = true;\n    }\n\n    this.callBase();\n  },\n  _renderSelectAllItem: function _renderSelectAllItem($container) {\n    $container = $container || this.$element().find(\".\".concat(NODE_CONTAINER_CLASS)).first();\n    this._$selectAllItem = (0, _renderer2.default)(\"<div>\").addClass(SELECT_ALL_ITEM_CLASS);\n\n    var value = this._dataAdapter.isAllSelected();\n\n    this._createComponent(this._$selectAllItem, _check_box2.default, {\n      value: value,\n      text: this.option(\"selectAllText\"),\n      onValueChanged: function (args) {\n        this._toggleSelectAll(args);\n\n        this._fireSelectAllValueChanged(args.value);\n      }.bind(this)\n    });\n\n    this._toggleSelectedClass(this._$selectAllItem, value);\n\n    $container.before(this._$selectAllItem);\n  },\n  _toggleSelectAll: function _toggleSelectAll(args) {\n    this._dataAdapter.toggleSelectAll(args.value);\n\n    this._updateItemsUI();\n\n    this._fireSelectionChanged();\n  },\n  _renderCheckBox: function _renderCheckBox($node, node) {\n    var $checkbox = (0, _renderer2.default)(\"<div>\").appendTo($node);\n\n    this._createComponent($checkbox, _check_box2.default, {\n      value: node.internalFields.selected,\n      onValueChanged: this._changeCheckboxValue.bind(this),\n      focusStateEnabled: false,\n      disabled: this._disabledGetter(node)\n    });\n  },\n  _toggleSelectedClass: function _toggleSelectedClass($node, value) {\n    $node.toggleClass(SELECTED_ITEM_CLASS, !!value);\n  },\n  _toggleNodeDisabledState: function _toggleNodeDisabledState(node, state) {\n    var $node = this._getNodeElement(node);\n\n    var $item = $node.find(\".\" + ITEM_CLASS).eq(0);\n\n    this._dataAdapter.toggleNodeDisabledState(node.internalFields.key, state);\n\n    $item.toggleClass(DISABLED_STATE_CLASS, !!state);\n\n    if (this._showCheckboxes()) {\n      var checkbox = this._getCheckBoxInstance($node);\n\n      checkbox.option(\"disabled\", !!state);\n    }\n  },\n  _itemOptionChanged: function _itemOptionChanged(item, property, value) {\n    var node = this._dataAdapter.getNodeByItem(item);\n\n    if (property === this.option(\"disabledExpr\")) {\n      this._toggleNodeDisabledState(node, value);\n    }\n  },\n  _changeCheckboxValue: function _changeCheckboxValue(e) {\n    var $node = (0, _renderer2.default)(e.element).parent(\".\" + NODE_CLASS);\n    var $item = $node.children(\".\" + ITEM_CLASS);\n\n    var item = this._getItemData($item);\n\n    var node = this._getNodeByElement($item);\n\n    var value = e.value;\n\n    if (node && node.internalFields.selected === value) {\n      return;\n    }\n\n    this._updateItemSelection(value, item, e.event);\n  },\n  _isSingleSelection: function _isSingleSelection() {\n    return \"single\" === this.option(\"selectionMode\");\n  },\n  _isRecursiveSelection: function _isRecursiveSelection() {\n    return this.option(\"selectNodesRecursive\") && \"single\" !== this.option(\"selectionMode\");\n  },\n  _isLastSelectedBranch: function _isLastSelectedBranch(publicNode, selectedNodesKeys, deep) {\n    var keyIndex = selectedNodesKeys.indexOf(publicNode.key);\n\n    if (keyIndex >= 0) {\n      selectedNodesKeys.splice(keyIndex, 1);\n    }\n\n    if (deep) {\n      (0, _iterator.each)(publicNode.children, function (_, childNode) {\n        this._isLastSelectedBranch(childNode, selectedNodesKeys, true);\n      }.bind(this));\n    }\n\n    if (publicNode.parent) {\n      this._isLastSelectedBranch(publicNode.parent, selectedNodesKeys);\n    }\n\n    return 0 === selectedNodesKeys.length;\n  },\n  _isLastRequired: function _isLastRequired(node) {\n    var selectionRequired = this.option(\"selectionRequired\");\n\n    var isSingleMode = this._isSingleSelection();\n\n    var selectedNodesKeys = this.getSelectedNodesKeys();\n\n    if (!selectionRequired) {\n      return;\n    }\n\n    if (isSingleMode) {\n      return 1 === selectedNodesKeys.length;\n    } else {\n      return this._isLastSelectedBranch(node.internalFields.publicNode, selectedNodesKeys.slice(), true);\n    }\n  },\n  _updateItemSelection: function _updateItemSelection(value, itemElement, dxEvent) {\n    var _this10 = this;\n\n    var node = this._getNode(itemElement);\n\n    if (!node || node.internalFields.selected === value) {\n      return;\n    }\n\n    if (!value && this._isLastRequired(node)) {\n      if (this._showCheckboxes()) {\n        var $node = this._getNodeElement(node);\n\n        var checkbox = this._getCheckBoxInstance($node);\n\n        checkbox && checkbox.option(\"value\", true);\n      }\n\n      return;\n    }\n\n    var selectedNodesKeys = this.getSelectedNodesKeys();\n\n    if (this._isSingleSelection() && value) {\n      (0, _iterator.each)(selectedNodesKeys, function (index, nodeKey) {\n        _this10.unselectItem(nodeKey);\n      });\n    }\n\n    this._dataAdapter.toggleSelection(node.internalFields.key, value);\n\n    this._updateItemsUI();\n\n    var initiator = dxEvent || this._findItemElementByItem(node.internalFields.item);\n\n    var handler = dxEvent ? this._itemDXEventHandler : this._itemEventHandler;\n    handler.call(this, initiator, \"onItemSelectionChanged\", {\n      node: this._dataAdapter.getPublicNode(node),\n      itemData: node.internalFields.item\n    });\n\n    this._fireSelectionChanged();\n  },\n  _getCheckBoxInstance: function _getCheckBoxInstance($node) {\n    return $node.children(\".dx-checkbox\").dxCheckBox(\"instance\");\n  },\n  _updateItemsUI: function _updateItemsUI() {\n    var _this11 = this;\n\n    var cache = {};\n    (0, _iterator.each)(this._dataAdapter.getData(), function (_, node) {\n      var $node = _this11._getNodeElement(node, cache);\n\n      var nodeSelection = node.internalFields.selected;\n\n      if (!$node.length) {\n        return;\n      }\n\n      _this11._toggleSelectedClass($node, nodeSelection);\n\n      _this11.setAria(\"selected\", nodeSelection, $node);\n\n      if (_this11._showCheckboxes()) {\n        var checkbox = _this11._getCheckBoxInstance($node);\n\n        checkbox.option(\"value\", nodeSelection);\n      }\n    });\n\n    if (this._selectAllEnabled()) {\n      this._$selectAllItem.dxCheckBox(\"instance\").option(\"value\", this._dataAdapter.isAllSelected());\n    }\n  },\n  _updateParentsState: function _updateParentsState(node, $node) {\n    if (!$node) {\n      return;\n    }\n\n    var parentNode = this._dataAdapter.getNodeByKey(node.internalFields.parentKey);\n\n    var $parentNode = (0, _renderer2.default)($node.parents(\".\" + NODE_CLASS)[0]);\n\n    if (this._showCheckboxes()) {\n      var parentValue = parentNode.internalFields.selected;\n\n      this._getCheckBoxInstance($parentNode).option(\"value\", parentValue);\n\n      this._toggleSelectedClass($parentNode, parentValue);\n    }\n\n    if (parentNode.internalFields.parentKey !== this.option(\"rootValue\")) {\n      this._updateParentsState(parentNode, $parentNode);\n    }\n  },\n  _itemEventHandlerImpl: function _itemEventHandlerImpl(initiator, action, actionArgs) {\n    var $itemElement = (0, _renderer2.default)(initiator).closest(\".\" + NODE_CLASS).children(\".\" + ITEM_CLASS);\n    return action((0, _extend.extend)(this._extendActionArgs($itemElement), actionArgs));\n  },\n  _itemContextMenuHandler: function _itemContextMenuHandler(e) {\n    this._createEventHandler(\"onItemContextMenu\", e);\n  },\n  _itemHoldHandler: function _itemHoldHandler(e) {\n    this._createEventHandler(\"onItemHold\", e);\n  },\n  _createEventHandler: function _createEventHandler(eventName, e) {\n    var node = this._getNodeByElement(e.currentTarget);\n\n    this._itemDXEventHandler(e, eventName, {\n      node: this._dataAdapter.getPublicNode(node)\n    });\n  },\n  _itemClass: function _itemClass() {\n    return ITEM_CLASS;\n  },\n  _itemDataKey: function _itemDataKey() {\n    return ITEM_DATA_KEY;\n  },\n  _attachClickEvent: function _attachClickEvent() {\n    var clickSelector = \".\" + this._itemClass();\n\n    var pointerDownSelector = \".\" + NODE_CLASS + \", .\" + SELECT_ALL_ITEM_CLASS;\n    var eventName = (0, _utils.addNamespace)(_click2.default.name, this.NAME);\n    var pointerDownEvent = (0, _utils.addNamespace)(_pointer.down, this.NAME);\n\n    var $itemContainer = this._itemContainer();\n\n    var that = this;\n    (0, _events_engine.off)($itemContainer, eventName, clickSelector);\n    (0, _events_engine.off)($itemContainer, pointerDownEvent, pointerDownSelector);\n    (0, _events_engine.on)($itemContainer, eventName, clickSelector, function (e) {\n      that._itemClickHandler(e, (0, _renderer2.default)(this));\n    });\n    (0, _events_engine.on)($itemContainer, pointerDownEvent, pointerDownSelector, function (e) {\n      that._itemPointerDownHandler(e);\n    });\n  },\n  _itemClickHandler: function _itemClickHandler(e, $item) {\n    var itemData = this._getItemData($item);\n\n    var node = this._getNodeByElement($item);\n\n    this._itemDXEventHandler(e, \"onItemClick\", {\n      node: this._dataAdapter.getPublicNode(node)\n    });\n\n    if (this.option(\"selectByClick\") && !e.isDefaultPrevented()) {\n      this._updateItemSelection(!node.internalFields.selected, itemData, e);\n    }\n  },\n  _updateSelectionToFirstItem: function _updateSelectionToFirstItem($items, startIndex) {\n    var itemIndex = startIndex;\n\n    while (itemIndex >= 0) {\n      var $item = (0, _renderer2.default)($items[itemIndex]);\n\n      this._updateItemSelection(true, $item.find(\".\" + ITEM_CLASS).get(0));\n\n      itemIndex--;\n    }\n  },\n  _updateSelectionToLastItem: function _updateSelectionToLastItem($items, startIndex) {\n    var length = $items.length;\n    var itemIndex = startIndex;\n\n    while (itemIndex < length) {\n      var $item = (0, _renderer2.default)($items[itemIndex]);\n\n      this._updateItemSelection(true, $item.find(\".\" + ITEM_CLASS).get(0));\n\n      itemIndex++;\n    }\n  },\n  _focusInHandler: function _focusInHandler(e) {\n    var _this12 = this;\n\n    this._updateFocusState(e, true);\n\n    if (this.option(\"focusedElement\")) {\n      clearTimeout(this._setFocusedItemTimeout);\n      this._setFocusedItemTimeout = setTimeout(function () {\n        _this12._setFocusedItem((0, _renderer2.default)(_this12.option(\"focusedElement\")));\n      });\n      return;\n    }\n\n    var $activeItem = this._getActiveItem();\n\n    this.option(\"focusedElement\", (0, _dom.getPublicElement)($activeItem.closest(\".\" + NODE_CLASS)));\n  },\n  _setFocusedItem: function _setFocusedItem($target) {\n    if (!$target || !$target.length) {\n      return;\n    }\n\n    if (!$target.children().hasClass(DISABLED_STATE_CLASS)) {\n      this.callBase($target);\n    }\n\n    this._scrollableContainer.scrollToElement($target.find(\".\" + ITEM_CLASS).first());\n  },\n  _itemPointerDownHandler: function _itemPointerDownHandler(e) {\n    if (!this.option(\"focusStateEnabled\")) {\n      return;\n    }\n\n    var $target = (0, _renderer2.default)(e.target).closest(\".\" + NODE_CLASS + \", .\" + SELECT_ALL_ITEM_CLASS);\n\n    if (!$target.length) {\n      return;\n    }\n\n    var itemElement = $target.hasClass(DISABLED_STATE_CLASS) ? null : $target;\n    this.option(\"focusedElement\", (0, _dom.getPublicElement)(itemElement));\n  },\n  _findNonDisabledNodes: function _findNonDisabledNodes($nodes) {\n    return $nodes.not(function () {\n      return (0, _renderer2.default)(this).children(\".\" + ITEM_CLASS).hasClass(DISABLED_STATE_CLASS);\n    });\n  },\n  _moveFocus: function _moveFocus(location, e) {\n    var FOCUS_UP = \"up\";\n    var FOCUS_DOWN = \"down\";\n    var FOCUS_FIRST = \"first\";\n    var FOCUS_LAST = \"last\";\n    var FOCUS_LEFT = this.option(\"rtlEnabled\") ? \"right\" : \"left\";\n    var FOCUS_RIGHT = this.option(\"rtlEnabled\") ? \"left\" : \"right\";\n    this.$element().find(\".\".concat(NODE_CONTAINER_CLASS)).each(function () {\n      _fx2.default.stop(this, true);\n    });\n\n    var $items = this._findNonDisabledNodes(this._nodeElements());\n\n    if (!$items || !$items.length) {\n      return;\n    }\n\n    switch (location) {\n      case FOCUS_UP:\n        var $prevItem = this._prevItem($items);\n\n        this.option(\"focusedElement\", (0, _dom.getPublicElement)($prevItem));\n\n        if (e.shiftKey && this._showCheckboxes()) {\n          this._updateItemSelection(true, $prevItem.find(\".\" + ITEM_CLASS).get(0));\n        }\n\n        break;\n\n      case FOCUS_DOWN:\n        var $nextItem = this._nextItem($items);\n\n        this.option(\"focusedElement\", (0, _dom.getPublicElement)($nextItem));\n\n        if (e.shiftKey && this._showCheckboxes()) {\n          this._updateItemSelection(true, $nextItem.find(\".\" + ITEM_CLASS).get(0));\n        }\n\n        break;\n\n      case FOCUS_FIRST:\n        var $firstItem = $items.first();\n\n        if (e.shiftKey && this._showCheckboxes()) {\n          this._updateSelectionToFirstItem($items, $items.index(this._prevItem($items)));\n        }\n\n        this.option(\"focusedElement\", (0, _dom.getPublicElement)($firstItem));\n        break;\n\n      case FOCUS_LAST:\n        var $lastItem = $items.last();\n\n        if (e.shiftKey && this._showCheckboxes()) {\n          this._updateSelectionToLastItem($items, $items.index(this._nextItem($items)));\n        }\n\n        this.option(\"focusedElement\", (0, _dom.getPublicElement)($lastItem));\n        break;\n\n      case FOCUS_RIGHT:\n        this._expandFocusedContainer();\n\n        break;\n\n      case FOCUS_LEFT:\n        this._collapseFocusedContainer();\n\n        break;\n\n      default:\n        this.callBase.apply(this, arguments);\n        return;\n    }\n  },\n  _nodeElements: function _nodeElements() {\n    return this.$element().find(\".\" + NODE_CLASS).not(\":hidden\");\n  },\n  _expandFocusedContainer: function _expandFocusedContainer() {\n    var $focusedNode = (0, _renderer2.default)(this.option(\"focusedElement\"));\n\n    if (!$focusedNode.length || $focusedNode.hasClass(IS_LEAF)) {\n      return;\n    }\n\n    var $node = $focusedNode.find(\".\".concat(NODE_CONTAINER_CLASS)).eq(0);\n\n    if ($node.hasClass(OPENED_NODE_CONTAINER_CLASS)) {\n      var $nextItem = this._nextItem(this._findNonDisabledNodes(this._nodeElements()));\n\n      this.option(\"focusedElement\", (0, _dom.getPublicElement)($nextItem));\n      return;\n    }\n\n    var node = this._getNodeByElement($focusedNode.children(\".\" + ITEM_CLASS));\n\n    this._toggleExpandedState(node, true);\n  },\n  _getClosestNonDisabledNode: function _getClosestNonDisabledNode($node) {\n    do {\n      $node = $node.parent().closest(\".\" + NODE_CLASS);\n    } while ($node.children(\".dx-treeview-item.dx-state-disabled\").length);\n\n    return $node;\n  },\n  _collapseFocusedContainer: function _collapseFocusedContainer() {\n    var $focusedNode = (0, _renderer2.default)(this.option(\"focusedElement\"));\n\n    if (!$focusedNode.length) {\n      return;\n    }\n\n    var nodeElement = $focusedNode.find(\".\".concat(NODE_CONTAINER_CLASS)).eq(0);\n\n    if (!$focusedNode.hasClass(IS_LEAF) && nodeElement.hasClass(OPENED_NODE_CONTAINER_CLASS)) {\n      var node = this._getNodeByElement($focusedNode.children(\".\" + ITEM_CLASS));\n\n      this._toggleExpandedState(node, false);\n    } else {\n      var collapsedNode = this._getClosestNonDisabledNode($focusedNode);\n\n      collapsedNode.length && this.option(\"focusedElement\", (0, _dom.getPublicElement)(collapsedNode));\n    }\n  },\n  _encodeString: function _encodeString(value) {\n    return (0, _type.isString)(value) ? encodeURI(value) : value;\n  },\n  _decodeString: function _decodeString(value) {\n    return (0, _type.isString)(value) ? decodeURI(value) : value;\n  },\n  updateDimensions: function updateDimensions() {\n    var _this13 = this;\n\n    var deferred = new _deferred.Deferred();\n\n    if (this._scrollableContainer) {\n      this._scrollableContainer.update().done(function () {\n        deferred.resolveWith(_this13);\n      });\n    } else {\n      deferred.resolveWith(this);\n    }\n\n    return deferred.promise();\n  },\n  selectItem: function selectItem(itemElement) {\n    this._updateItemSelection(true, itemElement);\n  },\n  unselectItem: function unselectItem(itemElement) {\n    this._updateItemSelection(false, itemElement);\n  },\n  expandItem: function expandItem(itemElement) {\n    this._toggleExpandedState(itemElement, true);\n  },\n  collapseItem: function collapseItem(itemElement) {\n    this._toggleExpandedState(itemElement, false);\n  },\n  getNodes: function getNodes() {\n    return this._dataAdapter.getTreeNodes();\n  },\n  getSelectedNodesKeys: function getSelectedNodesKeys() {\n    return this._dataAdapter.getSelectedNodesKeys();\n  },\n  selectAll: function selectAll() {\n    if (this._selectAllEnabled()) {\n      this._$selectAllItem.dxCheckBox(\"instance\").option(\"value\", true);\n    } else {\n      this._toggleSelectAll({\n        value: true\n      });\n    }\n  },\n  unselectAll: function unselectAll() {\n    if (this._selectAllEnabled()) {\n      this._$selectAllItem.dxCheckBox(\"instance\").option(\"value\", false);\n    } else {\n      this._toggleSelectAll({\n        value: false\n      });\n    }\n  },\n  expandAll: function expandAll() {\n    var dataAdapter = this._dataAdapter;\n    (0, _iterator.each)(dataAdapter.getData(), function (_, node) {\n      return dataAdapter.toggleExpansion(node.internalFields.key, true);\n    });\n    this.repaint();\n  },\n  collapseAll: function collapseAll() {\n    (0, _iterator.each)(this._dataAdapter.getExpandedNodesKeys(), function (_, key) {\n      this._toggleExpandedState(key, false);\n    }.bind(this));\n  }\n});\n\nmodule.exports = TreeViewBase;","map":{"version":3,"sources":["C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/devextreme/ui/tree_view/ui.tree_view.base.js"],"names":["_renderer","require","_renderer2","_interopRequireDefault","_dom_adapter","_events_engine","_message","_message2","_click","_click2","_common","_common2","_window","_window2","_type","_extend","_iterator","_dom","_check_box","_check_box2","_ui","_ui2","_utils","_pointer","_double_click","_double_click2","_fx","_fx2","_ui3","_ui4","_load_indicator","_load_indicator2","_deferred","obj","WIDGET_CLASS","NODE_CLASS","NODE_CONTAINER_CLASS","NODE_LOAD_INDICATOR_CLASS","OPENED_NODE_CONTAINER_CLASS","IS_LEAF","ITEM_CLASS","ITEM_WITH_CHECKBOX_CLASS","ITEM_WITHOUT_CHECKBOX_CLASS","ITEM_DATA_KEY","TOGGLE_ITEM_VISIBILITY_CLASS","LOAD_INDICATOR_CLASS","LOAD_INDICATOR_WRAPPER_CLASS","TOGGLE_ITEM_VISIBILITY_OPENED_CLASS","SELECT_ALL_ITEM_CLASS","INVISIBLE_STATE_CLASS","DISABLED_STATE_CLASS","SELECTED_ITEM_CLASS","EXPAND_EVENT_NAMESPACE","DATA_ITEM_ID","TreeViewBase","_supportedKeys","_this","click","$itemElement","e","expandEventName","expandByClick","select","toggleExpandedNestedItems","$rootElement","rootItem","enter","space","asterisk","minus","_changeCheckBoxState","checkboxInstance","currentState","$element","_toggleExpandedNestedItems","i","len","items","item","node","_getNodeElement","key","cache","$node","element","_activeStateUnit","_widgetClass","_getDefaultOptions","animationEnabled","dataStructure","deferRendering","expandAllEnabled","hasItemsExpr","selectNodesRecursive","expandNodesRecursive","showCheckBoxesMode","selectAllText","onItemSelectionChanged","onItemExpanded","onItemCollapsed","scrollDirection","virtualModeEnabled","rootValue","focusStateEnabled","selectionMode","expandEvent","selectByClick","createChildren","onSelectAllValueChanged","_initSelectedItems","_syncSelectionOptions","_fireSelectionChanged","selectionChangePromise","excludeValidators","_createSelectAllValueChangedAction","_fireSelectAllValueChanged","value","_checkBoxModeChange","selectAllExists","_removeSelection","that","_optionChanged","name","args","previousValue","_initDataSource","newItems","_initVirtualMode","filter","_useCustomChildrenLoader","_loadChildrenByCustomLoader","invocationResult","Array","_combineFilter","_dataSourceLoadErrorHandler","_init","_dataSourceChangedHandler","_removeTreeViewLoadIndicator","_createTreeViewLoadIndicator","_dataSourceLoadingChangedHandler","resultFilter","isLoading","$wrapper","_initStoreChangeHandlers","_this2","_markChildrenItemsToRemove","_this3","keys","_removeItems","_this4","counter","index","_updateLevel","$container","_getOldContainer","_getContainerByParentKey","_isRootLevel","parentId","_getAccessors","accessors","_getDataAdapterOptions","multipleSelection","recursiveSelection","recursiveExpansion","selectionRequired","dataType","sort","_initMarkup","_renderContentImpl","$nodeContainer","_isVirtualMode","_isDataStructurePlain","_fireContentReadyAction","dataSource","skipContentReadyAction","_renderScrollableContainer","direction","useKeyboard","_renderNodeContainer","$parent","itemData","_createDOMElement","role","label","expanded","level","_getLevel","parent","parseInt","_showCheckboxes","_selectAllEnabled","_renderItems","length","nodes","_renderItem","nodeData","showCheckBox","_setAriaSelected","_renderChildren","_this5","_getActualNode","cachedNode","_hasChildren","_loadSublevel","_this6","deferred","childrenNodes","_renderSublevel","$nestedNodeContainer","childNodesByChildrenKeys","childNode","firstChild","_executeItemRenderAction","itemElement","itemIndex","_addLeafClass","_expandEventHandler","$nodeElement","_initExpandEvent","expandedEventName","$itemsContainer","itemSelector","_getEventNameByOption","event","_getNode","identifier","_getNodeByElement","_toggleExpandedState","state","_createLoadIndicator","$icon","_renderToggleItemVisibilityIcon","_renderToggleItemVisibilityIconClick","_this7","eventName","_updateExpandedItemsUI","isHiddenNode","parentNode","nodeContainerExists","_loadNestedItemsWithUpdate","_this8","actualNodeData","_loadNestedItems","_this9","publicNode","_areNodesExists","keyOfRootItem","fullData","_appendItems","_updateExpandedItem","_animateNodeContainer","nodeHeight","type","duration","from","maxHeight","to","complete","_fireExpandedStateUpdatedEvent","optionName","isExpanded","target","_normalizeIconState","$loadIndicator","_emptyMessageContainer","_renderContent","_renderSelectAllItem","text","onValueChanged","_toggleSelectAll","_renderCheckBox","$checkbox","disabled","_toggleSelectedClass","_toggleNodeDisabledState","$item","checkbox","_itemOptionChanged","property","_changeCheckboxValue","_isSingleSelection","_isRecursiveSelection","_isLastSelectedBranch","keyIndex","selectedNodesKeys","_isLastRequired","isSingleMode","_updateItemSelection","_this10","initiator","dxEvent","handler","_getCheckBoxInstance","_updateItemsUI","_this11","nodeSelection","_updateParentsState","$parentNode","parentValue","_itemEventHandlerImpl","action","_itemContextMenuHandler","_itemHoldHandler","_createEventHandler","_itemClass","_itemDataKey","_attachClickEvent","clickSelector","pointerDownSelector","pointerDownEvent","$itemContainer","_itemClickHandler","_updateSelectionToFirstItem","$items","_updateSelectionToLastItem","_focusInHandler","_this12","clearTimeout","setTimeout","$activeItem","_setFocusedItem","$target","_itemPointerDownHandler","_findNonDisabledNodes","_moveFocus","FOCUS_UP","FOCUS_DOWN","FOCUS_FIRST","FOCUS_LAST","FOCUS_LEFT","FOCUS_RIGHT","$prevItem","$nextItem","$firstItem","$lastItem","_nodeElements","_expandFocusedContainer","$focusedNode","_getClosestNonDisabledNode","_collapseFocusedContainer","nodeElement","collapsedNode","_encodeString","encodeURI","_decodeString","decodeURI","updateDimensions","_this13","selectItem","unselectItem","expandItem","collapseItem","getNodes","getSelectedNodesKeys","selectAll","unselectAll","expandAll","dataAdapter","collapseAll","module"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/tree_view/ui.tree_view.base.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar _renderer = require(\"../../core/renderer\");\r\nvar _renderer2 = _interopRequireDefault(_renderer);\r\nvar _dom_adapter = require(\"../../core/dom_adapter\");\r\nvar _events_engine = require(\"../../events/core/events_engine\");\r\nvar _message = require(\"../../localization/message\");\r\nvar _message2 = _interopRequireDefault(_message);\r\nvar _click = require(\"../../events/click\");\r\nvar _click2 = _interopRequireDefault(_click);\r\nvar _common = require(\"../../core/utils/common\");\r\nvar _common2 = _interopRequireDefault(_common);\r\nvar _window = require(\"../../core/utils/window\");\r\nvar _window2 = _interopRequireDefault(_window);\r\nvar _type = require(\"../../core/utils/type\");\r\nvar _extend = require(\"../../core/utils/extend\");\r\nvar _iterator = require(\"../../core/utils/iterator\");\r\nvar _dom = require(\"../../core/utils/dom\");\r\nvar _check_box = require(\"../check_box\");\r\nvar _check_box2 = _interopRequireDefault(_check_box);\r\nvar _ui = require(\"../hierarchical_collection/ui.hierarchical_collection_widget\");\r\nvar _ui2 = _interopRequireDefault(_ui);\r\nvar _utils = require(\"../../events/utils\");\r\nvar _pointer = require(\"../../events/pointer\");\r\nvar _double_click = require(\"../../events/double_click\");\r\nvar _double_click2 = _interopRequireDefault(_double_click);\r\nvar _fx = require(\"../../animation/fx\");\r\nvar _fx2 = _interopRequireDefault(_fx);\r\nvar _ui3 = require(\"../scroll_view/ui.scrollable\");\r\nvar _ui4 = _interopRequireDefault(_ui3);\r\nvar _load_indicator = require(\"../load_indicator\");\r\nvar _load_indicator2 = _interopRequireDefault(_load_indicator);\r\nvar _deferred = require(\"../../core/utils/deferred\");\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\nvar WIDGET_CLASS = \"dx-treeview\";\r\nvar NODE_CLASS = \"\".concat(WIDGET_CLASS, \"-node\");\r\nvar NODE_CONTAINER_CLASS = \"\".concat(NODE_CLASS, \"-container\");\r\nvar NODE_LOAD_INDICATOR_CLASS = \"\".concat(NODE_CLASS, \"-loadindicator\");\r\nvar OPENED_NODE_CONTAINER_CLASS = \"\".concat(NODE_CLASS, \"-container-opened\");\r\nvar IS_LEAF = \"\".concat(NODE_CLASS, \"-is-leaf\");\r\nvar ITEM_CLASS = \"\".concat(WIDGET_CLASS, \"-item\");\r\nvar ITEM_WITH_CHECKBOX_CLASS = \"\".concat(ITEM_CLASS, \"-with-checkbox\");\r\nvar ITEM_WITHOUT_CHECKBOX_CLASS = \"\".concat(ITEM_CLASS, \"-without-checkbox\");\r\nvar ITEM_DATA_KEY = \"\".concat(ITEM_CLASS, \"-data\");\r\nvar TOGGLE_ITEM_VISIBILITY_CLASS = \"\".concat(WIDGET_CLASS, \"-toggle-item-visibility\");\r\nvar LOAD_INDICATOR_CLASS = \"\".concat(WIDGET_CLASS, \"-loadindicator\");\r\nvar LOAD_INDICATOR_WRAPPER_CLASS = \"\".concat(WIDGET_CLASS, \"-loadindicator-wrapper\");\r\nvar TOGGLE_ITEM_VISIBILITY_OPENED_CLASS = \"\".concat(WIDGET_CLASS, \"-toggle-item-visibility-opened\");\r\nvar SELECT_ALL_ITEM_CLASS = \"\".concat(WIDGET_CLASS, \"-select-all-item\");\r\nvar INVISIBLE_STATE_CLASS = \"dx-state-invisible\";\r\nvar DISABLED_STATE_CLASS = \"dx-state-disabled\";\r\nvar SELECTED_ITEM_CLASS = \"dx-state-selected\";\r\nvar EXPAND_EVENT_NAMESPACE = \"dxTreeView_expand\";\r\nvar DATA_ITEM_ID = \"data-item-id\";\r\nvar TreeViewBase = _ui2.default.inherit({\r\n    _supportedKeys: function(e) {\r\n        var _this = this;\r\n        var click = function(e) {\r\n            var $itemElement = (0, _renderer2.default)(_this.option(\"focusedElement\"));\r\n            if (!$itemElement.length) {\r\n                return\r\n            }\r\n            e.target = $itemElement;\r\n            e.currentTarget = $itemElement;\r\n            _this._itemClickHandler(e, $itemElement.children(\".\" + ITEM_CLASS));\r\n            var expandEventName = _this._getEventNameByOption(_this.option(\"expandEvent\"));\r\n            var expandByClick = expandEventName === (0, _utils.addNamespace)(_click2.default.name, EXPAND_EVENT_NAMESPACE);\r\n            if (expandByClick) {\r\n                _this._expandEventHandler(e)\r\n            }\r\n        };\r\n        var select = function(e) {\r\n            e.preventDefault();\r\n            _this._changeCheckBoxState((0, _renderer2.default)(_this.option(\"focusedElement\")))\r\n        };\r\n        var toggleExpandedNestedItems = function(state, e) {\r\n            if (!this.option(\"expandAllEnabled\")) {\r\n                return\r\n            }\r\n            e.preventDefault();\r\n            var $rootElement = (0, _renderer2.default)(this.option(\"focusedElement\"));\r\n            if (!$rootElement.length) {\r\n                return\r\n            }\r\n            var rootItem = this._getItemData($rootElement.find(\".\".concat(ITEM_CLASS)));\r\n            this._toggleExpandedNestedItems([rootItem], state)\r\n        };\r\n        return (0, _extend.extend)(this.callBase(), {\r\n            enter: this._showCheckboxes() ? select : click,\r\n            space: this._showCheckboxes() ? select : click,\r\n            asterisk: toggleExpandedNestedItems.bind(this, true),\r\n            minus: toggleExpandedNestedItems.bind(this, false)\r\n        })\r\n    },\r\n    _changeCheckBoxState: function($element) {\r\n        var checkboxInstance = this._getCheckBoxInstance($element);\r\n        var currentState = checkboxInstance.option(\"value\");\r\n        if (!checkboxInstance.option(\"disabled\")) {\r\n            this._updateItemSelection(!currentState, $element.find(\".\" + ITEM_CLASS).get(0), true, $element)\r\n        }\r\n    },\r\n    _toggleExpandedNestedItems: function(items, state) {\r\n        if (!items) {\r\n            return\r\n        }\r\n        for (var i = 0, len = items.length; i < len; i++) {\r\n            var item = items[i];\r\n            var node = this._dataAdapter.getNodeByItem(item);\r\n            this._toggleExpandedState(node, state);\r\n            this._toggleExpandedNestedItems(item.items, state)\r\n        }\r\n    },\r\n    _getNodeElement: function(node, cache) {\r\n        var key = this._encodeString(node.internalFields.key);\r\n        if (cache) {\r\n            if (!cache.$nodeByKey) {\r\n                cache.$nodeByKey = {};\r\n                this.$element().find(\".\".concat(NODE_CLASS)).each(function() {\r\n                    var $node = (0, _renderer2.default)(this);\r\n                    var key = $node.attr(DATA_ITEM_ID);\r\n                    cache.$nodeByKey[key] = $node\r\n                })\r\n            }\r\n            return cache.$nodeByKey[key] || (0, _renderer2.default)()\r\n        }\r\n        var element = this.$element().get(0).querySelector(\"[\".concat(DATA_ITEM_ID, '=\"').concat(key, '\"]'));\r\n        return (0, _renderer2.default)(element)\r\n    },\r\n    _activeStateUnit: \".\" + ITEM_CLASS,\r\n    _widgetClass: function() {\r\n        return WIDGET_CLASS\r\n    },\r\n    _getDefaultOptions: function() {\r\n        return (0, _extend.extend)(this.callBase(), {\r\n            animationEnabled: true,\r\n            dataStructure: \"tree\",\r\n            deferRendering: true,\r\n            expandAllEnabled: false,\r\n            hasItemsExpr: \"hasItems\",\r\n            selectNodesRecursive: true,\r\n            expandNodesRecursive: true,\r\n            showCheckBoxesMode: \"none\",\r\n            selectAllText: _message2.default.format(\"dxList-selectAll\"),\r\n            onItemSelectionChanged: null,\r\n            onItemExpanded: null,\r\n            onItemCollapsed: null,\r\n            scrollDirection: \"vertical\",\r\n            virtualModeEnabled: false,\r\n            rootValue: 0,\r\n            focusStateEnabled: false,\r\n            selectionMode: \"multiple\",\r\n            expandEvent: \"dblclick\",\r\n            selectByClick: false,\r\n            createChildren: null,\r\n            onSelectAllValueChanged: null\r\n        })\r\n    },\r\n    _initSelectedItems: _common2.default.noop,\r\n    _syncSelectionOptions: _common2.default.asyncNoop,\r\n    _fireSelectionChanged: function() {\r\n        var selectionChangePromise = this._selectionChangePromise;\r\n        (0, _deferred.when)(selectionChangePromise).done(function() {\r\n            this._createActionByOption(\"onSelectionChanged\", {\r\n                excludeValidators: [\"disabled\", \"readOnly\"]\r\n            })()\r\n        }.bind(this))\r\n    },\r\n    _createSelectAllValueChangedAction: function() {\r\n        this._selectAllValueChangedAction = this._createActionByOption(\"onSelectAllValueChanged\", {\r\n            excludeValidators: [\"disabled\", \"readOnly\"]\r\n        })\r\n    },\r\n    _fireSelectAllValueChanged: function(value) {\r\n        this._selectAllValueChangedAction({\r\n            value: value\r\n        })\r\n    },\r\n    _checkBoxModeChange: function(value, previousValue) {\r\n        if (\"none\" === previousValue || \"none\" === value) {\r\n            this.repaint();\r\n            return\r\n        }\r\n        var selectAllExists = this._$selectAllItem && this._$selectAllItem.length;\r\n        switch (value) {\r\n            case \"selectAll\":\r\n                !selectAllExists && this._renderSelectAllItem();\r\n                break;\r\n            case \"normal\":\r\n                if (selectAllExists) {\r\n                    this._$selectAllItem.remove();\r\n                    delete this._$selectAllItem\r\n                }\r\n        }\r\n    },\r\n    _removeSelection: function() {\r\n        var that = this;\r\n        (0, _iterator.each)(this._dataAdapter.getFullData(), function(_, node) {\r\n            if (!that._hasChildren(node)) {\r\n                return\r\n            }\r\n            that._dataAdapter.toggleSelection(node.internalFields.key, false, true)\r\n        })\r\n    },\r\n    _optionChanged: function(args) {\r\n        var name = args.name,\r\n            value = args.value,\r\n            previousValue = args.previousValue;\r\n        switch (name) {\r\n            case \"selectAllText\":\r\n                if (this._$selectAllItem) {\r\n                    this._$selectAllItem.dxCheckBox(\"instance\").option(\"text\", value)\r\n                }\r\n                break;\r\n            case \"showCheckBoxesMode\":\r\n                this._checkBoxModeChange(value, previousValue);\r\n                break;\r\n            case \"scrollDirection\":\r\n                this._scrollableContainer.option(\"direction\", value);\r\n                break;\r\n            case \"items\":\r\n                delete this._$selectAllItem;\r\n                this.callBase(args);\r\n                break;\r\n            case \"dataSource\":\r\n                this.callBase(args);\r\n                this._initDataAdapter();\r\n                this._filter = {};\r\n                break;\r\n            case \"hasItemsExpr\":\r\n                this._initAccessors();\r\n                this.repaint();\r\n                break;\r\n            case \"expandEvent\":\r\n                this._initExpandEvent();\r\n                break;\r\n            case \"deferRendering\":\r\n            case \"dataStructure\":\r\n            case \"rootValue\":\r\n            case \"createChildren\":\r\n            case \"expandNodesRecursive\":\r\n            case \"onItemSelectionChanged\":\r\n            case \"onItemExpanded\":\r\n            case \"onItemCollapsed\":\r\n            case \"expandAllEnabled\":\r\n            case \"animationEnabled\":\r\n            case \"virtualModeEnabled\":\r\n            case \"selectByClick\":\r\n                break;\r\n            case \"selectionMode\":\r\n                this._initDataAdapter();\r\n                this.callBase(args);\r\n                break;\r\n            case \"onSelectAllValueChanged\":\r\n                this._createSelectAllValueChangedAction();\r\n                break;\r\n            case \"selectNodesRecursive\":\r\n                this._dataAdapter.setOption(\"recursiveSelection\", args.value);\r\n                this.repaint();\r\n                break;\r\n            default:\r\n                this.callBase(args)\r\n        }\r\n    },\r\n    _initDataSource: function() {\r\n        if (this._useCustomChildrenLoader()) {\r\n            this._loadChildrenByCustomLoader(null).done(function(newItems) {\r\n                if (newItems && newItems.length) {\r\n                    this.option(\"items\", newItems)\r\n                }\r\n            }.bind(this))\r\n        } else {\r\n            this.callBase();\r\n            this._isVirtualMode() && this._initVirtualMode()\r\n        }\r\n    },\r\n    _initVirtualMode: function() {\r\n        var filter = this._filter;\r\n        if (!filter.custom) {\r\n            filter.custom = this._dataSource.filter()\r\n        }\r\n        if (!filter.internal) {\r\n            filter.internal = [this.option(\"parentIdExpr\"), this.option(\"rootValue\")]\r\n        }\r\n    },\r\n    _useCustomChildrenLoader: function() {\r\n        return (0, _type.isFunction)(this.option(\"createChildren\")) && this._isDataStructurePlain()\r\n    },\r\n    _loadChildrenByCustomLoader: function(parentNode) {\r\n        var invocationResult = this.option(\"createChildren\").call(this, parentNode);\r\n        if (Array.isArray(invocationResult)) {\r\n            return (new _deferred.Deferred).resolve(invocationResult).promise()\r\n        }\r\n        if (invocationResult && (0, _type.isFunction)(invocationResult.then)) {\r\n            return (0, _deferred.fromPromise)(invocationResult)\r\n        }\r\n        return (new _deferred.Deferred).resolve([]).promise()\r\n    },\r\n    _combineFilter: function() {\r\n        if (!this._filter.custom || !this._filter.custom.length) {\r\n            return this._filter.internal\r\n        }\r\n        return [this._filter.custom, this._filter.internal]\r\n    },\r\n    _dataSourceLoadErrorHandler: function() {\r\n        this._renderEmptyMessage()\r\n    },\r\n    _init: function() {\r\n        this._filter = {};\r\n        this.callBase();\r\n        this._initStoreChangeHandlers()\r\n    },\r\n    _dataSourceChangedHandler: function(newItems) {\r\n        var items = this.option(\"items\");\r\n        if (this._initialized && this._isVirtualMode() && items.length) {\r\n            return\r\n        }\r\n        this.option(\"items\", newItems)\r\n    },\r\n    _removeTreeViewLoadIndicator: function() {\r\n        if (!this._treeViewLoadIndicator) {\r\n            return\r\n        }\r\n        this._treeViewLoadIndicator.remove();\r\n        this._treeViewLoadIndicator = null\r\n    },\r\n    _createTreeViewLoadIndicator: function() {\r\n        this._treeViewLoadIndicator = (0, _renderer2.default)(\"<div>\").addClass(LOAD_INDICATOR_CLASS);\r\n        this._createComponent(this._treeViewLoadIndicator, _load_indicator2.default, {});\r\n        return this._treeViewLoadIndicator\r\n    },\r\n    _dataSourceLoadingChangedHandler: function(isLoading) {\r\n        var resultFilter;\r\n        if (this._isVirtualMode()) {\r\n            resultFilter = this._combineFilter();\r\n            this._dataSource.filter(resultFilter)\r\n        }\r\n        if (isLoading && !this._dataSource.isLoaded()) {\r\n            this.option(\"items\", []);\r\n            var $wrapper = (0, _renderer2.default)(\"<div>\").addClass(LOAD_INDICATOR_WRAPPER_CLASS);\r\n            this._createTreeViewLoadIndicator().appendTo($wrapper);\r\n            this.itemsContainer().append($wrapper);\r\n            if (this._isVirtualMode() && this._dataSource.filter() !== resultFilter) {\r\n                this._dataSource.filter([])\r\n            }\r\n        } else {\r\n            this._removeTreeViewLoadIndicator()\r\n        }\r\n    },\r\n    _initStoreChangeHandlers: function() {\r\n        var _this2 = this;\r\n        if (\"plain\" !== this.option(\"dataStructure\")) {\r\n            return\r\n        }\r\n        this._dataSource && this._dataSource.store().on(\"inserted\", function(newItem) {\r\n            _this2.option().items = _this2.option(\"items\").concat(newItem);\r\n            _this2._dataAdapter.addItem(newItem);\r\n            if (!_this2._dataAdapter.isFiltered(newItem)) {\r\n                return\r\n            }\r\n            _this2._updateLevel(_this2._parentIdGetter(newItem))\r\n        }).on(\"removed\", function(removedKey) {\r\n            var node = _this2._dataAdapter.getNodeByKey(removedKey);\r\n            _this2.option(\"items\")[_this2._dataAdapter.getIndexByKey(node.internalFields.key)] = 0;\r\n            _this2._markChildrenItemsToRemove(node);\r\n            _this2._removeItems();\r\n            _this2._dataAdapter.removeItem(removedKey);\r\n            _this2._updateLevel(_this2._parentIdGetter(node))\r\n        })\r\n    },\r\n    _markChildrenItemsToRemove: function(node) {\r\n        var _this3 = this;\r\n        var keys = node.internalFields.childrenKeys;\r\n        (0, _iterator.each)(keys, function(_, key) {\r\n            _this3.option(\"items\")[_this3._dataAdapter.getIndexByKey(key)] = 0;\r\n            _this3._markChildrenItemsToRemove(_this3._dataAdapter.getNodeByKey(key))\r\n        })\r\n    },\r\n    _removeItems: function() {\r\n        var _this4 = this;\r\n        var items = (0, _extend.extend)(true, [], this.option(\"items\"));\r\n        var counter = 0;\r\n        (0, _iterator.each)(items, function(index, item) {\r\n            if (!item) {\r\n                _this4.option(\"items\").splice(index - counter, 1);\r\n                counter++\r\n            }\r\n        })\r\n    },\r\n    _updateLevel: function(parentId) {\r\n        var $container = this._getContainerByParentKey(parentId);\r\n        this._renderItems($container, this._dataAdapter.getChildrenNodes(parentId))\r\n    },\r\n    _getOldContainer: function($itemElement) {\r\n        if ($itemElement.length) {\r\n            return $itemElement.children(\".\".concat(NODE_CONTAINER_CLASS))\r\n        }\r\n        if (this._scrollableContainer) {\r\n            return this._scrollableContainer.$content().children()\r\n        }\r\n        return (0, _renderer2.default)()\r\n    },\r\n    _getContainerByParentKey: function(parentId) {\r\n        var node = this._dataAdapter.getNodeByKey(parentId);\r\n        var $itemElement = node ? this._getNodeElement(node) : [];\r\n        this._getOldContainer($itemElement).remove();\r\n        var $container = this._renderNodeContainer($itemElement);\r\n        if (this._isRootLevel(parentId)) {\r\n            if (!this._scrollableContainer) {\r\n                this._renderScrollableContainer()\r\n            }\r\n            this._scrollableContainer.$content().append($container)\r\n        }\r\n        return $container\r\n    },\r\n    _isRootLevel: function(parentId) {\r\n        return parentId === this.option(\"rootValue\")\r\n    },\r\n    _getAccessors: function() {\r\n        var accessors = this.callBase();\r\n        accessors.push(\"hasItems\");\r\n        return accessors\r\n    },\r\n    _getDataAdapterOptions: function() {\r\n        return {\r\n            rootValue: this.option(\"rootValue\"),\r\n            multipleSelection: !this._isSingleSelection(),\r\n            recursiveSelection: this._isRecursiveSelection(),\r\n            recursiveExpansion: this.option(\"expandNodesRecursive\"),\r\n            selectionRequired: this.option(\"selectionRequired\"),\r\n            dataType: this.option(\"dataStructure\"),\r\n            sort: this._dataSource && this._dataSource.sort()\r\n        }\r\n    },\r\n    _initMarkup: function() {\r\n        this._renderScrollableContainer();\r\n        this._renderEmptyMessage(this._dataAdapter.getRootNodes());\r\n        this.callBase();\r\n        this.setAria(\"role\", \"tree\")\r\n    },\r\n    _renderContentImpl: function() {\r\n        var $nodeContainer = this._renderNodeContainer();\r\n        this._scrollableContainer.$content().append($nodeContainer);\r\n        if (!this.option(\"items\") || !this.option(\"items\").length) {\r\n            return\r\n        }\r\n        this._renderItems($nodeContainer, this._dataAdapter.getRootNodes());\r\n        this._initExpandEvent();\r\n        if (this._selectAllEnabled()) {\r\n            this._createSelectAllValueChangedAction();\r\n            this._renderSelectAllItem($nodeContainer)\r\n        }\r\n    },\r\n    _isVirtualMode: function() {\r\n        return this.option(\"virtualModeEnabled\") && this._isDataStructurePlain() && !!this.option(\"dataSource\")\r\n    },\r\n    _isDataStructurePlain: function() {\r\n        return \"plain\" === this.option(\"dataStructure\")\r\n    },\r\n    _fireContentReadyAction: function() {\r\n        var dataSource = this.getDataSource();\r\n        var skipContentReadyAction = dataSource && !dataSource.isLoaded();\r\n        if (!skipContentReadyAction) {\r\n            this.callBase()\r\n        }\r\n        if (this._scrollableContainer && _window2.default.hasWindow()) {\r\n            this._scrollableContainer.update()\r\n        }\r\n    },\r\n    _renderScrollableContainer: function() {\r\n        this._scrollableContainer = this._createComponent((0, _renderer2.default)(\"<div>\").appendTo(this.$element()), _ui4.default, {\r\n            direction: this.option(\"scrollDirection\"),\r\n            useKeyboard: false\r\n        })\r\n    },\r\n    _renderNodeContainer: function($parent) {\r\n        var $container = (0, _renderer2.default)(\"<ul>\").addClass(NODE_CONTAINER_CLASS);\r\n        this.setAria(\"role\", \"group\", $container);\r\n        if ($parent && $parent.length) {\r\n            var itemData = this._getItemData($parent.children(\".\" + ITEM_CLASS));\r\n            if (this._expandedGetter(itemData)) {\r\n                $container.addClass(OPENED_NODE_CONTAINER_CLASS)\r\n            }\r\n            $container.appendTo($parent)\r\n        }\r\n        return $container\r\n    },\r\n    _createDOMElement: function($nodeContainer, node) {\r\n        var $node = (0, _renderer2.default)(\"<li>\").addClass(NODE_CLASS).attr(DATA_ITEM_ID, this._encodeString(node.internalFields.key)).prependTo($nodeContainer);\r\n        this.setAria({\r\n            role: \"treeitem\",\r\n            label: this._displayGetter(node.internalFields.item) || \"\",\r\n            expanded: node.internalFields.expanded || false,\r\n            level: this._getLevel($nodeContainer)\r\n        }, $node);\r\n        return $node\r\n    },\r\n    _getLevel: function($nodeContainer) {\r\n        var parent = $nodeContainer.parent();\r\n        return parent.hasClass(\"dx-scrollable-content\") ? 1 : parseInt(parent.attr(\"aria-level\")) + 1\r\n    },\r\n    _showCheckboxes: function() {\r\n        return \"none\" !== this.option(\"showCheckBoxesMode\")\r\n    },\r\n    _selectAllEnabled: function() {\r\n        return \"selectAll\" === this.option(\"showCheckBoxesMode\") && !this._isSingleSelection()\r\n    },\r\n    _renderItems: function($nodeContainer, nodes) {\r\n        var length = nodes.length - 1;\r\n        for (var i = length; i >= 0; i--) {\r\n            this._renderItem(i, nodes[i], $nodeContainer)\r\n        }\r\n        this._renderedItemsCount += nodes.length\r\n    },\r\n    _renderItem: function(nodeIndex, node, $nodeContainer) {\r\n        var $node = this._createDOMElement($nodeContainer, node);\r\n        var nodeData = node.internalFields;\r\n        var showCheckBox = this._showCheckboxes();\r\n        $node.addClass(showCheckBox ? ITEM_WITH_CHECKBOX_CLASS : ITEM_WITHOUT_CHECKBOX_CLASS);\r\n        showCheckBox && this._renderCheckBox($node, node);\r\n        this.setAria(\"selected\", nodeData.selected, $node);\r\n        this._toggleSelectedClass($node, nodeData.selected);\r\n        this.callBase(this._renderedItemsCount + nodeIndex, nodeData.item, $node);\r\n        if (false !== nodeData.item.visible) {\r\n            this._renderChildren($node, node)\r\n        }\r\n    },\r\n    _setAriaSelected: function() {},\r\n    _renderChildren: function($node, node) {\r\n        var _this5 = this;\r\n        if (!this._hasChildren(node)) {\r\n            this._addLeafClass($node);\r\n            return\r\n        }\r\n        this._renderToggleItemVisibilityIcon($node, node);\r\n        if (this.option(\"deferRendering\") && !node.internalFields.expanded) {\r\n            return\r\n        }\r\n        this._loadSublevel(node).done(function(childNodes) {\r\n            _this5._renderSublevel($node, _this5._getActualNode(node), childNodes)\r\n        })\r\n    },\r\n    _getActualNode: function(cachedNode) {\r\n        return this._dataAdapter.getNodeByKey(cachedNode.internalFields.key)\r\n    },\r\n    _hasChildren: function(node) {\r\n        if (this._isVirtualMode() || this._useCustomChildrenLoader()) {\r\n            return false !== this._hasItemsGetter(node.internalFields.item)\r\n        }\r\n        return this.callBase(node)\r\n    },\r\n    _loadSublevel: function(node) {\r\n        var _this6 = this;\r\n        var deferred = new _deferred.Deferred;\r\n        var childrenNodes = this._getChildNodes(node);\r\n        if (childrenNodes.length) {\r\n            deferred.resolve(childrenNodes)\r\n        } else {\r\n            this._loadNestedItems(node).done(function(items) {\r\n                deferred.resolve(_this6._dataAdapter.getNodesByItems(items))\r\n            })\r\n        }\r\n        return deferred.promise()\r\n    },\r\n    _renderSublevel: function($node, node, childNodes) {\r\n        var $nestedNodeContainer = this._renderNodeContainer($node, node);\r\n        var childNodesByChildrenKeys = childNodes.filter(function(childNode) {\r\n            return node.internalFields.childrenKeys.indexOf(childNode.internalFields.key) !== -1\r\n        });\r\n        this._renderItems($nestedNodeContainer, childNodesByChildrenKeys);\r\n        if (childNodesByChildrenKeys.length && !node.internalFields.selected) {\r\n            var firstChild = childNodesByChildrenKeys[0];\r\n            this._updateParentsState(firstChild, this._getNodeElement(firstChild))\r\n        }\r\n        this._normalizeIconState($node, childNodesByChildrenKeys.length);\r\n        if (node.internalFields.expanded) {\r\n            $nestedNodeContainer.addClass(OPENED_NODE_CONTAINER_CLASS)\r\n        }\r\n    },\r\n    _executeItemRenderAction: function(itemIndex, itemData, itemElement) {\r\n        var node = this._getNode(itemElement);\r\n        this._getItemRenderAction()({\r\n            itemElement: itemElement,\r\n            itemIndex: itemIndex,\r\n            itemData: itemData,\r\n            node: this._dataAdapter.getPublicNode(node)\r\n        })\r\n    },\r\n    _addLeafClass: function($node) {\r\n        $node.addClass(IS_LEAF)\r\n    },\r\n    _expandEventHandler: function(e) {\r\n        var $nodeElement = (0, _renderer2.default)(e.currentTarget.parentNode);\r\n        if (!$nodeElement.hasClass(IS_LEAF)) {\r\n            this._toggleExpandedState(e.currentTarget, void 0, e)\r\n        }\r\n    },\r\n    _initExpandEvent: function() {\r\n        var expandedEventName = this._getEventNameByOption(this.option(\"expandEvent\"));\r\n        var $itemsContainer = this._itemContainer();\r\n        var itemSelector = this._itemSelector();\r\n        (0, _events_engine.off)($itemsContainer, \".\" + EXPAND_EVENT_NAMESPACE, itemSelector);\r\n        (0, _events_engine.on)($itemsContainer, expandedEventName, itemSelector, this._expandEventHandler.bind(this))\r\n    },\r\n    _getEventNameByOption: function(name) {\r\n        var event = \"click\" === name ? _click2.default : _double_click2.default;\r\n        return (0, _utils.addNamespace)(event.name, EXPAND_EVENT_NAMESPACE)\r\n    },\r\n    _getNode: function(identifier) {\r\n        if (!(0, _type.isDefined)(identifier)) {\r\n            return null\r\n        }\r\n        if (identifier.internalFields) {\r\n            return identifier\r\n        }\r\n        if ((0, _type.isPrimitive)(identifier)) {\r\n            return this._dataAdapter.getNodeByKey(identifier)\r\n        }\r\n        var itemElement = (0, _renderer2.default)(identifier).get(0);\r\n        if (!itemElement) {\r\n            return null\r\n        }\r\n        if ((0, _dom_adapter.isElementNode)(itemElement)) {\r\n            return this._getNodeByElement(itemElement)\r\n        }\r\n        return this._dataAdapter.getNodeByItem(itemElement)\r\n    },\r\n    _getNodeByElement: function(itemElement) {\r\n        var $node = (0, _renderer2.default)(itemElement).closest(\".\" + NODE_CLASS);\r\n        var key = this._decodeString($node.attr(DATA_ITEM_ID));\r\n        return this._dataAdapter.getNodeByKey(key)\r\n    },\r\n    _toggleExpandedState: function(itemElement, state, e) {\r\n        var node = this._getNode(itemElement);\r\n        var currentState = node.internalFields.expanded;\r\n        if (node.internalFields.disabled || currentState === state) {\r\n            return\r\n        }\r\n        if (this._hasChildren(node)) {\r\n            var $node = this._getNodeElement(node);\r\n            if ($node.find(\".\".concat(NODE_LOAD_INDICATOR_CLASS, \":not(.\").concat(INVISIBLE_STATE_CLASS, \")\")).length) {\r\n                return\r\n            }\r\n            this._createLoadIndicator($node)\r\n        }\r\n        if (!(0, _type.isDefined)(state)) {\r\n            state = !currentState\r\n        }\r\n        this._dataAdapter.toggleExpansion(node.internalFields.key, state);\r\n        this._updateExpandedItemsUI(node, state, e)\r\n    },\r\n    _createLoadIndicator: function($node) {\r\n        var $icon = $node.children(\".\" + TOGGLE_ITEM_VISIBILITY_CLASS);\r\n        var $nodeContainer = $node.children(\".\".concat(NODE_CONTAINER_CLASS));\r\n        if ($icon.hasClass(TOGGLE_ITEM_VISIBILITY_OPENED_CLASS) || $nodeContainer.not(\":empty\").length) {\r\n            return\r\n        }\r\n        this._createComponent((0, _renderer2.default)(\"<div>\").addClass(NODE_LOAD_INDICATOR_CLASS), _load_indicator2.default, {}).$element().appendTo($node);\r\n        $icon.hide()\r\n    },\r\n    _renderToggleItemVisibilityIcon: function($node, node) {\r\n        var $icon = (0, _renderer2.default)(\"<div>\").addClass(TOGGLE_ITEM_VISIBILITY_CLASS).appendTo($node);\r\n        if (node.internalFields.expanded) {\r\n            $icon.addClass(TOGGLE_ITEM_VISIBILITY_OPENED_CLASS);\r\n            $node.parent().addClass(OPENED_NODE_CONTAINER_CLASS)\r\n        }\r\n        if (node.internalFields.disabled) {\r\n            $icon.addClass(DISABLED_STATE_CLASS)\r\n        }\r\n        this._renderToggleItemVisibilityIconClick($icon, node)\r\n    },\r\n    _renderToggleItemVisibilityIconClick: function($icon, node) {\r\n        var _this7 = this;\r\n        var eventName = (0, _utils.addNamespace)(_click2.default.name, this.NAME);\r\n        (0, _events_engine.off)($icon, eventName);\r\n        (0, _events_engine.on)($icon, eventName, function(e) {\r\n            _this7._toggleExpandedState(node.internalFields.key, void 0, e)\r\n        })\r\n    },\r\n    _updateExpandedItemsUI: function(node, state, e) {\r\n        var $node = this._getNodeElement(node);\r\n        var isHiddenNode = !$node.length || state && $node.is(\":hidden\");\r\n        if (this.option(\"expandNodesRecursive\") && isHiddenNode) {\r\n            var parentNode = this._getNode(node.internalFields.parentKey);\r\n            if (parentNode) {\r\n                this._updateExpandedItemsUI(parentNode, state, e)\r\n            }\r\n        }\r\n        var $icon = $node.children(\".\" + TOGGLE_ITEM_VISIBILITY_CLASS);\r\n        var $nodeContainer = $node.children(\".\".concat(NODE_CONTAINER_CLASS));\r\n        $icon.toggleClass(TOGGLE_ITEM_VISIBILITY_OPENED_CLASS, state);\r\n        var nodeContainerExists = $nodeContainer.length > 0;\r\n        if (!state || nodeContainerExists && !$nodeContainer.is(\":empty\")) {\r\n            this._updateExpandedItem(node, state, e);\r\n            return\r\n        }\r\n        if (this._isVirtualMode() || this._useCustomChildrenLoader()) {\r\n            this._loadNestedItemsWithUpdate(node, state, e);\r\n            return\r\n        }\r\n        this._renderSublevel($node, node, this._getChildNodes(node));\r\n        this._fireContentReadyAction();\r\n        this._updateExpandedItem(node, state, e)\r\n    },\r\n    _loadNestedItemsWithUpdate: function(node, state, e) {\r\n        var _this8 = this;\r\n        var $node = this._getNodeElement(node);\r\n        this._loadNestedItems(node).done(function(items) {\r\n            var actualNodeData = _this8._getActualNode(node);\r\n            _this8._renderSublevel($node, actualNodeData, _this8._dataAdapter.getNodesByItems(items));\r\n            if (!items || !items.length) {\r\n                return\r\n            }\r\n            _this8._fireContentReadyAction();\r\n            _this8._updateExpandedItem(actualNodeData, state, e)\r\n        })\r\n    },\r\n    _loadNestedItems: function(node) {\r\n        var _this9 = this;\r\n        if (this._useCustomChildrenLoader()) {\r\n            var publicNode = this._dataAdapter.getPublicNode(node);\r\n            return this._loadChildrenByCustomLoader(publicNode).done(function(newItems) {\r\n                if (!_this9._areNodesExists(newItems)) {\r\n                    _this9._appendItems(newItems)\r\n                }\r\n            })\r\n        }\r\n        if (!this._isVirtualMode()) {\r\n            return (new _deferred.Deferred).resolve([]).promise()\r\n        }\r\n        this._filter.internal = [this.option(\"parentIdExpr\"), node.internalFields.key];\r\n        this._dataSource.filter(this._combineFilter());\r\n        return this._dataSource.load().done(function(newItems) {\r\n            if (!_this9._areNodesExists(newItems)) {\r\n                _this9._appendItems(newItems)\r\n            }\r\n        })\r\n    },\r\n    _areNodesExists: function(newItems, items) {\r\n        var keyOfRootItem = this.keyOf(newItems[0]);\r\n        var fullData = this._dataAdapter.getFullData();\r\n        return !!this._dataAdapter.getNodeByKey(keyOfRootItem, fullData)\r\n    },\r\n    _appendItems: function(newItems) {\r\n        this.option().items = this.option(\"items\").concat(newItems);\r\n        this._initDataAdapter()\r\n    },\r\n    _updateExpandedItem: function(node, state, e) {\r\n        this._animateNodeContainer(node, state, e)\r\n    },\r\n    _animateNodeContainer: function(node, state, e) {\r\n        var $node = this._getNodeElement(node);\r\n        var $nodeContainer = $node.children(\".\".concat(NODE_CONTAINER_CLASS));\r\n        var nodeHeight;\r\n        $nodeContainer.addClass(OPENED_NODE_CONTAINER_CLASS);\r\n        nodeHeight = $nodeContainer.height();\r\n        _fx2.default.stop($nodeContainer, true);\r\n        _fx2.default.animate($nodeContainer, {\r\n            type: \"custom\",\r\n            duration: this.option(\"animationEnabled\") ? 400 : 0,\r\n            from: {\r\n                maxHeight: state ? 0 : nodeHeight\r\n            },\r\n            to: {\r\n                maxHeight: state ? nodeHeight : 0\r\n            },\r\n            complete: function() {\r\n                $nodeContainer.css(\"maxHeight\", \"none\");\r\n                $nodeContainer.toggleClass(OPENED_NODE_CONTAINER_CLASS, state);\r\n                this.setAria(\"expanded\", state, $node);\r\n                this._scrollableContainer.update();\r\n                this._fireExpandedStateUpdatedEvent(state, node, e)\r\n            }.bind(this)\r\n        })\r\n    },\r\n    _fireExpandedStateUpdatedEvent: function(isExpanded, node, e) {\r\n        if (!this._hasChildren(node)) {\r\n            return\r\n        }\r\n        var optionName = isExpanded ? \"onItemExpanded\" : \"onItemCollapsed\";\r\n        if ((0, _type.isDefined)(e)) {\r\n            this._itemDXEventHandler(e, optionName, {\r\n                node: this._dataAdapter.getPublicNode(node)\r\n            })\r\n        } else {\r\n            var target = this._getNodeElement(node);\r\n            this._itemEventHandler(target, optionName, {\r\n                event: e,\r\n                node: this._dataAdapter.getPublicNode(node)\r\n            })\r\n        }\r\n    },\r\n    _normalizeIconState: function($node, hasNewItems) {\r\n        var $loadIndicator = $node.find(\".dx-loadindicator\");\r\n        $loadIndicator.length && _load_indicator2.default.getInstance($loadIndicator).option(\"visible\", false);\r\n        if (hasNewItems) {\r\n            var $icon = $node.find(\".\" + TOGGLE_ITEM_VISIBILITY_CLASS);\r\n            $icon.show();\r\n            return\r\n        }\r\n        $node.find(\".\" + TOGGLE_ITEM_VISIBILITY_CLASS).removeClass(TOGGLE_ITEM_VISIBILITY_CLASS);\r\n        $node.addClass(IS_LEAF)\r\n    },\r\n    _emptyMessageContainer: function() {\r\n        return this._scrollableContainer ? this._scrollableContainer.content() : this.callBase()\r\n    },\r\n    _renderContent: function() {\r\n        var items = this.option(\"items\");\r\n        if (items && items.length) {\r\n            this._contentAlreadyRendered = true\r\n        }\r\n        this.callBase()\r\n    },\r\n    _renderSelectAllItem: function($container) {\r\n        $container = $container || this.$element().find(\".\".concat(NODE_CONTAINER_CLASS)).first();\r\n        this._$selectAllItem = (0, _renderer2.default)(\"<div>\").addClass(SELECT_ALL_ITEM_CLASS);\r\n        var value = this._dataAdapter.isAllSelected();\r\n        this._createComponent(this._$selectAllItem, _check_box2.default, {\r\n            value: value,\r\n            text: this.option(\"selectAllText\"),\r\n            onValueChanged: function(args) {\r\n                this._toggleSelectAll(args);\r\n                this._fireSelectAllValueChanged(args.value)\r\n            }.bind(this)\r\n        });\r\n        this._toggleSelectedClass(this._$selectAllItem, value);\r\n        $container.before(this._$selectAllItem)\r\n    },\r\n    _toggleSelectAll: function(args) {\r\n        this._dataAdapter.toggleSelectAll(args.value);\r\n        this._updateItemsUI();\r\n        this._fireSelectionChanged()\r\n    },\r\n    _renderCheckBox: function($node, node) {\r\n        var $checkbox = (0, _renderer2.default)(\"<div>\").appendTo($node);\r\n        this._createComponent($checkbox, _check_box2.default, {\r\n            value: node.internalFields.selected,\r\n            onValueChanged: this._changeCheckboxValue.bind(this),\r\n            focusStateEnabled: false,\r\n            disabled: this._disabledGetter(node)\r\n        })\r\n    },\r\n    _toggleSelectedClass: function($node, value) {\r\n        $node.toggleClass(SELECTED_ITEM_CLASS, !!value)\r\n    },\r\n    _toggleNodeDisabledState: function(node, state) {\r\n        var $node = this._getNodeElement(node);\r\n        var $item = $node.find(\".\" + ITEM_CLASS).eq(0);\r\n        this._dataAdapter.toggleNodeDisabledState(node.internalFields.key, state);\r\n        $item.toggleClass(DISABLED_STATE_CLASS, !!state);\r\n        if (this._showCheckboxes()) {\r\n            var checkbox = this._getCheckBoxInstance($node);\r\n            checkbox.option(\"disabled\", !!state)\r\n        }\r\n    },\r\n    _itemOptionChanged: function(item, property, value) {\r\n        var node = this._dataAdapter.getNodeByItem(item);\r\n        if (property === this.option(\"disabledExpr\")) {\r\n            this._toggleNodeDisabledState(node, value)\r\n        }\r\n    },\r\n    _changeCheckboxValue: function(e) {\r\n        var $node = (0, _renderer2.default)(e.element).parent(\".\" + NODE_CLASS);\r\n        var $item = $node.children(\".\" + ITEM_CLASS);\r\n        var item = this._getItemData($item);\r\n        var node = this._getNodeByElement($item);\r\n        var value = e.value;\r\n        if (node && node.internalFields.selected === value) {\r\n            return\r\n        }\r\n        this._updateItemSelection(value, item, e.event)\r\n    },\r\n    _isSingleSelection: function() {\r\n        return \"single\" === this.option(\"selectionMode\")\r\n    },\r\n    _isRecursiveSelection: function() {\r\n        return this.option(\"selectNodesRecursive\") && \"single\" !== this.option(\"selectionMode\")\r\n    },\r\n    _isLastSelectedBranch: function(publicNode, selectedNodesKeys, deep) {\r\n        var keyIndex = selectedNodesKeys.indexOf(publicNode.key);\r\n        if (keyIndex >= 0) {\r\n            selectedNodesKeys.splice(keyIndex, 1)\r\n        }\r\n        if (deep) {\r\n            (0, _iterator.each)(publicNode.children, function(_, childNode) {\r\n                this._isLastSelectedBranch(childNode, selectedNodesKeys, true)\r\n            }.bind(this))\r\n        }\r\n        if (publicNode.parent) {\r\n            this._isLastSelectedBranch(publicNode.parent, selectedNodesKeys)\r\n        }\r\n        return 0 === selectedNodesKeys.length\r\n    },\r\n    _isLastRequired: function(node) {\r\n        var selectionRequired = this.option(\"selectionRequired\");\r\n        var isSingleMode = this._isSingleSelection();\r\n        var selectedNodesKeys = this.getSelectedNodesKeys();\r\n        if (!selectionRequired) {\r\n            return\r\n        }\r\n        if (isSingleMode) {\r\n            return 1 === selectedNodesKeys.length\r\n        } else {\r\n            return this._isLastSelectedBranch(node.internalFields.publicNode, selectedNodesKeys.slice(), true)\r\n        }\r\n    },\r\n    _updateItemSelection: function(value, itemElement, dxEvent) {\r\n        var _this10 = this;\r\n        var node = this._getNode(itemElement);\r\n        if (!node || node.internalFields.selected === value) {\r\n            return\r\n        }\r\n        if (!value && this._isLastRequired(node)) {\r\n            if (this._showCheckboxes()) {\r\n                var $node = this._getNodeElement(node);\r\n                var checkbox = this._getCheckBoxInstance($node);\r\n                checkbox && checkbox.option(\"value\", true)\r\n            }\r\n            return\r\n        }\r\n        var selectedNodesKeys = this.getSelectedNodesKeys();\r\n        if (this._isSingleSelection() && value) {\r\n            (0, _iterator.each)(selectedNodesKeys, function(index, nodeKey) {\r\n                _this10.unselectItem(nodeKey)\r\n            })\r\n        }\r\n        this._dataAdapter.toggleSelection(node.internalFields.key, value);\r\n        this._updateItemsUI();\r\n        var initiator = dxEvent || this._findItemElementByItem(node.internalFields.item);\r\n        var handler = dxEvent ? this._itemDXEventHandler : this._itemEventHandler;\r\n        handler.call(this, initiator, \"onItemSelectionChanged\", {\r\n            node: this._dataAdapter.getPublicNode(node),\r\n            itemData: node.internalFields.item\r\n        });\r\n        this._fireSelectionChanged()\r\n    },\r\n    _getCheckBoxInstance: function($node) {\r\n        return $node.children(\".dx-checkbox\").dxCheckBox(\"instance\")\r\n    },\r\n    _updateItemsUI: function() {\r\n        var _this11 = this;\r\n        var cache = {};\r\n        (0, _iterator.each)(this._dataAdapter.getData(), function(_, node) {\r\n            var $node = _this11._getNodeElement(node, cache);\r\n            var nodeSelection = node.internalFields.selected;\r\n            if (!$node.length) {\r\n                return\r\n            }\r\n            _this11._toggleSelectedClass($node, nodeSelection);\r\n            _this11.setAria(\"selected\", nodeSelection, $node);\r\n            if (_this11._showCheckboxes()) {\r\n                var checkbox = _this11._getCheckBoxInstance($node);\r\n                checkbox.option(\"value\", nodeSelection)\r\n            }\r\n        });\r\n        if (this._selectAllEnabled()) {\r\n            this._$selectAllItem.dxCheckBox(\"instance\").option(\"value\", this._dataAdapter.isAllSelected())\r\n        }\r\n    },\r\n    _updateParentsState: function(node, $node) {\r\n        if (!$node) {\r\n            return\r\n        }\r\n        var parentNode = this._dataAdapter.getNodeByKey(node.internalFields.parentKey);\r\n        var $parentNode = (0, _renderer2.default)($node.parents(\".\" + NODE_CLASS)[0]);\r\n        if (this._showCheckboxes()) {\r\n            var parentValue = parentNode.internalFields.selected;\r\n            this._getCheckBoxInstance($parentNode).option(\"value\", parentValue);\r\n            this._toggleSelectedClass($parentNode, parentValue)\r\n        }\r\n        if (parentNode.internalFields.parentKey !== this.option(\"rootValue\")) {\r\n            this._updateParentsState(parentNode, $parentNode)\r\n        }\r\n    },\r\n    _itemEventHandlerImpl: function(initiator, action, actionArgs) {\r\n        var $itemElement = (0, _renderer2.default)(initiator).closest(\".\" + NODE_CLASS).children(\".\" + ITEM_CLASS);\r\n        return action((0, _extend.extend)(this._extendActionArgs($itemElement), actionArgs))\r\n    },\r\n    _itemContextMenuHandler: function(e) {\r\n        this._createEventHandler(\"onItemContextMenu\", e)\r\n    },\r\n    _itemHoldHandler: function(e) {\r\n        this._createEventHandler(\"onItemHold\", e)\r\n    },\r\n    _createEventHandler: function(eventName, e) {\r\n        var node = this._getNodeByElement(e.currentTarget);\r\n        this._itemDXEventHandler(e, eventName, {\r\n            node: this._dataAdapter.getPublicNode(node)\r\n        })\r\n    },\r\n    _itemClass: function() {\r\n        return ITEM_CLASS\r\n    },\r\n    _itemDataKey: function() {\r\n        return ITEM_DATA_KEY\r\n    },\r\n    _attachClickEvent: function() {\r\n        var clickSelector = \".\" + this._itemClass();\r\n        var pointerDownSelector = \".\" + NODE_CLASS + \", .\" + SELECT_ALL_ITEM_CLASS;\r\n        var eventName = (0, _utils.addNamespace)(_click2.default.name, this.NAME);\r\n        var pointerDownEvent = (0, _utils.addNamespace)(_pointer.down, this.NAME);\r\n        var $itemContainer = this._itemContainer();\r\n        var that = this;\r\n        (0, _events_engine.off)($itemContainer, eventName, clickSelector);\r\n        (0, _events_engine.off)($itemContainer, pointerDownEvent, pointerDownSelector);\r\n        (0, _events_engine.on)($itemContainer, eventName, clickSelector, function(e) {\r\n            that._itemClickHandler(e, (0, _renderer2.default)(this))\r\n        });\r\n        (0, _events_engine.on)($itemContainer, pointerDownEvent, pointerDownSelector, function(e) {\r\n            that._itemPointerDownHandler(e)\r\n        })\r\n    },\r\n    _itemClickHandler: function(e, $item) {\r\n        var itemData = this._getItemData($item);\r\n        var node = this._getNodeByElement($item);\r\n        this._itemDXEventHandler(e, \"onItemClick\", {\r\n            node: this._dataAdapter.getPublicNode(node)\r\n        });\r\n        if (this.option(\"selectByClick\") && !e.isDefaultPrevented()) {\r\n            this._updateItemSelection(!node.internalFields.selected, itemData, e)\r\n        }\r\n    },\r\n    _updateSelectionToFirstItem: function($items, startIndex) {\r\n        var itemIndex = startIndex;\r\n        while (itemIndex >= 0) {\r\n            var $item = (0, _renderer2.default)($items[itemIndex]);\r\n            this._updateItemSelection(true, $item.find(\".\" + ITEM_CLASS).get(0));\r\n            itemIndex--\r\n        }\r\n    },\r\n    _updateSelectionToLastItem: function($items, startIndex) {\r\n        var length = $items.length;\r\n        var itemIndex = startIndex;\r\n        while (itemIndex < length) {\r\n            var $item = (0, _renderer2.default)($items[itemIndex]);\r\n            this._updateItemSelection(true, $item.find(\".\" + ITEM_CLASS).get(0));\r\n            itemIndex++\r\n        }\r\n    },\r\n    _focusInHandler: function(e) {\r\n        var _this12 = this;\r\n        this._updateFocusState(e, true);\r\n        if (this.option(\"focusedElement\")) {\r\n            clearTimeout(this._setFocusedItemTimeout);\r\n            this._setFocusedItemTimeout = setTimeout(function() {\r\n                _this12._setFocusedItem((0, _renderer2.default)(_this12.option(\"focusedElement\")))\r\n            });\r\n            return\r\n        }\r\n        var $activeItem = this._getActiveItem();\r\n        this.option(\"focusedElement\", (0, _dom.getPublicElement)($activeItem.closest(\".\" + NODE_CLASS)))\r\n    },\r\n    _setFocusedItem: function($target) {\r\n        if (!$target || !$target.length) {\r\n            return\r\n        }\r\n        if (!$target.children().hasClass(DISABLED_STATE_CLASS)) {\r\n            this.callBase($target)\r\n        }\r\n        this._scrollableContainer.scrollToElement($target.find(\".\" + ITEM_CLASS).first())\r\n    },\r\n    _itemPointerDownHandler: function(e) {\r\n        if (!this.option(\"focusStateEnabled\")) {\r\n            return\r\n        }\r\n        var $target = (0, _renderer2.default)(e.target).closest(\".\" + NODE_CLASS + \", .\" + SELECT_ALL_ITEM_CLASS);\r\n        if (!$target.length) {\r\n            return\r\n        }\r\n        var itemElement = $target.hasClass(DISABLED_STATE_CLASS) ? null : $target;\r\n        this.option(\"focusedElement\", (0, _dom.getPublicElement)(itemElement))\r\n    },\r\n    _findNonDisabledNodes: function($nodes) {\r\n        return $nodes.not(function() {\r\n            return (0, _renderer2.default)(this).children(\".\" + ITEM_CLASS).hasClass(DISABLED_STATE_CLASS)\r\n        })\r\n    },\r\n    _moveFocus: function(location, e) {\r\n        var FOCUS_UP = \"up\";\r\n        var FOCUS_DOWN = \"down\";\r\n        var FOCUS_FIRST = \"first\";\r\n        var FOCUS_LAST = \"last\";\r\n        var FOCUS_LEFT = this.option(\"rtlEnabled\") ? \"right\" : \"left\";\r\n        var FOCUS_RIGHT = this.option(\"rtlEnabled\") ? \"left\" : \"right\";\r\n        this.$element().find(\".\".concat(NODE_CONTAINER_CLASS)).each(function() {\r\n            _fx2.default.stop(this, true)\r\n        });\r\n        var $items = this._findNonDisabledNodes(this._nodeElements());\r\n        if (!$items || !$items.length) {\r\n            return\r\n        }\r\n        switch (location) {\r\n            case FOCUS_UP:\r\n                var $prevItem = this._prevItem($items);\r\n                this.option(\"focusedElement\", (0, _dom.getPublicElement)($prevItem));\r\n                if (e.shiftKey && this._showCheckboxes()) {\r\n                    this._updateItemSelection(true, $prevItem.find(\".\" + ITEM_CLASS).get(0))\r\n                }\r\n                break;\r\n            case FOCUS_DOWN:\r\n                var $nextItem = this._nextItem($items);\r\n                this.option(\"focusedElement\", (0, _dom.getPublicElement)($nextItem));\r\n                if (e.shiftKey && this._showCheckboxes()) {\r\n                    this._updateItemSelection(true, $nextItem.find(\".\" + ITEM_CLASS).get(0))\r\n                }\r\n                break;\r\n            case FOCUS_FIRST:\r\n                var $firstItem = $items.first();\r\n                if (e.shiftKey && this._showCheckboxes()) {\r\n                    this._updateSelectionToFirstItem($items, $items.index(this._prevItem($items)))\r\n                }\r\n                this.option(\"focusedElement\", (0, _dom.getPublicElement)($firstItem));\r\n                break;\r\n            case FOCUS_LAST:\r\n                var $lastItem = $items.last();\r\n                if (e.shiftKey && this._showCheckboxes()) {\r\n                    this._updateSelectionToLastItem($items, $items.index(this._nextItem($items)))\r\n                }\r\n                this.option(\"focusedElement\", (0, _dom.getPublicElement)($lastItem));\r\n                break;\r\n            case FOCUS_RIGHT:\r\n                this._expandFocusedContainer();\r\n                break;\r\n            case FOCUS_LEFT:\r\n                this._collapseFocusedContainer();\r\n                break;\r\n            default:\r\n                this.callBase.apply(this, arguments);\r\n                return\r\n        }\r\n    },\r\n    _nodeElements: function() {\r\n        return this.$element().find(\".\" + NODE_CLASS).not(\":hidden\")\r\n    },\r\n    _expandFocusedContainer: function() {\r\n        var $focusedNode = (0, _renderer2.default)(this.option(\"focusedElement\"));\r\n        if (!$focusedNode.length || $focusedNode.hasClass(IS_LEAF)) {\r\n            return\r\n        }\r\n        var $node = $focusedNode.find(\".\".concat(NODE_CONTAINER_CLASS)).eq(0);\r\n        if ($node.hasClass(OPENED_NODE_CONTAINER_CLASS)) {\r\n            var $nextItem = this._nextItem(this._findNonDisabledNodes(this._nodeElements()));\r\n            this.option(\"focusedElement\", (0, _dom.getPublicElement)($nextItem));\r\n            return\r\n        }\r\n        var node = this._getNodeByElement($focusedNode.children(\".\" + ITEM_CLASS));\r\n        this._toggleExpandedState(node, true)\r\n    },\r\n    _getClosestNonDisabledNode: function($node) {\r\n        do {\r\n            $node = $node.parent().closest(\".\" + NODE_CLASS)\r\n        } while ($node.children(\".dx-treeview-item.dx-state-disabled\").length);\r\n        return $node\r\n    },\r\n    _collapseFocusedContainer: function() {\r\n        var $focusedNode = (0, _renderer2.default)(this.option(\"focusedElement\"));\r\n        if (!$focusedNode.length) {\r\n            return\r\n        }\r\n        var nodeElement = $focusedNode.find(\".\".concat(NODE_CONTAINER_CLASS)).eq(0);\r\n        if (!$focusedNode.hasClass(IS_LEAF) && nodeElement.hasClass(OPENED_NODE_CONTAINER_CLASS)) {\r\n            var node = this._getNodeByElement($focusedNode.children(\".\" + ITEM_CLASS));\r\n            this._toggleExpandedState(node, false)\r\n        } else {\r\n            var collapsedNode = this._getClosestNonDisabledNode($focusedNode);\r\n            collapsedNode.length && this.option(\"focusedElement\", (0, _dom.getPublicElement)(collapsedNode))\r\n        }\r\n    },\r\n    _encodeString: function(value) {\r\n        return (0, _type.isString)(value) ? encodeURI(value) : value\r\n    },\r\n    _decodeString: function(value) {\r\n        return (0, _type.isString)(value) ? decodeURI(value) : value\r\n    },\r\n    updateDimensions: function() {\r\n        var _this13 = this;\r\n        var deferred = new _deferred.Deferred;\r\n        if (this._scrollableContainer) {\r\n            this._scrollableContainer.update().done(function() {\r\n                deferred.resolveWith(_this13)\r\n            })\r\n        } else {\r\n            deferred.resolveWith(this)\r\n        }\r\n        return deferred.promise()\r\n    },\r\n    selectItem: function(itemElement) {\r\n        this._updateItemSelection(true, itemElement)\r\n    },\r\n    unselectItem: function(itemElement) {\r\n        this._updateItemSelection(false, itemElement)\r\n    },\r\n    expandItem: function(itemElement) {\r\n        this._toggleExpandedState(itemElement, true)\r\n    },\r\n    collapseItem: function(itemElement) {\r\n        this._toggleExpandedState(itemElement, false)\r\n    },\r\n    getNodes: function() {\r\n        return this._dataAdapter.getTreeNodes()\r\n    },\r\n    getSelectedNodesKeys: function() {\r\n        return this._dataAdapter.getSelectedNodesKeys()\r\n    },\r\n    selectAll: function() {\r\n        if (this._selectAllEnabled()) {\r\n            this._$selectAllItem.dxCheckBox(\"instance\").option(\"value\", true)\r\n        } else {\r\n            this._toggleSelectAll({\r\n                value: true\r\n            })\r\n        }\r\n    },\r\n    unselectAll: function() {\r\n        if (this._selectAllEnabled()) {\r\n            this._$selectAllItem.dxCheckBox(\"instance\").option(\"value\", false)\r\n        } else {\r\n            this._toggleSelectAll({\r\n                value: false\r\n            })\r\n        }\r\n    },\r\n    expandAll: function() {\r\n        var dataAdapter = this._dataAdapter;\r\n        (0, _iterator.each)(dataAdapter.getData(), function(_, node) {\r\n            return dataAdapter.toggleExpansion(node.internalFields.key, true)\r\n        });\r\n        this.repaint()\r\n    },\r\n    collapseAll: function() {\r\n        (0, _iterator.each)(this._dataAdapter.getExpandedNodesKeys(), function(_, key) {\r\n            this._toggleExpandedState(key, false)\r\n        }.bind(this))\r\n    }\r\n});\r\nmodule.exports = TreeViewBase;\r\n"]},"metadata":{},"sourceType":"module"}