{"ast":null,"code":"/**\r\n * DevExtreme (ui/scheduler/ui.scheduler.appointments.layout_manager.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar _common = require(\"../../core/utils/common\");\n\nvar _uiSchedulerAppointmentsStrategy = require(\"./rendering_strategies/ui.scheduler.appointments.strategy.vertical\");\n\nvar _uiSchedulerAppointmentsStrategy2 = _interopRequireDefault(_uiSchedulerAppointmentsStrategy);\n\nvar _uiSchedulerAppointmentsStrategy3 = require(\"./rendering_strategies/ui.scheduler.appointments.strategy.horizontal\");\n\nvar _uiSchedulerAppointmentsStrategy4 = _interopRequireDefault(_uiSchedulerAppointmentsStrategy3);\n\nvar _uiSchedulerAppointmentsStrategy5 = require(\"./rendering_strategies/ui.scheduler.appointments.strategy.horizontal_month_line\");\n\nvar _uiSchedulerAppointmentsStrategy6 = _interopRequireDefault(_uiSchedulerAppointmentsStrategy5);\n\nvar _uiSchedulerAppointmentsStrategy7 = require(\"./rendering_strategies/ui.scheduler.appointments.strategy.horizontal_month\");\n\nvar _uiSchedulerAppointmentsStrategy8 = _interopRequireDefault(_uiSchedulerAppointmentsStrategy7);\n\nvar _uiSchedulerAppointmentsStrategy9 = require(\"./rendering_strategies/ui.scheduler.appointments.strategy.agenda\");\n\nvar _uiSchedulerAppointmentsStrategy10 = _interopRequireDefault(_uiSchedulerAppointmentsStrategy9);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n\n    if (\"value\" in descriptor) {\n      descriptor.writable = true;\n    }\n\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) {\n    _defineProperties(Constructor.prototype, protoProps);\n  }\n\n  if (staticProps) {\n    _defineProperties(Constructor, staticProps);\n  }\n\n  return Constructor;\n}\n\nvar RENDERING_STRATEGIES = {\n  horizontal: _uiSchedulerAppointmentsStrategy4.default,\n  horizontalMonth: _uiSchedulerAppointmentsStrategy8.default,\n  horizontalMonthLine: _uiSchedulerAppointmentsStrategy6.default,\n  vertical: _uiSchedulerAppointmentsStrategy2.default,\n  agenda: _uiSchedulerAppointmentsStrategy10.default\n};\n\nvar AppointmentLayoutManager = function () {\n  function AppointmentLayoutManager(instance, renderingStrategy) {\n    _classCallCheck(this, AppointmentLayoutManager);\n\n    this.instance = instance;\n    renderingStrategy && this.initRenderingStrategy(renderingStrategy);\n  }\n\n  _createClass(AppointmentLayoutManager, [{\n    key: \"getCellDimensions\",\n    value: function value(options) {\n      if (this.instance._workSpace) {\n        return {\n          width: this.instance._workSpace.getCellWidth(),\n          height: this.instance._workSpace.getCellHeight(),\n          allDayHeight: this.instance._workSpace.getAllDayHeight()\n        };\n      }\n    }\n  }, {\n    key: \"getGroupOrientation\",\n    value: function value(options) {\n      if (this.instance._workSpace) {\n        options.callback(this.instance._workSpace._getRealGroupOrientation());\n      }\n    }\n  }, {\n    key: \"initRenderingStrategy\",\n    value: function value(renderingStrategy) {\n      var Strategy = RENDERING_STRATEGIES[renderingStrategy];\n      this._renderingStrategyInstance = new Strategy(this.instance);\n      this.renderingStrategy = renderingStrategy;\n    }\n  }, {\n    key: \"createAppointmentsMap\",\n    value: function value(items) {\n      var _this = this;\n\n      var _this$getCellDimensio = this.getCellDimensions(),\n          width = _this$getCellDimensio.width,\n          height = _this$getCellDimensio.height,\n          allDayHeight = _this$getCellDimensio.allDayHeight;\n\n      this.instance._cellWidth = width;\n      this.instance._cellHeight = height;\n      this.instance._allDayCellHeight = allDayHeight;\n      this.getGroupOrientation({\n        callback: function callback(groupOrientation) {\n          return _this.instance._groupOrientation = groupOrientation;\n        }\n      });\n      this._positionMap = this._renderingStrategyInstance.createTaskPositionMap(items);\n      return this._createAppointmentsMapCore(items || [], this._positionMap);\n    }\n  }, {\n    key: \"_createAppointmentsMapCore\",\n    value: function value(list, positionMap) {\n      var _this2 = this;\n\n      return list.map(function (data, index) {\n        if (!_this2._renderingStrategyInstance.keepAppointmentSettings()) {\n          delete data.settings;\n        }\n\n        var appointmentSettings = positionMap[index];\n        appointmentSettings.forEach(function (settings) {\n          settings.direction = \"vertical\" === _this2.renderingStrategy && !settings.allDay ? \"vertical\" : \"horizontal\";\n        });\n        return {\n          itemData: data,\n          settings: appointmentSettings,\n          needRepaint: true,\n          needRemove: false\n        };\n      });\n    }\n  }, {\n    key: \"_hasChangesInData\",\n    value: function value(data) {\n      var updatedData = this.instance.getUpdatedAppointment();\n      return updatedData === data || this.instance.getUpdatedAppointmentKeys().some(function (item) {\n        return data[item.key] === item.value;\n      });\n    }\n  }, {\n    key: \"_hasChangesInSettings\",\n    value: function value(settingList, oldSettingList) {\n      if (settingList.length !== oldSettingList.length) {\n        return true;\n      }\n\n      for (var i = 0; i < settingList.length; i++) {\n        var newSettings = settingList[i];\n        var oldSettings = oldSettingList[i];\n\n        if (oldSettings) {\n          oldSettings.sortedIndex = newSettings.sortedIndex;\n        }\n\n        if (!(0, _common.equalByValue)(newSettings, oldSettings)) {\n          return true;\n        }\n      }\n\n      return false;\n    }\n  }, {\n    key: \"_getEqualAppointmentFromList\",\n    value: function value(appointment, list) {\n      for (var i = 0; i < list.length; i++) {\n        var item = list[i];\n\n        if (item.itemData === appointment.itemData) {\n          return item;\n        }\n      }\n\n      return null;\n    }\n  }, {\n    key: \"_getDeletedAppointments\",\n    value: function value(appointmentList, oldAppointmentList) {\n      var result = [];\n\n      for (var i = 0; i < oldAppointmentList.length; i++) {\n        var oldAppointment = oldAppointmentList[i];\n\n        var appointment = this._getEqualAppointmentFromList(oldAppointment, appointmentList);\n\n        if (!appointment) {\n          oldAppointment.needRemove = true;\n          result.push(oldAppointment);\n        }\n      }\n\n      return result;\n    }\n  }, {\n    key: \"getRepaintedAppointments\",\n    value: function value(appointmentList, oldAppointmentList) {\n      if (0 === oldAppointmentList.length || \"agenda\" === this.renderingStrategy) {\n        return appointmentList;\n      }\n\n      for (var i = 0; i < appointmentList.length; i++) {\n        var appointment = appointmentList[i];\n\n        var oldAppointment = this._getEqualAppointmentFromList(appointment, oldAppointmentList);\n\n        if (oldAppointment) {\n          appointment.needRepaint = this._hasChangesInData(appointment.itemData) || this._hasChangesInSettings(appointment.settings, oldAppointment.settings);\n        }\n      }\n\n      return appointmentList.concat(this._getDeletedAppointments(appointmentList, oldAppointmentList));\n    }\n  }, {\n    key: \"getRenderingStrategyInstance\",\n    value: function value() {\n      return this._renderingStrategyInstance;\n    }\n  }]);\n\n  return AppointmentLayoutManager;\n}();\n\nmodule.exports = AppointmentLayoutManager;","map":{"version":3,"sources":["C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/devextreme/ui/scheduler/ui.scheduler.appointments.layout_manager.js"],"names":["_common","require","_uiSchedulerAppointmentsStrategy","_uiSchedulerAppointmentsStrategy2","_interopRequireDefault","_uiSchedulerAppointmentsStrategy3","_uiSchedulerAppointmentsStrategy4","_uiSchedulerAppointmentsStrategy5","_uiSchedulerAppointmentsStrategy6","_uiSchedulerAppointmentsStrategy7","_uiSchedulerAppointmentsStrategy8","_uiSchedulerAppointmentsStrategy9","_uiSchedulerAppointmentsStrategy10","obj","instance","i","props","descriptor","Object","_defineProperties","Constructor","RENDERING_STRATEGIES","horizontal","horizontalMonth","horizontalMonthLine","vertical","agenda","default","AppointmentLayoutManager","_classCallCheck","renderingStrategy","_createClass","key","value","width","height","allDayHeight","options","Strategy","_this","_this$getCellDimensio","callback","items","_this2","data","appointmentSettings","positionMap","settings","itemData","needRepaint","needRemove","updatedData","item","settingList","oldSettingList","newSettings","oldSettings","list","appointment","result","oldAppointmentList","oldAppointment","appointmentList","module"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/scheduler/ui.scheduler.appointments.layout_manager.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar _common = require(\"../../core/utils/common\");\r\nvar _uiSchedulerAppointmentsStrategy = require(\"./rendering_strategies/ui.scheduler.appointments.strategy.vertical\");\r\nvar _uiSchedulerAppointmentsStrategy2 = _interopRequireDefault(_uiSchedulerAppointmentsStrategy);\r\nvar _uiSchedulerAppointmentsStrategy3 = require(\"./rendering_strategies/ui.scheduler.appointments.strategy.horizontal\");\r\nvar _uiSchedulerAppointmentsStrategy4 = _interopRequireDefault(_uiSchedulerAppointmentsStrategy3);\r\nvar _uiSchedulerAppointmentsStrategy5 = require(\"./rendering_strategies/ui.scheduler.appointments.strategy.horizontal_month_line\");\r\nvar _uiSchedulerAppointmentsStrategy6 = _interopRequireDefault(_uiSchedulerAppointmentsStrategy5);\r\nvar _uiSchedulerAppointmentsStrategy7 = require(\"./rendering_strategies/ui.scheduler.appointments.strategy.horizontal_month\");\r\nvar _uiSchedulerAppointmentsStrategy8 = _interopRequireDefault(_uiSchedulerAppointmentsStrategy7);\r\nvar _uiSchedulerAppointmentsStrategy9 = require(\"./rendering_strategies/ui.scheduler.appointments.strategy.agenda\");\r\nvar _uiSchedulerAppointmentsStrategy10 = _interopRequireDefault(_uiSchedulerAppointmentsStrategy9);\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\n\r\nfunction _classCallCheck(instance, Constructor) {\r\n    if (!(instance instanceof Constructor)) {\r\n        throw new TypeError(\"Cannot call a class as a function\")\r\n    }\r\n}\r\n\r\nfunction _defineProperties(target, props) {\r\n    for (var i = 0; i < props.length; i++) {\r\n        var descriptor = props[i];\r\n        descriptor.enumerable = descriptor.enumerable || false;\r\n        descriptor.configurable = true;\r\n        if (\"value\" in descriptor) {\r\n            descriptor.writable = true\r\n        }\r\n        Object.defineProperty(target, descriptor.key, descriptor)\r\n    }\r\n}\r\n\r\nfunction _createClass(Constructor, protoProps, staticProps) {\r\n    if (protoProps) {\r\n        _defineProperties(Constructor.prototype, protoProps)\r\n    }\r\n    if (staticProps) {\r\n        _defineProperties(Constructor, staticProps)\r\n    }\r\n    return Constructor\r\n}\r\nvar RENDERING_STRATEGIES = {\r\n    horizontal: _uiSchedulerAppointmentsStrategy4.default,\r\n    horizontalMonth: _uiSchedulerAppointmentsStrategy8.default,\r\n    horizontalMonthLine: _uiSchedulerAppointmentsStrategy6.default,\r\n    vertical: _uiSchedulerAppointmentsStrategy2.default,\r\n    agenda: _uiSchedulerAppointmentsStrategy10.default\r\n};\r\nvar AppointmentLayoutManager = function() {\r\n    function AppointmentLayoutManager(instance, renderingStrategy) {\r\n        _classCallCheck(this, AppointmentLayoutManager);\r\n        this.instance = instance;\r\n        renderingStrategy && this.initRenderingStrategy(renderingStrategy)\r\n    }\r\n    _createClass(AppointmentLayoutManager, [{\r\n        key: \"getCellDimensions\",\r\n        value: function(options) {\r\n            if (this.instance._workSpace) {\r\n                return {\r\n                    width: this.instance._workSpace.getCellWidth(),\r\n                    height: this.instance._workSpace.getCellHeight(),\r\n                    allDayHeight: this.instance._workSpace.getAllDayHeight()\r\n                }\r\n            }\r\n        }\r\n    }, {\r\n        key: \"getGroupOrientation\",\r\n        value: function(options) {\r\n            if (this.instance._workSpace) {\r\n                options.callback(this.instance._workSpace._getRealGroupOrientation())\r\n            }\r\n        }\r\n    }, {\r\n        key: \"initRenderingStrategy\",\r\n        value: function(renderingStrategy) {\r\n            var Strategy = RENDERING_STRATEGIES[renderingStrategy];\r\n            this._renderingStrategyInstance = new Strategy(this.instance);\r\n            this.renderingStrategy = renderingStrategy\r\n        }\r\n    }, {\r\n        key: \"createAppointmentsMap\",\r\n        value: function(items) {\r\n            var _this = this;\r\n            var _this$getCellDimensio = this.getCellDimensions(),\r\n                width = _this$getCellDimensio.width,\r\n                height = _this$getCellDimensio.height,\r\n                allDayHeight = _this$getCellDimensio.allDayHeight;\r\n            this.instance._cellWidth = width;\r\n            this.instance._cellHeight = height;\r\n            this.instance._allDayCellHeight = allDayHeight;\r\n            this.getGroupOrientation({\r\n                callback: function(groupOrientation) {\r\n                    return _this.instance._groupOrientation = groupOrientation\r\n                }\r\n            });\r\n            this._positionMap = this._renderingStrategyInstance.createTaskPositionMap(items);\r\n            return this._createAppointmentsMapCore(items || [], this._positionMap)\r\n        }\r\n    }, {\r\n        key: \"_createAppointmentsMapCore\",\r\n        value: function(list, positionMap) {\r\n            var _this2 = this;\r\n            return list.map(function(data, index) {\r\n                if (!_this2._renderingStrategyInstance.keepAppointmentSettings()) {\r\n                    delete data.settings\r\n                }\r\n                var appointmentSettings = positionMap[index];\r\n                appointmentSettings.forEach(function(settings) {\r\n                    settings.direction = \"vertical\" === _this2.renderingStrategy && !settings.allDay ? \"vertical\" : \"horizontal\"\r\n                });\r\n                return {\r\n                    itemData: data,\r\n                    settings: appointmentSettings,\r\n                    needRepaint: true,\r\n                    needRemove: false\r\n                }\r\n            })\r\n        }\r\n    }, {\r\n        key: \"_hasChangesInData\",\r\n        value: function(data) {\r\n            var updatedData = this.instance.getUpdatedAppointment();\r\n            return updatedData === data || this.instance.getUpdatedAppointmentKeys().some(function(item) {\r\n                return data[item.key] === item.value\r\n            })\r\n        }\r\n    }, {\r\n        key: \"_hasChangesInSettings\",\r\n        value: function(settingList, oldSettingList) {\r\n            if (settingList.length !== oldSettingList.length) {\r\n                return true\r\n            }\r\n            for (var i = 0; i < settingList.length; i++) {\r\n                var newSettings = settingList[i];\r\n                var oldSettings = oldSettingList[i];\r\n                if (oldSettings) {\r\n                    oldSettings.sortedIndex = newSettings.sortedIndex\r\n                }\r\n                if (!(0, _common.equalByValue)(newSettings, oldSettings)) {\r\n                    return true\r\n                }\r\n            }\r\n            return false\r\n        }\r\n    }, {\r\n        key: \"_getEqualAppointmentFromList\",\r\n        value: function(appointment, list) {\r\n            for (var i = 0; i < list.length; i++) {\r\n                var item = list[i];\r\n                if (item.itemData === appointment.itemData) {\r\n                    return item\r\n                }\r\n            }\r\n            return null\r\n        }\r\n    }, {\r\n        key: \"_getDeletedAppointments\",\r\n        value: function(appointmentList, oldAppointmentList) {\r\n            var result = [];\r\n            for (var i = 0; i < oldAppointmentList.length; i++) {\r\n                var oldAppointment = oldAppointmentList[i];\r\n                var appointment = this._getEqualAppointmentFromList(oldAppointment, appointmentList);\r\n                if (!appointment) {\r\n                    oldAppointment.needRemove = true;\r\n                    result.push(oldAppointment)\r\n                }\r\n            }\r\n            return result\r\n        }\r\n    }, {\r\n        key: \"getRepaintedAppointments\",\r\n        value: function(appointmentList, oldAppointmentList) {\r\n            if (0 === oldAppointmentList.length || \"agenda\" === this.renderingStrategy) {\r\n                return appointmentList\r\n            }\r\n            for (var i = 0; i < appointmentList.length; i++) {\r\n                var appointment = appointmentList[i];\r\n                var oldAppointment = this._getEqualAppointmentFromList(appointment, oldAppointmentList);\r\n                if (oldAppointment) {\r\n                    appointment.needRepaint = this._hasChangesInData(appointment.itemData) || this._hasChangesInSettings(appointment.settings, oldAppointment.settings)\r\n                }\r\n            }\r\n            return appointmentList.concat(this._getDeletedAppointments(appointmentList, oldAppointmentList))\r\n        }\r\n    }, {\r\n        key: \"getRenderingStrategyInstance\",\r\n        value: function() {\r\n            return this._renderingStrategyInstance\r\n        }\r\n    }]);\r\n    return AppointmentLayoutManager\r\n}();\r\nmodule.exports = AppointmentLayoutManager;\r\n"]},"metadata":{},"sourceType":"module"}