{"ast":null,"code":"/**\r\n * DevExtreme (ui/pivot_grid/ui.sortable.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar _renderer = require(\"../../core/renderer\");\n\nvar _renderer2 = _interopRequireDefault(_renderer);\n\nvar _events_engine = require(\"../../events/core/events_engine\");\n\nvar _events_engine2 = _interopRequireDefault(_events_engine);\n\nvar _type = require(\"../../core/utils/type\");\n\nvar _extend = require(\"../../core/utils/extend\");\n\nvar _iterator = require(\"../../core/utils/iterator\");\n\nvar _utils = require(\"../../events/utils\");\n\nvar _component_registrator = require(\"../../core/component_registrator\");\n\nvar _component_registrator2 = _interopRequireDefault(_component_registrator);\n\nvar _dom_component = require(\"../../core/dom_component\");\n\nvar _dom_component2 = _interopRequireDefault(_dom_component);\n\nvar _drag = require(\"../../events/drag\");\n\nvar _drag2 = _interopRequireDefault(_drag);\n\nvar _swatch_container = require(\"../widget/swatch_container\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nvar SORTABLE_NAMESPACE = \"dxSortable\";\nvar SORTABLE_CLASS = \"dx-sortable-old\";\nvar SCROLL_STEP = 2;\nvar START_SCROLL_OFFSET = 20;\nvar SCROLL_TIMEOUT = 10;\n\nfunction elementHasPoint(element, x, y) {\n  var $item = (0, _renderer2.default)(element);\n  var offset = $item.offset();\n\n  if (x >= offset.left && x <= offset.left + $item.outerWidth(true)) {\n    if (y >= offset.top && y <= offset.top + $item.outerHeight(true)) {\n      return true;\n    }\n  }\n}\n\nfunction checkHorizontalPosition(position, itemOffset, rtl) {\n  if ((0, _type.isDefined)(itemOffset.posHorizontal)) {\n    return rtl ? position > itemOffset.posHorizontal : position < itemOffset.posHorizontal;\n  } else {\n    return true;\n  }\n}\n\nfunction getIndex($items, $item) {\n  var index = -1;\n  var itemElement = $item.get(0);\n  (0, _iterator.each)($items, function (elementIndex, element) {\n    var $element = (0, _renderer2.default)(element);\n\n    if (!($element.attr(\"item-group\") && $element.attr(\"item-group\") === $items.eq(elementIndex - 1).attr(\"item-group\"))) {\n      index++;\n    }\n\n    if (element === itemElement) {\n      return false;\n    }\n  });\n  return index === $items.length ? -1 : index;\n}\n\nfunction getTargetGroup(e, $groups) {\n  var result;\n  (0, _iterator.each)($groups, function () {\n    if (elementHasPoint(this, e.pageX, e.pageY)) {\n      result = (0, _renderer2.default)(this);\n    }\n  });\n  return result;\n}\n\nfunction getItemsOffset($elements, isVertical, $itemsContainer) {\n  var result = [];\n  var $item = [];\n\n  for (var i = 0; i < $elements.length; i += $item.length) {\n    $item = $elements.eq(i);\n\n    if ($item.attr(\"item-group\")) {\n      $item = $itemsContainer.find(\"[item-group='\" + $item.attr(\"item-group\") + \"']\");\n    }\n\n    if ($item.is(\":visible\")) {\n      var offset = {\n        item: $item,\n        index: result.length,\n        posHorizontal: isVertical ? void 0 : ($item.last().outerWidth(true) + $item.last().offset().left + $item.offset().left) / 2\n      };\n\n      if (isVertical) {\n        offset.posVertical = ($item.last().offset().top + $item.offset().top + $item.last().outerHeight(true)) / 2;\n      } else {\n        offset.posVertical = $item.last().outerHeight(true) + $item.last().offset().top;\n      }\n\n      result.push(offset);\n    }\n  }\n\n  return result;\n}\n\nfunction getScrollWrapper(scrollable) {\n  var timeout = null;\n  var scrollTop = scrollable.scrollTop();\n  var $element = scrollable.$element();\n  var top = $element.offset().top;\n  var height = $element.height();\n  var delta = 0;\n\n  function onScroll(e) {\n    scrollTop = e.scrollOffset.top;\n  }\n\n  scrollable.on(\"scroll\", onScroll);\n\n  function move() {\n    stop();\n    scrollable.scrollTo(scrollTop += delta);\n    timeout = setTimeout(move, SCROLL_TIMEOUT);\n  }\n\n  function stop() {\n    clearTimeout(timeout);\n  }\n\n  function moveIfNeed(event) {\n    if (event.pageY <= top + START_SCROLL_OFFSET) {\n      delta = -SCROLL_STEP;\n    } else {\n      if (event.pageY >= top + height - START_SCROLL_OFFSET) {\n        delta = SCROLL_STEP;\n      } else {\n        delta = 0;\n        stop();\n        return;\n      }\n    }\n\n    move();\n  }\n\n  return {\n    moveIfNeed: moveIfNeed,\n    element: function element() {\n      return $element;\n    },\n    dispose: function dispose() {\n      stop();\n      scrollable.off(\"scroll\", onScroll);\n    }\n  };\n}\n\nvar Sortable = _dom_component2.default.inherit({\n  _getDefaultOptions: function _getDefaultOptions() {\n    return (0, _extend.extend)(this.callBase(), {\n      onChanged: null,\n      onDragging: null,\n      itemRender: null,\n      groupSelector: null,\n      itemSelector: \".dx-sort-item\",\n      itemContainerSelector: \".dx-sortable-old\",\n      sourceClass: \"dx-drag-source\",\n      dragClass: \"dx-drag\",\n      targetClass: \"dx-drag-target\",\n      direction: \"vertical\",\n      allowDragging: true,\n      groupFilter: null,\n      useIndicator: false\n    });\n  },\n  _renderItem: function _renderItem($sourceItem, target) {\n    var itemRender = this.option(\"itemRender\");\n    var $item;\n\n    if (itemRender) {\n      $item = itemRender($sourceItem, target);\n    } else {\n      $item = $sourceItem.clone();\n      $item.css({\n        width: $sourceItem.width(),\n        height: $sourceItem.height()\n      });\n    }\n\n    return $item;\n  },\n  _renderIndicator: function _renderIndicator($item, isVertical, $targetGroup, isLast) {\n    var height = $item.outerHeight(true);\n    var width = $item.outerWidth(true);\n    var top = $item.offset().top - $targetGroup.offset().top;\n    var left = $item.offset().left - $targetGroup.offset().left;\n\n    this._indicator.css({\n      position: \"absolute\",\n      top: isLast && isVertical ? top + height : top,\n      left: isLast && !isVertical ? left + width : left\n    }).toggleClass(\"dx-position-indicator-horizontal\", !isVertical).toggleClass(\"dx-position-indicator-vertical\", !!isVertical).toggleClass(\"dx-position-indicator-last\", !!isLast).height(\"\").width(\"\").appendTo($targetGroup);\n\n    isVertical ? this._indicator.width(width) : this._indicator.height(height);\n  },\n  _renderDraggable: function _renderDraggable($sourceItem) {\n    this._$draggable && this._$draggable.remove();\n    this._$draggable = this._renderItem($sourceItem, \"drag\").addClass(this.option(\"dragClass\")).appendTo((0, _swatch_container.getSwatchContainer)($sourceItem)).css({\n      zIndex: 1e6,\n      position: \"absolute\"\n    });\n  },\n  _detachEventHandlers: function _detachEventHandlers() {\n    var dragEventsString = [_drag2.default.move, _drag2.default.start, _drag2.default.end, _drag2.default.enter, _drag2.default.leave, _drag2.default.drop].join(\" \");\n\n    _events_engine2.default.off(this._getEventListener(), (0, _utils.addNamespace)(dragEventsString, SORTABLE_NAMESPACE));\n  },\n  _getItemOffset: function _getItemOffset(isVertical, itemsOffset, e) {\n    for (var i = 0; i < itemsOffset.length; i++) {\n      var shouldInsert;\n      var sameLine = e.pageY < itemsOffset[i].posVertical;\n\n      if (isVertical) {\n        shouldInsert = sameLine;\n      } else {\n        if (sameLine) {\n          shouldInsert = checkHorizontalPosition(e.pageX, itemsOffset[i], this.option(\"rtlEnabled\"));\n\n          if (!shouldInsert && itemsOffset[i + 1] && itemsOffset[i + 1].posVertical > itemsOffset[i].posVertical) {\n            shouldInsert = true;\n          }\n        }\n      }\n\n      if (shouldInsert) {\n        return itemsOffset[i];\n      }\n    }\n  },\n  _getEventListener: function _getEventListener() {\n    var groupSelector = this.option(\"groupSelector\");\n    var element = this.$element();\n    return groupSelector ? element.find(groupSelector) : element;\n  },\n  _attachEventHandlers: function _attachEventHandlers() {\n    var that = this;\n    var itemSelector = that.option(\"itemSelector\");\n    var itemContainerSelector = that.option(\"itemContainerSelector\");\n    var groupSelector = that.option(\"groupSelector\");\n    var sourceClass = that.option(\"sourceClass\");\n    var targetClass = that.option(\"targetClass\");\n    var onDragging = that.option(\"onDragging\");\n    var groupFilter = that.option(\"groupFilter\");\n    var $sourceItem;\n    var sourceIndex;\n    var $targetItem;\n    var $targetGroup;\n    var startPositions;\n    var sourceGroup;\n    var element = that.$element();\n    var $groups;\n    var scrollWrapper = null;\n    var targetIndex = -1;\n\n    var setStartPositions = function setStartPositions() {\n      startPositions = [];\n      (0, _iterator.each)($sourceItem, function (_, item) {\n        startPositions.push((0, _renderer2.default)(item).offset());\n      });\n    };\n\n    var createGroups = function createGroups() {\n      if (!groupSelector) {\n        return element;\n      } else {\n        return groupFilter ? (0, _renderer2.default)(groupSelector).filter(groupFilter) : element.find(groupSelector);\n      }\n    };\n\n    var disposeScrollWrapper = function disposeScrollWrapper() {\n      scrollWrapper && scrollWrapper.dispose();\n      scrollWrapper = null;\n    };\n\n    var invokeOnDraggingEvent = function invokeOnDraggingEvent() {\n      var draggingArgs = {\n        sourceGroup: sourceGroup,\n        sourceIndex: sourceIndex,\n        sourceElement: $sourceItem,\n        targetGroup: $targetGroup.attr(\"group\"),\n        targetIndex: $targetGroup.find(itemSelector).index($targetItem)\n      };\n      onDragging && onDragging(draggingArgs);\n\n      if (draggingArgs.cancel) {\n        $targetGroup = void 0;\n      }\n    };\n\n    that._detachEventHandlers();\n\n    if (that.option(\"allowDragging\")) {\n      var $eventListener = that._getEventListener();\n\n      _events_engine2.default.on($eventListener, (0, _utils.addNamespace)(_drag2.default.start, SORTABLE_NAMESPACE), itemSelector, function (e) {\n        $sourceItem = (0, _renderer2.default)(e.currentTarget);\n        var $sourceGroup = $sourceItem.closest(groupSelector);\n        sourceGroup = $sourceGroup.attr(\"group\");\n        sourceIndex = getIndex((groupSelector ? $sourceGroup : element).find(itemSelector), $sourceItem);\n\n        if ($sourceItem.attr(\"item-group\")) {\n          $sourceItem = $sourceGroup.find(\"[item-group='\" + $sourceItem.attr(\"item-group\") + \"']\");\n        }\n\n        that._renderDraggable($sourceItem);\n\n        $targetItem = that._renderItem($sourceItem, \"target\").addClass(targetClass);\n        $sourceItem.addClass(sourceClass);\n        setStartPositions();\n        $groups = createGroups();\n        that._indicator = (0, _renderer2.default)(\"<div>\").addClass(\"dx-position-indicator\");\n      });\n\n      _events_engine2.default.on($eventListener, (0, _utils.addNamespace)(_drag2.default.move, SORTABLE_NAMESPACE), function (e) {\n        var $item;\n        var $lastItem;\n        var $prevItem;\n\n        if (!$sourceItem) {\n          return;\n        }\n\n        targetIndex = -1;\n\n        that._indicator.detach();\n\n        (0, _iterator.each)(that._$draggable, function (index, draggableElement) {\n          (0, _renderer2.default)(draggableElement).css({\n            top: startPositions[index].top + e.offset.y,\n            left: startPositions[index].left + e.offset.x\n          });\n        });\n        $targetGroup && $targetGroup.removeClass(targetClass);\n        $targetGroup = getTargetGroup(e, $groups);\n        $targetGroup && invokeOnDraggingEvent();\n\n        if ($targetGroup && scrollWrapper && $targetGroup.get(0) !== scrollWrapper.element().get(0)) {\n          disposeScrollWrapper();\n        }\n\n        scrollWrapper && scrollWrapper.moveIfNeed(e);\n\n        if (!$targetGroup) {\n          $targetItem.detach();\n          return;\n        }\n\n        if (!scrollWrapper && $targetGroup.attr(\"allow-scrolling\")) {\n          scrollWrapper = getScrollWrapper($targetGroup.dxScrollable(\"instance\"));\n        }\n\n        $targetGroup.addClass(targetClass);\n        var $itemContainer = $targetGroup.find(itemContainerSelector);\n        var $items = $itemContainer.find(itemSelector);\n        var targetSortable = $targetGroup.closest(\".\" + SORTABLE_CLASS).data(\"dxSortableOld\");\n        var useIndicator = targetSortable.option(\"useIndicator\");\n        var isVertical = \"vertical\" === (targetSortable || that).option(\"direction\");\n        var itemsOffset = getItemsOffset($items, isVertical, $itemContainer);\n\n        var itemOffset = that._getItemOffset(isVertical, itemsOffset, e);\n\n        if (itemOffset) {\n          $item = itemOffset.item;\n          $prevItem = itemsOffset[itemOffset.index - 1] && itemsOffset[itemOffset.index - 1].item;\n\n          if ($item.hasClass(sourceClass) || $prevItem && $prevItem.hasClass(sourceClass) && $prevItem.is(\":visible\")) {\n            $targetItem.detach();\n            return;\n          }\n\n          targetIndex = itemOffset.index;\n\n          if (!useIndicator) {\n            $targetItem.insertBefore($item);\n            return;\n          }\n\n          var isAnotherGroup = $targetGroup.attr(\"group\") !== sourceGroup;\n          var isSameIndex = targetIndex === sourceIndex;\n          var isNextIndex = targetIndex === sourceIndex + 1;\n\n          if (isAnotherGroup) {\n            that._renderIndicator($item, isVertical, $targetGroup, that.option(\"rtlEnabled\") && !isVertical);\n\n            return;\n          }\n\n          if (!isSameIndex && !isNextIndex) {\n            that._renderIndicator($item, isVertical, $targetGroup, that.option(\"rtlEnabled\") && !isVertical);\n          }\n        } else {\n          $lastItem = $items.last();\n\n          if ($lastItem.is(\":visible\") && $lastItem.hasClass(sourceClass)) {\n            return;\n          }\n\n          if ($itemContainer.length) {\n            targetIndex = itemsOffset.length ? itemsOffset[itemsOffset.length - 1].index + 1 : 0;\n          }\n\n          if (useIndicator) {\n            $items.length && that._renderIndicator($lastItem, isVertical, $targetGroup, !that.option(\"rtlEnabled\") || isVertical);\n          } else {\n            $targetItem.appendTo($itemContainer);\n          }\n        }\n      });\n\n      _events_engine2.default.on($eventListener, (0, _utils.addNamespace)(_drag2.default.end, SORTABLE_NAMESPACE), function () {\n        disposeScrollWrapper();\n\n        if (!$sourceItem) {\n          return;\n        }\n\n        var onChanged = that.option(\"onChanged\");\n        var changedArgs = {\n          sourceIndex: sourceIndex,\n          sourceElement: $sourceItem,\n          sourceGroup: sourceGroup,\n          targetIndex: targetIndex,\n          removeSourceElement: true,\n          removeTargetElement: false,\n          removeSourceClass: true\n        };\n\n        if ($targetGroup) {\n          $targetGroup.removeClass(targetClass);\n          changedArgs.targetGroup = $targetGroup.attr(\"group\");\n\n          if (sourceGroup !== changedArgs.targetGroup || targetIndex > -1) {\n            onChanged && onChanged(changedArgs);\n            changedArgs.removeSourceElement && $sourceItem.remove();\n          }\n        }\n\n        that._indicator.detach();\n\n        changedArgs.removeSourceClass && $sourceItem.removeClass(sourceClass);\n        $sourceItem = null;\n\n        that._$draggable.remove();\n\n        that._$draggable = null;\n        changedArgs.removeTargetElement && $targetItem.remove();\n        $targetItem.removeClass(targetClass);\n        $targetItem = null;\n      });\n    }\n  },\n  _init: function _init() {\n    this.callBase();\n\n    this._attachEventHandlers();\n  },\n  _render: function _render() {\n    this.callBase();\n    this.$element().addClass(SORTABLE_CLASS);\n  },\n  _dispose: function _dispose() {\n    var that = this;\n    that.callBase.apply(that, arguments);\n    that._$draggable && that._$draggable.detach();\n    that._indicator && that._indicator.detach();\n  },\n  _optionChanged: function _optionChanged(args) {\n    var that = this;\n\n    switch (args.name) {\n      case \"onDragging\":\n      case \"onChanged\":\n      case \"itemRender\":\n      case \"groupSelector\":\n      case \"itemSelector\":\n      case \"itemContainerSelector\":\n      case \"sourceClass\":\n      case \"targetClass\":\n      case \"dragClass\":\n      case \"allowDragging\":\n      case \"groupFilter\":\n      case \"useIndicator\":\n        that._attachEventHandlers();\n\n        break;\n\n      case \"direction\":\n        break;\n\n      default:\n        that.callBase(args);\n    }\n  }\n});\n\n(0, _component_registrator2.default)(\"dxSortableOld\", Sortable);\nmodule.exports = Sortable;","map":{"version":3,"sources":["C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/devextreme/ui/pivot_grid/ui.sortable.js"],"names":["_renderer","require","_renderer2","_interopRequireDefault","_events_engine","_events_engine2","_type","_extend","_iterator","_utils","_component_registrator","_component_registrator2","_dom_component","_dom_component2","_drag","_drag2","_swatch_container","obj","SORTABLE_NAMESPACE","SORTABLE_CLASS","SCROLL_STEP","START_SCROLL_OFFSET","SCROLL_TIMEOUT","$item","offset","x","y","itemOffset","rtl","position","index","itemElement","$element","$items","elementIndex","element","elementHasPoint","e","result","i","$elements","$itemsContainer","item","posHorizontal","isVertical","timeout","scrollTop","scrollable","top","height","delta","stop","setTimeout","clearTimeout","event","move","moveIfNeed","dispose","Sortable","_getDefaultOptions","onChanged","onDragging","itemRender","groupSelector","itemSelector","itemContainerSelector","sourceClass","dragClass","targetClass","direction","allowDragging","groupFilter","useIndicator","_renderItem","$sourceItem","width","_renderIndicator","$targetGroup","left","isLast","_renderDraggable","zIndex","_detachEventHandlers","dragEventsString","_getItemOffset","itemsOffset","sameLine","shouldInsert","checkHorizontalPosition","_getEventListener","_attachEventHandlers","that","scrollWrapper","targetIndex","setStartPositions","startPositions","createGroups","disposeScrollWrapper","invokeOnDraggingEvent","draggingArgs","sourceGroup","sourceIndex","sourceElement","targetGroup","$eventListener","$sourceGroup","getIndex","$targetItem","$groups","getTargetGroup","getScrollWrapper","$itemContainer","targetSortable","getItemsOffset","$prevItem","isAnotherGroup","isSameIndex","isNextIndex","$lastItem","changedArgs","removeSourceElement","removeTargetElement","removeSourceClass","_init","_render","_dispose","_optionChanged","args","module"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/pivot_grid/ui.sortable.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar _renderer = require(\"../../core/renderer\");\r\nvar _renderer2 = _interopRequireDefault(_renderer);\r\nvar _events_engine = require(\"../../events/core/events_engine\");\r\nvar _events_engine2 = _interopRequireDefault(_events_engine);\r\nvar _type = require(\"../../core/utils/type\");\r\nvar _extend = require(\"../../core/utils/extend\");\r\nvar _iterator = require(\"../../core/utils/iterator\");\r\nvar _utils = require(\"../../events/utils\");\r\nvar _component_registrator = require(\"../../core/component_registrator\");\r\nvar _component_registrator2 = _interopRequireDefault(_component_registrator);\r\nvar _dom_component = require(\"../../core/dom_component\");\r\nvar _dom_component2 = _interopRequireDefault(_dom_component);\r\nvar _drag = require(\"../../events/drag\");\r\nvar _drag2 = _interopRequireDefault(_drag);\r\nvar _swatch_container = require(\"../widget/swatch_container\");\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\nvar SORTABLE_NAMESPACE = \"dxSortable\";\r\nvar SORTABLE_CLASS = \"dx-sortable-old\";\r\nvar SCROLL_STEP = 2;\r\nvar START_SCROLL_OFFSET = 20;\r\nvar SCROLL_TIMEOUT = 10;\r\n\r\nfunction elementHasPoint(element, x, y) {\r\n    var $item = (0, _renderer2.default)(element);\r\n    var offset = $item.offset();\r\n    if (x >= offset.left && x <= offset.left + $item.outerWidth(true)) {\r\n        if (y >= offset.top && y <= offset.top + $item.outerHeight(true)) {\r\n            return true\r\n        }\r\n    }\r\n}\r\n\r\nfunction checkHorizontalPosition(position, itemOffset, rtl) {\r\n    if ((0, _type.isDefined)(itemOffset.posHorizontal)) {\r\n        return rtl ? position > itemOffset.posHorizontal : position < itemOffset.posHorizontal\r\n    } else {\r\n        return true\r\n    }\r\n}\r\n\r\nfunction getIndex($items, $item) {\r\n    var index = -1;\r\n    var itemElement = $item.get(0);\r\n    (0, _iterator.each)($items, function(elementIndex, element) {\r\n        var $element = (0, _renderer2.default)(element);\r\n        if (!($element.attr(\"item-group\") && $element.attr(\"item-group\") === $items.eq(elementIndex - 1).attr(\"item-group\"))) {\r\n            index++\r\n        }\r\n        if (element === itemElement) {\r\n            return false\r\n        }\r\n    });\r\n    return index === $items.length ? -1 : index\r\n}\r\n\r\nfunction getTargetGroup(e, $groups) {\r\n    var result;\r\n    (0, _iterator.each)($groups, function() {\r\n        if (elementHasPoint(this, e.pageX, e.pageY)) {\r\n            result = (0, _renderer2.default)(this)\r\n        }\r\n    });\r\n    return result\r\n}\r\n\r\nfunction getItemsOffset($elements, isVertical, $itemsContainer) {\r\n    var result = [];\r\n    var $item = [];\r\n    for (var i = 0; i < $elements.length; i += $item.length) {\r\n        $item = $elements.eq(i);\r\n        if ($item.attr(\"item-group\")) {\r\n            $item = $itemsContainer.find(\"[item-group='\" + $item.attr(\"item-group\") + \"']\")\r\n        }\r\n        if ($item.is(\":visible\")) {\r\n            var offset = {\r\n                item: $item,\r\n                index: result.length,\r\n                posHorizontal: isVertical ? void 0 : ($item.last().outerWidth(true) + $item.last().offset().left + $item.offset().left) / 2\r\n            };\r\n            if (isVertical) {\r\n                offset.posVertical = ($item.last().offset().top + $item.offset().top + $item.last().outerHeight(true)) / 2\r\n            } else {\r\n                offset.posVertical = $item.last().outerHeight(true) + $item.last().offset().top\r\n            }\r\n            result.push(offset)\r\n        }\r\n    }\r\n    return result\r\n}\r\n\r\nfunction getScrollWrapper(scrollable) {\r\n    var timeout = null;\r\n    var scrollTop = scrollable.scrollTop();\r\n    var $element = scrollable.$element();\r\n    var top = $element.offset().top;\r\n    var height = $element.height();\r\n    var delta = 0;\r\n\r\n    function onScroll(e) {\r\n        scrollTop = e.scrollOffset.top\r\n    }\r\n    scrollable.on(\"scroll\", onScroll);\r\n\r\n    function move() {\r\n        stop();\r\n        scrollable.scrollTo(scrollTop += delta);\r\n        timeout = setTimeout(move, SCROLL_TIMEOUT)\r\n    }\r\n\r\n    function stop() {\r\n        clearTimeout(timeout)\r\n    }\r\n\r\n    function moveIfNeed(event) {\r\n        if (event.pageY <= top + START_SCROLL_OFFSET) {\r\n            delta = -SCROLL_STEP\r\n        } else {\r\n            if (event.pageY >= top + height - START_SCROLL_OFFSET) {\r\n                delta = SCROLL_STEP\r\n            } else {\r\n                delta = 0;\r\n                stop();\r\n                return\r\n            }\r\n        }\r\n        move()\r\n    }\r\n    return {\r\n        moveIfNeed: moveIfNeed,\r\n        element: function() {\r\n            return $element\r\n        },\r\n        dispose: function() {\r\n            stop();\r\n            scrollable.off(\"scroll\", onScroll)\r\n        }\r\n    }\r\n}\r\nvar Sortable = _dom_component2.default.inherit({\r\n    _getDefaultOptions: function() {\r\n        return (0, _extend.extend)(this.callBase(), {\r\n            onChanged: null,\r\n            onDragging: null,\r\n            itemRender: null,\r\n            groupSelector: null,\r\n            itemSelector: \".dx-sort-item\",\r\n            itemContainerSelector: \".dx-sortable-old\",\r\n            sourceClass: \"dx-drag-source\",\r\n            dragClass: \"dx-drag\",\r\n            targetClass: \"dx-drag-target\",\r\n            direction: \"vertical\",\r\n            allowDragging: true,\r\n            groupFilter: null,\r\n            useIndicator: false\r\n        })\r\n    },\r\n    _renderItem: function($sourceItem, target) {\r\n        var itemRender = this.option(\"itemRender\");\r\n        var $item;\r\n        if (itemRender) {\r\n            $item = itemRender($sourceItem, target)\r\n        } else {\r\n            $item = $sourceItem.clone();\r\n            $item.css({\r\n                width: $sourceItem.width(),\r\n                height: $sourceItem.height()\r\n            })\r\n        }\r\n        return $item\r\n    },\r\n    _renderIndicator: function($item, isVertical, $targetGroup, isLast) {\r\n        var height = $item.outerHeight(true);\r\n        var width = $item.outerWidth(true);\r\n        var top = $item.offset().top - $targetGroup.offset().top;\r\n        var left = $item.offset().left - $targetGroup.offset().left;\r\n        this._indicator.css({\r\n            position: \"absolute\",\r\n            top: isLast && isVertical ? top + height : top,\r\n            left: isLast && !isVertical ? left + width : left\r\n        }).toggleClass(\"dx-position-indicator-horizontal\", !isVertical).toggleClass(\"dx-position-indicator-vertical\", !!isVertical).toggleClass(\"dx-position-indicator-last\", !!isLast).height(\"\").width(\"\").appendTo($targetGroup);\r\n        isVertical ? this._indicator.width(width) : this._indicator.height(height)\r\n    },\r\n    _renderDraggable: function($sourceItem) {\r\n        this._$draggable && this._$draggable.remove();\r\n        this._$draggable = this._renderItem($sourceItem, \"drag\").addClass(this.option(\"dragClass\")).appendTo((0, _swatch_container.getSwatchContainer)($sourceItem)).css({\r\n            zIndex: 1e6,\r\n            position: \"absolute\"\r\n        })\r\n    },\r\n    _detachEventHandlers: function() {\r\n        var dragEventsString = [_drag2.default.move, _drag2.default.start, _drag2.default.end, _drag2.default.enter, _drag2.default.leave, _drag2.default.drop].join(\" \");\r\n        _events_engine2.default.off(this._getEventListener(), (0, _utils.addNamespace)(dragEventsString, SORTABLE_NAMESPACE))\r\n    },\r\n    _getItemOffset: function(isVertical, itemsOffset, e) {\r\n        for (var i = 0; i < itemsOffset.length; i++) {\r\n            var shouldInsert;\r\n            var sameLine = e.pageY < itemsOffset[i].posVertical;\r\n            if (isVertical) {\r\n                shouldInsert = sameLine\r\n            } else {\r\n                if (sameLine) {\r\n                    shouldInsert = checkHorizontalPosition(e.pageX, itemsOffset[i], this.option(\"rtlEnabled\"));\r\n                    if (!shouldInsert && itemsOffset[i + 1] && itemsOffset[i + 1].posVertical > itemsOffset[i].posVertical) {\r\n                        shouldInsert = true\r\n                    }\r\n                }\r\n            }\r\n            if (shouldInsert) {\r\n                return itemsOffset[i]\r\n            }\r\n        }\r\n    },\r\n    _getEventListener: function() {\r\n        var groupSelector = this.option(\"groupSelector\");\r\n        var element = this.$element();\r\n        return groupSelector ? element.find(groupSelector) : element\r\n    },\r\n    _attachEventHandlers: function() {\r\n        var that = this;\r\n        var itemSelector = that.option(\"itemSelector\");\r\n        var itemContainerSelector = that.option(\"itemContainerSelector\");\r\n        var groupSelector = that.option(\"groupSelector\");\r\n        var sourceClass = that.option(\"sourceClass\");\r\n        var targetClass = that.option(\"targetClass\");\r\n        var onDragging = that.option(\"onDragging\");\r\n        var groupFilter = that.option(\"groupFilter\");\r\n        var $sourceItem;\r\n        var sourceIndex;\r\n        var $targetItem;\r\n        var $targetGroup;\r\n        var startPositions;\r\n        var sourceGroup;\r\n        var element = that.$element();\r\n        var $groups;\r\n        var scrollWrapper = null;\r\n        var targetIndex = -1;\r\n        var setStartPositions = function() {\r\n            startPositions = [];\r\n            (0, _iterator.each)($sourceItem, function(_, item) {\r\n                startPositions.push((0, _renderer2.default)(item).offset())\r\n            })\r\n        };\r\n        var createGroups = function() {\r\n            if (!groupSelector) {\r\n                return element\r\n            } else {\r\n                return groupFilter ? (0, _renderer2.default)(groupSelector).filter(groupFilter) : element.find(groupSelector)\r\n            }\r\n        };\r\n        var disposeScrollWrapper = function() {\r\n            scrollWrapper && scrollWrapper.dispose();\r\n            scrollWrapper = null\r\n        };\r\n        var invokeOnDraggingEvent = function() {\r\n            var draggingArgs = {\r\n                sourceGroup: sourceGroup,\r\n                sourceIndex: sourceIndex,\r\n                sourceElement: $sourceItem,\r\n                targetGroup: $targetGroup.attr(\"group\"),\r\n                targetIndex: $targetGroup.find(itemSelector).index($targetItem)\r\n            };\r\n            onDragging && onDragging(draggingArgs);\r\n            if (draggingArgs.cancel) {\r\n                $targetGroup = void 0\r\n            }\r\n        };\r\n        that._detachEventHandlers();\r\n        if (that.option(\"allowDragging\")) {\r\n            var $eventListener = that._getEventListener();\r\n            _events_engine2.default.on($eventListener, (0, _utils.addNamespace)(_drag2.default.start, SORTABLE_NAMESPACE), itemSelector, function(e) {\r\n                $sourceItem = (0, _renderer2.default)(e.currentTarget);\r\n                var $sourceGroup = $sourceItem.closest(groupSelector);\r\n                sourceGroup = $sourceGroup.attr(\"group\");\r\n                sourceIndex = getIndex((groupSelector ? $sourceGroup : element).find(itemSelector), $sourceItem);\r\n                if ($sourceItem.attr(\"item-group\")) {\r\n                    $sourceItem = $sourceGroup.find(\"[item-group='\" + $sourceItem.attr(\"item-group\") + \"']\")\r\n                }\r\n                that._renderDraggable($sourceItem);\r\n                $targetItem = that._renderItem($sourceItem, \"target\").addClass(targetClass);\r\n                $sourceItem.addClass(sourceClass);\r\n                setStartPositions();\r\n                $groups = createGroups();\r\n                that._indicator = (0, _renderer2.default)(\"<div>\").addClass(\"dx-position-indicator\")\r\n            });\r\n            _events_engine2.default.on($eventListener, (0, _utils.addNamespace)(_drag2.default.move, SORTABLE_NAMESPACE), function(e) {\r\n                var $item;\r\n                var $lastItem;\r\n                var $prevItem;\r\n                if (!$sourceItem) {\r\n                    return\r\n                }\r\n                targetIndex = -1;\r\n                that._indicator.detach();\r\n                (0, _iterator.each)(that._$draggable, function(index, draggableElement) {\r\n                    (0, _renderer2.default)(draggableElement).css({\r\n                        top: startPositions[index].top + e.offset.y,\r\n                        left: startPositions[index].left + e.offset.x\r\n                    })\r\n                });\r\n                $targetGroup && $targetGroup.removeClass(targetClass);\r\n                $targetGroup = getTargetGroup(e, $groups);\r\n                $targetGroup && invokeOnDraggingEvent();\r\n                if ($targetGroup && scrollWrapper && $targetGroup.get(0) !== scrollWrapper.element().get(0)) {\r\n                    disposeScrollWrapper()\r\n                }\r\n                scrollWrapper && scrollWrapper.moveIfNeed(e);\r\n                if (!$targetGroup) {\r\n                    $targetItem.detach();\r\n                    return\r\n                }\r\n                if (!scrollWrapper && $targetGroup.attr(\"allow-scrolling\")) {\r\n                    scrollWrapper = getScrollWrapper($targetGroup.dxScrollable(\"instance\"))\r\n                }\r\n                $targetGroup.addClass(targetClass);\r\n                var $itemContainer = $targetGroup.find(itemContainerSelector);\r\n                var $items = $itemContainer.find(itemSelector);\r\n                var targetSortable = $targetGroup.closest(\".\" + SORTABLE_CLASS).data(\"dxSortableOld\");\r\n                var useIndicator = targetSortable.option(\"useIndicator\");\r\n                var isVertical = \"vertical\" === (targetSortable || that).option(\"direction\");\r\n                var itemsOffset = getItemsOffset($items, isVertical, $itemContainer);\r\n                var itemOffset = that._getItemOffset(isVertical, itemsOffset, e);\r\n                if (itemOffset) {\r\n                    $item = itemOffset.item;\r\n                    $prevItem = itemsOffset[itemOffset.index - 1] && itemsOffset[itemOffset.index - 1].item;\r\n                    if ($item.hasClass(sourceClass) || $prevItem && $prevItem.hasClass(sourceClass) && $prevItem.is(\":visible\")) {\r\n                        $targetItem.detach();\r\n                        return\r\n                    }\r\n                    targetIndex = itemOffset.index;\r\n                    if (!useIndicator) {\r\n                        $targetItem.insertBefore($item);\r\n                        return\r\n                    }\r\n                    var isAnotherGroup = $targetGroup.attr(\"group\") !== sourceGroup;\r\n                    var isSameIndex = targetIndex === sourceIndex;\r\n                    var isNextIndex = targetIndex === sourceIndex + 1;\r\n                    if (isAnotherGroup) {\r\n                        that._renderIndicator($item, isVertical, $targetGroup, that.option(\"rtlEnabled\") && !isVertical);\r\n                        return\r\n                    }\r\n                    if (!isSameIndex && !isNextIndex) {\r\n                        that._renderIndicator($item, isVertical, $targetGroup, that.option(\"rtlEnabled\") && !isVertical)\r\n                    }\r\n                } else {\r\n                    $lastItem = $items.last();\r\n                    if ($lastItem.is(\":visible\") && $lastItem.hasClass(sourceClass)) {\r\n                        return\r\n                    }\r\n                    if ($itemContainer.length) {\r\n                        targetIndex = itemsOffset.length ? itemsOffset[itemsOffset.length - 1].index + 1 : 0\r\n                    }\r\n                    if (useIndicator) {\r\n                        $items.length && that._renderIndicator($lastItem, isVertical, $targetGroup, !that.option(\"rtlEnabled\") || isVertical)\r\n                    } else {\r\n                        $targetItem.appendTo($itemContainer)\r\n                    }\r\n                }\r\n            });\r\n            _events_engine2.default.on($eventListener, (0, _utils.addNamespace)(_drag2.default.end, SORTABLE_NAMESPACE), function() {\r\n                disposeScrollWrapper();\r\n                if (!$sourceItem) {\r\n                    return\r\n                }\r\n                var onChanged = that.option(\"onChanged\");\r\n                var changedArgs = {\r\n                    sourceIndex: sourceIndex,\r\n                    sourceElement: $sourceItem,\r\n                    sourceGroup: sourceGroup,\r\n                    targetIndex: targetIndex,\r\n                    removeSourceElement: true,\r\n                    removeTargetElement: false,\r\n                    removeSourceClass: true\r\n                };\r\n                if ($targetGroup) {\r\n                    $targetGroup.removeClass(targetClass);\r\n                    changedArgs.targetGroup = $targetGroup.attr(\"group\");\r\n                    if (sourceGroup !== changedArgs.targetGroup || targetIndex > -1) {\r\n                        onChanged && onChanged(changedArgs);\r\n                        changedArgs.removeSourceElement && $sourceItem.remove()\r\n                    }\r\n                }\r\n                that._indicator.detach();\r\n                changedArgs.removeSourceClass && $sourceItem.removeClass(sourceClass);\r\n                $sourceItem = null;\r\n                that._$draggable.remove();\r\n                that._$draggable = null;\r\n                changedArgs.removeTargetElement && $targetItem.remove();\r\n                $targetItem.removeClass(targetClass);\r\n                $targetItem = null\r\n            })\r\n        }\r\n    },\r\n    _init: function() {\r\n        this.callBase();\r\n        this._attachEventHandlers()\r\n    },\r\n    _render: function() {\r\n        this.callBase();\r\n        this.$element().addClass(SORTABLE_CLASS)\r\n    },\r\n    _dispose: function() {\r\n        var that = this;\r\n        that.callBase.apply(that, arguments);\r\n        that._$draggable && that._$draggable.detach();\r\n        that._indicator && that._indicator.detach()\r\n    },\r\n    _optionChanged: function(args) {\r\n        var that = this;\r\n        switch (args.name) {\r\n            case \"onDragging\":\r\n            case \"onChanged\":\r\n            case \"itemRender\":\r\n            case \"groupSelector\":\r\n            case \"itemSelector\":\r\n            case \"itemContainerSelector\":\r\n            case \"sourceClass\":\r\n            case \"targetClass\":\r\n            case \"dragClass\":\r\n            case \"allowDragging\":\r\n            case \"groupFilter\":\r\n            case \"useIndicator\":\r\n                that._attachEventHandlers();\r\n                break;\r\n            case \"direction\":\r\n                break;\r\n            default:\r\n                that.callBase(args)\r\n        }\r\n    }\r\n});\r\n(0, _component_registrator2.default)(\"dxSortableOld\", Sortable);\r\nmodule.exports = Sortable;\r\n"]},"metadata":{},"sourceType":"module"}