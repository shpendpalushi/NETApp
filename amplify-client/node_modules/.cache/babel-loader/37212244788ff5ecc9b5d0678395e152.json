{"ast":null,"code":"/**\r\n * DevExtreme (ui/grid_core/ui.grid_core.header_filter.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar _events_engine = require(\"../../events/core/events_engine\");\n\nvar _events_engine2 = _interopRequireDefault(_events_engine);\n\nvar _uiGrid_core = require(\"./ui.grid_core.modules\");\n\nvar _uiGrid_core2 = _interopRequireDefault(_uiGrid_core);\n\nvar _filtering = require(\"../shared/filtering\");\n\nvar _filtering2 = _interopRequireDefault(_filtering);\n\nvar _uiGrid_core3 = require(\"./ui.grid_core.utils\");\n\nvar _uiGrid_core4 = _interopRequireDefault(_uiGrid_core3);\n\nvar _uiGrid_core5 = require(\"./ui.grid_core.header_filter_core\");\n\nvar _message = require(\"../../localization/message\");\n\nvar _message2 = _interopRequireDefault(_message);\n\nvar _click = require(\"../../events/click\");\n\nvar _click2 = _interopRequireDefault(_click);\n\nvar _data = require(\"../../core/utils/data\");\n\nvar _iterator = require(\"../../core/utils/iterator\");\n\nvar _type = require(\"../../core/utils/type\");\n\nvar _position = require(\"../../core/utils/position\");\n\nvar _extend = require(\"../../core/utils/extend\");\n\nvar _data_source = require(\"../../data/data_source/data_source\");\n\nvar _date = require(\"../../localization/date\");\n\nvar _date2 = _interopRequireDefault(_date);\n\nvar _variable_wrapper = require(\"../../core/utils/variable_wrapper\");\n\nvar _deferred = require(\"../../core/utils/deferred\");\n\nvar _accessibility = require(\"../shared/accessibility\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nvar DATE_INTERVAL_FORMATS = {\n  month: function month(value) {\n    return _date2.default.getMonthNames()[value - 1];\n  },\n  quarter: function quarter(value) {\n    return _date2.default.format(new Date(2e3, 3 * value - 1), \"quarter\");\n  }\n};\n\nvar HeaderFilterController = _uiGrid_core2.default.ViewController.inherit(function () {\n  var getFormatOptions = function getFormatOptions(value, column, currentLevel) {\n    var groupInterval = _filtering2.default.getGroupInterval(column);\n\n    var result = _uiGrid_core4.default.getFormatOptionsByColumn(column, \"headerFilter\");\n\n    if (groupInterval) {\n      result.groupInterval = groupInterval[currentLevel];\n\n      if (_uiGrid_core4.default.isDateType(column.dataType)) {\n        result.format = DATE_INTERVAL_FORMATS[groupInterval[currentLevel]];\n      } else {\n        if (\"number\" === column.dataType) {\n          result.getDisplayFormat = function () {\n            var formatOptions = {\n              format: column.format,\n              target: \"headerFilter\"\n            };\n\n            var firstValueText = _uiGrid_core4.default.formatValue(value, formatOptions);\n\n            var secondValue = value + groupInterval[currentLevel];\n\n            var secondValueText = _uiGrid_core4.default.formatValue(secondValue, formatOptions);\n\n            return firstValueText && secondValueText ? firstValueText + \" - \" + secondValueText : \"\";\n          };\n        }\n      }\n    }\n\n    return result;\n  };\n\n  return {\n    init: function init() {\n      this._columnsController = this.getController(\"columns\");\n      this._dataController = this.getController(\"data\");\n      this._headerFilterView = this.getView(\"headerFilterView\");\n    },\n    _updateSelectedState: function _updateSelectedState(items, column) {\n      var i = items.length;\n      var isExclude = \"exclude\" === column.filterType;\n\n      while (i--) {\n        var item = items[i];\n\n        if (\"items\" in items[i]) {\n          this._updateSelectedState(items[i].items, column);\n        }\n\n        (0, _uiGrid_core5.updateHeaderFilterItemSelectionState)(item, _uiGrid_core4.default.getIndexByKey(items[i].value, column.filterValues, null) > -1, isExclude);\n      }\n    },\n    _normalizeGroupItem: function _normalizeGroupItem(item, currentLevel, options) {\n      var value;\n      var displayValue;\n      var path = options.path;\n      var valueSelector = options.valueSelector;\n      var displaySelector = options.displaySelector;\n      var column = options.column;\n\n      if (valueSelector && displaySelector) {\n        value = valueSelector(item);\n        displayValue = displaySelector(item);\n      } else {\n        value = item.key;\n        displayValue = value;\n      }\n\n      if (!(0, _type.isObject)(item)) {\n        item = {};\n      } else {\n        item = (0, _extend.extend)({}, item);\n      }\n\n      path.push(value);\n\n      if (1 === path.length) {\n        item.value = path[0];\n      } else {\n        item.value = path.join(\"/\");\n      }\n\n      item.text = this.getHeaderItemText(displayValue, column, currentLevel, options.headerFilterOptions);\n      return item;\n    },\n    getHeaderItemText: function getHeaderItemText(displayValue, column, currentLevel, headerFilterOptions) {\n      var text = _uiGrid_core4.default.formatValue(displayValue, getFormatOptions(displayValue, column, currentLevel));\n\n      if (!text) {\n        text = headerFilterOptions.texts.emptyValue;\n      }\n\n      return text;\n    },\n    _processGroupItems: function _processGroupItems(groupItems, currentLevel, path, options) {\n      var that = this;\n      var displaySelector;\n      var valueSelector;\n      var column = options.column;\n      var lookup = column.lookup;\n      var level = options.level;\n      path = path || [];\n      currentLevel = currentLevel || 0;\n\n      if (lookup) {\n        displaySelector = (0, _data.compileGetter)(lookup.displayExpr);\n        valueSelector = (0, _data.compileGetter)(lookup.valueExpr);\n      }\n\n      for (var i = 0; i < groupItems.length; i++) {\n        groupItems[i] = that._normalizeGroupItem(groupItems[i], currentLevel, {\n          column: options.column,\n          headerFilterOptions: options.headerFilterOptions,\n          displaySelector: displaySelector,\n          valueSelector: valueSelector,\n          path: path\n        });\n\n        if (\"items\" in groupItems[i]) {\n          if (currentLevel === level || !(0, _type.isDefined)(groupItems[i].value)) {\n            delete groupItems[i].items;\n          } else {\n            that._processGroupItems(groupItems[i].items, currentLevel + 1, path, options);\n          }\n        }\n\n        path.pop();\n      }\n    },\n    getDataSource: function getDataSource(column) {\n      var that = this;\n      var filter;\n      var cutoffLevel;\n      var origPostProcess;\n\n      var dataSource = that._dataController.dataSource();\n\n      var group = _uiGrid_core4.default.getHeaderFilterGroupParameters(column, dataSource && dataSource.remoteOperations().grouping);\n\n      var headerFilterDataSource = column.headerFilter && column.headerFilter.dataSource;\n      var headerFilterOptions = that.option(\"headerFilter\");\n      var isLookup = false;\n      var options = {\n        component: that.component\n      };\n\n      if (!dataSource) {\n        return;\n      }\n\n      if ((0, _type.isDefined)(headerFilterDataSource) && !(0, _type.isFunction)(headerFilterDataSource)) {\n        options.dataSource = (0, _data_source.normalizeDataSourceOptions)(headerFilterDataSource);\n      } else {\n        if (column.lookup) {\n          isLookup = true;\n          dataSource = column.lookup.dataSource;\n\n          if ((0, _type.isFunction)(dataSource) && !(0, _variable_wrapper.isWrapped)(dataSource)) {\n            dataSource = dataSource({});\n          }\n\n          dataSource = (0, _data_source.normalizeDataSourceOptions)(dataSource);\n          options.dataSource = dataSource;\n        } else {\n          cutoffLevel = Array.isArray(group) ? group.length - 1 : 0;\n          that._currentColumn = column;\n          filter = that._dataController.getCombinedFilter();\n          that._currentColumn = null;\n          options.dataSource = {\n            filter: filter,\n            group: group,\n            useDefaultSearch: true,\n            load: function load(options) {\n              var d = new _deferred.Deferred();\n              options.dataField = column.dataField || column.name;\n              dataSource.load(options).done(function (data) {\n                that._processGroupItems(data, null, null, {\n                  level: cutoffLevel,\n                  column: column,\n                  headerFilterOptions: headerFilterOptions\n                });\n\n                d.resolve(data);\n              }).fail(d.reject);\n              return d;\n            }\n          };\n        }\n      }\n\n      if ((0, _type.isFunction)(headerFilterDataSource)) {\n        headerFilterDataSource.call(column, options);\n      }\n\n      origPostProcess = options.dataSource.postProcess;\n\n      options.dataSource.postProcess = function (data) {\n        var items = data;\n\n        if (isLookup) {\n          if (0 === this.pageIndex() && !this.searchValue()) {\n            items = items.slice(0);\n            items.unshift(null);\n          }\n\n          that._processGroupItems(items, null, null, {\n            level: 0,\n            column: column,\n            headerFilterOptions: headerFilterOptions\n          });\n        }\n\n        items = origPostProcess && origPostProcess.call(this, items) || items;\n\n        that._updateSelectedState(items, column);\n\n        return items;\n      };\n\n      return options.dataSource;\n    },\n    getCurrentColumn: function getCurrentColumn() {\n      return this._currentColumn;\n    },\n    showHeaderFilterMenu: function showHeaderFilterMenu(columnIndex, isGroupPanel) {\n      var columnsController = this._columnsController;\n      var column = (0, _extend.extend)(true, {}, this._columnsController.getColumns()[columnIndex]);\n\n      if (column) {\n        var visibleIndex = columnsController.getVisibleIndex(columnIndex);\n        var view = isGroupPanel ? this.getView(\"headerPanel\") : this.getView(\"columnHeadersView\");\n        var $columnElement = $columnElement || view.getColumnElements().eq(isGroupPanel ? column.groupIndex : visibleIndex);\n        this.showHeaderFilterMenuBase({\n          columnElement: $columnElement,\n          column: column,\n          applyFilter: true,\n          apply: function apply() {\n            columnsController.columnOption(columnIndex, {\n              filterValues: this.filterValues,\n              filterType: this.filterType\n            });\n          }\n        });\n      }\n    },\n    showHeaderFilterMenuBase: function showHeaderFilterMenuBase(options) {\n      var _this = this;\n\n      var that = this;\n      var column = options.column;\n\n      if (column) {\n        var groupInterval = _filtering2.default.getGroupInterval(column);\n\n        var dataSource = that._dataController.dataSource();\n\n        var remoteFiltering = dataSource && dataSource.remoteOperations().filtering;\n        (0, _extend.extend)(options, column, {\n          type: groupInterval && groupInterval.length > 1 ? \"tree\" : \"list\",\n          remoteFiltering: remoteFiltering,\n          onShowing: function onShowing(e) {\n            var dxResizableInstance = e.component.overlayContent().dxResizable(\"instance\");\n            dxResizableInstance && dxResizableInstance.option(\"onResizeEnd\", function (e) {\n              var columnsController = that.getController(\"columns\");\n              var headerFilterByColumn = columnsController.columnOption(options.dataField, \"headerFilter\");\n              headerFilterByColumn = headerFilterByColumn || {};\n              headerFilterByColumn.width = e.width;\n              headerFilterByColumn.height = e.height;\n              columnsController.columnOption(options.dataField, \"headerFilter\", headerFilterByColumn, true);\n            });\n          },\n          onHidden: function onHidden() {\n            return (0, _accessibility.restoreFocus)(_this);\n          }\n        });\n        options.dataSource = that.getDataSource(options);\n\n        if (options.isFilterBuilder) {\n          options.dataSource.filter = null;\n          options.alignment = \"right\";\n        }\n\n        that._headerFilterView.showHeaderFilterMenu(options.columnElement, options);\n      }\n    },\n    hideHeaderFilterMenu: function hideHeaderFilterMenu() {\n      this._headerFilterView.hideHeaderFilterMenu();\n    }\n  };\n}());\n\nvar ColumnHeadersViewHeaderFilterExtender = (0, _extend.extend)({}, _uiGrid_core5.headerFilterMixin, {\n  _renderCellContent: function _renderCellContent($cell, options) {\n    var that = this;\n    var $headerFilterIndicator;\n    var column = options.column;\n\n    if (!column.command && (0, _uiGrid_core5.allowHeaderFiltering)(column) && that.option(\"headerFilter.visible\") && \"header\" === options.rowType) {\n      $headerFilterIndicator = that._applyColumnState({\n        name: \"headerFilter\",\n        rootElement: $cell,\n        column: column,\n        showColumnLines: that.option(\"showColumnLines\")\n      });\n      $headerFilterIndicator && that._subscribeToIndicatorEvent($headerFilterIndicator, column, \"headerFilter\");\n    }\n\n    that.callBase($cell, options);\n  },\n  _subscribeToIndicatorEvent: function _subscribeToIndicatorEvent($indicator, column, indicatorName) {\n    var that = this;\n\n    if (\"headerFilter\" === indicatorName) {\n      _events_engine2.default.on($indicator, _click2.default.name, that.createAction(function (e) {\n        e.event.stopPropagation();\n        that.getController(\"headerFilter\").showHeaderFilterMenu(column.index, false);\n      }));\n    }\n  },\n  _updateIndicator: function _updateIndicator($cell, column, indicatorName) {\n    var $indicator = this.callBase($cell, column, indicatorName);\n    $indicator && this._subscribeToIndicatorEvent($indicator, column, indicatorName);\n  },\n  _updateHeaderFilterIndicators: function _updateHeaderFilterIndicators() {\n    if (this.option(\"headerFilter.visible\")) {\n      this._updateIndicators(\"headerFilter\");\n    }\n  },\n  _needUpdateFilterIndicators: function _needUpdateFilterIndicators() {\n    return true;\n  },\n  _columnOptionChanged: function _columnOptionChanged(e) {\n    var optionNames = e.optionNames;\n\n    if (_uiGrid_core4.default.checkChanges(optionNames, [\"filterValues\", \"filterType\"])) {\n      if (this._needUpdateFilterIndicators()) {\n        this._updateHeaderFilterIndicators();\n      }\n\n      return;\n    }\n\n    this.callBase(e);\n  }\n});\nvar HeaderPanelHeaderFilterExtender = (0, _extend.extend)({}, _uiGrid_core5.headerFilterMixin, {\n  _createGroupPanelItem: function _createGroupPanelItem($rootElement, groupColumn) {\n    var that = this;\n    var $item = that.callBase.apply(that, arguments);\n    var $headerFilterIndicator;\n\n    if (!groupColumn.command && (0, _uiGrid_core5.allowHeaderFiltering)(groupColumn) && that.option(\"headerFilter.visible\")) {\n      $headerFilterIndicator = that._applyColumnState({\n        name: \"headerFilter\",\n        rootElement: $item,\n        column: {\n          alignment: (0, _position.getDefaultAlignment)(that.option(\"rtlEnabled\")),\n          filterValues: groupColumn.filterValues,\n          allowHeaderFiltering: true\n        },\n        showColumnLines: true\n      });\n      $headerFilterIndicator && _events_engine2.default.on($headerFilterIndicator, _click2.default.name, that.createAction(function (e) {\n        var event = e.event;\n        event.stopPropagation();\n        that.getController(\"headerFilter\").showHeaderFilterMenu(groupColumn.index, true);\n      }));\n    }\n\n    return $item;\n  }\n});\n\nfunction invertFilterExpression(filter) {\n  return [\"!\", filter];\n}\n\nvar DataControllerFilterRowExtender = {\n  skipCalculateColumnFilters: function skipCalculateColumnFilters() {\n    return false;\n  },\n  _calculateAdditionalFilter: function _calculateAdditionalFilter() {\n    if (this.skipCalculateColumnFilters()) {\n      return this.callBase();\n    }\n\n    var that = this;\n    var filters = [that.callBase()];\n\n    var columns = that._columnsController.getVisibleColumns(null, true);\n\n    var headerFilterController = that.getController(\"headerFilter\");\n    var currentColumn = headerFilterController.getCurrentColumn();\n    (0, _iterator.each)(columns, function (_, column) {\n      var filter;\n\n      if (currentColumn && currentColumn.index === column.index) {\n        return;\n      }\n\n      if ((0, _uiGrid_core5.allowHeaderFiltering)(column) && column.calculateFilterExpression && Array.isArray(column.filterValues) && column.filterValues.length) {\n        var filterValues = [];\n        (0, _iterator.each)(column.filterValues, function (_, filterValue) {\n          if (Array.isArray(filterValue)) {\n            filter = filterValue;\n          } else {\n            if (column.deserializeValue && !_uiGrid_core4.default.isDateType(column.dataType) && \"number\" !== column.dataType) {\n              filterValue = column.deserializeValue(filterValue);\n            }\n\n            filter = column.createFilterExpression(filterValue, \"=\", \"headerFilter\");\n          }\n\n          if (filter) {\n            filter.columnIndex = column.index;\n          }\n\n          filterValues.push(filter);\n        });\n        filterValues = _uiGrid_core4.default.combineFilters(filterValues, \"or\");\n        filters.push(\"exclude\" === column.filterType ? [\"!\", filterValues] : filterValues);\n      }\n    });\n    return _uiGrid_core4.default.combineFilters(filters);\n  }\n};\nmodule.exports = {\n  invertFilterExpression: invertFilterExpression,\n  defaultOptions: function defaultOptions() {\n    return {\n      headerFilter: {\n        visible: false,\n        width: 252,\n        height: 325,\n        allowSearch: false,\n        searchTimeout: 500,\n        texts: {\n          emptyValue: _message2.default.format(\"dxDataGrid-headerFilterEmptyValue\"),\n          ok: _message2.default.format(\"dxDataGrid-headerFilterOK\"),\n          cancel: _message2.default.format(\"dxDataGrid-headerFilterCancel\")\n        }\n      }\n    };\n  },\n  controllers: {\n    headerFilter: HeaderFilterController\n  },\n  views: {\n    headerFilterView: _uiGrid_core5.HeaderFilterView\n  },\n  extenders: {\n    controllers: {\n      data: DataControllerFilterRowExtender\n    },\n    views: {\n      columnHeadersView: ColumnHeadersViewHeaderFilterExtender,\n      headerPanel: HeaderPanelHeaderFilterExtender\n    }\n  }\n};","map":{"version":3,"sources":["C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/devextreme/ui/grid_core/ui.grid_core.header_filter.js"],"names":["_events_engine","require","_events_engine2","_interopRequireDefault","_uiGrid_core","_uiGrid_core2","_filtering","_filtering2","_uiGrid_core3","_uiGrid_core4","_uiGrid_core5","_message","_message2","_click","_click2","_data","_iterator","_type","_position","_extend","_data_source","_date","_date2","_variable_wrapper","_deferred","_accessibility","obj","DATE_INTERVAL_FORMATS","month","value","quarter","HeaderFilterController","getFormatOptions","groupInterval","result","column","formatOptions","format","target","firstValueText","secondValue","secondValueText","init","_updateSelectedState","i","items","isExclude","item","_normalizeGroupItem","path","options","valueSelector","displaySelector","displayValue","getHeaderItemText","text","headerFilterOptions","_processGroupItems","that","lookup","level","currentLevel","groupItems","getDataSource","dataSource","group","headerFilterDataSource","isLookup","component","cutoffLevel","Array","filter","useDefaultSearch","load","d","origPostProcess","getCurrentColumn","showHeaderFilterMenu","columnsController","visibleIndex","view","isGroupPanel","$columnElement","columnElement","applyFilter","apply","filterValues","filterType","showHeaderFilterMenuBase","_this","remoteFiltering","type","onShowing","dxResizableInstance","e","headerFilterByColumn","onHidden","hideHeaderFilterMenu","ColumnHeadersViewHeaderFilterExtender","_renderCellContent","$headerFilterIndicator","name","rootElement","showColumnLines","_subscribeToIndicatorEvent","_updateIndicator","$indicator","_updateHeaderFilterIndicators","_needUpdateFilterIndicators","_columnOptionChanged","optionNames","HeaderPanelHeaderFilterExtender","_createGroupPanelItem","$item","groupColumn","alignment","allowHeaderFiltering","event","DataControllerFilterRowExtender","skipCalculateColumnFilters","_calculateAdditionalFilter","filters","columns","headerFilterController","currentColumn","filterValue","module","invertFilterExpression","defaultOptions","headerFilter","visible","width","height","allowSearch","searchTimeout","texts","emptyValue","ok","cancel","controllers","views","headerFilterView","HeaderFilterView","extenders","data","columnHeadersView","headerPanel"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/grid_core/ui.grid_core.header_filter.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar _events_engine = require(\"../../events/core/events_engine\");\r\nvar _events_engine2 = _interopRequireDefault(_events_engine);\r\nvar _uiGrid_core = require(\"./ui.grid_core.modules\");\r\nvar _uiGrid_core2 = _interopRequireDefault(_uiGrid_core);\r\nvar _filtering = require(\"../shared/filtering\");\r\nvar _filtering2 = _interopRequireDefault(_filtering);\r\nvar _uiGrid_core3 = require(\"./ui.grid_core.utils\");\r\nvar _uiGrid_core4 = _interopRequireDefault(_uiGrid_core3);\r\nvar _uiGrid_core5 = require(\"./ui.grid_core.header_filter_core\");\r\nvar _message = require(\"../../localization/message\");\r\nvar _message2 = _interopRequireDefault(_message);\r\nvar _click = require(\"../../events/click\");\r\nvar _click2 = _interopRequireDefault(_click);\r\nvar _data = require(\"../../core/utils/data\");\r\nvar _iterator = require(\"../../core/utils/iterator\");\r\nvar _type = require(\"../../core/utils/type\");\r\nvar _position = require(\"../../core/utils/position\");\r\nvar _extend = require(\"../../core/utils/extend\");\r\nvar _data_source = require(\"../../data/data_source/data_source\");\r\nvar _date = require(\"../../localization/date\");\r\nvar _date2 = _interopRequireDefault(_date);\r\nvar _variable_wrapper = require(\"../../core/utils/variable_wrapper\");\r\nvar _deferred = require(\"../../core/utils/deferred\");\r\nvar _accessibility = require(\"../shared/accessibility\");\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\nvar DATE_INTERVAL_FORMATS = {\r\n    month: function(value) {\r\n        return _date2.default.getMonthNames()[value - 1]\r\n    },\r\n    quarter: function(value) {\r\n        return _date2.default.format(new Date(2e3, 3 * value - 1), \"quarter\")\r\n    }\r\n};\r\nvar HeaderFilterController = _uiGrid_core2.default.ViewController.inherit(function() {\r\n    var getFormatOptions = function(value, column, currentLevel) {\r\n        var groupInterval = _filtering2.default.getGroupInterval(column);\r\n        var result = _uiGrid_core4.default.getFormatOptionsByColumn(column, \"headerFilter\");\r\n        if (groupInterval) {\r\n            result.groupInterval = groupInterval[currentLevel];\r\n            if (_uiGrid_core4.default.isDateType(column.dataType)) {\r\n                result.format = DATE_INTERVAL_FORMATS[groupInterval[currentLevel]]\r\n            } else {\r\n                if (\"number\" === column.dataType) {\r\n                    result.getDisplayFormat = function() {\r\n                        var formatOptions = {\r\n                            format: column.format,\r\n                            target: \"headerFilter\"\r\n                        };\r\n                        var firstValueText = _uiGrid_core4.default.formatValue(value, formatOptions);\r\n                        var secondValue = value + groupInterval[currentLevel];\r\n                        var secondValueText = _uiGrid_core4.default.formatValue(secondValue, formatOptions);\r\n                        return firstValueText && secondValueText ? firstValueText + \" - \" + secondValueText : \"\"\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return result\r\n    };\r\n    return {\r\n        init: function() {\r\n            this._columnsController = this.getController(\"columns\");\r\n            this._dataController = this.getController(\"data\");\r\n            this._headerFilterView = this.getView(\"headerFilterView\")\r\n        },\r\n        _updateSelectedState: function(items, column) {\r\n            var i = items.length;\r\n            var isExclude = \"exclude\" === column.filterType;\r\n            while (i--) {\r\n                var item = items[i];\r\n                if (\"items\" in items[i]) {\r\n                    this._updateSelectedState(items[i].items, column)\r\n                }(0, _uiGrid_core5.updateHeaderFilterItemSelectionState)(item, _uiGrid_core4.default.getIndexByKey(items[i].value, column.filterValues, null) > -1, isExclude)\r\n            }\r\n        },\r\n        _normalizeGroupItem: function(item, currentLevel, options) {\r\n            var value;\r\n            var displayValue;\r\n            var path = options.path;\r\n            var valueSelector = options.valueSelector;\r\n            var displaySelector = options.displaySelector;\r\n            var column = options.column;\r\n            if (valueSelector && displaySelector) {\r\n                value = valueSelector(item);\r\n                displayValue = displaySelector(item)\r\n            } else {\r\n                value = item.key;\r\n                displayValue = value\r\n            }\r\n            if (!(0, _type.isObject)(item)) {\r\n                item = {}\r\n            } else {\r\n                item = (0, _extend.extend)({}, item)\r\n            }\r\n            path.push(value);\r\n            if (1 === path.length) {\r\n                item.value = path[0]\r\n            } else {\r\n                item.value = path.join(\"/\")\r\n            }\r\n            item.text = this.getHeaderItemText(displayValue, column, currentLevel, options.headerFilterOptions);\r\n            return item\r\n        },\r\n        getHeaderItemText: function(displayValue, column, currentLevel, headerFilterOptions) {\r\n            var text = _uiGrid_core4.default.formatValue(displayValue, getFormatOptions(displayValue, column, currentLevel));\r\n            if (!text) {\r\n                text = headerFilterOptions.texts.emptyValue\r\n            }\r\n            return text\r\n        },\r\n        _processGroupItems: function(groupItems, currentLevel, path, options) {\r\n            var that = this;\r\n            var displaySelector;\r\n            var valueSelector;\r\n            var column = options.column;\r\n            var lookup = column.lookup;\r\n            var level = options.level;\r\n            path = path || [];\r\n            currentLevel = currentLevel || 0;\r\n            if (lookup) {\r\n                displaySelector = (0, _data.compileGetter)(lookup.displayExpr);\r\n                valueSelector = (0, _data.compileGetter)(lookup.valueExpr)\r\n            }\r\n            for (var i = 0; i < groupItems.length; i++) {\r\n                groupItems[i] = that._normalizeGroupItem(groupItems[i], currentLevel, {\r\n                    column: options.column,\r\n                    headerFilterOptions: options.headerFilterOptions,\r\n                    displaySelector: displaySelector,\r\n                    valueSelector: valueSelector,\r\n                    path: path\r\n                });\r\n                if (\"items\" in groupItems[i]) {\r\n                    if (currentLevel === level || !(0, _type.isDefined)(groupItems[i].value)) {\r\n                        delete groupItems[i].items\r\n                    } else {\r\n                        that._processGroupItems(groupItems[i].items, currentLevel + 1, path, options)\r\n                    }\r\n                }\r\n                path.pop()\r\n            }\r\n        },\r\n        getDataSource: function(column) {\r\n            var that = this;\r\n            var filter;\r\n            var cutoffLevel;\r\n            var origPostProcess;\r\n            var dataSource = that._dataController.dataSource();\r\n            var group = _uiGrid_core4.default.getHeaderFilterGroupParameters(column, dataSource && dataSource.remoteOperations().grouping);\r\n            var headerFilterDataSource = column.headerFilter && column.headerFilter.dataSource;\r\n            var headerFilterOptions = that.option(\"headerFilter\");\r\n            var isLookup = false;\r\n            var options = {\r\n                component: that.component\r\n            };\r\n            if (!dataSource) {\r\n                return\r\n            }\r\n            if ((0, _type.isDefined)(headerFilterDataSource) && !(0, _type.isFunction)(headerFilterDataSource)) {\r\n                options.dataSource = (0, _data_source.normalizeDataSourceOptions)(headerFilterDataSource)\r\n            } else {\r\n                if (column.lookup) {\r\n                    isLookup = true;\r\n                    dataSource = column.lookup.dataSource;\r\n                    if ((0, _type.isFunction)(dataSource) && !(0, _variable_wrapper.isWrapped)(dataSource)) {\r\n                        dataSource = dataSource({})\r\n                    }\r\n                    dataSource = (0, _data_source.normalizeDataSourceOptions)(dataSource);\r\n                    options.dataSource = dataSource\r\n                } else {\r\n                    cutoffLevel = Array.isArray(group) ? group.length - 1 : 0;\r\n                    that._currentColumn = column;\r\n                    filter = that._dataController.getCombinedFilter();\r\n                    that._currentColumn = null;\r\n                    options.dataSource = {\r\n                        filter: filter,\r\n                        group: group,\r\n                        useDefaultSearch: true,\r\n                        load: function(options) {\r\n                            var d = new _deferred.Deferred;\r\n                            options.dataField = column.dataField || column.name;\r\n                            dataSource.load(options).done(function(data) {\r\n                                that._processGroupItems(data, null, null, {\r\n                                    level: cutoffLevel,\r\n                                    column: column,\r\n                                    headerFilterOptions: headerFilterOptions\r\n                                });\r\n                                d.resolve(data)\r\n                            }).fail(d.reject);\r\n                            return d\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            if ((0, _type.isFunction)(headerFilterDataSource)) {\r\n                headerFilterDataSource.call(column, options)\r\n            }\r\n            origPostProcess = options.dataSource.postProcess;\r\n            options.dataSource.postProcess = function(data) {\r\n                var items = data;\r\n                if (isLookup) {\r\n                    if (0 === this.pageIndex() && !this.searchValue()) {\r\n                        items = items.slice(0);\r\n                        items.unshift(null)\r\n                    }\r\n                    that._processGroupItems(items, null, null, {\r\n                        level: 0,\r\n                        column: column,\r\n                        headerFilterOptions: headerFilterOptions\r\n                    })\r\n                }\r\n                items = origPostProcess && origPostProcess.call(this, items) || items;\r\n                that._updateSelectedState(items, column);\r\n                return items\r\n            };\r\n            return options.dataSource\r\n        },\r\n        getCurrentColumn: function() {\r\n            return this._currentColumn\r\n        },\r\n        showHeaderFilterMenu: function(columnIndex, isGroupPanel) {\r\n            var columnsController = this._columnsController;\r\n            var column = (0, _extend.extend)(true, {}, this._columnsController.getColumns()[columnIndex]);\r\n            if (column) {\r\n                var visibleIndex = columnsController.getVisibleIndex(columnIndex);\r\n                var view = isGroupPanel ? this.getView(\"headerPanel\") : this.getView(\"columnHeadersView\");\r\n                var $columnElement = $columnElement || view.getColumnElements().eq(isGroupPanel ? column.groupIndex : visibleIndex);\r\n                this.showHeaderFilterMenuBase({\r\n                    columnElement: $columnElement,\r\n                    column: column,\r\n                    applyFilter: true,\r\n                    apply: function() {\r\n                        columnsController.columnOption(columnIndex, {\r\n                            filterValues: this.filterValues,\r\n                            filterType: this.filterType\r\n                        })\r\n                    }\r\n                })\r\n            }\r\n        },\r\n        showHeaderFilterMenuBase: function(options) {\r\n            var _this = this;\r\n            var that = this;\r\n            var column = options.column;\r\n            if (column) {\r\n                var groupInterval = _filtering2.default.getGroupInterval(column);\r\n                var dataSource = that._dataController.dataSource();\r\n                var remoteFiltering = dataSource && dataSource.remoteOperations().filtering;\r\n                (0, _extend.extend)(options, column, {\r\n                    type: groupInterval && groupInterval.length > 1 ? \"tree\" : \"list\",\r\n                    remoteFiltering: remoteFiltering,\r\n                    onShowing: function(e) {\r\n                        var dxResizableInstance = e.component.overlayContent().dxResizable(\"instance\");\r\n                        dxResizableInstance && dxResizableInstance.option(\"onResizeEnd\", function(e) {\r\n                            var columnsController = that.getController(\"columns\");\r\n                            var headerFilterByColumn = columnsController.columnOption(options.dataField, \"headerFilter\");\r\n                            headerFilterByColumn = headerFilterByColumn || {};\r\n                            headerFilterByColumn.width = e.width;\r\n                            headerFilterByColumn.height = e.height;\r\n                            columnsController.columnOption(options.dataField, \"headerFilter\", headerFilterByColumn, true)\r\n                        })\r\n                    },\r\n                    onHidden: function() {\r\n                        return (0, _accessibility.restoreFocus)(_this)\r\n                    }\r\n                });\r\n                options.dataSource = that.getDataSource(options);\r\n                if (options.isFilterBuilder) {\r\n                    options.dataSource.filter = null;\r\n                    options.alignment = \"right\"\r\n                }\r\n                that._headerFilterView.showHeaderFilterMenu(options.columnElement, options)\r\n            }\r\n        },\r\n        hideHeaderFilterMenu: function() {\r\n            this._headerFilterView.hideHeaderFilterMenu()\r\n        }\r\n    }\r\n}());\r\nvar ColumnHeadersViewHeaderFilterExtender = (0, _extend.extend)({}, _uiGrid_core5.headerFilterMixin, {\r\n    _renderCellContent: function($cell, options) {\r\n        var that = this;\r\n        var $headerFilterIndicator;\r\n        var column = options.column;\r\n        if (!column.command && (0, _uiGrid_core5.allowHeaderFiltering)(column) && that.option(\"headerFilter.visible\") && \"header\" === options.rowType) {\r\n            $headerFilterIndicator = that._applyColumnState({\r\n                name: \"headerFilter\",\r\n                rootElement: $cell,\r\n                column: column,\r\n                showColumnLines: that.option(\"showColumnLines\")\r\n            });\r\n            $headerFilterIndicator && that._subscribeToIndicatorEvent($headerFilterIndicator, column, \"headerFilter\")\r\n        }\r\n        that.callBase($cell, options)\r\n    },\r\n    _subscribeToIndicatorEvent: function($indicator, column, indicatorName) {\r\n        var that = this;\r\n        if (\"headerFilter\" === indicatorName) {\r\n            _events_engine2.default.on($indicator, _click2.default.name, that.createAction(function(e) {\r\n                e.event.stopPropagation();\r\n                that.getController(\"headerFilter\").showHeaderFilterMenu(column.index, false)\r\n            }))\r\n        }\r\n    },\r\n    _updateIndicator: function($cell, column, indicatorName) {\r\n        var $indicator = this.callBase($cell, column, indicatorName);\r\n        $indicator && this._subscribeToIndicatorEvent($indicator, column, indicatorName)\r\n    },\r\n    _updateHeaderFilterIndicators: function() {\r\n        if (this.option(\"headerFilter.visible\")) {\r\n            this._updateIndicators(\"headerFilter\")\r\n        }\r\n    },\r\n    _needUpdateFilterIndicators: function() {\r\n        return true\r\n    },\r\n    _columnOptionChanged: function(e) {\r\n        var optionNames = e.optionNames;\r\n        if (_uiGrid_core4.default.checkChanges(optionNames, [\"filterValues\", \"filterType\"])) {\r\n            if (this._needUpdateFilterIndicators()) {\r\n                this._updateHeaderFilterIndicators()\r\n            }\r\n            return\r\n        }\r\n        this.callBase(e)\r\n    }\r\n});\r\nvar HeaderPanelHeaderFilterExtender = (0, _extend.extend)({}, _uiGrid_core5.headerFilterMixin, {\r\n    _createGroupPanelItem: function($rootElement, groupColumn) {\r\n        var that = this;\r\n        var $item = that.callBase.apply(that, arguments);\r\n        var $headerFilterIndicator;\r\n        if (!groupColumn.command && (0, _uiGrid_core5.allowHeaderFiltering)(groupColumn) && that.option(\"headerFilter.visible\")) {\r\n            $headerFilterIndicator = that._applyColumnState({\r\n                name: \"headerFilter\",\r\n                rootElement: $item,\r\n                column: {\r\n                    alignment: (0, _position.getDefaultAlignment)(that.option(\"rtlEnabled\")),\r\n                    filterValues: groupColumn.filterValues,\r\n                    allowHeaderFiltering: true\r\n                },\r\n                showColumnLines: true\r\n            });\r\n            $headerFilterIndicator && _events_engine2.default.on($headerFilterIndicator, _click2.default.name, that.createAction(function(e) {\r\n                var event = e.event;\r\n                event.stopPropagation();\r\n                that.getController(\"headerFilter\").showHeaderFilterMenu(groupColumn.index, true)\r\n            }))\r\n        }\r\n        return $item\r\n    }\r\n});\r\n\r\nfunction invertFilterExpression(filter) {\r\n    return [\"!\", filter]\r\n}\r\nvar DataControllerFilterRowExtender = {\r\n    skipCalculateColumnFilters: function() {\r\n        return false\r\n    },\r\n    _calculateAdditionalFilter: function() {\r\n        if (this.skipCalculateColumnFilters()) {\r\n            return this.callBase()\r\n        }\r\n        var that = this;\r\n        var filters = [that.callBase()];\r\n        var columns = that._columnsController.getVisibleColumns(null, true);\r\n        var headerFilterController = that.getController(\"headerFilter\");\r\n        var currentColumn = headerFilterController.getCurrentColumn();\r\n        (0, _iterator.each)(columns, function(_, column) {\r\n            var filter;\r\n            if (currentColumn && currentColumn.index === column.index) {\r\n                return\r\n            }\r\n            if ((0, _uiGrid_core5.allowHeaderFiltering)(column) && column.calculateFilterExpression && Array.isArray(column.filterValues) && column.filterValues.length) {\r\n                var filterValues = [];\r\n                (0, _iterator.each)(column.filterValues, function(_, filterValue) {\r\n                    if (Array.isArray(filterValue)) {\r\n                        filter = filterValue\r\n                    } else {\r\n                        if (column.deserializeValue && !_uiGrid_core4.default.isDateType(column.dataType) && \"number\" !== column.dataType) {\r\n                            filterValue = column.deserializeValue(filterValue)\r\n                        }\r\n                        filter = column.createFilterExpression(filterValue, \"=\", \"headerFilter\")\r\n                    }\r\n                    if (filter) {\r\n                        filter.columnIndex = column.index\r\n                    }\r\n                    filterValues.push(filter)\r\n                });\r\n                filterValues = _uiGrid_core4.default.combineFilters(filterValues, \"or\");\r\n                filters.push(\"exclude\" === column.filterType ? [\"!\", filterValues] : filterValues)\r\n            }\r\n        });\r\n        return _uiGrid_core4.default.combineFilters(filters)\r\n    }\r\n};\r\nmodule.exports = {\r\n    invertFilterExpression: invertFilterExpression,\r\n    defaultOptions: function() {\r\n        return {\r\n            headerFilter: {\r\n                visible: false,\r\n                width: 252,\r\n                height: 325,\r\n                allowSearch: false,\r\n                searchTimeout: 500,\r\n                texts: {\r\n                    emptyValue: _message2.default.format(\"dxDataGrid-headerFilterEmptyValue\"),\r\n                    ok: _message2.default.format(\"dxDataGrid-headerFilterOK\"),\r\n                    cancel: _message2.default.format(\"dxDataGrid-headerFilterCancel\")\r\n                }\r\n            }\r\n        }\r\n    },\r\n    controllers: {\r\n        headerFilter: HeaderFilterController\r\n    },\r\n    views: {\r\n        headerFilterView: _uiGrid_core5.HeaderFilterView\r\n    },\r\n    extenders: {\r\n        controllers: {\r\n            data: DataControllerFilterRowExtender\r\n        },\r\n        views: {\r\n            columnHeadersView: ColumnHeadersViewHeaderFilterExtender,\r\n            headerPanel: HeaderPanelHeaderFilterExtender\r\n        }\r\n    }\r\n};\r\n"]},"metadata":{},"sourceType":"module"}