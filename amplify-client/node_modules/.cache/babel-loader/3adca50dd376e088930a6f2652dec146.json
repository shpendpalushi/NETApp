{"ast":null,"code":"/**\r\n * DevExtreme (ui/map/provider.dynamic.google.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar $ = require(\"../../core/renderer\");\n\nvar window = require(\"../../core/utils/window\").getWindow();\n\nvar noop = require(\"../../core/utils/common\").noop;\n\nvar devices = require(\"../../core/devices\");\n\nvar Promise = require(\"../../core/polyfills/promise\");\n\nvar extend = require(\"../../core/utils/extend\").extend;\n\nvar map = require(\"../../core/utils/iterator\").map;\n\nvar DynamicProvider = require(\"./provider.dynamic\");\n\nvar errors = require(\"../widget/ui.errors\");\n\nvar Color = require(\"../../color\");\n\nvar ajax = require(\"../../core/utils/ajax\");\n\nvar isDefined = require(\"../../core/utils/type\").isDefined;\n\nvar GOOGLE_MAP_READY = \"_googleScriptReady\";\nvar GOOGLE_URL = \"https://maps.googleapis.com/maps/api/js?callback=\" + GOOGLE_MAP_READY;\nvar INFO_WINDOW_CLASS = \"gm-style-iw\";\nvar CustomMarker;\n\nvar initCustomMarkerClass = function initCustomMarkerClass() {\n  CustomMarker = function CustomMarker(options) {\n    this._position = options.position;\n    this._offset = options.offset;\n    this._$overlayContainer = $(\"<div>\").css({\n      position: \"absolute\",\n      display: \"none\",\n      cursor: \"pointer\"\n    }).append(options.html);\n    this.setMap(options.map);\n  };\n\n  CustomMarker.prototype = new google.maps.OverlayView();\n\n  CustomMarker.prototype.onAdd = function () {\n    var $pane = $(this.getPanes().overlayMouseTarget);\n    $pane.append(this._$overlayContainer);\n    this._clickListener = google.maps.event.addDomListener(this._$overlayContainer.get(0), \"click\", function (e) {\n      google.maps.event.trigger(this, \"click\");\n      e.preventDefault();\n    }.bind(this));\n    this.draw();\n  };\n\n  CustomMarker.prototype.onRemove = function () {\n    google.maps.event.removeListener(this._clickListener);\n\n    this._$overlayContainer.remove();\n  };\n\n  CustomMarker.prototype.draw = function () {\n    var position = this.getProjection().fromLatLngToDivPixel(this._position);\n\n    this._$overlayContainer.css({\n      left: position.x + this._offset.left,\n      top: position.y + this._offset.top,\n      display: \"block\"\n    });\n  };\n};\n\nvar googleMapsLoaded = function googleMapsLoaded() {\n  return window.google && window.google.maps;\n};\n\nvar googleMapsLoader;\nvar GoogleProvider = DynamicProvider.inherit({\n  _mapType: function _mapType(type) {\n    var mapTypes = {\n      hybrid: google.maps.MapTypeId.HYBRID,\n      roadmap: google.maps.MapTypeId.ROADMAP,\n      satellite: google.maps.MapTypeId.SATELLITE\n    };\n    return mapTypes[type] || mapTypes.hybrid;\n  },\n  _movementMode: function _movementMode(type) {\n    var movementTypes = {\n      driving: google.maps.TravelMode.DRIVING,\n      walking: google.maps.TravelMode.WALKING\n    };\n    return movementTypes[type] || movementTypes.driving;\n  },\n  _resolveLocation: function _resolveLocation(location) {\n    return new Promise(function (resolve) {\n      var latLng = this._getLatLng(location);\n\n      if (latLng) {\n        resolve(new google.maps.LatLng(latLng.lat, latLng.lng));\n      } else {\n        this._geocodeLocation(location).then(function (geocodedLocation) {\n          resolve(geocodedLocation);\n        });\n      }\n    }.bind(this));\n  },\n  _geocodedLocations: {},\n  _geocodeLocationImpl: function _geocodeLocationImpl(location) {\n    return new Promise(function (resolve) {\n      if (!isDefined(location)) {\n        resolve(new google.maps.LatLng(0, 0));\n        return;\n      }\n\n      var geocoder = new google.maps.Geocoder();\n      geocoder.geocode({\n        address: location\n      }, function (results, status) {\n        if (status === google.maps.GeocoderStatus.OK) {\n          resolve(results[0].geometry.location);\n        } else {\n          errors.log(\"W1006\", status);\n          resolve(new google.maps.LatLng(0, 0));\n        }\n      });\n    });\n  },\n  _normalizeLocation: function _normalizeLocation(location) {\n    return {\n      lat: location.lat(),\n      lng: location.lng()\n    };\n  },\n  _normalizeLocationRect: function _normalizeLocationRect(locationRect) {\n    return {\n      northEast: this._normalizeLocation(locationRect.getNorthEast()),\n      southWest: this._normalizeLocation(locationRect.getSouthWest())\n    };\n  },\n  _loadImpl: function _loadImpl() {\n    return new Promise(function (resolve) {\n      if (googleMapsLoaded()) {\n        resolve();\n      } else {\n        if (!googleMapsLoader) {\n          googleMapsLoader = this._loadMapScript();\n        }\n\n        googleMapsLoader.then(function () {\n          if (googleMapsLoaded()) {\n            resolve();\n            return;\n          }\n\n          this._loadMapScript().then(resolve);\n        }.bind(this));\n      }\n    }.bind(this)).then(function () {\n      initCustomMarkerClass();\n    });\n  },\n  _loadMapScript: function _loadMapScript() {\n    return new Promise(function (resolve) {\n      var key = this._keyOption(\"google\");\n\n      window[GOOGLE_MAP_READY] = resolve;\n      ajax.sendRequest({\n        url: GOOGLE_URL + (key ? \"&key=\" + key : \"\"),\n        dataType: \"script\"\n      });\n    }.bind(this)).then(function () {\n      try {\n        delete window[GOOGLE_MAP_READY];\n      } catch (e) {\n        window[GOOGLE_MAP_READY] = void 0;\n      }\n    });\n  },\n  _init: function _init() {\n    return new Promise(function (resolve) {\n      this._resolveLocation(this._option(\"center\")).then(function (center) {\n        var showDefaultUI = this._option(\"controls\");\n\n        this._map = new google.maps.Map(this._$container[0], {\n          zoom: this._option(\"zoom\"),\n          center: center,\n          disableDefaultUI: !showDefaultUI\n        });\n        var listener = google.maps.event.addListener(this._map, \"idle\", function () {\n          resolve(listener);\n        });\n      }.bind(this));\n    }.bind(this)).then(function (listener) {\n      google.maps.event.removeListener(listener);\n    });\n  },\n  _attachHandlers: function _attachHandlers() {\n    this._boundsChangeListener = google.maps.event.addListener(this._map, \"bounds_changed\", this._boundsChangeHandler.bind(this));\n    this._clickListener = google.maps.event.addListener(this._map, \"click\", this._clickActionHandler.bind(this));\n  },\n  _boundsChangeHandler: function _boundsChangeHandler() {\n    var bounds = this._map.getBounds();\n\n    this._option(\"bounds\", this._normalizeLocationRect(bounds));\n\n    var center = this._map.getCenter();\n\n    this._option(\"center\", this._normalizeLocation(center));\n\n    if (!this._preventZoomChangeEvent) {\n      this._option(\"zoom\", this._map.getZoom());\n    }\n  },\n  _clickActionHandler: function _clickActionHandler(e) {\n    this._fireClickAction({\n      location: this._normalizeLocation(e.latLng)\n    });\n  },\n  updateDimensions: function updateDimensions() {\n    var center = this._option(\"center\");\n\n    google.maps.event.trigger(this._map, \"resize\");\n\n    this._option(\"center\", center);\n\n    return this.updateCenter();\n  },\n  updateMapType: function updateMapType() {\n    this._map.setMapTypeId(this._mapType(this._option(\"type\")));\n\n    return Promise.resolve();\n  },\n  updateBounds: function updateBounds() {\n    return Promise.all([this._resolveLocation(this._option(\"bounds.northEast\")), this._resolveLocation(this._option(\"bounds.southWest\"))]).then(function (result) {\n      var bounds = new google.maps.LatLngBounds();\n      bounds.extend(result[0]);\n      bounds.extend(result[1]);\n\n      this._map.fitBounds(bounds);\n    }.bind(this));\n  },\n  updateCenter: function updateCenter() {\n    return this._resolveLocation(this._option(\"center\")).then(function (center) {\n      this._map.setCenter(center);\n\n      this._option(\"center\", this._normalizeLocation(center));\n    }.bind(this));\n  },\n  updateZoom: function updateZoom() {\n    this._map.setZoom(this._option(\"zoom\"));\n\n    return Promise.resolve();\n  },\n  updateControls: function updateControls() {\n    var showDefaultUI = this._option(\"controls\");\n\n    this._map.setOptions({\n      disableDefaultUI: !showDefaultUI\n    });\n\n    return Promise.resolve();\n  },\n  isEventsCanceled: function isEventsCanceled(e) {\n    var gestureHandling = this._map && this._map.get(\"gestureHandling\");\n\n    var isInfoWindowContent = $(e.target).closest(\".\".concat(INFO_WINDOW_CLASS)).length > 0;\n\n    if (isInfoWindowContent || \"desktop\" !== devices.real().deviceType && \"cooperative\" === gestureHandling) {\n      return false;\n    }\n\n    return this.callBase();\n  },\n  _renderMarker: function _renderMarker(options) {\n    return this._resolveLocation(options.location).then(function (location) {\n      var marker;\n\n      if (options.html) {\n        marker = new CustomMarker({\n          map: this._map,\n          position: location,\n          html: options.html,\n          offset: extend({\n            top: 0,\n            left: 0\n          }, options.htmlOffset)\n        });\n      } else {\n        marker = new google.maps.Marker({\n          position: location,\n          map: this._map,\n          icon: options.iconSrc || this._option(\"markerIconSrc\")\n        });\n      }\n\n      var infoWindow = this._renderTooltip(marker, options.tooltip);\n\n      var listener;\n\n      if (options.onClick || options.tooltip) {\n        var markerClickAction = this._mapWidget._createAction(options.onClick || noop);\n\n        var markerNormalizedLocation = this._normalizeLocation(location);\n\n        listener = google.maps.event.addListener(marker, \"click\", function () {\n          markerClickAction({\n            location: markerNormalizedLocation\n          });\n\n          if (infoWindow) {\n            infoWindow.open(this._map, marker);\n          }\n        }.bind(this));\n      }\n\n      return {\n        location: location,\n        marker: marker,\n        listener: listener\n      };\n    }.bind(this));\n  },\n  _renderTooltip: function _renderTooltip(marker, options) {\n    if (!options) {\n      return;\n    }\n\n    options = this._parseTooltipOptions(options);\n    var infoWindow = new google.maps.InfoWindow({\n      content: options.text\n    });\n\n    if (options.visible) {\n      infoWindow.open(this._map, marker);\n    }\n\n    return infoWindow;\n  },\n  _destroyMarker: function _destroyMarker(marker) {\n    marker.marker.setMap(null);\n\n    if (marker.listener) {\n      google.maps.event.removeListener(marker.listener);\n    }\n  },\n  _renderRoute: function _renderRoute(options) {\n    return Promise.all(map(options.locations, function (point) {\n      return this._resolveLocation(point);\n    }.bind(this))).then(function (locations) {\n      return new Promise(function (resolve) {\n        var origin = locations.shift();\n        var destination = locations.pop();\n        var waypoints = map(locations, function (location) {\n          return {\n            location: location,\n            stopover: true\n          };\n        });\n        var request = {\n          origin: origin,\n          destination: destination,\n          waypoints: waypoints,\n          optimizeWaypoints: true,\n          travelMode: this._movementMode(options.mode)\n        };\n        new google.maps.DirectionsService().route(request, function (response, status) {\n          if (status === google.maps.DirectionsStatus.OK) {\n            var color = new Color(options.color || this._defaultRouteColor()).toHex();\n            var directionOptions = {\n              directions: response,\n              map: this._map,\n              suppressMarkers: true,\n              preserveViewport: true,\n              polylineOptions: {\n                strokeWeight: options.weight || this._defaultRouteWeight(),\n                strokeOpacity: options.opacity || this._defaultRouteOpacity(),\n                strokeColor: color\n              }\n            };\n            var route = new google.maps.DirectionsRenderer(directionOptions);\n            var bounds = response.routes[0].bounds;\n            resolve({\n              instance: route,\n              northEast: bounds.getNorthEast(),\n              southWest: bounds.getSouthWest()\n            });\n          } else {\n            errors.log(\"W1006\", status);\n            resolve({\n              instance: new google.maps.DirectionsRenderer({})\n            });\n          }\n        }.bind(this));\n      }.bind(this));\n    }.bind(this));\n  },\n  _destroyRoute: function _destroyRoute(routeObject) {\n    routeObject.instance.setMap(null);\n  },\n  _fitBounds: function _fitBounds() {\n    this._updateBounds();\n\n    if (this._bounds && this._option(\"autoAdjust\")) {\n      var zoomBeforeFitting = this._map.getZoom();\n\n      this._preventZoomChangeEvent = true;\n\n      this._map.fitBounds(this._bounds);\n\n      this._boundsChangeHandler();\n\n      var zoomAfterFitting = this._map.getZoom();\n\n      if (zoomBeforeFitting < zoomAfterFitting) {\n        this._map.setZoom(zoomBeforeFitting);\n      } else {\n        this._option(\"zoom\", zoomAfterFitting);\n      }\n\n      delete this._preventZoomChangeEvent;\n    }\n\n    return Promise.resolve();\n  },\n  _extendBounds: function _extendBounds(location) {\n    if (this._bounds) {\n      this._bounds.extend(location);\n    } else {\n      this._bounds = new google.maps.LatLngBounds();\n\n      this._bounds.extend(location);\n    }\n  },\n  clean: function clean() {\n    if (this._map) {\n      google.maps.event.removeListener(this._boundsChangeListener);\n      google.maps.event.removeListener(this._clickListener);\n\n      this._clearMarkers();\n\n      this._clearRoutes();\n\n      delete this._map;\n\n      this._$container.empty();\n    }\n\n    return Promise.resolve();\n  }\n});\nmodule.exports = GoogleProvider;","map":{"version":3,"sources":["C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/devextreme/ui/map/provider.dynamic.google.js"],"names":["$","require","window","noop","devices","Promise","extend","map","DynamicProvider","errors","Color","ajax","isDefined","GOOGLE_MAP_READY","GOOGLE_URL","INFO_WINDOW_CLASS","initCustomMarkerClass","CustomMarker","options","position","display","cursor","google","$pane","e","left","top","googleMapsLoaded","GoogleProvider","_mapType","mapTypes","hybrid","roadmap","satellite","SATELLITE","_movementMode","movementTypes","driving","walking","WALKING","_resolveLocation","latLng","resolve","_geocodedLocations","_geocodeLocationImpl","geocoder","address","location","status","results","_normalizeLocation","lat","lng","_normalizeLocationRect","northEast","locationRect","southWest","_loadImpl","googleMapsLoader","_loadMapScript","key","url","dataType","_init","showDefaultUI","zoom","center","disableDefaultUI","listener","_attachHandlers","_boundsChangeHandler","bounds","_clickActionHandler","updateDimensions","updateMapType","updateBounds","result","updateCenter","updateZoom","updateControls","isEventsCanceled","gestureHandling","isInfoWindowContent","_renderMarker","marker","html","offset","icon","infoWindow","markerClickAction","markerNormalizedLocation","_renderTooltip","content","text","_destroyMarker","_renderRoute","origin","locations","destination","waypoints","stopover","request","optimizeWaypoints","travelMode","color","directionOptions","directions","suppressMarkers","preserveViewport","polylineOptions","strokeWeight","strokeOpacity","strokeColor","route","response","instance","_destroyRoute","routeObject","_fitBounds","zoomBeforeFitting","zoomAfterFitting","_extendBounds","clean","module"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/map/provider.dynamic.google.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar $ = require(\"../../core/renderer\");\r\nvar window = require(\"../../core/utils/window\").getWindow();\r\nvar noop = require(\"../../core/utils/common\").noop;\r\nvar devices = require(\"../../core/devices\");\r\nvar Promise = require(\"../../core/polyfills/promise\");\r\nvar extend = require(\"../../core/utils/extend\").extend;\r\nvar map = require(\"../../core/utils/iterator\").map;\r\nvar DynamicProvider = require(\"./provider.dynamic\");\r\nvar errors = require(\"../widget/ui.errors\");\r\nvar Color = require(\"../../color\");\r\nvar ajax = require(\"../../core/utils/ajax\");\r\nvar isDefined = require(\"../../core/utils/type\").isDefined;\r\nvar GOOGLE_MAP_READY = \"_googleScriptReady\";\r\nvar GOOGLE_URL = \"https://maps.googleapis.com/maps/api/js?callback=\" + GOOGLE_MAP_READY;\r\nvar INFO_WINDOW_CLASS = \"gm-style-iw\";\r\nvar CustomMarker;\r\nvar initCustomMarkerClass = function() {\r\n    CustomMarker = function(options) {\r\n        this._position = options.position;\r\n        this._offset = options.offset;\r\n        this._$overlayContainer = $(\"<div>\").css({\r\n            position: \"absolute\",\r\n            display: \"none\",\r\n            cursor: \"pointer\"\r\n        }).append(options.html);\r\n        this.setMap(options.map)\r\n    };\r\n    CustomMarker.prototype = new google.maps.OverlayView;\r\n    CustomMarker.prototype.onAdd = function() {\r\n        var $pane = $(this.getPanes().overlayMouseTarget);\r\n        $pane.append(this._$overlayContainer);\r\n        this._clickListener = google.maps.event.addDomListener(this._$overlayContainer.get(0), \"click\", function(e) {\r\n            google.maps.event.trigger(this, \"click\");\r\n            e.preventDefault()\r\n        }.bind(this));\r\n        this.draw()\r\n    };\r\n    CustomMarker.prototype.onRemove = function() {\r\n        google.maps.event.removeListener(this._clickListener);\r\n        this._$overlayContainer.remove()\r\n    };\r\n    CustomMarker.prototype.draw = function() {\r\n        var position = this.getProjection().fromLatLngToDivPixel(this._position);\r\n        this._$overlayContainer.css({\r\n            left: position.x + this._offset.left,\r\n            top: position.y + this._offset.top,\r\n            display: \"block\"\r\n        })\r\n    }\r\n};\r\nvar googleMapsLoaded = function() {\r\n    return window.google && window.google.maps\r\n};\r\nvar googleMapsLoader;\r\nvar GoogleProvider = DynamicProvider.inherit({\r\n    _mapType: function(type) {\r\n        var mapTypes = {\r\n            hybrid: google.maps.MapTypeId.HYBRID,\r\n            roadmap: google.maps.MapTypeId.ROADMAP,\r\n            satellite: google.maps.MapTypeId.SATELLITE\r\n        };\r\n        return mapTypes[type] || mapTypes.hybrid\r\n    },\r\n    _movementMode: function(type) {\r\n        var movementTypes = {\r\n            driving: google.maps.TravelMode.DRIVING,\r\n            walking: google.maps.TravelMode.WALKING\r\n        };\r\n        return movementTypes[type] || movementTypes.driving\r\n    },\r\n    _resolveLocation: function(location) {\r\n        return new Promise(function(resolve) {\r\n            var latLng = this._getLatLng(location);\r\n            if (latLng) {\r\n                resolve(new google.maps.LatLng(latLng.lat, latLng.lng))\r\n            } else {\r\n                this._geocodeLocation(location).then(function(geocodedLocation) {\r\n                    resolve(geocodedLocation)\r\n                })\r\n            }\r\n        }.bind(this))\r\n    },\r\n    _geocodedLocations: {},\r\n    _geocodeLocationImpl: function(location) {\r\n        return new Promise(function(resolve) {\r\n            if (!isDefined(location)) {\r\n                resolve(new google.maps.LatLng(0, 0));\r\n                return\r\n            }\r\n            var geocoder = new google.maps.Geocoder;\r\n            geocoder.geocode({\r\n                address: location\r\n            }, function(results, status) {\r\n                if (status === google.maps.GeocoderStatus.OK) {\r\n                    resolve(results[0].geometry.location)\r\n                } else {\r\n                    errors.log(\"W1006\", status);\r\n                    resolve(new google.maps.LatLng(0, 0))\r\n                }\r\n            })\r\n        })\r\n    },\r\n    _normalizeLocation: function(location) {\r\n        return {\r\n            lat: location.lat(),\r\n            lng: location.lng()\r\n        }\r\n    },\r\n    _normalizeLocationRect: function(locationRect) {\r\n        return {\r\n            northEast: this._normalizeLocation(locationRect.getNorthEast()),\r\n            southWest: this._normalizeLocation(locationRect.getSouthWest())\r\n        }\r\n    },\r\n    _loadImpl: function() {\r\n        return new Promise(function(resolve) {\r\n            if (googleMapsLoaded()) {\r\n                resolve()\r\n            } else {\r\n                if (!googleMapsLoader) {\r\n                    googleMapsLoader = this._loadMapScript()\r\n                }\r\n                googleMapsLoader.then(function() {\r\n                    if (googleMapsLoaded()) {\r\n                        resolve();\r\n                        return\r\n                    }\r\n                    this._loadMapScript().then(resolve)\r\n                }.bind(this))\r\n            }\r\n        }.bind(this)).then(function() {\r\n            initCustomMarkerClass()\r\n        })\r\n    },\r\n    _loadMapScript: function() {\r\n        return new Promise(function(resolve) {\r\n            var key = this._keyOption(\"google\");\r\n            window[GOOGLE_MAP_READY] = resolve;\r\n            ajax.sendRequest({\r\n                url: GOOGLE_URL + (key ? \"&key=\" + key : \"\"),\r\n                dataType: \"script\"\r\n            })\r\n        }.bind(this)).then(function() {\r\n            try {\r\n                delete window[GOOGLE_MAP_READY]\r\n            } catch (e) {\r\n                window[GOOGLE_MAP_READY] = void 0\r\n            }\r\n        })\r\n    },\r\n    _init: function() {\r\n        return new Promise(function(resolve) {\r\n            this._resolveLocation(this._option(\"center\")).then(function(center) {\r\n                var showDefaultUI = this._option(\"controls\");\r\n                this._map = new google.maps.Map(this._$container[0], {\r\n                    zoom: this._option(\"zoom\"),\r\n                    center: center,\r\n                    disableDefaultUI: !showDefaultUI\r\n                });\r\n                var listener = google.maps.event.addListener(this._map, \"idle\", function() {\r\n                    resolve(listener)\r\n                })\r\n            }.bind(this))\r\n        }.bind(this)).then(function(listener) {\r\n            google.maps.event.removeListener(listener)\r\n        })\r\n    },\r\n    _attachHandlers: function() {\r\n        this._boundsChangeListener = google.maps.event.addListener(this._map, \"bounds_changed\", this._boundsChangeHandler.bind(this));\r\n        this._clickListener = google.maps.event.addListener(this._map, \"click\", this._clickActionHandler.bind(this))\r\n    },\r\n    _boundsChangeHandler: function() {\r\n        var bounds = this._map.getBounds();\r\n        this._option(\"bounds\", this._normalizeLocationRect(bounds));\r\n        var center = this._map.getCenter();\r\n        this._option(\"center\", this._normalizeLocation(center));\r\n        if (!this._preventZoomChangeEvent) {\r\n            this._option(\"zoom\", this._map.getZoom())\r\n        }\r\n    },\r\n    _clickActionHandler: function(e) {\r\n        this._fireClickAction({\r\n            location: this._normalizeLocation(e.latLng)\r\n        })\r\n    },\r\n    updateDimensions: function() {\r\n        var center = this._option(\"center\");\r\n        google.maps.event.trigger(this._map, \"resize\");\r\n        this._option(\"center\", center);\r\n        return this.updateCenter()\r\n    },\r\n    updateMapType: function() {\r\n        this._map.setMapTypeId(this._mapType(this._option(\"type\")));\r\n        return Promise.resolve()\r\n    },\r\n    updateBounds: function() {\r\n        return Promise.all([this._resolveLocation(this._option(\"bounds.northEast\")), this._resolveLocation(this._option(\"bounds.southWest\"))]).then(function(result) {\r\n            var bounds = new google.maps.LatLngBounds;\r\n            bounds.extend(result[0]);\r\n            bounds.extend(result[1]);\r\n            this._map.fitBounds(bounds)\r\n        }.bind(this))\r\n    },\r\n    updateCenter: function() {\r\n        return this._resolveLocation(this._option(\"center\")).then(function(center) {\r\n            this._map.setCenter(center);\r\n            this._option(\"center\", this._normalizeLocation(center))\r\n        }.bind(this))\r\n    },\r\n    updateZoom: function() {\r\n        this._map.setZoom(this._option(\"zoom\"));\r\n        return Promise.resolve()\r\n    },\r\n    updateControls: function() {\r\n        var showDefaultUI = this._option(\"controls\");\r\n        this._map.setOptions({\r\n            disableDefaultUI: !showDefaultUI\r\n        });\r\n        return Promise.resolve()\r\n    },\r\n    isEventsCanceled: function(e) {\r\n        var gestureHandling = this._map && this._map.get(\"gestureHandling\");\r\n        var isInfoWindowContent = $(e.target).closest(\".\".concat(INFO_WINDOW_CLASS)).length > 0;\r\n        if (isInfoWindowContent || \"desktop\" !== devices.real().deviceType && \"cooperative\" === gestureHandling) {\r\n            return false\r\n        }\r\n        return this.callBase()\r\n    },\r\n    _renderMarker: function(options) {\r\n        return this._resolveLocation(options.location).then(function(location) {\r\n            var marker;\r\n            if (options.html) {\r\n                marker = new CustomMarker({\r\n                    map: this._map,\r\n                    position: location,\r\n                    html: options.html,\r\n                    offset: extend({\r\n                        top: 0,\r\n                        left: 0\r\n                    }, options.htmlOffset)\r\n                })\r\n            } else {\r\n                marker = new google.maps.Marker({\r\n                    position: location,\r\n                    map: this._map,\r\n                    icon: options.iconSrc || this._option(\"markerIconSrc\")\r\n                })\r\n            }\r\n            var infoWindow = this._renderTooltip(marker, options.tooltip);\r\n            var listener;\r\n            if (options.onClick || options.tooltip) {\r\n                var markerClickAction = this._mapWidget._createAction(options.onClick || noop);\r\n                var markerNormalizedLocation = this._normalizeLocation(location);\r\n                listener = google.maps.event.addListener(marker, \"click\", function() {\r\n                    markerClickAction({\r\n                        location: markerNormalizedLocation\r\n                    });\r\n                    if (infoWindow) {\r\n                        infoWindow.open(this._map, marker)\r\n                    }\r\n                }.bind(this))\r\n            }\r\n            return {\r\n                location: location,\r\n                marker: marker,\r\n                listener: listener\r\n            }\r\n        }.bind(this))\r\n    },\r\n    _renderTooltip: function(marker, options) {\r\n        if (!options) {\r\n            return\r\n        }\r\n        options = this._parseTooltipOptions(options);\r\n        var infoWindow = new google.maps.InfoWindow({\r\n            content: options.text\r\n        });\r\n        if (options.visible) {\r\n            infoWindow.open(this._map, marker)\r\n        }\r\n        return infoWindow\r\n    },\r\n    _destroyMarker: function(marker) {\r\n        marker.marker.setMap(null);\r\n        if (marker.listener) {\r\n            google.maps.event.removeListener(marker.listener)\r\n        }\r\n    },\r\n    _renderRoute: function(options) {\r\n        return Promise.all(map(options.locations, function(point) {\r\n            return this._resolveLocation(point)\r\n        }.bind(this))).then(function(locations) {\r\n            return new Promise(function(resolve) {\r\n                var origin = locations.shift();\r\n                var destination = locations.pop();\r\n                var waypoints = map(locations, function(location) {\r\n                    return {\r\n                        location: location,\r\n                        stopover: true\r\n                    }\r\n                });\r\n                var request = {\r\n                    origin: origin,\r\n                    destination: destination,\r\n                    waypoints: waypoints,\r\n                    optimizeWaypoints: true,\r\n                    travelMode: this._movementMode(options.mode)\r\n                };\r\n                (new google.maps.DirectionsService).route(request, function(response, status) {\r\n                    if (status === google.maps.DirectionsStatus.OK) {\r\n                        var color = new Color(options.color || this._defaultRouteColor()).toHex();\r\n                        var directionOptions = {\r\n                            directions: response,\r\n                            map: this._map,\r\n                            suppressMarkers: true,\r\n                            preserveViewport: true,\r\n                            polylineOptions: {\r\n                                strokeWeight: options.weight || this._defaultRouteWeight(),\r\n                                strokeOpacity: options.opacity || this._defaultRouteOpacity(),\r\n                                strokeColor: color\r\n                            }\r\n                        };\r\n                        var route = new google.maps.DirectionsRenderer(directionOptions);\r\n                        var bounds = response.routes[0].bounds;\r\n                        resolve({\r\n                            instance: route,\r\n                            northEast: bounds.getNorthEast(),\r\n                            southWest: bounds.getSouthWest()\r\n                        })\r\n                    } else {\r\n                        errors.log(\"W1006\", status);\r\n                        resolve({\r\n                            instance: new google.maps.DirectionsRenderer({})\r\n                        })\r\n                    }\r\n                }.bind(this))\r\n            }.bind(this))\r\n        }.bind(this))\r\n    },\r\n    _destroyRoute: function(routeObject) {\r\n        routeObject.instance.setMap(null)\r\n    },\r\n    _fitBounds: function() {\r\n        this._updateBounds();\r\n        if (this._bounds && this._option(\"autoAdjust\")) {\r\n            var zoomBeforeFitting = this._map.getZoom();\r\n            this._preventZoomChangeEvent = true;\r\n            this._map.fitBounds(this._bounds);\r\n            this._boundsChangeHandler();\r\n            var zoomAfterFitting = this._map.getZoom();\r\n            if (zoomBeforeFitting < zoomAfterFitting) {\r\n                this._map.setZoom(zoomBeforeFitting)\r\n            } else {\r\n                this._option(\"zoom\", zoomAfterFitting)\r\n            }\r\n            delete this._preventZoomChangeEvent\r\n        }\r\n        return Promise.resolve()\r\n    },\r\n    _extendBounds: function(location) {\r\n        if (this._bounds) {\r\n            this._bounds.extend(location)\r\n        } else {\r\n            this._bounds = new google.maps.LatLngBounds;\r\n            this._bounds.extend(location)\r\n        }\r\n    },\r\n    clean: function() {\r\n        if (this._map) {\r\n            google.maps.event.removeListener(this._boundsChangeListener);\r\n            google.maps.event.removeListener(this._clickListener);\r\n            this._clearMarkers();\r\n            this._clearRoutes();\r\n            delete this._map;\r\n            this._$container.empty()\r\n        }\r\n        return Promise.resolve()\r\n    }\r\n});\r\nmodule.exports = GoogleProvider;\r\n"]},"metadata":{},"sourceType":"module"}