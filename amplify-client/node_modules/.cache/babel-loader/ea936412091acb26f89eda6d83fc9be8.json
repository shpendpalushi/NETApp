{"ast":null,"code":"/**\r\n * DevExtreme (ui/drop_down_box.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar _ui = require(\"./drop_down_editor/ui.drop_down_editor\");\n\nvar _ui2 = _interopRequireDefault(_ui);\n\nvar _ui3 = require(\"./editor/ui.data_expression\");\n\nvar _ui4 = _interopRequireDefault(_ui3);\n\nvar _common = require(\"../core/utils/common\");\n\nvar _type = require(\"../core/utils/type\");\n\nvar _iterator = require(\"../core/utils/iterator\");\n\nvar _selectors = require(\"./widget/selectors\");\n\nvar _selectors2 = _interopRequireDefault(_selectors);\n\nvar _ui5 = require(\"./widget/ui.keyboard_processor\");\n\nvar _ui6 = _interopRequireDefault(_ui5);\n\nvar _deferred = require(\"../core/utils/deferred\");\n\nvar _renderer = require(\"../core/renderer\");\n\nvar _renderer2 = _interopRequireDefault(_renderer);\n\nvar _events_engine = require(\"../events/core/events_engine\");\n\nvar _events_engine2 = _interopRequireDefault(_events_engine);\n\nvar _extend = require(\"../core/utils/extend\");\n\nvar _utils = require(\"../ui/overlay/utils\");\n\nvar _component_registrator = require(\"../core/component_registrator\");\n\nvar _component_registrator2 = _interopRequireDefault(_component_registrator);\n\nvar _utils2 = require(\"../events/utils\");\n\nvar _devices = require(\"../core/devices\");\n\nvar _devices2 = _interopRequireDefault(_devices);\n\nvar _dom_adapter = require(\"../core/dom_adapter\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nvar DROP_DOWN_BOX_CLASS = \"dx-dropdownbox\";\nvar ANONYMOUS_TEMPLATE_NAME = \"content\";\n\nvar realDevice = _devices2.default.real();\n\nvar DropDownBox = _ui2.default.inherit({\n  _supportedKeys: function _supportedKeys() {\n    return (0, _extend.extend)({}, this.callBase(), {\n      tab: function tab(e) {\n        if (!this.option(\"opened\")) {\n          return;\n        }\n\n        var $tabbableElements = this._getTabbableElements();\n\n        var $focusableElement = e.shiftKey ? $tabbableElements.last() : $tabbableElements.first();\n        $focusableElement && _events_engine2.default.trigger($focusableElement, \"focus\");\n        e.preventDefault();\n      }\n    });\n  },\n  _getTabbableElements: function _getTabbableElements() {\n    return this._getElements().filter(_selectors2.default.tabbable);\n  },\n  _getElements: function _getElements() {\n    return (0, _renderer2.default)(this.content()).find(\"*\");\n  },\n  _getAnonymousTemplateName: function _getAnonymousTemplateName() {\n    return ANONYMOUS_TEMPLATE_NAME;\n  },\n  _getDefaultOptions: function _getDefaultOptions() {\n    return (0, _extend.extend)(this.callBase(), {\n      acceptCustomValue: false,\n      contentTemplate: \"content\",\n      openOnFieldClick: true,\n      displayValueFormatter: function displayValueFormatter(value) {\n        return Array.isArray(value) ? value.join(\", \") : value;\n      },\n      useHiddenSubmitElement: true\n    });\n  },\n  _initMarkup: function _initMarkup() {\n    this._initDataExpressions();\n\n    this.$element().addClass(DROP_DOWN_BOX_CLASS);\n    this.callBase();\n  },\n  _setSubmitValue: function _setSubmitValue() {\n    var value = this.option(\"value\");\n    var submitValue = this._shouldUseDisplayValue(value) ? this._displayGetter(value) : value;\n\n    this._getSubmitElement().val(submitValue);\n  },\n  _shouldUseDisplayValue: function _shouldUseDisplayValue(value) {\n    return \"this\" === this.option(\"valueExpr\") && (0, _type.isObject)(value);\n  },\n  _renderInputValue: function _renderInputValue() {\n    var callBase = this.callBase.bind(this);\n    var values = [];\n\n    if (!this._dataSource) {\n      callBase(values);\n      return new _deferred.Deferred().resolve();\n    }\n\n    var currentValue = this._getCurrentValue();\n\n    var keys = (0, _common.ensureDefined)(currentValue, []);\n    keys = Array.isArray(keys) ? keys : [keys];\n    var itemLoadDeferreds = (0, _iterator.map)(keys, function (key) {\n      return this._loadItem(key).always(function (item) {\n        var displayValue = this._displayGetter(item);\n\n        values.push((0, _common.ensureDefined)(displayValue, key));\n      }.bind(this));\n    }.bind(this));\n    return _deferred.when.apply(this, itemLoadDeferreds).always(function () {\n      this.option(\"displayValue\", values);\n      callBase(values.length && values);\n    }.bind(this)).fail(callBase);\n  },\n  _loadItem: function _loadItem(value) {\n    var deferred = new _deferred.Deferred();\n    var that = this;\n    var selectedItem = (0, _common.grep)(this.option(\"items\") || [], function (item) {\n      return this._isValueEquals(this._valueGetter(item), value);\n    }.bind(this))[0];\n\n    if (void 0 !== selectedItem) {\n      deferred.resolve(selectedItem);\n    } else {\n      this._loadValue(value).done(function (item) {\n        deferred.resolve(item);\n      }).fail(function (args) {\n        if (that.option(\"acceptCustomValue\")) {\n          deferred.resolve(value);\n        } else {\n          deferred.reject();\n        }\n      });\n    }\n\n    return deferred.promise();\n  },\n  _updatePopupWidth: function _updatePopupWidth() {\n    this._setPopupOption(\"width\", this.$element().outerWidth());\n  },\n  _popupElementTabHandler: function _popupElementTabHandler(e) {\n    if (\"tab\" !== (0, _utils2.normalizeKeyName)(e)) {\n      return;\n    }\n\n    var $firstTabbable = this._getTabbableElements().first().get(0);\n\n    var $lastTabbable = this._getTabbableElements().last().get(0);\n\n    var $target = e.originalEvent.target;\n    var moveBackward = !!($target === $firstTabbable && e.shift);\n    var moveForward = !!($target === $lastTabbable && !e.shift);\n\n    if (moveBackward || moveForward) {\n      this.close();\n\n      _events_engine2.default.trigger(this._input(), \"focus\");\n\n      if (moveBackward) {\n        e.originalEvent.preventDefault();\n      }\n    }\n  },\n  _renderPopup: function _renderPopup(e) {\n    this.callBase();\n\n    if (this.option(\"focusStateEnabled\")) {\n      this._popup._keyboardProcessor.push(new _ui6.default({\n        element: this.content(),\n        handler: this._popupElementTabHandler,\n        context: this\n      }));\n    }\n  },\n  _renderPopupContent: function _renderPopupContent() {\n    if (this.option(\"contentTemplate\") === ANONYMOUS_TEMPLATE_NAME) {\n      return;\n    }\n\n    return this.callBase();\n  },\n  _canShowVirtualKeyboard: function _canShowVirtualKeyboard() {\n    return realDevice.mac;\n  },\n  _isNestedElementActive: function _isNestedElementActive() {\n    var activeElement = (0, _dom_adapter.getActiveElement)();\n    return activeElement && this._popup.$content().get(0).contains(activeElement);\n  },\n  _shouldCloseOnTargetScroll: function _shouldCloseOnTargetScroll() {\n    return \"desktop\" === realDevice.deviceType && this._canShowVirtualKeyboard() && this._isNestedElementActive();\n  },\n  _popupConfig: function _popupConfig() {\n    var _this = this;\n\n    var horizontalAlignment = this.option(\"rtlEnabled\") ? \"right\" : \"left\";\n    return (0, _extend.extend)(this.callBase(), {\n      width: function () {\n        return this.$element().outerWidth();\n      }.bind(this),\n      height: \"auto\",\n      tabIndex: -1,\n      dragEnabled: false,\n      focusStateEnabled: this.option(\"focusStateEnabled\"),\n      closeOnTargetScroll: this._shouldCloseOnTargetScroll.bind(this),\n      position: {\n        of: this.$element(),\n        collision: \"flipfit\",\n        my: \"top \" + horizontalAlignment,\n        at: \"bottom \" + horizontalAlignment,\n        offset: {\n          y: -1\n        }\n      },\n      onKeyboardHandled: function onKeyboardHandled(opts) {\n        return _this.option(\"focusStateEnabled\") && _this._popupElementTabHandler(opts);\n      },\n      maxHeight: function () {\n        return (0, _utils.getElementMaxHeightByWindow)(this.$element());\n      }.bind(this)\n    });\n  },\n  _popupShownHandler: function _popupShownHandler() {\n    this.callBase();\n\n    var $firstElement = this._getTabbableElements().first();\n\n    _events_engine2.default.trigger($firstElement, \"focus\");\n  },\n  _setCollectionWidgetOption: _common.noop,\n  _optionChanged: function _optionChanged(args) {\n    this._dataExpressionOptionChanged(args);\n\n    switch (args.name) {\n      case \"width\":\n        this.callBase(args);\n        this._popup && this._popup.repaint();\n        break;\n\n      case \"dataSource\":\n        this._renderInputValue();\n\n        break;\n\n      case \"displayValue\":\n        this.option(\"text\", args.value);\n        break;\n\n      case \"displayExpr\":\n        this._renderValue();\n\n        break;\n\n      default:\n        this.callBase(args);\n    }\n  }\n}).include(_ui4.default);\n\n(0, _component_registrator2.default)(\"dxDropDownBox\", DropDownBox);\nmodule.exports = DropDownBox;\nmodule.exports.default = module.exports;","map":{"version":3,"sources":["C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/devextreme/ui/drop_down_box.js"],"names":["_ui","require","_ui2","_interopRequireDefault","_ui3","_ui4","_common","_type","_iterator","_selectors","_selectors2","_ui5","_ui6","_deferred","_renderer","_renderer2","_events_engine","_events_engine2","_extend","_utils","_component_registrator","_component_registrator2","_utils2","_devices","_devices2","_dom_adapter","obj","DROP_DOWN_BOX_CLASS","ANONYMOUS_TEMPLATE_NAME","realDevice","DropDownBox","_supportedKeys","tab","$tabbableElements","$focusableElement","e","_getTabbableElements","_getElements","_getAnonymousTemplateName","_getDefaultOptions","acceptCustomValue","contentTemplate","openOnFieldClick","displayValueFormatter","Array","value","useHiddenSubmitElement","_initMarkup","_setSubmitValue","submitValue","_shouldUseDisplayValue","_renderInputValue","callBase","values","currentValue","keys","itemLoadDeferreds","displayValue","_loadItem","deferred","that","selectedItem","_updatePopupWidth","_popupElementTabHandler","$firstTabbable","$lastTabbable","$target","moveBackward","moveForward","_renderPopup","element","handler","context","_renderPopupContent","_canShowVirtualKeyboard","_isNestedElementActive","activeElement","_shouldCloseOnTargetScroll","_popupConfig","_this","horizontalAlignment","width","height","tabIndex","dragEnabled","focusStateEnabled","closeOnTargetScroll","position","of","collision","my","at","offset","y","onKeyboardHandled","maxHeight","_popupShownHandler","$firstElement","_setCollectionWidgetOption","_optionChanged","args","module"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/drop_down_box.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar _ui = require(\"./drop_down_editor/ui.drop_down_editor\");\r\nvar _ui2 = _interopRequireDefault(_ui);\r\nvar _ui3 = require(\"./editor/ui.data_expression\");\r\nvar _ui4 = _interopRequireDefault(_ui3);\r\nvar _common = require(\"../core/utils/common\");\r\nvar _type = require(\"../core/utils/type\");\r\nvar _iterator = require(\"../core/utils/iterator\");\r\nvar _selectors = require(\"./widget/selectors\");\r\nvar _selectors2 = _interopRequireDefault(_selectors);\r\nvar _ui5 = require(\"./widget/ui.keyboard_processor\");\r\nvar _ui6 = _interopRequireDefault(_ui5);\r\nvar _deferred = require(\"../core/utils/deferred\");\r\nvar _renderer = require(\"../core/renderer\");\r\nvar _renderer2 = _interopRequireDefault(_renderer);\r\nvar _events_engine = require(\"../events/core/events_engine\");\r\nvar _events_engine2 = _interopRequireDefault(_events_engine);\r\nvar _extend = require(\"../core/utils/extend\");\r\nvar _utils = require(\"../ui/overlay/utils\");\r\nvar _component_registrator = require(\"../core/component_registrator\");\r\nvar _component_registrator2 = _interopRequireDefault(_component_registrator);\r\nvar _utils2 = require(\"../events/utils\");\r\nvar _devices = require(\"../core/devices\");\r\nvar _devices2 = _interopRequireDefault(_devices);\r\nvar _dom_adapter = require(\"../core/dom_adapter\");\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\nvar DROP_DOWN_BOX_CLASS = \"dx-dropdownbox\";\r\nvar ANONYMOUS_TEMPLATE_NAME = \"content\";\r\nvar realDevice = _devices2.default.real();\r\nvar DropDownBox = _ui2.default.inherit({\r\n    _supportedKeys: function() {\r\n        return (0, _extend.extend)({}, this.callBase(), {\r\n            tab: function(e) {\r\n                if (!this.option(\"opened\")) {\r\n                    return\r\n                }\r\n                var $tabbableElements = this._getTabbableElements();\r\n                var $focusableElement = e.shiftKey ? $tabbableElements.last() : $tabbableElements.first();\r\n                $focusableElement && _events_engine2.default.trigger($focusableElement, \"focus\");\r\n                e.preventDefault()\r\n            }\r\n        })\r\n    },\r\n    _getTabbableElements: function() {\r\n        return this._getElements().filter(_selectors2.default.tabbable)\r\n    },\r\n    _getElements: function() {\r\n        return (0, _renderer2.default)(this.content()).find(\"*\")\r\n    },\r\n    _getAnonymousTemplateName: function() {\r\n        return ANONYMOUS_TEMPLATE_NAME\r\n    },\r\n    _getDefaultOptions: function() {\r\n        return (0, _extend.extend)(this.callBase(), {\r\n            acceptCustomValue: false,\r\n            contentTemplate: \"content\",\r\n            openOnFieldClick: true,\r\n            displayValueFormatter: function(value) {\r\n                return Array.isArray(value) ? value.join(\", \") : value\r\n            },\r\n            useHiddenSubmitElement: true\r\n        })\r\n    },\r\n    _initMarkup: function() {\r\n        this._initDataExpressions();\r\n        this.$element().addClass(DROP_DOWN_BOX_CLASS);\r\n        this.callBase()\r\n    },\r\n    _setSubmitValue: function() {\r\n        var value = this.option(\"value\");\r\n        var submitValue = this._shouldUseDisplayValue(value) ? this._displayGetter(value) : value;\r\n        this._getSubmitElement().val(submitValue)\r\n    },\r\n    _shouldUseDisplayValue: function(value) {\r\n        return \"this\" === this.option(\"valueExpr\") && (0, _type.isObject)(value)\r\n    },\r\n    _renderInputValue: function() {\r\n        var callBase = this.callBase.bind(this);\r\n        var values = [];\r\n        if (!this._dataSource) {\r\n            callBase(values);\r\n            return (new _deferred.Deferred).resolve()\r\n        }\r\n        var currentValue = this._getCurrentValue();\r\n        var keys = (0, _common.ensureDefined)(currentValue, []);\r\n        keys = Array.isArray(keys) ? keys : [keys];\r\n        var itemLoadDeferreds = (0, _iterator.map)(keys, function(key) {\r\n            return this._loadItem(key).always(function(item) {\r\n                var displayValue = this._displayGetter(item);\r\n                values.push((0, _common.ensureDefined)(displayValue, key))\r\n            }.bind(this))\r\n        }.bind(this));\r\n        return _deferred.when.apply(this, itemLoadDeferreds).always(function() {\r\n            this.option(\"displayValue\", values);\r\n            callBase(values.length && values)\r\n        }.bind(this)).fail(callBase)\r\n    },\r\n    _loadItem: function(value) {\r\n        var deferred = new _deferred.Deferred;\r\n        var that = this;\r\n        var selectedItem = (0, _common.grep)(this.option(\"items\") || [], function(item) {\r\n            return this._isValueEquals(this._valueGetter(item), value)\r\n        }.bind(this))[0];\r\n        if (void 0 !== selectedItem) {\r\n            deferred.resolve(selectedItem)\r\n        } else {\r\n            this._loadValue(value).done(function(item) {\r\n                deferred.resolve(item)\r\n            }).fail(function(args) {\r\n                if (that.option(\"acceptCustomValue\")) {\r\n                    deferred.resolve(value)\r\n                } else {\r\n                    deferred.reject()\r\n                }\r\n            })\r\n        }\r\n        return deferred.promise()\r\n    },\r\n    _updatePopupWidth: function() {\r\n        this._setPopupOption(\"width\", this.$element().outerWidth())\r\n    },\r\n    _popupElementTabHandler: function(e) {\r\n        if (\"tab\" !== (0, _utils2.normalizeKeyName)(e)) {\r\n            return\r\n        }\r\n        var $firstTabbable = this._getTabbableElements().first().get(0);\r\n        var $lastTabbable = this._getTabbableElements().last().get(0);\r\n        var $target = e.originalEvent.target;\r\n        var moveBackward = !!($target === $firstTabbable && e.shift);\r\n        var moveForward = !!($target === $lastTabbable && !e.shift);\r\n        if (moveBackward || moveForward) {\r\n            this.close();\r\n            _events_engine2.default.trigger(this._input(), \"focus\");\r\n            if (moveBackward) {\r\n                e.originalEvent.preventDefault()\r\n            }\r\n        }\r\n    },\r\n    _renderPopup: function(e) {\r\n        this.callBase();\r\n        if (this.option(\"focusStateEnabled\")) {\r\n            this._popup._keyboardProcessor.push(new _ui6.default({\r\n                element: this.content(),\r\n                handler: this._popupElementTabHandler,\r\n                context: this\r\n            }))\r\n        }\r\n    },\r\n    _renderPopupContent: function() {\r\n        if (this.option(\"contentTemplate\") === ANONYMOUS_TEMPLATE_NAME) {\r\n            return\r\n        }\r\n        return this.callBase()\r\n    },\r\n    _canShowVirtualKeyboard: function() {\r\n        return realDevice.mac\r\n    },\r\n    _isNestedElementActive: function() {\r\n        var activeElement = (0, _dom_adapter.getActiveElement)();\r\n        return activeElement && this._popup.$content().get(0).contains(activeElement)\r\n    },\r\n    _shouldCloseOnTargetScroll: function() {\r\n        return \"desktop\" === realDevice.deviceType && this._canShowVirtualKeyboard() && this._isNestedElementActive()\r\n    },\r\n    _popupConfig: function() {\r\n        var _this = this;\r\n        var horizontalAlignment = this.option(\"rtlEnabled\") ? \"right\" : \"left\";\r\n        return (0, _extend.extend)(this.callBase(), {\r\n            width: function() {\r\n                return this.$element().outerWidth()\r\n            }.bind(this),\r\n            height: \"auto\",\r\n            tabIndex: -1,\r\n            dragEnabled: false,\r\n            focusStateEnabled: this.option(\"focusStateEnabled\"),\r\n            closeOnTargetScroll: this._shouldCloseOnTargetScroll.bind(this),\r\n            position: {\r\n                of: this.$element(),\r\n                collision: \"flipfit\",\r\n                my: \"top \" + horizontalAlignment,\r\n                at: \"bottom \" + horizontalAlignment,\r\n                offset: {\r\n                    y: -1\r\n                }\r\n            },\r\n            onKeyboardHandled: function(opts) {\r\n                return _this.option(\"focusStateEnabled\") && _this._popupElementTabHandler(opts)\r\n            },\r\n            maxHeight: function() {\r\n                return (0, _utils.getElementMaxHeightByWindow)(this.$element())\r\n            }.bind(this)\r\n        })\r\n    },\r\n    _popupShownHandler: function() {\r\n        this.callBase();\r\n        var $firstElement = this._getTabbableElements().first();\r\n        _events_engine2.default.trigger($firstElement, \"focus\")\r\n    },\r\n    _setCollectionWidgetOption: _common.noop,\r\n    _optionChanged: function(args) {\r\n        this._dataExpressionOptionChanged(args);\r\n        switch (args.name) {\r\n            case \"width\":\r\n                this.callBase(args);\r\n                this._popup && this._popup.repaint();\r\n                break;\r\n            case \"dataSource\":\r\n                this._renderInputValue();\r\n                break;\r\n            case \"displayValue\":\r\n                this.option(\"text\", args.value);\r\n                break;\r\n            case \"displayExpr\":\r\n                this._renderValue();\r\n                break;\r\n            default:\r\n                this.callBase(args)\r\n        }\r\n    }\r\n}).include(_ui4.default);\r\n(0, _component_registrator2.default)(\"dxDropDownBox\", DropDownBox);\r\nmodule.exports = DropDownBox;\r\nmodule.exports.default = module.exports;\r\n"]},"metadata":{},"sourceType":"module"}