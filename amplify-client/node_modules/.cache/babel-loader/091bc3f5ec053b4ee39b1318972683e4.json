{"ast":null,"code":"/**\r\n * DevExtreme (exporter/excel/excel.file.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _type = require(\"../../core/utils/type\");\n\nvar _excel = require(\"./excel.tag_helper\");\n\nvar _excel2 = _interopRequireDefault(_excel);\n\nvar _excel3 = require(\"./excel.cell_format_helper\");\n\nvar _excel4 = _interopRequireDefault(_excel3);\n\nvar _excel5 = require(\"./excel.fill_helper\");\n\nvar _excel6 = _interopRequireDefault(_excel5);\n\nvar _excel7 = require(\"./excel.font_helper\");\n\nvar _excel8 = _interopRequireDefault(_excel7);\n\nvar _excel9 = require(\"./excel.number_format_helper\");\n\nvar _excel10 = _interopRequireDefault(_excel9);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n\n    if (\"value\" in descriptor) {\n      descriptor.writable = true;\n    }\n\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) {\n    _defineProperties(Constructor.prototype, protoProps);\n  }\n\n  if (staticProps) {\n    _defineProperties(Constructor, staticProps);\n  }\n\n  return Constructor;\n}\n\nvar ExcelFile = function () {\n  function ExcelFile() {\n    _classCallCheck(this, ExcelFile);\n\n    this._cellFormatTags = [];\n    this._fillTags = [];\n    this._fontTags = [];\n    this._numberFormatTags = [];\n\n    this._fillTags.push(_excel6.default.tryCreateTag({\n      patternFill: {\n        patternType: \"none\"\n      }\n    }));\n  }\n\n  _createClass(ExcelFile, [{\n    key: \"registerCellFormat\",\n    value: function value(cellFormat) {\n      var result;\n\n      var cellFormatTag = _excel4.default.tryCreateTag(cellFormat, {\n        registerFill: this.registerFill.bind(this),\n        registerFont: this.registerFont.bind(this),\n        registerNumberFormat: this.registerNumberFormat.bind(this)\n      });\n\n      if ((0, _type.isDefined)(cellFormatTag)) {\n        for (var i = 0; i < this._cellFormatTags.length; i++) {\n          if (_excel4.default.areEqual(this._cellFormatTags[i], cellFormatTag)) {\n            result = i;\n            break;\n          }\n        }\n\n        if (void 0 === result) {\n          result = this._cellFormatTags.push(cellFormatTag) - 1;\n        }\n      }\n\n      return result;\n    }\n  }, {\n    key: \"generateCellFormatsXml\",\n    value: function value() {\n      var cellFormatTagsAsXmlStringsArray = this._cellFormatTags.map(function (tag) {\n        return _excel4.default.toXml(tag);\n      });\n\n      return _excel2.default.toXml(\"cellXfs\", {\n        count: cellFormatTagsAsXmlStringsArray.length\n      }, cellFormatTagsAsXmlStringsArray.join(\"\"));\n    }\n  }, {\n    key: \"registerFill\",\n    value: function value(fill) {\n      var result;\n\n      var fillTag = _excel6.default.tryCreateTag(fill);\n\n      if ((0, _type.isDefined)(fillTag)) {\n        for (var i = 0; i < this._fillTags.length; i++) {\n          if (_excel6.default.areEqual(this._fillTags[i], fillTag)) {\n            result = i;\n            break;\n          }\n        }\n\n        if (void 0 === result) {\n          if (this._fillTags.length < 2) {\n            this._fillTags.push(_excel6.default.tryCreateTag({\n              patternFill: {\n                patternType: \"Gray125\"\n              }\n            }));\n          }\n\n          result = this._fillTags.push(fillTag) - 1;\n        }\n      }\n\n      return result;\n    }\n  }, {\n    key: \"generateFillsXml\",\n    value: function value() {\n      var tagsAsXmlStringsArray = this._fillTags.map(function (tag) {\n        return _excel6.default.toXml(tag);\n      });\n\n      return _excel2.default.toXml(\"fills\", {\n        count: tagsAsXmlStringsArray.length\n      }, tagsAsXmlStringsArray.join(\"\"));\n    }\n  }, {\n    key: \"registerFont\",\n    value: function value(font) {\n      var result;\n\n      var fontTag = _excel8.default.tryCreateTag(font);\n\n      if ((0, _type.isDefined)(fontTag)) {\n        for (var i = 0; i < this._fontTags.length; i++) {\n          if (_excel8.default.areEqual(this._fontTags[i], fontTag)) {\n            result = i;\n            break;\n          }\n        }\n\n        if (void 0 === result) {\n          result = this._fontTags.push(fontTag) - 1;\n        }\n      }\n\n      return result;\n    }\n  }, {\n    key: \"generateFontsXml\",\n    value: function value() {\n      var xmlStringsArray = this._fontTags.map(function (tag) {\n        return _excel8.default.toXml(tag);\n      });\n\n      return _excel2.default.toXml(\"fonts\", {\n        count: xmlStringsArray.length\n      }, xmlStringsArray.join(\"\"));\n    }\n  }, {\n    key: \"_convertNumberFormatIndexToId\",\n    value: function value(index) {\n      var CUSTOM_FORMAT_ID_START_VALUE = 165;\n      return CUSTOM_FORMAT_ID_START_VALUE + index;\n    }\n  }, {\n    key: \"registerNumberFormat\",\n    value: function value(numberFormat) {\n      var result;\n\n      var tag = _excel10.default.tryCreateTag(numberFormat);\n\n      if ((0, _type.isDefined)(tag)) {\n        for (var i = 0; i < this._numberFormatTags.length; i++) {\n          if (_excel10.default.areEqual(this._numberFormatTags[i], tag)) {\n            result = this._numberFormatTags[i][_excel10.default.ID_PROPERTY_NAME];\n            break;\n          }\n        }\n\n        if (void 0 === result) {\n          tag[_excel10.default.ID_PROPERTY_NAME] = this._convertNumberFormatIndexToId(this._numberFormatTags.length);\n          result = tag[_excel10.default.ID_PROPERTY_NAME];\n\n          this._numberFormatTags.push(tag);\n        }\n      }\n\n      return result;\n    }\n  }, {\n    key: \"generateNumberFormatsXml\",\n    value: function value() {\n      if (this._numberFormatTags.length > 0) {\n        var xmlStringsArray = this._numberFormatTags.map(function (tag) {\n          return _excel10.default.toXml(tag);\n        });\n\n        return _excel2.default.toXml(\"numFmts\", {\n          count: xmlStringsArray.length\n        }, xmlStringsArray.join(\"\"));\n      } else {\n        return \"\";\n      }\n    }\n  }], [{\n    key: \"copyCellFormat\",\n    value: function value(source) {\n      return _excel4.default.copy(source);\n    }\n  }]);\n\n  return ExcelFile;\n}();\n\nexports.default = ExcelFile;\nmodule.exports = ExcelFile;","map":{"version":3,"sources":["C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/devextreme/exporter/excel/excel.file.js"],"names":["Object","value","exports","_type","require","_excel","_excel2","_interopRequireDefault","_excel3","_excel4","_excel5","_excel6","_excel7","_excel8","_excel9","_excel10","obj","instance","i","props","descriptor","_defineProperties","Constructor","ExcelFile","_classCallCheck","patternFill","patternType","_createClass","key","cellFormatTag","registerFill","registerFont","registerNumberFormat","result","cellFormatTagsAsXmlStringsArray","count","length","fillTag","tagsAsXmlStringsArray","fontTag","xmlStringsArray","CUSTOM_FORMAT_ID_START_VALUE","tag","module"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (exporter/excel/excel.file.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", {\r\n    value: true\r\n});\r\nexports.default = void 0;\r\nvar _type = require(\"../../core/utils/type\");\r\nvar _excel = require(\"./excel.tag_helper\");\r\nvar _excel2 = _interopRequireDefault(_excel);\r\nvar _excel3 = require(\"./excel.cell_format_helper\");\r\nvar _excel4 = _interopRequireDefault(_excel3);\r\nvar _excel5 = require(\"./excel.fill_helper\");\r\nvar _excel6 = _interopRequireDefault(_excel5);\r\nvar _excel7 = require(\"./excel.font_helper\");\r\nvar _excel8 = _interopRequireDefault(_excel7);\r\nvar _excel9 = require(\"./excel.number_format_helper\");\r\nvar _excel10 = _interopRequireDefault(_excel9);\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\n\r\nfunction _classCallCheck(instance, Constructor) {\r\n    if (!(instance instanceof Constructor)) {\r\n        throw new TypeError(\"Cannot call a class as a function\")\r\n    }\r\n}\r\n\r\nfunction _defineProperties(target, props) {\r\n    for (var i = 0; i < props.length; i++) {\r\n        var descriptor = props[i];\r\n        descriptor.enumerable = descriptor.enumerable || false;\r\n        descriptor.configurable = true;\r\n        if (\"value\" in descriptor) {\r\n            descriptor.writable = true\r\n        }\r\n        Object.defineProperty(target, descriptor.key, descriptor)\r\n    }\r\n}\r\n\r\nfunction _createClass(Constructor, protoProps, staticProps) {\r\n    if (protoProps) {\r\n        _defineProperties(Constructor.prototype, protoProps)\r\n    }\r\n    if (staticProps) {\r\n        _defineProperties(Constructor, staticProps)\r\n    }\r\n    return Constructor\r\n}\r\nvar ExcelFile = function() {\r\n    function ExcelFile() {\r\n        _classCallCheck(this, ExcelFile);\r\n        this._cellFormatTags = [];\r\n        this._fillTags = [];\r\n        this._fontTags = [];\r\n        this._numberFormatTags = [];\r\n        this._fillTags.push(_excel6.default.tryCreateTag({\r\n            patternFill: {\r\n                patternType: \"none\"\r\n            }\r\n        }))\r\n    }\r\n    _createClass(ExcelFile, [{\r\n        key: \"registerCellFormat\",\r\n        value: function(cellFormat) {\r\n            var result;\r\n            var cellFormatTag = _excel4.default.tryCreateTag(cellFormat, {\r\n                registerFill: this.registerFill.bind(this),\r\n                registerFont: this.registerFont.bind(this),\r\n                registerNumberFormat: this.registerNumberFormat.bind(this)\r\n            });\r\n            if ((0, _type.isDefined)(cellFormatTag)) {\r\n                for (var i = 0; i < this._cellFormatTags.length; i++) {\r\n                    if (_excel4.default.areEqual(this._cellFormatTags[i], cellFormatTag)) {\r\n                        result = i;\r\n                        break\r\n                    }\r\n                }\r\n                if (void 0 === result) {\r\n                    result = this._cellFormatTags.push(cellFormatTag) - 1\r\n                }\r\n            }\r\n            return result\r\n        }\r\n    }, {\r\n        key: \"generateCellFormatsXml\",\r\n        value: function() {\r\n            var cellFormatTagsAsXmlStringsArray = this._cellFormatTags.map(function(tag) {\r\n                return _excel4.default.toXml(tag)\r\n            });\r\n            return _excel2.default.toXml(\"cellXfs\", {\r\n                count: cellFormatTagsAsXmlStringsArray.length\r\n            }, cellFormatTagsAsXmlStringsArray.join(\"\"))\r\n        }\r\n    }, {\r\n        key: \"registerFill\",\r\n        value: function(fill) {\r\n            var result;\r\n            var fillTag = _excel6.default.tryCreateTag(fill);\r\n            if ((0, _type.isDefined)(fillTag)) {\r\n                for (var i = 0; i < this._fillTags.length; i++) {\r\n                    if (_excel6.default.areEqual(this._fillTags[i], fillTag)) {\r\n                        result = i;\r\n                        break\r\n                    }\r\n                }\r\n                if (void 0 === result) {\r\n                    if (this._fillTags.length < 2) {\r\n                        this._fillTags.push(_excel6.default.tryCreateTag({\r\n                            patternFill: {\r\n                                patternType: \"Gray125\"\r\n                            }\r\n                        }))\r\n                    }\r\n                    result = this._fillTags.push(fillTag) - 1\r\n                }\r\n            }\r\n            return result\r\n        }\r\n    }, {\r\n        key: \"generateFillsXml\",\r\n        value: function() {\r\n            var tagsAsXmlStringsArray = this._fillTags.map(function(tag) {\r\n                return _excel6.default.toXml(tag)\r\n            });\r\n            return _excel2.default.toXml(\"fills\", {\r\n                count: tagsAsXmlStringsArray.length\r\n            }, tagsAsXmlStringsArray.join(\"\"))\r\n        }\r\n    }, {\r\n        key: \"registerFont\",\r\n        value: function(font) {\r\n            var result;\r\n            var fontTag = _excel8.default.tryCreateTag(font);\r\n            if ((0, _type.isDefined)(fontTag)) {\r\n                for (var i = 0; i < this._fontTags.length; i++) {\r\n                    if (_excel8.default.areEqual(this._fontTags[i], fontTag)) {\r\n                        result = i;\r\n                        break\r\n                    }\r\n                }\r\n                if (void 0 === result) {\r\n                    result = this._fontTags.push(fontTag) - 1\r\n                }\r\n            }\r\n            return result\r\n        }\r\n    }, {\r\n        key: \"generateFontsXml\",\r\n        value: function() {\r\n            var xmlStringsArray = this._fontTags.map(function(tag) {\r\n                return _excel8.default.toXml(tag)\r\n            });\r\n            return _excel2.default.toXml(\"fonts\", {\r\n                count: xmlStringsArray.length\r\n            }, xmlStringsArray.join(\"\"))\r\n        }\r\n    }, {\r\n        key: \"_convertNumberFormatIndexToId\",\r\n        value: function(index) {\r\n            var CUSTOM_FORMAT_ID_START_VALUE = 165;\r\n            return CUSTOM_FORMAT_ID_START_VALUE + index\r\n        }\r\n    }, {\r\n        key: \"registerNumberFormat\",\r\n        value: function(numberFormat) {\r\n            var result;\r\n            var tag = _excel10.default.tryCreateTag(numberFormat);\r\n            if ((0, _type.isDefined)(tag)) {\r\n                for (var i = 0; i < this._numberFormatTags.length; i++) {\r\n                    if (_excel10.default.areEqual(this._numberFormatTags[i], tag)) {\r\n                        result = this._numberFormatTags[i][_excel10.default.ID_PROPERTY_NAME];\r\n                        break\r\n                    }\r\n                }\r\n                if (void 0 === result) {\r\n                    tag[_excel10.default.ID_PROPERTY_NAME] = this._convertNumberFormatIndexToId(this._numberFormatTags.length);\r\n                    result = tag[_excel10.default.ID_PROPERTY_NAME];\r\n                    this._numberFormatTags.push(tag)\r\n                }\r\n            }\r\n            return result\r\n        }\r\n    }, {\r\n        key: \"generateNumberFormatsXml\",\r\n        value: function() {\r\n            if (this._numberFormatTags.length > 0) {\r\n                var xmlStringsArray = this._numberFormatTags.map(function(tag) {\r\n                    return _excel10.default.toXml(tag)\r\n                });\r\n                return _excel2.default.toXml(\"numFmts\", {\r\n                    count: xmlStringsArray.length\r\n                }, xmlStringsArray.join(\"\"))\r\n            } else {\r\n                return \"\"\r\n            }\r\n        }\r\n    }], [{\r\n        key: \"copyCellFormat\",\r\n        value: function(source) {\r\n            return _excel4.default.copy(source)\r\n        }\r\n    }]);\r\n    return ExcelFile\r\n}();\r\nexports.default = ExcelFile;\r\nmodule.exports = ExcelFile;\r\n"]},"metadata":{},"sourceType":"module"}