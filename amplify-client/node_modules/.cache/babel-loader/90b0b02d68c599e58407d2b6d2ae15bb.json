{"ast":null,"code":"/**\r\n * DevExtreme (ui/date_box/ui.date_box.strategy.list.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar $ = require(\"../../core/renderer\");\n\nvar window = require(\"../../core/utils/window\").getWindow();\n\nvar List = require(\"../list\");\n\nvar DateBoxStrategy = require(\"./ui.date_box.strategy\");\n\nvar noop = require(\"../../core/utils/common\").noop;\n\nvar ensureDefined = require(\"../../core/utils/common\").ensureDefined;\n\nvar isDate = require(\"../../core/utils/type\").isDate;\n\nvar extend = require(\"../../core/utils/extend\").extend;\n\nvar dateUtils = require(\"./ui.date_utils\");\n\nvar dateLocalization = require(\"../../localization/date\");\n\nvar DATE_FORMAT = \"date\";\nvar BOUNDARY_VALUES = {\n  min: new Date(0, 0, 0, 0, 0),\n  max: new Date(0, 0, 0, 23, 59)\n};\nvar ListStrategy = DateBoxStrategy.inherit({\n  NAME: \"List\",\n  supportedKeys: function supportedKeys() {\n    return {\n      tab: function tab() {\n        if (this.option(\"opened\")) {\n          this.close();\n        }\n      },\n      space: noop,\n      home: noop,\n      end: noop\n    };\n  },\n  getDefaultOptions: function getDefaultOptions() {\n    return extend(this.callBase(), {\n      applyValueMode: \"instantly\"\n    });\n  },\n  getDisplayFormat: function getDisplayFormat(displayFormat) {\n    return displayFormat || \"shorttime\";\n  },\n  popupConfig: function popupConfig(_popupConfig) {\n    return extend(_popupConfig, {\n      width: this._getPopupWidth()\n    });\n  },\n  useCurrentDateByDefault: function useCurrentDateByDefault() {\n    return true;\n  },\n  getDefaultDate: function getDefaultDate() {\n    return new Date(null);\n  },\n  _getPopupWidth: function _getPopupWidth() {\n    return this.dateBox.$element().outerWidth();\n  },\n  popupShowingHandler: function popupShowingHandler() {\n    this._dimensionChanged();\n  },\n  _renderWidget: function _renderWidget() {\n    this.callBase();\n\n    this._refreshItems();\n  },\n  _getWidgetName: function _getWidgetName() {\n    return List;\n  },\n  _getWidgetOptions: function _getWidgetOptions() {\n    var keyboardProcessor = this.dateBox._keyboardProcessor;\n    return {\n      _keyboardProcessor: keyboardProcessor ? keyboardProcessor.attachChildProcessor() : null,\n      itemTemplate: this._timeListItemTemplate.bind(this),\n      onItemClick: this._listItemClickHandler.bind(this),\n      tabIndex: -1,\n      onFocusedItemChanged: this._refreshActiveDescendant.bind(this),\n      selectionMode: \"single\"\n    };\n  },\n  _refreshActiveDescendant: function _refreshActiveDescendant(e) {\n    this.dateBox.setAria(\"activedescendant\", \"\");\n    this.dateBox.setAria(\"activedescendant\", e.actionValue);\n  },\n  _refreshItems: function _refreshItems() {\n    this._widgetItems = this._getTimeListItems();\n\n    this._widget.option(\"items\", this._widgetItems);\n  },\n  renderOpenedState: function renderOpenedState() {\n    if (!this._widget) {\n      return;\n    }\n\n    this._widget.option(\"focusedElement\", null);\n\n    this._setSelectedItemsByValue();\n\n    if (this._widget.option(\"templatesRenderAsynchronously\")) {\n      this._asyncScrollTimeout = setTimeout(this._scrollToSelectedItem.bind(this));\n    } else {\n      this._scrollToSelectedItem();\n    }\n  },\n  dispose: function dispose() {\n    this.callBase();\n    clearTimeout(this._asyncScrollTimeout);\n  },\n  _updateValue: function _updateValue() {\n    if (!this._widget) {\n      return;\n    }\n\n    this._refreshItems();\n\n    this._setSelectedItemsByValue();\n\n    this._scrollToSelectedItem();\n  },\n  _setSelectedItemsByValue: function _setSelectedItemsByValue() {\n    var value = this.dateBoxValue();\n\n    var dateIndex = this._getDateIndex(value);\n\n    if (dateIndex === -1) {\n      this._widget.option(\"selectedItems\", []);\n    } else {\n      this._widget.option(\"selectedIndex\", dateIndex);\n    }\n  },\n  _scrollToSelectedItem: function _scrollToSelectedItem() {\n    this._widget.scrollToItem(this._widget.option(\"selectedIndex\"));\n  },\n  _getDateIndex: function _getDateIndex(date) {\n    var result = -1;\n\n    for (var i = 0, n = this._widgetItems.length; i < n; i++) {\n      if (this._areDatesEqual(date, this._widgetItems[i])) {\n        result = i;\n        break;\n      }\n    }\n\n    return result;\n  },\n  _areDatesEqual: function _areDatesEqual(first, second) {\n    return isDate(first) && isDate(second) && first.getHours() === second.getHours() && first.getMinutes() === second.getMinutes();\n  },\n  _getTimeListItems: function _getTimeListItems() {\n    var min = this.dateBox.dateOption(\"min\") || this._getBoundaryDate(\"min\");\n\n    var max = this.dateBox.dateOption(\"max\") || this._getBoundaryDate(\"max\");\n\n    var value = this.dateBox.dateOption(\"value\") || null;\n    var delta = max - min;\n    var minutes = min.getMinutes() % this.dateBox.option(\"interval\");\n\n    if (delta < 0) {\n      return [];\n    }\n\n    if (delta > dateUtils.ONE_DAY) {\n      delta = dateUtils.ONE_DAY;\n    }\n\n    if (value - min < dateUtils.ONE_DAY) {\n      return this._getRangeItems(min, new Date(min), delta);\n    }\n\n    min = this._getBoundaryDate(\"min\");\n    min.setMinutes(minutes);\n\n    if (value && Math.abs(value - max) < dateUtils.ONE_DAY) {\n      delta = (60 * max.getHours() + Math.abs(max.getMinutes() - minutes)) * dateUtils.ONE_MINUTE;\n    }\n\n    return this._getRangeItems(min, new Date(min), delta);\n  },\n  _getRangeItems: function _getRangeItems(startValue, currentValue, rangeDuration) {\n    var rangeItems = [];\n    var interval = this.dateBox.option(\"interval\");\n\n    while (currentValue - startValue < rangeDuration) {\n      rangeItems.push(new Date(currentValue));\n      currentValue.setMinutes(currentValue.getMinutes() + interval);\n    }\n\n    return rangeItems;\n  },\n  _getBoundaryDate: function _getBoundaryDate(boundary) {\n    var boundaryValue = BOUNDARY_VALUES[boundary];\n    var currentValue = new Date(ensureDefined(this.dateBox.dateOption(\"value\"), 0));\n    return new Date(currentValue.getFullYear(), currentValue.getMonth(), currentValue.getDate(), boundaryValue.getHours(), boundaryValue.getMinutes());\n  },\n  _timeListItemTemplate: function _timeListItemTemplate(itemData) {\n    var displayFormat = this.dateBox.option(\"displayFormat\");\n    return dateLocalization.format(itemData, this.getDisplayFormat(displayFormat));\n  },\n  _listItemClickHandler: function _listItemClickHandler(e) {\n    this.dateBox.option(\"opened\", false);\n    var date = this.dateBox.option(\"value\");\n    var itemData = e.itemData;\n    var hours = itemData.getHours();\n    var minutes = itemData.getMinutes();\n    var seconds = itemData.getSeconds();\n    var year = itemData.getFullYear();\n    var month = itemData.getMonth();\n    var day = itemData.getDate();\n\n    if (date) {\n      date = new Date(date);\n      date.setHours(hours);\n      date.setMinutes(minutes);\n      date.setSeconds(seconds);\n      date.setFullYear(year);\n      date.setMonth(month);\n      date.setDate(day);\n    } else {\n      date = new Date(year, month, day, hours, minutes, 0, 0);\n    }\n\n    this.dateBoxValue(date);\n  },\n  attachKeyboardEvents: function attachKeyboardEvents(keyboardProcessor) {\n    var child = keyboardProcessor.attachChildProcessor();\n\n    if (this._widget) {\n      this._widget.option(\"_keyboardProcessor\", child);\n    }\n  },\n  _dimensionChanged: function _dimensionChanged() {\n    this._getPopup() && this._updatePopupDimensions();\n  },\n  _updatePopupDimensions: function _updatePopupDimensions() {\n    this._updatePopupWidth();\n\n    this._updatePopupHeight();\n  },\n  _updatePopupWidth: function _updatePopupWidth() {\n    this.dateBox._setPopupOption(\"width\", this._getPopupWidth());\n  },\n  _updatePopupHeight: function _updatePopupHeight() {\n    this.dateBox._setPopupOption(\"height\", \"auto\");\n\n    var popupHeight = this._widget.$element().outerHeight();\n\n    var maxHeight = .45 * $(window).height();\n\n    this.dateBox._setPopupOption(\"height\", Math.min(popupHeight, maxHeight));\n\n    this.dateBox._timeList && this.dateBox._timeList.updateDimensions();\n  },\n  getParsedText: function getParsedText(text, format) {\n    var value = this.callBase(text, format);\n\n    if (value) {\n      value = dateUtils.mergeDates(value, new Date(null), DATE_FORMAT);\n    }\n\n    return value;\n  }\n});\nmodule.exports = ListStrategy;","map":{"version":3,"sources":["C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/devextreme/ui/date_box/ui.date_box.strategy.list.js"],"names":["$","require","window","List","DateBoxStrategy","noop","ensureDefined","isDate","extend","dateUtils","dateLocalization","DATE_FORMAT","BOUNDARY_VALUES","min","max","ListStrategy","NAME","supportedKeys","tab","space","home","end","getDefaultOptions","applyValueMode","getDisplayFormat","displayFormat","popupConfig","width","useCurrentDateByDefault","getDefaultDate","_getPopupWidth","popupShowingHandler","_renderWidget","_getWidgetName","_getWidgetOptions","keyboardProcessor","_keyboardProcessor","itemTemplate","onItemClick","tabIndex","onFocusedItemChanged","selectionMode","_refreshActiveDescendant","e","_refreshItems","renderOpenedState","setTimeout","dispose","clearTimeout","_updateValue","_setSelectedItemsByValue","value","dateIndex","_scrollToSelectedItem","_getDateIndex","result","i","n","_areDatesEqual","first","second","_getTimeListItems","delta","minutes","Math","_getRangeItems","rangeItems","interval","currentValue","_getBoundaryDate","boundaryValue","_timeListItemTemplate","_listItemClickHandler","date","itemData","hours","seconds","year","month","day","attachKeyboardEvents","child","_dimensionChanged","_updatePopupDimensions","_updatePopupWidth","_updatePopupHeight","popupHeight","maxHeight","getParsedText","module"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/date_box/ui.date_box.strategy.list.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar $ = require(\"../../core/renderer\");\r\nvar window = require(\"../../core/utils/window\").getWindow();\r\nvar List = require(\"../list\");\r\nvar DateBoxStrategy = require(\"./ui.date_box.strategy\");\r\nvar noop = require(\"../../core/utils/common\").noop;\r\nvar ensureDefined = require(\"../../core/utils/common\").ensureDefined;\r\nvar isDate = require(\"../../core/utils/type\").isDate;\r\nvar extend = require(\"../../core/utils/extend\").extend;\r\nvar dateUtils = require(\"./ui.date_utils\");\r\nvar dateLocalization = require(\"../../localization/date\");\r\nvar DATE_FORMAT = \"date\";\r\nvar BOUNDARY_VALUES = {\r\n    min: new Date(0, 0, 0, 0, 0),\r\n    max: new Date(0, 0, 0, 23, 59)\r\n};\r\nvar ListStrategy = DateBoxStrategy.inherit({\r\n    NAME: \"List\",\r\n    supportedKeys: function() {\r\n        return {\r\n            tab: function() {\r\n                if (this.option(\"opened\")) {\r\n                    this.close()\r\n                }\r\n            },\r\n            space: noop,\r\n            home: noop,\r\n            end: noop\r\n        }\r\n    },\r\n    getDefaultOptions: function() {\r\n        return extend(this.callBase(), {\r\n            applyValueMode: \"instantly\"\r\n        })\r\n    },\r\n    getDisplayFormat: function(displayFormat) {\r\n        return displayFormat || \"shorttime\"\r\n    },\r\n    popupConfig: function(_popupConfig) {\r\n        return extend(_popupConfig, {\r\n            width: this._getPopupWidth()\r\n        })\r\n    },\r\n    useCurrentDateByDefault: function() {\r\n        return true\r\n    },\r\n    getDefaultDate: function() {\r\n        return new Date(null)\r\n    },\r\n    _getPopupWidth: function() {\r\n        return this.dateBox.$element().outerWidth()\r\n    },\r\n    popupShowingHandler: function() {\r\n        this._dimensionChanged()\r\n    },\r\n    _renderWidget: function() {\r\n        this.callBase();\r\n        this._refreshItems()\r\n    },\r\n    _getWidgetName: function() {\r\n        return List\r\n    },\r\n    _getWidgetOptions: function() {\r\n        var keyboardProcessor = this.dateBox._keyboardProcessor;\r\n        return {\r\n            _keyboardProcessor: keyboardProcessor ? keyboardProcessor.attachChildProcessor() : null,\r\n            itemTemplate: this._timeListItemTemplate.bind(this),\r\n            onItemClick: this._listItemClickHandler.bind(this),\r\n            tabIndex: -1,\r\n            onFocusedItemChanged: this._refreshActiveDescendant.bind(this),\r\n            selectionMode: \"single\"\r\n        }\r\n    },\r\n    _refreshActiveDescendant: function(e) {\r\n        this.dateBox.setAria(\"activedescendant\", \"\");\r\n        this.dateBox.setAria(\"activedescendant\", e.actionValue)\r\n    },\r\n    _refreshItems: function() {\r\n        this._widgetItems = this._getTimeListItems();\r\n        this._widget.option(\"items\", this._widgetItems)\r\n    },\r\n    renderOpenedState: function() {\r\n        if (!this._widget) {\r\n            return\r\n        }\r\n        this._widget.option(\"focusedElement\", null);\r\n        this._setSelectedItemsByValue();\r\n        if (this._widget.option(\"templatesRenderAsynchronously\")) {\r\n            this._asyncScrollTimeout = setTimeout(this._scrollToSelectedItem.bind(this))\r\n        } else {\r\n            this._scrollToSelectedItem()\r\n        }\r\n    },\r\n    dispose: function() {\r\n        this.callBase();\r\n        clearTimeout(this._asyncScrollTimeout)\r\n    },\r\n    _updateValue: function() {\r\n        if (!this._widget) {\r\n            return\r\n        }\r\n        this._refreshItems();\r\n        this._setSelectedItemsByValue();\r\n        this._scrollToSelectedItem()\r\n    },\r\n    _setSelectedItemsByValue: function() {\r\n        var value = this.dateBoxValue();\r\n        var dateIndex = this._getDateIndex(value);\r\n        if (dateIndex === -1) {\r\n            this._widget.option(\"selectedItems\", [])\r\n        } else {\r\n            this._widget.option(\"selectedIndex\", dateIndex)\r\n        }\r\n    },\r\n    _scrollToSelectedItem: function() {\r\n        this._widget.scrollToItem(this._widget.option(\"selectedIndex\"))\r\n    },\r\n    _getDateIndex: function(date) {\r\n        var result = -1;\r\n        for (var i = 0, n = this._widgetItems.length; i < n; i++) {\r\n            if (this._areDatesEqual(date, this._widgetItems[i])) {\r\n                result = i;\r\n                break\r\n            }\r\n        }\r\n        return result\r\n    },\r\n    _areDatesEqual: function(first, second) {\r\n        return isDate(first) && isDate(second) && first.getHours() === second.getHours() && first.getMinutes() === second.getMinutes()\r\n    },\r\n    _getTimeListItems: function() {\r\n        var min = this.dateBox.dateOption(\"min\") || this._getBoundaryDate(\"min\");\r\n        var max = this.dateBox.dateOption(\"max\") || this._getBoundaryDate(\"max\");\r\n        var value = this.dateBox.dateOption(\"value\") || null;\r\n        var delta = max - min;\r\n        var minutes = min.getMinutes() % this.dateBox.option(\"interval\");\r\n        if (delta < 0) {\r\n            return []\r\n        }\r\n        if (delta > dateUtils.ONE_DAY) {\r\n            delta = dateUtils.ONE_DAY\r\n        }\r\n        if (value - min < dateUtils.ONE_DAY) {\r\n            return this._getRangeItems(min, new Date(min), delta)\r\n        }\r\n        min = this._getBoundaryDate(\"min\");\r\n        min.setMinutes(minutes);\r\n        if (value && Math.abs(value - max) < dateUtils.ONE_DAY) {\r\n            delta = (60 * max.getHours() + Math.abs(max.getMinutes() - minutes)) * dateUtils.ONE_MINUTE\r\n        }\r\n        return this._getRangeItems(min, new Date(min), delta)\r\n    },\r\n    _getRangeItems: function(startValue, currentValue, rangeDuration) {\r\n        var rangeItems = [];\r\n        var interval = this.dateBox.option(\"interval\");\r\n        while (currentValue - startValue < rangeDuration) {\r\n            rangeItems.push(new Date(currentValue));\r\n            currentValue.setMinutes(currentValue.getMinutes() + interval)\r\n        }\r\n        return rangeItems\r\n    },\r\n    _getBoundaryDate: function(boundary) {\r\n        var boundaryValue = BOUNDARY_VALUES[boundary];\r\n        var currentValue = new Date(ensureDefined(this.dateBox.dateOption(\"value\"), 0));\r\n        return new Date(currentValue.getFullYear(), currentValue.getMonth(), currentValue.getDate(), boundaryValue.getHours(), boundaryValue.getMinutes())\r\n    },\r\n    _timeListItemTemplate: function(itemData) {\r\n        var displayFormat = this.dateBox.option(\"displayFormat\");\r\n        return dateLocalization.format(itemData, this.getDisplayFormat(displayFormat))\r\n    },\r\n    _listItemClickHandler: function(e) {\r\n        this.dateBox.option(\"opened\", false);\r\n        var date = this.dateBox.option(\"value\");\r\n        var itemData = e.itemData;\r\n        var hours = itemData.getHours();\r\n        var minutes = itemData.getMinutes();\r\n        var seconds = itemData.getSeconds();\r\n        var year = itemData.getFullYear();\r\n        var month = itemData.getMonth();\r\n        var day = itemData.getDate();\r\n        if (date) {\r\n            date = new Date(date);\r\n            date.setHours(hours);\r\n            date.setMinutes(minutes);\r\n            date.setSeconds(seconds);\r\n            date.setFullYear(year);\r\n            date.setMonth(month);\r\n            date.setDate(day)\r\n        } else {\r\n            date = new Date(year, month, day, hours, minutes, 0, 0)\r\n        }\r\n        this.dateBoxValue(date)\r\n    },\r\n    attachKeyboardEvents: function(keyboardProcessor) {\r\n        var child = keyboardProcessor.attachChildProcessor();\r\n        if (this._widget) {\r\n            this._widget.option(\"_keyboardProcessor\", child)\r\n        }\r\n    },\r\n    _dimensionChanged: function() {\r\n        this._getPopup() && this._updatePopupDimensions()\r\n    },\r\n    _updatePopupDimensions: function() {\r\n        this._updatePopupWidth();\r\n        this._updatePopupHeight()\r\n    },\r\n    _updatePopupWidth: function() {\r\n        this.dateBox._setPopupOption(\"width\", this._getPopupWidth())\r\n    },\r\n    _updatePopupHeight: function() {\r\n        this.dateBox._setPopupOption(\"height\", \"auto\");\r\n        var popupHeight = this._widget.$element().outerHeight();\r\n        var maxHeight = .45 * $(window).height();\r\n        this.dateBox._setPopupOption(\"height\", Math.min(popupHeight, maxHeight));\r\n        this.dateBox._timeList && this.dateBox._timeList.updateDimensions()\r\n    },\r\n    getParsedText: function(text, format) {\r\n        var value = this.callBase(text, format);\r\n        if (value) {\r\n            value = dateUtils.mergeDates(value, new Date(null), DATE_FORMAT)\r\n        }\r\n        return value\r\n    }\r\n});\r\nmodule.exports = ListStrategy;\r\n"]},"metadata":{},"sourceType":"module"}