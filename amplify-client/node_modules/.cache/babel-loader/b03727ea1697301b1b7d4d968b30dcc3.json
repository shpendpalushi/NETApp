{"ast":null,"code":"/**\r\n * DevExtreme (ui/pivot_grid/remote_store.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar _type = require(\"../../core/utils/type\");\n\nvar _class = require(\"../../core/class\");\n\nvar _class2 = _interopRequireDefault(_class);\n\nvar _extend = require(\"../../core/utils/extend\");\n\nvar _iterator = require(\"../../core/utils/iterator\");\n\nvar _data_source = require(\"../../data/data_source/data_source\");\n\nvar _deferred = require(\"../../core/utils/deferred\");\n\nvar _uiPivot_grid = require(\"./ui.pivot_grid.utils\");\n\nvar _date_serialization = require(\"../../core/utils/date_serialization\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance\");\n}\n\nfunction _iterableToArray(iter) {\n  if (Symbol.iterator in Object(iter) || \"[object Arguments]\" === Object.prototype.toString.call(iter)) {\n    return Array.from(iter);\n  }\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) {\n      arr2[i] = arr[i];\n    }\n\n    return arr2;\n  }\n}\n\nfunction createGroupingOptions(dimensionOptions, useSortOrder) {\n  var groupingOptions = [];\n  (0, _iterator.each)(dimensionOptions, function (index, dimensionOption) {\n    groupingOptions.push({\n      selector: dimensionOption.dataField,\n      groupInterval: dimensionOption.groupInterval,\n      desc: useSortOrder && \"desc\" === dimensionOption.sortOrder,\n      isExpanded: index < dimensionOptions.length - 1\n    });\n  });\n  return groupingOptions;\n}\n\nfunction getFieldFilterSelector(field) {\n  var selector = field.dataField;\n  var groupInterval = field.groupInterval;\n\n  if (\"date\" === field.dataType && \"string\" === typeof groupInterval) {\n    if (\"quarter\" === groupInterval.toLowerCase()) {\n      groupInterval = \"Month\";\n    }\n\n    selector = selector + \".\" + (0, _uiPivot_grid.capitalizeFirstLetter)(groupInterval);\n  }\n\n  return selector;\n}\n\nfunction getIntervalFilterExpression(selector, numericInterval, numericValue, isExcludedFilterType) {\n  var startFilterValue = [selector, isExcludedFilterType ? \"<\" : \">=\", numericValue];\n  var endFilterValue = [selector, isExcludedFilterType ? \">=\" : \"<\", numericValue + numericInterval];\n  return [startFilterValue, isExcludedFilterType ? \"or\" : \"and\", endFilterValue];\n}\n\nfunction getFilterExpressionForFilterValue(field, filterValue) {\n  var selector = getFieldFilterSelector(field);\n  var isExcludedFilterType = \"exclude\" === field.filterType;\n  var expression = [selector, isExcludedFilterType ? \"<>\" : \"=\", filterValue];\n\n  if ((0, _type.isDefined)(field.groupInterval)) {\n    if (\"string\" === typeof field.groupInterval && \"quarter\" === field.groupInterval.toLowerCase()) {\n      expression = getIntervalFilterExpression(selector, 3, 3 * (filterValue - 1) + 1, isExcludedFilterType);\n    } else {\n      if (\"number\" === typeof field.groupInterval && \"date\" !== field.dataType) {\n        expression = getIntervalFilterExpression(selector, field.groupInterval, filterValue, isExcludedFilterType);\n      }\n    }\n  }\n\n  return expression;\n}\n\nfunction createFieldFilterExpressions(field, operation) {\n  var fieldFilterExpressions = [];\n\n  if (field.searchValue) {\n    return [field.dataField, \"contains\", field.searchValue];\n  }\n\n  if (\"exclude\" === field.filterType) {\n    operation = operation || \"and\";\n  } else {\n    operation = operation || \"or\";\n  }\n\n  (0, _iterator.each)(field.filterValues, function (index, filterValue) {\n    var currentExpression = [];\n\n    if (Array.isArray(filterValue)) {\n      var parseLevelsRecursive = field.levels && field.levels.length;\n\n      if (parseLevelsRecursive) {\n        currentExpression = createFieldFilterExpressions({\n          filterValues: filterValue,\n          filterType: field.filterType,\n          levels: field.levels\n        }, \"and\");\n      }\n    } else {\n      var currentField = field.levels ? field.levels[index] : field;\n      currentExpression = getFilterExpressionForFilterValue(currentField, filterValue);\n    }\n\n    if (!currentExpression.length) {\n      return;\n    }\n\n    if (fieldFilterExpressions.length) {\n      fieldFilterExpressions.push(operation);\n    }\n\n    fieldFilterExpressions.push(currentExpression);\n  });\n  return fieldFilterExpressions;\n}\n\nfunction createFilterExpressions(fields) {\n  var filterExpressions = [];\n  (0, _iterator.each)(fields, function (_, field) {\n    var fieldExpressions = createFieldFilterExpressions(field);\n\n    if (!fieldExpressions.length) {\n      return [];\n    }\n\n    if (filterExpressions.length) {\n      filterExpressions.push(\"and\");\n    }\n\n    filterExpressions.push(fieldExpressions);\n  });\n\n  if (1 === filterExpressions.length) {\n    filterExpressions = filterExpressions[0];\n  }\n\n  return filterExpressions;\n}\n\nfunction mergeFilters(filter1, filter2) {\n  var mergedFilter;\n\n  var notEmpty = function notEmpty(filter) {\n    return filter && filter.length;\n  };\n\n  if (notEmpty(filter1) && notEmpty(filter2)) {\n    mergedFilter = [filter1, \"and\", filter2];\n  } else {\n    mergedFilter = notEmpty(filter1) ? filter1 : filter2;\n  }\n\n  return mergedFilter;\n}\n\nfunction createLoadOptions(options, externalFilterExpr, hasRows) {\n  var filterExpressions = createFilterExpressions(options.filters);\n  var groupingOptions = createGroupingOptions(options.rows, options.rowTake).concat(createGroupingOptions(options.columns, options.columnTake));\n  var loadOptions = {\n    groupSummary: [],\n    totalSummary: [],\n    group: groupingOptions.length ? groupingOptions : void 0,\n    take: groupingOptions.length ? void 0 : 1\n  };\n\n  if (options.rows.length && options.rowTake) {\n    loadOptions.skip = options.rowSkip;\n    loadOptions.take = options.rowTake;\n    loadOptions.requireGroupCount = true;\n  } else {\n    if (options.columns.length && options.columnTake && !hasRows) {\n      loadOptions.skip = options.columnSkip;\n      loadOptions.take = options.columnTake;\n      loadOptions.requireGroupCount = true;\n    }\n  }\n\n  if (externalFilterExpr) {\n    filterExpressions = mergeFilters(filterExpressions, externalFilterExpr);\n  }\n\n  if (filterExpressions.length) {\n    loadOptions.filter = filterExpressions;\n  }\n\n  (0, _iterator.each)(options.values, function (_, value) {\n    var summaryOption = {\n      selector: value.dataField,\n      summaryType: value.summaryType || \"count\"\n    };\n    loadOptions.groupSummary.push(summaryOption);\n    options.includeTotalSummary && loadOptions.totalSummary.push(summaryOption);\n  });\n  return loadOptions;\n}\n\nfunction forEachGroup(data, callback, level) {\n  data = data || [];\n  level = level || 0;\n\n  for (var i = 0; i < data.length; i++) {\n    var group = data[i];\n    callback(group, level);\n\n    if (group && group.items && group.items.length) {\n      forEachGroup(group.items, callback, level + 1);\n    }\n  }\n}\n\nfunction setValue(valuesArray, value, rowIndex, columnIndex, dataIndex) {\n  valuesArray[rowIndex] = valuesArray[rowIndex] || [];\n  valuesArray[rowIndex][columnIndex] = valuesArray[rowIndex][columnIndex] || [];\n\n  if (!(0, _type.isDefined)(valuesArray[rowIndex][columnIndex][dataIndex])) {\n    valuesArray[rowIndex][columnIndex][dataIndex] = value;\n  }\n}\n\nfunction parseValue(value, field) {\n  if (field && \"number\" === field.dataType && (0, _type.isString)(value)) {\n    return Number(value);\n  }\n\n  if (field && \"date\" === field.dataType && !field.groupInterval && !(value instanceof Date)) {\n    return (0, _date_serialization.deserializeDate)(value);\n  }\n\n  return value;\n}\n\nfunction parseResult(data, total, descriptions, result) {\n  var rowPath = [];\n  var columnPath = [];\n  var rowHash = result.rowHash;\n  var columnHash = result.columnHash;\n\n  if (total && total.summary) {\n    (0, _iterator.each)(total.summary, function (index, summary) {\n      setValue(result.values, summary, result.grandTotalRowIndex, result.grandTotalColumnIndex, index);\n    });\n  }\n\n  if (total && total.groupCount >= 0) {\n    var skip = descriptions.rows.length ? descriptions.rowSkip : descriptions.columnSkip;\n    data = _toConsumableArray(Array(skip)).concat(data);\n    data.length = total.groupCount;\n  }\n\n  function getItem(dataItem, dimensionName, path, level, field) {\n    var dimensionHash = result[dimensionName + \"Hash\"];\n    var parentItem;\n    var parentItemChildren;\n    var item;\n    var pathValue = path.slice(0, level + 1).join(\"/\");\n    var parentPathValue;\n\n    if (void 0 !== dimensionHash[pathValue]) {\n      item = dimensionHash[pathValue];\n    } else {\n      item = {\n        value: parseValue(dataItem.key, field),\n        index: result[dimensionName + \"Index\"]++\n      };\n      parentPathValue = path.slice(0, level).join(\"/\");\n\n      if (level > 0 && void 0 !== dimensionHash[parentPathValue]) {\n        parentItem = dimensionHash[parentPathValue];\n        parentItemChildren = parentItem.children = parentItem.children || [];\n      } else {\n        parentItemChildren = result[dimensionName + \"s\"];\n      }\n\n      parentItemChildren.push(item);\n      dimensionHash[pathValue] = item;\n    }\n\n    return item;\n  }\n\n  forEachGroup(data, function (item, level) {\n    var rowLevel = level >= descriptions.rows.length ? descriptions.rows.length : level;\n    var columnLevel = level >= descriptions.rows.length ? level - descriptions.rows.length : 0;\n    var columnItem;\n    var rowItem;\n\n    if (level >= descriptions.rows.length && columnLevel >= descriptions.columns.length) {\n      return;\n    }\n\n    if (level < descriptions.rows.length) {\n      columnPath = [];\n    }\n\n    if (level >= descriptions.rows.length) {\n      if (item) {\n        columnPath[columnLevel] = item.key + \"\";\n        columnItem = getItem(item, \"column\", columnPath, columnLevel, descriptions.columns[columnPath.length - 1]);\n        rowItem = rowHash[rowPath.slice(0, rowLevel + 1).join(\"/\")];\n      } else {\n        result.columns.push({});\n      }\n    } else {\n      if (item) {\n        rowPath[rowLevel] = item.key + \"\";\n        rowItem = getItem(item, \"row\", rowPath, rowLevel);\n        columnItem = columnHash[columnPath.slice(0, columnLevel + 1).join(\"/\")];\n      } else {\n        result.rows.push({});\n      }\n    }\n\n    var currentRowIndex = rowItem && rowItem.index || result.grandTotalRowIndex;\n    var currentColumnIndex = columnItem && columnItem.index || result.grandTotalColumnIndex;\n    (0, _iterator.each)(item && item.summary || [], function (i, summary) {\n      setValue(result.values, summary, currentRowIndex, currentColumnIndex, i);\n    });\n  });\n  return result;\n}\n\nfunction getFiltersForDimension(fields) {\n  return (fields || []).filter(function (f) {\n    return f.filterValues && f.filterValues.length || f.searchValue;\n  });\n}\n\nfunction getExpandedIndex(options, axis) {\n  if (options.headerName) {\n    if (axis === options.headerName) {\n      return options.path.length;\n    } else {\n      if (options.oppositePath) {\n        return options.oppositePath.length;\n      }\n    }\n  }\n\n  return 0;\n}\n\nfunction getFiltersForExpandedDimension(options) {\n  return (0, _uiPivot_grid.getFiltersByPath)(options[options.headerName], options.path).concat((0, _uiPivot_grid.getFiltersByPath)(options[\"rows\" === options.headerName ? \"columns\" : \"rows\"], options.oppositePath || []));\n}\n\nfunction getExpandedPathSliceFilter(options, dimensionName, level, firstCollapsedFieldIndex) {\n  var result = [];\n  var startSliceIndex = level > firstCollapsedFieldIndex ? 0 : firstCollapsedFieldIndex;\n  var fields = options.headerName !== dimensionName ? options[dimensionName].slice(startSliceIndex, level) : [];\n  var paths = \"rows\" === dimensionName ? options.rowExpandedPaths : options.columnExpandedPaths;\n  (0, _iterator.each)(fields, function (index, field) {\n    var filterValues = [];\n    (0, _iterator.each)(paths, function (_, path) {\n      path = path.slice(startSliceIndex, level);\n\n      if (index < path.length) {\n        filterValues.push(path[index]);\n      }\n    });\n\n    if (filterValues.length) {\n      result.push((0, _extend.extend)({}, field, {\n        filterType: \"include\",\n        filterValues: filterValues\n      }));\n    }\n  });\n  return result;\n}\n\nfunction getGrandTotalRequest(options, dimensionName, expandedIndex, expandedLevel, commonFilters, firstCollapsedFieldIndex) {\n  var expandedPaths = (\"columns\" === dimensionName ? options.columnExpandedPaths : options.rowExpandedPaths) || [];\n  var oppositeDimensionName = \"columns\" === dimensionName ? \"rows\" : \"columns\";\n  var fields = options[dimensionName];\n  var result = [];\n  var newOptions;\n\n  if (expandedPaths.length) {\n    for (var i = expandedIndex; i < expandedLevel + 1; i++) {\n      newOptions = {\n        filters: commonFilters.concat(getExpandedPathSliceFilter(options, dimensionName, i, firstCollapsedFieldIndex))\n      };\n      newOptions[dimensionName] = fields.slice(expandedIndex, i + 1);\n      newOptions[oppositeDimensionName] = [];\n      result.push((0, _extend.extend)({}, options, newOptions));\n    }\n  } else {\n    newOptions = {\n      filters: commonFilters\n    };\n    newOptions[dimensionName] = fields.slice(expandedIndex, expandedLevel + 1);\n    newOptions[oppositeDimensionName] = [];\n    result.push((0, _extend.extend)({}, options, newOptions));\n  }\n\n  result[0].includeTotalSummary = true;\n  return result;\n}\n\nfunction getFirstCollapsedIndex(fields) {\n  var firstCollapsedIndex = 0;\n  (0, _iterator.each)(fields, function (index, field) {\n    if (!field.expanded) {\n      firstCollapsedIndex = index;\n      return false;\n    }\n  });\n  return firstCollapsedIndex;\n}\n\nfunction getRequestsData(options) {\n  var rowExpandedLevel = (0, _uiPivot_grid.getExpandedLevel)(options, \"rows\");\n  var columnExpandedLevel = (0, _uiPivot_grid.getExpandedLevel)(options, \"columns\");\n  var filters = options.filters || [];\n  var columnExpandedIndex = getExpandedIndex(options, \"columns\");\n  var firstCollapsedColumnIndex = getFirstCollapsedIndex(options.columns);\n  var firstCollapsedRowIndex = getFirstCollapsedIndex(options.rows);\n  var rowExpandedIndex = getExpandedIndex(options, \"rows\");\n  var data = [];\n  filters = filters.concat(getFiltersForDimension(options.rows)).concat(getFiltersForDimension(options.columns)).concat(getFiltersForExpandedDimension(options));\n  var columnTotalsOptions = getGrandTotalRequest(options, \"columns\", columnExpandedIndex, columnExpandedLevel, filters, firstCollapsedColumnIndex);\n\n  if (options.rows.length && options.columns.length) {\n    if (\"rows\" !== options.headerName) {\n      data = data.concat(columnTotalsOptions);\n    }\n\n    for (var i = rowExpandedIndex; i < rowExpandedLevel + 1; i++) {\n      var rows = options.rows.slice(rowExpandedIndex, i + 1);\n      var rowFilterByExpandedPaths = getExpandedPathSliceFilter(options, \"rows\", i, firstCollapsedRowIndex);\n\n      for (var j = columnExpandedIndex; j < columnExpandedLevel + 1; j++) {\n        var preparedOptions = (0, _extend.extend)({}, options, {\n          columns: options.columns.slice(columnExpandedIndex, j + 1),\n          rows: rows,\n          filters: filters.concat(getExpandedPathSliceFilter(options, \"columns\", j, firstCollapsedColumnIndex)).concat(rowFilterByExpandedPaths)\n        });\n        data.push(preparedOptions);\n      }\n    }\n  } else {\n    data = options.columns.length ? columnTotalsOptions : getGrandTotalRequest(options, \"rows\", rowExpandedIndex, rowExpandedLevel, filters, firstCollapsedRowIndex);\n  }\n\n  return data;\n}\n\nfunction prepareFields(fields) {\n  (0, _iterator.each)(fields || [], function (_, field) {\n    var levels = field.levels;\n\n    if (levels) {\n      prepareFields(levels);\n    }\n\n    (0, _uiPivot_grid.setDefaultFieldValueFormatting)(field);\n  });\n}\n\nmodule.exports = _class2.default.inherit(function () {\n  return {\n    ctor: function ctor(options) {\n      this._dataSource = new _data_source.DataSource(options);\n      this._store = this._dataSource.store();\n    },\n    getFields: function getFields(fields) {\n      var d = new _deferred.Deferred();\n\n      this._store.load({\n        skip: 0,\n        take: 20\n      }).done(function (data) {\n        d.resolve((0, _uiPivot_grid.discoverObjectFields)(data, fields));\n      }).fail(d.reject);\n\n      return d;\n    },\n    key: function key() {\n      return this._store.key();\n    },\n    load: function load(options) {\n      var that = this;\n      var d = new _deferred.Deferred();\n      var result = {\n        rows: [],\n        columns: [],\n        values: [[[]]],\n        grandTotalRowIndex: 0,\n        grandTotalColumnIndex: 0,\n        rowHash: {},\n        columnHash: {},\n        rowIndex: 1,\n        columnIndex: 1\n      };\n      var requestsData = getRequestsData(options);\n      var deferreds = [];\n      prepareFields(options.rows);\n      prepareFields(options.columns);\n      prepareFields(options.filters);\n      (0, _iterator.each)(requestsData, function (_, dataItem) {\n        deferreds.push(that._store.load(createLoadOptions(dataItem, that.filter(), options.rows.length)));\n      });\n\n      _deferred.when.apply(null, deferreds).done(function () {\n        var args = deferreds.length > 1 ? arguments : [arguments];\n        (0, _iterator.each)(args, function (index, argument) {\n          parseResult(argument[0], argument[1], requestsData[index], result);\n        });\n        d.resolve({\n          rows: result.rows,\n          columns: result.columns,\n          values: result.values,\n          grandTotalRowIndex: result.grandTotalRowIndex,\n          grandTotalColumnIndex: result.grandTotalColumnIndex\n        });\n      }).fail(d.reject);\n\n      return d;\n    },\n    filter: function filter() {\n      return this._dataSource.filter.apply(this._dataSource, arguments);\n    },\n    supportPaging: function supportPaging() {\n      return false;\n    },\n    createDrillDownDataSource: function createDrillDownDataSource(loadOptions, params) {\n      loadOptions = loadOptions || {};\n      params = params || {};\n      var store = this._store;\n      var filters = (0, _uiPivot_grid.getFiltersByPath)(loadOptions.rows, params.rowPath).concat((0, _uiPivot_grid.getFiltersByPath)(loadOptions.columns, params.columnPath)).concat(getFiltersForDimension(loadOptions.rows)).concat(loadOptions.filters || []).concat(getFiltersForDimension(loadOptions.columns));\n      var filterExp = createFilterExpressions(filters);\n      return new _data_source.DataSource({\n        load: function load(loadOptions) {\n          return store.load((0, _extend.extend)({}, loadOptions, {\n            filter: mergeFilters(filterExp, loadOptions.filter),\n            select: params.customColumns\n          }));\n        }\n      });\n    }\n  };\n}());","map":{"version":3,"sources":["C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/devextreme/ui/pivot_grid/remote_store.js"],"names":["_type","require","_class","_class2","_interopRequireDefault","_extend","_iterator","_data_source","_deferred","_uiPivot_grid","_date_serialization","obj","_arrayWithoutHoles","_iterableToArray","_nonIterableSpread","Symbol","Object","Array","i","arr2","arr","groupingOptions","selector","dimensionOption","groupInterval","desc","useSortOrder","isExpanded","index","dimensionOptions","field","startFilterValue","isExcludedFilterType","endFilterValue","numericValue","getFieldFilterSelector","expression","getIntervalFilterExpression","filterValue","fieldFilterExpressions","operation","currentExpression","parseLevelsRecursive","createFieldFilterExpressions","filterValues","filterType","levels","currentField","getFilterExpressionForFilterValue","filterExpressions","fieldExpressions","notEmpty","filter","mergedFilter","createFilterExpressions","options","createGroupingOptions","loadOptions","groupSummary","totalSummary","group","take","mergeFilters","summaryOption","value","summaryType","data","level","callback","forEachGroup","valuesArray","Number","rowPath","columnPath","rowHash","result","columnHash","total","setValue","skip","descriptions","_toConsumableArray","dimensionHash","dimensionName","pathValue","path","item","parseValue","dataItem","parentPathValue","parentItem","parentItemChildren","rowLevel","columnLevel","columnItem","getItem","rowItem","currentRowIndex","currentColumnIndex","fields","f","axis","startSliceIndex","paths","expandedPaths","oppositeDimensionName","expandedLevel","newOptions","filters","commonFilters","getExpandedPathSliceFilter","firstCollapsedIndex","rowExpandedLevel","columnExpandedLevel","columnExpandedIndex","getExpandedIndex","firstCollapsedColumnIndex","getFirstCollapsedIndex","firstCollapsedRowIndex","rowExpandedIndex","getFiltersForDimension","getFiltersForExpandedDimension","columnTotalsOptions","getGrandTotalRequest","rows","rowFilterByExpandedPaths","j","preparedOptions","columns","prepareFields","module","ctor","getFields","d","key","load","that","values","grandTotalRowIndex","grandTotalColumnIndex","rowIndex","columnIndex","requestsData","getRequestsData","deferreds","createLoadOptions","args","parseResult","argument","supportPaging","createDrillDownDataSource","params","store","filterExp","select","customColumns"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/pivot_grid/remote_store.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar _type = require(\"../../core/utils/type\");\r\nvar _class = require(\"../../core/class\");\r\nvar _class2 = _interopRequireDefault(_class);\r\nvar _extend = require(\"../../core/utils/extend\");\r\nvar _iterator = require(\"../../core/utils/iterator\");\r\nvar _data_source = require(\"../../data/data_source/data_source\");\r\nvar _deferred = require(\"../../core/utils/deferred\");\r\nvar _uiPivot_grid = require(\"./ui.pivot_grid.utils\");\r\nvar _date_serialization = require(\"../../core/utils/date_serialization\");\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\n\r\nfunction _toConsumableArray(arr) {\r\n    return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread()\r\n}\r\n\r\nfunction _nonIterableSpread() {\r\n    throw new TypeError(\"Invalid attempt to spread non-iterable instance\")\r\n}\r\n\r\nfunction _iterableToArray(iter) {\r\n    if (Symbol.iterator in Object(iter) || \"[object Arguments]\" === Object.prototype.toString.call(iter)) {\r\n        return Array.from(iter)\r\n    }\r\n}\r\n\r\nfunction _arrayWithoutHoles(arr) {\r\n    if (Array.isArray(arr)) {\r\n        for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) {\r\n            arr2[i] = arr[i]\r\n        }\r\n        return arr2\r\n    }\r\n}\r\n\r\nfunction createGroupingOptions(dimensionOptions, useSortOrder) {\r\n    var groupingOptions = [];\r\n    (0, _iterator.each)(dimensionOptions, function(index, dimensionOption) {\r\n        groupingOptions.push({\r\n            selector: dimensionOption.dataField,\r\n            groupInterval: dimensionOption.groupInterval,\r\n            desc: useSortOrder && \"desc\" === dimensionOption.sortOrder,\r\n            isExpanded: index < dimensionOptions.length - 1\r\n        })\r\n    });\r\n    return groupingOptions\r\n}\r\n\r\nfunction getFieldFilterSelector(field) {\r\n    var selector = field.dataField;\r\n    var groupInterval = field.groupInterval;\r\n    if (\"date\" === field.dataType && \"string\" === typeof groupInterval) {\r\n        if (\"quarter\" === groupInterval.toLowerCase()) {\r\n            groupInterval = \"Month\"\r\n        }\r\n        selector = selector + \".\" + (0, _uiPivot_grid.capitalizeFirstLetter)(groupInterval)\r\n    }\r\n    return selector\r\n}\r\n\r\nfunction getIntervalFilterExpression(selector, numericInterval, numericValue, isExcludedFilterType) {\r\n    var startFilterValue = [selector, isExcludedFilterType ? \"<\" : \">=\", numericValue];\r\n    var endFilterValue = [selector, isExcludedFilterType ? \">=\" : \"<\", numericValue + numericInterval];\r\n    return [startFilterValue, isExcludedFilterType ? \"or\" : \"and\", endFilterValue]\r\n}\r\n\r\nfunction getFilterExpressionForFilterValue(field, filterValue) {\r\n    var selector = getFieldFilterSelector(field);\r\n    var isExcludedFilterType = \"exclude\" === field.filterType;\r\n    var expression = [selector, isExcludedFilterType ? \"<>\" : \"=\", filterValue];\r\n    if ((0, _type.isDefined)(field.groupInterval)) {\r\n        if (\"string\" === typeof field.groupInterval && \"quarter\" === field.groupInterval.toLowerCase()) {\r\n            expression = getIntervalFilterExpression(selector, 3, 3 * (filterValue - 1) + 1, isExcludedFilterType)\r\n        } else {\r\n            if (\"number\" === typeof field.groupInterval && \"date\" !== field.dataType) {\r\n                expression = getIntervalFilterExpression(selector, field.groupInterval, filterValue, isExcludedFilterType)\r\n            }\r\n        }\r\n    }\r\n    return expression\r\n}\r\n\r\nfunction createFieldFilterExpressions(field, operation) {\r\n    var fieldFilterExpressions = [];\r\n    if (field.searchValue) {\r\n        return [field.dataField, \"contains\", field.searchValue]\r\n    }\r\n    if (\"exclude\" === field.filterType) {\r\n        operation = operation || \"and\"\r\n    } else {\r\n        operation = operation || \"or\"\r\n    }(0, _iterator.each)(field.filterValues, function(index, filterValue) {\r\n        var currentExpression = [];\r\n        if (Array.isArray(filterValue)) {\r\n            var parseLevelsRecursive = field.levels && field.levels.length;\r\n            if (parseLevelsRecursive) {\r\n                currentExpression = createFieldFilterExpressions({\r\n                    filterValues: filterValue,\r\n                    filterType: field.filterType,\r\n                    levels: field.levels\r\n                }, \"and\")\r\n            }\r\n        } else {\r\n            var currentField = field.levels ? field.levels[index] : field;\r\n            currentExpression = getFilterExpressionForFilterValue(currentField, filterValue)\r\n        }\r\n        if (!currentExpression.length) {\r\n            return\r\n        }\r\n        if (fieldFilterExpressions.length) {\r\n            fieldFilterExpressions.push(operation)\r\n        }\r\n        fieldFilterExpressions.push(currentExpression)\r\n    });\r\n    return fieldFilterExpressions\r\n}\r\n\r\nfunction createFilterExpressions(fields) {\r\n    var filterExpressions = [];\r\n    (0, _iterator.each)(fields, function(_, field) {\r\n        var fieldExpressions = createFieldFilterExpressions(field);\r\n        if (!fieldExpressions.length) {\r\n            return []\r\n        }\r\n        if (filterExpressions.length) {\r\n            filterExpressions.push(\"and\")\r\n        }\r\n        filterExpressions.push(fieldExpressions)\r\n    });\r\n    if (1 === filterExpressions.length) {\r\n        filterExpressions = filterExpressions[0]\r\n    }\r\n    return filterExpressions\r\n}\r\n\r\nfunction mergeFilters(filter1, filter2) {\r\n    var mergedFilter;\r\n    var notEmpty = function(filter) {\r\n        return filter && filter.length\r\n    };\r\n    if (notEmpty(filter1) && notEmpty(filter2)) {\r\n        mergedFilter = [filter1, \"and\", filter2]\r\n    } else {\r\n        mergedFilter = notEmpty(filter1) ? filter1 : filter2\r\n    }\r\n    return mergedFilter\r\n}\r\n\r\nfunction createLoadOptions(options, externalFilterExpr, hasRows) {\r\n    var filterExpressions = createFilterExpressions(options.filters);\r\n    var groupingOptions = createGroupingOptions(options.rows, options.rowTake).concat(createGroupingOptions(options.columns, options.columnTake));\r\n    var loadOptions = {\r\n        groupSummary: [],\r\n        totalSummary: [],\r\n        group: groupingOptions.length ? groupingOptions : void 0,\r\n        take: groupingOptions.length ? void 0 : 1\r\n    };\r\n    if (options.rows.length && options.rowTake) {\r\n        loadOptions.skip = options.rowSkip;\r\n        loadOptions.take = options.rowTake;\r\n        loadOptions.requireGroupCount = true\r\n    } else {\r\n        if (options.columns.length && options.columnTake && !hasRows) {\r\n            loadOptions.skip = options.columnSkip;\r\n            loadOptions.take = options.columnTake;\r\n            loadOptions.requireGroupCount = true\r\n        }\r\n    }\r\n    if (externalFilterExpr) {\r\n        filterExpressions = mergeFilters(filterExpressions, externalFilterExpr)\r\n    }\r\n    if (filterExpressions.length) {\r\n        loadOptions.filter = filterExpressions\r\n    }(0, _iterator.each)(options.values, function(_, value) {\r\n        var summaryOption = {\r\n            selector: value.dataField,\r\n            summaryType: value.summaryType || \"count\"\r\n        };\r\n        loadOptions.groupSummary.push(summaryOption);\r\n        options.includeTotalSummary && loadOptions.totalSummary.push(summaryOption)\r\n    });\r\n    return loadOptions\r\n}\r\n\r\nfunction forEachGroup(data, callback, level) {\r\n    data = data || [];\r\n    level = level || 0;\r\n    for (var i = 0; i < data.length; i++) {\r\n        var group = data[i];\r\n        callback(group, level);\r\n        if (group && group.items && group.items.length) {\r\n            forEachGroup(group.items, callback, level + 1)\r\n        }\r\n    }\r\n}\r\n\r\nfunction setValue(valuesArray, value, rowIndex, columnIndex, dataIndex) {\r\n    valuesArray[rowIndex] = valuesArray[rowIndex] || [];\r\n    valuesArray[rowIndex][columnIndex] = valuesArray[rowIndex][columnIndex] || [];\r\n    if (!(0, _type.isDefined)(valuesArray[rowIndex][columnIndex][dataIndex])) {\r\n        valuesArray[rowIndex][columnIndex][dataIndex] = value\r\n    }\r\n}\r\n\r\nfunction parseValue(value, field) {\r\n    if (field && \"number\" === field.dataType && (0, _type.isString)(value)) {\r\n        return Number(value)\r\n    }\r\n    if (field && \"date\" === field.dataType && !field.groupInterval && !(value instanceof Date)) {\r\n        return (0, _date_serialization.deserializeDate)(value)\r\n    }\r\n    return value\r\n}\r\n\r\nfunction parseResult(data, total, descriptions, result) {\r\n    var rowPath = [];\r\n    var columnPath = [];\r\n    var rowHash = result.rowHash;\r\n    var columnHash = result.columnHash;\r\n    if (total && total.summary) {\r\n        (0, _iterator.each)(total.summary, function(index, summary) {\r\n            setValue(result.values, summary, result.grandTotalRowIndex, result.grandTotalColumnIndex, index)\r\n        })\r\n    }\r\n    if (total && total.groupCount >= 0) {\r\n        var skip = descriptions.rows.length ? descriptions.rowSkip : descriptions.columnSkip;\r\n        data = _toConsumableArray(Array(skip)).concat(data);\r\n        data.length = total.groupCount\r\n    }\r\n\r\n    function getItem(dataItem, dimensionName, path, level, field) {\r\n        var dimensionHash = result[dimensionName + \"Hash\"];\r\n        var parentItem;\r\n        var parentItemChildren;\r\n        var item;\r\n        var pathValue = path.slice(0, level + 1).join(\"/\");\r\n        var parentPathValue;\r\n        if (void 0 !== dimensionHash[pathValue]) {\r\n            item = dimensionHash[pathValue]\r\n        } else {\r\n            item = {\r\n                value: parseValue(dataItem.key, field),\r\n                index: result[dimensionName + \"Index\"]++\r\n            };\r\n            parentPathValue = path.slice(0, level).join(\"/\");\r\n            if (level > 0 && void 0 !== dimensionHash[parentPathValue]) {\r\n                parentItem = dimensionHash[parentPathValue];\r\n                parentItemChildren = parentItem.children = parentItem.children || []\r\n            } else {\r\n                parentItemChildren = result[dimensionName + \"s\"]\r\n            }\r\n            parentItemChildren.push(item);\r\n            dimensionHash[pathValue] = item\r\n        }\r\n        return item\r\n    }\r\n    forEachGroup(data, function(item, level) {\r\n        var rowLevel = level >= descriptions.rows.length ? descriptions.rows.length : level;\r\n        var columnLevel = level >= descriptions.rows.length ? level - descriptions.rows.length : 0;\r\n        var columnItem;\r\n        var rowItem;\r\n        if (level >= descriptions.rows.length && columnLevel >= descriptions.columns.length) {\r\n            return\r\n        }\r\n        if (level < descriptions.rows.length) {\r\n            columnPath = []\r\n        }\r\n        if (level >= descriptions.rows.length) {\r\n            if (item) {\r\n                columnPath[columnLevel] = item.key + \"\";\r\n                columnItem = getItem(item, \"column\", columnPath, columnLevel, descriptions.columns[columnPath.length - 1]);\r\n                rowItem = rowHash[rowPath.slice(0, rowLevel + 1).join(\"/\")]\r\n            } else {\r\n                result.columns.push({})\r\n            }\r\n        } else {\r\n            if (item) {\r\n                rowPath[rowLevel] = item.key + \"\";\r\n                rowItem = getItem(item, \"row\", rowPath, rowLevel);\r\n                columnItem = columnHash[columnPath.slice(0, columnLevel + 1).join(\"/\")]\r\n            } else {\r\n                result.rows.push({})\r\n            }\r\n        }\r\n        var currentRowIndex = rowItem && rowItem.index || result.grandTotalRowIndex;\r\n        var currentColumnIndex = columnItem && columnItem.index || result.grandTotalColumnIndex;\r\n        (0, _iterator.each)(item && item.summary || [], function(i, summary) {\r\n            setValue(result.values, summary, currentRowIndex, currentColumnIndex, i)\r\n        })\r\n    });\r\n    return result\r\n}\r\n\r\nfunction getFiltersForDimension(fields) {\r\n    return (fields || []).filter(function(f) {\r\n        return f.filterValues && f.filterValues.length || f.searchValue\r\n    })\r\n}\r\n\r\nfunction getExpandedIndex(options, axis) {\r\n    if (options.headerName) {\r\n        if (axis === options.headerName) {\r\n            return options.path.length\r\n        } else {\r\n            if (options.oppositePath) {\r\n                return options.oppositePath.length\r\n            }\r\n        }\r\n    }\r\n    return 0\r\n}\r\n\r\nfunction getFiltersForExpandedDimension(options) {\r\n    return (0, _uiPivot_grid.getFiltersByPath)(options[options.headerName], options.path).concat((0, _uiPivot_grid.getFiltersByPath)(options[\"rows\" === options.headerName ? \"columns\" : \"rows\"], options.oppositePath || []))\r\n}\r\n\r\nfunction getExpandedPathSliceFilter(options, dimensionName, level, firstCollapsedFieldIndex) {\r\n    var result = [];\r\n    var startSliceIndex = level > firstCollapsedFieldIndex ? 0 : firstCollapsedFieldIndex;\r\n    var fields = options.headerName !== dimensionName ? options[dimensionName].slice(startSliceIndex, level) : [];\r\n    var paths = \"rows\" === dimensionName ? options.rowExpandedPaths : options.columnExpandedPaths;\r\n    (0, _iterator.each)(fields, function(index, field) {\r\n        var filterValues = [];\r\n        (0, _iterator.each)(paths, function(_, path) {\r\n            path = path.slice(startSliceIndex, level);\r\n            if (index < path.length) {\r\n                filterValues.push(path[index])\r\n            }\r\n        });\r\n        if (filterValues.length) {\r\n            result.push((0, _extend.extend)({}, field, {\r\n                filterType: \"include\",\r\n                filterValues: filterValues\r\n            }))\r\n        }\r\n    });\r\n    return result\r\n}\r\n\r\nfunction getGrandTotalRequest(options, dimensionName, expandedIndex, expandedLevel, commonFilters, firstCollapsedFieldIndex) {\r\n    var expandedPaths = (\"columns\" === dimensionName ? options.columnExpandedPaths : options.rowExpandedPaths) || [];\r\n    var oppositeDimensionName = \"columns\" === dimensionName ? \"rows\" : \"columns\";\r\n    var fields = options[dimensionName];\r\n    var result = [];\r\n    var newOptions;\r\n    if (expandedPaths.length) {\r\n        for (var i = expandedIndex; i < expandedLevel + 1; i++) {\r\n            newOptions = {\r\n                filters: commonFilters.concat(getExpandedPathSliceFilter(options, dimensionName, i, firstCollapsedFieldIndex))\r\n            };\r\n            newOptions[dimensionName] = fields.slice(expandedIndex, i + 1);\r\n            newOptions[oppositeDimensionName] = [];\r\n            result.push((0, _extend.extend)({}, options, newOptions))\r\n        }\r\n    } else {\r\n        newOptions = {\r\n            filters: commonFilters\r\n        };\r\n        newOptions[dimensionName] = fields.slice(expandedIndex, expandedLevel + 1);\r\n        newOptions[oppositeDimensionName] = [];\r\n        result.push((0, _extend.extend)({}, options, newOptions))\r\n    }\r\n    result[0].includeTotalSummary = true;\r\n    return result\r\n}\r\n\r\nfunction getFirstCollapsedIndex(fields) {\r\n    var firstCollapsedIndex = 0;\r\n    (0, _iterator.each)(fields, function(index, field) {\r\n        if (!field.expanded) {\r\n            firstCollapsedIndex = index;\r\n            return false\r\n        }\r\n    });\r\n    return firstCollapsedIndex\r\n}\r\n\r\nfunction getRequestsData(options) {\r\n    var rowExpandedLevel = (0, _uiPivot_grid.getExpandedLevel)(options, \"rows\");\r\n    var columnExpandedLevel = (0, _uiPivot_grid.getExpandedLevel)(options, \"columns\");\r\n    var filters = options.filters || [];\r\n    var columnExpandedIndex = getExpandedIndex(options, \"columns\");\r\n    var firstCollapsedColumnIndex = getFirstCollapsedIndex(options.columns);\r\n    var firstCollapsedRowIndex = getFirstCollapsedIndex(options.rows);\r\n    var rowExpandedIndex = getExpandedIndex(options, \"rows\");\r\n    var data = [];\r\n    filters = filters.concat(getFiltersForDimension(options.rows)).concat(getFiltersForDimension(options.columns)).concat(getFiltersForExpandedDimension(options));\r\n    var columnTotalsOptions = getGrandTotalRequest(options, \"columns\", columnExpandedIndex, columnExpandedLevel, filters, firstCollapsedColumnIndex);\r\n    if (options.rows.length && options.columns.length) {\r\n        if (\"rows\" !== options.headerName) {\r\n            data = data.concat(columnTotalsOptions)\r\n        }\r\n        for (var i = rowExpandedIndex; i < rowExpandedLevel + 1; i++) {\r\n            var rows = options.rows.slice(rowExpandedIndex, i + 1);\r\n            var rowFilterByExpandedPaths = getExpandedPathSliceFilter(options, \"rows\", i, firstCollapsedRowIndex);\r\n            for (var j = columnExpandedIndex; j < columnExpandedLevel + 1; j++) {\r\n                var preparedOptions = (0, _extend.extend)({}, options, {\r\n                    columns: options.columns.slice(columnExpandedIndex, j + 1),\r\n                    rows: rows,\r\n                    filters: filters.concat(getExpandedPathSliceFilter(options, \"columns\", j, firstCollapsedColumnIndex)).concat(rowFilterByExpandedPaths)\r\n                });\r\n                data.push(preparedOptions)\r\n            }\r\n        }\r\n    } else {\r\n        data = options.columns.length ? columnTotalsOptions : getGrandTotalRequest(options, \"rows\", rowExpandedIndex, rowExpandedLevel, filters, firstCollapsedRowIndex)\r\n    }\r\n    return data\r\n}\r\n\r\nfunction prepareFields(fields) {\r\n    (0, _iterator.each)(fields || [], function(_, field) {\r\n        var levels = field.levels;\r\n        if (levels) {\r\n            prepareFields(levels)\r\n        }(0, _uiPivot_grid.setDefaultFieldValueFormatting)(field)\r\n    })\r\n}\r\nmodule.exports = _class2.default.inherit(function() {\r\n    return {\r\n        ctor: function(options) {\r\n            this._dataSource = new _data_source.DataSource(options);\r\n            this._store = this._dataSource.store()\r\n        },\r\n        getFields: function(fields) {\r\n            var d = new _deferred.Deferred;\r\n            this._store.load({\r\n                skip: 0,\r\n                take: 20\r\n            }).done(function(data) {\r\n                d.resolve((0, _uiPivot_grid.discoverObjectFields)(data, fields))\r\n            }).fail(d.reject);\r\n            return d\r\n        },\r\n        key: function() {\r\n            return this._store.key()\r\n        },\r\n        load: function(options) {\r\n            var that = this;\r\n            var d = new _deferred.Deferred;\r\n            var result = {\r\n                rows: [],\r\n                columns: [],\r\n                values: [\r\n                    [\r\n                        []\r\n                    ]\r\n                ],\r\n                grandTotalRowIndex: 0,\r\n                grandTotalColumnIndex: 0,\r\n                rowHash: {},\r\n                columnHash: {},\r\n                rowIndex: 1,\r\n                columnIndex: 1\r\n            };\r\n            var requestsData = getRequestsData(options);\r\n            var deferreds = [];\r\n            prepareFields(options.rows);\r\n            prepareFields(options.columns);\r\n            prepareFields(options.filters);\r\n            (0, _iterator.each)(requestsData, function(_, dataItem) {\r\n                deferreds.push(that._store.load(createLoadOptions(dataItem, that.filter(), options.rows.length)))\r\n            });\r\n            _deferred.when.apply(null, deferreds).done(function() {\r\n                var args = deferreds.length > 1 ? arguments : [arguments];\r\n                (0, _iterator.each)(args, function(index, argument) {\r\n                    parseResult(argument[0], argument[1], requestsData[index], result)\r\n                });\r\n                d.resolve({\r\n                    rows: result.rows,\r\n                    columns: result.columns,\r\n                    values: result.values,\r\n                    grandTotalRowIndex: result.grandTotalRowIndex,\r\n                    grandTotalColumnIndex: result.grandTotalColumnIndex\r\n                })\r\n            }).fail(d.reject);\r\n            return d\r\n        },\r\n        filter: function() {\r\n            return this._dataSource.filter.apply(this._dataSource, arguments)\r\n        },\r\n        supportPaging: function() {\r\n            return false\r\n        },\r\n        createDrillDownDataSource: function(loadOptions, params) {\r\n            loadOptions = loadOptions || {};\r\n            params = params || {};\r\n            var store = this._store;\r\n            var filters = (0, _uiPivot_grid.getFiltersByPath)(loadOptions.rows, params.rowPath).concat((0, _uiPivot_grid.getFiltersByPath)(loadOptions.columns, params.columnPath)).concat(getFiltersForDimension(loadOptions.rows)).concat(loadOptions.filters || []).concat(getFiltersForDimension(loadOptions.columns));\r\n            var filterExp = createFilterExpressions(filters);\r\n            return new _data_source.DataSource({\r\n                load: function(loadOptions) {\r\n                    return store.load((0, _extend.extend)({}, loadOptions, {\r\n                        filter: mergeFilters(filterExp, loadOptions.filter),\r\n                        select: params.customColumns\r\n                    }))\r\n                }\r\n            })\r\n        }\r\n    }\r\n}());\r\n"]},"metadata":{},"sourceType":"module"}