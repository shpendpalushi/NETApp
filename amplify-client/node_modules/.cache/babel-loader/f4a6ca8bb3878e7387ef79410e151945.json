{"ast":null,"code":"/**\r\n * DevExtreme (ui/scheduler/rendering_strategies/ui.scheduler.appointments.strategy.base.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar _uiSchedulerAppointmentsPositioningStrategy = require(\"./ui.scheduler.appointmentsPositioning.strategy.base\");\n\nvar _uiSchedulerAppointmentsPositioningStrategy2 = _interopRequireDefault(_uiSchedulerAppointmentsPositioningStrategy);\n\nvar _uiSchedulerAppointmentsPositioningStrategy3 = require(\"./ui.scheduler.appointmentsPositioning.strategy.adaptive\");\n\nvar _uiSchedulerAppointmentsPositioningStrategy4 = _interopRequireDefault(_uiSchedulerAppointmentsPositioningStrategy3);\n\nvar _extend = require(\"../../../core/utils/extend\");\n\nvar _ui = require(\"../../widget/ui.errors\");\n\nvar _ui2 = _interopRequireDefault(_ui);\n\nvar _date = require(\"../../../core/utils/date\");\n\nvar _date2 = _interopRequireDefault(_date);\n\nvar _type = require(\"../../../core/utils/type\");\n\nvar _type2 = _interopRequireDefault(_type);\n\nvar _themes = require(\"../../themes\");\n\nvar _themes2 = _interopRequireDefault(_themes);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n\n    if (\"value\" in descriptor) {\n      descriptor.writable = true;\n    }\n\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) {\n    _defineProperties(Constructor.prototype, protoProps);\n  }\n\n  if (staticProps) {\n    _defineProperties(Constructor, staticProps);\n  }\n\n  return Constructor;\n}\n\nvar toMs = _date2.default.dateToMilliseconds;\nvar APPOINTMENT_MIN_SIZE = 2;\nvar COMPACT_APPOINTMENT_DEFAULT_WIDTH = 15;\nvar APPOINTMENT_DEFAULT_HEIGHT = 20;\nvar COMPACT_THEME_APPOINTMENT_DEFAULT_HEIGHT = 18;\nvar DROP_DOWN_BUTTON_ADAPTIVE_SIZE = 28;\n\nvar BaseRenderingStrategy = function () {\n  function BaseRenderingStrategy(instance) {\n    _classCallCheck(this, BaseRenderingStrategy);\n\n    this.instance = instance;\n\n    this._initPositioningStrategy();\n  }\n\n  _createClass(BaseRenderingStrategy, [{\n    key: \"_isAdaptive\",\n    value: function value() {\n      return this.instance.fire(\"isAdaptive\");\n    }\n  }, {\n    key: \"_correctCompactAppointmentCoordinatesInAdaptive\",\n    value: function value(coordinates, isAllDay) {\n      coordinates.top = coordinates.top + this.getCompactAppointmentTopOffset(isAllDay);\n      coordinates.left = coordinates.left + this.getCompactAppointmentLeftOffset();\n    }\n  }, {\n    key: \"_initPositioningStrategy\",\n    value: function value() {\n      this._positioningStrategy = this._isAdaptive() ? new _uiSchedulerAppointmentsPositioningStrategy4.default(this) : new _uiSchedulerAppointmentsPositioningStrategy2.default(this);\n    }\n  }, {\n    key: \"getPositioningStrategy\",\n    value: function value() {\n      return this._positioningStrategy;\n    }\n  }, {\n    key: \"getAppointmentMinSize\",\n    value: function value() {\n      return APPOINTMENT_MIN_SIZE;\n    }\n  }, {\n    key: \"keepAppointmentSettings\",\n    value: function value() {\n      return false;\n    }\n  }, {\n    key: \"getDeltaTime\",\n    value: function value() {}\n  }, {\n    key: \"getAppointmentGeometry\",\n    value: function value(coordinates) {\n      return coordinates;\n    }\n  }, {\n    key: \"needCorrectAppointmentDates\",\n    value: function value() {\n      return true;\n    }\n  }, {\n    key: \"getDirection\",\n    value: function value() {\n      return \"horizontal\";\n    }\n  }, {\n    key: \"createTaskPositionMap\",\n    value: function value(items) {\n      delete this._maxAppointmentCountPerCell;\n      var length = items && items.length;\n\n      if (!length) {\n        return;\n      }\n\n      this._defaultWidth = this.instance._cellWidth;\n      this._defaultHeight = this.instance._cellHeight;\n      this._allDayHeight = this.instance._allDayCellHeight;\n      var map = [];\n\n      for (var i = 0; i < length; i++) {\n        var coordinates = this._getItemPosition(items[i]);\n\n        if (this._isRtl()) {\n          coordinates = this._correctRtlCoordinates(coordinates);\n        }\n\n        map.push(coordinates);\n      }\n\n      var positionArray = this._getSortedPositions(map);\n\n      var resultPositions = this._getResultPositions(positionArray);\n\n      return this._getExtendedPositionMap(map, resultPositions);\n    }\n  }, {\n    key: \"_getDeltaWidth\",\n    value: function value(args, initialSize) {\n      var intervalWidth = this.instance.fire(\"getResizableStep\") || this.getAppointmentMinSize();\n      var initialWidth = initialSize.width;\n      return Math.round((args.width - initialWidth) / intervalWidth);\n    }\n  }, {\n    key: \"_correctRtlCoordinates\",\n    value: function value(coordinates) {\n      var width = coordinates[0].width || this._getAppointmentMaxWidth();\n\n      coordinates.forEach(function (coordinate) {\n        if (!coordinate.appointmentReduced) {\n          coordinate.left -= width;\n        }\n      });\n      return coordinates;\n    }\n  }, {\n    key: \"_getAppointmentMaxWidth\",\n    value: function value() {\n      return this.getDefaultCellWidth();\n    }\n  }, {\n    key: \"_getItemPosition\",\n    value: function value(item) {\n      var position = this._getAppointmentCoordinates(item);\n\n      var allDay = this.isAllDay(item);\n      var result = [];\n      var startDate = new Date(this.instance.fire(\"getField\", \"startDate\", item));\n      var isRecurring = !!this.instance.fire(\"getField\", \"recurrenceRule\", item);\n\n      for (var j = 0; j < position.length; j++) {\n        var height = this.calculateAppointmentHeight(item, position[j], isRecurring);\n        var width = this.calculateAppointmentWidth(item, position[j], isRecurring);\n        var resultWidth = width;\n        var appointmentReduced = null;\n        var multiWeekAppointmentParts = [];\n        var initialRowIndex = position[j].rowIndex;\n        var initialCellIndex = position[j].cellIndex;\n\n        if (this._needVerifyItemSize() || allDay) {\n          var currentMaxAllowedPosition = position[j].hMax;\n\n          if (this.isAppointmentGreaterThan(currentMaxAllowedPosition, {\n            left: position[j].left,\n            width: width\n          })) {\n            appointmentReduced = \"head\";\n            initialRowIndex = position[j].rowIndex;\n            initialCellIndex = position[j].cellIndex;\n            resultWidth = this._reduceMultiWeekAppointment(width, {\n              left: position[j].left,\n              right: currentMaxAllowedPosition\n            });\n            multiWeekAppointmentParts = this._getAppointmentParts({\n              sourceAppointmentWidth: width,\n              reducedWidth: resultWidth,\n              height: height\n            }, position[j], startDate);\n\n            if (this._isRtl()) {\n              position[j].left = currentMaxAllowedPosition;\n            }\n          }\n        }\n\n        (0, _extend.extend)(position[j], {\n          height: height,\n          width: resultWidth,\n          allDay: allDay,\n          rowIndex: initialRowIndex,\n          cellIndex: initialCellIndex,\n          appointmentReduced: appointmentReduced\n        });\n        result = this._getAppointmentPartsPosition(multiWeekAppointmentParts, position[j], result);\n      }\n\n      return result;\n    }\n  }, {\n    key: \"_getAppointmentPartsPosition\",\n    value: function value(appointmentParts, position, result) {\n      if (appointmentParts.length) {\n        appointmentParts.unshift(position);\n        result = result.concat(appointmentParts);\n      } else {\n        result.push(position);\n      }\n\n      return result;\n    }\n  }, {\n    key: \"_getAppointmentCoordinates\",\n    value: function value(itemData) {\n      return this.instance.fire(\"needCoordinates\", {\n        startDate: this.startDate(itemData),\n        originalStartDate: this.startDate(itemData, true),\n        appointmentData: itemData\n      });\n    }\n  }, {\n    key: \"_isRtl\",\n    value: function value() {\n      return this.instance.option(\"rtlEnabled\");\n    }\n  }, {\n    key: \"_getAppointmentParts\",\n    value: function value() {\n      return [];\n    }\n  }, {\n    key: \"_getCompactAppointmentParts\",\n    value: function value(appointmentWidth) {\n      var cellWidth = this.getDefaultCellWidth() || this.getAppointmentMinSize();\n      return Math.round(appointmentWidth / cellWidth);\n    }\n  }, {\n    key: \"_reduceMultiWeekAppointment\",\n    value: function value(sourceAppointmentWidth, bound) {\n      if (this._isRtl()) {\n        sourceAppointmentWidth = Math.floor(bound.left - bound.right);\n      } else {\n        sourceAppointmentWidth = bound.right - Math.floor(bound.left);\n      }\n\n      return sourceAppointmentWidth;\n    }\n  }, {\n    key: \"calculateAppointmentHeight\",\n    value: function value() {\n      return 0;\n    }\n  }, {\n    key: \"calculateAppointmentWidth\",\n    value: function value() {\n      return 0;\n    }\n  }, {\n    key: \"isAppointmentGreaterThan\",\n    value: function value(etalon, comparisonParameters) {\n      var result = comparisonParameters.left + comparisonParameters.width - etalon;\n\n      if (this._isRtl()) {\n        result = etalon + comparisonParameters.width - comparisonParameters.left;\n      }\n\n      return result > this.getDefaultCellWidth() / 2;\n    }\n  }, {\n    key: \"isAllDay\",\n    value: function value() {\n      return false;\n    }\n  }, {\n    key: \"cropAppointmentWidth\",\n    value: function value(width, cellWidth) {\n      if (this.instance.fire(\"isGroupedByDate\")) {\n        width = cellWidth;\n      }\n\n      return width;\n    }\n  }, {\n    key: \"_getSortedPositions\",\n    value: function value(positionList) {\n      var _this = this;\n\n      var result = [];\n\n      var round = function round(value) {\n        return Math.round(100 * value) / 100;\n      };\n\n      var createItem = function createItem(rowIndex, cellIndex, top, left, bottom, right, position, allDay) {\n        return {\n          i: rowIndex,\n          j: cellIndex,\n          top: round(top),\n          left: round(left),\n          bottom: round(bottom),\n          right: round(right),\n          cellPosition: position,\n          allDay: allDay\n        };\n      };\n\n      for (var rowIndex = 0, rowCount = positionList.length; rowIndex < rowCount; rowIndex++) {\n        for (var cellIndex = 0, cellCount = positionList[rowIndex].length; cellIndex < cellCount; cellIndex++) {\n          var _positionList$rowInde = positionList[rowIndex][cellIndex],\n              top = _positionList$rowInde.top,\n              left = _positionList$rowInde.left,\n              height = _positionList$rowInde.height,\n              width = _positionList$rowInde.width,\n              cellPosition = _positionList$rowInde.cellPosition,\n              allDay = _positionList$rowInde.allDay;\n          result.push(createItem(rowIndex, cellIndex, top, left, top + height, left + width, cellPosition, allDay));\n        }\n      }\n\n      return result.sort(function (a, b) {\n        return _this._sortCondition(a, b);\n      });\n    }\n  }, {\n    key: \"_sortCondition\",\n    value: function value() {}\n  }, {\n    key: \"_getConditions\",\n    value: function value(a, b) {\n      var isSomeEdge = this._isSomeEdge(a, b);\n\n      return {\n        columnCondition: isSomeEdge || this._normalizeCondition(a.left, b.left),\n        rowCondition: isSomeEdge || this._normalizeCondition(a.top, b.top),\n        cellPositionCondition: isSomeEdge || this._normalizeCondition(a.cellPosition, b.cellPosition)\n      };\n    }\n  }, {\n    key: \"_rowCondition\",\n    value: function value(a, b) {\n      var conditions = this._getConditions(a, b);\n\n      return conditions.columnCondition || conditions.rowCondition;\n    }\n  }, {\n    key: \"_columnCondition\",\n    value: function value(a, b) {\n      var conditions = this._getConditions(a, b);\n\n      return conditions.rowCondition || conditions.columnCondition;\n    }\n  }, {\n    key: \"_isSomeEdge\",\n    value: function value(a, b) {\n      return a.i === b.i && a.j === b.j;\n    }\n  }, {\n    key: \"_normalizeCondition\",\n    value: function value(first, second) {\n      var result = first - second;\n      return Math.abs(result) > 1 ? result : 0;\n    }\n  }, {\n    key: \"_isItemsCross\",\n    value: function value(item, currentItem, orientation) {\n      var side_1 = Math.floor(item[orientation[0]]);\n      var side_2 = Math.floor(item[orientation[1]]);\n      return item[orientation[2]] === currentItem[orientation[2]] && (side_1 <= currentItem[orientation[0]] && side_2 > currentItem[orientation[0]] || side_1 < currentItem[orientation[1]] && side_2 >= currentItem[orientation[1]] || side_1 === currentItem[orientation[0]] && side_2 === currentItem[orientation[1]]);\n    }\n  }, {\n    key: \"_getOrientation\",\n    value: function value() {\n      return [\"top\", \"bottom\", \"left\"];\n    }\n  }, {\n    key: \"_getResultPositions\",\n    value: function value(sortedArray) {\n      var _this2 = this;\n\n      var result = [];\n      var i;\n      var sortedIndex = 0;\n      var currentItem;\n      var indexes;\n      var itemIndex;\n      var maxIndexInStack = 0;\n      var stack = {};\n\n      var orientation = this._getOrientation();\n\n      var findFreeIndex = function findFreeIndex(indexes, index) {\n        var isFind = indexes.some(function (item) {\n          return item === index;\n        });\n\n        if (isFind) {\n          return findFreeIndex(indexes, ++index);\n        } else {\n          return index;\n        }\n      };\n\n      var startNewStack = function startNewStack(currentItem) {\n        stack.items = [createItem(currentItem)];\n        stack.left = currentItem.left;\n        stack.right = currentItem.right;\n        stack.top = currentItem.top;\n        stack.bottom = currentItem.bottom;\n      };\n\n      var createItem = function createItem(currentItem, index) {\n        var currentIndex = index || 0;\n        return {\n          index: currentIndex,\n          i: currentItem.i,\n          j: currentItem.j,\n          left: currentItem.left,\n          right: currentItem.right,\n          top: currentItem.top,\n          bottom: currentItem.bottom,\n          sortedIndex: _this2._skipSortedIndex(currentIndex) ? null : sortedIndex++\n        };\n      };\n\n      var pushItemsInResult = function pushItemsInResult(items) {\n        items.forEach(function (item) {\n          result.push({\n            index: item.index,\n            count: maxIndexInStack + 1,\n            i: item.i,\n            j: item.j,\n            sortedIndex: item.sortedIndex\n          });\n        });\n      };\n\n      for (i = 0; i < sortedArray.length; i++) {\n        currentItem = sortedArray[i];\n        indexes = [];\n\n        if (!stack.items) {\n          startNewStack(currentItem);\n        } else {\n          if (this._isItemsCross(stack, currentItem, orientation)) {\n            stack.items.forEach(function (item, index) {\n              if (_this2._isItemsCross(item, currentItem, orientation)) {\n                indexes.push(item.index);\n              }\n            });\n            itemIndex = indexes.length ? findFreeIndex(indexes, 0) : 0;\n            stack.items.push(createItem(currentItem, itemIndex));\n            maxIndexInStack = Math.max(itemIndex, maxIndexInStack);\n            stack.left = Math.min(stack.left, currentItem.left);\n            stack.right = Math.max(stack.right, currentItem.right);\n            stack.top = Math.min(stack.top, currentItem.top);\n            stack.bottom = Math.max(stack.bottom, currentItem.bottom);\n          } else {\n            pushItemsInResult(stack.items);\n            stack = {};\n            startNewStack(currentItem);\n            maxIndexInStack = 0;\n          }\n        }\n      }\n\n      if (stack.items) {\n        pushItemsInResult(stack.items);\n      }\n\n      return result.sort(function (a, b) {\n        var columnCondition = a.j - b.j;\n        var rowCondition = a.i - b.i;\n        return rowCondition ? rowCondition : columnCondition;\n      });\n    }\n  }, {\n    key: \"_skipSortedIndex\",\n    value: function value(index) {\n      return this.instance.fire(\"getMaxAppointmentsPerCell\") && index > this._getMaxAppointmentCountPerCell() - 1;\n    }\n  }, {\n    key: \"_findIndexByKey\",\n    value: function value(arr, iKey, jKey, iValue, jValue) {\n      var result = 0;\n\n      for (var i = 0, len = arr.length; i < len; i++) {\n        if (arr[i][iKey] === iValue && arr[i][jKey] === jValue) {\n          result = i;\n          break;\n        }\n      }\n\n      return result;\n    }\n  }, {\n    key: \"_getExtendedPositionMap\",\n    value: function value(map, positions) {\n      var positionCounter = 0;\n      var result = [];\n\n      for (var i = 0, mapLength = map.length; i < mapLength; i++) {\n        var resultString = [];\n\n        for (var j = 0, itemLength = map[i].length; j < itemLength; j++) {\n          map[i][j].index = positions[positionCounter].index;\n          map[i][j].sortedIndex = positions[positionCounter].sortedIndex;\n          map[i][j].count = positions[positionCounter++].count;\n          resultString.push(map[i][j]);\n\n          this._checkLongCompactAppointment(map[i][j], resultString);\n        }\n\n        result.push(resultString);\n      }\n\n      return result;\n    }\n  }, {\n    key: \"_checkLongCompactAppointment\",\n    value: function value() {}\n  }, {\n    key: \"_splitLongCompactAppointment\",\n    value: function value(item, result) {\n      var appointmentCountPerCell = this._getMaxAppointmentCountPerCellByType(item.allDay);\n\n      var compactCount = 0;\n\n      if (void 0 !== appointmentCountPerCell && item.index > appointmentCountPerCell - 1) {\n        item.isCompact = true;\n        compactCount = this._getCompactAppointmentParts(item.width);\n\n        for (var k = 1; k < compactCount; k++) {\n          var compactPart = (0, _extend.extend)(true, {}, item);\n          compactPart.left = this._getCompactLeftCoordinate(item.left, k);\n          compactPart.cellIndex = compactPart.cellIndex + k;\n          compactPart.sortedIndex = null;\n          result.push(compactPart);\n        }\n      }\n\n      return result;\n    }\n  }, {\n    key: \"startDate\",\n    value: function startDate(appointment, skipNormalize, position) {\n      var startDate = position && position.startDate;\n\n      var rangeStartDate = this.instance._getStartDate(appointment, skipNormalize);\n\n      var text = this.instance.fire(\"getField\", \"text\", appointment);\n\n      if (startDate && rangeStartDate > startDate || !startDate) {\n        startDate = rangeStartDate;\n      }\n\n      if (isNaN(startDate.getTime())) {\n        throw _ui2.default.Error(\"E1032\", text);\n      }\n\n      return startDate;\n    }\n  }, {\n    key: \"endDate\",\n    value: function endDate(appointment, position, isRecurring) {\n      var ignoreViewDates = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : false;\n\n      var endDate = this.instance._getEndDate(appointment, ignoreViewDates);\n\n      var realStartDate = this.startDate(appointment, true);\n      var viewStartDate = this.startDate(appointment, false, position);\n\n      if (viewStartDate.getTime() > endDate.getTime() || isRecurring) {\n        var recurrencePartStartDate = position ? position.initialStartDate || position.startDate : realStartDate;\n        var recurrencePartCroppedByViewStartDate = position ? position.startDate : realStartDate;\n        var fullDuration = viewStartDate.getTime() > endDate.getTime() ? this.instance.fire(\"getField\", \"endDate\", appointment).getTime() - this.instance.fire(\"getField\", \"startDate\", appointment).getTime() : endDate.getTime() - realStartDate.getTime();\n        fullDuration = this._adjustDurationByDaylightDiff(fullDuration, realStartDate, endDate);\n        endDate = new Date(viewStartDate.getTime() >= recurrencePartStartDate.getTime() ? recurrencePartStartDate.getTime() : viewStartDate.getTime());\n\n        if (isRecurring) {\n          endDate = new Date(endDate.getTime() + fullDuration);\n        }\n\n        if (!_date2.default.sameDate(realStartDate, endDate) && recurrencePartCroppedByViewStartDate.getTime() < viewStartDate.getTime()) {\n          var headDuration = _date2.default.trimTime(endDate).getTime() - recurrencePartCroppedByViewStartDate.getTime();\n          var tailDuration = fullDuration - headDuration || fullDuration;\n          endDate = new Date(_date2.default.trimTime(viewStartDate).getTime() + tailDuration);\n        }\n      }\n\n      if (!this.isAllDay(appointment)) {\n        var viewEndDate = _date2.default.roundToHour(this.instance.fire(\"getEndViewDate\"));\n\n        if (endDate > viewEndDate) {\n          endDate = viewEndDate;\n        }\n\n        var currentViewEndTime = new Date(new Date(endDate).setHours(this.instance.option(\"endDayHour\"), 0, 0));\n\n        if (endDate.getTime() > currentViewEndTime.getTime()) {\n          endDate = currentViewEndTime;\n        }\n      }\n\n      return endDate;\n    }\n  }, {\n    key: \"_adjustDurationByDaylightDiff\",\n    value: function value(duration, startDate, endDate) {\n      var daylightDiff = this.instance.fire(\"getDaylightOffset\", startDate, endDate);\n      return this._needAdjustDuration(daylightDiff) ? this._calculateDurationByDaylightDiff(duration, daylightDiff) : duration;\n    }\n  }, {\n    key: \"_needAdjustDuration\",\n    value: function value(diff) {\n      return 0 !== diff;\n    }\n  }, {\n    key: \"_calculateDurationByDaylightDiff\",\n    value: function value(duration, diff) {\n      return duration + diff * toMs(\"minute\");\n    }\n  }, {\n    key: \"_getAppointmentDurationInMs\",\n    value: function value(startDate, endDate, allDay) {\n      return this.instance.fire(\"getAppointmentDurationInMs\", {\n        startDate: startDate,\n        endDate: endDate,\n        allDay: allDay\n      });\n    }\n  }, {\n    key: \"_getMaxNeighborAppointmentCount\",\n    value: function value() {\n      var overlappingMode = this.instance.fire(\"getMaxAppointmentsPerCell\");\n\n      if (!overlappingMode) {\n        var outerAppointmentWidth = this.getCompactAppointmentDefaultWidth() + this.getCompactAppointmentLeftOffset();\n        return Math.floor(this.getDropDownAppointmentWidth() / outerAppointmentWidth);\n      } else {\n        return 0;\n      }\n    }\n  }, {\n    key: \"_markAppointmentAsVirtual\",\n    value: function value(coordinates, isAllDay) {\n      var countFullWidthAppointmentInCell = this._getMaxAppointmentCountPerCellByType(isAllDay);\n\n      if (coordinates.count - countFullWidthAppointmentInCell > this._getMaxNeighborAppointmentCount()) {\n        coordinates.virtual = {\n          top: coordinates.top,\n          left: coordinates.left,\n          index: \"tail\" === coordinates.appointmentReduced ? coordinates.groupIndex + \"-\" + coordinates.rowIndex + \"-\" + coordinates.cellIndex : coordinates.groupIndex + \"-\" + coordinates.rowIndex + \"-\" + coordinates.cellIndex + \"-tail\",\n          isAllDay: isAllDay\n        };\n      }\n    }\n  }, {\n    key: \"_getMaxAppointmentCountPerCellByType\",\n    value: function value(isAllDay) {\n      var appointmentCountPerCell = this._getMaxAppointmentCountPerCell();\n\n      if (_type2.default.isObject(appointmentCountPerCell)) {\n        return isAllDay ? this._getMaxAppointmentCountPerCell().allDay : this._getMaxAppointmentCountPerCell().simple;\n      } else {\n        return appointmentCountPerCell;\n      }\n    }\n  }, {\n    key: \"getDropDownAppointmentWidth\",\n    value: function value(intervalCount, isAllDay) {\n      return this.getPositioningStrategy().getDropDownAppointmentWidth(intervalCount, isAllDay);\n    }\n  }, {\n    key: \"getDropDownAppointmentHeight\",\n    value: function value() {\n      return this.getPositioningStrategy().getDropDownAppointmentHeight();\n    }\n  }, {\n    key: \"getDropDownButtonAdaptiveSize\",\n    value: function value() {\n      return DROP_DOWN_BUTTON_ADAPTIVE_SIZE;\n    }\n  }, {\n    key: \"getDefaultCellWidth\",\n    value: function value() {\n      return this._defaultWidth;\n    }\n  }, {\n    key: \"getDefaultCellHeight\",\n    value: function value() {\n      return this._defaultHeight;\n    }\n  }, {\n    key: \"getDefaultAllDayCellHeight\",\n    value: function value() {\n      return this._allDayHeight;\n    }\n  }, {\n    key: \"getCompactAppointmentDefaultWidth\",\n    value: function value() {\n      return COMPACT_APPOINTMENT_DEFAULT_WIDTH;\n    }\n  }, {\n    key: \"getCompactAppointmentTopOffset\",\n    value: function value(allDay) {\n      return this.getPositioningStrategy().getCompactAppointmentTopOffset(allDay);\n    }\n  }, {\n    key: \"getCompactAppointmentLeftOffset\",\n    value: function value() {\n      return this.getPositioningStrategy().getCompactAppointmentLeftOffset();\n    }\n  }, {\n    key: \"getAppointmentDataCalculator\",\n    value: function value() {}\n  }, {\n    key: \"_customizeCoordinates\",\n    value: function value(coordinates, height, appointmentCountPerCell, topOffset, isAllDay) {\n      var index = coordinates.index;\n      var appointmentHeight = height / appointmentCountPerCell;\n      var appointmentTop = coordinates.top + index * appointmentHeight;\n      var top = appointmentTop + topOffset;\n      var width = coordinates.width;\n      var left = coordinates.left;\n      var compactAppointmentDefaultSize;\n      var compactAppointmentLeftOffset;\n      var compactAppointmentTopOffset = this.getCompactAppointmentTopOffset(isAllDay);\n\n      if (coordinates.isCompact) {\n        compactAppointmentDefaultSize = this.getCompactAppointmentDefaultWidth();\n        compactAppointmentLeftOffset = this.getCompactAppointmentLeftOffset();\n        top = coordinates.top + compactAppointmentTopOffset;\n        left = coordinates.left + (index - appointmentCountPerCell) * (compactAppointmentDefaultSize + compactAppointmentLeftOffset) + compactAppointmentLeftOffset;\n        this._isAdaptive() && this._correctCompactAppointmentCoordinatesInAdaptive(coordinates, isAllDay);\n        appointmentHeight = compactAppointmentDefaultSize;\n        width = compactAppointmentDefaultSize;\n\n        this._markAppointmentAsVirtual(coordinates, isAllDay);\n      }\n\n      return {\n        height: appointmentHeight,\n        width: width,\n        top: top,\n        left: left,\n        empty: this._isAppointmentEmpty(height, width)\n      };\n    }\n  }, {\n    key: \"_isAppointmentEmpty\",\n    value: function value(height, width) {\n      return height < this._getAppointmentMinHeight() || width < this._getAppointmentMinWidth();\n    }\n  }, {\n    key: \"_calculateGeometryConfig\",\n    value: function value(coordinates) {\n      var overlappingMode = this.instance.fire(\"getMaxAppointmentsPerCell\");\n\n      var offsets = this._getOffsets();\n\n      var appointmentDefaultOffset = this._getAppointmentDefaultOffset();\n\n      var appointmentCountPerCell = this._getAppointmentCount(overlappingMode, coordinates);\n\n      var ratio = this._getDefaultRatio(coordinates, appointmentCountPerCell);\n\n      var maxHeight = this._getMaxHeight();\n\n      if (!(0, _type.isNumeric)(appointmentCountPerCell)) {\n        appointmentCountPerCell = coordinates.count;\n        ratio = (maxHeight - offsets.unlimited) / maxHeight;\n      }\n\n      var topOffset = (1 - ratio) * maxHeight;\n\n      if (\"auto\" === overlappingMode || (0, _type.isNumeric)(overlappingMode)) {\n        ratio = 1;\n        maxHeight -= appointmentDefaultOffset;\n        topOffset = appointmentDefaultOffset;\n      }\n\n      return {\n        height: ratio * maxHeight,\n        appointmentCountPerCell: appointmentCountPerCell,\n        offset: topOffset\n      };\n    }\n  }, {\n    key: \"_getAppointmentCount\",\n    value: function value() {}\n  }, {\n    key: \"_getDefaultRatio\",\n    value: function value() {}\n  }, {\n    key: \"_getOffsets\",\n    value: function value() {}\n  }, {\n    key: \"_getMaxHeight\",\n    value: function value() {}\n  }, {\n    key: \"_needVerifyItemSize\",\n    value: function value() {\n      return false;\n    }\n  }, {\n    key: \"needSeparateAppointment\",\n    value: function value(allDay) {\n      return this.instance.fire(\"isGroupedByDate\") && allDay;\n    }\n  }, {\n    key: \"_getMaxAppointmentCountPerCell\",\n    value: function value() {\n      if (!this._maxAppointmentCountPerCell) {\n        var overlappingMode = this.instance.fire(\"getMaxAppointmentsPerCell\");\n        var appointmentCountPerCell;\n\n        if (!overlappingMode) {\n          appointmentCountPerCell = 2;\n        }\n\n        if ((0, _type.isNumeric)(overlappingMode)) {\n          appointmentCountPerCell = overlappingMode;\n        }\n\n        if (\"auto\" === overlappingMode) {\n          appointmentCountPerCell = this._getDynamicAppointmentCountPerCell();\n        }\n\n        if (\"unlimited\" === overlappingMode) {\n          appointmentCountPerCell = void 0;\n        }\n\n        this._maxAppointmentCountPerCell = appointmentCountPerCell;\n      }\n\n      return this._maxAppointmentCountPerCell;\n    }\n  }, {\n    key: \"_getDynamicAppointmentCountPerCell\",\n    value: function value() {\n      return this.getPositioningStrategy().getDynamicAppointmentCountPerCell();\n    }\n  }, {\n    key: \"hasAllDayAppointments\",\n    value: function value() {\n      return false;\n    }\n  }, {\n    key: \"_isCompactTheme\",\n    value: function value() {\n      return \"compact\" === (_themes2.default.current() || \"\").split(\".\").pop();\n    }\n  }, {\n    key: \"_getAppointmentDefaultOffset\",\n    value: function value() {\n      return this.getPositioningStrategy().getAppointmentDefaultOffset();\n    }\n  }, {\n    key: \"_getAppointmentDefaultHeight\",\n    value: function value() {\n      return this._getAppointmentHeightByTheme();\n    }\n  }, {\n    key: \"_getAppointmentMinHeight\",\n    value: function value() {\n      return this._getAppointmentDefaultHeight();\n    }\n  }, {\n    key: \"_getAppointmentHeightByTheme\",\n    value: function value() {\n      return this._isCompactTheme() ? COMPACT_THEME_APPOINTMENT_DEFAULT_HEIGHT : APPOINTMENT_DEFAULT_HEIGHT;\n    }\n  }, {\n    key: \"_getAppointmentDefaultWidth\",\n    value: function value() {\n      return this.getPositioningStrategy()._getAppointmentDefaultWidth();\n    }\n  }, {\n    key: \"_getAppointmentMinWidth\",\n    value: function value() {\n      return this._getAppointmentDefaultWidth();\n    }\n  }, {\n    key: \"_needVerticalGroupBounds\",\n    value: function value() {\n      return false;\n    }\n  }, {\n    key: \"_needHorizontalGroupBounds\",\n    value: function value() {\n      return false;\n    }\n  }]);\n\n  return BaseRenderingStrategy;\n}();\n\nmodule.exports = BaseRenderingStrategy;","map":{"version":3,"sources":["C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/devextreme/ui/scheduler/rendering_strategies/ui.scheduler.appointments.strategy.base.js"],"names":["_uiSchedulerAppointmentsPositioningStrategy","require","_uiSchedulerAppointmentsPositioningStrategy2","_interopRequireDefault","_uiSchedulerAppointmentsPositioningStrategy3","_uiSchedulerAppointmentsPositioningStrategy4","_extend","_ui","_ui2","_date","_date2","_type","_type2","_themes","_themes2","obj","instance","i","props","descriptor","Object","_defineProperties","Constructor","toMs","APPOINTMENT_MIN_SIZE","COMPACT_APPOINTMENT_DEFAULT_WIDTH","APPOINTMENT_DEFAULT_HEIGHT","COMPACT_THEME_APPOINTMENT_DEFAULT_HEIGHT","DROP_DOWN_BUTTON_ADAPTIVE_SIZE","BaseRenderingStrategy","_classCallCheck","_createClass","key","value","coordinates","length","items","map","positionArray","resultPositions","intervalWidth","initialWidth","initialSize","Math","args","width","coordinate","position","allDay","result","startDate","isRecurring","j","height","resultWidth","appointmentReduced","multiWeekAppointmentParts","initialRowIndex","initialCellIndex","currentMaxAllowedPosition","left","right","sourceAppointmentWidth","reducedWidth","rowIndex","cellIndex","appointmentParts","originalStartDate","appointmentData","itemData","cellWidth","appointmentWidth","bound","comparisonParameters","etalon","_this","round","createItem","top","bottom","cellPosition","rowCount","positionList","cellCount","_positionList$rowInde","isSomeEdge","columnCondition","a","b","rowCondition","cellPositionCondition","conditions","first","side_1","item","orientation","side_2","currentItem","_this2","sortedIndex","maxIndexInStack","stack","findFreeIndex","isFind","startNewStack","currentIndex","index","pushItemsInResult","count","sortedArray","indexes","itemIndex","len","arr","positionCounter","mapLength","resultString","itemLength","positions","appointmentCountPerCell","compactCount","k","compactPart","rangeStartDate","text","isNaN","ignoreViewDates","arguments","endDate","realStartDate","viewStartDate","recurrencePartStartDate","recurrencePartCroppedByViewStartDate","fullDuration","headDuration","tailDuration","viewEndDate","currentViewEndTime","daylightDiff","duration","diff","overlappingMode","outerAppointmentWidth","countFullWidthAppointmentInCell","isAllDay","appointmentHeight","appointmentTop","compactAppointmentTopOffset","compactAppointmentDefaultSize","compactAppointmentLeftOffset","empty","offsets","appointmentDefaultOffset","ratio","maxHeight","topOffset","offset","module"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/scheduler/rendering_strategies/ui.scheduler.appointments.strategy.base.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar _uiSchedulerAppointmentsPositioningStrategy = require(\"./ui.scheduler.appointmentsPositioning.strategy.base\");\r\nvar _uiSchedulerAppointmentsPositioningStrategy2 = _interopRequireDefault(_uiSchedulerAppointmentsPositioningStrategy);\r\nvar _uiSchedulerAppointmentsPositioningStrategy3 = require(\"./ui.scheduler.appointmentsPositioning.strategy.adaptive\");\r\nvar _uiSchedulerAppointmentsPositioningStrategy4 = _interopRequireDefault(_uiSchedulerAppointmentsPositioningStrategy3);\r\nvar _extend = require(\"../../../core/utils/extend\");\r\nvar _ui = require(\"../../widget/ui.errors\");\r\nvar _ui2 = _interopRequireDefault(_ui);\r\nvar _date = require(\"../../../core/utils/date\");\r\nvar _date2 = _interopRequireDefault(_date);\r\nvar _type = require(\"../../../core/utils/type\");\r\nvar _type2 = _interopRequireDefault(_type);\r\nvar _themes = require(\"../../themes\");\r\nvar _themes2 = _interopRequireDefault(_themes);\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\n\r\nfunction _classCallCheck(instance, Constructor) {\r\n    if (!(instance instanceof Constructor)) {\r\n        throw new TypeError(\"Cannot call a class as a function\")\r\n    }\r\n}\r\n\r\nfunction _defineProperties(target, props) {\r\n    for (var i = 0; i < props.length; i++) {\r\n        var descriptor = props[i];\r\n        descriptor.enumerable = descriptor.enumerable || false;\r\n        descriptor.configurable = true;\r\n        if (\"value\" in descriptor) {\r\n            descriptor.writable = true\r\n        }\r\n        Object.defineProperty(target, descriptor.key, descriptor)\r\n    }\r\n}\r\n\r\nfunction _createClass(Constructor, protoProps, staticProps) {\r\n    if (protoProps) {\r\n        _defineProperties(Constructor.prototype, protoProps)\r\n    }\r\n    if (staticProps) {\r\n        _defineProperties(Constructor, staticProps)\r\n    }\r\n    return Constructor\r\n}\r\nvar toMs = _date2.default.dateToMilliseconds;\r\nvar APPOINTMENT_MIN_SIZE = 2;\r\nvar COMPACT_APPOINTMENT_DEFAULT_WIDTH = 15;\r\nvar APPOINTMENT_DEFAULT_HEIGHT = 20;\r\nvar COMPACT_THEME_APPOINTMENT_DEFAULT_HEIGHT = 18;\r\nvar DROP_DOWN_BUTTON_ADAPTIVE_SIZE = 28;\r\nvar BaseRenderingStrategy = function() {\r\n    function BaseRenderingStrategy(instance) {\r\n        _classCallCheck(this, BaseRenderingStrategy);\r\n        this.instance = instance;\r\n        this._initPositioningStrategy()\r\n    }\r\n    _createClass(BaseRenderingStrategy, [{\r\n        key: \"_isAdaptive\",\r\n        value: function() {\r\n            return this.instance.fire(\"isAdaptive\")\r\n        }\r\n    }, {\r\n        key: \"_correctCompactAppointmentCoordinatesInAdaptive\",\r\n        value: function(coordinates, isAllDay) {\r\n            coordinates.top = coordinates.top + this.getCompactAppointmentTopOffset(isAllDay);\r\n            coordinates.left = coordinates.left + this.getCompactAppointmentLeftOffset()\r\n        }\r\n    }, {\r\n        key: \"_initPositioningStrategy\",\r\n        value: function() {\r\n            this._positioningStrategy = this._isAdaptive() ? new _uiSchedulerAppointmentsPositioningStrategy4.default(this) : new _uiSchedulerAppointmentsPositioningStrategy2.default(this)\r\n        }\r\n    }, {\r\n        key: \"getPositioningStrategy\",\r\n        value: function() {\r\n            return this._positioningStrategy\r\n        }\r\n    }, {\r\n        key: \"getAppointmentMinSize\",\r\n        value: function() {\r\n            return APPOINTMENT_MIN_SIZE\r\n        }\r\n    }, {\r\n        key: \"keepAppointmentSettings\",\r\n        value: function() {\r\n            return false\r\n        }\r\n    }, {\r\n        key: \"getDeltaTime\",\r\n        value: function() {}\r\n    }, {\r\n        key: \"getAppointmentGeometry\",\r\n        value: function(coordinates) {\r\n            return coordinates\r\n        }\r\n    }, {\r\n        key: \"needCorrectAppointmentDates\",\r\n        value: function() {\r\n            return true\r\n        }\r\n    }, {\r\n        key: \"getDirection\",\r\n        value: function() {\r\n            return \"horizontal\"\r\n        }\r\n    }, {\r\n        key: \"createTaskPositionMap\",\r\n        value: function(items) {\r\n            delete this._maxAppointmentCountPerCell;\r\n            var length = items && items.length;\r\n            if (!length) {\r\n                return\r\n            }\r\n            this._defaultWidth = this.instance._cellWidth;\r\n            this._defaultHeight = this.instance._cellHeight;\r\n            this._allDayHeight = this.instance._allDayCellHeight;\r\n            var map = [];\r\n            for (var i = 0; i < length; i++) {\r\n                var coordinates = this._getItemPosition(items[i]);\r\n                if (this._isRtl()) {\r\n                    coordinates = this._correctRtlCoordinates(coordinates)\r\n                }\r\n                map.push(coordinates)\r\n            }\r\n            var positionArray = this._getSortedPositions(map);\r\n            var resultPositions = this._getResultPositions(positionArray);\r\n            return this._getExtendedPositionMap(map, resultPositions)\r\n        }\r\n    }, {\r\n        key: \"_getDeltaWidth\",\r\n        value: function(args, initialSize) {\r\n            var intervalWidth = this.instance.fire(\"getResizableStep\") || this.getAppointmentMinSize();\r\n            var initialWidth = initialSize.width;\r\n            return Math.round((args.width - initialWidth) / intervalWidth)\r\n        }\r\n    }, {\r\n        key: \"_correctRtlCoordinates\",\r\n        value: function(coordinates) {\r\n            var width = coordinates[0].width || this._getAppointmentMaxWidth();\r\n            coordinates.forEach(function(coordinate) {\r\n                if (!coordinate.appointmentReduced) {\r\n                    coordinate.left -= width\r\n                }\r\n            });\r\n            return coordinates\r\n        }\r\n    }, {\r\n        key: \"_getAppointmentMaxWidth\",\r\n        value: function() {\r\n            return this.getDefaultCellWidth()\r\n        }\r\n    }, {\r\n        key: \"_getItemPosition\",\r\n        value: function(item) {\r\n            var position = this._getAppointmentCoordinates(item);\r\n            var allDay = this.isAllDay(item);\r\n            var result = [];\r\n            var startDate = new Date(this.instance.fire(\"getField\", \"startDate\", item));\r\n            var isRecurring = !!this.instance.fire(\"getField\", \"recurrenceRule\", item);\r\n            for (var j = 0; j < position.length; j++) {\r\n                var height = this.calculateAppointmentHeight(item, position[j], isRecurring);\r\n                var width = this.calculateAppointmentWidth(item, position[j], isRecurring);\r\n                var resultWidth = width;\r\n                var appointmentReduced = null;\r\n                var multiWeekAppointmentParts = [];\r\n                var initialRowIndex = position[j].rowIndex;\r\n                var initialCellIndex = position[j].cellIndex;\r\n                if (this._needVerifyItemSize() || allDay) {\r\n                    var currentMaxAllowedPosition = position[j].hMax;\r\n                    if (this.isAppointmentGreaterThan(currentMaxAllowedPosition, {\r\n                            left: position[j].left,\r\n                            width: width\r\n                        })) {\r\n                        appointmentReduced = \"head\";\r\n                        initialRowIndex = position[j].rowIndex;\r\n                        initialCellIndex = position[j].cellIndex;\r\n                        resultWidth = this._reduceMultiWeekAppointment(width, {\r\n                            left: position[j].left,\r\n                            right: currentMaxAllowedPosition\r\n                        });\r\n                        multiWeekAppointmentParts = this._getAppointmentParts({\r\n                            sourceAppointmentWidth: width,\r\n                            reducedWidth: resultWidth,\r\n                            height: height\r\n                        }, position[j], startDate);\r\n                        if (this._isRtl()) {\r\n                            position[j].left = currentMaxAllowedPosition\r\n                        }\r\n                    }\r\n                }(0, _extend.extend)(position[j], {\r\n                    height: height,\r\n                    width: resultWidth,\r\n                    allDay: allDay,\r\n                    rowIndex: initialRowIndex,\r\n                    cellIndex: initialCellIndex,\r\n                    appointmentReduced: appointmentReduced\r\n                });\r\n                result = this._getAppointmentPartsPosition(multiWeekAppointmentParts, position[j], result)\r\n            }\r\n            return result\r\n        }\r\n    }, {\r\n        key: \"_getAppointmentPartsPosition\",\r\n        value: function(appointmentParts, position, result) {\r\n            if (appointmentParts.length) {\r\n                appointmentParts.unshift(position);\r\n                result = result.concat(appointmentParts)\r\n            } else {\r\n                result.push(position)\r\n            }\r\n            return result\r\n        }\r\n    }, {\r\n        key: \"_getAppointmentCoordinates\",\r\n        value: function(itemData) {\r\n            return this.instance.fire(\"needCoordinates\", {\r\n                startDate: this.startDate(itemData),\r\n                originalStartDate: this.startDate(itemData, true),\r\n                appointmentData: itemData\r\n            })\r\n        }\r\n    }, {\r\n        key: \"_isRtl\",\r\n        value: function() {\r\n            return this.instance.option(\"rtlEnabled\")\r\n        }\r\n    }, {\r\n        key: \"_getAppointmentParts\",\r\n        value: function() {\r\n            return []\r\n        }\r\n    }, {\r\n        key: \"_getCompactAppointmentParts\",\r\n        value: function(appointmentWidth) {\r\n            var cellWidth = this.getDefaultCellWidth() || this.getAppointmentMinSize();\r\n            return Math.round(appointmentWidth / cellWidth)\r\n        }\r\n    }, {\r\n        key: \"_reduceMultiWeekAppointment\",\r\n        value: function(sourceAppointmentWidth, bound) {\r\n            if (this._isRtl()) {\r\n                sourceAppointmentWidth = Math.floor(bound.left - bound.right)\r\n            } else {\r\n                sourceAppointmentWidth = bound.right - Math.floor(bound.left)\r\n            }\r\n            return sourceAppointmentWidth\r\n        }\r\n    }, {\r\n        key: \"calculateAppointmentHeight\",\r\n        value: function() {\r\n            return 0\r\n        }\r\n    }, {\r\n        key: \"calculateAppointmentWidth\",\r\n        value: function() {\r\n            return 0\r\n        }\r\n    }, {\r\n        key: \"isAppointmentGreaterThan\",\r\n        value: function(etalon, comparisonParameters) {\r\n            var result = comparisonParameters.left + comparisonParameters.width - etalon;\r\n            if (this._isRtl()) {\r\n                result = etalon + comparisonParameters.width - comparisonParameters.left\r\n            }\r\n            return result > this.getDefaultCellWidth() / 2\r\n        }\r\n    }, {\r\n        key: \"isAllDay\",\r\n        value: function() {\r\n            return false\r\n        }\r\n    }, {\r\n        key: \"cropAppointmentWidth\",\r\n        value: function(width, cellWidth) {\r\n            if (this.instance.fire(\"isGroupedByDate\")) {\r\n                width = cellWidth\r\n            }\r\n            return width\r\n        }\r\n    }, {\r\n        key: \"_getSortedPositions\",\r\n        value: function(positionList) {\r\n            var _this = this;\r\n            var result = [];\r\n            var round = function(value) {\r\n                return Math.round(100 * value) / 100\r\n            };\r\n            var createItem = function(rowIndex, cellIndex, top, left, bottom, right, position, allDay) {\r\n                return {\r\n                    i: rowIndex,\r\n                    j: cellIndex,\r\n                    top: round(top),\r\n                    left: round(left),\r\n                    bottom: round(bottom),\r\n                    right: round(right),\r\n                    cellPosition: position,\r\n                    allDay: allDay\r\n                }\r\n            };\r\n            for (var rowIndex = 0, rowCount = positionList.length; rowIndex < rowCount; rowIndex++) {\r\n                for (var cellIndex = 0, cellCount = positionList[rowIndex].length; cellIndex < cellCount; cellIndex++) {\r\n                    var _positionList$rowInde = positionList[rowIndex][cellIndex],\r\n                        top = _positionList$rowInde.top,\r\n                        left = _positionList$rowInde.left,\r\n                        height = _positionList$rowInde.height,\r\n                        width = _positionList$rowInde.width,\r\n                        cellPosition = _positionList$rowInde.cellPosition,\r\n                        allDay = _positionList$rowInde.allDay;\r\n                    result.push(createItem(rowIndex, cellIndex, top, left, top + height, left + width, cellPosition, allDay))\r\n                }\r\n            }\r\n            return result.sort(function(a, b) {\r\n                return _this._sortCondition(a, b)\r\n            })\r\n        }\r\n    }, {\r\n        key: \"_sortCondition\",\r\n        value: function() {}\r\n    }, {\r\n        key: \"_getConditions\",\r\n        value: function(a, b) {\r\n            var isSomeEdge = this._isSomeEdge(a, b);\r\n            return {\r\n                columnCondition: isSomeEdge || this._normalizeCondition(a.left, b.left),\r\n                rowCondition: isSomeEdge || this._normalizeCondition(a.top, b.top),\r\n                cellPositionCondition: isSomeEdge || this._normalizeCondition(a.cellPosition, b.cellPosition)\r\n            }\r\n        }\r\n    }, {\r\n        key: \"_rowCondition\",\r\n        value: function(a, b) {\r\n            var conditions = this._getConditions(a, b);\r\n            return conditions.columnCondition || conditions.rowCondition\r\n        }\r\n    }, {\r\n        key: \"_columnCondition\",\r\n        value: function(a, b) {\r\n            var conditions = this._getConditions(a, b);\r\n            return conditions.rowCondition || conditions.columnCondition\r\n        }\r\n    }, {\r\n        key: \"_isSomeEdge\",\r\n        value: function(a, b) {\r\n            return a.i === b.i && a.j === b.j\r\n        }\r\n    }, {\r\n        key: \"_normalizeCondition\",\r\n        value: function(first, second) {\r\n            var result = first - second;\r\n            return Math.abs(result) > 1 ? result : 0\r\n        }\r\n    }, {\r\n        key: \"_isItemsCross\",\r\n        value: function(item, currentItem, orientation) {\r\n            var side_1 = Math.floor(item[orientation[0]]);\r\n            var side_2 = Math.floor(item[orientation[1]]);\r\n            return item[orientation[2]] === currentItem[orientation[2]] && (side_1 <= currentItem[orientation[0]] && side_2 > currentItem[orientation[0]] || side_1 < currentItem[orientation[1]] && side_2 >= currentItem[orientation[1]] || side_1 === currentItem[orientation[0]] && side_2 === currentItem[orientation[1]])\r\n        }\r\n    }, {\r\n        key: \"_getOrientation\",\r\n        value: function() {\r\n            return [\"top\", \"bottom\", \"left\"]\r\n        }\r\n    }, {\r\n        key: \"_getResultPositions\",\r\n        value: function(sortedArray) {\r\n            var _this2 = this;\r\n            var result = [];\r\n            var i;\r\n            var sortedIndex = 0;\r\n            var currentItem;\r\n            var indexes;\r\n            var itemIndex;\r\n            var maxIndexInStack = 0;\r\n            var stack = {};\r\n            var orientation = this._getOrientation();\r\n            var findFreeIndex = function findFreeIndex(indexes, index) {\r\n                var isFind = indexes.some(function(item) {\r\n                    return item === index\r\n                });\r\n                if (isFind) {\r\n                    return findFreeIndex(indexes, ++index)\r\n                } else {\r\n                    return index\r\n                }\r\n            };\r\n            var startNewStack = function(currentItem) {\r\n                stack.items = [createItem(currentItem)];\r\n                stack.left = currentItem.left;\r\n                stack.right = currentItem.right;\r\n                stack.top = currentItem.top;\r\n                stack.bottom = currentItem.bottom\r\n            };\r\n            var createItem = function(currentItem, index) {\r\n                var currentIndex = index || 0;\r\n                return {\r\n                    index: currentIndex,\r\n                    i: currentItem.i,\r\n                    j: currentItem.j,\r\n                    left: currentItem.left,\r\n                    right: currentItem.right,\r\n                    top: currentItem.top,\r\n                    bottom: currentItem.bottom,\r\n                    sortedIndex: _this2._skipSortedIndex(currentIndex) ? null : sortedIndex++\r\n                }\r\n            };\r\n            var pushItemsInResult = function(items) {\r\n                items.forEach(function(item) {\r\n                    result.push({\r\n                        index: item.index,\r\n                        count: maxIndexInStack + 1,\r\n                        i: item.i,\r\n                        j: item.j,\r\n                        sortedIndex: item.sortedIndex\r\n                    })\r\n                })\r\n            };\r\n            for (i = 0; i < sortedArray.length; i++) {\r\n                currentItem = sortedArray[i];\r\n                indexes = [];\r\n                if (!stack.items) {\r\n                    startNewStack(currentItem)\r\n                } else {\r\n                    if (this._isItemsCross(stack, currentItem, orientation)) {\r\n                        stack.items.forEach(function(item, index) {\r\n                            if (_this2._isItemsCross(item, currentItem, orientation)) {\r\n                                indexes.push(item.index)\r\n                            }\r\n                        });\r\n                        itemIndex = indexes.length ? findFreeIndex(indexes, 0) : 0;\r\n                        stack.items.push(createItem(currentItem, itemIndex));\r\n                        maxIndexInStack = Math.max(itemIndex, maxIndexInStack);\r\n                        stack.left = Math.min(stack.left, currentItem.left);\r\n                        stack.right = Math.max(stack.right, currentItem.right);\r\n                        stack.top = Math.min(stack.top, currentItem.top);\r\n                        stack.bottom = Math.max(stack.bottom, currentItem.bottom)\r\n                    } else {\r\n                        pushItemsInResult(stack.items);\r\n                        stack = {};\r\n                        startNewStack(currentItem);\r\n                        maxIndexInStack = 0\r\n                    }\r\n                }\r\n            }\r\n            if (stack.items) {\r\n                pushItemsInResult(stack.items)\r\n            }\r\n            return result.sort(function(a, b) {\r\n                var columnCondition = a.j - b.j;\r\n                var rowCondition = a.i - b.i;\r\n                return rowCondition ? rowCondition : columnCondition\r\n            })\r\n        }\r\n    }, {\r\n        key: \"_skipSortedIndex\",\r\n        value: function(index) {\r\n            return this.instance.fire(\"getMaxAppointmentsPerCell\") && index > this._getMaxAppointmentCountPerCell() - 1\r\n        }\r\n    }, {\r\n        key: \"_findIndexByKey\",\r\n        value: function(arr, iKey, jKey, iValue, jValue) {\r\n            var result = 0;\r\n            for (var i = 0, len = arr.length; i < len; i++) {\r\n                if (arr[i][iKey] === iValue && arr[i][jKey] === jValue) {\r\n                    result = i;\r\n                    break\r\n                }\r\n            }\r\n            return result\r\n        }\r\n    }, {\r\n        key: \"_getExtendedPositionMap\",\r\n        value: function(map, positions) {\r\n            var positionCounter = 0;\r\n            var result = [];\r\n            for (var i = 0, mapLength = map.length; i < mapLength; i++) {\r\n                var resultString = [];\r\n                for (var j = 0, itemLength = map[i].length; j < itemLength; j++) {\r\n                    map[i][j].index = positions[positionCounter].index;\r\n                    map[i][j].sortedIndex = positions[positionCounter].sortedIndex;\r\n                    map[i][j].count = positions[positionCounter++].count;\r\n                    resultString.push(map[i][j]);\r\n                    this._checkLongCompactAppointment(map[i][j], resultString)\r\n                }\r\n                result.push(resultString)\r\n            }\r\n            return result\r\n        }\r\n    }, {\r\n        key: \"_checkLongCompactAppointment\",\r\n        value: function() {}\r\n    }, {\r\n        key: \"_splitLongCompactAppointment\",\r\n        value: function(item, result) {\r\n            var appointmentCountPerCell = this._getMaxAppointmentCountPerCellByType(item.allDay);\r\n            var compactCount = 0;\r\n            if (void 0 !== appointmentCountPerCell && item.index > appointmentCountPerCell - 1) {\r\n                item.isCompact = true;\r\n                compactCount = this._getCompactAppointmentParts(item.width);\r\n                for (var k = 1; k < compactCount; k++) {\r\n                    var compactPart = (0, _extend.extend)(true, {}, item);\r\n                    compactPart.left = this._getCompactLeftCoordinate(item.left, k);\r\n                    compactPart.cellIndex = compactPart.cellIndex + k;\r\n                    compactPart.sortedIndex = null;\r\n                    result.push(compactPart)\r\n                }\r\n            }\r\n            return result\r\n        }\r\n    }, {\r\n        key: \"startDate\",\r\n        value: function startDate(appointment, skipNormalize, position) {\r\n            var startDate = position && position.startDate;\r\n            var rangeStartDate = this.instance._getStartDate(appointment, skipNormalize);\r\n            var text = this.instance.fire(\"getField\", \"text\", appointment);\r\n            if (startDate && rangeStartDate > startDate || !startDate) {\r\n                startDate = rangeStartDate\r\n            }\r\n            if (isNaN(startDate.getTime())) {\r\n                throw _ui2.default.Error(\"E1032\", text)\r\n            }\r\n            return startDate\r\n        }\r\n    }, {\r\n        key: \"endDate\",\r\n        value: function endDate(appointment, position, isRecurring) {\r\n            var ignoreViewDates = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : false;\r\n            var endDate = this.instance._getEndDate(appointment, ignoreViewDates);\r\n            var realStartDate = this.startDate(appointment, true);\r\n            var viewStartDate = this.startDate(appointment, false, position);\r\n            if (viewStartDate.getTime() > endDate.getTime() || isRecurring) {\r\n                var recurrencePartStartDate = position ? position.initialStartDate || position.startDate : realStartDate;\r\n                var recurrencePartCroppedByViewStartDate = position ? position.startDate : realStartDate;\r\n                var fullDuration = viewStartDate.getTime() > endDate.getTime() ? this.instance.fire(\"getField\", \"endDate\", appointment).getTime() - this.instance.fire(\"getField\", \"startDate\", appointment).getTime() : endDate.getTime() - realStartDate.getTime();\r\n                fullDuration = this._adjustDurationByDaylightDiff(fullDuration, realStartDate, endDate);\r\n                endDate = new Date(viewStartDate.getTime() >= recurrencePartStartDate.getTime() ? recurrencePartStartDate.getTime() : viewStartDate.getTime());\r\n                if (isRecurring) {\r\n                    endDate = new Date(endDate.getTime() + fullDuration)\r\n                }\r\n                if (!_date2.default.sameDate(realStartDate, endDate) && recurrencePartCroppedByViewStartDate.getTime() < viewStartDate.getTime()) {\r\n                    var headDuration = _date2.default.trimTime(endDate).getTime() - recurrencePartCroppedByViewStartDate.getTime();\r\n                    var tailDuration = fullDuration - headDuration || fullDuration;\r\n                    endDate = new Date(_date2.default.trimTime(viewStartDate).getTime() + tailDuration)\r\n                }\r\n            }\r\n            if (!this.isAllDay(appointment)) {\r\n                var viewEndDate = _date2.default.roundToHour(this.instance.fire(\"getEndViewDate\"));\r\n                if (endDate > viewEndDate) {\r\n                    endDate = viewEndDate\r\n                }\r\n                var currentViewEndTime = new Date(new Date(endDate).setHours(this.instance.option(\"endDayHour\"), 0, 0));\r\n                if (endDate.getTime() > currentViewEndTime.getTime()) {\r\n                    endDate = currentViewEndTime\r\n                }\r\n            }\r\n            return endDate\r\n        }\r\n    }, {\r\n        key: \"_adjustDurationByDaylightDiff\",\r\n        value: function(duration, startDate, endDate) {\r\n            var daylightDiff = this.instance.fire(\"getDaylightOffset\", startDate, endDate);\r\n            return this._needAdjustDuration(daylightDiff) ? this._calculateDurationByDaylightDiff(duration, daylightDiff) : duration\r\n        }\r\n    }, {\r\n        key: \"_needAdjustDuration\",\r\n        value: function(diff) {\r\n            return 0 !== diff\r\n        }\r\n    }, {\r\n        key: \"_calculateDurationByDaylightDiff\",\r\n        value: function(duration, diff) {\r\n            return duration + diff * toMs(\"minute\")\r\n        }\r\n    }, {\r\n        key: \"_getAppointmentDurationInMs\",\r\n        value: function(startDate, endDate, allDay) {\r\n            return this.instance.fire(\"getAppointmentDurationInMs\", {\r\n                startDate: startDate,\r\n                endDate: endDate,\r\n                allDay: allDay\r\n            })\r\n        }\r\n    }, {\r\n        key: \"_getMaxNeighborAppointmentCount\",\r\n        value: function() {\r\n            var overlappingMode = this.instance.fire(\"getMaxAppointmentsPerCell\");\r\n            if (!overlappingMode) {\r\n                var outerAppointmentWidth = this.getCompactAppointmentDefaultWidth() + this.getCompactAppointmentLeftOffset();\r\n                return Math.floor(this.getDropDownAppointmentWidth() / outerAppointmentWidth)\r\n            } else {\r\n                return 0\r\n            }\r\n        }\r\n    }, {\r\n        key: \"_markAppointmentAsVirtual\",\r\n        value: function(coordinates, isAllDay) {\r\n            var countFullWidthAppointmentInCell = this._getMaxAppointmentCountPerCellByType(isAllDay);\r\n            if (coordinates.count - countFullWidthAppointmentInCell > this._getMaxNeighborAppointmentCount()) {\r\n                coordinates.virtual = {\r\n                    top: coordinates.top,\r\n                    left: coordinates.left,\r\n                    index: \"tail\" === coordinates.appointmentReduced ? coordinates.groupIndex + \"-\" + coordinates.rowIndex + \"-\" + coordinates.cellIndex : coordinates.groupIndex + \"-\" + coordinates.rowIndex + \"-\" + coordinates.cellIndex + \"-tail\",\r\n                    isAllDay: isAllDay\r\n                }\r\n            }\r\n        }\r\n    }, {\r\n        key: \"_getMaxAppointmentCountPerCellByType\",\r\n        value: function(isAllDay) {\r\n            var appointmentCountPerCell = this._getMaxAppointmentCountPerCell();\r\n            if (_type2.default.isObject(appointmentCountPerCell)) {\r\n                return isAllDay ? this._getMaxAppointmentCountPerCell().allDay : this._getMaxAppointmentCountPerCell().simple\r\n            } else {\r\n                return appointmentCountPerCell\r\n            }\r\n        }\r\n    }, {\r\n        key: \"getDropDownAppointmentWidth\",\r\n        value: function(intervalCount, isAllDay) {\r\n            return this.getPositioningStrategy().getDropDownAppointmentWidth(intervalCount, isAllDay)\r\n        }\r\n    }, {\r\n        key: \"getDropDownAppointmentHeight\",\r\n        value: function() {\r\n            return this.getPositioningStrategy().getDropDownAppointmentHeight()\r\n        }\r\n    }, {\r\n        key: \"getDropDownButtonAdaptiveSize\",\r\n        value: function() {\r\n            return DROP_DOWN_BUTTON_ADAPTIVE_SIZE\r\n        }\r\n    }, {\r\n        key: \"getDefaultCellWidth\",\r\n        value: function() {\r\n            return this._defaultWidth\r\n        }\r\n    }, {\r\n        key: \"getDefaultCellHeight\",\r\n        value: function() {\r\n            return this._defaultHeight\r\n        }\r\n    }, {\r\n        key: \"getDefaultAllDayCellHeight\",\r\n        value: function() {\r\n            return this._allDayHeight\r\n        }\r\n    }, {\r\n        key: \"getCompactAppointmentDefaultWidth\",\r\n        value: function() {\r\n            return COMPACT_APPOINTMENT_DEFAULT_WIDTH\r\n        }\r\n    }, {\r\n        key: \"getCompactAppointmentTopOffset\",\r\n        value: function(allDay) {\r\n            return this.getPositioningStrategy().getCompactAppointmentTopOffset(allDay)\r\n        }\r\n    }, {\r\n        key: \"getCompactAppointmentLeftOffset\",\r\n        value: function() {\r\n            return this.getPositioningStrategy().getCompactAppointmentLeftOffset()\r\n        }\r\n    }, {\r\n        key: \"getAppointmentDataCalculator\",\r\n        value: function() {}\r\n    }, {\r\n        key: \"_customizeCoordinates\",\r\n        value: function(coordinates, height, appointmentCountPerCell, topOffset, isAllDay) {\r\n            var index = coordinates.index;\r\n            var appointmentHeight = height / appointmentCountPerCell;\r\n            var appointmentTop = coordinates.top + index * appointmentHeight;\r\n            var top = appointmentTop + topOffset;\r\n            var width = coordinates.width;\r\n            var left = coordinates.left;\r\n            var compactAppointmentDefaultSize;\r\n            var compactAppointmentLeftOffset;\r\n            var compactAppointmentTopOffset = this.getCompactAppointmentTopOffset(isAllDay);\r\n            if (coordinates.isCompact) {\r\n                compactAppointmentDefaultSize = this.getCompactAppointmentDefaultWidth();\r\n                compactAppointmentLeftOffset = this.getCompactAppointmentLeftOffset();\r\n                top = coordinates.top + compactAppointmentTopOffset;\r\n                left = coordinates.left + (index - appointmentCountPerCell) * (compactAppointmentDefaultSize + compactAppointmentLeftOffset) + compactAppointmentLeftOffset;\r\n                this._isAdaptive() && this._correctCompactAppointmentCoordinatesInAdaptive(coordinates, isAllDay);\r\n                appointmentHeight = compactAppointmentDefaultSize;\r\n                width = compactAppointmentDefaultSize;\r\n                this._markAppointmentAsVirtual(coordinates, isAllDay)\r\n            }\r\n            return {\r\n                height: appointmentHeight,\r\n                width: width,\r\n                top: top,\r\n                left: left,\r\n                empty: this._isAppointmentEmpty(height, width)\r\n            }\r\n        }\r\n    }, {\r\n        key: \"_isAppointmentEmpty\",\r\n        value: function(height, width) {\r\n            return height < this._getAppointmentMinHeight() || width < this._getAppointmentMinWidth()\r\n        }\r\n    }, {\r\n        key: \"_calculateGeometryConfig\",\r\n        value: function(coordinates) {\r\n            var overlappingMode = this.instance.fire(\"getMaxAppointmentsPerCell\");\r\n            var offsets = this._getOffsets();\r\n            var appointmentDefaultOffset = this._getAppointmentDefaultOffset();\r\n            var appointmentCountPerCell = this._getAppointmentCount(overlappingMode, coordinates);\r\n            var ratio = this._getDefaultRatio(coordinates, appointmentCountPerCell);\r\n            var maxHeight = this._getMaxHeight();\r\n            if (!(0, _type.isNumeric)(appointmentCountPerCell)) {\r\n                appointmentCountPerCell = coordinates.count;\r\n                ratio = (maxHeight - offsets.unlimited) / maxHeight\r\n            }\r\n            var topOffset = (1 - ratio) * maxHeight;\r\n            if (\"auto\" === overlappingMode || (0, _type.isNumeric)(overlappingMode)) {\r\n                ratio = 1;\r\n                maxHeight -= appointmentDefaultOffset;\r\n                topOffset = appointmentDefaultOffset\r\n            }\r\n            return {\r\n                height: ratio * maxHeight,\r\n                appointmentCountPerCell: appointmentCountPerCell,\r\n                offset: topOffset\r\n            }\r\n        }\r\n    }, {\r\n        key: \"_getAppointmentCount\",\r\n        value: function() {}\r\n    }, {\r\n        key: \"_getDefaultRatio\",\r\n        value: function() {}\r\n    }, {\r\n        key: \"_getOffsets\",\r\n        value: function() {}\r\n    }, {\r\n        key: \"_getMaxHeight\",\r\n        value: function() {}\r\n    }, {\r\n        key: \"_needVerifyItemSize\",\r\n        value: function() {\r\n            return false\r\n        }\r\n    }, {\r\n        key: \"needSeparateAppointment\",\r\n        value: function(allDay) {\r\n            return this.instance.fire(\"isGroupedByDate\") && allDay\r\n        }\r\n    }, {\r\n        key: \"_getMaxAppointmentCountPerCell\",\r\n        value: function() {\r\n            if (!this._maxAppointmentCountPerCell) {\r\n                var overlappingMode = this.instance.fire(\"getMaxAppointmentsPerCell\");\r\n                var appointmentCountPerCell;\r\n                if (!overlappingMode) {\r\n                    appointmentCountPerCell = 2\r\n                }\r\n                if ((0, _type.isNumeric)(overlappingMode)) {\r\n                    appointmentCountPerCell = overlappingMode\r\n                }\r\n                if (\"auto\" === overlappingMode) {\r\n                    appointmentCountPerCell = this._getDynamicAppointmentCountPerCell()\r\n                }\r\n                if (\"unlimited\" === overlappingMode) {\r\n                    appointmentCountPerCell = void 0\r\n                }\r\n                this._maxAppointmentCountPerCell = appointmentCountPerCell\r\n            }\r\n            return this._maxAppointmentCountPerCell\r\n        }\r\n    }, {\r\n        key: \"_getDynamicAppointmentCountPerCell\",\r\n        value: function() {\r\n            return this.getPositioningStrategy().getDynamicAppointmentCountPerCell()\r\n        }\r\n    }, {\r\n        key: \"hasAllDayAppointments\",\r\n        value: function() {\r\n            return false\r\n        }\r\n    }, {\r\n        key: \"_isCompactTheme\",\r\n        value: function() {\r\n            return \"compact\" === (_themes2.default.current() || \"\").split(\".\").pop()\r\n        }\r\n    }, {\r\n        key: \"_getAppointmentDefaultOffset\",\r\n        value: function() {\r\n            return this.getPositioningStrategy().getAppointmentDefaultOffset()\r\n        }\r\n    }, {\r\n        key: \"_getAppointmentDefaultHeight\",\r\n        value: function() {\r\n            return this._getAppointmentHeightByTheme()\r\n        }\r\n    }, {\r\n        key: \"_getAppointmentMinHeight\",\r\n        value: function() {\r\n            return this._getAppointmentDefaultHeight()\r\n        }\r\n    }, {\r\n        key: \"_getAppointmentHeightByTheme\",\r\n        value: function() {\r\n            return this._isCompactTheme() ? COMPACT_THEME_APPOINTMENT_DEFAULT_HEIGHT : APPOINTMENT_DEFAULT_HEIGHT\r\n        }\r\n    }, {\r\n        key: \"_getAppointmentDefaultWidth\",\r\n        value: function() {\r\n            return this.getPositioningStrategy()._getAppointmentDefaultWidth()\r\n        }\r\n    }, {\r\n        key: \"_getAppointmentMinWidth\",\r\n        value: function() {\r\n            return this._getAppointmentDefaultWidth()\r\n        }\r\n    }, {\r\n        key: \"_needVerticalGroupBounds\",\r\n        value: function() {\r\n            return false\r\n        }\r\n    }, {\r\n        key: \"_needHorizontalGroupBounds\",\r\n        value: function() {\r\n            return false\r\n        }\r\n    }]);\r\n    return BaseRenderingStrategy\r\n}();\r\nmodule.exports = BaseRenderingStrategy;\r\n"]},"metadata":{},"sourceType":"module"}