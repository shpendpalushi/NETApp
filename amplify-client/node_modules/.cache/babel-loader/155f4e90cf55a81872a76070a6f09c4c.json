{"ast":null,"code":"/**\r\n * DevExtreme (ui/shared/accessibility.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar _renderer = require(\"../../core/renderer\");\n\nvar _renderer2 = _interopRequireDefault(_renderer);\n\nvar _events_engine = require(\"../../events/core/events_engine\");\n\nvar _events_engine2 = _interopRequireDefault(_events_engine);\n\nvar _utils = require(\"../../events/utils\");\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nvar _extend = require(\"../../core/utils/extend\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nvar FOCUS_STATE_CLASS = \"dx-state-focused\";\nvar FOCUS_DISABLED_CLASS = \"dx-cell-focus-disabled\";\nvar FOCUSED_ROW_SELECTOR = \".dx-row-focused\";\nvar GRID_ROW_SELECTOR = \".dx-datagrid-rowsview .dx-row\";\nvar GRID_CELL_SELECTOR = \"\".concat(GRID_ROW_SELECTOR, \" > td\");\nvar TREELIST_ROW_SELECTOR = \".dx-treelist-rowsview .dx-row\";\nvar TREELIST_CELL_SELECTOR = \"\".concat(TREELIST_ROW_SELECTOR, \" > td\");\nvar viewItemSelectorMap = {\n  groupPanel: [\".dx-datagrid-group-panel .dx-group-panel-item[tabindex]\"],\n  columnHeaders: [\".dx-datagrid-headers .dx-header-row > td.dx-datagrid-action\", \".dx-treelist-headers .dx-header-row > td.dx-treelist-action\"],\n  filterRow: [\".dx-datagrid-headers .dx-datagrid-filter-row .dx-editor-cell .dx-texteditor-input\", \".dx-treelist-headers .dx-treelist-filter-row .dx-editor-cell .dx-texteditor-input\"],\n  rowsView: [\"\".concat(FOCUSED_ROW_SELECTOR), \"\".concat(GRID_ROW_SELECTOR, \"[tabindex]\"), \"\".concat(GRID_CELL_SELECTOR, \"[tabindex]\"), \"\".concat(GRID_CELL_SELECTOR), \"\".concat(TREELIST_ROW_SELECTOR, \"[tabindex]\"), \"\".concat(TREELIST_CELL_SELECTOR, \"[tabindex]\"), \"\".concat(TREELIST_CELL_SELECTOR)],\n  footer: [\".dx-datagrid-total-footer .dx-datagrid-summary-item\", \".dx-treelist-total-footer .dx-treelist-summary-item\"],\n  filterPanel: [\".dx-datagrid-filter-panel .dx-icon-filter\", \".dx-treelist-filter-panel .dx-icon-filter\"],\n  pager: [\".dx-datagrid-pager [tabindex]\", \".dx-treelist-pager [tabindex]\"]\n};\nvar isMouseDown = false;\nvar isHiddenFocusing = false;\nvar focusedElementInfo = null;\n\nfunction processKeyDown(viewName, instance, event, action, $mainElement, executeKeyDown) {\n  var isHandled = fireKeyDownEvent(instance, event.originalEvent, executeKeyDown);\n\n  if (isHandled) {\n    return;\n  }\n\n  var keyName = _utils2.default.normalizeKeyName(event);\n\n  if (\"enter\" === keyName || \"space\" === keyName) {\n    saveFocusedElementInfo(event.target, instance);\n    action && action({\n      event: event\n    });\n  } else {\n    if (\"tab\" === keyName) {\n      $mainElement.addClass(FOCUS_STATE_CLASS);\n    } else {\n      module.exports.selectView(viewName, instance, event);\n    }\n  }\n}\n\nfunction saveFocusedElementInfo(target, instance) {\n  var $target = (0, _renderer2.default)(target);\n  var ariaLabel = $target.attr(\"aria-label\");\n  var $activeElements = getActiveAccessibleElements(ariaLabel, instance.element());\n  var targetIndex = $activeElements.index($target);\n  focusedElementInfo = (0, _extend.extend)({}, {\n    ariaLabel: ariaLabel,\n    index: targetIndex\n  }, {\n    viewInstance: instance\n  });\n}\n\nfunction getActiveAccessibleElements(ariaLabel, viewElement) {\n  var $viewElement = (0, _renderer2.default)(viewElement);\n  var $activeElements;\n\n  if (ariaLabel) {\n    $activeElements = $viewElement.find('[aria-label=\"'.concat(ariaLabel, '\"][tabindex]'));\n  } else {\n    $activeElements = $viewElement.find(\"[tabindex]\");\n  }\n\n  return $activeElements;\n}\n\nfunction findFocusedViewElement(viewSelectors) {\n  for (var index in viewSelectors) {\n    var selector = viewSelectors[index];\n    var $focusViewElement = (0, _renderer2.default)(selector).first();\n\n    if ($focusViewElement.length) {\n      return $focusViewElement;\n    }\n  }\n}\n\nfunction fireKeyDownEvent(instance, event, executeAction) {\n  var args = {\n    event: event,\n    handled: false\n  };\n\n  if (executeAction) {\n    executeAction(args);\n  } else {\n    instance._createActionByOption(\"onKeyDown\")(args);\n  }\n\n  return args.handled;\n}\n\nfunction onDocumentVisibilityChange() {\n  isHiddenFocusing = \"visible\" === document.visibilityState;\n}\n\nmodule.exports = {\n  subscribeVisibilityChange: function subscribeVisibilityChange() {\n    _events_engine2.default.on(document, \"visibilitychange\", onDocumentVisibilityChange);\n  },\n  unsubscribeVisibilityChange: function unsubscribeVisibilityChange() {\n    _events_engine2.default.off(document, \"visibilitychange\", onDocumentVisibilityChange);\n  },\n  hiddenFocus: function hiddenFocus(element) {\n    isHiddenFocusing = true;\n    element.focus();\n    isHiddenFocusing = false;\n  },\n  registerKeyboardAction: function registerKeyboardAction(viewName, instance, $element, selector, action, executeKeyDown) {\n    if (instance.option(\"useLegacyKeyboardNavigation\")) {\n      return;\n    }\n\n    var $mainElement = (0, _renderer2.default)(instance.element());\n\n    _events_engine2.default.on($element, \"keydown\", selector, function (e) {\n      return processKeyDown(viewName, instance, e, action, $mainElement, executeKeyDown);\n    });\n\n    _events_engine2.default.on($element, \"mousedown\", selector, function () {\n      isMouseDown = true;\n      $mainElement.removeClass(FOCUS_STATE_CLASS);\n    });\n\n    _events_engine2.default.on($element, \"focusin\", selector, function () {\n      var needShowOverlay = !isMouseDown && !isHiddenFocusing;\n\n      if (needShowOverlay) {\n        $mainElement.addClass(FOCUS_STATE_CLASS);\n      }\n\n      isMouseDown = false;\n    });\n  },\n  restoreFocus: function restoreFocus(instance) {\n    if (!instance.option(\"useLegacyKeyboardNavigation\") && focusedElementInfo) {\n      var viewInstance = focusedElementInfo.viewInstance;\n\n      if (viewInstance) {\n        var $activeElements = getActiveAccessibleElements(focusedElementInfo.ariaLabel, viewInstance.element());\n        var $targetElement = $activeElements.eq(focusedElementInfo.index);\n        focusedElementInfo = null;\n\n        _events_engine2.default.trigger($targetElement, \"focus\");\n      }\n    }\n  },\n  selectView: function selectView(viewName, instance, event) {\n    var keyName = _utils2.default.normalizeKeyName(event);\n\n    if (event.ctrlKey && (\"upArrow\" === keyName || \"downArrow\" === keyName)) {\n      var viewNames = Object.keys(viewItemSelectorMap);\n      var viewItemIndex = viewNames.indexOf(viewName);\n\n      while (viewItemIndex >= 0 && viewItemIndex < viewNames.length) {\n        viewItemIndex = \"upArrow\" === keyName ? --viewItemIndex : ++viewItemIndex;\n        var _viewName = viewNames[viewItemIndex];\n        var viewSelectors = viewItemSelectorMap[_viewName];\n        var $focusViewElement = findFocusedViewElement(viewSelectors);\n\n        if ($focusViewElement && $focusViewElement.length) {\n          $focusViewElement.attr(\"tabindex\", instance.option(\"tabindex\") || 0);\n\n          _events_engine2.default.trigger($focusViewElement, \"focus\");\n\n          $focusViewElement.removeClass(FOCUS_DISABLED_CLASS);\n          break;\n        }\n      }\n    }\n  },\n  setTabIndex: function setTabIndex(instance, $element) {\n    if (!instance.option(\"useLegacyKeyboardnavigation\")) {\n      $element.attr(\"tabindex\", instance.option(\"tabindex\") || 0);\n    }\n  }\n};","map":{"version":3,"sources":["C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/devextreme/ui/shared/accessibility.js"],"names":["_renderer","require","_renderer2","_interopRequireDefault","_events_engine","_events_engine2","_utils","_utils2","_extend","obj","FOCUS_STATE_CLASS","FOCUS_DISABLED_CLASS","FOCUSED_ROW_SELECTOR","GRID_ROW_SELECTOR","GRID_CELL_SELECTOR","TREELIST_ROW_SELECTOR","TREELIST_CELL_SELECTOR","viewItemSelectorMap","groupPanel","columnHeaders","filterRow","rowsView","footer","filterPanel","pager","isMouseDown","isHiddenFocusing","focusedElementInfo","isHandled","fireKeyDownEvent","event","keyName","saveFocusedElementInfo","action","$mainElement","module","$target","ariaLabel","$activeElements","getActiveAccessibleElements","instance","targetIndex","index","viewInstance","$viewElement","selector","viewSelectors","$focusViewElement","args","handled","executeAction","document","subscribeVisibilityChange","unsubscribeVisibilityChange","hiddenFocus","element","registerKeyboardAction","processKeyDown","needShowOverlay","restoreFocus","$targetElement","selectView","viewNames","Object","viewItemIndex","_viewName","findFocusedViewElement","setTabIndex","$element"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/shared/accessibility.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar _renderer = require(\"../../core/renderer\");\r\nvar _renderer2 = _interopRequireDefault(_renderer);\r\nvar _events_engine = require(\"../../events/core/events_engine\");\r\nvar _events_engine2 = _interopRequireDefault(_events_engine);\r\nvar _utils = require(\"../../events/utils\");\r\nvar _utils2 = _interopRequireDefault(_utils);\r\nvar _extend = require(\"../../core/utils/extend\");\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\nvar FOCUS_STATE_CLASS = \"dx-state-focused\";\r\nvar FOCUS_DISABLED_CLASS = \"dx-cell-focus-disabled\";\r\nvar FOCUSED_ROW_SELECTOR = \".dx-row-focused\";\r\nvar GRID_ROW_SELECTOR = \".dx-datagrid-rowsview .dx-row\";\r\nvar GRID_CELL_SELECTOR = \"\".concat(GRID_ROW_SELECTOR, \" > td\");\r\nvar TREELIST_ROW_SELECTOR = \".dx-treelist-rowsview .dx-row\";\r\nvar TREELIST_CELL_SELECTOR = \"\".concat(TREELIST_ROW_SELECTOR, \" > td\");\r\nvar viewItemSelectorMap = {\r\n    groupPanel: [\".dx-datagrid-group-panel .dx-group-panel-item[tabindex]\"],\r\n    columnHeaders: [\".dx-datagrid-headers .dx-header-row > td.dx-datagrid-action\", \".dx-treelist-headers .dx-header-row > td.dx-treelist-action\"],\r\n    filterRow: [\".dx-datagrid-headers .dx-datagrid-filter-row .dx-editor-cell .dx-texteditor-input\", \".dx-treelist-headers .dx-treelist-filter-row .dx-editor-cell .dx-texteditor-input\"],\r\n    rowsView: [\"\".concat(FOCUSED_ROW_SELECTOR), \"\".concat(GRID_ROW_SELECTOR, \"[tabindex]\"), \"\".concat(GRID_CELL_SELECTOR, \"[tabindex]\"), \"\".concat(GRID_CELL_SELECTOR), \"\".concat(TREELIST_ROW_SELECTOR, \"[tabindex]\"), \"\".concat(TREELIST_CELL_SELECTOR, \"[tabindex]\"), \"\".concat(TREELIST_CELL_SELECTOR)],\r\n    footer: [\".dx-datagrid-total-footer .dx-datagrid-summary-item\", \".dx-treelist-total-footer .dx-treelist-summary-item\"],\r\n    filterPanel: [\".dx-datagrid-filter-panel .dx-icon-filter\", \".dx-treelist-filter-panel .dx-icon-filter\"],\r\n    pager: [\".dx-datagrid-pager [tabindex]\", \".dx-treelist-pager [tabindex]\"]\r\n};\r\nvar isMouseDown = false;\r\nvar isHiddenFocusing = false;\r\nvar focusedElementInfo = null;\r\n\r\nfunction processKeyDown(viewName, instance, event, action, $mainElement, executeKeyDown) {\r\n    var isHandled = fireKeyDownEvent(instance, event.originalEvent, executeKeyDown);\r\n    if (isHandled) {\r\n        return\r\n    }\r\n    var keyName = _utils2.default.normalizeKeyName(event);\r\n    if (\"enter\" === keyName || \"space\" === keyName) {\r\n        saveFocusedElementInfo(event.target, instance);\r\n        action && action({\r\n            event: event\r\n        })\r\n    } else {\r\n        if (\"tab\" === keyName) {\r\n            $mainElement.addClass(FOCUS_STATE_CLASS)\r\n        } else {\r\n            module.exports.selectView(viewName, instance, event)\r\n        }\r\n    }\r\n}\r\n\r\nfunction saveFocusedElementInfo(target, instance) {\r\n    var $target = (0, _renderer2.default)(target);\r\n    var ariaLabel = $target.attr(\"aria-label\");\r\n    var $activeElements = getActiveAccessibleElements(ariaLabel, instance.element());\r\n    var targetIndex = $activeElements.index($target);\r\n    focusedElementInfo = (0, _extend.extend)({}, {\r\n        ariaLabel: ariaLabel,\r\n        index: targetIndex\r\n    }, {\r\n        viewInstance: instance\r\n    })\r\n}\r\n\r\nfunction getActiveAccessibleElements(ariaLabel, viewElement) {\r\n    var $viewElement = (0, _renderer2.default)(viewElement);\r\n    var $activeElements;\r\n    if (ariaLabel) {\r\n        $activeElements = $viewElement.find('[aria-label=\"'.concat(ariaLabel, '\"][tabindex]'))\r\n    } else {\r\n        $activeElements = $viewElement.find(\"[tabindex]\")\r\n    }\r\n    return $activeElements\r\n}\r\n\r\nfunction findFocusedViewElement(viewSelectors) {\r\n    for (var index in viewSelectors) {\r\n        var selector = viewSelectors[index];\r\n        var $focusViewElement = (0, _renderer2.default)(selector).first();\r\n        if ($focusViewElement.length) {\r\n            return $focusViewElement\r\n        }\r\n    }\r\n}\r\n\r\nfunction fireKeyDownEvent(instance, event, executeAction) {\r\n    var args = {\r\n        event: event,\r\n        handled: false\r\n    };\r\n    if (executeAction) {\r\n        executeAction(args)\r\n    } else {\r\n        instance._createActionByOption(\"onKeyDown\")(args)\r\n    }\r\n    return args.handled\r\n}\r\n\r\nfunction onDocumentVisibilityChange() {\r\n    isHiddenFocusing = \"visible\" === document.visibilityState\r\n}\r\nmodule.exports = {\r\n    subscribeVisibilityChange: function() {\r\n        _events_engine2.default.on(document, \"visibilitychange\", onDocumentVisibilityChange)\r\n    },\r\n    unsubscribeVisibilityChange: function() {\r\n        _events_engine2.default.off(document, \"visibilitychange\", onDocumentVisibilityChange)\r\n    },\r\n    hiddenFocus: function(element) {\r\n        isHiddenFocusing = true;\r\n        element.focus();\r\n        isHiddenFocusing = false\r\n    },\r\n    registerKeyboardAction: function(viewName, instance, $element, selector, action, executeKeyDown) {\r\n        if (instance.option(\"useLegacyKeyboardNavigation\")) {\r\n            return\r\n        }\r\n        var $mainElement = (0, _renderer2.default)(instance.element());\r\n        _events_engine2.default.on($element, \"keydown\", selector, function(e) {\r\n            return processKeyDown(viewName, instance, e, action, $mainElement, executeKeyDown)\r\n        });\r\n        _events_engine2.default.on($element, \"mousedown\", selector, function() {\r\n            isMouseDown = true;\r\n            $mainElement.removeClass(FOCUS_STATE_CLASS)\r\n        });\r\n        _events_engine2.default.on($element, \"focusin\", selector, function() {\r\n            var needShowOverlay = !isMouseDown && !isHiddenFocusing;\r\n            if (needShowOverlay) {\r\n                $mainElement.addClass(FOCUS_STATE_CLASS)\r\n            }\r\n            isMouseDown = false\r\n        })\r\n    },\r\n    restoreFocus: function(instance) {\r\n        if (!instance.option(\"useLegacyKeyboardNavigation\") && focusedElementInfo) {\r\n            var viewInstance = focusedElementInfo.viewInstance;\r\n            if (viewInstance) {\r\n                var $activeElements = getActiveAccessibleElements(focusedElementInfo.ariaLabel, viewInstance.element());\r\n                var $targetElement = $activeElements.eq(focusedElementInfo.index);\r\n                focusedElementInfo = null;\r\n                _events_engine2.default.trigger($targetElement, \"focus\")\r\n            }\r\n        }\r\n    },\r\n    selectView: function(viewName, instance, event) {\r\n        var keyName = _utils2.default.normalizeKeyName(event);\r\n        if (event.ctrlKey && (\"upArrow\" === keyName || \"downArrow\" === keyName)) {\r\n            var viewNames = Object.keys(viewItemSelectorMap);\r\n            var viewItemIndex = viewNames.indexOf(viewName);\r\n            while (viewItemIndex >= 0 && viewItemIndex < viewNames.length) {\r\n                viewItemIndex = \"upArrow\" === keyName ? --viewItemIndex : ++viewItemIndex;\r\n                var _viewName = viewNames[viewItemIndex];\r\n                var viewSelectors = viewItemSelectorMap[_viewName];\r\n                var $focusViewElement = findFocusedViewElement(viewSelectors);\r\n                if ($focusViewElement && $focusViewElement.length) {\r\n                    $focusViewElement.attr(\"tabindex\", instance.option(\"tabindex\") || 0);\r\n                    _events_engine2.default.trigger($focusViewElement, \"focus\");\r\n                    $focusViewElement.removeClass(FOCUS_DISABLED_CLASS);\r\n                    break\r\n                }\r\n            }\r\n        }\r\n    },\r\n    setTabIndex: function(instance, $element) {\r\n        if (!instance.option(\"useLegacyKeyboardnavigation\")) {\r\n            $element.attr(\"tabindex\", instance.option(\"tabindex\") || 0)\r\n        }\r\n    }\r\n};\r\n"]},"metadata":{},"sourceType":"module"}