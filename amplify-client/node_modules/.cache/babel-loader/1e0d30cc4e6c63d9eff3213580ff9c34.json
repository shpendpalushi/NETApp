{"ast":null,"code":"/**\r\n * DevExtreme (ui/tree_list/ui.tree_list.editing.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nrequire(\"./ui.tree_list.editor_factory\");\n\nvar _renderer = require(\"../../core/renderer\");\n\nvar _renderer2 = _interopRequireDefault(_renderer);\n\nvar _ui = require(\"../widget/ui.errors\");\n\nvar _ui2 = _interopRequireDefault(_ui);\n\nvar _type = require(\"../../core/utils/type\");\n\nvar _extend = require(\"../../core/utils/extend\");\n\nvar _deferred = require(\"../../core/utils/deferred\");\n\nvar _message = require(\"../../localization/message\");\n\nvar _message2 = _interopRequireDefault(_message);\n\nvar _uiTree_list = require(\"./ui.tree_list.core\");\n\nvar _uiTree_list2 = _interopRequireDefault(_uiTree_list);\n\nvar _uiGrid_core = require(\"../grid_core/ui.grid_core.utils\");\n\nvar _uiGrid_core2 = _interopRequireDefault(_uiGrid_core);\n\nvar _uiGrid_core3 = require(\"../grid_core/ui.grid_core.editing\");\n\nvar _uiGrid_core4 = _interopRequireDefault(_uiGrid_core3);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nvar TREELIST_EXPAND_ICON_CONTAINER_CLASS = \"dx-treelist-icon-container\";\nvar SELECT_CHECKBOX_CLASS = \"dx-select-checkbox\";\nvar DATA_EDIT_DATA_INSERT_TYPE = \"insert\";\n\nvar EditingController = _uiGrid_core4.default.controllers.editing.inherit(function () {\n  return {\n    _generateNewItem: function _generateNewItem(key) {\n      var item = this.callBase(key);\n      item.data = {\n        key: key\n      };\n      item.children = [];\n      item.level = 0;\n      item.parentKey = this.option(\"rootValue\");\n      return item;\n    },\n    _needInsertItem: function _needInsertItem(editData, changeType, items, item) {\n      var parentKey = editData.key.parentKey;\n\n      if (void 0 !== parentKey && parentKey !== this.option(\"rootValue\")) {\n        var rowIndex = _uiGrid_core2.default.getIndexByKey(parentKey, items);\n\n        if (rowIndex >= 0 && this._dataController.isRowExpanded(parentKey)) {\n          items.splice(rowIndex + 1, 0, item);\n        }\n\n        return false;\n      }\n\n      return this.callBase.apply(this, arguments);\n    },\n    _isEditColumnVisible: function _isEditColumnVisible() {\n      var result = this.callBase.apply(this, arguments);\n      var editingOptions = this.option(\"editing\");\n      return result || editingOptions && editingOptions.allowAdding;\n    },\n    _isDefaultButtonVisible: function _isDefaultButtonVisible(button, options) {\n      var result = this.callBase.apply(this, arguments);\n      var row = options.row;\n\n      if (\"add\" === button.name) {\n        return this.allowAdding(options) && row.rowIndex !== this._getVisibleEditRowIndex() && !(row.removed || row.isNewRow);\n      }\n\n      return result;\n    },\n    _getEditingButtons: function _getEditingButtons(options) {\n      var buttons = this.callBase.apply(this, arguments);\n\n      if (!options.column.buttons) {\n        buttons.unshift(this._getButtonConfig(\"add\", options));\n      }\n\n      return buttons;\n    },\n    _beforeSaveEditData: function _beforeSaveEditData(editData) {\n      var key;\n      var store;\n      var dataController = this._dataController;\n      var result = this.callBase.apply(this, arguments);\n\n      if (editData && editData.type !== DATA_EDIT_DATA_INSERT_TYPE) {\n        store = dataController && dataController.store();\n        key = store && store.key();\n\n        if (!(0, _type.isDefined)(key)) {\n          throw _ui2.default.Error(\"E1045\");\n        }\n      }\n\n      return result;\n    },\n    addRowByRowIndex: function addRowByRowIndex(rowIndex) {\n      var dataController = this.getController(\"data\");\n      var row = dataController.getVisibleRows()[rowIndex];\n      return this.addRow(row ? row.key : void 0);\n    },\n    addRow: function addRow(key) {\n      var that = this;\n      var callBase = that.callBase;\n      var dataController = that.getController(\"data\");\n\n      if (void 0 !== key && !dataController.isRowExpanded(key)) {\n        var d = new _deferred.Deferred();\n        dataController.expandRow(key).done(function () {\n          setTimeout(function () {\n            callBase.call(that, key);\n            d.resolve();\n          });\n        }).fail(d.reject);\n        return d;\n      }\n\n      if (void 0 === key) {\n        key = that.option(\"rootValue\");\n      }\n\n      callBase.call(that, key);\n    },\n    _initNewRow: function _initNewRow(options, parentKey) {\n      var dataController = this.getController(\"data\");\n      var dataSourceAdapter = dataController.dataSource();\n      var parentIdSetter = dataSourceAdapter.createParentIdSetter();\n      parentIdSetter(options.data, parentKey);\n      this.callBase.apply(this, arguments);\n    },\n    allowAdding: function allowAdding(options) {\n      return this._allowEditAction(\"allowAdding\", options);\n    },\n    _needToCloseEditableCell: function _needToCloseEditableCell($targetElement) {\n      return this.callBase.apply(this, arguments) || $targetElement.closest(\".\" + TREELIST_EXPAND_ICON_CONTAINER_CLASS).length && this.isEditing();\n    },\n    getButtonLocalizationNames: function getButtonLocalizationNames() {\n      var names = this.callBase.apply(this);\n      names.add = \"dxTreeList-editingAddRowToNode\";\n      return names;\n    }\n  };\n}());\n\nvar originalRowClick = _uiGrid_core4.default.extenders.views.rowsView._rowClick;\nvar originalRowDblClick = _uiGrid_core4.default.extenders.views.rowsView._rowDblClick;\n\nvar validateClick = function validateClick(e) {\n  var $targetElement = (0, _renderer2.default)(e.event.target);\n  var originalClickHandler = \"dxdblclick\" === e.event.type ? originalRowDblClick : originalRowClick;\n\n  if ($targetElement.closest(\".\" + SELECT_CHECKBOX_CLASS).length) {\n    return false;\n  }\n\n  return !needToCallOriginalClickHandler.call(this, e, originalClickHandler);\n};\n\nvar needToCallOriginalClickHandler = function needToCallOriginalClickHandler(e, originalClickHandler) {\n  var $targetElement = (0, _renderer2.default)(e.event.target);\n\n  if (!$targetElement.closest(\".\" + TREELIST_EXPAND_ICON_CONTAINER_CLASS).length) {\n    originalClickHandler.call(this, e);\n    return true;\n  }\n\n  return false;\n};\n\nvar RowsViewExtender = (0, _extend.extend)({}, _uiGrid_core4.default.extenders.views.rowsView, {\n  _renderCellCommandContent: function _renderCellCommandContent($container, options) {\n    var editingController = this._editingController;\n    var isEditRow = options.row && editingController.isEditRow(options.row.rowIndex);\n    var isEditing = options.isEditing || isEditRow;\n\n    if (!isEditing) {\n      return this.callBase.apply(this, arguments);\n    }\n\n    return false;\n  },\n  _rowClick: function _rowClick(e) {\n    if (validateClick.call(this, e)) {\n      this.callBase.apply(this, arguments);\n    }\n  },\n  _rowDblClick: function _rowDblClick(e) {\n    if (validateClick.call(this, e)) {\n      this.callBase.apply(this, arguments);\n    }\n  }\n});\n\n_uiTree_list2.default.registerModule(\"editing\", {\n  defaultOptions: function defaultOptions() {\n    return (0, _extend.extend)(true, _uiGrid_core4.default.defaultOptions(), {\n      editing: {\n        texts: {\n          addRowToNode: _message2.default.format(\"dxTreeList-editingAddRowToNode\")\n        }\n      }\n    });\n  },\n  controllers: {\n    editing: EditingController\n  },\n  extenders: {\n    controllers: (0, _extend.extend)(true, {}, _uiGrid_core4.default.extenders.controllers, {\n      data: {\n        changeRowExpand: function changeRowExpand() {\n          this._editingController.refresh();\n\n          return this.callBase.apply(this, arguments);\n        }\n      }\n    }),\n    views: {\n      rowsView: RowsViewExtender,\n      headerPanel: _uiGrid_core4.default.extenders.views.headerPanel\n    }\n  }\n});","map":{"version":3,"sources":["C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/devextreme/ui/tree_list/ui.tree_list.editing.js"],"names":["require","_renderer","_renderer2","_interopRequireDefault","_ui","_ui2","_type","_extend","_deferred","_message","_message2","_uiTree_list","_uiTree_list2","_uiGrid_core","_uiGrid_core2","_uiGrid_core3","_uiGrid_core4","obj","TREELIST_EXPAND_ICON_CONTAINER_CLASS","SELECT_CHECKBOX_CLASS","DATA_EDIT_DATA_INSERT_TYPE","EditingController","_generateNewItem","item","key","_needInsertItem","parentKey","editData","rowIndex","items","_isEditColumnVisible","result","editingOptions","_isDefaultButtonVisible","row","options","button","_getEditingButtons","buttons","_beforeSaveEditData","dataController","store","addRowByRowIndex","addRow","that","callBase","d","setTimeout","_initNewRow","dataSourceAdapter","parentIdSetter","allowAdding","_needToCloseEditableCell","$targetElement","getButtonLocalizationNames","names","originalRowClick","originalRowDblClick","validateClick","e","originalClickHandler","needToCallOriginalClickHandler","RowsViewExtender","_renderCellCommandContent","editingController","isEditRow","isEditing","_rowClick","_rowDblClick","defaultOptions","editing","texts","addRowToNode","controllers","extenders","data","changeRowExpand","views","rowsView","headerPanel"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/tree_list/ui.tree_list.editing.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nrequire(\"./ui.tree_list.editor_factory\");\r\nvar _renderer = require(\"../../core/renderer\");\r\nvar _renderer2 = _interopRequireDefault(_renderer);\r\nvar _ui = require(\"../widget/ui.errors\");\r\nvar _ui2 = _interopRequireDefault(_ui);\r\nvar _type = require(\"../../core/utils/type\");\r\nvar _extend = require(\"../../core/utils/extend\");\r\nvar _deferred = require(\"../../core/utils/deferred\");\r\nvar _message = require(\"../../localization/message\");\r\nvar _message2 = _interopRequireDefault(_message);\r\nvar _uiTree_list = require(\"./ui.tree_list.core\");\r\nvar _uiTree_list2 = _interopRequireDefault(_uiTree_list);\r\nvar _uiGrid_core = require(\"../grid_core/ui.grid_core.utils\");\r\nvar _uiGrid_core2 = _interopRequireDefault(_uiGrid_core);\r\nvar _uiGrid_core3 = require(\"../grid_core/ui.grid_core.editing\");\r\nvar _uiGrid_core4 = _interopRequireDefault(_uiGrid_core3);\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\nvar TREELIST_EXPAND_ICON_CONTAINER_CLASS = \"dx-treelist-icon-container\";\r\nvar SELECT_CHECKBOX_CLASS = \"dx-select-checkbox\";\r\nvar DATA_EDIT_DATA_INSERT_TYPE = \"insert\";\r\nvar EditingController = _uiGrid_core4.default.controllers.editing.inherit(function() {\r\n    return {\r\n        _generateNewItem: function(key) {\r\n            var item = this.callBase(key);\r\n            item.data = {\r\n                key: key\r\n            };\r\n            item.children = [];\r\n            item.level = 0;\r\n            item.parentKey = this.option(\"rootValue\");\r\n            return item\r\n        },\r\n        _needInsertItem: function(editData, changeType, items, item) {\r\n            var parentKey = editData.key.parentKey;\r\n            if (void 0 !== parentKey && parentKey !== this.option(\"rootValue\")) {\r\n                var rowIndex = _uiGrid_core2.default.getIndexByKey(parentKey, items);\r\n                if (rowIndex >= 0 && this._dataController.isRowExpanded(parentKey)) {\r\n                    items.splice(rowIndex + 1, 0, item)\r\n                }\r\n                return false\r\n            }\r\n            return this.callBase.apply(this, arguments)\r\n        },\r\n        _isEditColumnVisible: function() {\r\n            var result = this.callBase.apply(this, arguments);\r\n            var editingOptions = this.option(\"editing\");\r\n            return result || editingOptions && editingOptions.allowAdding\r\n        },\r\n        _isDefaultButtonVisible: function(button, options) {\r\n            var result = this.callBase.apply(this, arguments);\r\n            var row = options.row;\r\n            if (\"add\" === button.name) {\r\n                return this.allowAdding(options) && row.rowIndex !== this._getVisibleEditRowIndex() && !(row.removed || row.isNewRow)\r\n            }\r\n            return result\r\n        },\r\n        _getEditingButtons: function(options) {\r\n            var buttons = this.callBase.apply(this, arguments);\r\n            if (!options.column.buttons) {\r\n                buttons.unshift(this._getButtonConfig(\"add\", options))\r\n            }\r\n            return buttons\r\n        },\r\n        _beforeSaveEditData: function(editData) {\r\n            var key;\r\n            var store;\r\n            var dataController = this._dataController;\r\n            var result = this.callBase.apply(this, arguments);\r\n            if (editData && editData.type !== DATA_EDIT_DATA_INSERT_TYPE) {\r\n                store = dataController && dataController.store();\r\n                key = store && store.key();\r\n                if (!(0, _type.isDefined)(key)) {\r\n                    throw _ui2.default.Error(\"E1045\")\r\n                }\r\n            }\r\n            return result\r\n        },\r\n        addRowByRowIndex: function(rowIndex) {\r\n            var dataController = this.getController(\"data\");\r\n            var row = dataController.getVisibleRows()[rowIndex];\r\n            return this.addRow(row ? row.key : void 0)\r\n        },\r\n        addRow: function(key) {\r\n            var that = this;\r\n            var callBase = that.callBase;\r\n            var dataController = that.getController(\"data\");\r\n            if (void 0 !== key && !dataController.isRowExpanded(key)) {\r\n                var d = new _deferred.Deferred;\r\n                dataController.expandRow(key).done(function() {\r\n                    setTimeout(function() {\r\n                        callBase.call(that, key);\r\n                        d.resolve()\r\n                    })\r\n                }).fail(d.reject);\r\n                return d\r\n            }\r\n            if (void 0 === key) {\r\n                key = that.option(\"rootValue\")\r\n            }\r\n            callBase.call(that, key)\r\n        },\r\n        _initNewRow: function(options, parentKey) {\r\n            var dataController = this.getController(\"data\");\r\n            var dataSourceAdapter = dataController.dataSource();\r\n            var parentIdSetter = dataSourceAdapter.createParentIdSetter();\r\n            parentIdSetter(options.data, parentKey);\r\n            this.callBase.apply(this, arguments)\r\n        },\r\n        allowAdding: function(options) {\r\n            return this._allowEditAction(\"allowAdding\", options)\r\n        },\r\n        _needToCloseEditableCell: function($targetElement) {\r\n            return this.callBase.apply(this, arguments) || $targetElement.closest(\".\" + TREELIST_EXPAND_ICON_CONTAINER_CLASS).length && this.isEditing()\r\n        },\r\n        getButtonLocalizationNames: function() {\r\n            var names = this.callBase.apply(this);\r\n            names.add = \"dxTreeList-editingAddRowToNode\";\r\n            return names\r\n        }\r\n    }\r\n}());\r\nvar originalRowClick = _uiGrid_core4.default.extenders.views.rowsView._rowClick;\r\nvar originalRowDblClick = _uiGrid_core4.default.extenders.views.rowsView._rowDblClick;\r\nvar validateClick = function(e) {\r\n    var $targetElement = (0, _renderer2.default)(e.event.target);\r\n    var originalClickHandler = \"dxdblclick\" === e.event.type ? originalRowDblClick : originalRowClick;\r\n    if ($targetElement.closest(\".\" + SELECT_CHECKBOX_CLASS).length) {\r\n        return false\r\n    }\r\n    return !needToCallOriginalClickHandler.call(this, e, originalClickHandler)\r\n};\r\nvar needToCallOriginalClickHandler = function(e, originalClickHandler) {\r\n    var $targetElement = (0, _renderer2.default)(e.event.target);\r\n    if (!$targetElement.closest(\".\" + TREELIST_EXPAND_ICON_CONTAINER_CLASS).length) {\r\n        originalClickHandler.call(this, e);\r\n        return true\r\n    }\r\n    return false\r\n};\r\nvar RowsViewExtender = (0, _extend.extend)({}, _uiGrid_core4.default.extenders.views.rowsView, {\r\n    _renderCellCommandContent: function($container, options) {\r\n        var editingController = this._editingController;\r\n        var isEditRow = options.row && editingController.isEditRow(options.row.rowIndex);\r\n        var isEditing = options.isEditing || isEditRow;\r\n        if (!isEditing) {\r\n            return this.callBase.apply(this, arguments)\r\n        }\r\n        return false\r\n    },\r\n    _rowClick: function(e) {\r\n        if (validateClick.call(this, e)) {\r\n            this.callBase.apply(this, arguments)\r\n        }\r\n    },\r\n    _rowDblClick: function(e) {\r\n        if (validateClick.call(this, e)) {\r\n            this.callBase.apply(this, arguments)\r\n        }\r\n    }\r\n});\r\n_uiTree_list2.default.registerModule(\"editing\", {\r\n    defaultOptions: function() {\r\n        return (0, _extend.extend)(true, _uiGrid_core4.default.defaultOptions(), {\r\n            editing: {\r\n                texts: {\r\n                    addRowToNode: _message2.default.format(\"dxTreeList-editingAddRowToNode\")\r\n                }\r\n            }\r\n        })\r\n    },\r\n    controllers: {\r\n        editing: EditingController\r\n    },\r\n    extenders: {\r\n        controllers: (0, _extend.extend)(true, {}, _uiGrid_core4.default.extenders.controllers, {\r\n            data: {\r\n                changeRowExpand: function() {\r\n                    this._editingController.refresh();\r\n                    return this.callBase.apply(this, arguments)\r\n                }\r\n            }\r\n        }),\r\n        views: {\r\n            rowsView: RowsViewExtender,\r\n            headerPanel: _uiGrid_core4.default.extenders.views.headerPanel\r\n        }\r\n    }\r\n});\r\n"]},"metadata":{},"sourceType":"module"}