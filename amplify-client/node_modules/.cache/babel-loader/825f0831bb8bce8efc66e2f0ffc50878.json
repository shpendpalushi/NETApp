{"ast":null,"code":"/**\r\n * DevExtreme (ui/color_box/color_view.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar $ = require(\"../../core/renderer\");\n\nvar eventsEngine = require(\"../../events/core/events_engine\");\n\nvar translator = require(\"../../animation/translator\");\n\nvar extend = require(\"../../core/utils/extend\").extend;\n\nvar Color = require(\"../../color\");\n\nvar messageLocalization = require(\"../../localization/message\");\n\nvar devices = require(\"../../core/devices\");\n\nvar registerComponent = require(\"../../core/component_registrator\");\n\nvar Editor = require(\"../editor/editor\");\n\nvar NumberBox = require(\"../number_box\");\n\nvar TextBox = require(\"../text_box\");\n\nvar Draggable = require(\"../draggable\");\n\nvar clickEvent = require(\"../../events/click\");\n\nvar COLOR_VIEW_CLASS = \"dx-colorview\";\nvar COLOR_VIEW_CONTAINER_CLASS = \"dx-colorview-container\";\nvar COLOR_VIEW_ROW_CLASS = \"dx-colorview-container-row\";\nvar COLOR_VIEW_CELL_CLASS = \"dx-colorview-container-cell\";\nvar COLOR_VIEW_PALETTE_CLASS = \"dx-colorview-palette\";\nvar COLOR_VIEW_PALETTE_CELL_CLASS = \"dx-colorview-palette-cell\";\nvar COLOR_VIEW_PALETTE_HANDLE_CLASS = \"dx-colorview-palette-handle\";\nvar COLOR_VIEW_PALETTE_GRADIENT_CLASS = \"dx-colorview-palette-gradient\";\nvar COLOR_VIEW_PALETTE_GRADIENT_WHITE_CLASS = \"dx-colorview-palette-gradient-white\";\nvar COLOR_VIEW_PALETTE_GRADIENT_BLACK_CLASS = \"dx-colorview-palette-gradient-black\";\nvar COLOR_VIEW_HUE_SCALE_CLASS = \"dx-colorview-hue-scale\";\nvar COLOR_VIEW_HUE_SCALE_CELL_CLASS = \"dx-colorview-hue-scale-cell\";\nvar COLOR_VIEW_HUE_SCALE_HANDLE_CLASS = \"dx-colorview-hue-scale-handle\";\nvar COLOR_VIEW_HUE_SCALE_WRAPPER_CLASS = \"dx-colorview-hue-scale-wrapper\";\nvar COLOR_VIEW_CONTROLS_CONTAINER_CLASS = \"dx-colorview-controls-container\";\nvar COLOR_VIEW_RED_LABEL_CLASS = \"dx-colorview-label-red\";\nvar COLOR_VIEW_GREEN_LABEL_CLASS = \"dx-colorview-label-green\";\nvar COLOR_VIEW_BLUE_LABEL_CLASS = \"dx-colorview-label-blue\";\nvar COLOR_VIEW_HEX_LABEL_CLASS = \"dx-colorview-label-hex\";\nvar COLOR_VIEW_ALPHA_CHANNEL_SCALE_CLASS = \"dx-colorview-alpha-channel-scale\";\nvar COLOR_VIEW_APLHA_CHANNEL_ROW_CLASS = \"dx-colorview-alpha-channel-row\";\nvar COLOR_VIEW_ALPHA_CHANNEL_SCALE_WRAPPER_CLASS = \"dx-colorview-alpha-channel-wrapper\";\nvar COLOR_VIEW_ALPHA_CHANNEL_LABEL_CLASS = \"dx-colorview-alpha-channel-label\";\nvar COLOR_VIEW_ALPHA_CHANNEL_HANDLE_CLASS = \"dx-colorview-alpha-channel-handle\";\nvar COLOR_VIEW_ALPHA_CHANNEL_CELL_CLASS = \"dx-colorview-alpha-channel-cell\";\nvar COLOR_VIEW_ALPHA_CHANNEL_BORDER_CLASS = \"dx-colorview-alpha-channel-border\";\nvar COLOR_VIEW_COLOR_PREVIEW = \"dx-colorview-color-preview\";\nvar COLOR_VIEW_COLOR_PREVIEW_CONTAINER_CLASS = \"dx-colorview-color-preview-container\";\nvar COLOR_VIEW_COLOR_PREVIEW_CONTAINER_INNER_CLASS = \"dx-colorview-color-preview-container-inner\";\nvar COLOR_VIEW_COLOR_PREVIEW_COLOR_CURRENT = \"dx-colorview-color-preview-color-current\";\nvar COLOR_VIEW_COLOR_PREVIEW_COLOR_NEW = \"dx-colorview-color-preview-color-new\";\nvar ColorView = Editor.inherit({\n  _supportedKeys: function _supportedKeys() {\n    var isRTL = this.option(\"rtlEnabled\");\n    var that = this;\n\n    var getHorizontalPaletteStep = function getHorizontalPaletteStep(e) {\n      var step = 100 / that._paletteWidth;\n\n      if (e.shiftKey) {\n        step *= that.option(\"keyStep\");\n      }\n\n      step = step > 1 ? step : 1;\n      return Math.round(step);\n    };\n\n    var updateHorizontalPaletteValue = function updateHorizontalPaletteValue(step) {\n      var value = that._currentColor.hsv.s + step;\n\n      if (value > 100) {\n        value = 100;\n      } else {\n        if (value < 0) {\n          value = 0;\n        }\n      }\n\n      that._currentColor.hsv.s = value;\n      updatePaletteValue();\n    };\n\n    var getVerticalPaletteStep = function getVerticalPaletteStep(e) {\n      var step = 100 / that._paletteHeight;\n\n      if (e.shiftKey) {\n        step *= that.option(\"keyStep\");\n      }\n\n      step = step > 1 ? step : 1;\n      return Math.round(step);\n    };\n\n    var updateVerticalPaletteValue = function updateVerticalPaletteValue(step) {\n      var value = that._currentColor.hsv.v + step;\n\n      if (value > 100) {\n        value = 100;\n      } else {\n        if (value < 0) {\n          value = 0;\n        }\n      }\n\n      that._currentColor.hsv.v = value;\n      updatePaletteValue();\n    };\n\n    var updatePaletteValue = function updatePaletteValue() {\n      that._placePaletteHandle();\n\n      that._updateColorFromHsv(that._currentColor.hsv.h, that._currentColor.hsv.s, that._currentColor.hsv.v);\n    };\n\n    var getHueScaleStep = function getHueScaleStep(e) {\n      var step = 360 / (that._hueScaleWrapperHeight - that._hueScaleHandleHeight);\n\n      if (e.shiftKey) {\n        step *= that.option(\"keyStep\");\n      }\n\n      step = step > 1 ? step : 1;\n      return step;\n    };\n\n    var updateHueScaleValue = function updateHueScaleValue(step) {\n      that._currentColor.hsv.h += step;\n\n      that._placeHueScaleHandle();\n\n      var handleLocation = translator.locate(that._$hueScaleHandle);\n\n      that._updateColorHue(handleLocation.top + that._hueScaleHandleHeight / 2);\n    };\n\n    var getAlphaScaleStep = function getAlphaScaleStep(e) {\n      var step = 1 / that._alphaChannelScaleWorkWidth;\n\n      if (e.shiftKey) {\n        step *= that.option(\"keyStep\");\n      }\n\n      step = step > .01 ? step : .01;\n      step = isRTL ? -step : step;\n      return step;\n    };\n\n    var updateAlphaScaleValue = function updateAlphaScaleValue(step) {\n      that._currentColor.a += step;\n\n      that._placeAlphaChannelHandle();\n\n      var handleLocation = translator.locate(that._$alphaChannelHandle);\n\n      that._calculateColorTransparencyByScaleWidth(handleLocation.left + that._alphaChannelHandleWidth / 2);\n    };\n\n    return extend(this.callBase(), {\n      upArrow: function upArrow(e) {\n        e.preventDefault();\n        e.stopPropagation();\n\n        if (e.ctrlKey) {\n          if (this._currentColor.hsv.h <= 360 && !this._isTopColorHue) {\n            updateHueScaleValue(getHueScaleStep(e));\n          }\n        } else {\n          if (this._currentColor.hsv.v < 100) {\n            updateVerticalPaletteValue(getVerticalPaletteStep(e));\n          }\n        }\n      },\n      downArrow: function downArrow(e) {\n        e.preventDefault();\n        e.stopPropagation();\n\n        if (e.ctrlKey) {\n          if (this._currentColor.hsv.h >= 0) {\n            if (this._isTopColorHue) {\n              this._currentColor.hsv.h = 360;\n            }\n\n            updateHueScaleValue(-getHueScaleStep(e));\n          }\n        } else {\n          if (this._currentColor.hsv.v > 0) {\n            updateVerticalPaletteValue(-getVerticalPaletteStep(e));\n          }\n        }\n      },\n      rightArrow: function rightArrow(e) {\n        e.preventDefault();\n        e.stopPropagation();\n\n        if (e.ctrlKey) {\n          if (isRTL ? this._currentColor.a < 1 : this._currentColor.a > 0 && this.option(\"editAlphaChannel\")) {\n            updateAlphaScaleValue(-getAlphaScaleStep(e));\n          }\n        } else {\n          if (this._currentColor.hsv.s < 100) {\n            updateHorizontalPaletteValue(getHorizontalPaletteStep(e));\n          }\n        }\n      },\n      leftArrow: function leftArrow(e) {\n        e.preventDefault();\n        e.stopPropagation();\n\n        if (e.ctrlKey) {\n          if (isRTL ? this._currentColor.a > 0 : this._currentColor.a < 1 && this.option(\"editAlphaChannel\")) {\n            updateAlphaScaleValue(getAlphaScaleStep(e));\n          }\n        } else {\n          if (this._currentColor.hsv.s > 0) {\n            updateHorizontalPaletteValue(-getHorizontalPaletteStep(e));\n          }\n        }\n      },\n      enter: function enter(e) {\n        this._fireEnterKeyPressed(e);\n      }\n    });\n  },\n  _getDefaultOptions: function _getDefaultOptions() {\n    return extend(this.callBase(), {\n      value: null,\n      matchValue: null,\n      onEnterKeyPressed: void 0,\n      editAlphaChannel: false,\n      keyStep: 1,\n      stylingMode: void 0\n    });\n  },\n  _defaultOptionsRules: function _defaultOptionsRules() {\n    return this.callBase().concat([{\n      device: function device() {\n        return \"desktop\" === devices.real().deviceType && !devices.isSimulator();\n      },\n      options: {\n        focusStateEnabled: true\n      }\n    }]);\n  },\n  _init: function _init() {\n    this.callBase();\n\n    this._initColorAndOpacity();\n\n    this._initEnterKeyPressedAction();\n  },\n  _initEnterKeyPressedAction: function _initEnterKeyPressedAction() {\n    this._onEnterKeyPressedAction = this._createActionByOption(\"onEnterKeyPressed\");\n  },\n  _fireEnterKeyPressed: function _fireEnterKeyPressed(e) {\n    if (!this._onEnterKeyPressedAction) {\n      return;\n    }\n\n    this._onEnterKeyPressedAction({\n      event: e\n    });\n  },\n  _initColorAndOpacity: function _initColorAndOpacity() {\n    this._setCurrentColor(this.option(\"value\"));\n  },\n  _setCurrentColor: function _setCurrentColor(value) {\n    value = value || \"#000000\";\n    var newColor = new Color(value);\n\n    if (!newColor.colorIsInvalid) {\n      if (!this._currentColor || this._makeRgba(this._currentColor) !== this._makeRgba(newColor)) {\n        this._currentColor = newColor;\n\n        if (this._$currentColor) {\n          this._makeTransparentBackground(this._$currentColor, newColor);\n        }\n      }\n    } else {\n      this.option(\"value\", this._currentColor.baseColor);\n    }\n  },\n  _setBaseColor: function _setBaseColor(value) {\n    var color = value || \"#000000\";\n    var newColor = new Color(color);\n\n    if (!newColor.colorIsInvalid) {\n      var isBaseColorChanged = this._makeRgba(this.option(\"matchValue\") !== this._makeRgba(newColor));\n\n      if (isBaseColorChanged) {\n        if (this._$baseColor) {\n          this._makeTransparentBackground(this._$baseColor, newColor);\n        }\n      }\n    }\n  },\n  _initMarkup: function _initMarkup() {\n    this.callBase();\n    this.$element().addClass(COLOR_VIEW_CLASS);\n\n    this._renderColorPickerContainer();\n  },\n  _render: function _render() {\n    this.callBase();\n\n    this._renderPalette();\n\n    this._renderHueScale();\n\n    this._renderControlsContainer();\n\n    this._renderControls();\n\n    this._renderAlphaChannelElements();\n  },\n  _makeTransparentBackground: function _makeTransparentBackground($el, color) {\n    if (!(color instanceof Color)) {\n      color = new Color(color);\n    }\n\n    $el.css(\"backgroundColor\", this._makeRgba(color));\n  },\n  _makeRgba: function _makeRgba(color) {\n    if (!(color instanceof Color)) {\n      color = new Color(color);\n    }\n\n    return \"rgba(\" + [color.r, color.g, color.b, color.a].join(\", \") + \")\";\n  },\n  _renderValue: function _renderValue() {\n    this.callBase(this.option(\"editAlphaChannel\") ? this._makeRgba(this._currentColor) : this.option(\"value\"));\n  },\n  _renderColorPickerContainer: function _renderColorPickerContainer() {\n    var $parent = this.$element();\n    this._$colorPickerContainer = $(\"<div>\").addClass(COLOR_VIEW_CONTAINER_CLASS).appendTo($parent);\n\n    this._renderHtmlRows();\n  },\n  _renderHtmlRows: function _renderHtmlRows(updatedOption) {\n    var $renderedRows = this._$colorPickerContainer.find(\".\" + COLOR_VIEW_ROW_CLASS);\n\n    var renderedRowsCount = $renderedRows.length;\n    var rowCount = this.option(\"editAlphaChannel\") ? 2 : 1;\n    var delta = renderedRowsCount - rowCount;\n\n    if (delta > 0) {\n      $renderedRows.eq(-1).remove();\n    }\n\n    if (delta < 0) {\n      delta = Math.abs(delta);\n      var rows = [];\n      var i;\n\n      for (i = 0; i < delta; i++) {\n        rows.push($(\"<div>\").addClass(COLOR_VIEW_ROW_CLASS));\n      }\n\n      if (renderedRowsCount) {\n        for (i = 0; i < rows.length; i++) {\n          $renderedRows.eq(0).after(rows[i]);\n        }\n      } else {\n        this._$colorPickerContainer.append(rows);\n      }\n    }\n  },\n  _renderHtmlCellInsideRow: function _renderHtmlCellInsideRow(index, $rowParent, additionalClass) {\n    return $(\"<div>\").addClass(COLOR_VIEW_CELL_CLASS).addClass(additionalClass).appendTo($rowParent.find(\".\" + COLOR_VIEW_ROW_CLASS).eq(index));\n  },\n  _renderPalette: function _renderPalette() {\n    var $paletteCell = this._renderHtmlCellInsideRow(0, this._$colorPickerContainer, COLOR_VIEW_PALETTE_CELL_CLASS);\n\n    var $paletteGradientWhite = $(\"<div>\").addClass([COLOR_VIEW_PALETTE_GRADIENT_CLASS, COLOR_VIEW_PALETTE_GRADIENT_WHITE_CLASS].join(\" \"));\n    var $paletteGradientBlack = $(\"<div>\").addClass([COLOR_VIEW_PALETTE_GRADIENT_CLASS, COLOR_VIEW_PALETTE_GRADIENT_BLACK_CLASS].join(\" \"));\n    this._$palette = $(\"<div>\").addClass(COLOR_VIEW_PALETTE_CLASS).css(\"backgroundColor\", this._currentColor.getPureColor().toHex()).appendTo($paletteCell);\n    this._paletteHeight = this._$palette.height();\n    this._paletteWidth = this._$palette.width();\n\n    this._renderPaletteHandle();\n\n    this._$palette.append([$paletteGradientWhite, $paletteGradientBlack]);\n  },\n  _renderPaletteHandle: function _renderPaletteHandle() {\n    this._$paletteHandle = $(\"<div>\").addClass(COLOR_VIEW_PALETTE_HANDLE_CLASS).appendTo(this._$palette);\n\n    this._createComponent(this._$paletteHandle, Draggable, {\n      contentTemplate: null,\n      boundary: this._$palette,\n      allowMoveByClick: true,\n      boundOffset: function () {\n        return -this._paletteHandleHeight / 2;\n      }.bind(this),\n      onDragMove: function () {\n        var paletteHandlePosition = translator.locate(this._$paletteHandle);\n        this._updateByDrag = true;\n\n        this._updateColorFromHsv(this._currentColor.hsv.h, this._calculateColorSaturation(paletteHandlePosition), this._calculateColorValue(paletteHandlePosition));\n      }.bind(this)\n    });\n\n    this._paletteHandleWidth = this._$paletteHandle.width();\n    this._paletteHandleHeight = this._$paletteHandle.height();\n\n    this._placePaletteHandle();\n  },\n  _placePaletteHandle: function _placePaletteHandle() {\n    translator.move(this._$paletteHandle, {\n      left: Math.round(this._paletteWidth * this._currentColor.hsv.s / 100 - this._paletteHandleWidth / 2),\n      top: Math.round(this._paletteHeight - this._paletteHeight * this._currentColor.hsv.v / 100 - this._paletteHandleHeight / 2)\n    });\n  },\n  _calculateColorValue: function _calculateColorValue(paletteHandlePosition) {\n    var value = Math.floor(paletteHandlePosition.top + this._paletteHandleHeight / 2);\n    return 100 - Math.round(100 * value / this._paletteHeight);\n  },\n  _calculateColorSaturation: function _calculateColorSaturation(paletteHandlePosition) {\n    var saturation = Math.floor(paletteHandlePosition.left + this._paletteHandleWidth / 2);\n    return Math.round(100 * saturation / this._paletteWidth);\n  },\n  _updateColorFromHsv: function _updateColorFromHsv(hue, saturation, value) {\n    var a = this._currentColor.a;\n    this._currentColor = new Color(\"hsv(\" + [hue, saturation, value].join(\",\") + \")\");\n    this._currentColor.a = a;\n\n    this._updateColorParamsAndColorPreview();\n\n    this.applyColor();\n  },\n  _renderHueScale: function _renderHueScale() {\n    var $hueScaleCell = this._renderHtmlCellInsideRow(0, this._$colorPickerContainer, COLOR_VIEW_HUE_SCALE_CELL_CLASS);\n\n    this._$hueScaleWrapper = $(\"<div>\").addClass(COLOR_VIEW_HUE_SCALE_WRAPPER_CLASS).appendTo($hueScaleCell);\n    this._$hueScale = $(\"<div>\").addClass(COLOR_VIEW_HUE_SCALE_CLASS).appendTo(this._$hueScaleWrapper);\n    this._hueScaleHeight = this._$hueScale.height();\n    this._hueScaleWrapperHeight = this._$hueScaleWrapper.outerHeight();\n\n    this._renderHueScaleHandle();\n  },\n  _renderHueScaleHandle: function _renderHueScaleHandle() {\n    this._$hueScaleHandle = $(\"<div>\").addClass(COLOR_VIEW_HUE_SCALE_HANDLE_CLASS).appendTo(this._$hueScaleWrapper);\n\n    this._createComponent(this._$hueScaleHandle, Draggable, {\n      contentTemplate: null,\n      boundary: this._$hueScaleWrapper,\n      allowMoveByClick: true,\n      dragDirection: \"vertical\",\n      onDragMove: function () {\n        this._updateByDrag = true;\n\n        this._updateColorHue(translator.locate(this._$hueScaleHandle).top + this._hueScaleHandleHeight / 2);\n      }.bind(this)\n    });\n\n    this._hueScaleHandleHeight = this._$hueScaleHandle.height();\n\n    this._placeHueScaleHandle();\n  },\n  _placeHueScaleHandle: function _placeHueScaleHandle() {\n    var hueScaleHeight = this._hueScaleWrapperHeight;\n    var handleHeight = this._hueScaleHandleHeight;\n    var top = (hueScaleHeight - handleHeight) * (360 - this._currentColor.hsv.h) / 360;\n\n    if (hueScaleHeight < top + handleHeight) {\n      top = hueScaleHeight - handleHeight;\n    }\n\n    if (top < 0) {\n      top = 0;\n    }\n\n    translator.move(this._$hueScaleHandle, {\n      top: Math.round(top)\n    });\n  },\n  _updateColorHue: function _updateColorHue(handlePosition) {\n    var hue = 360 - Math.round(360 * (handlePosition - this._hueScaleHandleHeight / 2) / (this._hueScaleWrapperHeight - this._hueScaleHandleHeight));\n    var saturation = this._currentColor.hsv.s;\n    var value = this._currentColor.hsv.v;\n    this._isTopColorHue = false;\n    hue = hue < 0 ? 0 : hue;\n\n    if (hue >= 360) {\n      this._isTopColorHue = true;\n      hue = 0;\n    }\n\n    this._updateColorFromHsv(hue, saturation, value);\n\n    this._$palette.css(\"backgroundColor\", this._currentColor.getPureColor().toHex());\n  },\n  _renderControlsContainer: function _renderControlsContainer() {\n    var $controlsContainerCell = this._renderHtmlCellInsideRow(0, this._$colorPickerContainer);\n\n    this._$controlsContainer = $(\"<div>\").addClass(COLOR_VIEW_CONTROLS_CONTAINER_CLASS).appendTo($controlsContainerCell);\n  },\n  _renderControls: function _renderControls() {\n    this._renderColorsPreview();\n\n    this._renderRgbInputs();\n\n    this._renderHexInput();\n  },\n  _renderColorsPreview: function _renderColorsPreview() {\n    var $colorsPreviewContainer = $(\"<div>\").addClass(COLOR_VIEW_COLOR_PREVIEW_CONTAINER_CLASS).appendTo(this._$controlsContainer);\n    var $colorsPreviewContainerInner = $(\"<div>\").addClass(COLOR_VIEW_COLOR_PREVIEW_CONTAINER_INNER_CLASS).appendTo($colorsPreviewContainer);\n    this._$currentColor = $(\"<div>\").addClass([COLOR_VIEW_COLOR_PREVIEW, COLOR_VIEW_COLOR_PREVIEW_COLOR_NEW].join(\" \"));\n    this._$baseColor = $(\"<div>\").addClass([COLOR_VIEW_COLOR_PREVIEW, COLOR_VIEW_COLOR_PREVIEW_COLOR_CURRENT].join(\" \"));\n\n    this._makeTransparentBackground(this._$baseColor, this.option(\"matchValue\"));\n\n    this._makeTransparentBackground(this._$currentColor, this._currentColor);\n\n    $colorsPreviewContainerInner.append([this._$baseColor, this._$currentColor]);\n  },\n  _renderAlphaChannelElements: function _renderAlphaChannelElements() {\n    if (this.option(\"editAlphaChannel\")) {\n      this._$colorPickerContainer.find(\".\" + COLOR_VIEW_ROW_CLASS).eq(1).addClass(COLOR_VIEW_APLHA_CHANNEL_ROW_CLASS);\n\n      this._renderAlphaChannelScale();\n\n      this._renderAlphaChannelInput();\n    }\n  },\n  _renderRgbInputs: function _renderRgbInputs() {\n    this._rgbInputsWithLabels = [this._renderEditorWithLabel({\n      editorType: NumberBox,\n      value: this._currentColor.r,\n      onValueChanged: this._updateColor.bind(this, false),\n      labelText: \"R\",\n      labelAriaText: messageLocalization.format(\"dxColorView-ariaRed\"),\n      labelClass: COLOR_VIEW_RED_LABEL_CLASS\n    }), this._renderEditorWithLabel({\n      editorType: NumberBox,\n      value: this._currentColor.g,\n      onValueChanged: this._updateColor.bind(this, false),\n      labelText: \"G\",\n      labelAriaText: messageLocalization.format(\"dxColorView-ariaGreen\"),\n      labelClass: COLOR_VIEW_GREEN_LABEL_CLASS\n    }), this._renderEditorWithLabel({\n      editorType: NumberBox,\n      value: this._currentColor.b,\n      onValueChanged: this._updateColor.bind(this, false),\n      labelText: \"B\",\n      labelAriaText: messageLocalization.format(\"dxColorView-ariaBlue\"),\n      labelClass: COLOR_VIEW_BLUE_LABEL_CLASS\n    })];\n\n    this._$controlsContainer.append(this._rgbInputsWithLabels);\n\n    this._rgbInputs = [this._rgbInputsWithLabels[0].find(\".dx-numberbox\").dxNumberBox(\"instance\"), this._rgbInputsWithLabels[1].find(\".dx-numberbox\").dxNumberBox(\"instance\"), this._rgbInputsWithLabels[2].find(\".dx-numberbox\").dxNumberBox(\"instance\")];\n  },\n  _renderEditorWithLabel: function _renderEditorWithLabel(options) {\n    var $editor = $(\"<div>\");\n    var $label = $(\"<label>\").addClass(options.labelClass).text(options.labelText + \":\").append($editor);\n    eventsEngine.off($label, clickEvent.name);\n    eventsEngine.on($label, clickEvent.name, function (e) {\n      e.preventDefault();\n    });\n    var editorType = options.editorType;\n    var editorOptions = extend({\n      value: options.value,\n      onValueChanged: options.onValueChanged\n    }, {\n      stylingMode: this.option(\"stylingMode\")\n    });\n\n    if (editorType === NumberBox) {\n      editorOptions.min = options.min || 0;\n      editorOptions.max = options.max || 255;\n      editorOptions.step = options.step || 1;\n    }\n\n    var editor = new editorType($editor, editorOptions);\n\n    this._attachKeyboardProcessorToEditor(editor);\n\n    editor.registerKeyHandler(\"enter\", function (e) {\n      this._fireEnterKeyPressed(e);\n    }.bind(this));\n    this.setAria(\"label\", options.labelAriaText, $editor);\n    return $label;\n  },\n  _attachKeyboardProcessorToEditor: function _attachKeyboardProcessorToEditor(editor) {\n    var keyboardProcessor = editor._keyboardProcessor;\n\n    if (keyboardProcessor) {\n      keyboardProcessor.attachChildProcessor().reinitialize(this._keyboardHandler, this);\n    }\n  },\n  hexInputOptions: function hexInputOptions() {\n    return {\n      editorType: TextBox,\n      value: this._currentColor.toHex().replace(\"#\", \"\"),\n      onValueChanged: this._updateColor.bind(this, true),\n      labelClass: COLOR_VIEW_HEX_LABEL_CLASS,\n      labelText: \"#\",\n      labelAriaText: messageLocalization.format(\"dxColorView-ariaHex\")\n    };\n  },\n  _renderHexInput: function _renderHexInput() {\n    this._hexInput = TextBox.getInstance(this._renderEditorWithLabel(this.hexInputOptions()).appendTo(this._$controlsContainer).find(\".dx-textbox\"));\n  },\n  _renderAlphaChannelScale: function _renderAlphaChannelScale() {\n    var $alphaChannelScaleCell = this._renderHtmlCellInsideRow(1, this._$colorPickerContainer, COLOR_VIEW_ALPHA_CHANNEL_CELL_CLASS);\n\n    var $alphaChannelBorder = $(\"<div>\").addClass(COLOR_VIEW_ALPHA_CHANNEL_BORDER_CLASS).appendTo($alphaChannelScaleCell);\n    var $alphaChannelScaleWrapper = $(\"<div>\").addClass(COLOR_VIEW_ALPHA_CHANNEL_SCALE_WRAPPER_CLASS).appendTo($alphaChannelBorder);\n    this._$alphaChannelScale = $(\"<div>\").addClass(COLOR_VIEW_ALPHA_CHANNEL_SCALE_CLASS).appendTo($alphaChannelScaleWrapper);\n\n    this._makeCSSLinearGradient(this._$alphaChannelScale);\n\n    this._renderAlphaChannelHandle($alphaChannelScaleCell);\n  },\n  _makeCSSLinearGradient: function _makeCSSLinearGradient($el) {\n    var color = this._currentColor;\n    var colorAsRgb = [color.r, color.g, color.b].join(\",\");\n    var colorAsHex = color.toHex().replace(\"#\", \"\");\n\n    var combineGradientString = function combineGradientString(colorAsRgb, colorAsHex) {\n      var rtlEnabled = this.option(\"rtlEnabled\");\n      var startColor = \"rgba(\" + colorAsRgb + \", \" + (rtlEnabled ? \"1\" : \"0\") + \")\";\n      var finishColor = \"rgba(\" + colorAsRgb + \", \" + (rtlEnabled ? \"0\" : \"1\") + \")\";\n      var startColorIE = \"'#\" + (rtlEnabled ? \"00\" : \"\") + colorAsHex + \"'\";\n      var finishColorIE = \"'#\" + (rtlEnabled ? \"\" : \"00\") + colorAsHex + \"'\";\n      return [\"background-image: -webkit-linear-gradient(180deg, \" + startColor + \", \" + finishColor + \")\", \"background-image: -moz-linear-gradient(-90deg, \" + startColor + \", \" + finishColor + \")\", \"background-image: -o-linear-gradient(-90deg, \" + startColor + \", \" + finishColor + \")\", \"background-image: linear-gradient(-90deg, \" + startColor + \", \" + finishColor + \")\", \"filter: progid:DXImageTransform.Microsoft.gradient(GradientType=1,startColorstr=\" + startColorIE + \", endColorstr=\" + finishColorIE + \")\"].join(\";\");\n    };\n\n    $el.attr(\"style\", combineGradientString.call(this, colorAsRgb, colorAsHex));\n  },\n  _renderAlphaChannelInput: function _renderAlphaChannelInput() {\n    var that = this;\n\n    var $alphaChannelInputCell = this._renderHtmlCellInsideRow(1, this._$colorPickerContainer);\n\n    that._alphaChannelInput = this._renderEditorWithLabel({\n      editorType: NumberBox,\n      value: this._currentColor.a,\n      max: 1,\n      step: .1,\n      onValueChanged: function onValueChanged(e) {\n        var value = e.value;\n        value = that._currentColor.isValidAlpha(value) ? value : that._currentColor.a;\n\n        that._updateColorTransparency(value);\n\n        that._placeAlphaChannelHandle();\n      },\n      labelClass: COLOR_VIEW_ALPHA_CHANNEL_LABEL_CLASS,\n      labelText: \"Alpha\",\n      labelAriaText: messageLocalization.format(\"dxColorView-ariaAlpha\")\n    }).appendTo($alphaChannelInputCell).find(\".dx-numberbox\").dxNumberBox(\"instance\");\n  },\n  _updateColorTransparency: function _updateColorTransparency(transparency) {\n    this._currentColor.a = transparency;\n    this.applyColor();\n  },\n  _renderAlphaChannelHandle: function _renderAlphaChannelHandle($parent) {\n    this._$alphaChannelHandle = $(\"<div>\").addClass(COLOR_VIEW_ALPHA_CHANNEL_HANDLE_CLASS).appendTo($parent);\n\n    this._createComponent(this._$alphaChannelHandle, Draggable, {\n      contentTemplate: null,\n      boundary: $parent,\n      allowMoveByClick: true,\n      dragDirection: \"horizontal\",\n      onDragMove: function () {\n        this._updateByDrag = true;\n        var $alphaChannelHandle = this._$alphaChannelHandle;\n        var alphaChannelHandlePosition = translator.locate($alphaChannelHandle).left + this._alphaChannelHandleWidth / 2;\n\n        this._calculateColorTransparencyByScaleWidth(alphaChannelHandlePosition);\n      }.bind(this)\n    });\n\n    this._alphaChannelHandleWidth = this._$alphaChannelHandle.width();\n    this._alphaChannelScaleWorkWidth = $parent.width() - this._alphaChannelHandleWidth;\n\n    this._placeAlphaChannelHandle();\n  },\n  _calculateColorTransparencyByScaleWidth: function _calculateColorTransparencyByScaleWidth(handlePosition) {\n    var transparency = (handlePosition - this._alphaChannelHandleWidth / 2) / this._alphaChannelScaleWorkWidth;\n    var rtlEnabled = this.option(\"rtlEnabled\");\n    transparency = rtlEnabled ? transparency : 1 - transparency;\n\n    if (handlePosition >= this._alphaChannelScaleWorkWidth + this._alphaChannelHandleWidth / 2) {\n      transparency = rtlEnabled ? 1 : 0;\n    } else {\n      if (transparency < 1) {\n        transparency = transparency.toFixed(2);\n      }\n    }\n\n    transparency = Math.max(transparency, 0);\n    transparency = Math.min(transparency, 1);\n\n    this._alphaChannelInput.option(\"value\", transparency);\n  },\n  _placeAlphaChannelHandle: function _placeAlphaChannelHandle() {\n    var left = this._alphaChannelScaleWorkWidth * (1 - this._currentColor.a);\n\n    if (left < 0) {\n      left = 0;\n    }\n\n    if (this._alphaChannelScaleWorkWidth < left) {\n      left = this._alphaChannelScaleWorkWidth;\n    }\n\n    translator.move(this._$alphaChannelHandle, {\n      left: this.option(\"rtlEnabled\") ? this._alphaChannelScaleWorkWidth - left : left\n    });\n  },\n  applyColor: function applyColor() {\n    var colorValue = this.option(\"editAlphaChannel\") ? this._makeRgba(this._currentColor) : this._currentColor.toHex();\n\n    this._makeTransparentBackground(this._$currentColor, this._currentColor);\n\n    this.option(\"value\", colorValue);\n  },\n  cancelColor: function cancelColor() {\n    this._initColorAndOpacity();\n\n    this._refreshMarkup();\n  },\n  _updateColor: function _updateColor(isHex, e) {\n    var rgba;\n    var newColor;\n\n    if (isHex) {\n      newColor = this._validateHex(\"#\" + this._hexInput.option(\"value\"));\n    } else {\n      rgba = this._validateRgb();\n\n      if (this._alphaChannelInput) {\n        rgba.push(this._alphaChannelInput.option(\"value\"));\n        newColor = \"rgba(\" + rgba.join(\", \") + \")\";\n      } else {\n        newColor = \"rgb(\" + rgba.join(\", \") + \")\";\n      }\n    }\n\n    if (!this._suppressEditorsValueUpdating) {\n      this._currentColor = new Color(newColor);\n      this.applyColor();\n\n      this._refreshMarkup();\n    }\n  },\n  _validateHex: function _validateHex(hex) {\n    return this._currentColor.isValidHex(hex) ? hex : this._currentColor.toHex();\n  },\n  _validateRgb: function _validateRgb() {\n    var r = this._rgbInputs[0].option(\"value\");\n\n    var g = this._rgbInputs[1].option(\"value\");\n\n    var b = this._rgbInputs[2].option(\"value\");\n\n    if (!this._currentColor.isValidRGB(r, g, b)) {\n      r = this._currentColor.r;\n      g = this._currentColor.g;\n      b = this._currentColor.b;\n    }\n\n    return [r, g, b];\n  },\n  _refreshMarkup: function _refreshMarkup() {\n    this._placeHueScaleHandle();\n\n    this._placePaletteHandle();\n\n    this._updateColorParamsAndColorPreview();\n\n    this._$palette.css(\"backgroundColor\", this._currentColor.getPureColor().toHex());\n\n    if (this._$alphaChannelHandle) {\n      this._updateColorTransparency(this._currentColor.a);\n\n      this._placeAlphaChannelHandle();\n    }\n  },\n  _updateColorParamsAndColorPreview: function _updateColorParamsAndColorPreview() {\n    this._suppressEditorsValueUpdating = true;\n\n    this._hexInput.option(\"value\", this._currentColor.toHex().replace(\"#\", \"\"));\n\n    this._rgbInputs[0].option(\"value\", this._currentColor.r);\n\n    this._rgbInputs[1].option(\"value\", this._currentColor.g);\n\n    this._rgbInputs[2].option(\"value\", this._currentColor.b);\n\n    this._suppressEditorsValueUpdating = false;\n\n    if (this.option(\"editAlphaChannel\")) {\n      this._makeCSSLinearGradient.call(this, this._$alphaChannelScale);\n\n      this._alphaChannelInput.option(\"value\", this._currentColor.a);\n    }\n  },\n  _optionChanged: function _optionChanged(args) {\n    var value = args.value;\n\n    switch (args.name) {\n      case \"value\":\n        this._setCurrentColor(value);\n\n        if (!this._updateByDrag) {\n          this._refreshMarkup();\n        }\n\n        this._updateByDrag = false;\n        this.callBase(args);\n        break;\n\n      case \"matchValue\":\n        this._setBaseColor(value);\n\n        break;\n\n      case \"onEnterKeyPressed\":\n        this._initEnterKeyPressedAction();\n\n        break;\n\n      case \"editAlphaChannel\":\n        if (this._$colorPickerContainer) {\n          this._renderHtmlRows(\"editAlphaChannel\");\n\n          this._renderAlphaChannelElements();\n        }\n\n        break;\n\n      case \"keyStep\":\n        break;\n\n      case \"stylingMode\":\n        this._renderControls();\n\n        break;\n\n      default:\n        this.callBase(args);\n    }\n  }\n});\nregisterComponent(\"dxColorView\", ColorView);\nmodule.exports = ColorView;","map":{"version":3,"sources":["C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/devextreme/ui/color_box/color_view.js"],"names":["$","require","eventsEngine","translator","extend","Color","messageLocalization","devices","registerComponent","Editor","NumberBox","TextBox","Draggable","clickEvent","COLOR_VIEW_CLASS","COLOR_VIEW_CONTAINER_CLASS","COLOR_VIEW_ROW_CLASS","COLOR_VIEW_CELL_CLASS","COLOR_VIEW_PALETTE_CLASS","COLOR_VIEW_PALETTE_CELL_CLASS","COLOR_VIEW_PALETTE_HANDLE_CLASS","COLOR_VIEW_PALETTE_GRADIENT_CLASS","COLOR_VIEW_PALETTE_GRADIENT_WHITE_CLASS","COLOR_VIEW_PALETTE_GRADIENT_BLACK_CLASS","COLOR_VIEW_HUE_SCALE_CLASS","COLOR_VIEW_HUE_SCALE_CELL_CLASS","COLOR_VIEW_HUE_SCALE_HANDLE_CLASS","COLOR_VIEW_HUE_SCALE_WRAPPER_CLASS","COLOR_VIEW_CONTROLS_CONTAINER_CLASS","COLOR_VIEW_RED_LABEL_CLASS","COLOR_VIEW_GREEN_LABEL_CLASS","COLOR_VIEW_BLUE_LABEL_CLASS","COLOR_VIEW_HEX_LABEL_CLASS","COLOR_VIEW_ALPHA_CHANNEL_SCALE_CLASS","COLOR_VIEW_APLHA_CHANNEL_ROW_CLASS","COLOR_VIEW_ALPHA_CHANNEL_SCALE_WRAPPER_CLASS","COLOR_VIEW_ALPHA_CHANNEL_LABEL_CLASS","COLOR_VIEW_ALPHA_CHANNEL_HANDLE_CLASS","COLOR_VIEW_ALPHA_CHANNEL_CELL_CLASS","COLOR_VIEW_ALPHA_CHANNEL_BORDER_CLASS","COLOR_VIEW_COLOR_PREVIEW","COLOR_VIEW_COLOR_PREVIEW_CONTAINER_CLASS","COLOR_VIEW_COLOR_PREVIEW_CONTAINER_INNER_CLASS","COLOR_VIEW_COLOR_PREVIEW_COLOR_CURRENT","COLOR_VIEW_COLOR_PREVIEW_COLOR_NEW","ColorView","_supportedKeys","isRTL","that","getHorizontalPaletteStep","step","e","Math","updateHorizontalPaletteValue","value","updatePaletteValue","getVerticalPaletteStep","updateVerticalPaletteValue","getHueScaleStep","updateHueScaleValue","handleLocation","getAlphaScaleStep","updateAlphaScaleValue","upArrow","downArrow","rightArrow","leftArrow","enter","_getDefaultOptions","matchValue","onEnterKeyPressed","editAlphaChannel","keyStep","stylingMode","_defaultOptionsRules","device","options","focusStateEnabled","_init","_initEnterKeyPressedAction","_fireEnterKeyPressed","event","_initColorAndOpacity","_setCurrentColor","newColor","_setBaseColor","color","isBaseColorChanged","_initMarkup","_render","_makeTransparentBackground","$el","_makeRgba","_renderValue","_renderColorPickerContainer","$parent","_renderHtmlRows","$renderedRows","renderedRowsCount","rowCount","delta","rows","i","_renderHtmlCellInsideRow","$rowParent","_renderPalette","$paletteCell","$paletteGradientWhite","$paletteGradientBlack","_renderPaletteHandle","contentTemplate","boundary","allowMoveByClick","boundOffset","onDragMove","paletteHandlePosition","_placePaletteHandle","left","top","_calculateColorValue","_calculateColorSaturation","saturation","_updateColorFromHsv","a","_renderHueScale","$hueScaleCell","_renderHueScaleHandle","dragDirection","_placeHueScaleHandle","hueScaleHeight","handleHeight","_updateColorHue","hue","handlePosition","_renderControlsContainer","$controlsContainerCell","_renderControls","_renderColorsPreview","$colorsPreviewContainer","$colorsPreviewContainerInner","_renderAlphaChannelElements","_renderRgbInputs","editorType","onValueChanged","labelText","labelAriaText","labelClass","_renderEditorWithLabel","$editor","$label","editorOptions","editor","_attachKeyboardProcessorToEditor","keyboardProcessor","hexInputOptions","_renderHexInput","_renderAlphaChannelScale","$alphaChannelScaleCell","$alphaChannelBorder","$alphaChannelScaleWrapper","_makeCSSLinearGradient","colorAsRgb","colorAsHex","combineGradientString","rtlEnabled","startColor","finishColor","startColorIE","finishColorIE","_renderAlphaChannelInput","$alphaChannelInputCell","max","_updateColorTransparency","_renderAlphaChannelHandle","$alphaChannelHandle","alphaChannelHandlePosition","_calculateColorTransparencyByScaleWidth","transparency","_placeAlphaChannelHandle","applyColor","colorValue","cancelColor","_updateColor","rgba","_validateHex","_validateRgb","r","g","b","_refreshMarkup","_updateColorParamsAndColorPreview","_optionChanged","args","module"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/color_box/color_view.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar $ = require(\"../../core/renderer\");\r\nvar eventsEngine = require(\"../../events/core/events_engine\");\r\nvar translator = require(\"../../animation/translator\");\r\nvar extend = require(\"../../core/utils/extend\").extend;\r\nvar Color = require(\"../../color\");\r\nvar messageLocalization = require(\"../../localization/message\");\r\nvar devices = require(\"../../core/devices\");\r\nvar registerComponent = require(\"../../core/component_registrator\");\r\nvar Editor = require(\"../editor/editor\");\r\nvar NumberBox = require(\"../number_box\");\r\nvar TextBox = require(\"../text_box\");\r\nvar Draggable = require(\"../draggable\");\r\nvar clickEvent = require(\"../../events/click\");\r\nvar COLOR_VIEW_CLASS = \"dx-colorview\";\r\nvar COLOR_VIEW_CONTAINER_CLASS = \"dx-colorview-container\";\r\nvar COLOR_VIEW_ROW_CLASS = \"dx-colorview-container-row\";\r\nvar COLOR_VIEW_CELL_CLASS = \"dx-colorview-container-cell\";\r\nvar COLOR_VIEW_PALETTE_CLASS = \"dx-colorview-palette\";\r\nvar COLOR_VIEW_PALETTE_CELL_CLASS = \"dx-colorview-palette-cell\";\r\nvar COLOR_VIEW_PALETTE_HANDLE_CLASS = \"dx-colorview-palette-handle\";\r\nvar COLOR_VIEW_PALETTE_GRADIENT_CLASS = \"dx-colorview-palette-gradient\";\r\nvar COLOR_VIEW_PALETTE_GRADIENT_WHITE_CLASS = \"dx-colorview-palette-gradient-white\";\r\nvar COLOR_VIEW_PALETTE_GRADIENT_BLACK_CLASS = \"dx-colorview-palette-gradient-black\";\r\nvar COLOR_VIEW_HUE_SCALE_CLASS = \"dx-colorview-hue-scale\";\r\nvar COLOR_VIEW_HUE_SCALE_CELL_CLASS = \"dx-colorview-hue-scale-cell\";\r\nvar COLOR_VIEW_HUE_SCALE_HANDLE_CLASS = \"dx-colorview-hue-scale-handle\";\r\nvar COLOR_VIEW_HUE_SCALE_WRAPPER_CLASS = \"dx-colorview-hue-scale-wrapper\";\r\nvar COLOR_VIEW_CONTROLS_CONTAINER_CLASS = \"dx-colorview-controls-container\";\r\nvar COLOR_VIEW_RED_LABEL_CLASS = \"dx-colorview-label-red\";\r\nvar COLOR_VIEW_GREEN_LABEL_CLASS = \"dx-colorview-label-green\";\r\nvar COLOR_VIEW_BLUE_LABEL_CLASS = \"dx-colorview-label-blue\";\r\nvar COLOR_VIEW_HEX_LABEL_CLASS = \"dx-colorview-label-hex\";\r\nvar COLOR_VIEW_ALPHA_CHANNEL_SCALE_CLASS = \"dx-colorview-alpha-channel-scale\";\r\nvar COLOR_VIEW_APLHA_CHANNEL_ROW_CLASS = \"dx-colorview-alpha-channel-row\";\r\nvar COLOR_VIEW_ALPHA_CHANNEL_SCALE_WRAPPER_CLASS = \"dx-colorview-alpha-channel-wrapper\";\r\nvar COLOR_VIEW_ALPHA_CHANNEL_LABEL_CLASS = \"dx-colorview-alpha-channel-label\";\r\nvar COLOR_VIEW_ALPHA_CHANNEL_HANDLE_CLASS = \"dx-colorview-alpha-channel-handle\";\r\nvar COLOR_VIEW_ALPHA_CHANNEL_CELL_CLASS = \"dx-colorview-alpha-channel-cell\";\r\nvar COLOR_VIEW_ALPHA_CHANNEL_BORDER_CLASS = \"dx-colorview-alpha-channel-border\";\r\nvar COLOR_VIEW_COLOR_PREVIEW = \"dx-colorview-color-preview\";\r\nvar COLOR_VIEW_COLOR_PREVIEW_CONTAINER_CLASS = \"dx-colorview-color-preview-container\";\r\nvar COLOR_VIEW_COLOR_PREVIEW_CONTAINER_INNER_CLASS = \"dx-colorview-color-preview-container-inner\";\r\nvar COLOR_VIEW_COLOR_PREVIEW_COLOR_CURRENT = \"dx-colorview-color-preview-color-current\";\r\nvar COLOR_VIEW_COLOR_PREVIEW_COLOR_NEW = \"dx-colorview-color-preview-color-new\";\r\nvar ColorView = Editor.inherit({\r\n    _supportedKeys: function() {\r\n        var isRTL = this.option(\"rtlEnabled\");\r\n        var that = this;\r\n        var getHorizontalPaletteStep = function(e) {\r\n            var step = 100 / that._paletteWidth;\r\n            if (e.shiftKey) {\r\n                step *= that.option(\"keyStep\")\r\n            }\r\n            step = step > 1 ? step : 1;\r\n            return Math.round(step)\r\n        };\r\n        var updateHorizontalPaletteValue = function(step) {\r\n            var value = that._currentColor.hsv.s + step;\r\n            if (value > 100) {\r\n                value = 100\r\n            } else {\r\n                if (value < 0) {\r\n                    value = 0\r\n                }\r\n            }\r\n            that._currentColor.hsv.s = value;\r\n            updatePaletteValue()\r\n        };\r\n        var getVerticalPaletteStep = function(e) {\r\n            var step = 100 / that._paletteHeight;\r\n            if (e.shiftKey) {\r\n                step *= that.option(\"keyStep\")\r\n            }\r\n            step = step > 1 ? step : 1;\r\n            return Math.round(step)\r\n        };\r\n        var updateVerticalPaletteValue = function(step) {\r\n            var value = that._currentColor.hsv.v + step;\r\n            if (value > 100) {\r\n                value = 100\r\n            } else {\r\n                if (value < 0) {\r\n                    value = 0\r\n                }\r\n            }\r\n            that._currentColor.hsv.v = value;\r\n            updatePaletteValue()\r\n        };\r\n        var updatePaletteValue = function() {\r\n            that._placePaletteHandle();\r\n            that._updateColorFromHsv(that._currentColor.hsv.h, that._currentColor.hsv.s, that._currentColor.hsv.v)\r\n        };\r\n        var getHueScaleStep = function(e) {\r\n            var step = 360 / (that._hueScaleWrapperHeight - that._hueScaleHandleHeight);\r\n            if (e.shiftKey) {\r\n                step *= that.option(\"keyStep\")\r\n            }\r\n            step = step > 1 ? step : 1;\r\n            return step\r\n        };\r\n        var updateHueScaleValue = function(step) {\r\n            that._currentColor.hsv.h += step;\r\n            that._placeHueScaleHandle();\r\n            var handleLocation = translator.locate(that._$hueScaleHandle);\r\n            that._updateColorHue(handleLocation.top + that._hueScaleHandleHeight / 2)\r\n        };\r\n        var getAlphaScaleStep = function(e) {\r\n            var step = 1 / that._alphaChannelScaleWorkWidth;\r\n            if (e.shiftKey) {\r\n                step *= that.option(\"keyStep\")\r\n            }\r\n            step = step > .01 ? step : .01;\r\n            step = isRTL ? -step : step;\r\n            return step\r\n        };\r\n        var updateAlphaScaleValue = function(step) {\r\n            that._currentColor.a += step;\r\n            that._placeAlphaChannelHandle();\r\n            var handleLocation = translator.locate(that._$alphaChannelHandle);\r\n            that._calculateColorTransparencyByScaleWidth(handleLocation.left + that._alphaChannelHandleWidth / 2)\r\n        };\r\n        return extend(this.callBase(), {\r\n            upArrow: function(e) {\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n                if (e.ctrlKey) {\r\n                    if (this._currentColor.hsv.h <= 360 && !this._isTopColorHue) {\r\n                        updateHueScaleValue(getHueScaleStep(e))\r\n                    }\r\n                } else {\r\n                    if (this._currentColor.hsv.v < 100) {\r\n                        updateVerticalPaletteValue(getVerticalPaletteStep(e))\r\n                    }\r\n                }\r\n            },\r\n            downArrow: function(e) {\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n                if (e.ctrlKey) {\r\n                    if (this._currentColor.hsv.h >= 0) {\r\n                        if (this._isTopColorHue) {\r\n                            this._currentColor.hsv.h = 360\r\n                        }\r\n                        updateHueScaleValue(-getHueScaleStep(e))\r\n                    }\r\n                } else {\r\n                    if (this._currentColor.hsv.v > 0) {\r\n                        updateVerticalPaletteValue(-getVerticalPaletteStep(e))\r\n                    }\r\n                }\r\n            },\r\n            rightArrow: function(e) {\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n                if (e.ctrlKey) {\r\n                    if (isRTL ? this._currentColor.a < 1 : this._currentColor.a > 0 && this.option(\"editAlphaChannel\")) {\r\n                        updateAlphaScaleValue(-getAlphaScaleStep(e))\r\n                    }\r\n                } else {\r\n                    if (this._currentColor.hsv.s < 100) {\r\n                        updateHorizontalPaletteValue(getHorizontalPaletteStep(e))\r\n                    }\r\n                }\r\n            },\r\n            leftArrow: function(e) {\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n                if (e.ctrlKey) {\r\n                    if (isRTL ? this._currentColor.a > 0 : this._currentColor.a < 1 && this.option(\"editAlphaChannel\")) {\r\n                        updateAlphaScaleValue(getAlphaScaleStep(e))\r\n                    }\r\n                } else {\r\n                    if (this._currentColor.hsv.s > 0) {\r\n                        updateHorizontalPaletteValue(-getHorizontalPaletteStep(e))\r\n                    }\r\n                }\r\n            },\r\n            enter: function(e) {\r\n                this._fireEnterKeyPressed(e)\r\n            }\r\n        })\r\n    },\r\n    _getDefaultOptions: function() {\r\n        return extend(this.callBase(), {\r\n            value: null,\r\n            matchValue: null,\r\n            onEnterKeyPressed: void 0,\r\n            editAlphaChannel: false,\r\n            keyStep: 1,\r\n            stylingMode: void 0\r\n        })\r\n    },\r\n    _defaultOptionsRules: function() {\r\n        return this.callBase().concat([{\r\n            device: function() {\r\n                return \"desktop\" === devices.real().deviceType && !devices.isSimulator()\r\n            },\r\n            options: {\r\n                focusStateEnabled: true\r\n            }\r\n        }])\r\n    },\r\n    _init: function() {\r\n        this.callBase();\r\n        this._initColorAndOpacity();\r\n        this._initEnterKeyPressedAction()\r\n    },\r\n    _initEnterKeyPressedAction: function() {\r\n        this._onEnterKeyPressedAction = this._createActionByOption(\"onEnterKeyPressed\")\r\n    },\r\n    _fireEnterKeyPressed: function(e) {\r\n        if (!this._onEnterKeyPressedAction) {\r\n            return\r\n        }\r\n        this._onEnterKeyPressedAction({\r\n            event: e\r\n        })\r\n    },\r\n    _initColorAndOpacity: function() {\r\n        this._setCurrentColor(this.option(\"value\"))\r\n    },\r\n    _setCurrentColor: function(value) {\r\n        value = value || \"#000000\";\r\n        var newColor = new Color(value);\r\n        if (!newColor.colorIsInvalid) {\r\n            if (!this._currentColor || this._makeRgba(this._currentColor) !== this._makeRgba(newColor)) {\r\n                this._currentColor = newColor;\r\n                if (this._$currentColor) {\r\n                    this._makeTransparentBackground(this._$currentColor, newColor)\r\n                }\r\n            }\r\n        } else {\r\n            this.option(\"value\", this._currentColor.baseColor)\r\n        }\r\n    },\r\n    _setBaseColor: function(value) {\r\n        var color = value || \"#000000\";\r\n        var newColor = new Color(color);\r\n        if (!newColor.colorIsInvalid) {\r\n            var isBaseColorChanged = this._makeRgba(this.option(\"matchValue\") !== this._makeRgba(newColor));\r\n            if (isBaseColorChanged) {\r\n                if (this._$baseColor) {\r\n                    this._makeTransparentBackground(this._$baseColor, newColor)\r\n                }\r\n            }\r\n        }\r\n    },\r\n    _initMarkup: function() {\r\n        this.callBase();\r\n        this.$element().addClass(COLOR_VIEW_CLASS);\r\n        this._renderColorPickerContainer()\r\n    },\r\n    _render: function() {\r\n        this.callBase();\r\n        this._renderPalette();\r\n        this._renderHueScale();\r\n        this._renderControlsContainer();\r\n        this._renderControls();\r\n        this._renderAlphaChannelElements()\r\n    },\r\n    _makeTransparentBackground: function($el, color) {\r\n        if (!(color instanceof Color)) {\r\n            color = new Color(color)\r\n        }\r\n        $el.css(\"backgroundColor\", this._makeRgba(color))\r\n    },\r\n    _makeRgba: function(color) {\r\n        if (!(color instanceof Color)) {\r\n            color = new Color(color)\r\n        }\r\n        return \"rgba(\" + [color.r, color.g, color.b, color.a].join(\", \") + \")\"\r\n    },\r\n    _renderValue: function() {\r\n        this.callBase(this.option(\"editAlphaChannel\") ? this._makeRgba(this._currentColor) : this.option(\"value\"))\r\n    },\r\n    _renderColorPickerContainer: function() {\r\n        var $parent = this.$element();\r\n        this._$colorPickerContainer = $(\"<div>\").addClass(COLOR_VIEW_CONTAINER_CLASS).appendTo($parent);\r\n        this._renderHtmlRows()\r\n    },\r\n    _renderHtmlRows: function(updatedOption) {\r\n        var $renderedRows = this._$colorPickerContainer.find(\".\" + COLOR_VIEW_ROW_CLASS);\r\n        var renderedRowsCount = $renderedRows.length;\r\n        var rowCount = this.option(\"editAlphaChannel\") ? 2 : 1;\r\n        var delta = renderedRowsCount - rowCount;\r\n        if (delta > 0) {\r\n            $renderedRows.eq(-1).remove()\r\n        }\r\n        if (delta < 0) {\r\n            delta = Math.abs(delta);\r\n            var rows = [];\r\n            var i;\r\n            for (i = 0; i < delta; i++) {\r\n                rows.push($(\"<div>\").addClass(COLOR_VIEW_ROW_CLASS))\r\n            }\r\n            if (renderedRowsCount) {\r\n                for (i = 0; i < rows.length; i++) {\r\n                    $renderedRows.eq(0).after(rows[i])\r\n                }\r\n            } else {\r\n                this._$colorPickerContainer.append(rows)\r\n            }\r\n        }\r\n    },\r\n    _renderHtmlCellInsideRow: function(index, $rowParent, additionalClass) {\r\n        return $(\"<div>\").addClass(COLOR_VIEW_CELL_CLASS).addClass(additionalClass).appendTo($rowParent.find(\".\" + COLOR_VIEW_ROW_CLASS).eq(index))\r\n    },\r\n    _renderPalette: function() {\r\n        var $paletteCell = this._renderHtmlCellInsideRow(0, this._$colorPickerContainer, COLOR_VIEW_PALETTE_CELL_CLASS);\r\n        var $paletteGradientWhite = $(\"<div>\").addClass([COLOR_VIEW_PALETTE_GRADIENT_CLASS, COLOR_VIEW_PALETTE_GRADIENT_WHITE_CLASS].join(\" \"));\r\n        var $paletteGradientBlack = $(\"<div>\").addClass([COLOR_VIEW_PALETTE_GRADIENT_CLASS, COLOR_VIEW_PALETTE_GRADIENT_BLACK_CLASS].join(\" \"));\r\n        this._$palette = $(\"<div>\").addClass(COLOR_VIEW_PALETTE_CLASS).css(\"backgroundColor\", this._currentColor.getPureColor().toHex()).appendTo($paletteCell);\r\n        this._paletteHeight = this._$palette.height();\r\n        this._paletteWidth = this._$palette.width();\r\n        this._renderPaletteHandle();\r\n        this._$palette.append([$paletteGradientWhite, $paletteGradientBlack])\r\n    },\r\n    _renderPaletteHandle: function() {\r\n        this._$paletteHandle = $(\"<div>\").addClass(COLOR_VIEW_PALETTE_HANDLE_CLASS).appendTo(this._$palette);\r\n        this._createComponent(this._$paletteHandle, Draggable, {\r\n            contentTemplate: null,\r\n            boundary: this._$palette,\r\n            allowMoveByClick: true,\r\n            boundOffset: function() {\r\n                return -this._paletteHandleHeight / 2\r\n            }.bind(this),\r\n            onDragMove: function() {\r\n                var paletteHandlePosition = translator.locate(this._$paletteHandle);\r\n                this._updateByDrag = true;\r\n                this._updateColorFromHsv(this._currentColor.hsv.h, this._calculateColorSaturation(paletteHandlePosition), this._calculateColorValue(paletteHandlePosition))\r\n            }.bind(this)\r\n        });\r\n        this._paletteHandleWidth = this._$paletteHandle.width();\r\n        this._paletteHandleHeight = this._$paletteHandle.height();\r\n        this._placePaletteHandle()\r\n    },\r\n    _placePaletteHandle: function() {\r\n        translator.move(this._$paletteHandle, {\r\n            left: Math.round(this._paletteWidth * this._currentColor.hsv.s / 100 - this._paletteHandleWidth / 2),\r\n            top: Math.round(this._paletteHeight - this._paletteHeight * this._currentColor.hsv.v / 100 - this._paletteHandleHeight / 2)\r\n        })\r\n    },\r\n    _calculateColorValue: function(paletteHandlePosition) {\r\n        var value = Math.floor(paletteHandlePosition.top + this._paletteHandleHeight / 2);\r\n        return 100 - Math.round(100 * value / this._paletteHeight)\r\n    },\r\n    _calculateColorSaturation: function(paletteHandlePosition) {\r\n        var saturation = Math.floor(paletteHandlePosition.left + this._paletteHandleWidth / 2);\r\n        return Math.round(100 * saturation / this._paletteWidth)\r\n    },\r\n    _updateColorFromHsv: function(hue, saturation, value) {\r\n        var a = this._currentColor.a;\r\n        this._currentColor = new Color(\"hsv(\" + [hue, saturation, value].join(\",\") + \")\");\r\n        this._currentColor.a = a;\r\n        this._updateColorParamsAndColorPreview();\r\n        this.applyColor()\r\n    },\r\n    _renderHueScale: function() {\r\n        var $hueScaleCell = this._renderHtmlCellInsideRow(0, this._$colorPickerContainer, COLOR_VIEW_HUE_SCALE_CELL_CLASS);\r\n        this._$hueScaleWrapper = $(\"<div>\").addClass(COLOR_VIEW_HUE_SCALE_WRAPPER_CLASS).appendTo($hueScaleCell);\r\n        this._$hueScale = $(\"<div>\").addClass(COLOR_VIEW_HUE_SCALE_CLASS).appendTo(this._$hueScaleWrapper);\r\n        this._hueScaleHeight = this._$hueScale.height();\r\n        this._hueScaleWrapperHeight = this._$hueScaleWrapper.outerHeight();\r\n        this._renderHueScaleHandle()\r\n    },\r\n    _renderHueScaleHandle: function() {\r\n        this._$hueScaleHandle = $(\"<div>\").addClass(COLOR_VIEW_HUE_SCALE_HANDLE_CLASS).appendTo(this._$hueScaleWrapper);\r\n        this._createComponent(this._$hueScaleHandle, Draggable, {\r\n            contentTemplate: null,\r\n            boundary: this._$hueScaleWrapper,\r\n            allowMoveByClick: true,\r\n            dragDirection: \"vertical\",\r\n            onDragMove: function() {\r\n                this._updateByDrag = true;\r\n                this._updateColorHue(translator.locate(this._$hueScaleHandle).top + this._hueScaleHandleHeight / 2)\r\n            }.bind(this)\r\n        });\r\n        this._hueScaleHandleHeight = this._$hueScaleHandle.height();\r\n        this._placeHueScaleHandle()\r\n    },\r\n    _placeHueScaleHandle: function() {\r\n        var hueScaleHeight = this._hueScaleWrapperHeight;\r\n        var handleHeight = this._hueScaleHandleHeight;\r\n        var top = (hueScaleHeight - handleHeight) * (360 - this._currentColor.hsv.h) / 360;\r\n        if (hueScaleHeight < top + handleHeight) {\r\n            top = hueScaleHeight - handleHeight\r\n        }\r\n        if (top < 0) {\r\n            top = 0\r\n        }\r\n        translator.move(this._$hueScaleHandle, {\r\n            top: Math.round(top)\r\n        })\r\n    },\r\n    _updateColorHue: function(handlePosition) {\r\n        var hue = 360 - Math.round(360 * (handlePosition - this._hueScaleHandleHeight / 2) / (this._hueScaleWrapperHeight - this._hueScaleHandleHeight));\r\n        var saturation = this._currentColor.hsv.s;\r\n        var value = this._currentColor.hsv.v;\r\n        this._isTopColorHue = false;\r\n        hue = hue < 0 ? 0 : hue;\r\n        if (hue >= 360) {\r\n            this._isTopColorHue = true;\r\n            hue = 0\r\n        }\r\n        this._updateColorFromHsv(hue, saturation, value);\r\n        this._$palette.css(\"backgroundColor\", this._currentColor.getPureColor().toHex())\r\n    },\r\n    _renderControlsContainer: function() {\r\n        var $controlsContainerCell = this._renderHtmlCellInsideRow(0, this._$colorPickerContainer);\r\n        this._$controlsContainer = $(\"<div>\").addClass(COLOR_VIEW_CONTROLS_CONTAINER_CLASS).appendTo($controlsContainerCell)\r\n    },\r\n    _renderControls: function() {\r\n        this._renderColorsPreview();\r\n        this._renderRgbInputs();\r\n        this._renderHexInput()\r\n    },\r\n    _renderColorsPreview: function() {\r\n        var $colorsPreviewContainer = $(\"<div>\").addClass(COLOR_VIEW_COLOR_PREVIEW_CONTAINER_CLASS).appendTo(this._$controlsContainer);\r\n        var $colorsPreviewContainerInner = $(\"<div>\").addClass(COLOR_VIEW_COLOR_PREVIEW_CONTAINER_INNER_CLASS).appendTo($colorsPreviewContainer);\r\n        this._$currentColor = $(\"<div>\").addClass([COLOR_VIEW_COLOR_PREVIEW, COLOR_VIEW_COLOR_PREVIEW_COLOR_NEW].join(\" \"));\r\n        this._$baseColor = $(\"<div>\").addClass([COLOR_VIEW_COLOR_PREVIEW, COLOR_VIEW_COLOR_PREVIEW_COLOR_CURRENT].join(\" \"));\r\n        this._makeTransparentBackground(this._$baseColor, this.option(\"matchValue\"));\r\n        this._makeTransparentBackground(this._$currentColor, this._currentColor);\r\n        $colorsPreviewContainerInner.append([this._$baseColor, this._$currentColor])\r\n    },\r\n    _renderAlphaChannelElements: function() {\r\n        if (this.option(\"editAlphaChannel\")) {\r\n            this._$colorPickerContainer.find(\".\" + COLOR_VIEW_ROW_CLASS).eq(1).addClass(COLOR_VIEW_APLHA_CHANNEL_ROW_CLASS);\r\n            this._renderAlphaChannelScale();\r\n            this._renderAlphaChannelInput()\r\n        }\r\n    },\r\n    _renderRgbInputs: function() {\r\n        this._rgbInputsWithLabels = [this._renderEditorWithLabel({\r\n            editorType: NumberBox,\r\n            value: this._currentColor.r,\r\n            onValueChanged: this._updateColor.bind(this, false),\r\n            labelText: \"R\",\r\n            labelAriaText: messageLocalization.format(\"dxColorView-ariaRed\"),\r\n            labelClass: COLOR_VIEW_RED_LABEL_CLASS\r\n        }), this._renderEditorWithLabel({\r\n            editorType: NumberBox,\r\n            value: this._currentColor.g,\r\n            onValueChanged: this._updateColor.bind(this, false),\r\n            labelText: \"G\",\r\n            labelAriaText: messageLocalization.format(\"dxColorView-ariaGreen\"),\r\n            labelClass: COLOR_VIEW_GREEN_LABEL_CLASS\r\n        }), this._renderEditorWithLabel({\r\n            editorType: NumberBox,\r\n            value: this._currentColor.b,\r\n            onValueChanged: this._updateColor.bind(this, false),\r\n            labelText: \"B\",\r\n            labelAriaText: messageLocalization.format(\"dxColorView-ariaBlue\"),\r\n            labelClass: COLOR_VIEW_BLUE_LABEL_CLASS\r\n        })];\r\n        this._$controlsContainer.append(this._rgbInputsWithLabels);\r\n        this._rgbInputs = [this._rgbInputsWithLabels[0].find(\".dx-numberbox\").dxNumberBox(\"instance\"), this._rgbInputsWithLabels[1].find(\".dx-numberbox\").dxNumberBox(\"instance\"), this._rgbInputsWithLabels[2].find(\".dx-numberbox\").dxNumberBox(\"instance\")]\r\n    },\r\n    _renderEditorWithLabel: function(options) {\r\n        var $editor = $(\"<div>\");\r\n        var $label = $(\"<label>\").addClass(options.labelClass).text(options.labelText + \":\").append($editor);\r\n        eventsEngine.off($label, clickEvent.name);\r\n        eventsEngine.on($label, clickEvent.name, function(e) {\r\n            e.preventDefault()\r\n        });\r\n        var editorType = options.editorType;\r\n        var editorOptions = extend({\r\n            value: options.value,\r\n            onValueChanged: options.onValueChanged\r\n        }, {\r\n            stylingMode: this.option(\"stylingMode\")\r\n        });\r\n        if (editorType === NumberBox) {\r\n            editorOptions.min = options.min || 0;\r\n            editorOptions.max = options.max || 255;\r\n            editorOptions.step = options.step || 1\r\n        }\r\n        var editor = new editorType($editor, editorOptions);\r\n        this._attachKeyboardProcessorToEditor(editor);\r\n        editor.registerKeyHandler(\"enter\", function(e) {\r\n            this._fireEnterKeyPressed(e)\r\n        }.bind(this));\r\n        this.setAria(\"label\", options.labelAriaText, $editor);\r\n        return $label\r\n    },\r\n    _attachKeyboardProcessorToEditor: function(editor) {\r\n        var keyboardProcessor = editor._keyboardProcessor;\r\n        if (keyboardProcessor) {\r\n            keyboardProcessor.attachChildProcessor().reinitialize(this._keyboardHandler, this)\r\n        }\r\n    },\r\n    hexInputOptions: function() {\r\n        return {\r\n            editorType: TextBox,\r\n            value: this._currentColor.toHex().replace(\"#\", \"\"),\r\n            onValueChanged: this._updateColor.bind(this, true),\r\n            labelClass: COLOR_VIEW_HEX_LABEL_CLASS,\r\n            labelText: \"#\",\r\n            labelAriaText: messageLocalization.format(\"dxColorView-ariaHex\")\r\n        }\r\n    },\r\n    _renderHexInput: function() {\r\n        this._hexInput = TextBox.getInstance(this._renderEditorWithLabel(this.hexInputOptions()).appendTo(this._$controlsContainer).find(\".dx-textbox\"))\r\n    },\r\n    _renderAlphaChannelScale: function() {\r\n        var $alphaChannelScaleCell = this._renderHtmlCellInsideRow(1, this._$colorPickerContainer, COLOR_VIEW_ALPHA_CHANNEL_CELL_CLASS);\r\n        var $alphaChannelBorder = $(\"<div>\").addClass(COLOR_VIEW_ALPHA_CHANNEL_BORDER_CLASS).appendTo($alphaChannelScaleCell);\r\n        var $alphaChannelScaleWrapper = $(\"<div>\").addClass(COLOR_VIEW_ALPHA_CHANNEL_SCALE_WRAPPER_CLASS).appendTo($alphaChannelBorder);\r\n        this._$alphaChannelScale = $(\"<div>\").addClass(COLOR_VIEW_ALPHA_CHANNEL_SCALE_CLASS).appendTo($alphaChannelScaleWrapper);\r\n        this._makeCSSLinearGradient(this._$alphaChannelScale);\r\n        this._renderAlphaChannelHandle($alphaChannelScaleCell)\r\n    },\r\n    _makeCSSLinearGradient: function($el) {\r\n        var color = this._currentColor;\r\n        var colorAsRgb = [color.r, color.g, color.b].join(\",\");\r\n        var colorAsHex = color.toHex().replace(\"#\", \"\");\r\n        var combineGradientString = function(colorAsRgb, colorAsHex) {\r\n            var rtlEnabled = this.option(\"rtlEnabled\");\r\n            var startColor = \"rgba(\" + colorAsRgb + \", \" + (rtlEnabled ? \"1\" : \"0\") + \")\";\r\n            var finishColor = \"rgba(\" + colorAsRgb + \", \" + (rtlEnabled ? \"0\" : \"1\") + \")\";\r\n            var startColorIE = \"'#\" + (rtlEnabled ? \"00\" : \"\") + colorAsHex + \"'\";\r\n            var finishColorIE = \"'#\" + (rtlEnabled ? \"\" : \"00\") + colorAsHex + \"'\";\r\n            return [\"background-image: -webkit-linear-gradient(180deg, \" + startColor + \", \" + finishColor + \")\", \"background-image: -moz-linear-gradient(-90deg, \" + startColor + \", \" + finishColor + \")\", \"background-image: -o-linear-gradient(-90deg, \" + startColor + \", \" + finishColor + \")\", \"background-image: linear-gradient(-90deg, \" + startColor + \", \" + finishColor + \")\", \"filter: progid:DXImageTransform.Microsoft.gradient(GradientType=1,startColorstr=\" + startColorIE + \", endColorstr=\" + finishColorIE + \")\"].join(\";\")\r\n        };\r\n        $el.attr(\"style\", combineGradientString.call(this, colorAsRgb, colorAsHex))\r\n    },\r\n    _renderAlphaChannelInput: function() {\r\n        var that = this;\r\n        var $alphaChannelInputCell = this._renderHtmlCellInsideRow(1, this._$colorPickerContainer);\r\n        that._alphaChannelInput = this._renderEditorWithLabel({\r\n            editorType: NumberBox,\r\n            value: this._currentColor.a,\r\n            max: 1,\r\n            step: .1,\r\n            onValueChanged: function(e) {\r\n                var value = e.value;\r\n                value = that._currentColor.isValidAlpha(value) ? value : that._currentColor.a;\r\n                that._updateColorTransparency(value);\r\n                that._placeAlphaChannelHandle()\r\n            },\r\n            labelClass: COLOR_VIEW_ALPHA_CHANNEL_LABEL_CLASS,\r\n            labelText: \"Alpha\",\r\n            labelAriaText: messageLocalization.format(\"dxColorView-ariaAlpha\")\r\n        }).appendTo($alphaChannelInputCell).find(\".dx-numberbox\").dxNumberBox(\"instance\")\r\n    },\r\n    _updateColorTransparency: function(transparency) {\r\n        this._currentColor.a = transparency;\r\n        this.applyColor()\r\n    },\r\n    _renderAlphaChannelHandle: function($parent) {\r\n        this._$alphaChannelHandle = $(\"<div>\").addClass(COLOR_VIEW_ALPHA_CHANNEL_HANDLE_CLASS).appendTo($parent);\r\n        this._createComponent(this._$alphaChannelHandle, Draggable, {\r\n            contentTemplate: null,\r\n            boundary: $parent,\r\n            allowMoveByClick: true,\r\n            dragDirection: \"horizontal\",\r\n            onDragMove: function() {\r\n                this._updateByDrag = true;\r\n                var $alphaChannelHandle = this._$alphaChannelHandle;\r\n                var alphaChannelHandlePosition = translator.locate($alphaChannelHandle).left + this._alphaChannelHandleWidth / 2;\r\n                this._calculateColorTransparencyByScaleWidth(alphaChannelHandlePosition)\r\n            }.bind(this)\r\n        });\r\n        this._alphaChannelHandleWidth = this._$alphaChannelHandle.width();\r\n        this._alphaChannelScaleWorkWidth = $parent.width() - this._alphaChannelHandleWidth;\r\n        this._placeAlphaChannelHandle()\r\n    },\r\n    _calculateColorTransparencyByScaleWidth: function(handlePosition) {\r\n        var transparency = (handlePosition - this._alphaChannelHandleWidth / 2) / this._alphaChannelScaleWorkWidth;\r\n        var rtlEnabled = this.option(\"rtlEnabled\");\r\n        transparency = rtlEnabled ? transparency : 1 - transparency;\r\n        if (handlePosition >= this._alphaChannelScaleWorkWidth + this._alphaChannelHandleWidth / 2) {\r\n            transparency = rtlEnabled ? 1 : 0\r\n        } else {\r\n            if (transparency < 1) {\r\n                transparency = transparency.toFixed(2)\r\n            }\r\n        }\r\n        transparency = Math.max(transparency, 0);\r\n        transparency = Math.min(transparency, 1);\r\n        this._alphaChannelInput.option(\"value\", transparency)\r\n    },\r\n    _placeAlphaChannelHandle: function() {\r\n        var left = this._alphaChannelScaleWorkWidth * (1 - this._currentColor.a);\r\n        if (left < 0) {\r\n            left = 0\r\n        }\r\n        if (this._alphaChannelScaleWorkWidth < left) {\r\n            left = this._alphaChannelScaleWorkWidth\r\n        }\r\n        translator.move(this._$alphaChannelHandle, {\r\n            left: this.option(\"rtlEnabled\") ? this._alphaChannelScaleWorkWidth - left : left\r\n        })\r\n    },\r\n    applyColor: function() {\r\n        var colorValue = this.option(\"editAlphaChannel\") ? this._makeRgba(this._currentColor) : this._currentColor.toHex();\r\n        this._makeTransparentBackground(this._$currentColor, this._currentColor);\r\n        this.option(\"value\", colorValue)\r\n    },\r\n    cancelColor: function() {\r\n        this._initColorAndOpacity();\r\n        this._refreshMarkup()\r\n    },\r\n    _updateColor: function(isHex, e) {\r\n        var rgba;\r\n        var newColor;\r\n        if (isHex) {\r\n            newColor = this._validateHex(\"#\" + this._hexInput.option(\"value\"))\r\n        } else {\r\n            rgba = this._validateRgb();\r\n            if (this._alphaChannelInput) {\r\n                rgba.push(this._alphaChannelInput.option(\"value\"));\r\n                newColor = \"rgba(\" + rgba.join(\", \") + \")\"\r\n            } else {\r\n                newColor = \"rgb(\" + rgba.join(\", \") + \")\"\r\n            }\r\n        }\r\n        if (!this._suppressEditorsValueUpdating) {\r\n            this._currentColor = new Color(newColor);\r\n            this.applyColor();\r\n            this._refreshMarkup()\r\n        }\r\n    },\r\n    _validateHex: function(hex) {\r\n        return this._currentColor.isValidHex(hex) ? hex : this._currentColor.toHex()\r\n    },\r\n    _validateRgb: function() {\r\n        var r = this._rgbInputs[0].option(\"value\");\r\n        var g = this._rgbInputs[1].option(\"value\");\r\n        var b = this._rgbInputs[2].option(\"value\");\r\n        if (!this._currentColor.isValidRGB(r, g, b)) {\r\n            r = this._currentColor.r;\r\n            g = this._currentColor.g;\r\n            b = this._currentColor.b\r\n        }\r\n        return [r, g, b]\r\n    },\r\n    _refreshMarkup: function() {\r\n        this._placeHueScaleHandle();\r\n        this._placePaletteHandle();\r\n        this._updateColorParamsAndColorPreview();\r\n        this._$palette.css(\"backgroundColor\", this._currentColor.getPureColor().toHex());\r\n        if (this._$alphaChannelHandle) {\r\n            this._updateColorTransparency(this._currentColor.a);\r\n            this._placeAlphaChannelHandle()\r\n        }\r\n    },\r\n    _updateColorParamsAndColorPreview: function() {\r\n        this._suppressEditorsValueUpdating = true;\r\n        this._hexInput.option(\"value\", this._currentColor.toHex().replace(\"#\", \"\"));\r\n        this._rgbInputs[0].option(\"value\", this._currentColor.r);\r\n        this._rgbInputs[1].option(\"value\", this._currentColor.g);\r\n        this._rgbInputs[2].option(\"value\", this._currentColor.b);\r\n        this._suppressEditorsValueUpdating = false;\r\n        if (this.option(\"editAlphaChannel\")) {\r\n            this._makeCSSLinearGradient.call(this, this._$alphaChannelScale);\r\n            this._alphaChannelInput.option(\"value\", this._currentColor.a)\r\n        }\r\n    },\r\n    _optionChanged: function(args) {\r\n        var value = args.value;\r\n        switch (args.name) {\r\n            case \"value\":\r\n                this._setCurrentColor(value);\r\n                if (!this._updateByDrag) {\r\n                    this._refreshMarkup()\r\n                }\r\n                this._updateByDrag = false;\r\n                this.callBase(args);\r\n                break;\r\n            case \"matchValue\":\r\n                this._setBaseColor(value);\r\n                break;\r\n            case \"onEnterKeyPressed\":\r\n                this._initEnterKeyPressedAction();\r\n                break;\r\n            case \"editAlphaChannel\":\r\n                if (this._$colorPickerContainer) {\r\n                    this._renderHtmlRows(\"editAlphaChannel\");\r\n                    this._renderAlphaChannelElements()\r\n                }\r\n                break;\r\n            case \"keyStep\":\r\n                break;\r\n            case \"stylingMode\":\r\n                this._renderControls();\r\n                break;\r\n            default:\r\n                this.callBase(args)\r\n        }\r\n    }\r\n});\r\nregisterComponent(\"dxColorView\", ColorView);\r\nmodule.exports = ColorView;\r\n"]},"metadata":{},"sourceType":"module"}