{"ast":null,"code":"/**\r\n * DevExtreme (core/utils/selection_filter.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar getKeyHash = require(\"./common\").getKeyHash;\n\nvar equalByValue = require(\"./common\").equalByValue;\n\nvar typeUtils = require(\"./type\");\n\nvar SelectionFilterCreator = function SelectionFilterCreator(selectedItemKeys, isSelectAll) {\n  this.getLocalFilter = function (keyGetter, equalKeys, equalByReference, keyExpr) {\n    equalKeys = void 0 === equalKeys ? equalByValue : equalKeys;\n    return functionFilter.bind(this, equalKeys, keyGetter, equalByReference, keyExpr);\n  };\n\n  this.getExpr = function (keyExpr) {\n    if (!keyExpr) {\n      return;\n    }\n\n    var filterExpr;\n    selectedItemKeys.forEach(function (key, index) {\n      filterExpr = filterExpr || [];\n      var filterExprPart;\n\n      if (index > 0) {\n        filterExpr.push(isSelectAll ? \"and\" : \"or\");\n      }\n\n      if (typeUtils.isString(keyExpr)) {\n        filterExprPart = getFilterForPlainKey(keyExpr, key);\n      } else {\n        filterExprPart = getFilterForCompositeKey(keyExpr, key);\n      }\n\n      filterExpr.push(filterExprPart);\n    });\n\n    if (filterExpr && 1 === filterExpr.length) {\n      filterExpr = filterExpr[0];\n    }\n\n    return filterExpr;\n  };\n\n  this.getCombinedFilter = function (keyExpr, dataSourceFilter) {\n    var filterExpr = this.getExpr(keyExpr);\n    var combinedFilter = filterExpr;\n\n    if (isSelectAll && dataSourceFilter) {\n      if (filterExpr) {\n        combinedFilter = [];\n        combinedFilter.push(filterExpr);\n        combinedFilter.push(dataSourceFilter);\n      } else {\n        combinedFilter = dataSourceFilter;\n      }\n    }\n\n    return combinedFilter;\n  };\n\n  var selectedItemKeyHashesMap;\n\n  var getSelectedItemKeyHashesMap = function getSelectedItemKeyHashesMap(selectedItemKeys) {\n    if (!selectedItemKeyHashesMap) {\n      selectedItemKeyHashesMap = {};\n\n      for (var i = 0; i < selectedItemKeys.length; i++) {\n        selectedItemKeyHashesMap[getKeyHash(selectedItemKeys[i])] = true;\n      }\n    }\n\n    return selectedItemKeyHashesMap;\n  };\n\n  var normalizeKeys = function normalizeKeys(keys, keyOf, keyExpr) {\n    return Array.isArray(keyExpr) ? keys.map(function (key) {\n      return keyOf(key);\n    }) : keys;\n  };\n\n  var functionFilter = function functionFilter(equalKeys, keyOf, equalByReference, keyExpr, item) {\n    var key = keyOf(item);\n    var keyHash;\n    var i;\n\n    if (!equalByReference) {\n      keyHash = getKeyHash(key);\n\n      if (!typeUtils.isObject(keyHash)) {\n        var selectedKeyHashesMap = getSelectedItemKeyHashesMap(normalizeKeys(selectedItemKeys, keyOf, keyExpr));\n\n        if (selectedKeyHashesMap[keyHash]) {\n          return !isSelectAll;\n        }\n\n        return !!isSelectAll;\n      }\n    }\n\n    for (i = 0; i < selectedItemKeys.length; i++) {\n      if (equalKeys(selectedItemKeys[i], key)) {\n        return !isSelectAll;\n      }\n    }\n\n    return !!isSelectAll;\n  };\n\n  var getFilterForPlainKey = function getFilterForPlainKey(keyExpr, keyValue) {\n    if (void 0 === keyValue) {\n      return;\n    }\n\n    return [keyExpr, isSelectAll ? \"<>\" : \"=\", keyValue];\n  };\n\n  var getFilterForCompositeKey = function getFilterForCompositeKey(keyExpr, itemKeyValue) {\n    var filterExpr = [];\n\n    for (var i = 0, length = keyExpr.length; i < length; i++) {\n      var currentKeyExpr = keyExpr[i];\n      var currentKeyValue = itemKeyValue && itemKeyValue[currentKeyExpr];\n      var filterExprPart = getFilterForPlainKey(currentKeyExpr, currentKeyValue);\n\n      if (!filterExprPart) {\n        break;\n      }\n\n      if (i > 0) {\n        filterExpr.push(isSelectAll ? \"or\" : \"and\");\n      }\n\n      filterExpr.push(filterExprPart);\n    }\n\n    return filterExpr;\n  };\n};\n\nexports.SelectionFilterCreator = SelectionFilterCreator;","map":{"version":3,"sources":["C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/devextreme/core/utils/selection_filter.js"],"names":["getKeyHash","require","equalByValue","typeUtils","SelectionFilterCreator","equalKeys","functionFilter","selectedItemKeys","filterExpr","index","isSelectAll","filterExprPart","getFilterForPlainKey","getFilterForCompositeKey","combinedFilter","getSelectedItemKeyHashesMap","selectedItemKeyHashesMap","i","normalizeKeys","keyOf","key","keyHash","selectedKeyHashesMap","length","keyExpr","currentKeyExpr","currentKeyValue","itemKeyValue","exports"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (core/utils/selection_filter.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar getKeyHash = require(\"./common\").getKeyHash;\r\nvar equalByValue = require(\"./common\").equalByValue;\r\nvar typeUtils = require(\"./type\");\r\nvar SelectionFilterCreator = function(selectedItemKeys, isSelectAll) {\r\n    this.getLocalFilter = function(keyGetter, equalKeys, equalByReference, keyExpr) {\r\n        equalKeys = void 0 === equalKeys ? equalByValue : equalKeys;\r\n        return functionFilter.bind(this, equalKeys, keyGetter, equalByReference, keyExpr)\r\n    };\r\n    this.getExpr = function(keyExpr) {\r\n        if (!keyExpr) {\r\n            return\r\n        }\r\n        var filterExpr;\r\n        selectedItemKeys.forEach(function(key, index) {\r\n            filterExpr = filterExpr || [];\r\n            var filterExprPart;\r\n            if (index > 0) {\r\n                filterExpr.push(isSelectAll ? \"and\" : \"or\")\r\n            }\r\n            if (typeUtils.isString(keyExpr)) {\r\n                filterExprPart = getFilterForPlainKey(keyExpr, key)\r\n            } else {\r\n                filterExprPart = getFilterForCompositeKey(keyExpr, key)\r\n            }\r\n            filterExpr.push(filterExprPart)\r\n        });\r\n        if (filterExpr && 1 === filterExpr.length) {\r\n            filterExpr = filterExpr[0]\r\n        }\r\n        return filterExpr\r\n    };\r\n    this.getCombinedFilter = function(keyExpr, dataSourceFilter) {\r\n        var filterExpr = this.getExpr(keyExpr);\r\n        var combinedFilter = filterExpr;\r\n        if (isSelectAll && dataSourceFilter) {\r\n            if (filterExpr) {\r\n                combinedFilter = [];\r\n                combinedFilter.push(filterExpr);\r\n                combinedFilter.push(dataSourceFilter)\r\n            } else {\r\n                combinedFilter = dataSourceFilter\r\n            }\r\n        }\r\n        return combinedFilter\r\n    };\r\n    var selectedItemKeyHashesMap;\r\n    var getSelectedItemKeyHashesMap = function(selectedItemKeys) {\r\n        if (!selectedItemKeyHashesMap) {\r\n            selectedItemKeyHashesMap = {};\r\n            for (var i = 0; i < selectedItemKeys.length; i++) {\r\n                selectedItemKeyHashesMap[getKeyHash(selectedItemKeys[i])] = true\r\n            }\r\n        }\r\n        return selectedItemKeyHashesMap\r\n    };\r\n    var normalizeKeys = function(keys, keyOf, keyExpr) {\r\n        return Array.isArray(keyExpr) ? keys.map(function(key) {\r\n            return keyOf(key)\r\n        }) : keys\r\n    };\r\n    var functionFilter = function(equalKeys, keyOf, equalByReference, keyExpr, item) {\r\n        var key = keyOf(item);\r\n        var keyHash;\r\n        var i;\r\n        if (!equalByReference) {\r\n            keyHash = getKeyHash(key);\r\n            if (!typeUtils.isObject(keyHash)) {\r\n                var selectedKeyHashesMap = getSelectedItemKeyHashesMap(normalizeKeys(selectedItemKeys, keyOf, keyExpr));\r\n                if (selectedKeyHashesMap[keyHash]) {\r\n                    return !isSelectAll\r\n                }\r\n                return !!isSelectAll\r\n            }\r\n        }\r\n        for (i = 0; i < selectedItemKeys.length; i++) {\r\n            if (equalKeys(selectedItemKeys[i], key)) {\r\n                return !isSelectAll\r\n            }\r\n        }\r\n        return !!isSelectAll\r\n    };\r\n    var getFilterForPlainKey = function(keyExpr, keyValue) {\r\n        if (void 0 === keyValue) {\r\n            return\r\n        }\r\n        return [keyExpr, isSelectAll ? \"<>\" : \"=\", keyValue]\r\n    };\r\n    var getFilterForCompositeKey = function(keyExpr, itemKeyValue) {\r\n        var filterExpr = [];\r\n        for (var i = 0, length = keyExpr.length; i < length; i++) {\r\n            var currentKeyExpr = keyExpr[i];\r\n            var currentKeyValue = itemKeyValue && itemKeyValue[currentKeyExpr];\r\n            var filterExprPart = getFilterForPlainKey(currentKeyExpr, currentKeyValue);\r\n            if (!filterExprPart) {\r\n                break\r\n            }\r\n            if (i > 0) {\r\n                filterExpr.push(isSelectAll ? \"or\" : \"and\")\r\n            }\r\n            filterExpr.push(filterExprPart)\r\n        }\r\n        return filterExpr\r\n    }\r\n};\r\nexports.SelectionFilterCreator = SelectionFilterCreator;\r\n"]},"metadata":{},"sourceType":"module"}