{"ast":null,"code":"/**\r\n * DevExtreme (ui/grid_core/ui.grid_core.data_controller.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar _renderer = require(\"../../core/renderer\");\n\nvar _renderer2 = _interopRequireDefault(_renderer);\n\nvar _uiGrid_core = require(\"./ui.grid_core.modules\");\n\nvar _uiGrid_core2 = _interopRequireDefault(_uiGrid_core);\n\nvar _uiGrid_core3 = require(\"./ui.grid_core.utils\");\n\nvar _uiGrid_core4 = _interopRequireDefault(_uiGrid_core3);\n\nvar _array_store = require(\"../../data/array_store\");\n\nvar _array_store2 = _interopRequireDefault(_array_store);\n\nvar _custom_store = require(\"../../data/custom_store\");\n\nvar _custom_store2 = _interopRequireDefault(_custom_store);\n\nvar _ui = require(\"../widget/ui.errors\");\n\nvar _ui2 = _interopRequireDefault(_ui);\n\nvar _common = require(\"../../core/utils/common\");\n\nvar _iterator = require(\"../../core/utils/iterator\");\n\nvar _type = require(\"../../core/utils/type\");\n\nvar _type2 = _interopRequireDefault(_type);\n\nvar _extend = require(\"../../core/utils/extend\");\n\nvar _data_helper = require(\"../../data_helper\");\n\nvar _data_helper2 = _interopRequireDefault(_data_helper);\n\nvar _deferred = require(\"../../core/utils/deferred\");\n\nvar _array_compare = require(\"../../core/utils/array_compare\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nmodule.exports = {\n  defaultOptions: function defaultOptions() {\n    return {\n      loadingTimeout: 0,\n      dataSource: null,\n      cacheEnabled: true,\n      repaintChangesOnly: false,\n      highlightChanges: false,\n      onDataErrorOccurred: null,\n      remoteOperations: \"auto\",\n      paging: {\n        enabled: true,\n        pageSize: void 0,\n        pageIndex: void 0\n      }\n    };\n  },\n  controllers: {\n    data: _uiGrid_core2.default.Controller.inherit({}).include(_data_helper2.default).inherit(function () {\n      var changePaging = function changePaging(that, optionName, value) {\n        var dataSource = that._dataSource;\n\n        if (dataSource) {\n          if (void 0 !== value) {\n            if (dataSource[optionName]() !== value) {\n              if (\"pageSize\" === optionName) {\n                dataSource.pageIndex(0);\n              }\n\n              dataSource[optionName](value);\n              that._skipProcessingPagingChange = true;\n              that.option(\"paging.\" + optionName, value);\n              that._skipProcessingPagingChange = false;\n              return dataSource[\"pageIndex\" === optionName ? \"load\" : \"reload\"]().done(that.pageChanged.fire.bind(that.pageChanged));\n            }\n\n            return (0, _deferred.Deferred)().resolve().promise();\n          }\n\n          return dataSource[optionName]();\n        }\n\n        return 0;\n      };\n\n      var members = {\n        init: function init() {\n          var that = this;\n          that._items = [];\n          that._columnsController = that.getController(\"columns\");\n          that._columnsChangedHandler = that._handleColumnsChanged.bind(that);\n          that._dataChangedHandler = that._handleDataChanged.bind(that);\n          that._loadingChangedHandler = that._handleLoadingChanged.bind(that);\n          that._loadErrorHandler = that._handleLoadError.bind(that);\n          that._customizeStoreLoadOptionsHandler = that._handleCustomizeStoreLoadOptions.bind(that);\n          that._changingHandler = that._handleChanging.bind(that);\n\n          that._columnsController.columnsChanged.add(that._columnsChangedHandler);\n\n          that._isLoading = false;\n          that._isCustomLoading = false;\n          that._repaintChangesOnly = void 0;\n          that._changes = [];\n          that.createAction(\"onDataErrorOccurred\");\n          that.dataErrorOccurred.add(function (error) {\n            return that.executeAction(\"onDataErrorOccurred\", {\n              error: error\n            });\n          });\n\n          that._refreshDataSource();\n        },\n        callbackNames: function callbackNames() {\n          return [\"changed\", \"loadingChanged\", \"dataErrorOccurred\", \"pageChanged\", \"dataSourceChanged\"];\n        },\n        callbackFlags: function callbackFlags(name) {\n          if (\"dataErrorOccurred\" === name) {\n            return {\n              stopOnFalse: true\n            };\n          }\n        },\n        publicMethods: function publicMethods() {\n          return [\"beginCustomLoading\", \"endCustomLoading\", \"refresh\", \"filter\", \"clearFilter\", \"getCombinedFilter\", \"keyOf\", \"byKey\", \"getDataByKeys\", \"pageIndex\", \"pageSize\", \"pageCount\", \"totalCount\", \"_disposeDataSource\", \"getKeyByRowIndex\", \"getRowIndexByKey\", \"getDataSource\", \"getVisibleRows\", \"repaintRows\"];\n        },\n        reset: function reset() {\n          this._columnsController.reset();\n\n          this._items = [];\n\n          this._refreshDataSource();\n        },\n        optionChanged: function optionChanged(args) {\n          var that = this;\n          var dataSource;\n\n          function handled() {\n            args.handled = true;\n          }\n\n          if (\"dataSource\" === args.name && args.name === args.fullName && (args.value === args.previousValue || that.option(\"columns\") && Array.isArray(args.value) && Array.isArray(args.previousValue))) {\n            if (args.value !== args.previousValue) {\n              var store = that.store();\n\n              if (store) {\n                store._array = args.value;\n              }\n            }\n\n            handled();\n            that.refresh(that.option(\"repaintChangesOnly\"));\n            return;\n          }\n\n          switch (args.name) {\n            case \"cacheEnabled\":\n            case \"repaintChangesOnly\":\n            case \"highlightChanges\":\n            case \"loadingTimeout\":\n              handled();\n              break;\n\n            case \"remoteOperations\":\n            case \"keyExpr\":\n            case \"dataSource\":\n            case \"scrolling\":\n              handled();\n              that.reset();\n              break;\n\n            case \"paging\":\n              dataSource = that.dataSource();\n\n              if (dataSource && that._setPagingOptions(dataSource)) {\n                dataSource.load().done(that.pageChanged.fire.bind(that.pageChanged));\n              }\n\n              handled();\n              break;\n\n            case \"rtlEnabled\":\n              that.reset();\n              break;\n\n            case \"columns\":\n              dataSource = that.dataSource();\n\n              if (dataSource && dataSource.isLoading() && args.name === args.fullName) {\n                dataSource.load();\n              }\n\n              break;\n\n            default:\n              that.callBase(args);\n          }\n        },\n        isReady: function isReady() {\n          return !this._isLoading;\n        },\n        getDataSource: function getDataSource() {\n          return this._dataSource && this._dataSource._dataSource;\n        },\n        getCombinedFilter: function getCombinedFilter(returnDataField) {\n          return this.combinedFilter(void 0, returnDataField);\n        },\n        combinedFilter: function combinedFilter(filter, returnDataField) {\n          var that = this;\n          var dataSource = that._dataSource;\n          var columnsController = that._columnsController;\n          var additionalFilter;\n\n          if (dataSource) {\n            if (void 0 === filter) {\n              filter = dataSource.filter();\n            }\n\n            additionalFilter = that._calculateAdditionalFilter();\n\n            if (additionalFilter) {\n              if (columnsController.isDataSourceApplied() || columnsController.isAllDataTypesDefined()) {\n                filter = _uiGrid_core4.default.combineFilters([additionalFilter, filter]);\n              }\n            }\n\n            filter = columnsController.updateFilter(filter, returnDataField || dataSource.remoteOperations().filtering);\n          }\n\n          return filter;\n        },\n        waitReady: function waitReady() {\n          if (this._updateLockCount) {\n            this._readyDeferred = new _deferred.Deferred();\n            return this._readyDeferred;\n          }\n\n          return (0, _deferred.when)();\n        },\n        _endUpdateCore: function _endUpdateCore() {\n          var changes = this._changes;\n\n          if (changes.length) {\n            this._changes = [];\n            var repaintChangesOnly = changes.every(function (change) {\n              return change.repaintChangesOnly;\n            });\n            this.updateItems(1 === changes.length ? changes[0] : {\n              repaintChangesOnly: repaintChangesOnly\n            });\n          }\n\n          if (this._readyDeferred) {\n            this._readyDeferred.resolve();\n\n            this._readyDeferred = null;\n          }\n        },\n        _handleCustomizeStoreLoadOptions: function _handleCustomizeStoreLoadOptions(e) {\n          var columnsController = this._columnsController;\n          var dataSource = this._dataSource;\n          var storeLoadOptions = e.storeLoadOptions;\n\n          if (e.isCustomLoading && !storeLoadOptions.isLoadingAll) {\n            return;\n          }\n\n          storeLoadOptions.filter = this.combinedFilter(storeLoadOptions.filter);\n\n          if (!columnsController.isDataSourceApplied()) {\n            columnsController.updateColumnDataTypes(dataSource);\n          }\n\n          this._columnsUpdating = true;\n          columnsController.updateSortingGrouping(dataSource, !this._isFirstLoading);\n          this._columnsUpdating = false;\n          storeLoadOptions.sort = columnsController.getSortDataSourceParameters();\n          storeLoadOptions.group = columnsController.getGroupDataSourceParameters();\n          dataSource.sort(storeLoadOptions.sort);\n          dataSource.group(storeLoadOptions.group);\n          storeLoadOptions.sort = columnsController.getSortDataSourceParameters(!dataSource.remoteOperations().sorting);\n          e.group = columnsController.getGroupDataSourceParameters(!dataSource.remoteOperations().grouping);\n        },\n        _handleColumnsChanged: function _handleColumnsChanged(e) {\n          var that = this;\n          var changeTypes = e.changeTypes;\n          var optionNames = e.optionNames;\n          var filterValue;\n          var filterValues;\n          var filterApplied;\n\n          var updateItemsHandler = function updateItemsHandler() {\n            that._columnsController.columnsChanged.remove(updateItemsHandler);\n\n            that.updateItems();\n          };\n\n          if (changeTypes.sorting || changeTypes.grouping) {\n            if (that._dataSource && !that._columnsUpdating) {\n              that._dataSource.group(that._columnsController.getGroupDataSourceParameters());\n\n              that._dataSource.sort(that._columnsController.getSortDataSourceParameters());\n\n              that.reload();\n            }\n          } else {\n            if (changeTypes.columns) {\n              if (optionNames.filterValues || optionNames.filterValue || optionNames.selectedFilterOperation) {\n                filterValue = that._columnsController.columnOption(e.columnIndex, \"filterValue\");\n                filterValues = that._columnsController.columnOption(e.columnIndex, \"filterValues\");\n\n                if (Array.isArray(filterValues) || void 0 === e.columnIndex || _type2.default.isDefined(filterValue) || !optionNames.selectedFilterOperation || optionNames.filterValue) {\n                  that._applyFilter();\n\n                  filterApplied = true;\n                }\n              }\n\n              if (!that._needApplyFilter && !_uiGrid_core4.default.checkChanges(optionNames, [\"width\", \"visibleWidth\", \"filterValue\", \"bufferedFilterValue\", \"selectedFilterOperation\", \"filterValues\", \"filterType\"])) {\n                that._columnsController.columnsChanged.add(updateItemsHandler);\n              }\n\n              if (_type2.default.isDefined(optionNames.visible)) {\n                var column = that._columnsController.columnOption(e.columnIndex);\n\n                if (column && (_type2.default.isDefined(column.filterValue) || _type2.default.isDefined(column.filterValues))) {\n                  that._applyFilter();\n\n                  filterApplied = true;\n                }\n              }\n            }\n          }\n\n          if (!filterApplied && changeTypes.filtering) {\n            that.reload();\n          }\n        },\n        _handleDataChanged: function _handleDataChanged(e) {\n          var that = this;\n          var dataSource = that._dataSource;\n          var columnsController = that._columnsController;\n          var isAsyncDataSourceApplying = false;\n          this._isFirstLoading = false;\n\n          if (dataSource && !that._isDataSourceApplying) {\n            that._isDataSourceApplying = true;\n            (0, _deferred.when)(that._columnsController.applyDataSource(dataSource)).done(function () {\n              if (that._isLoading) {\n                that._handleLoadingChanged(false);\n              }\n\n              if (isAsyncDataSourceApplying && e && e.isDelayed) {\n                e.isDelayed = false;\n              }\n\n              that._isDataSourceApplying = false;\n\n              var hasAdditionalFilter = function hasAdditionalFilter() {\n                var additionalFilter = that._calculateAdditionalFilter();\n\n                return additionalFilter && additionalFilter.length;\n              };\n\n              var needApplyFilter = that._needApplyFilter;\n              that._needApplyFilter = false;\n\n              if (needApplyFilter && !that._isAllDataTypesDefined && hasAdditionalFilter()) {\n                _ui2.default.log(\"W1005\", that.component.NAME);\n\n                that._applyFilter();\n              } else {\n                that.updateItems(e, true);\n              }\n            }).fail(function () {\n              that._isDataSourceApplying = false;\n            });\n\n            if (that._isDataSourceApplying) {\n              isAsyncDataSourceApplying = true;\n\n              that._handleLoadingChanged(true);\n            }\n\n            that._needApplyFilter = !that._columnsController.isDataSourceApplied();\n            that._isAllDataTypesDefined = columnsController.isAllDataTypesDefined();\n          }\n        },\n        _handleLoadingChanged: function _handleLoadingChanged(isLoading) {\n          this._isLoading = isLoading;\n\n          this._fireLoadingChanged();\n        },\n        _handleLoadError: function _handleLoadError(e) {\n          this.dataErrorOccurred.fire(e);\n        },\n        fireError: function fireError() {\n          this.dataErrorOccurred.fire(_ui2.default.Error.apply(_ui2.default, arguments));\n        },\n        _setPagingOptions: function _setPagingOptions(dataSource) {\n          var pageIndex = this.option(\"paging.pageIndex\");\n          var pageSize = this.option(\"paging.pageSize\");\n          var pagingEnabled = this.option(\"paging.enabled\");\n          var scrollingMode = this.option(\"scrolling.mode\");\n          var appendMode = \"infinite\" === scrollingMode;\n          var virtualMode = \"virtual\" === scrollingMode;\n          var paginate = pagingEnabled || virtualMode || appendMode;\n          var isChanged = false;\n          dataSource.requireTotalCount(!appendMode);\n\n          if (void 0 !== pagingEnabled && dataSource.paginate() !== paginate) {\n            dataSource.paginate(paginate);\n            isChanged = true;\n          }\n\n          if (void 0 !== pageSize && dataSource.pageSize() !== pageSize) {\n            dataSource.pageSize(pageSize);\n            isChanged = true;\n          }\n\n          if (void 0 !== pageIndex && dataSource.pageIndex() !== pageIndex) {\n            dataSource.pageIndex(pageIndex);\n            isChanged = true;\n          }\n\n          return isChanged;\n        },\n        _getSpecificDataSourceOption: function _getSpecificDataSourceOption() {\n          var dataSource = this.option(\"dataSource\");\n\n          if (Array.isArray(dataSource)) {\n            return {\n              store: {\n                type: \"array\",\n                data: dataSource,\n                key: this.option(\"keyExpr\")\n              }\n            };\n          }\n\n          return dataSource;\n        },\n        _initDataSource: function _initDataSource() {\n          var that = this;\n          var dataSource = this.option(\"dataSource\");\n          var oldDataSource = this._dataSource;\n          that.callBase();\n          dataSource = that._dataSource;\n          that._isFirstLoading = true;\n\n          if (dataSource) {\n            that._setPagingOptions(dataSource);\n\n            that.setDataSource(dataSource);\n          } else {\n            if (oldDataSource) {\n              that.updateItems();\n            }\n          }\n        },\n        _loadDataSource: function _loadDataSource() {\n          var that = this;\n          var dataSource = that._dataSource;\n          var result = new _deferred.Deferred();\n          (0, _deferred.when)(this._columnsController.refresh(true)).always(function () {\n            if (dataSource) {\n              dataSource.load().done(result.resolve).fail(result.reject);\n            } else {\n              result.resolve();\n            }\n          });\n          return result.promise();\n        },\n        _beforeProcessItems: function _beforeProcessItems(items) {\n          return items.slice(0);\n        },\n        getRowIndexDelta: function getRowIndexDelta() {\n          return 0;\n        },\n        _processItems: function _processItems(items, change) {\n          var that = this;\n          var rowIndexDelta = that.getRowIndexDelta();\n          var changeType = change.changeType;\n\n          var visibleColumns = that._columnsController.getVisibleColumns(null, \"loadingAll\" === changeType);\n\n          var visibleItems = that._items;\n          var dataIndex = \"append\" === changeType && visibleItems.length > 0 ? visibleItems[visibleItems.length - 1].dataIndex + 1 : 0;\n          var options = {\n            visibleColumns: visibleColumns,\n            dataIndex: dataIndex\n          };\n          var result = [];\n          (0, _iterator.each)(items, function (index, item) {\n            if (_type2.default.isDefined(item)) {\n              options.rowIndex = index - rowIndexDelta;\n              item = that._processItem(item, options);\n              result.push(item);\n            }\n          });\n          return result;\n        },\n        _processItem: function _processItem(item, options) {\n          item = this._generateDataItem(item, options);\n          item = this._processDataItem(item, options);\n          item.dataIndex = options.dataIndex++;\n          return item;\n        },\n        _generateDataItem: function _generateDataItem(data) {\n          return {\n            rowType: \"data\",\n            data: data,\n            key: this.keyOf(data)\n          };\n        },\n        _processDataItem: function _processDataItem(dataItem, options) {\n          dataItem.values = this.generateDataValues(dataItem.data, options.visibleColumns);\n          return dataItem;\n        },\n        generateDataValues: function generateDataValues(data, columns, isModified) {\n          var values = [];\n          var column;\n          var value;\n\n          for (var i = 0; i < columns.length; i++) {\n            column = columns[i];\n            value = isModified ? void 0 : null;\n\n            if (!column.command) {\n              if (column.calculateCellValue) {\n                value = column.calculateCellValue(data);\n              } else {\n                if (column.dataField) {\n                  value = data[column.dataField];\n                }\n              }\n            }\n\n            values.push(value);\n          }\n\n          return values;\n        },\n        _applyChange: function _applyChange(change) {\n          var that = this;\n\n          if (\"update\" === change.changeType) {\n            that._applyChangeUpdate(change);\n          } else {\n            if (that.items().length && change.repaintChangesOnly && \"refresh\" === change.changeType) {\n              that._applyChangesOnly(change);\n            } else {\n              if (\"refresh\" === change.changeType) {\n                that._applyChangeFull(change);\n              }\n            }\n          }\n        },\n        _applyChangeFull: function _applyChangeFull(change) {\n          this._items = change.items.slice(0);\n        },\n        _getRowIndices: function _getRowIndices(change) {\n          var rowIndices = change.rowIndices.slice(0);\n          var rowIndexDelta = this.getRowIndexDelta();\n          rowIndices.sort(function (a, b) {\n            return a - b;\n          });\n\n          for (var i = 0; i < rowIndices.length; i++) {\n            var correctedRowIndex = rowIndices[i];\n\n            if (change.allowInvisibleRowIndices) {\n              correctedRowIndex += rowIndexDelta;\n            }\n\n            if (correctedRowIndex < 0) {\n              rowIndices.splice(i, 1);\n              i--;\n            }\n          }\n\n          return rowIndices;\n        },\n        _applyChangeUpdate: function _applyChangeUpdate(change) {\n          var that = this;\n          var items = change.items;\n\n          var rowIndices = that._getRowIndices(change);\n\n          var rowIndexDelta = that.getRowIndexDelta();\n          var repaintChangesOnly = that.option(\"repaintChangesOnly\");\n          var prevIndex = -1;\n          var rowIndexCorrection = 0;\n          var changeType;\n          change.items = [];\n          change.rowIndices = [];\n          change.columnIndices = [];\n          change.changeTypes = [];\n\n          var equalItems = function equalItems(item1, item2, strict) {\n            var result = item1 && item2 && (0, _common.equalByValue)(item1.key, item2.key);\n\n            if (result && strict) {\n              result = item1.rowType === item2.rowType && (\"detail\" !== item2.rowType || item1.isEditing === item2.isEditing);\n            }\n\n            return result;\n          };\n\n          (0, _iterator.each)(rowIndices, function (index, rowIndex) {\n            var oldItem;\n            var newItem;\n            var oldNextItem;\n            var newNextItem;\n            var strict;\n            var columnIndices;\n            rowIndex += rowIndexCorrection + rowIndexDelta;\n\n            if (prevIndex === rowIndex) {\n              return;\n            }\n\n            prevIndex = rowIndex;\n            oldItem = that._items[rowIndex];\n            oldNextItem = that._items[rowIndex + 1];\n            newItem = items[rowIndex];\n            newNextItem = items[rowIndex + 1];\n            strict = equalItems(oldItem, oldNextItem) || equalItems(newItem, newNextItem);\n\n            if (newItem) {\n              newItem.rowIndex = rowIndex;\n              change.items.push(newItem);\n            }\n\n            if (oldItem && newItem && equalItems(oldItem, newItem, strict)) {\n              changeType = \"update\";\n              that._items[rowIndex] = newItem;\n\n              if (oldItem.visible !== newItem.visible) {\n                change.items.splice(-1, 1, {\n                  visible: newItem.visible\n                });\n              } else {\n                if (repaintChangesOnly && !change.isFullUpdate) {\n                  newItem.cells = oldItem.cells;\n                  columnIndices = that._getChangedColumnIndices(oldItem, newItem, rowIndex - rowIndexDelta);\n                }\n              }\n            } else {\n              if (newItem && !oldItem || newNextItem && equalItems(oldItem, newNextItem, strict)) {\n                changeType = \"insert\";\n\n                that._items.splice(rowIndex, 0, newItem);\n\n                rowIndexCorrection++;\n              } else {\n                if (oldItem && !newItem || oldNextItem && equalItems(newItem, oldNextItem, strict)) {\n                  changeType = \"remove\";\n\n                  that._items.splice(rowIndex, 1);\n\n                  rowIndexCorrection--;\n                  prevIndex = -1;\n                } else {\n                  if (newItem) {\n                    changeType = \"update\";\n                    that._items[rowIndex] = newItem;\n                  } else {\n                    return;\n                  }\n                }\n              }\n            }\n\n            change.rowIndices.push(rowIndex - rowIndexDelta);\n            change.changeTypes.push(changeType);\n            change.columnIndices.push(columnIndices);\n          });\n        },\n        _isCellChanged: function _isCellChanged(oldRow, newRow, visibleRowIndex, columnIndex, isLiveUpdate) {\n          if (JSON.stringify(oldRow.values[columnIndex]) !== JSON.stringify(newRow.values[columnIndex])) {\n            return true;\n          }\n\n          function isCellModified(row, columnIndex) {\n            return row.modifiedValues ? void 0 !== row.modifiedValues[columnIndex] : false;\n          }\n\n          if (isCellModified(oldRow, columnIndex) !== isCellModified(newRow, columnIndex)) {\n            return true;\n          }\n\n          return false;\n        },\n        _getChangedColumnIndices: function _getChangedColumnIndices(oldItem, newItem, visibleRowIndex, isLiveUpdate) {\n          if (oldItem.rowType === newItem.rowType && \"group\" !== newItem.rowType && \"groupFooter\" !== newItem.rowType) {\n            var columnIndices = [];\n\n            if (\"detail\" !== newItem.rowType) {\n              for (var columnIndex = 0; columnIndex < oldItem.values.length; columnIndex++) {\n                if (this._isCellChanged(oldItem, newItem, visibleRowIndex, columnIndex, isLiveUpdate)) {\n                  columnIndices.push(columnIndex);\n                } else {\n                  var cell = oldItem.cells && oldItem.cells[columnIndex];\n\n                  if (cell && cell.update) {\n                    cell.update(newItem);\n                  }\n                }\n              }\n            }\n\n            oldItem.update && oldItem.update(newItem);\n            return columnIndices;\n          }\n        },\n        _isItemEquals: function _isItemEquals(item1, item2) {\n          if (JSON.stringify(item1.values) !== JSON.stringify(item2.values)) {\n            return false;\n          }\n\n          var compareFields = [\"modified\", \"isNewRow\", \"removed\", \"isEditing\"];\n\n          if (compareFields.some(function (field) {\n            return item1[field] !== item2[field];\n          })) {\n            return false;\n          }\n\n          if (\"group\" === item1.rowType || \"groupFooter\" === item1.rowType) {\n            if (item1.isExpanded !== item2.isExpanded || JSON.stringify(item1.summaryCells) !== JSON.stringify(item2.summaryCells)) {\n              return false;\n            }\n          }\n\n          return true;\n        },\n        _applyChangesOnly: function _applyChangesOnly(change) {\n          var _this = this;\n\n          var rowIndices = [];\n          var columnIndices = [];\n          var changeTypes = [];\n          var items = [];\n          var newIndexByKey = {};\n\n          function getRowKey(row) {\n            if (row) {\n              return row.rowType + \",\" + JSON.stringify(row.key);\n            }\n          }\n\n          var isItemEquals = function isItemEquals(item1, item2) {\n            if (!_this._isItemEquals(item1, item2)) {\n              return false;\n            }\n\n            if (item1.cells) {\n              item1.update && item1.update(item2);\n              item1.cells.forEach(function (cell) {\n                if (cell && cell.update) {\n                  cell.update(item2);\n                }\n              });\n            }\n\n            return true;\n          };\n\n          var oldItems = this._items.slice();\n\n          change.items.forEach(function (item, index) {\n            var key = getRowKey(item);\n            newIndexByKey[key] = index;\n            item.rowIndex = index;\n          });\n          var result = (0, _array_compare.findChanges)(oldItems, change.items, getRowKey, isItemEquals);\n\n          if (!result) {\n            this._applyChangeFull(change);\n\n            return;\n          }\n\n          result.forEach(function (change) {\n            switch (change.type) {\n              case \"update\":\n                var index = change.index;\n                var newItem = change.data;\n                var oldItem = change.oldItem;\n\n                var currentColumnIndices = _this._getChangedColumnIndices(oldItem, newItem, index, true);\n\n                rowIndices.push(index);\n                changeTypes.push(\"update\");\n                items.push(newItem);\n                _this._items[index] = newItem;\n                newItem.cells = oldItem.cells;\n                newItem.oldValues = oldItem.values;\n                columnIndices.push(currentColumnIndices);\n                break;\n\n              case \"insert\":\n                rowIndices.push(change.index);\n                changeTypes.push(\"insert\");\n                items.push(change.data);\n                columnIndices.push(void 0);\n\n                _this._items.splice(change.index, 0, change.data);\n\n                break;\n\n              case \"remove\":\n                rowIndices.push(change.index);\n                changeTypes.push(\"remove\");\n\n                _this._items.splice(change.index, 1);\n\n                items.push(change.oldItem);\n                columnIndices.push(void 0);\n            }\n          });\n          change.repaintChangesOnly = true;\n          change.changeType = \"update\";\n          change.rowIndices = rowIndices;\n          change.columnIndices = columnIndices;\n          change.changeTypes = changeTypes;\n          change.items = items;\n\n          if (oldItems.length) {\n            change.isLiveUpdate = true;\n          }\n\n          this._correctRowIndices(function (rowIndex) {\n            var oldItem = oldItems[rowIndex];\n            var key = getRowKey(oldItem);\n            var newRowIndex = newIndexByKey[key];\n            return newRowIndex >= 0 ? newRowIndex - rowIndex : 0;\n          });\n        },\n        _correctRowIndices: _common.noop,\n        _updateItemsCore: function _updateItemsCore(change) {\n          var that = this;\n          var items;\n          var oldItems;\n          var dataSource = that._dataSource;\n          var changeType = change.changeType || \"refresh\";\n          change.changeType = changeType;\n\n          if (dataSource) {\n            items = change.items || dataSource.items();\n            items = that._beforeProcessItems(items);\n            items = that._processItems(items, change);\n            change.items = items;\n            oldItems = that._items.length === items.length && that._items;\n\n            that._applyChange(change);\n\n            (0, _iterator.each)(that._items, function (index, item) {\n              item.rowIndex = index;\n\n              if (oldItems) {\n                item.cells = oldItems[index].cells || [];\n              }\n            });\n          } else {\n            that._items = [];\n          }\n        },\n        _handleChanging: function _handleChanging(e) {\n          var that = this;\n          var rows = that.getVisibleRows();\n          var dataSource = that.dataSource();\n\n          if (dataSource) {\n            e.changes.forEach(function (change) {\n              if (\"insert\" === change.type && change.index >= 0) {\n                var dataIndex = 0;\n                var row;\n\n                for (var i = 0; i < change.index; i++) {\n                  row = rows[i];\n\n                  if (row && (\"data\" === row.rowType || \"group\" === row.rowType)) {\n                    dataIndex++;\n                  }\n                }\n\n                change.index = dataIndex;\n              }\n            });\n          }\n        },\n        updateItems: function updateItems(change, isDataChanged) {\n          change = change || {};\n          var that = this;\n\n          if (void 0 !== that._repaintChangesOnly) {\n            change.repaintChangesOnly = that._repaintChangesOnly;\n          } else {\n            if (change.changes) {\n              change.repaintChangesOnly = that.option(\"repaintChangesOnly\");\n            } else {\n              if (isDataChanged) {\n                var operationTypes = that.dataSource().operationTypes();\n                change.repaintChangesOnly = operationTypes && !operationTypes.grouping && !operationTypes.filtering && that.option(\"repaintChangesOnly\");\n                change.isDataChanged = true;\n\n                if (operationTypes && (operationTypes.reload || operationTypes.paging || operationTypes.groupExpanding)) {\n                  change.needUpdateDimensions = true;\n                }\n              }\n            }\n          }\n\n          if (that._updateLockCount) {\n            that._changes.push(change);\n\n            return;\n          }\n\n          that._updateItemsCore(change);\n\n          if (change.cancel) {\n            return;\n          }\n\n          that._fireChanged(change);\n        },\n        loadingOperationTypes: function loadingOperationTypes() {\n          var dataSource = this.dataSource();\n          return dataSource && dataSource.loadingOperationTypes() || {};\n        },\n        _fireChanged: function _fireChanged(change) {\n          var that = this;\n          (0, _common.deferRender)(function () {\n            that.changed.fire(change);\n          });\n        },\n        isLoading: function isLoading() {\n          return this._isLoading || this._isCustomLoading;\n        },\n        _fireLoadingChanged: function _fireLoadingChanged() {\n          this.loadingChanged.fire(this.isLoading(), this._loadingText);\n        },\n        _calculateAdditionalFilter: function _calculateAdditionalFilter() {\n          return null;\n        },\n        _applyFilter: function _applyFilter() {\n          var that = this;\n          var dataSource = that._dataSource;\n\n          if (dataSource) {\n            dataSource.pageIndex(0);\n            return that.reload().done(that.pageChanged.fire.bind(that.pageChanged));\n          }\n        },\n        filter: function filter(filterExpr) {\n          var dataSource = this._dataSource;\n          var filter = dataSource && dataSource.filter();\n\n          if (0 === arguments.length) {\n            return filter;\n          }\n\n          filterExpr = arguments.length > 1 ? Array.prototype.slice.call(arguments, 0) : filterExpr;\n\n          if (_uiGrid_core4.default.equalFilterParameters(filter, filterExpr)) {\n            return;\n          }\n\n          if (dataSource) {\n            dataSource.filter(filterExpr);\n          }\n\n          this._applyFilter();\n        },\n        clearFilter: function clearFilter(filterName) {\n          var that = this;\n          var columnsController = that._columnsController;\n\n          var clearColumnOption = function clearColumnOption(optionName) {\n            var columnCount = columnsController.columnCount();\n            var index;\n\n            for (index = 0; index < columnCount; index++) {\n              columnsController.columnOption(index, optionName, void 0);\n            }\n          };\n\n          that.component.beginUpdate();\n\n          if (arguments.length > 0) {\n            switch (filterName) {\n              case \"dataSource\":\n                that.filter(null);\n                break;\n\n              case \"search\":\n                that.searchByText(\"\");\n                break;\n\n              case \"header\":\n                clearColumnOption(\"filterValues\");\n                break;\n\n              case \"row\":\n                clearColumnOption(\"filterValue\");\n            }\n          } else {\n            that.filter(null);\n            that.searchByText(\"\");\n            clearColumnOption(\"filterValue\");\n            clearColumnOption(\"bufferedFilterValue\");\n            clearColumnOption(\"filterValues\");\n          }\n\n          that.component.endUpdate();\n        },\n        _fireDataSourceChanged: function _fireDataSourceChanged() {\n          var that = this;\n\n          var changedHandler = function changedHandler() {\n            that.changed.remove(changedHandler);\n            that.dataSourceChanged.fire();\n          };\n\n          that.changed.add(changedHandler);\n        },\n        _getDataSourceAdapter: _common.noop,\n        _createDataSourceAdapterCore: function _createDataSourceAdapterCore(dataSource, remoteOperations) {\n          var dataSourceAdapterProvider = this._getDataSourceAdapter();\n\n          var dataSourceAdapter = dataSourceAdapterProvider.create(this.component);\n          dataSourceAdapter.init(dataSource, remoteOperations);\n          return dataSourceAdapter;\n        },\n        isLocalStore: function isLocalStore(store) {\n          store = store || this.store();\n          return store instanceof _array_store2.default;\n        },\n        isCustomStore: function isCustomStore(store) {\n          store = store || this.store();\n          return store instanceof _custom_store2.default;\n        },\n        _createDataSourceAdapter: function _createDataSourceAdapter(dataSource) {\n          var remoteOperations = this.option(\"remoteOperations\");\n          var store = dataSource.store();\n          var enabledRemoteOperations = {\n            filtering: true,\n            sorting: true,\n            paging: true,\n            grouping: true,\n            summary: true\n          };\n\n          if (remoteOperations && remoteOperations.groupPaging) {\n            remoteOperations = (0, _extend.extend)({}, enabledRemoteOperations, remoteOperations);\n          }\n\n          if (\"auto\" === remoteOperations) {\n            remoteOperations = this.isLocalStore(store) || this.isCustomStore(store) ? {} : {\n              filtering: true,\n              sorting: true,\n              paging: true\n            };\n          }\n\n          if (true === remoteOperations) {\n            remoteOperations = enabledRemoteOperations;\n          }\n\n          return this._createDataSourceAdapterCore(dataSource, remoteOperations);\n        },\n        setDataSource: function setDataSource(dataSource) {\n          var that = this;\n          var oldDataSource = that._dataSource;\n\n          if (!dataSource && oldDataSource) {\n            oldDataSource.changed.remove(that._dataChangedHandler);\n            oldDataSource.loadingChanged.remove(that._loadingChangedHandler);\n            oldDataSource.loadError.remove(that._loadErrorHandler);\n            oldDataSource.customizeStoreLoadOptions.remove(that._customizeStoreLoadOptionsHandler);\n            oldDataSource.changing.remove(that._changingHandler);\n            oldDataSource.cancelAll();\n            oldDataSource.dispose(that._isSharedDataSource);\n          }\n\n          if (dataSource) {\n            dataSource = that._createDataSourceAdapter(dataSource);\n          }\n\n          that._dataSource = dataSource;\n\n          if (dataSource) {\n            that._fireDataSourceChanged();\n\n            that._isLoading = !dataSource.isLoaded();\n            that._needApplyFilter = true;\n            that._isAllDataTypesDefined = that._columnsController.isAllDataTypesDefined();\n            dataSource.changed.add(that._dataChangedHandler);\n            dataSource.loadingChanged.add(that._loadingChangedHandler);\n            dataSource.loadError.add(that._loadErrorHandler);\n            dataSource.customizeStoreLoadOptions.add(that._customizeStoreLoadOptionsHandler);\n            dataSource.changing.add(that._changingHandler);\n          }\n        },\n        items: function items() {\n          return this._items;\n        },\n        isEmpty: function isEmpty() {\n          return !this.items().length;\n        },\n        pageCount: function pageCount() {\n          return this._dataSource ? this._dataSource.pageCount() : 1;\n        },\n        dataSource: function dataSource() {\n          return this._dataSource;\n        },\n        store: function store() {\n          var dataSource = this._dataSource;\n          return dataSource && dataSource.store();\n        },\n        loadAll: function loadAll(data) {\n          var that = this;\n          var d = new _deferred.Deferred();\n          var dataSource = that._dataSource;\n\n          if (dataSource) {\n            if (data) {\n              var options = {\n                data: data,\n                isCustomLoading: true,\n                storeLoadOptions: {\n                  isLoadingAll: true\n                },\n                loadOptions: {\n                  filter: that.getCombinedFilter(),\n                  group: dataSource.group(),\n                  sort: dataSource.sort()\n                }\n              };\n\n              dataSource._handleDataLoaded(options);\n\n              (0, _deferred.when)(options.data).done(function (data) {\n                data = that._beforeProcessItems(data);\n                d.resolve(that._processItems(data, {\n                  changeType: \"loadingAll\"\n                }), options.extra && options.extra.summary);\n              }).fail(d.reject);\n            } else {\n              if (!dataSource.isLoading()) {\n                var loadOptions = (0, _extend.extend)({}, dataSource.loadOptions(), {\n                  isLoadingAll: true,\n                  requireTotalCount: false\n                });\n                dataSource.load(loadOptions).done(function (items, extra) {\n                  items = that._beforeProcessItems(items);\n                  items = that._processItems(items, {\n                    changeType: \"loadingAll\"\n                  });\n                  d.resolve(items, extra && extra.summary);\n                }).fail(d.reject);\n              } else {\n                d.reject();\n              }\n            }\n          } else {\n            d.resolve([]);\n          }\n\n          return d;\n        },\n        getKeyByRowIndex: function getKeyByRowIndex(rowIndex) {\n          var item = this.items()[rowIndex];\n\n          if (item) {\n            return item.key;\n          }\n        },\n        getRowIndexByKey: function getRowIndexByKey(key) {\n          return _uiGrid_core4.default.getIndexByKey(key, this.items());\n        },\n        keyOf: function keyOf(data) {\n          var store = this.store();\n\n          if (store) {\n            return store.keyOf(data);\n          }\n        },\n        byKey: function byKey(key) {\n          var store = this.store();\n          var rowIndex = this.getRowIndexByKey(key);\n          var result;\n\n          if (!store) {\n            return;\n          }\n\n          if (rowIndex >= 0) {\n            result = new _deferred.Deferred().resolve(this.items()[rowIndex].data);\n          }\n\n          return result || store.byKey(key);\n        },\n        key: function key() {\n          var store = this.store();\n\n          if (store) {\n            return store.key();\n          }\n        },\n        getRowIndexOffset: function getRowIndexOffset() {\n          return 0;\n        },\n        getDataByKeys: function getDataByKeys(rowKeys) {\n          var that = this;\n          var result = new _deferred.Deferred();\n          var deferreds = [];\n          var data = [];\n          (0, _iterator.each)(rowKeys, function (index, key) {\n            deferreds.push(that.byKey(key).done(function (keyData) {\n              data[index] = keyData;\n            }));\n          });\n\n          _deferred.when.apply(_renderer2.default, deferreds).always(function () {\n            result.resolve(data);\n          });\n\n          return result;\n        },\n        pageIndex: function pageIndex(value) {\n          return changePaging(this, \"pageIndex\", value);\n        },\n        pageSize: function pageSize(value) {\n          return changePaging(this, \"pageSize\", value);\n        },\n        beginCustomLoading: function beginCustomLoading(messageText) {\n          this._isCustomLoading = true;\n          this._loadingText = messageText || \"\";\n\n          this._fireLoadingChanged();\n        },\n        endCustomLoading: function endCustomLoading() {\n          this._isCustomLoading = false;\n          this._loadingText = void 0;\n\n          this._fireLoadingChanged();\n        },\n        refresh: function refresh(options) {\n          if (true === options) {\n            options = {\n              reload: true,\n              changesOnly: true\n            };\n          } else {\n            if (!options) {\n              options = {\n                lookup: true,\n                selection: true,\n                reload: true\n              };\n            }\n          }\n\n          var that = this;\n          var dataSource = that.getDataSource();\n          var changesOnly = options.changesOnly;\n          var d = new _deferred.Deferred();\n\n          var customizeLoadResult = function customizeLoadResult() {\n            that._repaintChangesOnly = !!changesOnly;\n          };\n\n          (0, _deferred.when)(!options.lookup || that._columnsController.refresh()).always(function () {\n            if (options.load || options.reload) {\n              dataSource && dataSource.on(\"customizeLoadResult\", customizeLoadResult);\n              (0, _deferred.when)(that.reload(options.reload, changesOnly)).always(function () {\n                dataSource && dataSource.off(\"customizeLoadResult\", customizeLoadResult);\n                that._repaintChangesOnly = void 0;\n              }).done(d.resolve).fail(d.reject);\n            } else {\n              that.updateItems({\n                repaintChangesOnly: options.changesOnly\n              });\n              d.resolve();\n            }\n          });\n          return d.promise();\n        },\n        getVisibleRows: function getVisibleRows() {\n          return this.items();\n        },\n        _disposeDataSource: function _disposeDataSource() {\n          this.setDataSource(null);\n        },\n        dispose: function dispose() {\n          this._disposeDataSource();\n\n          this.callBase.apply(this, arguments);\n        },\n        repaintRows: function repaintRows(rowIndexes, changesOnly) {\n          rowIndexes = Array.isArray(rowIndexes) ? rowIndexes : [rowIndexes];\n\n          if (rowIndexes.length > 1 || _type2.default.isDefined(rowIndexes[0])) {\n            this.updateItems({\n              changeType: \"update\",\n              rowIndices: rowIndexes,\n              isFullUpdate: !changesOnly\n            });\n          }\n        },\n        skipProcessingPagingChange: function skipProcessingPagingChange(fullName) {\n          return this._skipProcessingPagingChange && (\"paging.pageIndex\" === fullName || \"paging.pageSize\" === fullName);\n        },\n        getUserState: function getUserState() {\n          return {\n            searchText: this.option(\"searchPanel.text\"),\n            pageIndex: this.pageIndex(),\n            pageSize: this.pageSize()\n          };\n        },\n        getCachedStoreData: function getCachedStoreData() {\n          return this._dataSource && this._dataSource.getCachedStoreData();\n        }\n      };\n\n      _uiGrid_core4.default.proxyMethod(members, \"load\");\n\n      _uiGrid_core4.default.proxyMethod(members, \"reload\");\n\n      _uiGrid_core4.default.proxyMethod(members, \"push\");\n\n      _uiGrid_core4.default.proxyMethod(members, \"itemsCount\", 0);\n\n      _uiGrid_core4.default.proxyMethod(members, \"totalItemsCount\", 0);\n\n      _uiGrid_core4.default.proxyMethod(members, \"hasKnownLastPage\", true);\n\n      _uiGrid_core4.default.proxyMethod(members, \"isLoaded\", true);\n\n      _uiGrid_core4.default.proxyMethod(members, \"totalCount\", 0);\n\n      return members;\n    }())\n  }\n};","map":{"version":3,"sources":["C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/devextreme/ui/grid_core/ui.grid_core.data_controller.js"],"names":["_renderer","require","_renderer2","_interopRequireDefault","_uiGrid_core","_uiGrid_core2","_uiGrid_core3","_uiGrid_core4","_array_store","_array_store2","_custom_store","_custom_store2","_ui","_ui2","_common","_iterator","_type","_type2","_extend","_data_helper","_data_helper2","_deferred","_array_compare","obj","module","defaultOptions","loadingTimeout","dataSource","cacheEnabled","repaintChangesOnly","highlightChanges","onDataErrorOccurred","remoteOperations","paging","enabled","pageSize","pageIndex","controllers","data","changePaging","that","members","init","error","callbackNames","callbackFlags","stopOnFalse","publicMethods","reset","optionChanged","args","Array","store","handled","isReady","getDataSource","getCombinedFilter","combinedFilter","columnsController","filter","additionalFilter","returnDataField","waitReady","_endUpdateCore","changes","change","_handleCustomizeStoreLoadOptions","storeLoadOptions","e","_handleColumnsChanged","changeTypes","optionNames","updateItemsHandler","filterValue","filterValues","filterApplied","column","_handleDataChanged","isAsyncDataSourceApplying","hasAdditionalFilter","needApplyFilter","_handleLoadingChanged","_handleLoadError","fireError","_setPagingOptions","pagingEnabled","scrollingMode","appendMode","virtualMode","paginate","isChanged","_getSpecificDataSourceOption","type","key","_initDataSource","oldDataSource","_loadDataSource","result","_beforeProcessItems","items","getRowIndexDelta","_processItems","rowIndexDelta","changeType","visibleColumns","visibleItems","dataIndex","options","index","item","_processItem","_generateDataItem","rowType","_processDataItem","dataItem","generateDataValues","values","i","columns","value","isModified","_applyChange","_applyChangeFull","_getRowIndices","rowIndices","a","correctedRowIndex","_applyChangeUpdate","prevIndex","rowIndexCorrection","equalItems","item1","item2","rowIndex","oldItem","oldNextItem","newItem","newNextItem","strict","visible","columnIndices","_isCellChanged","JSON","oldRow","newRow","row","isCellModified","_getChangedColumnIndices","columnIndex","cell","_isItemEquals","compareFields","_applyChangesOnly","_this","newIndexByKey","isItemEquals","oldItems","getRowKey","currentColumnIndices","newRowIndex","_correctRowIndices","_updateItemsCore","_handleChanging","rows","updateItems","operationTypes","loadingOperationTypes","_fireChanged","isLoading","_fireLoadingChanged","_calculateAdditionalFilter","_applyFilter","arguments","filterExpr","clearFilter","clearColumnOption","columnCount","_fireDataSourceChanged","changedHandler","_getDataSourceAdapter","_createDataSourceAdapterCore","dataSourceAdapterProvider","dataSourceAdapter","isLocalStore","isCustomStore","_createDataSourceAdapter","enabledRemoteOperations","filtering","sorting","grouping","summary","setDataSource","isEmpty","pageCount","loadAll","d","isCustomLoading","isLoadingAll","loadOptions","group","sort","requireTotalCount","extra","getKeyByRowIndex","getRowIndexByKey","keyOf","byKey","getRowIndexOffset","getDataByKeys","deferreds","beginCustomLoading","messageText","endCustomLoading","refresh","reload","changesOnly","lookup","selection","customizeLoadResult","getVisibleRows","_disposeDataSource","dispose","repaintRows","rowIndexes","isFullUpdate","skipProcessingPagingChange","getUserState","searchText","getCachedStoreData"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/grid_core/ui.grid_core.data_controller.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar _renderer = require(\"../../core/renderer\");\r\nvar _renderer2 = _interopRequireDefault(_renderer);\r\nvar _uiGrid_core = require(\"./ui.grid_core.modules\");\r\nvar _uiGrid_core2 = _interopRequireDefault(_uiGrid_core);\r\nvar _uiGrid_core3 = require(\"./ui.grid_core.utils\");\r\nvar _uiGrid_core4 = _interopRequireDefault(_uiGrid_core3);\r\nvar _array_store = require(\"../../data/array_store\");\r\nvar _array_store2 = _interopRequireDefault(_array_store);\r\nvar _custom_store = require(\"../../data/custom_store\");\r\nvar _custom_store2 = _interopRequireDefault(_custom_store);\r\nvar _ui = require(\"../widget/ui.errors\");\r\nvar _ui2 = _interopRequireDefault(_ui);\r\nvar _common = require(\"../../core/utils/common\");\r\nvar _iterator = require(\"../../core/utils/iterator\");\r\nvar _type = require(\"../../core/utils/type\");\r\nvar _type2 = _interopRequireDefault(_type);\r\nvar _extend = require(\"../../core/utils/extend\");\r\nvar _data_helper = require(\"../../data_helper\");\r\nvar _data_helper2 = _interopRequireDefault(_data_helper);\r\nvar _deferred = require(\"../../core/utils/deferred\");\r\nvar _array_compare = require(\"../../core/utils/array_compare\");\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\nmodule.exports = {\r\n    defaultOptions: function() {\r\n        return {\r\n            loadingTimeout: 0,\r\n            dataSource: null,\r\n            cacheEnabled: true,\r\n            repaintChangesOnly: false,\r\n            highlightChanges: false,\r\n            onDataErrorOccurred: null,\r\n            remoteOperations: \"auto\",\r\n            paging: {\r\n                enabled: true,\r\n                pageSize: void 0,\r\n                pageIndex: void 0\r\n            }\r\n        }\r\n    },\r\n    controllers: {\r\n        data: _uiGrid_core2.default.Controller.inherit({}).include(_data_helper2.default).inherit(function() {\r\n            var changePaging = function(that, optionName, value) {\r\n                var dataSource = that._dataSource;\r\n                if (dataSource) {\r\n                    if (void 0 !== value) {\r\n                        if (dataSource[optionName]() !== value) {\r\n                            if (\"pageSize\" === optionName) {\r\n                                dataSource.pageIndex(0)\r\n                            }\r\n                            dataSource[optionName](value);\r\n                            that._skipProcessingPagingChange = true;\r\n                            that.option(\"paging.\" + optionName, value);\r\n                            that._skipProcessingPagingChange = false;\r\n                            return dataSource[\"pageIndex\" === optionName ? \"load\" : \"reload\"]().done(that.pageChanged.fire.bind(that.pageChanged))\r\n                        }\r\n                        return (0, _deferred.Deferred)().resolve().promise()\r\n                    }\r\n                    return dataSource[optionName]()\r\n                }\r\n                return 0\r\n            };\r\n            var members = {\r\n                init: function() {\r\n                    var that = this;\r\n                    that._items = [];\r\n                    that._columnsController = that.getController(\"columns\");\r\n                    that._columnsChangedHandler = that._handleColumnsChanged.bind(that);\r\n                    that._dataChangedHandler = that._handleDataChanged.bind(that);\r\n                    that._loadingChangedHandler = that._handleLoadingChanged.bind(that);\r\n                    that._loadErrorHandler = that._handleLoadError.bind(that);\r\n                    that._customizeStoreLoadOptionsHandler = that._handleCustomizeStoreLoadOptions.bind(that);\r\n                    that._changingHandler = that._handleChanging.bind(that);\r\n                    that._columnsController.columnsChanged.add(that._columnsChangedHandler);\r\n                    that._isLoading = false;\r\n                    that._isCustomLoading = false;\r\n                    that._repaintChangesOnly = void 0;\r\n                    that._changes = [];\r\n                    that.createAction(\"onDataErrorOccurred\");\r\n                    that.dataErrorOccurred.add(function(error) {\r\n                        return that.executeAction(\"onDataErrorOccurred\", {\r\n                            error: error\r\n                        })\r\n                    });\r\n                    that._refreshDataSource()\r\n                },\r\n                callbackNames: function() {\r\n                    return [\"changed\", \"loadingChanged\", \"dataErrorOccurred\", \"pageChanged\", \"dataSourceChanged\"]\r\n                },\r\n                callbackFlags: function(name) {\r\n                    if (\"dataErrorOccurred\" === name) {\r\n                        return {\r\n                            stopOnFalse: true\r\n                        }\r\n                    }\r\n                },\r\n                publicMethods: function() {\r\n                    return [\"beginCustomLoading\", \"endCustomLoading\", \"refresh\", \"filter\", \"clearFilter\", \"getCombinedFilter\", \"keyOf\", \"byKey\", \"getDataByKeys\", \"pageIndex\", \"pageSize\", \"pageCount\", \"totalCount\", \"_disposeDataSource\", \"getKeyByRowIndex\", \"getRowIndexByKey\", \"getDataSource\", \"getVisibleRows\", \"repaintRows\"]\r\n                },\r\n                reset: function() {\r\n                    this._columnsController.reset();\r\n                    this._items = [];\r\n                    this._refreshDataSource()\r\n                },\r\n                optionChanged: function(args) {\r\n                    var that = this;\r\n                    var dataSource;\r\n\r\n                    function handled() {\r\n                        args.handled = true\r\n                    }\r\n                    if (\"dataSource\" === args.name && args.name === args.fullName && (args.value === args.previousValue || that.option(\"columns\") && Array.isArray(args.value) && Array.isArray(args.previousValue))) {\r\n                        if (args.value !== args.previousValue) {\r\n                            var store = that.store();\r\n                            if (store) {\r\n                                store._array = args.value\r\n                            }\r\n                        }\r\n                        handled();\r\n                        that.refresh(that.option(\"repaintChangesOnly\"));\r\n                        return\r\n                    }\r\n                    switch (args.name) {\r\n                        case \"cacheEnabled\":\r\n                        case \"repaintChangesOnly\":\r\n                        case \"highlightChanges\":\r\n                        case \"loadingTimeout\":\r\n                            handled();\r\n                            break;\r\n                        case \"remoteOperations\":\r\n                        case \"keyExpr\":\r\n                        case \"dataSource\":\r\n                        case \"scrolling\":\r\n                            handled();\r\n                            that.reset();\r\n                            break;\r\n                        case \"paging\":\r\n                            dataSource = that.dataSource();\r\n                            if (dataSource && that._setPagingOptions(dataSource)) {\r\n                                dataSource.load().done(that.pageChanged.fire.bind(that.pageChanged))\r\n                            }\r\n                            handled();\r\n                            break;\r\n                        case \"rtlEnabled\":\r\n                            that.reset();\r\n                            break;\r\n                        case \"columns\":\r\n                            dataSource = that.dataSource();\r\n                            if (dataSource && dataSource.isLoading() && args.name === args.fullName) {\r\n                                dataSource.load()\r\n                            }\r\n                            break;\r\n                        default:\r\n                            that.callBase(args)\r\n                    }\r\n                },\r\n                isReady: function() {\r\n                    return !this._isLoading\r\n                },\r\n                getDataSource: function() {\r\n                    return this._dataSource && this._dataSource._dataSource\r\n                },\r\n                getCombinedFilter: function(returnDataField) {\r\n                    return this.combinedFilter(void 0, returnDataField)\r\n                },\r\n                combinedFilter: function(filter, returnDataField) {\r\n                    var that = this;\r\n                    var dataSource = that._dataSource;\r\n                    var columnsController = that._columnsController;\r\n                    var additionalFilter;\r\n                    if (dataSource) {\r\n                        if (void 0 === filter) {\r\n                            filter = dataSource.filter()\r\n                        }\r\n                        additionalFilter = that._calculateAdditionalFilter();\r\n                        if (additionalFilter) {\r\n                            if (columnsController.isDataSourceApplied() || columnsController.isAllDataTypesDefined()) {\r\n                                filter = _uiGrid_core4.default.combineFilters([additionalFilter, filter])\r\n                            }\r\n                        }\r\n                        filter = columnsController.updateFilter(filter, returnDataField || dataSource.remoteOperations().filtering)\r\n                    }\r\n                    return filter\r\n                },\r\n                waitReady: function() {\r\n                    if (this._updateLockCount) {\r\n                        this._readyDeferred = new _deferred.Deferred;\r\n                        return this._readyDeferred\r\n                    }\r\n                    return (0, _deferred.when)()\r\n                },\r\n                _endUpdateCore: function() {\r\n                    var changes = this._changes;\r\n                    if (changes.length) {\r\n                        this._changes = [];\r\n                        var repaintChangesOnly = changes.every(function(change) {\r\n                            return change.repaintChangesOnly\r\n                        });\r\n                        this.updateItems(1 === changes.length ? changes[0] : {\r\n                            repaintChangesOnly: repaintChangesOnly\r\n                        })\r\n                    }\r\n                    if (this._readyDeferred) {\r\n                        this._readyDeferred.resolve();\r\n                        this._readyDeferred = null\r\n                    }\r\n                },\r\n                _handleCustomizeStoreLoadOptions: function(e) {\r\n                    var columnsController = this._columnsController;\r\n                    var dataSource = this._dataSource;\r\n                    var storeLoadOptions = e.storeLoadOptions;\r\n                    if (e.isCustomLoading && !storeLoadOptions.isLoadingAll) {\r\n                        return\r\n                    }\r\n                    storeLoadOptions.filter = this.combinedFilter(storeLoadOptions.filter);\r\n                    if (!columnsController.isDataSourceApplied()) {\r\n                        columnsController.updateColumnDataTypes(dataSource)\r\n                    }\r\n                    this._columnsUpdating = true;\r\n                    columnsController.updateSortingGrouping(dataSource, !this._isFirstLoading);\r\n                    this._columnsUpdating = false;\r\n                    storeLoadOptions.sort = columnsController.getSortDataSourceParameters();\r\n                    storeLoadOptions.group = columnsController.getGroupDataSourceParameters();\r\n                    dataSource.sort(storeLoadOptions.sort);\r\n                    dataSource.group(storeLoadOptions.group);\r\n                    storeLoadOptions.sort = columnsController.getSortDataSourceParameters(!dataSource.remoteOperations().sorting);\r\n                    e.group = columnsController.getGroupDataSourceParameters(!dataSource.remoteOperations().grouping)\r\n                },\r\n                _handleColumnsChanged: function(e) {\r\n                    var that = this;\r\n                    var changeTypes = e.changeTypes;\r\n                    var optionNames = e.optionNames;\r\n                    var filterValue;\r\n                    var filterValues;\r\n                    var filterApplied;\r\n                    var updateItemsHandler = function updateItemsHandler() {\r\n                        that._columnsController.columnsChanged.remove(updateItemsHandler);\r\n                        that.updateItems()\r\n                    };\r\n                    if (changeTypes.sorting || changeTypes.grouping) {\r\n                        if (that._dataSource && !that._columnsUpdating) {\r\n                            that._dataSource.group(that._columnsController.getGroupDataSourceParameters());\r\n                            that._dataSource.sort(that._columnsController.getSortDataSourceParameters());\r\n                            that.reload()\r\n                        }\r\n                    } else {\r\n                        if (changeTypes.columns) {\r\n                            if (optionNames.filterValues || optionNames.filterValue || optionNames.selectedFilterOperation) {\r\n                                filterValue = that._columnsController.columnOption(e.columnIndex, \"filterValue\");\r\n                                filterValues = that._columnsController.columnOption(e.columnIndex, \"filterValues\");\r\n                                if (Array.isArray(filterValues) || void 0 === e.columnIndex || _type2.default.isDefined(filterValue) || !optionNames.selectedFilterOperation || optionNames.filterValue) {\r\n                                    that._applyFilter();\r\n                                    filterApplied = true\r\n                                }\r\n                            }\r\n                            if (!that._needApplyFilter && !_uiGrid_core4.default.checkChanges(optionNames, [\"width\", \"visibleWidth\", \"filterValue\", \"bufferedFilterValue\", \"selectedFilterOperation\", \"filterValues\", \"filterType\"])) {\r\n                                that._columnsController.columnsChanged.add(updateItemsHandler)\r\n                            }\r\n                            if (_type2.default.isDefined(optionNames.visible)) {\r\n                                var column = that._columnsController.columnOption(e.columnIndex);\r\n                                if (column && (_type2.default.isDefined(column.filterValue) || _type2.default.isDefined(column.filterValues))) {\r\n                                    that._applyFilter();\r\n                                    filterApplied = true\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                    if (!filterApplied && changeTypes.filtering) {\r\n                        that.reload()\r\n                    }\r\n                },\r\n                _handleDataChanged: function(e) {\r\n                    var that = this;\r\n                    var dataSource = that._dataSource;\r\n                    var columnsController = that._columnsController;\r\n                    var isAsyncDataSourceApplying = false;\r\n                    this._isFirstLoading = false;\r\n                    if (dataSource && !that._isDataSourceApplying) {\r\n                        that._isDataSourceApplying = true;\r\n                        (0, _deferred.when)(that._columnsController.applyDataSource(dataSource)).done(function() {\r\n                            if (that._isLoading) {\r\n                                that._handleLoadingChanged(false)\r\n                            }\r\n                            if (isAsyncDataSourceApplying && e && e.isDelayed) {\r\n                                e.isDelayed = false\r\n                            }\r\n                            that._isDataSourceApplying = false;\r\n                            var hasAdditionalFilter = function() {\r\n                                var additionalFilter = that._calculateAdditionalFilter();\r\n                                return additionalFilter && additionalFilter.length\r\n                            };\r\n                            var needApplyFilter = that._needApplyFilter;\r\n                            that._needApplyFilter = false;\r\n                            if (needApplyFilter && !that._isAllDataTypesDefined && hasAdditionalFilter()) {\r\n                                _ui2.default.log(\"W1005\", that.component.NAME);\r\n                                that._applyFilter()\r\n                            } else {\r\n                                that.updateItems(e, true)\r\n                            }\r\n                        }).fail(function() {\r\n                            that._isDataSourceApplying = false\r\n                        });\r\n                        if (that._isDataSourceApplying) {\r\n                            isAsyncDataSourceApplying = true;\r\n                            that._handleLoadingChanged(true)\r\n                        }\r\n                        that._needApplyFilter = !that._columnsController.isDataSourceApplied();\r\n                        that._isAllDataTypesDefined = columnsController.isAllDataTypesDefined()\r\n                    }\r\n                },\r\n                _handleLoadingChanged: function(isLoading) {\r\n                    this._isLoading = isLoading;\r\n                    this._fireLoadingChanged()\r\n                },\r\n                _handleLoadError: function(e) {\r\n                    this.dataErrorOccurred.fire(e)\r\n                },\r\n                fireError: function() {\r\n                    this.dataErrorOccurred.fire(_ui2.default.Error.apply(_ui2.default, arguments))\r\n                },\r\n                _setPagingOptions: function(dataSource) {\r\n                    var pageIndex = this.option(\"paging.pageIndex\");\r\n                    var pageSize = this.option(\"paging.pageSize\");\r\n                    var pagingEnabled = this.option(\"paging.enabled\");\r\n                    var scrollingMode = this.option(\"scrolling.mode\");\r\n                    var appendMode = \"infinite\" === scrollingMode;\r\n                    var virtualMode = \"virtual\" === scrollingMode;\r\n                    var paginate = pagingEnabled || virtualMode || appendMode;\r\n                    var isChanged = false;\r\n                    dataSource.requireTotalCount(!appendMode);\r\n                    if (void 0 !== pagingEnabled && dataSource.paginate() !== paginate) {\r\n                        dataSource.paginate(paginate);\r\n                        isChanged = true\r\n                    }\r\n                    if (void 0 !== pageSize && dataSource.pageSize() !== pageSize) {\r\n                        dataSource.pageSize(pageSize);\r\n                        isChanged = true\r\n                    }\r\n                    if (void 0 !== pageIndex && dataSource.pageIndex() !== pageIndex) {\r\n                        dataSource.pageIndex(pageIndex);\r\n                        isChanged = true\r\n                    }\r\n                    return isChanged\r\n                },\r\n                _getSpecificDataSourceOption: function() {\r\n                    var dataSource = this.option(\"dataSource\");\r\n                    if (Array.isArray(dataSource)) {\r\n                        return {\r\n                            store: {\r\n                                type: \"array\",\r\n                                data: dataSource,\r\n                                key: this.option(\"keyExpr\")\r\n                            }\r\n                        }\r\n                    }\r\n                    return dataSource\r\n                },\r\n                _initDataSource: function() {\r\n                    var that = this;\r\n                    var dataSource = this.option(\"dataSource\");\r\n                    var oldDataSource = this._dataSource;\r\n                    that.callBase();\r\n                    dataSource = that._dataSource;\r\n                    that._isFirstLoading = true;\r\n                    if (dataSource) {\r\n                        that._setPagingOptions(dataSource);\r\n                        that.setDataSource(dataSource)\r\n                    } else {\r\n                        if (oldDataSource) {\r\n                            that.updateItems()\r\n                        }\r\n                    }\r\n                },\r\n                _loadDataSource: function() {\r\n                    var that = this;\r\n                    var dataSource = that._dataSource;\r\n                    var result = new _deferred.Deferred;\r\n                    (0, _deferred.when)(this._columnsController.refresh(true)).always(function() {\r\n                        if (dataSource) {\r\n                            dataSource.load().done(result.resolve).fail(result.reject)\r\n                        } else {\r\n                            result.resolve()\r\n                        }\r\n                    });\r\n                    return result.promise()\r\n                },\r\n                _beforeProcessItems: function(items) {\r\n                    return items.slice(0)\r\n                },\r\n                getRowIndexDelta: function() {\r\n                    return 0\r\n                },\r\n                _processItems: function(items, change) {\r\n                    var that = this;\r\n                    var rowIndexDelta = that.getRowIndexDelta();\r\n                    var changeType = change.changeType;\r\n                    var visibleColumns = that._columnsController.getVisibleColumns(null, \"loadingAll\" === changeType);\r\n                    var visibleItems = that._items;\r\n                    var dataIndex = \"append\" === changeType && visibleItems.length > 0 ? visibleItems[visibleItems.length - 1].dataIndex + 1 : 0;\r\n                    var options = {\r\n                        visibleColumns: visibleColumns,\r\n                        dataIndex: dataIndex\r\n                    };\r\n                    var result = [];\r\n                    (0, _iterator.each)(items, function(index, item) {\r\n                        if (_type2.default.isDefined(item)) {\r\n                            options.rowIndex = index - rowIndexDelta;\r\n                            item = that._processItem(item, options);\r\n                            result.push(item)\r\n                        }\r\n                    });\r\n                    return result\r\n                },\r\n                _processItem: function(item, options) {\r\n                    item = this._generateDataItem(item, options);\r\n                    item = this._processDataItem(item, options);\r\n                    item.dataIndex = options.dataIndex++;\r\n                    return item\r\n                },\r\n                _generateDataItem: function(data) {\r\n                    return {\r\n                        rowType: \"data\",\r\n                        data: data,\r\n                        key: this.keyOf(data)\r\n                    }\r\n                },\r\n                _processDataItem: function(dataItem, options) {\r\n                    dataItem.values = this.generateDataValues(dataItem.data, options.visibleColumns);\r\n                    return dataItem\r\n                },\r\n                generateDataValues: function(data, columns, isModified) {\r\n                    var values = [];\r\n                    var column;\r\n                    var value;\r\n                    for (var i = 0; i < columns.length; i++) {\r\n                        column = columns[i];\r\n                        value = isModified ? void 0 : null;\r\n                        if (!column.command) {\r\n                            if (column.calculateCellValue) {\r\n                                value = column.calculateCellValue(data)\r\n                            } else {\r\n                                if (column.dataField) {\r\n                                    value = data[column.dataField]\r\n                                }\r\n                            }\r\n                        }\r\n                        values.push(value)\r\n                    }\r\n                    return values\r\n                },\r\n                _applyChange: function(change) {\r\n                    var that = this;\r\n                    if (\"update\" === change.changeType) {\r\n                        that._applyChangeUpdate(change)\r\n                    } else {\r\n                        if (that.items().length && change.repaintChangesOnly && \"refresh\" === change.changeType) {\r\n                            that._applyChangesOnly(change)\r\n                        } else {\r\n                            if (\"refresh\" === change.changeType) {\r\n                                that._applyChangeFull(change)\r\n                            }\r\n                        }\r\n                    }\r\n                },\r\n                _applyChangeFull: function(change) {\r\n                    this._items = change.items.slice(0)\r\n                },\r\n                _getRowIndices: function(change) {\r\n                    var rowIndices = change.rowIndices.slice(0);\r\n                    var rowIndexDelta = this.getRowIndexDelta();\r\n                    rowIndices.sort(function(a, b) {\r\n                        return a - b\r\n                    });\r\n                    for (var i = 0; i < rowIndices.length; i++) {\r\n                        var correctedRowIndex = rowIndices[i];\r\n                        if (change.allowInvisibleRowIndices) {\r\n                            correctedRowIndex += rowIndexDelta\r\n                        }\r\n                        if (correctedRowIndex < 0) {\r\n                            rowIndices.splice(i, 1);\r\n                            i--\r\n                        }\r\n                    }\r\n                    return rowIndices\r\n                },\r\n                _applyChangeUpdate: function(change) {\r\n                    var that = this;\r\n                    var items = change.items;\r\n                    var rowIndices = that._getRowIndices(change);\r\n                    var rowIndexDelta = that.getRowIndexDelta();\r\n                    var repaintChangesOnly = that.option(\"repaintChangesOnly\");\r\n                    var prevIndex = -1;\r\n                    var rowIndexCorrection = 0;\r\n                    var changeType;\r\n                    change.items = [];\r\n                    change.rowIndices = [];\r\n                    change.columnIndices = [];\r\n                    change.changeTypes = [];\r\n                    var equalItems = function(item1, item2, strict) {\r\n                        var result = item1 && item2 && (0, _common.equalByValue)(item1.key, item2.key);\r\n                        if (result && strict) {\r\n                            result = item1.rowType === item2.rowType && (\"detail\" !== item2.rowType || item1.isEditing === item2.isEditing)\r\n                        }\r\n                        return result\r\n                    };\r\n                    (0, _iterator.each)(rowIndices, function(index, rowIndex) {\r\n                        var oldItem;\r\n                        var newItem;\r\n                        var oldNextItem;\r\n                        var newNextItem;\r\n                        var strict;\r\n                        var columnIndices;\r\n                        rowIndex += rowIndexCorrection + rowIndexDelta;\r\n                        if (prevIndex === rowIndex) {\r\n                            return\r\n                        }\r\n                        prevIndex = rowIndex;\r\n                        oldItem = that._items[rowIndex];\r\n                        oldNextItem = that._items[rowIndex + 1];\r\n                        newItem = items[rowIndex];\r\n                        newNextItem = items[rowIndex + 1];\r\n                        strict = equalItems(oldItem, oldNextItem) || equalItems(newItem, newNextItem);\r\n                        if (newItem) {\r\n                            newItem.rowIndex = rowIndex;\r\n                            change.items.push(newItem)\r\n                        }\r\n                        if (oldItem && newItem && equalItems(oldItem, newItem, strict)) {\r\n                            changeType = \"update\";\r\n                            that._items[rowIndex] = newItem;\r\n                            if (oldItem.visible !== newItem.visible) {\r\n                                change.items.splice(-1, 1, {\r\n                                    visible: newItem.visible\r\n                                })\r\n                            } else {\r\n                                if (repaintChangesOnly && !change.isFullUpdate) {\r\n                                    newItem.cells = oldItem.cells;\r\n                                    columnIndices = that._getChangedColumnIndices(oldItem, newItem, rowIndex - rowIndexDelta)\r\n                                }\r\n                            }\r\n                        } else {\r\n                            if (newItem && !oldItem || newNextItem && equalItems(oldItem, newNextItem, strict)) {\r\n                                changeType = \"insert\";\r\n                                that._items.splice(rowIndex, 0, newItem);\r\n                                rowIndexCorrection++\r\n                            } else {\r\n                                if (oldItem && !newItem || oldNextItem && equalItems(newItem, oldNextItem, strict)) {\r\n                                    changeType = \"remove\";\r\n                                    that._items.splice(rowIndex, 1);\r\n                                    rowIndexCorrection--;\r\n                                    prevIndex = -1\r\n                                } else {\r\n                                    if (newItem) {\r\n                                        changeType = \"update\";\r\n                                        that._items[rowIndex] = newItem\r\n                                    } else {\r\n                                        return\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                        change.rowIndices.push(rowIndex - rowIndexDelta);\r\n                        change.changeTypes.push(changeType);\r\n                        change.columnIndices.push(columnIndices)\r\n                    })\r\n                },\r\n                _isCellChanged: function(oldRow, newRow, visibleRowIndex, columnIndex, isLiveUpdate) {\r\n                    if (JSON.stringify(oldRow.values[columnIndex]) !== JSON.stringify(newRow.values[columnIndex])) {\r\n                        return true\r\n                    }\r\n\r\n                    function isCellModified(row, columnIndex) {\r\n                        return row.modifiedValues ? void 0 !== row.modifiedValues[columnIndex] : false\r\n                    }\r\n                    if (isCellModified(oldRow, columnIndex) !== isCellModified(newRow, columnIndex)) {\r\n                        return true\r\n                    }\r\n                    return false\r\n                },\r\n                _getChangedColumnIndices: function(oldItem, newItem, visibleRowIndex, isLiveUpdate) {\r\n                    if (oldItem.rowType === newItem.rowType && \"group\" !== newItem.rowType && \"groupFooter\" !== newItem.rowType) {\r\n                        var columnIndices = [];\r\n                        if (\"detail\" !== newItem.rowType) {\r\n                            for (var columnIndex = 0; columnIndex < oldItem.values.length; columnIndex++) {\r\n                                if (this._isCellChanged(oldItem, newItem, visibleRowIndex, columnIndex, isLiveUpdate)) {\r\n                                    columnIndices.push(columnIndex)\r\n                                } else {\r\n                                    var cell = oldItem.cells && oldItem.cells[columnIndex];\r\n                                    if (cell && cell.update) {\r\n                                        cell.update(newItem)\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                        oldItem.update && oldItem.update(newItem);\r\n                        return columnIndices\r\n                    }\r\n                },\r\n                _isItemEquals: function(item1, item2) {\r\n                    if (JSON.stringify(item1.values) !== JSON.stringify(item2.values)) {\r\n                        return false\r\n                    }\r\n                    var compareFields = [\"modified\", \"isNewRow\", \"removed\", \"isEditing\"];\r\n                    if (compareFields.some(function(field) {\r\n                            return item1[field] !== item2[field]\r\n                        })) {\r\n                        return false\r\n                    }\r\n                    if (\"group\" === item1.rowType || \"groupFooter\" === item1.rowType) {\r\n                        if (item1.isExpanded !== item2.isExpanded || JSON.stringify(item1.summaryCells) !== JSON.stringify(item2.summaryCells)) {\r\n                            return false\r\n                        }\r\n                    }\r\n                    return true\r\n                },\r\n                _applyChangesOnly: function(change) {\r\n                    var _this = this;\r\n                    var rowIndices = [];\r\n                    var columnIndices = [];\r\n                    var changeTypes = [];\r\n                    var items = [];\r\n                    var newIndexByKey = {};\r\n\r\n                    function getRowKey(row) {\r\n                        if (row) {\r\n                            return row.rowType + \",\" + JSON.stringify(row.key)\r\n                        }\r\n                    }\r\n                    var isItemEquals = function(item1, item2) {\r\n                        if (!_this._isItemEquals(item1, item2)) {\r\n                            return false\r\n                        }\r\n                        if (item1.cells) {\r\n                            item1.update && item1.update(item2);\r\n                            item1.cells.forEach(function(cell) {\r\n                                if (cell && cell.update) {\r\n                                    cell.update(item2)\r\n                                }\r\n                            })\r\n                        }\r\n                        return true\r\n                    };\r\n                    var oldItems = this._items.slice();\r\n                    change.items.forEach(function(item, index) {\r\n                        var key = getRowKey(item);\r\n                        newIndexByKey[key] = index;\r\n                        item.rowIndex = index\r\n                    });\r\n                    var result = (0, _array_compare.findChanges)(oldItems, change.items, getRowKey, isItemEquals);\r\n                    if (!result) {\r\n                        this._applyChangeFull(change);\r\n                        return\r\n                    }\r\n                    result.forEach(function(change) {\r\n                        switch (change.type) {\r\n                            case \"update\":\r\n                                var index = change.index;\r\n                                var newItem = change.data;\r\n                                var oldItem = change.oldItem;\r\n                                var currentColumnIndices = _this._getChangedColumnIndices(oldItem, newItem, index, true);\r\n                                rowIndices.push(index);\r\n                                changeTypes.push(\"update\");\r\n                                items.push(newItem);\r\n                                _this._items[index] = newItem;\r\n                                newItem.cells = oldItem.cells;\r\n                                newItem.oldValues = oldItem.values;\r\n                                columnIndices.push(currentColumnIndices);\r\n                                break;\r\n                            case \"insert\":\r\n                                rowIndices.push(change.index);\r\n                                changeTypes.push(\"insert\");\r\n                                items.push(change.data);\r\n                                columnIndices.push(void 0);\r\n                                _this._items.splice(change.index, 0, change.data);\r\n                                break;\r\n                            case \"remove\":\r\n                                rowIndices.push(change.index);\r\n                                changeTypes.push(\"remove\");\r\n                                _this._items.splice(change.index, 1);\r\n                                items.push(change.oldItem);\r\n                                columnIndices.push(void 0)\r\n                        }\r\n                    });\r\n                    change.repaintChangesOnly = true;\r\n                    change.changeType = \"update\";\r\n                    change.rowIndices = rowIndices;\r\n                    change.columnIndices = columnIndices;\r\n                    change.changeTypes = changeTypes;\r\n                    change.items = items;\r\n                    if (oldItems.length) {\r\n                        change.isLiveUpdate = true\r\n                    }\r\n                    this._correctRowIndices(function(rowIndex) {\r\n                        var oldItem = oldItems[rowIndex];\r\n                        var key = getRowKey(oldItem);\r\n                        var newRowIndex = newIndexByKey[key];\r\n                        return newRowIndex >= 0 ? newRowIndex - rowIndex : 0\r\n                    })\r\n                },\r\n                _correctRowIndices: _common.noop,\r\n                _updateItemsCore: function(change) {\r\n                    var that = this;\r\n                    var items;\r\n                    var oldItems;\r\n                    var dataSource = that._dataSource;\r\n                    var changeType = change.changeType || \"refresh\";\r\n                    change.changeType = changeType;\r\n                    if (dataSource) {\r\n                        items = change.items || dataSource.items();\r\n                        items = that._beforeProcessItems(items);\r\n                        items = that._processItems(items, change);\r\n                        change.items = items;\r\n                        oldItems = that._items.length === items.length && that._items;\r\n                        that._applyChange(change);\r\n                        (0, _iterator.each)(that._items, function(index, item) {\r\n                            item.rowIndex = index;\r\n                            if (oldItems) {\r\n                                item.cells = oldItems[index].cells || []\r\n                            }\r\n                        })\r\n                    } else {\r\n                        that._items = []\r\n                    }\r\n                },\r\n                _handleChanging: function(e) {\r\n                    var that = this;\r\n                    var rows = that.getVisibleRows();\r\n                    var dataSource = that.dataSource();\r\n                    if (dataSource) {\r\n                        e.changes.forEach(function(change) {\r\n                            if (\"insert\" === change.type && change.index >= 0) {\r\n                                var dataIndex = 0;\r\n                                var row;\r\n                                for (var i = 0; i < change.index; i++) {\r\n                                    row = rows[i];\r\n                                    if (row && (\"data\" === row.rowType || \"group\" === row.rowType)) {\r\n                                        dataIndex++\r\n                                    }\r\n                                }\r\n                                change.index = dataIndex\r\n                            }\r\n                        })\r\n                    }\r\n                },\r\n                updateItems: function(change, isDataChanged) {\r\n                    change = change || {};\r\n                    var that = this;\r\n                    if (void 0 !== that._repaintChangesOnly) {\r\n                        change.repaintChangesOnly = that._repaintChangesOnly\r\n                    } else {\r\n                        if (change.changes) {\r\n                            change.repaintChangesOnly = that.option(\"repaintChangesOnly\")\r\n                        } else {\r\n                            if (isDataChanged) {\r\n                                var operationTypes = that.dataSource().operationTypes();\r\n                                change.repaintChangesOnly = operationTypes && !operationTypes.grouping && !operationTypes.filtering && that.option(\"repaintChangesOnly\");\r\n                                change.isDataChanged = true;\r\n                                if (operationTypes && (operationTypes.reload || operationTypes.paging || operationTypes.groupExpanding)) {\r\n                                    change.needUpdateDimensions = true\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                    if (that._updateLockCount) {\r\n                        that._changes.push(change);\r\n                        return\r\n                    }\r\n                    that._updateItemsCore(change);\r\n                    if (change.cancel) {\r\n                        return\r\n                    }\r\n                    that._fireChanged(change)\r\n                },\r\n                loadingOperationTypes: function() {\r\n                    var dataSource = this.dataSource();\r\n                    return dataSource && dataSource.loadingOperationTypes() || {}\r\n                },\r\n                _fireChanged: function(change) {\r\n                    var that = this;\r\n                    (0, _common.deferRender)(function() {\r\n                        that.changed.fire(change)\r\n                    })\r\n                },\r\n                isLoading: function() {\r\n                    return this._isLoading || this._isCustomLoading\r\n                },\r\n                _fireLoadingChanged: function() {\r\n                    this.loadingChanged.fire(this.isLoading(), this._loadingText)\r\n                },\r\n                _calculateAdditionalFilter: function() {\r\n                    return null\r\n                },\r\n                _applyFilter: function() {\r\n                    var that = this;\r\n                    var dataSource = that._dataSource;\r\n                    if (dataSource) {\r\n                        dataSource.pageIndex(0);\r\n                        return that.reload().done(that.pageChanged.fire.bind(that.pageChanged))\r\n                    }\r\n                },\r\n                filter: function filter(filterExpr) {\r\n                    var dataSource = this._dataSource;\r\n                    var filter = dataSource && dataSource.filter();\r\n                    if (0 === arguments.length) {\r\n                        return filter\r\n                    }\r\n                    filterExpr = arguments.length > 1 ? Array.prototype.slice.call(arguments, 0) : filterExpr;\r\n                    if (_uiGrid_core4.default.equalFilterParameters(filter, filterExpr)) {\r\n                        return\r\n                    }\r\n                    if (dataSource) {\r\n                        dataSource.filter(filterExpr)\r\n                    }\r\n                    this._applyFilter()\r\n                },\r\n                clearFilter: function(filterName) {\r\n                    var that = this;\r\n                    var columnsController = that._columnsController;\r\n                    var clearColumnOption = function(optionName) {\r\n                        var columnCount = columnsController.columnCount();\r\n                        var index;\r\n                        for (index = 0; index < columnCount; index++) {\r\n                            columnsController.columnOption(index, optionName, void 0)\r\n                        }\r\n                    };\r\n                    that.component.beginUpdate();\r\n                    if (arguments.length > 0) {\r\n                        switch (filterName) {\r\n                            case \"dataSource\":\r\n                                that.filter(null);\r\n                                break;\r\n                            case \"search\":\r\n                                that.searchByText(\"\");\r\n                                break;\r\n                            case \"header\":\r\n                                clearColumnOption(\"filterValues\");\r\n                                break;\r\n                            case \"row\":\r\n                                clearColumnOption(\"filterValue\")\r\n                        }\r\n                    } else {\r\n                        that.filter(null);\r\n                        that.searchByText(\"\");\r\n                        clearColumnOption(\"filterValue\");\r\n                        clearColumnOption(\"bufferedFilterValue\");\r\n                        clearColumnOption(\"filterValues\")\r\n                    }\r\n                    that.component.endUpdate()\r\n                },\r\n                _fireDataSourceChanged: function() {\r\n                    var that = this;\r\n                    var changedHandler = function changedHandler() {\r\n                        that.changed.remove(changedHandler);\r\n                        that.dataSourceChanged.fire()\r\n                    };\r\n                    that.changed.add(changedHandler)\r\n                },\r\n                _getDataSourceAdapter: _common.noop,\r\n                _createDataSourceAdapterCore: function(dataSource, remoteOperations) {\r\n                    var dataSourceAdapterProvider = this._getDataSourceAdapter();\r\n                    var dataSourceAdapter = dataSourceAdapterProvider.create(this.component);\r\n                    dataSourceAdapter.init(dataSource, remoteOperations);\r\n                    return dataSourceAdapter\r\n                },\r\n                isLocalStore: function(store) {\r\n                    store = store || this.store();\r\n                    return store instanceof _array_store2.default\r\n                },\r\n                isCustomStore: function(store) {\r\n                    store = store || this.store();\r\n                    return store instanceof _custom_store2.default\r\n                },\r\n                _createDataSourceAdapter: function(dataSource) {\r\n                    var remoteOperations = this.option(\"remoteOperations\");\r\n                    var store = dataSource.store();\r\n                    var enabledRemoteOperations = {\r\n                        filtering: true,\r\n                        sorting: true,\r\n                        paging: true,\r\n                        grouping: true,\r\n                        summary: true\r\n                    };\r\n                    if (remoteOperations && remoteOperations.groupPaging) {\r\n                        remoteOperations = (0, _extend.extend)({}, enabledRemoteOperations, remoteOperations)\r\n                    }\r\n                    if (\"auto\" === remoteOperations) {\r\n                        remoteOperations = this.isLocalStore(store) || this.isCustomStore(store) ? {} : {\r\n                            filtering: true,\r\n                            sorting: true,\r\n                            paging: true\r\n                        }\r\n                    }\r\n                    if (true === remoteOperations) {\r\n                        remoteOperations = enabledRemoteOperations\r\n                    }\r\n                    return this._createDataSourceAdapterCore(dataSource, remoteOperations)\r\n                },\r\n                setDataSource: function(dataSource) {\r\n                    var that = this;\r\n                    var oldDataSource = that._dataSource;\r\n                    if (!dataSource && oldDataSource) {\r\n                        oldDataSource.changed.remove(that._dataChangedHandler);\r\n                        oldDataSource.loadingChanged.remove(that._loadingChangedHandler);\r\n                        oldDataSource.loadError.remove(that._loadErrorHandler);\r\n                        oldDataSource.customizeStoreLoadOptions.remove(that._customizeStoreLoadOptionsHandler);\r\n                        oldDataSource.changing.remove(that._changingHandler);\r\n                        oldDataSource.cancelAll();\r\n                        oldDataSource.dispose(that._isSharedDataSource)\r\n                    }\r\n                    if (dataSource) {\r\n                        dataSource = that._createDataSourceAdapter(dataSource)\r\n                    }\r\n                    that._dataSource = dataSource;\r\n                    if (dataSource) {\r\n                        that._fireDataSourceChanged();\r\n                        that._isLoading = !dataSource.isLoaded();\r\n                        that._needApplyFilter = true;\r\n                        that._isAllDataTypesDefined = that._columnsController.isAllDataTypesDefined();\r\n                        dataSource.changed.add(that._dataChangedHandler);\r\n                        dataSource.loadingChanged.add(that._loadingChangedHandler);\r\n                        dataSource.loadError.add(that._loadErrorHandler);\r\n                        dataSource.customizeStoreLoadOptions.add(that._customizeStoreLoadOptionsHandler);\r\n                        dataSource.changing.add(that._changingHandler)\r\n                    }\r\n                },\r\n                items: function() {\r\n                    return this._items\r\n                },\r\n                isEmpty: function() {\r\n                    return !this.items().length\r\n                },\r\n                pageCount: function() {\r\n                    return this._dataSource ? this._dataSource.pageCount() : 1\r\n                },\r\n                dataSource: function() {\r\n                    return this._dataSource\r\n                },\r\n                store: function() {\r\n                    var dataSource = this._dataSource;\r\n                    return dataSource && dataSource.store()\r\n                },\r\n                loadAll: function(data) {\r\n                    var that = this;\r\n                    var d = new _deferred.Deferred;\r\n                    var dataSource = that._dataSource;\r\n                    if (dataSource) {\r\n                        if (data) {\r\n                            var options = {\r\n                                data: data,\r\n                                isCustomLoading: true,\r\n                                storeLoadOptions: {\r\n                                    isLoadingAll: true\r\n                                },\r\n                                loadOptions: {\r\n                                    filter: that.getCombinedFilter(),\r\n                                    group: dataSource.group(),\r\n                                    sort: dataSource.sort()\r\n                                }\r\n                            };\r\n                            dataSource._handleDataLoaded(options);\r\n                            (0, _deferred.when)(options.data).done(function(data) {\r\n                                data = that._beforeProcessItems(data);\r\n                                d.resolve(that._processItems(data, {\r\n                                    changeType: \"loadingAll\"\r\n                                }), options.extra && options.extra.summary)\r\n                            }).fail(d.reject)\r\n                        } else {\r\n                            if (!dataSource.isLoading()) {\r\n                                var loadOptions = (0, _extend.extend)({}, dataSource.loadOptions(), {\r\n                                    isLoadingAll: true,\r\n                                    requireTotalCount: false\r\n                                });\r\n                                dataSource.load(loadOptions).done(function(items, extra) {\r\n                                    items = that._beforeProcessItems(items);\r\n                                    items = that._processItems(items, {\r\n                                        changeType: \"loadingAll\"\r\n                                    });\r\n                                    d.resolve(items, extra && extra.summary)\r\n                                }).fail(d.reject)\r\n                            } else {\r\n                                d.reject()\r\n                            }\r\n                        }\r\n                    } else {\r\n                        d.resolve([])\r\n                    }\r\n                    return d\r\n                },\r\n                getKeyByRowIndex: function(rowIndex) {\r\n                    var item = this.items()[rowIndex];\r\n                    if (item) {\r\n                        return item.key\r\n                    }\r\n                },\r\n                getRowIndexByKey: function(key) {\r\n                    return _uiGrid_core4.default.getIndexByKey(key, this.items())\r\n                },\r\n                keyOf: function(data) {\r\n                    var store = this.store();\r\n                    if (store) {\r\n                        return store.keyOf(data)\r\n                    }\r\n                },\r\n                byKey: function(key) {\r\n                    var store = this.store();\r\n                    var rowIndex = this.getRowIndexByKey(key);\r\n                    var result;\r\n                    if (!store) {\r\n                        return\r\n                    }\r\n                    if (rowIndex >= 0) {\r\n                        result = (new _deferred.Deferred).resolve(this.items()[rowIndex].data)\r\n                    }\r\n                    return result || store.byKey(key)\r\n                },\r\n                key: function() {\r\n                    var store = this.store();\r\n                    if (store) {\r\n                        return store.key()\r\n                    }\r\n                },\r\n                getRowIndexOffset: function() {\r\n                    return 0\r\n                },\r\n                getDataByKeys: function(rowKeys) {\r\n                    var that = this;\r\n                    var result = new _deferred.Deferred;\r\n                    var deferreds = [];\r\n                    var data = [];\r\n                    (0, _iterator.each)(rowKeys, function(index, key) {\r\n                        deferreds.push(that.byKey(key).done(function(keyData) {\r\n                            data[index] = keyData\r\n                        }))\r\n                    });\r\n                    _deferred.when.apply(_renderer2.default, deferreds).always(function() {\r\n                        result.resolve(data)\r\n                    });\r\n                    return result\r\n                },\r\n                pageIndex: function(value) {\r\n                    return changePaging(this, \"pageIndex\", value)\r\n                },\r\n                pageSize: function(value) {\r\n                    return changePaging(this, \"pageSize\", value)\r\n                },\r\n                beginCustomLoading: function(messageText) {\r\n                    this._isCustomLoading = true;\r\n                    this._loadingText = messageText || \"\";\r\n                    this._fireLoadingChanged()\r\n                },\r\n                endCustomLoading: function() {\r\n                    this._isCustomLoading = false;\r\n                    this._loadingText = void 0;\r\n                    this._fireLoadingChanged()\r\n                },\r\n                refresh: function(options) {\r\n                    if (true === options) {\r\n                        options = {\r\n                            reload: true,\r\n                            changesOnly: true\r\n                        }\r\n                    } else {\r\n                        if (!options) {\r\n                            options = {\r\n                                lookup: true,\r\n                                selection: true,\r\n                                reload: true\r\n                            }\r\n                        }\r\n                    }\r\n                    var that = this;\r\n                    var dataSource = that.getDataSource();\r\n                    var changesOnly = options.changesOnly;\r\n                    var d = new _deferred.Deferred;\r\n                    var customizeLoadResult = function() {\r\n                        that._repaintChangesOnly = !!changesOnly\r\n                    };\r\n                    (0, _deferred.when)(!options.lookup || that._columnsController.refresh()).always(function() {\r\n                        if (options.load || options.reload) {\r\n                            dataSource && dataSource.on(\"customizeLoadResult\", customizeLoadResult);\r\n                            (0, _deferred.when)(that.reload(options.reload, changesOnly)).always(function() {\r\n                                dataSource && dataSource.off(\"customizeLoadResult\", customizeLoadResult);\r\n                                that._repaintChangesOnly = void 0\r\n                            }).done(d.resolve).fail(d.reject)\r\n                        } else {\r\n                            that.updateItems({\r\n                                repaintChangesOnly: options.changesOnly\r\n                            });\r\n                            d.resolve()\r\n                        }\r\n                    });\r\n                    return d.promise()\r\n                },\r\n                getVisibleRows: function() {\r\n                    return this.items()\r\n                },\r\n                _disposeDataSource: function() {\r\n                    this.setDataSource(null)\r\n                },\r\n                dispose: function() {\r\n                    this._disposeDataSource();\r\n                    this.callBase.apply(this, arguments)\r\n                },\r\n                repaintRows: function(rowIndexes, changesOnly) {\r\n                    rowIndexes = Array.isArray(rowIndexes) ? rowIndexes : [rowIndexes];\r\n                    if (rowIndexes.length > 1 || _type2.default.isDefined(rowIndexes[0])) {\r\n                        this.updateItems({\r\n                            changeType: \"update\",\r\n                            rowIndices: rowIndexes,\r\n                            isFullUpdate: !changesOnly\r\n                        })\r\n                    }\r\n                },\r\n                skipProcessingPagingChange: function(fullName) {\r\n                    return this._skipProcessingPagingChange && (\"paging.pageIndex\" === fullName || \"paging.pageSize\" === fullName)\r\n                },\r\n                getUserState: function() {\r\n                    return {\r\n                        searchText: this.option(\"searchPanel.text\"),\r\n                        pageIndex: this.pageIndex(),\r\n                        pageSize: this.pageSize()\r\n                    }\r\n                },\r\n                getCachedStoreData: function() {\r\n                    return this._dataSource && this._dataSource.getCachedStoreData()\r\n                }\r\n            };\r\n            _uiGrid_core4.default.proxyMethod(members, \"load\");\r\n            _uiGrid_core4.default.proxyMethod(members, \"reload\");\r\n            _uiGrid_core4.default.proxyMethod(members, \"push\");\r\n            _uiGrid_core4.default.proxyMethod(members, \"itemsCount\", 0);\r\n            _uiGrid_core4.default.proxyMethod(members, \"totalItemsCount\", 0);\r\n            _uiGrid_core4.default.proxyMethod(members, \"hasKnownLastPage\", true);\r\n            _uiGrid_core4.default.proxyMethod(members, \"isLoaded\", true);\r\n            _uiGrid_core4.default.proxyMethod(members, \"totalCount\", 0);\r\n            return members\r\n        }())\r\n    }\r\n};\r\n"]},"metadata":{},"sourceType":"module"}