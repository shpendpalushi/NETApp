{"ast":null,"code":"/*!\r\nFullCalendar Core Package v4.3.1\r\nDocs & License: https://fullcalendar.io/\r\n(c) 2019 Adam Shaw\r\n*/\n// Creating\n// ----------------------------------------------------------------------------------------------------------------\nvar elementPropHash = {\n  className: true,\n  colSpan: true,\n  rowSpan: true\n};\nvar containerTagHash = {\n  '<tr': 'tbody',\n  '<td': 'tr'\n};\n\nfunction createElement(tagName, attrs, content) {\n  var el = document.createElement(tagName);\n\n  if (attrs) {\n    for (var attrName in attrs) {\n      if (attrName === 'style') {\n        applyStyle(el, attrs[attrName]);\n      } else if (elementPropHash[attrName]) {\n        el[attrName] = attrs[attrName];\n      } else {\n        el.setAttribute(attrName, attrs[attrName]);\n      }\n    }\n  }\n\n  if (typeof content === 'string') {\n    el.innerHTML = content; // shortcut. no need to process HTML in any way\n  } else if (content != null) {\n    appendToElement(el, content);\n  }\n\n  return el;\n}\n\nfunction htmlToElement(html) {\n  html = html.trim();\n  var container = document.createElement(computeContainerTag(html));\n  container.innerHTML = html;\n  return container.firstChild;\n}\n\nfunction htmlToElements(html) {\n  return Array.prototype.slice.call(htmlToNodeList(html));\n}\n\nfunction htmlToNodeList(html) {\n  html = html.trim();\n  var container = document.createElement(computeContainerTag(html));\n  container.innerHTML = html;\n  return container.childNodes;\n} // assumes html already trimmed and tag names are lowercase\n\n\nfunction computeContainerTag(html) {\n  return containerTagHash[html.substr(0, 3) // faster than using regex\n  ] || 'div';\n}\n\nfunction appendToElement(el, content) {\n  var childNodes = normalizeContent(content);\n\n  for (var i = 0; i < childNodes.length; i++) {\n    el.appendChild(childNodes[i]);\n  }\n}\n\nfunction prependToElement(parent, content) {\n  var newEls = normalizeContent(content);\n  var afterEl = parent.firstChild || null; // if no firstChild, will append to end, but that's okay, b/c there were no children\n\n  for (var i = 0; i < newEls.length; i++) {\n    parent.insertBefore(newEls[i], afterEl);\n  }\n}\n\nfunction insertAfterElement(refEl, content) {\n  var newEls = normalizeContent(content);\n  var afterEl = refEl.nextSibling || null;\n\n  for (var i = 0; i < newEls.length; i++) {\n    refEl.parentNode.insertBefore(newEls[i], afterEl);\n  }\n}\n\nfunction normalizeContent(content) {\n  var els;\n\n  if (typeof content === 'string') {\n    els = htmlToElements(content);\n  } else if (content instanceof Node) {\n    els = [content];\n  } else {\n    // Node[] or NodeList\n    els = Array.prototype.slice.call(content);\n  }\n\n  return els;\n}\n\nfunction removeElement(el) {\n  if (el.parentNode) {\n    el.parentNode.removeChild(el);\n  }\n} // Querying\n// ----------------------------------------------------------------------------------------------------------------\n// from https://developer.mozilla.org/en-US/docs/Web/API/Element/closest\n\n\nvar matchesMethod = Element.prototype.matches || Element.prototype.matchesSelector || Element.prototype.msMatchesSelector;\n\nvar closestMethod = Element.prototype.closest || function (selector) {\n  // polyfill\n  var el = this;\n\n  if (!document.documentElement.contains(el)) {\n    return null;\n  }\n\n  do {\n    if (elementMatches(el, selector)) {\n      return el;\n    }\n\n    el = el.parentElement || el.parentNode;\n  } while (el !== null && el.nodeType === 1);\n\n  return null;\n};\n\nfunction elementClosest(el, selector) {\n  return closestMethod.call(el, selector);\n}\n\nfunction elementMatches(el, selector) {\n  return matchesMethod.call(el, selector);\n} // accepts multiple subject els\n// returns a real array. good for methods like forEach\n\n\nfunction findElements(container, selector) {\n  var containers = container instanceof HTMLElement ? [container] : container;\n  var allMatches = [];\n\n  for (var i = 0; i < containers.length; i++) {\n    var matches = containers[i].querySelectorAll(selector);\n\n    for (var j = 0; j < matches.length; j++) {\n      allMatches.push(matches[j]);\n    }\n  }\n\n  return allMatches;\n} // accepts multiple subject els\n// only queries direct child elements\n\n\nfunction findChildren(parent, selector) {\n  var parents = parent instanceof HTMLElement ? [parent] : parent;\n  var allMatches = [];\n\n  for (var i = 0; i < parents.length; i++) {\n    var childNodes = parents[i].children; // only ever elements\n\n    for (var j = 0; j < childNodes.length; j++) {\n      var childNode = childNodes[j];\n\n      if (!selector || elementMatches(childNode, selector)) {\n        allMatches.push(childNode);\n      }\n    }\n  }\n\n  return allMatches;\n} // Attributes\n// ----------------------------------------------------------------------------------------------------------------\n\n\nfunction forceClassName(el, className, bool) {\n  if (bool) {\n    el.classList.add(className);\n  } else {\n    el.classList.remove(className);\n  }\n} // Style\n// ----------------------------------------------------------------------------------------------------------------\n\n\nvar PIXEL_PROP_RE = /(top|left|right|bottom|width|height)$/i;\n\nfunction applyStyle(el, props) {\n  for (var propName in props) {\n    applyStyleProp(el, propName, props[propName]);\n  }\n}\n\nfunction applyStyleProp(el, name, val) {\n  if (val == null) {\n    el.style[name] = '';\n  } else if (typeof val === 'number' && PIXEL_PROP_RE.test(name)) {\n    el.style[name] = val + 'px';\n  } else {\n    el.style[name] = val;\n  }\n}\n\nfunction pointInsideRect(point, rect) {\n  return point.left >= rect.left && point.left < rect.right && point.top >= rect.top && point.top < rect.bottom;\n} // Returns a new rectangle that is the intersection of the two rectangles. If they don't intersect, returns false\n\n\nfunction intersectRects(rect1, rect2) {\n  var res = {\n    left: Math.max(rect1.left, rect2.left),\n    right: Math.min(rect1.right, rect2.right),\n    top: Math.max(rect1.top, rect2.top),\n    bottom: Math.min(rect1.bottom, rect2.bottom)\n  };\n\n  if (res.left < res.right && res.top < res.bottom) {\n    return res;\n  }\n\n  return false;\n}\n\nfunction translateRect(rect, deltaX, deltaY) {\n  return {\n    left: rect.left + deltaX,\n    right: rect.right + deltaX,\n    top: rect.top + deltaY,\n    bottom: rect.bottom + deltaY\n  };\n} // Returns a new point that will have been moved to reside within the given rectangle\n\n\nfunction constrainPoint(point, rect) {\n  return {\n    left: Math.min(Math.max(point.left, rect.left), rect.right),\n    top: Math.min(Math.max(point.top, rect.top), rect.bottom)\n  };\n} // Returns a point that is the center of the given rectangle\n\n\nfunction getRectCenter(rect) {\n  return {\n    left: (rect.left + rect.right) / 2,\n    top: (rect.top + rect.bottom) / 2\n  };\n} // Subtracts point2's coordinates from point1's coordinates, returning a delta\n\n\nfunction diffPoints(point1, point2) {\n  return {\n    left: point1.left - point2.left,\n    top: point1.top - point2.top\n  };\n} // Logic for determining if, when the element is right-to-left, the scrollbar appears on the left side\n\n\nvar isRtlScrollbarOnLeft = null;\n\nfunction getIsRtlScrollbarOnLeft() {\n  if (isRtlScrollbarOnLeft === null) {\n    isRtlScrollbarOnLeft = computeIsRtlScrollbarOnLeft();\n  }\n\n  return isRtlScrollbarOnLeft;\n}\n\nfunction computeIsRtlScrollbarOnLeft() {\n  var outerEl = createElement('div', {\n    style: {\n      position: 'absolute',\n      top: -1000,\n      left: 0,\n      border: 0,\n      padding: 0,\n      overflow: 'scroll',\n      direction: 'rtl'\n    }\n  }, '<div></div>');\n  document.body.appendChild(outerEl);\n  var innerEl = outerEl.firstChild;\n  var res = innerEl.getBoundingClientRect().left > outerEl.getBoundingClientRect().left;\n  removeElement(outerEl);\n  return res;\n} // The scrollbar width computations in computeEdges are sometimes flawed when it comes to\n// retina displays, rounding, and IE11. Massage them into a usable value.\n\n\nfunction sanitizeScrollbarWidth(width) {\n  width = Math.max(0, width); // no negatives\n\n  width = Math.round(width);\n  return width;\n}\n\nfunction computeEdges(el, getPadding) {\n  if (getPadding === void 0) {\n    getPadding = false;\n  }\n\n  var computedStyle = window.getComputedStyle(el);\n  var borderLeft = parseInt(computedStyle.borderLeftWidth, 10) || 0;\n  var borderRight = parseInt(computedStyle.borderRightWidth, 10) || 0;\n  var borderTop = parseInt(computedStyle.borderTopWidth, 10) || 0;\n  var borderBottom = parseInt(computedStyle.borderBottomWidth, 10) || 0; // must use offset(Width|Height) because compatible with client(Width|Height)\n\n  var scrollbarLeftRight = sanitizeScrollbarWidth(el.offsetWidth - el.clientWidth - borderLeft - borderRight);\n  var scrollbarBottom = sanitizeScrollbarWidth(el.offsetHeight - el.clientHeight - borderTop - borderBottom);\n  var res = {\n    borderLeft: borderLeft,\n    borderRight: borderRight,\n    borderTop: borderTop,\n    borderBottom: borderBottom,\n    scrollbarBottom: scrollbarBottom,\n    scrollbarLeft: 0,\n    scrollbarRight: 0\n  };\n\n  if (getIsRtlScrollbarOnLeft() && computedStyle.direction === 'rtl') {\n    // is the scrollbar on the left side?\n    res.scrollbarLeft = scrollbarLeftRight;\n  } else {\n    res.scrollbarRight = scrollbarLeftRight;\n  }\n\n  if (getPadding) {\n    res.paddingLeft = parseInt(computedStyle.paddingLeft, 10) || 0;\n    res.paddingRight = parseInt(computedStyle.paddingRight, 10) || 0;\n    res.paddingTop = parseInt(computedStyle.paddingTop, 10) || 0;\n    res.paddingBottom = parseInt(computedStyle.paddingBottom, 10) || 0;\n  }\n\n  return res;\n}\n\nfunction computeInnerRect(el, goWithinPadding) {\n  if (goWithinPadding === void 0) {\n    goWithinPadding = false;\n  }\n\n  var outerRect = computeRect(el);\n  var edges = computeEdges(el, goWithinPadding);\n  var res = {\n    left: outerRect.left + edges.borderLeft + edges.scrollbarLeft,\n    right: outerRect.right - edges.borderRight - edges.scrollbarRight,\n    top: outerRect.top + edges.borderTop,\n    bottom: outerRect.bottom - edges.borderBottom - edges.scrollbarBottom\n  };\n\n  if (goWithinPadding) {\n    res.left += edges.paddingLeft;\n    res.right -= edges.paddingRight;\n    res.top += edges.paddingTop;\n    res.bottom -= edges.paddingBottom;\n  }\n\n  return res;\n}\n\nfunction computeRect(el) {\n  var rect = el.getBoundingClientRect();\n  return {\n    left: rect.left + window.pageXOffset,\n    top: rect.top + window.pageYOffset,\n    right: rect.right + window.pageXOffset,\n    bottom: rect.bottom + window.pageYOffset\n  };\n}\n\nfunction computeViewportRect() {\n  return {\n    left: window.pageXOffset,\n    right: window.pageXOffset + document.documentElement.clientWidth,\n    top: window.pageYOffset,\n    bottom: window.pageYOffset + document.documentElement.clientHeight\n  };\n}\n\nfunction computeHeightAndMargins(el) {\n  return el.getBoundingClientRect().height + computeVMargins(el);\n}\n\nfunction computeVMargins(el) {\n  var computed = window.getComputedStyle(el);\n  return parseInt(computed.marginTop, 10) + parseInt(computed.marginBottom, 10);\n} // does not return window\n\n\nfunction getClippingParents(el) {\n  var parents = [];\n\n  while (el instanceof HTMLElement) {\n    // will stop when gets to document or null\n    var computedStyle = window.getComputedStyle(el);\n\n    if (computedStyle.position === 'fixed') {\n      break;\n    }\n\n    if (/(auto|scroll)/.test(computedStyle.overflow + computedStyle.overflowY + computedStyle.overflowX)) {\n      parents.push(el);\n    }\n\n    el = el.parentNode;\n  }\n\n  return parents;\n}\n\nfunction computeClippingRect(el) {\n  return getClippingParents(el).map(function (el) {\n    return computeInnerRect(el);\n  }).concat(computeViewportRect()).reduce(function (rect0, rect1) {\n    return intersectRects(rect0, rect1) || rect1; // should always intersect\n  });\n} // Stops a mouse/touch event from doing it's native browser action\n\n\nfunction preventDefault(ev) {\n  ev.preventDefault();\n} // Event Delegation\n// ----------------------------------------------------------------------------------------------------------------\n\n\nfunction listenBySelector(container, eventType, selector, handler) {\n  function realHandler(ev) {\n    var matchedChild = elementClosest(ev.target, selector);\n\n    if (matchedChild) {\n      handler.call(matchedChild, ev, matchedChild);\n    }\n  }\n\n  container.addEventListener(eventType, realHandler);\n  return function () {\n    container.removeEventListener(eventType, realHandler);\n  };\n}\n\nfunction listenToHoverBySelector(container, selector, onMouseEnter, onMouseLeave) {\n  var currentMatchedChild;\n  return listenBySelector(container, 'mouseover', selector, function (ev, matchedChild) {\n    if (matchedChild !== currentMatchedChild) {\n      currentMatchedChild = matchedChild;\n      onMouseEnter(ev, matchedChild);\n\n      var realOnMouseLeave_1 = function realOnMouseLeave_1(ev) {\n        currentMatchedChild = null;\n        onMouseLeave(ev, matchedChild);\n        matchedChild.removeEventListener('mouseleave', realOnMouseLeave_1);\n      }; // listen to the next mouseleave, and then unattach\n\n\n      matchedChild.addEventListener('mouseleave', realOnMouseLeave_1);\n    }\n  });\n} // Animation\n// ----------------------------------------------------------------------------------------------------------------\n\n\nvar transitionEventNames = ['webkitTransitionEnd', 'otransitionend', 'oTransitionEnd', 'msTransitionEnd', 'transitionend']; // triggered only when the next single subsequent transition finishes\n\nfunction whenTransitionDone(el, callback) {\n  var realCallback = function realCallback(ev) {\n    callback(ev);\n    transitionEventNames.forEach(function (eventName) {\n      el.removeEventListener(eventName, realCallback);\n    });\n  };\n\n  transitionEventNames.forEach(function (eventName) {\n    el.addEventListener(eventName, realCallback); // cross-browser way to determine when the transition finishes\n  });\n}\n\nvar DAY_IDS = ['sun', 'mon', 'tue', 'wed', 'thu', 'fri', 'sat']; // Adding\n\nfunction addWeeks(m, n) {\n  var a = dateToUtcArray(m);\n  a[2] += n * 7;\n  return arrayToUtcDate(a);\n}\n\nfunction addDays(m, n) {\n  var a = dateToUtcArray(m);\n  a[2] += n;\n  return arrayToUtcDate(a);\n}\n\nfunction addMs(m, n) {\n  var a = dateToUtcArray(m);\n  a[6] += n;\n  return arrayToUtcDate(a);\n} // Diffing (all return floats)\n\n\nfunction diffWeeks(m0, m1) {\n  return diffDays(m0, m1) / 7;\n}\n\nfunction diffDays(m0, m1) {\n  return (m1.valueOf() - m0.valueOf()) / (1000 * 60 * 60 * 24);\n}\n\nfunction diffHours(m0, m1) {\n  return (m1.valueOf() - m0.valueOf()) / (1000 * 60 * 60);\n}\n\nfunction diffMinutes(m0, m1) {\n  return (m1.valueOf() - m0.valueOf()) / (1000 * 60);\n}\n\nfunction diffSeconds(m0, m1) {\n  return (m1.valueOf() - m0.valueOf()) / 1000;\n}\n\nfunction diffDayAndTime(m0, m1) {\n  var m0day = startOfDay(m0);\n  var m1day = startOfDay(m1);\n  return {\n    years: 0,\n    months: 0,\n    days: Math.round(diffDays(m0day, m1day)),\n    milliseconds: m1.valueOf() - m1day.valueOf() - (m0.valueOf() - m0day.valueOf())\n  };\n} // Diffing Whole Units\n\n\nfunction diffWholeWeeks(m0, m1) {\n  var d = diffWholeDays(m0, m1);\n\n  if (d !== null && d % 7 === 0) {\n    return d / 7;\n  }\n\n  return null;\n}\n\nfunction diffWholeDays(m0, m1) {\n  if (timeAsMs(m0) === timeAsMs(m1)) {\n    return Math.round(diffDays(m0, m1));\n  }\n\n  return null;\n} // Start-Of\n\n\nfunction startOfDay(m) {\n  return arrayToUtcDate([m.getUTCFullYear(), m.getUTCMonth(), m.getUTCDate()]);\n}\n\nfunction startOfHour(m) {\n  return arrayToUtcDate([m.getUTCFullYear(), m.getUTCMonth(), m.getUTCDate(), m.getUTCHours()]);\n}\n\nfunction startOfMinute(m) {\n  return arrayToUtcDate([m.getUTCFullYear(), m.getUTCMonth(), m.getUTCDate(), m.getUTCHours(), m.getUTCMinutes()]);\n}\n\nfunction startOfSecond(m) {\n  return arrayToUtcDate([m.getUTCFullYear(), m.getUTCMonth(), m.getUTCDate(), m.getUTCHours(), m.getUTCMinutes(), m.getUTCSeconds()]);\n} // Week Computation\n\n\nfunction weekOfYear(marker, dow, doy) {\n  var y = marker.getUTCFullYear();\n  var w = weekOfGivenYear(marker, y, dow, doy);\n\n  if (w < 1) {\n    return weekOfGivenYear(marker, y - 1, dow, doy);\n  }\n\n  var nextW = weekOfGivenYear(marker, y + 1, dow, doy);\n\n  if (nextW >= 1) {\n    return Math.min(w, nextW);\n  }\n\n  return w;\n}\n\nfunction weekOfGivenYear(marker, year, dow, doy) {\n  var firstWeekStart = arrayToUtcDate([year, 0, 1 + firstWeekOffset(year, dow, doy)]);\n  var dayStart = startOfDay(marker);\n  var days = Math.round(diffDays(firstWeekStart, dayStart));\n  return Math.floor(days / 7) + 1; // zero-indexed\n} // start-of-first-week - start-of-year\n\n\nfunction firstWeekOffset(year, dow, doy) {\n  // first-week day -- which january is always in the first week (4 for iso, 1 for other)\n  var fwd = 7 + dow - doy; // first-week day local weekday -- which local weekday is fwd\n\n  var fwdlw = (7 + arrayToUtcDate([year, 0, fwd]).getUTCDay() - dow) % 7;\n  return -fwdlw + fwd - 1;\n} // Array Conversion\n\n\nfunction dateToLocalArray(date) {\n  return [date.getFullYear(), date.getMonth(), date.getDate(), date.getHours(), date.getMinutes(), date.getSeconds(), date.getMilliseconds()];\n}\n\nfunction arrayToLocalDate(a) {\n  return new Date(a[0], a[1] || 0, a[2] == null ? 1 : a[2], // day of month\n  a[3] || 0, a[4] || 0, a[5] || 0);\n}\n\nfunction dateToUtcArray(date) {\n  return [date.getUTCFullYear(), date.getUTCMonth(), date.getUTCDate(), date.getUTCHours(), date.getUTCMinutes(), date.getUTCSeconds(), date.getUTCMilliseconds()];\n}\n\nfunction arrayToUtcDate(a) {\n  // according to web standards (and Safari), a month index is required.\n  // massage if only given a year.\n  if (a.length === 1) {\n    a = a.concat([0]);\n  }\n\n  return new Date(Date.UTC.apply(Date, a));\n} // Other Utils\n\n\nfunction isValidDate(m) {\n  return !isNaN(m.valueOf());\n}\n\nfunction timeAsMs(m) {\n  return m.getUTCHours() * 1000 * 60 * 60 + m.getUTCMinutes() * 1000 * 60 + m.getUTCSeconds() * 1000 + m.getUTCMilliseconds();\n}\n\nvar INTERNAL_UNITS = ['years', 'months', 'days', 'milliseconds'];\nvar PARSE_RE = /^(-?)(?:(\\d+)\\.)?(\\d+):(\\d\\d)(?::(\\d\\d)(?:\\.(\\d\\d\\d))?)?/; // Parsing and Creation\n\nfunction createDuration(input, unit) {\n  var _a;\n\n  if (typeof input === 'string') {\n    return parseString(input);\n  } else if (typeof input === 'object' && input) {\n    // non-null object\n    return normalizeObject(input);\n  } else if (typeof input === 'number') {\n    return normalizeObject((_a = {}, _a[unit || 'milliseconds'] = input, _a));\n  } else {\n    return null;\n  }\n}\n\nfunction parseString(s) {\n  var m = PARSE_RE.exec(s);\n\n  if (m) {\n    var sign = m[1] ? -1 : 1;\n    return {\n      years: 0,\n      months: 0,\n      days: sign * (m[2] ? parseInt(m[2], 10) : 0),\n      milliseconds: sign * ((m[3] ? parseInt(m[3], 10) : 0) * 60 * 60 * 1000 + // hours\n      (m[4] ? parseInt(m[4], 10) : 0) * 60 * 1000 + // minutes\n      (m[5] ? parseInt(m[5], 10) : 0) * 1000 + ( // seconds\n      m[6] ? parseInt(m[6], 10) : 0) // ms\n      )\n    };\n  }\n\n  return null;\n}\n\nfunction normalizeObject(obj) {\n  return {\n    years: obj.years || obj.year || 0,\n    months: obj.months || obj.month || 0,\n    days: (obj.days || obj.day || 0) + getWeeksFromInput(obj) * 7,\n    milliseconds: (obj.hours || obj.hour || 0) * 60 * 60 * 1000 + // hours\n    (obj.minutes || obj.minute || 0) * 60 * 1000 + // minutes\n    (obj.seconds || obj.second || 0) * 1000 + ( // seconds\n    obj.milliseconds || obj.millisecond || obj.ms || 0) // ms\n\n  };\n}\n\nfunction getWeeksFromInput(obj) {\n  return obj.weeks || obj.week || 0;\n} // Equality\n\n\nfunction durationsEqual(d0, d1) {\n  return d0.years === d1.years && d0.months === d1.months && d0.days === d1.days && d0.milliseconds === d1.milliseconds;\n}\n\nfunction isSingleDay(dur) {\n  return dur.years === 0 && dur.months === 0 && dur.days === 1 && dur.milliseconds === 0;\n} // Simple Math\n\n\nfunction addDurations(d0, d1) {\n  return {\n    years: d0.years + d1.years,\n    months: d0.months + d1.months,\n    days: d0.days + d1.days,\n    milliseconds: d0.milliseconds + d1.milliseconds\n  };\n}\n\nfunction subtractDurations(d1, d0) {\n  return {\n    years: d1.years - d0.years,\n    months: d1.months - d0.months,\n    days: d1.days - d0.days,\n    milliseconds: d1.milliseconds - d0.milliseconds\n  };\n}\n\nfunction multiplyDuration(d, n) {\n  return {\n    years: d.years * n,\n    months: d.months * n,\n    days: d.days * n,\n    milliseconds: d.milliseconds * n\n  };\n} // Conversions\n// \"Rough\" because they are based on average-case Gregorian months/years\n\n\nfunction asRoughYears(dur) {\n  return asRoughDays(dur) / 365;\n}\n\nfunction asRoughMonths(dur) {\n  return asRoughDays(dur) / 30;\n}\n\nfunction asRoughDays(dur) {\n  return asRoughMs(dur) / 864e5;\n}\n\nfunction asRoughMinutes(dur) {\n  return asRoughMs(dur) / (1000 * 60);\n}\n\nfunction asRoughSeconds(dur) {\n  return asRoughMs(dur) / 1000;\n}\n\nfunction asRoughMs(dur) {\n  return dur.years * (365 * 864e5) + dur.months * (30 * 864e5) + dur.days * 864e5 + dur.milliseconds;\n} // Advanced Math\n\n\nfunction wholeDivideDurations(numerator, denominator) {\n  var res = null;\n\n  for (var i = 0; i < INTERNAL_UNITS.length; i++) {\n    var unit = INTERNAL_UNITS[i];\n\n    if (denominator[unit]) {\n      var localRes = numerator[unit] / denominator[unit];\n\n      if (!isInt(localRes) || res !== null && res !== localRes) {\n        return null;\n      }\n\n      res = localRes;\n    } else if (numerator[unit]) {\n      // needs to divide by something but can't!\n      return null;\n    }\n  }\n\n  return res;\n}\n\nfunction greatestDurationDenominator(dur, dontReturnWeeks) {\n  var ms = dur.milliseconds;\n\n  if (ms) {\n    if (ms % 1000 !== 0) {\n      return {\n        unit: 'millisecond',\n        value: ms\n      };\n    }\n\n    if (ms % (1000 * 60) !== 0) {\n      return {\n        unit: 'second',\n        value: ms / 1000\n      };\n    }\n\n    if (ms % (1000 * 60 * 60) !== 0) {\n      return {\n        unit: 'minute',\n        value: ms / (1000 * 60)\n      };\n    }\n\n    if (ms) {\n      return {\n        unit: 'hour',\n        value: ms / (1000 * 60 * 60)\n      };\n    }\n  }\n\n  if (dur.days) {\n    if (!dontReturnWeeks && dur.days % 7 === 0) {\n      return {\n        unit: 'week',\n        value: dur.days / 7\n      };\n    }\n\n    return {\n      unit: 'day',\n      value: dur.days\n    };\n  }\n\n  if (dur.months) {\n    return {\n      unit: 'month',\n      value: dur.months\n    };\n  }\n\n  if (dur.years) {\n    return {\n      unit: 'year',\n      value: dur.years\n    };\n  }\n\n  return {\n    unit: 'millisecond',\n    value: 0\n  };\n}\n/* FullCalendar-specific DOM Utilities\r\n----------------------------------------------------------------------------------------------------------------------*/\n// Given the scrollbar widths of some other container, create borders/margins on rowEls in order to match the left\n// and right space that was offset by the scrollbars. A 1-pixel border first, then margin beyond that.\n\n\nfunction compensateScroll(rowEl, scrollbarWidths) {\n  if (scrollbarWidths.left) {\n    applyStyle(rowEl, {\n      borderLeftWidth: 1,\n      marginLeft: scrollbarWidths.left - 1\n    });\n  }\n\n  if (scrollbarWidths.right) {\n    applyStyle(rowEl, {\n      borderRightWidth: 1,\n      marginRight: scrollbarWidths.right - 1\n    });\n  }\n} // Undoes compensateScroll and restores all borders/margins\n\n\nfunction uncompensateScroll(rowEl) {\n  applyStyle(rowEl, {\n    marginLeft: '',\n    marginRight: '',\n    borderLeftWidth: '',\n    borderRightWidth: ''\n  });\n} // Make the mouse cursor express that an event is not allowed in the current area\n\n\nfunction disableCursor() {\n  document.body.classList.add('fc-not-allowed');\n} // Returns the mouse cursor to its original look\n\n\nfunction enableCursor() {\n  document.body.classList.remove('fc-not-allowed');\n} // Given a total available height to fill, have `els` (essentially child rows) expand to accomodate.\n// By default, all elements that are shorter than the recommended height are expanded uniformly, not considering\n// any other els that are already too tall. if `shouldRedistribute` is on, it considers these tall rows and\n// reduces the available height.\n\n\nfunction distributeHeight(els, availableHeight, shouldRedistribute) {\n  // *FLOORING NOTE*: we floor in certain places because zoom can give inaccurate floating-point dimensions,\n  // and it is better to be shorter than taller, to avoid creating unnecessary scrollbars.\n  var minOffset1 = Math.floor(availableHeight / els.length); // for non-last element\n\n  var minOffset2 = Math.floor(availableHeight - minOffset1 * (els.length - 1)); // for last element *FLOORING NOTE*\n\n  var flexEls = []; // elements that are allowed to expand. array of DOM nodes\n\n  var flexOffsets = []; // amount of vertical space it takes up\n\n  var flexHeights = []; // actual css height\n\n  var usedHeight = 0;\n  undistributeHeight(els); // give all elements their natural height\n  // find elements that are below the recommended height (expandable).\n  // important to query for heights in a single first pass (to avoid reflow oscillation).\n\n  els.forEach(function (el, i) {\n    var minOffset = i === els.length - 1 ? minOffset2 : minOffset1;\n    var naturalHeight = el.getBoundingClientRect().height;\n    var naturalOffset = naturalHeight + computeVMargins(el);\n\n    if (naturalOffset < minOffset) {\n      flexEls.push(el);\n      flexOffsets.push(naturalOffset);\n      flexHeights.push(naturalHeight);\n    } else {\n      // this element stretches past recommended height (non-expandable). mark the space as occupied.\n      usedHeight += naturalOffset;\n    }\n  }); // readjust the recommended height to only consider the height available to non-maxed-out rows.\n\n  if (shouldRedistribute) {\n    availableHeight -= usedHeight;\n    minOffset1 = Math.floor(availableHeight / flexEls.length);\n    minOffset2 = Math.floor(availableHeight - minOffset1 * (flexEls.length - 1)); // *FLOORING NOTE*\n  } // assign heights to all expandable elements\n\n\n  flexEls.forEach(function (el, i) {\n    var minOffset = i === flexEls.length - 1 ? minOffset2 : minOffset1;\n    var naturalOffset = flexOffsets[i];\n    var naturalHeight = flexHeights[i];\n    var newHeight = minOffset - (naturalOffset - naturalHeight); // subtract the margin/padding\n\n    if (naturalOffset < minOffset) {\n      // we check this again because redistribution might have changed things\n      el.style.height = newHeight + 'px';\n    }\n  });\n} // Undoes distrubuteHeight, restoring all els to their natural height\n\n\nfunction undistributeHeight(els) {\n  els.forEach(function (el) {\n    el.style.height = '';\n  });\n} // Given `els`, a set of <td> cells, find the cell with the largest natural width and set the widths of all the\n// cells to be that width.\n// PREREQUISITE: if you want a cell to take up width, it needs to have a single inner element w/ display:inline\n\n\nfunction matchCellWidths(els) {\n  var maxInnerWidth = 0;\n  els.forEach(function (el) {\n    var innerEl = el.firstChild; // hopefully an element\n\n    if (innerEl instanceof HTMLElement) {\n      var innerWidth_1 = innerEl.getBoundingClientRect().width;\n\n      if (innerWidth_1 > maxInnerWidth) {\n        maxInnerWidth = innerWidth_1;\n      }\n    }\n  });\n  maxInnerWidth++; // sometimes not accurate of width the text needs to stay on one line. insurance\n\n  els.forEach(function (el) {\n    el.style.width = maxInnerWidth + 'px';\n  });\n  return maxInnerWidth;\n} // Given one element that resides inside another,\n// Subtracts the height of the inner element from the outer element.\n\n\nfunction subtractInnerElHeight(outerEl, innerEl) {\n  // effin' IE8/9/10/11 sometimes returns 0 for dimensions. this weird hack was the only thing that worked\n  var reflowStyleProps = {\n    position: 'relative',\n    left: -1 // ensure reflow in case the el was already relative. negative is less likely to cause new scroll\n\n  };\n  applyStyle(outerEl, reflowStyleProps);\n  applyStyle(innerEl, reflowStyleProps);\n  var diff = // grab the dimensions\n  outerEl.getBoundingClientRect().height - innerEl.getBoundingClientRect().height; // undo hack\n\n  var resetStyleProps = {\n    position: '',\n    left: ''\n  };\n  applyStyle(outerEl, resetStyleProps);\n  applyStyle(innerEl, resetStyleProps);\n  return diff;\n}\n/* Selection\r\n----------------------------------------------------------------------------------------------------------------------*/\n\n\nfunction preventSelection(el) {\n  el.classList.add('fc-unselectable');\n  el.addEventListener('selectstart', preventDefault);\n}\n\nfunction allowSelection(el) {\n  el.classList.remove('fc-unselectable');\n  el.removeEventListener('selectstart', preventDefault);\n}\n/* Context Menu\r\n----------------------------------------------------------------------------------------------------------------------*/\n\n\nfunction preventContextMenu(el) {\n  el.addEventListener('contextmenu', preventDefault);\n}\n\nfunction allowContextMenu(el) {\n  el.removeEventListener('contextmenu', preventDefault);\n}\n/* Object Ordering by Field\r\n----------------------------------------------------------------------------------------------------------------------*/\n\n\nfunction parseFieldSpecs(input) {\n  var specs = [];\n  var tokens = [];\n  var i;\n  var token;\n\n  if (typeof input === 'string') {\n    tokens = input.split(/\\s*,\\s*/);\n  } else if (typeof input === 'function') {\n    tokens = [input];\n  } else if (Array.isArray(input)) {\n    tokens = input;\n  }\n\n  for (i = 0; i < tokens.length; i++) {\n    token = tokens[i];\n\n    if (typeof token === 'string') {\n      specs.push(token.charAt(0) === '-' ? {\n        field: token.substring(1),\n        order: -1\n      } : {\n        field: token,\n        order: 1\n      });\n    } else if (typeof token === 'function') {\n      specs.push({\n        func: token\n      });\n    }\n  }\n\n  return specs;\n}\n\nfunction compareByFieldSpecs(obj0, obj1, fieldSpecs) {\n  var i;\n  var cmp;\n\n  for (i = 0; i < fieldSpecs.length; i++) {\n    cmp = compareByFieldSpec(obj0, obj1, fieldSpecs[i]);\n\n    if (cmp) {\n      return cmp;\n    }\n  }\n\n  return 0;\n}\n\nfunction compareByFieldSpec(obj0, obj1, fieldSpec) {\n  if (fieldSpec.func) {\n    return fieldSpec.func(obj0, obj1);\n  }\n\n  return flexibleCompare(obj0[fieldSpec.field], obj1[fieldSpec.field]) * (fieldSpec.order || 1);\n}\n\nfunction flexibleCompare(a, b) {\n  if (!a && !b) {\n    return 0;\n  }\n\n  if (b == null) {\n    return -1;\n  }\n\n  if (a == null) {\n    return 1;\n  }\n\n  if (typeof a === 'string' || typeof b === 'string') {\n    return String(a).localeCompare(String(b));\n  }\n\n  return a - b;\n}\n/* String Utilities\r\n----------------------------------------------------------------------------------------------------------------------*/\n\n\nfunction capitaliseFirstLetter(str) {\n  return str.charAt(0).toUpperCase() + str.slice(1);\n}\n\nfunction padStart(val, len) {\n  var s = String(val);\n  return '000'.substr(0, len - s.length) + s;\n}\n/* Number Utilities\r\n----------------------------------------------------------------------------------------------------------------------*/\n\n\nfunction compareNumbers(a, b) {\n  return a - b;\n}\n\nfunction isInt(n) {\n  return n % 1 === 0;\n}\n/* Weird Utilities\r\n----------------------------------------------------------------------------------------------------------------------*/\n\n\nfunction applyAll(functions, thisObj, args) {\n  if (typeof functions === 'function') {\n    // supplied a single function\n    functions = [functions];\n  }\n\n  if (functions) {\n    var i = void 0;\n    var ret = void 0;\n\n    for (i = 0; i < functions.length; i++) {\n      ret = functions[i].apply(thisObj, args) || ret;\n    }\n\n    return ret;\n  }\n}\n\nfunction firstDefined() {\n  var args = [];\n\n  for (var _i = 0; _i < arguments.length; _i++) {\n    args[_i] = arguments[_i];\n  }\n\n  for (var i = 0; i < args.length; i++) {\n    if (args[i] !== undefined) {\n      return args[i];\n    }\n  }\n} // Returns a function, that, as long as it continues to be invoked, will not\n// be triggered. The function will be called after it stops being called for\n// N milliseconds. If `immediate` is passed, trigger the function on the\n// leading edge, instead of the trailing.\n// https://github.com/jashkenas/underscore/blob/1.6.0/underscore.js#L714\n\n\nfunction debounce(func, wait) {\n  var timeout;\n  var args;\n  var context;\n  var timestamp;\n  var result;\n\n  var later = function later() {\n    var last = new Date().valueOf() - timestamp;\n\n    if (last < wait) {\n      timeout = setTimeout(later, wait - last);\n    } else {\n      timeout = null;\n      result = func.apply(context, args);\n      context = args = null;\n    }\n  };\n\n  return function () {\n    context = this;\n    args = arguments;\n    timestamp = new Date().valueOf();\n\n    if (!timeout) {\n      timeout = setTimeout(later, wait);\n    }\n\n    return result;\n  };\n} // Number and Boolean are only types that defaults or not computed for\n// TODO: write more comments\n\n\nfunction refineProps(rawProps, processors, defaults, leftoverProps) {\n  if (defaults === void 0) {\n    defaults = {};\n  }\n\n  var refined = {};\n\n  for (var key in processors) {\n    var processor = processors[key];\n\n    if (rawProps[key] !== undefined) {\n      // found\n      if (processor === Function) {\n        refined[key] = typeof rawProps[key] === 'function' ? rawProps[key] : null;\n      } else if (processor) {\n        // a refining function?\n        refined[key] = processor(rawProps[key]);\n      } else {\n        refined[key] = rawProps[key];\n      }\n    } else if (defaults[key] !== undefined) {\n      // there's an explicit default\n      refined[key] = defaults[key];\n    } else {\n      // must compute a default\n      if (processor === String) {\n        refined[key] = ''; // empty string is default for String\n      } else if (!processor || processor === Number || processor === Boolean || processor === Function) {\n        refined[key] = null; // assign null for other non-custom processor funcs\n      } else {\n        refined[key] = processor(null); // run the custom processor func\n      }\n    }\n  }\n\n  if (leftoverProps) {\n    for (var key in rawProps) {\n      if (processors[key] === undefined) {\n        leftoverProps[key] = rawProps[key];\n      }\n    }\n  }\n\n  return refined;\n}\n/* Date stuff that doesn't belong in datelib core\r\n----------------------------------------------------------------------------------------------------------------------*/\n// given a timed range, computes an all-day range that has the same exact duration,\n// but whose start time is aligned with the start of the day.\n\n\nfunction computeAlignedDayRange(timedRange) {\n  var dayCnt = Math.floor(diffDays(timedRange.start, timedRange.end)) || 1;\n  var start = startOfDay(timedRange.start);\n  var end = addDays(start, dayCnt);\n  return {\n    start: start,\n    end: end\n  };\n} // given a timed range, computes an all-day range based on how for the end date bleeds into the next day\n// TODO: give nextDayThreshold a default arg\n\n\nfunction computeVisibleDayRange(timedRange, nextDayThreshold) {\n  if (nextDayThreshold === void 0) {\n    nextDayThreshold = createDuration(0);\n  }\n\n  var startDay = null;\n  var endDay = null;\n\n  if (timedRange.end) {\n    endDay = startOfDay(timedRange.end);\n    var endTimeMS = timedRange.end.valueOf() - endDay.valueOf(); // # of milliseconds into `endDay`\n    // If the end time is actually inclusively part of the next day and is equal to or\n    // beyond the next day threshold, adjust the end to be the exclusive end of `endDay`.\n    // Otherwise, leaving it as inclusive will cause it to exclude `endDay`.\n\n    if (endTimeMS && endTimeMS >= asRoughMs(nextDayThreshold)) {\n      endDay = addDays(endDay, 1);\n    }\n  }\n\n  if (timedRange.start) {\n    startDay = startOfDay(timedRange.start); // the beginning of the day the range starts\n    // If end is within `startDay` but not past nextDayThreshold, assign the default duration of one day.\n\n    if (endDay && endDay <= startDay) {\n      endDay = addDays(startDay, 1);\n    }\n  }\n\n  return {\n    start: startDay,\n    end: endDay\n  };\n} // spans from one day into another?\n\n\nfunction isMultiDayRange(range) {\n  var visibleRange = computeVisibleDayRange(range);\n  return diffDays(visibleRange.start, visibleRange.end) > 1;\n}\n\nfunction diffDates(date0, date1, dateEnv, largeUnit) {\n  if (largeUnit === 'year') {\n    return createDuration(dateEnv.diffWholeYears(date0, date1), 'year');\n  } else if (largeUnit === 'month') {\n    return createDuration(dateEnv.diffWholeMonths(date0, date1), 'month');\n  } else {\n    return diffDayAndTime(date0, date1); // returns a duration\n  }\n}\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\n\n/* global Reflect, Promise */\n\n\nvar _extendStatics = function extendStatics(d, b) {\n  _extendStatics = Object.setPrototypeOf || {\n    __proto__: []\n  } instanceof Array && function (d, b) {\n    d.__proto__ = b;\n  } || function (d, b) {\n    for (var p in b) {\n      if (b.hasOwnProperty(p)) d[p] = b[p];\n    }\n  };\n\n  return _extendStatics(d, b);\n};\n\nfunction __extends(d, b) {\n  _extendStatics(d, b);\n\n  function __() {\n    this.constructor = d;\n  }\n\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\n\nvar _assign = function __assign() {\n  _assign = Object.assign || function __assign(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return _assign.apply(this, arguments);\n};\n\nfunction parseRecurring(eventInput, allDayDefault, dateEnv, recurringTypes, leftovers) {\n  for (var i = 0; i < recurringTypes.length; i++) {\n    var localLeftovers = {};\n    var parsed = recurringTypes[i].parse(eventInput, localLeftovers, dateEnv);\n\n    if (parsed) {\n      var allDay = localLeftovers.allDay;\n      delete localLeftovers.allDay; // remove from leftovers\n\n      if (allDay == null) {\n        allDay = allDayDefault;\n\n        if (allDay == null) {\n          allDay = parsed.allDayGuess;\n\n          if (allDay == null) {\n            allDay = false;\n          }\n        }\n      }\n\n      _assign(leftovers, localLeftovers);\n\n      return {\n        allDay: allDay,\n        duration: parsed.duration,\n        typeData: parsed.typeData,\n        typeId: i\n      };\n    }\n  }\n\n  return null;\n}\n/*\r\nEvent MUST have a recurringDef\r\n*/\n\n\nfunction expandRecurringRanges(eventDef, duration, framingRange, dateEnv, recurringTypes) {\n  var typeDef = recurringTypes[eventDef.recurringDef.typeId];\n  var markers = typeDef.expand(eventDef.recurringDef.typeData, {\n    start: dateEnv.subtract(framingRange.start, duration),\n    end: framingRange.end\n  }, dateEnv); // the recurrence plugins don't guarantee that all-day events are start-of-day, so we have to\n\n  if (eventDef.allDay) {\n    markers = markers.map(startOfDay);\n  }\n\n  return markers;\n}\n\nvar hasOwnProperty = Object.prototype.hasOwnProperty; // Merges an array of objects into a single object.\n// The second argument allows for an array of property names who's object values will be merged together.\n\nfunction mergeProps(propObjs, complexProps) {\n  var dest = {};\n  var i;\n  var name;\n  var complexObjs;\n  var j;\n  var val;\n  var props;\n\n  if (complexProps) {\n    for (i = 0; i < complexProps.length; i++) {\n      name = complexProps[i];\n      complexObjs = []; // collect the trailing object values, stopping when a non-object is discovered\n\n      for (j = propObjs.length - 1; j >= 0; j--) {\n        val = propObjs[j][name];\n\n        if (typeof val === 'object' && val) {\n          // non-null object\n          complexObjs.unshift(val);\n        } else if (val !== undefined) {\n          dest[name] = val; // if there were no objects, this value will be used\n\n          break;\n        }\n      } // if the trailing values were objects, use the merged value\n\n\n      if (complexObjs.length) {\n        dest[name] = mergeProps(complexObjs);\n      }\n    }\n  } // copy values into the destination, going from last to first\n\n\n  for (i = propObjs.length - 1; i >= 0; i--) {\n    props = propObjs[i];\n\n    for (name in props) {\n      if (!(name in dest)) {\n        // if already assigned by previous props or complex props, don't reassign\n        dest[name] = props[name];\n      }\n    }\n  }\n\n  return dest;\n}\n\nfunction filterHash(hash, func) {\n  var filtered = {};\n\n  for (var key in hash) {\n    if (func(hash[key], key)) {\n      filtered[key] = hash[key];\n    }\n  }\n\n  return filtered;\n}\n\nfunction mapHash(hash, func) {\n  var newHash = {};\n\n  for (var key in hash) {\n    newHash[key] = func(hash[key], key);\n  }\n\n  return newHash;\n}\n\nfunction arrayToHash(a) {\n  var hash = {};\n\n  for (var _i = 0, a_1 = a; _i < a_1.length; _i++) {\n    var item = a_1[_i];\n    hash[item] = true;\n  }\n\n  return hash;\n}\n\nfunction hashValuesToArray(obj) {\n  var a = [];\n\n  for (var key in obj) {\n    a.push(obj[key]);\n  }\n\n  return a;\n}\n\nfunction isPropsEqual(obj0, obj1) {\n  for (var key in obj0) {\n    if (hasOwnProperty.call(obj0, key)) {\n      if (!(key in obj1)) {\n        return false;\n      }\n    }\n  }\n\n  for (var key in obj1) {\n    if (hasOwnProperty.call(obj1, key)) {\n      if (obj0[key] !== obj1[key]) {\n        return false;\n      }\n    }\n  }\n\n  return true;\n}\n\nfunction parseEvents(rawEvents, sourceId, calendar, allowOpenRange) {\n  var eventStore = createEmptyEventStore();\n\n  for (var _i = 0, rawEvents_1 = rawEvents; _i < rawEvents_1.length; _i++) {\n    var rawEvent = rawEvents_1[_i];\n    var tuple = parseEvent(rawEvent, sourceId, calendar, allowOpenRange);\n\n    if (tuple) {\n      eventTupleToStore(tuple, eventStore);\n    }\n  }\n\n  return eventStore;\n}\n\nfunction eventTupleToStore(tuple, eventStore) {\n  if (eventStore === void 0) {\n    eventStore = createEmptyEventStore();\n  }\n\n  eventStore.defs[tuple.def.defId] = tuple.def;\n\n  if (tuple.instance) {\n    eventStore.instances[tuple.instance.instanceId] = tuple.instance;\n  }\n\n  return eventStore;\n}\n\nfunction expandRecurring(eventStore, framingRange, calendar) {\n  var dateEnv = calendar.dateEnv;\n  var defs = eventStore.defs,\n      instances = eventStore.instances; // remove existing recurring instances\n\n  instances = filterHash(instances, function (instance) {\n    return !defs[instance.defId].recurringDef;\n  });\n\n  for (var defId in defs) {\n    var def = defs[defId];\n\n    if (def.recurringDef) {\n      var duration = def.recurringDef.duration;\n\n      if (!duration) {\n        duration = def.allDay ? calendar.defaultAllDayEventDuration : calendar.defaultTimedEventDuration;\n      }\n\n      var starts = expandRecurringRanges(def, duration, framingRange, calendar.dateEnv, calendar.pluginSystem.hooks.recurringTypes);\n\n      for (var _i = 0, starts_1 = starts; _i < starts_1.length; _i++) {\n        var start = starts_1[_i];\n        var instance = createEventInstance(defId, {\n          start: start,\n          end: dateEnv.add(start, duration)\n        });\n        instances[instance.instanceId] = instance;\n      }\n    }\n  }\n\n  return {\n    defs: defs,\n    instances: instances\n  };\n} // retrieves events that have the same groupId as the instance specified by `instanceId`\n// or they are the same as the instance.\n// why might instanceId not be in the store? an event from another calendar?\n\n\nfunction getRelevantEvents(eventStore, instanceId) {\n  var instance = eventStore.instances[instanceId];\n\n  if (instance) {\n    var def_1 = eventStore.defs[instance.defId]; // get events/instances with same group\n\n    var newStore = filterEventStoreDefs(eventStore, function (lookDef) {\n      return isEventDefsGrouped(def_1, lookDef);\n    }); // add the original\n    // TODO: wish we could use eventTupleToStore or something like it\n\n    newStore.defs[def_1.defId] = def_1;\n    newStore.instances[instance.instanceId] = instance;\n    return newStore;\n  }\n\n  return createEmptyEventStore();\n}\n\nfunction isEventDefsGrouped(def0, def1) {\n  return Boolean(def0.groupId && def0.groupId === def1.groupId);\n}\n\nfunction transformRawEvents(rawEvents, eventSource, calendar) {\n  var calEachTransform = calendar.opt('eventDataTransform');\n  var sourceEachTransform = eventSource ? eventSource.eventDataTransform : null;\n\n  if (sourceEachTransform) {\n    rawEvents = transformEachRawEvent(rawEvents, sourceEachTransform);\n  }\n\n  if (calEachTransform) {\n    rawEvents = transformEachRawEvent(rawEvents, calEachTransform);\n  }\n\n  return rawEvents;\n}\n\nfunction transformEachRawEvent(rawEvents, func) {\n  var refinedEvents;\n\n  if (!func) {\n    refinedEvents = rawEvents;\n  } else {\n    refinedEvents = [];\n\n    for (var _i = 0, rawEvents_2 = rawEvents; _i < rawEvents_2.length; _i++) {\n      var rawEvent = rawEvents_2[_i];\n      var refinedEvent = func(rawEvent);\n\n      if (refinedEvent) {\n        refinedEvents.push(refinedEvent);\n      } else if (refinedEvent == null) {\n        refinedEvents.push(rawEvent);\n      } // if a different falsy value, do nothing\n\n    }\n  }\n\n  return refinedEvents;\n}\n\nfunction createEmptyEventStore() {\n  return {\n    defs: {},\n    instances: {}\n  };\n}\n\nfunction mergeEventStores(store0, store1) {\n  return {\n    defs: _assign({}, store0.defs, store1.defs),\n    instances: _assign({}, store0.instances, store1.instances)\n  };\n}\n\nfunction filterEventStoreDefs(eventStore, filterFunc) {\n  var defs = filterHash(eventStore.defs, filterFunc);\n  var instances = filterHash(eventStore.instances, function (instance) {\n    return defs[instance.defId]; // still exists?\n  });\n  return {\n    defs: defs,\n    instances: instances\n  };\n}\n\nfunction parseRange(input, dateEnv) {\n  var start = null;\n  var end = null;\n\n  if (input.start) {\n    start = dateEnv.createMarker(input.start);\n  }\n\n  if (input.end) {\n    end = dateEnv.createMarker(input.end);\n  }\n\n  if (!start && !end) {\n    return null;\n  }\n\n  if (start && end && end < start) {\n    return null;\n  }\n\n  return {\n    start: start,\n    end: end\n  };\n} // SIDE-EFFECT: will mutate ranges.\n// Will return a new array result.\n\n\nfunction invertRanges(ranges, constraintRange) {\n  var invertedRanges = [];\n  var start = constraintRange.start; // the end of the previous range. the start of the new range\n\n  var i;\n  var dateRange; // ranges need to be in order. required for our date-walking algorithm\n\n  ranges.sort(compareRanges);\n\n  for (i = 0; i < ranges.length; i++) {\n    dateRange = ranges[i]; // add the span of time before the event (if there is any)\n\n    if (dateRange.start > start) {\n      // compare millisecond time (skip any ambig logic)\n      invertedRanges.push({\n        start: start,\n        end: dateRange.start\n      });\n    }\n\n    if (dateRange.end > start) {\n      start = dateRange.end;\n    }\n  } // add the span of time after the last event (if there is any)\n\n\n  if (start < constraintRange.end) {\n    // compare millisecond time (skip any ambig logic)\n    invertedRanges.push({\n      start: start,\n      end: constraintRange.end\n    });\n  }\n\n  return invertedRanges;\n}\n\nfunction compareRanges(range0, range1) {\n  return range0.start.valueOf() - range1.start.valueOf(); // earlier ranges go first\n}\n\nfunction intersectRanges(range0, range1) {\n  var start = range0.start;\n  var end = range0.end;\n  var newRange = null;\n\n  if (range1.start !== null) {\n    if (start === null) {\n      start = range1.start;\n    } else {\n      start = new Date(Math.max(start.valueOf(), range1.start.valueOf()));\n    }\n  }\n\n  if (range1.end != null) {\n    if (end === null) {\n      end = range1.end;\n    } else {\n      end = new Date(Math.min(end.valueOf(), range1.end.valueOf()));\n    }\n  }\n\n  if (start === null || end === null || start < end) {\n    newRange = {\n      start: start,\n      end: end\n    };\n  }\n\n  return newRange;\n}\n\nfunction rangesEqual(range0, range1) {\n  return (range0.start === null ? null : range0.start.valueOf()) === (range1.start === null ? null : range1.start.valueOf()) && (range0.end === null ? null : range0.end.valueOf()) === (range1.end === null ? null : range1.end.valueOf());\n}\n\nfunction rangesIntersect(range0, range1) {\n  return (range0.end === null || range1.start === null || range0.end > range1.start) && (range0.start === null || range1.end === null || range0.start < range1.end);\n}\n\nfunction rangeContainsRange(outerRange, innerRange) {\n  return (outerRange.start === null || innerRange.start !== null && innerRange.start >= outerRange.start) && (outerRange.end === null || innerRange.end !== null && innerRange.end <= outerRange.end);\n}\n\nfunction rangeContainsMarker(range, date) {\n  return (range.start === null || date >= range.start) && (range.end === null || date < range.end);\n} // If the given date is not within the given range, move it inside.\n// (If it's past the end, make it one millisecond before the end).\n\n\nfunction constrainMarkerToRange(date, range) {\n  if (range.start != null && date < range.start) {\n    return range.start;\n  }\n\n  if (range.end != null && date >= range.end) {\n    return new Date(range.end.valueOf() - 1);\n  }\n\n  return date;\n}\n\nfunction removeExact(array, exactVal) {\n  var removeCnt = 0;\n  var i = 0;\n\n  while (i < array.length) {\n    if (array[i] === exactVal) {\n      array.splice(i, 1);\n      removeCnt++;\n    } else {\n      i++;\n    }\n  }\n\n  return removeCnt;\n}\n\nfunction isArraysEqual(a0, a1) {\n  var len = a0.length;\n  var i;\n\n  if (len !== a1.length) {\n    // not array? or not same length?\n    return false;\n  }\n\n  for (i = 0; i < len; i++) {\n    if (a0[i] !== a1[i]) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nfunction memoize(workerFunc) {\n  var args;\n  var res;\n  return function () {\n    if (!args || !isArraysEqual(args, arguments)) {\n      args = arguments;\n      res = workerFunc.apply(this, arguments);\n    }\n\n    return res;\n  };\n}\n/*\r\nalways executes the workerFunc, but if the result is equal to the previous result,\r\nreturn the previous result instead.\r\n*/\n\n\nfunction memoizeOutput(workerFunc, equalityFunc) {\n  var cachedRes = null;\n  return function () {\n    var newRes = workerFunc.apply(this, arguments);\n\n    if (cachedRes === null || !(cachedRes === newRes || equalityFunc(cachedRes, newRes))) {\n      cachedRes = newRes;\n    }\n\n    return cachedRes;\n  };\n}\n\nvar EXTENDED_SETTINGS_AND_SEVERITIES = {\n  week: 3,\n  separator: 0,\n  omitZeroMinute: 0,\n  meridiem: 0,\n  omitCommas: 0\n};\nvar STANDARD_DATE_PROP_SEVERITIES = {\n  timeZoneName: 7,\n  era: 6,\n  year: 5,\n  month: 4,\n  day: 2,\n  weekday: 2,\n  hour: 1,\n  minute: 1,\n  second: 1\n};\nvar MERIDIEM_RE = /\\s*([ap])\\.?m\\.?/i; // eats up leading spaces too\n\nvar COMMA_RE = /,/g; // we need re for globalness\n\nvar MULTI_SPACE_RE = /\\s+/g;\nvar LTR_RE = /\\u200e/g; // control character\n\nvar UTC_RE = /UTC|GMT/;\n\nvar NativeFormatter =\n/** @class */\nfunction () {\n  function NativeFormatter(formatSettings) {\n    var standardDateProps = {};\n    var extendedSettings = {};\n    var severity = 0;\n\n    for (var name_1 in formatSettings) {\n      if (name_1 in EXTENDED_SETTINGS_AND_SEVERITIES) {\n        extendedSettings[name_1] = formatSettings[name_1];\n        severity = Math.max(EXTENDED_SETTINGS_AND_SEVERITIES[name_1], severity);\n      } else {\n        standardDateProps[name_1] = formatSettings[name_1];\n\n        if (name_1 in STANDARD_DATE_PROP_SEVERITIES) {\n          severity = Math.max(STANDARD_DATE_PROP_SEVERITIES[name_1], severity);\n        }\n      }\n    }\n\n    this.standardDateProps = standardDateProps;\n    this.extendedSettings = extendedSettings;\n    this.severity = severity;\n    this.buildFormattingFunc = memoize(buildFormattingFunc);\n  }\n\n  NativeFormatter.prototype.format = function (date, context) {\n    return this.buildFormattingFunc(this.standardDateProps, this.extendedSettings, context)(date);\n  };\n\n  NativeFormatter.prototype.formatRange = function (start, end, context) {\n    var _a = this,\n        standardDateProps = _a.standardDateProps,\n        extendedSettings = _a.extendedSettings;\n\n    var diffSeverity = computeMarkerDiffSeverity(start.marker, end.marker, context.calendarSystem);\n\n    if (!diffSeverity) {\n      return this.format(start, context);\n    }\n\n    var biggestUnitForPartial = diffSeverity;\n\n    if (biggestUnitForPartial > 1 && ( // the two dates are different in a way that's larger scale than time\n    standardDateProps.year === 'numeric' || standardDateProps.year === '2-digit') && (standardDateProps.month === 'numeric' || standardDateProps.month === '2-digit') && (standardDateProps.day === 'numeric' || standardDateProps.day === '2-digit')) {\n      biggestUnitForPartial = 1; // make it look like the dates are only different in terms of time\n    }\n\n    var full0 = this.format(start, context);\n    var full1 = this.format(end, context);\n\n    if (full0 === full1) {\n      return full0;\n    }\n\n    var partialDateProps = computePartialFormattingOptions(standardDateProps, biggestUnitForPartial);\n    var partialFormattingFunc = buildFormattingFunc(partialDateProps, extendedSettings, context);\n    var partial0 = partialFormattingFunc(start);\n    var partial1 = partialFormattingFunc(end);\n    var insertion = findCommonInsertion(full0, partial0, full1, partial1);\n    var separator = extendedSettings.separator || '';\n\n    if (insertion) {\n      return insertion.before + partial0 + separator + partial1 + insertion.after;\n    }\n\n    return full0 + separator + full1;\n  };\n\n  NativeFormatter.prototype.getLargestUnit = function () {\n    switch (this.severity) {\n      case 7:\n      case 6:\n      case 5:\n        return 'year';\n\n      case 4:\n        return 'month';\n\n      case 3:\n        return 'week';\n\n      default:\n        return 'day';\n    }\n  };\n\n  return NativeFormatter;\n}();\n\nfunction buildFormattingFunc(standardDateProps, extendedSettings, context) {\n  var standardDatePropCnt = Object.keys(standardDateProps).length;\n\n  if (standardDatePropCnt === 1 && standardDateProps.timeZoneName === 'short') {\n    return function (date) {\n      return formatTimeZoneOffset(date.timeZoneOffset);\n    };\n  }\n\n  if (standardDatePropCnt === 0 && extendedSettings.week) {\n    return function (date) {\n      return formatWeekNumber(context.computeWeekNumber(date.marker), context.weekLabel, context.locale, extendedSettings.week);\n    };\n  }\n\n  return buildNativeFormattingFunc(standardDateProps, extendedSettings, context);\n}\n\nfunction buildNativeFormattingFunc(standardDateProps, extendedSettings, context) {\n  standardDateProps = _assign({}, standardDateProps); // copy\n\n  extendedSettings = _assign({}, extendedSettings); // copy\n\n  sanitizeSettings(standardDateProps, extendedSettings);\n  standardDateProps.timeZone = 'UTC'; // we leverage the only guaranteed timeZone for our UTC markers\n\n  var normalFormat = new Intl.DateTimeFormat(context.locale.codes, standardDateProps);\n  var zeroFormat; // needed?\n\n  if (extendedSettings.omitZeroMinute) {\n    var zeroProps = _assign({}, standardDateProps);\n\n    delete zeroProps.minute; // seconds and ms were already considered in sanitizeSettings\n\n    zeroFormat = new Intl.DateTimeFormat(context.locale.codes, zeroProps);\n  }\n\n  return function (date) {\n    var marker = date.marker;\n    var format;\n\n    if (zeroFormat && !marker.getUTCMinutes()) {\n      format = zeroFormat;\n    } else {\n      format = normalFormat;\n    }\n\n    var s = format.format(marker);\n    return postProcess(s, date, standardDateProps, extendedSettings, context);\n  };\n}\n\nfunction sanitizeSettings(standardDateProps, extendedSettings) {\n  // deal with a browser inconsistency where formatting the timezone\n  // requires that the hour/minute be present.\n  if (standardDateProps.timeZoneName) {\n    if (!standardDateProps.hour) {\n      standardDateProps.hour = '2-digit';\n    }\n\n    if (!standardDateProps.minute) {\n      standardDateProps.minute = '2-digit';\n    }\n  } // only support short timezone names\n\n\n  if (standardDateProps.timeZoneName === 'long') {\n    standardDateProps.timeZoneName = 'short';\n  } // if requesting to display seconds, MUST display minutes\n\n\n  if (extendedSettings.omitZeroMinute && (standardDateProps.second || standardDateProps.millisecond)) {\n    delete extendedSettings.omitZeroMinute;\n  }\n}\n\nfunction postProcess(s, date, standardDateProps, extendedSettings, context) {\n  s = s.replace(LTR_RE, ''); // remove left-to-right control chars. do first. good for other regexes\n\n  if (standardDateProps.timeZoneName === 'short') {\n    s = injectTzoStr(s, context.timeZone === 'UTC' || date.timeZoneOffset == null ? 'UTC' : // important to normalize for IE, which does \"GMT\"\n    formatTimeZoneOffset(date.timeZoneOffset));\n  }\n\n  if (extendedSettings.omitCommas) {\n    s = s.replace(COMMA_RE, '').trim();\n  }\n\n  if (extendedSettings.omitZeroMinute) {\n    s = s.replace(':00', ''); // zeroFormat doesn't always achieve this\n  } // ^ do anything that might create adjacent spaces before this point,\n  // because MERIDIEM_RE likes to eat up loading spaces\n\n\n  if (extendedSettings.meridiem === false) {\n    s = s.replace(MERIDIEM_RE, '').trim();\n  } else if (extendedSettings.meridiem === 'narrow') {\n    // a/p\n    s = s.replace(MERIDIEM_RE, function (m0, m1) {\n      return m1.toLocaleLowerCase();\n    });\n  } else if (extendedSettings.meridiem === 'short') {\n    // am/pm\n    s = s.replace(MERIDIEM_RE, function (m0, m1) {\n      return m1.toLocaleLowerCase() + 'm';\n    });\n  } else if (extendedSettings.meridiem === 'lowercase') {\n    // other meridiem transformers already converted to lowercase\n    s = s.replace(MERIDIEM_RE, function (m0) {\n      return m0.toLocaleLowerCase();\n    });\n  }\n\n  s = s.replace(MULTI_SPACE_RE, ' ');\n  s = s.trim();\n  return s;\n}\n\nfunction injectTzoStr(s, tzoStr) {\n  var replaced = false;\n  s = s.replace(UTC_RE, function () {\n    replaced = true;\n    return tzoStr;\n  }); // IE11 doesn't include UTC/GMT in the original string, so append to end\n\n  if (!replaced) {\n    s += ' ' + tzoStr;\n  }\n\n  return s;\n}\n\nfunction formatWeekNumber(num, weekLabel, locale, display) {\n  var parts = [];\n\n  if (display === 'narrow') {\n    parts.push(weekLabel);\n  } else if (display === 'short') {\n    parts.push(weekLabel, ' ');\n  } // otherwise, considered 'numeric'\n\n\n  parts.push(locale.simpleNumberFormat.format(num));\n\n  if (locale.options.isRtl) {\n    // TODO: use control characters instead?\n    parts.reverse();\n  }\n\n  return parts.join('');\n} // Range Formatting Utils\n// 0 = exactly the same\n// 1 = different by time\n// and bigger\n\n\nfunction computeMarkerDiffSeverity(d0, d1, ca) {\n  if (ca.getMarkerYear(d0) !== ca.getMarkerYear(d1)) {\n    return 5;\n  }\n\n  if (ca.getMarkerMonth(d0) !== ca.getMarkerMonth(d1)) {\n    return 4;\n  }\n\n  if (ca.getMarkerDay(d0) !== ca.getMarkerDay(d1)) {\n    return 2;\n  }\n\n  if (timeAsMs(d0) !== timeAsMs(d1)) {\n    return 1;\n  }\n\n  return 0;\n}\n\nfunction computePartialFormattingOptions(options, biggestUnit) {\n  var partialOptions = {};\n\n  for (var name_2 in options) {\n    if (!(name_2 in STANDARD_DATE_PROP_SEVERITIES) || // not a date part prop (like timeZone)\n    STANDARD_DATE_PROP_SEVERITIES[name_2] <= biggestUnit) {\n      partialOptions[name_2] = options[name_2];\n    }\n  }\n\n  return partialOptions;\n}\n\nfunction findCommonInsertion(full0, partial0, full1, partial1) {\n  var i0 = 0;\n\n  while (i0 < full0.length) {\n    var found0 = full0.indexOf(partial0, i0);\n\n    if (found0 === -1) {\n      break;\n    }\n\n    var before0 = full0.substr(0, found0);\n    i0 = found0 + partial0.length;\n    var after0 = full0.substr(i0);\n    var i1 = 0;\n\n    while (i1 < full1.length) {\n      var found1 = full1.indexOf(partial1, i1);\n\n      if (found1 === -1) {\n        break;\n      }\n\n      var before1 = full1.substr(0, found1);\n      i1 = found1 + partial1.length;\n      var after1 = full1.substr(i1);\n\n      if (before0 === before1 && after0 === after1) {\n        return {\n          before: before0,\n          after: after0\n        };\n      }\n    }\n  }\n\n  return null;\n}\n/*\r\nTODO: fix the terminology of \"formatter\" vs \"formatting func\"\r\n*/\n\n/*\r\nAt the time of instantiation, this object does not know which cmd-formatting system it will use.\r\nIt receives this at the time of formatting, as a setting.\r\n*/\n\n\nvar CmdFormatter =\n/** @class */\nfunction () {\n  function CmdFormatter(cmdStr, separator) {\n    this.cmdStr = cmdStr;\n    this.separator = separator;\n  }\n\n  CmdFormatter.prototype.format = function (date, context) {\n    return context.cmdFormatter(this.cmdStr, createVerboseFormattingArg(date, null, context, this.separator));\n  };\n\n  CmdFormatter.prototype.formatRange = function (start, end, context) {\n    return context.cmdFormatter(this.cmdStr, createVerboseFormattingArg(start, end, context, this.separator));\n  };\n\n  return CmdFormatter;\n}();\n\nvar FuncFormatter =\n/** @class */\nfunction () {\n  function FuncFormatter(func) {\n    this.func = func;\n  }\n\n  FuncFormatter.prototype.format = function (date, context) {\n    return this.func(createVerboseFormattingArg(date, null, context));\n  };\n\n  FuncFormatter.prototype.formatRange = function (start, end, context) {\n    return this.func(createVerboseFormattingArg(start, end, context));\n  };\n\n  return FuncFormatter;\n}(); // Formatter Object Creation\n\n\nfunction createFormatter(input, defaultSeparator) {\n  if (typeof input === 'object' && input) {\n    // non-null object\n    if (typeof defaultSeparator === 'string') {\n      input = _assign({\n        separator: defaultSeparator\n      }, input);\n    }\n\n    return new NativeFormatter(input);\n  } else if (typeof input === 'string') {\n    return new CmdFormatter(input, defaultSeparator);\n  } else if (typeof input === 'function') {\n    return new FuncFormatter(input);\n  }\n} // String Utils\n// timeZoneOffset is in minutes\n\n\nfunction buildIsoString(marker, timeZoneOffset, stripZeroTime) {\n  if (stripZeroTime === void 0) {\n    stripZeroTime = false;\n  }\n\n  var s = marker.toISOString();\n  s = s.replace('.000', '');\n\n  if (stripZeroTime) {\n    s = s.replace('T00:00:00Z', '');\n  }\n\n  if (s.length > 10) {\n    // time part wasn't stripped, can add timezone info\n    if (timeZoneOffset == null) {\n      s = s.replace('Z', '');\n    } else if (timeZoneOffset !== 0) {\n      s = s.replace('Z', formatTimeZoneOffset(timeZoneOffset, true));\n    } // otherwise, its UTC-0 and we want to keep the Z\n\n  }\n\n  return s;\n}\n\nfunction formatIsoTimeString(marker) {\n  return padStart(marker.getUTCHours(), 2) + ':' + padStart(marker.getUTCMinutes(), 2) + ':' + padStart(marker.getUTCSeconds(), 2);\n}\n\nfunction formatTimeZoneOffset(minutes, doIso) {\n  if (doIso === void 0) {\n    doIso = false;\n  }\n\n  var sign = minutes < 0 ? '-' : '+';\n  var abs = Math.abs(minutes);\n  var hours = Math.floor(abs / 60);\n  var mins = Math.round(abs % 60);\n\n  if (doIso) {\n    return sign + padStart(hours, 2) + ':' + padStart(mins, 2);\n  } else {\n    return 'GMT' + sign + hours + (mins ? ':' + padStart(mins, 2) : '');\n  }\n} // Arg Utils\n\n\nfunction createVerboseFormattingArg(start, end, context, separator) {\n  var startInfo = expandZonedMarker(start, context.calendarSystem);\n  var endInfo = end ? expandZonedMarker(end, context.calendarSystem) : null;\n  return {\n    date: startInfo,\n    start: startInfo,\n    end: endInfo,\n    timeZone: context.timeZone,\n    localeCodes: context.locale.codes,\n    separator: separator\n  };\n}\n\nfunction expandZonedMarker(dateInfo, calendarSystem) {\n  var a = calendarSystem.markerToArray(dateInfo.marker);\n  return {\n    marker: dateInfo.marker,\n    timeZoneOffset: dateInfo.timeZoneOffset,\n    array: a,\n    year: a[0],\n    month: a[1],\n    day: a[2],\n    hour: a[3],\n    minute: a[4],\n    second: a[5],\n    millisecond: a[6]\n  };\n}\n\nvar EventSourceApi =\n/** @class */\nfunction () {\n  function EventSourceApi(calendar, internalEventSource) {\n    this.calendar = calendar;\n    this.internalEventSource = internalEventSource;\n  }\n\n  EventSourceApi.prototype.remove = function () {\n    this.calendar.dispatch({\n      type: 'REMOVE_EVENT_SOURCE',\n      sourceId: this.internalEventSource.sourceId\n    });\n  };\n\n  EventSourceApi.prototype.refetch = function () {\n    this.calendar.dispatch({\n      type: 'FETCH_EVENT_SOURCES',\n      sourceIds: [this.internalEventSource.sourceId]\n    });\n  };\n\n  Object.defineProperty(EventSourceApi.prototype, \"id\", {\n    get: function get() {\n      return this.internalEventSource.publicId;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(EventSourceApi.prototype, \"url\", {\n    // only relevant to json-feed event sources\n    get: function get() {\n      return this.internalEventSource.meta.url;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  return EventSourceApi;\n}();\n\nvar EventApi =\n/** @class */\nfunction () {\n  function EventApi(calendar, def, instance) {\n    this._calendar = calendar;\n    this._def = def;\n    this._instance = instance || null;\n  }\n  /*\r\n  TODO: make event struct more responsible for this\r\n  */\n\n\n  EventApi.prototype.setProp = function (name, val) {\n    var _a, _b;\n\n    if (name in DATE_PROPS) ;else if (name in NON_DATE_PROPS) {\n      if (typeof NON_DATE_PROPS[name] === 'function') {\n        val = NON_DATE_PROPS[name](val);\n      }\n\n      this.mutate({\n        standardProps: (_a = {}, _a[name] = val, _a)\n      });\n    } else if (name in UNSCOPED_EVENT_UI_PROPS) {\n      var ui = void 0;\n\n      if (typeof UNSCOPED_EVENT_UI_PROPS[name] === 'function') {\n        val = UNSCOPED_EVENT_UI_PROPS[name](val);\n      }\n\n      if (name === 'color') {\n        ui = {\n          backgroundColor: val,\n          borderColor: val\n        };\n      } else if (name === 'editable') {\n        ui = {\n          startEditable: val,\n          durationEditable: val\n        };\n      } else {\n        ui = (_b = {}, _b[name] = val, _b);\n      }\n\n      this.mutate({\n        standardProps: {\n          ui: ui\n        }\n      });\n    }\n  };\n\n  EventApi.prototype.setExtendedProp = function (name, val) {\n    var _a;\n\n    this.mutate({\n      extendedProps: (_a = {}, _a[name] = val, _a)\n    });\n  };\n\n  EventApi.prototype.setStart = function (startInput, options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    var dateEnv = this._calendar.dateEnv;\n    var start = dateEnv.createMarker(startInput);\n\n    if (start && this._instance) {\n      // TODO: warning if parsed bad\n      var instanceRange = this._instance.range;\n      var startDelta = diffDates(instanceRange.start, start, dateEnv, options.granularity); // what if parsed bad!?\n\n      if (options.maintainDuration) {\n        this.mutate({\n          datesDelta: startDelta\n        });\n      } else {\n        this.mutate({\n          startDelta: startDelta\n        });\n      }\n    }\n  };\n\n  EventApi.prototype.setEnd = function (endInput, options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    var dateEnv = this._calendar.dateEnv;\n    var end;\n\n    if (endInput != null) {\n      end = dateEnv.createMarker(endInput);\n\n      if (!end) {\n        return; // TODO: warning if parsed bad\n      }\n    }\n\n    if (this._instance) {\n      if (end) {\n        var endDelta = diffDates(this._instance.range.end, end, dateEnv, options.granularity);\n        this.mutate({\n          endDelta: endDelta\n        });\n      } else {\n        this.mutate({\n          standardProps: {\n            hasEnd: false\n          }\n        });\n      }\n    }\n  };\n\n  EventApi.prototype.setDates = function (startInput, endInput, options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    var dateEnv = this._calendar.dateEnv;\n    var standardProps = {\n      allDay: options.allDay\n    };\n    var start = dateEnv.createMarker(startInput);\n    var end;\n\n    if (!start) {\n      return; // TODO: warning if parsed bad\n    }\n\n    if (endInput != null) {\n      end = dateEnv.createMarker(endInput);\n\n      if (!end) {\n        // TODO: warning if parsed bad\n        return;\n      }\n    }\n\n    if (this._instance) {\n      var instanceRange = this._instance.range; // when computing the diff for an event being converted to all-day,\n      // compute diff off of the all-day values the way event-mutation does.\n\n      if (options.allDay === true) {\n        instanceRange = computeAlignedDayRange(instanceRange);\n      }\n\n      var startDelta = diffDates(instanceRange.start, start, dateEnv, options.granularity);\n\n      if (end) {\n        var endDelta = diffDates(instanceRange.end, end, dateEnv, options.granularity);\n\n        if (durationsEqual(startDelta, endDelta)) {\n          this.mutate({\n            datesDelta: startDelta,\n            standardProps: standardProps\n          });\n        } else {\n          this.mutate({\n            startDelta: startDelta,\n            endDelta: endDelta,\n            standardProps: standardProps\n          });\n        }\n      } else {\n        // means \"clear the end\"\n        standardProps.hasEnd = false;\n        this.mutate({\n          datesDelta: startDelta,\n          standardProps: standardProps\n        });\n      }\n    }\n  };\n\n  EventApi.prototype.moveStart = function (deltaInput) {\n    var delta = createDuration(deltaInput);\n\n    if (delta) {\n      // TODO: warning if parsed bad\n      this.mutate({\n        startDelta: delta\n      });\n    }\n  };\n\n  EventApi.prototype.moveEnd = function (deltaInput) {\n    var delta = createDuration(deltaInput);\n\n    if (delta) {\n      // TODO: warning if parsed bad\n      this.mutate({\n        endDelta: delta\n      });\n    }\n  };\n\n  EventApi.prototype.moveDates = function (deltaInput) {\n    var delta = createDuration(deltaInput);\n\n    if (delta) {\n      // TODO: warning if parsed bad\n      this.mutate({\n        datesDelta: delta\n      });\n    }\n  };\n\n  EventApi.prototype.setAllDay = function (allDay, options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    var standardProps = {\n      allDay: allDay\n    };\n    var maintainDuration = options.maintainDuration;\n\n    if (maintainDuration == null) {\n      maintainDuration = this._calendar.opt('allDayMaintainDuration');\n    }\n\n    if (this._def.allDay !== allDay) {\n      standardProps.hasEnd = maintainDuration;\n    }\n\n    this.mutate({\n      standardProps: standardProps\n    });\n  };\n\n  EventApi.prototype.formatRange = function (formatInput) {\n    var dateEnv = this._calendar.dateEnv;\n    var instance = this._instance;\n    var formatter = createFormatter(formatInput, this._calendar.opt('defaultRangeSeparator'));\n\n    if (this._def.hasEnd) {\n      return dateEnv.formatRange(instance.range.start, instance.range.end, formatter, {\n        forcedStartTzo: instance.forcedStartTzo,\n        forcedEndTzo: instance.forcedEndTzo\n      });\n    } else {\n      return dateEnv.format(instance.range.start, formatter, {\n        forcedTzo: instance.forcedStartTzo\n      });\n    }\n  };\n\n  EventApi.prototype.mutate = function (mutation) {\n    var def = this._def;\n    var instance = this._instance;\n\n    if (instance) {\n      this._calendar.dispatch({\n        type: 'MUTATE_EVENTS',\n        instanceId: instance.instanceId,\n        mutation: mutation,\n        fromApi: true\n      });\n\n      var eventStore = this._calendar.state.eventStore;\n      this._def = eventStore.defs[def.defId];\n      this._instance = eventStore.instances[instance.instanceId];\n    }\n  };\n\n  EventApi.prototype.remove = function () {\n    this._calendar.dispatch({\n      type: 'REMOVE_EVENT_DEF',\n      defId: this._def.defId\n    });\n  };\n\n  Object.defineProperty(EventApi.prototype, \"source\", {\n    get: function get() {\n      var sourceId = this._def.sourceId;\n\n      if (sourceId) {\n        return new EventSourceApi(this._calendar, this._calendar.state.eventSources[sourceId]);\n      }\n\n      return null;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(EventApi.prototype, \"start\", {\n    get: function get() {\n      return this._instance ? this._calendar.dateEnv.toDate(this._instance.range.start) : null;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(EventApi.prototype, \"end\", {\n    get: function get() {\n      return this._instance && this._def.hasEnd ? this._calendar.dateEnv.toDate(this._instance.range.end) : null;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(EventApi.prototype, \"id\", {\n    // computable props that all access the def\n    // TODO: find a TypeScript-compatible way to do this at scale\n    get: function get() {\n      return this._def.publicId;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(EventApi.prototype, \"groupId\", {\n    get: function get() {\n      return this._def.groupId;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(EventApi.prototype, \"allDay\", {\n    get: function get() {\n      return this._def.allDay;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(EventApi.prototype, \"title\", {\n    get: function get() {\n      return this._def.title;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(EventApi.prototype, \"url\", {\n    get: function get() {\n      return this._def.url;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(EventApi.prototype, \"rendering\", {\n    get: function get() {\n      return this._def.rendering;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(EventApi.prototype, \"startEditable\", {\n    get: function get() {\n      return this._def.ui.startEditable;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(EventApi.prototype, \"durationEditable\", {\n    get: function get() {\n      return this._def.ui.durationEditable;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(EventApi.prototype, \"constraint\", {\n    get: function get() {\n      return this._def.ui.constraints[0] || null;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(EventApi.prototype, \"overlap\", {\n    get: function get() {\n      return this._def.ui.overlap;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(EventApi.prototype, \"allow\", {\n    get: function get() {\n      return this._def.ui.allows[0] || null;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(EventApi.prototype, \"backgroundColor\", {\n    get: function get() {\n      return this._def.ui.backgroundColor;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(EventApi.prototype, \"borderColor\", {\n    get: function get() {\n      return this._def.ui.borderColor;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(EventApi.prototype, \"textColor\", {\n    get: function get() {\n      return this._def.ui.textColor;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(EventApi.prototype, \"classNames\", {\n    // NOTE: user can't modify these because Object.freeze was called in event-def parsing\n    get: function get() {\n      return this._def.ui.classNames;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(EventApi.prototype, \"extendedProps\", {\n    get: function get() {\n      return this._def.extendedProps;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  return EventApi;\n}();\n/*\r\nSpecifying nextDayThreshold signals that all-day ranges should be sliced.\r\n*/\n\n\nfunction sliceEventStore(eventStore, eventUiBases, framingRange, nextDayThreshold) {\n  var inverseBgByGroupId = {};\n  var inverseBgByDefId = {};\n  var defByGroupId = {};\n  var bgRanges = [];\n  var fgRanges = [];\n  var eventUis = compileEventUis(eventStore.defs, eventUiBases);\n\n  for (var defId in eventStore.defs) {\n    var def = eventStore.defs[defId];\n\n    if (def.rendering === 'inverse-background') {\n      if (def.groupId) {\n        inverseBgByGroupId[def.groupId] = [];\n\n        if (!defByGroupId[def.groupId]) {\n          defByGroupId[def.groupId] = def;\n        }\n      } else {\n        inverseBgByDefId[defId] = [];\n      }\n    }\n  }\n\n  for (var instanceId in eventStore.instances) {\n    var instance = eventStore.instances[instanceId];\n    var def = eventStore.defs[instance.defId];\n    var ui = eventUis[def.defId];\n    var origRange = instance.range;\n    var normalRange = !def.allDay && nextDayThreshold ? computeVisibleDayRange(origRange, nextDayThreshold) : origRange;\n    var slicedRange = intersectRanges(normalRange, framingRange);\n\n    if (slicedRange) {\n      if (def.rendering === 'inverse-background') {\n        if (def.groupId) {\n          inverseBgByGroupId[def.groupId].push(slicedRange);\n        } else {\n          inverseBgByDefId[instance.defId].push(slicedRange);\n        }\n      } else {\n        (def.rendering === 'background' ? bgRanges : fgRanges).push({\n          def: def,\n          ui: ui,\n          instance: instance,\n          range: slicedRange,\n          isStart: normalRange.start && normalRange.start.valueOf() === slicedRange.start.valueOf(),\n          isEnd: normalRange.end && normalRange.end.valueOf() === slicedRange.end.valueOf()\n        });\n      }\n    }\n  }\n\n  for (var groupId in inverseBgByGroupId) {\n    // BY GROUP\n    var ranges = inverseBgByGroupId[groupId];\n    var invertedRanges = invertRanges(ranges, framingRange);\n\n    for (var _i = 0, invertedRanges_1 = invertedRanges; _i < invertedRanges_1.length; _i++) {\n      var invertedRange = invertedRanges_1[_i];\n      var def = defByGroupId[groupId];\n      var ui = eventUis[def.defId];\n      bgRanges.push({\n        def: def,\n        ui: ui,\n        instance: null,\n        range: invertedRange,\n        isStart: false,\n        isEnd: false\n      });\n    }\n  }\n\n  for (var defId in inverseBgByDefId) {\n    var ranges = inverseBgByDefId[defId];\n    var invertedRanges = invertRanges(ranges, framingRange);\n\n    for (var _a = 0, invertedRanges_2 = invertedRanges; _a < invertedRanges_2.length; _a++) {\n      var invertedRange = invertedRanges_2[_a];\n      bgRanges.push({\n        def: eventStore.defs[defId],\n        ui: eventUis[defId],\n        instance: null,\n        range: invertedRange,\n        isStart: false,\n        isEnd: false\n      });\n    }\n  }\n\n  return {\n    bg: bgRanges,\n    fg: fgRanges\n  };\n}\n\nfunction hasBgRendering(def) {\n  return def.rendering === 'background' || def.rendering === 'inverse-background';\n}\n\nfunction filterSegsViaEls(view, segs, isMirror) {\n  if (view.hasPublicHandlers('eventRender')) {\n    segs = segs.filter(function (seg) {\n      var custom = view.publiclyTrigger('eventRender', [{\n        event: new EventApi(view.calendar, seg.eventRange.def, seg.eventRange.instance),\n        isMirror: isMirror,\n        isStart: seg.isStart,\n        isEnd: seg.isEnd,\n        // TODO: include seg.range once all components consistently generate it\n        el: seg.el,\n        view: view\n      }]);\n\n      if (custom === false) {\n        // means don't render at all\n        return false;\n      } else if (custom && custom !== true) {\n        seg.el = custom;\n      }\n\n      return true;\n    });\n  }\n\n  for (var _i = 0, segs_1 = segs; _i < segs_1.length; _i++) {\n    var seg = segs_1[_i];\n    setElSeg(seg.el, seg);\n  }\n\n  return segs;\n}\n\nfunction setElSeg(el, seg) {\n  el.fcSeg = seg;\n}\n\nfunction getElSeg(el) {\n  return el.fcSeg || null;\n} // event ui computation\n\n\nfunction compileEventUis(eventDefs, eventUiBases) {\n  return mapHash(eventDefs, function (eventDef) {\n    return compileEventUi(eventDef, eventUiBases);\n  });\n}\n\nfunction compileEventUi(eventDef, eventUiBases) {\n  var uis = [];\n\n  if (eventUiBases['']) {\n    uis.push(eventUiBases['']);\n  }\n\n  if (eventUiBases[eventDef.defId]) {\n    uis.push(eventUiBases[eventDef.defId]);\n  }\n\n  uis.push(eventDef.ui);\n  return combineEventUis(uis);\n} // applies the mutation to ALL defs/instances within the event store\n\n\nfunction applyMutationToEventStore(eventStore, eventConfigBase, mutation, calendar) {\n  var eventConfigs = compileEventUis(eventStore.defs, eventConfigBase);\n  var dest = createEmptyEventStore();\n\n  for (var defId in eventStore.defs) {\n    var def = eventStore.defs[defId];\n    dest.defs[defId] = applyMutationToEventDef(def, eventConfigs[defId], mutation, calendar.pluginSystem.hooks.eventDefMutationAppliers, calendar);\n  }\n\n  for (var instanceId in eventStore.instances) {\n    var instance = eventStore.instances[instanceId];\n    var def = dest.defs[instance.defId]; // important to grab the newly modified def\n\n    dest.instances[instanceId] = applyMutationToEventInstance(instance, def, eventConfigs[instance.defId], mutation, calendar);\n  }\n\n  return dest;\n}\n\nfunction applyMutationToEventDef(eventDef, eventConfig, mutation, appliers, calendar) {\n  var standardProps = mutation.standardProps || {}; // if hasEnd has not been specified, guess a good value based on deltas.\n  // if duration will change, there's no way the default duration will persist,\n  // and thus, we need to mark the event as having a real end\n\n  if (standardProps.hasEnd == null && eventConfig.durationEditable && (mutation.startDelta || mutation.endDelta)) {\n    standardProps.hasEnd = true; // TODO: is this mutation okay?\n  }\n\n  var copy = _assign({}, eventDef, standardProps, {\n    ui: _assign({}, eventDef.ui, standardProps.ui)\n  });\n\n  if (mutation.extendedProps) {\n    copy.extendedProps = _assign({}, copy.extendedProps, mutation.extendedProps);\n  }\n\n  for (var _i = 0, appliers_1 = appliers; _i < appliers_1.length; _i++) {\n    var applier = appliers_1[_i];\n    applier(copy, mutation, calendar);\n  }\n\n  if (!copy.hasEnd && calendar.opt('forceEventDuration')) {\n    copy.hasEnd = true;\n  }\n\n  return copy;\n}\n\nfunction applyMutationToEventInstance(eventInstance, eventDef, // must first be modified by applyMutationToEventDef\neventConfig, mutation, calendar) {\n  var dateEnv = calendar.dateEnv;\n  var forceAllDay = mutation.standardProps && mutation.standardProps.allDay === true;\n  var clearEnd = mutation.standardProps && mutation.standardProps.hasEnd === false;\n\n  var copy = _assign({}, eventInstance);\n\n  if (forceAllDay) {\n    copy.range = computeAlignedDayRange(copy.range);\n  }\n\n  if (mutation.datesDelta && eventConfig.startEditable) {\n    copy.range = {\n      start: dateEnv.add(copy.range.start, mutation.datesDelta),\n      end: dateEnv.add(copy.range.end, mutation.datesDelta)\n    };\n  }\n\n  if (mutation.startDelta && eventConfig.durationEditable) {\n    copy.range = {\n      start: dateEnv.add(copy.range.start, mutation.startDelta),\n      end: copy.range.end\n    };\n  }\n\n  if (mutation.endDelta && eventConfig.durationEditable) {\n    copy.range = {\n      start: copy.range.start,\n      end: dateEnv.add(copy.range.end, mutation.endDelta)\n    };\n  }\n\n  if (clearEnd) {\n    copy.range = {\n      start: copy.range.start,\n      end: calendar.getDefaultEventEnd(eventDef.allDay, copy.range.start)\n    };\n  } // in case event was all-day but the supplied deltas were not\n  // better util for this?\n\n\n  if (eventDef.allDay) {\n    copy.range = {\n      start: startOfDay(copy.range.start),\n      end: startOfDay(copy.range.end)\n    };\n  } // handle invalid durations\n\n\n  if (copy.range.end < copy.range.start) {\n    copy.range.end = calendar.getDefaultEventEnd(eventDef.allDay, copy.range.start);\n  }\n\n  return copy;\n}\n\nfunction reduceEventStore(eventStore, action, eventSources, dateProfile, calendar) {\n  switch (action.type) {\n    case 'RECEIVE_EVENTS':\n      // raw\n      return receiveRawEvents(eventStore, eventSources[action.sourceId], action.fetchId, action.fetchRange, action.rawEvents, calendar);\n\n    case 'ADD_EVENTS':\n      // already parsed, but not expanded\n      return addEvent(eventStore, action.eventStore, // new ones\n      dateProfile ? dateProfile.activeRange : null, calendar);\n\n    case 'MERGE_EVENTS':\n      // already parsed and expanded\n      return mergeEventStores(eventStore, action.eventStore);\n\n    case 'PREV': // TODO: how do we track all actions that affect dateProfile :(\n\n    case 'NEXT':\n    case 'SET_DATE':\n    case 'SET_VIEW_TYPE':\n      if (dateProfile) {\n        return expandRecurring(eventStore, dateProfile.activeRange, calendar);\n      } else {\n        return eventStore;\n      }\n\n    case 'CHANGE_TIMEZONE':\n      return rezoneDates(eventStore, action.oldDateEnv, calendar.dateEnv);\n\n    case 'MUTATE_EVENTS':\n      return applyMutationToRelated(eventStore, action.instanceId, action.mutation, action.fromApi, calendar);\n\n    case 'REMOVE_EVENT_INSTANCES':\n      return excludeInstances(eventStore, action.instances);\n\n    case 'REMOVE_EVENT_DEF':\n      return filterEventStoreDefs(eventStore, function (eventDef) {\n        return eventDef.defId !== action.defId;\n      });\n\n    case 'REMOVE_EVENT_SOURCE':\n      return excludeEventsBySourceId(eventStore, action.sourceId);\n\n    case 'REMOVE_ALL_EVENT_SOURCES':\n      return filterEventStoreDefs(eventStore, function (eventDef) {\n        return !eventDef.sourceId; // only keep events with no source id\n      });\n\n    case 'REMOVE_ALL_EVENTS':\n      return createEmptyEventStore();\n\n    case 'RESET_EVENTS':\n      return {\n        defs: eventStore.defs,\n        instances: eventStore.instances\n      };\n\n    default:\n      return eventStore;\n  }\n}\n\nfunction receiveRawEvents(eventStore, eventSource, fetchId, fetchRange, rawEvents, calendar) {\n  if (eventSource && // not already removed\n  fetchId === eventSource.latestFetchId // TODO: wish this logic was always in event-sources\n  ) {\n      var subset = parseEvents(transformRawEvents(rawEvents, eventSource, calendar), eventSource.sourceId, calendar);\n\n      if (fetchRange) {\n        subset = expandRecurring(subset, fetchRange, calendar);\n      }\n\n      return mergeEventStores(excludeEventsBySourceId(eventStore, eventSource.sourceId), subset);\n    }\n\n  return eventStore;\n}\n\nfunction addEvent(eventStore, subset, expandRange, calendar) {\n  if (expandRange) {\n    subset = expandRecurring(subset, expandRange, calendar);\n  }\n\n  return mergeEventStores(eventStore, subset);\n}\n\nfunction rezoneDates(eventStore, oldDateEnv, newDateEnv) {\n  var defs = eventStore.defs;\n  var instances = mapHash(eventStore.instances, function (instance) {\n    var def = defs[instance.defId];\n\n    if (def.allDay || def.recurringDef) {\n      return instance; // isn't dependent on timezone\n    } else {\n      return _assign({}, instance, {\n        range: {\n          start: newDateEnv.createMarker(oldDateEnv.toDate(instance.range.start, instance.forcedStartTzo)),\n          end: newDateEnv.createMarker(oldDateEnv.toDate(instance.range.end, instance.forcedEndTzo))\n        },\n        forcedStartTzo: newDateEnv.canComputeOffset ? null : instance.forcedStartTzo,\n        forcedEndTzo: newDateEnv.canComputeOffset ? null : instance.forcedEndTzo\n      });\n    }\n  });\n  return {\n    defs: defs,\n    instances: instances\n  };\n}\n\nfunction applyMutationToRelated(eventStore, instanceId, mutation, fromApi, calendar) {\n  var relevant = getRelevantEvents(eventStore, instanceId);\n  var eventConfigBase = fromApi ? {\n    '': {\n      startEditable: true,\n      durationEditable: true,\n      constraints: [],\n      overlap: null,\n      allows: [],\n      backgroundColor: '',\n      borderColor: '',\n      textColor: '',\n      classNames: []\n    }\n  } : calendar.eventUiBases;\n  relevant = applyMutationToEventStore(relevant, eventConfigBase, mutation, calendar);\n  return mergeEventStores(eventStore, relevant);\n}\n\nfunction excludeEventsBySourceId(eventStore, sourceId) {\n  return filterEventStoreDefs(eventStore, function (eventDef) {\n    return eventDef.sourceId !== sourceId;\n  });\n} // QUESTION: why not just return instances? do a general object-property-exclusion util\n\n\nfunction excludeInstances(eventStore, removals) {\n  return {\n    defs: eventStore.defs,\n    instances: filterHash(eventStore.instances, function (instance) {\n      return !removals[instance.instanceId];\n    })\n  };\n} // high-level segmenting-aware tester functions\n// ------------------------------------------------------------------------------------------------------------------------\n\n\nfunction isInteractionValid(interaction, calendar) {\n  return isNewPropsValid({\n    eventDrag: interaction\n  }, calendar); // HACK: the eventDrag props is used for ALL interactions\n}\n\nfunction isDateSelectionValid(dateSelection, calendar) {\n  return isNewPropsValid({\n    dateSelection: dateSelection\n  }, calendar);\n}\n\nfunction isNewPropsValid(newProps, calendar) {\n  var view = calendar.view;\n\n  var props = _assign({\n    businessHours: view ? view.props.businessHours : createEmptyEventStore(),\n    dateSelection: '',\n    eventStore: calendar.state.eventStore,\n    eventUiBases: calendar.eventUiBases,\n    eventSelection: '',\n    eventDrag: null,\n    eventResize: null\n  }, newProps);\n\n  return (calendar.pluginSystem.hooks.isPropsValid || isPropsValid)(props, calendar);\n}\n\nfunction isPropsValid(state, calendar, dateSpanMeta, filterConfig) {\n  if (dateSpanMeta === void 0) {\n    dateSpanMeta = {};\n  }\n\n  if (state.eventDrag && !isInteractionPropsValid(state, calendar, dateSpanMeta, filterConfig)) {\n    return false;\n  }\n\n  if (state.dateSelection && !isDateSelectionPropsValid(state, calendar, dateSpanMeta, filterConfig)) {\n    return false;\n  }\n\n  return true;\n} // Moving Event Validation\n// ------------------------------------------------------------------------------------------------------------------------\n\n\nfunction isInteractionPropsValid(state, calendar, dateSpanMeta, filterConfig) {\n  var interaction = state.eventDrag; // HACK: the eventDrag props is used for ALL interactions\n\n  var subjectEventStore = interaction.mutatedEvents;\n  var subjectDefs = subjectEventStore.defs;\n  var subjectInstances = subjectEventStore.instances;\n  var subjectConfigs = compileEventUis(subjectDefs, interaction.isEvent ? state.eventUiBases : {\n    '': calendar.selectionConfig\n  } // if not a real event, validate as a selection\n  );\n\n  if (filterConfig) {\n    subjectConfigs = mapHash(subjectConfigs, filterConfig);\n  }\n\n  var otherEventStore = excludeInstances(state.eventStore, interaction.affectedEvents.instances); // exclude the subject events. TODO: exclude defs too?\n\n  var otherDefs = otherEventStore.defs;\n  var otherInstances = otherEventStore.instances;\n  var otherConfigs = compileEventUis(otherDefs, state.eventUiBases);\n\n  for (var subjectInstanceId in subjectInstances) {\n    var subjectInstance = subjectInstances[subjectInstanceId];\n    var subjectRange = subjectInstance.range;\n    var subjectConfig = subjectConfigs[subjectInstance.defId];\n    var subjectDef = subjectDefs[subjectInstance.defId]; // constraint\n\n    if (!allConstraintsPass(subjectConfig.constraints, subjectRange, otherEventStore, state.businessHours, calendar)) {\n      return false;\n    } // overlap\n\n\n    var overlapFunc = calendar.opt('eventOverlap');\n\n    if (typeof overlapFunc !== 'function') {\n      overlapFunc = null;\n    }\n\n    for (var otherInstanceId in otherInstances) {\n      var otherInstance = otherInstances[otherInstanceId]; // intersect! evaluate\n\n      if (rangesIntersect(subjectRange, otherInstance.range)) {\n        var otherOverlap = otherConfigs[otherInstance.defId].overlap; // consider the other event's overlap. only do this if the subject event is a \"real\" event\n\n        if (otherOverlap === false && interaction.isEvent) {\n          return false;\n        }\n\n        if (subjectConfig.overlap === false) {\n          return false;\n        }\n\n        if (overlapFunc && !overlapFunc(new EventApi(calendar, otherDefs[otherInstance.defId], otherInstance), // still event\n        new EventApi(calendar, subjectDef, subjectInstance) // moving event\n        )) {\n          return false;\n        }\n      }\n    } // allow (a function)\n\n\n    var calendarEventStore = calendar.state.eventStore; // need global-to-calendar, not local to component (splittable)state\n\n    for (var _i = 0, _a = subjectConfig.allows; _i < _a.length; _i++) {\n      var subjectAllow = _a[_i];\n\n      var subjectDateSpan = _assign({}, dateSpanMeta, {\n        range: subjectInstance.range,\n        allDay: subjectDef.allDay\n      });\n\n      var origDef = calendarEventStore.defs[subjectDef.defId];\n      var origInstance = calendarEventStore.instances[subjectInstanceId];\n      var eventApi = void 0;\n\n      if (origDef) {\n        // was previously in the calendar\n        eventApi = new EventApi(calendar, origDef, origInstance);\n      } else {\n        // was an external event\n        eventApi = new EventApi(calendar, subjectDef); // no instance, because had no dates\n      }\n\n      if (!subjectAllow(calendar.buildDateSpanApi(subjectDateSpan), eventApi)) {\n        return false;\n      }\n    }\n  }\n\n  return true;\n} // Date Selection Validation\n// ------------------------------------------------------------------------------------------------------------------------\n\n\nfunction isDateSelectionPropsValid(state, calendar, dateSpanMeta, filterConfig) {\n  var relevantEventStore = state.eventStore;\n  var relevantDefs = relevantEventStore.defs;\n  var relevantInstances = relevantEventStore.instances;\n  var selection = state.dateSelection;\n  var selectionRange = selection.range;\n  var selectionConfig = calendar.selectionConfig;\n\n  if (filterConfig) {\n    selectionConfig = filterConfig(selectionConfig);\n  } // constraint\n\n\n  if (!allConstraintsPass(selectionConfig.constraints, selectionRange, relevantEventStore, state.businessHours, calendar)) {\n    return false;\n  } // overlap\n\n\n  var overlapFunc = calendar.opt('selectOverlap');\n\n  if (typeof overlapFunc !== 'function') {\n    overlapFunc = null;\n  }\n\n  for (var relevantInstanceId in relevantInstances) {\n    var relevantInstance = relevantInstances[relevantInstanceId]; // intersect! evaluate\n\n    if (rangesIntersect(selectionRange, relevantInstance.range)) {\n      if (selectionConfig.overlap === false) {\n        return false;\n      }\n\n      if (overlapFunc && !overlapFunc(new EventApi(calendar, relevantDefs[relevantInstance.defId], relevantInstance))) {\n        return false;\n      }\n    }\n  } // allow (a function)\n\n\n  for (var _i = 0, _a = selectionConfig.allows; _i < _a.length; _i++) {\n    var selectionAllow = _a[_i];\n\n    var fullDateSpan = _assign({}, dateSpanMeta, selection);\n\n    if (!selectionAllow(calendar.buildDateSpanApi(fullDateSpan), null)) {\n      return false;\n    }\n  }\n\n  return true;\n} // Constraint Utils\n// ------------------------------------------------------------------------------------------------------------------------\n\n\nfunction allConstraintsPass(constraints, subjectRange, otherEventStore, businessHoursUnexpanded, calendar) {\n  for (var _i = 0, constraints_1 = constraints; _i < constraints_1.length; _i++) {\n    var constraint = constraints_1[_i];\n\n    if (!anyRangesContainRange(constraintToRanges(constraint, subjectRange, otherEventStore, businessHoursUnexpanded, calendar), subjectRange)) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nfunction constraintToRanges(constraint, subjectRange, // for expanding a recurring constraint, or expanding business hours\notherEventStore, // for if constraint is an even group ID\nbusinessHoursUnexpanded, // for if constraint is 'businessHours'\ncalendar // for expanding businesshours\n) {\n  if (constraint === 'businessHours') {\n    return eventStoreToRanges(expandRecurring(businessHoursUnexpanded, subjectRange, calendar));\n  } else if (typeof constraint === 'string') {\n    // an group ID\n    return eventStoreToRanges(filterEventStoreDefs(otherEventStore, function (eventDef) {\n      return eventDef.groupId === constraint;\n    }));\n  } else if (typeof constraint === 'object' && constraint) {\n    // non-null object\n    return eventStoreToRanges(expandRecurring(constraint, subjectRange, calendar));\n  }\n\n  return []; // if it's false\n} // TODO: move to event-store file?\n\n\nfunction eventStoreToRanges(eventStore) {\n  var instances = eventStore.instances;\n  var ranges = [];\n\n  for (var instanceId in instances) {\n    ranges.push(instances[instanceId].range);\n  }\n\n  return ranges;\n} // TODO: move to geom file?\n\n\nfunction anyRangesContainRange(outerRanges, innerRange) {\n  for (var _i = 0, outerRanges_1 = outerRanges; _i < outerRanges_1.length; _i++) {\n    var outerRange = outerRanges_1[_i];\n\n    if (rangeContainsRange(outerRange, innerRange)) {\n      return true;\n    }\n  }\n\n  return false;\n} // Parsing\n// ------------------------------------------------------------------------------------------------------------------------\n\n\nfunction normalizeConstraint(input, calendar) {\n  if (Array.isArray(input)) {\n    return parseEvents(input, '', calendar, true); // allowOpenRange=true\n  } else if (typeof input === 'object' && input) {\n    // non-null object\n    return parseEvents([input], '', calendar, true); // allowOpenRange=true\n  } else if (input != null) {\n    return String(input);\n  } else {\n    return null;\n  }\n}\n\nfunction htmlEscape(s) {\n  return (s + '').replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/'/g, '&#039;').replace(/\"/g, '&quot;').replace(/\\n/g, '<br />');\n} // Given a hash of CSS properties, returns a string of CSS.\n// Uses property names as-is (no camel-case conversion). Will not make statements for null/undefined values.\n\n\nfunction cssToStr(cssProps) {\n  var statements = [];\n\n  for (var name_1 in cssProps) {\n    var val = cssProps[name_1];\n\n    if (val != null && val !== '') {\n      statements.push(name_1 + ':' + val);\n    }\n  }\n\n  return statements.join(';');\n} // Given an object hash of HTML attribute names to values,\n// generates a string that can be injected between < > in HTML\n\n\nfunction attrsToStr(attrs) {\n  var parts = [];\n\n  for (var name_2 in attrs) {\n    var val = attrs[name_2];\n\n    if (val != null) {\n      parts.push(name_2 + '=\"' + htmlEscape(val) + '\"');\n    }\n  }\n\n  return parts.join(' ');\n}\n\nfunction parseClassName(raw) {\n  if (Array.isArray(raw)) {\n    return raw;\n  } else if (typeof raw === 'string') {\n    return raw.split(/\\s+/);\n  } else {\n    return [];\n  }\n}\n\nvar UNSCOPED_EVENT_UI_PROPS = {\n  editable: Boolean,\n  startEditable: Boolean,\n  durationEditable: Boolean,\n  constraint: null,\n  overlap: null,\n  allow: null,\n  className: parseClassName,\n  classNames: parseClassName,\n  color: String,\n  backgroundColor: String,\n  borderColor: String,\n  textColor: String\n};\n\nfunction processUnscopedUiProps(rawProps, calendar, leftovers) {\n  var props = refineProps(rawProps, UNSCOPED_EVENT_UI_PROPS, {}, leftovers);\n  var constraint = normalizeConstraint(props.constraint, calendar);\n  return {\n    startEditable: props.startEditable != null ? props.startEditable : props.editable,\n    durationEditable: props.durationEditable != null ? props.durationEditable : props.editable,\n    constraints: constraint != null ? [constraint] : [],\n    overlap: props.overlap,\n    allows: props.allow != null ? [props.allow] : [],\n    backgroundColor: props.backgroundColor || props.color,\n    borderColor: props.borderColor || props.color,\n    textColor: props.textColor,\n    classNames: props.classNames.concat(props.className)\n  };\n}\n\nfunction processScopedUiProps(prefix, rawScoped, calendar, leftovers) {\n  var rawUnscoped = {};\n  var wasFound = {};\n\n  for (var key in UNSCOPED_EVENT_UI_PROPS) {\n    var scopedKey = prefix + capitaliseFirstLetter(key);\n    rawUnscoped[key] = rawScoped[scopedKey];\n    wasFound[scopedKey] = true;\n  }\n\n  if (prefix === 'event') {\n    rawUnscoped.editable = rawScoped.editable; // special case. there is no 'eventEditable', just 'editable'\n  }\n\n  if (leftovers) {\n    for (var key in rawScoped) {\n      if (!wasFound[key]) {\n        leftovers[key] = rawScoped[key];\n      }\n    }\n  }\n\n  return processUnscopedUiProps(rawUnscoped, calendar);\n}\n\nvar EMPTY_EVENT_UI = {\n  startEditable: null,\n  durationEditable: null,\n  constraints: [],\n  overlap: null,\n  allows: [],\n  backgroundColor: '',\n  borderColor: '',\n  textColor: '',\n  classNames: []\n}; // prevent against problems with <2 args!\n\nfunction combineEventUis(uis) {\n  return uis.reduce(combineTwoEventUis, EMPTY_EVENT_UI);\n}\n\nfunction combineTwoEventUis(item0, item1) {\n  return {\n    startEditable: item1.startEditable != null ? item1.startEditable : item0.startEditable,\n    durationEditable: item1.durationEditable != null ? item1.durationEditable : item0.durationEditable,\n    constraints: item0.constraints.concat(item1.constraints),\n    overlap: typeof item1.overlap === 'boolean' ? item1.overlap : item0.overlap,\n    allows: item0.allows.concat(item1.allows),\n    backgroundColor: item1.backgroundColor || item0.backgroundColor,\n    borderColor: item1.borderColor || item0.borderColor,\n    textColor: item1.textColor || item0.textColor,\n    classNames: item0.classNames.concat(item1.classNames)\n  };\n}\n\nvar NON_DATE_PROPS = {\n  id: String,\n  groupId: String,\n  title: String,\n  url: String,\n  rendering: String,\n  extendedProps: null\n};\nvar DATE_PROPS = {\n  start: null,\n  date: null,\n  end: null,\n  allDay: null\n};\nvar uid = 0;\n\nfunction parseEvent(raw, sourceId, calendar, allowOpenRange) {\n  var allDayDefault = computeIsAllDayDefault(sourceId, calendar);\n  var leftovers0 = {};\n  var recurringRes = parseRecurring(raw, // raw, but with single-event stuff stripped out\n  allDayDefault, calendar.dateEnv, calendar.pluginSystem.hooks.recurringTypes, leftovers0 // will populate with non-recurring props\n  );\n\n  if (recurringRes) {\n    var def = parseEventDef(leftovers0, sourceId, recurringRes.allDay, Boolean(recurringRes.duration), calendar);\n    def.recurringDef = {\n      typeId: recurringRes.typeId,\n      typeData: recurringRes.typeData,\n      duration: recurringRes.duration\n    };\n    return {\n      def: def,\n      instance: null\n    };\n  } else {\n    var leftovers1 = {};\n    var singleRes = parseSingle(raw, allDayDefault, calendar, leftovers1, allowOpenRange);\n\n    if (singleRes) {\n      var def = parseEventDef(leftovers1, sourceId, singleRes.allDay, singleRes.hasEnd, calendar);\n      var instance = createEventInstance(def.defId, singleRes.range, singleRes.forcedStartTzo, singleRes.forcedEndTzo);\n      return {\n        def: def,\n        instance: instance\n      };\n    }\n  }\n\n  return null;\n}\n/*\r\nWill NOT populate extendedProps with the leftover properties.\r\nWill NOT populate date-related props.\r\nThe EventNonDateInput has been normalized (id => publicId, etc).\r\n*/\n\n\nfunction parseEventDef(raw, sourceId, allDay, hasEnd, calendar) {\n  var leftovers = {};\n  var def = pluckNonDateProps(raw, calendar, leftovers);\n  def.defId = String(uid++);\n  def.sourceId = sourceId;\n  def.allDay = allDay;\n  def.hasEnd = hasEnd;\n\n  for (var _i = 0, _a = calendar.pluginSystem.hooks.eventDefParsers; _i < _a.length; _i++) {\n    var eventDefParser = _a[_i];\n    var newLeftovers = {};\n    eventDefParser(def, leftovers, newLeftovers);\n    leftovers = newLeftovers;\n  }\n\n  def.extendedProps = _assign(leftovers, def.extendedProps || {}); // help out EventApi from having user modify props\n\n  Object.freeze(def.ui.classNames);\n  Object.freeze(def.extendedProps);\n  return def;\n}\n\nfunction createEventInstance(defId, range, forcedStartTzo, forcedEndTzo) {\n  return {\n    instanceId: String(uid++),\n    defId: defId,\n    range: range,\n    forcedStartTzo: forcedStartTzo == null ? null : forcedStartTzo,\n    forcedEndTzo: forcedEndTzo == null ? null : forcedEndTzo\n  };\n}\n\nfunction parseSingle(raw, allDayDefault, calendar, leftovers, allowOpenRange) {\n  var props = pluckDateProps(raw, leftovers);\n  var allDay = props.allDay;\n  var startMeta;\n  var startMarker = null;\n  var hasEnd = false;\n  var endMeta;\n  var endMarker = null;\n  startMeta = calendar.dateEnv.createMarkerMeta(props.start);\n\n  if (startMeta) {\n    startMarker = startMeta.marker;\n  } else if (!allowOpenRange) {\n    return null;\n  }\n\n  if (props.end != null) {\n    endMeta = calendar.dateEnv.createMarkerMeta(props.end);\n  }\n\n  if (allDay == null) {\n    if (allDayDefault != null) {\n      allDay = allDayDefault;\n    } else {\n      // fall back to the date props LAST\n      allDay = (!startMeta || startMeta.isTimeUnspecified) && (!endMeta || endMeta.isTimeUnspecified);\n    }\n  }\n\n  if (allDay && startMarker) {\n    startMarker = startOfDay(startMarker);\n  }\n\n  if (endMeta) {\n    endMarker = endMeta.marker;\n\n    if (allDay) {\n      endMarker = startOfDay(endMarker);\n    }\n\n    if (startMarker && endMarker <= startMarker) {\n      endMarker = null;\n    }\n  }\n\n  if (endMarker) {\n    hasEnd = true;\n  } else if (!allowOpenRange) {\n    hasEnd = calendar.opt('forceEventDuration') || false;\n    endMarker = calendar.dateEnv.add(startMarker, allDay ? calendar.defaultAllDayEventDuration : calendar.defaultTimedEventDuration);\n  }\n\n  return {\n    allDay: allDay,\n    hasEnd: hasEnd,\n    range: {\n      start: startMarker,\n      end: endMarker\n    },\n    forcedStartTzo: startMeta ? startMeta.forcedTzo : null,\n    forcedEndTzo: endMeta ? endMeta.forcedTzo : null\n  };\n}\n\nfunction pluckDateProps(raw, leftovers) {\n  var props = refineProps(raw, DATE_PROPS, {}, leftovers);\n  props.start = props.start !== null ? props.start : props.date;\n  delete props.date;\n  return props;\n}\n\nfunction pluckNonDateProps(raw, calendar, leftovers) {\n  var preLeftovers = {};\n  var props = refineProps(raw, NON_DATE_PROPS, {}, preLeftovers);\n  var ui = processUnscopedUiProps(preLeftovers, calendar, leftovers);\n  props.publicId = props.id;\n  delete props.id;\n  props.ui = ui;\n  return props;\n}\n\nfunction computeIsAllDayDefault(sourceId, calendar) {\n  var res = null;\n\n  if (sourceId) {\n    var source = calendar.state.eventSources[sourceId];\n    res = source.allDayDefault;\n  }\n\n  if (res == null) {\n    res = calendar.opt('allDayDefault');\n  }\n\n  return res;\n}\n\nvar DEF_DEFAULTS = {\n  startTime: '09:00',\n  endTime: '17:00',\n  daysOfWeek: [1, 2, 3, 4, 5],\n  rendering: 'inverse-background',\n  classNames: 'fc-nonbusiness',\n  groupId: '_businessHours' // so multiple defs get grouped\n\n};\n/*\r\nTODO: pass around as EventDefHash!!!\r\n*/\n\nfunction parseBusinessHours(input, calendar) {\n  return parseEvents(refineInputs(input), '', calendar);\n}\n\nfunction refineInputs(input) {\n  var rawDefs;\n\n  if (input === true) {\n    rawDefs = [{}]; // will get DEF_DEFAULTS verbatim\n  } else if (Array.isArray(input)) {\n    // if specifying an array, every sub-definition NEEDS a day-of-week\n    rawDefs = input.filter(function (rawDef) {\n      return rawDef.daysOfWeek;\n    });\n  } else if (typeof input === 'object' && input) {\n    // non-null object\n    rawDefs = [input];\n  } else {\n    // is probably false\n    rawDefs = [];\n  }\n\n  rawDefs = rawDefs.map(function (rawDef) {\n    return _assign({}, DEF_DEFAULTS, rawDef);\n  });\n  return rawDefs;\n}\n\nfunction memoizeRendering(renderFunc, unrenderFunc, dependencies) {\n  if (dependencies === void 0) {\n    dependencies = [];\n  }\n\n  var dependents = [];\n  var thisContext;\n  var prevArgs;\n\n  function unrender() {\n    if (prevArgs) {\n      for (var _i = 0, dependents_1 = dependents; _i < dependents_1.length; _i++) {\n        var dependent = dependents_1[_i];\n        dependent.unrender();\n      }\n\n      if (unrenderFunc) {\n        unrenderFunc.apply(thisContext, prevArgs);\n      }\n\n      prevArgs = null;\n    }\n  }\n\n  function res() {\n    if (!prevArgs || !isArraysEqual(prevArgs, arguments)) {\n      unrender();\n      thisContext = this;\n      prevArgs = arguments;\n      renderFunc.apply(this, arguments);\n    }\n  }\n\n  res.dependents = dependents;\n  res.unrender = unrender;\n\n  for (var _i = 0, dependencies_1 = dependencies; _i < dependencies_1.length; _i++) {\n    var dependency = dependencies_1[_i];\n    dependency.dependents.push(res);\n  }\n\n  return res;\n}\n\nvar EMPTY_EVENT_STORE = createEmptyEventStore(); // for purecomponents. TODO: keep elsewhere\n\nvar Splitter =\n/** @class */\nfunction () {\n  function Splitter() {\n    this.getKeysForEventDefs = memoize(this._getKeysForEventDefs);\n    this.splitDateSelection = memoize(this._splitDateSpan);\n    this.splitEventStore = memoize(this._splitEventStore);\n    this.splitIndividualUi = memoize(this._splitIndividualUi);\n    this.splitEventDrag = memoize(this._splitInteraction);\n    this.splitEventResize = memoize(this._splitInteraction);\n    this.eventUiBuilders = {}; // TODO: typescript protection\n  }\n\n  Splitter.prototype.splitProps = function (props) {\n    var _this = this;\n\n    var keyInfos = this.getKeyInfo(props);\n    var defKeys = this.getKeysForEventDefs(props.eventStore);\n    var dateSelections = this.splitDateSelection(props.dateSelection);\n    var individualUi = this.splitIndividualUi(props.eventUiBases, defKeys); // the individual *bases*\n\n    var eventStores = this.splitEventStore(props.eventStore, defKeys);\n    var eventDrags = this.splitEventDrag(props.eventDrag);\n    var eventResizes = this.splitEventResize(props.eventResize);\n    var splitProps = {};\n    this.eventUiBuilders = mapHash(keyInfos, function (info, key) {\n      return _this.eventUiBuilders[key] || memoize(buildEventUiForKey);\n    });\n\n    for (var key in keyInfos) {\n      var keyInfo = keyInfos[key];\n      var eventStore = eventStores[key] || EMPTY_EVENT_STORE;\n      var buildEventUi = this.eventUiBuilders[key];\n      splitProps[key] = {\n        businessHours: keyInfo.businessHours || props.businessHours,\n        dateSelection: dateSelections[key] || null,\n        eventStore: eventStore,\n        eventUiBases: buildEventUi(props.eventUiBases[''], keyInfo.ui, individualUi[key]),\n        eventSelection: eventStore.instances[props.eventSelection] ? props.eventSelection : '',\n        eventDrag: eventDrags[key] || null,\n        eventResize: eventResizes[key] || null\n      };\n    }\n\n    return splitProps;\n  };\n\n  Splitter.prototype._splitDateSpan = function (dateSpan) {\n    var dateSpans = {};\n\n    if (dateSpan) {\n      var keys = this.getKeysForDateSpan(dateSpan);\n\n      for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {\n        var key = keys_1[_i];\n        dateSpans[key] = dateSpan;\n      }\n    }\n\n    return dateSpans;\n  };\n\n  Splitter.prototype._getKeysForEventDefs = function (eventStore) {\n    var _this = this;\n\n    return mapHash(eventStore.defs, function (eventDef) {\n      return _this.getKeysForEventDef(eventDef);\n    });\n  };\n\n  Splitter.prototype._splitEventStore = function (eventStore, defKeys) {\n    var defs = eventStore.defs,\n        instances = eventStore.instances;\n    var splitStores = {};\n\n    for (var defId in defs) {\n      for (var _i = 0, _a = defKeys[defId]; _i < _a.length; _i++) {\n        var key = _a[_i];\n\n        if (!splitStores[key]) {\n          splitStores[key] = createEmptyEventStore();\n        }\n\n        splitStores[key].defs[defId] = defs[defId];\n      }\n    }\n\n    for (var instanceId in instances) {\n      var instance = instances[instanceId];\n\n      for (var _b = 0, _c = defKeys[instance.defId]; _b < _c.length; _b++) {\n        var key = _c[_b];\n\n        if (splitStores[key]) {\n          // must have already been created\n          splitStores[key].instances[instanceId] = instance;\n        }\n      }\n    }\n\n    return splitStores;\n  };\n\n  Splitter.prototype._splitIndividualUi = function (eventUiBases, defKeys) {\n    var splitHashes = {};\n\n    for (var defId in eventUiBases) {\n      if (defId) {\n        // not the '' key\n        for (var _i = 0, _a = defKeys[defId]; _i < _a.length; _i++) {\n          var key = _a[_i];\n\n          if (!splitHashes[key]) {\n            splitHashes[key] = {};\n          }\n\n          splitHashes[key][defId] = eventUiBases[defId];\n        }\n      }\n    }\n\n    return splitHashes;\n  };\n\n  Splitter.prototype._splitInteraction = function (interaction) {\n    var splitStates = {};\n\n    if (interaction) {\n      var affectedStores_1 = this._splitEventStore(interaction.affectedEvents, this._getKeysForEventDefs(interaction.affectedEvents) // can't use cached. might be events from other calendar\n      ); // can't rely on defKeys because event data is mutated\n\n\n      var mutatedKeysByDefId = this._getKeysForEventDefs(interaction.mutatedEvents);\n\n      var mutatedStores_1 = this._splitEventStore(interaction.mutatedEvents, mutatedKeysByDefId);\n\n      var populate = function populate(key) {\n        if (!splitStates[key]) {\n          splitStates[key] = {\n            affectedEvents: affectedStores_1[key] || EMPTY_EVENT_STORE,\n            mutatedEvents: mutatedStores_1[key] || EMPTY_EVENT_STORE,\n            isEvent: interaction.isEvent,\n            origSeg: interaction.origSeg\n          };\n        }\n      };\n\n      for (var key in affectedStores_1) {\n        populate(key);\n      }\n\n      for (var key in mutatedStores_1) {\n        populate(key);\n      }\n    }\n\n    return splitStates;\n  };\n\n  return Splitter;\n}();\n\nfunction buildEventUiForKey(allUi, eventUiForKey, individualUi) {\n  var baseParts = [];\n\n  if (allUi) {\n    baseParts.push(allUi);\n  }\n\n  if (eventUiForKey) {\n    baseParts.push(eventUiForKey);\n  }\n\n  var stuff = {\n    '': combineEventUis(baseParts)\n  };\n\n  if (individualUi) {\n    _assign(stuff, individualUi);\n  }\n\n  return stuff;\n} // Generates HTML for an anchor to another view into the calendar.\n// Will either generate an <a> tag or a non-clickable <span> tag, depending on enabled settings.\n// `gotoOptions` can either be a DateMarker, or an object with the form:\n// { date, type, forceOff }\n// `type` is a view-type like \"day\" or \"week\". default value is \"day\".\n// `attrs` and `innerHtml` are use to generate the rest of the HTML tag.\n\n\nfunction buildGotoAnchorHtml(component, gotoOptions, attrs, innerHtml) {\n  var dateEnv = component.dateEnv;\n  var date;\n  var type;\n  var forceOff;\n  var finalOptions;\n\n  if (gotoOptions instanceof Date) {\n    date = gotoOptions; // a single date-like input\n  } else {\n    date = gotoOptions.date;\n    type = gotoOptions.type;\n    forceOff = gotoOptions.forceOff;\n  }\n\n  finalOptions = {\n    date: dateEnv.formatIso(date, {\n      omitTime: true\n    }),\n    type: type || 'day'\n  };\n\n  if (typeof attrs === 'string') {\n    innerHtml = attrs;\n    attrs = null;\n  }\n\n  attrs = attrs ? ' ' + attrsToStr(attrs) : ''; // will have a leading space\n\n  innerHtml = innerHtml || '';\n\n  if (!forceOff && component.opt('navLinks')) {\n    return '<a' + attrs + ' data-goto=\"' + htmlEscape(JSON.stringify(finalOptions)) + '\">' + innerHtml + '</a>';\n  } else {\n    return '<span' + attrs + '>' + innerHtml + '</span>';\n  }\n}\n\nfunction getAllDayHtml(component) {\n  return component.opt('allDayHtml') || htmlEscape(component.opt('allDayText'));\n} // Computes HTML classNames for a single-day element\n\n\nfunction getDayClasses(date, dateProfile, context, noThemeHighlight) {\n  var calendar = context.calendar,\n      view = context.view,\n      theme = context.theme,\n      dateEnv = context.dateEnv;\n  var classes = [];\n  var todayStart;\n  var todayEnd;\n\n  if (!rangeContainsMarker(dateProfile.activeRange, date)) {\n    classes.push('fc-disabled-day');\n  } else {\n    classes.push('fc-' + DAY_IDS[date.getUTCDay()]);\n\n    if (view.opt('monthMode') && dateEnv.getMonth(date) !== dateEnv.getMonth(dateProfile.currentRange.start)) {\n      classes.push('fc-other-month');\n    }\n\n    todayStart = startOfDay(calendar.getNow());\n    todayEnd = addDays(todayStart, 1);\n\n    if (date < todayStart) {\n      classes.push('fc-past');\n    } else if (date >= todayEnd) {\n      classes.push('fc-future');\n    } else {\n      classes.push('fc-today');\n\n      if (noThemeHighlight !== true) {\n        classes.push(theme.getClass('today'));\n      }\n    }\n  }\n\n  return classes;\n} // given a function that resolves a result asynchronously.\n// the function can either call passed-in success and failure callbacks,\n// or it can return a promise.\n// if you need to pass additional params to func, bind them first.\n\n\nfunction unpromisify(func, success, failure) {\n  // guard against success/failure callbacks being called more than once\n  // and guard against a promise AND callback being used together.\n  var isResolved = false;\n\n  var wrappedSuccess = function wrappedSuccess() {\n    if (!isResolved) {\n      isResolved = true;\n      success.apply(this, arguments);\n    }\n  };\n\n  var wrappedFailure = function wrappedFailure() {\n    if (!isResolved) {\n      isResolved = true;\n\n      if (failure) {\n        failure.apply(this, arguments);\n      }\n    }\n  };\n\n  var res = func(wrappedSuccess, wrappedFailure);\n\n  if (res && typeof res.then === 'function') {\n    res.then(wrappedSuccess, wrappedFailure);\n  }\n}\n\nvar Mixin =\n/** @class */\nfunction () {\n  function Mixin() {} // mix into a CLASS\n\n\n  Mixin.mixInto = function (destClass) {\n    this.mixIntoObj(destClass.prototype);\n  }; // mix into ANY object\n\n\n  Mixin.mixIntoObj = function (destObj) {\n    var _this = this;\n\n    Object.getOwnPropertyNames(this.prototype).forEach(function (name) {\n      if (!destObj[name]) {\n        // if destination doesn't already define it\n        destObj[name] = _this.prototype[name];\n      }\n    });\n  };\n  /*\r\n  will override existing methods\r\n  TODO: remove! not used anymore\r\n  */\n\n\n  Mixin.mixOver = function (destClass) {\n    var _this = this;\n\n    Object.getOwnPropertyNames(this.prototype).forEach(function (name) {\n      destClass.prototype[name] = _this.prototype[name];\n    });\n  };\n\n  return Mixin;\n}();\n/*\r\nUSAGE:\r\n  import { default as EmitterMixin, EmitterInterface } from './EmitterMixin'\r\nin class:\r\n  on: EmitterInterface['on']\r\n  one: EmitterInterface['one']\r\n  off: EmitterInterface['off']\r\n  trigger: EmitterInterface['trigger']\r\n  triggerWith: EmitterInterface['triggerWith']\r\n  hasHandlers: EmitterInterface['hasHandlers']\r\nafter class:\r\n  EmitterMixin.mixInto(TheClass)\r\n*/\n\n\nvar EmitterMixin =\n/** @class */\nfunction (_super) {\n  __extends(EmitterMixin, _super);\n\n  function EmitterMixin() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  EmitterMixin.prototype.on = function (type, handler) {\n    addToHash(this._handlers || (this._handlers = {}), type, handler);\n    return this; // for chaining\n  }; // todo: add comments\n\n\n  EmitterMixin.prototype.one = function (type, handler) {\n    addToHash(this._oneHandlers || (this._oneHandlers = {}), type, handler);\n    return this; // for chaining\n  };\n\n  EmitterMixin.prototype.off = function (type, handler) {\n    if (this._handlers) {\n      removeFromHash(this._handlers, type, handler);\n    }\n\n    if (this._oneHandlers) {\n      removeFromHash(this._oneHandlers, type, handler);\n    }\n\n    return this; // for chaining\n  };\n\n  EmitterMixin.prototype.trigger = function (type) {\n    var args = [];\n\n    for (var _i = 1; _i < arguments.length; _i++) {\n      args[_i - 1] = arguments[_i];\n    }\n\n    this.triggerWith(type, this, args);\n    return this; // for chaining\n  };\n\n  EmitterMixin.prototype.triggerWith = function (type, context, args) {\n    if (this._handlers) {\n      applyAll(this._handlers[type], context, args);\n    }\n\n    if (this._oneHandlers) {\n      applyAll(this._oneHandlers[type], context, args);\n      delete this._oneHandlers[type]; // will never fire again\n    }\n\n    return this; // for chaining\n  };\n\n  EmitterMixin.prototype.hasHandlers = function (type) {\n    return this._handlers && this._handlers[type] && this._handlers[type].length || this._oneHandlers && this._oneHandlers[type] && this._oneHandlers[type].length;\n  };\n\n  return EmitterMixin;\n}(Mixin);\n\nfunction addToHash(hash, type, handler) {\n  (hash[type] || (hash[type] = [])).push(handler);\n}\n\nfunction removeFromHash(hash, type, handler) {\n  if (handler) {\n    if (hash[type]) {\n      hash[type] = hash[type].filter(function (func) {\n        return func !== handler;\n      });\n    }\n  } else {\n    delete hash[type]; // remove all handler funcs for this type\n  }\n}\n/*\r\nRecords offset information for a set of elements, relative to an origin element.\r\nCan record the left/right OR the top/bottom OR both.\r\nProvides methods for querying the cache by position.\r\n*/\n\n\nvar PositionCache =\n/** @class */\nfunction () {\n  function PositionCache(originEl, els, isHorizontal, isVertical) {\n    this.originEl = originEl;\n    this.els = els;\n    this.isHorizontal = isHorizontal;\n    this.isVertical = isVertical;\n  } // Queries the els for coordinates and stores them.\n  // Call this method before using and of the get* methods below.\n\n\n  PositionCache.prototype.build = function () {\n    var originEl = this.originEl;\n    var originClientRect = this.originClientRect = originEl.getBoundingClientRect(); // relative to viewport top-left\n\n    if (this.isHorizontal) {\n      this.buildElHorizontals(originClientRect.left);\n    }\n\n    if (this.isVertical) {\n      this.buildElVerticals(originClientRect.top);\n    }\n  }; // Populates the left/right internal coordinate arrays\n\n\n  PositionCache.prototype.buildElHorizontals = function (originClientLeft) {\n    var lefts = [];\n    var rights = [];\n\n    for (var _i = 0, _a = this.els; _i < _a.length; _i++) {\n      var el = _a[_i];\n      var rect = el.getBoundingClientRect();\n      lefts.push(rect.left - originClientLeft);\n      rights.push(rect.right - originClientLeft);\n    }\n\n    this.lefts = lefts;\n    this.rights = rights;\n  }; // Populates the top/bottom internal coordinate arrays\n\n\n  PositionCache.prototype.buildElVerticals = function (originClientTop) {\n    var tops = [];\n    var bottoms = [];\n\n    for (var _i = 0, _a = this.els; _i < _a.length; _i++) {\n      var el = _a[_i];\n      var rect = el.getBoundingClientRect();\n      tops.push(rect.top - originClientTop);\n      bottoms.push(rect.bottom - originClientTop);\n    }\n\n    this.tops = tops;\n    this.bottoms = bottoms;\n  }; // Given a left offset (from document left), returns the index of the el that it horizontally intersects.\n  // If no intersection is made, returns undefined.\n\n\n  PositionCache.prototype.leftToIndex = function (leftPosition) {\n    var lefts = this.lefts;\n    var rights = this.rights;\n    var len = lefts.length;\n    var i;\n\n    for (i = 0; i < len; i++) {\n      if (leftPosition >= lefts[i] && leftPosition < rights[i]) {\n        return i;\n      }\n    }\n  }; // Given a top offset (from document top), returns the index of the el that it vertically intersects.\n  // If no intersection is made, returns undefined.\n\n\n  PositionCache.prototype.topToIndex = function (topPosition) {\n    var tops = this.tops;\n    var bottoms = this.bottoms;\n    var len = tops.length;\n    var i;\n\n    for (i = 0; i < len; i++) {\n      if (topPosition >= tops[i] && topPosition < bottoms[i]) {\n        return i;\n      }\n    }\n  }; // Gets the width of the element at the given index\n\n\n  PositionCache.prototype.getWidth = function (leftIndex) {\n    return this.rights[leftIndex] - this.lefts[leftIndex];\n  }; // Gets the height of the element at the given index\n\n\n  PositionCache.prototype.getHeight = function (topIndex) {\n    return this.bottoms[topIndex] - this.tops[topIndex];\n  };\n\n  return PositionCache;\n}();\n/*\r\nAn object for getting/setting scroll-related information for an element.\r\nInternally, this is done very differently for window versus DOM element,\r\nso this object serves as a common interface.\r\n*/\n\n\nvar ScrollController =\n/** @class */\nfunction () {\n  function ScrollController() {}\n\n  ScrollController.prototype.getMaxScrollTop = function () {\n    return this.getScrollHeight() - this.getClientHeight();\n  };\n\n  ScrollController.prototype.getMaxScrollLeft = function () {\n    return this.getScrollWidth() - this.getClientWidth();\n  };\n\n  ScrollController.prototype.canScrollVertically = function () {\n    return this.getMaxScrollTop() > 0;\n  };\n\n  ScrollController.prototype.canScrollHorizontally = function () {\n    return this.getMaxScrollLeft() > 0;\n  };\n\n  ScrollController.prototype.canScrollUp = function () {\n    return this.getScrollTop() > 0;\n  };\n\n  ScrollController.prototype.canScrollDown = function () {\n    return this.getScrollTop() < this.getMaxScrollTop();\n  };\n\n  ScrollController.prototype.canScrollLeft = function () {\n    return this.getScrollLeft() > 0;\n  };\n\n  ScrollController.prototype.canScrollRight = function () {\n    return this.getScrollLeft() < this.getMaxScrollLeft();\n  };\n\n  return ScrollController;\n}();\n\nvar ElementScrollController =\n/** @class */\nfunction (_super) {\n  __extends(ElementScrollController, _super);\n\n  function ElementScrollController(el) {\n    var _this = _super.call(this) || this;\n\n    _this.el = el;\n    return _this;\n  }\n\n  ElementScrollController.prototype.getScrollTop = function () {\n    return this.el.scrollTop;\n  };\n\n  ElementScrollController.prototype.getScrollLeft = function () {\n    return this.el.scrollLeft;\n  };\n\n  ElementScrollController.prototype.setScrollTop = function (top) {\n    this.el.scrollTop = top;\n  };\n\n  ElementScrollController.prototype.setScrollLeft = function (left) {\n    this.el.scrollLeft = left;\n  };\n\n  ElementScrollController.prototype.getScrollWidth = function () {\n    return this.el.scrollWidth;\n  };\n\n  ElementScrollController.prototype.getScrollHeight = function () {\n    return this.el.scrollHeight;\n  };\n\n  ElementScrollController.prototype.getClientHeight = function () {\n    return this.el.clientHeight;\n  };\n\n  ElementScrollController.prototype.getClientWidth = function () {\n    return this.el.clientWidth;\n  };\n\n  return ElementScrollController;\n}(ScrollController);\n\nvar WindowScrollController =\n/** @class */\nfunction (_super) {\n  __extends(WindowScrollController, _super);\n\n  function WindowScrollController() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  WindowScrollController.prototype.getScrollTop = function () {\n    return window.pageYOffset;\n  };\n\n  WindowScrollController.prototype.getScrollLeft = function () {\n    return window.pageXOffset;\n  };\n\n  WindowScrollController.prototype.setScrollTop = function (n) {\n    window.scroll(window.pageXOffset, n);\n  };\n\n  WindowScrollController.prototype.setScrollLeft = function (n) {\n    window.scroll(n, window.pageYOffset);\n  };\n\n  WindowScrollController.prototype.getScrollWidth = function () {\n    return document.documentElement.scrollWidth;\n  };\n\n  WindowScrollController.prototype.getScrollHeight = function () {\n    return document.documentElement.scrollHeight;\n  };\n\n  WindowScrollController.prototype.getClientHeight = function () {\n    return document.documentElement.clientHeight;\n  };\n\n  WindowScrollController.prototype.getClientWidth = function () {\n    return document.documentElement.clientWidth;\n  };\n\n  return WindowScrollController;\n}(ScrollController);\n/*\r\nEmbodies a div that has potential scrollbars\r\n*/\n\n\nvar ScrollComponent =\n/** @class */\nfunction (_super) {\n  __extends(ScrollComponent, _super);\n\n  function ScrollComponent(overflowX, overflowY) {\n    var _this = _super.call(this, createElement('div', {\n      className: 'fc-scroller'\n    })) || this;\n\n    _this.overflowX = overflowX;\n    _this.overflowY = overflowY;\n\n    _this.applyOverflow();\n\n    return _this;\n  } // sets to natural height, unlocks overflow\n\n\n  ScrollComponent.prototype.clear = function () {\n    this.setHeight('auto');\n    this.applyOverflow();\n  };\n\n  ScrollComponent.prototype.destroy = function () {\n    removeElement(this.el);\n  }; // Overflow\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  ScrollComponent.prototype.applyOverflow = function () {\n    applyStyle(this.el, {\n      overflowX: this.overflowX,\n      overflowY: this.overflowY\n    });\n  }; // Causes any 'auto' overflow values to resolves to 'scroll' or 'hidden'.\n  // Useful for preserving scrollbar widths regardless of future resizes.\n  // Can pass in scrollbarWidths for optimization.\n\n\n  ScrollComponent.prototype.lockOverflow = function (scrollbarWidths) {\n    var overflowX = this.overflowX;\n    var overflowY = this.overflowY;\n    scrollbarWidths = scrollbarWidths || this.getScrollbarWidths();\n\n    if (overflowX === 'auto') {\n      overflowX = scrollbarWidths.bottom || // horizontal scrollbars?\n      this.canScrollHorizontally() // OR scrolling pane with massless scrollbars?\n      ? 'scroll' : 'hidden';\n    }\n\n    if (overflowY === 'auto') {\n      overflowY = scrollbarWidths.left || scrollbarWidths.right || // horizontal scrollbars?\n      this.canScrollVertically() // OR scrolling pane with massless scrollbars?\n      ? 'scroll' : 'hidden';\n    }\n\n    applyStyle(this.el, {\n      overflowX: overflowX,\n      overflowY: overflowY\n    });\n  };\n\n  ScrollComponent.prototype.setHeight = function (height) {\n    applyStyleProp(this.el, 'height', height);\n  };\n\n  ScrollComponent.prototype.getScrollbarWidths = function () {\n    var edges = computeEdges(this.el);\n    return {\n      left: edges.scrollbarLeft,\n      right: edges.scrollbarRight,\n      bottom: edges.scrollbarBottom\n    };\n  };\n\n  return ScrollComponent;\n}(ElementScrollController);\n\nvar Theme =\n/** @class */\nfunction () {\n  function Theme(calendarOptions) {\n    this.calendarOptions = calendarOptions;\n    this.processIconOverride();\n  }\n\n  Theme.prototype.processIconOverride = function () {\n    if (this.iconOverrideOption) {\n      this.setIconOverride(this.calendarOptions[this.iconOverrideOption]);\n    }\n  };\n\n  Theme.prototype.setIconOverride = function (iconOverrideHash) {\n    var iconClassesCopy;\n    var buttonName;\n\n    if (typeof iconOverrideHash === 'object' && iconOverrideHash) {\n      // non-null object\n      iconClassesCopy = _assign({}, this.iconClasses);\n\n      for (buttonName in iconOverrideHash) {\n        iconClassesCopy[buttonName] = this.applyIconOverridePrefix(iconOverrideHash[buttonName]);\n      }\n\n      this.iconClasses = iconClassesCopy;\n    } else if (iconOverrideHash === false) {\n      this.iconClasses = {};\n    }\n  };\n\n  Theme.prototype.applyIconOverridePrefix = function (className) {\n    var prefix = this.iconOverridePrefix;\n\n    if (prefix && className.indexOf(prefix) !== 0) {\n      // if not already present\n      className = prefix + className;\n    }\n\n    return className;\n  };\n\n  Theme.prototype.getClass = function (key) {\n    return this.classes[key] || '';\n  };\n\n  Theme.prototype.getIconClass = function (buttonName) {\n    var className = this.iconClasses[buttonName];\n\n    if (className) {\n      return this.baseIconClass + ' ' + className;\n    }\n\n    return '';\n  };\n\n  Theme.prototype.getCustomButtonIconClass = function (customButtonProps) {\n    var className;\n\n    if (this.iconOverrideCustomButtonOption) {\n      className = customButtonProps[this.iconOverrideCustomButtonOption];\n\n      if (className) {\n        return this.baseIconClass + ' ' + this.applyIconOverridePrefix(className);\n      }\n    }\n\n    return '';\n  };\n\n  return Theme;\n}();\n\nTheme.prototype.classes = {};\nTheme.prototype.iconClasses = {};\nTheme.prototype.baseIconClass = '';\nTheme.prototype.iconOverridePrefix = '';\nvar guid = 0;\n\nvar Component =\n/** @class */\nfunction () {\n  function Component(context, isView) {\n    // HACK to populate view at top of component instantiation call chain\n    if (isView) {\n      context.view = this;\n    }\n\n    this.uid = String(guid++);\n    this.context = context;\n    this.dateEnv = context.dateEnv;\n    this.theme = context.theme;\n    this.view = context.view;\n    this.calendar = context.calendar;\n    this.isRtl = this.opt('dir') === 'rtl';\n  }\n\n  Component.addEqualityFuncs = function (newFuncs) {\n    this.prototype.equalityFuncs = _assign({}, this.prototype.equalityFuncs, newFuncs);\n  };\n\n  Component.prototype.opt = function (name) {\n    return this.context.options[name];\n  };\n\n  Component.prototype.receiveProps = function (props) {\n    var _a = recycleProps(this.props || {}, props, this.equalityFuncs),\n        anyChanges = _a.anyChanges,\n        comboProps = _a.comboProps;\n\n    this.props = comboProps;\n\n    if (anyChanges) {\n      this.render(comboProps);\n    }\n  };\n\n  Component.prototype.render = function (props) {}; // after destroy is called, this component won't ever be used again\n\n\n  Component.prototype.destroy = function () {};\n\n  return Component;\n}();\n\nComponent.prototype.equalityFuncs = {};\n/*\r\nReuses old values when equal. If anything is unequal, returns newProps as-is.\r\nGreat for PureComponent, but won't be feasible with React, so just eliminate and use React's DOM diffing.\r\n*/\n\nfunction recycleProps(oldProps, newProps, equalityFuncs) {\n  var comboProps = {}; // some old, some new\n\n  var anyChanges = false;\n\n  for (var key in newProps) {\n    if (key in oldProps && (oldProps[key] === newProps[key] || equalityFuncs[key] && equalityFuncs[key](oldProps[key], newProps[key]))) {\n      // equal to old? use old prop\n      comboProps[key] = oldProps[key];\n    } else {\n      comboProps[key] = newProps[key];\n      anyChanges = true;\n    }\n  }\n\n  for (var key in oldProps) {\n    if (!(key in newProps)) {\n      anyChanges = true;\n      break;\n    }\n  }\n\n  return {\n    anyChanges: anyChanges,\n    comboProps: comboProps\n  };\n}\n/*\r\nPURPOSES:\r\n- hook up to fg, fill, and mirror renderers\r\n- interface for dragging and hits\r\n*/\n\n\nvar DateComponent =\n/** @class */\nfunction (_super) {\n  __extends(DateComponent, _super);\n\n  function DateComponent(context, el, isView) {\n    var _this = _super.call(this, context, isView) || this;\n\n    _this.el = el;\n    return _this;\n  }\n\n  DateComponent.prototype.destroy = function () {\n    _super.prototype.destroy.call(this);\n\n    removeElement(this.el);\n  }; // TODO: WHAT ABOUT (sourceSeg && sourceSeg.component.doesDragMirror)\n  //\n  // Event Drag-n-Drop Rendering (for both events and external elements)\n  // ---------------------------------------------------------------------------------------------------------------\n\n  /*\r\n  renderEventDragSegs(state: EventSegUiInteractionState) {\r\n    if (state) {\r\n      let { isEvent, segs, sourceSeg } = state\r\n          if (this.eventRenderer) {\r\n        this.eventRenderer.hideByHash(state.affectedInstances)\r\n      }\r\n          // if the user is dragging something that is considered an event with real event data,\r\n      // and this component likes to do drag mirrors OR the component where the seg came from\r\n      // likes to do drag mirrors, then render a drag mirror.\r\n      if (isEvent && (this.doesDragMirror || sourceSeg && sourceSeg.component.doesDragMirror)) {\r\n        if (this.mirrorRenderer) {\r\n          this.mirrorRenderer.renderSegs(segs, { isDragging: true, sourceSeg })\r\n        }\r\n      }\r\n          // if it would be impossible to render a drag mirror OR this component likes to render\r\n      // highlights, then render a highlight.\r\n      if (!isEvent || this.doesDragHighlight) {\r\n        if (this.fillRenderer) {\r\n          this.fillRenderer.renderSegs('highlight', segs)\r\n        }\r\n      }\r\n    }\r\n  }\r\n  */\n  // Hit System\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  DateComponent.prototype.buildPositionCaches = function () {};\n\n  DateComponent.prototype.queryHit = function (positionLeft, positionTop, elWidth, elHeight) {\n    return null; // this should be abstract\n  }; // Validation\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  DateComponent.prototype.isInteractionValid = function (interaction) {\n    var calendar = this.calendar;\n    var dateProfile = this.props.dateProfile; // HACK\n\n    var instances = interaction.mutatedEvents.instances;\n\n    if (dateProfile) {\n      // HACK for DayTile\n      for (var instanceId in instances) {\n        if (!rangeContainsRange(dateProfile.validRange, instances[instanceId].range)) {\n          return false;\n        }\n      }\n    }\n\n    return isInteractionValid(interaction, calendar);\n  };\n\n  DateComponent.prototype.isDateSelectionValid = function (selection) {\n    var dateProfile = this.props.dateProfile; // HACK\n\n    if (dateProfile && // HACK for DayTile\n    !rangeContainsRange(dateProfile.validRange, selection.range)) {\n      return false;\n    }\n\n    return isDateSelectionValid(selection, this.calendar);\n  }; // Triggering\n  // -----------------------------------------------------------------------------------------------------------------\n  // TODO: move to Calendar\n\n\n  DateComponent.prototype.publiclyTrigger = function (name, args) {\n    var calendar = this.calendar;\n    return calendar.publiclyTrigger(name, args);\n  };\n\n  DateComponent.prototype.publiclyTriggerAfterSizing = function (name, args) {\n    var calendar = this.calendar;\n    return calendar.publiclyTriggerAfterSizing(name, args);\n  };\n\n  DateComponent.prototype.hasPublicHandlers = function (name) {\n    var calendar = this.calendar;\n    return calendar.hasPublicHandlers(name);\n  };\n\n  DateComponent.prototype.triggerRenderedSegs = function (segs, isMirrors) {\n    var calendar = this.calendar;\n\n    if (this.hasPublicHandlers('eventPositioned')) {\n      for (var _i = 0, segs_1 = segs; _i < segs_1.length; _i++) {\n        var seg = segs_1[_i];\n        this.publiclyTriggerAfterSizing('eventPositioned', [{\n          event: new EventApi(calendar, seg.eventRange.def, seg.eventRange.instance),\n          isMirror: isMirrors,\n          isStart: seg.isStart,\n          isEnd: seg.isEnd,\n          el: seg.el,\n          view: this // safe to cast because this method is only called on context.view\n\n        }]);\n      }\n    }\n\n    if (!calendar.state.loadingLevel) {\n      // avoid initial empty state while pending\n      calendar.afterSizingTriggers._eventsPositioned = [null]; // fire once\n    }\n  };\n\n  DateComponent.prototype.triggerWillRemoveSegs = function (segs, isMirrors) {\n    var calendar = this.calendar;\n\n    for (var _i = 0, segs_2 = segs; _i < segs_2.length; _i++) {\n      var seg = segs_2[_i];\n      calendar.trigger('eventElRemove', seg.el);\n    }\n\n    if (this.hasPublicHandlers('eventDestroy')) {\n      for (var _a = 0, segs_3 = segs; _a < segs_3.length; _a++) {\n        var seg = segs_3[_a];\n        this.publiclyTrigger('eventDestroy', [{\n          event: new EventApi(calendar, seg.eventRange.def, seg.eventRange.instance),\n          isMirror: isMirrors,\n          el: seg.el,\n          view: this // safe to cast because this method is only called on context.view\n\n        }]);\n      }\n    }\n  }; // Pointer Interaction Utils\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  DateComponent.prototype.isValidSegDownEl = function (el) {\n    return !this.props.eventDrag && // HACK\n    !this.props.eventResize && // HACK\n    !elementClosest(el, '.fc-mirror') && (this.isPopover() || !this.isInPopover(el)); // ^above line ensures we don't detect a seg interaction within a nested component.\n    // it's a HACK because it only supports a popover as the nested component.\n  };\n\n  DateComponent.prototype.isValidDateDownEl = function (el) {\n    var segEl = elementClosest(el, this.fgSegSelector);\n    return (!segEl || segEl.classList.contains('fc-mirror')) && !elementClosest(el, '.fc-more') && // a \"more..\" link\n    !elementClosest(el, 'a[data-goto]') && // a clickable nav link\n    !this.isInPopover(el);\n  };\n\n  DateComponent.prototype.isPopover = function () {\n    return this.el.classList.contains('fc-popover');\n  };\n\n  DateComponent.prototype.isInPopover = function (el) {\n    return Boolean(elementClosest(el, '.fc-popover'));\n  };\n\n  return DateComponent;\n}(Component);\n\nDateComponent.prototype.fgSegSelector = '.fc-event-container > *';\nDateComponent.prototype.bgSegSelector = '.fc-bgevent:not(.fc-nonbusiness)';\nvar uid$1 = 0;\n\nfunction createPlugin(input) {\n  return {\n    id: String(uid$1++),\n    deps: input.deps || [],\n    reducers: input.reducers || [],\n    eventDefParsers: input.eventDefParsers || [],\n    isDraggableTransformers: input.isDraggableTransformers || [],\n    eventDragMutationMassagers: input.eventDragMutationMassagers || [],\n    eventDefMutationAppliers: input.eventDefMutationAppliers || [],\n    dateSelectionTransformers: input.dateSelectionTransformers || [],\n    datePointTransforms: input.datePointTransforms || [],\n    dateSpanTransforms: input.dateSpanTransforms || [],\n    views: input.views || {},\n    viewPropsTransformers: input.viewPropsTransformers || [],\n    isPropsValid: input.isPropsValid || null,\n    externalDefTransforms: input.externalDefTransforms || [],\n    eventResizeJoinTransforms: input.eventResizeJoinTransforms || [],\n    viewContainerModifiers: input.viewContainerModifiers || [],\n    eventDropTransformers: input.eventDropTransformers || [],\n    componentInteractions: input.componentInteractions || [],\n    calendarInteractions: input.calendarInteractions || [],\n    themeClasses: input.themeClasses || {},\n    eventSourceDefs: input.eventSourceDefs || [],\n    cmdFormatter: input.cmdFormatter,\n    recurringTypes: input.recurringTypes || [],\n    namedTimeZonedImpl: input.namedTimeZonedImpl,\n    defaultView: input.defaultView || '',\n    elementDraggingImpl: input.elementDraggingImpl,\n    optionChangeHandlers: input.optionChangeHandlers || {}\n  };\n}\n\nvar PluginSystem =\n/** @class */\nfunction () {\n  function PluginSystem() {\n    this.hooks = {\n      reducers: [],\n      eventDefParsers: [],\n      isDraggableTransformers: [],\n      eventDragMutationMassagers: [],\n      eventDefMutationAppliers: [],\n      dateSelectionTransformers: [],\n      datePointTransforms: [],\n      dateSpanTransforms: [],\n      views: {},\n      viewPropsTransformers: [],\n      isPropsValid: null,\n      externalDefTransforms: [],\n      eventResizeJoinTransforms: [],\n      viewContainerModifiers: [],\n      eventDropTransformers: [],\n      componentInteractions: [],\n      calendarInteractions: [],\n      themeClasses: {},\n      eventSourceDefs: [],\n      cmdFormatter: null,\n      recurringTypes: [],\n      namedTimeZonedImpl: null,\n      defaultView: '',\n      elementDraggingImpl: null,\n      optionChangeHandlers: {}\n    };\n    this.addedHash = {};\n  }\n\n  PluginSystem.prototype.add = function (plugin) {\n    if (!this.addedHash[plugin.id]) {\n      this.addedHash[plugin.id] = true;\n\n      for (var _i = 0, _a = plugin.deps; _i < _a.length; _i++) {\n        var dep = _a[_i];\n        this.add(dep);\n      }\n\n      this.hooks = combineHooks(this.hooks, plugin);\n    }\n  };\n\n  return PluginSystem;\n}();\n\nfunction combineHooks(hooks0, hooks1) {\n  return {\n    reducers: hooks0.reducers.concat(hooks1.reducers),\n    eventDefParsers: hooks0.eventDefParsers.concat(hooks1.eventDefParsers),\n    isDraggableTransformers: hooks0.isDraggableTransformers.concat(hooks1.isDraggableTransformers),\n    eventDragMutationMassagers: hooks0.eventDragMutationMassagers.concat(hooks1.eventDragMutationMassagers),\n    eventDefMutationAppliers: hooks0.eventDefMutationAppliers.concat(hooks1.eventDefMutationAppliers),\n    dateSelectionTransformers: hooks0.dateSelectionTransformers.concat(hooks1.dateSelectionTransformers),\n    datePointTransforms: hooks0.datePointTransforms.concat(hooks1.datePointTransforms),\n    dateSpanTransforms: hooks0.dateSpanTransforms.concat(hooks1.dateSpanTransforms),\n    views: _assign({}, hooks0.views, hooks1.views),\n    viewPropsTransformers: hooks0.viewPropsTransformers.concat(hooks1.viewPropsTransformers),\n    isPropsValid: hooks1.isPropsValid || hooks0.isPropsValid,\n    externalDefTransforms: hooks0.externalDefTransforms.concat(hooks1.externalDefTransforms),\n    eventResizeJoinTransforms: hooks0.eventResizeJoinTransforms.concat(hooks1.eventResizeJoinTransforms),\n    viewContainerModifiers: hooks0.viewContainerModifiers.concat(hooks1.viewContainerModifiers),\n    eventDropTransformers: hooks0.eventDropTransformers.concat(hooks1.eventDropTransformers),\n    calendarInteractions: hooks0.calendarInteractions.concat(hooks1.calendarInteractions),\n    componentInteractions: hooks0.componentInteractions.concat(hooks1.componentInteractions),\n    themeClasses: _assign({}, hooks0.themeClasses, hooks1.themeClasses),\n    eventSourceDefs: hooks0.eventSourceDefs.concat(hooks1.eventSourceDefs),\n    cmdFormatter: hooks1.cmdFormatter || hooks0.cmdFormatter,\n    recurringTypes: hooks0.recurringTypes.concat(hooks1.recurringTypes),\n    namedTimeZonedImpl: hooks1.namedTimeZonedImpl || hooks0.namedTimeZonedImpl,\n    defaultView: hooks0.defaultView || hooks1.defaultView,\n    elementDraggingImpl: hooks0.elementDraggingImpl || hooks1.elementDraggingImpl,\n    optionChangeHandlers: _assign({}, hooks0.optionChangeHandlers, hooks1.optionChangeHandlers)\n  };\n}\n\nvar eventSourceDef = {\n  ignoreRange: true,\n  parseMeta: function parseMeta(raw) {\n    if (Array.isArray(raw)) {\n      // short form\n      return raw;\n    } else if (Array.isArray(raw.events)) {\n      return raw.events;\n    }\n\n    return null;\n  },\n  fetch: function fetch(arg, success) {\n    success({\n      rawEvents: arg.eventSource.meta\n    });\n  }\n};\nvar ArrayEventSourcePlugin = createPlugin({\n  eventSourceDefs: [eventSourceDef]\n});\nvar eventSourceDef$1 = {\n  parseMeta: function parseMeta(raw) {\n    if (typeof raw === 'function') {\n      // short form\n      return raw;\n    } else if (typeof raw.events === 'function') {\n      return raw.events;\n    }\n\n    return null;\n  },\n  fetch: function fetch(arg, success, failure) {\n    var dateEnv = arg.calendar.dateEnv;\n    var func = arg.eventSource.meta;\n    unpromisify(func.bind(null, {\n      start: dateEnv.toDate(arg.range.start),\n      end: dateEnv.toDate(arg.range.end),\n      startStr: dateEnv.formatIso(arg.range.start),\n      endStr: dateEnv.formatIso(arg.range.end),\n      timeZone: dateEnv.timeZone\n    }), function (rawEvents) {\n      success({\n        rawEvents: rawEvents\n      }); // needs an object response\n    }, failure // send errorObj directly to failure callback\n    );\n  }\n};\nvar FuncEventSourcePlugin = createPlugin({\n  eventSourceDefs: [eventSourceDef$1]\n});\n\nfunction requestJson(method, url, params, successCallback, failureCallback) {\n  method = method.toUpperCase();\n  var body = null;\n\n  if (method === 'GET') {\n    url = injectQueryStringParams(url, params);\n  } else {\n    body = encodeParams(params);\n  }\n\n  var xhr = new XMLHttpRequest();\n  xhr.open(method, url, true);\n\n  if (method !== 'GET') {\n    xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');\n  }\n\n  xhr.onload = function () {\n    if (xhr.status >= 200 && xhr.status < 400) {\n      try {\n        var res = JSON.parse(xhr.responseText);\n        successCallback(res, xhr);\n      } catch (err) {\n        failureCallback('Failure parsing JSON', xhr);\n      }\n    } else {\n      failureCallback('Request failed', xhr);\n    }\n  };\n\n  xhr.onerror = function () {\n    failureCallback('Request failed', xhr);\n  };\n\n  xhr.send(body);\n}\n\nfunction injectQueryStringParams(url, params) {\n  return url + (url.indexOf('?') === -1 ? '?' : '&') + encodeParams(params);\n}\n\nfunction encodeParams(params) {\n  var parts = [];\n\n  for (var key in params) {\n    parts.push(encodeURIComponent(key) + '=' + encodeURIComponent(params[key]));\n  }\n\n  return parts.join('&');\n}\n\nvar eventSourceDef$2 = {\n  parseMeta: function parseMeta(raw) {\n    if (typeof raw === 'string') {\n      // short form\n      raw = {\n        url: raw\n      };\n    } else if (!raw || typeof raw !== 'object' || !raw.url) {\n      return null;\n    }\n\n    return {\n      url: raw.url,\n      method: (raw.method || 'GET').toUpperCase(),\n      extraParams: raw.extraParams,\n      startParam: raw.startParam,\n      endParam: raw.endParam,\n      timeZoneParam: raw.timeZoneParam\n    };\n  },\n  fetch: function fetch(arg, success, failure) {\n    var meta = arg.eventSource.meta;\n    var requestParams = buildRequestParams(meta, arg.range, arg.calendar);\n    requestJson(meta.method, meta.url, requestParams, function (rawEvents, xhr) {\n      success({\n        rawEvents: rawEvents,\n        xhr: xhr\n      });\n    }, function (errorMessage, xhr) {\n      failure({\n        message: errorMessage,\n        xhr: xhr\n      });\n    });\n  }\n};\nvar JsonFeedEventSourcePlugin = createPlugin({\n  eventSourceDefs: [eventSourceDef$2]\n});\n\nfunction buildRequestParams(meta, range, calendar) {\n  var dateEnv = calendar.dateEnv;\n  var startParam;\n  var endParam;\n  var timeZoneParam;\n  var customRequestParams;\n  var params = {};\n  startParam = meta.startParam;\n\n  if (startParam == null) {\n    startParam = calendar.opt('startParam');\n  }\n\n  endParam = meta.endParam;\n\n  if (endParam == null) {\n    endParam = calendar.opt('endParam');\n  }\n\n  timeZoneParam = meta.timeZoneParam;\n\n  if (timeZoneParam == null) {\n    timeZoneParam = calendar.opt('timeZoneParam');\n  } // retrieve any outbound GET/POST data from the options\n\n\n  if (typeof meta.extraParams === 'function') {\n    // supplied as a function that returns a key/value object\n    customRequestParams = meta.extraParams();\n  } else {\n    // probably supplied as a straight key/value object\n    customRequestParams = meta.extraParams || {};\n  }\n\n  _assign(params, customRequestParams);\n\n  params[startParam] = dateEnv.formatIso(range.start);\n  params[endParam] = dateEnv.formatIso(range.end);\n\n  if (dateEnv.timeZone !== 'local') {\n    params[timeZoneParam] = dateEnv.timeZone;\n  }\n\n  return params;\n}\n\nvar recurring = {\n  parse: function parse(rawEvent, leftoverProps, dateEnv) {\n    var createMarker = dateEnv.createMarker.bind(dateEnv);\n    var processors = {\n      daysOfWeek: null,\n      startTime: createDuration,\n      endTime: createDuration,\n      startRecur: createMarker,\n      endRecur: createMarker\n    };\n    var props = refineProps(rawEvent, processors, {}, leftoverProps);\n    var anyValid = false;\n\n    for (var propName in props) {\n      if (props[propName] != null) {\n        anyValid = true;\n        break;\n      }\n    }\n\n    if (anyValid) {\n      var duration = null;\n\n      if ('duration' in leftoverProps) {\n        duration = createDuration(leftoverProps.duration);\n        delete leftoverProps.duration;\n      }\n\n      if (!duration && props.startTime && props.endTime) {\n        duration = subtractDurations(props.endTime, props.startTime);\n      }\n\n      return {\n        allDayGuess: Boolean(!props.startTime && !props.endTime),\n        duration: duration,\n        typeData: props // doesn't need endTime anymore but oh well\n\n      };\n    }\n\n    return null;\n  },\n  expand: function expand(typeData, framingRange, dateEnv) {\n    var clippedFramingRange = intersectRanges(framingRange, {\n      start: typeData.startRecur,\n      end: typeData.endRecur\n    });\n\n    if (clippedFramingRange) {\n      return expandRanges(typeData.daysOfWeek, typeData.startTime, clippedFramingRange, dateEnv);\n    } else {\n      return [];\n    }\n  }\n};\nvar SimpleRecurrencePlugin = createPlugin({\n  recurringTypes: [recurring]\n});\n\nfunction expandRanges(daysOfWeek, startTime, framingRange, dateEnv) {\n  var dowHash = daysOfWeek ? arrayToHash(daysOfWeek) : null;\n  var dayMarker = startOfDay(framingRange.start);\n  var endMarker = framingRange.end;\n  var instanceStarts = [];\n\n  while (dayMarker < endMarker) {\n    var instanceStart // if everyday, or this particular day-of-week\n    = void 0; // if everyday, or this particular day-of-week\n\n    if (!dowHash || dowHash[dayMarker.getUTCDay()]) {\n      if (startTime) {\n        instanceStart = dateEnv.add(dayMarker, startTime);\n      } else {\n        instanceStart = dayMarker;\n      }\n\n      instanceStarts.push(instanceStart);\n    }\n\n    dayMarker = addDays(dayMarker, 1);\n  }\n\n  return instanceStarts;\n}\n\nvar DefaultOptionChangeHandlers = createPlugin({\n  optionChangeHandlers: {\n    events: function events(_events, calendar, deepEqual) {\n      handleEventSources([_events], calendar, deepEqual);\n    },\n    eventSources: handleEventSources,\n    plugins: handlePlugins\n  }\n});\n\nfunction handleEventSources(inputs, calendar, deepEqual) {\n  var unfoundSources = hashValuesToArray(calendar.state.eventSources);\n  var newInputs = [];\n\n  for (var _i = 0, inputs_1 = inputs; _i < inputs_1.length; _i++) {\n    var input = inputs_1[_i];\n    var inputFound = false;\n\n    for (var i = 0; i < unfoundSources.length; i++) {\n      if (deepEqual(unfoundSources[i]._raw, input)) {\n        unfoundSources.splice(i, 1); // delete\n\n        inputFound = true;\n        break;\n      }\n    }\n\n    if (!inputFound) {\n      newInputs.push(input);\n    }\n  }\n\n  for (var _a = 0, unfoundSources_1 = unfoundSources; _a < unfoundSources_1.length; _a++) {\n    var unfoundSource = unfoundSources_1[_a];\n    calendar.dispatch({\n      type: 'REMOVE_EVENT_SOURCE',\n      sourceId: unfoundSource.sourceId\n    });\n  }\n\n  for (var _b = 0, newInputs_1 = newInputs; _b < newInputs_1.length; _b++) {\n    var newInput = newInputs_1[_b];\n    calendar.addEventSource(newInput);\n  }\n} // shortcoming: won't remove plugins\n\n\nfunction handlePlugins(inputs, calendar) {\n  calendar.addPluginInputs(inputs); // will gracefully handle duplicates\n}\n\nvar config = {}; // TODO: make these options\n\nvar globalDefaults = {\n  defaultRangeSeparator: ' - ',\n  titleRangeSeparator: \" \\u2013 \",\n  defaultTimedEventDuration: '01:00:00',\n  defaultAllDayEventDuration: {\n    day: 1\n  },\n  forceEventDuration: false,\n  nextDayThreshold: '00:00:00',\n  // display\n  columnHeader: true,\n  defaultView: '',\n  aspectRatio: 1.35,\n  header: {\n    left: 'title',\n    center: '',\n    right: 'today prev,next'\n  },\n  weekends: true,\n  weekNumbers: false,\n  weekNumberCalculation: 'local',\n  editable: false,\n  // nowIndicator: false,\n  scrollTime: '06:00:00',\n  minTime: '00:00:00',\n  maxTime: '24:00:00',\n  showNonCurrentDates: true,\n  // event ajax\n  lazyFetching: true,\n  startParam: 'start',\n  endParam: 'end',\n  timeZoneParam: 'timeZone',\n  timeZone: 'local',\n  // allDayDefault: undefined,\n  // locale\n  locales: [],\n  locale: '',\n  // dir: will get this from the default locale\n  // buttonIcons: null,\n  // allows setting a min-height to the event segment to prevent short events overlapping each other\n  timeGridEventMinHeight: 0,\n  themeSystem: 'standard',\n  // eventResizableFromStart: false,\n  dragRevertDuration: 500,\n  dragScroll: true,\n  allDayMaintainDuration: false,\n  // selectable: false,\n  unselectAuto: true,\n  // selectMinDistance: 0,\n  dropAccept: '*',\n  eventOrder: 'start,-duration,allDay,title',\n  // ^ if start tie, longer events go before shorter. final tie-breaker is title text\n  // rerenderDelay: null,\n  eventLimit: false,\n  eventLimitClick: 'popover',\n  dayPopoverFormat: {\n    month: 'long',\n    day: 'numeric',\n    year: 'numeric'\n  },\n  handleWindowResize: true,\n  windowResizeDelay: 100,\n  longPressDelay: 1000,\n  eventDragMinDistance: 5 // only applies to mouse\n\n};\nvar rtlDefaults = {\n  header: {\n    left: 'next,prev today',\n    center: '',\n    right: 'title'\n  },\n  buttonIcons: {\n    // TODO: make RTL support the responibility of the theme\n    prev: 'fc-icon-chevron-right',\n    next: 'fc-icon-chevron-left',\n    prevYear: 'fc-icon-chevrons-right',\n    nextYear: 'fc-icon-chevrons-left'\n  }\n};\nvar complexOptions = ['header', 'footer', 'buttonText', 'buttonIcons']; // Merges an array of option objects into a single object\n\nfunction mergeOptions(optionObjs) {\n  return mergeProps(optionObjs, complexOptions);\n} // TODO: move this stuff to a \"plugin\"-related file...\n\n\nvar INTERNAL_PLUGINS = [ArrayEventSourcePlugin, FuncEventSourcePlugin, JsonFeedEventSourcePlugin, SimpleRecurrencePlugin, DefaultOptionChangeHandlers];\n\nfunction refinePluginDefs(pluginInputs) {\n  var plugins = [];\n\n  for (var _i = 0, pluginInputs_1 = pluginInputs; _i < pluginInputs_1.length; _i++) {\n    var pluginInput = pluginInputs_1[_i];\n\n    if (typeof pluginInput === 'string') {\n      var globalName = 'FullCalendar' + capitaliseFirstLetter(pluginInput);\n\n      if (!window[globalName]) {\n        console.warn('Plugin file not loaded for ' + pluginInput);\n      } else {\n        plugins.push(window[globalName].default); // is an ES6 module\n      }\n    } else {\n      plugins.push(pluginInput);\n    }\n  }\n\n  return INTERNAL_PLUGINS.concat(plugins);\n}\n\nvar RAW_EN_LOCALE = {\n  code: 'en',\n  week: {\n    dow: 0,\n    doy: 4 // 4 days need to be within the year to be considered the first week\n\n  },\n  dir: 'ltr',\n  buttonText: {\n    prev: 'prev',\n    next: 'next',\n    prevYear: 'prev year',\n    nextYear: 'next year',\n    year: 'year',\n    today: 'today',\n    month: 'month',\n    week: 'week',\n    day: 'day',\n    list: 'list'\n  },\n  weekLabel: 'W',\n  allDayText: 'all-day',\n  eventLimitText: 'more',\n  noEventsMessage: 'No events to display'\n};\n\nfunction parseRawLocales(explicitRawLocales) {\n  var defaultCode = explicitRawLocales.length > 0 ? explicitRawLocales[0].code : 'en';\n  var globalArray = window['FullCalendarLocalesAll'] || []; // from locales-all.js\n\n  var globalObject = window['FullCalendarLocales'] || {}; // from locales/*.js. keys are meaningless\n\n  var allRawLocales = globalArray.concat( // globalArray is low prio\n  hashValuesToArray(globalObject), // medium prio\n  explicitRawLocales // highest prio\n  );\n  var rawLocaleMap = {\n    en: RAW_EN_LOCALE // necessary?\n\n  };\n\n  for (var _i = 0, allRawLocales_1 = allRawLocales; _i < allRawLocales_1.length; _i++) {\n    var rawLocale = allRawLocales_1[_i];\n    rawLocaleMap[rawLocale.code] = rawLocale;\n  }\n\n  return {\n    map: rawLocaleMap,\n    defaultCode: defaultCode\n  };\n}\n\nfunction buildLocale(inputSingular, available) {\n  if (typeof inputSingular === 'object' && !Array.isArray(inputSingular)) {\n    return parseLocale(inputSingular.code, [inputSingular.code], inputSingular);\n  } else {\n    return queryLocale(inputSingular, available);\n  }\n}\n\nfunction queryLocale(codeArg, available) {\n  var codes = [].concat(codeArg || []); // will convert to array\n\n  var raw = queryRawLocale(codes, available) || RAW_EN_LOCALE;\n  return parseLocale(codeArg, codes, raw);\n}\n\nfunction queryRawLocale(codes, available) {\n  for (var i = 0; i < codes.length; i++) {\n    var parts = codes[i].toLocaleLowerCase().split('-');\n\n    for (var j = parts.length; j > 0; j--) {\n      var simpleId = parts.slice(0, j).join('-');\n\n      if (available[simpleId]) {\n        return available[simpleId];\n      }\n    }\n  }\n\n  return null;\n}\n\nfunction parseLocale(codeArg, codes, raw) {\n  var merged = mergeProps([RAW_EN_LOCALE, raw], ['buttonText']);\n  delete merged.code; // don't want this part of the options\n\n  var week = merged.week;\n  delete merged.week;\n  return {\n    codeArg: codeArg,\n    codes: codes,\n    week: week,\n    simpleNumberFormat: new Intl.NumberFormat(codeArg),\n    options: merged\n  };\n}\n\nvar OptionsManager =\n/** @class */\nfunction () {\n  function OptionsManager(overrides) {\n    this.overrides = _assign({}, overrides); // make a copy\n\n    this.dynamicOverrides = {};\n    this.compute();\n  }\n\n  OptionsManager.prototype.mutate = function (updates, removals, isDynamic) {\n    var overrideHash = isDynamic ? this.dynamicOverrides : this.overrides;\n\n    _assign(overrideHash, updates);\n\n    for (var _i = 0, removals_1 = removals; _i < removals_1.length; _i++) {\n      var propName = removals_1[_i];\n      delete overrideHash[propName];\n    }\n\n    this.compute();\n  }; // Computes the flattened options hash for the calendar and assigns to `this.options`.\n  // Assumes this.overrides and this.dynamicOverrides have already been initialized.\n\n\n  OptionsManager.prototype.compute = function () {\n    // TODO: not a very efficient system\n    var locales = firstDefined( // explicit locale option given?\n    this.dynamicOverrides.locales, this.overrides.locales, globalDefaults.locales);\n    var locale = firstDefined( // explicit locales option given?\n    this.dynamicOverrides.locale, this.overrides.locale, globalDefaults.locale);\n    var available = parseRawLocales(locales);\n    var localeDefaults = buildLocale(locale || available.defaultCode, available.map).options;\n    var dir = firstDefined( // based on options computed so far, is direction RTL?\n    this.dynamicOverrides.dir, this.overrides.dir, localeDefaults.dir);\n    var dirDefaults = dir === 'rtl' ? rtlDefaults : {};\n    this.dirDefaults = dirDefaults;\n    this.localeDefaults = localeDefaults;\n    this.computed = mergeOptions([globalDefaults, dirDefaults, localeDefaults, this.overrides, this.dynamicOverrides]);\n  };\n\n  return OptionsManager;\n}();\n\nvar calendarSystemClassMap = {};\n\nfunction registerCalendarSystem(name, theClass) {\n  calendarSystemClassMap[name] = theClass;\n}\n\nfunction createCalendarSystem(name) {\n  return new calendarSystemClassMap[name]();\n}\n\nvar GregorianCalendarSystem =\n/** @class */\nfunction () {\n  function GregorianCalendarSystem() {}\n\n  GregorianCalendarSystem.prototype.getMarkerYear = function (d) {\n    return d.getUTCFullYear();\n  };\n\n  GregorianCalendarSystem.prototype.getMarkerMonth = function (d) {\n    return d.getUTCMonth();\n  };\n\n  GregorianCalendarSystem.prototype.getMarkerDay = function (d) {\n    return d.getUTCDate();\n  };\n\n  GregorianCalendarSystem.prototype.arrayToMarker = function (arr) {\n    return arrayToUtcDate(arr);\n  };\n\n  GregorianCalendarSystem.prototype.markerToArray = function (marker) {\n    return dateToUtcArray(marker);\n  };\n\n  return GregorianCalendarSystem;\n}();\n\nregisterCalendarSystem('gregory', GregorianCalendarSystem);\nvar ISO_RE = /^\\s*(\\d{4})(-(\\d{2})(-(\\d{2})([T ](\\d{2}):(\\d{2})(:(\\d{2})(\\.(\\d+))?)?(Z|(([-+])(\\d{2})(:?(\\d{2}))?))?)?)?)?$/;\n\nfunction parse(str) {\n  var m = ISO_RE.exec(str);\n\n  if (m) {\n    var marker = new Date(Date.UTC(Number(m[1]), m[3] ? Number(m[3]) - 1 : 0, Number(m[5] || 1), Number(m[7] || 0), Number(m[8] || 0), Number(m[10] || 0), m[12] ? Number('0.' + m[12]) * 1000 : 0));\n\n    if (isValidDate(marker)) {\n      var timeZoneOffset = null;\n\n      if (m[13]) {\n        timeZoneOffset = (m[15] === '-' ? -1 : 1) * (Number(m[16] || 0) * 60 + Number(m[18] || 0));\n      }\n\n      return {\n        marker: marker,\n        isTimeUnspecified: !m[6],\n        timeZoneOffset: timeZoneOffset\n      };\n    }\n  }\n\n  return null;\n}\n\nvar DateEnv =\n/** @class */\nfunction () {\n  function DateEnv(settings) {\n    var timeZone = this.timeZone = settings.timeZone;\n    var isNamedTimeZone = timeZone !== 'local' && timeZone !== 'UTC';\n\n    if (settings.namedTimeZoneImpl && isNamedTimeZone) {\n      this.namedTimeZoneImpl = new settings.namedTimeZoneImpl(timeZone);\n    }\n\n    this.canComputeOffset = Boolean(!isNamedTimeZone || this.namedTimeZoneImpl);\n    this.calendarSystem = createCalendarSystem(settings.calendarSystem);\n    this.locale = settings.locale;\n    this.weekDow = settings.locale.week.dow;\n    this.weekDoy = settings.locale.week.doy;\n\n    if (settings.weekNumberCalculation === 'ISO') {\n      this.weekDow = 1;\n      this.weekDoy = 4;\n    }\n\n    if (typeof settings.firstDay === 'number') {\n      this.weekDow = settings.firstDay;\n    }\n\n    if (typeof settings.weekNumberCalculation === 'function') {\n      this.weekNumberFunc = settings.weekNumberCalculation;\n    }\n\n    this.weekLabel = settings.weekLabel != null ? settings.weekLabel : settings.locale.options.weekLabel;\n    this.cmdFormatter = settings.cmdFormatter;\n  } // Creating / Parsing\n\n\n  DateEnv.prototype.createMarker = function (input) {\n    var meta = this.createMarkerMeta(input);\n\n    if (meta === null) {\n      return null;\n    }\n\n    return meta.marker;\n  };\n\n  DateEnv.prototype.createNowMarker = function () {\n    if (this.canComputeOffset) {\n      return this.timestampToMarker(new Date().valueOf());\n    } else {\n      // if we can't compute the current date val for a timezone,\n      // better to give the current local date vals than UTC\n      return arrayToUtcDate(dateToLocalArray(new Date()));\n    }\n  };\n\n  DateEnv.prototype.createMarkerMeta = function (input) {\n    if (typeof input === 'string') {\n      return this.parse(input);\n    }\n\n    var marker = null;\n\n    if (typeof input === 'number') {\n      marker = this.timestampToMarker(input);\n    } else if (input instanceof Date) {\n      input = input.valueOf();\n\n      if (!isNaN(input)) {\n        marker = this.timestampToMarker(input);\n      }\n    } else if (Array.isArray(input)) {\n      marker = arrayToUtcDate(input);\n    }\n\n    if (marker === null || !isValidDate(marker)) {\n      return null;\n    }\n\n    return {\n      marker: marker,\n      isTimeUnspecified: false,\n      forcedTzo: null\n    };\n  };\n\n  DateEnv.prototype.parse = function (s) {\n    var parts = parse(s);\n\n    if (parts === null) {\n      return null;\n    }\n\n    var marker = parts.marker;\n    var forcedTzo = null;\n\n    if (parts.timeZoneOffset !== null) {\n      if (this.canComputeOffset) {\n        marker = this.timestampToMarker(marker.valueOf() - parts.timeZoneOffset * 60 * 1000);\n      } else {\n        forcedTzo = parts.timeZoneOffset;\n      }\n    }\n\n    return {\n      marker: marker,\n      isTimeUnspecified: parts.isTimeUnspecified,\n      forcedTzo: forcedTzo\n    };\n  }; // Accessors\n\n\n  DateEnv.prototype.getYear = function (marker) {\n    return this.calendarSystem.getMarkerYear(marker);\n  };\n\n  DateEnv.prototype.getMonth = function (marker) {\n    return this.calendarSystem.getMarkerMonth(marker);\n  }; // Adding / Subtracting\n\n\n  DateEnv.prototype.add = function (marker, dur) {\n    var a = this.calendarSystem.markerToArray(marker);\n    a[0] += dur.years;\n    a[1] += dur.months;\n    a[2] += dur.days;\n    a[6] += dur.milliseconds;\n    return this.calendarSystem.arrayToMarker(a);\n  };\n\n  DateEnv.prototype.subtract = function (marker, dur) {\n    var a = this.calendarSystem.markerToArray(marker);\n    a[0] -= dur.years;\n    a[1] -= dur.months;\n    a[2] -= dur.days;\n    a[6] -= dur.milliseconds;\n    return this.calendarSystem.arrayToMarker(a);\n  };\n\n  DateEnv.prototype.addYears = function (marker, n) {\n    var a = this.calendarSystem.markerToArray(marker);\n    a[0] += n;\n    return this.calendarSystem.arrayToMarker(a);\n  };\n\n  DateEnv.prototype.addMonths = function (marker, n) {\n    var a = this.calendarSystem.markerToArray(marker);\n    a[1] += n;\n    return this.calendarSystem.arrayToMarker(a);\n  }; // Diffing Whole Units\n\n\n  DateEnv.prototype.diffWholeYears = function (m0, m1) {\n    var calendarSystem = this.calendarSystem;\n\n    if (timeAsMs(m0) === timeAsMs(m1) && calendarSystem.getMarkerDay(m0) === calendarSystem.getMarkerDay(m1) && calendarSystem.getMarkerMonth(m0) === calendarSystem.getMarkerMonth(m1)) {\n      return calendarSystem.getMarkerYear(m1) - calendarSystem.getMarkerYear(m0);\n    }\n\n    return null;\n  };\n\n  DateEnv.prototype.diffWholeMonths = function (m0, m1) {\n    var calendarSystem = this.calendarSystem;\n\n    if (timeAsMs(m0) === timeAsMs(m1) && calendarSystem.getMarkerDay(m0) === calendarSystem.getMarkerDay(m1)) {\n      return calendarSystem.getMarkerMonth(m1) - calendarSystem.getMarkerMonth(m0) + (calendarSystem.getMarkerYear(m1) - calendarSystem.getMarkerYear(m0)) * 12;\n    }\n\n    return null;\n  }; // Range / Duration\n\n\n  DateEnv.prototype.greatestWholeUnit = function (m0, m1) {\n    var n = this.diffWholeYears(m0, m1);\n\n    if (n !== null) {\n      return {\n        unit: 'year',\n        value: n\n      };\n    }\n\n    n = this.diffWholeMonths(m0, m1);\n\n    if (n !== null) {\n      return {\n        unit: 'month',\n        value: n\n      };\n    }\n\n    n = diffWholeWeeks(m0, m1);\n\n    if (n !== null) {\n      return {\n        unit: 'week',\n        value: n\n      };\n    }\n\n    n = diffWholeDays(m0, m1);\n\n    if (n !== null) {\n      return {\n        unit: 'day',\n        value: n\n      };\n    }\n\n    n = diffHours(m0, m1);\n\n    if (isInt(n)) {\n      return {\n        unit: 'hour',\n        value: n\n      };\n    }\n\n    n = diffMinutes(m0, m1);\n\n    if (isInt(n)) {\n      return {\n        unit: 'minute',\n        value: n\n      };\n    }\n\n    n = diffSeconds(m0, m1);\n\n    if (isInt(n)) {\n      return {\n        unit: 'second',\n        value: n\n      };\n    }\n\n    return {\n      unit: 'millisecond',\n      value: m1.valueOf() - m0.valueOf()\n    };\n  };\n\n  DateEnv.prototype.countDurationsBetween = function (m0, m1, d) {\n    // TODO: can use greatestWholeUnit\n    var diff;\n\n    if (d.years) {\n      diff = this.diffWholeYears(m0, m1);\n\n      if (diff !== null) {\n        return diff / asRoughYears(d);\n      }\n    }\n\n    if (d.months) {\n      diff = this.diffWholeMonths(m0, m1);\n\n      if (diff !== null) {\n        return diff / asRoughMonths(d);\n      }\n    }\n\n    if (d.days) {\n      diff = diffWholeDays(m0, m1);\n\n      if (diff !== null) {\n        return diff / asRoughDays(d);\n      }\n    }\n\n    return (m1.valueOf() - m0.valueOf()) / asRoughMs(d);\n  }; // Start-Of\n\n\n  DateEnv.prototype.startOf = function (m, unit) {\n    if (unit === 'year') {\n      return this.startOfYear(m);\n    } else if (unit === 'month') {\n      return this.startOfMonth(m);\n    } else if (unit === 'week') {\n      return this.startOfWeek(m);\n    } else if (unit === 'day') {\n      return startOfDay(m);\n    } else if (unit === 'hour') {\n      return startOfHour(m);\n    } else if (unit === 'minute') {\n      return startOfMinute(m);\n    } else if (unit === 'second') {\n      return startOfSecond(m);\n    }\n  };\n\n  DateEnv.prototype.startOfYear = function (m) {\n    return this.calendarSystem.arrayToMarker([this.calendarSystem.getMarkerYear(m)]);\n  };\n\n  DateEnv.prototype.startOfMonth = function (m) {\n    return this.calendarSystem.arrayToMarker([this.calendarSystem.getMarkerYear(m), this.calendarSystem.getMarkerMonth(m)]);\n  };\n\n  DateEnv.prototype.startOfWeek = function (m) {\n    return this.calendarSystem.arrayToMarker([this.calendarSystem.getMarkerYear(m), this.calendarSystem.getMarkerMonth(m), m.getUTCDate() - (m.getUTCDay() - this.weekDow + 7) % 7]);\n  }; // Week Number\n\n\n  DateEnv.prototype.computeWeekNumber = function (marker) {\n    if (this.weekNumberFunc) {\n      return this.weekNumberFunc(this.toDate(marker));\n    } else {\n      return weekOfYear(marker, this.weekDow, this.weekDoy);\n    }\n  }; // TODO: choke on timeZoneName: long\n\n\n  DateEnv.prototype.format = function (marker, formatter, dateOptions) {\n    if (dateOptions === void 0) {\n      dateOptions = {};\n    }\n\n    return formatter.format({\n      marker: marker,\n      timeZoneOffset: dateOptions.forcedTzo != null ? dateOptions.forcedTzo : this.offsetForMarker(marker)\n    }, this);\n  };\n\n  DateEnv.prototype.formatRange = function (start, end, formatter, dateOptions) {\n    if (dateOptions === void 0) {\n      dateOptions = {};\n    }\n\n    if (dateOptions.isEndExclusive) {\n      end = addMs(end, -1);\n    }\n\n    return formatter.formatRange({\n      marker: start,\n      timeZoneOffset: dateOptions.forcedStartTzo != null ? dateOptions.forcedStartTzo : this.offsetForMarker(start)\n    }, {\n      marker: end,\n      timeZoneOffset: dateOptions.forcedEndTzo != null ? dateOptions.forcedEndTzo : this.offsetForMarker(end)\n    }, this);\n  };\n\n  DateEnv.prototype.formatIso = function (marker, extraOptions) {\n    if (extraOptions === void 0) {\n      extraOptions = {};\n    }\n\n    var timeZoneOffset = null;\n\n    if (!extraOptions.omitTimeZoneOffset) {\n      if (extraOptions.forcedTzo != null) {\n        timeZoneOffset = extraOptions.forcedTzo;\n      } else {\n        timeZoneOffset = this.offsetForMarker(marker);\n      }\n    }\n\n    return buildIsoString(marker, timeZoneOffset, extraOptions.omitTime);\n  }; // TimeZone\n\n\n  DateEnv.prototype.timestampToMarker = function (ms) {\n    if (this.timeZone === 'local') {\n      return arrayToUtcDate(dateToLocalArray(new Date(ms)));\n    } else if (this.timeZone === 'UTC' || !this.namedTimeZoneImpl) {\n      return new Date(ms);\n    } else {\n      return arrayToUtcDate(this.namedTimeZoneImpl.timestampToArray(ms));\n    }\n  };\n\n  DateEnv.prototype.offsetForMarker = function (m) {\n    if (this.timeZone === 'local') {\n      return -arrayToLocalDate(dateToUtcArray(m)).getTimezoneOffset(); // convert \"inverse\" offset to \"normal\" offset\n    } else if (this.timeZone === 'UTC') {\n      return 0;\n    } else if (this.namedTimeZoneImpl) {\n      return this.namedTimeZoneImpl.offsetForArray(dateToUtcArray(m));\n    }\n\n    return null;\n  }; // Conversion\n\n\n  DateEnv.prototype.toDate = function (m, forcedTzo) {\n    if (this.timeZone === 'local') {\n      return arrayToLocalDate(dateToUtcArray(m));\n    } else if (this.timeZone === 'UTC') {\n      return new Date(m.valueOf()); // make sure it's a copy\n    } else if (!this.namedTimeZoneImpl) {\n      return new Date(m.valueOf() - (forcedTzo || 0));\n    } else {\n      return new Date(m.valueOf() - this.namedTimeZoneImpl.offsetForArray(dateToUtcArray(m)) * 1000 * 60 // convert minutes -> ms\n      );\n    }\n  };\n\n  return DateEnv;\n}();\n\nvar SIMPLE_SOURCE_PROPS = {\n  id: String,\n  allDayDefault: Boolean,\n  eventDataTransform: Function,\n  success: Function,\n  failure: Function\n};\nvar uid$2 = 0;\n\nfunction doesSourceNeedRange(eventSource, calendar) {\n  var defs = calendar.pluginSystem.hooks.eventSourceDefs;\n  return !defs[eventSource.sourceDefId].ignoreRange;\n}\n\nfunction parseEventSource(raw, calendar) {\n  var defs = calendar.pluginSystem.hooks.eventSourceDefs;\n\n  for (var i = defs.length - 1; i >= 0; i--) {\n    // later-added plugins take precedence\n    var def = defs[i];\n    var meta = def.parseMeta(raw);\n\n    if (meta) {\n      var res = parseEventSourceProps(typeof raw === 'object' ? raw : {}, meta, i, calendar);\n      res._raw = raw;\n      return res;\n    }\n  }\n\n  return null;\n}\n\nfunction parseEventSourceProps(raw, meta, sourceDefId, calendar) {\n  var leftovers0 = {};\n  var props = refineProps(raw, SIMPLE_SOURCE_PROPS, {}, leftovers0);\n  var leftovers1 = {};\n  var ui = processUnscopedUiProps(leftovers0, calendar, leftovers1);\n  props.isFetching = false;\n  props.latestFetchId = '';\n  props.fetchRange = null;\n  props.publicId = String(raw.id || '');\n  props.sourceId = String(uid$2++);\n  props.sourceDefId = sourceDefId;\n  props.meta = meta;\n  props.ui = ui;\n  props.extendedProps = leftovers1;\n  return props;\n}\n\nfunction reduceEventSources(eventSources, action, dateProfile, calendar) {\n  switch (action.type) {\n    case 'ADD_EVENT_SOURCES':\n      // already parsed\n      return addSources(eventSources, action.sources, dateProfile ? dateProfile.activeRange : null, calendar);\n\n    case 'REMOVE_EVENT_SOURCE':\n      return removeSource(eventSources, action.sourceId);\n\n    case 'PREV': // TODO: how do we track all actions that affect dateProfile :(\n\n    case 'NEXT':\n    case 'SET_DATE':\n    case 'SET_VIEW_TYPE':\n      if (dateProfile) {\n        return fetchDirtySources(eventSources, dateProfile.activeRange, calendar);\n      } else {\n        return eventSources;\n      }\n\n    case 'FETCH_EVENT_SOURCES':\n    case 'CHANGE_TIMEZONE':\n      return fetchSourcesByIds(eventSources, action.sourceIds ? arrayToHash(action.sourceIds) : excludeStaticSources(eventSources, calendar), dateProfile ? dateProfile.activeRange : null, calendar);\n\n    case 'RECEIVE_EVENTS':\n    case 'RECEIVE_EVENT_ERROR':\n      return receiveResponse(eventSources, action.sourceId, action.fetchId, action.fetchRange);\n\n    case 'REMOVE_ALL_EVENT_SOURCES':\n      return {};\n\n    default:\n      return eventSources;\n  }\n}\n\nvar uid$3 = 0;\n\nfunction addSources(eventSourceHash, sources, fetchRange, calendar) {\n  var hash = {};\n\n  for (var _i = 0, sources_1 = sources; _i < sources_1.length; _i++) {\n    var source = sources_1[_i];\n    hash[source.sourceId] = source;\n  }\n\n  if (fetchRange) {\n    hash = fetchDirtySources(hash, fetchRange, calendar);\n  }\n\n  return _assign({}, eventSourceHash, hash);\n}\n\nfunction removeSource(eventSourceHash, sourceId) {\n  return filterHash(eventSourceHash, function (eventSource) {\n    return eventSource.sourceId !== sourceId;\n  });\n}\n\nfunction fetchDirtySources(sourceHash, fetchRange, calendar) {\n  return fetchSourcesByIds(sourceHash, filterHash(sourceHash, function (eventSource) {\n    return isSourceDirty(eventSource, fetchRange, calendar);\n  }), fetchRange, calendar);\n}\n\nfunction isSourceDirty(eventSource, fetchRange, calendar) {\n  if (!doesSourceNeedRange(eventSource, calendar)) {\n    return !eventSource.latestFetchId;\n  } else {\n    return !calendar.opt('lazyFetching') || !eventSource.fetchRange || fetchRange.start < eventSource.fetchRange.start || fetchRange.end > eventSource.fetchRange.end;\n  }\n}\n\nfunction fetchSourcesByIds(prevSources, sourceIdHash, fetchRange, calendar) {\n  var nextSources = {};\n\n  for (var sourceId in prevSources) {\n    var source = prevSources[sourceId];\n\n    if (sourceIdHash[sourceId]) {\n      nextSources[sourceId] = fetchSource(source, fetchRange, calendar);\n    } else {\n      nextSources[sourceId] = source;\n    }\n  }\n\n  return nextSources;\n}\n\nfunction fetchSource(eventSource, fetchRange, calendar) {\n  var sourceDef = calendar.pluginSystem.hooks.eventSourceDefs[eventSource.sourceDefId];\n  var fetchId = String(uid$3++);\n  sourceDef.fetch({\n    eventSource: eventSource,\n    calendar: calendar,\n    range: fetchRange\n  }, function (res) {\n    var rawEvents = res.rawEvents;\n    var calSuccess = calendar.opt('eventSourceSuccess');\n    var calSuccessRes;\n    var sourceSuccessRes;\n\n    if (eventSource.success) {\n      sourceSuccessRes = eventSource.success(rawEvents, res.xhr);\n    }\n\n    if (calSuccess) {\n      calSuccessRes = calSuccess(rawEvents, res.xhr);\n    }\n\n    rawEvents = sourceSuccessRes || calSuccessRes || rawEvents;\n    calendar.dispatch({\n      type: 'RECEIVE_EVENTS',\n      sourceId: eventSource.sourceId,\n      fetchId: fetchId,\n      fetchRange: fetchRange,\n      rawEvents: rawEvents\n    });\n  }, function (error) {\n    var callFailure = calendar.opt('eventSourceFailure');\n    console.warn(error.message, error);\n\n    if (eventSource.failure) {\n      eventSource.failure(error);\n    }\n\n    if (callFailure) {\n      callFailure(error);\n    }\n\n    calendar.dispatch({\n      type: 'RECEIVE_EVENT_ERROR',\n      sourceId: eventSource.sourceId,\n      fetchId: fetchId,\n      fetchRange: fetchRange,\n      error: error\n    });\n  });\n  return _assign({}, eventSource, {\n    isFetching: true,\n    latestFetchId: fetchId\n  });\n}\n\nfunction receiveResponse(sourceHash, sourceId, fetchId, fetchRange) {\n  var _a;\n\n  var eventSource = sourceHash[sourceId];\n\n  if (eventSource && // not already removed\n  fetchId === eventSource.latestFetchId) {\n    return _assign({}, sourceHash, (_a = {}, _a[sourceId] = _assign({}, eventSource, {\n      isFetching: false,\n      fetchRange: fetchRange\n    }), _a));\n  }\n\n  return sourceHash;\n}\n\nfunction excludeStaticSources(eventSources, calendar) {\n  return filterHash(eventSources, function (eventSource) {\n    return doesSourceNeedRange(eventSource, calendar);\n  });\n}\n\nvar DateProfileGenerator =\n/** @class */\nfunction () {\n  function DateProfileGenerator(viewSpec, calendar) {\n    this.viewSpec = viewSpec;\n    this.options = viewSpec.options;\n    this.dateEnv = calendar.dateEnv;\n    this.calendar = calendar;\n    this.initHiddenDays();\n  }\n  /* Date Range Computation\r\n  ------------------------------------------------------------------------------------------------------------------*/\n  // Builds a structure with info about what the dates/ranges will be for the \"prev\" view.\n\n\n  DateProfileGenerator.prototype.buildPrev = function (currentDateProfile, currentDate) {\n    var dateEnv = this.dateEnv;\n    var prevDate = dateEnv.subtract(dateEnv.startOf(currentDate, currentDateProfile.currentRangeUnit), // important for start-of-month\n    currentDateProfile.dateIncrement);\n    return this.build(prevDate, -1);\n  }; // Builds a structure with info about what the dates/ranges will be for the \"next\" view.\n\n\n  DateProfileGenerator.prototype.buildNext = function (currentDateProfile, currentDate) {\n    var dateEnv = this.dateEnv;\n    var nextDate = dateEnv.add(dateEnv.startOf(currentDate, currentDateProfile.currentRangeUnit), // important for start-of-month\n    currentDateProfile.dateIncrement);\n    return this.build(nextDate, 1);\n  }; // Builds a structure holding dates/ranges for rendering around the given date.\n  // Optional direction param indicates whether the date is being incremented/decremented\n  // from its previous value. decremented = -1, incremented = 1 (default).\n\n\n  DateProfileGenerator.prototype.build = function (currentDate, direction, forceToValid) {\n    if (forceToValid === void 0) {\n      forceToValid = false;\n    }\n\n    var validRange;\n    var minTime = null;\n    var maxTime = null;\n    var currentInfo;\n    var isRangeAllDay;\n    var renderRange;\n    var activeRange;\n    var isValid;\n    validRange = this.buildValidRange();\n    validRange = this.trimHiddenDays(validRange);\n\n    if (forceToValid) {\n      currentDate = constrainMarkerToRange(currentDate, validRange);\n    }\n\n    currentInfo = this.buildCurrentRangeInfo(currentDate, direction);\n    isRangeAllDay = /^(year|month|week|day)$/.test(currentInfo.unit);\n    renderRange = this.buildRenderRange(this.trimHiddenDays(currentInfo.range), currentInfo.unit, isRangeAllDay);\n    renderRange = this.trimHiddenDays(renderRange);\n    activeRange = renderRange;\n\n    if (!this.options.showNonCurrentDates) {\n      activeRange = intersectRanges(activeRange, currentInfo.range);\n    }\n\n    minTime = createDuration(this.options.minTime);\n    maxTime = createDuration(this.options.maxTime);\n    activeRange = this.adjustActiveRange(activeRange, minTime, maxTime);\n    activeRange = intersectRanges(activeRange, validRange); // might return null\n    // it's invalid if the originally requested date is not contained,\n    // or if the range is completely outside of the valid range.\n\n    isValid = rangesIntersect(currentInfo.range, validRange);\n    return {\n      // constraint for where prev/next operations can go and where events can be dragged/resized to.\n      // an object with optional start and end properties.\n      validRange: validRange,\n      // range the view is formally responsible for.\n      // for example, a month view might have 1st-31st, excluding padded dates\n      currentRange: currentInfo.range,\n      // name of largest unit being displayed, like \"month\" or \"week\"\n      currentRangeUnit: currentInfo.unit,\n      isRangeAllDay: isRangeAllDay,\n      // dates that display events and accept drag-n-drop\n      // will be `null` if no dates accept events\n      activeRange: activeRange,\n      // date range with a rendered skeleton\n      // includes not-active days that need some sort of DOM\n      renderRange: renderRange,\n      // Duration object that denotes the first visible time of any given day\n      minTime: minTime,\n      // Duration object that denotes the exclusive visible end time of any given day\n      maxTime: maxTime,\n      isValid: isValid,\n      // how far the current date will move for a prev/next operation\n      dateIncrement: this.buildDateIncrement(currentInfo.duration) // pass a fallback (might be null) ^\n\n    };\n  }; // Builds an object with optional start/end properties.\n  // Indicates the minimum/maximum dates to display.\n  // not responsible for trimming hidden days.\n\n\n  DateProfileGenerator.prototype.buildValidRange = function () {\n    return this.getRangeOption('validRange', this.calendar.getNow()) || {\n      start: null,\n      end: null\n    }; // completely open-ended\n  }; // Builds a structure with info about the \"current\" range, the range that is\n  // highlighted as being the current month for example.\n  // See build() for a description of `direction`.\n  // Guaranteed to have `range` and `unit` properties. `duration` is optional.\n\n\n  DateProfileGenerator.prototype.buildCurrentRangeInfo = function (date, direction) {\n    var _a = this,\n        viewSpec = _a.viewSpec,\n        dateEnv = _a.dateEnv;\n\n    var duration = null;\n    var unit = null;\n    var range = null;\n    var dayCount;\n\n    if (viewSpec.duration) {\n      duration = viewSpec.duration;\n      unit = viewSpec.durationUnit;\n      range = this.buildRangeFromDuration(date, direction, duration, unit);\n    } else if (dayCount = this.options.dayCount) {\n      unit = 'day';\n      range = this.buildRangeFromDayCount(date, direction, dayCount);\n    } else if (range = this.buildCustomVisibleRange(date)) {\n      unit = dateEnv.greatestWholeUnit(range.start, range.end).unit;\n    } else {\n      duration = this.getFallbackDuration();\n      unit = greatestDurationDenominator(duration).unit;\n      range = this.buildRangeFromDuration(date, direction, duration, unit);\n    }\n\n    return {\n      duration: duration,\n      unit: unit,\n      range: range\n    };\n  };\n\n  DateProfileGenerator.prototype.getFallbackDuration = function () {\n    return createDuration({\n      day: 1\n    });\n  }; // Returns a new activeRange to have time values (un-ambiguate)\n  // minTime or maxTime causes the range to expand.\n\n\n  DateProfileGenerator.prototype.adjustActiveRange = function (range, minTime, maxTime) {\n    var dateEnv = this.dateEnv;\n    var start = range.start;\n    var end = range.end;\n\n    if (this.viewSpec.class.prototype.usesMinMaxTime) {\n      // expand active range if minTime is negative (why not when positive?)\n      if (asRoughDays(minTime) < 0) {\n        start = startOfDay(start); // necessary?\n\n        start = dateEnv.add(start, minTime);\n      } // expand active range if maxTime is beyond one day (why not when positive?)\n\n\n      if (asRoughDays(maxTime) > 1) {\n        end = startOfDay(end); // necessary?\n\n        end = addDays(end, -1);\n        end = dateEnv.add(end, maxTime);\n      }\n    }\n\n    return {\n      start: start,\n      end: end\n    };\n  }; // Builds the \"current\" range when it is specified as an explicit duration.\n  // `unit` is the already-computed greatestDurationDenominator unit of duration.\n\n\n  DateProfileGenerator.prototype.buildRangeFromDuration = function (date, direction, duration, unit) {\n    var dateEnv = this.dateEnv;\n    var alignment = this.options.dateAlignment;\n    var dateIncrementInput;\n    var dateIncrementDuration;\n    var start;\n    var end;\n    var res; // compute what the alignment should be\n\n    if (!alignment) {\n      dateIncrementInput = this.options.dateIncrement;\n\n      if (dateIncrementInput) {\n        dateIncrementDuration = createDuration(dateIncrementInput); // use the smaller of the two units\n\n        if (asRoughMs(dateIncrementDuration) < asRoughMs(duration)) {\n          alignment = greatestDurationDenominator(dateIncrementDuration, !getWeeksFromInput(dateIncrementInput)).unit;\n        } else {\n          alignment = unit;\n        }\n      } else {\n        alignment = unit;\n      }\n    } // if the view displays a single day or smaller\n\n\n    if (asRoughDays(duration) <= 1) {\n      if (this.isHiddenDay(start)) {\n        start = this.skipHiddenDays(start, direction);\n        start = startOfDay(start);\n      }\n    }\n\n    function computeRes() {\n      start = dateEnv.startOf(date, alignment);\n      end = dateEnv.add(start, duration);\n      res = {\n        start: start,\n        end: end\n      };\n    }\n\n    computeRes(); // if range is completely enveloped by hidden days, go past the hidden days\n\n    if (!this.trimHiddenDays(res)) {\n      date = this.skipHiddenDays(date, direction);\n      computeRes();\n    }\n\n    return res;\n  }; // Builds the \"current\" range when a dayCount is specified.\n\n\n  DateProfileGenerator.prototype.buildRangeFromDayCount = function (date, direction, dayCount) {\n    var dateEnv = this.dateEnv;\n    var customAlignment = this.options.dateAlignment;\n    var runningCount = 0;\n    var start = date;\n    var end;\n\n    if (customAlignment) {\n      start = dateEnv.startOf(start, customAlignment);\n    }\n\n    start = startOfDay(start);\n    start = this.skipHiddenDays(start, direction);\n    end = start;\n\n    do {\n      end = addDays(end, 1);\n\n      if (!this.isHiddenDay(end)) {\n        runningCount++;\n      }\n    } while (runningCount < dayCount);\n\n    return {\n      start: start,\n      end: end\n    };\n  }; // Builds a normalized range object for the \"visible\" range,\n  // which is a way to define the currentRange and activeRange at the same time.\n\n\n  DateProfileGenerator.prototype.buildCustomVisibleRange = function (date) {\n    var dateEnv = this.dateEnv;\n    var visibleRange = this.getRangeOption('visibleRange', dateEnv.toDate(date));\n\n    if (visibleRange && (visibleRange.start == null || visibleRange.end == null)) {\n      return null;\n    }\n\n    return visibleRange;\n  }; // Computes the range that will represent the element/cells for *rendering*,\n  // but which may have voided days/times.\n  // not responsible for trimming hidden days.\n\n\n  DateProfileGenerator.prototype.buildRenderRange = function (currentRange, currentRangeUnit, isRangeAllDay) {\n    return currentRange;\n  }; // Compute the duration value that should be added/substracted to the current date\n  // when a prev/next operation happens.\n\n\n  DateProfileGenerator.prototype.buildDateIncrement = function (fallback) {\n    var dateIncrementInput = this.options.dateIncrement;\n    var customAlignment;\n\n    if (dateIncrementInput) {\n      return createDuration(dateIncrementInput);\n    } else if (customAlignment = this.options.dateAlignment) {\n      return createDuration(1, customAlignment);\n    } else if (fallback) {\n      return fallback;\n    } else {\n      return createDuration({\n        days: 1\n      });\n    }\n  }; // Arguments after name will be forwarded to a hypothetical function value\n  // WARNING: passed-in arguments will be given to generator functions as-is and can cause side-effects.\n  // Always clone your objects if you fear mutation.\n\n\n  DateProfileGenerator.prototype.getRangeOption = function (name) {\n    var otherArgs = [];\n\n    for (var _i = 1; _i < arguments.length; _i++) {\n      otherArgs[_i - 1] = arguments[_i];\n    }\n\n    var val = this.options[name];\n\n    if (typeof val === 'function') {\n      val = val.apply(null, otherArgs);\n    }\n\n    if (val) {\n      val = parseRange(val, this.dateEnv);\n    }\n\n    if (val) {\n      val = computeVisibleDayRange(val);\n    }\n\n    return val;\n  };\n  /* Hidden Days\r\n  ------------------------------------------------------------------------------------------------------------------*/\n  // Initializes internal variables related to calculating hidden days-of-week\n\n\n  DateProfileGenerator.prototype.initHiddenDays = function () {\n    var hiddenDays = this.options.hiddenDays || []; // array of day-of-week indices that are hidden\n\n    var isHiddenDayHash = []; // is the day-of-week hidden? (hash with day-of-week-index -> bool)\n\n    var dayCnt = 0;\n    var i;\n\n    if (this.options.weekends === false) {\n      hiddenDays.push(0, 6); // 0=sunday, 6=saturday\n    }\n\n    for (i = 0; i < 7; i++) {\n      if (!(isHiddenDayHash[i] = hiddenDays.indexOf(i) !== -1)) {\n        dayCnt++;\n      }\n    }\n\n    if (!dayCnt) {\n      throw new Error('invalid hiddenDays'); // all days were hidden? bad.\n    }\n\n    this.isHiddenDayHash = isHiddenDayHash;\n  }; // Remove days from the beginning and end of the range that are computed as hidden.\n  // If the whole range is trimmed off, returns null\n\n\n  DateProfileGenerator.prototype.trimHiddenDays = function (range) {\n    var start = range.start;\n    var end = range.end;\n\n    if (start) {\n      start = this.skipHiddenDays(start);\n    }\n\n    if (end) {\n      end = this.skipHiddenDays(end, -1, true);\n    }\n\n    if (start == null || end == null || start < end) {\n      return {\n        start: start,\n        end: end\n      };\n    }\n\n    return null;\n  }; // Is the current day hidden?\n  // `day` is a day-of-week index (0-6), or a Date (used for UTC)\n\n\n  DateProfileGenerator.prototype.isHiddenDay = function (day) {\n    if (day instanceof Date) {\n      day = day.getUTCDay();\n    }\n\n    return this.isHiddenDayHash[day];\n  }; // Incrementing the current day until it is no longer a hidden day, returning a copy.\n  // DOES NOT CONSIDER validRange!\n  // If the initial value of `date` is not a hidden day, don't do anything.\n  // Pass `isExclusive` as `true` if you are dealing with an end date.\n  // `inc` defaults to `1` (increment one day forward each time)\n\n\n  DateProfileGenerator.prototype.skipHiddenDays = function (date, inc, isExclusive) {\n    if (inc === void 0) {\n      inc = 1;\n    }\n\n    if (isExclusive === void 0) {\n      isExclusive = false;\n    }\n\n    while (this.isHiddenDayHash[(date.getUTCDay() + (isExclusive ? inc : 0) + 7) % 7]) {\n      date = addDays(date, inc);\n    }\n\n    return date;\n  };\n\n  return DateProfileGenerator;\n}(); // TODO: find a way to avoid comparing DateProfiles. it's tedious\n\n\nfunction isDateProfilesEqual(p0, p1) {\n  return rangesEqual(p0.validRange, p1.validRange) && rangesEqual(p0.activeRange, p1.activeRange) && rangesEqual(p0.renderRange, p1.renderRange) && durationsEqual(p0.minTime, p1.minTime) && durationsEqual(p0.maxTime, p1.maxTime);\n  /*\r\n  TODO: compare more?\r\n    currentRange: DateRange\r\n    currentRangeUnit: string\r\n    isRangeAllDay: boolean\r\n    isValid: boolean\r\n    dateIncrement: Duration\r\n  */\n}\n\nfunction reduce(state, action, calendar) {\n  var viewType = reduceViewType(state.viewType, action);\n  var dateProfile = reduceDateProfile(state.dateProfile, action, state.currentDate, viewType, calendar);\n  var eventSources = reduceEventSources(state.eventSources, action, dateProfile, calendar);\n\n  var nextState = _assign({}, state, {\n    viewType: viewType,\n    dateProfile: dateProfile,\n    currentDate: reduceCurrentDate(state.currentDate, action, dateProfile),\n    eventSources: eventSources,\n    eventStore: reduceEventStore(state.eventStore, action, eventSources, dateProfile, calendar),\n    dateSelection: reduceDateSelection(state.dateSelection, action, calendar),\n    eventSelection: reduceSelectedEvent(state.eventSelection, action),\n    eventDrag: reduceEventDrag(state.eventDrag, action, eventSources, calendar),\n    eventResize: reduceEventResize(state.eventResize, action, eventSources, calendar),\n    eventSourceLoadingLevel: computeLoadingLevel(eventSources),\n    loadingLevel: computeLoadingLevel(eventSources)\n  });\n\n  for (var _i = 0, _a = calendar.pluginSystem.hooks.reducers; _i < _a.length; _i++) {\n    var reducerFunc = _a[_i];\n    nextState = reducerFunc(nextState, action, calendar);\n  } // console.log(action.type, nextState)\n\n\n  return nextState;\n}\n\nfunction reduceViewType(currentViewType, action) {\n  switch (action.type) {\n    case 'SET_VIEW_TYPE':\n      return action.viewType;\n\n    default:\n      return currentViewType;\n  }\n}\n\nfunction reduceDateProfile(currentDateProfile, action, currentDate, viewType, calendar) {\n  var newDateProfile;\n\n  switch (action.type) {\n    case 'PREV':\n      newDateProfile = calendar.dateProfileGenerators[viewType].buildPrev(currentDateProfile, currentDate);\n      break;\n\n    case 'NEXT':\n      newDateProfile = calendar.dateProfileGenerators[viewType].buildNext(currentDateProfile, currentDate);\n      break;\n\n    case 'SET_DATE':\n      if (!currentDateProfile.activeRange || !rangeContainsMarker(currentDateProfile.currentRange, action.dateMarker)) {\n        newDateProfile = calendar.dateProfileGenerators[viewType].build(action.dateMarker, undefined, true // forceToValid\n        );\n      }\n\n      break;\n\n    case 'SET_VIEW_TYPE':\n      var generator = calendar.dateProfileGenerators[viewType];\n\n      if (!generator) {\n        throw new Error(viewType ? 'The FullCalendar view \"' + viewType + '\" does not exist. Make sure your plugins are loaded correctly.' : 'No available FullCalendar view plugins.');\n      }\n\n      newDateProfile = generator.build(action.dateMarker || currentDate, undefined, true // forceToValid\n      );\n      break;\n  }\n\n  if (newDateProfile && newDateProfile.isValid && !(currentDateProfile && isDateProfilesEqual(currentDateProfile, newDateProfile))) {\n    return newDateProfile;\n  } else {\n    return currentDateProfile;\n  }\n}\n\nfunction reduceCurrentDate(currentDate, action, dateProfile) {\n  switch (action.type) {\n    case 'PREV':\n    case 'NEXT':\n      if (!rangeContainsMarker(dateProfile.currentRange, currentDate)) {\n        return dateProfile.currentRange.start;\n      } else {\n        return currentDate;\n      }\n\n    case 'SET_DATE':\n    case 'SET_VIEW_TYPE':\n      var newDate = action.dateMarker || currentDate;\n\n      if (dateProfile.activeRange && !rangeContainsMarker(dateProfile.activeRange, newDate)) {\n        return dateProfile.currentRange.start;\n      } else {\n        return newDate;\n      }\n\n    default:\n      return currentDate;\n  }\n}\n\nfunction reduceDateSelection(currentSelection, action, calendar) {\n  switch (action.type) {\n    case 'SELECT_DATES':\n      return action.selection;\n\n    case 'UNSELECT_DATES':\n      return null;\n\n    default:\n      return currentSelection;\n  }\n}\n\nfunction reduceSelectedEvent(currentInstanceId, action) {\n  switch (action.type) {\n    case 'SELECT_EVENT':\n      return action.eventInstanceId;\n\n    case 'UNSELECT_EVENT':\n      return '';\n\n    default:\n      return currentInstanceId;\n  }\n}\n\nfunction reduceEventDrag(currentDrag, action, sources, calendar) {\n  switch (action.type) {\n    case 'SET_EVENT_DRAG':\n      var newDrag = action.state;\n      return {\n        affectedEvents: newDrag.affectedEvents,\n        mutatedEvents: newDrag.mutatedEvents,\n        isEvent: newDrag.isEvent,\n        origSeg: newDrag.origSeg\n      };\n\n    case 'UNSET_EVENT_DRAG':\n      return null;\n\n    default:\n      return currentDrag;\n  }\n}\n\nfunction reduceEventResize(currentResize, action, sources, calendar) {\n  switch (action.type) {\n    case 'SET_EVENT_RESIZE':\n      var newResize = action.state;\n      return {\n        affectedEvents: newResize.affectedEvents,\n        mutatedEvents: newResize.mutatedEvents,\n        isEvent: newResize.isEvent,\n        origSeg: newResize.origSeg\n      };\n\n    case 'UNSET_EVENT_RESIZE':\n      return null;\n\n    default:\n      return currentResize;\n  }\n}\n\nfunction computeLoadingLevel(eventSources) {\n  var cnt = 0;\n\n  for (var sourceId in eventSources) {\n    if (eventSources[sourceId].isFetching) {\n      cnt++;\n    }\n  }\n\n  return cnt;\n}\n\nvar STANDARD_PROPS = {\n  start: null,\n  end: null,\n  allDay: Boolean\n};\n\nfunction parseDateSpan(raw, dateEnv, defaultDuration) {\n  var span = parseOpenDateSpan(raw, dateEnv);\n  var range = span.range;\n\n  if (!range.start) {\n    return null;\n  }\n\n  if (!range.end) {\n    if (defaultDuration == null) {\n      return null;\n    } else {\n      range.end = dateEnv.add(range.start, defaultDuration);\n    }\n  }\n\n  return span;\n}\n/*\r\nTODO: somehow combine with parseRange?\r\nWill return null if the start/end props were present but parsed invalidly.\r\n*/\n\n\nfunction parseOpenDateSpan(raw, dateEnv) {\n  var leftovers = {};\n  var standardProps = refineProps(raw, STANDARD_PROPS, {}, leftovers);\n  var startMeta = standardProps.start ? dateEnv.createMarkerMeta(standardProps.start) : null;\n  var endMeta = standardProps.end ? dateEnv.createMarkerMeta(standardProps.end) : null;\n  var allDay = standardProps.allDay;\n\n  if (allDay == null) {\n    allDay = startMeta && startMeta.isTimeUnspecified && (!endMeta || endMeta.isTimeUnspecified);\n  } // use this leftover object as the selection object\n\n\n  leftovers.range = {\n    start: startMeta ? startMeta.marker : null,\n    end: endMeta ? endMeta.marker : null\n  };\n  leftovers.allDay = allDay;\n  return leftovers;\n}\n\nfunction isDateSpansEqual(span0, span1) {\n  return rangesEqual(span0.range, span1.range) && span0.allDay === span1.allDay && isSpanPropsEqual(span0, span1);\n} // the NON-DATE-RELATED props\n\n\nfunction isSpanPropsEqual(span0, span1) {\n  for (var propName in span1) {\n    if (propName !== 'range' && propName !== 'allDay') {\n      if (span0[propName] !== span1[propName]) {\n        return false;\n      }\n    }\n  } // are there any props that span0 has that span1 DOESN'T have?\n  // both have range/allDay, so no need to special-case.\n\n\n  for (var propName in span0) {\n    if (!(propName in span1)) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nfunction buildDateSpanApi(span, dateEnv) {\n  return {\n    start: dateEnv.toDate(span.range.start),\n    end: dateEnv.toDate(span.range.end),\n    startStr: dateEnv.formatIso(span.range.start, {\n      omitTime: span.allDay\n    }),\n    endStr: dateEnv.formatIso(span.range.end, {\n      omitTime: span.allDay\n    }),\n    allDay: span.allDay\n  };\n}\n\nfunction buildDatePointApi(span, dateEnv) {\n  return {\n    date: dateEnv.toDate(span.range.start),\n    dateStr: dateEnv.formatIso(span.range.start, {\n      omitTime: span.allDay\n    }),\n    allDay: span.allDay\n  };\n}\n\nfunction fabricateEventRange(dateSpan, eventUiBases, calendar) {\n  var def = parseEventDef({\n    editable: false\n  }, '', // sourceId\n  dateSpan.allDay, true, // hasEnd\n  calendar);\n  return {\n    def: def,\n    ui: compileEventUi(def, eventUiBases),\n    instance: createEventInstance(def.defId, dateSpan.range),\n    range: dateSpan.range,\n    isStart: true,\n    isEnd: true\n  };\n}\n\nfunction compileViewDefs(defaultConfigs, overrideConfigs) {\n  var hash = {};\n  var viewType;\n\n  for (viewType in defaultConfigs) {\n    ensureViewDef(viewType, hash, defaultConfigs, overrideConfigs);\n  }\n\n  for (viewType in overrideConfigs) {\n    ensureViewDef(viewType, hash, defaultConfigs, overrideConfigs);\n  }\n\n  return hash;\n}\n\nfunction ensureViewDef(viewType, hash, defaultConfigs, overrideConfigs) {\n  if (hash[viewType]) {\n    return hash[viewType];\n  }\n\n  var viewDef = buildViewDef(viewType, hash, defaultConfigs, overrideConfigs);\n\n  if (viewDef) {\n    hash[viewType] = viewDef;\n  }\n\n  return viewDef;\n}\n\nfunction buildViewDef(viewType, hash, defaultConfigs, overrideConfigs) {\n  var defaultConfig = defaultConfigs[viewType];\n  var overrideConfig = overrideConfigs[viewType];\n\n  var queryProp = function queryProp(name) {\n    return defaultConfig && defaultConfig[name] !== null ? defaultConfig[name] : overrideConfig && overrideConfig[name] !== null ? overrideConfig[name] : null;\n  };\n\n  var theClass = queryProp('class');\n  var superType = queryProp('superType');\n\n  if (!superType && theClass) {\n    superType = findViewNameBySubclass(theClass, overrideConfigs) || findViewNameBySubclass(theClass, defaultConfigs);\n  }\n\n  var superDef = null;\n\n  if (superType) {\n    if (superType === viewType) {\n      throw new Error('Can\\'t have a custom view type that references itself');\n    }\n\n    superDef = ensureViewDef(superType, hash, defaultConfigs, overrideConfigs);\n  }\n\n  if (!theClass && superDef) {\n    theClass = superDef.class;\n  }\n\n  if (!theClass) {\n    return null; // don't throw a warning, might be settings for a single-unit view\n  }\n\n  return {\n    type: viewType,\n    class: theClass,\n    defaults: _assign({}, superDef ? superDef.defaults : {}, defaultConfig ? defaultConfig.options : {}),\n    overrides: _assign({}, superDef ? superDef.overrides : {}, overrideConfig ? overrideConfig.options : {})\n  };\n}\n\nfunction findViewNameBySubclass(viewSubclass, configs) {\n  var superProto = Object.getPrototypeOf(viewSubclass.prototype);\n\n  for (var viewType in configs) {\n    var parsed = configs[viewType]; // need DIRECT subclass, so instanceof won't do it\n\n    if (parsed.class && parsed.class.prototype === superProto) {\n      return viewType;\n    }\n  }\n\n  return '';\n}\n\nfunction parseViewConfigs(inputs) {\n  return mapHash(inputs, parseViewConfig);\n}\n\nvar VIEW_DEF_PROPS = {\n  type: String,\n  class: null\n};\n\nfunction parseViewConfig(input) {\n  if (typeof input === 'function') {\n    input = {\n      class: input\n    };\n  }\n\n  var options = {};\n  var props = refineProps(input, VIEW_DEF_PROPS, {}, options);\n  return {\n    superType: props.type,\n    class: props.class,\n    options: options\n  };\n}\n\nfunction buildViewSpecs(defaultInputs, optionsManager) {\n  var defaultConfigs = parseViewConfigs(defaultInputs);\n  var overrideConfigs = parseViewConfigs(optionsManager.overrides.views);\n  var viewDefs = compileViewDefs(defaultConfigs, overrideConfigs);\n  return mapHash(viewDefs, function (viewDef) {\n    return buildViewSpec(viewDef, overrideConfigs, optionsManager);\n  });\n}\n\nfunction buildViewSpec(viewDef, overrideConfigs, optionsManager) {\n  var durationInput = viewDef.overrides.duration || viewDef.defaults.duration || optionsManager.dynamicOverrides.duration || optionsManager.overrides.duration;\n  var duration = null;\n  var durationUnit = '';\n  var singleUnit = '';\n  var singleUnitOverrides = {};\n\n  if (durationInput) {\n    duration = createDuration(durationInput);\n\n    if (duration) {\n      // valid?\n      var denom = greatestDurationDenominator(duration, !getWeeksFromInput(durationInput));\n      durationUnit = denom.unit;\n\n      if (denom.value === 1) {\n        singleUnit = durationUnit;\n        singleUnitOverrides = overrideConfigs[durationUnit] ? overrideConfigs[durationUnit].options : {};\n      }\n    }\n  }\n\n  var queryButtonText = function queryButtonText(options) {\n    var buttonTextMap = options.buttonText || {};\n    var buttonTextKey = viewDef.defaults.buttonTextKey;\n\n    if (buttonTextKey != null && buttonTextMap[buttonTextKey] != null) {\n      return buttonTextMap[buttonTextKey];\n    }\n\n    if (buttonTextMap[viewDef.type] != null) {\n      return buttonTextMap[viewDef.type];\n    }\n\n    if (buttonTextMap[singleUnit] != null) {\n      return buttonTextMap[singleUnit];\n    }\n  };\n\n  return {\n    type: viewDef.type,\n    class: viewDef.class,\n    duration: duration,\n    durationUnit: durationUnit,\n    singleUnit: singleUnit,\n    options: _assign({}, globalDefaults, viewDef.defaults, optionsManager.dirDefaults, optionsManager.localeDefaults, optionsManager.overrides, singleUnitOverrides, viewDef.overrides, optionsManager.dynamicOverrides),\n    buttonTextOverride: queryButtonText(optionsManager.dynamicOverrides) || queryButtonText(optionsManager.overrides) || // constructor-specified buttonText lookup hash takes precedence\n    viewDef.overrides.buttonText,\n    buttonTextDefault: queryButtonText(optionsManager.localeDefaults) || queryButtonText(optionsManager.dirDefaults) || viewDef.defaults.buttonText || queryButtonText(globalDefaults) || viewDef.type // fall back to given view name\n\n  };\n}\n\nvar Toolbar =\n/** @class */\nfunction (_super) {\n  __extends(Toolbar, _super);\n\n  function Toolbar(context, extraClassName) {\n    var _this = _super.call(this, context) || this;\n\n    _this._renderLayout = memoizeRendering(_this.renderLayout, _this.unrenderLayout);\n    _this._updateTitle = memoizeRendering(_this.updateTitle, null, [_this._renderLayout]);\n    _this._updateActiveButton = memoizeRendering(_this.updateActiveButton, null, [_this._renderLayout]);\n    _this._updateToday = memoizeRendering(_this.updateToday, null, [_this._renderLayout]);\n    _this._updatePrev = memoizeRendering(_this.updatePrev, null, [_this._renderLayout]);\n    _this._updateNext = memoizeRendering(_this.updateNext, null, [_this._renderLayout]);\n    _this.el = createElement('div', {\n      className: 'fc-toolbar ' + extraClassName\n    });\n    return _this;\n  }\n\n  Toolbar.prototype.destroy = function () {\n    _super.prototype.destroy.call(this);\n\n    this._renderLayout.unrender(); // should unrender everything else\n\n\n    removeElement(this.el);\n  };\n\n  Toolbar.prototype.render = function (props) {\n    this._renderLayout(props.layout);\n\n    this._updateTitle(props.title);\n\n    this._updateActiveButton(props.activeButton);\n\n    this._updateToday(props.isTodayEnabled);\n\n    this._updatePrev(props.isPrevEnabled);\n\n    this._updateNext(props.isNextEnabled);\n  };\n\n  Toolbar.prototype.renderLayout = function (layout) {\n    var el = this.el;\n    this.viewsWithButtons = [];\n    appendToElement(el, this.renderSection('left', layout.left));\n    appendToElement(el, this.renderSection('center', layout.center));\n    appendToElement(el, this.renderSection('right', layout.right));\n  };\n\n  Toolbar.prototype.unrenderLayout = function () {\n    this.el.innerHTML = '';\n  };\n\n  Toolbar.prototype.renderSection = function (position, buttonStr) {\n    var _this = this;\n\n    var _a = this,\n        theme = _a.theme,\n        calendar = _a.calendar;\n\n    var optionsManager = calendar.optionsManager;\n    var viewSpecs = calendar.viewSpecs;\n    var sectionEl = createElement('div', {\n      className: 'fc-' + position\n    });\n    var calendarCustomButtons = optionsManager.computed.customButtons || {};\n    var calendarButtonTextOverrides = optionsManager.overrides.buttonText || {};\n    var calendarButtonText = optionsManager.computed.buttonText || {};\n\n    if (buttonStr) {\n      buttonStr.split(' ').forEach(function (buttonGroupStr, i) {\n        var groupChildren = [];\n        var isOnlyButtons = true;\n        var groupEl;\n        buttonGroupStr.split(',').forEach(function (buttonName, j) {\n          var customButtonProps;\n          var viewSpec;\n          var buttonClick;\n          var buttonIcon; // only one of these will be set\n\n          var buttonText; // \"\n\n          var buttonInnerHtml;\n          var buttonClasses;\n          var buttonEl;\n          var buttonAriaAttr;\n\n          if (buttonName === 'title') {\n            groupChildren.push(htmlToElement('<h2>&nbsp;</h2>')); // we always want it to take up height\n\n            isOnlyButtons = false;\n          } else {\n            if (customButtonProps = calendarCustomButtons[buttonName]) {\n              buttonClick = function buttonClick(ev) {\n                if (customButtonProps.click) {\n                  customButtonProps.click.call(buttonEl, ev);\n                }\n              };\n\n              (buttonIcon = theme.getCustomButtonIconClass(customButtonProps)) || (buttonIcon = theme.getIconClass(buttonName)) || (buttonText = customButtonProps.text);\n            } else if (viewSpec = viewSpecs[buttonName]) {\n              _this.viewsWithButtons.push(buttonName);\n\n              buttonClick = function buttonClick() {\n                calendar.changeView(buttonName);\n              };\n\n              (buttonText = viewSpec.buttonTextOverride) || (buttonIcon = theme.getIconClass(buttonName)) || (buttonText = viewSpec.buttonTextDefault);\n            } else if (calendar[buttonName]) {\n              // a calendar method\n              buttonClick = function buttonClick() {\n                calendar[buttonName]();\n              };\n\n              (buttonText = calendarButtonTextOverrides[buttonName]) || (buttonIcon = theme.getIconClass(buttonName)) || (buttonText = calendarButtonText[buttonName]); //            ^ everything else is considered default\n            }\n\n            if (buttonClick) {\n              buttonClasses = ['fc-' + buttonName + '-button', theme.getClass('button')];\n\n              if (buttonText) {\n                buttonInnerHtml = htmlEscape(buttonText);\n                buttonAriaAttr = '';\n              } else if (buttonIcon) {\n                buttonInnerHtml = \"<span class='\" + buttonIcon + \"'></span>\";\n                buttonAriaAttr = ' aria-label=\"' + buttonName + '\"';\n              }\n\n              buttonEl = htmlToElement( // type=\"button\" so that it doesn't submit a form\n              '<button type=\"button\" class=\"' + buttonClasses.join(' ') + '\"' + buttonAriaAttr + '>' + buttonInnerHtml + '</button>');\n              buttonEl.addEventListener('click', buttonClick);\n              groupChildren.push(buttonEl);\n            }\n          }\n        });\n\n        if (groupChildren.length > 1) {\n          groupEl = document.createElement('div');\n          var buttonGroupClassName = theme.getClass('buttonGroup');\n\n          if (isOnlyButtons && buttonGroupClassName) {\n            groupEl.classList.add(buttonGroupClassName);\n          }\n\n          appendToElement(groupEl, groupChildren);\n          sectionEl.appendChild(groupEl);\n        } else {\n          appendToElement(sectionEl, groupChildren); // 1 or 0 children\n        }\n      });\n    }\n\n    return sectionEl;\n  };\n\n  Toolbar.prototype.updateToday = function (isTodayEnabled) {\n    this.toggleButtonEnabled('today', isTodayEnabled);\n  };\n\n  Toolbar.prototype.updatePrev = function (isPrevEnabled) {\n    this.toggleButtonEnabled('prev', isPrevEnabled);\n  };\n\n  Toolbar.prototype.updateNext = function (isNextEnabled) {\n    this.toggleButtonEnabled('next', isNextEnabled);\n  };\n\n  Toolbar.prototype.updateTitle = function (text) {\n    findElements(this.el, 'h2').forEach(function (titleEl) {\n      titleEl.innerText = text;\n    });\n  };\n\n  Toolbar.prototype.updateActiveButton = function (buttonName) {\n    var className = this.theme.getClass('buttonActive');\n    findElements(this.el, 'button').forEach(function (buttonEl) {\n      if (buttonName && buttonEl.classList.contains('fc-' + buttonName + '-button')) {\n        buttonEl.classList.add(className);\n      } else {\n        buttonEl.classList.remove(className);\n      }\n    });\n  };\n\n  Toolbar.prototype.toggleButtonEnabled = function (buttonName, bool) {\n    findElements(this.el, '.fc-' + buttonName + '-button').forEach(function (buttonEl) {\n      buttonEl.disabled = !bool;\n    });\n  };\n\n  return Toolbar;\n}(Component);\n\nvar CalendarComponent =\n/** @class */\nfunction (_super) {\n  __extends(CalendarComponent, _super);\n\n  function CalendarComponent(context, el) {\n    var _this = _super.call(this, context) || this;\n\n    _this._renderToolbars = memoizeRendering(_this.renderToolbars);\n    _this.buildViewPropTransformers = memoize(buildViewPropTransformers);\n    _this.el = el;\n    prependToElement(el, _this.contentEl = createElement('div', {\n      className: 'fc-view-container'\n    }));\n    var calendar = _this.calendar;\n\n    for (var _i = 0, _a = calendar.pluginSystem.hooks.viewContainerModifiers; _i < _a.length; _i++) {\n      var modifyViewContainer = _a[_i];\n      modifyViewContainer(_this.contentEl, calendar);\n    }\n\n    _this.toggleElClassNames(true);\n\n    _this.computeTitle = memoize(computeTitle);\n    _this.parseBusinessHours = memoize(function (input) {\n      return parseBusinessHours(input, _this.calendar);\n    });\n    return _this;\n  }\n\n  CalendarComponent.prototype.destroy = function () {\n    if (this.header) {\n      this.header.destroy();\n    }\n\n    if (this.footer) {\n      this.footer.destroy();\n    }\n\n    if (this.view) {\n      this.view.destroy();\n    }\n\n    removeElement(this.contentEl);\n    this.toggleElClassNames(false);\n\n    _super.prototype.destroy.call(this);\n  };\n\n  CalendarComponent.prototype.toggleElClassNames = function (bool) {\n    var classList = this.el.classList;\n    var dirClassName = 'fc-' + this.opt('dir');\n    var themeClassName = this.theme.getClass('widget');\n\n    if (bool) {\n      classList.add('fc');\n      classList.add(dirClassName);\n      classList.add(themeClassName);\n    } else {\n      classList.remove('fc');\n      classList.remove(dirClassName);\n      classList.remove(themeClassName);\n    }\n  };\n\n  CalendarComponent.prototype.render = function (props) {\n    this.freezeHeight();\n    var title = this.computeTitle(props.dateProfile, props.viewSpec.options);\n\n    this._renderToolbars(props.viewSpec, props.dateProfile, props.currentDate, props.dateProfileGenerator, title);\n\n    this.renderView(props, title);\n    this.updateSize();\n    this.thawHeight();\n  };\n\n  CalendarComponent.prototype.renderToolbars = function (viewSpec, dateProfile, currentDate, dateProfileGenerator, title) {\n    var headerLayout = this.opt('header');\n    var footerLayout = this.opt('footer');\n    var now = this.calendar.getNow();\n    var todayInfo = dateProfileGenerator.build(now);\n    var prevInfo = dateProfileGenerator.buildPrev(dateProfile, currentDate);\n    var nextInfo = dateProfileGenerator.buildNext(dateProfile, currentDate);\n    var toolbarProps = {\n      title: title,\n      activeButton: viewSpec.type,\n      isTodayEnabled: todayInfo.isValid && !rangeContainsMarker(dateProfile.currentRange, now),\n      isPrevEnabled: prevInfo.isValid,\n      isNextEnabled: nextInfo.isValid\n    };\n\n    if (headerLayout) {\n      if (!this.header) {\n        this.header = new Toolbar(this.context, 'fc-header-toolbar');\n        prependToElement(this.el, this.header.el);\n      }\n\n      this.header.receiveProps(_assign({\n        layout: headerLayout\n      }, toolbarProps));\n    } else if (this.header) {\n      this.header.destroy();\n      this.header = null;\n    }\n\n    if (footerLayout) {\n      if (!this.footer) {\n        this.footer = new Toolbar(this.context, 'fc-footer-toolbar');\n        appendToElement(this.el, this.footer.el);\n      }\n\n      this.footer.receiveProps(_assign({\n        layout: footerLayout\n      }, toolbarProps));\n    } else if (this.footer) {\n      this.footer.destroy();\n      this.footer = null;\n    }\n  };\n\n  CalendarComponent.prototype.renderView = function (props, title) {\n    var view = this.view;\n    var viewSpec = props.viewSpec,\n        dateProfileGenerator = props.dateProfileGenerator;\n\n    if (!view || view.viewSpec !== viewSpec) {\n      if (view) {\n        view.destroy();\n      }\n\n      view = this.view = new viewSpec['class']({\n        calendar: this.calendar,\n        view: null,\n        dateEnv: this.dateEnv,\n        theme: this.theme,\n        options: viewSpec.options\n      }, viewSpec, dateProfileGenerator, this.contentEl);\n    } else {\n      view.addScroll(view.queryScroll());\n    }\n\n    view.title = title; // for the API\n\n    var viewProps = {\n      dateProfile: props.dateProfile,\n      businessHours: this.parseBusinessHours(viewSpec.options.businessHours),\n      eventStore: props.eventStore,\n      eventUiBases: props.eventUiBases,\n      dateSelection: props.dateSelection,\n      eventSelection: props.eventSelection,\n      eventDrag: props.eventDrag,\n      eventResize: props.eventResize\n    };\n    var transformers = this.buildViewPropTransformers(this.calendar.pluginSystem.hooks.viewPropsTransformers);\n\n    for (var _i = 0, transformers_1 = transformers; _i < transformers_1.length; _i++) {\n      var transformer = transformers_1[_i];\n\n      _assign(viewProps, transformer.transform(viewProps, viewSpec, props, view));\n    }\n\n    view.receiveProps(viewProps);\n  }; // Sizing\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  CalendarComponent.prototype.updateSize = function (isResize) {\n    if (isResize === void 0) {\n      isResize = false;\n    }\n\n    var view = this.view;\n\n    if (isResize) {\n      view.addScroll(view.queryScroll());\n    }\n\n    if (isResize || this.isHeightAuto == null) {\n      this.computeHeightVars();\n    }\n\n    view.updateSize(isResize, this.viewHeight, this.isHeightAuto);\n    view.updateNowIndicator(); // we need to guarantee this will run after updateSize\n\n    view.popScroll(isResize);\n  };\n\n  CalendarComponent.prototype.computeHeightVars = function () {\n    var calendar = this.calendar; // yuck. need to handle dynamic options\n\n    var heightInput = calendar.opt('height');\n    var contentHeightInput = calendar.opt('contentHeight');\n    this.isHeightAuto = heightInput === 'auto' || contentHeightInput === 'auto';\n\n    if (typeof contentHeightInput === 'number') {\n      // exists and not 'auto'\n      this.viewHeight = contentHeightInput;\n    } else if (typeof contentHeightInput === 'function') {\n      // exists and is a function\n      this.viewHeight = contentHeightInput();\n    } else if (typeof heightInput === 'number') {\n      // exists and not 'auto'\n      this.viewHeight = heightInput - this.queryToolbarsHeight();\n    } else if (typeof heightInput === 'function') {\n      // exists and is a function\n      this.viewHeight = heightInput() - this.queryToolbarsHeight();\n    } else if (heightInput === 'parent') {\n      // set to height of parent element\n      var parentEl = this.el.parentNode;\n      this.viewHeight = parentEl.getBoundingClientRect().height - this.queryToolbarsHeight();\n    } else {\n      this.viewHeight = Math.round(this.contentEl.getBoundingClientRect().width / Math.max(calendar.opt('aspectRatio'), .5));\n    }\n  };\n\n  CalendarComponent.prototype.queryToolbarsHeight = function () {\n    var height = 0;\n\n    if (this.header) {\n      height += computeHeightAndMargins(this.header.el);\n    }\n\n    if (this.footer) {\n      height += computeHeightAndMargins(this.footer.el);\n    }\n\n    return height;\n  }; // Height \"Freezing\"\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  CalendarComponent.prototype.freezeHeight = function () {\n    applyStyle(this.el, {\n      height: this.el.getBoundingClientRect().height,\n      overflow: 'hidden'\n    });\n  };\n\n  CalendarComponent.prototype.thawHeight = function () {\n    applyStyle(this.el, {\n      height: '',\n      overflow: ''\n    });\n  };\n\n  return CalendarComponent;\n}(Component); // Title and Date Formatting\n// -----------------------------------------------------------------------------------------------------------------\n// Computes what the title at the top of the calendar should be for this view\n\n\nfunction computeTitle(dateProfile, viewOptions) {\n  var range; // for views that span a large unit of time, show the proper interval, ignoring stray days before and after\n\n  if (/^(year|month)$/.test(dateProfile.currentRangeUnit)) {\n    range = dateProfile.currentRange;\n  } else {\n    // for day units or smaller, use the actual day range\n    range = dateProfile.activeRange;\n  }\n\n  return this.dateEnv.formatRange(range.start, range.end, createFormatter(viewOptions.titleFormat || computeTitleFormat(dateProfile), viewOptions.titleRangeSeparator), {\n    isEndExclusive: dateProfile.isRangeAllDay\n  });\n} // Generates the format string that should be used to generate the title for the current date range.\n// Attempts to compute the most appropriate format if not explicitly specified with `titleFormat`.\n\n\nfunction computeTitleFormat(dateProfile) {\n  var currentRangeUnit = dateProfile.currentRangeUnit;\n\n  if (currentRangeUnit === 'year') {\n    return {\n      year: 'numeric'\n    };\n  } else if (currentRangeUnit === 'month') {\n    return {\n      year: 'numeric',\n      month: 'long'\n    }; // like \"September 2014\"\n  } else {\n    var days = diffWholeDays(dateProfile.currentRange.start, dateProfile.currentRange.end);\n\n    if (days !== null && days > 1) {\n      // multi-day range. shorter, like \"Sep 9 - 10 2014\"\n      return {\n        year: 'numeric',\n        month: 'short',\n        day: 'numeric'\n      };\n    } else {\n      // one day. longer, like \"September 9 2014\"\n      return {\n        year: 'numeric',\n        month: 'long',\n        day: 'numeric'\n      };\n    }\n  }\n} // Plugin\n// -----------------------------------------------------------------------------------------------------------------\n\n\nfunction buildViewPropTransformers(theClasses) {\n  return theClasses.map(function (theClass) {\n    return new theClass();\n  });\n}\n\nvar Interaction =\n/** @class */\nfunction () {\n  function Interaction(settings) {\n    this.component = settings.component;\n  }\n\n  Interaction.prototype.destroy = function () {};\n\n  return Interaction;\n}();\n\nfunction parseInteractionSettings(component, input) {\n  return {\n    component: component,\n    el: input.el,\n    useEventCenter: input.useEventCenter != null ? input.useEventCenter : true\n  };\n}\n\nfunction interactionSettingsToStore(settings) {\n  var _a;\n\n  return _a = {}, _a[settings.component.uid] = settings, _a;\n} // global state\n\n\nvar interactionSettingsStore = {};\n/*\r\nDetects when the user clicks on an event within a DateComponent\r\n*/\n\nvar EventClicking =\n/** @class */\nfunction (_super) {\n  __extends(EventClicking, _super);\n\n  function EventClicking(settings) {\n    var _this = _super.call(this, settings) || this;\n\n    _this.handleSegClick = function (ev, segEl) {\n      var component = _this.component;\n      var seg = getElSeg(segEl);\n\n      if (seg && // might be the <div> surrounding the more link\n      component.isValidSegDownEl(ev.target)) {\n        // our way to simulate a link click for elements that can't be <a> tags\n        // grab before trigger fired in case trigger trashes DOM thru rerendering\n        var hasUrlContainer = elementClosest(ev.target, '.fc-has-url');\n        var url = hasUrlContainer ? hasUrlContainer.querySelector('a[href]').href : '';\n        component.publiclyTrigger('eventClick', [{\n          el: segEl,\n          event: new EventApi(component.calendar, seg.eventRange.def, seg.eventRange.instance),\n          jsEvent: ev,\n          view: component.view\n        }]);\n\n        if (url && !ev.defaultPrevented) {\n          window.location.href = url;\n        }\n      }\n    };\n\n    var component = settings.component;\n    _this.destroy = listenBySelector(component.el, 'click', component.fgSegSelector + ',' + component.bgSegSelector, _this.handleSegClick);\n    return _this;\n  }\n\n  return EventClicking;\n}(Interaction);\n/*\r\nTriggers events and adds/removes core classNames when the user's pointer\r\nenters/leaves event-elements of a component.\r\n*/\n\n\nvar EventHovering =\n/** @class */\nfunction (_super) {\n  __extends(EventHovering, _super);\n\n  function EventHovering(settings) {\n    var _this = _super.call(this, settings) || this; // for simulating an eventMouseLeave when the event el is destroyed while mouse is over it\n\n\n    _this.handleEventElRemove = function (el) {\n      if (el === _this.currentSegEl) {\n        _this.handleSegLeave(null, _this.currentSegEl);\n      }\n    };\n\n    _this.handleSegEnter = function (ev, segEl) {\n      if (getElSeg(segEl)) {\n        // TODO: better way to make sure not hovering over more+ link or its wrapper\n        segEl.classList.add('fc-allow-mouse-resize');\n        _this.currentSegEl = segEl;\n\n        _this.triggerEvent('eventMouseEnter', ev, segEl);\n      }\n    };\n\n    _this.handleSegLeave = function (ev, segEl) {\n      if (_this.currentSegEl) {\n        segEl.classList.remove('fc-allow-mouse-resize');\n        _this.currentSegEl = null;\n\n        _this.triggerEvent('eventMouseLeave', ev, segEl);\n      }\n    };\n\n    var component = settings.component;\n    _this.removeHoverListeners = listenToHoverBySelector(component.el, component.fgSegSelector + ',' + component.bgSegSelector, _this.handleSegEnter, _this.handleSegLeave);\n    component.calendar.on('eventElRemove', _this.handleEventElRemove);\n    return _this;\n  }\n\n  EventHovering.prototype.destroy = function () {\n    this.removeHoverListeners();\n    this.component.calendar.off('eventElRemove', this.handleEventElRemove);\n  };\n\n  EventHovering.prototype.triggerEvent = function (publicEvName, ev, segEl) {\n    var component = this.component;\n    var seg = getElSeg(segEl);\n\n    if (!ev || component.isValidSegDownEl(ev.target)) {\n      component.publiclyTrigger(publicEvName, [{\n        el: segEl,\n        event: new EventApi(this.component.calendar, seg.eventRange.def, seg.eventRange.instance),\n        jsEvent: ev,\n        view: component.view\n      }]);\n    }\n  };\n\n  return EventHovering;\n}(Interaction);\n\nvar StandardTheme =\n/** @class */\nfunction (_super) {\n  __extends(StandardTheme, _super);\n\n  function StandardTheme() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  return StandardTheme;\n}(Theme);\n\nStandardTheme.prototype.classes = {\n  widget: 'fc-unthemed',\n  widgetHeader: 'fc-widget-header',\n  widgetContent: 'fc-widget-content',\n  buttonGroup: 'fc-button-group',\n  button: 'fc-button fc-button-primary',\n  buttonActive: 'fc-button-active',\n  popoverHeader: 'fc-widget-header',\n  popoverContent: 'fc-widget-content',\n  // day grid\n  headerRow: 'fc-widget-header',\n  dayRow: 'fc-widget-content',\n  // list view\n  listView: 'fc-widget-content'\n};\nStandardTheme.prototype.baseIconClass = 'fc-icon';\nStandardTheme.prototype.iconClasses = {\n  close: 'fc-icon-x',\n  prev: 'fc-icon-chevron-left',\n  next: 'fc-icon-chevron-right',\n  prevYear: 'fc-icon-chevrons-left',\n  nextYear: 'fc-icon-chevrons-right'\n};\nStandardTheme.prototype.iconOverrideOption = 'buttonIcons';\nStandardTheme.prototype.iconOverrideCustomButtonOption = 'icon';\nStandardTheme.prototype.iconOverridePrefix = 'fc-icon-';\n\nvar Calendar =\n/** @class */\nfunction () {\n  function Calendar(el, overrides) {\n    var _this = this;\n\n    this.parseRawLocales = memoize(parseRawLocales);\n    this.buildLocale = memoize(buildLocale);\n    this.buildDateEnv = memoize(buildDateEnv);\n    this.buildTheme = memoize(buildTheme);\n    this.buildEventUiSingleBase = memoize(this._buildEventUiSingleBase);\n    this.buildSelectionConfig = memoize(this._buildSelectionConfig);\n    this.buildEventUiBySource = memoizeOutput(buildEventUiBySource, isPropsEqual);\n    this.buildEventUiBases = memoize(buildEventUiBases);\n    this.interactionsStore = {};\n    this.actionQueue = [];\n    this.isReducing = false; // isDisplaying: boolean = false // installed in DOM? accepting renders?\n\n    this.needsRerender = false; // needs a render?\n\n    this.needsFullRerender = false;\n    this.isRendering = false; // currently in the executeRender function?\n\n    this.renderingPauseDepth = 0;\n    this.buildDelayedRerender = memoize(buildDelayedRerender);\n    this.afterSizingTriggers = {};\n    this.isViewUpdated = false;\n    this.isDatesUpdated = false;\n    this.isEventsUpdated = false;\n    this.el = el;\n    this.optionsManager = new OptionsManager(overrides || {});\n    this.pluginSystem = new PluginSystem(); // only do once. don't do in handleOptions. because can't remove plugins\n\n    this.addPluginInputs(this.optionsManager.computed.plugins || []);\n    this.handleOptions(this.optionsManager.computed);\n    this.publiclyTrigger('_init'); // for tests\n\n    this.hydrate();\n    this.calendarInteractions = this.pluginSystem.hooks.calendarInteractions.map(function (calendarInteractionClass) {\n      return new calendarInteractionClass(_this);\n    });\n  }\n\n  Calendar.prototype.addPluginInputs = function (pluginInputs) {\n    var pluginDefs = refinePluginDefs(pluginInputs);\n\n    for (var _i = 0, pluginDefs_1 = pluginDefs; _i < pluginDefs_1.length; _i++) {\n      var pluginDef = pluginDefs_1[_i];\n      this.pluginSystem.add(pluginDef);\n    }\n  };\n\n  Object.defineProperty(Calendar.prototype, \"view\", {\n    // public API\n    get: function get() {\n      return this.component ? this.component.view : null;\n    },\n    enumerable: true,\n    configurable: true\n  }); // Public API for rendering\n  // -----------------------------------------------------------------------------------------------------------------\n\n  Calendar.prototype.render = function () {\n    if (!this.component) {\n      this.renderableEventStore = createEmptyEventStore();\n      this.bindHandlers();\n      this.executeRender();\n    } else {\n      this.requestRerender(true);\n    }\n  };\n\n  Calendar.prototype.destroy = function () {\n    if (this.component) {\n      this.unbindHandlers();\n      this.component.destroy(); // don't null-out. in case API needs access\n\n      this.component = null; // umm ???\n\n      for (var _i = 0, _a = this.calendarInteractions; _i < _a.length; _i++) {\n        var interaction = _a[_i];\n        interaction.destroy();\n      }\n\n      this.publiclyTrigger('_destroyed');\n    }\n  }; // Handlers\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  Calendar.prototype.bindHandlers = function () {\n    var _this = this; // event delegation for nav links\n\n\n    this.removeNavLinkListener = listenBySelector(this.el, 'click', 'a[data-goto]', function (ev, anchorEl) {\n      var gotoOptions = anchorEl.getAttribute('data-goto');\n      gotoOptions = gotoOptions ? JSON.parse(gotoOptions) : {};\n      var dateEnv = _this.dateEnv;\n      var dateMarker = dateEnv.createMarker(gotoOptions.date);\n      var viewType = gotoOptions.type; // property like \"navLinkDayClick\". might be a string or a function\n\n      var customAction = _this.viewOpt('navLink' + capitaliseFirstLetter(viewType) + 'Click');\n\n      if (typeof customAction === 'function') {\n        customAction(dateEnv.toDate(dateMarker), ev);\n      } else {\n        if (typeof customAction === 'string') {\n          viewType = customAction;\n        }\n\n        _this.zoomTo(dateMarker, viewType);\n      }\n    });\n\n    if (this.opt('handleWindowResize')) {\n      window.addEventListener('resize', this.windowResizeProxy = debounce( // prevents rapid calls\n      this.windowResize.bind(this), this.opt('windowResizeDelay')));\n    }\n  };\n\n  Calendar.prototype.unbindHandlers = function () {\n    this.removeNavLinkListener();\n\n    if (this.windowResizeProxy) {\n      window.removeEventListener('resize', this.windowResizeProxy);\n      this.windowResizeProxy = null;\n    }\n  }; // Dispatcher\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  Calendar.prototype.hydrate = function () {\n    var _this = this;\n\n    this.state = this.buildInitialState();\n    var rawSources = this.opt('eventSources') || [];\n    var singleRawSource = this.opt('events');\n    var sources = []; // parsed\n\n    if (singleRawSource) {\n      rawSources.unshift(singleRawSource);\n    }\n\n    for (var _i = 0, rawSources_1 = rawSources; _i < rawSources_1.length; _i++) {\n      var rawSource = rawSources_1[_i];\n      var source = parseEventSource(rawSource, this);\n\n      if (source) {\n        sources.push(source);\n      }\n    }\n\n    this.batchRendering(function () {\n      _this.dispatch({\n        type: 'INIT'\n      }); // pass in sources here?\n\n\n      _this.dispatch({\n        type: 'ADD_EVENT_SOURCES',\n        sources: sources\n      });\n\n      _this.dispatch({\n        type: 'SET_VIEW_TYPE',\n        viewType: _this.opt('defaultView') || _this.pluginSystem.hooks.defaultView\n      });\n    });\n  };\n\n  Calendar.prototype.buildInitialState = function () {\n    return {\n      viewType: null,\n      loadingLevel: 0,\n      eventSourceLoadingLevel: 0,\n      currentDate: this.getInitialDate(),\n      dateProfile: null,\n      eventSources: {},\n      eventStore: createEmptyEventStore(),\n      dateSelection: null,\n      eventSelection: '',\n      eventDrag: null,\n      eventResize: null\n    };\n  };\n\n  Calendar.prototype.dispatch = function (action) {\n    this.actionQueue.push(action);\n\n    if (!this.isReducing) {\n      this.isReducing = true;\n      var oldState = this.state;\n\n      while (this.actionQueue.length) {\n        this.state = this.reduce(this.state, this.actionQueue.shift(), this);\n      }\n\n      var newState = this.state;\n      this.isReducing = false;\n\n      if (!oldState.loadingLevel && newState.loadingLevel) {\n        this.publiclyTrigger('loading', [true]);\n      } else if (oldState.loadingLevel && !newState.loadingLevel) {\n        this.publiclyTrigger('loading', [false]);\n      }\n\n      var view = this.component && this.component.view;\n\n      if (oldState.eventStore !== newState.eventStore || this.needsFullRerender) {\n        if (oldState.eventStore) {\n          this.isEventsUpdated = true;\n        }\n      }\n\n      if (oldState.dateProfile !== newState.dateProfile || this.needsFullRerender) {\n        if (oldState.dateProfile && view) {\n          // why would view be null!?\n          this.publiclyTrigger('datesDestroy', [{\n            view: view,\n            el: view.el\n          }]);\n        }\n\n        this.isDatesUpdated = true;\n      }\n\n      if (oldState.viewType !== newState.viewType || this.needsFullRerender) {\n        if (oldState.viewType && view) {\n          // why would view be null!?\n          this.publiclyTrigger('viewSkeletonDestroy', [{\n            view: view,\n            el: view.el\n          }]);\n        }\n\n        this.isViewUpdated = true;\n      }\n\n      this.requestRerender();\n    }\n  };\n\n  Calendar.prototype.reduce = function (state, action, calendar) {\n    return reduce(state, action, calendar);\n  }; // Render Queue\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  Calendar.prototype.requestRerender = function (needsFull) {\n    if (needsFull === void 0) {\n      needsFull = false;\n    }\n\n    this.needsRerender = true;\n    this.needsFullRerender = this.needsFullRerender || needsFull;\n    this.delayedRerender(); // will call a debounced-version of tryRerender\n  };\n\n  Calendar.prototype.tryRerender = function () {\n    if (this.component && // must be accepting renders\n    this.needsRerender && // indicates that a rerender was requested\n    !this.renderingPauseDepth && // not paused\n    !this.isRendering // not currently in the render loop\n    ) {\n        this.executeRender();\n      }\n  };\n\n  Calendar.prototype.batchRendering = function (func) {\n    this.renderingPauseDepth++;\n    func();\n    this.renderingPauseDepth--;\n\n    if (this.needsRerender) {\n      this.requestRerender();\n    }\n  }; // Rendering\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  Calendar.prototype.executeRender = function () {\n    var needsFullRerender = this.needsFullRerender; // save before clearing\n    // clear these BEFORE the render so that new values will accumulate during render\n\n    this.needsRerender = false;\n    this.needsFullRerender = false;\n    this.isRendering = true;\n    this.renderComponent(needsFullRerender);\n    this.isRendering = false; // received a rerender request while rendering\n\n    if (this.needsRerender) {\n      this.delayedRerender();\n    }\n  };\n  /*\r\n  don't call this directly. use executeRender instead\r\n  */\n\n\n  Calendar.prototype.renderComponent = function (needsFull) {\n    var _a = this,\n        state = _a.state,\n        component = _a.component;\n\n    var viewType = state.viewType;\n    var viewSpec = this.viewSpecs[viewType];\n    var savedScroll = needsFull && component ? component.view.queryScroll() : null;\n\n    if (!viewSpec) {\n      throw new Error(\"View type \\\"\" + viewType + \"\\\" is not valid\");\n    } // if event sources are still loading and progressive rendering hasn't been enabled,\n    // keep rendering the last fully loaded set of events\n\n\n    var renderableEventStore = this.renderableEventStore = state.eventSourceLoadingLevel && !this.opt('progressiveEventRendering') ? this.renderableEventStore : state.eventStore;\n    var eventUiSingleBase = this.buildEventUiSingleBase(viewSpec.options);\n    var eventUiBySource = this.buildEventUiBySource(state.eventSources);\n    var eventUiBases = this.eventUiBases = this.buildEventUiBases(renderableEventStore.defs, eventUiSingleBase, eventUiBySource);\n\n    if (needsFull || !component) {\n      if (component) {\n        component.freezeHeight(); // next component will unfreeze it\n\n        component.destroy();\n      }\n\n      component = this.component = new CalendarComponent({\n        calendar: this,\n        view: null,\n        dateEnv: this.dateEnv,\n        theme: this.theme,\n        options: this.optionsManager.computed\n      }, this.el);\n      this.isViewUpdated = true;\n      this.isDatesUpdated = true;\n      this.isEventsUpdated = true;\n    }\n\n    component.receiveProps(_assign({}, state, {\n      viewSpec: viewSpec,\n      dateProfile: state.dateProfile,\n      dateProfileGenerator: this.dateProfileGenerators[viewType],\n      eventStore: renderableEventStore,\n      eventUiBases: eventUiBases,\n      dateSelection: state.dateSelection,\n      eventSelection: state.eventSelection,\n      eventDrag: state.eventDrag,\n      eventResize: state.eventResize\n    }));\n\n    if (savedScroll) {\n      component.view.applyScroll(savedScroll, false);\n    }\n\n    if (this.isViewUpdated) {\n      this.isViewUpdated = false;\n      this.publiclyTrigger('viewSkeletonRender', [{\n        view: component.view,\n        el: component.view.el\n      }]);\n    }\n\n    if (this.isDatesUpdated) {\n      this.isDatesUpdated = false;\n      this.publiclyTrigger('datesRender', [{\n        view: component.view,\n        el: component.view.el\n      }]);\n    }\n\n    if (this.isEventsUpdated) {\n      this.isEventsUpdated = false;\n    }\n\n    this.releaseAfterSizingTriggers();\n  }; // Options\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  Calendar.prototype.setOption = function (name, val) {\n    var _a;\n\n    this.mutateOptions((_a = {}, _a[name] = val, _a), [], true);\n  };\n\n  Calendar.prototype.getOption = function (name) {\n    return this.optionsManager.computed[name];\n  };\n\n  Calendar.prototype.opt = function (name) {\n    return this.optionsManager.computed[name];\n  };\n\n  Calendar.prototype.viewOpt = function (name) {\n    return this.viewOpts()[name];\n  };\n\n  Calendar.prototype.viewOpts = function () {\n    return this.viewSpecs[this.state.viewType].options;\n  };\n  /*\r\n  handles option changes (like a diff)\r\n  */\n\n\n  Calendar.prototype.mutateOptions = function (updates, removals, isDynamic, deepEqual) {\n    var _this = this;\n\n    var changeHandlers = this.pluginSystem.hooks.optionChangeHandlers;\n    var normalUpdates = {};\n    var specialUpdates = {};\n    var oldDateEnv = this.dateEnv; // do this before handleOptions\n\n    var isTimeZoneDirty = false;\n    var isSizeDirty = false;\n    var anyDifficultOptions = Boolean(removals.length);\n\n    for (var name_1 in updates) {\n      if (changeHandlers[name_1]) {\n        specialUpdates[name_1] = updates[name_1];\n      } else {\n        normalUpdates[name_1] = updates[name_1];\n      }\n    }\n\n    for (var name_2 in normalUpdates) {\n      if (/^(height|contentHeight|aspectRatio)$/.test(name_2)) {\n        isSizeDirty = true;\n      } else if (/^(defaultDate|defaultView)$/.test(name_2)) ;else {\n        anyDifficultOptions = true;\n\n        if (name_2 === 'timeZone') {\n          isTimeZoneDirty = true;\n        }\n      }\n    }\n\n    this.optionsManager.mutate(normalUpdates, removals, isDynamic);\n\n    if (anyDifficultOptions) {\n      this.handleOptions(this.optionsManager.computed);\n      this.needsFullRerender = true;\n    }\n\n    this.batchRendering(function () {\n      if (anyDifficultOptions) {\n        if (isTimeZoneDirty) {\n          _this.dispatch({\n            type: 'CHANGE_TIMEZONE',\n            oldDateEnv: oldDateEnv\n          });\n        }\n        /* HACK\r\n        has the same effect as calling this.requestRerender(true)\r\n        but recomputes the state's dateProfile\r\n        */\n\n\n        _this.dispatch({\n          type: 'SET_VIEW_TYPE',\n          viewType: _this.state.viewType\n        });\n      } else if (isSizeDirty) {\n        _this.updateSize();\n      } // special updates\n\n\n      if (deepEqual) {\n        for (var name_3 in specialUpdates) {\n          changeHandlers[name_3](specialUpdates[name_3], _this, deepEqual);\n        }\n      }\n    });\n  };\n  /*\r\n  rebuilds things based off of a complete set of refined options\r\n  */\n\n\n  Calendar.prototype.handleOptions = function (options) {\n    var _this = this;\n\n    var pluginHooks = this.pluginSystem.hooks;\n    this.defaultAllDayEventDuration = createDuration(options.defaultAllDayEventDuration);\n    this.defaultTimedEventDuration = createDuration(options.defaultTimedEventDuration);\n    this.delayedRerender = this.buildDelayedRerender(options.rerenderDelay);\n    this.theme = this.buildTheme(options);\n    var available = this.parseRawLocales(options.locales);\n    this.availableRawLocales = available.map;\n    var locale = this.buildLocale(options.locale || available.defaultCode, available.map);\n    this.dateEnv = this.buildDateEnv(locale, options.timeZone, pluginHooks.namedTimeZonedImpl, options.firstDay, options.weekNumberCalculation, options.weekLabel, pluginHooks.cmdFormatter);\n    this.selectionConfig = this.buildSelectionConfig(options); // needs dateEnv. do after :(\n    // ineffecient to do every time?\n\n    this.viewSpecs = buildViewSpecs(pluginHooks.views, this.optionsManager); // ineffecient to do every time?\n\n    this.dateProfileGenerators = mapHash(this.viewSpecs, function (viewSpec) {\n      return new viewSpec.class.prototype.dateProfileGeneratorClass(viewSpec, _this);\n    });\n  };\n\n  Calendar.prototype.getAvailableLocaleCodes = function () {\n    return Object.keys(this.availableRawLocales);\n  };\n\n  Calendar.prototype._buildSelectionConfig = function (rawOpts) {\n    return processScopedUiProps('select', rawOpts, this);\n  };\n\n  Calendar.prototype._buildEventUiSingleBase = function (rawOpts) {\n    if (rawOpts.editable) {\n      // so 'editable' affected events\n      rawOpts = _assign({}, rawOpts, {\n        eventEditable: true\n      });\n    }\n\n    return processScopedUiProps('event', rawOpts, this);\n  }; // Trigger\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  Calendar.prototype.hasPublicHandlers = function (name) {\n    return this.hasHandlers(name) || this.opt(name); // handler specified in options\n  };\n\n  Calendar.prototype.publiclyTrigger = function (name, args) {\n    var optHandler = this.opt(name);\n    this.triggerWith(name, this, args);\n\n    if (optHandler) {\n      return optHandler.apply(this, args);\n    }\n  };\n\n  Calendar.prototype.publiclyTriggerAfterSizing = function (name, args) {\n    var afterSizingTriggers = this.afterSizingTriggers;\n    (afterSizingTriggers[name] || (afterSizingTriggers[name] = [])).push(args);\n  };\n\n  Calendar.prototype.releaseAfterSizingTriggers = function () {\n    var afterSizingTriggers = this.afterSizingTriggers;\n\n    for (var name_4 in afterSizingTriggers) {\n      for (var _i = 0, _a = afterSizingTriggers[name_4]; _i < _a.length; _i++) {\n        var args = _a[_i];\n        this.publiclyTrigger(name_4, args);\n      }\n    }\n\n    this.afterSizingTriggers = {};\n  }; // View\n  // -----------------------------------------------------------------------------------------------------------------\n  // Returns a boolean about whether the view is okay to instantiate at some point\n\n\n  Calendar.prototype.isValidViewType = function (viewType) {\n    return Boolean(this.viewSpecs[viewType]);\n  };\n\n  Calendar.prototype.changeView = function (viewType, dateOrRange) {\n    var dateMarker = null;\n\n    if (dateOrRange) {\n      if (dateOrRange.start && dateOrRange.end) {\n        // a range\n        this.optionsManager.mutate({\n          visibleRange: dateOrRange\n        }, []); // will not rerender\n\n        this.handleOptions(this.optionsManager.computed); // ...but yuck\n      } else {\n        // a date\n        dateMarker = this.dateEnv.createMarker(dateOrRange); // just like gotoDate\n      }\n    }\n\n    this.unselect();\n    this.dispatch({\n      type: 'SET_VIEW_TYPE',\n      viewType: viewType,\n      dateMarker: dateMarker\n    });\n  }; // Forces navigation to a view for the given date.\n  // `viewType` can be a specific view name or a generic one like \"week\" or \"day\".\n  // needs to change\n\n\n  Calendar.prototype.zoomTo = function (dateMarker, viewType) {\n    var spec;\n    viewType = viewType || 'day'; // day is default zoom\n\n    spec = this.viewSpecs[viewType] || this.getUnitViewSpec(viewType);\n    this.unselect();\n\n    if (spec) {\n      this.dispatch({\n        type: 'SET_VIEW_TYPE',\n        viewType: spec.type,\n        dateMarker: dateMarker\n      });\n    } else {\n      this.dispatch({\n        type: 'SET_DATE',\n        dateMarker: dateMarker\n      });\n    }\n  }; // Given a duration singular unit, like \"week\" or \"day\", finds a matching view spec.\n  // Preference is given to views that have corresponding buttons.\n\n\n  Calendar.prototype.getUnitViewSpec = function (unit) {\n    var component = this.component;\n    var viewTypes = [];\n    var i;\n    var spec; // put views that have buttons first. there will be duplicates, but oh\n\n    if (component.header) {\n      viewTypes.push.apply(viewTypes, component.header.viewsWithButtons);\n    }\n\n    if (component.footer) {\n      viewTypes.push.apply(viewTypes, component.footer.viewsWithButtons);\n    }\n\n    for (var viewType in this.viewSpecs) {\n      viewTypes.push(viewType);\n    }\n\n    for (i = 0; i < viewTypes.length; i++) {\n      spec = this.viewSpecs[viewTypes[i]];\n\n      if (spec) {\n        if (spec.singleUnit === unit) {\n          return spec;\n        }\n      }\n    }\n  }; // Current Date\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  Calendar.prototype.getInitialDate = function () {\n    var defaultDateInput = this.opt('defaultDate'); // compute the initial ambig-timezone date\n\n    if (defaultDateInput != null) {\n      return this.dateEnv.createMarker(defaultDateInput);\n    } else {\n      return this.getNow(); // getNow already returns unzoned\n    }\n  };\n\n  Calendar.prototype.prev = function () {\n    this.unselect();\n    this.dispatch({\n      type: 'PREV'\n    });\n  };\n\n  Calendar.prototype.next = function () {\n    this.unselect();\n    this.dispatch({\n      type: 'NEXT'\n    });\n  };\n\n  Calendar.prototype.prevYear = function () {\n    this.unselect();\n    this.dispatch({\n      type: 'SET_DATE',\n      dateMarker: this.dateEnv.addYears(this.state.currentDate, -1)\n    });\n  };\n\n  Calendar.prototype.nextYear = function () {\n    this.unselect();\n    this.dispatch({\n      type: 'SET_DATE',\n      dateMarker: this.dateEnv.addYears(this.state.currentDate, 1)\n    });\n  };\n\n  Calendar.prototype.today = function () {\n    this.unselect();\n    this.dispatch({\n      type: 'SET_DATE',\n      dateMarker: this.getNow()\n    });\n  };\n\n  Calendar.prototype.gotoDate = function (zonedDateInput) {\n    this.unselect();\n    this.dispatch({\n      type: 'SET_DATE',\n      dateMarker: this.dateEnv.createMarker(zonedDateInput)\n    });\n  };\n\n  Calendar.prototype.incrementDate = function (deltaInput) {\n    var delta = createDuration(deltaInput);\n\n    if (delta) {\n      // else, warn about invalid input?\n      this.unselect();\n      this.dispatch({\n        type: 'SET_DATE',\n        dateMarker: this.dateEnv.add(this.state.currentDate, delta)\n      });\n    }\n  }; // for external API\n\n\n  Calendar.prototype.getDate = function () {\n    return this.dateEnv.toDate(this.state.currentDate);\n  }; // Date Formatting Utils\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  Calendar.prototype.formatDate = function (d, formatter) {\n    var dateEnv = this.dateEnv;\n    return dateEnv.format(dateEnv.createMarker(d), createFormatter(formatter));\n  }; // `settings` is for formatter AND isEndExclusive\n\n\n  Calendar.prototype.formatRange = function (d0, d1, settings) {\n    var dateEnv = this.dateEnv;\n    return dateEnv.formatRange(dateEnv.createMarker(d0), dateEnv.createMarker(d1), createFormatter(settings, this.opt('defaultRangeSeparator')), settings);\n  };\n\n  Calendar.prototype.formatIso = function (d, omitTime) {\n    var dateEnv = this.dateEnv;\n    return dateEnv.formatIso(dateEnv.createMarker(d), {\n      omitTime: omitTime\n    });\n  }; // Sizing\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  Calendar.prototype.windowResize = function (ev) {\n    if (!this.isHandlingWindowResize && this.component && // why?\n    ev.target === window // not a jqui resize event\n    ) {\n        this.isHandlingWindowResize = true;\n        this.updateSize();\n        this.publiclyTrigger('windowResize', [this.view]);\n        this.isHandlingWindowResize = false;\n      }\n  };\n\n  Calendar.prototype.updateSize = function () {\n    if (this.component) {\n      // when?\n      this.component.updateSize(true);\n    }\n  }; // Component Registration\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  Calendar.prototype.registerInteractiveComponent = function (component, settingsInput) {\n    var settings = parseInteractionSettings(component, settingsInput);\n    var DEFAULT_INTERACTIONS = [EventClicking, EventHovering];\n    var interactionClasses = DEFAULT_INTERACTIONS.concat(this.pluginSystem.hooks.componentInteractions);\n    var interactions = interactionClasses.map(function (interactionClass) {\n      return new interactionClass(settings);\n    });\n    this.interactionsStore[component.uid] = interactions;\n    interactionSettingsStore[component.uid] = settings;\n  };\n\n  Calendar.prototype.unregisterInteractiveComponent = function (component) {\n    for (var _i = 0, _a = this.interactionsStore[component.uid]; _i < _a.length; _i++) {\n      var listener = _a[_i];\n      listener.destroy();\n    }\n\n    delete this.interactionsStore[component.uid];\n    delete interactionSettingsStore[component.uid];\n  }; // Date Selection / Event Selection / DayClick\n  // -----------------------------------------------------------------------------------------------------------------\n  // this public method receives start/end dates in any format, with any timezone\n  // NOTE: args were changed from v3\n\n\n  Calendar.prototype.select = function (dateOrObj, endDate) {\n    var selectionInput;\n\n    if (endDate == null) {\n      if (dateOrObj.start != null) {\n        selectionInput = dateOrObj;\n      } else {\n        selectionInput = {\n          start: dateOrObj,\n          end: null\n        };\n      }\n    } else {\n      selectionInput = {\n        start: dateOrObj,\n        end: endDate\n      };\n    }\n\n    var selection = parseDateSpan(selectionInput, this.dateEnv, createDuration({\n      days: 1\n    }) // TODO: cache this?\n    );\n\n    if (selection) {\n      // throw parse error otherwise?\n      this.dispatch({\n        type: 'SELECT_DATES',\n        selection: selection\n      });\n      this.triggerDateSelect(selection);\n    }\n  }; // public method\n\n\n  Calendar.prototype.unselect = function (pev) {\n    if (this.state.dateSelection) {\n      this.dispatch({\n        type: 'UNSELECT_DATES'\n      });\n      this.triggerDateUnselect(pev);\n    }\n  };\n\n  Calendar.prototype.triggerDateSelect = function (selection, pev) {\n    var arg = _assign({}, this.buildDateSpanApi(selection), {\n      jsEvent: pev ? pev.origEvent : null,\n      view: this.view\n    });\n\n    this.publiclyTrigger('select', [arg]);\n  };\n\n  Calendar.prototype.triggerDateUnselect = function (pev) {\n    this.publiclyTrigger('unselect', [{\n      jsEvent: pev ? pev.origEvent : null,\n      view: this.view\n    }]);\n  }; // TODO: receive pev?\n\n\n  Calendar.prototype.triggerDateClick = function (dateSpan, dayEl, view, ev) {\n    var arg = _assign({}, this.buildDatePointApi(dateSpan), {\n      dayEl: dayEl,\n      jsEvent: ev,\n      // Is this always a mouse event? See #4655\n      view: view\n    });\n\n    this.publiclyTrigger('dateClick', [arg]);\n  };\n\n  Calendar.prototype.buildDatePointApi = function (dateSpan) {\n    var props = {};\n\n    for (var _i = 0, _a = this.pluginSystem.hooks.datePointTransforms; _i < _a.length; _i++) {\n      var transform = _a[_i];\n\n      _assign(props, transform(dateSpan, this));\n    }\n\n    _assign(props, buildDatePointApi(dateSpan, this.dateEnv));\n\n    return props;\n  };\n\n  Calendar.prototype.buildDateSpanApi = function (dateSpan) {\n    var props = {};\n\n    for (var _i = 0, _a = this.pluginSystem.hooks.dateSpanTransforms; _i < _a.length; _i++) {\n      var transform = _a[_i];\n\n      _assign(props, transform(dateSpan, this));\n    }\n\n    _assign(props, buildDateSpanApi(dateSpan, this.dateEnv));\n\n    return props;\n  }; // Date Utils\n  // -----------------------------------------------------------------------------------------------------------------\n  // Returns a DateMarker for the current date, as defined by the client's computer or from the `now` option\n\n\n  Calendar.prototype.getNow = function () {\n    var now = this.opt('now');\n\n    if (typeof now === 'function') {\n      now = now();\n    }\n\n    if (now == null) {\n      return this.dateEnv.createNowMarker();\n    }\n\n    return this.dateEnv.createMarker(now);\n  }; // Event-Date Utilities\n  // -----------------------------------------------------------------------------------------------------------------\n  // Given an event's allDay status and start date, return what its fallback end date should be.\n  // TODO: rename to computeDefaultEventEnd\n\n\n  Calendar.prototype.getDefaultEventEnd = function (allDay, marker) {\n    var end = marker;\n\n    if (allDay) {\n      end = startOfDay(end);\n      end = this.dateEnv.add(end, this.defaultAllDayEventDuration);\n    } else {\n      end = this.dateEnv.add(end, this.defaultTimedEventDuration);\n    }\n\n    return end;\n  }; // Public Events API\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  Calendar.prototype.addEvent = function (eventInput, sourceInput) {\n    if (eventInput instanceof EventApi) {\n      var def = eventInput._def;\n      var instance = eventInput._instance; // not already present? don't want to add an old snapshot\n\n      if (!this.state.eventStore.defs[def.defId]) {\n        this.dispatch({\n          type: 'ADD_EVENTS',\n          eventStore: eventTupleToStore({\n            def: def,\n            instance: instance\n          }) // TODO: better util for two args?\n\n        });\n      }\n\n      return eventInput;\n    }\n\n    var sourceId;\n\n    if (sourceInput instanceof EventSourceApi) {\n      sourceId = sourceInput.internalEventSource.sourceId;\n    } else if (sourceInput != null) {\n      var sourceApi = this.getEventSourceById(sourceInput); // TODO: use an internal function\n\n      if (!sourceApi) {\n        console.warn('Could not find an event source with ID \"' + sourceInput + '\"'); // TODO: test\n\n        return null;\n      } else {\n        sourceId = sourceApi.internalEventSource.sourceId;\n      }\n    }\n\n    var tuple = parseEvent(eventInput, sourceId, this);\n\n    if (tuple) {\n      this.dispatch({\n        type: 'ADD_EVENTS',\n        eventStore: eventTupleToStore(tuple)\n      });\n      return new EventApi(this, tuple.def, tuple.def.recurringDef ? null : tuple.instance);\n    }\n\n    return null;\n  }; // TODO: optimize\n\n\n  Calendar.prototype.getEventById = function (id) {\n    var _a = this.state.eventStore,\n        defs = _a.defs,\n        instances = _a.instances;\n    id = String(id);\n\n    for (var defId in defs) {\n      var def = defs[defId];\n\n      if (def.publicId === id) {\n        if (def.recurringDef) {\n          return new EventApi(this, def, null);\n        } else {\n          for (var instanceId in instances) {\n            var instance = instances[instanceId];\n\n            if (instance.defId === def.defId) {\n              return new EventApi(this, def, instance);\n            }\n          }\n        }\n      }\n    }\n\n    return null;\n  };\n\n  Calendar.prototype.getEvents = function () {\n    var _a = this.state.eventStore,\n        defs = _a.defs,\n        instances = _a.instances;\n    var eventApis = [];\n\n    for (var id in instances) {\n      var instance = instances[id];\n      var def = defs[instance.defId];\n      eventApis.push(new EventApi(this, def, instance));\n    }\n\n    return eventApis;\n  };\n\n  Calendar.prototype.removeAllEvents = function () {\n    this.dispatch({\n      type: 'REMOVE_ALL_EVENTS'\n    });\n  };\n\n  Calendar.prototype.rerenderEvents = function () {\n    this.dispatch({\n      type: 'RESET_EVENTS'\n    });\n  }; // Public Event Sources API\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  Calendar.prototype.getEventSources = function () {\n    var sourceHash = this.state.eventSources;\n    var sourceApis = [];\n\n    for (var internalId in sourceHash) {\n      sourceApis.push(new EventSourceApi(this, sourceHash[internalId]));\n    }\n\n    return sourceApis;\n  };\n\n  Calendar.prototype.getEventSourceById = function (id) {\n    var sourceHash = this.state.eventSources;\n    id = String(id);\n\n    for (var sourceId in sourceHash) {\n      if (sourceHash[sourceId].publicId === id) {\n        return new EventSourceApi(this, sourceHash[sourceId]);\n      }\n    }\n\n    return null;\n  };\n\n  Calendar.prototype.addEventSource = function (sourceInput) {\n    if (sourceInput instanceof EventSourceApi) {\n      // not already present? don't want to add an old snapshot\n      if (!this.state.eventSources[sourceInput.internalEventSource.sourceId]) {\n        this.dispatch({\n          type: 'ADD_EVENT_SOURCES',\n          sources: [sourceInput.internalEventSource]\n        });\n      }\n\n      return sourceInput;\n    }\n\n    var eventSource = parseEventSource(sourceInput, this);\n\n    if (eventSource) {\n      // TODO: error otherwise?\n      this.dispatch({\n        type: 'ADD_EVENT_SOURCES',\n        sources: [eventSource]\n      });\n      return new EventSourceApi(this, eventSource);\n    }\n\n    return null;\n  };\n\n  Calendar.prototype.removeAllEventSources = function () {\n    this.dispatch({\n      type: 'REMOVE_ALL_EVENT_SOURCES'\n    });\n  };\n\n  Calendar.prototype.refetchEvents = function () {\n    this.dispatch({\n      type: 'FETCH_EVENT_SOURCES'\n    });\n  }; // Scroll\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  Calendar.prototype.scrollToTime = function (timeInput) {\n    var duration = createDuration(timeInput);\n\n    if (duration) {\n      this.component.view.scrollToDuration(duration);\n    }\n  };\n\n  return Calendar;\n}();\n\nEmitterMixin.mixInto(Calendar); // for memoizers\n// -----------------------------------------------------------------------------------------------------------------\n\nfunction buildDateEnv(locale, timeZone, namedTimeZoneImpl, firstDay, weekNumberCalculation, weekLabel, cmdFormatter) {\n  return new DateEnv({\n    calendarSystem: 'gregory',\n    timeZone: timeZone,\n    namedTimeZoneImpl: namedTimeZoneImpl,\n    locale: locale,\n    weekNumberCalculation: weekNumberCalculation,\n    firstDay: firstDay,\n    weekLabel: weekLabel,\n    cmdFormatter: cmdFormatter\n  });\n}\n\nfunction buildTheme(calendarOptions) {\n  var themeClass = this.pluginSystem.hooks.themeClasses[calendarOptions.themeSystem] || StandardTheme;\n  return new themeClass(calendarOptions);\n}\n\nfunction buildDelayedRerender(wait) {\n  var func = this.tryRerender.bind(this);\n\n  if (wait != null) {\n    func = debounce(func, wait);\n  }\n\n  return func;\n}\n\nfunction buildEventUiBySource(eventSources) {\n  return mapHash(eventSources, function (eventSource) {\n    return eventSource.ui;\n  });\n}\n\nfunction buildEventUiBases(eventDefs, eventUiSingleBase, eventUiBySource) {\n  var eventUiBases = {\n    '': eventUiSingleBase\n  };\n\n  for (var defId in eventDefs) {\n    var def = eventDefs[defId];\n\n    if (def.sourceId && eventUiBySource[def.sourceId]) {\n      eventUiBases[defId] = eventUiBySource[def.sourceId];\n    }\n  }\n\n  return eventUiBases;\n}\n\nvar View =\n/** @class */\nfunction (_super) {\n  __extends(View, _super);\n\n  function View(context, viewSpec, dateProfileGenerator, parentEl) {\n    var _this = _super.call(this, context, createElement('div', {\n      className: 'fc-view fc-' + viewSpec.type + '-view'\n    }), true // isView (HACK)\n    ) || this;\n\n    _this.renderDatesMem = memoizeRendering(_this.renderDatesWrap, _this.unrenderDatesWrap);\n    _this.renderBusinessHoursMem = memoizeRendering(_this.renderBusinessHours, _this.unrenderBusinessHours, [_this.renderDatesMem]);\n    _this.renderDateSelectionMem = memoizeRendering(_this.renderDateSelectionWrap, _this.unrenderDateSelectionWrap, [_this.renderDatesMem]);\n    _this.renderEventsMem = memoizeRendering(_this.renderEvents, _this.unrenderEvents, [_this.renderDatesMem]);\n    _this.renderEventSelectionMem = memoizeRendering(_this.renderEventSelectionWrap, _this.unrenderEventSelectionWrap, [_this.renderEventsMem]);\n    _this.renderEventDragMem = memoizeRendering(_this.renderEventDragWrap, _this.unrenderEventDragWrap, [_this.renderDatesMem]);\n    _this.renderEventResizeMem = memoizeRendering(_this.renderEventResizeWrap, _this.unrenderEventResizeWrap, [_this.renderDatesMem]);\n    _this.viewSpec = viewSpec;\n    _this.dateProfileGenerator = dateProfileGenerator;\n    _this.type = viewSpec.type;\n    _this.eventOrderSpecs = parseFieldSpecs(_this.opt('eventOrder'));\n    _this.nextDayThreshold = createDuration(_this.opt('nextDayThreshold'));\n    parentEl.appendChild(_this.el);\n\n    _this.initialize();\n\n    return _this;\n  }\n\n  View.prototype.initialize = function () {};\n\n  Object.defineProperty(View.prototype, \"activeStart\", {\n    // Date Setting/Unsetting\n    // -----------------------------------------------------------------------------------------------------------------\n    get: function get() {\n      return this.dateEnv.toDate(this.props.dateProfile.activeRange.start);\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(View.prototype, \"activeEnd\", {\n    get: function get() {\n      return this.dateEnv.toDate(this.props.dateProfile.activeRange.end);\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(View.prototype, \"currentStart\", {\n    get: function get() {\n      return this.dateEnv.toDate(this.props.dateProfile.currentRange.start);\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(View.prototype, \"currentEnd\", {\n    get: function get() {\n      return this.dateEnv.toDate(this.props.dateProfile.currentRange.end);\n    },\n    enumerable: true,\n    configurable: true\n  }); // General Rendering\n  // -----------------------------------------------------------------------------------------------------------------\n\n  View.prototype.render = function (props) {\n    this.renderDatesMem(props.dateProfile);\n    this.renderBusinessHoursMem(props.businessHours);\n    this.renderDateSelectionMem(props.dateSelection);\n    this.renderEventsMem(props.eventStore);\n    this.renderEventSelectionMem(props.eventSelection);\n    this.renderEventDragMem(props.eventDrag);\n    this.renderEventResizeMem(props.eventResize);\n  };\n\n  View.prototype.destroy = function () {\n    _super.prototype.destroy.call(this);\n\n    this.renderDatesMem.unrender(); // should unrender everything else\n  }; // Sizing\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  View.prototype.updateSize = function (isResize, viewHeight, isAuto) {\n    var calendar = this.calendar;\n\n    if (isResize || // HACKS...\n    calendar.isViewUpdated || calendar.isDatesUpdated || calendar.isEventsUpdated) {\n      // sort of the catch-all sizing\n      // anything that might cause dimension changes\n      this.updateBaseSize(isResize, viewHeight, isAuto);\n    }\n  };\n\n  View.prototype.updateBaseSize = function (isResize, viewHeight, isAuto) {}; // Date Rendering\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  View.prototype.renderDatesWrap = function (dateProfile) {\n    this.renderDates(dateProfile);\n    this.addScroll({\n      duration: createDuration(this.opt('scrollTime'))\n    });\n    this.startNowIndicator(dateProfile); // shouldn't render yet because updateSize will be called soon\n  };\n\n  View.prototype.unrenderDatesWrap = function () {\n    this.stopNowIndicator();\n    this.unrenderDates();\n  };\n\n  View.prototype.renderDates = function (dateProfile) {};\n\n  View.prototype.unrenderDates = function () {}; // Business Hours\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  View.prototype.renderBusinessHours = function (businessHours) {};\n\n  View.prototype.unrenderBusinessHours = function () {}; // Date Selection\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  View.prototype.renderDateSelectionWrap = function (selection) {\n    if (selection) {\n      this.renderDateSelection(selection);\n    }\n  };\n\n  View.prototype.unrenderDateSelectionWrap = function (selection) {\n    if (selection) {\n      this.unrenderDateSelection(selection);\n    }\n  };\n\n  View.prototype.renderDateSelection = function (selection) {};\n\n  View.prototype.unrenderDateSelection = function (selection) {}; // Event Rendering\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  View.prototype.renderEvents = function (eventStore) {};\n\n  View.prototype.unrenderEvents = function () {}; // util for subclasses\n\n\n  View.prototype.sliceEvents = function (eventStore, allDay) {\n    var props = this.props;\n    return sliceEventStore(eventStore, props.eventUiBases, props.dateProfile.activeRange, allDay ? this.nextDayThreshold : null).fg;\n  };\n\n  View.prototype.computeEventDraggable = function (eventDef, eventUi) {\n    var transformers = this.calendar.pluginSystem.hooks.isDraggableTransformers;\n    var val = eventUi.startEditable;\n\n    for (var _i = 0, transformers_1 = transformers; _i < transformers_1.length; _i++) {\n      var transformer = transformers_1[_i];\n      val = transformer(val, eventDef, eventUi, this);\n    }\n\n    return val;\n  };\n\n  View.prototype.computeEventStartResizable = function (eventDef, eventUi) {\n    return eventUi.durationEditable && this.opt('eventResizableFromStart');\n  };\n\n  View.prototype.computeEventEndResizable = function (eventDef, eventUi) {\n    return eventUi.durationEditable;\n  }; // Event Selection\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  View.prototype.renderEventSelectionWrap = function (instanceId) {\n    if (instanceId) {\n      this.renderEventSelection(instanceId);\n    }\n  };\n\n  View.prototype.unrenderEventSelectionWrap = function (instanceId) {\n    if (instanceId) {\n      this.unrenderEventSelection(instanceId);\n    }\n  };\n\n  View.prototype.renderEventSelection = function (instanceId) {};\n\n  View.prototype.unrenderEventSelection = function (instanceId) {}; // Event Drag\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  View.prototype.renderEventDragWrap = function (state) {\n    if (state) {\n      this.renderEventDrag(state);\n    }\n  };\n\n  View.prototype.unrenderEventDragWrap = function (state) {\n    if (state) {\n      this.unrenderEventDrag(state);\n    }\n  };\n\n  View.prototype.renderEventDrag = function (state) {};\n\n  View.prototype.unrenderEventDrag = function (state) {}; // Event Resize\n  // -----------------------------------------------------------------------------------------------------------------\n\n\n  View.prototype.renderEventResizeWrap = function (state) {\n    if (state) {\n      this.renderEventResize(state);\n    }\n  };\n\n  View.prototype.unrenderEventResizeWrap = function (state) {\n    if (state) {\n      this.unrenderEventResize(state);\n    }\n  };\n\n  View.prototype.renderEventResize = function (state) {};\n\n  View.prototype.unrenderEventResize = function (state) {};\n  /* Now Indicator\r\n  ------------------------------------------------------------------------------------------------------------------*/\n  // Immediately render the current time indicator and begins re-rendering it at an interval,\n  // which is defined by this.getNowIndicatorUnit().\n  // TODO: somehow do this for the current whole day's background too\n\n\n  View.prototype.startNowIndicator = function (dateProfile) {\n    var _this = this;\n\n    var dateEnv = this.dateEnv;\n    var unit;\n    var update;\n    var delay; // ms wait value\n\n    if (this.opt('nowIndicator')) {\n      unit = this.getNowIndicatorUnit(dateProfile);\n\n      if (unit) {\n        update = this.updateNowIndicator.bind(this);\n        this.initialNowDate = this.calendar.getNow();\n        this.initialNowQueriedMs = new Date().valueOf(); // wait until the beginning of the next interval\n\n        delay = dateEnv.add(dateEnv.startOf(this.initialNowDate, unit), createDuration(1, unit)).valueOf() - this.initialNowDate.valueOf(); // TODO: maybe always use setTimeout, waiting until start of next unit\n\n        this.nowIndicatorTimeoutID = setTimeout(function () {\n          _this.nowIndicatorTimeoutID = null;\n          update();\n\n          if (unit === 'second') {\n            delay = 1000; // every second\n          } else {\n            delay = 1000 * 60; // otherwise, every minute\n          }\n\n          _this.nowIndicatorIntervalID = setInterval(update, delay); // update every interval\n        }, delay);\n      } // rendering will be initiated in updateSize\n\n    }\n  }; // rerenders the now indicator, computing the new current time from the amount of time that has passed\n  // since the initial getNow call.\n\n\n  View.prototype.updateNowIndicator = function () {\n    if (this.props.dateProfile && // a way to determine if dates were rendered yet\n    this.initialNowDate // activated before?\n    ) {\n        this.unrenderNowIndicator(); // won't unrender if unnecessary\n\n        this.renderNowIndicator(addMs(this.initialNowDate, new Date().valueOf() - this.initialNowQueriedMs));\n        this.isNowIndicatorRendered = true;\n      }\n  }; // Immediately unrenders the view's current time indicator and stops any re-rendering timers.\n  // Won't cause side effects if indicator isn't rendered.\n\n\n  View.prototype.stopNowIndicator = function () {\n    if (this.isNowIndicatorRendered) {\n      if (this.nowIndicatorTimeoutID) {\n        clearTimeout(this.nowIndicatorTimeoutID);\n        this.nowIndicatorTimeoutID = null;\n      }\n\n      if (this.nowIndicatorIntervalID) {\n        clearInterval(this.nowIndicatorIntervalID);\n        this.nowIndicatorIntervalID = null;\n      }\n\n      this.unrenderNowIndicator();\n      this.isNowIndicatorRendered = false;\n    }\n  };\n\n  View.prototype.getNowIndicatorUnit = function (dateProfile) {// subclasses should implement\n  }; // Renders a current time indicator at the given datetime\n\n\n  View.prototype.renderNowIndicator = function (date) {// SUBCLASSES MUST PASS TO CHILDREN!\n  }; // Undoes the rendering actions from renderNowIndicator\n\n\n  View.prototype.unrenderNowIndicator = function () {// SUBCLASSES MUST PASS TO CHILDREN!\n  };\n  /* Scroller\r\n  ------------------------------------------------------------------------------------------------------------------*/\n\n\n  View.prototype.addScroll = function (scroll) {\n    var queuedScroll = this.queuedScroll || (this.queuedScroll = {});\n\n    _assign(queuedScroll, scroll);\n  };\n\n  View.prototype.popScroll = function (isResize) {\n    this.applyQueuedScroll(isResize);\n    this.queuedScroll = null;\n  };\n\n  View.prototype.applyQueuedScroll = function (isResize) {\n    this.applyScroll(this.queuedScroll || {}, isResize);\n  };\n\n  View.prototype.queryScroll = function () {\n    var scroll = {};\n\n    if (this.props.dateProfile) {\n      // dates rendered yet?\n      _assign(scroll, this.queryDateScroll());\n    }\n\n    return scroll;\n  };\n\n  View.prototype.applyScroll = function (scroll, isResize) {\n    var duration = scroll.duration;\n\n    if (duration != null) {\n      delete scroll.duration;\n\n      if (this.props.dateProfile) {\n        // dates rendered yet?\n        _assign(scroll, this.computeDateScroll(duration));\n      }\n    }\n\n    if (this.props.dateProfile) {\n      // dates rendered yet?\n      this.applyDateScroll(scroll);\n    }\n  };\n\n  View.prototype.computeDateScroll = function (duration) {\n    return {}; // subclasses must implement\n  };\n\n  View.prototype.queryDateScroll = function () {\n    return {}; // subclasses must implement\n  };\n\n  View.prototype.applyDateScroll = function (scroll) {// subclasses must implement\n  }; // for API\n\n\n  View.prototype.scrollToDuration = function (duration) {\n    this.applyScroll({\n      duration: duration\n    }, false);\n  };\n\n  return View;\n}(DateComponent);\n\nEmitterMixin.mixInto(View);\nView.prototype.usesMinMaxTime = false;\nView.prototype.dateProfileGeneratorClass = DateProfileGenerator;\n\nvar FgEventRenderer =\n/** @class */\nfunction () {\n  function FgEventRenderer(context) {\n    this.segs = [];\n    this.isSizeDirty = false;\n    this.context = context;\n  }\n\n  FgEventRenderer.prototype.renderSegs = function (segs, mirrorInfo) {\n    this.rangeUpdated(); // called too frequently :(\n    // render an `.el` on each seg\n    // returns a subset of the segs. segs that were actually rendered\n\n    segs = this.renderSegEls(segs, mirrorInfo);\n    this.segs = segs;\n    this.attachSegs(segs, mirrorInfo);\n    this.isSizeDirty = true;\n    this.context.view.triggerRenderedSegs(this.segs, Boolean(mirrorInfo));\n  };\n\n  FgEventRenderer.prototype.unrender = function (_segs, mirrorInfo) {\n    this.context.view.triggerWillRemoveSegs(this.segs, Boolean(mirrorInfo));\n    this.detachSegs(this.segs);\n    this.segs = [];\n  }; // Updates values that rely on options and also relate to range\n\n\n  FgEventRenderer.prototype.rangeUpdated = function () {\n    var options = this.context.options;\n    var displayEventTime;\n    var displayEventEnd;\n    this.eventTimeFormat = createFormatter(options.eventTimeFormat || this.computeEventTimeFormat(), options.defaultRangeSeparator);\n    displayEventTime = options.displayEventTime;\n\n    if (displayEventTime == null) {\n      displayEventTime = this.computeDisplayEventTime(); // might be based off of range\n    }\n\n    displayEventEnd = options.displayEventEnd;\n\n    if (displayEventEnd == null) {\n      displayEventEnd = this.computeDisplayEventEnd(); // might be based off of range\n    }\n\n    this.displayEventTime = displayEventTime;\n    this.displayEventEnd = displayEventEnd;\n  }; // Renders and assigns an `el` property for each foreground event segment.\n  // Only returns segments that successfully rendered.\n\n\n  FgEventRenderer.prototype.renderSegEls = function (segs, mirrorInfo) {\n    var html = '';\n    var i;\n\n    if (segs.length) {\n      // don't build an empty html string\n      // build a large concatenation of event segment HTML\n      for (i = 0; i < segs.length; i++) {\n        html += this.renderSegHtml(segs[i], mirrorInfo);\n      } // Grab individual elements from the combined HTML string. Use each as the default rendering.\n      // Then, compute the 'el' for each segment. An el might be null if the eventRender callback returned false.\n\n\n      htmlToElements(html).forEach(function (el, i) {\n        var seg = segs[i];\n\n        if (el) {\n          seg.el = el;\n        }\n      });\n      segs = filterSegsViaEls(this.context.view, segs, Boolean(mirrorInfo));\n    }\n\n    return segs;\n  }; // Generic utility for generating the HTML classNames for an event segment's element\n\n\n  FgEventRenderer.prototype.getSegClasses = function (seg, isDraggable, isResizable, mirrorInfo) {\n    var classes = ['fc-event', seg.isStart ? 'fc-start' : 'fc-not-start', seg.isEnd ? 'fc-end' : 'fc-not-end'].concat(seg.eventRange.ui.classNames);\n\n    if (isDraggable) {\n      classes.push('fc-draggable');\n    }\n\n    if (isResizable) {\n      classes.push('fc-resizable');\n    }\n\n    if (mirrorInfo) {\n      classes.push('fc-mirror');\n\n      if (mirrorInfo.isDragging) {\n        classes.push('fc-dragging');\n      }\n\n      if (mirrorInfo.isResizing) {\n        classes.push('fc-resizing');\n      }\n    }\n\n    return classes;\n  }; // Compute the text that should be displayed on an event's element.\n  // `range` can be the Event object itself, or something range-like, with at least a `start`.\n  // If event times are disabled, or the event has no time, will return a blank string.\n  // If not specified, formatter will default to the eventTimeFormat setting,\n  // and displayEnd will default to the displayEventEnd setting.\n\n\n  FgEventRenderer.prototype.getTimeText = function (eventRange, formatter, displayEnd) {\n    var def = eventRange.def,\n        instance = eventRange.instance;\n    return this._getTimeText(instance.range.start, def.hasEnd ? instance.range.end : null, def.allDay, formatter, displayEnd, instance.forcedStartTzo, instance.forcedEndTzo);\n  };\n\n  FgEventRenderer.prototype._getTimeText = function (start, end, allDay, formatter, displayEnd, forcedStartTzo, forcedEndTzo) {\n    var dateEnv = this.context.dateEnv;\n\n    if (formatter == null) {\n      formatter = this.eventTimeFormat;\n    }\n\n    if (displayEnd == null) {\n      displayEnd = this.displayEventEnd;\n    }\n\n    if (this.displayEventTime && !allDay) {\n      if (displayEnd && end) {\n        return dateEnv.formatRange(start, end, formatter, {\n          forcedStartTzo: forcedStartTzo,\n          forcedEndTzo: forcedEndTzo\n        });\n      } else {\n        return dateEnv.format(start, formatter, {\n          forcedTzo: forcedStartTzo\n        });\n      }\n    }\n\n    return '';\n  };\n\n  FgEventRenderer.prototype.computeEventTimeFormat = function () {\n    return {\n      hour: 'numeric',\n      minute: '2-digit',\n      omitZeroMinute: true\n    };\n  };\n\n  FgEventRenderer.prototype.computeDisplayEventTime = function () {\n    return true;\n  };\n\n  FgEventRenderer.prototype.computeDisplayEventEnd = function () {\n    return true;\n  }; // Utility for generating event skin-related CSS properties\n\n\n  FgEventRenderer.prototype.getSkinCss = function (ui) {\n    return {\n      'background-color': ui.backgroundColor,\n      'border-color': ui.borderColor,\n      color: ui.textColor\n    };\n  };\n\n  FgEventRenderer.prototype.sortEventSegs = function (segs) {\n    var specs = this.context.view.eventOrderSpecs;\n    var objs = segs.map(buildSegCompareObj);\n    objs.sort(function (obj0, obj1) {\n      return compareByFieldSpecs(obj0, obj1, specs);\n    });\n    return objs.map(function (c) {\n      return c._seg;\n    });\n  };\n\n  FgEventRenderer.prototype.computeSizes = function (force) {\n    if (force || this.isSizeDirty) {\n      this.computeSegSizes(this.segs);\n    }\n  };\n\n  FgEventRenderer.prototype.assignSizes = function (force) {\n    if (force || this.isSizeDirty) {\n      this.assignSegSizes(this.segs);\n      this.isSizeDirty = false;\n    }\n  };\n\n  FgEventRenderer.prototype.computeSegSizes = function (segs) {};\n\n  FgEventRenderer.prototype.assignSegSizes = function (segs) {}; // Manipulation on rendered segs\n\n\n  FgEventRenderer.prototype.hideByHash = function (hash) {\n    if (hash) {\n      for (var _i = 0, _a = this.segs; _i < _a.length; _i++) {\n        var seg = _a[_i];\n\n        if (hash[seg.eventRange.instance.instanceId]) {\n          seg.el.style.visibility = 'hidden';\n        }\n      }\n    }\n  };\n\n  FgEventRenderer.prototype.showByHash = function (hash) {\n    if (hash) {\n      for (var _i = 0, _a = this.segs; _i < _a.length; _i++) {\n        var seg = _a[_i];\n\n        if (hash[seg.eventRange.instance.instanceId]) {\n          seg.el.style.visibility = '';\n        }\n      }\n    }\n  };\n\n  FgEventRenderer.prototype.selectByInstanceId = function (instanceId) {\n    if (instanceId) {\n      for (var _i = 0, _a = this.segs; _i < _a.length; _i++) {\n        var seg = _a[_i];\n        var eventInstance = seg.eventRange.instance;\n\n        if (eventInstance && eventInstance.instanceId === instanceId && seg.el // necessary?\n        ) {\n            seg.el.classList.add('fc-selected');\n          }\n      }\n    }\n  };\n\n  FgEventRenderer.prototype.unselectByInstanceId = function (instanceId) {\n    if (instanceId) {\n      for (var _i = 0, _a = this.segs; _i < _a.length; _i++) {\n        var seg = _a[_i];\n\n        if (seg.el) {\n          // necessary?\n          seg.el.classList.remove('fc-selected');\n        }\n      }\n    }\n  };\n\n  return FgEventRenderer;\n}(); // returns a object with all primitive props that can be compared\n\n\nfunction buildSegCompareObj(seg) {\n  var eventDef = seg.eventRange.def;\n  var range = seg.eventRange.instance.range;\n  var start = range.start ? range.start.valueOf() : 0; // TODO: better support for open-range events\n\n  var end = range.end ? range.end.valueOf() : 0; // \"\n\n  return _assign({}, eventDef.extendedProps, eventDef, {\n    id: eventDef.publicId,\n    start: start,\n    end: end,\n    duration: end - start,\n    allDay: Number(eventDef.allDay),\n    _seg: seg // for later retrieval\n\n  });\n}\n\nvar FillRenderer =\n/** @class */\nfunction () {\n  function FillRenderer(context) {\n    this.fillSegTag = 'div';\n    this.dirtySizeFlags = {};\n    this.context = context;\n    this.containerElsByType = {};\n    this.segsByType = {};\n  }\n\n  FillRenderer.prototype.getSegsByType = function (type) {\n    return this.segsByType[type] || [];\n  };\n\n  FillRenderer.prototype.renderSegs = function (type, segs) {\n    var _a;\n\n    var renderedSegs = this.renderSegEls(type, segs); // assignes `.el` to each seg. returns successfully rendered segs\n\n    var containerEls = this.attachSegs(type, renderedSegs);\n\n    if (containerEls) {\n      (_a = this.containerElsByType[type] || (this.containerElsByType[type] = [])).push.apply(_a, containerEls);\n    }\n\n    this.segsByType[type] = renderedSegs;\n\n    if (type === 'bgEvent') {\n      this.context.view.triggerRenderedSegs(renderedSegs, false); // isMirror=false\n    }\n\n    this.dirtySizeFlags[type] = true;\n  }; // Unrenders a specific type of fill that is currently rendered on the grid\n\n\n  FillRenderer.prototype.unrender = function (type) {\n    var segs = this.segsByType[type];\n\n    if (segs) {\n      if (type === 'bgEvent') {\n        this.context.view.triggerWillRemoveSegs(segs, false); // isMirror=false\n      }\n\n      this.detachSegs(type, segs);\n    }\n  }; // Renders and assigns an `el` property for each fill segment. Generic enough to work with different types.\n  // Only returns segments that successfully rendered.\n\n\n  FillRenderer.prototype.renderSegEls = function (type, segs) {\n    var _this = this;\n\n    var html = '';\n    var i;\n\n    if (segs.length) {\n      // build a large concatenation of segment HTML\n      for (i = 0; i < segs.length; i++) {\n        html += this.renderSegHtml(type, segs[i]);\n      } // Grab individual elements from the combined HTML string. Use each as the default rendering.\n      // Then, compute the 'el' for each segment.\n\n\n      htmlToElements(html).forEach(function (el, i) {\n        var seg = segs[i];\n\n        if (el) {\n          seg.el = el;\n        }\n      });\n\n      if (type === 'bgEvent') {\n        segs = filterSegsViaEls(this.context.view, segs, false // isMirror. background events can never be mirror elements\n        );\n      } // correct element type? (would be bad if a non-TD were inserted into a table for example)\n\n\n      segs = segs.filter(function (seg) {\n        return elementMatches(seg.el, _this.fillSegTag);\n      });\n    }\n\n    return segs;\n  }; // Builds the HTML needed for one fill segment. Generic enough to work with different types.\n\n\n  FillRenderer.prototype.renderSegHtml = function (type, seg) {\n    var css = null;\n    var classNames = [];\n\n    if (type !== 'highlight' && type !== 'businessHours') {\n      css = {\n        'background-color': seg.eventRange.ui.backgroundColor\n      };\n    }\n\n    if (type !== 'highlight') {\n      classNames = classNames.concat(seg.eventRange.ui.classNames);\n    }\n\n    if (type === 'businessHours') {\n      classNames.push('fc-bgevent');\n    } else {\n      classNames.push('fc-' + type.toLowerCase());\n    }\n\n    return '<' + this.fillSegTag + (classNames.length ? ' class=\"' + classNames.join(' ') + '\"' : '') + (css ? ' style=\"' + cssToStr(css) + '\"' : '') + '></' + this.fillSegTag + '>';\n  };\n\n  FillRenderer.prototype.detachSegs = function (type, segs) {\n    var containerEls = this.containerElsByType[type];\n\n    if (containerEls) {\n      containerEls.forEach(removeElement);\n      delete this.containerElsByType[type];\n    }\n  };\n\n  FillRenderer.prototype.computeSizes = function (force) {\n    for (var type in this.segsByType) {\n      if (force || this.dirtySizeFlags[type]) {\n        this.computeSegSizes(this.segsByType[type]);\n      }\n    }\n  };\n\n  FillRenderer.prototype.assignSizes = function (force) {\n    for (var type in this.segsByType) {\n      if (force || this.dirtySizeFlags[type]) {\n        this.assignSegSizes(this.segsByType[type]);\n      }\n    }\n\n    this.dirtySizeFlags = {};\n  };\n\n  FillRenderer.prototype.computeSegSizes = function (segs) {};\n\n  FillRenderer.prototype.assignSegSizes = function (segs) {};\n\n  return FillRenderer;\n}();\n\nvar NamedTimeZoneImpl =\n/** @class */\nfunction () {\n  function NamedTimeZoneImpl(timeZoneName) {\n    this.timeZoneName = timeZoneName;\n  }\n\n  return NamedTimeZoneImpl;\n}();\n/*\r\nAn abstraction for a dragging interaction originating on an event.\r\nDoes higher-level things than PointerDragger, such as possibly:\r\n- a \"mirror\" that moves with the pointer\r\n- a minimum number of pixels or other criteria for a true drag to begin\r\n\r\nsubclasses must emit:\r\n- pointerdown\r\n- dragstart\r\n- dragmove\r\n- pointerup\r\n- dragend\r\n*/\n\n\nvar ElementDragging =\n/** @class */\nfunction () {\n  function ElementDragging(el) {\n    this.emitter = new EmitterMixin();\n  }\n\n  ElementDragging.prototype.destroy = function () {};\n\n  ElementDragging.prototype.setMirrorIsVisible = function (bool) {// optional if subclass doesn't want to support a mirror\n  };\n\n  ElementDragging.prototype.setMirrorNeedsRevert = function (bool) {// optional if subclass doesn't want to support a mirror\n  };\n\n  ElementDragging.prototype.setAutoScrollEnabled = function (bool) {// optional\n  };\n\n  return ElementDragging;\n}();\n\nfunction formatDate(dateInput, settings) {\n  if (settings === void 0) {\n    settings = {};\n  }\n\n  var dateEnv = buildDateEnv$1(settings);\n  var formatter = createFormatter(settings);\n  var dateMeta = dateEnv.createMarkerMeta(dateInput);\n\n  if (!dateMeta) {\n    // TODO: warning?\n    return '';\n  }\n\n  return dateEnv.format(dateMeta.marker, formatter, {\n    forcedTzo: dateMeta.forcedTzo\n  });\n}\n\nfunction formatRange(startInput, endInput, settings // mixture of env and formatter settings\n) {\n  var dateEnv = buildDateEnv$1(typeof settings === 'object' && settings ? settings : {}); // pass in if non-null object\n\n  var formatter = createFormatter(settings, globalDefaults.defaultRangeSeparator);\n  var startMeta = dateEnv.createMarkerMeta(startInput);\n  var endMeta = dateEnv.createMarkerMeta(endInput);\n\n  if (!startMeta || !endMeta) {\n    // TODO: warning?\n    return '';\n  }\n\n  return dateEnv.formatRange(startMeta.marker, endMeta.marker, formatter, {\n    forcedStartTzo: startMeta.forcedTzo,\n    forcedEndTzo: endMeta.forcedTzo,\n    isEndExclusive: settings.isEndExclusive\n  });\n} // TODO: more DRY and optimized\n\n\nfunction buildDateEnv$1(settings) {\n  var locale = buildLocale(settings.locale || 'en', parseRawLocales([]).map); // TODO: don't hardcode 'en' everywhere\n  // ensure required settings\n\n  settings = _assign({\n    timeZone: globalDefaults.timeZone,\n    calendarSystem: 'gregory'\n  }, settings, {\n    locale: locale\n  });\n  return new DateEnv(settings);\n}\n\nvar DRAG_META_PROPS = {\n  startTime: createDuration,\n  duration: createDuration,\n  create: Boolean,\n  sourceId: String\n};\nvar DRAG_META_DEFAULTS = {\n  create: true\n};\n\nfunction parseDragMeta(raw) {\n  var leftoverProps = {};\n  var refined = refineProps(raw, DRAG_META_PROPS, DRAG_META_DEFAULTS, leftoverProps);\n  refined.leftoverProps = leftoverProps;\n  return refined;\n} // Computes a default column header formatting string if `colFormat` is not explicitly defined\n\n\nfunction computeFallbackHeaderFormat(datesRepDistinctDays, dayCnt) {\n  // if more than one week row, or if there are a lot of columns with not much space,\n  // put just the day numbers will be in each cell\n  if (!datesRepDistinctDays || dayCnt > 10) {\n    return {\n      weekday: 'short'\n    }; // \"Sat\"\n  } else if (dayCnt > 1) {\n    return {\n      weekday: 'short',\n      month: 'numeric',\n      day: 'numeric',\n      omitCommas: true\n    }; // \"Sat 11/12\"\n  } else {\n    return {\n      weekday: 'long'\n    }; // \"Saturday\"\n  }\n}\n\nfunction renderDateCell(dateMarker, dateProfile, datesRepDistinctDays, colCnt, colHeadFormat, context, colspan, otherAttrs) {\n  var view = context.view,\n      dateEnv = context.dateEnv,\n      theme = context.theme,\n      options = context.options;\n  var isDateValid = rangeContainsMarker(dateProfile.activeRange, dateMarker); // TODO: called too frequently. cache somehow.\n\n  var classNames = ['fc-day-header', theme.getClass('widgetHeader')];\n  var innerHtml;\n\n  if (typeof options.columnHeaderHtml === 'function') {\n    innerHtml = options.columnHeaderHtml(dateEnv.toDate(dateMarker));\n  } else if (typeof options.columnHeaderText === 'function') {\n    innerHtml = htmlEscape(options.columnHeaderText(dateEnv.toDate(dateMarker)));\n  } else {\n    innerHtml = htmlEscape(dateEnv.format(dateMarker, colHeadFormat));\n  } // if only one row of days, the classNames on the header can represent the specific days beneath\n\n\n  if (datesRepDistinctDays) {\n    classNames = classNames.concat( // includes the day-of-week class\n    // noThemeHighlight=true (don't highlight the header)\n    getDayClasses(dateMarker, dateProfile, context, true));\n  } else {\n    classNames.push('fc-' + DAY_IDS[dateMarker.getUTCDay()]); // only add the day-of-week class\n  }\n\n  return '' + '<th class=\"' + classNames.join(' ') + '\"' + (isDateValid && datesRepDistinctDays ? ' data-date=\"' + dateEnv.formatIso(dateMarker, {\n    omitTime: true\n  }) + '\"' : '') + (colspan > 1 ? ' colspan=\"' + colspan + '\"' : '') + (otherAttrs ? ' ' + otherAttrs : '') + '>' + (isDateValid ? // don't make a link if the heading could represent multiple days, or if there's only one day (forceOff)\n  buildGotoAnchorHtml(view, {\n    date: dateMarker,\n    forceOff: !datesRepDistinctDays || colCnt === 1\n  }, innerHtml) : // if not valid, display text, but no link\n  innerHtml) + '</th>';\n}\n\nvar DayHeader =\n/** @class */\nfunction (_super) {\n  __extends(DayHeader, _super);\n\n  function DayHeader(context, parentEl) {\n    var _this = _super.call(this, context) || this;\n\n    parentEl.innerHTML = ''; // because might be nbsp\n\n    parentEl.appendChild(_this.el = htmlToElement('<div class=\"fc-row ' + _this.theme.getClass('headerRow') + '\">' + '<table class=\"' + _this.theme.getClass('tableGrid') + '\">' + '<thead></thead>' + '</table>' + '</div>'));\n    _this.thead = _this.el.querySelector('thead');\n    return _this;\n  }\n\n  DayHeader.prototype.destroy = function () {\n    removeElement(this.el);\n  };\n\n  DayHeader.prototype.render = function (props) {\n    var dates = props.dates,\n        datesRepDistinctDays = props.datesRepDistinctDays;\n    var parts = [];\n\n    if (props.renderIntroHtml) {\n      parts.push(props.renderIntroHtml());\n    }\n\n    var colHeadFormat = createFormatter(this.opt('columnHeaderFormat') || computeFallbackHeaderFormat(datesRepDistinctDays, dates.length));\n\n    for (var _i = 0, dates_1 = dates; _i < dates_1.length; _i++) {\n      var date = dates_1[_i];\n      parts.push(renderDateCell(date, props.dateProfile, datesRepDistinctDays, dates.length, colHeadFormat, this.context));\n    }\n\n    if (this.isRtl) {\n      parts.reverse();\n    }\n\n    this.thead.innerHTML = '<tr>' + parts.join('') + '</tr>';\n  };\n\n  return DayHeader;\n}(Component);\n\nvar DaySeries =\n/** @class */\nfunction () {\n  function DaySeries(range, dateProfileGenerator) {\n    var date = range.start;\n    var end = range.end;\n    var indices = [];\n    var dates = [];\n    var dayIndex = -1;\n\n    while (date < end) {\n      // loop each day from start to end\n      if (dateProfileGenerator.isHiddenDay(date)) {\n        indices.push(dayIndex + 0.5); // mark that it's between indices\n      } else {\n        dayIndex++;\n        indices.push(dayIndex);\n        dates.push(date);\n      }\n\n      date = addDays(date, 1);\n    }\n\n    this.dates = dates;\n    this.indices = indices;\n    this.cnt = dates.length;\n  }\n\n  DaySeries.prototype.sliceRange = function (range) {\n    var firstIndex = this.getDateDayIndex(range.start); // inclusive first index\n\n    var lastIndex = this.getDateDayIndex(addDays(range.end, -1)); // inclusive last index\n\n    var clippedFirstIndex = Math.max(0, firstIndex);\n    var clippedLastIndex = Math.min(this.cnt - 1, lastIndex); // deal with in-between indices\n\n    clippedFirstIndex = Math.ceil(clippedFirstIndex); // in-between starts round to next cell\n\n    clippedLastIndex = Math.floor(clippedLastIndex); // in-between ends round to prev cell\n\n    if (clippedFirstIndex <= clippedLastIndex) {\n      return {\n        firstIndex: clippedFirstIndex,\n        lastIndex: clippedLastIndex,\n        isStart: firstIndex === clippedFirstIndex,\n        isEnd: lastIndex === clippedLastIndex\n      };\n    } else {\n      return null;\n    }\n  }; // Given a date, returns its chronolocial cell-index from the first cell of the grid.\n  // If the date lies between cells (because of hiddenDays), returns a floating-point value between offsets.\n  // If before the first offset, returns a negative number.\n  // If after the last offset, returns an offset past the last cell offset.\n  // Only works for *start* dates of cells. Will not work for exclusive end dates for cells.\n\n\n  DaySeries.prototype.getDateDayIndex = function (date) {\n    var indices = this.indices;\n    var dayOffset = Math.floor(diffDays(this.dates[0], date));\n\n    if (dayOffset < 0) {\n      return indices[0] - 1;\n    } else if (dayOffset >= indices.length) {\n      return indices[indices.length - 1] + 1;\n    } else {\n      return indices[dayOffset];\n    }\n  };\n\n  return DaySeries;\n}();\n\nvar DayTable =\n/** @class */\nfunction () {\n  function DayTable(daySeries, breakOnWeeks) {\n    var dates = daySeries.dates;\n    var daysPerRow;\n    var firstDay;\n    var rowCnt;\n\n    if (breakOnWeeks) {\n      // count columns until the day-of-week repeats\n      firstDay = dates[0].getUTCDay();\n\n      for (daysPerRow = 1; daysPerRow < dates.length; daysPerRow++) {\n        if (dates[daysPerRow].getUTCDay() === firstDay) {\n          break;\n        }\n      }\n\n      rowCnt = Math.ceil(dates.length / daysPerRow);\n    } else {\n      rowCnt = 1;\n      daysPerRow = dates.length;\n    }\n\n    this.rowCnt = rowCnt;\n    this.colCnt = daysPerRow;\n    this.daySeries = daySeries;\n    this.cells = this.buildCells();\n    this.headerDates = this.buildHeaderDates();\n  }\n\n  DayTable.prototype.buildCells = function () {\n    var rows = [];\n\n    for (var row = 0; row < this.rowCnt; row++) {\n      var cells = [];\n\n      for (var col = 0; col < this.colCnt; col++) {\n        cells.push(this.buildCell(row, col));\n      }\n\n      rows.push(cells);\n    }\n\n    return rows;\n  };\n\n  DayTable.prototype.buildCell = function (row, col) {\n    return {\n      date: this.daySeries.dates[row * this.colCnt + col]\n    };\n  };\n\n  DayTable.prototype.buildHeaderDates = function () {\n    var dates = [];\n\n    for (var col = 0; col < this.colCnt; col++) {\n      dates.push(this.cells[0][col].date);\n    }\n\n    return dates;\n  };\n\n  DayTable.prototype.sliceRange = function (range) {\n    var colCnt = this.colCnt;\n    var seriesSeg = this.daySeries.sliceRange(range);\n    var segs = [];\n\n    if (seriesSeg) {\n      var firstIndex = seriesSeg.firstIndex,\n          lastIndex = seriesSeg.lastIndex;\n      var index = firstIndex;\n\n      while (index <= lastIndex) {\n        var row = Math.floor(index / colCnt);\n        var nextIndex = Math.min((row + 1) * colCnt, lastIndex + 1);\n        segs.push({\n          row: row,\n          firstCol: index % colCnt,\n          lastCol: (nextIndex - 1) % colCnt,\n          isStart: seriesSeg.isStart && index === firstIndex,\n          isEnd: seriesSeg.isEnd && nextIndex - 1 === lastIndex\n        });\n        index = nextIndex;\n      }\n    }\n\n    return segs;\n  };\n\n  return DayTable;\n}();\n\nvar Slicer =\n/** @class */\nfunction () {\n  function Slicer() {\n    this.sliceBusinessHours = memoize(this._sliceBusinessHours);\n    this.sliceDateSelection = memoize(this._sliceDateSpan);\n    this.sliceEventStore = memoize(this._sliceEventStore);\n    this.sliceEventDrag = memoize(this._sliceInteraction);\n    this.sliceEventResize = memoize(this._sliceInteraction);\n  }\n\n  Slicer.prototype.sliceProps = function (props, dateProfile, nextDayThreshold, component) {\n    var extraArgs = [];\n\n    for (var _i = 4; _i < arguments.length; _i++) {\n      extraArgs[_i - 4] = arguments[_i];\n    }\n\n    var eventUiBases = props.eventUiBases;\n    var eventSegs = this.sliceEventStore.apply(this, [props.eventStore, eventUiBases, dateProfile, nextDayThreshold, component].concat(extraArgs));\n    return {\n      dateSelectionSegs: this.sliceDateSelection.apply(this, [props.dateSelection, eventUiBases, component].concat(extraArgs)),\n      businessHourSegs: this.sliceBusinessHours.apply(this, [props.businessHours, dateProfile, nextDayThreshold, component].concat(extraArgs)),\n      fgEventSegs: eventSegs.fg,\n      bgEventSegs: eventSegs.bg,\n      eventDrag: this.sliceEventDrag.apply(this, [props.eventDrag, eventUiBases, dateProfile, nextDayThreshold, component].concat(extraArgs)),\n      eventResize: this.sliceEventResize.apply(this, [props.eventResize, eventUiBases, dateProfile, nextDayThreshold, component].concat(extraArgs)),\n      eventSelection: props.eventSelection\n    }; // TODO: give interactionSegs?\n  };\n\n  Slicer.prototype.sliceNowDate = function ( // does not memoize\n  date, component) {\n    var extraArgs = [];\n\n    for (var _i = 2; _i < arguments.length; _i++) {\n      extraArgs[_i - 2] = arguments[_i];\n    }\n\n    return this._sliceDateSpan.apply(this, [{\n      range: {\n        start: date,\n        end: addMs(date, 1)\n      },\n      allDay: false\n    }, {}, component].concat(extraArgs));\n  };\n\n  Slicer.prototype._sliceBusinessHours = function (businessHours, dateProfile, nextDayThreshold, component) {\n    var extraArgs = [];\n\n    for (var _i = 4; _i < arguments.length; _i++) {\n      extraArgs[_i - 4] = arguments[_i];\n    }\n\n    if (!businessHours) {\n      return [];\n    }\n\n    return this._sliceEventStore.apply(this, [expandRecurring(businessHours, computeActiveRange(dateProfile, Boolean(nextDayThreshold)), component.calendar), {}, dateProfile, nextDayThreshold, component].concat(extraArgs)).bg;\n  };\n\n  Slicer.prototype._sliceEventStore = function (eventStore, eventUiBases, dateProfile, nextDayThreshold, component) {\n    var extraArgs = [];\n\n    for (var _i = 5; _i < arguments.length; _i++) {\n      extraArgs[_i - 5] = arguments[_i];\n    }\n\n    if (eventStore) {\n      var rangeRes = sliceEventStore(eventStore, eventUiBases, computeActiveRange(dateProfile, Boolean(nextDayThreshold)), nextDayThreshold);\n      return {\n        bg: this.sliceEventRanges(rangeRes.bg, component, extraArgs),\n        fg: this.sliceEventRanges(rangeRes.fg, component, extraArgs)\n      };\n    } else {\n      return {\n        bg: [],\n        fg: []\n      };\n    }\n  };\n\n  Slicer.prototype._sliceInteraction = function (interaction, eventUiBases, dateProfile, nextDayThreshold, component) {\n    var extraArgs = [];\n\n    for (var _i = 5; _i < arguments.length; _i++) {\n      extraArgs[_i - 5] = arguments[_i];\n    }\n\n    if (!interaction) {\n      return null;\n    }\n\n    var rangeRes = sliceEventStore(interaction.mutatedEvents, eventUiBases, computeActiveRange(dateProfile, Boolean(nextDayThreshold)), nextDayThreshold);\n    return {\n      segs: this.sliceEventRanges(rangeRes.fg, component, extraArgs),\n      affectedInstances: interaction.affectedEvents.instances,\n      isEvent: interaction.isEvent,\n      sourceSeg: interaction.origSeg\n    };\n  };\n\n  Slicer.prototype._sliceDateSpan = function (dateSpan, eventUiBases, component) {\n    var extraArgs = [];\n\n    for (var _i = 3; _i < arguments.length; _i++) {\n      extraArgs[_i - 3] = arguments[_i];\n    }\n\n    if (!dateSpan) {\n      return [];\n    }\n\n    var eventRange = fabricateEventRange(dateSpan, eventUiBases, component.calendar);\n    var segs = this.sliceRange.apply(this, [dateSpan.range].concat(extraArgs));\n\n    for (var _a = 0, segs_1 = segs; _a < segs_1.length; _a++) {\n      var seg = segs_1[_a];\n      seg.component = component;\n      seg.eventRange = eventRange;\n    }\n\n    return segs;\n  };\n  /*\r\n  \"complete\" seg means it has component and eventRange\r\n  */\n\n\n  Slicer.prototype.sliceEventRanges = function (eventRanges, component, // TODO: kill\n  extraArgs) {\n    var segs = [];\n\n    for (var _i = 0, eventRanges_1 = eventRanges; _i < eventRanges_1.length; _i++) {\n      var eventRange = eventRanges_1[_i];\n      segs.push.apply(segs, this.sliceEventRange(eventRange, component, extraArgs));\n    }\n\n    return segs;\n  };\n  /*\r\n  \"complete\" seg means it has component and eventRange\r\n  */\n\n\n  Slicer.prototype.sliceEventRange = function (eventRange, component, // TODO: kill\n  extraArgs) {\n    var segs = this.sliceRange.apply(this, [eventRange.range].concat(extraArgs));\n\n    for (var _i = 0, segs_2 = segs; _i < segs_2.length; _i++) {\n      var seg = segs_2[_i];\n      seg.component = component;\n      seg.eventRange = eventRange;\n      seg.isStart = eventRange.isStart && seg.isStart;\n      seg.isEnd = eventRange.isEnd && seg.isEnd;\n    }\n\n    return segs;\n  };\n\n  return Slicer;\n}();\n/*\r\nfor incorporating minTime/maxTime if appropriate\r\nTODO: should be part of DateProfile!\r\nTimelineDateProfile already does this btw\r\n*/\n\n\nfunction computeActiveRange(dateProfile, isComponentAllDay) {\n  var range = dateProfile.activeRange;\n\n  if (isComponentAllDay) {\n    return range;\n  }\n\n  return {\n    start: addMs(range.start, dateProfile.minTime.milliseconds),\n    end: addMs(range.end, dateProfile.maxTime.milliseconds - 864e5) // 864e5 = ms in a day\n\n  };\n} // exports\n// --------------------------------------------------------------------------------------------------\n\n\nvar version = '4.3.1';\nexport { Calendar, Component, DateComponent, DateEnv, DateProfileGenerator, DayHeader, DaySeries, DayTable, ElementDragging, ElementScrollController, EmitterMixin, EventApi, FgEventRenderer, FillRenderer, Interaction, Mixin, NamedTimeZoneImpl, PositionCache, ScrollComponent, ScrollController, Slicer, Splitter, Theme, View, WindowScrollController, addDays, addDurations, addMs, addWeeks, allowContextMenu, allowSelection, appendToElement, applyAll, applyMutationToEventStore, applyStyle, applyStyleProp, asRoughMinutes, asRoughMs, asRoughSeconds, buildGotoAnchorHtml, buildSegCompareObj, capitaliseFirstLetter, combineEventUis, compareByFieldSpec, compareByFieldSpecs, compareNumbers, compensateScroll, computeClippingRect, computeEdges, computeFallbackHeaderFormat, computeHeightAndMargins, computeInnerRect, computeRect, computeVisibleDayRange, config, constrainPoint, createDuration, createElement, createEmptyEventStore, createEventInstance, createFormatter, createPlugin, cssToStr, debounce, diffDates, diffDayAndTime, diffDays, diffPoints, diffWeeks, diffWholeDays, diffWholeWeeks, disableCursor, distributeHeight, elementClosest, elementMatches, enableCursor, eventTupleToStore, filterEventStoreDefs, filterHash, findChildren, findElements, flexibleCompare, forceClassName, formatDate, formatIsoTimeString, formatRange, getAllDayHtml, getClippingParents, getDayClasses, getElSeg, getRectCenter, getRelevantEvents, globalDefaults, greatestDurationDenominator, hasBgRendering, htmlEscape, htmlToElement, insertAfterElement, interactionSettingsStore, interactionSettingsToStore, intersectRanges, intersectRects, isArraysEqual, isDateSpansEqual, isInt, isInteractionValid, isMultiDayRange, isPropsEqual, isPropsValid, isSingleDay, isValidDate, listenBySelector, mapHash, matchCellWidths, memoize, memoizeOutput, memoizeRendering, mergeEventStores, multiplyDuration, padStart, parseBusinessHours, parseDragMeta, parseEventDef, parseFieldSpecs, parse as parseMarker, pointInsideRect, prependToElement, preventContextMenu, preventDefault, preventSelection, processScopedUiProps, rangeContainsMarker, rangeContainsRange, rangesEqual, rangesIntersect, refineProps, removeElement, removeExact, renderDateCell, requestJson, sliceEventStore, startOfDay, subtractInnerElHeight, translateRect, uncompensateScroll, undistributeHeight, unpromisify, version, whenTransitionDone, wholeDivideDurations };","map":{"version":3,"sources":["C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/@fullcalendar/core/main.esm.js"],"names":["elementPropHash","className","colSpan","rowSpan","containerTagHash","el","document","attrName","applyStyle","attrs","content","appendToElement","html","container","computeContainerTag","Array","htmlToNodeList","childNodes","normalizeContent","i","newEls","afterEl","parent","refEl","els","htmlToElements","matchesMethod","Element","closestMethod","elementMatches","containers","allMatches","matches","j","parents","childNode","PIXEL_PROP_RE","applyStyleProp","props","val","point","rect","res","left","Math","rect1","rect2","right","top","bottom","deltaY","point1","point2","isRtlScrollbarOnLeft","computeIsRtlScrollbarOnLeft","outerEl","createElement","style","position","border","padding","overflow","direction","innerEl","removeElement","width","getPadding","computedStyle","window","borderLeft","parseInt","borderRight","borderTop","borderBottom","scrollbarLeftRight","sanitizeScrollbarWidth","scrollbarBottom","scrollbarLeft","scrollbarRight","getIsRtlScrollbarOnLeft","goWithinPadding","outerRect","computeRect","edges","computeEdges","pageYOffset","clientHeight","computeVMargins","computed","computeInnerRect","computeViewportRect","intersectRects","ev","matchedChild","elementClosest","handler","listenBySelector","currentMatchedChild","onMouseEnter","realOnMouseLeave_1","onMouseLeave","transitionEventNames","realCallback","callback","DAY_IDS","a","dateToUtcArray","n","arrayToUtcDate","diffDays","m1","m0","m0day","startOfDay","m1day","years","months","days","milliseconds","d","diffWholeDays","timeAsMs","m","y","marker","w","weekOfGivenYear","nextW","firstWeekStart","firstWeekOffset","dayStart","fwd","fwdlw","date","Date","isNaN","INTERNAL_UNITS","PARSE_RE","parseString","normalizeObject","_a","unit","sign","obj","getWeeksFromInput","d0","d1","dur","asRoughDays","asRoughMs","denominator","localRes","numerator","isInt","ms","value","scrollbarWidths","borderLeftWidth","marginLeft","borderRightWidth","marginRight","minOffset1","availableHeight","minOffset2","flexEls","flexOffsets","flexHeights","usedHeight","undistributeHeight","minOffset","naturalHeight","naturalOffset","newHeight","maxInnerWidth","innerWidth_1","reflowStyleProps","diff","resetStyleProps","specs","tokens","input","token","field","order","func","fieldSpecs","cmp","compareByFieldSpec","fieldSpec","flexibleCompare","obj0","obj1","b","String","str","s","len","functions","ret","args","_i","arguments","later","last","timeout","setTimeout","wait","result","context","timestamp","defaults","refined","processor","processors","rawProps","leftoverProps","dayCnt","timedRange","start","end","addDays","nextDayThreshold","createDuration","startDay","endDay","endTimeMS","visibleRange","computeVisibleDayRange","largeUnit","dateEnv","diffDayAndTime","extendStatics","__proto__","Object","__","__assign","t","recurringTypes","localLeftovers","parsed","allDay","duration","typeData","typeId","typeDef","eventDef","markers","framingRange","hasOwnProperty","dest","complexProps","name","complexObjs","propObjs","mergeProps","filtered","hash","newHash","a_1","item","key","eventStore","createEmptyEventStore","rawEvents_1","rawEvent","tuple","parseEvent","eventTupleToStore","calendar","defs","instances","filterHash","instance","def","starts","expandRecurringRanges","starts_1","createEventInstance","def_1","newStore","filterEventStoreDefs","isEventDefsGrouped","Boolean","def0","def1","calEachTransform","sourceEachTransform","eventSource","rawEvents","transformEachRawEvent","refinedEvents","rawEvents_2","refinedEvent","store0","store1","invertedRanges","constraintRange","ranges","dateRange","range0","range1","newRange","outerRange","innerRange","range","removeCnt","array","a0","a1","isArraysEqual","workerFunc","cachedRes","newRes","equalityFunc","EXTENDED_SETTINGS_AND_SEVERITIES","week","separator","omitZeroMinute","meridiem","omitCommas","STANDARD_DATE_PROP_SEVERITIES","timeZoneName","era","year","month","day","weekday","hour","minute","second","MERIDIEM_RE","COMMA_RE","MULTI_SPACE_RE","LTR_RE","UTC_RE","NativeFormatter","standardDateProps","extendedSettings","severity","name_1","formatSettings","memoize","diffSeverity","computeMarkerDiffSeverity","biggestUnitForPartial","full0","full1","partialDateProps","computePartialFormattingOptions","partialFormattingFunc","buildFormattingFunc","partial0","partial1","insertion","findCommonInsertion","standardDatePropCnt","formatTimeZoneOffset","formatWeekNumber","buildNativeFormattingFunc","sanitizeSettings","normalFormat","Intl","zeroProps","zeroFormat","format","postProcess","injectTzoStr","replaced","parts","display","locale","ca","partialOptions","name_2","options","i0","found0","before0","after0","i1","found1","before1","after1","before","after","CmdFormatter","createVerboseFormattingArg","FuncFormatter","defaultSeparator","stripZeroTime","timeZoneOffset","padStart","doIso","minutes","abs","hours","mins","startInfo","expandZonedMarker","endInfo","timeZone","localeCodes","calendarSystem","dateInfo","millisecond","EventSourceApi","type","sourceId","sourceIds","get","enumerable","configurable","EventApi","NON_DATE_PROPS","standardProps","ui","UNSCOPED_EVENT_UI_PROPS","backgroundColor","borderColor","startEditable","durationEditable","_b","extendedProps","instanceRange","startDelta","diffDates","datesDelta","endInput","endDelta","hasEnd","computeAlignedDayRange","durationsEqual","delta","maintainDuration","formatter","createFormatter","forcedStartTzo","forcedEndTzo","forcedTzo","instanceId","mutation","fromApi","defId","inverseBgByGroupId","inverseBgByDefId","defByGroupId","bgRanges","fgRanges","eventUis","compileEventUis","origRange","normalRange","slicedRange","intersectRanges","isStart","isEnd","invertRanges","invertedRanges_1","invertedRange","invertedRanges_2","bg","fg","view","segs","custom","event","seg","isMirror","segs_1","setElSeg","mapHash","compileEventUi","uis","eventUiBases","combineEventUis","eventConfigs","applyMutationToEventDef","applyMutationToEventInstance","eventConfig","copy","appliers_1","applier","forceAllDay","clearEnd","action","receiveRawEvents","eventSources","addEvent","dateProfile","mergeEventStores","expandRecurring","rezoneDates","applyMutationToRelated","excludeInstances","excludeEventsBySourceId","fetchId","subset","parseEvents","transformRawEvents","newDateEnv","oldDateEnv","relevant","getRelevantEvents","eventConfigBase","constraints","overlap","allows","textColor","classNames","applyMutationToEventStore","removals","isNewPropsValid","eventDrag","interaction","dateSelection","businessHours","eventSelection","eventResize","dateSpanMeta","state","isInteractionPropsValid","isDateSelectionPropsValid","subjectEventStore","subjectDefs","subjectInstances","subjectConfigs","selectionConfig","otherEventStore","otherDefs","otherInstances","otherConfigs","subjectInstance","subjectRange","subjectConfig","subjectDef","allConstraintsPass","overlapFunc","otherInstance","rangesIntersect","otherOverlap","calendarEventStore","subjectAllow","subjectDateSpan","origDef","origInstance","eventApi","relevantEventStore","relevantDefs","relevantInstances","selection","selectionRange","filterConfig","relevantInstance","selectionAllow","fullDateSpan","constraints_1","constraint","anyRangesContainRange","constraintToRanges","eventStoreToRanges","outerRanges_1","rangeContainsRange","statements","cssProps","htmlEscape","raw","editable","allow","color","refineProps","normalizeConstraint","rawUnscoped","wasFound","scopedKey","prefix","capitaliseFirstLetter","rawScoped","leftovers","processUnscopedUiProps","EMPTY_EVENT_UI","item1","item0","id","groupId","title","url","rendering","DATE_PROPS","uid","allDayDefault","computeIsAllDayDefault","leftovers0","recurringRes","parseRecurring","parseEventDef","leftovers1","singleRes","parseSingle","pluckNonDateProps","eventDefParser","newLeftovers","pluckDateProps","startMarker","endMarker","startMeta","endMeta","preLeftovers","source","DEF_DEFAULTS","startTime","endTime","daysOfWeek","refineInputs","rawDefs","rawDef","dependencies","dependents","dependents_1","dependent","unrenderFunc","prevArgs","unrender","thisContext","renderFunc","dependencies_1","dependency","EMPTY_EVENT_STORE","Splitter","_this","keyInfos","defKeys","dateSelections","individualUi","eventStores","eventDrags","eventResizes","splitProps","keyInfo","buildEventUi","dateSpans","keys","keys_1","splitStores","_c","splitHashes","splitStates","affectedStores_1","mutatedKeysByDefId","mutatedStores_1","populate","affectedEvents","mutatedEvents","isEvent","origSeg","baseParts","stuff","component","gotoOptions","forceOff","finalOptions","omitTime","innerHtml","attrsToStr","JSON","theme","classes","rangeContainsMarker","todayStart","todayEnd","noThemeHighlight","isResolved","wrappedSuccess","success","wrappedFailure","failure","Mixin","destClass","destObj","EmitterMixin","__extends","_super","addToHash","removeFromHash","applyAll","PositionCache","originEl","originClientRect","lefts","rights","tops","bottoms","leftPosition","topPosition","ScrollController","ElementScrollController","WindowScrollController","ScrollComponent","overflowX","overflowY","Theme","iconClassesCopy","iconOverrideHash","customButtonProps","guid","Component","recycleProps","anyChanges","comboProps","oldProps","newProps","equalityFuncs","DateComponent","isInteractionValid","isDateSelectionValid","segs_2","segs_3","segEl","uid$1","deps","reducers","eventDefParsers","isDraggableTransformers","eventDragMutationMassagers","eventDefMutationAppliers","dateSelectionTransformers","datePointTransforms","dateSpanTransforms","views","viewPropsTransformers","isPropsValid","externalDefTransforms","eventResizeJoinTransforms","viewContainerModifiers","eventDropTransformers","componentInteractions","calendarInteractions","themeClasses","eventSourceDefs","cmdFormatter","namedTimeZonedImpl","defaultView","elementDraggingImpl","optionChangeHandlers","PluginSystem","plugin","dep","combineHooks","hooks0","hooks1","eventSourceDef","ignoreRange","parseMeta","fetch","arg","meta","ArrayEventSourcePlugin","createPlugin","eventSourceDef$1","unpromisify","startStr","endStr","FuncEventSourcePlugin","method","body","injectQueryStringParams","encodeParams","xhr","successCallback","failureCallback","encodeURIComponent","params","eventSourceDef$2","extraParams","startParam","endParam","timeZoneParam","requestParams","buildRequestParams","requestJson","message","JsonFeedEventSourcePlugin","customRequestParams","recurring","parse","createMarker","startRecur","endRecur","anyValid","subtractDurations","allDayGuess","expand","clippedFramingRange","expandRanges","SimpleRecurrencePlugin","dowHash","arrayToHash","dayMarker","instanceStarts","instanceStart","DefaultOptionChangeHandlers","events","handleEventSources","plugins","handlePlugins","unfoundSources","hashValuesToArray","newInputs","inputs_1","inputFound","deepEqual","unfoundSources_1","unfoundSource","newInputs_1","newInput","config","globalDefaults","defaultRangeSeparator","titleRangeSeparator","defaultTimedEventDuration","defaultAllDayEventDuration","forceEventDuration","columnHeader","aspectRatio","header","center","weekends","weekNumbers","weekNumberCalculation","scrollTime","minTime","maxTime","showNonCurrentDates","lazyFetching","locales","timeGridEventMinHeight","themeSystem","dragRevertDuration","dragScroll","allDayMaintainDuration","unselectAuto","dropAccept","eventOrder","eventLimit","eventLimitClick","dayPopoverFormat","handleWindowResize","windowResizeDelay","longPressDelay","eventDragMinDistance","rtlDefaults","buttonIcons","prev","next","prevYear","nextYear","complexOptions","INTERNAL_PLUGINS","pluginInputs_1","pluginInput","globalName","console","RAW_EN_LOCALE","code","dow","doy","dir","buttonText","today","list","weekLabel","allDayText","eventLimitText","noEventsMessage","defaultCode","explicitRawLocales","globalArray","globalObject","allRawLocales","rawLocaleMap","en","allRawLocales_1","rawLocale","map","parseLocale","inputSingular","queryLocale","codes","codeArg","queryRawLocale","simpleId","available","merged","simpleNumberFormat","OptionsManager","overrideHash","isDynamic","removals_1","propName","firstDefined","parseRawLocales","localeDefaults","buildLocale","dirDefaults","mergeOptions","calendarSystemClassMap","GregorianCalendarSystem","registerCalendarSystem","ISO_RE","Number","isValidDate","isTimeUnspecified","DateEnv","settings","isNamedTimeZone","createCalendarSystem","dateToLocalArray","diffWholeWeeks","diffHours","diffMinutes","diffSeconds","asRoughYears","asRoughMonths","startOfHour","startOfMinute","startOfSecond","weekOfYear","dateOptions","addMs","extraOptions","buildIsoString","arrayToLocalDate","SIMPLE_SOURCE_PROPS","eventDataTransform","Function","uid$2","parseEventSourceProps","addSources","removeSource","fetchDirtySources","fetchSourcesByIds","excludeStaticSources","receiveResponse","uid$3","sources_1","isSourceDirty","doesSourceNeedRange","fetchRange","nextSources","prevSources","sourceIdHash","fetchSource","sourceDef","calSuccess","sourceSuccessRes","calSuccessRes","callFailure","error","isFetching","latestFetchId","sourceHash","DateProfileGenerator","viewSpec","prevDate","currentDateProfile","nextDate","forceToValid","validRange","currentDate","constrainMarkerToRange","currentInfo","isRangeAllDay","renderRange","activeRange","isValid","currentRange","currentRangeUnit","dateIncrement","dayCount","greatestDurationDenominator","alignment","dateIncrementInput","dateIncrementDuration","computeRes","customAlignment","runningCount","otherArgs","parseRange","hiddenDays","isHiddenDayHash","inc","isExclusive","rangesEqual","p0","p1","viewType","reduceViewType","reduceDateProfile","reduceEventSources","nextState","reduceCurrentDate","reduceEventStore","reduceDateSelection","reduceSelectedEvent","reduceEventDrag","reduceEventResize","eventSourceLoadingLevel","computeLoadingLevel","loadingLevel","reducerFunc","newDateProfile","generator","isDateProfilesEqual","newDate","newDrag","newResize","cnt","STANDARD_PROPS","span","parseOpenDateSpan","defaultDuration","span0","span1","isSpanPropsEqual","dateStr","dateSpan","ensureViewDef","viewDef","buildViewDef","defaultConfig","defaultConfigs","overrideConfig","overrideConfigs","queryProp","theClass","superType","findViewNameBySubclass","superDef","class","overrides","superProto","viewSubclass","configs","VIEW_DEF_PROPS","parseViewConfigs","optionsManager","viewDefs","compileViewDefs","buildViewSpec","durationInput","durationUnit","singleUnit","singleUnitOverrides","denom","queryButtonText","buttonTextMap","buttonTextKey","buttonTextOverride","buttonTextDefault","Toolbar","memoizeRendering","extraClassName","layout","viewSpecs","sectionEl","calendarCustomButtons","calendarButtonTextOverrides","calendarButtonText","buttonStr","groupChildren","isOnlyButtons","buttonGroupStr","buttonName","htmlToElement","buttonClick","buttonIcon","buttonClasses","buttonInnerHtml","buttonAriaAttr","buttonEl","groupEl","buttonGroupClassName","findElements","titleEl","CalendarComponent","prependToElement","modifyViewContainer","parseBusinessHours","classList","dirClassName","themeClassName","headerLayout","footerLayout","now","todayInfo","dateProfileGenerator","prevInfo","nextInfo","toolbarProps","activeButton","isTodayEnabled","isPrevEnabled","isNextEnabled","viewProps","transformers","transformers_1","transformer","isResize","heightInput","contentHeightInput","parentEl","height","computeHeightAndMargins","viewOptions","computeTitleFormat","isEndExclusive","Interaction","useEventCenter","interactionSettingsStore","EventClicking","getElSeg","hasUrlContainer","jsEvent","EventHovering","listenToHoverBySelector","StandardTheme","widget","widgetHeader","widgetContent","buttonGroup","button","buttonActive","popoverHeader","popoverContent","headerRow","dayRow","listView","close","Calendar","memoizeOutput","pluginDefs","refinePluginDefs","pluginDefs_1","pluginDef","anchorEl","dateMarker","customAction","debounce","rawSources","singleRawSource","sources","rawSources_1","rawSource","parseEventSource","oldState","newState","reduce","needsFull","needsFullRerender","savedScroll","renderableEventStore","eventUiSingleBase","eventUiBySource","changeHandlers","normalUpdates","specialUpdates","isTimeZoneDirty","isSizeDirty","anyDifficultOptions","updates","pluginHooks","buildViewSpecs","processScopedUiProps","rawOpts","eventEditable","optHandler","afterSizingTriggers","dateOrRange","spec","viewTypes","defaultDateInput","parseInteractionSettings","DEFAULT_INTERACTIONS","interactionClasses","interactions","listener","endDate","dateOrObj","selectionInput","parseDateSpan","pev","dayEl","transform","buildDatePointApi","buildDateSpanApi","eventInput","sourceInput","sourceApi","eventApis","sourceApis","namedTimeZoneImpl","firstDay","themeClass","calendarOptions","eventDefs","View","parseFieldSpecs","sliceEventStore","eventUi","update","delay","setInterval","clearTimeout","clearInterval","queuedScroll","scroll","FgEventRenderer","displayEventTime","displayEventEnd","filterSegsViaEls","mirrorInfo","eventRange","displayEnd","objs","compareByFieldSpecs","c","force","eventInstance","_seg","FillRenderer","renderedSegs","containerEls","css","cssToStr","NamedTimeZoneImpl","ElementDragging","buildDateEnv$1","dateMeta","DRAG_META_PROPS","create","DRAG_META_DEFAULTS","isDateValid","getDayClasses","colspan","otherAttrs","buildGotoAnchorHtml","colCnt","DayHeader","dates","datesRepDistinctDays","colHeadFormat","computeFallbackHeaderFormat","dates_1","renderDateCell","DaySeries","indices","dayIndex","firstIndex","lastIndex","clippedFirstIndex","clippedLastIndex","dayOffset","DayTable","daySeries","daysPerRow","rowCnt","rows","row","cells","col","seriesSeg","index","nextIndex","firstCol","lastCol","Slicer","extraArgs","eventSegs","dateSelectionSegs","businessHourSegs","fgEventSegs","bgEventSegs","computeActiveRange","rangeRes","affectedInstances","sourceSeg","fabricateEventRange","eventRanges_1","version"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA,IAAIA,eAAe,GAAG;AAClBC,EAAAA,SAAS,EADS,IAAA;AAElBC,EAAAA,OAAO,EAFW,IAAA;AAGlBC,EAAAA,OAAO,EAAE;AAHS,CAAtB;AAKA,IAAIC,gBAAgB,GAAG;AACnB,SADmB,OAAA;AAEnB,SAAO;AAFY,CAAvB;;AAIA,SAAA,aAAA,CAAA,OAAA,EAAA,KAAA,EAAA,OAAA,EAAgD;AAC5C,MAAIC,EAAE,GAAGC,QAAQ,CAARA,aAAAA,CAAT,OAASA,CAAT;;AACA,MAAA,KAAA,EAAW;AACP,SAAK,IAAL,QAAA,IAAA,KAAA,EAA4B;AACxB,UAAIC,QAAQ,KAAZ,OAAA,EAA0B;AACtBC,QAAAA,UAAU,CAAA,EAAA,EAAKC,KAAK,CAApBD,QAAoB,CAAV,CAAVA;AADJ,OAAA,MAGK,IAAIR,eAAe,CAAnB,QAAmB,CAAnB,EAA+B;AAChCK,QAAAA,EAAE,CAAFA,QAAE,CAAFA,GAAeI,KAAK,CAApBJ,QAAoB,CAApBA;AADC,OAAA,MAGA;AACDA,QAAAA,EAAE,CAAFA,YAAAA,CAAAA,QAAAA,EAA0BI,KAAK,CAA/BJ,QAA+B,CAA/BA;AACH;AACJ;AACJ;;AACD,MAAI,OAAA,OAAA,KAAJ,QAAA,EAAiC;AAC7BA,IAAAA,EAAE,CAAFA,SAAAA,GAD6B,OAC7BA,CAD6B,CACL;AAD5B,GAAA,MAGK,IAAIK,OAAO,IAAX,IAAA,EAAqB;AACtBC,IAAAA,eAAe,CAAA,EAAA,EAAfA,OAAe,CAAfA;AACH;;AACD,SAAA,EAAA;AACH;;AACD,SAAA,aAAA,CAAA,IAAA,EAA6B;AACzBC,EAAAA,IAAI,GAAGA,IAAI,CAAXA,IAAOA,EAAPA;AACA,MAAIC,SAAS,GAAGP,QAAQ,CAARA,aAAAA,CAAuBQ,mBAAmB,CAA1D,IAA0D,CAA1CR,CAAhB;AACAO,EAAAA,SAAS,CAATA,SAAAA,GAAAA,IAAAA;AACA,SAAOA,SAAS,CAAhB,UAAA;AACH;;AACD,SAAA,cAAA,CAAA,IAAA,EAA8B;AAC1B,SAAOE,KAAK,CAALA,SAAAA,CAAAA,KAAAA,CAAAA,IAAAA,CAA2BC,cAAc,CAAhD,IAAgD,CAAzCD,CAAP;AACH;;AACD,SAAA,cAAA,CAAA,IAAA,EAA8B;AAC1BH,EAAAA,IAAI,GAAGA,IAAI,CAAXA,IAAOA,EAAPA;AACA,MAAIC,SAAS,GAAGP,QAAQ,CAARA,aAAAA,CAAuBQ,mBAAmB,CAA1D,IAA0D,CAA1CR,CAAhB;AACAO,EAAAA,SAAS,CAATA,SAAAA,GAAAA,IAAAA;AACA,SAAOA,SAAS,CAAhB,UAAA;EAEJ;;;AACA,SAAA,mBAAA,CAAA,IAAA,EAAmC;AAC/B,SAAO,gBAAgB,CAACD,IAAI,CAAJA,MAAAA,CAAAA,CAAAA,EAAD,CAACA,CAAD,CAAmB;AAAnB,GAAhB,IAAP,KAAA;AAEH;;AACD,SAAA,eAAA,CAAA,EAAA,EAAA,OAAA,EAAsC;AAClC,MAAIK,UAAU,GAAGC,gBAAgB,CAAjC,OAAiC,CAAjC;;AACA,OAAK,IAAIC,CAAC,GAAV,CAAA,EAAgBA,CAAC,GAAGF,UAAU,CAA9B,MAAA,EAAuCE,CAAvC,EAAA,EAA4C;AACxCd,IAAAA,EAAE,CAAFA,WAAAA,CAAeY,UAAU,CAAzBZ,CAAyB,CAAzBA;AACH;AACJ;;AACD,SAAA,gBAAA,CAAA,MAAA,EAAA,OAAA,EAA2C;AACvC,MAAIe,MAAM,GAAGF,gBAAgB,CAA7B,OAA6B,CAA7B;AACA,MAAIG,OAAO,GAAGC,MAAM,CAANA,UAAAA,IAFyB,IAEvC,CAFuC,CAEE;;AACzC,OAAK,IAAIH,CAAC,GAAV,CAAA,EAAgBA,CAAC,GAAGC,MAAM,CAA1B,MAAA,EAAmCD,CAAnC,EAAA,EAAwC;AACpCG,IAAAA,MAAM,CAANA,YAAAA,CAAoBF,MAAM,CAA1BE,CAA0B,CAA1BA,EAAAA,OAAAA;AACH;AACJ;;AACD,SAAA,kBAAA,CAAA,KAAA,EAAA,OAAA,EAA4C;AACxC,MAAIF,MAAM,GAAGF,gBAAgB,CAA7B,OAA6B,CAA7B;AACA,MAAIG,OAAO,GAAGE,KAAK,CAALA,WAAAA,IAAd,IAAA;;AACA,OAAK,IAAIJ,CAAC,GAAV,CAAA,EAAgBA,CAAC,GAAGC,MAAM,CAA1B,MAAA,EAAmCD,CAAnC,EAAA,EAAwC;AACpCI,IAAAA,KAAK,CAALA,UAAAA,CAAAA,YAAAA,CAA8BH,MAAM,CAApCG,CAAoC,CAApCA,EAAAA,OAAAA;AACH;AACJ;;AACD,SAAA,gBAAA,CAAA,OAAA,EAAmC;AAC/B,MAAA,GAAA;;AACA,MAAI,OAAA,OAAA,KAAJ,QAAA,EAAiC;AAC7BC,IAAAA,GAAG,GAAGC,cAAc,CAApBD,OAAoB,CAApBA;AADJ,GAAA,MAGK,IAAId,OAAO,YAAX,IAAA,EAA6B;AAC9Bc,IAAAA,GAAG,GAAG,CAANA,OAAM,CAANA;AADC,GAAA,MAGA;AAAE;AACHA,IAAAA,GAAG,GAAGT,KAAK,CAALA,SAAAA,CAAAA,KAAAA,CAAAA,IAAAA,CAANS,OAAMT,CAANS;AACH;;AACD,SAAA,GAAA;AACH;;AACD,SAAA,aAAA,CAAA,EAAA,EAA2B;AACvB,MAAInB,EAAE,CAAN,UAAA,EAAmB;AACfA,IAAAA,EAAE,CAAFA,UAAAA,CAAAA,WAAAA,CAAAA,EAAAA;AACH;EAEL;AACA;AACA;;;AACA,IAAIqB,aAAa,GAAGC,OAAO,CAAPA,SAAAA,CAAAA,OAAAA,IAChBA,OAAO,CAAPA,SAAAA,CADgBA,eAAAA,IAEhBA,OAAO,CAAPA,SAAAA,CAFJ,iBAAA;;AAGA,IAAIC,aAAa,GAAGD,OAAO,CAAPA,SAAAA,CAAAA,OAAAA,IAA6B,UAAA,QAAA,EAAoB;AACjE;AACA,MAAItB,EAAE,GAAN,IAAA;;AACA,MAAI,CAACC,QAAQ,CAARA,eAAAA,CAAAA,QAAAA,CAAL,EAAKA,CAAL,EAA4C;AACxC,WAAA,IAAA;AACH;;AACD,KAAG;AACC,QAAIuB,cAAc,CAAA,EAAA,EAAlB,QAAkB,CAAlB,EAAkC;AAC9B,aAAA,EAAA;AACH;;AACDxB,IAAAA,EAAE,GAAGA,EAAE,CAAFA,aAAAA,IAAoBA,EAAE,CAA3BA,UAAAA;AAJJ,GAAA,QAKSA,EAAE,KAAFA,IAAAA,IAAeA,EAAE,CAAFA,QAAAA,KALxB,CAAA;;AAMA,SAAA,IAAA;AAZJ,CAAA;;AAcA,SAAA,cAAA,CAAA,EAAA,EAAA,QAAA,EAAsC;AAClC,SAAOuB,aAAa,CAAbA,IAAAA,CAAAA,EAAAA,EAAP,QAAOA,CAAP;AACH;;AACD,SAAA,cAAA,CAAA,EAAA,EAAA,QAAA,EAAsC;AAClC,SAAOF,aAAa,CAAbA,IAAAA,CAAAA,EAAAA,EAAP,QAAOA,CAAP;EAEJ;AACA;;;AACA,SAAA,YAAA,CAAA,SAAA,EAAA,QAAA,EAA2C;AACvC,MAAII,UAAU,GAAGjB,SAAS,YAATA,WAAAA,GAAmC,CAAnCA,SAAmC,CAAnCA,GAAjB,SAAA;AACA,MAAIkB,UAAU,GAAd,EAAA;;AACA,OAAK,IAAIZ,CAAC,GAAV,CAAA,EAAgBA,CAAC,GAAGW,UAAU,CAA9B,MAAA,EAAuCX,CAAvC,EAAA,EAA4C;AACxC,QAAIa,OAAO,GAAGF,UAAU,CAAVA,CAAU,CAAVA,CAAAA,gBAAAA,CAAd,QAAcA,CAAd;;AACA,SAAK,IAAIG,CAAC,GAAV,CAAA,EAAgBA,CAAC,GAAGD,OAAO,CAA3B,MAAA,EAAoCC,CAApC,EAAA,EAAyC;AACrCF,MAAAA,UAAU,CAAVA,IAAAA,CAAgBC,OAAO,CAAvBD,CAAuB,CAAvBA;AACH;AACJ;;AACD,SAAA,UAAA;EAEJ;AACA;;;AACA,SAAA,YAAA,CAAA,MAAA,EAAA,QAAA,EAAwC;AACpC,MAAIG,OAAO,GAAGZ,MAAM,YAANA,WAAAA,GAAgC,CAAhCA,MAAgC,CAAhCA,GAAd,MAAA;AACA,MAAIS,UAAU,GAAd,EAAA;;AACA,OAAK,IAAIZ,CAAC,GAAV,CAAA,EAAgBA,CAAC,GAAGe,OAAO,CAA3B,MAAA,EAAoCf,CAApC,EAAA,EAAyC;AACrC,QAAIF,UAAU,GAAGiB,OAAO,CAAPA,CAAO,CAAPA,CADoB,QACrC,CADqC,CACC;;AACtC,SAAK,IAAID,CAAC,GAAV,CAAA,EAAgBA,CAAC,GAAGhB,UAAU,CAA9B,MAAA,EAAuCgB,CAAvC,EAAA,EAA4C;AACxC,UAAIE,SAAS,GAAGlB,UAAU,CAA1B,CAA0B,CAA1B;;AACA,UAAI,CAAA,QAAA,IAAaY,cAAc,CAAA,SAAA,EAA/B,QAA+B,CAA/B,EAAsD;AAClDE,QAAAA,UAAU,CAAVA,IAAAA,CAAAA,SAAAA;AACH;AACJ;AACJ;;AACD,SAAA,UAAA;EAEJ;AACA;;;AACA,SAAA,cAAA,CAAA,EAAA,EAAA,SAAA,EAAA,IAAA,EAA6C;AACzC,MAAA,IAAA,EAAU;AACN1B,IAAAA,EAAE,CAAFA,SAAAA,CAAAA,GAAAA,CAAAA,SAAAA;AADJ,GAAA,MAGK;AACDA,IAAAA,EAAE,CAAFA,SAAAA,CAAAA,MAAAA,CAAAA,SAAAA;AACH;EAEL;AACA;;;AACA,IAAI+B,aAAa,GAAjB,wCAAA;;AACA,SAAA,UAAA,CAAA,EAAA,EAAA,KAAA,EAA+B;AAC3B,OAAK,IAAL,QAAA,IAAA,KAAA,EAA4B;AACxBC,IAAAA,cAAc,CAAA,EAAA,EAAA,QAAA,EAAeC,KAAK,CAAlCD,QAAkC,CAApB,CAAdA;AACH;AACJ;;AACD,SAAA,cAAA,CAAA,EAAA,EAAA,IAAA,EAAA,GAAA,EAAuC;AACnC,MAAIE,GAAG,IAAP,IAAA,EAAiB;AACblC,IAAAA,EAAE,CAAFA,KAAAA,CAAAA,IAAAA,IAAAA,EAAAA;AADJ,GAAA,MAGK,IAAI,OAAA,GAAA,KAAA,QAAA,IAA2B+B,aAAa,CAAbA,IAAAA,CAA/B,IAA+BA,CAA/B,EAAyD;AAC1D/B,IAAAA,EAAE,CAAFA,KAAAA,CAAAA,IAAAA,IAAiBkC,GAAG,GAApBlC,IAAAA;AADC,GAAA,MAGA;AACDA,IAAAA,EAAE,CAAFA,KAAAA,CAAAA,IAAAA,IAAAA,GAAAA;AACH;AACJ;;AAED,SAAA,eAAA,CAAA,KAAA,EAAA,IAAA,EAAsC;AAClC,SAAOmC,KAAK,CAALA,IAAAA,IAAcC,IAAI,CAAlBD,IAAAA,IACHA,KAAK,CAALA,IAAAA,GAAaC,IAAI,CADdD,KAAAA,IAEHA,KAAK,CAALA,GAAAA,IAAaC,IAAI,CAFdD,GAAAA,IAGHA,KAAK,CAALA,GAAAA,GAAYC,IAAI,CAHpB,MAAA;EAKJ;;;AACA,SAAA,cAAA,CAAA,KAAA,EAAA,KAAA,EAAsC;AAClC,MAAIC,GAAG,GAAG;AACNC,IAAAA,IAAI,EAAEC,IAAI,CAAJA,GAAAA,CAASC,KAAK,CAAdD,IAAAA,EAAqBE,KAAK,CAD1B,IACAF,CADA;AAENG,IAAAA,KAAK,EAAEH,IAAI,CAAJA,GAAAA,CAASC,KAAK,CAAdD,KAAAA,EAAsBE,KAAK,CAF5B,KAECF,CAFD;AAGNI,IAAAA,GAAG,EAAEJ,IAAI,CAAJA,GAAAA,CAASC,KAAK,CAAdD,GAAAA,EAAoBE,KAAK,CAHxB,GAGDF,CAHC;AAINK,IAAAA,MAAM,EAAEL,IAAI,CAAJA,GAAAA,CAASC,KAAK,CAAdD,MAAAA,EAAuBE,KAAK,CAA5BF,MAAAA;AAJF,GAAV;;AAMA,MAAIF,GAAG,CAAHA,IAAAA,GAAWA,GAAG,CAAdA,KAAAA,IAAwBA,GAAG,CAAHA,GAAAA,GAAUA,GAAG,CAAzC,MAAA,EAAkD;AAC9C,WAAA,GAAA;AACH;;AACD,SAAA,KAAA;AACH;;AACD,SAAA,aAAA,CAAA,IAAA,EAAA,MAAA,EAAA,MAAA,EAA6C;AACzC,SAAO;AACHC,IAAAA,IAAI,EAAEF,IAAI,CAAJA,IAAAA,GADH,MAAA;AAEHM,IAAAA,KAAK,EAAEN,IAAI,CAAJA,KAAAA,GAFJ,MAAA;AAGHO,IAAAA,GAAG,EAAEP,IAAI,CAAJA,GAAAA,GAHF,MAAA;AAIHQ,IAAAA,MAAM,EAAER,IAAI,CAAJA,MAAAA,GAAcS;AAJnB,GAAP;EAOJ;;;AACA,SAAA,cAAA,CAAA,KAAA,EAAA,IAAA,EAAqC;AACjC,SAAO;AACHP,IAAAA,IAAI,EAAEC,IAAI,CAAJA,GAAAA,CAASA,IAAI,CAAJA,GAAAA,CAASJ,KAAK,CAAdI,IAAAA,EAAqBH,IAAI,CAAlCG,IAASA,CAATA,EAA0CH,IAAI,CADjD,KACGG,CADH;AAEHI,IAAAA,GAAG,EAAEJ,IAAI,CAAJA,GAAAA,CAASA,IAAI,CAAJA,GAAAA,CAASJ,KAAK,CAAdI,GAAAA,EAAoBH,IAAI,CAAjCG,GAASA,CAATA,EAAwCH,IAAI,CAA5CG,MAAAA;AAFF,GAAP;EAKJ;;;AACA,SAAA,aAAA,CAAA,IAAA,EAA6B;AACzB,SAAO;AACHD,IAAAA,IAAI,EAAE,CAACF,IAAI,CAAJA,IAAAA,GAAYA,IAAI,CAAjB,KAAA,IADH,CAAA;AAEHO,IAAAA,GAAG,EAAE,CAACP,IAAI,CAAJA,GAAAA,GAAWA,IAAI,CAAhB,MAAA,IAA2B;AAF7B,GAAP;EAKJ;;;AACA,SAAA,UAAA,CAAA,MAAA,EAAA,MAAA,EAAoC;AAChC,SAAO;AACHE,IAAAA,IAAI,EAAEQ,MAAM,CAANA,IAAAA,GAAcC,MAAM,CADvB,IAAA;AAEHJ,IAAAA,GAAG,EAAEG,MAAM,CAANA,GAAAA,GAAaC,MAAM,CAACJ;AAFtB,GAAP;EAMJ;;;AACA,IAAIK,oBAAoB,GAAxB,IAAA;;AACA,SAAA,uBAAA,GAAmC;AAC/B,MAAIA,oBAAoB,KAAxB,IAAA,EAAmC;AAC/BA,IAAAA,oBAAoB,GAAGC,2BAAvBD,EAAAA;AACH;;AACD,SAAA,oBAAA;AACH;;AACD,SAAA,2BAAA,GAAuC;AACnC,MAAIE,OAAO,GAAGC,aAAa,CAAA,KAAA,EAAQ;AAC/BC,IAAAA,KAAK,EAAE;AACHC,MAAAA,QAAQ,EADL,UAAA;AAEHV,MAAAA,GAAG,EAAE,CAFF,IAAA;AAGHL,MAAAA,IAAI,EAHD,CAAA;AAIHgB,MAAAA,MAAM,EAJH,CAAA;AAKHC,MAAAA,OAAO,EALJ,CAAA;AAMHC,MAAAA,QAAQ,EANL,QAAA;AAOHC,MAAAA,SAAS,EAAE;AAPR;AADwB,GAAR,EAA3B,aAA2B,CAA3B;AAWAxD,EAAAA,QAAQ,CAARA,IAAAA,CAAAA,WAAAA,CAAAA,OAAAA;AACA,MAAIyD,OAAO,GAAGR,OAAO,CAArB,UAAA;AACA,MAAIb,GAAG,GAAGqB,OAAO,CAAPA,qBAAAA,GAAAA,IAAAA,GAAuCR,OAAO,CAAPA,qBAAAA,GAAjD,IAAA;AACAS,EAAAA,aAAa,CAAbA,OAAa,CAAbA;AACA,SAAA,GAAA;EAEJ;AACA;;;AACA,SAAA,sBAAA,CAAA,KAAA,EAAuC;AACnCC,EAAAA,KAAK,GAAGrB,IAAI,CAAJA,GAAAA,CAAAA,CAAAA,EAD2B,KAC3BA,CAARqB,CADmC,CACP;;AAC5BA,EAAAA,KAAK,GAAGrB,IAAI,CAAJA,KAAAA,CAARqB,KAAQrB,CAARqB;AACA,SAAA,KAAA;AACH;;AAED,SAAA,YAAA,CAAA,EAAA,EAAA,UAAA,EAAsC;AAClC,MAAIC,UAAU,KAAK,KAAnB,CAAA,EAA2B;AAAEA,IAAAA,UAAU,GAAVA,KAAAA;AAAqB;;AAClD,MAAIC,aAAa,GAAGC,MAAM,CAANA,gBAAAA,CAApB,EAAoBA,CAApB;AACA,MAAIC,UAAU,GAAGC,QAAQ,CAACH,aAAa,CAAd,eAAA,EAARG,EAAQ,CAARA,IAAjB,CAAA;AACA,MAAIC,WAAW,GAAGD,QAAQ,CAACH,aAAa,CAAd,gBAAA,EAARG,EAAQ,CAARA,IAAlB,CAAA;AACA,MAAIE,SAAS,GAAGF,QAAQ,CAACH,aAAa,CAAd,cAAA,EAARG,EAAQ,CAARA,IAAhB,CAAA;AACA,MAAIG,YAAY,GAAGH,QAAQ,CAACH,aAAa,CAAd,iBAAA,EAARG,EAAQ,CAARA,IANe,CAMlC,CANkC,CAOlC;;AACA,MAAII,kBAAkB,GAAGC,sBAAsB,CAACtE,EAAE,CAAFA,WAAAA,GAAiBA,EAAE,CAAnBA,WAAAA,GAAAA,UAAAA,GAAhD,WAA+C,CAA/C;AACA,MAAIuE,eAAe,GAAGD,sBAAsB,CAACtE,EAAE,CAAFA,YAAAA,GAAkBA,EAAE,CAApBA,YAAAA,GAAAA,SAAAA,GAA7C,YAA4C,CAA5C;AACA,MAAIqC,GAAG,GAAG;AACN2B,IAAAA,UAAU,EADJ,UAAA;AAENE,IAAAA,WAAW,EAFL,WAAA;AAGNC,IAAAA,SAAS,EAHH,SAAA;AAINC,IAAAA,YAAY,EAJN,YAAA;AAKNG,IAAAA,eAAe,EALT,eAAA;AAMNC,IAAAA,aAAa,EANP,CAAA;AAONC,IAAAA,cAAc,EAAE;AAPV,GAAV;;AASA,MAAIC,uBAAuB,MAAMZ,aAAa,CAAbA,SAAAA,KAAjC,KAAA,EAAoE;AAAE;AAClEzB,IAAAA,GAAG,CAAHA,aAAAA,GAAAA,kBAAAA;AADJ,GAAA,MAGK;AACDA,IAAAA,GAAG,CAAHA,cAAAA,GAAAA,kBAAAA;AACH;;AACD,MAAA,UAAA,EAAgB;AACZA,IAAAA,GAAG,CAAHA,WAAAA,GAAkB4B,QAAQ,CAACH,aAAa,CAAd,WAAA,EAARG,EAAQ,CAARA,IAAlB5B,CAAAA;AACAA,IAAAA,GAAG,CAAHA,YAAAA,GAAmB4B,QAAQ,CAACH,aAAa,CAAd,YAAA,EAARG,EAAQ,CAARA,IAAnB5B,CAAAA;AACAA,IAAAA,GAAG,CAAHA,UAAAA,GAAiB4B,QAAQ,CAACH,aAAa,CAAd,UAAA,EAARG,EAAQ,CAARA,IAAjB5B,CAAAA;AACAA,IAAAA,GAAG,CAAHA,aAAAA,GAAoB4B,QAAQ,CAACH,aAAa,CAAd,aAAA,EAARG,EAAQ,CAARA,IAApB5B,CAAAA;AACH;;AACD,SAAA,GAAA;AACH;;AACD,SAAA,gBAAA,CAAA,EAAA,EAAA,eAAA,EAA+C;AAC3C,MAAIsC,eAAe,KAAK,KAAxB,CAAA,EAAgC;AAAEA,IAAAA,eAAe,GAAfA,KAAAA;AAA0B;;AAC5D,MAAIC,SAAS,GAAGC,WAAW,CAA3B,EAA2B,CAA3B;AACA,MAAIC,KAAK,GAAGC,YAAY,CAAA,EAAA,EAAxB,eAAwB,CAAxB;AACA,MAAI1C,GAAG,GAAG;AACNC,IAAAA,IAAI,EAAEsC,SAAS,CAATA,IAAAA,GAAiBE,KAAK,CAAtBF,UAAAA,GAAoCE,KAAK,CADzC,aAAA;AAENpC,IAAAA,KAAK,EAAEkC,SAAS,CAATA,KAAAA,GAAkBE,KAAK,CAAvBF,WAAAA,GAAsCE,KAAK,CAF5C,cAAA;AAGNnC,IAAAA,GAAG,EAAEiC,SAAS,CAATA,GAAAA,GAAgBE,KAAK,CAHpB,SAAA;AAINlC,IAAAA,MAAM,EAAEgC,SAAS,CAATA,MAAAA,GAAmBE,KAAK,CAAxBF,YAAAA,GAAwCE,KAAK,CAACP;AAJhD,GAAV;;AAMA,MAAA,eAAA,EAAqB;AACjBlC,IAAAA,GAAG,CAAHA,IAAAA,IAAYyC,KAAK,CAAjBzC,WAAAA;AACAA,IAAAA,GAAG,CAAHA,KAAAA,IAAayC,KAAK,CAAlBzC,YAAAA;AACAA,IAAAA,GAAG,CAAHA,GAAAA,IAAWyC,KAAK,CAAhBzC,UAAAA;AACAA,IAAAA,GAAG,CAAHA,MAAAA,IAAcyC,KAAK,CAAnBzC,aAAAA;AACH;;AACD,SAAA,GAAA;AACH;;AACD,SAAA,WAAA,CAAA,EAAA,EAAyB;AACrB,MAAID,IAAI,GAAGpC,EAAE,CAAb,qBAAWA,EAAX;AACA,SAAO;AACHsC,IAAAA,IAAI,EAAEF,IAAI,CAAJA,IAAAA,GAAY2B,MAAM,CADrB,WAAA;AAEHpB,IAAAA,GAAG,EAAEP,IAAI,CAAJA,GAAAA,GAAW2B,MAAM,CAFnB,WAAA;AAGHrB,IAAAA,KAAK,EAAEN,IAAI,CAAJA,KAAAA,GAAa2B,MAAM,CAHvB,WAAA;AAIHnB,IAAAA,MAAM,EAAER,IAAI,CAAJA,MAAAA,GAAc2B,MAAM,CAACiB;AAJ1B,GAAP;AAMH;;AACD,SAAA,mBAAA,GAA+B;AAC3B,SAAO;AACH1C,IAAAA,IAAI,EAAEyB,MAAM,CADT,WAAA;AAEHrB,IAAAA,KAAK,EAAEqB,MAAM,CAANA,WAAAA,GAAqB9D,QAAQ,CAARA,eAAAA,CAFzB,WAAA;AAGH0C,IAAAA,GAAG,EAAEoB,MAAM,CAHR,WAAA;AAIHnB,IAAAA,MAAM,EAAEmB,MAAM,CAANA,WAAAA,GAAqB9D,QAAQ,CAARA,eAAAA,CAAyBgF;AAJnD,GAAP;AAMH;;AACD,SAAA,uBAAA,CAAA,EAAA,EAAqC;AACjC,SAAOjF,EAAE,CAAFA,qBAAAA,GAAAA,MAAAA,GAAoCkF,eAAe,CAA1D,EAA0D,CAA1D;AACH;;AACD,SAAA,eAAA,CAAA,EAAA,EAA6B;AACzB,MAAIC,QAAQ,GAAGpB,MAAM,CAANA,gBAAAA,CAAf,EAAeA,CAAf;AACA,SAAOE,QAAQ,CAACkB,QAAQ,CAAT,SAAA,EAARlB,EAAQ,CAARA,GACHA,QAAQ,CAACkB,QAAQ,CAAT,YAAA,EADZ,EACY,CADZ;EAGJ;;;AACA,SAAA,kBAAA,CAAA,EAAA,EAAgC;AAC5B,MAAItD,OAAO,GAAX,EAAA;;AACA,SAAO7B,EAAE,YAAT,WAAA,EAAkC;AAAE;AAChC,QAAI8D,aAAa,GAAGC,MAAM,CAANA,gBAAAA,CAApB,EAAoBA,CAApB;;AACA,QAAID,aAAa,CAAbA,QAAAA,KAAJ,OAAA,EAAwC;AACpC;AACH;;AACD,QAAI,gBAAA,IAAA,CAAuBA,aAAa,CAAbA,QAAAA,GAAyBA,aAAa,CAAtCA,SAAAA,GAAmDA,aAAa,CAA3F,SAAI,CAAJ,EAAwG;AACpGjC,MAAAA,OAAO,CAAPA,IAAAA,CAAAA,EAAAA;AACH;;AACD7B,IAAAA,EAAE,GAAGA,EAAE,CAAPA,UAAAA;AACH;;AACD,SAAA,OAAA;AACH;;AACD,SAAA,mBAAA,CAAA,EAAA,EAAiC;AAC7B,SAAO,kBAAkB,CAAlB,EAAkB,CAAlB,CAAA,GAAA,CACE,UAAA,EAAA,EAAc;AACnB,WAAOoF,gBAAgB,CAAvB,EAAuB,CAAvB;AAFG,GAAA,EAAA,MAAA,CAIKC,mBAJL,EAAA,EAAA,MAAA,CAKK,UAAA,KAAA,EAAA,KAAA,EAAwB;AAChC,WAAOC,cAAc,CAAA,KAAA,EAAdA,KAAc,CAAdA,IADyB,KAChC,CADgC,CACc;AANlD,GAAO,CAAP;EAUJ;;;AACA,SAAA,cAAA,CAAA,EAAA,EAA4B;AACxBC,EAAAA,EAAE,CAAFA,cAAAA;EAEJ;AACA;;;AACA,SAAA,gBAAA,CAAA,SAAA,EAAA,SAAA,EAAA,QAAA,EAAA,OAAA,EAAmE;AAC/D,WAAA,WAAA,CAAA,EAAA,EAAyB;AACrB,QAAIC,YAAY,GAAGC,cAAc,CAACF,EAAE,CAAH,MAAA,EAAjC,QAAiC,CAAjC;;AACA,QAAA,YAAA,EAAkB;AACdG,MAAAA,OAAO,CAAPA,IAAAA,CAAAA,YAAAA,EAAAA,EAAAA,EAAAA,YAAAA;AACH;AACJ;;AACDlF,EAAAA,SAAS,CAATA,gBAAAA,CAAAA,SAAAA,EAAAA,WAAAA;AACA,SAAO,YAAY;AACfA,IAAAA,SAAS,CAATA,mBAAAA,CAAAA,SAAAA,EAAAA,WAAAA;AADJ,GAAA;AAGH;;AACD,SAAA,uBAAA,CAAA,SAAA,EAAA,QAAA,EAAA,YAAA,EAAA,YAAA,EAAkF;AAC9E,MAAA,mBAAA;AACA,SAAOmF,gBAAgB,CAAA,SAAA,EAAA,WAAA,EAAA,QAAA,EAAmC,UAAA,EAAA,EAAA,YAAA,EAA4B;AAClF,QAAIH,YAAY,KAAhB,mBAAA,EAA0C;AACtCI,MAAAA,mBAAmB,GAAnBA,YAAAA;AACAC,MAAAA,YAAY,CAAA,EAAA,EAAZA,YAAY,CAAZA;;AACA,UAAIC,kBAAkB,GAAG,SAArBA,kBAAqB,CAAA,EAAA,EAAc;AACnCF,QAAAA,mBAAmB,GAAnBA,IAAAA;AACAG,QAAAA,YAAY,CAAA,EAAA,EAAZA,YAAY,CAAZA;AACAP,QAAAA,YAAY,CAAZA,mBAAAA,CAAAA,YAAAA,EAAAA,kBAAAA;AANkC,OAGtC,CAHsC,CAQtC;;;AACAA,MAAAA,YAAY,CAAZA,gBAAAA,CAAAA,YAAAA,EAAAA,kBAAAA;AACH;AAXL,GAAuB,CAAvB;EAcJ;AACA;;;AACA,IAAIQ,oBAAoB,GAAG,CAAA,qBAAA,EAAA,gBAAA,EAAA,gBAAA,EAAA,iBAAA,EAA3B,eAA2B,CAA3B,C,CAOA;;AACA,SAAA,kBAAA,CAAA,EAAA,EAAA,QAAA,EAA0C;AACtC,MAAIC,YAAY,GAAG,SAAfA,YAAe,CAAA,EAAA,EAAc;AAC7BC,IAAAA,QAAQ,CAARA,EAAQ,CAARA;AACAF,IAAAA,oBAAoB,CAApBA,OAAAA,CAA6B,UAAA,SAAA,EAAqB;AAC9ChG,MAAAA,EAAE,CAAFA,mBAAAA,CAAAA,SAAAA,EAAAA,YAAAA;AADJgG,KAAAA;AAFJ,GAAA;;AAMAA,EAAAA,oBAAoB,CAApBA,OAAAA,CAA6B,UAAA,SAAA,EAAqB;AAC9ChG,IAAAA,EAAE,CAAFA,gBAAAA,CAAAA,SAAAA,EAD8C,YAC9CA,EAD8C,CACA;AADlDgG,GAAAA;AAGH;;AAED,IAAIG,OAAO,GAAG,CAAA,KAAA,EAAA,KAAA,EAAA,KAAA,EAAA,KAAA,EAAA,KAAA,EAAA,KAAA,EAAd,KAAc,CAAd,C,CACA;;AACA,SAAA,QAAA,CAAA,CAAA,EAAA,CAAA,EAAwB;AACpB,MAAIC,CAAC,GAAGC,cAAc,CAAtB,CAAsB,CAAtB;AACAD,EAAAA,CAAC,CAADA,CAAC,CAADA,IAAQE,CAAC,GAATF,CAAAA;AACA,SAAOG,cAAc,CAArB,CAAqB,CAArB;AACH;;AACD,SAAA,OAAA,CAAA,CAAA,EAAA,CAAA,EAAuB;AACnB,MAAIH,CAAC,GAAGC,cAAc,CAAtB,CAAsB,CAAtB;AACAD,EAAAA,CAAC,CAADA,CAAC,CAADA,IAAAA,CAAAA;AACA,SAAOG,cAAc,CAArB,CAAqB,CAArB;AACH;;AACD,SAAA,KAAA,CAAA,CAAA,EAAA,CAAA,EAAqB;AACjB,MAAIH,CAAC,GAAGC,cAAc,CAAtB,CAAsB,CAAtB;AACAD,EAAAA,CAAC,CAADA,CAAC,CAADA,IAAAA,CAAAA;AACA,SAAOG,cAAc,CAArB,CAAqB,CAArB;EAEJ;;;AACA,SAAA,SAAA,CAAA,EAAA,EAAA,EAAA,EAA2B;AACvB,SAAOC,QAAQ,CAAA,EAAA,EAARA,EAAQ,CAARA,GAAP,CAAA;AACH;;AACD,SAAA,QAAA,CAAA,EAAA,EAAA,EAAA,EAA0B;AACtB,SAAO,CAACC,EAAE,CAAFA,OAAAA,KAAeC,EAAE,CAAlB,OAAgBA,EAAhB,KAAiC,OAAA,EAAA,GAAA,EAAA,GAAxC,EAAO,CAAP;AACH;;AACD,SAAA,SAAA,CAAA,EAAA,EAAA,EAAA,EAA2B;AACvB,SAAO,CAACD,EAAE,CAAFA,OAAAA,KAAeC,EAAE,CAAlB,OAAgBA,EAAhB,KAAiC,OAAA,EAAA,GAAxC,EAAO,CAAP;AACH;;AACD,SAAA,WAAA,CAAA,EAAA,EAAA,EAAA,EAA6B;AACzB,SAAO,CAACD,EAAE,CAAFA,OAAAA,KAAeC,EAAE,CAAlB,OAAgBA,EAAhB,KAAiC,OAAxC,EAAO,CAAP;AACH;;AACD,SAAA,WAAA,CAAA,EAAA,EAAA,EAAA,EAA6B;AACzB,SAAO,CAACD,EAAE,CAAFA,OAAAA,KAAeC,EAAE,CAAlB,OAAgBA,EAAhB,IAAP,IAAA;AACH;;AACD,SAAA,cAAA,CAAA,EAAA,EAAA,EAAA,EAAgC;AAC5B,MAAIC,KAAK,GAAGC,UAAU,CAAtB,EAAsB,CAAtB;AACA,MAAIC,KAAK,GAAGD,UAAU,CAAtB,EAAsB,CAAtB;AACA,SAAO;AACHE,IAAAA,KAAK,EADF,CAAA;AAEHC,IAAAA,MAAM,EAFH,CAAA;AAGHC,IAAAA,IAAI,EAAEzE,IAAI,CAAJA,KAAAA,CAAWiE,QAAQ,CAAA,KAAA,EAHtB,KAGsB,CAAnBjE,CAHH;AAIH0E,IAAAA,YAAY,EAAGR,EAAE,CAAFA,OAAAA,KAAeI,KAAK,CAArB,OAAgBA,EAAfJ,IAAmCC,EAAE,CAAFA,OAAAA,KAAeC,KAAK,CAAxD,OAAmDA,EAAlDF;AAJZ,GAAP;EAOJ;;;AACA,SAAA,cAAA,CAAA,EAAA,EAAA,EAAA,EAAgC;AAC5B,MAAIS,CAAC,GAAGC,aAAa,CAAA,EAAA,EAArB,EAAqB,CAArB;;AACA,MAAID,CAAC,KAADA,IAAAA,IAAcA,CAAC,GAADA,CAAAA,KAAlB,CAAA,EAA+B;AAC3B,WAAOA,CAAC,GAAR,CAAA;AACH;;AACD,SAAA,IAAA;AACH;;AACD,SAAA,aAAA,CAAA,EAAA,EAAA,EAAA,EAA+B;AAC3B,MAAIE,QAAQ,CAARA,EAAQ,CAARA,KAAiBA,QAAQ,CAA7B,EAA6B,CAA7B,EAAmC;AAC/B,WAAO7E,IAAI,CAAJA,KAAAA,CAAWiE,QAAQ,CAAA,EAAA,EAA1B,EAA0B,CAAnBjE,CAAP;AACH;;AACD,SAAA,IAAA;EAEJ;;;AACA,SAAA,UAAA,CAAA,CAAA,EAAuB;AACnB,SAAOgE,cAAc,CAAC,CAClBc,CAAC,CADiB,cAClBA,EADkB,EAElBA,CAAC,CAFiB,WAElBA,EAFkB,EAGlBA,CAAC,CAHL,UAGIA,EAHkB,CAAD,CAArB;AAKH;;AACD,SAAA,WAAA,CAAA,CAAA,EAAwB;AACpB,SAAOd,cAAc,CAAC,CAClBc,CAAC,CADiB,cAClBA,EADkB,EAElBA,CAAC,CAFiB,WAElBA,EAFkB,EAGlBA,CAAC,CAHiB,UAGlBA,EAHkB,EAIlBA,CAAC,CAJL,WAIIA,EAJkB,CAAD,CAArB;AAMH;;AACD,SAAA,aAAA,CAAA,CAAA,EAA0B;AACtB,SAAOd,cAAc,CAAC,CAClBc,CAAC,CADiB,cAClBA,EADkB,EAElBA,CAAC,CAFiB,WAElBA,EAFkB,EAGlBA,CAAC,CAHiB,UAGlBA,EAHkB,EAIlBA,CAAC,CAJiB,WAIlBA,EAJkB,EAKlBA,CAAC,CALL,aAKIA,EALkB,CAAD,CAArB;AAOH;;AACD,SAAA,aAAA,CAAA,CAAA,EAA0B;AACtB,SAAOd,cAAc,CAAC,CAClBc,CAAC,CADiB,cAClBA,EADkB,EAElBA,CAAC,CAFiB,WAElBA,EAFkB,EAGlBA,CAAC,CAHiB,UAGlBA,EAHkB,EAIlBA,CAAC,CAJiB,WAIlBA,EAJkB,EAKlBA,CAAC,CALiB,aAKlBA,EALkB,EAMlBA,CAAC,CANL,aAMIA,EANkB,CAAD,CAArB;EASJ;;;AACA,SAAA,UAAA,CAAA,MAAA,EAAA,GAAA,EAAA,GAAA,EAAsC;AAClC,MAAIC,CAAC,GAAGC,MAAM,CAAd,cAAQA,EAAR;AACA,MAAIC,CAAC,GAAGC,eAAe,CAAA,MAAA,EAAA,CAAA,EAAA,GAAA,EAAvB,GAAuB,CAAvB;;AACA,MAAID,CAAC,GAAL,CAAA,EAAW;AACP,WAAOC,eAAe,CAAA,MAAA,EAASH,CAAC,GAAV,CAAA,EAAA,GAAA,EAAtB,GAAsB,CAAtB;AACH;;AACD,MAAII,KAAK,GAAGD,eAAe,CAAA,MAAA,EAASH,CAAC,GAAV,CAAA,EAAA,GAAA,EAA3B,GAA2B,CAA3B;;AACA,MAAII,KAAK,IAAT,CAAA,EAAgB;AACZ,WAAOnF,IAAI,CAAJA,GAAAA,CAAAA,CAAAA,EAAP,KAAOA,CAAP;AACH;;AACD,SAAA,CAAA;AACH;;AACD,SAAA,eAAA,CAAA,MAAA,EAAA,IAAA,EAAA,GAAA,EAAA,GAAA,EAAiD;AAC7C,MAAIoF,cAAc,GAAGpB,cAAc,CAAC,CAAA,IAAA,EAAA,CAAA,EAAU,IAAIqB,eAAe,CAAA,IAAA,EAAA,GAAA,EAAjE,GAAiE,CAA7B,CAAD,CAAnC;AACA,MAAIC,QAAQ,GAAGjB,UAAU,CAAzB,MAAyB,CAAzB;AACA,MAAII,IAAI,GAAGzE,IAAI,CAAJA,KAAAA,CAAWiE,QAAQ,CAAA,cAAA,EAA9B,QAA8B,CAAnBjE,CAAX;AACA,SAAOA,IAAI,CAAJA,KAAAA,CAAWyE,IAAI,GAAfzE,CAAAA,IAJsC,CAI7C,CAJ6C,CAIZ;EAErC;;;AACA,SAAA,eAAA,CAAA,IAAA,EAAA,GAAA,EAAA,GAAA,EAAyC;AACrC;AACA,MAAIuF,GAAG,GAAG,IAAA,GAAA,GAF2B,GAErC,CAFqC,CAGrC;;AACA,MAAIC,KAAK,GAAG,CAAC,IAAIxB,cAAc,CAAC,CAAA,IAAA,EAAA,CAAA,EAAfA,GAAe,CAAD,CAAdA,CAAJ,SAAIA,EAAJ,GAAD,GAAA,IAAZ,CAAA;AACA,SAAO,CAAA,KAAA,GAAA,GAAA,GAAP,CAAA;EAEJ;;;AACA,SAAA,gBAAA,CAAA,IAAA,EAAgC;AAC5B,SAAO,CACHyB,IAAI,CADD,WACHA,EADG,EAEHA,IAAI,CAFD,QAEHA,EAFG,EAGHA,IAAI,CAHD,OAGHA,EAHG,EAIHA,IAAI,CAJD,QAIHA,EAJG,EAKHA,IAAI,CALD,UAKHA,EALG,EAMHA,IAAI,CAND,UAMHA,EANG,EAOHA,IAAI,CAPR,eAOIA,EAPG,CAAP;AASH;;AACD,SAAA,gBAAA,CAAA,CAAA,EAA6B;AACzB,SAAO,IAAA,IAAA,CAAS5B,CAAC,CAAV,CAAU,CAAV,EAAeA,CAAC,CAADA,CAAC,CAADA,IAAf,CAAA,EAA0BA,CAAC,CAADA,CAAC,CAADA,IAAAA,IAAAA,GAAAA,CAAAA,GAAmBA,CAAC,CAA9C,CAA8C,CAA9C,EAAmD;AAC1DA,EAAAA,CAAC,CAADA,CAAC,CAADA,IADO,CAAA,EACIA,CAAC,CAADA,CAAC,CAADA,IADJ,CAAA,EACeA,CAAC,CAADA,CAAC,CAADA,IADtB,CAAO,CAAP;AAEH;;AACD,SAAA,cAAA,CAAA,IAAA,EAA8B;AAC1B,SAAO,CACH4B,IAAI,CADD,cACHA,EADG,EAEHA,IAAI,CAFD,WAEHA,EAFG,EAGHA,IAAI,CAHD,UAGHA,EAHG,EAIHA,IAAI,CAJD,WAIHA,EAJG,EAKHA,IAAI,CALD,aAKHA,EALG,EAMHA,IAAI,CAND,aAMHA,EANG,EAOHA,IAAI,CAPR,kBAOIA,EAPG,CAAP;AASH;;AACD,SAAA,cAAA,CAAA,CAAA,EAA2B;AACvB;AACA;AACA,MAAI5B,CAAC,CAADA,MAAAA,KAAJ,CAAA,EAAoB;AAChBA,IAAAA,CAAC,GAAGA,CAAC,CAADA,MAAAA,CAAS,CAAbA,CAAa,CAATA,CAAJA;AACH;;AACD,SAAO,IAAA,IAAA,CAAS6B,IAAI,CAAJA,GAAAA,CAAAA,KAAAA,CAAAA,IAAAA,EAAhB,CAAgBA,CAAT,CAAP;EAEJ;;;AACA,SAAA,WAAA,CAAA,CAAA,EAAwB;AACpB,SAAO,CAACC,KAAK,CAACb,CAAC,CAAf,OAAcA,EAAD,CAAb;AACH;;AACD,SAAA,QAAA,CAAA,CAAA,EAAqB;AACjB,SAAOA,CAAC,CAADA,WAAAA,KAAAA,IAAAA,GAAAA,EAAAA,GAAAA,EAAAA,GACHA,CAAC,CAADA,aAAAA,KAAAA,IAAAA,GADGA,EAAAA,GAEHA,CAAC,CAADA,aAAAA,KAFGA,IAAAA,GAGHA,CAAC,CAHL,kBAGIA,EAHJ;AAIH;;AAED,IAAIc,cAAc,GAAG,CAAA,OAAA,EAAA,QAAA,EAAA,MAAA,EAArB,cAAqB,CAArB;AACA,IAAIC,QAAQ,GAAZ,0DAAA,C,CACA;;AACA,SAAA,cAAA,CAAA,KAAA,EAAA,IAAA,EAAqC;AACjC,MAAA,EAAA;;AACA,MAAI,OAAA,KAAA,KAAJ,QAAA,EAA+B;AAC3B,WAAOC,WAAW,CAAlB,KAAkB,CAAlB;AADJ,GAAA,MAGK,IAAI,OAAA,KAAA,KAAA,QAAA,IAAJ,KAAA,EAAwC;AAAE;AAC3C,WAAOC,eAAe,CAAtB,KAAsB,CAAtB;AADC,GAAA,MAGA,IAAI,OAAA,KAAA,KAAJ,QAAA,EAA+B;AAChC,WAAOA,eAAe,EAAEC,EAAE,GAAFA,EAAAA,EAASA,EAAE,CAACC,IAAI,IAAPD,cAAE,CAAFA,GAATA,KAAAA,EAAxB,EAAsB,EAAtB;AADC,GAAA,MAGA;AACD,WAAA,IAAA;AACH;AACJ;;AACD,SAAA,WAAA,CAAA,CAAA,EAAwB;AACpB,MAAIlB,CAAC,GAAGe,QAAQ,CAARA,IAAAA,CAAR,CAAQA,CAAR;;AACA,MAAA,CAAA,EAAO;AACH,QAAIK,IAAI,GAAGpB,CAAC,CAADA,CAAC,CAADA,GAAO,CAAPA,CAAAA,GAAX,CAAA;AACA,WAAO;AACHP,MAAAA,KAAK,EADF,CAAA;AAEHC,MAAAA,MAAM,EAFH,CAAA;AAGHC,MAAAA,IAAI,EAAEyB,IAAI,IAAIpB,CAAC,CAADA,CAAC,CAADA,GAAOpD,QAAQ,CAACoD,CAAC,CAAF,CAAE,CAAF,EAAfA,EAAe,CAAfA,GAHX,CAGO,CAHP;AAIHJ,MAAAA,YAAY,EAAEwB,IAAI,IAAI,CAACpB,CAAC,CAADA,CAAC,CAADA,GAAOpD,QAAQ,CAACoD,CAAC,CAAF,CAAE,CAAF,EAAfA,EAAe,CAAfA,GAAD,CAAA,IAAA,EAAA,GAAA,EAAA,GAAA,IAAA,GAAmD;AACrE,OAACA,CAAC,CAADA,CAAC,CAADA,GAAOpD,QAAQ,CAACoD,CAAC,CAAF,CAAE,CAAF,EAAfA,EAAe,CAAfA,GAAD,CAAA,IAAA,EAAA,GADkB,IAAA,GAC4B;AAC9C,OAACA,CAAC,CAADA,CAAC,CAADA,GAAOpD,QAAQ,CAACoD,CAAC,CAAF,CAAE,CAAF,EAAfA,EAAe,CAAfA,GAAD,CAAA,IAFkB,IAAA,KAEuB;AACxCA,MAAAA,CAAC,CAADA,CAAC,CAADA,GAAOpD,QAAQ,CAACoD,CAAC,CAAF,CAAE,CAAF,EAAfA,EAAe,CAAfA,GAHa,CAAI,CAAJ,CAGkB;AAHlB;AAJf,KAAP;AAUH;;AACD,SAAA,IAAA;AACH;;AACD,SAAA,eAAA,CAAA,GAAA,EAA8B;AAC1B,SAAO;AACHP,IAAAA,KAAK,EAAE4B,GAAG,CAAHA,KAAAA,IAAaA,GAAG,CAAhBA,IAAAA,IADJ,CAAA;AAEH3B,IAAAA,MAAM,EAAE2B,GAAG,CAAHA,MAAAA,IAAcA,GAAG,CAAjBA,KAAAA,IAFL,CAAA;AAGH1B,IAAAA,IAAI,EAAE,CAAC0B,GAAG,CAAHA,IAAAA,IAAYA,GAAG,CAAfA,GAAAA,IAAD,CAAA,IACFC,iBAAiB,CAAjBA,GAAiB,CAAjBA,GAJD,CAAA;AAKH1B,IAAAA,YAAY,EAAE,CAACyB,GAAG,CAAHA,KAAAA,IAAaA,GAAG,CAAhBA,IAAAA,IAAD,CAAA,IAAA,EAAA,GAAA,EAAA,GAAA,IAAA,GAAgD;AAC1D,KAACA,GAAG,CAAHA,OAAAA,IAAeA,GAAG,CAAlBA,MAAAA,IAAD,CAAA,IAAA,EAAA,GADU,IAAA,GACqC;AAC/C,KAACA,GAAG,CAAHA,OAAAA,IAAeA,GAAG,CAAlBA,MAAAA,IAAD,CAAA,IAFU,IAAA,KAEgC;AACzCA,IAAAA,GAAG,CAAHA,YAAAA,IAAoBA,GAAG,CAAvBA,WAAAA,IAAuCA,GAAG,CAA1CA,EAAAA,IARF,CAKW,CALX,CAQsD;;AARtD,GAAP;AAUH;;AACD,SAAA,iBAAA,CAAA,GAAA,EAAgC;AAC5B,SAAOA,GAAG,CAAHA,KAAAA,IAAaA,GAAG,CAAhBA,IAAAA,IAAP,CAAA;EAEJ;;;AACA,SAAA,cAAA,CAAA,EAAA,EAAA,EAAA,EAAgC;AAC5B,SAAOE,EAAE,CAAFA,KAAAA,KAAaC,EAAE,CAAfD,KAAAA,IACHA,EAAE,CAAFA,MAAAA,KAAcC,EAAE,CADbD,MAAAA,IAEHA,EAAE,CAAFA,IAAAA,KAAYC,EAAE,CAFXD,IAAAA,IAGHA,EAAE,CAAFA,YAAAA,KAAoBC,EAAE,CAH1B,YAAA;AAIH;;AACD,SAAA,WAAA,CAAA,GAAA,EAA0B;AACtB,SAAOC,GAAG,CAAHA,KAAAA,KAAAA,CAAAA,IAAmBA,GAAG,CAAHA,MAAAA,KAAnBA,CAAAA,IAAuCA,GAAG,CAAHA,IAAAA,KAAvCA,CAAAA,IAAyDA,GAAG,CAAHA,YAAAA,KAAhE,CAAA;EAEJ;;;AACA,SAAA,YAAA,CAAA,EAAA,EAAA,EAAA,EAA8B;AAC1B,SAAO;AACHhC,IAAAA,KAAK,EAAE8B,EAAE,CAAFA,KAAAA,GAAWC,EAAE,CADjB,KAAA;AAEH9B,IAAAA,MAAM,EAAE6B,EAAE,CAAFA,MAAAA,GAAYC,EAAE,CAFnB,MAAA;AAGH7B,IAAAA,IAAI,EAAE4B,EAAE,CAAFA,IAAAA,GAAUC,EAAE,CAHf,IAAA;AAIH5B,IAAAA,YAAY,EAAE2B,EAAE,CAAFA,YAAAA,GAAkBC,EAAE,CAAC5B;AAJhC,GAAP;AAMH;;AACD,SAAA,iBAAA,CAAA,EAAA,EAAA,EAAA,EAAmC;AAC/B,SAAO;AACHH,IAAAA,KAAK,EAAE+B,EAAE,CAAFA,KAAAA,GAAWD,EAAE,CADjB,KAAA;AAEH7B,IAAAA,MAAM,EAAE8B,EAAE,CAAFA,MAAAA,GAAYD,EAAE,CAFnB,MAAA;AAGH5B,IAAAA,IAAI,EAAE6B,EAAE,CAAFA,IAAAA,GAAUD,EAAE,CAHf,IAAA;AAIH3B,IAAAA,YAAY,EAAE4B,EAAE,CAAFA,YAAAA,GAAkBD,EAAE,CAAC3B;AAJhC,GAAP;AAMH;;AACD,SAAA,gBAAA,CAAA,CAAA,EAAA,CAAA,EAAgC;AAC5B,SAAO;AACHH,IAAAA,KAAK,EAAEI,CAAC,CAADA,KAAAA,GADJ,CAAA;AAEHH,IAAAA,MAAM,EAAEG,CAAC,CAADA,MAAAA,GAFL,CAAA;AAGHF,IAAAA,IAAI,EAAEE,CAAC,CAADA,IAAAA,GAHH,CAAA;AAIHD,IAAAA,YAAY,EAAEC,CAAC,CAADA,YAAAA,GAAiBZ;AAJ5B,GAAP;EAOJ;AACA;;;AACA,SAAA,YAAA,CAAA,GAAA,EAA2B;AACvB,SAAOyC,WAAW,CAAXA,GAAW,CAAXA,GAAP,GAAA;AACH;;AACD,SAAA,aAAA,CAAA,GAAA,EAA4B;AACxB,SAAOA,WAAW,CAAXA,GAAW,CAAXA,GAAP,EAAA;AACH;;AACD,SAAA,WAAA,CAAA,GAAA,EAA0B;AACtB,SAAOC,SAAS,CAATA,GAAS,CAATA,GAAP,KAAA;AACH;;AACD,SAAA,cAAA,CAAA,GAAA,EAA6B;AACzB,SAAOA,SAAS,CAATA,GAAS,CAATA,IAAkB,OAAzB,EAAOA,CAAP;AACH;;AACD,SAAA,cAAA,CAAA,GAAA,EAA6B;AACzB,SAAOA,SAAS,CAATA,GAAS,CAATA,GAAP,IAAA;AACH;;AACD,SAAA,SAAA,CAAA,GAAA,EAAwB;AACpB,SAAOF,GAAG,CAAHA,KAAAA,IAAa,MAAbA,KAAAA,IACHA,GAAG,CAAHA,MAAAA,IAAc,KADXA,KACHA,CADGA,GAEHA,GAAG,CAAHA,IAAAA,GAFGA,KAAAA,GAGHA,GAAG,CAHP,YAAA;EAKJ;;;AACA,SAAA,oBAAA,CAAA,SAAA,EAAA,WAAA,EAAsD;AAClD,MAAIzG,GAAG,GAAP,IAAA;;AACA,OAAK,IAAIvB,CAAC,GAAV,CAAA,EAAgBA,CAAC,GAAGqH,cAAc,CAAlC,MAAA,EAA2CrH,CAA3C,EAAA,EAAgD;AAC5C,QAAI0H,IAAI,GAAGL,cAAc,CAAzB,CAAyB,CAAzB;;AACA,QAAIc,WAAW,CAAf,IAAe,CAAf,EAAuB;AACnB,UAAIC,QAAQ,GAAGC,SAAS,CAATA,IAAS,CAATA,GAAkBF,WAAW,CAA5C,IAA4C,CAA5C;;AACA,UAAI,CAACG,KAAK,CAAN,QAAM,CAAN,IAAqB/G,GAAG,KAAHA,IAAAA,IAAgBA,GAAG,KAA5C,QAAA,EAA4D;AACxD,eAAA,IAAA;AACH;;AACDA,MAAAA,GAAG,GAAHA,QAAAA;AALJ,KAAA,MAOK,IAAI8G,SAAS,CAAb,IAAa,CAAb,EAAqB;AACtB;AACA,aAAA,IAAA;AACH;AACJ;;AACD,SAAA,GAAA;AACH;;AACD,SAAA,2BAAA,CAAA,GAAA,EAAA,eAAA,EAA2D;AACvD,MAAIE,EAAE,GAAGP,GAAG,CAAZ,YAAA;;AACA,MAAA,EAAA,EAAQ;AACJ,QAAIO,EAAE,GAAFA,IAAAA,KAAJ,CAAA,EAAqB;AACjB,aAAO;AAAEb,QAAAA,IAAI,EAAN,aAAA;AAAuBc,QAAAA,KAAK,EAAED;AAA9B,OAAP;AACH;;AACD,QAAIA,EAAE,IAAI,OAANA,EAAE,CAAFA,KAAJ,CAAA,EAA4B;AACxB,aAAO;AAAEb,QAAAA,IAAI,EAAN,QAAA;AAAkBc,QAAAA,KAAK,EAAED,EAAE,GAAG;AAA9B,OAAP;AACH;;AACD,QAAIA,EAAE,IAAI,OAAA,EAAA,GAANA,EAAE,CAAFA,KAAJ,CAAA,EAAiC;AAC7B,aAAO;AAAEb,QAAAA,IAAI,EAAN,QAAA;AAAkBc,QAAAA,KAAK,EAAED,EAAE,IAAI,OAAJ,EAAA;AAA3B,OAAP;AACH;;AACD,QAAA,EAAA,EAAQ;AACJ,aAAO;AAAEb,QAAAA,IAAI,EAAN,MAAA;AAAgBc,QAAAA,KAAK,EAAED,EAAE,IAAI,OAAA,EAAA,GAAJ,EAAA;AAAzB,OAAP;AACH;AACJ;;AACD,MAAIP,GAAG,CAAP,IAAA,EAAc;AACV,QAAI,CAAA,eAAA,IAAoBA,GAAG,CAAHA,IAAAA,GAAAA,CAAAA,KAAxB,CAAA,EAA4C;AACxC,aAAO;AAAEN,QAAAA,IAAI,EAAN,MAAA;AAAgBc,QAAAA,KAAK,EAAER,GAAG,CAAHA,IAAAA,GAAW;AAAlC,OAAP;AACH;;AACD,WAAO;AAAEN,MAAAA,IAAI,EAAN,KAAA;AAAec,MAAAA,KAAK,EAAER,GAAG,CAAC9B;AAA1B,KAAP;AACH;;AACD,MAAI8B,GAAG,CAAP,MAAA,EAAgB;AACZ,WAAO;AAAEN,MAAAA,IAAI,EAAN,OAAA;AAAiBc,MAAAA,KAAK,EAAER,GAAG,CAAC/B;AAA5B,KAAP;AACH;;AACD,MAAI+B,GAAG,CAAP,KAAA,EAAe;AACX,WAAO;AAAEN,MAAAA,IAAI,EAAN,MAAA;AAAgBc,MAAAA,KAAK,EAAER,GAAG,CAAChC;AAA3B,KAAP;AACH;;AACD,SAAO;AAAE0B,IAAAA,IAAI,EAAN,aAAA;AAAuBc,IAAAA,KAAK,EAAE;AAA9B,GAAP;AACH;AAED;AACA;AACA;AACA;;;AACA,SAAA,gBAAA,CAAA,KAAA,EAAA,eAAA,EAAkD;AAC9C,MAAIC,eAAe,CAAnB,IAAA,EAA0B;AACtBpJ,IAAAA,UAAU,CAAA,KAAA,EAAQ;AACdqJ,MAAAA,eAAe,EADD,CAAA;AAEdC,MAAAA,UAAU,EAAEF,eAAe,CAAfA,IAAAA,GAAuB;AAFrB,KAAR,CAAVpJ;AAIH;;AACD,MAAIoJ,eAAe,CAAnB,KAAA,EAA2B;AACvBpJ,IAAAA,UAAU,CAAA,KAAA,EAAQ;AACduJ,MAAAA,gBAAgB,EADF,CAAA;AAEdC,MAAAA,WAAW,EAAEJ,eAAe,CAAfA,KAAAA,GAAwB;AAFvB,KAAR,CAAVpJ;AAIH;EAEL;;;AACA,SAAA,kBAAA,CAAA,KAAA,EAAmC;AAC/BA,EAAAA,UAAU,CAAA,KAAA,EAAQ;AACdsJ,IAAAA,UAAU,EADI,EAAA;AAEdE,IAAAA,WAAW,EAFG,EAAA;AAGdH,IAAAA,eAAe,EAHD,EAAA;AAIdE,IAAAA,gBAAgB,EAAE;AAJJ,GAAR,CAAVvJ;EAOJ;;;AACA,SAAA,aAAA,GAAyB;AACrBF,EAAAA,QAAQ,CAARA,IAAAA,CAAAA,SAAAA,CAAAA,GAAAA,CAAAA,gBAAAA;EAEJ;;;AACA,SAAA,YAAA,GAAwB;AACpBA,EAAAA,QAAQ,CAARA,IAAAA,CAAAA,SAAAA,CAAAA,MAAAA,CAAAA,gBAAAA;EAEJ;AACA;AACA;AACA;;;AACA,SAAA,gBAAA,CAAA,GAAA,EAAA,eAAA,EAAA,kBAAA,EAAoE;AAChE;AACA;AACA,MAAI2J,UAAU,GAAGrH,IAAI,CAAJA,KAAAA,CAAWsH,eAAe,GAAG1I,GAAG,CAHe,MAG/CoB,CAAjB,CAHgE,CAGL;;AAC3D,MAAIuH,UAAU,GAAGvH,IAAI,CAAJA,KAAAA,CAAWsH,eAAe,GAAGD,UAAU,IAAIzI,GAAG,CAAHA,MAAAA,GAJI,CAIR,CAAvCoB,CAAjB,CAJgE,CAIc;;AAC9E,MAAIwH,OAAO,GALqD,EAKhE,CALgE,CAK9C;;AAClB,MAAIC,WAAW,GANiD,EAMhE,CANgE,CAM1C;;AACtB,MAAIC,WAAW,GAPiD,EAOhE,CAPgE,CAO1C;;AACtB,MAAIC,UAAU,GAAd,CAAA;AACAC,EAAAA,kBAAkB,CAT8C,GAS9C,CAAlBA,CATgE,CASvC;AACzB;AACA;;AACAhJ,EAAAA,GAAG,CAAHA,OAAAA,CAAY,UAAA,EAAA,EAAA,CAAA,EAAiB;AACzB,QAAIiJ,SAAS,GAAGtJ,CAAC,KAAKK,GAAG,CAAHA,MAAAA,GAANL,CAAAA,GAAAA,UAAAA,GAAhB,UAAA;AACA,QAAIuJ,aAAa,GAAGrK,EAAE,CAAFA,qBAAAA,GAApB,MAAA;AACA,QAAIsK,aAAa,GAAGD,aAAa,GAAGnF,eAAe,CAAnD,EAAmD,CAAnD;;AACA,QAAIoF,aAAa,GAAjB,SAAA,EAA+B;AAC3BP,MAAAA,OAAO,CAAPA,IAAAA,CAAAA,EAAAA;AACAC,MAAAA,WAAW,CAAXA,IAAAA,CAAAA,aAAAA;AACAC,MAAAA,WAAW,CAAXA,IAAAA,CAAAA,aAAAA;AAHJ,KAAA,MAKK;AACD;AACAC,MAAAA,UAAU,IAAVA,aAAAA;AACH;AAxB2D,GAYhE/I,EAZgE,CA0BhE;;AACA,MAAA,kBAAA,EAAwB;AACpB0I,IAAAA,eAAe,IAAfA,UAAAA;AACAD,IAAAA,UAAU,GAAGrH,IAAI,CAAJA,KAAAA,CAAWsH,eAAe,GAAGE,OAAO,CAAjDH,MAAarH,CAAbqH;AACAE,IAAAA,UAAU,GAAGvH,IAAI,CAAJA,KAAAA,CAAWsH,eAAe,GAAGD,UAAU,IAAIG,OAAO,CAAPA,MAAAA,GAHpC,CAGgC,CAAvCxH,CAAbuH,CAHoB,CAG0D;AA9BlB,GAAA,CAgChE;;;AACAC,EAAAA,OAAO,CAAPA,OAAAA,CAAgB,UAAA,EAAA,EAAA,CAAA,EAAiB;AAC7B,QAAIK,SAAS,GAAGtJ,CAAC,KAAKiJ,OAAO,CAAPA,MAAAA,GAANjJ,CAAAA,GAAAA,UAAAA,GAAhB,UAAA;AACA,QAAIwJ,aAAa,GAAGN,WAAW,CAA/B,CAA+B,CAA/B;AACA,QAAIK,aAAa,GAAGJ,WAAW,CAA/B,CAA+B,CAA/B;AACA,QAAIM,SAAS,GAAGH,SAAS,IAAIE,aAAa,GAJb,aAIJ,CAAzB,CAJ6B,CAIgC;;AAC7D,QAAIA,aAAa,GAAjB,SAAA,EAA+B;AAAE;AAC7BtK,MAAAA,EAAE,CAAFA,KAAAA,CAAAA,MAAAA,GAAkBuK,SAAS,GAA3BvK,IAAAA;AACH;AAPL+J,GAAAA;EAUJ;;;AACA,SAAA,kBAAA,CAAA,GAAA,EAAiC;AAC7B5I,EAAAA,GAAG,CAAHA,OAAAA,CAAY,UAAA,EAAA,EAAc;AACtBnB,IAAAA,EAAE,CAAFA,KAAAA,CAAAA,MAAAA,GAAAA,EAAAA;AADJmB,GAAAA;EAIJ;AACA;AACA;;;AACA,SAAA,eAAA,CAAA,GAAA,EAA8B;AAC1B,MAAIqJ,aAAa,GAAjB,CAAA;AACArJ,EAAAA,GAAG,CAAHA,OAAAA,CAAY,UAAA,EAAA,EAAc;AACtB,QAAIuC,OAAO,GAAG1D,EAAE,CADM,UACtB,CADsB,CACO;;AAC7B,QAAI0D,OAAO,YAAX,WAAA,EAAoC;AAChC,UAAI+G,YAAY,GAAG/G,OAAO,CAAPA,qBAAAA,GAAnB,KAAA;;AACA,UAAI+G,YAAY,GAAhB,aAAA,EAAkC;AAC9BD,QAAAA,aAAa,GAAbA,YAAAA;AACH;AACJ;AAPLrJ,GAAAA;AASAqJ,EAAAA,aAX0B,GAAA,CAWT;;AACjBrJ,EAAAA,GAAG,CAAHA,OAAAA,CAAY,UAAA,EAAA,EAAc;AACtBnB,IAAAA,EAAE,CAAFA,KAAAA,CAAAA,KAAAA,GAAiBwK,aAAa,GAA9BxK,IAAAA;AADJmB,GAAAA;AAGA,SAAA,aAAA;EAEJ;AACA;;;AACA,SAAA,qBAAA,CAAA,OAAA,EAAA,OAAA,EAAiD;AAC7C;AACA,MAAIuJ,gBAAgB,GAAG;AACnBrH,IAAAA,QAAQ,EADW,UAAA;AAEnBf,IAAAA,IAAI,EAAE,CAFa,CAAA,CAEV;;AAFU,GAAvB;AAIAnC,EAAAA,UAAU,CAAA,OAAA,EAAVA,gBAAU,CAAVA;AACAA,EAAAA,UAAU,CAAA,OAAA,EAAVA,gBAAU,CAAVA;AACA,MAAIwK,IAAI,GAAG;AACVzH,EAAAA,OAAO,CAAPA,qBAAAA,GAAAA,MAAAA,GACGQ,OAAO,CAAPA,qBAAAA,GAVyC,MAQ7C,CAR6C,CAW7C;;AACA,MAAIkH,eAAe,GAAG;AAAEvH,IAAAA,QAAQ,EAAV,EAAA;AAAgBf,IAAAA,IAAI,EAAE;AAAtB,GAAtB;AACAnC,EAAAA,UAAU,CAAA,OAAA,EAAVA,eAAU,CAAVA;AACAA,EAAAA,UAAU,CAAA,OAAA,EAAVA,eAAU,CAAVA;AACA,SAAA,IAAA;AACH;AACD;AACA;;;AACA,SAAA,gBAAA,CAAA,EAAA,EAA8B;AAC1BH,EAAAA,EAAE,CAAFA,SAAAA,CAAAA,GAAAA,CAAAA,iBAAAA;AACAA,EAAAA,EAAE,CAAFA,gBAAAA,CAAAA,aAAAA,EAAAA,cAAAA;AACH;;AACD,SAAA,cAAA,CAAA,EAAA,EAA4B;AACxBA,EAAAA,EAAE,CAAFA,SAAAA,CAAAA,MAAAA,CAAAA,iBAAAA;AACAA,EAAAA,EAAE,CAAFA,mBAAAA,CAAAA,aAAAA,EAAAA,cAAAA;AACH;AACD;AACA;;;AACA,SAAA,kBAAA,CAAA,EAAA,EAAgC;AAC5BA,EAAAA,EAAE,CAAFA,gBAAAA,CAAAA,aAAAA,EAAAA,cAAAA;AACH;;AACD,SAAA,gBAAA,CAAA,EAAA,EAA8B;AAC1BA,EAAAA,EAAE,CAAFA,mBAAAA,CAAAA,aAAAA,EAAAA,cAAAA;AACH;AACD;AACA;;;AACA,SAAA,eAAA,CAAA,KAAA,EAAgC;AAC5B,MAAI6K,KAAK,GAAT,EAAA;AACA,MAAIC,MAAM,GAAV,EAAA;AACA,MAAA,CAAA;AACA,MAAA,KAAA;;AACA,MAAI,OAAA,KAAA,KAAJ,QAAA,EAA+B;AAC3BA,IAAAA,MAAM,GAAGC,KAAK,CAALA,KAAAA,CAATD,SAASC,CAATD;AADJ,GAAA,MAGK,IAAI,OAAA,KAAA,KAAJ,UAAA,EAAiC;AAClCA,IAAAA,MAAM,GAAG,CAATA,KAAS,CAATA;AADC,GAAA,MAGA,IAAIpK,KAAK,CAALA,OAAAA,CAAJ,KAAIA,CAAJ,EAA0B;AAC3BoK,IAAAA,MAAM,GAANA,KAAAA;AACH;;AACD,OAAKhK,CAAC,GAAN,CAAA,EAAYA,CAAC,GAAGgK,MAAM,CAAtB,MAAA,EAA+BhK,CAA/B,EAAA,EAAoC;AAChCkK,IAAAA,KAAK,GAAGF,MAAM,CAAdE,CAAc,CAAdA;;AACA,QAAI,OAAA,KAAA,KAAJ,QAAA,EAA+B;AAC3BH,MAAAA,KAAK,CAALA,IAAAA,CAAW,KAAK,CAAL,MAAA,CAAA,CAAA,MAAA,GAAA,GACP;AAAEI,QAAAA,KAAK,EAAED,KAAK,CAALA,SAAAA,CAAT,CAASA,CAAT;AAA6BE,QAAAA,KAAK,EAAE,CAAC;AAArC,OADO,GAEP;AAAED,QAAAA,KAAK,EAAP,KAAA;AAAgBC,QAAAA,KAAK,EAAE;AAAvB,OAFJL;AADJ,KAAA,MAKK,IAAI,OAAA,KAAA,KAAJ,UAAA,EAAiC;AAClCA,MAAAA,KAAK,CAALA,IAAAA,CAAW;AAAEM,QAAAA,IAAI,EAAEH;AAAR,OAAXH;AACH;AACJ;;AACD,SAAA,KAAA;AACH;;AACD,SAAA,mBAAA,CAAA,IAAA,EAAA,IAAA,EAAA,UAAA,EAAqD;AACjD,MAAA,CAAA;AACA,MAAA,GAAA;;AACA,OAAK/J,CAAC,GAAN,CAAA,EAAYA,CAAC,GAAGsK,UAAU,CAA1B,MAAA,EAAmCtK,CAAnC,EAAA,EAAwC;AACpCuK,IAAAA,GAAG,GAAGC,kBAAkB,CAAA,IAAA,EAAA,IAAA,EAAaF,UAAU,CAA/CC,CAA+C,CAAvB,CAAxBA;;AACA,QAAA,GAAA,EAAS;AACL,aAAA,GAAA;AACH;AACJ;;AACD,SAAA,CAAA;AACH;;AACD,SAAA,kBAAA,CAAA,IAAA,EAAA,IAAA,EAAA,SAAA,EAAmD;AAC/C,MAAIE,SAAS,CAAb,IAAA,EAAoB;AAChB,WAAOA,SAAS,CAATA,IAAAA,CAAAA,IAAAA,EAAP,IAAOA,CAAP;AACH;;AACD,SAAOC,eAAe,CAACC,IAAI,CAACF,SAAS,CAAf,KAAK,CAAL,EAAwBG,IAAI,CAACH,SAAS,CAArDC,KAA2C,CAA5B,CAAfA,IACAD,SAAS,CAATA,KAAAA,IADP,CAAOC,CAAP;AAEH;;AACD,SAAA,eAAA,CAAA,CAAA,EAAA,CAAA,EAA+B;AAC3B,MAAI,CAAA,CAAA,IAAM,CAAV,CAAA,EAAc;AACV,WAAA,CAAA;AACH;;AACD,MAAIG,CAAC,IAAL,IAAA,EAAe;AACX,WAAO,CAAP,CAAA;AACH;;AACD,MAAIvF,CAAC,IAAL,IAAA,EAAe;AACX,WAAA,CAAA;AACH;;AACD,MAAI,OAAA,CAAA,KAAA,QAAA,IAAyB,OAAA,CAAA,KAA7B,QAAA,EAAoD;AAChD,WAAOwF,MAAM,CAANA,CAAM,CAANA,CAAAA,aAAAA,CAAwBA,MAAM,CAArC,CAAqC,CAA9BA,CAAP;AACH;;AACD,SAAOxF,CAAC,GAAR,CAAA;AACH;AACD;AACA;;;AACA,SAAA,qBAAA,CAAA,GAAA,EAAoC;AAChC,SAAOyF,GAAG,CAAHA,MAAAA,CAAAA,CAAAA,EAAAA,WAAAA,KAA8BA,GAAG,CAAHA,KAAAA,CAArC,CAAqCA,CAArC;AACH;;AACD,SAAA,QAAA,CAAA,GAAA,EAAA,GAAA,EAA4B;AACxB,MAAIC,CAAC,GAAGF,MAAM,CAAd,GAAc,CAAd;AACA,SAAO,MAAA,MAAA,CAAA,CAAA,EAAgBG,GAAG,GAAGD,CAAC,CAAvB,MAAA,IAAP,CAAA;AACH;AACD;AACA;;;AACA,SAAA,cAAA,CAAA,CAAA,EAAA,CAAA,EAA8B;AAC1B,SAAO1F,CAAC,GAAR,CAAA;AACH;;AACD,SAAA,KAAA,CAAA,CAAA,EAAkB;AACd,SAAOE,CAAC,GAADA,CAAAA,KAAP,CAAA;AACH;AACD;AACA;;;AACA,SAAA,QAAA,CAAA,SAAA,EAAA,OAAA,EAAA,IAAA,EAA4C;AACxC,MAAI,OAAA,SAAA,KAAJ,UAAA,EAAqC;AAAE;AACnC0F,IAAAA,SAAS,GAAG,CAAZA,SAAY,CAAZA;AACH;;AACD,MAAA,SAAA,EAAe;AACX,QAAIlL,CAAC,GAAG,KAAR,CAAA;AACA,QAAImL,GAAG,GAAG,KAAV,CAAA;;AACA,SAAKnL,CAAC,GAAN,CAAA,EAAYA,CAAC,GAAGkL,SAAS,CAAzB,MAAA,EAAkClL,CAAlC,EAAA,EAAuC;AACnCmL,MAAAA,GAAG,GAAGD,SAAS,CAATA,CAAS,CAATA,CAAAA,KAAAA,CAAAA,OAAAA,EAAAA,IAAAA,KAANC,GAAAA;AACH;;AACD,WAAA,GAAA;AACH;AACJ;;AACD,SAAA,YAAA,GAAwB;AACpB,MAAIC,IAAI,GAAR,EAAA;;AACA,OAAK,IAAIC,EAAE,GAAX,CAAA,EAAiBA,EAAE,GAAGC,SAAS,CAA/B,MAAA,EAAwCD,EAAxC,EAAA,EAA8C;AAC1CD,IAAAA,IAAI,CAAJA,EAAI,CAAJA,GAAWE,SAAS,CAApBF,EAAoB,CAApBA;AACH;;AACD,OAAK,IAAIpL,CAAC,GAAV,CAAA,EAAgBA,CAAC,GAAGoL,IAAI,CAAxB,MAAA,EAAiCpL,CAAjC,EAAA,EAAsC;AAClC,QAAIoL,IAAI,CAAJA,CAAI,CAAJA,KAAJ,SAAA,EAA2B;AACvB,aAAOA,IAAI,CAAX,CAAW,CAAX;AACH;AACJ;EAEL;AACA;AACA;AACA;AACA;;;AACA,SAAA,QAAA,CAAA,IAAA,EAAA,IAAA,EAA8B;AAC1B,MAAA,OAAA;AACA,MAAA,IAAA;AACA,MAAA,OAAA;AACA,MAAA,SAAA;AACA,MAAA,MAAA;;AACA,MAAIG,KAAK,GAAG,SAARA,KAAQ,GAAY;AACpB,QAAIC,IAAI,GAAG,IAAA,IAAA,GAAA,OAAA,KAAX,SAAA;;AACA,QAAIA,IAAI,GAAR,IAAA,EAAiB;AACbC,MAAAA,OAAO,GAAGC,UAAU,CAAA,KAAA,EAAQC,IAAI,GAAhCF,IAAoB,CAApBA;AADJ,KAAA,MAGK;AACDA,MAAAA,OAAO,GAAPA,IAAAA;AACAG,MAAAA,MAAM,GAAGvB,IAAI,CAAJA,KAAAA,CAAAA,OAAAA,EAATuB,IAASvB,CAATuB;AACAC,MAAAA,OAAO,GAAGT,IAAI,GAAdS,IAAAA;AACH;AATL,GAAA;;AAWA,SAAO,YAAY;AACfA,IAAAA,OAAO,GAAPA,IAAAA;AACAT,IAAAA,IAAI,GAAJA,SAAAA;AACAU,IAAAA,SAAS,GAAG,IAAA,IAAA,GAAZA,OAAY,EAAZA;;AACA,QAAI,CAAJ,OAAA,EAAc;AACVL,MAAAA,OAAO,GAAGC,UAAU,CAAA,KAAA,EAApBD,IAAoB,CAApBA;AACH;;AACD,WAAA,MAAA;AAPJ,GAAA;EAUJ;AACA;;;AACA,SAAA,WAAA,CAAA,QAAA,EAAA,UAAA,EAAA,QAAA,EAAA,aAAA,EAAoE;AAChE,MAAIM,QAAQ,KAAK,KAAjB,CAAA,EAAyB;AAAEA,IAAAA,QAAQ,GAARA,EAAAA;AAAgB;;AAC3C,MAAIC,OAAO,GAAX,EAAA;;AACA,OAAK,IAAL,GAAA,IAAA,UAAA,EAA4B;AACxB,QAAIC,SAAS,GAAGC,UAAU,CAA1B,GAA0B,CAA1B;;AACA,QAAIC,QAAQ,CAARA,GAAQ,CAARA,KAAJ,SAAA,EAAiC;AAC7B;AACA,UAAIF,SAAS,KAAb,QAAA,EAA4B;AACxBD,QAAAA,OAAO,CAAPA,GAAO,CAAPA,GAAe,OAAOG,QAAQ,CAAf,GAAe,CAAf,KAAA,UAAA,GAAsCA,QAAQ,CAA9C,GAA8C,CAA9C,GAAfH,IAAAA;AADJ,OAAA,MAGK,IAAA,SAAA,EAAe;AAAE;AAClBA,QAAAA,OAAO,CAAPA,GAAO,CAAPA,GAAeC,SAAS,CAACE,QAAQ,CAAjCH,GAAiC,CAAT,CAAxBA;AADC,OAAA,MAGA;AACDA,QAAAA,OAAO,CAAPA,GAAO,CAAPA,GAAeG,QAAQ,CAAvBH,GAAuB,CAAvBA;AACH;AAVL,KAAA,MAYK,IAAID,QAAQ,CAARA,GAAQ,CAARA,KAAJ,SAAA,EAAiC;AAClC;AACAC,MAAAA,OAAO,CAAPA,GAAO,CAAPA,GAAeD,QAAQ,CAAvBC,GAAuB,CAAvBA;AAFC,KAAA,MAIA;AACD;AACA,UAAIC,SAAS,KAAb,MAAA,EAA0B;AACtBD,QAAAA,OAAO,CAAPA,GAAO,CAAPA,GADsB,EACtBA,CADsB,CACH;AADvB,OAAA,MAGK,IAAI,CAAA,SAAA,IAAcC,SAAS,KAAvB,MAAA,IAAsCA,SAAS,KAA/C,OAAA,IAA+DA,SAAS,KAA5E,QAAA,EAA2F;AAC5FD,QAAAA,OAAO,CAAPA,GAAO,CAAPA,GAD4F,IAC5FA,CAD4F,CACvE;AADpB,OAAA,MAGA;AACDA,QAAAA,OAAO,CAAPA,GAAO,CAAPA,GAAeC,SAAS,CADvB,IACuB,CAAxBD,CADC,CAC+B;AACnC;AACJ;AACJ;;AACD,MAAA,aAAA,EAAmB;AACf,SAAK,IAAL,GAAA,IAAA,QAAA,EAA0B;AACtB,UAAIE,UAAU,CAAVA,GAAU,CAAVA,KAAJ,SAAA,EAAmC;AAC/BE,QAAAA,aAAa,CAAbA,GAAa,CAAbA,GAAqBD,QAAQ,CAA7BC,GAA6B,CAA7BA;AACH;AACJ;AACJ;;AACD,SAAA,OAAA;AACH;AACD;AACA;AACA;AACA;;;AACA,SAAA,sBAAA,CAAA,UAAA,EAA4C;AACxC,MAAIC,MAAM,GAAG5K,IAAI,CAAJA,KAAAA,CAAWiE,QAAQ,CAAC4G,UAAU,CAAX,KAAA,EAAmBA,UAAU,CAAhD7K,GAAmB,CAAnBA,KAAb,CAAA;AACA,MAAI8K,KAAK,GAAGzG,UAAU,CAACwG,UAAU,CAAjC,KAAsB,CAAtB;AACA,MAAIE,GAAG,GAAGC,OAAO,CAAA,KAAA,EAAjB,MAAiB,CAAjB;AACA,SAAO;AAAEF,IAAAA,KAAK,EAAP,KAAA;AAAgBC,IAAAA,GAAG,EAAEA;AAArB,GAAP;EAEJ;AACA;;;AACA,SAAA,sBAAA,CAAA,UAAA,EAAA,gBAAA,EAA8D;AAC1D,MAAIE,gBAAgB,KAAK,KAAzB,CAAA,EAAiC;AAAEA,IAAAA,gBAAgB,GAAGC,cAAc,CAAjCD,CAAiC,CAAjCA;AAAuC;;AAC1E,MAAIE,QAAQ,GAAZ,IAAA;AACA,MAAIC,MAAM,GAAV,IAAA;;AACA,MAAIP,UAAU,CAAd,GAAA,EAAoB;AAChBO,IAAAA,MAAM,GAAG/G,UAAU,CAACwG,UAAU,CAA9BO,GAAmB,CAAnBA;AACA,QAAIC,SAAS,GAAGR,UAAU,CAAVA,GAAAA,CAAAA,OAAAA,KAA2BO,MAAM,CAFjC,OAE2BA,EAA3C,CAFgB,CAE6C;AAC7D;AACA;AACA;;AACA,QAAIC,SAAS,IAAIA,SAAS,IAAI5E,SAAS,CAAvC,gBAAuC,CAAvC,EAA2D;AACvD2E,MAAAA,MAAM,GAAGJ,OAAO,CAAA,MAAA,EAAhBI,CAAgB,CAAhBA;AACH;AACJ;;AACD,MAAIP,UAAU,CAAd,KAAA,EAAsB;AAClBM,IAAAA,QAAQ,GAAG9G,UAAU,CAACwG,UAAU,CADd,KACG,CAArBM,CADkB,CACuB;AACzC;;AACA,QAAIC,MAAM,IAAIA,MAAM,IAApB,QAAA,EAAkC;AAC9BA,MAAAA,MAAM,GAAGJ,OAAO,CAAA,QAAA,EAAhBI,CAAgB,CAAhBA;AACH;AACJ;;AACD,SAAO;AAAEN,IAAAA,KAAK,EAAP,QAAA;AAAmBC,IAAAA,GAAG,EAAEK;AAAxB,GAAP;EAEJ;;;AACA,SAAA,eAAA,CAAA,KAAA,EAAgC;AAC5B,MAAIE,YAAY,GAAGC,sBAAsB,CAAzC,KAAyC,CAAzC;AACA,SAAOtH,QAAQ,CAACqH,YAAY,CAAb,KAAA,EAAqBA,YAAY,CAAzCrH,GAAQ,CAARA,GAAP,CAAA;AACH;;AACD,SAAA,SAAA,CAAA,KAAA,EAAA,KAAA,EAAA,OAAA,EAAA,SAAA,EAAqD;AACjD,MAAIuH,SAAS,KAAb,MAAA,EAA0B;AACtB,WAAON,cAAc,CAACO,OAAO,CAAPA,cAAAA,CAAAA,KAAAA,EAAD,KAACA,CAAD,EAArB,MAAqB,CAArB;AADJ,GAAA,MAGK,IAAID,SAAS,KAAb,OAAA,EAA2B;AAC5B,WAAON,cAAc,CAACO,OAAO,CAAPA,eAAAA,CAAAA,KAAAA,EAAD,KAACA,CAAD,EAArB,OAAqB,CAArB;AADC,GAAA,MAGA;AACD,WAAOC,cAAc,CAAA,KAAA,EADpB,KACoB,CAArB,CADC,CACoC;AACxC;AACJ;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA;;;AAEA,IAAIC,cAAa,GAAG,SAAA,aAAA,CAAA,CAAA,EAAA,CAAA,EAAe;AAC/BA,EAAAA,cAAa,GAAG,MAAM,CAAN,cAAA,IACX;AAAEC,IAAAA,SAAS,EAAE;AAAb,eAAA,KAAA,IAAsC,UAAA,CAAA,EAAA,CAAA,EAAgB;AAAEjH,IAAAA,CAAC,CAADA,SAAAA,GAAAA,CAAAA;AAD7C,GAAA,IAEZ,UAAA,CAAA,EAAA,CAAA,EAAgB;AAAE,SAAK,IAAL,CAAA,IAAA,CAAA,EAAA;AAAiB,UAAIyE,CAAC,CAADA,cAAAA,CAAJ,CAAIA,CAAJ,EAAyBzE,CAAC,CAADA,CAAC,CAADA,GAAOyE,CAAC,CAARzE,CAAQ,CAARA;AAA1C;AAFtBgH,GAAAA;;AAGA,SAAOA,cAAa,CAAA,CAAA,EAApB,CAAoB,CAApB;AAJJ,CAAA;;AAOA,SAAA,SAAA,CAAA,CAAA,EAAA,CAAA,EAAyB;AACrBA,EAAAA,cAAa,CAAA,CAAA,EAAbA,CAAa,CAAbA;;AACA,WAAA,EAAA,GAAc;AAAE,SAAA,WAAA,GAAA,CAAA;AAAuB;;AACvChH,EAAAA,CAAC,CAADA,SAAAA,GAAcyE,CAAC,KAADA,IAAAA,GAAayC,MAAM,CAANA,MAAAA,CAAbzC,CAAayC,CAAbzC,IAAiC0C,EAAE,CAAFA,SAAAA,GAAe1C,CAAC,CAAhB0C,SAAAA,EAA4B,IAA3EnH,EAA2E,EAA7DyE,CAAdzE;AACH;;AAED,IAAIoH,OAAQ,GAAG,SAAA,QAAA,GAAW;AACtBA,EAAAA,OAAQ,GAAGF,MAAM,CAANA,MAAAA,IAAiB,SAAA,QAAA,CAAA,CAAA,EAAqB;AAC7C,SAAK,IAAA,CAAA,EAAOtN,CAAC,GAAR,CAAA,EAAcwF,CAAC,GAAG8F,SAAS,CAAhC,MAAA,EAAyCtL,CAAC,GAA1C,CAAA,EAAgDA,CAAhD,EAAA,EAAqD;AACjDgL,MAAAA,CAAC,GAAGM,SAAS,CAAbN,CAAa,CAAbA;;AACA,WAAK,IAAL,CAAA,IAAA,CAAA,EAAA;AAAiB,YAAIsC,MAAM,CAANA,SAAAA,CAAAA,cAAAA,CAAAA,IAAAA,CAAAA,CAAAA,EAAJ,CAAIA,CAAJ,EAAgDG,CAAC,CAADA,CAAC,CAADA,GAAOzC,CAAC,CAARyC,CAAQ,CAARA;AAAjE;AACH;;AACD,WAAA,CAAA;AALJD,GAAAA;;AAOA,SAAOA,OAAQ,CAARA,KAAAA,CAAAA,IAAAA,EAAP,SAAOA,CAAP;AARJ,CAAA;;AAWA,SAAA,cAAA,CAAA,UAAA,EAAA,aAAA,EAAA,OAAA,EAAA,cAAA,EAAA,SAAA,EAAuF;AACnF,OAAK,IAAIxN,CAAC,GAAV,CAAA,EAAgBA,CAAC,GAAG0N,cAAc,CAAlC,MAAA,EAA2C1N,CAA3C,EAAA,EAAgD;AAC5C,QAAI2N,cAAc,GAAlB,EAAA;AACA,QAAIC,MAAM,GAAGF,cAAc,CAAdA,CAAc,CAAdA,CAAAA,KAAAA,CAAAA,UAAAA,EAAAA,cAAAA,EAAb,OAAaA,CAAb;;AACA,QAAA,MAAA,EAAY;AACR,UAAIG,MAAM,GAAGF,cAAc,CAA3B,MAAA;AACA,aAAOA,cAAc,CAFb,MAER,CAFQ,CAEsB;;AAC9B,UAAIE,MAAM,IAAV,IAAA,EAAoB;AAChBA,QAAAA,MAAM,GAANA,aAAAA;;AACA,YAAIA,MAAM,IAAV,IAAA,EAAoB;AAChBA,UAAAA,MAAM,GAAGD,MAAM,CAAfC,WAAAA;;AACA,cAAIA,MAAM,IAAV,IAAA,EAAoB;AAChBA,YAAAA,MAAM,GAANA,KAAAA;AACH;AACJ;AACJ;;AACDL,MAAAA,OAAQ,CAAA,SAAA,EAARA,cAAQ,CAARA;;AACA,aAAO;AACHK,QAAAA,MAAM,EADH,MAAA;AAEHC,QAAAA,QAAQ,EAAEF,MAAM,CAFb,QAAA;AAGHG,QAAAA,QAAQ,EAAEH,MAAM,CAHb,QAAA;AAIHI,QAAAA,MAAM,EAAEhO;AAJL,OAAP;AAMH;AACJ;;AACD,SAAA,IAAA;AACH;AACD;AACA;AACA;;;AACA,SAAA,qBAAA,CAAA,QAAA,EAAA,QAAA,EAAA,YAAA,EAAA,OAAA,EAAA,cAAA,EAA0F;AACtF,MAAIiO,OAAO,GAAGP,cAAc,CAACQ,QAAQ,CAARA,YAAAA,CAA7B,MAA4B,CAA5B;AACA,MAAIC,OAAO,GAAG,OAAO,CAAP,MAAA,CAAeD,QAAQ,CAARA,YAAAA,CAAf,QAAA,EAA+C;AACzD3B,IAAAA,KAAK,EAAEW,OAAO,CAAPA,QAAAA,CAAiBkB,YAAY,CAA7BlB,KAAAA,EADkD,QAClDA,CADkD;AAEzDV,IAAAA,GAAG,EAAE4B,YAAY,CAAC5B;AAFuC,GAA/C,EAFwE,OAExE,CAAd,CAFsF,CAMtF;;AACA,MAAI0B,QAAQ,CAAZ,MAAA,EAAqB;AACjBC,IAAAA,OAAO,GAAGA,OAAO,CAAPA,GAAAA,CAAVA,UAAUA,CAAVA;AACH;;AACD,SAAA,OAAA;AACH;;AAED,IAAIE,cAAc,GAAGf,MAAM,CAANA,SAAAA,CAArB,cAAA,C,CACA;AACA;;AACA,SAAA,UAAA,CAAA,QAAA,EAAA,YAAA,EAA4C;AACxC,MAAIgB,IAAI,GAAR,EAAA;AACA,MAAA,CAAA;AACA,MAAA,IAAA;AACA,MAAA,WAAA;AACA,MAAA,CAAA;AACA,MAAA,GAAA;AACA,MAAA,KAAA;;AACA,MAAA,YAAA,EAAkB;AACd,SAAKtO,CAAC,GAAN,CAAA,EAAYA,CAAC,GAAGuO,YAAY,CAA5B,MAAA,EAAqCvO,CAArC,EAAA,EAA0C;AACtCwO,MAAAA,IAAI,GAAGD,YAAY,CAAnBC,CAAmB,CAAnBA;AACAC,MAAAA,WAAW,GAF2B,EAEtCA,CAFsC,CAGtC;;AACA,WAAK3N,CAAC,GAAG4N,QAAQ,CAARA,MAAAA,GAAT,CAAA,EAA8B5N,CAAC,IAA/B,CAAA,EAAsCA,CAAtC,EAAA,EAA2C;AACvCM,QAAAA,GAAG,GAAGsN,QAAQ,CAARA,CAAQ,CAARA,CAANtN,IAAMsN,CAANtN;;AACA,YAAI,OAAA,GAAA,KAAA,QAAA,IAAJ,GAAA,EAAoC;AAAE;AAClCqN,UAAAA,WAAW,CAAXA,OAAAA,CAAAA,GAAAA;AADJ,SAAA,MAGK,IAAIrN,GAAG,KAAP,SAAA,EAAuB;AACxBkN,UAAAA,IAAI,CAAJA,IAAI,CAAJA,GADwB,GACxBA,CADwB,CACN;;AAClB;AACH;AAZiC,OAAA,CActC;;;AACA,UAAIG,WAAW,CAAf,MAAA,EAAwB;AACpBH,QAAAA,IAAI,CAAJA,IAAI,CAAJA,GAAaK,UAAU,CAAvBL,WAAuB,CAAvBA;AACH;AACJ;AA3BmC,GAAA,CA6BxC;;;AACA,OAAKtO,CAAC,GAAG0O,QAAQ,CAARA,MAAAA,GAAT,CAAA,EAA8B1O,CAAC,IAA/B,CAAA,EAAsCA,CAAtC,EAAA,EAA2C;AACvCmB,IAAAA,KAAK,GAAGuN,QAAQ,CAAhBvN,CAAgB,CAAhBA;;AACA,SAAA,IAAA,IAAA,KAAA,EAAoB;AAChB,UAAI,EAAEqN,IAAI,IAAV,IAAI,CAAJ,EAAqB;AAAE;AACnBF,QAAAA,IAAI,CAAJA,IAAI,CAAJA,GAAanN,KAAK,CAAlBmN,IAAkB,CAAlBA;AACH;AACJ;AACJ;;AACD,SAAA,IAAA;AACH;;AACD,SAAA,UAAA,CAAA,IAAA,EAAA,IAAA,EAAgC;AAC5B,MAAIM,QAAQ,GAAZ,EAAA;;AACA,OAAK,IAAL,GAAA,IAAA,IAAA,EAAsB;AAClB,QAAIvE,IAAI,CAACwE,IAAI,CAAL,GAAK,CAAL,EAAR,GAAQ,CAAR,EAA0B;AACtBD,MAAAA,QAAQ,CAARA,GAAQ,CAARA,GAAgBC,IAAI,CAApBD,GAAoB,CAApBA;AACH;AACJ;;AACD,SAAA,QAAA;AACH;;AACD,SAAA,OAAA,CAAA,IAAA,EAAA,IAAA,EAA6B;AACzB,MAAIE,OAAO,GAAX,EAAA;;AACA,OAAK,IAAL,GAAA,IAAA,IAAA,EAAsB;AAClBA,IAAAA,OAAO,CAAPA,GAAO,CAAPA,GAAezE,IAAI,CAACwE,IAAI,CAAL,GAAK,CAAL,EAAnBC,GAAmB,CAAnBA;AACH;;AACD,SAAA,OAAA;AACH;;AACD,SAAA,WAAA,CAAA,CAAA,EAAwB;AACpB,MAAID,IAAI,GAAR,EAAA;;AACA,OAAK,IAAIxD,EAAE,GAAN,CAAA,EAAY0D,GAAG,GAApB,CAAA,EAA0B1D,EAAE,GAAG0D,GAAG,CAAlC,MAAA,EAA2C1D,EAA3C,EAAA,EAAiD;AAC7C,QAAI2D,IAAI,GAAGD,GAAG,CAAd,EAAc,CAAd;AACAF,IAAAA,IAAI,CAAJA,IAAI,CAAJA,GAAAA,IAAAA;AACH;;AACD,SAAA,IAAA;AACH;;AACD,SAAA,iBAAA,CAAA,GAAA,EAAgC;AAC5B,MAAIvJ,CAAC,GAAL,EAAA;;AACA,OAAK,IAAL,GAAA,IAAA,GAAA,EAAqB;AACjBA,IAAAA,CAAC,CAADA,IAAAA,CAAOsC,GAAG,CAAVtC,GAAU,CAAVA;AACH;;AACD,SAAA,CAAA;AACH;;AACD,SAAA,YAAA,CAAA,IAAA,EAAA,IAAA,EAAkC;AAC9B,OAAK,IAAL,GAAA,IAAA,IAAA,EAAsB;AAClB,QAAI+I,cAAc,CAAdA,IAAAA,CAAAA,IAAAA,EAAJ,GAAIA,CAAJ,EAAoC;AAChC,UAAI,EAAEY,GAAG,IAAT,IAAI,CAAJ,EAAoB;AAChB,eAAA,KAAA;AACH;AACJ;AACJ;;AACD,OAAK,IAAL,GAAA,IAAA,IAAA,EAAsB;AAClB,QAAIZ,cAAc,CAAdA,IAAAA,CAAAA,IAAAA,EAAJ,GAAIA,CAAJ,EAAoC;AAChC,UAAI1D,IAAI,CAAJA,GAAI,CAAJA,KAAcC,IAAI,CAAtB,GAAsB,CAAtB,EAA6B;AACzB,eAAA,KAAA;AACH;AACJ;AACJ;;AACD,SAAA,IAAA;AACH;;AAED,SAAA,WAAA,CAAA,SAAA,EAAA,QAAA,EAAA,QAAA,EAAA,cAAA,EAAoE;AAChE,MAAIsE,UAAU,GAAGC,qBAAjB,EAAA;;AACA,OAAK,IAAI9D,EAAE,GAAN,CAAA,EAAY+D,WAAW,GAA5B,SAAA,EAA0C/D,EAAE,GAAG+D,WAAW,CAA1D,MAAA,EAAmE/D,EAAnE,EAAA,EAAyE;AACrE,QAAIgE,QAAQ,GAAGD,WAAW,CAA1B,EAA0B,CAA1B;AACA,QAAIE,KAAK,GAAGC,UAAU,CAAA,QAAA,EAAA,QAAA,EAAA,QAAA,EAAtB,cAAsB,CAAtB;;AACA,QAAA,KAAA,EAAW;AACPC,MAAAA,iBAAiB,CAAA,KAAA,EAAjBA,UAAiB,CAAjBA;AACH;AACJ;;AACD,SAAA,UAAA;AACH;;AACD,SAAA,iBAAA,CAAA,KAAA,EAAA,UAAA,EAA8C;AAC1C,MAAIN,UAAU,KAAK,KAAnB,CAAA,EAA2B;AAAEA,IAAAA,UAAU,GAAGC,qBAAbD,EAAAA;AAAuC;;AACpEA,EAAAA,UAAU,CAAVA,IAAAA,CAAgBI,KAAK,CAALA,GAAAA,CAAhBJ,KAAAA,IAAmCI,KAAK,CAAxCJ,GAAAA;;AACA,MAAII,KAAK,CAAT,QAAA,EAAoB;AAChBJ,IAAAA,UAAU,CAAVA,SAAAA,CAAqBI,KAAK,CAALA,QAAAA,CAArBJ,UAAAA,IAAkDI,KAAK,CAAvDJ,QAAAA;AACH;;AACD,SAAA,UAAA;AACH;;AACD,SAAA,eAAA,CAAA,UAAA,EAAA,YAAA,EAAA,QAAA,EAA6D;AACzD,MAAIhC,OAAO,GAAGuC,QAAQ,CAAtB,OAAA;AACA,MAAIC,IAAI,GAAGR,UAAU,CAArB,IAAA;AAAA,MAA4BS,SAAS,GAAGT,UAAU,CAFO,SAEzD,CAFyD,CAGzD;;AACAS,EAAAA,SAAS,GAAGC,UAAU,CAAA,SAAA,EAAY,UAAA,QAAA,EAAoB;AAClD,WAAO,CAACF,IAAI,CAACG,QAAQ,CAAbH,KAAI,CAAJA,CAAR,YAAA;AADJC,GAAsB,CAAtBA;;AAGA,OAAK,IAAL,KAAA,IAAA,IAAA,EAAwB;AACpB,QAAIG,GAAG,GAAGJ,IAAI,CAAd,KAAc,CAAd;;AACA,QAAII,GAAG,CAAP,YAAA,EAAsB;AAClB,UAAIhC,QAAQ,GAAGgC,GAAG,CAAHA,YAAAA,CAAf,QAAA;;AACA,UAAI,CAAJ,QAAA,EAAe;AACXhC,QAAAA,QAAQ,GAAGgC,GAAG,CAAHA,MAAAA,GACPL,QAAQ,CADDK,0BAAAA,GAEPL,QAAQ,CAFZ3B,yBAAAA;AAGH;;AACD,UAAIiC,MAAM,GAAGC,qBAAqB,CAAA,GAAA,EAAA,QAAA,EAAA,YAAA,EAA8BP,QAAQ,CAAtC,OAAA,EAAgDA,QAAQ,CAARA,YAAAA,CAAAA,KAAAA,CAAlF,cAAkC,CAAlC;;AACA,WAAK,IAAIpE,EAAE,GAAN,CAAA,EAAY4E,QAAQ,GAAzB,MAAA,EAAoC5E,EAAE,GAAG4E,QAAQ,CAAjD,MAAA,EAA0D5E,EAA1D,EAAA,EAAgE;AAC5D,YAAIkB,KAAK,GAAG0D,QAAQ,CAApB,EAAoB,CAApB;AACA,YAAIJ,QAAQ,GAAGK,mBAAmB,CAAA,KAAA,EAAQ;AACtC3D,UAAAA,KAAK,EADiC,KAAA;AAEtCC,UAAAA,GAAG,EAAEU,OAAO,CAAPA,GAAAA,CAAAA,KAAAA,EAAAA,QAAAA;AAFiC,SAAR,CAAlC;AAIAyC,QAAAA,SAAS,CAACE,QAAQ,CAAlBF,UAAS,CAATA,GAAAA,QAAAA;AACH;AACJ;AACJ;;AACD,SAAO;AAAED,IAAAA,IAAI,EAAN,IAAA;AAAcC,IAAAA,SAAS,EAAEA;AAAzB,GAAP;EAEJ;AACA;AACA;;;AACA,SAAA,iBAAA,CAAA,UAAA,EAAA,UAAA,EAAmD;AAC/C,MAAIE,QAAQ,GAAGX,UAAU,CAAVA,SAAAA,CAAf,UAAeA,CAAf;;AACA,MAAA,QAAA,EAAc;AACV,QAAIiB,KAAK,GAAGjB,UAAU,CAAVA,IAAAA,CAAgBW,QAAQ,CAD1B,KACEX,CAAZ,CADU,CAEV;;AACA,QAAIkB,QAAQ,GAAGC,oBAAoB,CAAA,UAAA,EAAa,UAAA,OAAA,EAAmB;AAC/D,aAAOC,kBAAkB,CAAA,KAAA,EAAzB,OAAyB,CAAzB;AAJM,KAGyB,CAAnC,CAHU,CAMV;AACA;;AACAF,IAAAA,QAAQ,CAARA,IAAAA,CAAcD,KAAK,CAAnBC,KAAAA,IAAAA,KAAAA;AACAA,IAAAA,QAAQ,CAARA,SAAAA,CAAmBP,QAAQ,CAA3BO,UAAAA,IAAAA,QAAAA;AACA,WAAA,QAAA;AACH;;AACD,SAAOjB,qBAAP,EAAA;AACH;;AACD,SAAA,kBAAA,CAAA,IAAA,EAAA,IAAA,EAAwC;AACpC,SAAOoB,OAAO,CAACC,IAAI,CAAJA,OAAAA,IAAgBA,IAAI,CAAJA,OAAAA,KAAiBC,IAAI,CAApD,OAAc,CAAd;AACH;;AACD,SAAA,kBAAA,CAAA,SAAA,EAAA,WAAA,EAAA,QAAA,EAA8D;AAC1D,MAAIC,gBAAgB,GAAGjB,QAAQ,CAARA,GAAAA,CAAvB,oBAAuBA,CAAvB;AACA,MAAIkB,mBAAmB,GAAGC,WAAW,GAAGA,WAAW,CAAd,kBAAA,GAArC,IAAA;;AACA,MAAA,mBAAA,EAAyB;AACrBC,IAAAA,SAAS,GAAGC,qBAAqB,CAAA,SAAA,EAAjCD,mBAAiC,CAAjCA;AACH;;AACD,MAAA,gBAAA,EAAsB;AAClBA,IAAAA,SAAS,GAAGC,qBAAqB,CAAA,SAAA,EAAjCD,gBAAiC,CAAjCA;AACH;;AACD,SAAA,SAAA;AACH;;AACD,SAAA,qBAAA,CAAA,SAAA,EAAA,IAAA,EAAgD;AAC5C,MAAA,aAAA;;AACA,MAAI,CAAJ,IAAA,EAAW;AACPE,IAAAA,aAAa,GAAbA,SAAAA;AADJ,GAAA,MAGK;AACDA,IAAAA,aAAa,GAAbA,EAAAA;;AACA,SAAK,IAAI1F,EAAE,GAAN,CAAA,EAAY2F,WAAW,GAA5B,SAAA,EAA0C3F,EAAE,GAAG2F,WAAW,CAA1D,MAAA,EAAmE3F,EAAnE,EAAA,EAAyE;AACrE,UAAIgE,QAAQ,GAAG2B,WAAW,CAA1B,EAA0B,CAA1B;AACA,UAAIC,YAAY,GAAG5G,IAAI,CAAvB,QAAuB,CAAvB;;AACA,UAAA,YAAA,EAAkB;AACd0G,QAAAA,aAAa,CAAbA,IAAAA,CAAAA,YAAAA;AADJ,OAAA,MAGK,IAAIE,YAAY,IAAhB,IAAA,EAA0B;AAC3BF,QAAAA,aAAa,CAAbA,IAAAA,CAAAA,QAAAA;AAPiE,OAAA,CAQnE;;AACL;AACJ;;AACD,SAAA,aAAA;AACH;;AACD,SAAA,qBAAA,GAAiC;AAC7B,SAAO;AAAErB,IAAAA,IAAI,EAAN,EAAA;AAAYC,IAAAA,SAAS,EAAE;AAAvB,GAAP;AACH;;AACD,SAAA,gBAAA,CAAA,MAAA,EAAA,MAAA,EAA0C;AACtC,SAAO;AACHD,IAAAA,IAAI,EAAElC,OAAQ,CAAA,EAAA,EAAK0D,MAAM,CAAX,IAAA,EAAkBC,MAAM,CADnC,IACW,CADX;AAEHxB,IAAAA,SAAS,EAAEnC,OAAQ,CAAA,EAAA,EAAK0D,MAAM,CAAX,SAAA,EAAuBC,MAAM,CAA7B,SAAA;AAFhB,GAAP;AAIH;;AACD,SAAA,oBAAA,CAAA,UAAA,EAAA,UAAA,EAAsD;AAClD,MAAIzB,IAAI,GAAGE,UAAU,CAACV,UAAU,CAAX,IAAA,EAArB,UAAqB,CAArB;AACA,MAAIS,SAAS,GAAGC,UAAU,CAACV,UAAU,CAAX,SAAA,EAAuB,UAAA,QAAA,EAAoB;AACjE,WAAOQ,IAAI,CAACG,QAAQ,CAD6C,KACtD,CAAX,CADiE,CACpC;AADjC,GAA0B,CAA1B;AAGA,SAAO;AAAEH,IAAAA,IAAI,EAAN,IAAA;AAAcC,IAAAA,SAAS,EAAEA;AAAzB,GAAP;AACH;;AAED,SAAA,UAAA,CAAA,KAAA,EAAA,OAAA,EAAoC;AAChC,MAAIpD,KAAK,GAAT,IAAA;AACA,MAAIC,GAAG,GAAP,IAAA;;AACA,MAAIvC,KAAK,CAAT,KAAA,EAAiB;AACbsC,IAAAA,KAAK,GAAGW,OAAO,CAAPA,YAAAA,CAAqBjD,KAAK,CAAlCsC,KAAQW,CAARX;AACH;;AACD,MAAItC,KAAK,CAAT,GAAA,EAAe;AACXuC,IAAAA,GAAG,GAAGU,OAAO,CAAPA,YAAAA,CAAqBjD,KAAK,CAAhCuC,GAAMU,CAANV;AACH;;AACD,MAAI,CAAA,KAAA,IAAU,CAAd,GAAA,EAAoB;AAChB,WAAA,IAAA;AACH;;AACD,MAAID,KAAK,IAALA,GAAAA,IAAgBC,GAAG,GAAvB,KAAA,EAAiC;AAC7B,WAAA,IAAA;AACH;;AACD,SAAO;AAAED,IAAAA,KAAK,EAAP,KAAA;AAAgBC,IAAAA,GAAG,EAAEA;AAArB,GAAP;EAEJ;AACA;;;AACA,SAAA,YAAA,CAAA,MAAA,EAAA,eAAA,EAA+C;AAC3C,MAAI4E,cAAc,GAAlB,EAAA;AACA,MAAI7E,KAAK,GAAG8E,eAAe,CAFgB,KAE3C,CAF2C,CAER;;AACnC,MAAA,CAAA;AACA,MAJ2C,SAI3C,CAJ2C,CAK3C;;AACAC,EAAAA,MAAM,CAANA,IAAAA,CAAAA,aAAAA;;AACA,OAAKtR,CAAC,GAAN,CAAA,EAAYA,CAAC,GAAGsR,MAAM,CAAtB,MAAA,EAA+BtR,CAA/B,EAAA,EAAoC;AAChCuR,IAAAA,SAAS,GAAGD,MAAM,CADc,CACd,CAAlBC,CADgC,CAEhC;;AACA,QAAIA,SAAS,CAATA,KAAAA,GAAJ,KAAA,EAA6B;AAAE;AAC3BH,MAAAA,cAAc,CAAdA,IAAAA,CAAoB;AAAE7E,QAAAA,KAAK,EAAP,KAAA;AAAgBC,QAAAA,GAAG,EAAE+E,SAAS,CAAChF;AAA/B,OAApB6E;AACH;;AACD,QAAIG,SAAS,CAATA,GAAAA,GAAJ,KAAA,EAA2B;AACvBhF,MAAAA,KAAK,GAAGgF,SAAS,CAAjBhF,GAAAA;AACH;AAfsC,GAAA,CAiB3C;;;AACA,MAAIA,KAAK,GAAG8E,eAAe,CAA3B,GAAA,EAAiC;AAAE;AAC/BD,IAAAA,cAAc,CAAdA,IAAAA,CAAoB;AAAE7E,MAAAA,KAAK,EAAP,KAAA;AAAgBC,MAAAA,GAAG,EAAE6E,eAAe,CAAC7E;AAArC,KAApB4E;AACH;;AACD,SAAA,cAAA;AACH;;AACD,SAAA,aAAA,CAAA,MAAA,EAAA,MAAA,EAAuC;AACnC,SAAOI,MAAM,CAANA,KAAAA,CAAAA,OAAAA,KAAyBC,MAAM,CAANA,KAAAA,CADG,OACHA,EAAhC,CADmC,CACqB;AAC3D;;AACD,SAAA,eAAA,CAAA,MAAA,EAAA,MAAA,EAAyC;AACrC,MAAIlF,KAAK,GAAGiF,MAAM,CAAlB,KAAA;AACA,MAAIhF,GAAG,GAAGgF,MAAM,CAAhB,GAAA;AACA,MAAIE,QAAQ,GAAZ,IAAA;;AACA,MAAID,MAAM,CAANA,KAAAA,KAAJ,IAAA,EAA2B;AACvB,QAAIlF,KAAK,KAAT,IAAA,EAAoB;AAChBA,MAAAA,KAAK,GAAGkF,MAAM,CAAdlF,KAAAA;AADJ,KAAA,MAGK;AACDA,MAAAA,KAAK,GAAG,IAAA,IAAA,CAAS9K,IAAI,CAAJA,GAAAA,CAAS8K,KAAK,CAAd9K,OAAS8K,EAAT9K,EAA0BgQ,MAAM,CAANA,KAAAA,CAA3ClF,OAA2CkF,EAA1BhQ,CAAT,CAAR8K;AACH;AACJ;;AACD,MAAIkF,MAAM,CAANA,GAAAA,IAAJ,IAAA,EAAwB;AACpB,QAAIjF,GAAG,KAAP,IAAA,EAAkB;AACdA,MAAAA,GAAG,GAAGiF,MAAM,CAAZjF,GAAAA;AADJ,KAAA,MAGK;AACDA,MAAAA,GAAG,GAAG,IAAA,IAAA,CAAS/K,IAAI,CAAJA,GAAAA,CAAS+K,GAAG,CAAZ/K,OAAS+K,EAAT/K,EAAwBgQ,MAAM,CAANA,GAAAA,CAAvCjF,OAAuCiF,EAAxBhQ,CAAT,CAAN+K;AACH;AACJ;;AACD,MAAID,KAAK,KAALA,IAAAA,IAAkBC,GAAG,KAArBD,IAAAA,IAAkCA,KAAK,GAA3C,GAAA,EAAmD;AAC/CmF,IAAAA,QAAQ,GAAG;AAAEnF,MAAAA,KAAK,EAAP,KAAA;AAAgBC,MAAAA,GAAG,EAAEA;AAArB,KAAXkF;AACH;;AACD,SAAA,QAAA;AACH;;AACD,SAAA,WAAA,CAAA,MAAA,EAAA,MAAA,EAAqC;AACjC,SAAO,CAACF,MAAM,CAANA,KAAAA,KAAAA,IAAAA,GAAAA,IAAAA,GAA+BA,MAAM,CAANA,KAAAA,CAAhC,OAAgCA,EAAhC,OAA6DC,MAAM,CAANA,KAAAA,KAAAA,IAAAA,GAAAA,IAAAA,GAA+BA,MAAM,CAANA,KAAAA,CAA5F,OAA4FA,EAA5F,KACH,CAACD,MAAM,CAANA,GAAAA,KAAAA,IAAAA,GAAAA,IAAAA,GAA6BA,MAAM,CAANA,GAAAA,CAA9B,OAA8BA,EAA9B,OAAyDC,MAAM,CAANA,GAAAA,KAAAA,IAAAA,GAAAA,IAAAA,GAA6BA,MAAM,CAANA,GAAAA,CAD1F,OAC0FA,EAAtF,CADJ;AAEH;;AACD,SAAA,eAAA,CAAA,MAAA,EAAA,MAAA,EAAyC;AACrC,SAAO,CAACD,MAAM,CAANA,GAAAA,KAAAA,IAAAA,IAAuBC,MAAM,CAANA,KAAAA,KAAvBD,IAAAA,IAAgDA,MAAM,CAANA,GAAAA,GAAaC,MAAM,CAApE,KAAA,MACFD,MAAM,CAANA,KAAAA,KAAAA,IAAAA,IAAyBC,MAAM,CAANA,GAAAA,KAAzBD,IAAAA,IAAgDA,MAAM,CAANA,KAAAA,GAAeC,MAAM,CAD1E,GAAO,CAAP;AAEH;;AACD,SAAA,kBAAA,CAAA,UAAA,EAAA,UAAA,EAAoD;AAChD,SAAO,CAACE,UAAU,CAAVA,KAAAA,KAAAA,IAAAA,IAA8BC,UAAU,CAAVA,KAAAA,KAAAA,IAAAA,IAA6BA,UAAU,CAAVA,KAAAA,IAAoBD,UAAU,CAA1F,KAAA,MACFA,UAAU,CAAVA,GAAAA,KAAAA,IAAAA,IAA4BC,UAAU,CAAVA,GAAAA,KAAAA,IAAAA,IAA2BA,UAAU,CAAVA,GAAAA,IAAkBD,UAAU,CADxF,GAAO,CAAP;AAEH;;AACD,SAAA,mBAAA,CAAA,KAAA,EAAA,IAAA,EAA0C;AACtC,SAAO,CAACE,KAAK,CAALA,KAAAA,KAAAA,IAAAA,IAAwB3K,IAAI,IAAI2K,KAAK,CAAtC,KAAA,MACFA,KAAK,CAALA,GAAAA,KAAAA,IAAAA,IAAsB3K,IAAI,GAAG2K,KAAK,CADvC,GAAO,CAAP;EAGJ;AACA;;;AACA,SAAA,sBAAA,CAAA,IAAA,EAAA,KAAA,EAA6C;AACzC,MAAIA,KAAK,CAALA,KAAAA,IAAAA,IAAAA,IAAuB3K,IAAI,GAAG2K,KAAK,CAAvC,KAAA,EAA+C;AAC3C,WAAOA,KAAK,CAAZ,KAAA;AACH;;AACD,MAAIA,KAAK,CAALA,GAAAA,IAAAA,IAAAA,IAAqB3K,IAAI,IAAI2K,KAAK,CAAtC,GAAA,EAA4C;AACxC,WAAO,IAAA,IAAA,CAASA,KAAK,CAALA,GAAAA,CAAAA,OAAAA,KAAhB,CAAO,CAAP;AACH;;AACD,SAAA,IAAA;AACH;;AAED,SAAA,WAAA,CAAA,KAAA,EAAA,QAAA,EAAsC;AAClC,MAAIC,SAAS,GAAb,CAAA;AACA,MAAI9R,CAAC,GAAL,CAAA;;AACA,SAAOA,CAAC,GAAG+R,KAAK,CAAhB,MAAA,EAAyB;AACrB,QAAIA,KAAK,CAALA,CAAK,CAALA,KAAJ,QAAA,EAA2B;AACvBA,MAAAA,KAAK,CAALA,MAAAA,CAAAA,CAAAA,EAAAA,CAAAA;AACAD,MAAAA,SAAS;AAFb,KAAA,MAIK;AACD9R,MAAAA,CAAC;AACJ;AACJ;;AACD,SAAA,SAAA;AACH;;AACD,SAAA,aAAA,CAAA,EAAA,EAAA,EAAA,EAA+B;AAC3B,MAAIiL,GAAG,GAAG+G,EAAE,CAAZ,MAAA;AACA,MAAA,CAAA;;AACA,MAAI/G,GAAG,KAAKgH,EAAE,CAAd,MAAA,EAAuB;AAAE;AACrB,WAAA,KAAA;AACH;;AACD,OAAKjS,CAAC,GAAN,CAAA,EAAYA,CAAC,GAAb,GAAA,EAAqBA,CAArB,EAAA,EAA0B;AACtB,QAAIgS,EAAE,CAAFA,CAAE,CAAFA,KAAUC,EAAE,CAAhB,CAAgB,CAAhB,EAAqB;AACjB,aAAA,KAAA;AACH;AACJ;;AACD,SAAA,IAAA;AACH;;AAED,SAAA,OAAA,CAAA,UAAA,EAA6B;AACzB,MAAA,IAAA;AACA,MAAA,GAAA;AACA,SAAO,YAAY;AACf,QAAI,CAAA,IAAA,IAAS,CAACC,aAAa,CAAA,IAAA,EAA3B,SAA2B,CAA3B,EAA8C;AAC1C9G,MAAAA,IAAI,GAAJA,SAAAA;AACA7J,MAAAA,GAAG,GAAG4Q,UAAU,CAAVA,KAAAA,CAAAA,IAAAA,EAAN5Q,SAAM4Q,CAAN5Q;AACH;;AACD,WAAA,GAAA;AALJ,GAAA;AAOH;AACD;AACA;AACA;AACA;;;AACA,SAAA,aAAA,CAAA,UAAA,EAAA,YAAA,EAAiD;AAC7C,MAAI6Q,SAAS,GAAb,IAAA;AACA,SAAO,YAAY;AACf,QAAIC,MAAM,GAAGF,UAAU,CAAVA,KAAAA,CAAAA,IAAAA,EAAb,SAAaA,CAAb;;AACA,QAAIC,SAAS,KAATA,IAAAA,IAAsB,EAAEA,SAAS,KAATA,MAAAA,IAAwBE,YAAY,CAAA,SAAA,EAAhE,MAAgE,CAAtC,CAA1B,EAAsF;AAClFF,MAAAA,SAAS,GAATA,MAAAA;AACH;;AACD,WAAA,SAAA;AALJ,GAAA;AAOH;;AAED,IAAIG,gCAAgC,GAAG;AACnCC,EAAAA,IAAI,EAD+B,CAAA;AAEnCC,EAAAA,SAAS,EAF0B,CAAA;AAGnCC,EAAAA,cAAc,EAHqB,CAAA;AAInCC,EAAAA,QAAQ,EAJ2B,CAAA;AAKnCC,EAAAA,UAAU,EAAE;AALuB,CAAvC;AAOA,IAAIC,6BAA6B,GAAG;AAChCC,EAAAA,YAAY,EADoB,CAAA;AAEhCC,EAAAA,GAAG,EAF6B,CAAA;AAGhCC,EAAAA,IAAI,EAH4B,CAAA;AAIhCC,EAAAA,KAAK,EAJ2B,CAAA;AAKhCC,EAAAA,GAAG,EAL6B,CAAA;AAMhCC,EAAAA,OAAO,EANyB,CAAA;AAOhCC,EAAAA,IAAI,EAP4B,CAAA;AAQhCC,EAAAA,MAAM,EAR0B,CAAA;AAShCC,EAAAA,MAAM,EAAE;AATwB,CAApC;AAWA,IAAIC,WAAW,GAAf,mBAAA,C,CAAuC;;AACvC,IAAIC,QAAQ,GAAZ,IAAA,C,CAAqB;;AACrB,IAAIC,cAAc,GAAlB,MAAA;AACA,IAAIC,MAAM,GAAV,SAAA,C,CAAwB;;AACxB,IAAIC,MAAM,GAAV,SAAA;;AACA,IAAIC,eAAe;AAAG;AAAe,YAAY;AAC7C,WAAA,eAAA,CAAA,cAAA,EAAyC;AACrC,QAAIC,iBAAiB,GAArB,EAAA;AACA,QAAIC,gBAAgB,GAApB,EAAA;AACA,QAAIC,QAAQ,GAAZ,CAAA;;AACA,SAAK,IAAL,MAAA,IAAA,cAAA,EAAmC;AAC/B,UAAIC,MAAM,IAAV,gCAAA,EAAgD;AAC5CF,QAAAA,gBAAgB,CAAhBA,MAAgB,CAAhBA,GAA2BG,cAAc,CAAzCH,MAAyC,CAAzCA;AACAC,QAAAA,QAAQ,GAAGtS,IAAI,CAAJA,GAAAA,CAAS8Q,gCAAgC,CAAzC9Q,MAAyC,CAAzCA,EAAXsS,QAAWtS,CAAXsS;AAFJ,OAAA,MAIK;AACDF,QAAAA,iBAAiB,CAAjBA,MAAiB,CAAjBA,GAA4BI,cAAc,CAA1CJ,MAA0C,CAA1CA;;AACA,YAAIG,MAAM,IAAV,6BAAA,EAA6C;AACzCD,UAAAA,QAAQ,GAAGtS,IAAI,CAAJA,GAAAA,CAASoR,6BAA6B,CAAtCpR,MAAsC,CAAtCA,EAAXsS,QAAWtS,CAAXsS;AACH;AACJ;AACJ;;AACD,SAAA,iBAAA,GAAA,iBAAA;AACA,SAAA,gBAAA,GAAA,gBAAA;AACA,SAAA,QAAA,GAAA,QAAA;AACA,SAAA,mBAAA,GAA2BG,OAAO,CAAlC,mBAAkC,CAAlC;AACH;;AACDN,EAAAA,eAAe,CAAfA,SAAAA,CAAAA,MAAAA,GAAmC,UAAA,IAAA,EAAA,OAAA,EAAyB;AACxD,WAAO,KAAA,mBAAA,CAAyB,KAAzB,iBAAA,EAAiD,KAAjD,gBAAA,EAAA,OAAA,EAAP,IAAO,CAAP;AADJA,GAAAA;;AAGAA,EAAAA,eAAe,CAAfA,SAAAA,CAAAA,WAAAA,GAAwC,UAAA,KAAA,EAAA,GAAA,EAAA,OAAA,EAA+B;AACnE,QAAInM,EAAE,GAAN,IAAA;AAAA,QAAeoM,iBAAiB,GAAGpM,EAAE,CAArC,iBAAA;AAAA,QAAyDqM,gBAAgB,GAAGrM,EAAE,CAA9E,gBAAA;;AACA,QAAI0M,YAAY,GAAGC,yBAAyB,CAAC7H,KAAK,CAAN,MAAA,EAAeC,GAAG,CAAlB,MAAA,EAA2BX,OAAO,CAA9E,cAA4C,CAA5C;;AACA,QAAI,CAAJ,YAAA,EAAmB;AACf,aAAO,KAAA,MAAA,CAAA,KAAA,EAAP,OAAO,CAAP;AACH;;AACD,QAAIwI,qBAAqB,GAAzB,YAAA;;AACA,QAAIA,qBAAqB,GAArBA,CAAAA,MAA6B;AAC5BR,IAAAA,iBAAiB,CAAjBA,IAAAA,KAAAA,SAAAA,IAAwCA,iBAAiB,CAAjBA,IAAAA,KADzCQ,SAAAA,MAECR,iBAAiB,CAAjBA,KAAAA,KAAAA,SAAAA,IAAyCA,iBAAiB,CAAjBA,KAAAA,KAF1CQ,SAAAA,MAGCR,iBAAiB,CAAjBA,GAAAA,KAAAA,SAAAA,IAAuCA,iBAAiB,CAAjBA,GAAAA,KAH5C,SAAIQ,CAAJ,EAGkF;AAC9EA,MAAAA,qBAAqB,GADyD,CAC9EA,CAD8E,CACnD;AAC9B;;AACD,QAAIC,KAAK,GAAG,KAAA,MAAA,CAAA,KAAA,EAAZ,OAAY,CAAZ;AACA,QAAIC,KAAK,GAAG,KAAA,MAAA,CAAA,GAAA,EAAZ,OAAY,CAAZ;;AACA,QAAID,KAAK,KAAT,KAAA,EAAqB;AACjB,aAAA,KAAA;AACH;;AACD,QAAIE,gBAAgB,GAAGC,+BAA+B,CAAA,iBAAA,EAAtD,qBAAsD,CAAtD;AACA,QAAIC,qBAAqB,GAAGC,mBAAmB,CAAA,gBAAA,EAAA,gBAAA,EAA/C,OAA+C,CAA/C;AACA,QAAIC,QAAQ,GAAGF,qBAAqB,CAApC,KAAoC,CAApC;AACA,QAAIG,QAAQ,GAAGH,qBAAqB,CAApC,GAAoC,CAApC;AACA,QAAII,SAAS,GAAGC,mBAAmB,CAAA,KAAA,EAAA,QAAA,EAAA,KAAA,EAAnC,QAAmC,CAAnC;AACA,QAAItC,SAAS,GAAGqB,gBAAgB,CAAhBA,SAAAA,IAAhB,EAAA;;AACA,QAAA,SAAA,EAAe;AACX,aAAOgB,SAAS,CAATA,MAAAA,GAAAA,QAAAA,GAAAA,SAAAA,GAAAA,QAAAA,GAAqDA,SAAS,CAArE,KAAA;AACH;;AACD,WAAOR,KAAK,GAALA,SAAAA,GAAP,KAAA;AA3BJV,GAAAA;;AA6BAA,EAAAA,eAAe,CAAfA,SAAAA,CAAAA,cAAAA,GAA2C,YAAY;AACnD,YAAQ,KAAR,QAAA;AACI,WAAA,CAAA;AACA,WAAA,CAAA;AACA,WAAA,CAAA;AACI,eAAA,MAAA;;AACJ,WAAA,CAAA;AACI,eAAA,OAAA;;AACJ,WAAA,CAAA;AACI,eAAA,MAAA;;AACJ;AACI,eAAA,KAAA;AAVR;AADJA,GAAAA;;AAcA,SAAA,eAAA;AApEJ,CAAqC,EAArC;;AAsEA,SAAA,mBAAA,CAAA,iBAAA,EAAA,gBAAA,EAAA,OAAA,EAA2E;AACvE,MAAIoB,mBAAmB,GAAG1H,MAAM,CAANA,IAAAA,CAAAA,iBAAAA,EAA1B,MAAA;;AACA,MAAI0H,mBAAmB,KAAnBA,CAAAA,IAA6BnB,iBAAiB,CAAjBA,YAAAA,KAAjC,OAAA,EAA6E;AACzE,WAAO,UAAA,IAAA,EAAgB;AACnB,aAAOoB,oBAAoB,CAAC/N,IAAI,CAAhC,cAA2B,CAA3B;AADJ,KAAA;AAGH;;AACD,MAAI8N,mBAAmB,KAAnBA,CAAAA,IAA6BlB,gBAAgB,CAAjD,IAAA,EAAwD;AACpD,WAAO,UAAA,IAAA,EAAgB;AACnB,aAAOoB,gBAAgB,CAACrJ,OAAO,CAAPA,iBAAAA,CAA0B3E,IAAI,CAA/B,MAAC2E,CAAD,EAAyCA,OAAO,CAAhD,SAAA,EAA4DA,OAAO,CAAnE,MAAA,EAA4EiI,gBAAgB,CAAnH,IAAuB,CAAvB;AADJ,KAAA;AAGH;;AACD,SAAOqB,yBAAyB,CAAA,iBAAA,EAAA,gBAAA,EAAhC,OAAgC,CAAhC;AACH;;AACD,SAAA,yBAAA,CAAA,iBAAA,EAAA,gBAAA,EAAA,OAAA,EAAiF;AAC7EtB,EAAAA,iBAAiB,GAAGrG,OAAQ,CAAA,EAAA,EADiD,iBACjD,CAA5BqG,CAD6E,CACxB;;AACrDC,EAAAA,gBAAgB,GAAGtG,OAAQ,CAAA,EAAA,EAFkD,gBAElD,CAA3BsG,CAF6E,CAE1B;;AACnDsB,EAAAA,gBAAgB,CAAA,iBAAA,EAAhBA,gBAAgB,CAAhBA;AACAvB,EAAAA,iBAAiB,CAAjBA,QAAAA,GAJ6E,KAI7EA,CAJ6E,CAIzC;;AACpC,MAAIwB,YAAY,GAAG,IAAIC,IAAI,CAAR,cAAA,CAAwBzJ,OAAO,CAAPA,MAAAA,CAAxB,KAAA,EAAnB,iBAAmB,CAAnB;AACA,MAN6E,UAM7E,CAN6E,CAM7D;;AAChB,MAAIiI,gBAAgB,CAApB,cAAA,EAAqC;AACjC,QAAIyB,SAAS,GAAG/H,OAAQ,CAAA,EAAA,EAAxB,iBAAwB,CAAxB;;AACA,WAAO+H,SAAS,CAFiB,MAEjC,CAFiC,CAER;;AACzBC,IAAAA,UAAU,GAAG,IAAIF,IAAI,CAAR,cAAA,CAAwBzJ,OAAO,CAAPA,MAAAA,CAAxB,KAAA,EAAb2J,SAAa,CAAbA;AACH;;AACD,SAAO,UAAA,IAAA,EAAgB;AACnB,QAAI/O,MAAM,GAAGS,IAAI,CAAjB,MAAA;AACA,QAAA,MAAA;;AACA,QAAIsO,UAAU,IAAI,CAAC/O,MAAM,CAAzB,aAAmBA,EAAnB,EAA2C;AACvCgP,MAAAA,MAAM,GAANA,UAAAA;AADJ,KAAA,MAGK;AACDA,MAAAA,MAAM,GAANA,YAAAA;AACH;;AACD,QAAIzK,CAAC,GAAGyK,MAAM,CAANA,MAAAA,CAAR,MAAQA,CAAR;AACA,WAAOC,WAAW,CAAA,CAAA,EAAA,IAAA,EAAA,iBAAA,EAAA,gBAAA,EAAlB,OAAkB,CAAlB;AAVJ,GAAA;AAYH;;AACD,SAAA,gBAAA,CAAA,iBAAA,EAAA,gBAAA,EAA+D;AAC3D;AACA;AACA,MAAI7B,iBAAiB,CAArB,YAAA,EAAoC;AAChC,QAAI,CAACA,iBAAiB,CAAtB,IAAA,EAA6B;AACzBA,MAAAA,iBAAiB,CAAjBA,IAAAA,GAAAA,SAAAA;AACH;;AACD,QAAI,CAACA,iBAAiB,CAAtB,MAAA,EAA+B;AAC3BA,MAAAA,iBAAiB,CAAjBA,MAAAA,GAAAA,SAAAA;AACH;AATsD,GAAA,CAW3D;;;AACA,MAAIA,iBAAiB,CAAjBA,YAAAA,KAAJ,MAAA,EAA+C;AAC3CA,IAAAA,iBAAiB,CAAjBA,YAAAA,GAAAA,OAAAA;AAbuD,GAAA,CAe3D;;;AACA,MAAIC,gBAAgB,CAAhBA,cAAAA,KAAoCD,iBAAiB,CAAjBA,MAAAA,IAA4BA,iBAAiB,CAArF,WAAIC,CAAJ,EAAoG;AAChG,WAAOA,gBAAgB,CAAvB,cAAA;AACH;AACJ;;AACD,SAAA,WAAA,CAAA,CAAA,EAAA,IAAA,EAAA,iBAAA,EAAA,gBAAA,EAAA,OAAA,EAA4E;AACxE9I,EAAAA,CAAC,GAAGA,CAAC,CAADA,OAAAA,CAAAA,MAAAA,EADoE,EACpEA,CAAJA,CADwE,CAC7C;;AAC3B,MAAI6I,iBAAiB,CAAjBA,YAAAA,KAAJ,OAAA,EAAgD;AAC5C7I,IAAAA,CAAC,GAAG2K,YAAY,CAAA,CAAA,EAAK9J,OAAO,CAAPA,QAAAA,KAAAA,KAAAA,IAA8B3E,IAAI,CAAJA,cAAAA,IAA/B,IAAC2E,GAAD,KAACA,GACT;AACRoJ,IAAAA,oBAAoB,CAAC/N,IAAI,CAF7B8D,cAEwB,CAFR,CAAhBA;AAGH;;AACD,MAAI8I,gBAAgB,CAApB,UAAA,EAAiC;AAC7B9I,IAAAA,CAAC,GAAGA,CAAC,CAADA,OAAAA,CAAAA,QAAAA,EAAAA,EAAAA,EAAJA,IAAIA,EAAJA;AACH;;AACD,MAAI8I,gBAAgB,CAApB,cAAA,EAAqC;AACjC9I,IAAAA,CAAC,GAAGA,CAAC,CAADA,OAAAA,CAAAA,KAAAA,EAD6B,EAC7BA,CAAJA,CADiC,CACP;AAX0C,GAAA,CAaxE;AACA;;;AACA,MAAI8I,gBAAgB,CAAhBA,QAAAA,KAAJ,KAAA,EAAyC;AACrC9I,IAAAA,CAAC,GAAGA,CAAC,CAADA,OAAAA,CAAAA,WAAAA,EAAAA,EAAAA,EAAJA,IAAIA,EAAJA;AADJ,GAAA,MAGK,IAAI8I,gBAAgB,CAAhBA,QAAAA,KAAJ,QAAA,EAA4C;AAAE;AAC/C9I,IAAAA,CAAC,GAAG,CAAC,CAAD,OAAA,CAAA,WAAA,EAAuB,UAAA,EAAA,EAAA,EAAA,EAAkB;AACzC,aAAOrF,EAAE,CAAT,iBAAOA,EAAP;AADJqF,KAAI,CAAJA;AADC,GAAA,MAKA,IAAI8I,gBAAgB,CAAhBA,QAAAA,KAAJ,OAAA,EAA2C;AAAE;AAC9C9I,IAAAA,CAAC,GAAG,CAAC,CAAD,OAAA,CAAA,WAAA,EAAuB,UAAA,EAAA,EAAA,EAAA,EAAkB;AACzC,aAAOrF,EAAE,CAAFA,iBAAAA,KAAP,GAAA;AADJqF,KAAI,CAAJA;AADC,GAAA,MAKA,IAAI8I,gBAAgB,CAAhBA,QAAAA,KAAJ,WAAA,EAA+C;AAAE;AAClD9I,IAAAA,CAAC,GAAG,CAAC,CAAD,OAAA,CAAA,WAAA,EAAuB,UAAA,EAAA,EAAc;AACrC,aAAOpF,EAAE,CAAT,iBAAOA,EAAP;AADJoF,KAAI,CAAJA;AAGH;;AACDA,EAAAA,CAAC,GAAGA,CAAC,CAADA,OAAAA,CAAAA,cAAAA,EAAJA,GAAIA,CAAJA;AACAA,EAAAA,CAAC,GAAGA,CAAC,CAALA,IAAIA,EAAJA;AACA,SAAA,CAAA;AACH;;AACD,SAAA,YAAA,CAAA,CAAA,EAAA,MAAA,EAAiC;AAC7B,MAAI4K,QAAQ,GAAZ,KAAA;AACA5K,EAAAA,CAAC,GAAG,CAAC,CAAD,OAAA,CAAA,MAAA,EAAkB,YAAY;AAC9B4K,IAAAA,QAAQ,GAARA,IAAAA;AACA,WAAA,MAAA;AAJyB,GAEzB,CAAJ5K,CAF6B,CAM7B;;AACA,MAAI,CAAJ,QAAA,EAAe;AACXA,IAAAA,CAAC,IAAI,MAALA,MAAAA;AACH;;AACD,SAAA,CAAA;AACH;;AACD,SAAA,gBAAA,CAAA,GAAA,EAAA,SAAA,EAAA,MAAA,EAAA,OAAA,EAA2D;AACvD,MAAI6K,KAAK,GAAT,EAAA;;AACA,MAAIC,OAAO,KAAX,QAAA,EAA0B;AACtBD,IAAAA,KAAK,CAALA,IAAAA,CAAAA,SAAAA;AADJ,GAAA,MAGK,IAAIC,OAAO,KAAX,OAAA,EAAyB;AAC1BD,IAAAA,KAAK,CAALA,IAAAA,CAAAA,SAAAA,EAAAA,GAAAA;AANmD,GAAA,CAQvD;;;AACAA,EAAAA,KAAK,CAALA,IAAAA,CAAWE,MAAM,CAANA,kBAAAA,CAAAA,MAAAA,CAAXF,GAAWE,CAAXF;;AACA,MAAIE,MAAM,CAANA,OAAAA,CAAJ,KAAA,EAA0B;AAAE;AACxBF,IAAAA,KAAK,CAALA,OAAAA;AACH;;AACD,SAAOA,KAAK,CAALA,IAAAA,CAAP,EAAOA,CAAP;EAEJ;AACA;AACA;AACA;;;AACA,SAAA,yBAAA,CAAA,EAAA,EAAA,EAAA,EAAA,EAAA,EAA+C;AAC3C,MAAIG,EAAE,CAAFA,aAAAA,CAAAA,EAAAA,MAAyBA,EAAE,CAAFA,aAAAA,CAA7B,EAA6BA,CAA7B,EAAmD;AAC/C,WAAA,CAAA;AACH;;AACD,MAAIA,EAAE,CAAFA,cAAAA,CAAAA,EAAAA,MAA0BA,EAAE,CAAFA,cAAAA,CAA9B,EAA8BA,CAA9B,EAAqD;AACjD,WAAA,CAAA;AACH;;AACD,MAAIA,EAAE,CAAFA,YAAAA,CAAAA,EAAAA,MAAwBA,EAAE,CAAFA,YAAAA,CAA5B,EAA4BA,CAA5B,EAAiD;AAC7C,WAAA,CAAA;AACH;;AACD,MAAI1P,QAAQ,CAARA,EAAQ,CAARA,KAAiBA,QAAQ,CAA7B,EAA6B,CAA7B,EAAmC;AAC/B,WAAA,CAAA;AACH;;AACD,SAAA,CAAA;AACH;;AACD,SAAA,+BAAA,CAAA,OAAA,EAAA,WAAA,EAA+D;AAC3D,MAAI2P,cAAc,GAAlB,EAAA;;AACA,OAAK,IAAL,MAAA,IAAA,OAAA,EAA4B;AACxB,QAAI,EAAEC,MAAM,IAAR,6BAAA,KAA8C;AAC9CrD,IAAAA,6BAA6B,CAA7BA,MAA6B,CAA7BA,IADJ,WAAA,EAC0D;AACtDoD,MAAAA,cAAc,CAAdA,MAAc,CAAdA,GAAyBE,OAAO,CAAhCF,MAAgC,CAAhCA;AACH;AACJ;;AACD,SAAA,cAAA;AACH;;AACD,SAAA,mBAAA,CAAA,KAAA,EAAA,QAAA,EAAA,KAAA,EAAA,QAAA,EAA+D;AAC3D,MAAIG,EAAE,GAAN,CAAA;;AACA,SAAOA,EAAE,GAAG9B,KAAK,CAAjB,MAAA,EAA0B;AACtB,QAAI+B,MAAM,GAAG/B,KAAK,CAALA,OAAAA,CAAAA,QAAAA,EAAb,EAAaA,CAAb;;AACA,QAAI+B,MAAM,KAAK,CAAf,CAAA,EAAmB;AACf;AACH;;AACD,QAAIC,OAAO,GAAGhC,KAAK,CAALA,MAAAA,CAAAA,CAAAA,EAAd,MAAcA,CAAd;AACA8B,IAAAA,EAAE,GAAGC,MAAM,GAAGzB,QAAQ,CAAtBwB,MAAAA;AACA,QAAIG,MAAM,GAAGjC,KAAK,CAALA,MAAAA,CAAb,EAAaA,CAAb;AACA,QAAIkC,EAAE,GAAN,CAAA;;AACA,WAAOA,EAAE,GAAGjC,KAAK,CAAjB,MAAA,EAA0B;AACtB,UAAIkC,MAAM,GAAGlC,KAAK,CAALA,OAAAA,CAAAA,QAAAA,EAAb,EAAaA,CAAb;;AACA,UAAIkC,MAAM,KAAK,CAAf,CAAA,EAAmB;AACf;AACH;;AACD,UAAIC,OAAO,GAAGnC,KAAK,CAALA,MAAAA,CAAAA,CAAAA,EAAd,MAAcA,CAAd;AACAiC,MAAAA,EAAE,GAAGC,MAAM,GAAG5B,QAAQ,CAAtB2B,MAAAA;AACA,UAAIG,MAAM,GAAGpC,KAAK,CAALA,MAAAA,CAAb,EAAaA,CAAb;;AACA,UAAI+B,OAAO,KAAPA,OAAAA,IAAuBC,MAAM,KAAjC,MAAA,EAA8C;AAC1C,eAAO;AACHK,UAAAA,MAAM,EADH,OAAA;AAEHC,UAAAA,KAAK,EAAEN;AAFJ,SAAP;AAIH;AACJ;AACJ;;AACD,SAAA,IAAA;AACH;AAED;AACA;AACA;;AACA;AACA;AACA;AACA;;;AACA,IAAIO,YAAY;AAAG;AAAe,YAAY;AAC1C,WAAA,YAAA,CAAA,MAAA,EAAA,SAAA,EAAyC;AACrC,SAAA,MAAA,GAAA,MAAA;AACA,SAAA,SAAA,GAAA,SAAA;AACH;;AACDA,EAAAA,YAAY,CAAZA,SAAAA,CAAAA,MAAAA,GAAgC,UAAA,IAAA,EAAA,OAAA,EAAyB;AACrD,WAAOjL,OAAO,CAAPA,YAAAA,CAAqB,KAArBA,MAAAA,EAAkCkL,0BAA0B,CAAA,IAAA,EAAA,IAAA,EAAA,OAAA,EAAsB,KAAzF,SAAmE,CAA5DlL,CAAP;AADJiL,GAAAA;;AAGAA,EAAAA,YAAY,CAAZA,SAAAA,CAAAA,WAAAA,GAAqC,UAAA,KAAA,EAAA,GAAA,EAAA,OAAA,EAA+B;AAChE,WAAOjL,OAAO,CAAPA,YAAAA,CAAqB,KAArBA,MAAAA,EAAkCkL,0BAA0B,CAAA,KAAA,EAAA,GAAA,EAAA,OAAA,EAAsB,KAAzF,SAAmE,CAA5DlL,CAAP;AADJiL,GAAAA;;AAGA,SAAA,YAAA;AAXJ,CAAkC,EAAlC;;AAcA,IAAIE,aAAa;AAAG;AAAe,YAAY;AAC3C,WAAA,aAAA,CAAA,IAAA,EAA6B;AACzB,SAAA,IAAA,GAAA,IAAA;AACH;;AACDA,EAAAA,aAAa,CAAbA,SAAAA,CAAAA,MAAAA,GAAiC,UAAA,IAAA,EAAA,OAAA,EAAyB;AACtD,WAAO,KAAA,IAAA,CAAUD,0BAA0B,CAAA,IAAA,EAAA,IAAA,EAA3C,OAA2C,CAApC,CAAP;AADJC,GAAAA;;AAGAA,EAAAA,aAAa,CAAbA,SAAAA,CAAAA,WAAAA,GAAsC,UAAA,KAAA,EAAA,GAAA,EAAA,OAAA,EAA+B;AACjE,WAAO,KAAA,IAAA,CAAUD,0BAA0B,CAAA,KAAA,EAAA,GAAA,EAA3C,OAA2C,CAApC,CAAP;AADJC,GAAAA;;AAGA,SAAA,aAAA;AAVJ,CAAmC,EAAnC,C,CAaA;;;AACA,SAAA,eAAA,CAAA,KAAA,EAAA,gBAAA,EAAkD;AAC9C,MAAI,OAAA,KAAA,KAAA,QAAA,IAAJ,KAAA,EAAwC;AAAE;AACtC,QAAI,OAAA,gBAAA,KAAJ,QAAA,EAA0C;AACtC/M,MAAAA,KAAK,GAAGuD,OAAQ,CAAC;AAAEiF,QAAAA,SAAS,EAAEwE;AAAb,OAAD,EAAhBhN,KAAgB,CAAhBA;AACH;;AACD,WAAO,IAAA,eAAA,CAAP,KAAO,CAAP;AAJJ,GAAA,MAMK,IAAI,OAAA,KAAA,KAAJ,QAAA,EAA+B;AAChC,WAAO,IAAA,YAAA,CAAA,KAAA,EAAP,gBAAO,CAAP;AADC,GAAA,MAGA,IAAI,OAAA,KAAA,KAAJ,UAAA,EAAiC;AAClC,WAAO,IAAA,aAAA,CAAP,KAAO,CAAP;AACH;EAEL;AACA;;;AACA,SAAA,cAAA,CAAA,MAAA,EAAA,cAAA,EAAA,aAAA,EAA+D;AAC3D,MAAIiN,aAAa,KAAK,KAAtB,CAAA,EAA8B;AAAEA,IAAAA,aAAa,GAAbA,KAAAA;AAAwB;;AACxD,MAAIlM,CAAC,GAAGvE,MAAM,CAAd,WAAQA,EAAR;AACAuE,EAAAA,CAAC,GAAGA,CAAC,CAADA,OAAAA,CAAAA,MAAAA,EAAJA,EAAIA,CAAJA;;AACA,MAAA,aAAA,EAAmB;AACfA,IAAAA,CAAC,GAAGA,CAAC,CAADA,OAAAA,CAAAA,YAAAA,EAAJA,EAAIA,CAAJA;AACH;;AACD,MAAIA,CAAC,CAADA,MAAAA,GAAJ,EAAA,EAAmB;AAAE;AACjB,QAAImM,cAAc,IAAlB,IAAA,EAA4B;AACxBnM,MAAAA,CAAC,GAAGA,CAAC,CAADA,OAAAA,CAAAA,GAAAA,EAAJA,EAAIA,CAAJA;AADJ,KAAA,MAGK,IAAImM,cAAc,KAAlB,CAAA,EAA0B;AAC3BnM,MAAAA,CAAC,GAAGA,CAAC,CAADA,OAAAA,CAAAA,GAAAA,EAAeiK,oBAAoB,CAAA,cAAA,EAAvCjK,IAAuC,CAAnCA,CAAJA;AALW,KAAA,CAOf;;AACH;;AACD,SAAA,CAAA;AACH;;AACD,SAAA,mBAAA,CAAA,MAAA,EAAqC;AACjC,SAAOoM,QAAQ,CAAC3Q,MAAM,CAAP,WAACA,EAAD,EAAR2Q,CAAQ,CAARA,GAAAA,GAAAA,GACHA,QAAQ,CAAC3Q,MAAM,CAAP,aAACA,EAAD,EADL2Q,CACK,CADLA,GAAAA,GAAAA,GAEHA,QAAQ,CAAC3Q,MAAM,CAAP,aAACA,EAAD,EAFZ,CAEY,CAFZ;AAGH;;AACD,SAAA,oBAAA,CAAA,OAAA,EAAA,KAAA,EAA8C;AAC1C,MAAI4Q,KAAK,KAAK,KAAd,CAAA,EAAsB;AAAEA,IAAAA,KAAK,GAALA,KAAAA;AAAgB;;AACxC,MAAI1P,IAAI,GAAG2P,OAAO,GAAPA,CAAAA,GAAAA,GAAAA,GAAX,GAAA;AACA,MAAIC,GAAG,GAAG9V,IAAI,CAAJA,GAAAA,CAAV,OAAUA,CAAV;AACA,MAAI+V,KAAK,GAAG/V,IAAI,CAAJA,KAAAA,CAAW8V,GAAG,GAA1B,EAAY9V,CAAZ;AACA,MAAIgW,IAAI,GAAGhW,IAAI,CAAJA,KAAAA,CAAW8V,GAAG,GAAzB,EAAW9V,CAAX;;AACA,MAAA,KAAA,EAAW;AACP,WAAOkG,IAAI,GAAGyP,QAAQ,CAAA,KAAA,EAAfzP,CAAe,CAAfA,GAAAA,GAAAA,GAAkCyP,QAAQ,CAAA,IAAA,EAAjD,CAAiD,CAAjD;AADJ,GAAA,MAGK;AACD,WAAO,QAAA,IAAA,GAAA,KAAA,IAAwBK,IAAI,GAAG,MAAML,QAAQ,CAAA,IAAA,EAAjB,CAAiB,CAAjB,GAAnC,EAAO,CAAP;AACH;EAEL;;;AACA,SAAA,0BAAA,CAAA,KAAA,EAAA,GAAA,EAAA,OAAA,EAAA,SAAA,EAAoE;AAChE,MAAIM,SAAS,GAAGC,iBAAiB,CAAA,KAAA,EAAQ9L,OAAO,CAAhD,cAAiC,CAAjC;AACA,MAAI+L,OAAO,GAAGpL,GAAG,GAAGmL,iBAAiB,CAAA,GAAA,EAAM9L,OAAO,CAAjC,cAAoB,CAApB,GAAjB,IAAA;AACA,SAAO;AACH3E,IAAAA,IAAI,EADD,SAAA;AAEHqF,IAAAA,KAAK,EAFF,SAAA;AAGHC,IAAAA,GAAG,EAHA,OAAA;AAIHqL,IAAAA,QAAQ,EAAEhM,OAAO,CAJd,QAAA;AAKHiM,IAAAA,WAAW,EAAEjM,OAAO,CAAPA,MAAAA,CALV,KAAA;AAMH4G,IAAAA,SAAS,EAAEA;AANR,GAAP;AAQH;;AACD,SAAA,iBAAA,CAAA,QAAA,EAAA,cAAA,EAAqD;AACjD,MAAInN,CAAC,GAAGyS,cAAc,CAAdA,aAAAA,CAA6BC,QAAQ,CAA7C,MAAQD,CAAR;AACA,SAAO;AACHtR,IAAAA,MAAM,EAAEuR,QAAQ,CADb,MAAA;AAEHb,IAAAA,cAAc,EAAEa,QAAQ,CAFrB,cAAA;AAGHjG,IAAAA,KAAK,EAHF,CAAA;AAIHiB,IAAAA,IAAI,EAAE1N,CAAC,CAJJ,CAII,CAJJ;AAKH2N,IAAAA,KAAK,EAAE3N,CAAC,CALL,CAKK,CALL;AAMH4N,IAAAA,GAAG,EAAE5N,CAAC,CANH,CAMG,CANH;AAOH8N,IAAAA,IAAI,EAAE9N,CAAC,CAPJ,CAOI,CAPJ;AAQH+N,IAAAA,MAAM,EAAE/N,CAAC,CARN,CAQM,CARN;AASHgO,IAAAA,MAAM,EAAEhO,CAAC,CATN,CASM,CATN;AAUH2S,IAAAA,WAAW,EAAE3S,CAAC,CAAA,CAAA;AAVX,GAAP;AAYH;;AAED,IAAI4S,cAAc;AAAG;AAAe,YAAY;AAC5C,WAAA,cAAA,CAAA,QAAA,EAAA,mBAAA,EAAuD;AACnD,SAAA,QAAA,GAAA,QAAA;AACA,SAAA,mBAAA,GAAA,mBAAA;AACH;;AACDA,EAAAA,cAAc,CAAdA,SAAAA,CAAAA,MAAAA,GAAkC,YAAY;AAC1C,SAAA,QAAA,CAAA,QAAA,CAAuB;AACnBC,MAAAA,IAAI,EADe,qBAAA;AAEnBC,MAAAA,QAAQ,EAAE,KAAA,mBAAA,CAAyBA;AAFhB,KAAvB;AADJF,GAAAA;;AAMAA,EAAAA,cAAc,CAAdA,SAAAA,CAAAA,OAAAA,GAAmC,YAAY;AAC3C,SAAA,QAAA,CAAA,QAAA,CAAuB;AACnBC,MAAAA,IAAI,EADe,qBAAA;AAEnBE,MAAAA,SAAS,EAAE,CAAC,KAAA,mBAAA,CAAD,QAAA;AAFQ,KAAvB;AADJH,GAAAA;;AAMA5K,EAAAA,MAAM,CAANA,cAAAA,CAAsB4K,cAAc,CAApC5K,SAAAA,EAAAA,IAAAA,EAAsD;AAClDgL,IAAAA,GAAG,EAAE,SAAA,GAAA,GAAY;AACb,aAAO,KAAA,mBAAA,CAAP,QAAA;AAF8C,KAAA;AAIlDC,IAAAA,UAAU,EAJwC,IAAA;AAKlDC,IAAAA,YAAY,EAAE;AALoC,GAAtDlL;AAOAA,EAAAA,MAAM,CAANA,cAAAA,CAAsB4K,cAAc,CAApC5K,SAAAA,EAAAA,KAAAA,EAAuD;AACnD;AACAgL,IAAAA,GAAG,EAAE,SAAA,GAAA,GAAY;AACb,aAAO,KAAA,mBAAA,CAAA,IAAA,CAAP,GAAA;AAH+C,KAAA;AAKnDC,IAAAA,UAAU,EALyC,IAAA;AAMnDC,IAAAA,YAAY,EAAE;AANqC,GAAvDlL;AAQA,SAAA,cAAA;AAhCJ,CAAoC,EAApC;;AAmCA,IAAImL,QAAQ;AAAG;AAAe,YAAY;AACtC,WAAA,QAAA,CAAA,QAAA,EAAA,GAAA,EAAA,QAAA,EAA2C;AACvC,SAAA,SAAA,GAAA,QAAA;AACA,SAAA,IAAA,GAAA,GAAA;AACA,SAAA,SAAA,GAAiB5I,QAAQ,IAAzB,IAAA;AACH;AACD;AACJ;AACA;;;AACI4I,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,OAAAA,GAA6B,UAAA,IAAA,EAAA,GAAA,EAAqB;AAC9C,QAAA,EAAA,EAAA,EAAA;;AACA,QAAIjK,IAAI,IAAR,UAAA,EAAA,CAAA,KACK,IAAIA,IAAI,IAAR,cAAA,EAA4B;AAC7B,UAAI,OAAOkK,cAAc,CAArB,IAAqB,CAArB,KAAJ,UAAA,EAAgD;AAC5CtX,QAAAA,GAAG,GAAGsX,cAAc,CAAdA,IAAc,CAAdA,CAANtX,GAAMsX,CAANtX;AACH;;AACD,WAAA,MAAA,CAAY;AACRuX,QAAAA,aAAa,GAAGlR,EAAE,GAAFA,EAAAA,EAASA,EAAE,CAAFA,IAAE,CAAFA,GAATA,GAAAA,EAAH,EAAA;AADL,OAAZ;AAJC,KAAA,MAQA,IAAI+G,IAAI,IAAR,uBAAA,EAAqC;AACtC,UAAIoK,EAAE,GAAG,KAAT,CAAA;;AACA,UAAI,OAAOC,uBAAuB,CAA9B,IAA8B,CAA9B,KAAJ,UAAA,EAAyD;AACrDzX,QAAAA,GAAG,GAAGyX,uBAAuB,CAAvBA,IAAuB,CAAvBA,CAANzX,GAAMyX,CAANzX;AACH;;AACD,UAAIoN,IAAI,KAAR,OAAA,EAAsB;AAClBoK,QAAAA,EAAE,GAAG;AAAEE,UAAAA,eAAe,EAAjB,GAAA;AAAwBC,UAAAA,WAAW,EAAE3X;AAArC,SAALwX;AADJ,OAAA,MAGK,IAAIpK,IAAI,KAAR,UAAA,EAAyB;AAC1BoK,QAAAA,EAAE,GAAG;AAAEI,UAAAA,aAAa,EAAf,GAAA;AAAsBC,UAAAA,gBAAgB,EAAE7X;AAAxC,SAALwX;AADC,OAAA,MAGA;AACDA,QAAAA,EAAE,IAAIM,EAAE,GAAFA,EAAAA,EAASA,EAAE,CAAFA,IAAE,CAAFA,GAATA,GAAAA,EAANN,EAAE,CAAFA;AACH;;AACD,WAAA,MAAA,CAAY;AACRD,QAAAA,aAAa,EAAE;AAAEC,UAAAA,EAAE,EAAEA;AAAN;AADP,OAAZ;AAGH;AA5BLH,GAAAA;;AA8BAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,eAAAA,GAAqC,UAAA,IAAA,EAAA,GAAA,EAAqB;AACtD,QAAA,EAAA;;AACA,SAAA,MAAA,CAAY;AACRU,MAAAA,aAAa,GAAG1R,EAAE,GAAFA,EAAAA,EAASA,EAAE,CAAFA,IAAE,CAAFA,GAATA,GAAAA,EAAH,EAAA;AADL,KAAZ;AAFJgR,GAAAA;;AAMAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,QAAAA,GAA8B,UAAA,UAAA,EAAA,OAAA,EAA+B;AACzD,QAAItC,OAAO,KAAK,KAAhB,CAAA,EAAwB;AAAEA,MAAAA,OAAO,GAAPA,EAAAA;AAAe;;AACzC,QAAIjJ,OAAO,GAAG,KAAA,SAAA,CAAd,OAAA;AACA,QAAIX,KAAK,GAAGW,OAAO,CAAPA,YAAAA,CAAZ,UAAYA,CAAZ;;AACA,QAAIX,KAAK,IAAI,KAAb,SAAA,EAA6B;AAAE;AAC3B,UAAI6M,aAAa,GAAG,KAAA,SAAA,CAApB,KAAA;AACA,UAAIC,UAAU,GAAGC,SAAS,CAACF,aAAa,CAAd,KAAA,EAAA,KAAA,EAAA,OAAA,EAAsCjD,OAAO,CAF9C,WAEC,CAA1B,CAFyB,CAE6D;;AACtF,UAAIA,OAAO,CAAX,gBAAA,EAA8B;AAC1B,aAAA,MAAA,CAAY;AAAEoD,UAAAA,UAAU,EAAEF;AAAd,SAAZ;AADJ,OAAA,MAGK;AACD,aAAA,MAAA,CAAY;AAAEA,UAAAA,UAAU,EAAEA;AAAd,SAAZ;AACH;AACJ;AAbLZ,GAAAA;;AAeAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,MAAAA,GAA4B,UAAA,QAAA,EAAA,OAAA,EAA6B;AACrD,QAAItC,OAAO,KAAK,KAAhB,CAAA,EAAwB;AAAEA,MAAAA,OAAO,GAAPA,EAAAA;AAAe;;AACzC,QAAIjJ,OAAO,GAAG,KAAA,SAAA,CAAd,OAAA;AACA,QAAA,GAAA;;AACA,QAAIsM,QAAQ,IAAZ,IAAA,EAAsB;AAClBhN,MAAAA,GAAG,GAAGU,OAAO,CAAPA,YAAAA,CAANV,QAAMU,CAANV;;AACA,UAAI,CAAJ,GAAA,EAAU;AAAA,eAAA,CACE;AACX;AACJ;;AACD,QAAI,KAAJ,SAAA,EAAoB;AAChB,UAAA,GAAA,EAAS;AACL,YAAIiN,QAAQ,GAAGH,SAAS,CAAC,KAAA,SAAA,CAAA,KAAA,CAAD,GAAA,EAAA,GAAA,EAAA,OAAA,EAAyCnD,OAAO,CAAxE,WAAwB,CAAxB;AACA,aAAA,MAAA,CAAY;AAAEsD,UAAAA,QAAQ,EAAEA;AAAZ,SAAZ;AAFJ,OAAA,MAIK;AACD,aAAA,MAAA,CAAY;AAAEd,UAAAA,aAAa,EAAE;AAAEe,YAAAA,MAAM,EAAE;AAAV;AAAjB,SAAZ;AACH;AACJ;AAlBLjB,GAAAA;;AAoBAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,QAAAA,GAA8B,UAAA,UAAA,EAAA,QAAA,EAAA,OAAA,EAAyC;AACnE,QAAItC,OAAO,KAAK,KAAhB,CAAA,EAAwB;AAAEA,MAAAA,OAAO,GAAPA,EAAAA;AAAe;;AACzC,QAAIjJ,OAAO,GAAG,KAAA,SAAA,CAAd,OAAA;AACA,QAAIyL,aAAa,GAAG;AAAE9K,MAAAA,MAAM,EAAEsI,OAAO,CAACtI;AAAlB,KAApB;AACA,QAAItB,KAAK,GAAGW,OAAO,CAAPA,YAAAA,CAAZ,UAAYA,CAAZ;AACA,QAAA,GAAA;;AACA,QAAI,CAAJ,KAAA,EAAY;AAAA,aAAA,CACA;AACX;;AACD,QAAIsM,QAAQ,IAAZ,IAAA,EAAsB;AAClBhN,MAAAA,GAAG,GAAGU,OAAO,CAAPA,YAAAA,CAANV,QAAMU,CAANV;;AACA,UAAI,CAAJ,GAAA,EAAU;AAAE;AACR;AACH;AACJ;;AACD,QAAI,KAAJ,SAAA,EAAoB;AAChB,UAAI4M,aAAa,GAAG,KAAA,SAAA,CADJ,KAChB,CADgB,CAEhB;AACA;;AACA,UAAIjD,OAAO,CAAPA,MAAAA,KAAJ,IAAA,EAA6B;AACzBiD,QAAAA,aAAa,GAAGO,sBAAsB,CAAtCP,aAAsC,CAAtCA;AACH;;AACD,UAAIC,UAAU,GAAGC,SAAS,CAACF,aAAa,CAAd,KAAA,EAAA,KAAA,EAAA,OAAA,EAAsCjD,OAAO,CAAvE,WAA0B,CAA1B;;AACA,UAAA,GAAA,EAAS;AACL,YAAIsD,QAAQ,GAAGH,SAAS,CAACF,aAAa,CAAd,GAAA,EAAA,GAAA,EAAA,OAAA,EAAkCjD,OAAO,CAAjE,WAAwB,CAAxB;;AACA,YAAIyD,cAAc,CAAA,UAAA,EAAlB,QAAkB,CAAlB,EAA0C;AACtC,eAAA,MAAA,CAAY;AAAEL,YAAAA,UAAU,EAAZ,UAAA;AAA0BZ,YAAAA,aAAa,EAAEA;AAAzC,WAAZ;AADJ,SAAA,MAGK;AACD,eAAA,MAAA,CAAY;AAAEU,YAAAA,UAAU,EAAZ,UAAA;AAA0BI,YAAAA,QAAQ,EAAlC,QAAA;AAA8Cd,YAAAA,aAAa,EAAEA;AAA7D,WAAZ;AACH;AAPL,OAAA,MASK;AAAE;AACHA,QAAAA,aAAa,CAAbA,MAAAA,GAAAA,KAAAA;AACA,aAAA,MAAA,CAAY;AAAEY,UAAAA,UAAU,EAAZ,UAAA;AAA0BZ,UAAAA,aAAa,EAAEA;AAAzC,SAAZ;AACH;AACJ;AApCLF,GAAAA;;AAsCAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,SAAAA,GAA+B,UAAA,UAAA,EAAsB;AACjD,QAAIoB,KAAK,GAAGlN,cAAc,CAA1B,UAA0B,CAA1B;;AACA,QAAA,KAAA,EAAW;AAAE;AACT,WAAA,MAAA,CAAY;AAAE0M,QAAAA,UAAU,EAAEQ;AAAd,OAAZ;AACH;AAJLpB,GAAAA;;AAMAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,OAAAA,GAA6B,UAAA,UAAA,EAAsB;AAC/C,QAAIoB,KAAK,GAAGlN,cAAc,CAA1B,UAA0B,CAA1B;;AACA,QAAA,KAAA,EAAW;AAAE;AACT,WAAA,MAAA,CAAY;AAAE8M,QAAAA,QAAQ,EAAEI;AAAZ,OAAZ;AACH;AAJLpB,GAAAA;;AAMAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,SAAAA,GAA+B,UAAA,UAAA,EAAsB;AACjD,QAAIoB,KAAK,GAAGlN,cAAc,CAA1B,UAA0B,CAA1B;;AACA,QAAA,KAAA,EAAW;AAAE;AACT,WAAA,MAAA,CAAY;AAAE4M,QAAAA,UAAU,EAAEM;AAAd,OAAZ;AACH;AAJLpB,GAAAA;;AAMAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,SAAAA,GAA+B,UAAA,MAAA,EAAA,OAAA,EAA2B;AACtD,QAAItC,OAAO,KAAK,KAAhB,CAAA,EAAwB;AAAEA,MAAAA,OAAO,GAAPA,EAAAA;AAAe;;AACzC,QAAIwC,aAAa,GAAG;AAAE9K,MAAAA,MAAM,EAAEA;AAAV,KAApB;AACA,QAAIiM,gBAAgB,GAAG3D,OAAO,CAA9B,gBAAA;;AACA,QAAI2D,gBAAgB,IAApB,IAAA,EAA8B;AAC1BA,MAAAA,gBAAgB,GAAG,KAAA,SAAA,CAAA,GAAA,CAAnBA,wBAAmB,CAAnBA;AACH;;AACD,QAAI,KAAA,IAAA,CAAA,MAAA,KAAJ,MAAA,EAAiC;AAC7BnB,MAAAA,aAAa,CAAbA,MAAAA,GAAAA,gBAAAA;AACH;;AACD,SAAA,MAAA,CAAY;AAAEA,MAAAA,aAAa,EAAEA;AAAjB,KAAZ;AAVJF,GAAAA;;AAYAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,WAAAA,GAAiC,UAAA,WAAA,EAAuB;AACpD,QAAIvL,OAAO,GAAG,KAAA,SAAA,CAAd,OAAA;AACA,QAAI2C,QAAQ,GAAG,KAAf,SAAA;AACA,QAAIkK,SAAS,GAAGC,eAAe,CAAA,WAAA,EAAc,KAAA,SAAA,CAAA,GAAA,CAA7C,uBAA6C,CAAd,CAA/B;;AACA,QAAI,KAAA,IAAA,CAAJ,MAAA,EAAsB;AAClB,aAAO,OAAO,CAAP,WAAA,CAAoBnK,QAAQ,CAARA,KAAAA,CAApB,KAAA,EAA0CA,QAAQ,CAARA,KAAAA,CAA1C,GAAA,EAAA,SAAA,EAAyE;AAC5EoK,QAAAA,cAAc,EAAEpK,QAAQ,CADoD,cAAA;AAE5EqK,QAAAA,YAAY,EAAErK,QAAQ,CAACqK;AAFqD,OAAzE,CAAP;AADJ,KAAA,MAMK;AACD,aAAO,OAAO,CAAP,MAAA,CAAerK,QAAQ,CAARA,KAAAA,CAAf,KAAA,EAAA,SAAA,EAAgD;AACnDsK,QAAAA,SAAS,EAAEtK,QAAQ,CAACoK;AAD+B,OAAhD,CAAP;AAGH;AAdLxB,GAAAA;;AAgBAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,MAAAA,GAA4B,UAAA,QAAA,EAAoB;AAC5C,QAAI3I,GAAG,GAAG,KAAV,IAAA;AACA,QAAID,QAAQ,GAAG,KAAf,SAAA;;AACA,QAAA,QAAA,EAAc;AACV,WAAA,SAAA,CAAA,QAAA,CAAwB;AACpBsI,QAAAA,IAAI,EADgB,eAAA;AAEpBiC,QAAAA,UAAU,EAAEvK,QAAQ,CAFA,UAAA;AAGpBwK,QAAAA,QAAQ,EAHY,QAAA;AAIpBC,QAAAA,OAAO,EAAE;AAJW,OAAxB;;AAMA,UAAIpL,UAAU,GAAG,KAAA,SAAA,CAAA,KAAA,CAAjB,UAAA;AACA,WAAA,IAAA,GAAYA,UAAU,CAAVA,IAAAA,CAAgBY,GAAG,CAA/B,KAAYZ,CAAZ;AACA,WAAA,SAAA,GAAiBA,UAAU,CAAVA,SAAAA,CAAqBW,QAAQ,CAA9C,UAAiBX,CAAjB;AACH;AAbLuJ,GAAAA;;AAeAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,MAAAA,GAA4B,YAAY;AACpC,SAAA,SAAA,CAAA,QAAA,CAAwB;AACpBN,MAAAA,IAAI,EADgB,kBAAA;AAEpBoC,MAAAA,KAAK,EAAE,KAAA,IAAA,CAAUA;AAFG,KAAxB;AADJ9B,GAAAA;;AAMAnL,EAAAA,MAAM,CAANA,cAAAA,CAAsBmL,QAAQ,CAA9BnL,SAAAA,EAAAA,QAAAA,EAAoD;AAChDgL,IAAAA,GAAG,EAAE,SAAA,GAAA,GAAY;AACb,UAAIF,QAAQ,GAAG,KAAA,IAAA,CAAf,QAAA;;AACA,UAAA,QAAA,EAAc;AACV,eAAO,IAAA,cAAA,CAAmB,KAAnB,SAAA,EAAmC,KAAA,SAAA,CAAA,KAAA,CAAA,YAAA,CAA1C,QAA0C,CAAnC,CAAP;AACH;;AACD,aAAA,IAAA;AAN4C,KAAA;AAQhDG,IAAAA,UAAU,EARsC,IAAA;AAShDC,IAAAA,YAAY,EAAE;AATkC,GAApDlL;AAWAA,EAAAA,MAAM,CAANA,cAAAA,CAAsBmL,QAAQ,CAA9BnL,SAAAA,EAAAA,OAAAA,EAAmD;AAC/CgL,IAAAA,GAAG,EAAE,SAAA,GAAA,GAAY;AACb,aAAO,KAAA,SAAA,GACH,KAAA,SAAA,CAAA,OAAA,CAAA,MAAA,CAA8B,KAAA,SAAA,CAAA,KAAA,CAD3B,KACH,CADG,GAAP,IAAA;AAF2C,KAAA;AAM/CC,IAAAA,UAAU,EANqC,IAAA;AAO/CC,IAAAA,YAAY,EAAE;AAPiC,GAAnDlL;AASAA,EAAAA,MAAM,CAANA,cAAAA,CAAsBmL,QAAQ,CAA9BnL,SAAAA,EAAAA,KAAAA,EAAiD;AAC7CgL,IAAAA,GAAG,EAAE,SAAA,GAAA,GAAY;AACb,aAAQ,KAAA,SAAA,IAAkB,KAAA,IAAA,CAAnB,MAAC,GACJ,KAAA,SAAA,CAAA,OAAA,CAAA,MAAA,CAA8B,KAAA,SAAA,CAAA,KAAA,CAD3B,GACH,CADI,GAAR,IAAA;AAFyC,KAAA;AAM7CC,IAAAA,UAAU,EANmC,IAAA;AAO7CC,IAAAA,YAAY,EAAE;AAP+B,GAAjDlL;AASAA,EAAAA,MAAM,CAANA,cAAAA,CAAsBmL,QAAQ,CAA9BnL,SAAAA,EAAAA,IAAAA,EAAgD;AAC5C;AACA;AACAgL,IAAAA,GAAG,EAAE,SAAA,GAAA,GAAY;AAAE,aAAO,KAAA,IAAA,CAAP,QAAA;AAHyB,KAAA;AAI5CC,IAAAA,UAAU,EAJkC,IAAA;AAK5CC,IAAAA,YAAY,EAAE;AAL8B,GAAhDlL;AAOAA,EAAAA,MAAM,CAANA,cAAAA,CAAsBmL,QAAQ,CAA9BnL,SAAAA,EAAAA,SAAAA,EAAqD;AACjDgL,IAAAA,GAAG,EAAE,SAAA,GAAA,GAAY;AAAE,aAAO,KAAA,IAAA,CAAP,OAAA;AAD8B,KAAA;AAEjDC,IAAAA,UAAU,EAFuC,IAAA;AAGjDC,IAAAA,YAAY,EAAE;AAHmC,GAArDlL;AAKAA,EAAAA,MAAM,CAANA,cAAAA,CAAsBmL,QAAQ,CAA9BnL,SAAAA,EAAAA,QAAAA,EAAoD;AAChDgL,IAAAA,GAAG,EAAE,SAAA,GAAA,GAAY;AAAE,aAAO,KAAA,IAAA,CAAP,MAAA;AAD6B,KAAA;AAEhDC,IAAAA,UAAU,EAFsC,IAAA;AAGhDC,IAAAA,YAAY,EAAE;AAHkC,GAApDlL;AAKAA,EAAAA,MAAM,CAANA,cAAAA,CAAsBmL,QAAQ,CAA9BnL,SAAAA,EAAAA,OAAAA,EAAmD;AAC/CgL,IAAAA,GAAG,EAAE,SAAA,GAAA,GAAY;AAAE,aAAO,KAAA,IAAA,CAAP,KAAA;AAD4B,KAAA;AAE/CC,IAAAA,UAAU,EAFqC,IAAA;AAG/CC,IAAAA,YAAY,EAAE;AAHiC,GAAnDlL;AAKAA,EAAAA,MAAM,CAANA,cAAAA,CAAsBmL,QAAQ,CAA9BnL,SAAAA,EAAAA,KAAAA,EAAiD;AAC7CgL,IAAAA,GAAG,EAAE,SAAA,GAAA,GAAY;AAAE,aAAO,KAAA,IAAA,CAAP,GAAA;AAD0B,KAAA;AAE7CC,IAAAA,UAAU,EAFmC,IAAA;AAG7CC,IAAAA,YAAY,EAAE;AAH+B,GAAjDlL;AAKAA,EAAAA,MAAM,CAANA,cAAAA,CAAsBmL,QAAQ,CAA9BnL,SAAAA,EAAAA,WAAAA,EAAuD;AACnDgL,IAAAA,GAAG,EAAE,SAAA,GAAA,GAAY;AAAE,aAAO,KAAA,IAAA,CAAP,SAAA;AADgC,KAAA;AAEnDC,IAAAA,UAAU,EAFyC,IAAA;AAGnDC,IAAAA,YAAY,EAAE;AAHqC,GAAvDlL;AAKAA,EAAAA,MAAM,CAANA,cAAAA,CAAsBmL,QAAQ,CAA9BnL,SAAAA,EAAAA,eAAAA,EAA2D;AACvDgL,IAAAA,GAAG,EAAE,SAAA,GAAA,GAAY;AAAE,aAAO,KAAA,IAAA,CAAA,EAAA,CAAP,aAAA;AADoC,KAAA;AAEvDC,IAAAA,UAAU,EAF6C,IAAA;AAGvDC,IAAAA,YAAY,EAAE;AAHyC,GAA3DlL;AAKAA,EAAAA,MAAM,CAANA,cAAAA,CAAsBmL,QAAQ,CAA9BnL,SAAAA,EAAAA,kBAAAA,EAA8D;AAC1DgL,IAAAA,GAAG,EAAE,SAAA,GAAA,GAAY;AAAE,aAAO,KAAA,IAAA,CAAA,EAAA,CAAP,gBAAA;AADuC,KAAA;AAE1DC,IAAAA,UAAU,EAFgD,IAAA;AAG1DC,IAAAA,YAAY,EAAE;AAH4C,GAA9DlL;AAKAA,EAAAA,MAAM,CAANA,cAAAA,CAAsBmL,QAAQ,CAA9BnL,SAAAA,EAAAA,YAAAA,EAAwD;AACpDgL,IAAAA,GAAG,EAAE,SAAA,GAAA,GAAY;AAAE,aAAO,KAAA,IAAA,CAAA,EAAA,CAAA,WAAA,CAAA,CAAA,KAAP,IAAA;AADiC,KAAA;AAEpDC,IAAAA,UAAU,EAF0C,IAAA;AAGpDC,IAAAA,YAAY,EAAE;AAHsC,GAAxDlL;AAKAA,EAAAA,MAAM,CAANA,cAAAA,CAAsBmL,QAAQ,CAA9BnL,SAAAA,EAAAA,SAAAA,EAAqD;AACjDgL,IAAAA,GAAG,EAAE,SAAA,GAAA,GAAY;AAAE,aAAO,KAAA,IAAA,CAAA,EAAA,CAAP,OAAA;AAD8B,KAAA;AAEjDC,IAAAA,UAAU,EAFuC,IAAA;AAGjDC,IAAAA,YAAY,EAAE;AAHmC,GAArDlL;AAKAA,EAAAA,MAAM,CAANA,cAAAA,CAAsBmL,QAAQ,CAA9BnL,SAAAA,EAAAA,OAAAA,EAAmD;AAC/CgL,IAAAA,GAAG,EAAE,SAAA,GAAA,GAAY;AAAE,aAAO,KAAA,IAAA,CAAA,EAAA,CAAA,MAAA,CAAA,CAAA,KAAP,IAAA;AAD4B,KAAA;AAE/CC,IAAAA,UAAU,EAFqC,IAAA;AAG/CC,IAAAA,YAAY,EAAE;AAHiC,GAAnDlL;AAKAA,EAAAA,MAAM,CAANA,cAAAA,CAAsBmL,QAAQ,CAA9BnL,SAAAA,EAAAA,iBAAAA,EAA6D;AACzDgL,IAAAA,GAAG,EAAE,SAAA,GAAA,GAAY;AAAE,aAAO,KAAA,IAAA,CAAA,EAAA,CAAP,eAAA;AADsC,KAAA;AAEzDC,IAAAA,UAAU,EAF+C,IAAA;AAGzDC,IAAAA,YAAY,EAAE;AAH2C,GAA7DlL;AAKAA,EAAAA,MAAM,CAANA,cAAAA,CAAsBmL,QAAQ,CAA9BnL,SAAAA,EAAAA,aAAAA,EAAyD;AACrDgL,IAAAA,GAAG,EAAE,SAAA,GAAA,GAAY;AAAE,aAAO,KAAA,IAAA,CAAA,EAAA,CAAP,WAAA;AADkC,KAAA;AAErDC,IAAAA,UAAU,EAF2C,IAAA;AAGrDC,IAAAA,YAAY,EAAE;AAHuC,GAAzDlL;AAKAA,EAAAA,MAAM,CAANA,cAAAA,CAAsBmL,QAAQ,CAA9BnL,SAAAA,EAAAA,WAAAA,EAAuD;AACnDgL,IAAAA,GAAG,EAAE,SAAA,GAAA,GAAY;AAAE,aAAO,KAAA,IAAA,CAAA,EAAA,CAAP,SAAA;AADgC,KAAA;AAEnDC,IAAAA,UAAU,EAFyC,IAAA;AAGnDC,IAAAA,YAAY,EAAE;AAHqC,GAAvDlL;AAKAA,EAAAA,MAAM,CAANA,cAAAA,CAAsBmL,QAAQ,CAA9BnL,SAAAA,EAAAA,YAAAA,EAAwD;AACpD;AACAgL,IAAAA,GAAG,EAAE,SAAA,GAAA,GAAY;AAAE,aAAO,KAAA,IAAA,CAAA,EAAA,CAAP,UAAA;AAFiC,KAAA;AAGpDC,IAAAA,UAAU,EAH0C,IAAA;AAIpDC,IAAAA,YAAY,EAAE;AAJsC,GAAxDlL;AAMAA,EAAAA,MAAM,CAANA,cAAAA,CAAsBmL,QAAQ,CAA9BnL,SAAAA,EAAAA,eAAAA,EAA2D;AACvDgL,IAAAA,GAAG,EAAE,SAAA,GAAA,GAAY;AAAE,aAAO,KAAA,IAAA,CAAP,aAAA;AADoC,KAAA;AAEvDC,IAAAA,UAAU,EAF6C,IAAA;AAGvDC,IAAAA,YAAY,EAAE;AAHyC,GAA3DlL;AAKA,SAAA,QAAA;AAzSJ,CAA8B,EAA9B;AA4SA;AACA;AACA;;;AACA,SAAA,eAAA,CAAA,UAAA,EAAA,YAAA,EAAA,YAAA,EAAA,gBAAA,EAAmF;AAC/E,MAAIkN,kBAAkB,GAAtB,EAAA;AACA,MAAIC,gBAAgB,GAApB,EAAA;AACA,MAAIC,YAAY,GAAhB,EAAA;AACA,MAAIC,QAAQ,GAAZ,EAAA;AACA,MAAIC,QAAQ,GAAZ,EAAA;AACA,MAAIC,QAAQ,GAAGC,eAAe,CAAC5L,UAAU,CAAX,IAAA,EAA9B,YAA8B,CAA9B;;AACA,OAAK,IAAL,KAAA,IAAkBA,UAAU,CAA5B,IAAA,EAAmC;AAC/B,QAAIY,GAAG,GAAGZ,UAAU,CAAVA,IAAAA,CAAV,KAAUA,CAAV;;AACA,QAAIY,GAAG,CAAHA,SAAAA,KAAJ,oBAAA,EAA4C;AACxC,UAAIA,GAAG,CAAP,OAAA,EAAiB;AACb0K,QAAAA,kBAAkB,CAAC1K,GAAG,CAAtB0K,OAAkB,CAAlBA,GAAAA,EAAAA;;AACA,YAAI,CAACE,YAAY,CAAC5K,GAAG,CAArB,OAAiB,CAAjB,EAAgC;AAC5B4K,UAAAA,YAAY,CAAC5K,GAAG,CAAhB4K,OAAY,CAAZA,GAAAA,GAAAA;AACH;AAJL,OAAA,MAMK;AACDD,QAAAA,gBAAgB,CAAhBA,KAAgB,CAAhBA,GAAAA,EAAAA;AACH;AACJ;AACJ;;AACD,OAAK,IAAL,UAAA,IAAuBvL,UAAU,CAAjC,SAAA,EAA6C;AACzC,QAAIW,QAAQ,GAAGX,UAAU,CAAVA,SAAAA,CAAf,UAAeA,CAAf;AACA,QAAIY,GAAG,GAAGZ,UAAU,CAAVA,IAAAA,CAAgBW,QAAQ,CAAlC,KAAUX,CAAV;AACA,QAAI0J,EAAE,GAAGiC,QAAQ,CAAC/K,GAAG,CAArB,KAAiB,CAAjB;AACA,QAAIiL,SAAS,GAAGlL,QAAQ,CAAxB,KAAA;AACA,QAAImL,WAAW,GAAI,CAAClL,GAAG,CAAJ,MAAA,IAAD,gBAAC,GACf9C,sBAAsB,CAAA,SAAA,EADR,gBACQ,CADP,GAAnB,SAAA;AAGA,QAAIiO,WAAW,GAAGC,eAAe,CAAA,WAAA,EAAjC,YAAiC,CAAjC;;AACA,QAAA,WAAA,EAAiB;AACb,UAAIpL,GAAG,CAAHA,SAAAA,KAAJ,oBAAA,EAA4C;AACxC,YAAIA,GAAG,CAAP,OAAA,EAAiB;AACb0K,UAAAA,kBAAkB,CAAC1K,GAAG,CAAtB0K,OAAkB,CAAlBA,CAAAA,IAAAA,CAAAA,WAAAA;AADJ,SAAA,MAGK;AACDC,UAAAA,gBAAgB,CAAC5K,QAAQ,CAAzB4K,KAAgB,CAAhBA,CAAAA,IAAAA,CAAAA,WAAAA;AACH;AANL,OAAA,MAQK;AACD,SAAC3K,GAAG,CAAHA,SAAAA,KAAAA,YAAAA,GAAAA,QAAAA,GAAD,QAAA,EAAA,IAAA,CAA4D;AACxDA,UAAAA,GAAG,EADqD,GAAA;AAExD8I,UAAAA,EAAE,EAFsD,EAAA;AAGxD/I,UAAAA,QAAQ,EAHgD,QAAA;AAIxDgC,UAAAA,KAAK,EAJmD,WAAA;AAKxDsJ,UAAAA,OAAO,EAAEH,WAAW,CAAXA,KAAAA,IAAqBA,WAAW,CAAXA,KAAAA,CAAAA,OAAAA,OAAgCC,WAAW,CAAXA,KAAAA,CALN,OAKMA,EALN;AAMxDG,UAAAA,KAAK,EAAEJ,WAAW,CAAXA,GAAAA,IAAmBA,WAAW,CAAXA,GAAAA,CAAAA,OAAAA,OAA8BC,WAAW,CAAXA,GAAAA,CAAAA,OAAAA;AANA,SAA5D;AAQH;AACJ;AACJ;;AACD,OAAK,IAAL,OAAA,IAAA,kBAAA,EAAwC;AAAE;AACtC,QAAI3J,MAAM,GAAGkJ,kBAAkB,CAA/B,OAA+B,CAA/B;AACA,QAAIpJ,cAAc,GAAGiK,YAAY,CAAA,MAAA,EAAjC,YAAiC,CAAjC;;AACA,SAAK,IAAIhQ,EAAE,GAAN,CAAA,EAAYiQ,gBAAgB,GAAjC,cAAA,EAAoDjQ,EAAE,GAAGiQ,gBAAgB,CAAzE,MAAA,EAAkFjQ,EAAlF,EAAA,EAAwF;AACpF,UAAIkQ,aAAa,GAAGD,gBAAgB,CAApC,EAAoC,CAApC;AACA,UAAIxL,GAAG,GAAG4K,YAAY,CAAtB,OAAsB,CAAtB;AACA,UAAI9B,EAAE,GAAGiC,QAAQ,CAAC/K,GAAG,CAArB,KAAiB,CAAjB;AACA6K,MAAAA,QAAQ,CAARA,IAAAA,CAAc;AACV7K,QAAAA,GAAG,EADO,GAAA;AAEV8I,QAAAA,EAAE,EAFQ,EAAA;AAGV/I,QAAAA,QAAQ,EAHE,IAAA;AAIVgC,QAAAA,KAAK,EAJK,aAAA;AAKVsJ,QAAAA,OAAO,EALG,KAAA;AAMVC,QAAAA,KAAK,EAAE;AANG,OAAdT;AAQH;AACJ;;AACD,OAAK,IAAL,KAAA,IAAA,gBAAA,EAAoC;AAChC,QAAIrJ,MAAM,GAAGmJ,gBAAgB,CAA7B,KAA6B,CAA7B;AACA,QAAIrJ,cAAc,GAAGiK,YAAY,CAAA,MAAA,EAAjC,YAAiC,CAAjC;;AACA,SAAK,IAAI5T,EAAE,GAAN,CAAA,EAAY+T,gBAAgB,GAAjC,cAAA,EAAoD/T,EAAE,GAAG+T,gBAAgB,CAAzE,MAAA,EAAkF/T,EAAlF,EAAA,EAAwF;AACpF,UAAI8T,aAAa,GAAGC,gBAAgB,CAApC,EAAoC,CAApC;AACAb,MAAAA,QAAQ,CAARA,IAAAA,CAAc;AACV7K,QAAAA,GAAG,EAAEZ,UAAU,CAAVA,IAAAA,CADK,KACLA,CADK;AAEV0J,QAAAA,EAAE,EAAEiC,QAAQ,CAFF,KAEE,CAFF;AAGVhL,QAAAA,QAAQ,EAHE,IAAA;AAIVgC,QAAAA,KAAK,EAJK,aAAA;AAKVsJ,QAAAA,OAAO,EALG,KAAA;AAMVC,QAAAA,KAAK,EAAE;AANG,OAAdT;AAQH;AACJ;;AACD,SAAO;AAAEc,IAAAA,EAAE,EAAJ,QAAA;AAAgBC,IAAAA,EAAE,EAAEd;AAApB,GAAP;AACH;;AACD,SAAA,cAAA,CAAA,GAAA,EAA6B;AACzB,SAAO9K,GAAG,CAAHA,SAAAA,KAAAA,YAAAA,IAAkCA,GAAG,CAAHA,SAAAA,KAAzC,oBAAA;AACH;;AACD,SAAA,gBAAA,CAAA,IAAA,EAAA,IAAA,EAAA,QAAA,EAAgD;AAC5C,MAAI6L,IAAI,CAAJA,iBAAAA,CAAJ,aAAIA,CAAJ,EAA2C;AACvCC,IAAAA,IAAI,GAAG,IAAI,CAAJ,MAAA,CAAY,UAAA,GAAA,EAAe;AAC9B,UAAIC,MAAM,GAAG,IAAI,CAAJ,eAAA,CAAA,aAAA,EAAoC,CAC7C;AACIC,QAAAA,KAAK,EAAE,IAAA,QAAA,CAAaH,IAAI,CAAjB,QAAA,EAA4BI,GAAG,CAAHA,UAAAA,CAA5B,GAAA,EAAgDA,GAAG,CAAHA,UAAAA,CAD3D,QACW,CADX;AAEIC,QAAAA,QAAQ,EAFZ,QAAA;AAGIb,QAAAA,OAAO,EAAEY,GAAG,CAHhB,OAAA;AAIIX,QAAAA,KAAK,EAAEW,GAAG,CAJd,KAAA;AAKI;AACA7c,QAAAA,EAAE,EAAE6c,GAAG,CANX,EAAA;AAOIJ,QAAAA,IAAI,EAAEA;AAPV,OAD6C,CAApC,CAAb;;AAWA,UAAIE,MAAM,KAAV,KAAA,EAAsB;AAAE;AACpB,eAAA,KAAA;AADJ,OAAA,MAGK,IAAIA,MAAM,IAAIA,MAAM,KAApB,IAAA,EAA+B;AAChCE,QAAAA,GAAG,CAAHA,EAAAA,GAAAA,MAAAA;AACH;;AACD,aAAA,IAAA;AAlBJH,KAAO,CAAPA;AAoBH;;AACD,OAAK,IAAIvQ,EAAE,GAAN,CAAA,EAAY4Q,MAAM,GAAvB,IAAA,EAAgC5Q,EAAE,GAAG4Q,MAAM,CAA3C,MAAA,EAAoD5Q,EAApD,EAAA,EAA0D;AACtD,QAAI0Q,GAAG,GAAGE,MAAM,CAAhB,EAAgB,CAAhB;AACAC,IAAAA,QAAQ,CAACH,GAAG,CAAJ,EAAA,EAARG,GAAQ,CAARA;AACH;;AACD,SAAA,IAAA;AACH;;AACD,SAAA,QAAA,CAAA,EAAA,EAAA,GAAA,EAA2B;AACvBhd,EAAAA,EAAE,CAAFA,KAAAA,GAAAA,GAAAA;AACH;;AACD,SAAA,QAAA,CAAA,EAAA,EAAsB;AAClB,SAAOA,EAAE,CAAFA,KAAAA,IAAP,IAAA;EAEJ;;;AACA,SAAA,eAAA,CAAA,SAAA,EAAA,YAAA,EAAkD;AAC9C,SAAOid,OAAO,CAAA,SAAA,EAAY,UAAA,QAAA,EAAoB;AAC1C,WAAOC,cAAc,CAAA,QAAA,EAArB,YAAqB,CAArB;AADJ,GAAc,CAAd;AAGH;;AACD,SAAA,cAAA,CAAA,QAAA,EAAA,YAAA,EAAgD;AAC5C,MAAIC,GAAG,GAAP,EAAA;;AACA,MAAIC,YAAY,CAAhB,EAAgB,CAAhB,EAAsB;AAClBD,IAAAA,GAAG,CAAHA,IAAAA,CAASC,YAAY,CAArBD,EAAqB,CAArBA;AACH;;AACD,MAAIC,YAAY,CAACpO,QAAQ,CAAzB,KAAgB,CAAhB,EAAkC;AAC9BmO,IAAAA,GAAG,CAAHA,IAAAA,CAASC,YAAY,CAACpO,QAAQ,CAA9BmO,KAAqB,CAArBA;AACH;;AACDA,EAAAA,GAAG,CAAHA,IAAAA,CAASnO,QAAQ,CAAjBmO,EAAAA;AACA,SAAOE,eAAe,CAAtB,GAAsB,CAAtB;EAGJ;;;AACA,SAAA,yBAAA,CAAA,UAAA,EAAA,eAAA,EAAA,QAAA,EAAA,QAAA,EAAoF;AAChF,MAAIC,YAAY,GAAG1B,eAAe,CAAC5L,UAAU,CAAX,IAAA,EAAlC,eAAkC,CAAlC;AACA,MAAIZ,IAAI,GAAGa,qBAAX,EAAA;;AACA,OAAK,IAAL,KAAA,IAAkBD,UAAU,CAA5B,IAAA,EAAmC;AAC/B,QAAIY,GAAG,GAAGZ,UAAU,CAAVA,IAAAA,CAAV,KAAUA,CAAV;AACAZ,IAAAA,IAAI,CAAJA,IAAAA,CAAAA,KAAAA,IAAmBmO,uBAAuB,CAAA,GAAA,EAAMD,YAAY,CAAlB,KAAkB,CAAlB,EAAA,QAAA,EAAqC/M,QAAQ,CAARA,YAAAA,CAAAA,KAAAA,CAArC,wBAAA,EAA1CnB,QAA0C,CAA1CA;AACH;;AACD,OAAK,IAAL,UAAA,IAAuBY,UAAU,CAAjC,SAAA,EAA6C;AACzC,QAAIW,QAAQ,GAAGX,UAAU,CAAVA,SAAAA,CAAf,UAAeA,CAAf;AACA,QAAIY,GAAG,GAAGxB,IAAI,CAAJA,IAAAA,CAAUuB,QAAQ,CAFa,KAE/BvB,CAAV,CAFyC,CAEJ;;AACrCA,IAAAA,IAAI,CAAJA,SAAAA,CAAAA,UAAAA,IAA6BoO,4BAA4B,CAAA,QAAA,EAAA,GAAA,EAAgBF,YAAY,CAAC3M,QAAQ,CAArC,KAA4B,CAA5B,EAAA,QAAA,EAAzDvB,QAAyD,CAAzDA;AACH;;AACD,SAAA,IAAA;AACH;;AACD,SAAA,uBAAA,CAAA,QAAA,EAAA,WAAA,EAAA,QAAA,EAAA,QAAA,EAAA,QAAA,EAAsF;AAClF,MAAIqK,aAAa,GAAG0B,QAAQ,CAARA,aAAAA,IAD8D,EAClF,CADkF,CAElF;AACA;AACA;;AACA,MAAI1B,aAAa,CAAbA,MAAAA,IAAAA,IAAAA,IACAgE,WAAW,CADXhE,gBAAAA,KAEC0B,QAAQ,CAARA,UAAAA,IAAuBA,QAAQ,CAFpC,QAAI1B,CAAJ,EAEgD;AAC5CA,IAAAA,aAAa,CAAbA,MAAAA,GAD4C,IAC5CA,CAD4C,CACf;AAChC;;AACD,MAAIiE,IAAI,GAAGpP,OAAQ,CAAA,EAAA,EAAA,QAAA,EAAA,aAAA,EAA8B;AAAEoL,IAAAA,EAAE,EAAEpL,OAAQ,CAAA,EAAA,EAAKU,QAAQ,CAAb,EAAA,EAAkByK,aAAa,CAA/B,EAAA;AAAd,GAA9B,CAAnB;;AACA,MAAI0B,QAAQ,CAAZ,aAAA,EAA4B;AACxBuC,IAAAA,IAAI,CAAJA,aAAAA,GAAqBpP,OAAQ,CAAA,EAAA,EAAKoP,IAAI,CAAT,aAAA,EAAyBvC,QAAQ,CAA9DuC,aAA6B,CAA7BA;AACH;;AACD,OAAK,IAAIvR,EAAE,GAAN,CAAA,EAAYwR,UAAU,GAA3B,QAAA,EAAwCxR,EAAE,GAAGwR,UAAU,CAAvD,MAAA,EAAgExR,EAAhE,EAAA,EAAsE;AAClE,QAAIyR,OAAO,GAAGD,UAAU,CAAxB,EAAwB,CAAxB;AACAC,IAAAA,OAAO,CAAA,IAAA,EAAA,QAAA,EAAPA,QAAO,CAAPA;AACH;;AACD,MAAI,CAACF,IAAI,CAAL,MAAA,IAAgBnN,QAAQ,CAARA,GAAAA,CAApB,oBAAoBA,CAApB,EAAwD;AACpDmN,IAAAA,IAAI,CAAJA,MAAAA,GAAAA,IAAAA;AACH;;AACD,SAAA,IAAA;AACH;;AACD,SAAA,4BAAA,CAAA,aAAA,EAAA,QAAA,EAA+D;AAA/D,WAAA,EAAA,QAAA,EAAA,QAAA,EACiC;AAC7B,MAAI1P,OAAO,GAAGuC,QAAQ,CAAtB,OAAA;AACA,MAAIsN,WAAW,GAAG1C,QAAQ,CAARA,aAAAA,IAA0BA,QAAQ,CAARA,aAAAA,CAAAA,MAAAA,KAA5C,IAAA;AACA,MAAI2C,QAAQ,GAAG3C,QAAQ,CAARA,aAAAA,IAA0BA,QAAQ,CAARA,aAAAA,CAAAA,MAAAA,KAAzC,KAAA;;AACA,MAAIuC,IAAI,GAAGpP,OAAQ,CAAA,EAAA,EAAnB,aAAmB,CAAnB;;AACA,MAAA,WAAA,EAAiB;AACboP,IAAAA,IAAI,CAAJA,KAAAA,GAAajD,sBAAsB,CAACiD,IAAI,CAAxCA,KAAmC,CAAnCA;AACH;;AACD,MAAIvC,QAAQ,CAARA,UAAAA,IAAuBsC,WAAW,CAAtC,aAAA,EAAsD;AAClDC,IAAAA,IAAI,CAAJA,KAAAA,GAAa;AACTrQ,MAAAA,KAAK,EAAEW,OAAO,CAAPA,GAAAA,CAAY0P,IAAI,CAAJA,KAAAA,CAAZ1P,KAAAA,EAA8BmN,QAAQ,CADpC,UACFnN,CADE;AAETV,MAAAA,GAAG,EAAEU,OAAO,CAAPA,GAAAA,CAAY0P,IAAI,CAAJA,KAAAA,CAAZ1P,GAAAA,EAA4BmN,QAAQ,CAApCnN,UAAAA;AAFI,KAAb0P;AAIH;;AACD,MAAIvC,QAAQ,CAARA,UAAAA,IAAuBsC,WAAW,CAAtC,gBAAA,EAAyD;AACrDC,IAAAA,IAAI,CAAJA,KAAAA,GAAa;AACTrQ,MAAAA,KAAK,EAAEW,OAAO,CAAPA,GAAAA,CAAY0P,IAAI,CAAJA,KAAAA,CAAZ1P,KAAAA,EAA8BmN,QAAQ,CADpC,UACFnN,CADE;AAETV,MAAAA,GAAG,EAAEoQ,IAAI,CAAJA,KAAAA,CAAWpQ;AAFP,KAAboQ;AAIH;;AACD,MAAIvC,QAAQ,CAARA,QAAAA,IAAqBsC,WAAW,CAApC,gBAAA,EAAuD;AACnDC,IAAAA,IAAI,CAAJA,KAAAA,GAAa;AACTrQ,MAAAA,KAAK,EAAEqQ,IAAI,CAAJA,KAAAA,CADE,KAAA;AAETpQ,MAAAA,GAAG,EAAEU,OAAO,CAAPA,GAAAA,CAAY0P,IAAI,CAAJA,KAAAA,CAAZ1P,GAAAA,EAA4BmN,QAAQ,CAApCnN,QAAAA;AAFI,KAAb0P;AAIH;;AACD,MAAA,QAAA,EAAc;AACVA,IAAAA,IAAI,CAAJA,KAAAA,GAAa;AACTrQ,MAAAA,KAAK,EAAEqQ,IAAI,CAAJA,KAAAA,CADE,KAAA;AAETpQ,MAAAA,GAAG,EAAEiD,QAAQ,CAARA,kBAAAA,CAA4BvB,QAAQ,CAApCuB,MAAAA,EAA6CmN,IAAI,CAAJA,KAAAA,CAA7CnN,KAAAA;AAFI,KAAbmN;AA3ByB,GAAA,CAgC7B;AACA;;;AACA,MAAI1O,QAAQ,CAAZ,MAAA,EAAqB;AACjB0O,IAAAA,IAAI,CAAJA,KAAAA,GAAa;AACTrQ,MAAAA,KAAK,EAAEzG,UAAU,CAAC8W,IAAI,CAAJA,KAAAA,CADT,KACQ,CADR;AAETpQ,MAAAA,GAAG,EAAE1G,UAAU,CAAC8W,IAAI,CAAJA,KAAAA,CAAD,GAAA;AAFN,KAAbA;AAnCyB,GAAA,CAwC7B;;;AACA,MAAIA,IAAI,CAAJA,KAAAA,CAAAA,GAAAA,GAAiBA,IAAI,CAAJA,KAAAA,CAArB,KAAA,EAAuC;AACnCA,IAAAA,IAAI,CAAJA,KAAAA,CAAAA,GAAAA,GAAiBnN,QAAQ,CAARA,kBAAAA,CAA4BvB,QAAQ,CAApCuB,MAAAA,EAA6CmN,IAAI,CAAJA,KAAAA,CAA9DA,KAAiBnN,CAAjBmN;AACH;;AACD,SAAA,IAAA;AACH;;AAED,SAAA,gBAAA,CAAA,UAAA,EAAA,MAAA,EAAA,YAAA,EAAA,WAAA,EAAA,QAAA,EAAoF;AAChF,UAAQK,MAAM,CAAd,IAAA;AACI,SAAA,gBAAA;AAAuB;AACnB,aAAOC,gBAAgB,CAAA,UAAA,EAAaC,YAAY,CAACF,MAAM,CAAhC,QAAyB,CAAzB,EAA4CA,MAAM,CAAlD,OAAA,EAA4DA,MAAM,CAAlE,UAAA,EAA+EA,MAAM,CAArF,SAAA,EAAvB,QAAuB,CAAvB;;AACJ,SAAA,YAAA;AAAmB;AACf,aAAOG,QAAQ,CAAA,UAAA,EAAaH,MAAM,CAAnB,UAAA,EAAgC;AAC/CI,MAAAA,WAAW,GAAGA,WAAW,CAAd,WAAA,GADI,IAAA,EAAf,QAAe,CAAf;;AAEJ,SAAA,cAAA;AAAqB;AACjB,aAAOC,gBAAgB,CAAA,UAAA,EAAaL,MAAM,CAA1C,UAAuB,CAAvB;;AACJ,SARJ,MAQI,CARJ,CAQiB;;AACb,SAAA,MAAA;AACA,SAAA,UAAA;AACA,SAAA,eAAA;AACI,UAAA,WAAA,EAAiB;AACb,eAAOM,eAAe,CAAA,UAAA,EAAaF,WAAW,CAAxB,WAAA,EAAtB,QAAsB,CAAtB;AADJ,OAAA,MAGK;AACD,eAAA,UAAA;AACH;;AACL,SAAA,iBAAA;AACI,aAAOG,WAAW,CAAA,UAAA,EAAaP,MAAM,CAAnB,UAAA,EAAgCxN,QAAQ,CAA1D,OAAkB,CAAlB;;AACJ,SAAA,eAAA;AACI,aAAOgO,sBAAsB,CAAA,UAAA,EAAaR,MAAM,CAAnB,UAAA,EAAgCA,MAAM,CAAtC,QAAA,EAAiDA,MAAM,CAAvD,OAAA,EAA7B,QAA6B,CAA7B;;AACJ,SAAA,wBAAA;AACI,aAAOS,gBAAgB,CAAA,UAAA,EAAaT,MAAM,CAA1C,SAAuB,CAAvB;;AACJ,SAAA,kBAAA;AACI,aAAO5M,oBAAoB,CAAA,UAAA,EAAa,UAAA,QAAA,EAAoB;AACxD,eAAOnC,QAAQ,CAARA,KAAAA,KAAmB+O,MAAM,CAAhC,KAAA;AADJ,OAA2B,CAA3B;;AAGJ,SAAA,qBAAA;AACI,aAAOU,uBAAuB,CAAA,UAAA,EAAaV,MAAM,CAAjD,QAA8B,CAA9B;;AACJ,SAAA,0BAAA;AACI,aAAO5M,oBAAoB,CAAA,UAAA,EAAa,UAAA,QAAA,EAAoB;AACxD,eAAO,CAACnC,QAAQ,CADwC,QACxD,CADwD,CAC7B;AAD/B,OAA2B,CAA3B;;AAGJ,SAAA,mBAAA;AACI,aAAOiB,qBAAP,EAAA;;AACJ,SAAA,cAAA;AACI,aAAO;AACHO,QAAAA,IAAI,EAAER,UAAU,CADb,IAAA;AAEHS,QAAAA,SAAS,EAAET,UAAU,CAACS;AAFnB,OAAP;;AAIJ;AACI,aAAA,UAAA;AA1CR;AA4CH;;AACD,SAAA,gBAAA,CAAA,UAAA,EAAA,WAAA,EAAA,OAAA,EAAA,UAAA,EAAA,SAAA,EAAA,QAAA,EAA6F;AACzF,MAAIiB,WAAW,IAAI;AACfgN,EAAAA,OAAO,KAAKhN,WAAW,CAD3B,aAAA,CAC0C;AAD1C,IAEE;AACE,UAAIiN,MAAM,GAAGC,WAAW,CAACC,kBAAkB,CAAA,SAAA,EAAA,WAAA,EAAnB,QAAmB,CAAnB,EAAuDnN,WAAW,CAAlE,QAAA,EAAxB,QAAwB,CAAxB;;AACA,UAAA,UAAA,EAAgB;AACZiN,QAAAA,MAAM,GAAGN,eAAe,CAAA,MAAA,EAAA,UAAA,EAAxBM,QAAwB,CAAxBA;AACH;;AACD,aAAOP,gBAAgB,CAACK,uBAAuB,CAAA,UAAA,EAAa/M,WAAW,CAAhD,QAAwB,CAAxB,EAAvB,MAAuB,CAAvB;AACH;;AACD,SAAA,UAAA;AACH;;AACD,SAAA,QAAA,CAAA,UAAA,EAAA,MAAA,EAAA,WAAA,EAAA,QAAA,EAA6D;AACzD,MAAA,WAAA,EAAiB;AACbiN,IAAAA,MAAM,GAAGN,eAAe,CAAA,MAAA,EAAA,WAAA,EAAxBM,QAAwB,CAAxBA;AACH;;AACD,SAAOP,gBAAgB,CAAA,UAAA,EAAvB,MAAuB,CAAvB;AACH;;AACD,SAAA,WAAA,CAAA,UAAA,EAAA,UAAA,EAAA,UAAA,EAAyD;AACrD,MAAI5N,IAAI,GAAGR,UAAU,CAArB,IAAA;AACA,MAAIS,SAAS,GAAGwM,OAAO,CAACjN,UAAU,CAAX,SAAA,EAAuB,UAAA,QAAA,EAAoB;AAC9D,QAAIY,GAAG,GAAGJ,IAAI,CAACG,QAAQ,CAAvB,KAAc,CAAd;;AACA,QAAIC,GAAG,CAAHA,MAAAA,IAAcA,GAAG,CAArB,YAAA,EAAoC;AAChC,aADgC,QAChC,CADgC,CACf;AADrB,KAAA,MAGK;AACD,aAAOtC,OAAQ,CAAA,EAAA,EAAA,QAAA,EAAe;AAAEqE,QAAAA,KAAK,EAAE;AAC/BtF,UAAAA,KAAK,EAAEyR,UAAU,CAAVA,YAAAA,CAAwBC,UAAU,CAAVA,MAAAA,CAAkBpO,QAAQ,CAARA,KAAAA,CAAlBoO,KAAAA,EAAwCpO,QAAQ,CADhD,cACAoO,CAAxBD,CADwB;AAE/BxR,UAAAA,GAAG,EAAEwR,UAAU,CAAVA,YAAAA,CAAwBC,UAAU,CAAVA,MAAAA,CAAkBpO,QAAQ,CAARA,KAAAA,CAAlBoO,GAAAA,EAAsCpO,QAAQ,CAAtEmO,YAAwBC,CAAxBD;AAF0B,SAAT;AAGvB/D,QAAAA,cAAc,EAAE+D,UAAU,CAAVA,gBAAAA,GAAAA,IAAAA,GAAqCnO,QAAQ,CAHtC,cAAA;AAGuDqK,QAAAA,YAAY,EAAE8D,UAAU,CAAVA,gBAAAA,GAAAA,IAAAA,GAAqCnO,QAAQ,CAACqK;AAHnH,OAAf,CAAf;AAIH;AAVL,GAAuB,CAAvB;AAYA,SAAO;AAAExK,IAAAA,IAAI,EAAN,IAAA;AAAcC,IAAAA,SAAS,EAAEA;AAAzB,GAAP;AACH;;AACD,SAAA,sBAAA,CAAA,UAAA,EAAA,UAAA,EAAA,QAAA,EAAA,OAAA,EAAA,QAAA,EAAqF;AACjF,MAAIuO,QAAQ,GAAGC,iBAAiB,CAAA,UAAA,EAAhC,UAAgC,CAAhC;AACA,MAAIC,eAAe,GAAG9D,OAAO,GACzB;AAAE,QAAI;AACEtB,MAAAA,aAAa,EADf,IAAA;AAEEC,MAAAA,gBAAgB,EAFlB,IAAA;AAGEoF,MAAAA,WAAW,EAHb,EAAA;AAIEC,MAAAA,OAAO,EAJT,IAAA;AAKEC,MAAAA,MAAM,EALR,EAAA;AAMEzF,MAAAA,eAAe,EANjB,EAAA;AAOEC,MAAAA,WAAW,EAPb,EAAA;AAQEyF,MAAAA,SAAS,EARX,EAAA;AASEC,MAAAA,UAAU,EAAE;AATd;AAAN,GADyB,GAYzBhP,QAAQ,CAZZ,YAAA;AAaAyO,EAAAA,QAAQ,GAAGQ,yBAAyB,CAAA,QAAA,EAAA,eAAA,EAAA,QAAA,EAApCR,QAAoC,CAApCA;AACA,SAAOZ,gBAAgB,CAAA,UAAA,EAAvB,QAAuB,CAAvB;AACH;;AACD,SAAA,uBAAA,CAAA,UAAA,EAAA,QAAA,EAAuD;AACnD,SAAOjN,oBAAoB,CAAA,UAAA,EAAa,UAAA,QAAA,EAAoB;AACxD,WAAOnC,QAAQ,CAARA,QAAAA,KAAP,QAAA;AADJ,GAA2B,CAA3B;EAIJ;;;AACA,SAAA,gBAAA,CAAA,UAAA,EAAA,QAAA,EAAgD;AAC5C,SAAO;AACHwB,IAAAA,IAAI,EAAER,UAAU,CADb,IAAA;AAEHS,IAAAA,SAAS,EAAEC,UAAU,CAACV,UAAU,CAAX,SAAA,EAAuB,UAAA,QAAA,EAAoB;AAC5D,aAAO,CAACyP,QAAQ,CAAC9O,QAAQ,CAAzB,UAAgB,CAAhB;AADiB,KAAA;AAFlB,GAAP;EAQJ;AACA;;;AACA,SAAA,kBAAA,CAAA,WAAA,EAAA,QAAA,EAAmD;AAC/C,SAAO+O,eAAe,CAAC;AAAEC,IAAAA,SAAS,EAAEC;AAAb,GAAD,EADyB,QACzB,CAAtB,CAD+C,CACe;AACjE;;AACD,SAAA,oBAAA,CAAA,aAAA,EAAA,QAAA,EAAuD;AACnD,SAAOF,eAAe,CAAC;AAAEG,IAAAA,aAAa,EAAEA;AAAjB,GAAD,EAAtB,QAAsB,CAAtB;AACH;;AACD,SAAA,eAAA,CAAA,QAAA,EAAA,QAAA,EAA6C;AACzC,MAAIpD,IAAI,GAAGlM,QAAQ,CAAnB,IAAA;;AACA,MAAItO,KAAK,GAAGqM,OAAQ,CAAC;AAAEwR,IAAAA,aAAa,EAAErD,IAAI,GAAGA,IAAI,CAAJA,KAAAA,CAAH,aAAA,GAA8BxM,qBAAnD,EAAA;AAA4E4P,IAAAA,aAAa,EAAzF,EAAA;AAA+F7P,IAAAA,UAAU,EAAEO,QAAQ,CAARA,KAAAA,CAA3G,UAAA;AAAsI6M,IAAAA,YAAY,EAAE7M,QAAQ,CAA5J,YAAA;AAA2KwP,IAAAA,cAAc,EAAzL,EAAA;AAA+LJ,IAAAA,SAAS,EAAxM,IAAA;AAAgNK,IAAAA,WAAW,EAAE;AAA7N,GAAD,EAApB,QAAoB,CAApB;;AACA,SAAO,CAACzP,QAAQ,CAARA,YAAAA,CAAAA,KAAAA,CAAAA,YAAAA,IAAD,YAAA,EAAA,KAAA,EAAP,QAAO,CAAP;AACH;;AACD,SAAA,YAAA,CAAA,KAAA,EAAA,QAAA,EAAA,YAAA,EAAA,YAAA,EAAmE;AAC/D,MAAI0P,YAAY,KAAK,KAArB,CAAA,EAA6B;AAAEA,IAAAA,YAAY,GAAZA,EAAAA;AAAoB;;AACnD,MAAIC,KAAK,CAALA,SAAAA,IAAmB,CAACC,uBAAuB,CAAA,KAAA,EAAA,QAAA,EAAA,YAAA,EAA/C,YAA+C,CAA/C,EAA8F;AAC1F,WAAA,KAAA;AACH;;AACD,MAAID,KAAK,CAALA,aAAAA,IAAuB,CAACE,yBAAyB,CAAA,KAAA,EAAA,QAAA,EAAA,YAAA,EAArD,YAAqD,CAArD,EAAoG;AAChG,WAAA,KAAA;AACH;;AACD,SAAA,IAAA;EAEJ;AACA;;;AACA,SAAA,uBAAA,CAAA,KAAA,EAAA,QAAA,EAAA,YAAA,EAAA,YAAA,EAA8E;AAC1E,MAAIR,WAAW,GAAGM,KAAK,CADmD,SAC1E,CAD0E,CACvC;;AACnC,MAAIG,iBAAiB,GAAGT,WAAW,CAAnC,aAAA;AACA,MAAIU,WAAW,GAAGD,iBAAiB,CAAnC,IAAA;AACA,MAAIE,gBAAgB,GAAGF,iBAAiB,CAAxC,SAAA;AACA,MAAIG,cAAc,GAAG5E,eAAe,CAAA,WAAA,EAAcgE,WAAW,CAAXA,OAAAA,GAC9CM,KAAK,CADyCN,YAAAA,GAE9C;AAAE,QAAIrP,QAAQ,CAACkQ;AAAf,GAFgC,CAEC;AAFD,GAApC;;AAIA,MAAA,YAAA,EAAkB;AACdD,IAAAA,cAAc,GAAGvD,OAAO,CAAA,cAAA,EAAxBuD,YAAwB,CAAxBA;AACH;;AACD,MAAIE,eAAe,GAAGlC,gBAAgB,CAAC0B,KAAK,CAAN,UAAA,EAAmBN,WAAW,CAAXA,cAAAA,CAZiB,SAYpC,CAAtC,CAZ0E,CAYsB;;AAChG,MAAIe,SAAS,GAAGD,eAAe,CAA/B,IAAA;AACA,MAAIE,cAAc,GAAGF,eAAe,CAApC,SAAA;AACA,MAAIG,YAAY,GAAGjF,eAAe,CAAA,SAAA,EAAYsE,KAAK,CAAnD,YAAkC,CAAlC;;AACA,OAAK,IAAL,iBAAA,IAAA,gBAAA,EAAgD;AAC5C,QAAIY,eAAe,GAAGP,gBAAgB,CAAtC,iBAAsC,CAAtC;AACA,QAAIQ,YAAY,GAAGD,eAAe,CAAlC,KAAA;AACA,QAAIE,aAAa,GAAGR,cAAc,CAACM,eAAe,CAAlD,KAAkC,CAAlC;AACA,QAAIG,UAAU,GAAGX,WAAW,CAACQ,eAAe,CAJA,KAIhB,CAA5B,CAJ4C,CAK5C;;AACA,QAAI,CAACI,kBAAkB,CAACF,aAAa,CAAd,WAAA,EAAA,YAAA,EAAA,eAAA,EAA2Dd,KAAK,CAAhE,aAAA,EAAvB,QAAuB,CAAvB,EAAkH;AAC9G,aAAA,KAAA;AAPwC,KAAA,CAS5C;;;AACA,QAAIiB,WAAW,GAAG5Q,QAAQ,CAARA,GAAAA,CAAlB,cAAkBA,CAAlB;;AACA,QAAI,OAAA,WAAA,KAAJ,UAAA,EAAuC;AACnC4Q,MAAAA,WAAW,GAAXA,IAAAA;AACH;;AACD,SAAK,IAAL,eAAA,IAAA,cAAA,EAA4C;AACxC,UAAIC,aAAa,GAAGR,cAAc,CADM,eACN,CAAlC,CADwC,CAExC;;AACA,UAAIS,eAAe,CAAA,YAAA,EAAeD,aAAa,CAA/C,KAAmB,CAAnB,EAAwD;AACpD,YAAIE,YAAY,GAAGT,YAAY,CAACO,aAAa,CAA1BP,KAAY,CAAZA,CADiC,OACpD,CADoD,CAEpD;;AACA,YAAIS,YAAY,KAAZA,KAAAA,IAA0B1B,WAAW,CAAzC,OAAA,EAAmD;AAC/C,iBAAA,KAAA;AACH;;AACD,YAAIoB,aAAa,CAAbA,OAAAA,KAAJ,KAAA,EAAqC;AACjC,iBAAA,KAAA;AACH;;AACD,YAAIG,WAAW,IAAI,CAACA,WAAW,CAAC,IAAA,QAAA,CAAA,QAAA,EAAuBR,SAAS,CAACS,aAAa,CAA9C,KAAgC,CAAhC,EAAD,aAAC,CAAD,EAAwE;AACvG,YAAA,QAAA,CAAA,QAAA,EAAA,UAAA,EAD+B,eAC/B,CAD+B,CACqB;AADrB,SAA/B,EAEG;AACC,iBAAA,KAAA;AACH;AACJ;AA/BuC,KAAA,CAiC5C;;;AACA,QAAIG,kBAAkB,GAAGhR,QAAQ,CAARA,KAAAA,CAlCmB,UAkC5C,CAlC4C,CAkCQ;;AACpD,SAAK,IAAIpE,EAAE,GAAN,CAAA,EAAY5D,EAAE,GAAGyY,aAAa,CAAnC,MAAA,EAA4C7U,EAAE,GAAG5D,EAAE,CAAnD,MAAA,EAA4D4D,EAA5D,EAAA,EAAkE;AAC9D,UAAIqV,YAAY,GAAGjZ,EAAE,CAArB,EAAqB,CAArB;;AACA,UAAIkZ,eAAe,GAAGnT,OAAQ,CAAA,EAAA,EAAA,YAAA,EAAmB;AAAEqE,QAAAA,KAAK,EAAEmO,eAAe,CAAxB,KAAA;AAAgCnS,QAAAA,MAAM,EAAEsS,UAAU,CAACtS;AAAnD,OAAnB,CAA9B;;AACA,UAAI+S,OAAO,GAAGH,kBAAkB,CAAlBA,IAAAA,CAAwBN,UAAU,CAAhD,KAAcM,CAAd;AACA,UAAII,YAAY,GAAGJ,kBAAkB,CAAlBA,SAAAA,CAAnB,iBAAmBA,CAAnB;AACA,UAAIK,QAAQ,GAAG,KAAf,CAAA;;AACA,UAAA,OAAA,EAAa;AAAE;AACXA,QAAAA,QAAQ,GAAG,IAAA,QAAA,CAAA,QAAA,EAAA,OAAA,EAAXA,YAAW,CAAXA;AADJ,OAAA,MAGK;AAAE;AACHA,QAAAA,QAAQ,GAAG,IAAA,QAAA,CAAA,QAAA,EADV,UACU,CAAXA,CADC,CAC8C;AAClD;;AACD,UAAI,CAACJ,YAAY,CAACjR,QAAQ,CAARA,gBAAAA,CAAD,eAACA,CAAD,EAAjB,QAAiB,CAAjB,EAAyE;AACrE,eAAA,KAAA;AACH;AACJ;AACJ;;AACD,SAAA,IAAA;EAEJ;AACA;;;AACA,SAAA,yBAAA,CAAA,KAAA,EAAA,QAAA,EAAA,YAAA,EAAA,YAAA,EAAgF;AAC5E,MAAIsR,kBAAkB,GAAG3B,KAAK,CAA9B,UAAA;AACA,MAAI4B,YAAY,GAAGD,kBAAkB,CAArC,IAAA;AACA,MAAIE,iBAAiB,GAAGF,kBAAkB,CAA1C,SAAA;AACA,MAAIG,SAAS,GAAG9B,KAAK,CAArB,aAAA;AACA,MAAI+B,cAAc,GAAGD,SAAS,CAA9B,KAAA;AACA,MAAIvB,eAAe,GAAGlQ,QAAQ,CAA9B,eAAA;;AACA,MAAA,YAAA,EAAkB;AACdkQ,IAAAA,eAAe,GAAGyB,YAAY,CAA9BzB,eAA8B,CAA9BA;AARwE,GAAA,CAU5E;;;AACA,MAAI,CAACS,kBAAkB,CAACT,eAAe,CAAhB,WAAA,EAAA,cAAA,EAAA,kBAAA,EAAkEP,KAAK,CAAvE,aAAA,EAAvB,QAAuB,CAAvB,EAAyH;AACrH,WAAA,KAAA;AAZwE,GAAA,CAc5E;;;AACA,MAAIiB,WAAW,GAAG5Q,QAAQ,CAARA,GAAAA,CAAlB,eAAkBA,CAAlB;;AACA,MAAI,OAAA,WAAA,KAAJ,UAAA,EAAuC;AACnC4Q,IAAAA,WAAW,GAAXA,IAAAA;AACH;;AACD,OAAK,IAAL,kBAAA,IAAA,iBAAA,EAAkD;AAC9C,QAAIgB,gBAAgB,GAAGJ,iBAAiB,CADM,kBACN,CAAxC,CAD8C,CAE9C;;AACA,QAAIV,eAAe,CAAA,cAAA,EAAiBc,gBAAgB,CAApD,KAAmB,CAAnB,EAA6D;AACzD,UAAI1B,eAAe,CAAfA,OAAAA,KAAJ,KAAA,EAAuC;AACnC,eAAA,KAAA;AACH;;AACD,UAAIU,WAAW,IAAI,CAACA,WAAW,CAAC,IAAA,QAAA,CAAA,QAAA,EAAuBW,YAAY,CAACK,gBAAgB,CAApD,KAAmC,CAAnC,EAAhC,gBAAgC,CAAD,CAA/B,EAAiH;AAC7G,eAAA,KAAA;AACH;AACJ;AA7BuE,GAAA,CA+B5E;;;AACA,OAAK,IAAIhW,EAAE,GAAN,CAAA,EAAY5D,EAAE,GAAGkY,eAAe,CAArC,MAAA,EAA8CtU,EAAE,GAAG5D,EAAE,CAArD,MAAA,EAA8D4D,EAA9D,EAAA,EAAoE;AAChE,QAAIiW,cAAc,GAAG7Z,EAAE,CAAvB,EAAuB,CAAvB;;AACA,QAAI8Z,YAAY,GAAG/T,OAAQ,CAAA,EAAA,EAAA,YAAA,EAA3B,SAA2B,CAA3B;;AACA,QAAI,CAAC8T,cAAc,CAAC7R,QAAQ,CAARA,gBAAAA,CAAD,YAACA,CAAD,EAAnB,IAAmB,CAAnB,EAAoE;AAChE,aAAA,KAAA;AACH;AACJ;;AACD,SAAA,IAAA;EAEJ;AACA;;;AACA,SAAA,kBAAA,CAAA,WAAA,EAAA,YAAA,EAAA,eAAA,EAAA,uBAAA,EAAA,QAAA,EAA2G;AACvG,OAAK,IAAIpE,EAAE,GAAN,CAAA,EAAYmW,aAAa,GAA9B,WAAA,EAA8CnW,EAAE,GAAGmW,aAAa,CAAhE,MAAA,EAAyEnW,EAAzE,EAAA,EAA+E;AAC3E,QAAIoW,UAAU,GAAGD,aAAa,CAA9B,EAA8B,CAA9B;;AACA,QAAI,CAACE,qBAAqB,CAACC,kBAAkB,CAAA,UAAA,EAAA,YAAA,EAAA,eAAA,EAAA,uBAAA,EAAnB,QAAmB,CAAnB,EAA1B,YAA0B,CAA1B,EAA4I;AACxI,aAAA,KAAA;AACH;AACJ;;AACD,SAAA,IAAA;AACH;;AACD,SAAA,kBAAA,CAAA,UAAA,EAAA,YAAA,EAAsD;AAAtD,eAAA,EACiB;AADjB,uBAAA,EAEyB;AAFzB,QAAA,CAGS;AAHT,EAIE;AACE,MAAIF,UAAU,KAAd,eAAA,EAAoC;AAChC,WAAOG,kBAAkB,CAACrE,eAAe,CAAA,uBAAA,EAAA,YAAA,EAAzC,QAAyC,CAAhB,CAAzB;AADJ,GAAA,MAGK,IAAI,OAAA,UAAA,KAAJ,QAAA,EAAoC;AAAE;AACvC,WAAOqE,kBAAkB,CAACvR,oBAAoB,CAAA,eAAA,EAAkB,UAAA,QAAA,EAAoB;AAChF,aAAOnC,QAAQ,CAARA,OAAAA,KAAP,UAAA;AADJ,KAA8C,CAArB,CAAzB;AADC,GAAA,MAKA,IAAI,OAAA,UAAA,KAAA,QAAA,IAAJ,UAAA,EAAkD;AAAE;AACrD,WAAO0T,kBAAkB,CAACrE,eAAe,CAAA,UAAA,EAAA,YAAA,EAAzC,QAAyC,CAAhB,CAAzB;AACH;;AACD,SAZF,EAYE,CAZF,CAYa;EAEf;;;AACA,SAAA,kBAAA,CAAA,UAAA,EAAwC;AACpC,MAAI5N,SAAS,GAAGT,UAAU,CAA1B,SAAA;AACA,MAAIoC,MAAM,GAAV,EAAA;;AACA,OAAK,IAAL,UAAA,IAAA,SAAA,EAAkC;AAC9BA,IAAAA,MAAM,CAANA,IAAAA,CAAY3B,SAAS,CAATA,UAAS,CAATA,CAAZ2B,KAAAA;AACH;;AACD,SAAA,MAAA;EAEJ;;;AACA,SAAA,qBAAA,CAAA,WAAA,EAAA,UAAA,EAAwD;AACpD,OAAK,IAAIjG,EAAE,GAAN,CAAA,EAAYwW,aAAa,GAA9B,WAAA,EAA8CxW,EAAE,GAAGwW,aAAa,CAAhE,MAAA,EAAyExW,EAAzE,EAAA,EAA+E;AAC3E,QAAIsG,UAAU,GAAGkQ,aAAa,CAA9B,EAA8B,CAA9B;;AACA,QAAIC,kBAAkB,CAAA,UAAA,EAAtB,UAAsB,CAAtB,EAAgD;AAC5C,aAAA,IAAA;AACH;AACJ;;AACD,SAAA,KAAA;EAEJ;AACA;;;AACA,SAAA,mBAAA,CAAA,KAAA,EAAA,QAAA,EAA8C;AAC1C,MAAIliB,KAAK,CAALA,OAAAA,CAAJ,KAAIA,CAAJ,EAA0B;AACtB,WAAOke,WAAW,CAAA,KAAA,EAAA,EAAA,EAAA,QAAA,EADI,IACJ,CAAlB,CADsB,CACyB;AADnD,GAAA,MAGK,IAAI,OAAA,KAAA,KAAA,QAAA,IAAJ,KAAA,EAAwC;AAAE;AAC3C,WAAOA,WAAW,CAAC,CAAD,KAAC,CAAD,EAAA,EAAA,EAAA,QAAA,EADuB,IACvB,CAAlB,CADyC,CACQ;AADhD,GAAA,MAGA,IAAI7T,KAAK,IAAT,IAAA,EAAmB;AACpB,WAAOa,MAAM,CAAb,KAAa,CAAb;AADC,GAAA,MAGA;AACD,WAAA,IAAA;AACH;AACJ;;AAED,SAAA,UAAA,CAAA,CAAA,EAAuB;AACnB,SAAO,CAACE,CAAC,GAAF,EAAA,EAAA,OAAA,CAAA,IAAA,EAAA,OAAA,EAAA,OAAA,CAAA,IAAA,EAAA,MAAA,EAAA,OAAA,CAAA,IAAA,EAAA,MAAA,EAAA,OAAA,CAAA,IAAA,EAAA,QAAA,EAAA,OAAA,CAAA,IAAA,EAAA,QAAA,EAAA,OAAA,CAAA,KAAA,EAAP,QAAO,CAAP;EAOJ;AACA;;;AACA,SAAA,QAAA,CAAA,QAAA,EAA4B;AACxB,MAAI+W,UAAU,GAAd,EAAA;;AACA,OAAK,IAAL,MAAA,IAAA,QAAA,EAA6B;AACzB,QAAI3gB,GAAG,GAAG4gB,QAAQ,CAAlB,MAAkB,CAAlB;;AACA,QAAI5gB,GAAG,IAAHA,IAAAA,IAAeA,GAAG,KAAtB,EAAA,EAA+B;AAC3B2gB,MAAAA,UAAU,CAAVA,IAAAA,CAAgB/N,MAAM,GAANA,GAAAA,GAAhB+N,GAAAA;AACH;AACJ;;AACD,SAAOA,UAAU,CAAVA,IAAAA,CAAP,GAAOA,CAAP;EAEJ;AACA;;;AACA,SAAA,UAAA,CAAA,KAAA,EAA2B;AACvB,MAAIlM,KAAK,GAAT,EAAA;;AACA,OAAK,IAAL,MAAA,IAAA,KAAA,EAA0B;AACtB,QAAIzU,GAAG,GAAG9B,KAAK,CAAf,MAAe,CAAf;;AACA,QAAI8B,GAAG,IAAP,IAAA,EAAiB;AACbyU,MAAAA,KAAK,CAALA,IAAAA,CAAWK,MAAM,GAANA,IAAAA,GAAgB+L,UAAU,CAA1B/L,GAA0B,CAA1BA,GAAXL,GAAAA;AACH;AACJ;;AACD,SAAOA,KAAK,CAALA,IAAAA,CAAP,GAAOA,CAAP;AACH;;AACD,SAAA,cAAA,CAAA,GAAA,EAA6B;AACzB,MAAIjW,KAAK,CAALA,OAAAA,CAAJ,GAAIA,CAAJ,EAAwB;AACpB,WAAA,GAAA;AADJ,GAAA,MAGK,IAAI,OAAA,GAAA,KAAJ,QAAA,EAA6B;AAC9B,WAAOsiB,GAAG,CAAHA,KAAAA,CAAP,KAAOA,CAAP;AADC,GAAA,MAGA;AACD,WAAA,EAAA;AACH;AACJ;;AAED,IAAIrJ,uBAAuB,GAAG;AAC1BsJ,EAAAA,QAAQ,EADkB,OAAA;AAE1BnJ,EAAAA,aAAa,EAFa,OAAA;AAG1BC,EAAAA,gBAAgB,EAHU,OAAA;AAI1BwI,EAAAA,UAAU,EAJgB,IAAA;AAK1BnD,EAAAA,OAAO,EALmB,IAAA;AAM1B8D,EAAAA,KAAK,EANqB,IAAA;AAO1BtjB,EAAAA,SAAS,EAPiB,cAAA;AAQ1B2f,EAAAA,UAAU,EARgB,cAAA;AAS1B4D,EAAAA,KAAK,EATqB,MAAA;AAU1BvJ,EAAAA,eAAe,EAVW,MAAA;AAW1BC,EAAAA,WAAW,EAXe,MAAA;AAY1ByF,EAAAA,SAAS,EAAE1T;AAZe,CAA9B;;AAcA,SAAA,sBAAA,CAAA,QAAA,EAAA,QAAA,EAAA,SAAA,EAA+D;AAC3D,MAAI3J,KAAK,GAAGmhB,WAAW,CAAA,QAAA,EAAA,uBAAA,EAAA,EAAA,EAAvB,SAAuB,CAAvB;AACA,MAAIb,UAAU,GAAGc,mBAAmB,CAACphB,KAAK,CAAN,UAAA,EAApC,QAAoC,CAApC;AACA,SAAO;AACH6X,IAAAA,aAAa,EAAE7X,KAAK,CAALA,aAAAA,IAAAA,IAAAA,GAA8BA,KAAK,CAAnCA,aAAAA,GAAoDA,KAAK,CADrE,QAAA;AAEH8X,IAAAA,gBAAgB,EAAE9X,KAAK,CAALA,gBAAAA,IAAAA,IAAAA,GAAiCA,KAAK,CAAtCA,gBAAAA,GAA0DA,KAAK,CAF9E,QAAA;AAGHkd,IAAAA,WAAW,EAAEoD,UAAU,IAAVA,IAAAA,GAAqB,CAArBA,UAAqB,CAArBA,GAHV,EAAA;AAIHnD,IAAAA,OAAO,EAAEnd,KAAK,CAJX,OAAA;AAKHod,IAAAA,MAAM,EAAEpd,KAAK,CAALA,KAAAA,IAAAA,IAAAA,GAAsB,CAACA,KAAK,CAA5BA,KAAsB,CAAtBA,GALL,EAAA;AAMH2X,IAAAA,eAAe,EAAE3X,KAAK,CAALA,eAAAA,IAAyBA,KAAK,CAN5C,KAAA;AAOH4X,IAAAA,WAAW,EAAE5X,KAAK,CAALA,WAAAA,IAAqBA,KAAK,CAPpC,KAAA;AAQHqd,IAAAA,SAAS,EAAErd,KAAK,CARb,SAAA;AASHsd,IAAAA,UAAU,EAAEtd,KAAK,CAALA,UAAAA,CAAAA,MAAAA,CAAwBA,KAAK,CAA7BA,SAAAA;AATT,GAAP;AAWH;;AACD,SAAA,oBAAA,CAAA,MAAA,EAAA,SAAA,EAAA,QAAA,EAAA,SAAA,EAAsE;AAClE,MAAIqhB,WAAW,GAAf,EAAA;AACA,MAAIC,QAAQ,GAAZ,EAAA;;AACA,OAAK,IAAL,GAAA,IAAA,uBAAA,EAAyC;AACrC,QAAIC,SAAS,GAAGC,MAAM,GAAGC,qBAAqB,CAA9C,GAA8C,CAA9C;AACAJ,IAAAA,WAAW,CAAXA,GAAW,CAAXA,GAAmBK,SAAS,CAA5BL,SAA4B,CAA5BA;AACAC,IAAAA,QAAQ,CAARA,SAAQ,CAARA,GAAAA,IAAAA;AACH;;AACD,MAAIE,MAAM,KAAV,OAAA,EAAwB;AACpBH,IAAAA,WAAW,CAAXA,QAAAA,GAAuBK,SAAS,CADZ,QACpBL,CADoB,CACuB;AAC9C;;AACD,MAAA,SAAA,EAAe;AACX,SAAK,IAAL,GAAA,IAAA,SAAA,EAA2B;AACvB,UAAI,CAACC,QAAQ,CAAb,GAAa,CAAb,EAAoB;AAChBK,QAAAA,SAAS,CAATA,GAAS,CAATA,GAAiBD,SAAS,CAA1BC,GAA0B,CAA1BA;AACH;AACJ;AACJ;;AACD,SAAOC,sBAAsB,CAAA,WAAA,EAA7B,QAA6B,CAA7B;AACH;;AACD,IAAIC,cAAc,GAAG;AACjBhK,EAAAA,aAAa,EADI,IAAA;AAEjBC,EAAAA,gBAAgB,EAFC,IAAA;AAGjBoF,EAAAA,WAAW,EAHM,EAAA;AAIjBC,EAAAA,OAAO,EAJU,IAAA;AAKjBC,EAAAA,MAAM,EALW,EAAA;AAMjBzF,EAAAA,eAAe,EANE,EAAA;AAOjBC,EAAAA,WAAW,EAPM,EAAA;AAQjByF,EAAAA,SAAS,EARQ,EAAA;AASjBC,EAAAA,UAAU,EAAE;AATK,CAArB,C,CAWA;;AACA,SAAA,eAAA,CAAA,GAAA,EAA8B;AAC1B,SAAOpC,GAAG,CAAHA,MAAAA,CAAAA,kBAAAA,EAAP,cAAOA,CAAP;AACH;;AACD,SAAA,kBAAA,CAAA,KAAA,EAAA,KAAA,EAA0C;AACtC,SAAO;AACHrD,IAAAA,aAAa,EAAEiK,KAAK,CAALA,aAAAA,IAAAA,IAAAA,GAA8BA,KAAK,CAAnCA,aAAAA,GAAoDC,KAAK,CADrE,aAAA;AAEHjK,IAAAA,gBAAgB,EAAEgK,KAAK,CAALA,gBAAAA,IAAAA,IAAAA,GAAiCA,KAAK,CAAtCA,gBAAAA,GAA0DC,KAAK,CAF9E,gBAAA;AAGH7E,IAAAA,WAAW,EAAE6E,KAAK,CAALA,WAAAA,CAAAA,MAAAA,CAAyBD,KAAK,CAHxC,WAGUC,CAHV;AAIH5E,IAAAA,OAAO,EAAE,OAAO2E,KAAK,CAAZ,OAAA,KAAA,SAAA,GAAqCA,KAAK,CAA1C,OAAA,GAAqDC,KAAK,CAJhE,OAAA;AAKH3E,IAAAA,MAAM,EAAE2E,KAAK,CAALA,MAAAA,CAAAA,MAAAA,CAAoBD,KAAK,CAL9B,MAKKC,CALL;AAMHpK,IAAAA,eAAe,EAAEmK,KAAK,CAALA,eAAAA,IAAyBC,KAAK,CAN5C,eAAA;AAOHnK,IAAAA,WAAW,EAAEkK,KAAK,CAALA,WAAAA,IAAqBC,KAAK,CAPpC,WAAA;AAQH1E,IAAAA,SAAS,EAAEyE,KAAK,CAALA,SAAAA,IAAmBC,KAAK,CARhC,SAAA;AASHzE,IAAAA,UAAU,EAAEyE,KAAK,CAALA,UAAAA,CAAAA,MAAAA,CAAwBD,KAAK,CAA7BC,UAAAA;AATT,GAAP;AAWH;;AAED,IAAIxK,cAAc,GAAG;AACjByK,EAAAA,EAAE,EADe,MAAA;AAEjBC,EAAAA,OAAO,EAFU,MAAA;AAGjBC,EAAAA,KAAK,EAHY,MAAA;AAIjBC,EAAAA,GAAG,EAJc,MAAA;AAKjBC,EAAAA,SAAS,EALQ,MAAA;AAMjBpK,EAAAA,aAAa,EAAE;AANE,CAArB;AAQA,IAAIqK,UAAU,GAAG;AACbjX,EAAAA,KAAK,EADQ,IAAA;AAEbrF,EAAAA,IAAI,EAFS,IAAA;AAGbsF,EAAAA,GAAG,EAHU,IAAA;AAIbqB,EAAAA,MAAM,EAAE;AAJK,CAAjB;AAMA,IAAI4V,GAAG,GAAP,CAAA;;AACA,SAAA,UAAA,CAAA,GAAA,EAAA,QAAA,EAAA,QAAA,EAAA,cAAA,EAA6D;AACzD,MAAIC,aAAa,GAAGC,sBAAsB,CAAA,QAAA,EAA1C,QAA0C,CAA1C;AACA,MAAIC,UAAU,GAAd,EAAA;AACA,MAAIC,YAAY,GAAGC,cAAc,CAAA,GAAA,EAAM;AAAN,EAAA,aAAA,EAClBrU,QAAQ,CADU,OAAA,EACAA,QAAQ,CAARA,YAAAA,CAAAA,KAAAA,CADA,cAAA,EAAA,UAAA,CACuD;AADvD,GAAjC;;AAGA,MAAA,YAAA,EAAkB;AACd,QAAIK,GAAG,GAAGiU,aAAa,CAAA,UAAA,EAAA,QAAA,EAAuBF,YAAY,CAAnC,MAAA,EAA4CtT,OAAO,CAACsT,YAAY,CAAhE,QAAmD,CAAnD,EAAvB,QAAuB,CAAvB;AACA/T,IAAAA,GAAG,CAAHA,YAAAA,GAAmB;AACf9B,MAAAA,MAAM,EAAE6V,YAAY,CADL,MAAA;AAEf9V,MAAAA,QAAQ,EAAE8V,YAAY,CAFP,QAAA;AAGf/V,MAAAA,QAAQ,EAAE+V,YAAY,CAAC/V;AAHR,KAAnBgC;AAKA,WAAO;AAAEA,MAAAA,GAAG,EAAL,GAAA;AAAYD,MAAAA,QAAQ,EAAE;AAAtB,KAAP;AAPJ,GAAA,MASK;AACD,QAAImU,UAAU,GAAd,EAAA;AACA,QAAIC,SAAS,GAAGC,WAAW,CAAA,GAAA,EAAA,aAAA,EAAA,QAAA,EAAA,UAAA,EAA3B,cAA2B,CAA3B;;AACA,QAAA,SAAA,EAAe;AACX,UAAIpU,GAAG,GAAGiU,aAAa,CAAA,UAAA,EAAA,QAAA,EAAuBE,SAAS,CAAhC,MAAA,EAAyCA,SAAS,CAAlD,MAAA,EAAvB,QAAuB,CAAvB;AACA,UAAIpU,QAAQ,GAAGK,mBAAmB,CAACJ,GAAG,CAAJ,KAAA,EAAYmU,SAAS,CAArB,KAAA,EAA6BA,SAAS,CAAtC,cAAA,EAAuDA,SAAS,CAAlG,YAAkC,CAAlC;AACA,aAAO;AAAEnU,QAAAA,GAAG,EAAL,GAAA;AAAYD,QAAAA,QAAQ,EAAEA;AAAtB,OAAP;AACH;AACJ;;AACD,SAAA,IAAA;AACH;AACD;AACA;AACA;AACA;AACA;;;AACA,SAAA,aAAA,CAAA,GAAA,EAAA,QAAA,EAAA,MAAA,EAAA,MAAA,EAAA,QAAA,EAAgE;AAC5D,MAAIiT,SAAS,GAAb,EAAA;AACA,MAAIhT,GAAG,GAAGqU,iBAAiB,CAAA,GAAA,EAAA,QAAA,EAA3B,SAA2B,CAA3B;AACArU,EAAAA,GAAG,CAAHA,KAAAA,GAAYhF,MAAM,CAAC2Y,GAAnB3T,EAAkB,CAAlBA;AACAA,EAAAA,GAAG,CAAHA,QAAAA,GAAAA,QAAAA;AACAA,EAAAA,GAAG,CAAHA,MAAAA,GAAAA,MAAAA;AACAA,EAAAA,GAAG,CAAHA,MAAAA,GAAAA,MAAAA;;AACA,OAAK,IAAIzE,EAAE,GAAN,CAAA,EAAY5D,EAAE,GAAGgI,QAAQ,CAARA,YAAAA,CAAAA,KAAAA,CAAtB,eAAA,EAAmEpE,EAAE,GAAG5D,EAAE,CAA1E,MAAA,EAAmF4D,EAAnF,EAAA,EAAyF;AACrF,QAAI+Y,cAAc,GAAG3c,EAAE,CAAvB,EAAuB,CAAvB;AACA,QAAI4c,YAAY,GAAhB,EAAA;AACAD,IAAAA,cAAc,CAAA,GAAA,EAAA,SAAA,EAAdA,YAAc,CAAdA;AACAtB,IAAAA,SAAS,GAATA,YAAAA;AACH;;AACDhT,EAAAA,GAAG,CAAHA,aAAAA,GAAoBtC,OAAQ,CAAA,SAAA,EAAYsC,GAAG,CAAHA,aAAAA,IAboB,EAahC,CAA5BA,CAb4D,CAc5D;;AACAxC,EAAAA,MAAM,CAANA,MAAAA,CAAcwC,GAAG,CAAHA,EAAAA,CAAdxC,UAAAA;AACAA,EAAAA,MAAM,CAANA,MAAAA,CAAcwC,GAAG,CAAjBxC,aAAAA;AACA,SAAA,GAAA;AACH;;AACD,SAAA,mBAAA,CAAA,KAAA,EAAA,KAAA,EAAA,cAAA,EAAA,YAAA,EAAyE;AACrE,SAAO;AACH8M,IAAAA,UAAU,EAAEtP,MAAM,CAAC2Y,GADhB,EACe,CADf;AAEHlJ,IAAAA,KAAK,EAFF,KAAA;AAGH1I,IAAAA,KAAK,EAHF,KAAA;AAIHoI,IAAAA,cAAc,EAAEA,cAAc,IAAdA,IAAAA,GAAAA,IAAAA,GAJb,cAAA;AAKHC,IAAAA,YAAY,EAAEA,YAAY,IAAZA,IAAAA,GAAAA,IAAAA,GAA8BA;AALzC,GAAP;AAOH;;AACD,SAAA,WAAA,CAAA,GAAA,EAAA,aAAA,EAAA,QAAA,EAAA,SAAA,EAAA,cAAA,EAA8E;AAC1E,MAAI/Y,KAAK,GAAGmjB,cAAc,CAAA,GAAA,EAA1B,SAA0B,CAA1B;AACA,MAAIzW,MAAM,GAAG1M,KAAK,CAAlB,MAAA;AACA,MAAA,SAAA;AACA,MAAIojB,WAAW,GAAf,IAAA;AACA,MAAI7K,MAAM,GAAV,KAAA;AACA,MAAA,OAAA;AACA,MAAI8K,SAAS,GAAb,IAAA;AACAC,EAAAA,SAAS,GAAGhV,QAAQ,CAARA,OAAAA,CAAAA,gBAAAA,CAAkCtO,KAAK,CAAnDsjB,KAAYhV,CAAZgV;;AACA,MAAA,SAAA,EAAe;AACXF,IAAAA,WAAW,GAAGE,SAAS,CAAvBF,MAAAA;AADJ,GAAA,MAGK,IAAI,CAAJ,cAAA,EAAqB;AACtB,WAAA,IAAA;AACH;;AACD,MAAIpjB,KAAK,CAALA,GAAAA,IAAJ,IAAA,EAAuB;AACnBujB,IAAAA,OAAO,GAAGjV,QAAQ,CAARA,OAAAA,CAAAA,gBAAAA,CAAkCtO,KAAK,CAAjDujB,GAAUjV,CAAViV;AACH;;AACD,MAAI7W,MAAM,IAAV,IAAA,EAAoB;AAChB,QAAI6V,aAAa,IAAjB,IAAA,EAA2B;AACvB7V,MAAAA,MAAM,GAANA,aAAAA;AADJ,KAAA,MAGK;AACD;AACAA,MAAAA,MAAM,GAAG,CAAC,CAAA,SAAA,IAAc4W,SAAS,CAAxB,iBAAA,MACJ,CAAA,OAAA,IAAYC,OAAO,CADxB7W,iBAAS,CAATA;AAEH;AACJ;;AACD,MAAIA,MAAM,IAAV,WAAA,EAA2B;AACvB0W,IAAAA,WAAW,GAAGze,UAAU,CAAxBye,WAAwB,CAAxBA;AACH;;AACD,MAAA,OAAA,EAAa;AACTC,IAAAA,SAAS,GAAGE,OAAO,CAAnBF,MAAAA;;AACA,QAAA,MAAA,EAAY;AACRA,MAAAA,SAAS,GAAG1e,UAAU,CAAtB0e,SAAsB,CAAtBA;AACH;;AACD,QAAID,WAAW,IAAIC,SAAS,IAA5B,WAAA,EAA6C;AACzCA,MAAAA,SAAS,GAATA,IAAAA;AACH;AACJ;;AACD,MAAA,SAAA,EAAe;AACX9K,IAAAA,MAAM,GAANA,IAAAA;AADJ,GAAA,MAGK,IAAI,CAAJ,cAAA,EAAqB;AACtBA,IAAAA,MAAM,GAAGjK,QAAQ,CAARA,GAAAA,CAAAA,oBAAAA,KAATiK,KAAAA;AACA8K,IAAAA,SAAS,GAAG/U,QAAQ,CAARA,OAAAA,CAAAA,GAAAA,CAAAA,WAAAA,EAAkC5B,MAAM,GAChD4B,QAAQ,CADwC,0BAAA,GAEhDA,QAAQ,CAFZ+U,yBAAY/U,CAAZ+U;AAGH;;AACD,SAAO;AACH3W,IAAAA,MAAM,EADH,MAAA;AAEH6L,IAAAA,MAAM,EAFH,MAAA;AAGH7H,IAAAA,KAAK,EAAE;AAAEtF,MAAAA,KAAK,EAAP,WAAA;AAAsBC,MAAAA,GAAG,EAAEgY;AAA3B,KAHJ;AAIHvK,IAAAA,cAAc,EAAEwK,SAAS,GAAGA,SAAS,CAAZ,SAAA,GAJtB,IAAA;AAKHvK,IAAAA,YAAY,EAAEwK,OAAO,GAAGA,OAAO,CAAV,SAAA,GAAuB;AALzC,GAAP;AAOH;;AACD,SAAA,cAAA,CAAA,GAAA,EAAA,SAAA,EAAwC;AACpC,MAAIvjB,KAAK,GAAGmhB,WAAW,CAAA,GAAA,EAAA,UAAA,EAAA,EAAA,EAAvB,SAAuB,CAAvB;AACAnhB,EAAAA,KAAK,CAALA,KAAAA,GAAeA,KAAK,CAALA,KAAAA,KAAD,IAACA,GAAwBA,KAAK,CAA9B,KAACA,GAAsCA,KAAK,CAA1DA,IAAAA;AACA,SAAOA,KAAK,CAAZ,IAAA;AACA,SAAA,KAAA;AACH;;AACD,SAAA,iBAAA,CAAA,GAAA,EAAA,QAAA,EAAA,SAAA,EAAqD;AACjD,MAAIwjB,YAAY,GAAhB,EAAA;AACA,MAAIxjB,KAAK,GAAGmhB,WAAW,CAAA,GAAA,EAAA,cAAA,EAAA,EAAA,EAAvB,YAAuB,CAAvB;AACA,MAAI1J,EAAE,GAAGmK,sBAAsB,CAAA,YAAA,EAAA,QAAA,EAA/B,SAA+B,CAA/B;AACA5hB,EAAAA,KAAK,CAALA,QAAAA,GAAiBA,KAAK,CAAtBA,EAAAA;AACA,SAAOA,KAAK,CAAZ,EAAA;AACAA,EAAAA,KAAK,CAALA,EAAAA,GAAAA,EAAAA;AACA,SAAA,KAAA;AACH;;AACD,SAAA,sBAAA,CAAA,QAAA,EAAA,QAAA,EAAoD;AAChD,MAAII,GAAG,GAAP,IAAA;;AACA,MAAA,QAAA,EAAc;AACV,QAAIqjB,MAAM,GAAGnV,QAAQ,CAARA,KAAAA,CAAAA,YAAAA,CAAb,QAAaA,CAAb;AACAlO,IAAAA,GAAG,GAAGqjB,MAAM,CAAZrjB,aAAAA;AACH;;AACD,MAAIA,GAAG,IAAP,IAAA,EAAiB;AACbA,IAAAA,GAAG,GAAGkO,QAAQ,CAARA,GAAAA,CAANlO,eAAMkO,CAANlO;AACH;;AACD,SAAA,GAAA;AACH;;AAED,IAAIsjB,YAAY,GAAG;AACfC,EAAAA,SAAS,EADM,OAAA;AAEfC,EAAAA,OAAO,EAFQ,OAAA;AAGfC,EAAAA,UAAU,EAAE,CAAA,CAAA,EAAA,CAAA,EAAA,CAAA,EAAA,CAAA,EAHG,CAGH,CAHG;AAIfzB,EAAAA,SAAS,EAJM,oBAAA;AAKf9E,EAAAA,UAAU,EALK,gBAAA;AAMf2E,EAAAA,OAAO,EANQ,gBAAA,CAMW;;AANX,CAAnB;AAQA;AACA;AACA;;AACA,SAAA,kBAAA,CAAA,KAAA,EAAA,QAAA,EAA6C;AACzC,SAAOtF,WAAW,CAACmH,YAAY,CAAb,KAAa,CAAb,EAAA,EAAA,EAAlB,QAAkB,CAAlB;AACH;;AACD,SAAA,YAAA,CAAA,KAAA,EAA6B;AACzB,MAAA,OAAA;;AACA,MAAIhb,KAAK,KAAT,IAAA,EAAoB;AAChBib,IAAAA,OAAO,GAAG,CADM,EACN,CAAVA,CADgB,CACA;AADpB,GAAA,MAGK,IAAItlB,KAAK,CAALA,OAAAA,CAAJ,KAAIA,CAAJ,EAA0B;AAC3B;AACAslB,IAAAA,OAAO,GAAG,KAAK,CAAL,MAAA,CAAa,UAAA,MAAA,EAAkB;AACrC,aAAOC,MAAM,CAAb,UAAA;AADJD,KAAU,CAAVA;AAFC,GAAA,MAMA,IAAI,OAAA,KAAA,KAAA,QAAA,IAAJ,KAAA,EAAwC;AAAE;AAC3CA,IAAAA,OAAO,GAAG,CAAVA,KAAU,CAAVA;AADC,GAAA,MAGA;AAAE;AACHA,IAAAA,OAAO,GAAPA,EAAAA;AACH;;AACDA,EAAAA,OAAO,GAAG,OAAO,CAAP,GAAA,CAAY,UAAA,MAAA,EAAkB;AACpC,WAAO1X,OAAQ,CAAA,EAAA,EAAA,YAAA,EAAf,MAAe,CAAf;AADJ0X,GAAU,CAAVA;AAGA,SAAA,OAAA;AACH;;AAED,SAAA,gBAAA,CAAA,UAAA,EAAA,YAAA,EAAA,YAAA,EAAkE;AAC9D,MAAIE,YAAY,KAAK,KAArB,CAAA,EAA6B;AAAEA,IAAAA,YAAY,GAAZA,EAAAA;AAAoB;;AACnD,MAAIC,UAAU,GAAd,EAAA;AACA,MAAA,WAAA;AACA,MAAA,QAAA;;AACA,WAAA,QAAA,GAAoB;AAChB,QAAA,QAAA,EAAc;AACV,WAAK,IAAIha,EAAE,GAAN,CAAA,EAAYia,YAAY,GAA7B,UAAA,EAA4Cja,EAAE,GAAGia,YAAY,CAA7D,MAAA,EAAsEja,EAAtE,EAAA,EAA4E;AACxE,YAAIka,SAAS,GAAGD,YAAY,CAA5B,EAA4B,CAA5B;AACAC,QAAAA,SAAS,CAATA,QAAAA;AACH;;AACD,UAAA,YAAA,EAAkB;AACdC,QAAAA,YAAY,CAAZA,KAAAA,CAAAA,WAAAA,EAAAA,QAAAA;AACH;;AACDC,MAAAA,QAAQ,GAARA,IAAAA;AACH;AACJ;;AACD,WAAA,GAAA,GAAe;AACX,QAAI,CAAA,QAAA,IAAa,CAACvT,aAAa,CAAA,QAAA,EAA/B,SAA+B,CAA/B,EAAsD;AAClDwT,MAAAA,QAAQ;AACRC,MAAAA,WAAW,GAAXA,IAAAA;AACAF,MAAAA,QAAQ,GAARA,SAAAA;AACAG,MAAAA,UAAU,CAAVA,KAAAA,CAAAA,IAAAA,EAAAA,SAAAA;AACH;AACJ;;AACDrkB,EAAAA,GAAG,CAAHA,UAAAA,GAAAA,UAAAA;AACAA,EAAAA,GAAG,CAAHA,QAAAA,GAAAA,QAAAA;;AACA,OAAK,IAAI8J,EAAE,GAAN,CAAA,EAAYwa,cAAc,GAA/B,YAAA,EAAgDxa,EAAE,GAAGwa,cAAc,CAAnE,MAAA,EAA4Exa,EAA5E,EAAA,EAAkF;AAC9E,QAAIya,UAAU,GAAGD,cAAc,CAA/B,EAA+B,CAA/B;AACAC,IAAAA,UAAU,CAAVA,UAAAA,CAAAA,IAAAA,CAAAA,GAAAA;AACH;;AACD,SAAA,GAAA;AACH;;AAED,IAAIC,iBAAiB,GAAG5W,qBAAxB,EAAA,C,CAAiD;;AACjD,IAAI6W,QAAQ;AAAG;AAAe,YAAY;AACtC,WAAA,QAAA,GAAoB;AAChB,SAAA,mBAAA,GAA2B9R,OAAO,CAAC,KAAnC,oBAAkC,CAAlC;AACA,SAAA,kBAAA,GAA0BA,OAAO,CAAC,KAAlC,cAAiC,CAAjC;AACA,SAAA,eAAA,GAAuBA,OAAO,CAAC,KAA/B,gBAA8B,CAA9B;AACA,SAAA,iBAAA,GAAyBA,OAAO,CAAC,KAAjC,kBAAgC,CAAhC;AACA,SAAA,cAAA,GAAsBA,OAAO,CAAC,KAA9B,iBAA6B,CAA7B;AACA,SAAA,gBAAA,GAAwBA,OAAO,CAAC,KAAhC,iBAA+B,CAA/B;AACA,SAAA,eAAA,GAPgB,EAOhB,CAPgB,CAOW;AAC9B;;AACD8R,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,UAAAA,GAAgC,UAAA,KAAA,EAAiB;AAC7C,QAAIC,KAAK,GAAT,IAAA;;AACA,QAAIC,QAAQ,GAAG,KAAA,UAAA,CAAf,KAAe,CAAf;AACA,QAAIC,OAAO,GAAG,KAAA,mBAAA,CAAyBhlB,KAAK,CAA5C,UAAc,CAAd;AACA,QAAIilB,cAAc,GAAG,KAAA,kBAAA,CAAwBjlB,KAAK,CAAlD,aAAqB,CAArB;AACA,QAAIklB,YAAY,GAAG,KAAA,iBAAA,CAAuBllB,KAAK,CAA5B,YAAA,EAL0B,OAK1B,CAAnB,CAL6C,CAK2B;;AACxE,QAAImlB,WAAW,GAAG,KAAA,eAAA,CAAqBnlB,KAAK,CAA1B,UAAA,EAAlB,OAAkB,CAAlB;AACA,QAAIolB,UAAU,GAAG,KAAA,cAAA,CAAoBplB,KAAK,CAA1C,SAAiB,CAAjB;AACA,QAAIqlB,YAAY,GAAG,KAAA,gBAAA,CAAsBrlB,KAAK,CAA9C,WAAmB,CAAnB;AACA,QAAIslB,UAAU,GAAd,EAAA;AACA,SAAA,eAAA,GAAuBtK,OAAO,CAAA,QAAA,EAAW,UAAA,IAAA,EAAA,GAAA,EAAqB;AAC1D,aAAO8J,KAAK,CAALA,eAAAA,CAAAA,GAAAA,KAA8B/R,OAAO,CAA5C,kBAA4C,CAA5C;AADJ,KAA8B,CAA9B;;AAGA,SAAK,IAAL,GAAA,IAAA,QAAA,EAA0B;AACtB,UAAIwS,OAAO,GAAGR,QAAQ,CAAtB,GAAsB,CAAtB;AACA,UAAIhX,UAAU,GAAGoX,WAAW,CAAXA,GAAW,CAAXA,IAAjB,iBAAA;AACA,UAAIK,YAAY,GAAG,KAAA,eAAA,CAAnB,GAAmB,CAAnB;AACAF,MAAAA,UAAU,CAAVA,GAAU,CAAVA,GAAkB;AACdzH,QAAAA,aAAa,EAAE0H,OAAO,CAAPA,aAAAA,IAAyBvlB,KAAK,CAD/B,aAAA;AAEd4d,QAAAA,aAAa,EAAEqH,cAAc,CAAdA,GAAc,CAAdA,IAFD,IAAA;AAGdlX,QAAAA,UAAU,EAHI,UAAA;AAIdoN,QAAAA,YAAY,EAAEqK,YAAY,CAACxlB,KAAK,CAALA,YAAAA,CAAD,EAACA,CAAD,EAAyBulB,OAAO,CAAhC,EAAA,EAAqCL,YAAY,CAJ7D,GAI6D,CAAjD,CAJZ;AAKdpH,QAAAA,cAAc,EAAE/P,UAAU,CAAVA,SAAAA,CAAqB/N,KAAK,CAA1B+N,cAAAA,IAA6C/N,KAAK,CAAlD+N,cAAAA,GALF,EAAA;AAMd2P,QAAAA,SAAS,EAAE0H,UAAU,CAAVA,GAAU,CAAVA,IANG,IAAA;AAOdrH,QAAAA,WAAW,EAAEsH,YAAY,CAAZA,GAAY,CAAZA,IAAqB;AAPpB,OAAlBC;AASH;;AACD,WAAA,UAAA;AA3BJT,GAAAA;;AA6BAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,cAAAA,GAAoC,UAAA,QAAA,EAAoB;AACpD,QAAIY,SAAS,GAAb,EAAA;;AACA,QAAA,QAAA,EAAc;AACV,UAAIC,IAAI,GAAG,KAAA,kBAAA,CAAX,QAAW,CAAX;;AACA,WAAK,IAAIxb,EAAE,GAAN,CAAA,EAAYyb,MAAM,GAAvB,IAAA,EAAgCzb,EAAE,GAAGyb,MAAM,CAA3C,MAAA,EAAoDzb,EAApD,EAAA,EAA0D;AACtD,YAAI4D,GAAG,GAAG6X,MAAM,CAAhB,EAAgB,CAAhB;AACAF,QAAAA,SAAS,CAATA,GAAS,CAATA,GAAAA,QAAAA;AACH;AACJ;;AACD,WAAA,SAAA;AATJZ,GAAAA;;AAWAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,oBAAAA,GAA0C,UAAA,UAAA,EAAsB;AAC5D,QAAIC,KAAK,GAAT,IAAA;;AACA,WAAO9J,OAAO,CAACjN,UAAU,CAAX,IAAA,EAAkB,UAAA,QAAA,EAAoB;AAChD,aAAO+W,KAAK,CAALA,kBAAAA,CAAP,QAAOA,CAAP;AADJ,KAAc,CAAd;AAFJD,GAAAA;;AAMAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,gBAAAA,GAAsC,UAAA,UAAA,EAAA,OAAA,EAA+B;AACjE,QAAItW,IAAI,GAAGR,UAAU,CAArB,IAAA;AAAA,QAA4BS,SAAS,GAAGT,UAAU,CAAlD,SAAA;AACA,QAAI6X,WAAW,GAAf,EAAA;;AACA,SAAK,IAAL,KAAA,IAAA,IAAA,EAAwB;AACpB,WAAK,IAAI1b,EAAE,GAAN,CAAA,EAAY5D,EAAE,GAAG0e,OAAO,CAA7B,KAA6B,CAA7B,EAAsC9a,EAAE,GAAG5D,EAAE,CAA7C,MAAA,EAAsD4D,EAAtD,EAAA,EAA4D;AACxD,YAAI4D,GAAG,GAAGxH,EAAE,CAAZ,EAAY,CAAZ;;AACA,YAAI,CAACsf,WAAW,CAAhB,GAAgB,CAAhB,EAAuB;AACnBA,UAAAA,WAAW,CAAXA,GAAW,CAAXA,GAAmB5X,qBAAnB4X,EAAAA;AACH;;AACDA,QAAAA,WAAW,CAAXA,GAAW,CAAXA,CAAAA,IAAAA,CAAAA,KAAAA,IAA+BrX,IAAI,CAAnCqX,KAAmC,CAAnCA;AACH;AACJ;;AACD,SAAK,IAAL,UAAA,IAAA,SAAA,EAAkC;AAC9B,UAAIlX,QAAQ,GAAGF,SAAS,CAAxB,UAAwB,CAAxB;;AACA,WAAK,IAAIuJ,EAAE,GAAN,CAAA,EAAY8N,EAAE,GAAGb,OAAO,CAACtW,QAAQ,CAAtC,KAA6B,CAA7B,EAA+CqJ,EAAE,GAAG8N,EAAE,CAAtD,MAAA,EAA+D9N,EAA/D,EAAA,EAAqE;AACjE,YAAIjK,GAAG,GAAG+X,EAAE,CAAZ,EAAY,CAAZ;;AACA,YAAID,WAAW,CAAf,GAAe,CAAf,EAAsB;AAAE;AACpBA,UAAAA,WAAW,CAAXA,GAAW,CAAXA,CAAAA,SAAAA,CAAAA,UAAAA,IAAAA,QAAAA;AACH;AACJ;AACJ;;AACD,WAAA,WAAA;AArBJf,GAAAA;;AAuBAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,kBAAAA,GAAwC,UAAA,YAAA,EAAA,OAAA,EAAiC;AACrE,QAAIiB,WAAW,GAAf,EAAA;;AACA,SAAK,IAAL,KAAA,IAAA,YAAA,EAAgC;AAC5B,UAAA,KAAA,EAAW;AAAE;AACT,aAAK,IAAI5b,EAAE,GAAN,CAAA,EAAY5D,EAAE,GAAG0e,OAAO,CAA7B,KAA6B,CAA7B,EAAsC9a,EAAE,GAAG5D,EAAE,CAA7C,MAAA,EAAsD4D,EAAtD,EAAA,EAA4D;AACxD,cAAI4D,GAAG,GAAGxH,EAAE,CAAZ,EAAY,CAAZ;;AACA,cAAI,CAACwf,WAAW,CAAhB,GAAgB,CAAhB,EAAuB;AACnBA,YAAAA,WAAW,CAAXA,GAAW,CAAXA,GAAAA,EAAAA;AACH;;AACDA,UAAAA,WAAW,CAAXA,GAAW,CAAXA,CAAAA,KAAAA,IAA0B3K,YAAY,CAAtC2K,KAAsC,CAAtCA;AACH;AACJ;AACJ;;AACD,WAAA,WAAA;AAbJjB,GAAAA;;AAeAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,iBAAAA,GAAuC,UAAA,WAAA,EAAuB;AAC1D,QAAIkB,WAAW,GAAf,EAAA;;AACA,QAAA,WAAA,EAAiB;AACb,UAAIC,gBAAgB,GAAG,KAAA,gBAAA,CAAsBrI,WAAW,CAAjC,cAAA,EAAkD,KAAA,oBAAA,CAA0BA,WAAW,CAAvF,cAAkD,CAAlD,CAAwG;AAAxG,OAAvB,CADa,CAGb;;;AACA,UAAIsI,kBAAkB,GAAG,KAAA,oBAAA,CAA0BtI,WAAW,CAA9D,aAAyB,CAAzB;;AACA,UAAIuI,eAAe,GAAG,KAAA,gBAAA,CAAsBvI,WAAW,CAAjC,aAAA,EAAtB,kBAAsB,CAAtB;;AACA,UAAIwI,QAAQ,GAAG,SAAXA,QAAW,CAAA,GAAA,EAAe;AAC1B,YAAI,CAACJ,WAAW,CAAhB,GAAgB,CAAhB,EAAuB;AACnBA,UAAAA,WAAW,CAAXA,GAAW,CAAXA,GAAmB;AACfK,YAAAA,cAAc,EAAEJ,gBAAgB,CAAhBA,GAAgB,CAAhBA,IADD,iBAAA;AAEfK,YAAAA,aAAa,EAAEH,eAAe,CAAfA,GAAe,CAAfA,IAFA,iBAAA;AAGfI,YAAAA,OAAO,EAAE3I,WAAW,CAHL,OAAA;AAIf4I,YAAAA,OAAO,EAAE5I,WAAW,CAAC4I;AAJN,WAAnBR;AAMH;AARL,OAAA;;AAUA,WAAK,IAAL,GAAA,IAAA,gBAAA,EAAkC;AAC9BI,QAAAA,QAAQ,CAARA,GAAQ,CAARA;AACH;;AACD,WAAK,IAAL,GAAA,IAAA,eAAA,EAAiC;AAC7BA,QAAAA,QAAQ,CAARA,GAAQ,CAARA;AACH;AACJ;;AACD,WAAA,WAAA;AAzBJtB,GAAAA;;AA2BA,SAAA,QAAA;AAzHJ,CAA8B,EAA9B;;AA2HA,SAAA,kBAAA,CAAA,KAAA,EAAA,aAAA,EAAA,YAAA,EAAgE;AAC5D,MAAI2B,SAAS,GAAb,EAAA;;AACA,MAAA,KAAA,EAAW;AACPA,IAAAA,SAAS,CAATA,IAAAA,CAAAA,KAAAA;AACH;;AACD,MAAA,aAAA,EAAmB;AACfA,IAAAA,SAAS,CAATA,IAAAA,CAAAA,aAAAA;AACH;;AACD,MAAIC,KAAK,GAAG;AACR,QAAIrL,eAAe,CAAA,SAAA;AADX,GAAZ;;AAGA,MAAA,YAAA,EAAkB;AACd/O,IAAAA,OAAQ,CAAA,KAAA,EAARA,YAAQ,CAARA;AACH;;AACD,SAAA,KAAA;EAGJ;AACA;AACA;AACA;AACA;AACA;;;AACA,SAAA,mBAAA,CAAA,SAAA,EAAA,WAAA,EAAA,KAAA,EAAA,SAAA,EAAuE;AACnE,MAAIN,OAAO,GAAG2a,SAAS,CAAvB,OAAA;AACA,MAAA,IAAA;AACA,MAAA,IAAA;AACA,MAAA,QAAA;AACA,MAAA,YAAA;;AACA,MAAIC,WAAW,YAAf,IAAA,EAAiC;AAC7B5gB,IAAAA,IAAI,GADyB,WAC7BA,CAD6B,CACT;AADxB,GAAA,MAGK;AACDA,IAAAA,IAAI,GAAG4gB,WAAW,CAAlB5gB,IAAAA;AACAiR,IAAAA,IAAI,GAAG2P,WAAW,CAAlB3P,IAAAA;AACA4P,IAAAA,QAAQ,GAAGD,WAAW,CAAtBC,QAAAA;AACH;;AACDC,EAAAA,YAAY,GAAG;AACX9gB,IAAAA,IAAI,EAAE,OAAO,CAAP,SAAA,CAAA,IAAA,EAAwB;AAAE+gB,MAAAA,QAAQ,EAAE;AAAZ,KAAxB,CADK;AAEX9P,IAAAA,IAAI,EAAEA,IAAI,IAAI;AAFH,GAAf6P;;AAIA,MAAI,OAAA,KAAA,KAAJ,QAAA,EAA+B;AAC3BE,IAAAA,SAAS,GAATA,KAAAA;AACA5oB,IAAAA,KAAK,GAALA,IAAAA;AACH;;AACDA,EAAAA,KAAK,GAAGA,KAAK,GAAG,MAAM6oB,UAAU,CAAnB,KAAmB,CAAnB,GAtBsD,EAsBnE7oB,CAtBmE,CAsBrB;;AAC9C4oB,EAAAA,SAAS,GAAGA,SAAS,IAArBA,EAAAA;;AACA,MAAI,CAAA,QAAA,IAAaL,SAAS,CAATA,GAAAA,CAAjB,UAAiBA,CAAjB,EAA4C;AACxC,WAAO,OAAA,KAAA,GAAA,cAAA,GACc5F,UAAU,CAACmG,IAAI,CAAJA,SAAAA,CADzB,YACyBA,CAAD,CADxB,GAAA,IAAA,GAAA,SAAA,GAAP,MAAA;AADJ,GAAA,MAMK;AACD,WAAO,UAAA,KAAA,GAAA,GAAA,GAAA,SAAA,GAAP,SAAA;AAGH;AACJ;;AACD,SAAA,aAAA,CAAA,SAAA,EAAkC;AAC9B,SAAOP,SAAS,CAATA,GAAAA,CAAAA,YAAAA,KAA+B5F,UAAU,CAAC4F,SAAS,CAATA,GAAAA,CAAjD,YAAiDA,CAAD,CAAhD;EAEJ;;;AACA,SAAA,aAAA,CAAA,IAAA,EAAA,WAAA,EAAA,OAAA,EAAA,gBAAA,EAAqE;AACjE,MAAIpY,QAAQ,GAAG5D,OAAO,CAAtB,QAAA;AAAA,MAAiC8P,IAAI,GAAG9P,OAAO,CAA/C,IAAA;AAAA,MAAsDwc,KAAK,GAAGxc,OAAO,CAArE,KAAA;AAAA,MAA6EqB,OAAO,GAAGrB,OAAO,CAA9F,OAAA;AACA,MAAIyc,OAAO,GAAX,EAAA;AACA,MAAA,UAAA;AACA,MAAA,QAAA;;AACA,MAAI,CAACC,mBAAmB,CAAClL,WAAW,CAAZ,WAAA,EAAxB,IAAwB,CAAxB,EAAyD;AACrDiL,IAAAA,OAAO,CAAPA,IAAAA,CAAAA,iBAAAA;AADJ,GAAA,MAGK;AACDA,IAAAA,OAAO,CAAPA,IAAAA,CAAa,QAAQjjB,OAAO,CAAC6B,IAAI,CAAjCohB,SAA6BphB,EAAD,CAA5BohB;;AACA,QAAI3M,IAAI,CAAJA,GAAAA,CAAAA,WAAAA,KACAzO,OAAO,CAAPA,QAAAA,CAAAA,IAAAA,MAA2BA,OAAO,CAAPA,QAAAA,CAAiBmQ,WAAW,CAAXA,YAAAA,CADhD,KAC+BnQ,CAD/B,EACiF;AAC7Eob,MAAAA,OAAO,CAAPA,IAAAA,CAAAA,gBAAAA;AACH;;AACDE,IAAAA,UAAU,GAAG1iB,UAAU,CAAC2J,QAAQ,CAAhC+Y,MAAwB/Y,EAAD,CAAvB+Y;AACAC,IAAAA,QAAQ,GAAGhc,OAAO,CAAA,UAAA,EAAlBgc,CAAkB,CAAlBA;;AACA,QAAIvhB,IAAI,GAAR,UAAA,EAAuB;AACnBohB,MAAAA,OAAO,CAAPA,IAAAA,CAAAA,SAAAA;AADJ,KAAA,MAGK,IAAIphB,IAAI,IAAR,QAAA,EAAsB;AACvBohB,MAAAA,OAAO,CAAPA,IAAAA,CAAAA,WAAAA;AADC,KAAA,MAGA;AACDA,MAAAA,OAAO,CAAPA,IAAAA,CAAAA,UAAAA;;AACA,UAAII,gBAAgB,KAApB,IAAA,EAA+B;AAC3BJ,QAAAA,OAAO,CAAPA,IAAAA,CAAaD,KAAK,CAALA,QAAAA,CAAbC,OAAaD,CAAbC;AACH;AACJ;AACJ;;AACD,SAAA,OAAA;EAGJ;AACA;AACA;AACA;;;AACA,SAAA,WAAA,CAAA,IAAA,EAAA,OAAA,EAAA,OAAA,EAA6C;AACzC;AACA;AACA,MAAIK,UAAU,GAAd,KAAA;;AACA,MAAIC,cAAc,GAAG,SAAjBA,cAAiB,GAAY;AAC7B,QAAI,CAAJ,UAAA,EAAiB;AACbD,MAAAA,UAAU,GAAVA,IAAAA;AACAE,MAAAA,OAAO,CAAPA,KAAAA,CAAAA,IAAAA,EAAAA,SAAAA;AACH;AAJL,GAAA;;AAMA,MAAIC,cAAc,GAAG,SAAjBA,cAAiB,GAAY;AAC7B,QAAI,CAAJ,UAAA,EAAiB;AACbH,MAAAA,UAAU,GAAVA,IAAAA;;AACA,UAAA,OAAA,EAAa;AACTI,QAAAA,OAAO,CAAPA,KAAAA,CAAAA,IAAAA,EAAAA,SAAAA;AACH;AACJ;AANL,GAAA;;AAQA,MAAIxnB,GAAG,GAAG8I,IAAI,CAAA,cAAA,EAAd,cAAc,CAAd;;AACA,MAAI9I,GAAG,IAAI,OAAOA,GAAG,CAAV,IAAA,KAAX,UAAA,EAA2C;AACvCA,IAAAA,GAAG,CAAHA,IAAAA,CAAAA,cAAAA,EAAAA,cAAAA;AACH;AACJ;;AAED,IAAIynB,KAAK;AAAG;AAAe,YAAY;AACnC,WAAA,KAAA,GAAiB,CADkB,CAAA,CAGnC;;;AACAA,EAAAA,KAAK,CAALA,OAAAA,GAAgB,UAAA,SAAA,EAAqB;AACjC,SAAA,UAAA,CAAgBC,SAAS,CAAzB,SAAA;AAL+B,GAInCD,CAJmC,CAOnC;;;AACAA,EAAAA,KAAK,CAALA,UAAAA,GAAmB,UAAA,OAAA,EAAmB;AAClC,QAAI/C,KAAK,GAAT,IAAA;;AACA3Y,IAAAA,MAAM,CAANA,mBAAAA,CAA2B,KAA3BA,SAAAA,EAAAA,OAAAA,CAAmD,UAAA,IAAA,EAAgB;AAC/D,UAAI,CAAC4b,OAAO,CAAZ,IAAY,CAAZ,EAAoB;AAAE;AAClBA,QAAAA,OAAO,CAAPA,IAAO,CAAPA,GAAgBjD,KAAK,CAALA,SAAAA,CAAhBiD,IAAgBjD,CAAhBiD;AACH;AAHL5b,KAAAA;AAFJ0b,GAAAA;AAQA;AACJ;AACA;AACA;;;AACIA,EAAAA,KAAK,CAALA,OAAAA,GAAgB,UAAA,SAAA,EAAqB;AACjC,QAAI/C,KAAK,GAAT,IAAA;;AACA3Y,IAAAA,MAAM,CAANA,mBAAAA,CAA2B,KAA3BA,SAAAA,EAAAA,OAAAA,CAAmD,UAAA,IAAA,EAAgB;AAC/D2b,MAAAA,SAAS,CAATA,SAAAA,CAAAA,IAAAA,IAA4BhD,KAAK,CAALA,SAAAA,CAA5BgD,IAA4BhD,CAA5BgD;AADJ3b,KAAAA;AAFJ0b,GAAAA;;AAMA,SAAA,KAAA;AA1BJ,CAA2B,EAA3B;AA6BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA,IAAIG,YAAY;AAAG;AAAe,UAAA,MAAA,EAAkB;AAChDC,EAAAA,SAAS,CAAA,YAAA,EAATA,MAAS,CAATA;;AACA,WAAA,YAAA,GAAwB;AACpB,WAAOC,MAAM,KAANA,IAAAA,IAAmBA,MAAM,CAANA,KAAAA,CAAAA,IAAAA,EAAnBA,SAAmBA,CAAnBA,IAAP,IAAA;AACH;;AACDF,EAAAA,YAAY,CAAZA,SAAAA,CAAAA,EAAAA,GAA4B,UAAA,IAAA,EAAA,OAAA,EAAyB;AACjDG,IAAAA,SAAS,CAAC,KAAA,SAAA,KAAmB,KAAA,SAAA,GAApB,EAAC,CAAD,EAAA,IAAA,EAATA,OAAS,CAATA;AACA,WAFiD,IAEjD,CAFiD,CAEpC;AAP+B,GAKhDH,CALgD,CAShD;;;AACAA,EAAAA,YAAY,CAAZA,SAAAA,CAAAA,GAAAA,GAA6B,UAAA,IAAA,EAAA,OAAA,EAAyB;AAClDG,IAAAA,SAAS,CAAC,KAAA,YAAA,KAAsB,KAAA,YAAA,GAAvB,EAAC,CAAD,EAAA,IAAA,EAATA,OAAS,CAATA;AACA,WAFkD,IAElD,CAFkD,CAErC;AAFjBH,GAAAA;;AAIAA,EAAAA,YAAY,CAAZA,SAAAA,CAAAA,GAAAA,GAA6B,UAAA,IAAA,EAAA,OAAA,EAAyB;AAClD,QAAI,KAAJ,SAAA,EAAoB;AAChBI,MAAAA,cAAc,CAAC,KAAD,SAAA,EAAA,IAAA,EAAdA,OAAc,CAAdA;AACH;;AACD,QAAI,KAAJ,YAAA,EAAuB;AACnBA,MAAAA,cAAc,CAAC,KAAD,YAAA,EAAA,IAAA,EAAdA,OAAc,CAAdA;AACH;;AACD,WAPkD,IAOlD,CAPkD,CAOrC;AAPjBJ,GAAAA;;AASAA,EAAAA,YAAY,CAAZA,SAAAA,CAAAA,OAAAA,GAAiC,UAAA,IAAA,EAAgB;AAC7C,QAAI/d,IAAI,GAAR,EAAA;;AACA,SAAK,IAAIC,EAAE,GAAX,CAAA,EAAiBA,EAAE,GAAGC,SAAS,CAA/B,MAAA,EAAwCD,EAAxC,EAAA,EAA8C;AAC1CD,MAAAA,IAAI,CAACC,EAAE,GAAPD,CAAI,CAAJA,GAAeE,SAAS,CAAxBF,EAAwB,CAAxBA;AACH;;AACD,SAAA,WAAA,CAAA,IAAA,EAAA,IAAA,EAAA,IAAA;AACA,WAN6C,IAM7C,CAN6C,CAMhC;AANjB+d,GAAAA;;AAQAA,EAAAA,YAAY,CAAZA,SAAAA,CAAAA,WAAAA,GAAqC,UAAA,IAAA,EAAA,OAAA,EAAA,IAAA,EAA+B;AAChE,QAAI,KAAJ,SAAA,EAAoB;AAChBK,MAAAA,QAAQ,CAAC,KAAA,SAAA,CAAD,IAAC,CAAD,EAAA,OAAA,EAARA,IAAQ,CAARA;AACH;;AACD,QAAI,KAAJ,YAAA,EAAuB;AACnBA,MAAAA,QAAQ,CAAC,KAAA,YAAA,CAAD,IAAC,CAAD,EAAA,OAAA,EAARA,IAAQ,CAARA;AACA,aAAO,KAAA,YAAA,CAFY,IAEZ,CAAP,CAFmB,CAEa;AACnC;;AACD,WARgE,IAQhE,CARgE,CAQnD;AARjBL,GAAAA;;AAUAA,EAAAA,YAAY,CAAZA,SAAAA,CAAAA,WAAAA,GAAqC,UAAA,IAAA,EAAgB;AACjD,WAAQ,KAAA,SAAA,IAAkB,KAAA,SAAA,CAAlB,IAAkB,CAAlB,IAA0C,KAAA,SAAA,CAAA,IAAA,EAA3C,MAAC,IACH,KAAA,YAAA,IAAqB,KAAA,YAAA,CAArB,IAAqB,CAArB,IAAgD,KAAA,YAAA,CAAA,IAAA,EADrD,MAAA;AADJA,GAAAA;;AAIA,SAAA,YAAA;AA7C8B,CAAA,CAAlC,KAAkC,CAAlC;;AA+CA,SAAA,SAAA,CAAA,IAAA,EAAA,IAAA,EAAA,OAAA,EAAwC;AACpC,GAACta,IAAI,CAAJA,IAAI,CAAJA,KAAeA,IAAI,CAAJA,IAAI,CAAJA,GAAhB,EAACA,CAAD,EAAA,IAAA,CAAA,OAAA;AAEH;;AACD,SAAA,cAAA,CAAA,IAAA,EAAA,IAAA,EAAA,OAAA,EAA6C;AACzC,MAAA,OAAA,EAAa;AACT,QAAIA,IAAI,CAAR,IAAQ,CAAR,EAAgB;AACZA,MAAAA,IAAI,CAAJA,IAAI,CAAJA,GAAa,IAAI,CAAJ,IAAI,CAAJ,CAAA,MAAA,CAAkB,UAAA,IAAA,EAAgB;AAC3C,eAAOxE,IAAI,KAAX,OAAA;AADJwE,OAAa,CAAbA;AAGH;AALL,GAAA,MAOK;AACD,WAAOA,IAAI,CADV,IACU,CAAX,CADC,CACkB;AACtB;AACJ;AAED;AACA;AACA;AACA;AACA;;;AACA,IAAI4a,aAAa;AAAG;AAAe,YAAY;AAC3C,WAAA,aAAA,CAAA,QAAA,EAAA,GAAA,EAAA,YAAA,EAAA,UAAA,EAAgE;AAC5D,SAAA,QAAA,GAAA,QAAA;AACA,SAAA,GAAA,GAAA,GAAA;AACA,SAAA,YAAA,GAAA,YAAA;AACA,SAAA,UAAA,GAAA,UAAA;AALuC,GAAA,CAO3C;AACA;;;AACAA,EAAAA,aAAa,CAAbA,SAAAA,CAAAA,KAAAA,GAAgC,YAAY;AACxC,QAAIC,QAAQ,GAAG,KAAf,QAAA;AACA,QAAIC,gBAAgB,GAAG,KAAA,gBAAA,GACnBD,QAAQ,CAH4B,qBAGpCA,EADJ,CAFwC,CAGF;;AACtC,QAAI,KAAJ,YAAA,EAAuB;AACnB,WAAA,kBAAA,CAAwBC,gBAAgB,CAAxC,IAAA;AACH;;AACD,QAAI,KAAJ,UAAA,EAAqB;AACjB,WAAA,gBAAA,CAAsBA,gBAAgB,CAAtC,GAAA;AACH;AAlBsC,GAS3CF,CAT2C,CAoB3C;;;AACAA,EAAAA,aAAa,CAAbA,SAAAA,CAAAA,kBAAAA,GAA6C,UAAA,gBAAA,EAA4B;AACrE,QAAIG,KAAK,GAAT,EAAA;AACA,QAAIC,MAAM,GAAV,EAAA;;AACA,SAAK,IAAIxe,EAAE,GAAN,CAAA,EAAY5D,EAAE,GAAG,KAAtB,GAAA,EAAgC4D,EAAE,GAAG5D,EAAE,CAAvC,MAAA,EAAgD4D,EAAhD,EAAA,EAAsD;AAClD,UAAInM,EAAE,GAAGuI,EAAE,CAAX,EAAW,CAAX;AACA,UAAInG,IAAI,GAAGpC,EAAE,CAAb,qBAAWA,EAAX;AACA0qB,MAAAA,KAAK,CAALA,IAAAA,CAAWtoB,IAAI,CAAJA,IAAAA,GAAXsoB,gBAAAA;AACAC,MAAAA,MAAM,CAANA,IAAAA,CAAYvoB,IAAI,CAAJA,KAAAA,GAAZuoB,gBAAAA;AACH;;AACD,SAAA,KAAA,GAAA,KAAA;AACA,SAAA,MAAA,GAAA,MAAA;AA/BuC,GAqB3CJ,CArB2C,CAiC3C;;;AACAA,EAAAA,aAAa,CAAbA,SAAAA,CAAAA,gBAAAA,GAA2C,UAAA,eAAA,EAA2B;AAClE,QAAIK,IAAI,GAAR,EAAA;AACA,QAAIC,OAAO,GAAX,EAAA;;AACA,SAAK,IAAI1e,EAAE,GAAN,CAAA,EAAY5D,EAAE,GAAG,KAAtB,GAAA,EAAgC4D,EAAE,GAAG5D,EAAE,CAAvC,MAAA,EAAgD4D,EAAhD,EAAA,EAAsD;AAClD,UAAInM,EAAE,GAAGuI,EAAE,CAAX,EAAW,CAAX;AACA,UAAInG,IAAI,GAAGpC,EAAE,CAAb,qBAAWA,EAAX;AACA4qB,MAAAA,IAAI,CAAJA,IAAAA,CAAUxoB,IAAI,CAAJA,GAAAA,GAAVwoB,eAAAA;AACAC,MAAAA,OAAO,CAAPA,IAAAA,CAAazoB,IAAI,CAAJA,MAAAA,GAAbyoB,eAAAA;AACH;;AACD,SAAA,IAAA,GAAA,IAAA;AACA,SAAA,OAAA,GAAA,OAAA;AA5CuC,GAkC3CN,CAlC2C,CA8C3C;AACA;;;AACAA,EAAAA,aAAa,CAAbA,SAAAA,CAAAA,WAAAA,GAAsC,UAAA,YAAA,EAAwB;AAC1D,QAAIG,KAAK,GAAG,KAAZ,KAAA;AACA,QAAIC,MAAM,GAAG,KAAb,MAAA;AACA,QAAI5e,GAAG,GAAG2e,KAAK,CAAf,MAAA;AACA,QAAA,CAAA;;AACA,SAAK5pB,CAAC,GAAN,CAAA,EAAYA,CAAC,GAAb,GAAA,EAAqBA,CAArB,EAAA,EAA0B;AACtB,UAAIgqB,YAAY,IAAIJ,KAAK,CAArBI,CAAqB,CAArBA,IAA4BA,YAAY,GAAGH,MAAM,CAArD,CAAqD,CAArD,EAA0D;AACtD,eAAA,CAAA;AACH;AACJ;AAzDsC,GAgD3CJ,CAhD2C,CA2D3C;AACA;;;AACAA,EAAAA,aAAa,CAAbA,SAAAA,CAAAA,UAAAA,GAAqC,UAAA,WAAA,EAAuB;AACxD,QAAIK,IAAI,GAAG,KAAX,IAAA;AACA,QAAIC,OAAO,GAAG,KAAd,OAAA;AACA,QAAI9e,GAAG,GAAG6e,IAAI,CAAd,MAAA;AACA,QAAA,CAAA;;AACA,SAAK9pB,CAAC,GAAN,CAAA,EAAYA,CAAC,GAAb,GAAA,EAAqBA,CAArB,EAAA,EAA0B;AACtB,UAAIiqB,WAAW,IAAIH,IAAI,CAAnBG,CAAmB,CAAnBA,IAA0BA,WAAW,GAAGF,OAAO,CAAnD,CAAmD,CAAnD,EAAwD;AACpD,eAAA,CAAA;AACH;AACJ;AAtEsC,GA6D3CN,CA7D2C,CAwE3C;;;AACAA,EAAAA,aAAa,CAAbA,SAAAA,CAAAA,QAAAA,GAAmC,UAAA,SAAA,EAAqB;AACpD,WAAO,KAAA,MAAA,CAAA,SAAA,IAAyB,KAAA,KAAA,CAAhC,SAAgC,CAAhC;AA1EuC,GAyE3CA,CAzE2C,CA4E3C;;;AACAA,EAAAA,aAAa,CAAbA,SAAAA,CAAAA,SAAAA,GAAoC,UAAA,QAAA,EAAoB;AACpD,WAAO,KAAA,OAAA,CAAA,QAAA,IAAyB,KAAA,IAAA,CAAhC,QAAgC,CAAhC;AADJA,GAAAA;;AAGA,SAAA,aAAA;AAhFJ,CAAmC,EAAnC;AAmFA;AACA;AACA;AACA;AACA;;;AACA,IAAIS,gBAAgB;AAAG;AAAe,YAAY;AAC9C,WAAA,gBAAA,GAA4B,CAC3B;;AACDA,EAAAA,gBAAgB,CAAhBA,SAAAA,CAAAA,eAAAA,GAA6C,YAAY;AACrD,WAAO,KAAA,eAAA,KAAyB,KAAhC,eAAgC,EAAhC;AADJA,GAAAA;;AAGAA,EAAAA,gBAAgB,CAAhBA,SAAAA,CAAAA,gBAAAA,GAA8C,YAAY;AACtD,WAAO,KAAA,cAAA,KAAwB,KAA/B,cAA+B,EAA/B;AADJA,GAAAA;;AAGAA,EAAAA,gBAAgB,CAAhBA,SAAAA,CAAAA,mBAAAA,GAAiD,YAAY;AACzD,WAAO,KAAA,eAAA,KAAP,CAAA;AADJA,GAAAA;;AAGAA,EAAAA,gBAAgB,CAAhBA,SAAAA,CAAAA,qBAAAA,GAAmD,YAAY;AAC3D,WAAO,KAAA,gBAAA,KAAP,CAAA;AADJA,GAAAA;;AAGAA,EAAAA,gBAAgB,CAAhBA,SAAAA,CAAAA,WAAAA,GAAyC,YAAY;AACjD,WAAO,KAAA,YAAA,KAAP,CAAA;AADJA,GAAAA;;AAGAA,EAAAA,gBAAgB,CAAhBA,SAAAA,CAAAA,aAAAA,GAA2C,YAAY;AACnD,WAAO,KAAA,YAAA,KAAsB,KAA7B,eAA6B,EAA7B;AADJA,GAAAA;;AAGAA,EAAAA,gBAAgB,CAAhBA,SAAAA,CAAAA,aAAAA,GAA2C,YAAY;AACnD,WAAO,KAAA,aAAA,KAAP,CAAA;AADJA,GAAAA;;AAGAA,EAAAA,gBAAgB,CAAhBA,SAAAA,CAAAA,cAAAA,GAA4C,YAAY;AACpD,WAAO,KAAA,aAAA,KAAuB,KAA9B,gBAA8B,EAA9B;AADJA,GAAAA;;AAGA,SAAA,gBAAA;AA3BJ,CAAsC,EAAtC;;AA6BA,IAAIC,uBAAuB;AAAG;AAAe,UAAA,MAAA,EAAkB;AAC3Df,EAAAA,SAAS,CAAA,uBAAA,EAATA,MAAS,CAATA;;AACA,WAAA,uBAAA,CAAA,EAAA,EAAqC;AACjC,QAAInD,KAAK,GAAGoD,MAAM,CAANA,IAAAA,CAAAA,IAAAA,KAAZ,IAAA;;AACApD,IAAAA,KAAK,CAALA,EAAAA,GAAAA,EAAAA;AACA,WAAA,KAAA;AACH;;AACDkE,EAAAA,uBAAuB,CAAvBA,SAAAA,CAAAA,YAAAA,GAAiD,YAAY;AACzD,WAAO,KAAA,EAAA,CAAP,SAAA;AADJA,GAAAA;;AAGAA,EAAAA,uBAAuB,CAAvBA,SAAAA,CAAAA,aAAAA,GAAkD,YAAY;AAC1D,WAAO,KAAA,EAAA,CAAP,UAAA;AADJA,GAAAA;;AAGAA,EAAAA,uBAAuB,CAAvBA,SAAAA,CAAAA,YAAAA,GAAiD,UAAA,GAAA,EAAe;AAC5D,SAAA,EAAA,CAAA,SAAA,GAAA,GAAA;AADJA,GAAAA;;AAGAA,EAAAA,uBAAuB,CAAvBA,SAAAA,CAAAA,aAAAA,GAAkD,UAAA,IAAA,EAAgB;AAC9D,SAAA,EAAA,CAAA,UAAA,GAAA,IAAA;AADJA,GAAAA;;AAGAA,EAAAA,uBAAuB,CAAvBA,SAAAA,CAAAA,cAAAA,GAAmD,YAAY;AAC3D,WAAO,KAAA,EAAA,CAAP,WAAA;AADJA,GAAAA;;AAGAA,EAAAA,uBAAuB,CAAvBA,SAAAA,CAAAA,eAAAA,GAAoD,YAAY;AAC5D,WAAO,KAAA,EAAA,CAAP,YAAA;AADJA,GAAAA;;AAGAA,EAAAA,uBAAuB,CAAvBA,SAAAA,CAAAA,eAAAA,GAAoD,YAAY;AAC5D,WAAO,KAAA,EAAA,CAAP,YAAA;AADJA,GAAAA;;AAGAA,EAAAA,uBAAuB,CAAvBA,SAAAA,CAAAA,cAAAA,GAAmD,YAAY;AAC3D,WAAO,KAAA,EAAA,CAAP,WAAA;AADJA,GAAAA;;AAGA,SAAA,uBAAA;AA/ByC,CAAA,CAA7C,gBAA6C,CAA7C;;AAiCA,IAAIC,sBAAsB;AAAG;AAAe,UAAA,MAAA,EAAkB;AAC1DhB,EAAAA,SAAS,CAAA,sBAAA,EAATA,MAAS,CAATA;;AACA,WAAA,sBAAA,GAAkC;AAC9B,WAAOC,MAAM,KAANA,IAAAA,IAAmBA,MAAM,CAANA,KAAAA,CAAAA,IAAAA,EAAnBA,SAAmBA,CAAnBA,IAAP,IAAA;AACH;;AACDe,EAAAA,sBAAsB,CAAtBA,SAAAA,CAAAA,YAAAA,GAAgD,YAAY;AACxD,WAAOnnB,MAAM,CAAb,WAAA;AADJmnB,GAAAA;;AAGAA,EAAAA,sBAAsB,CAAtBA,SAAAA,CAAAA,aAAAA,GAAiD,YAAY;AACzD,WAAOnnB,MAAM,CAAb,WAAA;AADJmnB,GAAAA;;AAGAA,EAAAA,sBAAsB,CAAtBA,SAAAA,CAAAA,YAAAA,GAAgD,UAAA,CAAA,EAAa;AACzDnnB,IAAAA,MAAM,CAANA,MAAAA,CAAcA,MAAM,CAApBA,WAAAA,EAAAA,CAAAA;AADJmnB,GAAAA;;AAGAA,EAAAA,sBAAsB,CAAtBA,SAAAA,CAAAA,aAAAA,GAAiD,UAAA,CAAA,EAAa;AAC1DnnB,IAAAA,MAAM,CAANA,MAAAA,CAAAA,CAAAA,EAAiBA,MAAM,CAAvBA,WAAAA;AADJmnB,GAAAA;;AAGAA,EAAAA,sBAAsB,CAAtBA,SAAAA,CAAAA,cAAAA,GAAkD,YAAY;AAC1D,WAAOjrB,QAAQ,CAARA,eAAAA,CAAP,WAAA;AADJirB,GAAAA;;AAGAA,EAAAA,sBAAsB,CAAtBA,SAAAA,CAAAA,eAAAA,GAAmD,YAAY;AAC3D,WAAOjrB,QAAQ,CAARA,eAAAA,CAAP,YAAA;AADJirB,GAAAA;;AAGAA,EAAAA,sBAAsB,CAAtBA,SAAAA,CAAAA,eAAAA,GAAmD,YAAY;AAC3D,WAAOjrB,QAAQ,CAARA,eAAAA,CAAP,YAAA;AADJirB,GAAAA;;AAGAA,EAAAA,sBAAsB,CAAtBA,SAAAA,CAAAA,cAAAA,GAAkD,YAAY;AAC1D,WAAOjrB,QAAQ,CAARA,eAAAA,CAAP,WAAA;AADJirB,GAAAA;;AAGA,SAAA,sBAAA;AA7BwC,CAAA,CAA5C,gBAA4C,CAA5C;AAgCA;AACA;AACA;;;AACA,IAAIC,eAAe;AAAG;AAAe,UAAA,MAAA,EAAkB;AACnDjB,EAAAA,SAAS,CAAA,eAAA,EAATA,MAAS,CAATA;;AACA,WAAA,eAAA,CAAA,SAAA,EAAA,SAAA,EAA+C;AAC3C,QAAInD,KAAK,GAAG,MAAM,CAAN,IAAA,CAAA,IAAA,EAAkB5jB,aAAa,CAAA,KAAA,EAAQ;AAC/CvD,MAAAA,SAAS,EAAE;AADoC,KAAR,CAA/B,KAAZ,IAAA;;AAGAmnB,IAAAA,KAAK,CAALA,SAAAA,GAAAA,SAAAA;AACAA,IAAAA,KAAK,CAALA,SAAAA,GAAAA,SAAAA;;AACAA,IAAAA,KAAK,CAALA,aAAAA;;AACA,WAAA,KAAA;AAT+C,GAAA,CAWnD;;;AACAoE,EAAAA,eAAe,CAAfA,SAAAA,CAAAA,KAAAA,GAAkC,YAAY;AAC1C,SAAA,SAAA,CAAA,MAAA;AACA,SAAA,aAAA;AAFJA,GAAAA;;AAIAA,EAAAA,eAAe,CAAfA,SAAAA,CAAAA,OAAAA,GAAoC,YAAY;AAC5CxnB,IAAAA,aAAa,CAAC,KAAdA,EAAa,CAAbA;AAjB+C,GAgBnDwnB,CAhBmD,CAmBnD;AACA;;;AACAA,EAAAA,eAAe,CAAfA,SAAAA,CAAAA,aAAAA,GAA0C,YAAY;AAClDhrB,IAAAA,UAAU,CAAC,KAAD,EAAA,EAAU;AAChBirB,MAAAA,SAAS,EAAE,KADK,SAAA;AAEhBC,MAAAA,SAAS,EAAE,KAAKA;AAFA,KAAV,CAAVlrB;AAtB+C,GAqBnDgrB,CArBmD,CA2BnD;AACA;AACA;;;AACAA,EAAAA,eAAe,CAAfA,SAAAA,CAAAA,YAAAA,GAAyC,UAAA,eAAA,EAA2B;AAChE,QAAIC,SAAS,GAAG,KAAhB,SAAA;AACA,QAAIC,SAAS,GAAG,KAAhB,SAAA;AACA9hB,IAAAA,eAAe,GAAGA,eAAe,IAAI,KAArCA,kBAAqC,EAArCA;;AACA,QAAI6hB,SAAS,KAAb,MAAA,EAA0B;AACtBA,MAAAA,SAAS,GAAI7hB,eAAe,CAAfA,MAAAA,IAA0B;AACnC,WADQ,qBACR,EADSA,CACoB;AADpBA,QAAD,QAACA,GAAb6hB,QAAAA;AAGH;;AACD,QAAIC,SAAS,KAAb,MAAA,EAA0B;AACtBA,MAAAA,SAAS,GAAI9hB,eAAe,CAAfA,IAAAA,IAAwBA,eAAe,CAAvCA,KAAAA,IAAiD;AAC1D,WADQ,mBACR,EADSA,CACkB;AADlBA,QAAD,QAACA,GAAb8hB,QAAAA;AAGH;;AACDlrB,IAAAA,UAAU,CAAC,KAAD,EAAA,EAAU;AAAEirB,MAAAA,SAAS,EAAX,SAAA;AAAwBC,MAAAA,SAAS,EAAEA;AAAnC,KAAV,CAAVlrB;AAdJgrB,GAAAA;;AAgBAA,EAAAA,eAAe,CAAfA,SAAAA,CAAAA,SAAAA,GAAsC,UAAA,MAAA,EAAkB;AACpDnpB,IAAAA,cAAc,CAAC,KAAD,EAAA,EAAA,QAAA,EAAdA,MAAc,CAAdA;AADJmpB,GAAAA;;AAGAA,EAAAA,eAAe,CAAfA,SAAAA,CAAAA,kBAAAA,GAA+C,YAAY;AACvD,QAAIrmB,KAAK,GAAGC,YAAY,CAAC,KAAzB,EAAwB,CAAxB;AACA,WAAO;AACHzC,MAAAA,IAAI,EAAEwC,KAAK,CADR,aAAA;AAEHpC,MAAAA,KAAK,EAAEoC,KAAK,CAFT,cAAA;AAGHlC,MAAAA,MAAM,EAAEkC,KAAK,CAACP;AAHX,KAAP;AAFJ4mB,GAAAA;;AAQA,SAAA,eAAA;AAzDiC,CAAA,CAArC,uBAAqC,CAArC;;AA4DA,IAAIG,KAAK;AAAG;AAAe,YAAY;AACnC,WAAA,KAAA,CAAA,eAAA,EAAgC;AAC5B,SAAA,eAAA,GAAA,eAAA;AACA,SAAA,mBAAA;AACH;;AACDA,EAAAA,KAAK,CAALA,SAAAA,CAAAA,mBAAAA,GAAsC,YAAY;AAC9C,QAAI,KAAJ,kBAAA,EAA6B;AACzB,WAAA,eAAA,CAAqB,KAAA,eAAA,CAAqB,KAA1C,kBAAqB,CAArB;AACH;AAHLA,GAAAA;;AAKAA,EAAAA,KAAK,CAALA,SAAAA,CAAAA,eAAAA,GAAkC,UAAA,gBAAA,EAA4B;AAC1D,QAAA,eAAA;AACA,QAAA,UAAA;;AACA,QAAI,OAAA,gBAAA,KAAA,QAAA,IAAJ,gBAAA,EAA8D;AAAE;AAC5DC,MAAAA,eAAe,GAAGjd,OAAQ,CAAA,EAAA,EAAK,KAA/Bid,WAA0B,CAA1BA;;AACA,WAAA,UAAA,IAAA,gBAAA,EAAqC;AACjCA,QAAAA,eAAe,CAAfA,UAAe,CAAfA,GAA8B,KAAA,uBAAA,CAA6BC,gBAAgB,CAA3ED,UAA2E,CAA7C,CAA9BA;AACH;;AACD,WAAA,WAAA,GAAA,eAAA;AALJ,KAAA,MAOK,IAAIC,gBAAgB,KAApB,KAAA,EAAgC;AACjC,WAAA,WAAA,GAAA,EAAA;AACH;AAZLF,GAAAA;;AAcAA,EAAAA,KAAK,CAALA,SAAAA,CAAAA,uBAAAA,GAA0C,UAAA,SAAA,EAAqB;AAC3D,QAAI7H,MAAM,GAAG,KAAb,kBAAA;;AACA,QAAIA,MAAM,IAAI7jB,SAAS,CAATA,OAAAA,CAAAA,MAAAA,MAAd,CAAA,EAA+C;AAAE;AAC7CA,MAAAA,SAAS,GAAG6jB,MAAM,GAAlB7jB,SAAAA;AACH;;AACD,WAAA,SAAA;AALJ0rB,GAAAA;;AAOAA,EAAAA,KAAK,CAALA,SAAAA,CAAAA,QAAAA,GAA2B,UAAA,GAAA,EAAe;AACtC,WAAO,KAAA,OAAA,CAAA,GAAA,KAAP,EAAA;AADJA,GAAAA;;AAGAA,EAAAA,KAAK,CAALA,SAAAA,CAAAA,YAAAA,GAA+B,UAAA,UAAA,EAAsB;AACjD,QAAI1rB,SAAS,GAAG,KAAA,WAAA,CAAhB,UAAgB,CAAhB;;AACA,QAAA,SAAA,EAAe;AACX,aAAO,KAAA,aAAA,GAAA,GAAA,GAAP,SAAA;AACH;;AACD,WAAA,EAAA;AALJ0rB,GAAAA;;AAOAA,EAAAA,KAAK,CAALA,SAAAA,CAAAA,wBAAAA,GAA2C,UAAA,iBAAA,EAA6B;AACpE,QAAA,SAAA;;AACA,QAAI,KAAJ,8BAAA,EAAyC;AACrC1rB,MAAAA,SAAS,GAAG6rB,iBAAiB,CAAC,KAA9B7rB,8BAA6B,CAA7BA;;AACA,UAAA,SAAA,EAAe;AACX,eAAO,KAAA,aAAA,GAAA,GAAA,GAA2B,KAAA,uBAAA,CAAlC,SAAkC,CAAlC;AACH;AACJ;;AACD,WAAA,EAAA;AARJ0rB,GAAAA;;AAUA,SAAA,KAAA;AAnDJ,CAA2B,EAA3B;;AAqDAA,KAAK,CAALA,SAAAA,CAAAA,OAAAA,GAAAA,EAAAA;AACAA,KAAK,CAALA,SAAAA,CAAAA,WAAAA,GAAAA,EAAAA;AACAA,KAAK,CAALA,SAAAA,CAAAA,aAAAA,GAAAA,EAAAA;AACAA,KAAK,CAALA,SAAAA,CAAAA,kBAAAA,GAAAA,EAAAA;AAEA,IAAII,IAAI,GAAR,CAAA;;AACA,IAAIC,SAAS;AAAG;AAAe,YAAY;AACvC,WAAA,SAAA,CAAA,OAAA,EAAA,MAAA,EAAoC;AAChC;AACA,QAAA,MAAA,EAAY;AACRhf,MAAAA,OAAO,CAAPA,IAAAA,GAAAA,IAAAA;AACH;;AACD,SAAA,GAAA,GAAWf,MAAM,CAAC8f,IAAlB,EAAiB,CAAjB;AACA,SAAA,OAAA,GAAA,OAAA;AACA,SAAA,OAAA,GAAe/e,OAAO,CAAtB,OAAA;AACA,SAAA,KAAA,GAAaA,OAAO,CAApB,KAAA;AACA,SAAA,IAAA,GAAYA,OAAO,CAAnB,IAAA;AACA,SAAA,QAAA,GAAgBA,OAAO,CAAvB,QAAA;AACA,SAAA,KAAA,GAAa,KAAA,GAAA,CAAA,KAAA,MAAb,KAAA;AACH;;AACDgf,EAAAA,SAAS,CAATA,gBAAAA,GAA6B,UAAA,QAAA,EAAoB;AAC7C,SAAA,SAAA,CAAA,aAAA,GAA+Brd,OAAQ,CAAA,EAAA,EAAK,KAAA,SAAA,CAAL,aAAA,EAAvC,QAAuC,CAAvC;AADJqd,GAAAA;;AAGAA,EAAAA,SAAS,CAATA,SAAAA,CAAAA,GAAAA,GAA0B,UAAA,IAAA,EAAgB;AACtC,WAAO,KAAA,OAAA,CAAA,OAAA,CAAP,IAAO,CAAP;AADJA,GAAAA;;AAGAA,EAAAA,SAAS,CAATA,SAAAA,CAAAA,YAAAA,GAAmC,UAAA,KAAA,EAAiB;AAChD,QAAIpjB,EAAE,GAAGqjB,YAAY,CAAC,KAAA,KAAA,IAAD,EAAA,EAAA,KAAA,EAA0B,KAA/C,aAAqB,CAArB;AAAA,QAAoEC,UAAU,GAAGtjB,EAAE,CAAnF,UAAA;AAAA,QAAgGujB,UAAU,GAAGvjB,EAAE,CAA/G,UAAA;;AACA,SAAA,KAAA,GAAA,UAAA;;AACA,QAAA,UAAA,EAAgB;AACZ,WAAA,MAAA,CAAA,UAAA;AACH;AALLojB,GAAAA;;AAOAA,EAAAA,SAAS,CAATA,SAAAA,CAAAA,MAAAA,GAA6B,UAAA,KAAA,EAAiB,CA3BP,CA2BvCA,CA3BuC,CA6BvC;;;AACAA,EAAAA,SAAS,CAATA,SAAAA,CAAAA,OAAAA,GAA8B,YAAY,CAA1CA,CAAAA;;AAEA,SAAA,SAAA;AAhCJ,CAA+B,EAA/B;;AAkCAA,SAAS,CAATA,SAAAA,CAAAA,aAAAA,GAAAA,EAAAA;AACA;AACA;AACA;AACA;;AACA,SAAA,YAAA,CAAA,QAAA,EAAA,QAAA,EAAA,aAAA,EAAyD;AACrD,MAAIG,UAAU,GADuC,EACrD,CADqD,CAChC;;AACrB,MAAID,UAAU,GAAd,KAAA;;AACA,OAAK,IAAL,GAAA,IAAA,QAAA,EAA0B;AACtB,QAAI9b,GAAG,IAAHA,QAAAA,KAAoBgc,QAAQ,CAARA,GAAQ,CAARA,KAAkBC,QAAQ,CAA1BD,GAA0B,CAA1BA,IACnBE,aAAa,CAAbA,GAAa,CAAbA,IAAsBA,aAAa,CAAbA,GAAa,CAAbA,CAAmBF,QAAQ,CAA3BE,GAA2B,CAA3BA,EAAkCD,QAAQ,CADrE,GACqE,CAA1CC,CADvBlc,CAAJ,EAC+E;AAC3E;AACA+b,MAAAA,UAAU,CAAVA,GAAU,CAAVA,GAAkBC,QAAQ,CAA1BD,GAA0B,CAA1BA;AAHJ,KAAA,MAKK;AACDA,MAAAA,UAAU,CAAVA,GAAU,CAAVA,GAAkBE,QAAQ,CAA1BF,GAA0B,CAA1BA;AACAD,MAAAA,UAAU,GAAVA,IAAAA;AACH;AACJ;;AACD,OAAK,IAAL,GAAA,IAAA,QAAA,EAA0B;AACtB,QAAI,EAAE9b,GAAG,IAAT,QAAI,CAAJ,EAAwB;AACpB8b,MAAAA,UAAU,GAAVA,IAAAA;AACA;AACH;AACJ;;AACD,SAAO;AAAEA,IAAAA,UAAU,EAAZ,UAAA;AAA0BC,IAAAA,UAAU,EAAEA;AAAtC,GAAP;AACH;AAED;AACA;AACA;AACA;AACA;;;AACA,IAAII,aAAa;AAAG;AAAe,UAAA,MAAA,EAAkB;AACjDhC,EAAAA,SAAS,CAAA,aAAA,EAATA,MAAS,CAATA;;AACA,WAAA,aAAA,CAAA,OAAA,EAAA,EAAA,EAAA,MAAA,EAA4C;AACxC,QAAInD,KAAK,GAAGoD,MAAM,CAANA,IAAAA,CAAAA,IAAAA,EAAAA,OAAAA,EAAAA,MAAAA,KAAZ,IAAA;;AACApD,IAAAA,KAAK,CAALA,EAAAA,GAAAA,EAAAA;AACA,WAAA,KAAA;AACH;;AACDmF,EAAAA,aAAa,CAAbA,SAAAA,CAAAA,OAAAA,GAAkC,YAAY;AAC1C/B,IAAAA,MAAM,CAANA,SAAAA,CAAAA,OAAAA,CAAAA,IAAAA,CAAAA,IAAAA;;AACAxmB,IAAAA,aAAa,CAAC,KAAdA,EAAa,CAAbA;AAT6C,GAOjDuoB,CAPiD,CAWjD;AACA;AACA;AACA;;AACA;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAII;AACA;;;AACAA,EAAAA,aAAa,CAAbA,SAAAA,CAAAA,mBAAAA,GAA8C,YAAY,CAA1DA,CAAAA;;AAEAA,EAAAA,aAAa,CAAbA,SAAAA,CAAAA,QAAAA,GAAmC,UAAA,YAAA,EAAA,WAAA,EAAA,OAAA,EAAA,QAAA,EAAwD;AACvF,WADuF,IACvF,CADuF,CAC1E;AAhDgC,GA+CjDA,CA/CiD,CAkDjD;AACA;;;AACAA,EAAAA,aAAa,CAAbA,SAAAA,CAAAA,kBAAAA,GAA6C,UAAA,WAAA,EAAuB;AAChE,QAAI3b,QAAQ,GAAG,KAAf,QAAA;AACA,QAAI4N,WAAW,GAAG,KAAA,KAAA,CAF8C,WAEhE,CAFgE,CAEtB;;AAC1C,QAAI1N,SAAS,GAAGmP,WAAW,CAAXA,aAAAA,CAAhB,SAAA;;AACA,QAAA,WAAA,EAAiB;AAAE;AACf,WAAK,IAAL,UAAA,IAAA,SAAA,EAAkC;AAC9B,YAAI,CAACgD,kBAAkB,CAACzE,WAAW,CAAZ,UAAA,EAAyB1N,SAAS,CAATA,UAAS,CAATA,CAAhD,KAAuB,CAAvB,EAA8E;AAC1E,iBAAA,KAAA;AACH;AACJ;AACJ;;AACD,WAAO0b,kBAAkB,CAAA,WAAA,EAAzB,QAAyB,CAAzB;AAXJD,GAAAA;;AAaAA,EAAAA,aAAa,CAAbA,SAAAA,CAAAA,oBAAAA,GAA+C,UAAA,SAAA,EAAqB;AAChE,QAAI/N,WAAW,GAAG,KAAA,KAAA,CAD8C,WAChE,CADgE,CACtB;;AAC1C,QAAIA,WAAW,IAAI;AACf,KAACyE,kBAAkB,CAACzE,WAAW,CAAZ,UAAA,EAAyB6D,SAAS,CADzD,KACuB,CADvB,EACkE;AAC9D,aAAA,KAAA;AACH;;AACD,WAAOoK,oBAAoB,CAAA,SAAA,EAAY,KAAvC,QAA2B,CAA3B;AAvE6C,GAiEjDF,CAjEiD,CAyEjD;AACA;AACA;;;AACAA,EAAAA,aAAa,CAAbA,SAAAA,CAAAA,eAAAA,GAA0C,UAAA,IAAA,EAAA,IAAA,EAAsB;AAC5D,QAAI3b,QAAQ,GAAG,KAAf,QAAA;AACA,WAAOA,QAAQ,CAARA,eAAAA,CAAAA,IAAAA,EAAP,IAAOA,CAAP;AAFJ2b,GAAAA;;AAIAA,EAAAA,aAAa,CAAbA,SAAAA,CAAAA,0BAAAA,GAAqD,UAAA,IAAA,EAAA,IAAA,EAAsB;AACvE,QAAI3b,QAAQ,GAAG,KAAf,QAAA;AACA,WAAOA,QAAQ,CAARA,0BAAAA,CAAAA,IAAAA,EAAP,IAAOA,CAAP;AAFJ2b,GAAAA;;AAIAA,EAAAA,aAAa,CAAbA,SAAAA,CAAAA,iBAAAA,GAA4C,UAAA,IAAA,EAAgB;AACxD,QAAI3b,QAAQ,GAAG,KAAf,QAAA;AACA,WAAOA,QAAQ,CAARA,iBAAAA,CAAP,IAAOA,CAAP;AAFJ2b,GAAAA;;AAIAA,EAAAA,aAAa,CAAbA,SAAAA,CAAAA,mBAAAA,GAA8C,UAAA,IAAA,EAAA,SAAA,EAA2B;AACrE,QAAI3b,QAAQ,GAAG,KAAf,QAAA;;AACA,QAAI,KAAA,iBAAA,CAAJ,iBAAI,CAAJ,EAA+C;AAC3C,WAAK,IAAIpE,EAAE,GAAN,CAAA,EAAY4Q,MAAM,GAAvB,IAAA,EAAgC5Q,EAAE,GAAG4Q,MAAM,CAA3C,MAAA,EAAoD5Q,EAApD,EAAA,EAA0D;AACtD,YAAI0Q,GAAG,GAAGE,MAAM,CAAhB,EAAgB,CAAhB;AACA,aAAA,0BAAA,CAAA,iBAAA,EAAmD,CAC/C;AACIH,UAAAA,KAAK,EAAE,IAAA,QAAA,CAAA,QAAA,EAAuBC,GAAG,CAAHA,UAAAA,CAAvB,GAAA,EAA2CA,GAAG,CAAHA,UAAAA,CADtD,QACW,CADX;AAEIC,UAAAA,QAAQ,EAFZ,SAAA;AAGIb,UAAAA,OAAO,EAAEY,GAAG,CAHhB,OAAA;AAIIX,UAAAA,KAAK,EAAEW,GAAG,CAJd,KAAA;AAKI7c,UAAAA,EAAE,EAAE6c,GAAG,CALX,EAAA;AAMIJ,UAAAA,IAAI,EANR,IAAA,CAMe;;AANf,SAD+C,CAAnD;AAUH;AACJ;;AACD,QAAI,CAAClM,QAAQ,CAARA,KAAAA,CAAL,YAAA,EAAkC;AAAE;AAChCA,MAAAA,QAAQ,CAARA,mBAAAA,CAAAA,iBAAAA,GAAiD,CADnB,IACmB,CAAjDA,CAD8B,CAC2B;AAC5D;AAnBL2b,GAAAA;;AAqBAA,EAAAA,aAAa,CAAbA,SAAAA,CAAAA,qBAAAA,GAAgD,UAAA,IAAA,EAAA,SAAA,EAA2B;AACvE,QAAI3b,QAAQ,GAAG,KAAf,QAAA;;AACA,SAAK,IAAIpE,EAAE,GAAN,CAAA,EAAYkgB,MAAM,GAAvB,IAAA,EAAgClgB,EAAE,GAAGkgB,MAAM,CAA3C,MAAA,EAAoDlgB,EAApD,EAAA,EAA0D;AACtD,UAAI0Q,GAAG,GAAGwP,MAAM,CAAhB,EAAgB,CAAhB;AACA9b,MAAAA,QAAQ,CAARA,OAAAA,CAAAA,eAAAA,EAAkCsM,GAAG,CAArCtM,EAAAA;AACH;;AACD,QAAI,KAAA,iBAAA,CAAJ,cAAI,CAAJ,EAA4C;AACxC,WAAK,IAAIhI,EAAE,GAAN,CAAA,EAAY+jB,MAAM,GAAvB,IAAA,EAAgC/jB,EAAE,GAAG+jB,MAAM,CAA3C,MAAA,EAAoD/jB,EAApD,EAAA,EAA0D;AACtD,YAAIsU,GAAG,GAAGyP,MAAM,CAAhB,EAAgB,CAAhB;AACA,aAAA,eAAA,CAAA,cAAA,EAAqC,CACjC;AACI1P,UAAAA,KAAK,EAAE,IAAA,QAAA,CAAA,QAAA,EAAuBC,GAAG,CAAHA,UAAAA,CAAvB,GAAA,EAA2CA,GAAG,CAAHA,UAAAA,CADtD,QACW,CADX;AAEIC,UAAAA,QAAQ,EAFZ,SAAA;AAGI9c,UAAAA,EAAE,EAAE6c,GAAG,CAHX,EAAA;AAIIJ,UAAAA,IAAI,EAJR,IAAA,CAIe;;AAJf,SADiC,CAArC;AAQH;AACJ;AA/H4C,GA6GjDyP,CA7GiD,CAiIjD;AACA;;;AACAA,EAAAA,aAAa,CAAbA,SAAAA,CAAAA,gBAAAA,GAA2C,UAAA,EAAA,EAAc;AACrD,WAAO,CAAC,KAAA,KAAA,CAAD,SAAA,IAAyB;AAC5B,KAAC,KAAA,KAAA,CADE,WAAA,IACwB;AAC3B,KAACzmB,cAAc,CAAA,EAAA,EAFZ,YAEY,CAFZ,KAGF,KAAA,SAAA,MAAoB,CAAC,KAAA,WAAA,CAJ2B,EAI3B,CAHnB,CAAP,CADqD,CAKrD;AACA;AANJymB,GAAAA;;AAQAA,EAAAA,aAAa,CAAbA,SAAAA,CAAAA,iBAAAA,GAA4C,UAAA,EAAA,EAAc;AACtD,QAAIK,KAAK,GAAG9mB,cAAc,CAAA,EAAA,EAAK,KAA/B,aAA0B,CAA1B;AACA,WAAO,CAAC,CAAA,KAAA,IAAU8mB,KAAK,CAALA,SAAAA,CAAAA,QAAAA,CAAX,WAAWA,CAAX,KACH,CAAC9mB,cAAc,CAAA,EAAA,EADZ,UACY,CADZ,IACgC;AACnC,KAACA,cAAc,CAAA,EAAA,EAFZ,cAEY,CAFZ,IAEoC;AACvC,KAAC,KAAA,WAAA,CAHL,EAGK,CAHL;AAFJymB,GAAAA;;AAOAA,EAAAA,aAAa,CAAbA,SAAAA,CAAAA,SAAAA,GAAoC,YAAY;AAC5C,WAAO,KAAA,EAAA,CAAA,SAAA,CAAA,QAAA,CAAP,YAAO,CAAP;AADJA,GAAAA;;AAGAA,EAAAA,aAAa,CAAbA,SAAAA,CAAAA,WAAAA,GAAsC,UAAA,EAAA,EAAc;AAChD,WAAO7a,OAAO,CAAC5L,cAAc,CAAA,EAAA,EAA7B,aAA6B,CAAf,CAAd;AADJymB,GAAAA;;AAGA,SAAA,aAAA;AAxJ+B,CAAA,CAAnC,SAAmC,CAAnC;;AA0JAA,aAAa,CAAbA,SAAAA,CAAAA,aAAAA,GAAAA,yBAAAA;AACAA,aAAa,CAAbA,SAAAA,CAAAA,aAAAA,GAAAA,kCAAAA;AAEA,IAAIM,KAAK,GAAT,CAAA;;AACA,SAAA,YAAA,CAAA,KAAA,EAA6B;AACzB,SAAO;AACHvI,IAAAA,EAAE,EAAErY,MAAM,CAAC4gB,KADR,EACO,CADP;AAEHC,IAAAA,IAAI,EAAE1hB,KAAK,CAALA,IAAAA,IAFH,EAAA;AAGH2hB,IAAAA,QAAQ,EAAE3hB,KAAK,CAALA,QAAAA,IAHP,EAAA;AAIH4hB,IAAAA,eAAe,EAAE5hB,KAAK,CAALA,eAAAA,IAJd,EAAA;AAKH6hB,IAAAA,uBAAuB,EAAE7hB,KAAK,CAALA,uBAAAA,IALtB,EAAA;AAMH8hB,IAAAA,0BAA0B,EAAE9hB,KAAK,CAALA,0BAAAA,IANzB,EAAA;AAOH+hB,IAAAA,wBAAwB,EAAE/hB,KAAK,CAALA,wBAAAA,IAPvB,EAAA;AAQHgiB,IAAAA,yBAAyB,EAAEhiB,KAAK,CAALA,yBAAAA,IARxB,EAAA;AASHiiB,IAAAA,mBAAmB,EAAEjiB,KAAK,CAALA,mBAAAA,IATlB,EAAA;AAUHkiB,IAAAA,kBAAkB,EAAEliB,KAAK,CAALA,kBAAAA,IAVjB,EAAA;AAWHmiB,IAAAA,KAAK,EAAEniB,KAAK,CAALA,KAAAA,IAXJ,EAAA;AAYHoiB,IAAAA,qBAAqB,EAAEpiB,KAAK,CAALA,qBAAAA,IAZpB,EAAA;AAaHqiB,IAAAA,YAAY,EAAEriB,KAAK,CAALA,YAAAA,IAbX,IAAA;AAcHsiB,IAAAA,qBAAqB,EAAEtiB,KAAK,CAALA,qBAAAA,IAdpB,EAAA;AAeHuiB,IAAAA,yBAAyB,EAAEviB,KAAK,CAALA,yBAAAA,IAfxB,EAAA;AAgBHwiB,IAAAA,sBAAsB,EAAExiB,KAAK,CAALA,sBAAAA,IAhBrB,EAAA;AAiBHyiB,IAAAA,qBAAqB,EAAEziB,KAAK,CAALA,qBAAAA,IAjBpB,EAAA;AAkBH0iB,IAAAA,qBAAqB,EAAE1iB,KAAK,CAALA,qBAAAA,IAlBpB,EAAA;AAmBH2iB,IAAAA,oBAAoB,EAAE3iB,KAAK,CAALA,oBAAAA,IAnBnB,EAAA;AAoBH4iB,IAAAA,YAAY,EAAE5iB,KAAK,CAALA,YAAAA,IApBX,EAAA;AAqBH6iB,IAAAA,eAAe,EAAE7iB,KAAK,CAALA,eAAAA,IArBd,EAAA;AAsBH8iB,IAAAA,YAAY,EAAE9iB,KAAK,CAtBhB,YAAA;AAuBHyD,IAAAA,cAAc,EAAEzD,KAAK,CAALA,cAAAA,IAvBb,EAAA;AAwBH+iB,IAAAA,kBAAkB,EAAE/iB,KAAK,CAxBtB,kBAAA;AAyBHgjB,IAAAA,WAAW,EAAEhjB,KAAK,CAALA,WAAAA,IAzBV,EAAA;AA0BHijB,IAAAA,mBAAmB,EAAEjjB,KAAK,CA1BvB,mBAAA;AA2BHkjB,IAAAA,oBAAoB,EAAEljB,KAAK,CAALA,oBAAAA,IAA8B;AA3BjD,GAAP;AA6BH;;AACD,IAAImjB,YAAY;AAAG;AAAe,YAAY;AAC1C,WAAA,YAAA,GAAwB;AACpB,SAAA,KAAA,GAAa;AACTxB,MAAAA,QAAQ,EADC,EAAA;AAETC,MAAAA,eAAe,EAFN,EAAA;AAGTC,MAAAA,uBAAuB,EAHd,EAAA;AAITC,MAAAA,0BAA0B,EAJjB,EAAA;AAKTC,MAAAA,wBAAwB,EALf,EAAA;AAMTC,MAAAA,yBAAyB,EANhB,EAAA;AAOTC,MAAAA,mBAAmB,EAPV,EAAA;AAQTC,MAAAA,kBAAkB,EART,EAAA;AASTC,MAAAA,KAAK,EATI,EAAA;AAUTC,MAAAA,qBAAqB,EAVZ,EAAA;AAWTC,MAAAA,YAAY,EAXH,IAAA;AAYTC,MAAAA,qBAAqB,EAZZ,EAAA;AAaTC,MAAAA,yBAAyB,EAbhB,EAAA;AAcTC,MAAAA,sBAAsB,EAdb,EAAA;AAeTC,MAAAA,qBAAqB,EAfZ,EAAA;AAgBTC,MAAAA,qBAAqB,EAhBZ,EAAA;AAiBTC,MAAAA,oBAAoB,EAjBX,EAAA;AAkBTC,MAAAA,YAAY,EAlBH,EAAA;AAmBTC,MAAAA,eAAe,EAnBN,EAAA;AAoBTC,MAAAA,YAAY,EApBH,IAAA;AAqBTrf,MAAAA,cAAc,EArBL,EAAA;AAsBTsf,MAAAA,kBAAkB,EAtBT,IAAA;AAuBTC,MAAAA,WAAW,EAvBF,EAAA;AAwBTC,MAAAA,mBAAmB,EAxBV,IAAA;AAyBTC,MAAAA,oBAAoB,EAAE;AAzBb,KAAb;AA2BA,SAAA,SAAA,GAAA,EAAA;AACH;;AACDC,EAAAA,YAAY,CAAZA,SAAAA,CAAAA,GAAAA,GAA6B,UAAA,MAAA,EAAkB;AAC3C,QAAI,CAAC,KAAA,SAAA,CAAeC,MAAM,CAA1B,EAAK,CAAL,EAAgC;AAC5B,WAAA,SAAA,CAAeA,MAAM,CAArB,EAAA,IAAA,IAAA;;AACA,WAAK,IAAIhiB,EAAE,GAAN,CAAA,EAAY5D,EAAE,GAAG4lB,MAAM,CAA5B,IAAA,EAAmChiB,EAAE,GAAG5D,EAAE,CAA1C,MAAA,EAAmD4D,EAAnD,EAAA,EAAyD;AACrD,YAAIiiB,GAAG,GAAG7lB,EAAE,CAAZ,EAAY,CAAZ;AACA,aAAA,GAAA,CAAA,GAAA;AACH;;AACD,WAAA,KAAA,GAAa8lB,YAAY,CAAC,KAAD,KAAA,EAAzB,MAAyB,CAAzB;AACH;AARLH,GAAAA;;AAUA,SAAA,YAAA;AAzCJ,CAAkC,EAAlC;;AA2CA,SAAA,YAAA,CAAA,MAAA,EAAA,MAAA,EAAsC;AAClC,SAAO;AACHxB,IAAAA,QAAQ,EAAE4B,MAAM,CAANA,QAAAA,CAAAA,MAAAA,CAAuBC,MAAM,CADpC,QACOD,CADP;AAEH3B,IAAAA,eAAe,EAAE2B,MAAM,CAANA,eAAAA,CAAAA,MAAAA,CAA8BC,MAAM,CAFlD,eAEcD,CAFd;AAGH1B,IAAAA,uBAAuB,EAAE0B,MAAM,CAANA,uBAAAA,CAAAA,MAAAA,CAAsCC,MAAM,CAHlE,uBAGsBD,CAHtB;AAIHzB,IAAAA,0BAA0B,EAAEyB,MAAM,CAANA,0BAAAA,CAAAA,MAAAA,CAAyCC,MAAM,CAJxE,0BAIyBD,CAJzB;AAKHxB,IAAAA,wBAAwB,EAAEwB,MAAM,CAANA,wBAAAA,CAAAA,MAAAA,CAAuCC,MAAM,CALpE,wBAKuBD,CALvB;AAMHvB,IAAAA,yBAAyB,EAAEuB,MAAM,CAANA,yBAAAA,CAAAA,MAAAA,CAAwCC,MAAM,CANtE,yBAMwBD,CANxB;AAOHtB,IAAAA,mBAAmB,EAAEsB,MAAM,CAANA,mBAAAA,CAAAA,MAAAA,CAAkCC,MAAM,CAP1D,mBAOkBD,CAPlB;AAQHrB,IAAAA,kBAAkB,EAAEqB,MAAM,CAANA,kBAAAA,CAAAA,MAAAA,CAAiCC,MAAM,CARxD,kBAQiBD,CARjB;AASHpB,IAAAA,KAAK,EAAE5e,OAAQ,CAAA,EAAA,EAAKggB,MAAM,CAAX,KAAA,EAAmBC,MAAM,CATrC,KASY,CATZ;AAUHpB,IAAAA,qBAAqB,EAAEmB,MAAM,CAANA,qBAAAA,CAAAA,MAAAA,CAAoCC,MAAM,CAV9D,qBAUoBD,CAVpB;AAWHlB,IAAAA,YAAY,EAAEmB,MAAM,CAANA,YAAAA,IAAuBD,MAAM,CAXxC,YAAA;AAYHjB,IAAAA,qBAAqB,EAAEiB,MAAM,CAANA,qBAAAA,CAAAA,MAAAA,CAAoCC,MAAM,CAZ9D,qBAYoBD,CAZpB;AAaHhB,IAAAA,yBAAyB,EAAEgB,MAAM,CAANA,yBAAAA,CAAAA,MAAAA,CAAwCC,MAAM,CAbtE,yBAawBD,CAbxB;AAcHf,IAAAA,sBAAsB,EAAEe,MAAM,CAANA,sBAAAA,CAAAA,MAAAA,CAAqCC,MAAM,CAdhE,sBAcqBD,CAdrB;AAeHd,IAAAA,qBAAqB,EAAEc,MAAM,CAANA,qBAAAA,CAAAA,MAAAA,CAAoCC,MAAM,CAf9D,qBAeoBD,CAfpB;AAgBHZ,IAAAA,oBAAoB,EAAEY,MAAM,CAANA,oBAAAA,CAAAA,MAAAA,CAAmCC,MAAM,CAhB5D,oBAgBmBD,CAhBnB;AAiBHb,IAAAA,qBAAqB,EAAEa,MAAM,CAANA,qBAAAA,CAAAA,MAAAA,CAAoCC,MAAM,CAjB9D,qBAiBoBD,CAjBpB;AAkBHX,IAAAA,YAAY,EAAErf,OAAQ,CAAA,EAAA,EAAKggB,MAAM,CAAX,YAAA,EAA0BC,MAAM,CAlBnD,YAkBmB,CAlBnB;AAmBHX,IAAAA,eAAe,EAAEU,MAAM,CAANA,eAAAA,CAAAA,MAAAA,CAA8BC,MAAM,CAnBlD,eAmBcD,CAnBd;AAoBHT,IAAAA,YAAY,EAAEU,MAAM,CAANA,YAAAA,IAAuBD,MAAM,CApBxC,YAAA;AAqBH9f,IAAAA,cAAc,EAAE8f,MAAM,CAANA,cAAAA,CAAAA,MAAAA,CAA6BC,MAAM,CArBhD,cAqBaD,CArBb;AAsBHR,IAAAA,kBAAkB,EAAES,MAAM,CAANA,kBAAAA,IAA6BD,MAAM,CAtBpD,kBAAA;AAuBHP,IAAAA,WAAW,EAAEO,MAAM,CAANA,WAAAA,IAAsBC,MAAM,CAvBtC,WAAA;AAwBHP,IAAAA,mBAAmB,EAAEM,MAAM,CAANA,mBAAAA,IAA8BC,MAAM,CAxBtD,mBAAA;AAyBHN,IAAAA,oBAAoB,EAAE3f,OAAQ,CAAA,EAAA,EAAKggB,MAAM,CAAX,oBAAA,EAAkCC,MAAM,CAAxC,oBAAA;AAzB3B,GAAP;AA2BH;;AAED,IAAIC,cAAc,GAAG;AACjBC,EAAAA,WAAW,EADM,IAAA;AAEjBC,EAAAA,SAAS,EAAE,SAAA,SAAA,CAAA,GAAA,EAAe;AACtB,QAAIhuB,KAAK,CAALA,OAAAA,CAAJ,GAAIA,CAAJ,EAAwB;AAAE;AACtB,aAAA,GAAA;AADJ,KAAA,MAGK,IAAIA,KAAK,CAALA,OAAAA,CAAcsiB,GAAG,CAArB,MAAItiB,CAAJ,EAA+B;AAChC,aAAOsiB,GAAG,CAAV,MAAA;AACH;;AACD,WAAA,IAAA;AATa,GAAA;AAWjB2L,EAAAA,KAAK,EAAE,SAAA,KAAA,CAAA,GAAA,EAAA,OAAA,EAAwB;AAC3BhF,IAAAA,OAAO,CAAC;AACJhY,MAAAA,SAAS,EAAEid,GAAG,CAAHA,WAAAA,CAAgBC;AADvB,KAAD,CAAPlF;AAGH;AAfgB,CAArB;AAiBA,IAAImF,sBAAsB,GAAGC,YAAY,CAAC;AACtCnB,EAAAA,eAAe,EAAE,CAAA,cAAA;AADqB,CAAD,CAAzC;AAIA,IAAIoB,gBAAgB,GAAG;AACnBN,EAAAA,SAAS,EAAE,SAAA,SAAA,CAAA,GAAA,EAAe;AACtB,QAAI,OAAA,GAAA,KAAJ,UAAA,EAA+B;AAAE;AAC7B,aAAA,GAAA;AADJ,KAAA,MAGK,IAAI,OAAO1L,GAAG,CAAV,MAAA,KAAJ,UAAA,EAAsC;AACvC,aAAOA,GAAG,CAAV,MAAA;AACH;;AACD,WAAA,IAAA;AARe,GAAA;AAUnB2L,EAAAA,KAAK,EAAE,SAAA,KAAA,CAAA,GAAA,EAAA,OAAA,EAAA,OAAA,EAAiC;AACpC,QAAI3gB,OAAO,GAAG4gB,GAAG,CAAHA,QAAAA,CAAd,OAAA;AACA,QAAIzjB,IAAI,GAAGyjB,GAAG,CAAHA,WAAAA,CAAX,IAAA;AACAK,IAAAA,WAAW,CAAC,IAAI,CAAJ,IAAA,CAAA,IAAA,EAAgB;AACxB5hB,MAAAA,KAAK,EAAEW,OAAO,CAAPA,MAAAA,CAAe4gB,GAAG,CAAHA,KAAAA,CADE,KACjB5gB,CADiB;AAExBV,MAAAA,GAAG,EAAEU,OAAO,CAAPA,MAAAA,CAAe4gB,GAAG,CAAHA,KAAAA,CAFI,GAEnB5gB,CAFmB;AAGxBkhB,MAAAA,QAAQ,EAAElhB,OAAO,CAAPA,SAAAA,CAAkB4gB,GAAG,CAAHA,KAAAA,CAHJ,KAGd5gB,CAHc;AAIxBmhB,MAAAA,MAAM,EAAEnhB,OAAO,CAAPA,SAAAA,CAAkB4gB,GAAG,CAAHA,KAAAA,CAJF,GAIhB5gB,CAJgB;AAKxB2K,MAAAA,QAAQ,EAAE3K,OAAO,CAAC2K;AALM,KAAhB,CAAD,EAMP,UAAA,SAAA,EAAqB;AACrBgR,MAAAA,OAAO,CAAC;AAAEhY,QAAAA,SAAS,EAAEA;AAAb,OAAD,CAAPgY,CADqB,CACc;AAP5B,KAAA,EAAA,OAAA,CAQA;AARA,KAAXsF;AAUH;AAvBkB,CAAvB;AAyBA,IAAIG,qBAAqB,GAAGL,YAAY,CAAC;AACrCnB,EAAAA,eAAe,EAAE,CAAA,gBAAA;AADoB,CAAD,CAAxC;;AAIA,SAAA,WAAA,CAAA,MAAA,EAAA,GAAA,EAAA,MAAA,EAAA,eAAA,EAAA,eAAA,EAA4E;AACxEyB,EAAAA,MAAM,GAAGA,MAAM,CAAfA,WAASA,EAATA;AACA,MAAIC,IAAI,GAAR,IAAA;;AACA,MAAID,MAAM,KAAV,KAAA,EAAsB;AAClBjL,IAAAA,GAAG,GAAGmL,uBAAuB,CAAA,GAAA,EAA7BnL,MAA6B,CAA7BA;AADJ,GAAA,MAGK;AACDkL,IAAAA,IAAI,GAAGE,YAAY,CAAnBF,MAAmB,CAAnBA;AACH;;AACD,MAAIG,GAAG,GAAG,IAAV,cAAU,EAAV;AACAA,EAAAA,GAAG,CAAHA,IAAAA,CAAAA,MAAAA,EAAAA,GAAAA,EAAAA,IAAAA;;AACA,MAAIJ,MAAM,KAAV,KAAA,EAAsB;AAClBI,IAAAA,GAAG,CAAHA,gBAAAA,CAAAA,cAAAA,EAAAA,mCAAAA;AACH;;AACDA,EAAAA,GAAG,CAAHA,MAAAA,GAAa,YAAY;AACrB,QAAIA,GAAG,CAAHA,MAAAA,IAAAA,GAAAA,IAAqBA,GAAG,CAAHA,MAAAA,GAAzB,GAAA,EAA2C;AACvC,UAAI;AACA,YAAIptB,GAAG,GAAG6mB,IAAI,CAAJA,KAAAA,CAAWuG,GAAG,CAAxB,YAAUvG,CAAV;AACAwG,QAAAA,eAAe,CAAA,GAAA,EAAfA,GAAe,CAAfA;AAFJ,OAAA,CAIA,OAAA,GAAA,EAAY;AACRC,QAAAA,eAAe,CAAA,sBAAA,EAAfA,GAAe,CAAfA;AACH;AAPL,KAAA,MASK;AACDA,MAAAA,eAAe,CAAA,gBAAA,EAAfA,GAAe,CAAfA;AACH;AAZLF,GAAAA;;AAcAA,EAAAA,GAAG,CAAHA,OAAAA,GAAc,YAAY;AACtBE,IAAAA,eAAe,CAAA,gBAAA,EAAfA,GAAe,CAAfA;AADJF,GAAAA;;AAGAA,EAAAA,GAAG,CAAHA,IAAAA,CAAAA,IAAAA;AACH;;AACD,SAAA,uBAAA,CAAA,GAAA,EAAA,MAAA,EAA8C;AAC1C,SAAOrL,GAAG,IACLA,GAAG,CAAHA,OAAAA,CAAAA,GAAAA,MAAqB,CAArBA,CAAAA,GAAAA,GAAAA,GADEA,GAAG,CAAHA,GAEHoL,YAAY,CAFhB,MAEgB,CAFhB;AAGH;;AACD,SAAA,YAAA,CAAA,MAAA,EAA8B;AAC1B,MAAI7Y,KAAK,GAAT,EAAA;;AACA,OAAK,IAAL,GAAA,IAAA,MAAA,EAAwB;AACpBA,IAAAA,KAAK,CAALA,IAAAA,CAAWiZ,kBAAkB,CAAlBA,GAAkB,CAAlBA,GAAAA,GAAAA,GAAgCA,kBAAkB,CAACC,MAAM,CAApElZ,GAAoE,CAAP,CAA7DA;AACH;;AACD,SAAOA,KAAK,CAALA,IAAAA,CAAP,GAAOA,CAAP;AACH;;AAED,IAAImZ,gBAAgB,GAAG;AACnBpB,EAAAA,SAAS,EAAE,SAAA,SAAA,CAAA,GAAA,EAAe;AACtB,QAAI,OAAA,GAAA,KAAJ,QAAA,EAA6B;AAAE;AAC3B1L,MAAAA,GAAG,GAAG;AAAEoB,QAAAA,GAAG,EAAEpB;AAAP,OAANA;AADJ,KAAA,MAGK,IAAI,CAAA,GAAA,IAAQ,OAAA,GAAA,KAAR,QAAA,IAAmC,CAACA,GAAG,CAA3C,GAAA,EAAiD;AAClD,aAAA,IAAA;AACH;;AACD,WAAO;AACHoB,MAAAA,GAAG,EAAEpB,GAAG,CADL,GAAA;AAEHqM,MAAAA,MAAM,EAAE,CAACrM,GAAG,CAAHA,MAAAA,IAAD,KAAA,EAFL,WAEK,EAFL;AAGH+M,MAAAA,WAAW,EAAE/M,GAAG,CAHb,WAAA;AAIHgN,MAAAA,UAAU,EAAEhN,GAAG,CAJZ,UAAA;AAKHiN,MAAAA,QAAQ,EAAEjN,GAAG,CALV,QAAA;AAMHkN,MAAAA,aAAa,EAAElN,GAAG,CAACkN;AANhB,KAAP;AARe,GAAA;AAiBnBvB,EAAAA,KAAK,EAAE,SAAA,KAAA,CAAA,GAAA,EAAA,OAAA,EAAA,OAAA,EAAiC;AACpC,QAAIE,IAAI,GAAGD,GAAG,CAAHA,WAAAA,CAAX,IAAA;AACA,QAAIuB,aAAa,GAAGC,kBAAkB,CAAA,IAAA,EAAOxB,GAAG,CAAV,KAAA,EAAkBA,GAAG,CAA3D,QAAsC,CAAtC;AACAyB,IAAAA,WAAW,CAACxB,IAAI,CAAL,MAAA,EAAcA,IAAI,CAAlB,GAAA,EAAA,aAAA,EAAuC,UAAA,SAAA,EAAA,GAAA,EAA0B;AACxElF,MAAAA,OAAO,CAAC;AAAEhY,QAAAA,SAAS,EAAX,SAAA;AAAwB8d,QAAAA,GAAG,EAAEA;AAA7B,OAAD,CAAP9F;AADO,KAAA,EAER,UAAA,YAAA,EAAA,GAAA,EAA6B;AAC5BE,MAAAA,OAAO,CAAC;AAAEyG,QAAAA,OAAO,EAAT,YAAA;AAAyBb,QAAAA,GAAG,EAAEA;AAA9B,OAAD,CAAP5F;AAHJwG,KAAW,CAAXA;AAKH;AAzBkB,CAAvB;AA2BA,IAAIE,yBAAyB,GAAGxB,YAAY,CAAC;AACzCnB,EAAAA,eAAe,EAAE,CAAA,gBAAA;AADwB,CAAD,CAA5C;;AAGA,SAAA,kBAAA,CAAA,IAAA,EAAA,KAAA,EAAA,QAAA,EAAmD;AAC/C,MAAI5f,OAAO,GAAGuC,QAAQ,CAAtB,OAAA;AACA,MAAA,UAAA;AACA,MAAA,QAAA;AACA,MAAA,aAAA;AACA,MAAA,mBAAA;AACA,MAAIsf,MAAM,GAAV,EAAA;AACAG,EAAAA,UAAU,GAAGnB,IAAI,CAAjBmB,UAAAA;;AACA,MAAIA,UAAU,IAAd,IAAA,EAAwB;AACpBA,IAAAA,UAAU,GAAGzf,QAAQ,CAARA,GAAAA,CAAbyf,YAAazf,CAAbyf;AACH;;AACDC,EAAAA,QAAQ,GAAGpB,IAAI,CAAfoB,QAAAA;;AACA,MAAIA,QAAQ,IAAZ,IAAA,EAAsB;AAClBA,IAAAA,QAAQ,GAAG1f,QAAQ,CAARA,GAAAA,CAAX0f,UAAW1f,CAAX0f;AACH;;AACDC,EAAAA,aAAa,GAAGrB,IAAI,CAApBqB,aAAAA;;AACA,MAAIA,aAAa,IAAjB,IAAA,EAA2B;AACvBA,IAAAA,aAAa,GAAG3f,QAAQ,CAARA,GAAAA,CAAhB2f,eAAgB3f,CAAhB2f;AAjB2C,GAAA,CAmB/C;;;AACA,MAAI,OAAOrB,IAAI,CAAX,WAAA,KAAJ,UAAA,EAA4C;AACxC;AACA2B,IAAAA,mBAAmB,GAAG3B,IAAI,CAA1B2B,WAAsB3B,EAAtB2B;AAFJ,GAAA,MAIK;AACD;AACAA,IAAAA,mBAAmB,GAAG3B,IAAI,CAAJA,WAAAA,IAAtB2B,EAAAA;AACH;;AACDliB,EAAAA,OAAQ,CAAA,MAAA,EAARA,mBAAQ,CAARA;;AACAuhB,EAAAA,MAAM,CAANA,UAAM,CAANA,GAAqB7hB,OAAO,CAAPA,SAAAA,CAAkB2E,KAAK,CAA5Ckd,KAAqB7hB,CAArB6hB;AACAA,EAAAA,MAAM,CAANA,QAAM,CAANA,GAAmB7hB,OAAO,CAAPA,SAAAA,CAAkB2E,KAAK,CAA1Ckd,GAAmB7hB,CAAnB6hB;;AACA,MAAI7hB,OAAO,CAAPA,QAAAA,KAAJ,OAAA,EAAkC;AAC9B6hB,IAAAA,MAAM,CAANA,aAAM,CAANA,GAAwB7hB,OAAO,CAA/B6hB,QAAAA;AACH;;AACD,SAAA,MAAA;AACH;;AAED,IAAIY,SAAS,GAAG;AACZC,EAAAA,KAAK,EAAE,SAAA,KAAA,CAAA,QAAA,EAAA,aAAA,EAAA,OAAA,EAA4C;AAC/C,QAAIC,YAAY,GAAG3iB,OAAO,CAAPA,YAAAA,CAAAA,IAAAA,CAAnB,OAAmBA,CAAnB;AACA,QAAIhB,UAAU,GAAG;AACb8Y,MAAAA,UAAU,EADG,IAAA;AAEbF,MAAAA,SAAS,EAFI,cAAA;AAGbC,MAAAA,OAAO,EAHM,cAAA;AAIb+K,MAAAA,UAAU,EAJG,YAAA;AAKbC,MAAAA,QAAQ,EAAEF;AALG,KAAjB;AAOA,QAAI1uB,KAAK,GAAGmhB,WAAW,CAAA,QAAA,EAAA,UAAA,EAAA,EAAA,EAAvB,aAAuB,CAAvB;AACA,QAAI0N,QAAQ,GAAZ,KAAA;;AACA,SAAK,IAAL,QAAA,IAAA,KAAA,EAA4B;AACxB,UAAI7uB,KAAK,CAALA,QAAK,CAALA,IAAJ,IAAA,EAA6B;AACzB6uB,QAAAA,QAAQ,GAARA,IAAAA;AACA;AACH;AACJ;;AACD,QAAA,QAAA,EAAc;AACV,UAAIliB,QAAQ,GAAZ,IAAA;;AACA,UAAI,cAAJ,aAAA,EAAiC;AAC7BA,QAAAA,QAAQ,GAAGnB,cAAc,CAACP,aAAa,CAAvC0B,QAAyB,CAAzBA;AACA,eAAO1B,aAAa,CAApB,QAAA;AACH;;AACD,UAAI,CAAA,QAAA,IAAajL,KAAK,CAAlB,SAAA,IAAgCA,KAAK,CAAzC,OAAA,EAAmD;AAC/C2M,QAAAA,QAAQ,GAAGmiB,iBAAiB,CAAC9uB,KAAK,CAAN,OAAA,EAAgBA,KAAK,CAAjD2M,SAA4B,CAA5BA;AACH;;AACD,aAAO;AACHoiB,QAAAA,WAAW,EAAE3f,OAAO,CAAC,CAACpP,KAAK,CAAN,SAAA,IAAoB,CAACA,KAAK,CAD5C,OACiB,CADjB;AAEH2M,QAAAA,QAAQ,EAFL,QAAA;AAGHC,QAAAA,QAAQ,EAHL,KAAA,CAGa;;AAHb,OAAP;AAKH;;AACD,WAAA,IAAA;AAjCQ,GAAA;AAmCZoiB,EAAAA,MAAM,EAAE,SAAA,MAAA,CAAA,QAAA,EAAA,YAAA,EAAA,OAAA,EAA2C;AAC/C,QAAIC,mBAAmB,GAAGlV,eAAe,CAAA,YAAA,EAAe;AAAE3O,MAAAA,KAAK,EAAEwB,QAAQ,CAAjB,UAAA;AAA8BvB,MAAAA,GAAG,EAAEuB,QAAQ,CAACgiB;AAA5C,KAAf,CAAzC;;AACA,QAAA,mBAAA,EAAyB;AACrB,aAAOM,YAAY,CAACtiB,QAAQ,CAAT,UAAA,EAAsBA,QAAQ,CAA9B,SAAA,EAAA,mBAAA,EAAnB,OAAmB,CAAnB;AADJ,KAAA,MAGK;AACD,aAAA,EAAA;AACH;AACJ;AA3CW,CAAhB;AA6CA,IAAIuiB,sBAAsB,GAAGrC,YAAY,CAAC;AACtCvgB,EAAAA,cAAc,EAAE,CAAA,SAAA;AADsB,CAAD,CAAzC;;AAGA,SAAA,YAAA,CAAA,UAAA,EAAA,SAAA,EAAA,YAAA,EAAA,OAAA,EAAoE;AAChE,MAAI6iB,OAAO,GAAGvL,UAAU,GAAGwL,WAAW,CAAd,UAAc,CAAd,GAAxB,IAAA;AACA,MAAIC,SAAS,GAAG3qB,UAAU,CAACsI,YAAY,CAAvC,KAA0B,CAA1B;AACA,MAAIoW,SAAS,GAAGpW,YAAY,CAA5B,GAAA;AACA,MAAIsiB,cAAc,GAAlB,EAAA;;AACA,SAAOD,SAAS,GAAhB,SAAA,EAA8B;AAC1B,QAAIE,aAAa,CACjB;AADiB,MAEf,KAHwB,CAC1B,CAD0B,CAI1B;;AACA,QAAI,CAAA,OAAA,IAAYJ,OAAO,CAACE,SAAS,CAAjC,SAAwBA,EAAD,CAAvB,EAAgD;AAC5C,UAAA,SAAA,EAAe;AACXE,QAAAA,aAAa,GAAGzjB,OAAO,CAAPA,GAAAA,CAAAA,SAAAA,EAAhByjB,SAAgBzjB,CAAhByjB;AADJ,OAAA,MAGK;AACDA,QAAAA,aAAa,GAAbA,SAAAA;AACH;;AACDD,MAAAA,cAAc,CAAdA,IAAAA,CAAAA,aAAAA;AACH;;AACDD,IAAAA,SAAS,GAAGhkB,OAAO,CAAA,SAAA,EAAnBgkB,CAAmB,CAAnBA;AACH;;AACD,SAAA,cAAA;AACH;;AAED,IAAIG,2BAA2B,GAAG3C,YAAY,CAAC;AAC3Cd,EAAAA,oBAAoB,EAAE;AAClB0D,IAAAA,MAAM,EAAE,SAAA,MAAA,CAAA,OAAA,EAAA,QAAA,EAAA,SAAA,EAAuC;AAC3CC,MAAAA,kBAAkB,CAAC,CAAD,OAAC,CAAD,EAAA,QAAA,EAAlBA,SAAkB,CAAlBA;AAFc,KAAA;AAIlB3T,IAAAA,YAAY,EAJM,kBAAA;AAKlB4T,IAAAA,OAAO,EAAEC;AALS;AADqB,CAAD,CAA9C;;AASA,SAAA,kBAAA,CAAA,MAAA,EAAA,QAAA,EAAA,SAAA,EAAyD;AACrD,MAAIC,cAAc,GAAGC,iBAAiB,CAACzhB,QAAQ,CAARA,KAAAA,CAAvC,YAAsC,CAAtC;AACA,MAAI0hB,SAAS,GAAb,EAAA;;AACA,OAAK,IAAI9lB,EAAE,GAAN,CAAA,EAAY+lB,QAAQ,GAAzB,MAAA,EAAoC/lB,EAAE,GAAG+lB,QAAQ,CAAjD,MAAA,EAA0D/lB,EAA1D,EAAA,EAAgE;AAC5D,QAAIpB,KAAK,GAAGmnB,QAAQ,CAApB,EAAoB,CAApB;AACA,QAAIC,UAAU,GAAd,KAAA;;AACA,SAAK,IAAIrxB,CAAC,GAAV,CAAA,EAAgBA,CAAC,GAAGixB,cAAc,CAAlC,MAAA,EAA2CjxB,CAA3C,EAAA,EAAgD;AAC5C,UAAIsxB,SAAS,CAACL,cAAc,CAAdA,CAAc,CAAdA,CAAD,IAAA,EAAb,KAAa,CAAb,EAA8C;AAC1CA,QAAAA,cAAc,CAAdA,MAAAA,CAAAA,CAAAA,EAD0C,CAC1CA,EAD0C,CACb;;AAC7BI,QAAAA,UAAU,GAAVA,IAAAA;AACA;AACH;AACJ;;AACD,QAAI,CAAJ,UAAA,EAAiB;AACbF,MAAAA,SAAS,CAATA,IAAAA,CAAAA,KAAAA;AACH;AACJ;;AACD,OAAK,IAAI1pB,EAAE,GAAN,CAAA,EAAY8pB,gBAAgB,GAAjC,cAAA,EAAoD9pB,EAAE,GAAG8pB,gBAAgB,CAAzE,MAAA,EAAkF9pB,EAAlF,EAAA,EAAwF;AACpF,QAAI+pB,aAAa,GAAGD,gBAAgB,CAApC,EAAoC,CAApC;AACA9hB,IAAAA,QAAQ,CAARA,QAAAA,CAAkB;AACd0I,MAAAA,IAAI,EADU,qBAAA;AAEdC,MAAAA,QAAQ,EAAEoZ,aAAa,CAACpZ;AAFV,KAAlB3I;AAIH;;AACD,OAAK,IAAIyJ,EAAE,GAAN,CAAA,EAAYuY,WAAW,GAA5B,SAAA,EAA0CvY,EAAE,GAAGuY,WAAW,CAA1D,MAAA,EAAmEvY,EAAnE,EAAA,EAAyE;AACrE,QAAIwY,QAAQ,GAAGD,WAAW,CAA1B,EAA0B,CAA1B;AACAhiB,IAAAA,QAAQ,CAARA,cAAAA,CAAAA,QAAAA;AACH;EAEL;;;AACA,SAAA,aAAA,CAAA,MAAA,EAAA,QAAA,EAAyC;AACrCA,EAAAA,QAAQ,CAARA,eAAAA,CADqC,MACrCA,EADqC,CACH;AACrC;;AAED,IAAIkiB,MAAM,GAAV,EAAA,C,CAAiB;;AACjB,IAAIC,cAAc,GAAG;AACjBC,EAAAA,qBAAqB,EADJ,KAAA;AAEjBC,EAAAA,mBAAmB,EAFF,UAAA;AAGjBC,EAAAA,yBAAyB,EAHR,UAAA;AAIjBC,EAAAA,0BAA0B,EAAE;AAAE9e,IAAAA,GAAG,EAAE;AAAP,GAJX;AAKjB+e,EAAAA,kBAAkB,EALD,KAAA;AAMjBvlB,EAAAA,gBAAgB,EANC,UAAA;AAOjB;AACAwlB,EAAAA,YAAY,EARK,IAAA;AASjBjF,EAAAA,WAAW,EATM,EAAA;AAUjBkF,EAAAA,WAAW,EAVM,IAAA;AAWjBC,EAAAA,MAAM,EAAE;AACJ5wB,IAAAA,IAAI,EADA,OAAA;AAEJ6wB,IAAAA,MAAM,EAFF,EAAA;AAGJzwB,IAAAA,KAAK,EAAE;AAHH,GAXS;AAgBjB0wB,EAAAA,QAAQ,EAhBS,IAAA;AAiBjBC,EAAAA,WAAW,EAjBM,KAAA;AAkBjBC,EAAAA,qBAAqB,EAlBJ,OAAA;AAmBjBrQ,EAAAA,QAAQ,EAnBS,KAAA;AAoBjB;AACAsQ,EAAAA,UAAU,EArBO,UAAA;AAsBjBC,EAAAA,OAAO,EAtBU,UAAA;AAuBjBC,EAAAA,OAAO,EAvBU,UAAA;AAwBjBC,EAAAA,mBAAmB,EAxBF,IAAA;AAyBjB;AACAC,EAAAA,YAAY,EA1BK,IAAA;AA2BjB3D,EAAAA,UAAU,EA3BO,OAAA;AA4BjBC,EAAAA,QAAQ,EA5BS,KAAA;AA6BjBC,EAAAA,aAAa,EA7BI,UAAA;AA8BjBvX,EAAAA,QAAQ,EA9BS,OAAA;AA+BjB;AACA;AACAib,EAAAA,OAAO,EAjCU,EAAA;AAkCjB/c,EAAAA,MAAM,EAlCW,EAAA;AAmCjB;AACA;AACA;AACAgd,EAAAA,sBAAsB,EAtCL,CAAA;AAuCjBC,EAAAA,WAAW,EAvCM,UAAA;AAwCjB;AACAC,EAAAA,kBAAkB,EAzCD,GAAA;AA0CjBC,EAAAA,UAAU,EA1CO,IAAA;AA2CjBC,EAAAA,sBAAsB,EA3CL,KAAA;AA4CjB;AACAC,EAAAA,YAAY,EA7CK,IAAA;AA8CjB;AACAC,EAAAA,UAAU,EA/CO,GAAA;AAgDjBC,EAAAA,UAAU,EAhDO,8BAAA;AAiDjB;AACA;AACAC,EAAAA,UAAU,EAnDO,KAAA;AAoDjBC,EAAAA,eAAe,EApDE,SAAA;AAqDjBC,EAAAA,gBAAgB,EAAE;AAAExgB,IAAAA,KAAK,EAAP,MAAA;AAAiBC,IAAAA,GAAG,EAApB,SAAA;AAAiCF,IAAAA,IAAI,EAAE;AAAvC,GArDD;AAsDjB0gB,EAAAA,kBAAkB,EAtDD,IAAA;AAuDjBC,EAAAA,iBAAiB,EAvDA,GAAA;AAwDjBC,EAAAA,cAAc,EAxDG,IAAA;AAyDjBC,EAAAA,oBAAoB,EAzDH,CAAA,CAyDO;;AAzDP,CAArB;AA2DA,IAAIC,WAAW,GAAG;AACd1B,EAAAA,MAAM,EAAE;AACJ5wB,IAAAA,IAAI,EADA,iBAAA;AAEJ6wB,IAAAA,MAAM,EAFF,EAAA;AAGJzwB,IAAAA,KAAK,EAAE;AAHH,GADM;AAMdmyB,EAAAA,WAAW,EAAE;AACT;AACAC,IAAAA,IAAI,EAFK,uBAAA;AAGTC,IAAAA,IAAI,EAHK,sBAAA;AAITC,IAAAA,QAAQ,EAJC,wBAAA;AAKTC,IAAAA,QAAQ,EAAE;AALD;AANC,CAAlB;AAcA,IAAIC,cAAc,GAAG,CAAA,QAAA,EAAA,QAAA,EAAA,YAAA,EAArB,aAAqB,CAArB,C,CAMA;;AACA,SAAA,YAAA,CAAA,UAAA,EAAkC;AAC9B,SAAOzlB,UAAU,CAAA,UAAA,EAAjB,cAAiB,CAAjB;EAEJ;;;AACA,IAAI0lB,gBAAgB,GAAG,CAAA,sBAAA,EAAA,qBAAA,EAAA,yBAAA,EAAA,sBAAA,EAAvB,2BAAuB,CAAvB;;AAOA,SAAA,gBAAA,CAAA,YAAA,EAAwC;AACpC,MAAItD,OAAO,GAAX,EAAA;;AACA,OAAK,IAAI1lB,EAAE,GAAN,CAAA,EAAYipB,cAAc,GAA/B,YAAA,EAAgDjpB,EAAE,GAAGipB,cAAc,CAAnE,MAAA,EAA4EjpB,EAA5E,EAAA,EAAkF;AAC9E,QAAIkpB,WAAW,GAAGD,cAAc,CAAhC,EAAgC,CAAhC;;AACA,QAAI,OAAA,WAAA,KAAJ,QAAA,EAAqC;AACjC,UAAIE,UAAU,GAAG,iBAAiB5R,qBAAqB,CAAvD,WAAuD,CAAvD;;AACA,UAAI,CAAC3f,MAAM,CAAX,UAAW,CAAX,EAAyB;AACrBwxB,QAAAA,OAAO,CAAPA,IAAAA,CAAa,gCAAbA,WAAAA;AADJ,OAAA,MAGK;AACD1D,QAAAA,OAAO,CAAPA,IAAAA,CAAa9tB,MAAM,CAANA,UAAM,CAANA,CADZ,OACD8tB,EADC,CACyC;AAC7C;AAPL,KAAA,MASK;AACDA,MAAAA,OAAO,CAAPA,IAAAA,CAAAA,WAAAA;AACH;AACJ;;AACD,SAAOsD,gBAAgB,CAAhBA,MAAAA,CAAP,OAAOA,CAAP;AACH;;AAED,IAAIK,aAAa,GAAG;AAChBC,EAAAA,IAAI,EADY,IAAA;AAEhBniB,EAAAA,IAAI,EAAE;AACFoiB,IAAAA,GAAG,EADD,CAAA;AAEFC,IAAAA,GAAG,EAFD,CAAA,CAEK;;AAFL,GAFU;AAMhBC,EAAAA,GAAG,EANa,KAAA;AAOhBC,EAAAA,UAAU,EAAE;AACRf,IAAAA,IAAI,EADI,MAAA;AAERC,IAAAA,IAAI,EAFI,MAAA;AAGRC,IAAAA,QAAQ,EAHA,WAAA;AAIRC,IAAAA,QAAQ,EAJA,WAAA;AAKRnhB,IAAAA,IAAI,EALI,MAAA;AAMRgiB,IAAAA,KAAK,EANG,OAAA;AAOR/hB,IAAAA,KAAK,EAPG,OAAA;AAQRT,IAAAA,IAAI,EARI,MAAA;AASRU,IAAAA,GAAG,EATK,KAAA;AAUR+hB,IAAAA,IAAI,EAAE;AAVE,GAPI;AAmBhBC,EAAAA,SAAS,EAnBO,GAAA;AAoBhBC,EAAAA,UAAU,EApBM,SAAA;AAqBhBC,EAAAA,cAAc,EArBE,MAAA;AAsBhBC,EAAAA,eAAe,EAAE;AAtBD,CAApB;;AAwBA,SAAA,eAAA,CAAA,kBAAA,EAA6C;AACzC,MAAIC,WAAW,GAAGC,kBAAkB,CAAlBA,MAAAA,GAAAA,CAAAA,GAAgCA,kBAAkB,CAAlBA,CAAkB,CAAlBA,CAAhCA,IAAAA,GAAlB,IAAA;AACA,MAAIC,WAAW,GAAGvyB,MAAM,CAANA,wBAAM,CAANA,IAFuB,EAEzC,CAFyC,CAEiB;;AAC1D,MAAIwyB,YAAY,GAAGxyB,MAAM,CAANA,qBAAM,CAANA,IAHsB,EAGzC,CAHyC,CAGe;;AACxD,MAAIyyB,aAAa,GAAG,WAAW,CAAX,MAAA,EAAmB;AACvCxE,EAAAA,iBAAiB,CADG,YACH,CADG,EACa;AADb,EAAA,kBAAA,CAED;AAFC,GAApB;AAIA,MAAIyE,YAAY,GAAG;AACfC,IAAAA,EAAE,EADa,aAAA,CACG;;AADH,GAAnB;;AAGA,OAAK,IAAIvqB,EAAE,GAAN,CAAA,EAAYwqB,eAAe,GAAhC,aAAA,EAAkDxqB,EAAE,GAAGwqB,eAAe,CAAtE,MAAA,EAA+ExqB,EAA/E,EAAA,EAAqF;AACjF,QAAIyqB,SAAS,GAAGD,eAAe,CAA/B,EAA+B,CAA/B;AACAF,IAAAA,YAAY,CAACG,SAAS,CAAtBH,IAAY,CAAZA,GAAAA,SAAAA;AACH;;AACD,SAAO;AACHI,IAAAA,GAAG,EADA,YAAA;AAEHT,IAAAA,WAAW,EAAEA;AAFV,GAAP;AAIH;;AACD,SAAA,WAAA,CAAA,aAAA,EAAA,SAAA,EAA+C;AAC3C,MAAI,OAAA,aAAA,KAAA,QAAA,IAAqC,CAAC11B,KAAK,CAALA,OAAAA,CAA1C,aAA0CA,CAA1C,EAAwE;AACpE,WAAOo2B,WAAW,CAACC,aAAa,CAAd,IAAA,EAAqB,CAACA,aAAa,CAAnC,IAAqB,CAArB,EAAlB,aAAkB,CAAlB;AADJ,GAAA,MAGK;AACD,WAAOC,WAAW,CAAA,aAAA,EAAlB,SAAkB,CAAlB;AACH;AACJ;;AACD,SAAA,WAAA,CAAA,OAAA,EAAA,SAAA,EAAyC;AACrC,MAAIC,KAAK,GAAG,GAAA,MAAA,CAAUC,OAAO,IADQ,EACzB,CAAZ,CADqC,CACC;;AACtC,MAAIlU,GAAG,GAAGmU,cAAc,CAAA,KAAA,EAAdA,SAAc,CAAdA,IAAV,aAAA;AACA,SAAOL,WAAW,CAAA,OAAA,EAAA,KAAA,EAAlB,GAAkB,CAAlB;AACH;;AACD,SAAA,cAAA,CAAA,KAAA,EAAA,SAAA,EAA0C;AACtC,OAAK,IAAIh2B,CAAC,GAAV,CAAA,EAAgBA,CAAC,GAAGm2B,KAAK,CAAzB,MAAA,EAAkCn2B,CAAlC,EAAA,EAAuC;AACnC,QAAI6V,KAAK,GAAGsgB,KAAK,CAALA,CAAK,CAALA,CAAAA,iBAAAA,GAAAA,KAAAA,CAAZ,GAAYA,CAAZ;;AACA,SAAK,IAAIr1B,CAAC,GAAG+U,KAAK,CAAlB,MAAA,EAA2B/U,CAAC,GAA5B,CAAA,EAAkCA,CAAlC,EAAA,EAAuC;AACnC,UAAIw1B,QAAQ,GAAGzgB,KAAK,CAALA,KAAAA,CAAAA,CAAAA,EAAAA,CAAAA,EAAAA,IAAAA,CAAf,GAAeA,CAAf;;AACA,UAAI0gB,SAAS,CAAb,QAAa,CAAb,EAAyB;AACrB,eAAOA,SAAS,CAAhB,QAAgB,CAAhB;AACH;AACJ;AACJ;;AACD,SAAA,IAAA;AACH;;AACD,SAAA,WAAA,CAAA,OAAA,EAAA,KAAA,EAAA,GAAA,EAA0C;AACtC,MAAIC,MAAM,GAAG7nB,UAAU,CAAC,CAAA,aAAA,EAAD,GAAC,CAAD,EAAuB,CAA9C,YAA8C,CAAvB,CAAvB;AACA,SAAO6nB,MAAM,CAFyB,IAEtC,CAFsC,CAElB;;AACpB,MAAIhkB,IAAI,GAAGgkB,MAAM,CAAjB,IAAA;AACA,SAAOA,MAAM,CAAb,IAAA;AACA,SAAO;AACHJ,IAAAA,OAAO,EADJ,OAAA;AAEHD,IAAAA,KAAK,EAFF,KAAA;AAGH3jB,IAAAA,IAAI,EAHD,IAAA;AAIHikB,IAAAA,kBAAkB,EAAE,IAAInhB,IAAI,CAAR,YAAA,CAJjB,OAIiB,CAJjB;AAKHa,IAAAA,OAAO,EAAEqgB;AALN,GAAP;AAOH;;AAED,IAAIE,cAAc;AAAG;AAAe,YAAY;AAC5C,WAAA,cAAA,CAAA,SAAA,EAAmC;AAC/B,SAAA,SAAA,GAAiBlpB,OAAQ,CAAA,EAAA,EADM,SACN,CAAzB,CAD+B,CACW;;AAC1C,SAAA,gBAAA,GAAA,EAAA;AACA,SAAA,OAAA;AACH;;AACDkpB,EAAAA,cAAc,CAAdA,SAAAA,CAAAA,MAAAA,GAAkC,UAAA,OAAA,EAAA,QAAA,EAAA,SAAA,EAAwC;AACtE,QAAIC,YAAY,GAAGC,SAAS,GAAG,KAAH,gBAAA,GAA2B,KAAvD,SAAA;;AACAppB,IAAAA,OAAQ,CAAA,YAAA,EAARA,OAAQ,CAARA;;AACA,SAAK,IAAInC,EAAE,GAAN,CAAA,EAAYwrB,UAAU,GAA3B,QAAA,EAAwCxrB,EAAE,GAAGwrB,UAAU,CAAvD,MAAA,EAAgExrB,EAAhE,EAAA,EAAsE;AAClE,UAAIyrB,QAAQ,GAAGD,UAAU,CAAzB,EAAyB,CAAzB;AACA,aAAOF,YAAY,CAAnB,QAAmB,CAAnB;AACH;;AACD,SAAA,OAAA;AAbwC,GAM5CD,CAN4C,CAe5C;AACA;;;AACAA,EAAAA,cAAc,CAAdA,SAAAA,CAAAA,OAAAA,GAAmC,YAAY;AAC3C;AACA,QAAI5D,OAAO,GAAGiE,YAAY,EAAC;AAC3B,SAAA,gBAAA,CAD0B,OAAA,EACK,KAAA,SAAA,CADL,OAAA,EAC6BnF,cAAc,CADrE,OAA0B,CAA1B;AAEA,QAAI7b,MAAM,GAAGghB,YAAY,EAAC;AAC1B,SAAA,gBAAA,CADyB,MAAA,EACK,KAAA,SAAA,CADL,MAAA,EAC4BnF,cAAc,CADnE,MAAyB,CAAzB;AAEA,QAAI2E,SAAS,GAAGS,eAAe,CAA/B,OAA+B,CAA/B;AACA,QAAIC,cAAc,GAAGC,WAAW,CAACnhB,MAAM,IAAIwgB,SAAS,CAApB,WAAA,EAAkCA,SAAS,CAAtDW,GAAW,CAAXA,CAArB,OAAA;AACA,QAAIpC,GAAG,GAAGiC,YAAY,EAAC;AACvB,SAAA,gBAAA,CADsB,GAAA,EACK,KAAA,SAAA,CADL,GAAA,EACyBE,cAAc,CAD7D,GAAsB,CAAtB;AAEA,QAAIE,WAAW,GAAGrC,GAAG,KAAHA,KAAAA,GAAAA,WAAAA,GAAlB,EAAA;AACA,SAAA,WAAA,GAAA,WAAA;AACA,SAAA,cAAA,GAAA,cAAA;AACA,SAAA,QAAA,GAAgBsC,YAAY,CAAC,CAAA,cAAA,EAAA,WAAA,EAAA,cAAA,EAIzB,KAJyB,SAAA,EAKzB,KALJ,gBAA6B,CAAD,CAA5B;AAbJV,GAAAA;;AAqBA,SAAA,cAAA;AAtCJ,CAAoC,EAApC;;AAyCA,IAAIW,sBAAsB,GAA1B,EAAA;;AACA,SAAA,sBAAA,CAAA,IAAA,EAAA,QAAA,EAAgD;AAC5CA,EAAAA,sBAAsB,CAAtBA,IAAsB,CAAtBA,GAAAA,QAAAA;AACH;;AACD,SAAA,oBAAA,CAAA,IAAA,EAAoC;AAChC,SAAO,IAAIA,sBAAsB,CAAjC,IAAiC,CAA1B,EAAP;AACH;;AACD,IAAIC,uBAAuB;AAAG;AAAe,YAAY;AACrD,WAAA,uBAAA,GAAmC,CAClC;;AACDA,EAAAA,uBAAuB,CAAvBA,SAAAA,CAAAA,aAAAA,GAAkD,UAAA,CAAA,EAAa;AAC3D,WAAOlxB,CAAC,CAAR,cAAOA,EAAP;AADJkxB,GAAAA;;AAGAA,EAAAA,uBAAuB,CAAvBA,SAAAA,CAAAA,cAAAA,GAAmD,UAAA,CAAA,EAAa;AAC5D,WAAOlxB,CAAC,CAAR,WAAOA,EAAP;AADJkxB,GAAAA;;AAGAA,EAAAA,uBAAuB,CAAvBA,SAAAA,CAAAA,YAAAA,GAAiD,UAAA,CAAA,EAAa;AAC1D,WAAOlxB,CAAC,CAAR,UAAOA,EAAP;AADJkxB,GAAAA;;AAGAA,EAAAA,uBAAuB,CAAvBA,SAAAA,CAAAA,aAAAA,GAAkD,UAAA,GAAA,EAAe;AAC7D,WAAO7xB,cAAc,CAArB,GAAqB,CAArB;AADJ6xB,GAAAA;;AAGAA,EAAAA,uBAAuB,CAAvBA,SAAAA,CAAAA,aAAAA,GAAkD,UAAA,MAAA,EAAkB;AAChE,WAAO/xB,cAAc,CAArB,MAAqB,CAArB;AADJ+xB,GAAAA;;AAGA,SAAA,uBAAA;AAlBJ,CAA6C,EAA7C;;AAoBAC,sBAAsB,CAAA,SAAA,EAAtBA,uBAAsB,CAAtBA;AAEA,IAAIC,MAAM,GAAV,+GAAA;;AACA,SAAA,KAAA,CAAA,GAAA,EAAoB;AAChB,MAAIjxB,CAAC,GAAGixB,MAAM,CAANA,IAAAA,CAAR,GAAQA,CAAR;;AACA,MAAA,CAAA,EAAO;AACH,QAAI/wB,MAAM,GAAG,IAAA,IAAA,CAASU,IAAI,CAAJA,GAAAA,CAASswB,MAAM,CAAClxB,CAAC,CAAjBY,CAAiB,CAAF,CAAfA,EAAuBZ,CAAC,CAADA,CAAC,CAADA,GAAOkxB,MAAM,CAAClxB,CAAC,CAARkxB,CAAQ,CAAF,CAANA,GAAPlxB,CAAAA,GAAvBY,CAAAA,EAAoDswB,MAAM,CAAClxB,CAAC,CAADA,CAAC,CAADA,IAA3DY,CAA0D,CAA1DA,EAAuEswB,MAAM,CAAClxB,CAAC,CAADA,CAAC,CAADA,IAA9EY,CAA6E,CAA7EA,EAA0FswB,MAAM,CAAClxB,CAAC,CAADA,CAAC,CAADA,IAAjGY,CAAgG,CAAhGA,EAA6GswB,MAAM,CAAClxB,CAAC,CAADA,EAAC,CAADA,IAApHY,CAAmH,CAAnHA,EAAiIZ,CAAC,CAADA,EAAC,CAADA,GAAQkxB,MAAM,CAAC,OAAOlxB,CAAC,CAAfkxB,EAAe,CAAT,CAANA,GAARlxB,IAAAA,GAAvJ,CAAsBY,CAAT,CAAb;;AACA,QAAIuwB,WAAW,CAAf,MAAe,CAAf,EAAyB;AACrB,UAAIvgB,cAAc,GAAlB,IAAA;;AACA,UAAI5Q,CAAC,CAAL,EAAK,CAAL,EAAW;AACP4Q,QAAAA,cAAc,GAAG,CAAC5Q,CAAC,CAADA,EAAC,CAADA,KAAAA,GAAAA,GAAgB,CAAhBA,CAAAA,GAAD,CAAA,KAA4BkxB,MAAM,CAAClxB,CAAC,CAADA,EAAC,CAADA,IAAPkxB,CAAM,CAANA,GAAAA,EAAAA,GACzCA,MAAM,CAAClxB,CAAC,CAADA,EAAC,CAADA,IADX4Q,CACU,CADO,CAAjBA;AAEH;;AACD,aAAO;AACH1Q,QAAAA,MAAM,EADH,MAAA;AAEHkxB,QAAAA,iBAAiB,EAAE,CAACpxB,CAAC,CAFlB,CAEkB,CAFlB;AAGH4Q,QAAAA,cAAc,EAAEA;AAHb,OAAP;AAKH;AACJ;;AACD,SAAA,IAAA;AACH;;AAED,IAAIygB,OAAO;AAAG;AAAe,YAAY;AACrC,WAAA,OAAA,CAAA,QAAA,EAA2B;AACvB,QAAI/f,QAAQ,GAAG,KAAA,QAAA,GAAgBggB,QAAQ,CAAvC,QAAA;AACA,QAAIC,eAAe,GAAGjgB,QAAQ,KAARA,OAAAA,IAAwBA,QAAQ,KAAtD,KAAA;;AACA,QAAIggB,QAAQ,CAARA,iBAAAA,IAAJ,eAAA,EAAmD;AAC/C,WAAA,iBAAA,GAAyB,IAAIA,QAAQ,CAAZ,iBAAA,CAAzB,QAAyB,CAAzB;AACH;;AACD,SAAA,gBAAA,GAAwBtnB,OAAO,CAAC,CAAA,eAAA,IAAoB,KAApD,iBAA+B,CAA/B;AACA,SAAA,cAAA,GAAsBwnB,oBAAoB,CAACF,QAAQ,CAAnD,cAA0C,CAA1C;AACA,SAAA,MAAA,GAAcA,QAAQ,CAAtB,MAAA;AACA,SAAA,OAAA,GAAeA,QAAQ,CAARA,MAAAA,CAAAA,IAAAA,CAAf,GAAA;AACA,SAAA,OAAA,GAAeA,QAAQ,CAARA,MAAAA,CAAAA,IAAAA,CAAf,GAAA;;AACA,QAAIA,QAAQ,CAARA,qBAAAA,KAAJ,KAAA,EAA8C;AAC1C,WAAA,OAAA,GAAA,CAAA;AACA,WAAA,OAAA,GAAA,CAAA;AACH;;AACD,QAAI,OAAOA,QAAQ,CAAf,QAAA,KAAJ,QAAA,EAA2C;AACvC,WAAA,OAAA,GAAeA,QAAQ,CAAvB,QAAA;AACH;;AACD,QAAI,OAAOA,QAAQ,CAAf,qBAAA,KAAJ,UAAA,EAA0D;AACtD,WAAA,cAAA,GAAsBA,QAAQ,CAA9B,qBAAA;AACH;;AACD,SAAA,SAAA,GAAiBA,QAAQ,CAARA,SAAAA,IAAAA,IAAAA,GAA6BA,QAAQ,CAArCA,SAAAA,GAAkDA,QAAQ,CAARA,MAAAA,CAAAA,OAAAA,CAAnE,SAAA;AACA,SAAA,YAAA,GAAoBA,QAAQ,CAA5B,YAAA;AAvBiC,GAAA,CAyBrC;;;AACAD,EAAAA,OAAO,CAAPA,SAAAA,CAAAA,YAAAA,GAAiC,UAAA,KAAA,EAAiB;AAC9C,QAAI7J,IAAI,GAAG,KAAA,gBAAA,CAAX,KAAW,CAAX;;AACA,QAAIA,IAAI,KAAR,IAAA,EAAmB;AACf,aAAA,IAAA;AACH;;AACD,WAAOA,IAAI,CAAX,MAAA;AALJ6J,GAAAA;;AAOAA,EAAAA,OAAO,CAAPA,SAAAA,CAAAA,eAAAA,GAAoC,YAAY;AAC5C,QAAI,KAAJ,gBAAA,EAA2B;AACvB,aAAO,KAAA,iBAAA,CAAuB,IAAA,IAAA,GAA9B,OAA8B,EAAvB,CAAP;AADJ,KAAA,MAGK;AACD;AACA;AACA,aAAOnyB,cAAc,CAACuyB,gBAAgB,CAAC,IAAvC,IAAuC,EAAD,CAAjB,CAArB;AACH;AARLJ,GAAAA;;AAUAA,EAAAA,OAAO,CAAPA,SAAAA,CAAAA,gBAAAA,GAAqC,UAAA,KAAA,EAAiB;AAClD,QAAI,OAAA,KAAA,KAAJ,QAAA,EAA+B;AAC3B,aAAO,KAAA,KAAA,CAAP,KAAO,CAAP;AACH;;AACD,QAAInxB,MAAM,GAAV,IAAA;;AACA,QAAI,OAAA,KAAA,KAAJ,QAAA,EAA+B;AAC3BA,MAAAA,MAAM,GAAG,KAAA,iBAAA,CAATA,KAAS,CAATA;AADJ,KAAA,MAGK,IAAIwD,KAAK,YAAT,IAAA,EAA2B;AAC5BA,MAAAA,KAAK,GAAGA,KAAK,CAAbA,OAAQA,EAARA;;AACA,UAAI,CAAC7C,KAAK,CAAV,KAAU,CAAV,EAAmB;AACfX,QAAAA,MAAM,GAAG,KAAA,iBAAA,CAATA,KAAS,CAATA;AACH;AAJA,KAAA,MAMA,IAAI7G,KAAK,CAALA,OAAAA,CAAJ,KAAIA,CAAJ,EAA0B;AAC3B6G,MAAAA,MAAM,GAAGhB,cAAc,CAAvBgB,KAAuB,CAAvBA;AACH;;AACD,QAAIA,MAAM,KAANA,IAAAA,IAAmB,CAACixB,WAAW,CAAnC,MAAmC,CAAnC,EAA6C;AACzC,aAAA,IAAA;AACH;;AACD,WAAO;AAAEjxB,MAAAA,MAAM,EAAR,MAAA;AAAkBkxB,MAAAA,iBAAiB,EAAnC,KAAA;AAA4Cxd,MAAAA,SAAS,EAAE;AAAvD,KAAP;AApBJyd,GAAAA;;AAsBAA,EAAAA,OAAO,CAAPA,SAAAA,CAAAA,KAAAA,GAA0B,UAAA,CAAA,EAAa;AACnC,QAAI/hB,KAAK,GAAG+Z,KAAK,CAAjB,CAAiB,CAAjB;;AACA,QAAI/Z,KAAK,KAAT,IAAA,EAAoB;AAChB,aAAA,IAAA;AACH;;AACD,QAAIpP,MAAM,GAAGoP,KAAK,CAAlB,MAAA;AACA,QAAIsE,SAAS,GAAb,IAAA;;AACA,QAAItE,KAAK,CAALA,cAAAA,KAAJ,IAAA,EAAmC;AAC/B,UAAI,KAAJ,gBAAA,EAA2B;AACvBpP,QAAAA,MAAM,GAAG,KAAA,iBAAA,CAAuBA,MAAM,CAANA,OAAAA,KAAmBoP,KAAK,CAALA,cAAAA,GAAAA,EAAAA,GAAnDpP,IAAS,CAATA;AADJ,OAAA,MAGK;AACD0T,QAAAA,SAAS,GAAGtE,KAAK,CAAjBsE,cAAAA;AACH;AACJ;;AACD,WAAO;AAAE1T,MAAAA,MAAM,EAAR,MAAA;AAAkBkxB,MAAAA,iBAAiB,EAAE9hB,KAAK,CAA1C,iBAAA;AAA8DsE,MAAAA,SAAS,EAAEA;AAAzE,KAAP;AAhFiC,GAiErCyd,CAjEqC,CAkFrC;;;AACAA,EAAAA,OAAO,CAAPA,SAAAA,CAAAA,OAAAA,GAA4B,UAAA,MAAA,EAAkB;AAC1C,WAAO,KAAA,cAAA,CAAA,aAAA,CAAP,MAAO,CAAP;AADJA,GAAAA;;AAGAA,EAAAA,OAAO,CAAPA,SAAAA,CAAAA,QAAAA,GAA6B,UAAA,MAAA,EAAkB;AAC3C,WAAO,KAAA,cAAA,CAAA,cAAA,CAAP,MAAO,CAAP;AAvFiC,GAsFrCA,CAtFqC,CAyFrC;;;AACAA,EAAAA,OAAO,CAAPA,SAAAA,CAAAA,GAAAA,GAAwB,UAAA,MAAA,EAAA,GAAA,EAAuB;AAC3C,QAAItyB,CAAC,GAAG,KAAA,cAAA,CAAA,aAAA,CAAR,MAAQ,CAAR;AACAA,IAAAA,CAAC,CAADA,CAAC,CAADA,IAAQ0C,GAAG,CAAX1C,KAAAA;AACAA,IAAAA,CAAC,CAADA,CAAC,CAADA,IAAQ0C,GAAG,CAAX1C,MAAAA;AACAA,IAAAA,CAAC,CAADA,CAAC,CAADA,IAAQ0C,GAAG,CAAX1C,IAAAA;AACAA,IAAAA,CAAC,CAADA,CAAC,CAADA,IAAQ0C,GAAG,CAAX1C,YAAAA;AACA,WAAO,KAAA,cAAA,CAAA,aAAA,CAAP,CAAO,CAAP;AANJsyB,GAAAA;;AAQAA,EAAAA,OAAO,CAAPA,SAAAA,CAAAA,QAAAA,GAA6B,UAAA,MAAA,EAAA,GAAA,EAAuB;AAChD,QAAItyB,CAAC,GAAG,KAAA,cAAA,CAAA,aAAA,CAAR,MAAQ,CAAR;AACAA,IAAAA,CAAC,CAADA,CAAC,CAADA,IAAQ0C,GAAG,CAAX1C,KAAAA;AACAA,IAAAA,CAAC,CAADA,CAAC,CAADA,IAAQ0C,GAAG,CAAX1C,MAAAA;AACAA,IAAAA,CAAC,CAADA,CAAC,CAADA,IAAQ0C,GAAG,CAAX1C,IAAAA;AACAA,IAAAA,CAAC,CAADA,CAAC,CAADA,IAAQ0C,GAAG,CAAX1C,YAAAA;AACA,WAAO,KAAA,cAAA,CAAA,aAAA,CAAP,CAAO,CAAP;AANJsyB,GAAAA;;AAQAA,EAAAA,OAAO,CAAPA,SAAAA,CAAAA,QAAAA,GAA6B,UAAA,MAAA,EAAA,CAAA,EAAqB;AAC9C,QAAItyB,CAAC,GAAG,KAAA,cAAA,CAAA,aAAA,CAAR,MAAQ,CAAR;AACAA,IAAAA,CAAC,CAADA,CAAC,CAADA,IAAAA,CAAAA;AACA,WAAO,KAAA,cAAA,CAAA,aAAA,CAAP,CAAO,CAAP;AAHJsyB,GAAAA;;AAKAA,EAAAA,OAAO,CAAPA,SAAAA,CAAAA,SAAAA,GAA8B,UAAA,MAAA,EAAA,CAAA,EAAqB;AAC/C,QAAItyB,CAAC,GAAG,KAAA,cAAA,CAAA,aAAA,CAAR,MAAQ,CAAR;AACAA,IAAAA,CAAC,CAADA,CAAC,CAADA,IAAAA,CAAAA;AACA,WAAO,KAAA,cAAA,CAAA,aAAA,CAAP,CAAO,CAAP;AAlHiC,GA+GrCsyB,CA/GqC,CAoHrC;;;AACAA,EAAAA,OAAO,CAAPA,SAAAA,CAAAA,cAAAA,GAAmC,UAAA,EAAA,EAAA,EAAA,EAAkB;AACjD,QAAI7f,cAAc,GAAG,KAArB,cAAA;;AACA,QAAIzR,QAAQ,CAARA,EAAQ,CAARA,KAAiBA,QAAQ,CAAzBA,EAAyB,CAAzBA,IACAyR,cAAc,CAAdA,YAAAA,CAAAA,EAAAA,MAAoCA,cAAc,CAAdA,YAAAA,CADpCzR,EACoCyR,CADpCzR,IAEAyR,cAAc,CAAdA,cAAAA,CAAAA,EAAAA,MAAsCA,cAAc,CAAdA,cAAAA,CAF1C,EAE0CA,CAF1C,EAE6E;AACzE,aAAOA,cAAc,CAAdA,aAAAA,CAAAA,EAAAA,IAAmCA,cAAc,CAAdA,aAAAA,CAA1C,EAA0CA,CAA1C;AACH;;AACD,WAAA,IAAA;AAPJ6f,GAAAA;;AASAA,EAAAA,OAAO,CAAPA,SAAAA,CAAAA,eAAAA,GAAoC,UAAA,EAAA,EAAA,EAAA,EAAkB;AAClD,QAAI7f,cAAc,GAAG,KAArB,cAAA;;AACA,QAAIzR,QAAQ,CAARA,EAAQ,CAARA,KAAiBA,QAAQ,CAAzBA,EAAyB,CAAzBA,IACAyR,cAAc,CAAdA,YAAAA,CAAAA,EAAAA,MAAoCA,cAAc,CAAdA,YAAAA,CADxC,EACwCA,CADxC,EACyE;AACrE,aAAQA,cAAc,CAAdA,cAAAA,CAAAA,EAAAA,IAAoCA,cAAc,CAAdA,cAAAA,CAArC,EAAqCA,CAApCA,GACJ,CAACA,cAAc,CAAdA,aAAAA,CAAAA,EAAAA,IAAmCA,cAAc,CAAdA,aAAAA,CAApC,EAAoCA,CAApC,IADJ,EAAA;AAEH;;AACD,WAAA,IAAA;AArIiC,GA8HrC6f,CA9HqC,CAuIrC;;;AACAA,EAAAA,OAAO,CAAPA,SAAAA,CAAAA,iBAAAA,GAAsC,UAAA,EAAA,EAAA,EAAA,EAAkB;AACpD,QAAIpyB,CAAC,GAAG,KAAA,cAAA,CAAA,EAAA,EAAR,EAAQ,CAAR;;AACA,QAAIA,CAAC,KAAL,IAAA,EAAgB;AACZ,aAAO;AAAEkC,QAAAA,IAAI,EAAN,MAAA;AAAgBc,QAAAA,KAAK,EAAEhD;AAAvB,OAAP;AACH;;AACDA,IAAAA,CAAC,GAAG,KAAA,eAAA,CAAA,EAAA,EAAJA,EAAI,CAAJA;;AACA,QAAIA,CAAC,KAAL,IAAA,EAAgB;AACZ,aAAO;AAAEkC,QAAAA,IAAI,EAAN,OAAA;AAAiBc,QAAAA,KAAK,EAAEhD;AAAxB,OAAP;AACH;;AACDA,IAAAA,CAAC,GAAGyyB,cAAc,CAAA,EAAA,EAAlBzyB,EAAkB,CAAlBA;;AACA,QAAIA,CAAC,KAAL,IAAA,EAAgB;AACZ,aAAO;AAAEkC,QAAAA,IAAI,EAAN,MAAA;AAAgBc,QAAAA,KAAK,EAAEhD;AAAvB,OAAP;AACH;;AACDA,IAAAA,CAAC,GAAGa,aAAa,CAAA,EAAA,EAAjBb,EAAiB,CAAjBA;;AACA,QAAIA,CAAC,KAAL,IAAA,EAAgB;AACZ,aAAO;AAAEkC,QAAAA,IAAI,EAAN,KAAA;AAAec,QAAAA,KAAK,EAAEhD;AAAtB,OAAP;AACH;;AACDA,IAAAA,CAAC,GAAG0yB,SAAS,CAAA,EAAA,EAAb1yB,EAAa,CAAbA;;AACA,QAAI8C,KAAK,CAAT,CAAS,CAAT,EAAc;AACV,aAAO;AAAEZ,QAAAA,IAAI,EAAN,MAAA;AAAgBc,QAAAA,KAAK,EAAEhD;AAAvB,OAAP;AACH;;AACDA,IAAAA,CAAC,GAAG2yB,WAAW,CAAA,EAAA,EAAf3yB,EAAe,CAAfA;;AACA,QAAI8C,KAAK,CAAT,CAAS,CAAT,EAAc;AACV,aAAO;AAAEZ,QAAAA,IAAI,EAAN,QAAA;AAAkBc,QAAAA,KAAK,EAAEhD;AAAzB,OAAP;AACH;;AACDA,IAAAA,CAAC,GAAG4yB,WAAW,CAAA,EAAA,EAAf5yB,EAAe,CAAfA;;AACA,QAAI8C,KAAK,CAAT,CAAS,CAAT,EAAc;AACV,aAAO;AAAEZ,QAAAA,IAAI,EAAN,QAAA;AAAkBc,QAAAA,KAAK,EAAEhD;AAAzB,OAAP;AACH;;AACD,WAAO;AAAEkC,MAAAA,IAAI,EAAN,aAAA;AAAuBc,MAAAA,KAAK,EAAE7C,EAAE,CAAFA,OAAAA,KAAeC,EAAE,CAAFA,OAAAA;AAA7C,KAAP;AA7BJgyB,GAAAA;;AA+BAA,EAAAA,OAAO,CAAPA,SAAAA,CAAAA,qBAAAA,GAA0C,UAAA,EAAA,EAAA,EAAA,EAAA,CAAA,EAAqB;AAC3D;AACA,QAAA,IAAA;;AACA,QAAIxxB,CAAC,CAAL,KAAA,EAAa;AACTyD,MAAAA,IAAI,GAAG,KAAA,cAAA,CAAA,EAAA,EAAPA,EAAO,CAAPA;;AACA,UAAIA,IAAI,KAAR,IAAA,EAAmB;AACf,eAAOA,IAAI,GAAGwuB,YAAY,CAA1B,CAA0B,CAA1B;AACH;AACJ;;AACD,QAAIjyB,CAAC,CAAL,MAAA,EAAc;AACVyD,MAAAA,IAAI,GAAG,KAAA,eAAA,CAAA,EAAA,EAAPA,EAAO,CAAPA;;AACA,UAAIA,IAAI,KAAR,IAAA,EAAmB;AACf,eAAOA,IAAI,GAAGyuB,aAAa,CAA3B,CAA2B,CAA3B;AACH;AACJ;;AACD,QAAIlyB,CAAC,CAAL,IAAA,EAAY;AACRyD,MAAAA,IAAI,GAAGxD,aAAa,CAAA,EAAA,EAApBwD,EAAoB,CAApBA;;AACA,UAAIA,IAAI,KAAR,IAAA,EAAmB;AACf,eAAOA,IAAI,GAAG5B,WAAW,CAAzB,CAAyB,CAAzB;AACH;AACJ;;AACD,WAAO,CAACtC,EAAE,CAAFA,OAAAA,KAAeC,EAAE,CAAlB,OAAgBA,EAAhB,IAAgCsC,SAAS,CAAhD,CAAgD,CAAhD;AA5LiC,GAuKrC0vB,CAvKqC,CA8LrC;;;AACAA,EAAAA,OAAO,CAAPA,SAAAA,CAAAA,OAAAA,GAA4B,UAAA,CAAA,EAAA,IAAA,EAAmB;AAC3C,QAAIlwB,IAAI,KAAR,MAAA,EAAqB;AACjB,aAAO,KAAA,WAAA,CAAP,CAAO,CAAP;AADJ,KAAA,MAGK,IAAIA,IAAI,KAAR,OAAA,EAAsB;AACvB,aAAO,KAAA,YAAA,CAAP,CAAO,CAAP;AADC,KAAA,MAGA,IAAIA,IAAI,KAAR,MAAA,EAAqB;AACtB,aAAO,KAAA,WAAA,CAAP,CAAO,CAAP;AADC,KAAA,MAGA,IAAIA,IAAI,KAAR,KAAA,EAAoB;AACrB,aAAO5B,UAAU,CAAjB,CAAiB,CAAjB;AADC,KAAA,MAGA,IAAI4B,IAAI,KAAR,MAAA,EAAqB;AACtB,aAAO6wB,WAAW,CAAlB,CAAkB,CAAlB;AADC,KAAA,MAGA,IAAI7wB,IAAI,KAAR,QAAA,EAAuB;AACxB,aAAO8wB,aAAa,CAApB,CAAoB,CAApB;AADC,KAAA,MAGA,IAAI9wB,IAAI,KAAR,QAAA,EAAuB;AACxB,aAAO+wB,aAAa,CAApB,CAAoB,CAApB;AACH;AArBLb,GAAAA;;AAuBAA,EAAAA,OAAO,CAAPA,SAAAA,CAAAA,WAAAA,GAAgC,UAAA,CAAA,EAAa;AACzC,WAAO,KAAA,cAAA,CAAA,aAAA,CAAkC,CACrC,KAAA,cAAA,CAAA,aAAA,CADJ,CACI,CADqC,CAAlC,CAAP;AADJA,GAAAA;;AAKAA,EAAAA,OAAO,CAAPA,SAAAA,CAAAA,YAAAA,GAAiC,UAAA,CAAA,EAAa;AAC1C,WAAO,KAAA,cAAA,CAAA,aAAA,CAAkC,CACrC,KAAA,cAAA,CAAA,aAAA,CADqC,CACrC,CADqC,EAErC,KAAA,cAAA,CAAA,cAAA,CAFJ,CAEI,CAFqC,CAAlC,CAAP;AADJA,GAAAA;;AAMAA,EAAAA,OAAO,CAAPA,SAAAA,CAAAA,WAAAA,GAAgC,UAAA,CAAA,EAAa;AACzC,WAAO,KAAA,cAAA,CAAA,aAAA,CAAkC,CACrC,KAAA,cAAA,CAAA,aAAA,CADqC,CACrC,CADqC,EAErC,KAAA,cAAA,CAAA,cAAA,CAFqC,CAErC,CAFqC,EAGrCrxB,CAAC,CAADA,UAAAA,KAAkB,CAACA,CAAC,CAADA,SAAAA,KAAgB,KAAhBA,OAAAA,GAAD,CAAA,IAHtB,CAAyC,CAAlC,CAAP;AAlOiC,GAiOrCqxB,CAjOqC,CAwOrC;;;AACAA,EAAAA,OAAO,CAAPA,SAAAA,CAAAA,iBAAAA,GAAsC,UAAA,MAAA,EAAkB;AACpD,QAAI,KAAJ,cAAA,EAAyB;AACrB,aAAO,KAAA,cAAA,CAAoB,KAAA,MAAA,CAA3B,MAA2B,CAApB,CAAP;AADJ,KAAA,MAGK;AACD,aAAOc,UAAU,CAAA,MAAA,EAAS,KAAT,OAAA,EAAuB,KAAxC,OAAiB,CAAjB;AACH;AA/OgC,GAyOrCd,CAzOqC,CAiPrC;;;AACAA,EAAAA,OAAO,CAAPA,SAAAA,CAAAA,MAAAA,GAA2B,UAAA,MAAA,EAAA,SAAA,EAAA,WAAA,EAA0C;AACjE,QAAIe,WAAW,KAAK,KAApB,CAAA,EAA4B;AAAEA,MAAAA,WAAW,GAAXA,EAAAA;AAAmB;;AACjD,WAAO,SAAS,CAAT,MAAA,CAAiB;AACpBlyB,MAAAA,MAAM,EADc,MAAA;AAEpB0Q,MAAAA,cAAc,EAAEwhB,WAAW,CAAXA,SAAAA,IAAAA,IAAAA,GACZA,WAAW,CADCA,SAAAA,GAEZ,KAAA,eAAA,CAAA,MAAA;AAJgB,KAAjB,EAAP,IAAO,CAAP;AAFJf,GAAAA;;AASAA,EAAAA,OAAO,CAAPA,SAAAA,CAAAA,WAAAA,GAAgC,UAAA,KAAA,EAAA,GAAA,EAAA,SAAA,EAAA,WAAA,EAA8C;AAC1E,QAAIe,WAAW,KAAK,KAApB,CAAA,EAA4B;AAAEA,MAAAA,WAAW,GAAXA,EAAAA;AAAmB;;AACjD,QAAIA,WAAW,CAAf,cAAA,EAAgC;AAC5BnsB,MAAAA,GAAG,GAAGosB,KAAK,CAAA,GAAA,EAAM,CAAjBpsB,CAAW,CAAXA;AACH;;AACD,WAAO,SAAS,CAAT,WAAA,CAAsB;AACzB/F,MAAAA,MAAM,EADmB,KAAA;AAEzB0Q,MAAAA,cAAc,EAAEwhB,WAAW,CAAXA,cAAAA,IAAAA,IAAAA,GACZA,WAAW,CADCA,cAAAA,GAEZ,KAAA,eAAA,CAAA,KAAA;AAJqB,KAAtB,EAKJ;AACClyB,MAAAA,MAAM,EADP,GAAA;AAEC0Q,MAAAA,cAAc,EAAEwhB,WAAW,CAAXA,YAAAA,IAAAA,IAAAA,GACZA,WAAW,CADCA,YAAAA,GAEZ,KAAA,eAAA,CAAA,GAAA;AAJL,KALI,EAAP,IAAO,CAAP;AALJf,GAAAA;;AAiBAA,EAAAA,OAAO,CAAPA,SAAAA,CAAAA,SAAAA,GAA8B,UAAA,MAAA,EAAA,YAAA,EAAgC;AAC1D,QAAIiB,YAAY,KAAK,KAArB,CAAA,EAA6B;AAAEA,MAAAA,YAAY,GAAZA,EAAAA;AAAoB;;AACnD,QAAI1hB,cAAc,GAAlB,IAAA;;AACA,QAAI,CAAC0hB,YAAY,CAAjB,kBAAA,EAAsC;AAClC,UAAIA,YAAY,CAAZA,SAAAA,IAAJ,IAAA,EAAoC;AAChC1hB,QAAAA,cAAc,GAAG0hB,YAAY,CAA7B1hB,SAAAA;AADJ,OAAA,MAGK;AACDA,QAAAA,cAAc,GAAG,KAAA,eAAA,CAAjBA,MAAiB,CAAjBA;AACH;AACJ;;AACD,WAAO2hB,cAAc,CAAA,MAAA,EAAA,cAAA,EAAyBD,YAAY,CAA1D,QAAqB,CAArB;AAvRiC,GA4QrCjB,CA5QqC,CAyRrC;;;AACAA,EAAAA,OAAO,CAAPA,SAAAA,CAAAA,iBAAAA,GAAsC,UAAA,EAAA,EAAc;AAChD,QAAI,KAAA,QAAA,KAAJ,OAAA,EAA+B;AAC3B,aAAOnyB,cAAc,CAACuyB,gBAAgB,CAAC,IAAA,IAAA,CAAvC,EAAuC,CAAD,CAAjB,CAArB;AADJ,KAAA,MAGK,IAAI,KAAA,QAAA,KAAA,KAAA,IAA2B,CAAC,KAAhC,iBAAA,EAAwD;AACzD,aAAO,IAAA,IAAA,CAAP,EAAO,CAAP;AADC,KAAA,MAGA;AACD,aAAOvyB,cAAc,CAAC,KAAA,iBAAA,CAAA,gBAAA,CAAtB,EAAsB,CAAD,CAArB;AACH;AATLmyB,GAAAA;;AAWAA,EAAAA,OAAO,CAAPA,SAAAA,CAAAA,eAAAA,GAAoC,UAAA,CAAA,EAAa;AAC7C,QAAI,KAAA,QAAA,KAAJ,OAAA,EAA+B;AAC3B,aAAO,CAACmB,gBAAgB,CAACxzB,cAAc,CAA/BwzB,CAA+B,CAAf,CAAhBA,CADmB,iBACnBA,EAAR,CAD2B,CACsC;AADrE,KAAA,MAGK,IAAI,KAAA,QAAA,KAAJ,KAAA,EAA6B;AAC9B,aAAA,CAAA;AADC,KAAA,MAGA,IAAI,KAAJ,iBAAA,EAA4B;AAC7B,aAAO,KAAA,iBAAA,CAAA,cAAA,CAAsCxzB,cAAc,CAA3D,CAA2D,CAApD,CAAP;AACH;;AACD,WAAA,IAAA;AA/SiC,GAqSrCqyB,CArSqC,CAiTrC;;;AACAA,EAAAA,OAAO,CAAPA,SAAAA,CAAAA,MAAAA,GAA2B,UAAA,CAAA,EAAA,SAAA,EAAwB;AAC/C,QAAI,KAAA,QAAA,KAAJ,OAAA,EAA+B;AAC3B,aAAOmB,gBAAgB,CAACxzB,cAAc,CAAtC,CAAsC,CAAf,CAAvB;AADJ,KAAA,MAGK,IAAI,KAAA,QAAA,KAAJ,KAAA,EAA6B;AAC9B,aAAO,IAAA,IAAA,CAASgB,CAAC,CADa,OACdA,EAAT,CAAP,CAD8B,CACA;AAD7B,KAAA,MAGA,IAAI,CAAC,KAAL,iBAAA,EAA6B;AAC9B,aAAO,IAAA,IAAA,CAASA,CAAC,CAADA,OAAAA,MAAe4T,SAAS,IAAxC,CAAgB5T,CAAT,CAAP;AADC,KAAA,MAGA;AACD,aAAO,IAAA,IAAA,CAASA,CAAC,CAADA,OAAAA,KACZ,KAAA,iBAAA,CAAA,cAAA,CAAsChB,cAAc,CAApD,CAAoD,CAApD,IAAA,IAAA,GADG,EAAA,CACkE;AADlE,OAAP;AAGH;AAdLqyB,GAAAA;;AAgBA,SAAA,OAAA;AAlUJ,CAA6B,EAA7B;;AAqUA,IAAIoB,mBAAmB,GAAG;AACtB7V,EAAAA,EAAE,EADoB,MAAA;AAEtBO,EAAAA,aAAa,EAFS,OAAA;AAGtBuV,EAAAA,kBAAkB,EAHI,QAAA;AAItBpQ,EAAAA,OAAO,EAJe,QAAA;AAKtBE,EAAAA,OAAO,EAAEmQ;AALa,CAA1B;AAOA,IAAIC,KAAK,GAAT,CAAA;;AACA,SAAA,mBAAA,CAAA,WAAA,EAAA,QAAA,EAAoD;AAChD,MAAIzpB,IAAI,GAAGD,QAAQ,CAARA,YAAAA,CAAAA,KAAAA,CAAX,eAAA;AACA,SAAO,CAACC,IAAI,CAACkB,WAAW,CAAhBlB,WAAI,CAAJA,CAAR,WAAA;AACH;;AACD,SAAA,gBAAA,CAAA,GAAA,EAAA,QAAA,EAAyC;AACrC,MAAIA,IAAI,GAAGD,QAAQ,CAARA,YAAAA,CAAAA,KAAAA,CAAX,eAAA;;AACA,OAAK,IAAIzP,CAAC,GAAG0P,IAAI,CAAJA,MAAAA,GAAb,CAAA,EAA8B1P,CAAC,IAA/B,CAAA,EAAsCA,CAAtC,EAAA,EAA2C;AAAE;AACzC,QAAI8P,GAAG,GAAGJ,IAAI,CAAd,CAAc,CAAd;AACA,QAAIqe,IAAI,GAAGje,GAAG,CAAHA,SAAAA,CAAX,GAAWA,CAAX;;AACA,QAAA,IAAA,EAAU;AACN,UAAIvO,GAAG,GAAG63B,qBAAqB,CAAC,OAAA,GAAA,KAAA,QAAA,GAAA,GAAA,GAAD,EAAA,EAAA,IAAA,EAAA,CAAA,EAA/B,QAA+B,CAA/B;AACA73B,MAAAA,GAAG,CAAHA,IAAAA,GAAAA,GAAAA;AACA,aAAA,GAAA;AACH;AACJ;;AACD,SAAA,IAAA;AACH;;AACD,SAAA,qBAAA,CAAA,GAAA,EAAA,IAAA,EAAA,WAAA,EAAA,QAAA,EAAiE;AAC7D,MAAIqiB,UAAU,GAAd,EAAA;AACA,MAAIziB,KAAK,GAAGmhB,WAAW,CAAA,GAAA,EAAA,mBAAA,EAAA,EAAA,EAAvB,UAAuB,CAAvB;AACA,MAAI0B,UAAU,GAAd,EAAA;AACA,MAAIpL,EAAE,GAAGmK,sBAAsB,CAAA,UAAA,EAAA,QAAA,EAA/B,UAA+B,CAA/B;AACA5hB,EAAAA,KAAK,CAALA,UAAAA,GAAAA,KAAAA;AACAA,EAAAA,KAAK,CAALA,aAAAA,GAAAA,EAAAA;AACAA,EAAAA,KAAK,CAALA,UAAAA,GAAAA,IAAAA;AACAA,EAAAA,KAAK,CAALA,QAAAA,GAAiB2J,MAAM,CAACoX,GAAG,CAAHA,EAAAA,IAAxB/gB,EAAuB,CAAvBA;AACAA,EAAAA,KAAK,CAALA,QAAAA,GAAiB2J,MAAM,CAACquB,KAAxBh4B,EAAuB,CAAvBA;AACAA,EAAAA,KAAK,CAALA,WAAAA,GAAAA,WAAAA;AACAA,EAAAA,KAAK,CAALA,IAAAA,GAAAA,IAAAA;AACAA,EAAAA,KAAK,CAALA,EAAAA,GAAAA,EAAAA;AACAA,EAAAA,KAAK,CAALA,aAAAA,GAAAA,UAAAA;AACA,SAAA,KAAA;AACH;;AAED,SAAA,kBAAA,CAAA,YAAA,EAAA,MAAA,EAAA,WAAA,EAAA,QAAA,EAA0E;AACtE,UAAQ8b,MAAM,CAAd,IAAA;AACI,SAAA,mBAAA;AAA0B;AACtB,aAAOoc,UAAU,CAAA,YAAA,EAAepc,MAAM,CAArB,OAAA,EAA+BI,WAAW,GAAGA,WAAW,CAAd,WAAA,GAA1C,IAAA,EAAjB,QAAiB,CAAjB;;AACJ,SAAA,qBAAA;AACI,aAAOic,YAAY,CAAA,YAAA,EAAerc,MAAM,CAAxC,QAAmB,CAAnB;;AACJ,SALJ,MAKI,CALJ,CAKiB;;AACb,SAAA,MAAA;AACA,SAAA,UAAA;AACA,SAAA,eAAA;AACI,UAAA,WAAA,EAAiB;AACb,eAAOsc,iBAAiB,CAAA,YAAA,EAAelc,WAAW,CAA1B,WAAA,EAAxB,QAAwB,CAAxB;AADJ,OAAA,MAGK;AACD,eAAA,YAAA;AACH;;AACL,SAAA,qBAAA;AACA,SAAA,iBAAA;AACI,aAAOmc,iBAAiB,CAAA,YAAA,EAAevc,MAAM,CAANA,SAAAA,GACnCuT,WAAW,CAACvT,MAAM,CADiBA,SACxB,CADwBA,GAEnCwc,oBAAoB,CAAA,YAAA,EAFA,QAEA,CAFA,EAE0Bpc,WAAW,GAAGA,WAAW,CAAd,WAAA,GAFrC,IAAA,EAAxB,QAAwB,CAAxB;;AAGJ,SAAA,gBAAA;AACA,SAAA,qBAAA;AACI,aAAOqc,eAAe,CAAA,YAAA,EAAezc,MAAM,CAArB,QAAA,EAAgCA,MAAM,CAAtC,OAAA,EAAgDA,MAAM,CAA5E,UAAsB,CAAtB;;AACJ,SAAA,0BAAA;AACI,aAAA,EAAA;;AACJ;AACI,aAAA,YAAA;AA1BR;AA4BH;;AACD,IAAI0c,KAAK,GAAT,CAAA;;AACA,SAAA,UAAA,CAAA,eAAA,EAAA,OAAA,EAAA,UAAA,EAAA,QAAA,EAAoE;AAChE,MAAI9qB,IAAI,GAAR,EAAA;;AACA,OAAK,IAAIxD,EAAE,GAAN,CAAA,EAAYuuB,SAAS,GAA1B,OAAA,EAAsCvuB,EAAE,GAAGuuB,SAAS,CAApD,MAAA,EAA6DvuB,EAA7D,EAAA,EAAmE;AAC/D,QAAIuZ,MAAM,GAAGgV,SAAS,CAAtB,EAAsB,CAAtB;AACA/qB,IAAAA,IAAI,CAAC+V,MAAM,CAAX/V,QAAI,CAAJA,GAAAA,MAAAA;AACH;;AACD,MAAA,UAAA,EAAgB;AACZA,IAAAA,IAAI,GAAG0qB,iBAAiB,CAAA,IAAA,EAAA,UAAA,EAAxB1qB,QAAwB,CAAxBA;AACH;;AACD,SAAOrB,OAAQ,CAAA,EAAA,EAAA,eAAA,EAAf,IAAe,CAAf;AACH;;AACD,SAAA,YAAA,CAAA,eAAA,EAAA,QAAA,EAAiD;AAC7C,SAAOoC,UAAU,CAAA,eAAA,EAAkB,UAAA,WAAA,EAAuB;AACtD,WAAOgB,WAAW,CAAXA,QAAAA,KAAP,QAAA;AADJ,GAAiB,CAAjB;AAGH;;AACD,SAAA,iBAAA,CAAA,UAAA,EAAA,UAAA,EAAA,QAAA,EAA6D;AACzD,SAAO4oB,iBAAiB,CAAA,UAAA,EAAa5pB,UAAU,CAAA,UAAA,EAAa,UAAA,WAAA,EAAuB;AAC/E,WAAOiqB,aAAa,CAAA,WAAA,EAAA,UAAA,EAApB,QAAoB,CAApB;AADoB,GAAuB,CAAvB,EAAA,UAAA,EAAxB,QAAwB,CAAxB;AAGH;;AACD,SAAA,aAAA,CAAA,WAAA,EAAA,UAAA,EAAA,QAAA,EAA0D;AACtD,MAAI,CAACC,mBAAmB,CAAA,WAAA,EAAxB,QAAwB,CAAxB,EAAiD;AAC7C,WAAO,CAAClpB,WAAW,CAAnB,aAAA;AADJ,GAAA,MAGK;AACD,WAAO,CAACnB,QAAQ,CAARA,GAAAA,CAAD,cAACA,CAAD,IACH,CAACmB,WAAW,CADT,UAAA,IAEHmpB,UAAU,CAAVA,KAAAA,GAAmBnpB,WAAW,CAAXA,UAAAA,CAFhB,KAAA,IAGHmpB,UAAU,CAAVA,GAAAA,GAAiBnpB,WAAW,CAAXA,UAAAA,CAHrB,GAAA;AAIH;AACJ;;AACD,SAAA,iBAAA,CAAA,WAAA,EAAA,YAAA,EAAA,UAAA,EAAA,QAAA,EAA4E;AACxE,MAAIopB,WAAW,GAAf,EAAA;;AACA,OAAK,IAAL,QAAA,IAAA,WAAA,EAAkC;AAC9B,QAAIpV,MAAM,GAAGqV,WAAW,CAAxB,QAAwB,CAAxB;;AACA,QAAIC,YAAY,CAAhB,QAAgB,CAAhB,EAA4B;AACxBF,MAAAA,WAAW,CAAXA,QAAW,CAAXA,GAAwBG,WAAW,CAAA,MAAA,EAAA,UAAA,EAAnCH,QAAmC,CAAnCA;AADJ,KAAA,MAGK;AACDA,MAAAA,WAAW,CAAXA,QAAW,CAAXA,GAAAA,MAAAA;AACH;AACJ;;AACD,SAAA,WAAA;AACH;;AACD,SAAA,WAAA,CAAA,WAAA,EAAA,UAAA,EAAA,QAAA,EAAwD;AACpD,MAAII,SAAS,GAAG3qB,QAAQ,CAARA,YAAAA,CAAAA,KAAAA,CAAAA,eAAAA,CAA4CmB,WAAW,CAAvE,WAAgBnB,CAAhB;AACA,MAAImO,OAAO,GAAG9S,MAAM,CAAC6uB,KAArB,EAAoB,CAApB;AACAS,EAAAA,SAAS,CAATA,KAAAA,CAAgB;AACZxpB,IAAAA,WAAW,EADC,WAAA;AAEZnB,IAAAA,QAAQ,EAFI,QAAA;AAGZoC,IAAAA,KAAK,EAAEkoB;AAHK,GAAhBK,EAIG,UAAA,GAAA,EAAe;AACd,QAAIvpB,SAAS,GAAGtP,GAAG,CAAnB,SAAA;AACA,QAAI84B,UAAU,GAAG5qB,QAAQ,CAARA,GAAAA,CAAjB,oBAAiBA,CAAjB;AACA,QAAA,aAAA;AACA,QAAA,gBAAA;;AACA,QAAImB,WAAW,CAAf,OAAA,EAAyB;AACrB0pB,MAAAA,gBAAgB,GAAG1pB,WAAW,CAAXA,OAAAA,CAAAA,SAAAA,EAA+BrP,GAAG,CAArD+4B,GAAmB1pB,CAAnB0pB;AACH;;AACD,QAAA,UAAA,EAAgB;AACZC,MAAAA,aAAa,GAAGF,UAAU,CAAA,SAAA,EAAY94B,GAAG,CAAzCg5B,GAA0B,CAA1BA;AACH;;AACD1pB,IAAAA,SAAS,GAAGypB,gBAAgB,IAAhBA,aAAAA,IAAZzpB,SAAAA;AACApB,IAAAA,QAAQ,CAARA,QAAAA,CAAkB;AACd0I,MAAAA,IAAI,EADU,gBAAA;AAEdC,MAAAA,QAAQ,EAAExH,WAAW,CAFP,QAAA;AAGdgN,MAAAA,OAAO,EAHO,OAAA;AAIdmc,MAAAA,UAAU,EAJI,UAAA;AAKdlpB,MAAAA,SAAS,EAAEA;AALG,KAAlBpB;AAhBJ2qB,GAAAA,EAuBG,UAAA,KAAA,EAAiB;AAChB,QAAII,WAAW,GAAG/qB,QAAQ,CAARA,GAAAA,CAAlB,oBAAkBA,CAAlB;AACAglB,IAAAA,OAAO,CAAPA,IAAAA,CAAagG,KAAK,CAAlBhG,OAAAA,EAAAA,KAAAA;;AACA,QAAI7jB,WAAW,CAAf,OAAA,EAAyB;AACrBA,MAAAA,WAAW,CAAXA,OAAAA,CAAAA,KAAAA;AACH;;AACD,QAAA,WAAA,EAAiB;AACb4pB,MAAAA,WAAW,CAAXA,KAAW,CAAXA;AACH;;AACD/qB,IAAAA,QAAQ,CAARA,QAAAA,CAAkB;AACd0I,MAAAA,IAAI,EADU,qBAAA;AAEdC,MAAAA,QAAQ,EAAExH,WAAW,CAFP,QAAA;AAGdgN,MAAAA,OAAO,EAHO,OAAA;AAIdmc,MAAAA,UAAU,EAJI,UAAA;AAKdU,MAAAA,KAAK,EAAEA;AALO,KAAlBhrB;AAhCJ2qB,GAAAA;AAwCA,SAAO5sB,OAAQ,CAAA,EAAA,EAAA,WAAA,EAAkB;AAAEktB,IAAAA,UAAU,EAAZ,IAAA;AAAoBC,IAAAA,aAAa,EAAE/c;AAAnC,GAAlB,CAAf;AACH;;AACD,SAAA,eAAA,CAAA,UAAA,EAAA,QAAA,EAAA,OAAA,EAAA,UAAA,EAAoE;AAChE,MAAA,EAAA;;AACA,MAAIhN,WAAW,GAAGgqB,UAAU,CAA5B,QAA4B,CAA5B;;AACA,MAAIhqB,WAAW,IAAI;AACfgN,EAAAA,OAAO,KAAKhN,WAAW,CAD3B,aAAA,EAC2C;AACvC,WAAOpD,OAAQ,CAAA,EAAA,EAAA,UAAA,GAAkB,EAAE,GAAF,EAAA,EAAS/F,EAAE,CAAFA,QAAE,CAAFA,GAAe+F,OAAQ,CAAA,EAAA,EAAA,WAAA,EAAkB;AAAEktB,MAAAA,UAAU,EAAZ,KAAA;AAAqBX,MAAAA,UAAU,EAAEA;AAAjC,KAAlB,CAAhC,EAAjC,EAAe,EAAf;AACH;;AACD,SAAA,UAAA;AACH;;AACD,SAAA,oBAAA,CAAA,YAAA,EAAA,QAAA,EAAsD;AAClD,SAAOnqB,UAAU,CAAA,YAAA,EAAe,UAAA,WAAA,EAAuB;AACnD,WAAOkqB,mBAAmB,CAAA,WAAA,EAA1B,QAA0B,CAA1B;AADJ,GAAiB,CAAjB;AAGH;;AAED,IAAIe,oBAAoB;AAAG;AAAe,YAAY;AAClD,WAAA,oBAAA,CAAA,QAAA,EAAA,QAAA,EAAkD;AAC9C,SAAA,QAAA,GAAA,QAAA;AACA,SAAA,OAAA,GAAeC,QAAQ,CAAvB,OAAA;AACA,SAAA,OAAA,GAAerrB,QAAQ,CAAvB,OAAA;AACA,SAAA,QAAA,GAAA,QAAA;AACA,SAAA,cAAA;AACH;AACD;AACJ;AACI;;;AACAorB,EAAAA,oBAAoB,CAApBA,SAAAA,CAAAA,SAAAA,GAA2C,UAAA,kBAAA,EAAA,WAAA,EAA2C;AAClF,QAAI3tB,OAAO,GAAG,KAAd,OAAA;AACA,QAAI6tB,QAAQ,GAAG7tB,OAAO,CAAPA,QAAAA,CAAiBA,OAAO,CAAPA,OAAAA,CAAAA,WAAAA,EAA6B8tB,kBAAkB,CAAhE9tB,gBAAiBA,CAAjBA,EAAoF;AACnG8tB,IAAAA,kBAAkB,CADlB,aAAe9tB,CAAf;AAEA,WAAO,KAAA,KAAA,CAAA,QAAA,EAAqB,CAA5B,CAAO,CAAP;AAf8C,GAWlD2tB,CAXkD,CAiBlD;;;AACAA,EAAAA,oBAAoB,CAApBA,SAAAA,CAAAA,SAAAA,GAA2C,UAAA,kBAAA,EAAA,WAAA,EAA2C;AAClF,QAAI3tB,OAAO,GAAG,KAAd,OAAA;AACA,QAAI+tB,QAAQ,GAAG/tB,OAAO,CAAPA,GAAAA,CAAYA,OAAO,CAAPA,OAAAA,CAAAA,WAAAA,EAA6B8tB,kBAAkB,CAA3D9tB,gBAAYA,CAAZA,EAA+E;AAC9F8tB,IAAAA,kBAAkB,CADlB,aAAe9tB,CAAf;AAEA,WAAO,KAAA,KAAA,CAAA,QAAA,EAAP,CAAO,CAAP;AAtB8C,GAkBlD2tB,CAlBkD,CAwBlD;AACA;AACA;;;AACAA,EAAAA,oBAAoB,CAApBA,SAAAA,CAAAA,KAAAA,GAAuC,UAAA,WAAA,EAAA,SAAA,EAAA,YAAA,EAAgD;AACnF,QAAIK,YAAY,KAAK,KAArB,CAAA,EAA6B;AAAEA,MAAAA,YAAY,GAAZA,KAAAA;AAAuB;;AACtD,QAAA,UAAA;AACA,QAAIxI,OAAO,GAAX,IAAA;AACA,QAAIC,OAAO,GAAX,IAAA;AACA,QAAA,WAAA;AACA,QAAA,aAAA;AACA,QAAA,WAAA;AACA,QAAA,WAAA;AACA,QAAA,OAAA;AACAwI,IAAAA,UAAU,GAAG,KAAbA,eAAa,EAAbA;AACAA,IAAAA,UAAU,GAAG,KAAA,cAAA,CAAbA,UAAa,CAAbA;;AACA,QAAA,YAAA,EAAkB;AACdC,MAAAA,WAAW,GAAGC,sBAAsB,CAAA,WAAA,EAApCD,UAAoC,CAApCA;AACH;;AACDE,IAAAA,WAAW,GAAG,KAAA,qBAAA,CAAA,WAAA,EAAdA,SAAc,CAAdA;AACAC,IAAAA,aAAa,GAAG,0BAAA,IAAA,CAA+BD,WAAW,CAA1DC,IAAgB,CAAhBA;AACAC,IAAAA,WAAW,GAAG,KAAA,gBAAA,CAAsB,KAAA,cAAA,CAAoBF,WAAW,CAArD,KAAsB,CAAtB,EAA8DA,WAAW,CAAzE,IAAA,EAAdE,aAAc,CAAdA;AACAA,IAAAA,WAAW,GAAG,KAAA,cAAA,CAAdA,WAAc,CAAdA;AACAC,IAAAA,WAAW,GAAXA,WAAAA;;AACA,QAAI,CAAC,KAAA,OAAA,CAAL,mBAAA,EAAuC;AACnCA,MAAAA,WAAW,GAAGvgB,eAAe,CAAA,WAAA,EAAcogB,WAAW,CAAtDG,KAA6B,CAA7BA;AACH;;AACD/I,IAAAA,OAAO,GAAG/lB,cAAc,CAAC,KAAA,OAAA,CAAzB+lB,OAAwB,CAAxBA;AACAC,IAAAA,OAAO,GAAGhmB,cAAc,CAAC,KAAA,OAAA,CAAzBgmB,OAAwB,CAAxBA;AACA8I,IAAAA,WAAW,GAAG,KAAA,iBAAA,CAAA,WAAA,EAAA,OAAA,EAAdA,OAAc,CAAdA;AACAA,IAAAA,WAAW,GAAGvgB,eAAe,CAAA,WAAA,EA1BsD,UA0BtD,CAA7BugB,CA1BmF,CA0B3B;AACxD;AACA;;AACAC,IAAAA,OAAO,GAAGnb,eAAe,CAAC+a,WAAW,CAAZ,KAAA,EAAzBI,UAAyB,CAAzBA;AACA,WAAO;AACH;AACA;AACAP,MAAAA,UAAU,EAHP,UAAA;AAIH;AACA;AACAQ,MAAAA,YAAY,EAAEL,WAAW,CANtB,KAAA;AAOH;AACAM,MAAAA,gBAAgB,EAAEN,WAAW,CAR1B,IAAA;AASHC,MAAAA,aAAa,EATV,aAAA;AAUH;AACA;AACAE,MAAAA,WAAW,EAZR,WAAA;AAaH;AACA;AACAD,MAAAA,WAAW,EAfR,WAAA;AAgBH;AACA9I,MAAAA,OAAO,EAjBJ,OAAA;AAkBH;AACAC,MAAAA,OAAO,EAnBJ,OAAA;AAoBH+I,MAAAA,OAAO,EApBJ,OAAA;AAqBH;AACAG,MAAAA,aAAa,EAAE,KAAA,kBAAA,CAAwBP,WAAW,CAtB/C,QAsBY,CAtBZ,CAuBH;;AAvBG,KAAP;AAzD8C,GA2BlDT,CA3BkD,CAmFlD;AACA;AACA;;;AACAA,EAAAA,oBAAoB,CAApBA,SAAAA,CAAAA,eAAAA,GAAiD,YAAY;AACzD,WAAO,KAAA,cAAA,CAAA,YAAA,EAAkC,KAAA,QAAA,CAAlC,MAAkC,EAAlC,KACH;AAAEtuB,MAAAA,KAAK,EAAP,IAAA;AAAeC,MAAAA,GAAG,EAAE;AAApB,KADJ,CADyD,CAEzB;AAxFc,GAsFlDquB,CAtFkD,CA0FlD;AACA;AACA;AACA;;;AACAA,EAAAA,oBAAoB,CAApBA,SAAAA,CAAAA,qBAAAA,GAAuD,UAAA,IAAA,EAAA,SAAA,EAA2B;AAC9E,QAAIpzB,EAAE,GAAN,IAAA;AAAA,QAAeqzB,QAAQ,GAAGrzB,EAAE,CAA5B,QAAA;AAAA,QAAuCyF,OAAO,GAAGzF,EAAE,CAAnD,OAAA;;AACA,QAAIqG,QAAQ,GAAZ,IAAA;AACA,QAAIpG,IAAI,GAAR,IAAA;AACA,QAAImK,KAAK,GAAT,IAAA;AACA,QAAA,QAAA;;AACA,QAAIipB,QAAQ,CAAZ,QAAA,EAAuB;AACnBhtB,MAAAA,QAAQ,GAAGgtB,QAAQ,CAAnBhtB,QAAAA;AACApG,MAAAA,IAAI,GAAGozB,QAAQ,CAAfpzB,YAAAA;AACAmK,MAAAA,KAAK,GAAG,KAAA,sBAAA,CAAA,IAAA,EAAA,SAAA,EAAA,QAAA,EAARA,IAAQ,CAARA;AAHJ,KAAA,MAKK,IAAKiqB,QAAQ,GAAG,KAAA,OAAA,CAAhB,QAAA,EAAwC;AACzCp0B,MAAAA,IAAI,GAAJA,KAAAA;AACAmK,MAAAA,KAAK,GAAG,KAAA,sBAAA,CAAA,IAAA,EAAA,SAAA,EAARA,QAAQ,CAARA;AAFC,KAAA,MAIA,IAAKA,KAAK,GAAG,KAAA,uBAAA,CAAb,IAAa,CAAb,EAAkD;AACnDnK,MAAAA,IAAI,GAAGwF,OAAO,CAAPA,iBAAAA,CAA0B2E,KAAK,CAA/B3E,KAAAA,EAAuC2E,KAAK,CAA5C3E,GAAAA,EAAPxF,IAAAA;AADC,KAAA,MAGA;AACDoG,MAAAA,QAAQ,GAAG,KAAXA,mBAAW,EAAXA;AACApG,MAAAA,IAAI,GAAGq0B,2BAA2B,CAA3BA,QAA2B,CAA3BA,CAAPr0B,IAAAA;AACAmK,MAAAA,KAAK,GAAG,KAAA,sBAAA,CAAA,IAAA,EAAA,SAAA,EAAA,QAAA,EAARA,IAAQ,CAARA;AACH;;AACD,WAAO;AAAE/D,MAAAA,QAAQ,EAAV,QAAA;AAAsBpG,MAAAA,IAAI,EAA1B,IAAA;AAAkCmK,MAAAA,KAAK,EAAEA;AAAzC,KAAP;AAvBJgpB,GAAAA;;AAyBAA,EAAAA,oBAAoB,CAApBA,SAAAA,CAAAA,mBAAAA,GAAqD,YAAY;AAC7D,WAAOluB,cAAc,CAAC;AAAEuG,MAAAA,GAAG,EAAE;AAAP,KAAD,CAArB;AAxH8C,GAuHlD2nB,CAvHkD,CA0HlD;AACA;;;AACAA,EAAAA,oBAAoB,CAApBA,SAAAA,CAAAA,iBAAAA,GAAmD,UAAA,KAAA,EAAA,OAAA,EAAA,OAAA,EAAmC;AAClF,QAAI3tB,OAAO,GAAG,KAAd,OAAA;AACA,QAAIX,KAAK,GAAGsF,KAAK,CAAjB,KAAA;AACA,QAAIrF,GAAG,GAAGqF,KAAK,CAAf,GAAA;;AACA,QAAI,KAAA,QAAA,CAAA,KAAA,CAAA,SAAA,CAAJ,cAAA,EAAkD;AAC9C;AACA,UAAI5J,WAAW,CAAXA,OAAW,CAAXA,GAAJ,CAAA,EAA8B;AAC1BsE,QAAAA,KAAK,GAAGzG,UAAU,CADQ,KACR,CAAlByG,CAD0B,CACC;;AAC3BA,QAAAA,KAAK,GAAGW,OAAO,CAAPA,GAAAA,CAAAA,KAAAA,EAARX,OAAQW,CAARX;AAJ0C,OAAA,CAM9C;;;AACA,UAAItE,WAAW,CAAXA,OAAW,CAAXA,GAAJ,CAAA,EAA8B;AAC1BuE,QAAAA,GAAG,GAAG1G,UAAU,CADU,GACV,CAAhB0G,CAD0B,CACH;;AACvBA,QAAAA,GAAG,GAAGC,OAAO,CAAA,GAAA,EAAM,CAAnBD,CAAa,CAAbA;AACAA,QAAAA,GAAG,GAAGU,OAAO,CAAPA,GAAAA,CAAAA,GAAAA,EAANV,OAAMU,CAANV;AACH;AACJ;;AACD,WAAO;AAAED,MAAAA,KAAK,EAAP,KAAA;AAAgBC,MAAAA,GAAG,EAAEA;AAArB,KAAP;AA7I8C,GA4HlDquB,CA5HkD,CA+IlD;AACA;;;AACAA,EAAAA,oBAAoB,CAApBA,SAAAA,CAAAA,sBAAAA,GAAwD,UAAA,IAAA,EAAA,SAAA,EAAA,QAAA,EAAA,IAAA,EAA2C;AAC/F,QAAI3tB,OAAO,GAAG,KAAd,OAAA;AACA,QAAI8uB,SAAS,GAAG,KAAA,OAAA,CAAhB,aAAA;AACA,QAAA,kBAAA;AACA,QAAA,qBAAA;AACA,QAAA,KAAA;AACA,QAAA,GAAA;AACA,QAP+F,GAO/F,CAP+F,CAQ/F;;AACA,QAAI,CAAJ,SAAA,EAAgB;AACZC,MAAAA,kBAAkB,GAAG,KAAA,OAAA,CAArBA,aAAAA;;AACA,UAAA,kBAAA,EAAwB;AACpBC,QAAAA,qBAAqB,GAAGvvB,cAAc,CADlB,kBACkB,CAAtCuvB,CADoB,CAEpB;;AACA,YAAIh0B,SAAS,CAATA,qBAAS,CAATA,GAAmCA,SAAS,CAAhD,QAAgD,CAAhD,EAA4D;AACxD8zB,UAAAA,SAAS,GAAGD,2BAA2B,CAAA,qBAAA,EAAwB,CAACl0B,iBAAiB,CAArEk0B,kBAAqE,CAA1C,CAA3BA,CAAZC,IAAAA;AADJ,SAAA,MAGK;AACDA,UAAAA,SAAS,GAATA,IAAAA;AACH;AARL,OAAA,MAUK;AACDA,QAAAA,SAAS,GAATA,IAAAA;AACH;AAvB0F,KAAA,CAyB/F;;;AACA,QAAI/zB,WAAW,CAAXA,QAAW,CAAXA,IAAJ,CAAA,EAAgC;AAC5B,UAAI,KAAA,WAAA,CAAJ,KAAI,CAAJ,EAA6B;AACzBsE,QAAAA,KAAK,GAAG,KAAA,cAAA,CAAA,KAAA,EAARA,SAAQ,CAARA;AACAA,QAAAA,KAAK,GAAGzG,UAAU,CAAlByG,KAAkB,CAAlBA;AACH;AACJ;;AACD,aAAA,UAAA,GAAsB;AAClBA,MAAAA,KAAK,GAAGW,OAAO,CAAPA,OAAAA,CAAAA,IAAAA,EAARX,SAAQW,CAARX;AACAC,MAAAA,GAAG,GAAGU,OAAO,CAAPA,GAAAA,CAAAA,KAAAA,EAANV,QAAMU,CAANV;AACAjL,MAAAA,GAAG,GAAG;AAAEgL,QAAAA,KAAK,EAAP,KAAA;AAAgBC,QAAAA,GAAG,EAAEA;AAArB,OAANjL;AACH;;AACD46B,IAAAA,UArC+F,GAAA,CAsC/F;;AACA,QAAI,CAAC,KAAA,cAAA,CAAL,GAAK,CAAL,EAA+B;AAC3Bj1B,MAAAA,IAAI,GAAG,KAAA,cAAA,CAAA,IAAA,EAAPA,SAAO,CAAPA;AACAi1B,MAAAA,UAAU;AACb;;AACD,WAAA,GAAA;AA5L8C,GAiJlDtB,CAjJkD,CA8LlD;;;AACAA,EAAAA,oBAAoB,CAApBA,SAAAA,CAAAA,sBAAAA,GAAwD,UAAA,IAAA,EAAA,SAAA,EAAA,QAAA,EAAqC;AACzF,QAAI3tB,OAAO,GAAG,KAAd,OAAA;AACA,QAAIkvB,eAAe,GAAG,KAAA,OAAA,CAAtB,aAAA;AACA,QAAIC,YAAY,GAAhB,CAAA;AACA,QAAI9vB,KAAK,GAAT,IAAA;AACA,QAAA,GAAA;;AACA,QAAA,eAAA,EAAqB;AACjBA,MAAAA,KAAK,GAAGW,OAAO,CAAPA,OAAAA,CAAAA,KAAAA,EAARX,eAAQW,CAARX;AACH;;AACDA,IAAAA,KAAK,GAAGzG,UAAU,CAAlByG,KAAkB,CAAlBA;AACAA,IAAAA,KAAK,GAAG,KAAA,cAAA,CAAA,KAAA,EAARA,SAAQ,CAARA;AACAC,IAAAA,GAAG,GAAHA,KAAAA;;AACA,OAAG;AACCA,MAAAA,GAAG,GAAGC,OAAO,CAAA,GAAA,EAAbD,CAAa,CAAbA;;AACA,UAAI,CAAC,KAAA,WAAA,CAAL,GAAK,CAAL,EAA4B;AACxB6vB,QAAAA,YAAY;AACf;AAJL,KAAA,QAKSA,YAAY,GALrB,QAAA;;AAMA,WAAO;AAAE9vB,MAAAA,KAAK,EAAP,KAAA;AAAgBC,MAAAA,GAAG,EAAEA;AAArB,KAAP;AAjN8C,GA+LlDquB,CA/LkD,CAmNlD;AACA;;;AACAA,EAAAA,oBAAoB,CAApBA,SAAAA,CAAAA,uBAAAA,GAAyD,UAAA,IAAA,EAAgB;AACrE,QAAI3tB,OAAO,GAAG,KAAd,OAAA;AACA,QAAIH,YAAY,GAAG,KAAA,cAAA,CAAA,cAAA,EAAoCG,OAAO,CAAPA,MAAAA,CAAvD,IAAuDA,CAApC,CAAnB;;AACA,QAAIH,YAAY,KAAKA,YAAY,CAAZA,KAAAA,IAAAA,IAAAA,IAA8BA,YAAY,CAAZA,GAAAA,IAAnD,IAAgB,CAAhB,EAA8E;AAC1E,aAAA,IAAA;AACH;;AACD,WAAA,YAAA;AA3N8C,GAqNlD8tB,CArNkD,CA6NlD;AACA;AACA;;;AACAA,EAAAA,oBAAoB,CAApBA,SAAAA,CAAAA,gBAAAA,GAAkD,UAAA,YAAA,EAAA,gBAAA,EAAA,aAAA,EAAyD;AACvG,WAAA,YAAA;AAjO8C,GAgOlDA,CAhOkD,CAmOlD;AACA;;;AACAA,EAAAA,oBAAoB,CAApBA,SAAAA,CAAAA,kBAAAA,GAAoD,UAAA,QAAA,EAAoB;AACpE,QAAIoB,kBAAkB,GAAG,KAAA,OAAA,CAAzB,aAAA;AACA,QAAA,eAAA;;AACA,QAAA,kBAAA,EAAwB;AACpB,aAAOtvB,cAAc,CAArB,kBAAqB,CAArB;AADJ,KAAA,MAGK,IAAKyvB,eAAe,GAAG,KAAA,OAAA,CAAvB,aAAA,EAAoD;AACrD,aAAOzvB,cAAc,CAAA,CAAA,EAArB,eAAqB,CAArB;AADC,KAAA,MAGA,IAAA,QAAA,EAAc;AACf,aAAA,QAAA;AADC,KAAA,MAGA;AACD,aAAOA,cAAc,CAAC;AAAEzG,QAAAA,IAAI,EAAE;AAAR,OAAD,CAArB;AACH;AAnP6C,GAqOlD20B,CArOkD,CAqPlD;AACA;AACA;;;AACAA,EAAAA,oBAAoB,CAApBA,SAAAA,CAAAA,cAAAA,GAAgD,UAAA,IAAA,EAAgB;AAC5D,QAAIyB,SAAS,GAAb,EAAA;;AACA,SAAK,IAAIjxB,EAAE,GAAX,CAAA,EAAiBA,EAAE,GAAGC,SAAS,CAA/B,MAAA,EAAwCD,EAAxC,EAAA,EAA8C;AAC1CixB,MAAAA,SAAS,CAACjxB,EAAE,GAAZixB,CAAS,CAATA,GAAoBhxB,SAAS,CAA7BgxB,EAA6B,CAA7BA;AACH;;AACD,QAAIl7B,GAAG,GAAG,KAAA,OAAA,CAAV,IAAU,CAAV;;AACA,QAAI,OAAA,GAAA,KAAJ,UAAA,EAA+B;AAC3BA,MAAAA,GAAG,GAAGA,GAAG,CAAHA,KAAAA,CAAAA,IAAAA,EAANA,SAAMA,CAANA;AACH;;AACD,QAAA,GAAA,EAAS;AACLA,MAAAA,GAAG,GAAGm7B,UAAU,CAAA,GAAA,EAAM,KAAtBn7B,OAAgB,CAAhBA;AACH;;AACD,QAAA,GAAA,EAAS;AACLA,MAAAA,GAAG,GAAG4L,sBAAsB,CAA5B5L,GAA4B,CAA5BA;AACH;;AACD,WAAA,GAAA;AAfJy5B,GAAAA;AAiBA;AACJ;AACI;;;AACAA,EAAAA,oBAAoB,CAApBA,SAAAA,CAAAA,cAAAA,GAAgD,YAAY;AACxD,QAAI2B,UAAU,GAAG,KAAA,OAAA,CAAA,UAAA,IADuC,EACxD,CADwD,CACR;;AAChD,QAAIC,eAAe,GAFqC,EAExD,CAFwD,CAE9B;;AAC1B,QAAIpwB,MAAM,GAAV,CAAA;AACA,QAAA,CAAA;;AACA,QAAI,KAAA,OAAA,CAAA,QAAA,KAAJ,KAAA,EAAqC;AACjCmwB,MAAAA,UAAU,CAAVA,IAAAA,CAAAA,CAAAA,EADiC,CACjCA,EADiC,CACV;AAC1B;;AACD,SAAKx8B,CAAC,GAAN,CAAA,EAAYA,CAAC,GAAb,CAAA,EAAmBA,CAAnB,EAAA,EAAwB;AACpB,UAAI,EAAEy8B,eAAe,CAAfA,CAAe,CAAfA,GAAqBD,UAAU,CAAVA,OAAAA,CAAAA,CAAAA,MAA0B,CAArD,CAAI,CAAJ,EAA0D;AACtDnwB,QAAAA,MAAM;AACT;AACJ;;AACD,QAAI,CAAJ,MAAA,EAAa;AACT,YAAM,IAAA,KAAA,CADG,oBACH,CAAN,CADS,CAC8B;AAC1C;;AACD,SAAA,eAAA,GAAA,eAAA;AA5R8C,GA4QlDwuB,CA5QkD,CA8RlD;AACA;;;AACAA,EAAAA,oBAAoB,CAApBA,SAAAA,CAAAA,cAAAA,GAAgD,UAAA,KAAA,EAAiB;AAC7D,QAAItuB,KAAK,GAAGsF,KAAK,CAAjB,KAAA;AACA,QAAIrF,GAAG,GAAGqF,KAAK,CAAf,GAAA;;AACA,QAAA,KAAA,EAAW;AACPtF,MAAAA,KAAK,GAAG,KAAA,cAAA,CAARA,KAAQ,CAARA;AACH;;AACD,QAAA,GAAA,EAAS;AACLC,MAAAA,GAAG,GAAG,KAAA,cAAA,CAAA,GAAA,EAAyB,CAAzB,CAAA,EAANA,IAAM,CAANA;AACH;;AACD,QAAID,KAAK,IAALA,IAAAA,IAAiBC,GAAG,IAApBD,IAAAA,IAAgCA,KAAK,GAAzC,GAAA,EAAiD;AAC7C,aAAO;AAAEA,QAAAA,KAAK,EAAP,KAAA;AAAgBC,QAAAA,GAAG,EAAEA;AAArB,OAAP;AACH;;AACD,WAAA,IAAA;AA5S8C,GAgSlDquB,CAhSkD,CA8SlD;AACA;;;AACAA,EAAAA,oBAAoB,CAApBA,SAAAA,CAAAA,WAAAA,GAA6C,UAAA,GAAA,EAAe;AACxD,QAAI3nB,GAAG,YAAP,IAAA,EAAyB;AACrBA,MAAAA,GAAG,GAAGA,GAAG,CAATA,SAAMA,EAANA;AACH;;AACD,WAAO,KAAA,eAAA,CAAP,GAAO,CAAP;AApT8C,GAgTlD2nB,CAhTkD,CAsTlD;AACA;AACA;AACA;AACA;;;AACAA,EAAAA,oBAAoB,CAApBA,SAAAA,CAAAA,cAAAA,GAAgD,UAAA,IAAA,EAAA,GAAA,EAAA,WAAA,EAAkC;AAC9E,QAAI6B,GAAG,KAAK,KAAZ,CAAA,EAAoB;AAAEA,MAAAA,GAAG,GAAHA,CAAAA;AAAU;;AAChC,QAAIC,WAAW,KAAK,KAApB,CAAA,EAA4B;AAAEA,MAAAA,WAAW,GAAXA,KAAAA;AAAsB;;AACpD,WAAO,KAAA,eAAA,CAAqB,CAACz1B,IAAI,CAAJA,SAAAA,MAAoBy1B,WAAW,GAAA,GAAA,GAA/Bz1B,CAAAA,IAAD,CAAA,IAA5B,CAAO,CAAP,EAAmF;AAC/EA,MAAAA,IAAI,GAAGuF,OAAO,CAAA,IAAA,EAAdvF,GAAc,CAAdA;AACH;;AACD,WAAA,IAAA;AANJ2zB,GAAAA;;AAQA,SAAA,oBAAA;AAnUJ,CAA0C,EAA1C,C,CAqUA;;;AACA,SAAA,mBAAA,CAAA,EAAA,EAAA,EAAA,EAAqC;AACjC,SAAO+B,WAAW,CAACC,EAAE,CAAH,UAAA,EAAgBC,EAAE,CAA7BF,UAAW,CAAXA,IACHA,WAAW,CAACC,EAAE,CAAH,WAAA,EAAiBC,EAAE,CAD3BF,WACQ,CADRA,IAEHA,WAAW,CAACC,EAAE,CAAH,WAAA,EAAiBC,EAAE,CAF3BF,WAEQ,CAFRA,IAGHhjB,cAAc,CAACijB,EAAE,CAAH,OAAA,EAAaC,EAAE,CAH1BF,OAGW,CAHXA,IAIHhjB,cAAc,CAACijB,EAAE,CAAH,OAAA,EAAaC,EAAE,CAJjC,OAIkB,CAJlB;AAKA;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACC;;AAED,SAAA,MAAA,CAAA,KAAA,EAAA,MAAA,EAAA,QAAA,EAA0C;AACtC,MAAIC,QAAQ,GAAGC,cAAc,CAAC5d,KAAK,CAAN,QAAA,EAA7B,MAA6B,CAA7B;AACA,MAAI/B,WAAW,GAAG4f,iBAAiB,CAAC7d,KAAK,CAAN,WAAA,EAAA,MAAA,EAA4BA,KAAK,CAAjC,WAAA,EAAA,QAAA,EAAnC,QAAmC,CAAnC;AACA,MAAIjC,YAAY,GAAG+f,kBAAkB,CAAC9d,KAAK,CAAN,YAAA,EAAA,MAAA,EAAA,WAAA,EAArC,QAAqC,CAArC;;AACA,MAAI+d,SAAS,GAAG3vB,OAAQ,CAAA,EAAA,EAAA,KAAA,EAAY;AAAEuvB,IAAAA,QAAQ,EAAV,QAAA;AAChC1f,IAAAA,WAAW,EADqB,WAAA;AACN+d,IAAAA,WAAW,EAAEgC,iBAAiB,CAAChe,KAAK,CAAN,WAAA,EAAA,MAAA,EADxB,WACwB,CADxB;AACkEjC,IAAAA,YAAY,EAD9E,YAAA;AAC8FjO,IAAAA,UAAU,EAAEmuB,gBAAgB,CAACje,KAAK,CAAN,UAAA,EAAA,MAAA,EAAA,YAAA,EAAA,WAAA,EAD1H,QAC0H,CAD1H;AAC2LL,IAAAA,aAAa,EAAEue,mBAAmB,CAACle,KAAK,CAAN,aAAA,EAAA,MAAA,EAD7N,QAC6N,CAD7N;AACsQH,IAAAA,cAAc,EAAEse,mBAAmB,CAACne,KAAK,CAAN,cAAA,EADzS,MACyS,CADzS;AACyUP,IAAAA,SAAS,EAAE2e,eAAe,CAACpe,KAAK,CAAN,SAAA,EAAA,MAAA,EAAA,YAAA,EADnW,QACmW,CADnW;AACsZF,IAAAA,WAAW,EAAEue,iBAAiB,CAACre,KAAK,CAAN,WAAA,EAAA,MAAA,EAAA,YAAA,EADpb,QACob,CADpb;AACyese,IAAAA,uBAAuB,EAAEC,mBAAmB,CADrhB,YACqhB,CADrhB;AACqiBC,IAAAA,YAAY,EAAED,mBAAmB,CAAA,YAAA;AADtkB,GAAZ,CAAxB;;AAEA,OAAK,IAAItyB,EAAE,GAAN,CAAA,EAAY5D,EAAE,GAAGgI,QAAQ,CAARA,YAAAA,CAAAA,KAAAA,CAAtB,QAAA,EAA4DpE,EAAE,GAAG5D,EAAE,CAAnE,MAAA,EAA4E4D,EAA5E,EAAA,EAAkF;AAC9E,QAAIwyB,WAAW,GAAGp2B,EAAE,CAApB,EAAoB,CAApB;AACA01B,IAAAA,SAAS,GAAGU,WAAW,CAAA,SAAA,EAAA,MAAA,EAAvBV,QAAuB,CAAvBA;AARkC,GAAA,CAUtC;;;AACA,SAAA,SAAA;AACH;;AACD,SAAA,cAAA,CAAA,eAAA,EAAA,MAAA,EAAiD;AAC7C,UAAQlgB,MAAM,CAAd,IAAA;AACI,SAAA,eAAA;AACI,aAAOA,MAAM,CAAb,QAAA;;AACJ;AACI,aAAA,eAAA;AAJR;AAMH;;AACD,SAAA,iBAAA,CAAA,kBAAA,EAAA,MAAA,EAAA,WAAA,EAAA,QAAA,EAAA,QAAA,EAAwF;AACpF,MAAA,cAAA;;AACA,UAAQA,MAAM,CAAd,IAAA;AACI,SAAA,MAAA;AACI6gB,MAAAA,cAAc,GAAGruB,QAAQ,CAARA,qBAAAA,CAAAA,QAAAA,EAAAA,SAAAA,CAAAA,kBAAAA,EAAjBquB,WAAiBruB,CAAjBquB;AACA;;AACJ,SAAA,MAAA;AACIA,MAAAA,cAAc,GAAGruB,QAAQ,CAARA,qBAAAA,CAAAA,QAAAA,EAAAA,SAAAA,CAAAA,kBAAAA,EAAjBquB,WAAiBruB,CAAjBquB;AACA;;AACJ,SAAA,UAAA;AACI,UAAI,CAAC9C,kBAAkB,CAAnB,WAAA,IACA,CAACzS,mBAAmB,CAACyS,kBAAkB,CAAnB,YAAA,EAAkC/d,MAAM,CADhE,UACwB,CADxB,EAC8E;AAC1E6gB,QAAAA,cAAc,GAAG,QAAQ,CAAR,qBAAA,CAAA,QAAA,EAAA,KAAA,CAA+C7gB,MAAM,CAArD,UAAA,EAAA,SAAA,EAAA,IAAA,CAAkF;AAAlF,SAAjB6gB;AAEH;;AACD;;AACJ,SAAA,eAAA;AACI,UAAIC,SAAS,GAAGtuB,QAAQ,CAARA,qBAAAA,CAAhB,QAAgBA,CAAhB;;AACA,UAAI,CAAJ,SAAA,EAAgB;AACZ,cAAM,IAAA,KAAA,CAAUstB,QAAQ,GACpB,4BAAA,QAAA,GADoB,gEAAA,GAAxB,yCAAM,CAAN;AAGH;;AACDe,MAAAA,cAAc,GAAG,SAAS,CAAT,KAAA,CAAgB7gB,MAAM,CAANA,UAAAA,IAAhB,WAAA,EAAA,SAAA,EAAA,IAAA,CAAkE;AAAlE,OAAjB6gB;AAEA;AAvBR;;AAyBA,MAAIA,cAAc,IACdA,cAAc,CADdA,OAAAA,IAEA,EAAE9C,kBAAkB,IAAIgD,mBAAmB,CAAA,kBAAA,EAF/C,cAE+C,CAA3C,CAFJ,EAEsF;AAClF,WAAA,cAAA;AAHJ,GAAA,MAKK;AACD,WAAA,kBAAA;AACH;AACJ;;AACD,SAAA,iBAAA,CAAA,WAAA,EAAA,MAAA,EAAA,WAAA,EAA6D;AACzD,UAAQ/gB,MAAM,CAAd,IAAA;AACI,SAAA,MAAA;AACA,SAAA,MAAA;AACI,UAAI,CAACsL,mBAAmB,CAAClL,WAAW,CAAZ,YAAA,EAAxB,WAAwB,CAAxB,EAAiE;AAC7D,eAAOA,WAAW,CAAXA,YAAAA,CAAP,KAAA;AADJ,OAAA,MAGK;AACD,eAAA,WAAA;AACH;;AACL,SAAA,UAAA;AACA,SAAA,eAAA;AACI,UAAI4gB,OAAO,GAAGhhB,MAAM,CAANA,UAAAA,IAAd,WAAA;;AACA,UAAII,WAAW,CAAXA,WAAAA,IAA2B,CAACkL,mBAAmB,CAAClL,WAAW,CAAZ,WAAA,EAAnD,OAAmD,CAAnD,EAAuF;AACnF,eAAOA,WAAW,CAAXA,YAAAA,CAAP,KAAA;AADJ,OAAA,MAGK;AACD,eAAA,OAAA;AACH;;AACL;AACI,aAAA,WAAA;AAnBR;AAqBH;;AACD,SAAA,mBAAA,CAAA,gBAAA,EAAA,MAAA,EAAA,QAAA,EAAiE;AAC7D,UAAQJ,MAAM,CAAd,IAAA;AACI,SAAA,cAAA;AACI,aAAOA,MAAM,CAAb,SAAA;;AACJ,SAAA,gBAAA;AACI,aAAA,IAAA;;AACJ;AACI,aAAA,gBAAA;AANR;AAQH;;AACD,SAAA,mBAAA,CAAA,iBAAA,EAAA,MAAA,EAAwD;AACpD,UAAQA,MAAM,CAAd,IAAA;AACI,SAAA,cAAA;AACI,aAAOA,MAAM,CAAb,eAAA;;AACJ,SAAA,gBAAA;AACI,aAAA,EAAA;;AACJ;AACI,aAAA,iBAAA;AANR;AAQH;;AACD,SAAA,eAAA,CAAA,WAAA,EAAA,MAAA,EAAA,OAAA,EAAA,QAAA,EAAiE;AAC7D,UAAQA,MAAM,CAAd,IAAA;AACI,SAAA,gBAAA;AACI,UAAIihB,OAAO,GAAGjhB,MAAM,CAApB,KAAA;AACA,aAAO;AACHsK,QAAAA,cAAc,EAAE2W,OAAO,CADpB,cAAA;AAEH1W,QAAAA,aAAa,EAAE0W,OAAO,CAFnB,aAAA;AAGHzW,QAAAA,OAAO,EAAEyW,OAAO,CAHb,OAAA;AAIHxW,QAAAA,OAAO,EAAEwW,OAAO,CAACxW;AAJd,OAAP;;AAMJ,SAAA,kBAAA;AACI,aAAA,IAAA;;AACJ;AACI,aAAA,WAAA;AAZR;AAcH;;AACD,SAAA,iBAAA,CAAA,aAAA,EAAA,MAAA,EAAA,OAAA,EAAA,QAAA,EAAqE;AACjE,UAAQzK,MAAM,CAAd,IAAA;AACI,SAAA,kBAAA;AACI,UAAIkhB,SAAS,GAAGlhB,MAAM,CAAtB,KAAA;AACA,aAAO;AACHsK,QAAAA,cAAc,EAAE4W,SAAS,CADtB,cAAA;AAEH3W,QAAAA,aAAa,EAAE2W,SAAS,CAFrB,aAAA;AAGH1W,QAAAA,OAAO,EAAE0W,SAAS,CAHf,OAAA;AAIHzW,QAAAA,OAAO,EAAEyW,SAAS,CAACzW;AAJhB,OAAP;;AAMJ,SAAA,oBAAA;AACI,aAAA,IAAA;;AACJ;AACI,aAAA,aAAA;AAZR;AAcH;;AACD,SAAA,mBAAA,CAAA,YAAA,EAA2C;AACvC,MAAI0W,GAAG,GAAP,CAAA;;AACA,OAAK,IAAL,QAAA,IAAA,YAAA,EAAmC;AAC/B,QAAIjhB,YAAY,CAAZA,QAAY,CAAZA,CAAJ,UAAA,EAAuC;AACnCihB,MAAAA,GAAG;AACN;AACJ;;AACD,SAAA,GAAA;AACH;;AAED,IAAIC,cAAc,GAAG;AACjB9xB,EAAAA,KAAK,EADY,IAAA;AAEjBC,EAAAA,GAAG,EAFc,IAAA;AAGjBqB,EAAAA,MAAM,EAAE0C;AAHS,CAArB;;AAKA,SAAA,aAAA,CAAA,GAAA,EAAA,OAAA,EAAA,eAAA,EAAsD;AAClD,MAAI+tB,IAAI,GAAGC,iBAAiB,CAAA,GAAA,EAA5B,OAA4B,CAA5B;AACA,MAAI1sB,KAAK,GAAGysB,IAAI,CAAhB,KAAA;;AACA,MAAI,CAACzsB,KAAK,CAAV,KAAA,EAAkB;AACd,WAAA,IAAA;AACH;;AACD,MAAI,CAACA,KAAK,CAAV,GAAA,EAAgB;AACZ,QAAI2sB,eAAe,IAAnB,IAAA,EAA6B;AACzB,aAAA,IAAA;AADJ,KAAA,MAGK;AACD3sB,MAAAA,KAAK,CAALA,GAAAA,GAAY3E,OAAO,CAAPA,GAAAA,CAAY2E,KAAK,CAAjB3E,KAAAA,EAAZ2E,eAAY3E,CAAZ2E;AACH;AACJ;;AACD,SAAA,IAAA;AACH;AACD;AACA;AACA;AACA;;;AACA,SAAA,iBAAA,CAAA,GAAA,EAAA,OAAA,EAAyC;AACrC,MAAIiR,SAAS,GAAb,EAAA;AACA,MAAInK,aAAa,GAAG2J,WAAW,CAAA,GAAA,EAAA,cAAA,EAAA,EAAA,EAA/B,SAA+B,CAA/B;AACA,MAAImC,SAAS,GAAG9L,aAAa,CAAbA,KAAAA,GAAsBzL,OAAO,CAAPA,gBAAAA,CAAyByL,aAAa,CAA5DA,KAAsBzL,CAAtByL,GAAhB,IAAA;AACA,MAAI+L,OAAO,GAAG/L,aAAa,CAAbA,GAAAA,GAAoBzL,OAAO,CAAPA,gBAAAA,CAAyByL,aAAa,CAA1DA,GAAoBzL,CAApByL,GAAd,IAAA;AACA,MAAI9K,MAAM,GAAG8K,aAAa,CAA1B,MAAA;;AACA,MAAI9K,MAAM,IAAV,IAAA,EAAoB;AAChBA,IAAAA,MAAM,GAAI4W,SAAS,IAAIA,SAAS,CAAvB,iBAACA,KACL,CAAA,OAAA,IAAYC,OAAO,CADxB7W,iBAAU4W,CAAV5W;AAPiC,GAAA,CAUrC;;;AACAiV,EAAAA,SAAS,CAATA,KAAAA,GAAkB;AACdvW,IAAAA,KAAK,EAAEkY,SAAS,GAAGA,SAAS,CAAZ,MAAA,GADF,IAAA;AAEdjY,IAAAA,GAAG,EAAEkY,OAAO,GAAGA,OAAO,CAAV,MAAA,GAAoB;AAFlB,GAAlB5B;AAIAA,EAAAA,SAAS,CAATA,MAAAA,GAAAA,MAAAA;AACA,SAAA,SAAA;AACH;;AACD,SAAA,gBAAA,CAAA,KAAA,EAAA,KAAA,EAAwC;AACpC,SAAO8Z,WAAW,CAAC6B,KAAK,CAAN,KAAA,EAAcC,KAAK,CAA9B9B,KAAW,CAAXA,IACH6B,KAAK,CAALA,MAAAA,KAAiBC,KAAK,CADnB9B,MAAAA,IAEH+B,gBAAgB,CAAA,KAAA,EAFpB,KAEoB,CAFpB;EAIJ;;;AACA,SAAA,gBAAA,CAAA,KAAA,EAAA,KAAA,EAAwC;AACpC,OAAK,IAAL,QAAA,IAAA,KAAA,EAA4B;AACxB,QAAI7H,QAAQ,KAARA,OAAAA,IAAwBA,QAAQ,KAApC,QAAA,EAAmD;AAC/C,UAAI2H,KAAK,CAALA,QAAK,CAALA,KAAoBC,KAAK,CAA7B,QAA6B,CAA7B,EAAyC;AACrC,eAAA,KAAA;AACH;AACJ;AAN+B,GAAA,CAQpC;AACA;;;AACA,OAAK,IAAL,QAAA,IAAA,KAAA,EAA4B;AACxB,QAAI,EAAE5H,QAAQ,IAAd,KAAI,CAAJ,EAA0B;AACtB,aAAA,KAAA;AACH;AACJ;;AACD,SAAA,IAAA;AACH;;AACD,SAAA,gBAAA,CAAA,IAAA,EAAA,OAAA,EAAyC;AACrC,SAAO;AACHvqB,IAAAA,KAAK,EAAEW,OAAO,CAAPA,MAAAA,CAAeoxB,IAAI,CAAJA,KAAAA,CADnB,KACIpxB,CADJ;AAEHV,IAAAA,GAAG,EAAEU,OAAO,CAAPA,MAAAA,CAAeoxB,IAAI,CAAJA,KAAAA,CAFjB,GAEEpxB,CAFF;AAGHkhB,IAAAA,QAAQ,EAAE,OAAO,CAAP,SAAA,CAAkBkQ,IAAI,CAAJA,KAAAA,CAAlB,KAAA,EAAoC;AAAErW,MAAAA,QAAQ,EAAEqW,IAAI,CAACzwB;AAAjB,KAApC,CAHP;AAIHwgB,IAAAA,MAAM,EAAE,OAAO,CAAP,SAAA,CAAkBiQ,IAAI,CAAJA,KAAAA,CAAlB,GAAA,EAAkC;AAAErW,MAAAA,QAAQ,EAAEqW,IAAI,CAACzwB;AAAjB,KAAlC,CAJL;AAKHA,IAAAA,MAAM,EAAEywB,IAAI,CAACzwB;AALV,GAAP;AAOH;;AACD,SAAA,iBAAA,CAAA,IAAA,EAAA,OAAA,EAA0C;AACtC,SAAO;AACH3G,IAAAA,IAAI,EAAEgG,OAAO,CAAPA,MAAAA,CAAeoxB,IAAI,CAAJA,KAAAA,CADlB,KACGpxB,CADH;AAEH0xB,IAAAA,OAAO,EAAE,OAAO,CAAP,SAAA,CAAkBN,IAAI,CAAJA,KAAAA,CAAlB,KAAA,EAAoC;AAAErW,MAAAA,QAAQ,EAAEqW,IAAI,CAACzwB;AAAjB,KAApC,CAFN;AAGHA,IAAAA,MAAM,EAAEywB,IAAI,CAACzwB;AAHV,GAAP;AAKH;;AACD,SAAA,mBAAA,CAAA,QAAA,EAAA,YAAA,EAAA,QAAA,EAA+D;AAC3D,MAAIiC,GAAG,GAAGiU,aAAa,CAAC;AAAE5B,IAAAA,QAAQ,EAAE;AAAZ,GAAD,EAAA,EAAA,EAA0B;AACjD0c,EAAAA,QAAQ,CADe,MAAA,EAAA,IAAA,EACA;AADvB,EAAA,QAAuB,CAAvB;AAGA,SAAO;AACH/uB,IAAAA,GAAG,EADA,GAAA;AAEH8I,IAAAA,EAAE,EAAEwD,cAAc,CAAA,GAAA,EAFf,YAEe,CAFf;AAGHvM,IAAAA,QAAQ,EAAEK,mBAAmB,CAACJ,GAAG,CAAJ,KAAA,EAAY+uB,QAAQ,CAH9C,KAG0B,CAH1B;AAIHhtB,IAAAA,KAAK,EAAEgtB,QAAQ,CAJZ,KAAA;AAKH1jB,IAAAA,OAAO,EALJ,IAAA;AAMHC,IAAAA,KAAK,EAAE;AANJ,GAAP;AAQH;;AAED,SAAA,eAAA,CAAA,cAAA,EAAA,eAAA,EAA0D;AACtD,MAAIvM,IAAI,GAAR,EAAA;AACA,MAAA,QAAA;;AACA,OAAA,QAAA,IAAA,cAAA,EAAiC;AAC7BiwB,IAAAA,aAAa,CAAA,QAAA,EAAA,IAAA,EAAA,cAAA,EAAbA,eAAa,CAAbA;AACH;;AACD,OAAA,QAAA,IAAA,eAAA,EAAkC;AAC9BA,IAAAA,aAAa,CAAA,QAAA,EAAA,IAAA,EAAA,cAAA,EAAbA,eAAa,CAAbA;AACH;;AACD,SAAA,IAAA;AACH;;AACD,SAAA,aAAA,CAAA,QAAA,EAAA,IAAA,EAAA,cAAA,EAAA,eAAA,EAAwE;AACpE,MAAIjwB,IAAI,CAAR,QAAQ,CAAR,EAAoB;AAChB,WAAOA,IAAI,CAAX,QAAW,CAAX;AACH;;AACD,MAAIkwB,OAAO,GAAGC,YAAY,CAAA,QAAA,EAAA,IAAA,EAAA,cAAA,EAA1B,eAA0B,CAA1B;;AACA,MAAA,OAAA,EAAa;AACTnwB,IAAAA,IAAI,CAAJA,QAAI,CAAJA,GAAAA,OAAAA;AACH;;AACD,SAAA,OAAA;AACH;;AACD,SAAA,YAAA,CAAA,QAAA,EAAA,IAAA,EAAA,cAAA,EAAA,eAAA,EAAuE;AACnE,MAAIowB,aAAa,GAAGC,cAAc,CAAlC,QAAkC,CAAlC;AACA,MAAIC,cAAc,GAAGC,eAAe,CAApC,QAAoC,CAApC;;AACA,MAAIC,SAAS,GAAG,SAAZA,SAAY,CAAA,IAAA,EAAgB;AAC5B,WAAQJ,aAAa,IAAIA,aAAa,CAAbA,IAAa,CAAbA,KAAlB,IAACA,GAAiDA,aAAa,CAA/D,IAA+D,CAA9DA,GACFE,cAAc,IAAIA,cAAc,CAAdA,IAAc,CAAdA,KAAnB,IAACA,GAAmDA,cAAc,CAAlE,IAAkE,CAAjEA,GADN,IAAA;AADJ,GAAA;;AAIA,MAAIG,QAAQ,GAAGD,SAAS,CAAxB,OAAwB,CAAxB;AACA,MAAIE,SAAS,GAAGF,SAAS,CAAzB,WAAyB,CAAzB;;AACA,MAAI,CAAA,SAAA,IAAJ,QAAA,EAA4B;AACxBE,IAAAA,SAAS,GACLC,sBAAsB,CAAA,QAAA,EAAtBA,eAAsB,CAAtBA,IACIA,sBAAsB,CAAA,QAAA,EAF9BD,cAE8B,CAF9BA;AAGH;;AACD,MAAIE,QAAQ,GAAZ,IAAA;;AACA,MAAA,SAAA,EAAe;AACX,QAAIF,SAAS,KAAb,QAAA,EAA4B;AACxB,YAAM,IAAA,KAAA,CAAN,uDAAM,CAAN;AACH;;AACDE,IAAAA,QAAQ,GAAGX,aAAa,CAAA,SAAA,EAAA,IAAA,EAAA,cAAA,EAAxBW,eAAwB,CAAxBA;AACH;;AACD,MAAI,CAAA,QAAA,IAAJ,QAAA,EAA2B;AACvBH,IAAAA,QAAQ,GAAGG,QAAQ,CAAnBH,KAAAA;AACH;;AACD,MAAI,CAAJ,QAAA,EAAe;AACX,WADW,IACX,CADW,CACE;AAChB;;AACD,SAAO;AACHnnB,IAAAA,IAAI,EADD,QAAA;AAEHunB,IAAAA,KAAK,EAFF,QAAA;AAGH3zB,IAAAA,QAAQ,EAAEyB,OAAQ,CAAA,EAAA,EAAMiyB,QAAQ,GAAGA,QAAQ,CAAX,QAAA,GAAd,EAAA,EAA2CR,aAAa,GAAGA,aAAa,CAAhB,OAAA,GAHvE,EAGe,CAHf;AAIHU,IAAAA,SAAS,EAAEnyB,OAAQ,CAAA,EAAA,EAAMiyB,QAAQ,GAAGA,QAAQ,CAAX,SAAA,GAAd,EAAA,EAA4CN,cAAc,GAAGA,cAAc,CAAjB,OAAA,GAA1D,EAAA;AAJhB,GAAP;AAMH;;AACD,SAAA,sBAAA,CAAA,YAAA,EAAA,OAAA,EAAuD;AACnD,MAAIS,UAAU,GAAGtyB,MAAM,CAANA,cAAAA,CAAsBuyB,YAAY,CAAnD,SAAiBvyB,CAAjB;;AACA,OAAK,IAAL,QAAA,IAAA,OAAA,EAA8B;AAC1B,QAAIM,MAAM,GAAGkyB,OAAO,CADM,QACN,CAApB,CAD0B,CAE1B;;AACA,QAAIlyB,MAAM,CAANA,KAAAA,IAAgBA,MAAM,CAANA,KAAAA,CAAAA,SAAAA,KAApB,UAAA,EAA2D;AACvD,aAAA,QAAA;AACH;AACJ;;AACD,SAAA,EAAA;AACH;;AAED,SAAA,gBAAA,CAAA,MAAA,EAAkC;AAC9B,SAAOuO,OAAO,CAAA,MAAA,EAAd,eAAc,CAAd;AACH;;AACD,IAAI4jB,cAAc,GAAG;AACjB5nB,EAAAA,IAAI,EADa,MAAA;AAEjBunB,EAAAA,KAAK,EAAE;AAFU,CAArB;;AAIA,SAAA,eAAA,CAAA,KAAA,EAAgC;AAC5B,MAAI,OAAA,KAAA,KAAJ,UAAA,EAAiC;AAC7Bz1B,IAAAA,KAAK,GAAG;AAAEy1B,MAAAA,KAAK,EAAEz1B;AAAT,KAARA;AACH;;AACD,MAAIkM,OAAO,GAAX,EAAA;AACA,MAAIhV,KAAK,GAAGmhB,WAAW,CAAA,KAAA,EAAA,cAAA,EAAA,EAAA,EAAvB,OAAuB,CAAvB;AACA,SAAO;AACHid,IAAAA,SAAS,EAAEp+B,KAAK,CADb,IAAA;AAEHu+B,IAAAA,KAAK,EAAEv+B,KAAK,CAFT,KAAA;AAGHgV,IAAAA,OAAO,EAAEA;AAHN,GAAP;AAKH;;AAED,SAAA,cAAA,CAAA,aAAA,EAAA,cAAA,EAAuD;AACnD,MAAI+oB,cAAc,GAAGc,gBAAgB,CAArC,aAAqC,CAArC;AACA,MAAIZ,eAAe,GAAGY,gBAAgB,CAACC,cAAc,CAAdA,SAAAA,CAAvC,KAAsC,CAAtC;AACA,MAAIC,QAAQ,GAAGC,eAAe,CAAA,cAAA,EAA9B,eAA8B,CAA9B;AACA,SAAOhkB,OAAO,CAAA,QAAA,EAAW,UAAA,OAAA,EAAmB;AACxC,WAAOikB,aAAa,CAAA,OAAA,EAAA,eAAA,EAApB,cAAoB,CAApB;AADJ,GAAc,CAAd;AAGH;;AACD,SAAA,aAAA,CAAA,OAAA,EAAA,eAAA,EAAA,cAAA,EAAiE;AAC7D,MAAIC,aAAa,GAAGtB,OAAO,CAAPA,SAAAA,CAAAA,QAAAA,IAChBA,OAAO,CAAPA,QAAAA,CADgBA,QAAAA,IAEhBkB,cAAc,CAAdA,gBAAAA,CAFgBlB,QAAAA,IAGhBkB,cAAc,CAAdA,SAAAA,CAHJ,QAAA;AAIA,MAAInyB,QAAQ,GAAZ,IAAA;AACA,MAAIwyB,YAAY,GAAhB,EAAA;AACA,MAAIC,UAAU,GAAd,EAAA;AACA,MAAIC,mBAAmB,GAAvB,EAAA;;AACA,MAAA,aAAA,EAAmB;AACf1yB,IAAAA,QAAQ,GAAGnB,cAAc,CAAzBmB,aAAyB,CAAzBA;;AACA,QAAA,QAAA,EAAc;AAAE;AACZ,UAAI2yB,KAAK,GAAG1E,2BAA2B,CAAA,QAAA,EAAW,CAACl0B,iBAAiB,CAApE,aAAoE,CAA7B,CAAvC;AACAy4B,MAAAA,YAAY,GAAGG,KAAK,CAApBH,IAAAA;;AACA,UAAIG,KAAK,CAALA,KAAAA,KAAJ,CAAA,EAAuB;AACnBF,QAAAA,UAAU,GAAVA,YAAAA;AACAC,QAAAA,mBAAmB,GAAGpB,eAAe,CAAfA,YAAe,CAAfA,GAAgCA,eAAe,CAAfA,YAAe,CAAfA,CAAhCA,OAAAA,GAAtBoB,EAAAA;AACH;AACJ;AACJ;;AACD,MAAIE,eAAe,GAAG,SAAlBA,eAAkB,CAAA,OAAA,EAAmB;AACrC,QAAIC,aAAa,GAAGxqB,OAAO,CAAPA,UAAAA,IAApB,EAAA;AACA,QAAIyqB,aAAa,GAAG7B,OAAO,CAAPA,QAAAA,CAApB,aAAA;;AACA,QAAI6B,aAAa,IAAbA,IAAAA,IAAyBD,aAAa,CAAbA,aAAa,CAAbA,IAA7B,IAAA,EAAmE;AAC/D,aAAOA,aAAa,CAApB,aAAoB,CAApB;AACH;;AACD,QAAIA,aAAa,CAAC5B,OAAO,CAArB4B,IAAa,CAAbA,IAAJ,IAAA,EAAyC;AACrC,aAAOA,aAAa,CAAC5B,OAAO,CAA5B,IAAoB,CAApB;AACH;;AACD,QAAI4B,aAAa,CAAbA,UAAa,CAAbA,IAAJ,IAAA,EAAuC;AACnC,aAAOA,aAAa,CAApB,UAAoB,CAApB;AACH;AAXL,GAAA;;AAaA,SAAO;AACHxoB,IAAAA,IAAI,EAAE4mB,OAAO,CADV,IAAA;AAEHW,IAAAA,KAAK,EAAEX,OAAO,CAFX,KAAA;AAGHjxB,IAAAA,QAAQ,EAHL,QAAA;AAIHwyB,IAAAA,YAAY,EAJT,YAAA;AAKHC,IAAAA,UAAU,EALP,UAAA;AAMHpqB,IAAAA,OAAO,EAAE3I,OAAQ,CAAA,EAAA,EAAA,cAAA,EAAqBuxB,OAAO,CAA5B,QAAA,EAAuCkB,cAAc,CAArD,WAAA,EAAmEA,cAAc,CAAjF,cAAA,EAAkGA,cAAc,CAAhH,SAAA,EAAA,mBAAA,EAAiJlB,OAAO,CAAxJ,SAAA,EAAoKkB,cAAc,CANhM,gBAMc,CANd;AAOHY,IAAAA,kBAAkB,EAAEH,eAAe,CAACT,cAAc,CAA9BS,gBAAe,CAAfA,IAChBA,eAAe,CAACT,cAAc,CADdS,SACD,CADCA,IAC6B;AAC7C3B,IAAAA,OAAO,CAAPA,SAAAA,CATD,UAAA;AAUH+B,IAAAA,iBAAiB,EAAEJ,eAAe,CAACT,cAAc,CAA9BS,cAAe,CAAfA,IACfA,eAAe,CAACT,cAAc,CADfS,WACA,CADAA,IAEf3B,OAAO,CAAPA,QAAAA,CAFe2B,UAAAA,IAGfA,eAAe,CAHAA,cAGA,CAHAA,IAIf3B,OAAO,CAdR,IAAA,CAcc;;AAdd,GAAP;AAgBH;;AAED,IAAIgC,OAAO;AAAG;AAAe,UAAA,MAAA,EAAkB;AAC3C3X,EAAAA,SAAS,CAAA,OAAA,EAATA,MAAS,CAATA;;AACA,WAAA,OAAA,CAAA,OAAA,EAAA,cAAA,EAA0C;AACtC,QAAInD,KAAK,GAAGoD,MAAM,CAANA,IAAAA,CAAAA,IAAAA,EAAAA,OAAAA,KAAZ,IAAA;;AACApD,IAAAA,KAAK,CAALA,aAAAA,GAAsB+a,gBAAgB,CAAC/a,KAAK,CAAN,YAAA,EAAqBA,KAAK,CAAhEA,cAAsC,CAAtCA;AACAA,IAAAA,KAAK,CAALA,YAAAA,GAAqB+a,gBAAgB,CAAC/a,KAAK,CAAN,WAAA,EAAA,IAAA,EAA0B,CAACA,KAAK,CAArEA,aAA+D,CAA1B,CAArCA;AACAA,IAAAA,KAAK,CAALA,mBAAAA,GAA4B+a,gBAAgB,CAAC/a,KAAK,CAAN,kBAAA,EAAA,IAAA,EAAiC,CAACA,KAAK,CAAnFA,aAA6E,CAAjC,CAA5CA;AACAA,IAAAA,KAAK,CAALA,YAAAA,GAAqB+a,gBAAgB,CAAC/a,KAAK,CAAN,WAAA,EAAA,IAAA,EAA0B,CAACA,KAAK,CAArEA,aAA+D,CAA1B,CAArCA;AACAA,IAAAA,KAAK,CAALA,WAAAA,GAAoB+a,gBAAgB,CAAC/a,KAAK,CAAN,UAAA,EAAA,IAAA,EAAyB,CAACA,KAAK,CAAnEA,aAA6D,CAAzB,CAApCA;AACAA,IAAAA,KAAK,CAALA,WAAAA,GAAoB+a,gBAAgB,CAAC/a,KAAK,CAAN,UAAA,EAAA,IAAA,EAAyB,CAACA,KAAK,CAAnEA,aAA6D,CAAzB,CAApCA;AACAA,IAAAA,KAAK,CAALA,EAAAA,GAAW5jB,aAAa,CAAA,KAAA,EAAQ;AAAEvD,MAAAA,SAAS,EAAE,gBAAgBmiC;AAA7B,KAAR,CAAxBhb;AACA,WAAA,KAAA;AACH;;AACD8a,EAAAA,OAAO,CAAPA,SAAAA,CAAAA,OAAAA,GAA4B,YAAY;AACpC1X,IAAAA,MAAM,CAANA,SAAAA,CAAAA,OAAAA,CAAAA,IAAAA,CAAAA,IAAAA;;AACA,SAAA,aAAA,CAFoC,QAEpC,GAFoC,CAEL;;;AAC/BxmB,IAAAA,aAAa,CAAC,KAAdA,EAAa,CAAbA;AAHJk+B,GAAAA;;AAKAA,EAAAA,OAAO,CAAPA,SAAAA,CAAAA,MAAAA,GAA2B,UAAA,KAAA,EAAiB;AACxC,SAAA,aAAA,CAAmB5/B,KAAK,CAAxB,MAAA;;AACA,SAAA,YAAA,CAAkBA,KAAK,CAAvB,KAAA;;AACA,SAAA,mBAAA,CAAyBA,KAAK,CAA9B,YAAA;;AACA,SAAA,YAAA,CAAkBA,KAAK,CAAvB,cAAA;;AACA,SAAA,WAAA,CAAiBA,KAAK,CAAtB,aAAA;;AACA,SAAA,WAAA,CAAiBA,KAAK,CAAtB,aAAA;AANJ4/B,GAAAA;;AAQAA,EAAAA,OAAO,CAAPA,SAAAA,CAAAA,YAAAA,GAAiC,UAAA,MAAA,EAAkB;AAC/C,QAAI7hC,EAAE,GAAG,KAAT,EAAA;AACA,SAAA,gBAAA,GAAA,EAAA;AACAM,IAAAA,eAAe,CAAA,EAAA,EAAK,KAAA,aAAA,CAAA,MAAA,EAA2B0hC,MAAM,CAArD1hC,IAAoB,CAAL,CAAfA;AACAA,IAAAA,eAAe,CAAA,EAAA,EAAK,KAAA,aAAA,CAAA,QAAA,EAA6B0hC,MAAM,CAAvD1hC,MAAoB,CAAL,CAAfA;AACAA,IAAAA,eAAe,CAAA,EAAA,EAAK,KAAA,aAAA,CAAA,OAAA,EAA4B0hC,MAAM,CAAtD1hC,KAAoB,CAAL,CAAfA;AALJuhC,GAAAA;;AAOAA,EAAAA,OAAO,CAAPA,SAAAA,CAAAA,cAAAA,GAAmC,YAAY;AAC3C,SAAA,EAAA,CAAA,SAAA,GAAA,EAAA;AADJA,GAAAA;;AAGAA,EAAAA,OAAO,CAAPA,SAAAA,CAAAA,aAAAA,GAAkC,UAAA,QAAA,EAAA,SAAA,EAA+B;AAC7D,QAAI9a,KAAK,GAAT,IAAA;;AACA,QAAIxe,EAAE,GAAN,IAAA;AAAA,QAAe4gB,KAAK,GAAG5gB,EAAE,CAAzB,KAAA;AAAA,QAAiCgI,QAAQ,GAAGhI,EAAE,CAA9C,QAAA;;AACA,QAAIw4B,cAAc,GAAGxwB,QAAQ,CAA7B,cAAA;AACA,QAAI0xB,SAAS,GAAG1xB,QAAQ,CAAxB,SAAA;AACA,QAAI2xB,SAAS,GAAG/+B,aAAa,CAAA,KAAA,EAAQ;AAAEvD,MAAAA,SAAS,EAAE,QAAQyD;AAArB,KAAR,CAA7B;AACA,QAAI8+B,qBAAqB,GAAGpB,cAAc,CAAdA,QAAAA,CAAAA,aAAAA,IAA5B,EAAA;AACA,QAAIqB,2BAA2B,GAAGrB,cAAc,CAAdA,SAAAA,CAAAA,UAAAA,IAAlC,EAAA;AACA,QAAIsB,kBAAkB,GAAGtB,cAAc,CAAdA,QAAAA,CAAAA,UAAAA,IAAzB,EAAA;;AACA,QAAA,SAAA,EAAe;AACXuB,MAAAA,SAAS,CAATA,KAAAA,CAAAA,GAAAA,EAAAA,OAAAA,CAA6B,UAAA,cAAA,EAAA,CAAA,EAA6B;AACtD,YAAIC,aAAa,GAAjB,EAAA;AACA,YAAIC,aAAa,GAAjB,IAAA;AACA,YAAA,OAAA;AACAC,QAAAA,cAAc,CAAdA,KAAAA,CAAAA,GAAAA,EAAAA,OAAAA,CAAkC,UAAA,UAAA,EAAA,CAAA,EAAyB;AACvD,cAAA,iBAAA;AACA,cAAA,QAAA;AACA,cAAA,WAAA;AACA,cAJuD,UAIvD,CAJuD,CAIvC;;AAChB,cALuD,UAKvD,CALuD,CAKvC;;AAChB,cAAA,eAAA;AACA,cAAA,aAAA;AACA,cAAA,QAAA;AACA,cAAA,cAAA;;AACA,cAAIC,UAAU,KAAd,OAAA,EAA4B;AACxBH,YAAAA,aAAa,CAAbA,IAAAA,CAAmBI,aAAa,CADR,iBACQ,CAAhCJ,EADwB,CAC8B;;AACtDC,YAAAA,aAAa,GAAbA,KAAAA;AAFJ,WAAA,MAIK;AACD,gBAAK/W,iBAAiB,GAAG0W,qBAAqB,CAA9C,UAA8C,CAA9C,EAA6D;AACzDS,cAAAA,WAAW,GAAG,SAAA,WAAA,CAAA,EAAA,EAAc;AACxB,oBAAInX,iBAAiB,CAArB,KAAA,EAA6B;AACzBA,kBAAAA,iBAAiB,CAAjBA,KAAAA,CAAAA,IAAAA,CAAAA,QAAAA,EAAAA,EAAAA;AACH;AAHLmX,eAAAA;;AAKA,eAACC,UAAU,GAAG1Z,KAAK,CAALA,wBAAAA,CAAd,iBAAcA,CAAd,MACK0Z,UAAU,GAAG1Z,KAAK,CAALA,YAAAA,CADlB,UACkBA,CADlB,MAEK0M,UAAU,GAAGpK,iBAAiB,CAFnC,IAAA;AANJ,aAAA,MAUK,IAAKmQ,QAAQ,GAAGqG,SAAS,CAAzB,UAAyB,CAAzB,EAAwC;AACzClb,cAAAA,KAAK,CAALA,gBAAAA,CAAAA,IAAAA,CAAAA,UAAAA;;AACA6b,cAAAA,WAAW,GAAG,SAAA,WAAA,GAAY;AACtBryB,gBAAAA,QAAQ,CAARA,UAAAA,CAAAA,UAAAA;AADJqyB,eAAAA;;AAGA,eAAC/M,UAAU,GAAG+F,QAAQ,CAAtB,kBAAA,MACKiH,UAAU,GAAG1Z,KAAK,CAALA,YAAAA,CADlB,UACkBA,CADlB,MAEK0M,UAAU,GAAG+F,QAAQ,CAF1B,iBAAA;AALC,aAAA,MASA,IAAIrrB,QAAQ,CAAZ,UAAY,CAAZ,EAA0B;AAAE;AAC7BqyB,cAAAA,WAAW,GAAG,SAAA,WAAA,GAAY;AACtBryB,gBAAAA,QAAQ,CAARA,UAAQ,CAARA;AADJqyB,eAAAA;;AAGA,eAAC/M,UAAU,GAAGuM,2BAA2B,CAAzC,UAAyC,CAAzC,MACKS,UAAU,GAAG1Z,KAAK,CAALA,YAAAA,CADlB,UACkBA,CADlB,MAEK0M,UAAU,GAAGwM,kBAAkB,CANT,UAMS,CAFpC,EAJ2B,CAO3B;AACH;;AACD,gBAAA,WAAA,EAAiB;AACbS,cAAAA,aAAa,GAAG,CACZ,QAAA,UAAA,GADY,SAAA,EAEZ3Z,KAAK,CAALA,QAAAA,CAFJ2Z,QAEI3Z,CAFY,CAAhB2Z;;AAIA,kBAAA,UAAA,EAAgB;AACZC,gBAAAA,eAAe,GAAGhgB,UAAU,CAA5BggB,UAA4B,CAA5BA;AACAC,gBAAAA,cAAc,GAAdA,EAAAA;AAFJ,eAAA,MAIK,IAAA,UAAA,EAAgB;AACjBD,gBAAAA,eAAe,GAAG,kBAAA,UAAA,GAAlBA,WAAAA;AACAC,gBAAAA,cAAc,GAAG,kBAAA,UAAA,GAAjBA,GAAAA;AACH;;AACDC,cAAAA,QAAQ,GAAGN,aAAa,EAAC;AACzB,gDAAkCG,aAAa,CAAbA,IAAAA,CAAlC,GAAkCA,CAAlC,GAAA,GAAA,GAAA,cAAA,GAAA,GAAA,GAAA,eAAA,GADAG,WAAwB,CAAxBA;AAIAA,cAAAA,QAAQ,CAARA,gBAAAA,CAAAA,OAAAA,EAAAA,WAAAA;AACAV,cAAAA,aAAa,CAAbA,IAAAA,CAAAA,QAAAA;AACH;AACJ;AA/DLE,SAAAA;;AAiEA,YAAIF,aAAa,CAAbA,MAAAA,GAAJ,CAAA,EAA8B;AAC1BW,UAAAA,OAAO,GAAGjjC,QAAQ,CAARA,aAAAA,CAAVijC,KAAUjjC,CAAVijC;AACA,cAAIC,oBAAoB,GAAGha,KAAK,CAALA,QAAAA,CAA3B,aAA2BA,CAA3B;;AACA,cAAIqZ,aAAa,IAAjB,oBAAA,EAA2C;AACvCU,YAAAA,OAAO,CAAPA,SAAAA,CAAAA,GAAAA,CAAAA,oBAAAA;AACH;;AACD5iC,UAAAA,eAAe,CAAA,OAAA,EAAfA,aAAe,CAAfA;AACA4hC,UAAAA,SAAS,CAATA,WAAAA,CAAAA,OAAAA;AAPJ,SAAA,MASK;AACD5hC,UAAAA,eAAe,CAAA,SAAA,EADd,aACc,CAAfA,CADC,CAC0C;AAC9C;AAhFLgiC,OAAAA;AAkFH;;AACD,WAAA,SAAA;AA7FJT,GAAAA;;AA+FAA,EAAAA,OAAO,CAAPA,SAAAA,CAAAA,WAAAA,GAAgC,UAAA,cAAA,EAA0B;AACtD,SAAA,mBAAA,CAAA,OAAA,EAAA,cAAA;AADJA,GAAAA;;AAGAA,EAAAA,OAAO,CAAPA,SAAAA,CAAAA,UAAAA,GAA+B,UAAA,aAAA,EAAyB;AACpD,SAAA,mBAAA,CAAA,MAAA,EAAA,aAAA;AADJA,GAAAA;;AAGAA,EAAAA,OAAO,CAAPA,SAAAA,CAAAA,UAAAA,GAA+B,UAAA,aAAA,EAAyB;AACpD,SAAA,mBAAA,CAAA,MAAA,EAAA,aAAA;AADJA,GAAAA;;AAGAA,EAAAA,OAAO,CAAPA,SAAAA,CAAAA,WAAAA,GAAgC,UAAA,IAAA,EAAgB;AAC5CuB,IAAAA,YAAY,CAAC,KAAD,EAAA,EAAZA,IAAY,CAAZA,CAAAA,OAAAA,CAAoC,UAAA,OAAA,EAAmB;AACnDC,MAAAA,OAAO,CAAPA,SAAAA,GAAAA,IAAAA;AADJD,KAAAA;AADJvB,GAAAA;;AAKAA,EAAAA,OAAO,CAAPA,SAAAA,CAAAA,kBAAAA,GAAuC,UAAA,UAAA,EAAsB;AACzD,QAAIjiC,SAAS,GAAG,KAAA,KAAA,CAAA,QAAA,CAAhB,cAAgB,CAAhB;AACAwjC,IAAAA,YAAY,CAAC,KAAD,EAAA,EAAZA,QAAY,CAAZA,CAAAA,OAAAA,CAAwC,UAAA,QAAA,EAAoB;AACxD,UAAIV,UAAU,IAAIO,QAAQ,CAARA,SAAAA,CAAAA,QAAAA,CAA4B,QAAA,UAAA,GAA9C,SAAkBA,CAAlB,EAA+E;AAC3EA,QAAAA,QAAQ,CAARA,SAAAA,CAAAA,GAAAA,CAAAA,SAAAA;AADJ,OAAA,MAGK;AACDA,QAAAA,QAAQ,CAARA,SAAAA,CAAAA,MAAAA,CAAAA,SAAAA;AACH;AANLG,KAAAA;AAFJvB,GAAAA;;AAWAA,EAAAA,OAAO,CAAPA,SAAAA,CAAAA,mBAAAA,GAAwC,UAAA,UAAA,EAAA,IAAA,EAA4B;AAChEuB,IAAAA,YAAY,CAAC,KAAD,EAAA,EAAU,SAAA,UAAA,GAAtBA,SAAY,CAAZA,CAAAA,OAAAA,CAA+D,UAAA,QAAA,EAAoB;AAC/EH,MAAAA,QAAQ,CAARA,QAAAA,GAAoB,CAApBA,IAAAA;AADJG,KAAAA;AADJvB,GAAAA;;AAKA,SAAA,OAAA;AAjKyB,CAAA,CAA7B,SAA6B,CAA7B;;AAoKA,IAAIyB,iBAAiB;AAAG;AAAe,UAAA,MAAA,EAAkB;AACrDpZ,EAAAA,SAAS,CAAA,iBAAA,EAATA,MAAS,CAATA;;AACA,WAAA,iBAAA,CAAA,OAAA,EAAA,EAAA,EAAwC;AACpC,QAAInD,KAAK,GAAGoD,MAAM,CAANA,IAAAA,CAAAA,IAAAA,EAAAA,OAAAA,KAAZ,IAAA;;AACApD,IAAAA,KAAK,CAALA,eAAAA,GAAwB+a,gBAAgB,CAAC/a,KAAK,CAA9CA,cAAwC,CAAxCA;AACAA,IAAAA,KAAK,CAALA,yBAAAA,GAAkC/R,OAAO,CAAzC+R,yBAAyC,CAAzCA;AACAA,IAAAA,KAAK,CAALA,EAAAA,GAAAA,EAAAA;AACAwc,IAAAA,gBAAgB,CAAA,EAAA,EAAKxc,KAAK,CAALA,SAAAA,GAAkB5jB,aAAa,CAAA,KAAA,EAAQ;AAAEvD,MAAAA,SAAS,EAAE;AAAb,KAAR,CAApC,CAAhB2jC;AACA,QAAIhzB,QAAQ,GAAGwW,KAAK,CAApB,QAAA;;AACA,SAAK,IAAI5a,EAAE,GAAN,CAAA,EAAY5D,EAAE,GAAGgI,QAAQ,CAARA,YAAAA,CAAAA,KAAAA,CAAtB,sBAAA,EAA0EpE,EAAE,GAAG5D,EAAE,CAAjF,MAAA,EAA0F4D,EAA1F,EAAA,EAAgG;AAC5F,UAAIq3B,mBAAmB,GAAGj7B,EAAE,CAA5B,EAA4B,CAA5B;AACAi7B,MAAAA,mBAAmB,CAACzc,KAAK,CAAN,SAAA,EAAnByc,QAAmB,CAAnBA;AACH;;AACDzc,IAAAA,KAAK,CAALA,kBAAAA,CAAAA,IAAAA;;AACAA,IAAAA,KAAK,CAALA,YAAAA,GAAqB/R,OAAO,CAA5B+R,YAA4B,CAA5BA;AACAA,IAAAA,KAAK,CAALA,kBAAAA,GAA2B/R,OAAO,CAAC,UAAA,KAAA,EAAiB;AAChD,aAAOyuB,kBAAkB,CAAA,KAAA,EAAQ1c,KAAK,CAAtC,QAAyB,CAAzB;AADJA,KAAkC,CAAlCA;AAGA,WAAA,KAAA;AACH;;AACDuc,EAAAA,iBAAiB,CAAjBA,SAAAA,CAAAA,OAAAA,GAAsC,YAAY;AAC9C,QAAI,KAAJ,MAAA,EAAiB;AACb,WAAA,MAAA,CAAA,OAAA;AACH;;AACD,QAAI,KAAJ,MAAA,EAAiB;AACb,WAAA,MAAA,CAAA,OAAA;AACH;;AACD,QAAI,KAAJ,IAAA,EAAe;AACX,WAAA,IAAA,CAAA,OAAA;AACH;;AACD3/B,IAAAA,aAAa,CAAC,KAAdA,SAAa,CAAbA;AACA,SAAA,kBAAA,CAAA,KAAA;;AACAwmB,IAAAA,MAAM,CAANA,SAAAA,CAAAA,OAAAA,CAAAA,IAAAA,CAAAA,IAAAA;AAZJmZ,GAAAA;;AAcAA,EAAAA,iBAAiB,CAAjBA,SAAAA,CAAAA,kBAAAA,GAAiD,UAAA,IAAA,EAAgB;AAC7D,QAAII,SAAS,GAAG,KAAA,EAAA,CAAhB,SAAA;AACA,QAAIC,YAAY,GAAG,QAAQ,KAAA,GAAA,CAA3B,KAA2B,CAA3B;AACA,QAAIC,cAAc,GAAG,KAAA,KAAA,CAAA,QAAA,CAArB,QAAqB,CAArB;;AACA,QAAA,IAAA,EAAU;AACNF,MAAAA,SAAS,CAATA,GAAAA,CAAAA,IAAAA;AACAA,MAAAA,SAAS,CAATA,GAAAA,CAAAA,YAAAA;AACAA,MAAAA,SAAS,CAATA,GAAAA,CAAAA,cAAAA;AAHJ,KAAA,MAKK;AACDA,MAAAA,SAAS,CAATA,MAAAA,CAAAA,IAAAA;AACAA,MAAAA,SAAS,CAATA,MAAAA,CAAAA,YAAAA;AACAA,MAAAA,SAAS,CAATA,MAAAA,CAAAA,cAAAA;AACH;AAbLJ,GAAAA;;AAeAA,EAAAA,iBAAiB,CAAjBA,SAAAA,CAAAA,MAAAA,GAAqC,UAAA,KAAA,EAAiB;AAClD,SAAA,YAAA;AACA,QAAInf,KAAK,GAAG,KAAA,YAAA,CAAkBliB,KAAK,CAAvB,WAAA,EAAqCA,KAAK,CAALA,QAAAA,CAAjD,OAAY,CAAZ;;AACA,SAAA,eAAA,CAAqBA,KAAK,CAA1B,QAAA,EAAqCA,KAAK,CAA1C,WAAA,EAAwDA,KAAK,CAA7D,WAAA,EAA2EA,KAAK,CAAhF,oBAAA,EAAA,KAAA;;AACA,SAAA,UAAA,CAAA,KAAA,EAAA,KAAA;AACA,SAAA,UAAA;AACA,SAAA,UAAA;AANJqhC,GAAAA;;AAQAA,EAAAA,iBAAiB,CAAjBA,SAAAA,CAAAA,cAAAA,GAA6C,UAAA,QAAA,EAAA,WAAA,EAAA,WAAA,EAAA,oBAAA,EAAA,KAAA,EAA2E;AACpH,QAAIO,YAAY,GAAG,KAAA,GAAA,CAAnB,QAAmB,CAAnB;AACA,QAAIC,YAAY,GAAG,KAAA,GAAA,CAAnB,QAAmB,CAAnB;AACA,QAAIC,GAAG,GAAG,KAAA,QAAA,CAAV,MAAU,EAAV;AACA,QAAIC,SAAS,GAAGC,oBAAoB,CAApBA,KAAAA,CAAhB,GAAgBA,CAAhB;AACA,QAAIC,QAAQ,GAAGD,oBAAoB,CAApBA,SAAAA,CAAAA,WAAAA,EAAf,WAAeA,CAAf;AACA,QAAIE,QAAQ,GAAGF,oBAAoB,CAApBA,SAAAA,CAAAA,WAAAA,EAAf,WAAeA,CAAf;AACA,QAAIG,YAAY,GAAG;AACfjgB,MAAAA,KAAK,EADU,KAAA;AAEfkgB,MAAAA,YAAY,EAAEzI,QAAQ,CAFP,IAAA;AAGf0I,MAAAA,cAAc,EAAEN,SAAS,CAATA,OAAAA,IAAqB,CAAC3a,mBAAmB,CAAClL,WAAW,CAAZ,YAAA,EAH1C,GAG0C,CAH1C;AAIfomB,MAAAA,aAAa,EAAEL,QAAQ,CAJR,OAAA;AAKfM,MAAAA,aAAa,EAAEL,QAAQ,CAAC3H;AALT,KAAnB;;AAOA,QAAA,YAAA,EAAkB;AACd,UAAI,CAAC,KAAL,MAAA,EAAkB;AACd,aAAA,MAAA,GAAc,IAAA,OAAA,CAAY,KAAZ,OAAA,EAAd,mBAAc,CAAd;AACA+G,QAAAA,gBAAgB,CAAC,KAAD,EAAA,EAAU,KAAA,MAAA,CAA1BA,EAAgB,CAAhBA;AACH;;AACD,WAAA,MAAA,CAAA,YAAA,CAAyBj1B,OAAQ,CAAC;AAAE0zB,QAAAA,MAAM,EAAE6B;AAAV,OAAD,EAAjC,YAAiC,CAAjC;AALJ,KAAA,MAOK,IAAI,KAAJ,MAAA,EAAiB;AAClB,WAAA,MAAA,CAAA,OAAA;AACA,WAAA,MAAA,GAAA,IAAA;AACH;;AACD,QAAA,YAAA,EAAkB;AACd,UAAI,CAAC,KAAL,MAAA,EAAkB;AACd,aAAA,MAAA,GAAc,IAAA,OAAA,CAAY,KAAZ,OAAA,EAAd,mBAAc,CAAd;AACAvjC,QAAAA,eAAe,CAAC,KAAD,EAAA,EAAU,KAAA,MAAA,CAAzBA,EAAe,CAAfA;AACH;;AACD,WAAA,MAAA,CAAA,YAAA,CAAyBgO,OAAQ,CAAC;AAAE0zB,QAAAA,MAAM,EAAE8B;AAAV,OAAD,EAAjC,YAAiC,CAAjC;AALJ,KAAA,MAOK,IAAI,KAAJ,MAAA,EAAiB;AAClB,WAAA,MAAA,CAAA,OAAA;AACA,WAAA,MAAA,GAAA,IAAA;AACH;AAnCLR,GAAAA;;AAqCAA,EAAAA,iBAAiB,CAAjBA,SAAAA,CAAAA,UAAAA,GAAyC,UAAA,KAAA,EAAA,KAAA,EAAwB;AAC7D,QAAI7mB,IAAI,GAAG,KAAX,IAAA;AACA,QAAImf,QAAQ,GAAG35B,KAAK,CAApB,QAAA;AAAA,QAA+BgiC,oBAAoB,GAAGhiC,KAAK,CAA3D,oBAAA;;AACA,QAAI,CAAA,IAAA,IAASwa,IAAI,CAAJA,QAAAA,KAAb,QAAA,EAAyC;AACrC,UAAA,IAAA,EAAU;AACNA,QAAAA,IAAI,CAAJA,OAAAA;AACH;;AACDA,MAAAA,IAAI,GAAG,KAAA,IAAA,GAAY,IAAImf,QAAQ,CAAZ,OAAY,CAAZ,CAAsB;AACrCrrB,QAAAA,QAAQ,EAAE,KAD2B,QAAA;AAErCkM,QAAAA,IAAI,EAFiC,IAAA;AAGrCzO,QAAAA,OAAO,EAAE,KAH4B,OAAA;AAIrCmb,QAAAA,KAAK,EAAE,KAJ8B,KAAA;AAKrClS,QAAAA,OAAO,EAAE2kB,QAAQ,CAAC3kB;AALmB,OAAtB,EAAA,QAAA,EAAA,oBAAA,EAMgB,KANnCwF,SAAmB,CAAnBA;AAJJ,KAAA,MAYK;AACDA,MAAAA,IAAI,CAAJA,SAAAA,CAAeA,IAAI,CAAnBA,WAAeA,EAAfA;AACH;;AACDA,IAAAA,IAAI,CAAJA,KAAAA,GAlB6D,KAkB7DA,CAlB6D,CAkBzC;;AACpB,QAAIgoB,SAAS,GAAG;AACZtmB,MAAAA,WAAW,EAAElc,KAAK,CADN,WAAA;AAEZ6d,MAAAA,aAAa,EAAE,KAAA,kBAAA,CAAwB8b,QAAQ,CAARA,OAAAA,CAF3B,aAEG,CAFH;AAGZ5rB,MAAAA,UAAU,EAAE/N,KAAK,CAHL,UAAA;AAIZmb,MAAAA,YAAY,EAAEnb,KAAK,CAJP,YAAA;AAKZ4d,MAAAA,aAAa,EAAE5d,KAAK,CALR,aAAA;AAMZ8d,MAAAA,cAAc,EAAE9d,KAAK,CANT,cAAA;AAOZ0d,MAAAA,SAAS,EAAE1d,KAAK,CAPJ,SAAA;AAQZ+d,MAAAA,WAAW,EAAE/d,KAAK,CAAC+d;AARP,KAAhB;AAUA,QAAI0kB,YAAY,GAAG,KAAA,yBAAA,CAA+B,KAAA,QAAA,CAAA,YAAA,CAAA,KAAA,CAAlD,qBAAmB,CAAnB;;AACA,SAAK,IAAIv4B,EAAE,GAAN,CAAA,EAAYw4B,cAAc,GAA/B,YAAA,EAAgDx4B,EAAE,GAAGw4B,cAAc,CAAnE,MAAA,EAA4Ex4B,EAA5E,EAAA,EAAkF;AAC9E,UAAIy4B,WAAW,GAAGD,cAAc,CAAhC,EAAgC,CAAhC;;AACAr2B,MAAAA,OAAQ,CAAA,SAAA,EAAYs2B,WAAW,CAAXA,SAAAA,CAAAA,SAAAA,EAAAA,QAAAA,EAAAA,KAAAA,EAApBt2B,IAAoBs2B,CAAZ,CAARt2B;AACH;;AACDmO,IAAAA,IAAI,CAAJA,YAAAA,CAAAA,SAAAA;AAhIiD,GA8FrD6mB,CA9FqD,CAkIrD;AACA;;;AACAA,EAAAA,iBAAiB,CAAjBA,SAAAA,CAAAA,UAAAA,GAAyC,UAAA,QAAA,EAAoB;AACzD,QAAIuB,QAAQ,KAAK,KAAjB,CAAA,EAAyB;AAAEA,MAAAA,QAAQ,GAARA,KAAAA;AAAmB;;AAC9C,QAAIpoB,IAAI,GAAG,KAAX,IAAA;;AACA,QAAA,QAAA,EAAc;AACVA,MAAAA,IAAI,CAAJA,SAAAA,CAAeA,IAAI,CAAnBA,WAAeA,EAAfA;AACH;;AACD,QAAIooB,QAAQ,IAAI,KAAA,YAAA,IAAhB,IAAA,EAA2C;AACvC,WAAA,iBAAA;AACH;;AACDpoB,IAAAA,IAAI,CAAJA,UAAAA,CAAAA,QAAAA,EAA0B,KAA1BA,UAAAA,EAA2C,KAA3CA,YAAAA;AACAA,IAAAA,IAAI,CAVqD,kBAUzDA,GAVyD,CAU9B;;AAC3BA,IAAAA,IAAI,CAAJA,SAAAA,CAAAA,QAAAA;AAXJ6mB,GAAAA;;AAaAA,EAAAA,iBAAiB,CAAjBA,SAAAA,CAAAA,iBAAAA,GAAgD,YAAY;AACxD,QAAI/yB,QAAQ,GAAG,KADyC,QACxD,CADwD,CAC1B;;AAC9B,QAAIu0B,WAAW,GAAGv0B,QAAQ,CAARA,GAAAA,CAAlB,QAAkBA,CAAlB;AACA,QAAIw0B,kBAAkB,GAAGx0B,QAAQ,CAARA,GAAAA,CAAzB,eAAyBA,CAAzB;AACA,SAAA,YAAA,GAAoBu0B,WAAW,KAAXA,MAAAA,IAA0BC,kBAAkB,KAAhE,MAAA;;AACA,QAAI,OAAA,kBAAA,KAAJ,QAAA,EAA4C;AAAE;AAC1C,WAAA,UAAA,GAAA,kBAAA;AADJ,KAAA,MAGK,IAAI,OAAA,kBAAA,KAAJ,UAAA,EAA8C;AAAE;AACjD,WAAA,UAAA,GAAkBA,kBAAlB,EAAA;AADC,KAAA,MAGA,IAAI,OAAA,WAAA,KAAJ,QAAA,EAAqC;AAAE;AACxC,WAAA,UAAA,GAAkBD,WAAW,GAAG,KAAhC,mBAAgC,EAAhC;AADC,KAAA,MAGA,IAAI,OAAA,WAAA,KAAJ,UAAA,EAAuC;AAAE;AAC1C,WAAA,UAAA,GAAkBA,WAAW,KAAK,KAAlC,mBAAkC,EAAlC;AADC,KAAA,MAGA,IAAIA,WAAW,KAAf,QAAA,EAA8B;AAAE;AACjC,UAAIE,QAAQ,GAAG,KAAA,EAAA,CAAf,UAAA;AACA,WAAA,UAAA,GAAkBA,QAAQ,CAARA,qBAAAA,GAAAA,MAAAA,GAA0C,KAA5D,mBAA4D,EAA5D;AAFC,KAAA,MAIA;AACD,WAAA,UAAA,GAAkBziC,IAAI,CAAJA,KAAAA,CAAW,KAAA,SAAA,CAAA,qBAAA,GAAA,KAAA,GACzBA,IAAI,CAAJA,GAAAA,CAASgO,QAAQ,CAARA,GAAAA,CAAThO,aAASgO,CAAThO,EADJ,EACIA,CADcA,CAAlB;AAEH;AAxBL+gC,GAAAA;;AA0BAA,EAAAA,iBAAiB,CAAjBA,SAAAA,CAAAA,mBAAAA,GAAkD,YAAY;AAC1D,QAAI2B,MAAM,GAAV,CAAA;;AACA,QAAI,KAAJ,MAAA,EAAiB;AACbA,MAAAA,MAAM,IAAIC,uBAAuB,CAAC,KAAA,MAAA,CAAlCD,EAAiC,CAAjCA;AACH;;AACD,QAAI,KAAJ,MAAA,EAAiB;AACbA,MAAAA,MAAM,IAAIC,uBAAuB,CAAC,KAAA,MAAA,CAAlCD,EAAiC,CAAjCA;AACH;;AACD,WAAA,MAAA;AAnLiD,GA2KrD3B,CA3KqD,CAqLrD;AACA;;;AACAA,EAAAA,iBAAiB,CAAjBA,SAAAA,CAAAA,YAAAA,GAA2C,YAAY;AACnDnjC,IAAAA,UAAU,CAAC,KAAD,EAAA,EAAU;AAChB8kC,MAAAA,MAAM,EAAE,KAAA,EAAA,CAAA,qBAAA,GADQ,MAAA;AAEhBzhC,MAAAA,QAAQ,EAAE;AAFM,KAAV,CAAVrD;AADJmjC,GAAAA;;AAMAA,EAAAA,iBAAiB,CAAjBA,SAAAA,CAAAA,UAAAA,GAAyC,YAAY;AACjDnjC,IAAAA,UAAU,CAAC,KAAD,EAAA,EAAU;AAChB8kC,MAAAA,MAAM,EADU,EAAA;AAEhBzhC,MAAAA,QAAQ,EAAE;AAFM,KAAV,CAAVrD;AADJmjC,GAAAA;;AAMA,SAAA,iBAAA;AAnMmC,CAAA,CAAvC,SAAuC,CAAvC,C,CAqMA;AACA;AACA;;;AACA,SAAA,YAAA,CAAA,WAAA,EAAA,WAAA,EAAgD;AAC5C,MAD4C,KAC5C,CAD4C,CAE5C;;AACA,MAAI,iBAAA,IAAA,CAAsBnlB,WAAW,CAArC,gBAAI,CAAJ,EAAyD;AACrDxL,IAAAA,KAAK,GAAGwL,WAAW,CAAnBxL,YAAAA;AADJ,GAAA,MAGK;AAAE;AACHA,IAAAA,KAAK,GAAGwL,WAAW,CAAnBxL,WAAAA;AACH;;AACD,SAAO,KAAA,OAAA,CAAA,WAAA,CAAyBA,KAAK,CAA9B,KAAA,EAAsCA,KAAK,CAA3C,GAAA,EAAiDmI,eAAe,CAACqqB,WAAW,CAAXA,WAAAA,IAA2BC,kBAAkB,CAA9C,WAA8C,CAA9C,EAA6DD,WAAW,CAAxI,mBAAgE,CAAhE,EAA+J;AAAEE,IAAAA,cAAc,EAAElnB,WAAW,CAACke;AAA9B,GAA/J,CAAP;EAEJ;AACA;;;AACA,SAAA,kBAAA,CAAA,WAAA,EAAyC;AACrC,MAAIK,gBAAgB,GAAGve,WAAW,CAAlC,gBAAA;;AACA,MAAIue,gBAAgB,KAApB,MAAA,EAAiC;AAC7B,WAAO;AAAE5oB,MAAAA,IAAI,EAAE;AAAR,KAAP;AADJ,GAAA,MAGK,IAAI4oB,gBAAgB,KAApB,OAAA,EAAkC;AACnC,WAAO;AAAE5oB,MAAAA,IAAI,EAAN,SAAA;AAAmBC,MAAAA,KAAK,EAAE;AAA1B,KAAP,CADmC,CACQ;AAD1C,GAAA,MAGA;AACD,QAAI/M,IAAI,GAAGG,aAAa,CAACgX,WAAW,CAAXA,YAAAA,CAAD,KAAA,EAAiCA,WAAW,CAAXA,YAAAA,CAAzD,GAAwB,CAAxB;;AACA,QAAInX,IAAI,KAAJA,IAAAA,IAAiBA,IAAI,GAAzB,CAAA,EAA+B;AAC3B;AACA,aAAO;AAAE8M,QAAAA,IAAI,EAAN,SAAA;AAAmBC,QAAAA,KAAK,EAAxB,OAAA;AAAmCC,QAAAA,GAAG,EAAE;AAAxC,OAAP;AAFJ,KAAA,MAIK;AACD;AACA,aAAO;AAAEF,QAAAA,IAAI,EAAN,SAAA;AAAmBC,QAAAA,KAAK,EAAxB,MAAA;AAAkCC,QAAAA,GAAG,EAAE;AAAvC,OAAP;AACH;AACJ;EAEL;AACA;;;AACA,SAAA,yBAAA,CAAA,UAAA,EAA+C;AAC3C,SAAO,UAAU,CAAV,GAAA,CAAe,UAAA,QAAA,EAAoB;AACtC,WAAO,IAAP,QAAO,EAAP;AADJ,GAAO,CAAP;AAGH;;AAED,IAAIsxB,WAAW;AAAG;AAAe,YAAY;AACzC,WAAA,WAAA,CAAA,QAAA,EAA+B;AAC3B,SAAA,SAAA,GAAiB3M,QAAQ,CAAzB,SAAA;AACH;;AACD2M,EAAAA,WAAW,CAAXA,SAAAA,CAAAA,OAAAA,GAAgC,YAAY,CAA5CA,CAAAA;;AAEA,SAAA,WAAA;AANJ,CAAiC,EAAjC;;AAQA,SAAA,wBAAA,CAAA,SAAA,EAAA,KAAA,EAAoD;AAChD,SAAO;AACH3c,IAAAA,SAAS,EADN,SAAA;AAEH3oB,IAAAA,EAAE,EAAE+K,KAAK,CAFN,EAAA;AAGHw6B,IAAAA,cAAc,EAAEx6B,KAAK,CAALA,cAAAA,IAAAA,IAAAA,GAA+BA,KAAK,CAApCA,cAAAA,GAAsD;AAHnE,GAAP;AAKH;;AACD,SAAA,0BAAA,CAAA,QAAA,EAA8C;AAC1C,MAAA,EAAA;;AACA,SAAOxC,EAAE,GAAFA,EAAAA,EACHA,EAAE,CAACowB,QAAQ,CAARA,SAAAA,CAAHpwB,GAAE,CAAFA,GADGA,QAAAA,EAAP,EAAA;EAIJ;;;AACA,IAAIi9B,wBAAwB,GAA5B,EAAA;AAEA;AACA;AACA;;AACA,IAAIC,aAAa;AAAG;AAAe,UAAA,MAAA,EAAkB;AACjDvb,EAAAA,SAAS,CAAA,aAAA,EAATA,MAAS,CAATA;;AACA,WAAA,aAAA,CAAA,QAAA,EAAiC;AAC7B,QAAInD,KAAK,GAAGoD,MAAM,CAANA,IAAAA,CAAAA,IAAAA,EAAAA,QAAAA,KAAZ,IAAA;;AACApD,IAAAA,KAAK,CAALA,cAAAA,GAAuB,UAAA,EAAA,EAAA,KAAA,EAAqB;AACxC,UAAI4B,SAAS,GAAG5B,KAAK,CAArB,SAAA;AACA,UAAIlK,GAAG,GAAG6oB,QAAQ,CAAlB,KAAkB,CAAlB;;AACA,UAAI7oB,GAAG,IAAI;AACP8L,MAAAA,SAAS,CAATA,gBAAAA,CAA2BpjB,EAAE,CADjC,MACIojB,CADJ,EAC2C;AACvC;AACA;AACA,YAAIgd,eAAe,GAAGlgC,cAAc,CAACF,EAAE,CAAH,MAAA,EAApC,aAAoC,CAApC;AACA,YAAI6e,GAAG,GAAGuhB,eAAe,GAAGA,eAAe,CAAfA,aAAAA,CAAAA,SAAAA,EAAH,IAAA,GAAzB,EAAA;AACAhd,QAAAA,SAAS,CAATA,eAAAA,CAAAA,YAAAA,EAAwC,CACpC;AACI3oB,UAAAA,EAAE,EADN,KAAA;AAEI4c,UAAAA,KAAK,EAAE,IAAA,QAAA,CAAa+L,SAAS,CAAtB,QAAA,EAAiC9L,GAAG,CAAHA,UAAAA,CAAjC,GAAA,EAAqDA,GAAG,CAAHA,UAAAA,CAFhE,QAEW,CAFX;AAGI+oB,UAAAA,OAAO,EAHX,EAAA;AAIInpB,UAAAA,IAAI,EAAEkM,SAAS,CAAClM;AAJpB,SADoC,CAAxCkM;;AAQA,YAAIvE,GAAG,IAAI,CAAC7e,EAAE,CAAd,gBAAA,EAAiC;AAC7BxB,UAAAA,MAAM,CAANA,QAAAA,CAAAA,IAAAA,GAAAA,GAAAA;AACH;AACJ;AApBLgjB,KAAAA;;AAsBA,QAAI4B,SAAS,GAAGgQ,QAAQ,CAAxB,SAAA;AACA5R,IAAAA,KAAK,CAALA,OAAAA,GAAgBphB,gBAAgB,CAACgjB,SAAS,CAAV,EAAA,EAAA,OAAA,EAAwBA,SAAS,CAATA,aAAAA,GAAAA,GAAAA,GAAgCA,SAAS,CAAjE,aAAA,EAAiF5B,KAAK,CAAtHA,cAAgC,CAAhCA;AACA,WAAA,KAAA;AACH;;AACD,SAAA,aAAA;AA9B+B,CAAA,CAAnC,WAAmC,CAAnC;AAiCA;AACA;AACA;AACA;;;AACA,IAAI8e,aAAa;AAAG;AAAe,UAAA,MAAA,EAAkB;AACjD3b,EAAAA,SAAS,CAAA,aAAA,EAATA,MAAS,CAATA;;AACA,WAAA,aAAA,CAAA,QAAA,EAAiC;AAC7B,QAAInD,KAAK,GAAGoD,MAAM,CAANA,IAAAA,CAAAA,IAAAA,EAAAA,QAAAA,KADiB,IAC7B,CAD6B,CAE7B;;;AACApD,IAAAA,KAAK,CAALA,mBAAAA,GAA4B,UAAA,EAAA,EAAc;AACtC,UAAI/mB,EAAE,KAAK+mB,KAAK,CAAhB,YAAA,EAA+B;AAC3BA,QAAAA,KAAK,CAALA,cAAAA,CAAAA,IAAAA,EAA2BA,KAAK,CAAhCA,YAAAA;AACH;AAHLA,KAAAA;;AAKAA,IAAAA,KAAK,CAALA,cAAAA,GAAuB,UAAA,EAAA,EAAA,KAAA,EAAqB;AACxC,UAAI2e,QAAQ,CAAZ,KAAY,CAAZ,EAAqB;AAAE;AACnBnZ,QAAAA,KAAK,CAALA,SAAAA,CAAAA,GAAAA,CAAAA,uBAAAA;AACAxF,QAAAA,KAAK,CAALA,YAAAA,GAAAA,KAAAA;;AACAA,QAAAA,KAAK,CAALA,YAAAA,CAAAA,iBAAAA,EAAAA,EAAAA,EAAAA,KAAAA;AACH;AALLA,KAAAA;;AAOAA,IAAAA,KAAK,CAALA,cAAAA,GAAuB,UAAA,EAAA,EAAA,KAAA,EAAqB;AACxC,UAAIA,KAAK,CAAT,YAAA,EAAwB;AACpBwF,QAAAA,KAAK,CAALA,SAAAA,CAAAA,MAAAA,CAAAA,uBAAAA;AACAxF,QAAAA,KAAK,CAALA,YAAAA,GAAAA,IAAAA;;AACAA,QAAAA,KAAK,CAALA,YAAAA,CAAAA,iBAAAA,EAAAA,EAAAA,EAAAA,KAAAA;AACH;AALLA,KAAAA;;AAOA,QAAI4B,SAAS,GAAGgQ,QAAQ,CAAxB,SAAA;AACA5R,IAAAA,KAAK,CAALA,oBAAAA,GAA6B+e,uBAAuB,CAACnd,SAAS,CAAV,EAAA,EAAeA,SAAS,CAATA,aAAAA,GAAAA,GAAAA,GAAgCA,SAAS,CAAxD,aAAA,EAAwE5B,KAAK,CAA7E,cAAA,EAA8FA,KAAK,CAAvJA,cAAoD,CAApDA;AACA4B,IAAAA,SAAS,CAATA,QAAAA,CAAAA,EAAAA,CAAAA,eAAAA,EAAuC5B,KAAK,CAA5C4B,mBAAAA;AACA,WAAA,KAAA;AACH;;AACDkd,EAAAA,aAAa,CAAbA,SAAAA,CAAAA,OAAAA,GAAkC,YAAY;AAC1C,SAAA,oBAAA;AACA,SAAA,SAAA,CAAA,QAAA,CAAA,GAAA,CAAA,eAAA,EAA6C,KAA7C,mBAAA;AAFJA,GAAAA;;AAIAA,EAAAA,aAAa,CAAbA,SAAAA,CAAAA,YAAAA,GAAuC,UAAA,YAAA,EAAA,EAAA,EAAA,KAAA,EAAmC;AACtE,QAAIld,SAAS,GAAG,KAAhB,SAAA;AACA,QAAI9L,GAAG,GAAG6oB,QAAQ,CAAlB,KAAkB,CAAlB;;AACA,QAAI,CAAA,EAAA,IAAO/c,SAAS,CAATA,gBAAAA,CAA2BpjB,EAAE,CAAxC,MAAWojB,CAAX,EAAkD;AAC9CA,MAAAA,SAAS,CAATA,eAAAA,CAAAA,YAAAA,EAAwC,CACpC;AACI3oB,QAAAA,EAAE,EADN,KAAA;AAEI4c,QAAAA,KAAK,EAAE,IAAA,QAAA,CAAa,KAAA,SAAA,CAAb,QAAA,EAAsCC,GAAG,CAAHA,UAAAA,CAAtC,GAAA,EAA0DA,GAAG,CAAHA,UAAAA,CAFrE,QAEW,CAFX;AAGI+oB,QAAAA,OAAO,EAHX,EAAA;AAIInpB,QAAAA,IAAI,EAAEkM,SAAS,CAAClM;AAJpB,OADoC,CAAxCkM;AAQH;AAZLkd,GAAAA;;AAcA,SAAA,aAAA;AA/C+B,CAAA,CAAnC,WAAmC,CAAnC;;AAkDA,IAAIE,aAAa;AAAG;AAAe,UAAA,MAAA,EAAkB;AACjD7b,EAAAA,SAAS,CAAA,aAAA,EAATA,MAAS,CAATA;;AACA,WAAA,aAAA,GAAyB;AACrB,WAAOC,MAAM,KAANA,IAAAA,IAAmBA,MAAM,CAANA,KAAAA,CAAAA,IAAAA,EAAnBA,SAAmBA,CAAnBA,IAAP,IAAA;AACH;;AACD,SAAA,aAAA;AAL+B,CAAA,CAAnC,KAAmC,CAAnC;;AAOA4b,aAAa,CAAbA,SAAAA,CAAAA,OAAAA,GAAkC;AAC9BC,EAAAA,MAAM,EADwB,aAAA;AAE9BC,EAAAA,YAAY,EAFkB,kBAAA;AAG9BC,EAAAA,aAAa,EAHiB,mBAAA;AAI9BC,EAAAA,WAAW,EAJmB,iBAAA;AAK9BC,EAAAA,MAAM,EALwB,6BAAA;AAM9BC,EAAAA,YAAY,EANkB,kBAAA;AAO9BC,EAAAA,aAAa,EAPiB,kBAAA;AAQ9BC,EAAAA,cAAc,EARgB,mBAAA;AAS9B;AACAC,EAAAA,SAAS,EAVqB,kBAAA;AAW9BC,EAAAA,MAAM,EAXwB,mBAAA;AAY9B;AACAC,EAAAA,QAAQ,EAAE;AAboB,CAAlCX;AAeAA,aAAa,CAAbA,SAAAA,CAAAA,aAAAA,GAAAA,SAAAA;AACAA,aAAa,CAAbA,SAAAA,CAAAA,WAAAA,GAAsC;AAClCY,EAAAA,KAAK,EAD6B,WAAA;AAElC7R,EAAAA,IAAI,EAF8B,sBAAA;AAGlCC,EAAAA,IAAI,EAH8B,uBAAA;AAIlCC,EAAAA,QAAQ,EAJ0B,uBAAA;AAKlCC,EAAAA,QAAQ,EAAE;AALwB,CAAtC8Q;AAOAA,aAAa,CAAbA,SAAAA,CAAAA,kBAAAA,GAAAA,aAAAA;AACAA,aAAa,CAAbA,SAAAA,CAAAA,8BAAAA,GAAAA,MAAAA;AACAA,aAAa,CAAbA,SAAAA,CAAAA,kBAAAA,GAAAA,UAAAA;;AAEA,IAAIa,QAAQ;AAAG;AAAe,YAAY;AACtC,WAAA,QAAA,CAAA,EAAA,EAAA,SAAA,EAAiC;AAC7B,QAAI7f,KAAK,GAAT,IAAA;;AACA,SAAA,eAAA,GAAuB/R,OAAO,CAA9B,eAA8B,CAA9B;AACA,SAAA,WAAA,GAAmBA,OAAO,CAA1B,WAA0B,CAA1B;AACA,SAAA,YAAA,GAAoBA,OAAO,CAA3B,YAA2B,CAA3B;AACA,SAAA,UAAA,GAAkBA,OAAO,CAAzB,UAAyB,CAAzB;AACA,SAAA,sBAAA,GAA8BA,OAAO,CAAC,KAAtC,uBAAqC,CAArC;AACA,SAAA,oBAAA,GAA4BA,OAAO,CAAC,KAApC,qBAAmC,CAAnC;AACA,SAAA,oBAAA,GAA4B6xB,aAAa,CAAA,oBAAA,EAAzC,YAAyC,CAAzC;AACA,SAAA,iBAAA,GAAyB7xB,OAAO,CAAhC,iBAAgC,CAAhC;AACA,SAAA,iBAAA,GAAA,EAAA;AACA,SAAA,WAAA,GAAA,EAAA;AACA,SAAA,UAAA,GAZ6B,KAY7B,CAZ6B,CAa7B;;AACA,SAAA,aAAA,GAd6B,KAc7B,CAd6B,CAcD;;AAC5B,SAAA,iBAAA,GAAA,KAAA;AACA,SAAA,WAAA,GAhB6B,KAgB7B,CAhB6B,CAgBH;;AAC1B,SAAA,mBAAA,GAAA,CAAA;AACA,SAAA,oBAAA,GAA4BA,OAAO,CAAnC,oBAAmC,CAAnC;AACA,SAAA,mBAAA,GAAA,EAAA;AACA,SAAA,aAAA,GAAA,KAAA;AACA,SAAA,cAAA,GAAA,KAAA;AACA,SAAA,eAAA,GAAA,KAAA;AACA,SAAA,EAAA,GAAA,EAAA;AACA,SAAA,cAAA,GAAsB,IAAA,cAAA,CAAmByrB,SAAS,IAAlD,EAAsB,CAAtB;AACA,SAAA,YAAA,GAAoB,IAzBS,YAyBT,EAApB,CAzB6B,CA0B7B;;AACA,SAAA,eAAA,CAAqB,KAAA,cAAA,CAAA,QAAA,CAAA,OAAA,IAArB,EAAA;AACA,SAAA,aAAA,CAAmB,KAAA,cAAA,CAAnB,QAAA;AACA,SAAA,eAAA,CA7B6B,OA6B7B,EA7B6B,CA6BE;;AAC/B,SAAA,OAAA;AACA,SAAA,oBAAA,GAA4B,KAAA,YAAA,CAAA,KAAA,CAAA,oBAAA,CAAA,GAAA,CACnB,UAAA,wBAAA,EAAoC;AACzC,aAAO,IAAA,wBAAA,CAAP,KAAO,CAAP;AAFJ,KAA4B,CAA5B;AAIH;;AACDmG,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,eAAAA,GAAqC,UAAA,YAAA,EAAwB;AACzD,QAAIE,UAAU,GAAGC,gBAAgB,CAAjC,YAAiC,CAAjC;;AACA,SAAK,IAAI56B,EAAE,GAAN,CAAA,EAAY66B,YAAY,GAA7B,UAAA,EAA4C76B,EAAE,GAAG66B,YAAY,CAA7D,MAAA,EAAsE76B,EAAtE,EAAA,EAA4E;AACxE,UAAI86B,SAAS,GAAGD,YAAY,CAA5B,EAA4B,CAA5B;AACA,WAAA,YAAA,CAAA,GAAA,CAAA,SAAA;AACH;AALLJ,GAAAA;;AAOAx4B,EAAAA,MAAM,CAANA,cAAAA,CAAsBw4B,QAAQ,CAA9Bx4B,SAAAA,EAAAA,MAAAA,EAAkD;AAC9C;AACAgL,IAAAA,GAAG,EAAE,SAAA,GAAA,GAAY;AACb,aAAO,KAAA,SAAA,GAAiB,KAAA,SAAA,CAAjB,IAAA,GAAP,IAAA;AAH0C,KAAA;AAK9CC,IAAAA,UAAU,EALoC,IAAA;AAM9CC,IAAAA,YAAY,EAAE;AANgC,GAAlDlL,EA5CsC,CAoDtC;AACA;;AACAw4B,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,MAAAA,GAA4B,YAAY;AACpC,QAAI,CAAC,KAAL,SAAA,EAAqB;AACjB,WAAA,oBAAA,GAA4B32B,qBAA5B,EAAA;AACA,WAAA,YAAA;AACA,WAAA,aAAA;AAHJ,KAAA,MAKK;AACD,WAAA,eAAA,CAAA,IAAA;AACH;AARL22B,GAAAA;;AAUAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,OAAAA,GAA6B,YAAY;AACrC,QAAI,KAAJ,SAAA,EAAoB;AAChB,WAAA,cAAA;AACA,WAAA,SAAA,CAFgB,OAEhB,GAFgB,CAEU;;AAC1B,WAAA,SAAA,GAHgB,IAGhB,CAHgB,CAGO;;AACvB,WAAK,IAAIz6B,EAAE,GAAN,CAAA,EAAY5D,EAAE,GAAG,KAAtB,oBAAA,EAAiD4D,EAAE,GAAG5D,EAAE,CAAxD,MAAA,EAAiE4D,EAAjE,EAAA,EAAuE;AACnE,YAAIyT,WAAW,GAAGrX,EAAE,CAApB,EAAoB,CAApB;AACAqX,QAAAA,WAAW,CAAXA,OAAAA;AACH;;AACD,WAAA,eAAA,CAAA,YAAA;AACH;AA1EiC,GAgEtCgnB,CAhEsC,CA4EtC;AACA;;;AACAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,YAAAA,GAAkC,YAAY;AAC1C,QAAI7f,KAAK,GADiC,IAC1C,CAD0C,CAE1C;;;AACA,SAAA,qBAAA,GAA6BphB,gBAAgB,CAAC,KAAD,EAAA,EAAA,OAAA,EAAA,cAAA,EAAmC,UAAA,EAAA,EAAA,QAAA,EAAwB;AACpG,UAAIijB,WAAW,GAAGse,QAAQ,CAARA,YAAAA,CAAlB,WAAkBA,CAAlB;AACAte,MAAAA,WAAW,GAAGA,WAAW,GAAGM,IAAI,CAAJA,KAAAA,CAAH,WAAGA,CAAH,GAAzBN,EAAAA;AACA,UAAI5a,OAAO,GAAG+Y,KAAK,CAAnB,OAAA;AACA,UAAIogB,UAAU,GAAGn5B,OAAO,CAAPA,YAAAA,CAAqB4a,WAAW,CAAjD,IAAiB5a,CAAjB;AACA,UAAI6vB,QAAQ,GAAGjV,WAAW,CAL0E,IAKpG,CALoG,CAMpG;;AACA,UAAIwe,YAAY,GAAGrgB,KAAK,CAALA,OAAAA,CAAc,YAAYrD,qBAAqB,CAAjC,QAAiC,CAAjC,GAAjC,OAAmBqD,CAAnB;;AACA,UAAI,OAAA,YAAA,KAAJ,UAAA,EAAwC;AACpCqgB,QAAAA,YAAY,CAACp5B,OAAO,CAAPA,MAAAA,CAAD,UAACA,CAAD,EAAZo5B,EAAY,CAAZA;AADJ,OAAA,MAGK;AACD,YAAI,OAAA,YAAA,KAAJ,QAAA,EAAsC;AAClCvJ,UAAAA,QAAQ,GAARA,YAAAA;AACH;;AACD9W,QAAAA,KAAK,CAALA,MAAAA,CAAAA,UAAAA,EAAAA,QAAAA;AACH;AAhBL,KAA6C,CAA7C;;AAkBA,QAAI,KAAA,GAAA,CAAJ,oBAAI,CAAJ,EAAoC;AAChChjB,MAAAA,MAAM,CAANA,gBAAAA,CAAAA,QAAAA,EAAkC,KAAA,iBAAA,GAAyBsjC,QAAQ,EAAC;AACpE,WAAA,YAAA,CAAA,IAAA,CADmE,IACnE,CADmE,EACrC,KAAA,GAAA,CAD9BtjC,mBAC8B,CADqC,CAAnEA;AAEH;AAxBL6iC,GAAAA;;AA0BAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,cAAAA,GAAoC,YAAY;AAC5C,SAAA,qBAAA;;AACA,QAAI,KAAJ,iBAAA,EAA4B;AACxB7iC,MAAAA,MAAM,CAANA,mBAAAA,CAAAA,QAAAA,EAAqC,KAArCA,iBAAAA;AACA,WAAA,iBAAA,GAAA,IAAA;AACH;AA7GiC,GAwGtC6iC,CAxGsC,CA+GtC;AACA;;;AACAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,OAAAA,GAA6B,YAAY;AACrC,QAAI7f,KAAK,GAAT,IAAA;;AACA,SAAA,KAAA,GAAa,KAAb,iBAAa,EAAb;AACA,QAAIugB,UAAU,GAAG,KAAA,GAAA,CAAA,cAAA,KAAjB,EAAA;AACA,QAAIC,eAAe,GAAG,KAAA,GAAA,CAAtB,QAAsB,CAAtB;AACA,QAAIC,OAAO,GAL0B,EAKrC,CALqC,CAKnB;;AAClB,QAAA,eAAA,EAAqB;AACjBF,MAAAA,UAAU,CAAVA,OAAAA,CAAAA,eAAAA;AACH;;AACD,SAAK,IAAIn7B,EAAE,GAAN,CAAA,EAAYs7B,YAAY,GAA7B,UAAA,EAA4Ct7B,EAAE,GAAGs7B,YAAY,CAA7D,MAAA,EAAsEt7B,EAAtE,EAAA,EAA4E;AACxE,UAAIu7B,SAAS,GAAGD,YAAY,CAA5B,EAA4B,CAA5B;AACA,UAAI/hB,MAAM,GAAGiiB,gBAAgB,CAAA,SAAA,EAA7B,IAA6B,CAA7B;;AACA,UAAA,MAAA,EAAY;AACRH,QAAAA,OAAO,CAAPA,IAAAA,CAAAA,MAAAA;AACH;AACJ;;AACD,SAAA,cAAA,CAAoB,YAAY;AAC5BzgB,MAAAA,KAAK,CAALA,QAAAA,CAAe;AAAE9N,QAAAA,IAAI,EAAE;AAAR,OAAf8N,EAD4B,CACM;;;AAClCA,MAAAA,KAAK,CAALA,QAAAA,CAAe;AAAE9N,QAAAA,IAAI,EAAN,mBAAA;AAA6BuuB,QAAAA,OAAO,EAAEA;AAAtC,OAAfzgB;;AACAA,MAAAA,KAAK,CAALA,QAAAA,CAAe;AACX9N,QAAAA,IAAI,EADO,eAAA;AAEX4kB,QAAAA,QAAQ,EAAE9W,KAAK,CAALA,GAAAA,CAAAA,aAAAA,KAA4BA,KAAK,CAALA,YAAAA,CAAAA,KAAAA,CAAyBgH;AAFpD,OAAfhH;AAHJ,KAAA;AAhBJ6f,GAAAA;;AAyBAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,iBAAAA,GAAuC,YAAY;AAC/C,WAAO;AACH/I,MAAAA,QAAQ,EADL,IAAA;AAEHa,MAAAA,YAAY,EAFT,CAAA;AAGHF,MAAAA,uBAAuB,EAHpB,CAAA;AAIHtC,MAAAA,WAAW,EAAE,KAJV,cAIU,EAJV;AAKH/d,MAAAA,WAAW,EALR,IAAA;AAMHF,MAAAA,YAAY,EANT,EAAA;AAOHjO,MAAAA,UAAU,EAAEC,qBAPT,EAAA;AAQH4P,MAAAA,aAAa,EARV,IAAA;AASHE,MAAAA,cAAc,EATX,EAAA;AAUHJ,MAAAA,SAAS,EAVN,IAAA;AAWHK,MAAAA,WAAW,EAAE;AAXV,KAAP;AADJ4mB,GAAAA;;AAeAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,QAAAA,GAA8B,UAAA,MAAA,EAAkB;AAC5C,SAAA,WAAA,CAAA,IAAA,CAAA,MAAA;;AACA,QAAI,CAAC,KAAL,UAAA,EAAsB;AAClB,WAAA,UAAA,GAAA,IAAA;AACA,UAAIgB,QAAQ,GAAG,KAAf,KAAA;;AACA,aAAO,KAAA,WAAA,CAAP,MAAA,EAAgC;AAC5B,aAAA,KAAA,GAAa,KAAA,MAAA,CAAY,KAAZ,KAAA,EAAwB,KAAA,WAAA,CAAxB,KAAwB,EAAxB,EAAb,IAAa,CAAb;AACH;;AACD,UAAIC,QAAQ,GAAG,KAAf,KAAA;AACA,WAAA,UAAA,GAAA,KAAA;;AACA,UAAI,CAACD,QAAQ,CAAT,YAAA,IAA0BC,QAAQ,CAAtC,YAAA,EAAqD;AACjD,aAAA,eAAA,CAAA,SAAA,EAAgC,CAAhC,IAAgC,CAAhC;AADJ,OAAA,MAGK,IAAID,QAAQ,CAARA,YAAAA,IAAyB,CAACC,QAAQ,CAAtC,YAAA,EAAqD;AACtD,aAAA,eAAA,CAAA,SAAA,EAAgC,CAAhC,KAAgC,CAAhC;AACH;;AACD,UAAIprB,IAAI,GAAG,KAAA,SAAA,IAAkB,KAAA,SAAA,CAA7B,IAAA;;AACA,UAAImrB,QAAQ,CAARA,UAAAA,KAAwBC,QAAQ,CAAhCD,UAAAA,IAA+C,KAAnD,iBAAA,EAA2E;AACvE,YAAIA,QAAQ,CAAZ,UAAA,EAAyB;AACrB,eAAA,eAAA,GAAA,IAAA;AACH;AACJ;;AACD,UAAIA,QAAQ,CAARA,WAAAA,KAAyBC,QAAQ,CAAjCD,WAAAA,IAAiD,KAArD,iBAAA,EAA6E;AACzE,YAAIA,QAAQ,CAARA,WAAAA,IAAJ,IAAA,EAAkC;AAAE;AAChC,eAAA,eAAA,CAAA,cAAA,EAAqC,CACjC;AACInrB,YAAAA,IAAI,EADR,IAAA;AAEIzc,YAAAA,EAAE,EAAEyc,IAAI,CAACzc;AAFb,WADiC,CAArC;AAMH;;AACD,aAAA,cAAA,GAAA,IAAA;AACH;;AACD,UAAI4nC,QAAQ,CAARA,QAAAA,KAAsBC,QAAQ,CAA9BD,QAAAA,IAA2C,KAA/C,iBAAA,EAAuE;AACnE,YAAIA,QAAQ,CAARA,QAAAA,IAAJ,IAAA,EAA+B;AAAE;AAC7B,eAAA,eAAA,CAAA,qBAAA,EAA4C,CACxC;AACInrB,YAAAA,IAAI,EADR,IAAA;AAEIzc,YAAAA,EAAE,EAAEyc,IAAI,CAACzc;AAFb,WADwC,CAA5C;AAMH;;AACD,aAAA,aAAA,GAAA,IAAA;AACH;;AACD,WAAA,eAAA;AACH;AA7CL4mC,GAAAA;;AA+CAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,MAAAA,GAA4B,UAAA,KAAA,EAAA,MAAA,EAAA,QAAA,EAAmC;AAC3D,WAAOkB,MAAM,CAAA,KAAA,EAAA,MAAA,EAAb,QAAa,CAAb;AAzMkC,GAwMtClB,CAxMsC,CA2MtC;AACA;;;AACAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,eAAAA,GAAqC,UAAA,SAAA,EAAqB;AACtD,QAAImB,SAAS,KAAK,KAAlB,CAAA,EAA0B;AAAEA,MAAAA,SAAS,GAATA,KAAAA;AAAoB;;AAChD,SAAA,aAAA,GAAA,IAAA;AACA,SAAA,iBAAA,GAAyB,KAAA,iBAAA,IAAzB,SAAA;AACA,SAJsD,eAItD,GAJsD,CAI9B;AAJ5BnB,GAAAA;;AAMAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,WAAAA,GAAiC,YAAY;AACzC,QAAI,KAAA,SAAA,IAAkB;AAClB,SADA,aAAA,IACsB;AACtB,KAAC,KAFD,mBAAA,IAE6B;AAC7B,KAAC,KAHL,WAAA,CAGsB;AAHtB,MAIE;AACE,aAAA,aAAA;AACH;AAPLA,GAAAA;;AASAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,cAAAA,GAAoC,UAAA,IAAA,EAAgB;AAChD,SAAA,mBAAA;AACAz7B,IAAAA,IAAI;AACJ,SAAA,mBAAA;;AACA,QAAI,KAAJ,aAAA,EAAwB;AACpB,WAAA,eAAA;AACH;AAlOiC,GA4NtCy7B,CA5NsC,CAoOtC;AACA;;;AACAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,aAAAA,GAAmC,YAAY;AAC3C,QAAIoB,iBAAiB,GAAG,KADmB,iBAC3C,CAD2C,CACK;AAChD;;AACA,SAAA,aAAA,GAAA,KAAA;AACA,SAAA,iBAAA,GAAA,KAAA;AACA,SAAA,WAAA,GAAA,IAAA;AACA,SAAA,eAAA,CAAA,iBAAA;AACA,SAAA,WAAA,GAP2C,KAO3C,CAP2C,CAQ3C;;AACA,QAAI,KAAJ,aAAA,EAAwB;AACpB,WAAA,eAAA;AACH;AAXLpB,GAAAA;AAaA;AACJ;AACA;;;AACIA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,eAAAA,GAAqC,UAAA,SAAA,EAAqB;AACtD,QAAIr+B,EAAE,GAAN,IAAA;AAAA,QAAe2X,KAAK,GAAG3X,EAAE,CAAzB,KAAA;AAAA,QAAiCogB,SAAS,GAAGpgB,EAAE,CAA/C,SAAA;;AACA,QAAIs1B,QAAQ,GAAG3d,KAAK,CAApB,QAAA;AACA,QAAI0b,QAAQ,GAAG,KAAA,SAAA,CAAf,QAAe,CAAf;AACA,QAAIqM,WAAW,GAAIF,SAAS,IAAV,SAACA,GAA0Bpf,SAAS,CAATA,IAAAA,CAA3B,WAA2BA,EAA1Bof,GAAnB,IAAA;;AACA,QAAI,CAAJ,QAAA,EAAe;AACX,YAAM,IAAA,KAAA,CAAU,iBAAA,QAAA,GAAhB,iBAAM,CAAN;AANkD,KAAA,CAQtD;AACA;;;AACA,QAAIG,oBAAoB,GAAG,KAAA,oBAAA,GACtBhoB,KAAK,CAALA,uBAAAA,IAAiC,CAAC,KAAA,GAAA,CAAnC,2BAAmC,CAAlCA,GACG,KADJ,oBAACA,GAEGA,KAAK,CAHb,UAAA;AAIA,QAAIioB,iBAAiB,GAAG,KAAA,sBAAA,CAA4BvM,QAAQ,CAA5D,OAAwB,CAAxB;AACA,QAAIwM,eAAe,GAAG,KAAA,oBAAA,CAA0BloB,KAAK,CAArD,YAAsB,CAAtB;AACA,QAAI9C,YAAY,GAAG,KAAA,YAAA,GAAoB,KAAA,iBAAA,CAAuB8qB,oBAAoB,CAA3C,IAAA,EAAA,iBAAA,EAAvC,eAAuC,CAAvC;;AACA,QAAIH,SAAS,IAAI,CAAjB,SAAA,EAA6B;AACzB,UAAA,SAAA,EAAe;AACXpf,QAAAA,SAAS,CADE,YACXA,GADW,CACe;;AAC1BA,QAAAA,SAAS,CAATA,OAAAA;AACH;;AACDA,MAAAA,SAAS,GAAG,KAAA,SAAA,GAAiB,IAAA,iBAAA,CAAsB;AAC/CpY,QAAAA,QAAQ,EADuC,IAAA;AAE/CkM,QAAAA,IAAI,EAF2C,IAAA;AAG/CzO,QAAAA,OAAO,EAAE,KAHsC,OAAA;AAI/Cmb,QAAAA,KAAK,EAAE,KAJwC,KAAA;AAK/ClS,QAAAA,OAAO,EAAE,KAAA,cAAA,CAAoB9R;AALkB,OAAtB,EAM1B,KANHwjB,EAA6B,CAA7BA;AAOA,WAAA,aAAA,GAAA,IAAA;AACA,WAAA,cAAA,GAAA,IAAA;AACA,WAAA,eAAA,GAAA,IAAA;AACH;;AACDA,IAAAA,SAAS,CAATA,YAAAA,CAAuBra,OAAQ,CAAA,EAAA,EAAA,KAAA,EAAY;AAAEstB,MAAAA,QAAQ,EAAV,QAAA;AAAsBzd,MAAAA,WAAW,EAAE+B,KAAK,CAAxC,WAAA;AAAsD+jB,MAAAA,oBAAoB,EAAE,KAAA,qBAAA,CAA5E,QAA4E,CAA5E;AAAkHj0B,MAAAA,UAAU,EAA5H,oBAAA;AAAoJoN,MAAAA,YAAY,EAAhK,YAAA;AAAgLyC,MAAAA,aAAa,EAAEK,KAAK,CAApM,aAAA;AAAoNH,MAAAA,cAAc,EAAEG,KAAK,CAAzO,cAAA;AAA0PP,MAAAA,SAAS,EAAEO,KAAK,CAA1Q,SAAA;AAAsRF,MAAAA,WAAW,EAAEE,KAAK,CAACF;AAAzS,KAAZ,CAA/B2I;;AACA,QAAA,WAAA,EAAiB;AACbA,MAAAA,SAAS,CAATA,IAAAA,CAAAA,WAAAA,CAAAA,WAAAA,EAAAA,KAAAA;AACH;;AACD,QAAI,KAAJ,aAAA,EAAwB;AACpB,WAAA,aAAA,GAAA,KAAA;AACA,WAAA,eAAA,CAAA,oBAAA,EAA2C,CACvC;AACIlM,QAAAA,IAAI,EAAEkM,SAAS,CADnB,IAAA;AAEI3oB,QAAAA,EAAE,EAAE2oB,SAAS,CAATA,IAAAA,CAAe3oB;AAFvB,OADuC,CAA3C;AAMH;;AACD,QAAI,KAAJ,cAAA,EAAyB;AACrB,WAAA,cAAA,GAAA,KAAA;AACA,WAAA,eAAA,CAAA,aAAA,EAAoC,CAChC;AACIyc,QAAAA,IAAI,EAAEkM,SAAS,CADnB,IAAA;AAEI3oB,QAAAA,EAAE,EAAE2oB,SAAS,CAATA,IAAAA,CAAe3oB;AAFvB,OADgC,CAApC;AAMH;;AACD,QAAI,KAAJ,eAAA,EAA0B;AACtB,WAAA,eAAA,GAAA,KAAA;AACH;;AACD,SAAA,0BAAA;AAhTkC,GAsPtC4mC,CAtPsC,CAkTtC;AACA;;;AACAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,SAAAA,GAA+B,UAAA,IAAA,EAAA,GAAA,EAAqB;AAChD,QAAA,EAAA;;AACA,SAAA,aAAA,EAAoBr+B,EAAE,GAAFA,EAAAA,EAASA,EAAE,CAAFA,IAAE,CAAFA,GAATA,GAAAA,EAApB,EAAA,GAAA,EAAA,EAAA,IAAA;AAFJq+B,GAAAA;;AAIAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,SAAAA,GAA+B,UAAA,IAAA,EAAgB;AAC3C,WAAO,KAAA,cAAA,CAAA,QAAA,CAAP,IAAO,CAAP;AADJA,GAAAA;;AAGAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,GAAAA,GAAyB,UAAA,IAAA,EAAgB;AACrC,WAAO,KAAA,cAAA,CAAA,QAAA,CAAP,IAAO,CAAP;AADJA,GAAAA;;AAGAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,OAAAA,GAA6B,UAAA,IAAA,EAAgB;AACzC,WAAO,KAAA,QAAA,GAAP,IAAO,CAAP;AADJA,GAAAA;;AAGAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,QAAAA,GAA8B,YAAY;AACtC,WAAO,KAAA,SAAA,CAAe,KAAA,KAAA,CAAf,QAAA,EAAP,OAAA;AADJA,GAAAA;AAGA;AACJ;AACA;;;AACIA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,aAAAA,GAAmC,UAAA,OAAA,EAAA,QAAA,EAAA,SAAA,EAAA,SAAA,EAAmD;AAClF,QAAI7f,KAAK,GAAT,IAAA;;AACA,QAAIshB,cAAc,GAAG,KAAA,YAAA,CAAA,KAAA,CAArB,oBAAA;AACA,QAAIC,aAAa,GAAjB,EAAA;AACA,QAAIC,cAAc,GAAlB,EAAA;AACA,QAAIxpB,UAAU,GAAG,KALiE,OAKlF,CALkF,CAKnD;;AAC/B,QAAIypB,eAAe,GAAnB,KAAA;AACA,QAAIC,WAAW,GAAf,KAAA;AACA,QAAIC,mBAAmB,GAAGr3B,OAAO,CAACoO,QAAQ,CAA1C,MAAiC,CAAjC;;AACA,SAAK,IAAL,MAAA,IAAA,OAAA,EAA4B;AACxB,UAAI4oB,cAAc,CAAlB,MAAkB,CAAlB,EAA4B;AACxBE,QAAAA,cAAc,CAAdA,MAAc,CAAdA,GAAyBI,OAAO,CAAhCJ,MAAgC,CAAhCA;AADJ,OAAA,MAGK;AACDD,QAAAA,aAAa,CAAbA,MAAa,CAAbA,GAAwBK,OAAO,CAA/BL,MAA+B,CAA/BA;AACH;AACJ;;AACD,SAAK,IAAL,MAAA,IAAA,aAAA,EAAkC;AAC9B,UAAI,uCAAA,IAAA,CAAJ,MAAI,CAAJ,EAAyD;AACrDG,QAAAA,WAAW,GAAXA,IAAAA;AADJ,OAAA,MAGK,IAAI,8BAAA,IAAA,CAAJ,MAAI,CAAJ,EAAA,CAAA,KACA;AACDC,QAAAA,mBAAmB,GAAnBA,IAAAA;;AACA,YAAI1xB,MAAM,KAAV,UAAA,EAA2B;AACvBwxB,UAAAA,eAAe,GAAfA,IAAAA;AACH;AACJ;AACJ;;AACD,SAAA,cAAA,CAAA,MAAA,CAAA,aAAA,EAAA,QAAA,EAAA,SAAA;;AACA,QAAA,mBAAA,EAAyB;AACrB,WAAA,aAAA,CAAmB,KAAA,cAAA,CAAnB,QAAA;AACA,WAAA,iBAAA,GAAA,IAAA;AACH;;AACD,SAAA,cAAA,CAAoB,YAAY;AAC5B,UAAA,mBAAA,EAAyB;AACrB,YAAA,eAAA,EAAqB;AACjBzhB,UAAAA,KAAK,CAALA,QAAAA,CAAe;AACX9N,YAAAA,IAAI,EADO,iBAAA;AAEX8F,YAAAA,UAAU,EAAEA;AAFD,WAAfgI;AAIH;AACD;AAChB;AACA;AACA;;;AACgBA,QAAAA,KAAK,CAALA,QAAAA,CAAe;AACX9N,UAAAA,IAAI,EADO,eAAA;AAEX4kB,UAAAA,QAAQ,EAAE9W,KAAK,CAALA,KAAAA,CAAY8W;AAFX,SAAf9W;AAXJ,OAAA,MAgBK,IAAA,WAAA,EAAiB;AAClBA,QAAAA,KAAK,CAALA,UAAAA;AAlBwB,OAAA,CAoB5B;;;AACA,UAAA,SAAA,EAAe;AACX,aAAK,IAAL,MAAA,IAAA,cAAA,EAAmC;AAC/BshB,UAAAA,cAAc,CAAdA,MAAc,CAAdA,CAAuBE,cAAc,CAArCF,MAAqC,CAArCA,EAAAA,KAAAA,EAAAA,SAAAA;AACH;AACJ;AAzBL,KAAA;AAlCJzB,GAAAA;AA8DA;AACJ;AACA;;;AACIA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,aAAAA,GAAmC,UAAA,OAAA,EAAmB;AAClD,QAAI7f,KAAK,GAAT,IAAA;;AACA,QAAI6hB,WAAW,GAAG,KAAA,YAAA,CAAlB,KAAA;AACA,SAAA,0BAAA,GAAkCn7B,cAAc,CAACwJ,OAAO,CAAxD,0BAAgD,CAAhD;AACA,SAAA,yBAAA,GAAiCxJ,cAAc,CAACwJ,OAAO,CAAvD,yBAA+C,CAA/C;AACA,SAAA,eAAA,GAAuB,KAAA,oBAAA,CAA0BA,OAAO,CAAxD,aAAuB,CAAvB;AACA,SAAA,KAAA,GAAa,KAAA,UAAA,CAAb,OAAa,CAAb;AACA,QAAIogB,SAAS,GAAG,KAAA,eAAA,CAAqBpgB,OAAO,CAA5C,OAAgB,CAAhB;AACA,SAAA,mBAAA,GAA2BogB,SAAS,CAApC,GAAA;AACA,QAAIxgB,MAAM,GAAG,KAAA,WAAA,CAAiBI,OAAO,CAAPA,MAAAA,IAAkBogB,SAAS,CAA5C,WAAA,EAA0DA,SAAS,CAAhF,GAAa,CAAb;AACA,SAAA,OAAA,GAAe,KAAA,YAAA,CAAA,MAAA,EAA0BpgB,OAAO,CAAjC,QAAA,EAA4C2xB,WAAW,CAAvD,kBAAA,EAA4E3xB,OAAO,CAAnF,QAAA,EAA8FA,OAAO,CAArG,qBAAA,EAA6HA,OAAO,CAApI,SAAA,EAAgJ2xB,WAAW,CAA1K,YAAe,CAAf;AACA,SAAA,eAAA,GAAuB,KAAA,oBAAA,CAX2B,OAW3B,CAAvB,CAXkD,CAWS;AAC3D;;AACA,SAAA,SAAA,GAAiBC,cAAc,CAACD,WAAW,CAAZ,KAAA,EAAoB,KAbD,cAanB,CAA/B,CAbkD,CAclD;;AACA,SAAA,qBAAA,GAA6B3rB,OAAO,CAAC,KAAD,SAAA,EAAiB,UAAA,QAAA,EAAoB;AACrE,aAAO,IAAI2e,QAAQ,CAARA,KAAAA,CAAAA,SAAAA,CAAJ,yBAAA,CAAA,QAAA,EAAP,KAAO,CAAP;AADJ,KAAoC,CAApC;AAfJgL,GAAAA;;AAmBAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,uBAAAA,GAA6C,YAAY;AACrD,WAAOx4B,MAAM,CAANA,IAAAA,CAAY,KAAnB,mBAAOA,CAAP;AADJw4B,GAAAA;;AAGAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,qBAAAA,GAA2C,UAAA,OAAA,EAAmB;AAC1D,WAAOkC,oBAAoB,CAAA,QAAA,EAAA,OAAA,EAA3B,IAA2B,CAA3B;AADJlC,GAAAA;;AAGAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,uBAAAA,GAA6C,UAAA,OAAA,EAAmB;AAC5D,QAAImC,OAAO,CAAX,QAAA,EAAsB;AAAE;AACpBA,MAAAA,OAAO,GAAGz6B,OAAQ,CAAA,EAAA,EAAA,OAAA,EAAc;AAAE06B,QAAAA,aAAa,EAAE;AAAjB,OAAd,CAAlBD;AACH;;AACD,WAAOD,oBAAoB,CAAA,OAAA,EAAA,OAAA,EAA3B,IAA2B,CAA3B;AArakC,GAiatClC,CAjasC,CAuatC;AACA;;;AACAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,iBAAAA,GAAuC,UAAA,IAAA,EAAgB;AACnD,WAAO,KAAA,WAAA,CAAA,IAAA,KACH,KAAA,GAAA,CAF+C,IAE/C,CADJ,CADmD,CAE/B;AAFxBA,GAAAA;;AAIAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,eAAAA,GAAqC,UAAA,IAAA,EAAA,IAAA,EAAsB;AACvD,QAAIqC,UAAU,GAAG,KAAA,GAAA,CAAjB,IAAiB,CAAjB;AACA,SAAA,WAAA,CAAA,IAAA,EAAA,IAAA,EAAA,IAAA;;AACA,QAAA,UAAA,EAAgB;AACZ,aAAOA,UAAU,CAAVA,KAAAA,CAAAA,IAAAA,EAAP,IAAOA,CAAP;AACH;AALLrC,GAAAA;;AAOAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,0BAAAA,GAAgD,UAAA,IAAA,EAAA,IAAA,EAAsB;AAClE,QAAIsC,mBAAmB,GAAG,KAA1B,mBAAA;AACA,KAACA,mBAAmB,CAAnBA,IAAmB,CAAnBA,KAA8BA,mBAAmB,CAAnBA,IAAmB,CAAnBA,GAA/B,EAACA,CAAD,EAAA,IAAA,CAAA,IAAA;AAFJtC,GAAAA;;AAIAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,0BAAAA,GAAgD,YAAY;AACxD,QAAIsC,mBAAmB,GAAG,KAA1B,mBAAA;;AACA,SAAK,IAAL,MAAA,IAAA,mBAAA,EAAwC;AACpC,WAAK,IAAI/8B,EAAE,GAAN,CAAA,EAAY5D,EAAE,GAAG2gC,mBAAmB,CAAzC,MAAyC,CAAzC,EAAmD/8B,EAAE,GAAG5D,EAAE,CAA1D,MAAA,EAAmE4D,EAAnE,EAAA,EAAyE;AACrE,YAAID,IAAI,GAAG3D,EAAE,CAAb,EAAa,CAAb;AACA,aAAA,eAAA,CAAA,MAAA,EAAA,IAAA;AACH;AACJ;;AACD,SAAA,mBAAA,GAAA,EAAA;AAhckC,GAwbtCq+B,CAxbsC,CAkctC;AACA;AACA;;;AACAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,eAAAA,GAAqC,UAAA,QAAA,EAAoB;AACrD,WAAOv1B,OAAO,CAAC,KAAA,SAAA,CAAf,QAAe,CAAD,CAAd;AADJu1B,GAAAA;;AAGAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,UAAAA,GAAgC,UAAA,QAAA,EAAA,WAAA,EAAiC;AAC7D,QAAIO,UAAU,GAAd,IAAA;;AACA,QAAA,WAAA,EAAiB;AACb,UAAIgC,WAAW,CAAXA,KAAAA,IAAqBA,WAAW,CAApC,GAAA,EAA0C;AAAE;AACxC,aAAA,cAAA,CAAA,MAAA,CAA2B;AAAEt7B,UAAAA,YAAY,EAAEs7B;AAAhB,SAA3B,EADsC,EACtC,EADsC,CACyB;;AAC/D,aAAA,aAAA,CAAmB,KAAA,cAAA,CAFmB,QAEtC,EAFsC,CAEY;AAFtD,OAAA,MAIK;AAAE;AACHhC,QAAAA,UAAU,GAAG,KAAA,OAAA,CAAA,YAAA,CADZ,WACY,CAAbA,CADC,CACoD;AACxD;AACJ;;AACD,SAAA,QAAA;AACA,SAAA,QAAA,CAAc;AACVluB,MAAAA,IAAI,EADM,eAAA;AAEV4kB,MAAAA,QAAQ,EAFE,QAAA;AAGVsJ,MAAAA,UAAU,EAAEA;AAHF,KAAd;AApdkC,GAwctCP,CAxcsC,CA0dtC;AACA;AACA;;;AACAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,MAAAA,GAA4B,UAAA,UAAA,EAAA,QAAA,EAAgC;AACxD,QAAA,IAAA;AACA/I,IAAAA,QAAQ,GAAGA,QAAQ,IAFqC,KAExDA,CAFwD,CAE1B;;AAC9BuL,IAAAA,IAAI,GAAG,KAAA,SAAA,CAAA,QAAA,KACH,KAAA,eAAA,CADJA,QACI,CADJA;AAEA,SAAA,QAAA;;AACA,QAAA,IAAA,EAAU;AACN,WAAA,QAAA,CAAc;AACVnwB,QAAAA,IAAI,EADM,eAAA;AAEV4kB,QAAAA,QAAQ,EAAEuL,IAAI,CAFJ,IAAA;AAGVjC,QAAAA,UAAU,EAAEA;AAHF,OAAd;AADJ,KAAA,MAOK;AACD,WAAA,QAAA,CAAc;AACVluB,QAAAA,IAAI,EADM,UAAA;AAEVkuB,QAAAA,UAAU,EAAEA;AAFF,OAAd;AAIH;AA/eiC,GA6dtCP,CA7dsC,CAiftC;AACA;;;AACAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,eAAAA,GAAqC,UAAA,IAAA,EAAgB;AACjD,QAAIje,SAAS,GAAG,KAAhB,SAAA;AACA,QAAI0gB,SAAS,GAAb,EAAA;AACA,QAAA,CAAA;AACA,QAJiD,IAIjD,CAJiD,CAKjD;;AACA,QAAI1gB,SAAS,CAAb,MAAA,EAAsB;AAClB0gB,MAAAA,SAAS,CAATA,IAAAA,CAAAA,KAAAA,CAAAA,SAAAA,EAAgC1gB,SAAS,CAATA,MAAAA,CAAhC0gB,gBAAAA;AACH;;AACD,QAAI1gB,SAAS,CAAb,MAAA,EAAsB;AAClB0gB,MAAAA,SAAS,CAATA,IAAAA,CAAAA,KAAAA,CAAAA,SAAAA,EAAgC1gB,SAAS,CAATA,MAAAA,CAAhC0gB,gBAAAA;AACH;;AACD,SAAK,IAAL,QAAA,IAAqB,KAArB,SAAA,EAAqC;AACjCA,MAAAA,SAAS,CAATA,IAAAA,CAAAA,QAAAA;AACH;;AACD,SAAKvoC,CAAC,GAAN,CAAA,EAAYA,CAAC,GAAGuoC,SAAS,CAAzB,MAAA,EAAkCvoC,CAAlC,EAAA,EAAuC;AACnCsoC,MAAAA,IAAI,GAAG,KAAA,SAAA,CAAeC,SAAS,CAA/BD,CAA+B,CAAxB,CAAPA;;AACA,UAAA,IAAA,EAAU;AACN,YAAIA,IAAI,CAAJA,UAAAA,KAAJ,IAAA,EAA8B;AAC1B,iBAAA,IAAA;AACH;AACJ;AACJ;AAzgBiC,GAmftCxC,CAnfsC,CA2gBtC;AACA;;;AACAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,cAAAA,GAAoC,YAAY;AAC5C,QAAI0C,gBAAgB,GAAG,KAAA,GAAA,CADqB,aACrB,CAAvB,CAD4C,CAE5C;;AACA,QAAIA,gBAAgB,IAApB,IAAA,EAA8B;AAC1B,aAAO,KAAA,OAAA,CAAA,YAAA,CAAP,gBAAO,CAAP;AADJ,KAAA,MAGK;AACD,aAAO,KADN,MACM,EAAP,CADC,CACqB;AACzB;AARL1C,GAAAA;;AAUAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,IAAAA,GAA0B,YAAY;AAClC,SAAA,QAAA;AACA,SAAA,QAAA,CAAc;AAAE3tB,MAAAA,IAAI,EAAE;AAAR,KAAd;AAFJ2tB,GAAAA;;AAIAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,IAAAA,GAA0B,YAAY;AAClC,SAAA,QAAA;AACA,SAAA,QAAA,CAAc;AAAE3tB,MAAAA,IAAI,EAAE;AAAR,KAAd;AAFJ2tB,GAAAA;;AAIAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,QAAAA,GAA8B,YAAY;AACtC,SAAA,QAAA;AACA,SAAA,QAAA,CAAc;AACV3tB,MAAAA,IAAI,EADM,UAAA;AAEVkuB,MAAAA,UAAU,EAAE,KAAA,OAAA,CAAA,QAAA,CAAsB,KAAA,KAAA,CAAtB,WAAA,EAA8C,CAA9C,CAAA;AAFF,KAAd;AAFJP,GAAAA;;AAOAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,QAAAA,GAA8B,YAAY;AACtC,SAAA,QAAA;AACA,SAAA,QAAA,CAAc;AACV3tB,MAAAA,IAAI,EADM,UAAA;AAEVkuB,MAAAA,UAAU,EAAE,KAAA,OAAA,CAAA,QAAA,CAAsB,KAAA,KAAA,CAAtB,WAAA,EAAA,CAAA;AAFF,KAAd;AAFJP,GAAAA;;AAOAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,KAAAA,GAA2B,YAAY;AACnC,SAAA,QAAA;AACA,SAAA,QAAA,CAAc;AACV3tB,MAAAA,IAAI,EADM,UAAA;AAEVkuB,MAAAA,UAAU,EAAE,KAAA,MAAA;AAFF,KAAd;AAFJP,GAAAA;;AAOAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,QAAAA,GAA8B,UAAA,cAAA,EAA0B;AACpD,SAAA,QAAA;AACA,SAAA,QAAA,CAAc;AACV3tB,MAAAA,IAAI,EADM,UAAA;AAEVkuB,MAAAA,UAAU,EAAE,KAAA,OAAA,CAAA,YAAA,CAAA,cAAA;AAFF,KAAd;AAFJP,GAAAA;;AAOAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,aAAAA,GAAmC,UAAA,UAAA,EAAsB;AACrD,QAAIjsB,KAAK,GAAGlN,cAAc,CAA1B,UAA0B,CAA1B;;AACA,QAAA,KAAA,EAAW;AAAE;AACT,WAAA,QAAA;AACA,WAAA,QAAA,CAAc;AACVwL,QAAAA,IAAI,EADM,UAAA;AAEVkuB,QAAAA,UAAU,EAAE,KAAA,OAAA,CAAA,GAAA,CAAiB,KAAA,KAAA,CAAjB,WAAA,EAAA,KAAA;AAFF,OAAd;AAIH;AAnkBiC,GA2jBtCP,CA3jBsC,CAqkBtC;;;AACAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,OAAAA,GAA6B,YAAY;AACrC,WAAO,KAAA,OAAA,CAAA,MAAA,CAAoB,KAAA,KAAA,CAA3B,WAAO,CAAP;AAvkBkC,GAskBtCA,CAtkBsC,CAykBtC;AACA;;;AACAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,UAAAA,GAAgC,UAAA,CAAA,EAAA,SAAA,EAAwB;AACpD,QAAI54B,OAAO,GAAG,KAAd,OAAA;AACA,WAAOA,OAAO,CAAPA,MAAAA,CAAeA,OAAO,CAAPA,YAAAA,CAAfA,CAAeA,CAAfA,EAAwC8M,eAAe,CAA9D,SAA8D,CAAvD9M,CAAP;AA7kBkC,GA2kBtC44B,CA3kBsC,CA+kBtC;;;AACAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,WAAAA,GAAiC,UAAA,EAAA,EAAA,EAAA,EAAA,QAAA,EAA4B;AACzD,QAAI54B,OAAO,GAAG,KAAd,OAAA;AACA,WAAOA,OAAO,CAAPA,WAAAA,CAAoBA,OAAO,CAAPA,YAAAA,CAApBA,EAAoBA,CAApBA,EAA8CA,OAAO,CAAPA,YAAAA,CAA9CA,EAA8CA,CAA9CA,EAAwE8M,eAAe,CAAA,QAAA,EAAW,KAAA,GAAA,CAAlG9M,uBAAkG,CAAX,CAAvFA,EAAP,QAAOA,CAAP;AAFJ44B,GAAAA;;AAIAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,SAAAA,GAA+B,UAAA,CAAA,EAAA,QAAA,EAAuB;AAClD,QAAI54B,OAAO,GAAG,KAAd,OAAA;AACA,WAAO,OAAO,CAAP,SAAA,CAAkBA,OAAO,CAAPA,YAAAA,CAAlB,CAAkBA,CAAlB,EAA2C;AAAE+a,MAAAA,QAAQ,EAAEA;AAAZ,KAA3C,CAAP;AAtlBkC,GAolBtC6d,CAplBsC,CAwlBtC;AACA;;;AACAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,YAAAA,GAAkC,UAAA,EAAA,EAAc;AAC5C,QAAI,CAAC,KAAD,sBAAA,IACA,KADA,SAAA,IACkB;AAClBrhC,IAAAA,EAAE,CAAFA,MAAAA,KAFJ,MAAA,CAEyB;AAFzB,MAGE;AACE,aAAA,sBAAA,GAAA,IAAA;AACA,aAAA,UAAA;AACA,aAAA,eAAA,CAAA,cAAA,EAAqC,CAAC,KAAtC,IAAqC,CAArC;AACA,aAAA,sBAAA,GAAA,KAAA;AACH;AATLqhC,GAAAA;;AAWAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,UAAAA,GAAgC,YAAY;AACxC,QAAI,KAAJ,SAAA,EAAoB;AAAE;AAClB,WAAA,SAAA,CAAA,UAAA,CAAA,IAAA;AACH;AAxmBiC,GAqmBtCA,CArmBsC,CA0mBtC;AACA;;;AACAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,4BAAAA,GAAkD,UAAA,SAAA,EAAA,aAAA,EAAoC;AAClF,QAAIjO,QAAQ,GAAG4Q,wBAAwB,CAAA,SAAA,EAAvC,aAAuC,CAAvC;AACA,QAAIC,oBAAoB,GAAG,CAAA,aAAA,EAA3B,aAA2B,CAA3B;AAIA,QAAIC,kBAAkB,GAAGD,oBAAoB,CAApBA,MAAAA,CAA4B,KAAA,YAAA,CAAA,KAAA,CAArD,qBAAyBA,CAAzB;AACA,QAAIE,YAAY,GAAG,kBAAkB,CAAlB,GAAA,CAAuB,UAAA,gBAAA,EAA4B;AAClE,aAAO,IAAA,gBAAA,CAAP,QAAO,CAAP;AADJ,KAAmB,CAAnB;AAGA,SAAA,iBAAA,CAAuB/gB,SAAS,CAAhC,GAAA,IAAA,YAAA;AACA6c,IAAAA,wBAAwB,CAAC7c,SAAS,CAAlC6c,GAAwB,CAAxBA,GAAAA,QAAAA;AAXJoB,GAAAA;;AAaAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,8BAAAA,GAAoD,UAAA,SAAA,EAAqB;AACrE,SAAK,IAAIz6B,EAAE,GAAN,CAAA,EAAY5D,EAAE,GAAG,KAAA,iBAAA,CAAuBogB,SAAS,CAAtD,GAAsB,CAAtB,EAA6Dxc,EAAE,GAAG5D,EAAE,CAApE,MAAA,EAA6E4D,EAA7E,EAAA,EAAmF;AAC/E,UAAIw9B,QAAQ,GAAGphC,EAAE,CAAjB,EAAiB,CAAjB;AACAohC,MAAAA,QAAQ,CAARA,OAAAA;AACH;;AACD,WAAO,KAAA,iBAAA,CAAuBhhB,SAAS,CAAvC,GAAO,CAAP;AACA,WAAO6c,wBAAwB,CAAC7c,SAAS,CAAzC,GAA+B,CAA/B;AA/nBkC,GAynBtCie,CAznBsC,CAioBtC;AACA;AACA;AACA;;;AACAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,MAAAA,GAA4B,UAAA,SAAA,EAAA,OAAA,EAA8B;AACtD,QAAA,cAAA;;AACA,QAAIgD,OAAO,IAAX,IAAA,EAAqB;AACjB,UAAIC,SAAS,CAATA,KAAAA,IAAJ,IAAA,EAA6B;AACzBC,QAAAA,cAAc,GAAdA,SAAAA;AADJ,OAAA,MAGK;AACDA,QAAAA,cAAc,GAAG;AACbz8B,UAAAA,KAAK,EADQ,SAAA;AAEbC,UAAAA,GAAG,EAAE;AAFQ,SAAjBw8B;AAIH;AATL,KAAA,MAWK;AACDA,MAAAA,cAAc,GAAG;AACbz8B,QAAAA,KAAK,EADQ,SAAA;AAEbC,QAAAA,GAAG,EAAEs8B;AAFQ,OAAjBE;AAIH;;AACD,QAAI9nB,SAAS,GAAG+nB,aAAa,CAAA,cAAA,EAAiB,KAAjB,OAAA,EAA+Bt8B,cAAc,CAAC;AAAEzG,MAAAA,IAAI,EAAE;AAAR,KAAD,CAA7C,CAA2D;AAA3D,KAA7B;;AAEA,QAAA,SAAA,EAAe;AAAE;AACb,WAAA,QAAA,CAAc;AAAEiS,QAAAA,IAAI,EAAN,cAAA;AAAwB+I,QAAAA,SAAS,EAAEA;AAAnC,OAAd;AACA,WAAA,iBAAA,CAAA,SAAA;AACH;AA7pBiC,GAqoBtC4kB,CAroBsC,CA+pBtC;;;AACAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,QAAAA,GAA8B,UAAA,GAAA,EAAe;AACzC,QAAI,KAAA,KAAA,CAAJ,aAAA,EAA8B;AAC1B,WAAA,QAAA,CAAc;AAAE3tB,QAAAA,IAAI,EAAE;AAAR,OAAd;AACA,WAAA,mBAAA,CAAA,GAAA;AACH;AAJL2tB,GAAAA;;AAMAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,iBAAAA,GAAuC,UAAA,SAAA,EAAA,GAAA,EAA0B;AAC7D,QAAIhY,GAAG,GAAGtgB,OAAQ,CAAA,EAAA,EAAK,KAAA,gBAAA,CAAL,SAAK,CAAL,EAAuC;AAAEs3B,MAAAA,OAAO,EAAEoE,GAAG,GAAGA,GAAG,CAAN,SAAA,GAAd,IAAA;AAAuCvtB,MAAAA,IAAI,EAAE,KAAKA;AAAlD,KAAvC,CAAlB;;AACA,SAAA,eAAA,CAAA,QAAA,EAA+B,CAA/B,GAA+B,CAA/B;AAFJmqB,GAAAA;;AAIAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,mBAAAA,GAAyC,UAAA,GAAA,EAAe;AACpD,SAAA,eAAA,CAAA,UAAA,EAAiC,CAC7B;AACIhB,MAAAA,OAAO,EAAEoE,GAAG,GAAGA,GAAG,CAAN,SAAA,GADhB,IAAA;AAEIvtB,MAAAA,IAAI,EAAE,KAAKA;AAFf,KAD6B,CAAjC;AA3qBkC,GA0qBtCmqB,CA1qBsC,CAkrBtC;;;AACAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,gBAAAA,GAAsC,UAAA,QAAA,EAAA,KAAA,EAAA,IAAA,EAAA,EAAA,EAAqC;AACvE,QAAIhY,GAAG,GAAGtgB,OAAQ,CAAA,EAAA,EAAK,KAAA,iBAAA,CAAL,QAAK,CAAL,EAAuC;AAAE27B,MAAAA,KAAK,EAAP,KAAA;AAAgBrE,MAAAA,OAAO,EAAvB,EAAA;AAA6B;AAClFnpB,MAAAA,IAAI,EAAEA;AAD+C,KAAvC,CAAlB;;AAEA,SAAA,eAAA,CAAA,WAAA,EAAkC,CAAlC,GAAkC,CAAlC;AAHJmqB,GAAAA;;AAKAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,iBAAAA,GAAuC,UAAA,QAAA,EAAoB;AACvD,QAAI3kC,KAAK,GAAT,EAAA;;AACA,SAAK,IAAIkK,EAAE,GAAN,CAAA,EAAY5D,EAAE,GAAG,KAAA,YAAA,CAAA,KAAA,CAAtB,mBAAA,EAAmE4D,EAAE,GAAG5D,EAAE,CAA1E,MAAA,EAAmF4D,EAAnF,EAAA,EAAyF;AACrF,UAAI+9B,SAAS,GAAG3hC,EAAE,CAAlB,EAAkB,CAAlB;;AACA+F,MAAAA,OAAQ,CAAA,KAAA,EAAQ47B,SAAS,CAAA,QAAA,EAAzB57B,IAAyB,CAAjB,CAARA;AACH;;AACDA,IAAAA,OAAQ,CAAA,KAAA,EAAQ67B,iBAAiB,CAAA,QAAA,EAAW,KAA5C77B,OAAiC,CAAzB,CAARA;;AACA,WAAA,KAAA;AAPJs4B,GAAAA;;AASAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,gBAAAA,GAAsC,UAAA,QAAA,EAAoB;AACtD,QAAI3kC,KAAK,GAAT,EAAA;;AACA,SAAK,IAAIkK,EAAE,GAAN,CAAA,EAAY5D,EAAE,GAAG,KAAA,YAAA,CAAA,KAAA,CAAtB,kBAAA,EAAkE4D,EAAE,GAAG5D,EAAE,CAAzE,MAAA,EAAkF4D,EAAlF,EAAA,EAAwF;AACpF,UAAI+9B,SAAS,GAAG3hC,EAAE,CAAlB,EAAkB,CAAlB;;AACA+F,MAAAA,OAAQ,CAAA,KAAA,EAAQ47B,SAAS,CAAA,QAAA,EAAzB57B,IAAyB,CAAjB,CAARA;AACH;;AACDA,IAAAA,OAAQ,CAAA,KAAA,EAAQ87B,gBAAgB,CAAA,QAAA,EAAW,KAA3C97B,OAAgC,CAAxB,CAARA;;AACA,WAAA,KAAA;AAxsBkC,GAisBtCs4B,CAjsBsC,CA0sBtC;AACA;AACA;;;AACAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,MAAAA,GAA4B,YAAY;AACpC,QAAI7C,GAAG,GAAG,KAAA,GAAA,CAAV,KAAU,CAAV;;AACA,QAAI,OAAA,GAAA,KAAJ,UAAA,EAA+B;AAC3BA,MAAAA,GAAG,GAAGA,GAANA,EAAAA;AACH;;AACD,QAAIA,GAAG,IAAP,IAAA,EAAiB;AACb,aAAO,KAAA,OAAA,CAAP,eAAO,EAAP;AACH;;AACD,WAAO,KAAA,OAAA,CAAA,YAAA,CAAP,GAAO,CAAP;AArtBkC,GA6sBtC6C,CA7sBsC,CAutBtC;AACA;AACA;AACA;;;AACAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,kBAAAA,GAAwC,UAAA,MAAA,EAAA,MAAA,EAA0B;AAC9D,QAAIt5B,GAAG,GAAP,MAAA;;AACA,QAAA,MAAA,EAAY;AACRA,MAAAA,GAAG,GAAG1G,UAAU,CAAhB0G,GAAgB,CAAhBA;AACAA,MAAAA,GAAG,GAAG,KAAA,OAAA,CAAA,GAAA,CAAA,GAAA,EAAsB,KAA5BA,0BAAM,CAANA;AAFJ,KAAA,MAIK;AACDA,MAAAA,GAAG,GAAG,KAAA,OAAA,CAAA,GAAA,CAAA,GAAA,EAAsB,KAA5BA,yBAAM,CAANA;AACH;;AACD,WAAA,GAAA;AApuBkC,GA2tBtCs5B,CA3tBsC,CAsuBtC;AACA;;;AACAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,QAAAA,GAA8B,UAAA,UAAA,EAAA,WAAA,EAAmC;AAC7D,QAAIyD,UAAU,YAAd,QAAA,EAAoC;AAChC,UAAIz5B,GAAG,GAAGy5B,UAAU,CAApB,IAAA;AACA,UAAI15B,QAAQ,GAAG05B,UAAU,CAFO,SAEhC,CAFgC,CAGhC;;AACA,UAAI,CAAC,KAAA,KAAA,CAAA,UAAA,CAAA,IAAA,CAA2Bz5B,GAAG,CAAnC,KAAK,CAAL,EAA4C;AACxC,aAAA,QAAA,CAAc;AACVqI,UAAAA,IAAI,EADM,YAAA;AAEVjJ,UAAAA,UAAU,EAAEM,iBAAiB,CAAC;AAAEM,YAAAA,GAAG,EAAL,GAAA;AAAYD,YAAAA,QAAQ,EAAEA;AAAtB,WAAD,CAFnB,CAEsD;;AAFtD,SAAd;AAIH;;AACD,aAAA,UAAA;AACH;;AACD,QAAA,QAAA;;AACA,QAAI25B,WAAW,YAAf,cAAA,EAA2C;AACvCpxB,MAAAA,QAAQ,GAAGoxB,WAAW,CAAXA,mBAAAA,CAAXpxB,QAAAA;AADJ,KAAA,MAGK,IAAIoxB,WAAW,IAAf,IAAA,EAAyB;AAC1B,UAAIC,SAAS,GAAG,KAAA,kBAAA,CADU,WACV,CAAhB,CAD0B,CAC4B;;AACtD,UAAI,CAAJ,SAAA,EAAgB;AACZhV,QAAAA,OAAO,CAAPA,IAAAA,CAAa,6CAAA,WAAA,GADD,GACZA,EADY,CACkE;;AAC9E,eAAA,IAAA;AAFJ,OAAA,MAIK;AACDrc,QAAAA,QAAQ,GAAGqxB,SAAS,CAATA,mBAAAA,CAAXrxB,QAAAA;AACH;AACJ;;AACD,QAAI9I,KAAK,GAAGC,UAAU,CAAA,UAAA,EAAA,QAAA,EAAtB,IAAsB,CAAtB;;AACA,QAAA,KAAA,EAAW;AACP,WAAA,QAAA,CAAc;AACV4I,QAAAA,IAAI,EADM,YAAA;AAEVjJ,QAAAA,UAAU,EAAEM,iBAAiB,CAAA,KAAA;AAFnB,OAAd;AAIA,aAAO,IAAA,QAAA,CAAA,IAAA,EAAmBF,KAAK,CAAxB,GAAA,EAA8BA,KAAK,CAALA,GAAAA,CAAAA,YAAAA,GAAAA,IAAAA,GAAgCA,KAAK,CAA1E,QAAO,CAAP;AACH;;AACD,WAAA,IAAA;AA3wBkC,GAwuBtCw2B,CAxuBsC,CA6wBtC;;;AACAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,YAAAA,GAAkC,UAAA,EAAA,EAAc;AAC5C,QAAIr+B,EAAE,GAAG,KAAA,KAAA,CAAT,UAAA;AAAA,QAAgCiI,IAAI,GAAGjI,EAAE,CAAzC,IAAA;AAAA,QAAgDkI,SAAS,GAAGlI,EAAE,CAA9D,SAAA;AACA0b,IAAAA,EAAE,GAAGrY,MAAM,CAAXqY,EAAW,CAAXA;;AACA,SAAK,IAAL,KAAA,IAAA,IAAA,EAAwB;AACpB,UAAIrT,GAAG,GAAGJ,IAAI,CAAd,KAAc,CAAd;;AACA,UAAII,GAAG,CAAHA,QAAAA,KAAJ,EAAA,EAAyB;AACrB,YAAIA,GAAG,CAAP,YAAA,EAAsB;AAClB,iBAAO,IAAA,QAAA,CAAA,IAAA,EAAA,GAAA,EAAP,IAAO,CAAP;AADJ,SAAA,MAGK;AACD,eAAK,IAAL,UAAA,IAAA,SAAA,EAAkC;AAC9B,gBAAID,QAAQ,GAAGF,SAAS,CAAxB,UAAwB,CAAxB;;AACA,gBAAIE,QAAQ,CAARA,KAAAA,KAAmBC,GAAG,CAA1B,KAAA,EAAkC;AAC9B,qBAAO,IAAA,QAAA,CAAA,IAAA,EAAA,GAAA,EAAP,QAAO,CAAP;AACH;AACJ;AACJ;AACJ;AACJ;;AACD,WAAA,IAAA;AAnBJg2B,GAAAA;;AAqBAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,SAAAA,GAA+B,YAAY;AACvC,QAAIr+B,EAAE,GAAG,KAAA,KAAA,CAAT,UAAA;AAAA,QAAgCiI,IAAI,GAAGjI,EAAE,CAAzC,IAAA;AAAA,QAAgDkI,SAAS,GAAGlI,EAAE,CAA9D,SAAA;AACA,QAAIiiC,SAAS,GAAb,EAAA;;AACA,SAAK,IAAL,EAAA,IAAA,SAAA,EAA0B;AACtB,UAAI75B,QAAQ,GAAGF,SAAS,CAAxB,EAAwB,CAAxB;AACA,UAAIG,GAAG,GAAGJ,IAAI,CAACG,QAAQ,CAAvB,KAAc,CAAd;AACA65B,MAAAA,SAAS,CAATA,IAAAA,CAAe,IAAA,QAAA,CAAA,IAAA,EAAA,GAAA,EAAfA,QAAe,CAAfA;AACH;;AACD,WAAA,SAAA;AARJ5D,GAAAA;;AAUAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,eAAAA,GAAqC,YAAY;AAC7C,SAAA,QAAA,CAAc;AAAE3tB,MAAAA,IAAI,EAAE;AAAR,KAAd;AADJ2tB,GAAAA;;AAGAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,cAAAA,GAAoC,YAAY;AAC5C,SAAA,QAAA,CAAc;AAAE3tB,MAAAA,IAAI,EAAE;AAAR,KAAd;AAjzBkC,GAgzBtC2tB,CAhzBsC,CAmzBtC;AACA;;;AACAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,eAAAA,GAAqC,YAAY;AAC7C,QAAIlL,UAAU,GAAG,KAAA,KAAA,CAAjB,YAAA;AACA,QAAI+O,UAAU,GAAd,EAAA;;AACA,SAAK,IAAL,UAAA,IAAA,UAAA,EAAmC;AAC/BA,MAAAA,UAAU,CAAVA,IAAAA,CAAgB,IAAA,cAAA,CAAA,IAAA,EAAyB/O,UAAU,CAAnD+O,UAAmD,CAAnC,CAAhBA;AACH;;AACD,WAAA,UAAA;AANJ7D,GAAAA;;AAQAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,kBAAAA,GAAwC,UAAA,EAAA,EAAc;AAClD,QAAIlL,UAAU,GAAG,KAAA,KAAA,CAAjB,YAAA;AACAzX,IAAAA,EAAE,GAAGrY,MAAM,CAAXqY,EAAW,CAAXA;;AACA,SAAK,IAAL,QAAA,IAAA,UAAA,EAAiC;AAC7B,UAAIyX,UAAU,CAAVA,QAAU,CAAVA,CAAAA,QAAAA,KAAJ,EAAA,EAA0C;AACtC,eAAO,IAAA,cAAA,CAAA,IAAA,EAAyBA,UAAU,CAA1C,QAA0C,CAAnC,CAAP;AACH;AACJ;;AACD,WAAA,IAAA;AARJkL,GAAAA;;AAUAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,cAAAA,GAAoC,UAAA,WAAA,EAAuB;AACvD,QAAI0D,WAAW,YAAf,cAAA,EAA2C;AACvC;AACA,UAAI,CAAC,KAAA,KAAA,CAAA,YAAA,CAAwBA,WAAW,CAAXA,mBAAAA,CAA7B,QAAK,CAAL,EAAwE;AACpE,aAAA,QAAA,CAAc;AACVrxB,UAAAA,IAAI,EADM,mBAAA;AAEVuuB,UAAAA,OAAO,EAAE,CAAC8C,WAAW,CAAZ,mBAAA;AAFC,SAAd;AAIH;;AACD,aAAA,WAAA;AACH;;AACD,QAAI54B,WAAW,GAAGi2B,gBAAgB,CAAA,WAAA,EAAlC,IAAkC,CAAlC;;AACA,QAAA,WAAA,EAAiB;AAAE;AACf,WAAA,QAAA,CAAc;AAAE1uB,QAAAA,IAAI,EAAN,mBAAA;AAA6BuuB,QAAAA,OAAO,EAAE,CAAA,WAAA;AAAtC,OAAd;AACA,aAAO,IAAA,cAAA,CAAA,IAAA,EAAP,WAAO,CAAP;AACH;;AACD,WAAA,IAAA;AAhBJZ,GAAAA;;AAkBAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,qBAAAA,GAA2C,YAAY;AACnD,SAAA,QAAA,CAAc;AAAE3tB,MAAAA,IAAI,EAAE;AAAR,KAAd;AADJ2tB,GAAAA;;AAGAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,aAAAA,GAAmC,YAAY;AAC3C,SAAA,QAAA,CAAc;AAAE3tB,MAAAA,IAAI,EAAE;AAAR,KAAd;AA71BkC,GA41BtC2tB,CA51BsC,CA+1BtC;AACA;;;AACAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,YAAAA,GAAkC,UAAA,SAAA,EAAqB;AACnD,QAAIh4B,QAAQ,GAAGnB,cAAc,CAA7B,SAA6B,CAA7B;;AACA,QAAA,QAAA,EAAc;AACV,WAAA,SAAA,CAAA,IAAA,CAAA,gBAAA,CAAA,QAAA;AACH;AAJLm5B,GAAAA;;AAMA,SAAA,QAAA;AAv2BJ,CAA8B,EAA9B;;AAy2BA3c,YAAY,CAAZA,OAAAA,CAAAA,QAAAA,E,CACA;AACA;;AACA,SAAA,YAAA,CAAA,MAAA,EAAA,QAAA,EAAA,iBAAA,EAAA,QAAA,EAAA,qBAAA,EAAA,SAAA,EAAA,YAAA,EAAqH;AACjH,SAAO,IAAA,OAAA,CAAY;AACfpR,IAAAA,cAAc,EADC,SAAA;AAEfF,IAAAA,QAAQ,EAFO,QAAA;AAGf+xB,IAAAA,iBAAiB,EAHF,iBAAA;AAIf7zB,IAAAA,MAAM,EAJS,MAAA;AAKfyc,IAAAA,qBAAqB,EALN,qBAAA;AAMfqX,IAAAA,QAAQ,EANO,QAAA;AAOf3U,IAAAA,SAAS,EAPM,SAAA;AAQfnI,IAAAA,YAAY,EAAEA;AARC,GAAZ,CAAP;AAUH;;AACD,SAAA,UAAA,CAAA,eAAA,EAAqC;AACjC,MAAI+c,UAAU,GAAG,KAAA,YAAA,CAAA,KAAA,CAAA,YAAA,CAAqCC,eAAe,CAApD,WAAA,KAAjB,aAAA;AACA,SAAO,IAAA,UAAA,CAAP,eAAO,CAAP;AACH;;AACD,SAAA,oBAAA,CAAA,IAAA,EAAoC;AAChC,MAAI1/B,IAAI,GAAG,KAAA,WAAA,CAAA,IAAA,CAAX,IAAW,CAAX;;AACA,MAAIsB,IAAI,IAAR,IAAA,EAAkB;AACdtB,IAAAA,IAAI,GAAGk8B,QAAQ,CAAA,IAAA,EAAfl8B,IAAe,CAAfA;AACH;;AACD,SAAA,IAAA;AACH;;AACD,SAAA,oBAAA,CAAA,YAAA,EAA4C;AACxC,SAAO8R,OAAO,CAAA,YAAA,EAAe,UAAA,WAAA,EAAuB;AAChD,WAAOvL,WAAW,CAAlB,EAAA;AADJ,GAAc,CAAd;AAGH;;AACD,SAAA,iBAAA,CAAA,SAAA,EAAA,iBAAA,EAAA,eAAA,EAA0E;AACtE,MAAI0L,YAAY,GAAG;AAAE,QAAI+qB;AAAN,GAAnB;;AACA,OAAK,IAAL,KAAA,IAAA,SAAA,EAA6B;AACzB,QAAIv3B,GAAG,GAAGk6B,SAAS,CAAnB,KAAmB,CAAnB;;AACA,QAAIl6B,GAAG,CAAHA,QAAAA,IAAgBw3B,eAAe,CAACx3B,GAAG,CAAvC,QAAmC,CAAnC,EAAmD;AAC/CwM,MAAAA,YAAY,CAAZA,KAAY,CAAZA,GAAsBgrB,eAAe,CAACx3B,GAAG,CAAzCwM,QAAqC,CAArCA;AACH;AACJ;;AACD,SAAA,YAAA;AACH;;AAED,IAAI2tB,IAAI;AAAG;AAAe,UAAA,MAAA,EAAkB;AACxC7gB,EAAAA,SAAS,CAAA,IAAA,EAATA,MAAS,CAATA;;AACA,WAAA,IAAA,CAAA,OAAA,EAAA,QAAA,EAAA,oBAAA,EAAA,QAAA,EAAiE;AAC7D,QAAInD,KAAK,GAAG,MAAM,CAAN,IAAA,CAAA,IAAA,EAAA,OAAA,EAA2B5jB,aAAa,CAAA,KAAA,EAAQ;AAAEvD,MAAAA,SAAS,EAAE,gBAAgBg8B,QAAQ,CAAxB,IAAA,GAAgC;AAA7C,KAAR,CAAxC,EAAA,IAAA,CAA8G;AAA9G,SAAZ,IAAA;;AAEA7U,IAAAA,KAAK,CAALA,cAAAA,GAAuB+a,gBAAgB,CAAC/a,KAAK,CAAN,eAAA,EAAwBA,KAAK,CAApEA,iBAAuC,CAAvCA;AACAA,IAAAA,KAAK,CAALA,sBAAAA,GAA+B+a,gBAAgB,CAAC/a,KAAK,CAAN,mBAAA,EAA4BA,KAAK,CAAjC,qBAAA,EAAyD,CAACA,KAAK,CAA9GA,cAAwG,CAAzD,CAA/CA;AACAA,IAAAA,KAAK,CAALA,sBAAAA,GAA+B+a,gBAAgB,CAAC/a,KAAK,CAAN,uBAAA,EAAgCA,KAAK,CAArC,yBAAA,EAAiE,CAACA,KAAK,CAAtHA,cAAgH,CAAjE,CAA/CA;AACAA,IAAAA,KAAK,CAALA,eAAAA,GAAwB+a,gBAAgB,CAAC/a,KAAK,CAAN,YAAA,EAAqBA,KAAK,CAA1B,cAAA,EAA2C,CAACA,KAAK,CAAzFA,cAAmF,CAA3C,CAAxCA;AACAA,IAAAA,KAAK,CAALA,uBAAAA,GAAgC+a,gBAAgB,CAAC/a,KAAK,CAAN,wBAAA,EAAiCA,KAAK,CAAtC,0BAAA,EAAmE,CAACA,KAAK,CAAzHA,eAAmH,CAAnE,CAAhDA;AACAA,IAAAA,KAAK,CAALA,kBAAAA,GAA2B+a,gBAAgB,CAAC/a,KAAK,CAAN,mBAAA,EAA4BA,KAAK,CAAjC,qBAAA,EAAyD,CAACA,KAAK,CAA1GA,cAAoG,CAAzD,CAA3CA;AACAA,IAAAA,KAAK,CAALA,oBAAAA,GAA6B+a,gBAAgB,CAAC/a,KAAK,CAAN,qBAAA,EAA8BA,KAAK,CAAnC,uBAAA,EAA6D,CAACA,KAAK,CAAhHA,cAA0G,CAA7D,CAA7CA;AACAA,IAAAA,KAAK,CAALA,QAAAA,GAAAA,QAAAA;AACAA,IAAAA,KAAK,CAALA,oBAAAA,GAAAA,oBAAAA;AACAA,IAAAA,KAAK,CAALA,IAAAA,GAAa6U,QAAQ,CAArB7U,IAAAA;AACAA,IAAAA,KAAK,CAALA,eAAAA,GAAwBikB,eAAe,CAACjkB,KAAK,CAALA,GAAAA,CAAxCA,YAAwCA,CAAD,CAAvCA;AACAA,IAAAA,KAAK,CAALA,gBAAAA,GAAyBtZ,cAAc,CAACsZ,KAAK,CAALA,GAAAA,CAAxCA,kBAAwCA,CAAD,CAAvCA;AACAie,IAAAA,QAAQ,CAARA,WAAAA,CAAqBje,KAAK,CAA1Bie,EAAAA;;AACAje,IAAAA,KAAK,CAALA,UAAAA;;AACA,WAAA,KAAA;AACH;;AACDgkB,EAAAA,IAAI,CAAJA,SAAAA,CAAAA,UAAAA,GAA4B,YAAY,CAAxCA,CAAAA;;AAEA38B,EAAAA,MAAM,CAANA,cAAAA,CAAsB28B,IAAI,CAA1B38B,SAAAA,EAAAA,aAAAA,EAAqD;AACjD;AACA;AACAgL,IAAAA,GAAG,EAAE,SAAA,GAAA,GAAY;AACb,aAAO,KAAA,OAAA,CAAA,MAAA,CAAoB,KAAA,KAAA,CAAA,WAAA,CAAA,WAAA,CAA3B,KAAO,CAAP;AAJ6C,KAAA;AAMjDC,IAAAA,UAAU,EANuC,IAAA;AAOjDC,IAAAA,YAAY,EAAE;AAPmC,GAArDlL;AASAA,EAAAA,MAAM,CAANA,cAAAA,CAAsB28B,IAAI,CAA1B38B,SAAAA,EAAAA,WAAAA,EAAmD;AAC/CgL,IAAAA,GAAG,EAAE,SAAA,GAAA,GAAY;AACb,aAAO,KAAA,OAAA,CAAA,MAAA,CAAoB,KAAA,KAAA,CAAA,WAAA,CAAA,WAAA,CAA3B,GAAO,CAAP;AAF2C,KAAA;AAI/CC,IAAAA,UAAU,EAJqC,IAAA;AAK/CC,IAAAA,YAAY,EAAE;AALiC,GAAnDlL;AAOAA,EAAAA,MAAM,CAANA,cAAAA,CAAsB28B,IAAI,CAA1B38B,SAAAA,EAAAA,cAAAA,EAAsD;AAClDgL,IAAAA,GAAG,EAAE,SAAA,GAAA,GAAY;AACb,aAAO,KAAA,OAAA,CAAA,MAAA,CAAoB,KAAA,KAAA,CAAA,WAAA,CAAA,YAAA,CAA3B,KAAO,CAAP;AAF8C,KAAA;AAIlDC,IAAAA,UAAU,EAJwC,IAAA;AAKlDC,IAAAA,YAAY,EAAE;AALoC,GAAtDlL;AAOAA,EAAAA,MAAM,CAANA,cAAAA,CAAsB28B,IAAI,CAA1B38B,SAAAA,EAAAA,YAAAA,EAAoD;AAChDgL,IAAAA,GAAG,EAAE,SAAA,GAAA,GAAY;AACb,aAAO,KAAA,OAAA,CAAA,MAAA,CAAoB,KAAA,KAAA,CAAA,WAAA,CAAA,YAAA,CAA3B,GAAO,CAAP;AAF4C,KAAA;AAIhDC,IAAAA,UAAU,EAJsC,IAAA;AAKhDC,IAAAA,YAAY,EAAE;AALkC,GAApDlL,EA9CwC,CAqDxC;AACA;;AACA28B,EAAAA,IAAI,CAAJA,SAAAA,CAAAA,MAAAA,GAAwB,UAAA,KAAA,EAAiB;AACrC,SAAA,cAAA,CAAoB9oC,KAAK,CAAzB,WAAA;AACA,SAAA,sBAAA,CAA4BA,KAAK,CAAjC,aAAA;AACA,SAAA,sBAAA,CAA4BA,KAAK,CAAjC,aAAA;AACA,SAAA,eAAA,CAAqBA,KAAK,CAA1B,UAAA;AACA,SAAA,uBAAA,CAA6BA,KAAK,CAAlC,cAAA;AACA,SAAA,kBAAA,CAAwBA,KAAK,CAA7B,SAAA;AACA,SAAA,oBAAA,CAA0BA,KAAK,CAA/B,WAAA;AAPJ8oC,GAAAA;;AASAA,EAAAA,IAAI,CAAJA,SAAAA,CAAAA,OAAAA,GAAyB,YAAY;AACjC5gB,IAAAA,MAAM,CAANA,SAAAA,CAAAA,OAAAA,CAAAA,IAAAA,CAAAA,IAAAA;;AACA,SAAA,cAAA,CAFiC,QAEjC,GAFiC,CAED;AAlEI,GAgExC4gB,CAhEwC,CAoExC;AACA;;;AACAA,EAAAA,IAAI,CAAJA,SAAAA,CAAAA,UAAAA,GAA4B,UAAA,QAAA,EAAA,UAAA,EAAA,MAAA,EAAwC;AAChE,QAAIx6B,QAAQ,GAAG,KAAf,QAAA;;AACA,QAAIs0B,QAAQ,IAAI;AACZt0B,IAAAA,QAAQ,CADRs0B,aAAAA,IAEAt0B,QAAQ,CAFRs0B,cAAAA,IAGAt0B,QAAQ,CAHZ,eAAA,EAG8B;AAC1B;AACA;AACA,WAAA,cAAA,CAAA,QAAA,EAAA,UAAA,EAAA,MAAA;AACH;AATLw6B,GAAAA;;AAWAA,EAAAA,IAAI,CAAJA,SAAAA,CAAAA,cAAAA,GAAgC,UAAA,QAAA,EAAA,UAAA,EAAA,MAAA,EAAwC,CAjFhC,CAiFxCA,CAjFwC,CAmFxC;AACA;;;AACAA,EAAAA,IAAI,CAAJA,SAAAA,CAAAA,eAAAA,GAAiC,UAAA,WAAA,EAAuB;AACpD,SAAA,WAAA,CAAA,WAAA;AACA,SAAA,SAAA,CAAe;AACXn8B,MAAAA,QAAQ,EAAEnB,cAAc,CAAC,KAAA,GAAA,CAAD,YAAC,CAAD;AADb,KAAf;AAGA,SAAA,iBAAA,CALoD,WAKpD,EALoD,CAKf;AALzCs9B,GAAAA;;AAOAA,EAAAA,IAAI,CAAJA,SAAAA,CAAAA,iBAAAA,GAAmC,YAAY;AAC3C,SAAA,gBAAA;AACA,SAAA,aAAA;AAFJA,GAAAA;;AAIAA,EAAAA,IAAI,CAAJA,SAAAA,CAAAA,WAAAA,GAA6B,UAAA,WAAA,EAAuB,CAApDA,CAAAA;;AACAA,EAAAA,IAAI,CAAJA,SAAAA,CAAAA,aAAAA,GAA+B,YAAY,CAjGH,CAiGxCA,CAjGwC,CAkGxC;AACA;;;AACAA,EAAAA,IAAI,CAAJA,SAAAA,CAAAA,mBAAAA,GAAqC,UAAA,aAAA,EAAyB,CAA9DA,CAAAA;;AACAA,EAAAA,IAAI,CAAJA,SAAAA,CAAAA,qBAAAA,GAAuC,YAAY,CArGX,CAqGxCA,CArGwC,CAsGxC;AACA;;;AACAA,EAAAA,IAAI,CAAJA,SAAAA,CAAAA,uBAAAA,GAAyC,UAAA,SAAA,EAAqB;AAC1D,QAAA,SAAA,EAAe;AACX,WAAA,mBAAA,CAAA,SAAA;AACH;AAHLA,GAAAA;;AAKAA,EAAAA,IAAI,CAAJA,SAAAA,CAAAA,yBAAAA,GAA2C,UAAA,SAAA,EAAqB;AAC5D,QAAA,SAAA,EAAe;AACX,WAAA,qBAAA,CAAA,SAAA;AACH;AAHLA,GAAAA;;AAKAA,EAAAA,IAAI,CAAJA,SAAAA,CAAAA,mBAAAA,GAAqC,UAAA,SAAA,EAAqB,CAA1DA,CAAAA;;AACAA,EAAAA,IAAI,CAAJA,SAAAA,CAAAA,qBAAAA,GAAuC,UAAA,SAAA,EAAqB,CAnHpB,CAmHxCA,CAnHwC,CAoHxC;AACA;;;AACAA,EAAAA,IAAI,CAAJA,SAAAA,CAAAA,YAAAA,GAA8B,UAAA,UAAA,EAAsB,CAApDA,CAAAA;;AACAA,EAAAA,IAAI,CAAJA,SAAAA,CAAAA,cAAAA,GAAgC,YAAY,CAvHJ,CAuHxCA,CAvHwC,CAwHxC;;;AACAA,EAAAA,IAAI,CAAJA,SAAAA,CAAAA,WAAAA,GAA6B,UAAA,UAAA,EAAA,MAAA,EAA8B;AACvD,QAAI9oC,KAAK,GAAG,KAAZ,KAAA;AACA,WAAOgpC,eAAe,CAAA,UAAA,EAAahpC,KAAK,CAAlB,YAAA,EAAiCA,KAAK,CAALA,WAAAA,CAAjC,WAAA,EAAgE0M,MAAM,GAAG,KAAH,gBAAA,GAArFs8B,IAAe,CAAfA,CAAP,EAAA;AAFJF,GAAAA;;AAIAA,EAAAA,IAAI,CAAJA,SAAAA,CAAAA,qBAAAA,GAAuC,UAAA,QAAA,EAAA,OAAA,EAA6B;AAChE,QAAIrG,YAAY,GAAG,KAAA,QAAA,CAAA,YAAA,CAAA,KAAA,CAAnB,uBAAA;AACA,QAAIxiC,GAAG,GAAGgpC,OAAO,CAAjB,aAAA;;AACA,SAAK,IAAI/+B,EAAE,GAAN,CAAA,EAAYw4B,cAAc,GAA/B,YAAA,EAAgDx4B,EAAE,GAAGw4B,cAAc,CAAnE,MAAA,EAA4Ex4B,EAA5E,EAAA,EAAkF;AAC9E,UAAIy4B,WAAW,GAAGD,cAAc,CAAhC,EAAgC,CAAhC;AACAziC,MAAAA,GAAG,GAAG0iC,WAAW,CAAA,GAAA,EAAA,QAAA,EAAA,OAAA,EAAjB1iC,IAAiB,CAAjBA;AACH;;AACD,WAAA,GAAA;AAPJ6oC,GAAAA;;AASAA,EAAAA,IAAI,CAAJA,SAAAA,CAAAA,0BAAAA,GAA4C,UAAA,QAAA,EAAA,OAAA,EAA6B;AACrE,WAAOG,OAAO,CAAPA,gBAAAA,IAA4B,KAAA,GAAA,CAAnC,yBAAmC,CAAnC;AADJH,GAAAA;;AAGAA,EAAAA,IAAI,CAAJA,SAAAA,CAAAA,wBAAAA,GAA0C,UAAA,QAAA,EAAA,OAAA,EAA6B;AACnE,WAAOG,OAAO,CAAd,gBAAA;AA1IoC,GAyIxCH,CAzIwC,CA4IxC;AACA;;;AACAA,EAAAA,IAAI,CAAJA,SAAAA,CAAAA,wBAAAA,GAA0C,UAAA,UAAA,EAAsB;AAC5D,QAAA,UAAA,EAAgB;AACZ,WAAA,oBAAA,CAAA,UAAA;AACH;AAHLA,GAAAA;;AAKAA,EAAAA,IAAI,CAAJA,SAAAA,CAAAA,0BAAAA,GAA4C,UAAA,UAAA,EAAsB;AAC9D,QAAA,UAAA,EAAgB;AACZ,WAAA,sBAAA,CAAA,UAAA;AACH;AAHLA,GAAAA;;AAKAA,EAAAA,IAAI,CAAJA,SAAAA,CAAAA,oBAAAA,GAAsC,UAAA,UAAA,EAAsB,CAA5DA,CAAAA;;AACAA,EAAAA,IAAI,CAAJA,SAAAA,CAAAA,sBAAAA,GAAwC,UAAA,UAAA,EAAsB,CAzJtB,CAyJxCA,CAzJwC,CA0JxC;AACA;;;AACAA,EAAAA,IAAI,CAAJA,SAAAA,CAAAA,mBAAAA,GAAqC,UAAA,KAAA,EAAiB;AAClD,QAAA,KAAA,EAAW;AACP,WAAA,eAAA,CAAA,KAAA;AACH;AAHLA,GAAAA;;AAKAA,EAAAA,IAAI,CAAJA,SAAAA,CAAAA,qBAAAA,GAAuC,UAAA,KAAA,EAAiB;AACpD,QAAA,KAAA,EAAW;AACP,WAAA,iBAAA,CAAA,KAAA;AACH;AAHLA,GAAAA;;AAKAA,EAAAA,IAAI,CAAJA,SAAAA,CAAAA,eAAAA,GAAiC,UAAA,KAAA,EAAiB,CAAlDA,CAAAA;;AACAA,EAAAA,IAAI,CAAJA,SAAAA,CAAAA,iBAAAA,GAAmC,UAAA,KAAA,EAAiB,CAvKZ,CAuKxCA,CAvKwC,CAwKxC;AACA;;;AACAA,EAAAA,IAAI,CAAJA,SAAAA,CAAAA,qBAAAA,GAAuC,UAAA,KAAA,EAAiB;AACpD,QAAA,KAAA,EAAW;AACP,WAAA,iBAAA,CAAA,KAAA;AACH;AAHLA,GAAAA;;AAKAA,EAAAA,IAAI,CAAJA,SAAAA,CAAAA,uBAAAA,GAAyC,UAAA,KAAA,EAAiB;AACtD,QAAA,KAAA,EAAW;AACP,WAAA,mBAAA,CAAA,KAAA;AACH;AAHLA,GAAAA;;AAKAA,EAAAA,IAAI,CAAJA,SAAAA,CAAAA,iBAAAA,GAAmC,UAAA,KAAA,EAAiB,CAApDA,CAAAA;;AACAA,EAAAA,IAAI,CAAJA,SAAAA,CAAAA,mBAAAA,GAAqC,UAAA,KAAA,EAAiB,CAAtDA,CAAAA;AACA;AACJ;AACI;AACA;AACA;;;AACAA,EAAAA,IAAI,CAAJA,SAAAA,CAAAA,iBAAAA,GAAmC,UAAA,WAAA,EAAuB;AACtD,QAAIhkB,KAAK,GAAT,IAAA;;AACA,QAAI/Y,OAAO,GAAG,KAAd,OAAA;AACA,QAAA,IAAA;AACA,QAAA,MAAA;AACA,QALsD,KAKtD,CALsD,CAK3C;;AACX,QAAI,KAAA,GAAA,CAAJ,cAAI,CAAJ,EAA8B;AAC1BxF,MAAAA,IAAI,GAAG,KAAA,mBAAA,CAAPA,WAAO,CAAPA;;AACA,UAAA,IAAA,EAAU;AACN2iC,QAAAA,MAAM,GAAG,KAAA,kBAAA,CAAA,IAAA,CAATA,IAAS,CAATA;AACA,aAAA,cAAA,GAAsB,KAAA,QAAA,CAAtB,MAAsB,EAAtB;AACA,aAAA,mBAAA,GAA2B,IAAA,IAAA,GAHrB,OAGqB,EAA3B,CAHM,CAIN;;AACAC,QAAAA,KAAK,GAAGp9B,OAAO,CAAPA,GAAAA,CAAYA,OAAO,CAAPA,OAAAA,CAAgB,KAAhBA,cAAAA,EAAZA,IAAYA,CAAZA,EAAwDP,cAAc,CAAA,CAAA,EAAtEO,IAAsE,CAAtEA,EAAAA,OAAAA,KAA6F,KAAA,cAAA,CAL/F,OAK+F,EAArGo9B,CALM,CAMN;;AACA,aAAA,qBAAA,GAA6B5+B,UAAU,CAAC,YAAY;AAChDua,UAAAA,KAAK,CAALA,qBAAAA,GAAAA,IAAAA;AACAokB,UAAAA,MAAM;;AACN,cAAI3iC,IAAI,KAAR,QAAA,EAAuB;AACnB4iC,YAAAA,KAAK,GADc,IACnBA,CADmB,CACL;AADlB,WAAA,MAGK;AACDA,YAAAA,KAAK,GAAG,OADP,EACDA,CADC,CACkB;AACtB;;AACDrkB,UAAAA,KAAK,CAALA,sBAAAA,GAA+BskB,WAAW,CAAA,MAAA,EATM,KASN,CAA1CtkB,CATgD,CASW;AATxB,SAAA,EAAvC,KAAuC,CAAvC;AATsB,OAAA,CAqB1B;;AACH;AAvNmC,GA2LxCgkB,CA3LwC,CAyNxC;AACA;;;AACAA,EAAAA,IAAI,CAAJA,SAAAA,CAAAA,kBAAAA,GAAoC,YAAY;AAC5C,QAAI,KAAA,KAAA,CAAA,WAAA,IAA0B;AAC1B,SADJ,cAAA,CACwB;AADxB,MAEE;AACE,aADF,oBACE,GADF,CAC+B;;AAC7B,aAAA,kBAAA,CAAwBrR,KAAK,CAAC,KAAD,cAAA,EAAsB,IAAA,IAAA,GAAA,OAAA,KAAuB,KAA1E,mBAA6B,CAA7B;AACA,aAAA,sBAAA,GAAA,IAAA;AACH;AAlOmC,GA2NxCqR,CA3NwC,CAoOxC;AACA;;;AACAA,EAAAA,IAAI,CAAJA,SAAAA,CAAAA,gBAAAA,GAAkC,YAAY;AAC1C,QAAI,KAAJ,sBAAA,EAAiC;AAC7B,UAAI,KAAJ,qBAAA,EAAgC;AAC5BO,QAAAA,YAAY,CAAC,KAAbA,qBAAY,CAAZA;AACA,aAAA,qBAAA,GAAA,IAAA;AACH;;AACD,UAAI,KAAJ,sBAAA,EAAiC;AAC7BC,QAAAA,aAAa,CAAC,KAAdA,sBAAa,CAAbA;AACA,aAAA,sBAAA,GAAA,IAAA;AACH;;AACD,WAAA,oBAAA;AACA,WAAA,sBAAA,GAAA,KAAA;AACH;AAZLR,GAAAA;;AAcAA,EAAAA,IAAI,CAAJA,SAAAA,CAAAA,mBAAAA,GAAqC,UAAA,WAAA,EAAuB,CACxD;AArPoC,GAoPxCA,CApPwC,CAuPxC;;;AACAA,EAAAA,IAAI,CAAJA,SAAAA,CAAAA,kBAAAA,GAAoC,UAAA,IAAA,EAAgB,CAChD;AAzPoC,GAwPxCA,CAxPwC,CA2PxC;;;AACAA,EAAAA,IAAI,CAAJA,SAAAA,CAAAA,oBAAAA,GAAsC,YAAY,CAC9C;AADJA,GAAAA;AAGA;AACJ;;;AACIA,EAAAA,IAAI,CAAJA,SAAAA,CAAAA,SAAAA,GAA2B,UAAA,MAAA,EAAkB;AACzC,QAAIS,YAAY,GAAG,KAAA,YAAA,KAAsB,KAAA,YAAA,GAAzC,EAAmB,CAAnB;;AACAl9B,IAAAA,OAAQ,CAAA,YAAA,EAARA,MAAQ,CAARA;AAFJy8B,GAAAA;;AAIAA,EAAAA,IAAI,CAAJA,SAAAA,CAAAA,SAAAA,GAA2B,UAAA,QAAA,EAAoB;AAC3C,SAAA,iBAAA,CAAA,QAAA;AACA,SAAA,YAAA,GAAA,IAAA;AAFJA,GAAAA;;AAIAA,EAAAA,IAAI,CAAJA,SAAAA,CAAAA,iBAAAA,GAAmC,UAAA,QAAA,EAAoB;AACnD,SAAA,WAAA,CAAiB,KAAA,YAAA,IAAjB,EAAA,EAAA,QAAA;AADJA,GAAAA;;AAGAA,EAAAA,IAAI,CAAJA,SAAAA,CAAAA,WAAAA,GAA6B,YAAY;AACrC,QAAIU,MAAM,GAAV,EAAA;;AACA,QAAI,KAAA,KAAA,CAAJ,WAAA,EAA4B;AAAE;AAC1Bn9B,MAAAA,OAAQ,CAAA,MAAA,EAAS,KAAjBA,eAAiB,EAAT,CAARA;AACH;;AACD,WAAA,MAAA;AALJy8B,GAAAA;;AAOAA,EAAAA,IAAI,CAAJA,SAAAA,CAAAA,WAAAA,GAA6B,UAAA,MAAA,EAAA,QAAA,EAA4B;AACrD,QAAIn8B,QAAQ,GAAG68B,MAAM,CAArB,QAAA;;AACA,QAAI78B,QAAQ,IAAZ,IAAA,EAAsB;AAClB,aAAO68B,MAAM,CAAb,QAAA;;AACA,UAAI,KAAA,KAAA,CAAJ,WAAA,EAA4B;AAAE;AAC1Bn9B,QAAAA,OAAQ,CAAA,MAAA,EAAS,KAAA,iBAAA,CAAjBA,QAAiB,CAAT,CAARA;AACH;AACJ;;AACD,QAAI,KAAA,KAAA,CAAJ,WAAA,EAA4B;AAAE;AAC1B,WAAA,eAAA,CAAA,MAAA;AACH;AAVLy8B,GAAAA;;AAYAA,EAAAA,IAAI,CAAJA,SAAAA,CAAAA,iBAAAA,GAAmC,UAAA,QAAA,EAAoB;AACnD,WADmD,EACnD,CADmD,CACxC;AADfA,GAAAA;;AAGAA,EAAAA,IAAI,CAAJA,SAAAA,CAAAA,eAAAA,GAAiC,YAAY;AACzC,WADyC,EACzC,CADyC,CAC9B;AADfA,GAAAA;;AAGAA,EAAAA,IAAI,CAAJA,SAAAA,CAAAA,eAAAA,GAAiC,UAAA,MAAA,EAAkB,CAC/C;AAtSoC,GAqSxCA,CArSwC,CAwSxC;;;AACAA,EAAAA,IAAI,CAAJA,SAAAA,CAAAA,gBAAAA,GAAkC,UAAA,QAAA,EAAoB;AAClD,SAAA,WAAA,CAAiB;AAAEn8B,MAAAA,QAAQ,EAAEA;AAAZ,KAAjB,EAAA,KAAA;AADJm8B,GAAAA;;AAGA,SAAA,IAAA;AA5SsB,CAAA,CAA1B,aAA0B,CAA1B;;AA8SA9gB,YAAY,CAAZA,OAAAA,CAAAA,IAAAA;AACA8gB,IAAI,CAAJA,SAAAA,CAAAA,cAAAA,GAAAA,KAAAA;AACAA,IAAI,CAAJA,SAAAA,CAAAA,yBAAAA,GAAAA,oBAAAA;;AAEA,IAAIW,eAAe;AAAG;AAAe,YAAY;AAC7C,WAAA,eAAA,CAAA,OAAA,EAAkC;AAC9B,SAAA,IAAA,GAAA,EAAA;AACA,SAAA,WAAA,GAAA,KAAA;AACA,SAAA,OAAA,GAAA,OAAA;AACH;;AACDA,EAAAA,eAAe,CAAfA,SAAAA,CAAAA,UAAAA,GAAuC,UAAA,IAAA,EAAA,UAAA,EAA4B;AAC/D,SAD+D,YAC/D,GAD+D,CAC1C;AACrB;AACA;;AACAhvB,IAAAA,IAAI,GAAG,KAAA,YAAA,CAAA,IAAA,EAAPA,UAAO,CAAPA;AACA,SAAA,IAAA,GAAA,IAAA;AACA,SAAA,UAAA,CAAA,IAAA,EAAA,UAAA;AACA,SAAA,WAAA,GAAA,IAAA;AACA,SAAA,OAAA,CAAA,IAAA,CAAA,mBAAA,CAAsC,KAAtC,IAAA,EAAiDrL,OAAO,CAAxD,UAAwD,CAAxD;AARJq6B,GAAAA;;AAUAA,EAAAA,eAAe,CAAfA,SAAAA,CAAAA,QAAAA,GAAqC,UAAA,KAAA,EAAA,UAAA,EAA6B;AAC9D,SAAA,OAAA,CAAA,IAAA,CAAA,qBAAA,CAAwC,KAAxC,IAAA,EAAmDr6B,OAAO,CAA1D,UAA0D,CAA1D;AACA,SAAA,UAAA,CAAgB,KAAhB,IAAA;AACA,SAAA,IAAA,GAAA,EAAA;AAnByC,GAgB7Cq6B,CAhB6C,CAqB7C;;;AACAA,EAAAA,eAAe,CAAfA,SAAAA,CAAAA,YAAAA,GAAyC,YAAY;AACjD,QAAIz0B,OAAO,GAAG,KAAA,OAAA,CAAd,OAAA;AACA,QAAA,gBAAA;AACA,QAAA,eAAA;AACA,SAAA,eAAA,GAAuB6D,eAAe,CAAC7D,OAAO,CAAPA,eAAAA,IAA2B,KAA5B,sBAA4B,EAA5B,EAA2DA,OAAO,CAAxG,qBAAsC,CAAtC;AACA00B,IAAAA,gBAAgB,GAAG10B,OAAO,CAA1B00B,gBAAAA;;AACA,QAAIA,gBAAgB,IAApB,IAAA,EAA8B;AAC1BA,MAAAA,gBAAgB,GAAG,KADO,uBACP,EAAnBA,CAD0B,CACyB;AACtD;;AACDC,IAAAA,eAAe,GAAG30B,OAAO,CAAzB20B,eAAAA;;AACA,QAAIA,eAAe,IAAnB,IAAA,EAA6B;AACzBA,MAAAA,eAAe,GAAG,KADO,sBACP,EAAlBA,CADyB,CACwB;AACpD;;AACD,SAAA,gBAAA,GAAA,gBAAA;AACA,SAAA,eAAA,GAAA,eAAA;AApCyC,GAsB7CF,CAtB6C,CAsC7C;AACA;;;AACAA,EAAAA,eAAe,CAAfA,SAAAA,CAAAA,YAAAA,GAAyC,UAAA,IAAA,EAAA,UAAA,EAA4B;AACjE,QAAInrC,IAAI,GAAR,EAAA;AACA,QAAA,CAAA;;AACA,QAAImc,IAAI,CAAR,MAAA,EAAiB;AAAE;AACf;AACA,WAAK5b,CAAC,GAAN,CAAA,EAAYA,CAAC,GAAG4b,IAAI,CAApB,MAAA,EAA6B5b,CAA7B,EAAA,EAAkC;AAC9BP,QAAAA,IAAI,IAAI,KAAA,aAAA,CAAmBmc,IAAI,CAAvB,CAAuB,CAAvB,EAARnc,UAAQ,CAARA;AAHS,OAAA,CAKb;AACA;;;AACAa,MAAAA,cAAc,CAAdA,IAAc,CAAdA,CAAAA,OAAAA,CAA6B,UAAA,EAAA,EAAA,CAAA,EAAiB;AAC1C,YAAIyb,GAAG,GAAGH,IAAI,CAAd,CAAc,CAAd;;AACA,YAAA,EAAA,EAAQ;AACJG,UAAAA,GAAG,CAAHA,EAAAA,GAAAA,EAAAA;AACH;AAJLzb,OAAAA;AAMAsb,MAAAA,IAAI,GAAGmvB,gBAAgB,CAAC,KAAA,OAAA,CAAD,IAAA,EAAA,IAAA,EAA0Bx6B,OAAO,CAAxDqL,UAAwD,CAAjC,CAAvBA;AACH;;AACD,WAAA,IAAA;AA1DyC,GAwC7CgvB,CAxC6C,CA4D7C;;;AACAA,EAAAA,eAAe,CAAfA,SAAAA,CAAAA,aAAAA,GAA0C,UAAA,GAAA,EAAA,WAAA,EAAA,WAAA,EAAA,UAAA,EAAqD;AAC3F,QAAItiB,OAAO,GAAG,CAAA,UAAA,EAEVvM,GAAG,CAAHA,OAAAA,GAAAA,UAAAA,GAFU,cAAA,EAGVA,GAAG,CAAHA,KAAAA,GAAAA,QAAAA,GAHU,YAAA,EAAA,MAAA,CAILA,GAAG,CAAHA,UAAAA,CAAAA,EAAAA,CAJT,UAAc,CAAd;;AAKA,QAAA,WAAA,EAAiB;AACbuM,MAAAA,OAAO,CAAPA,IAAAA,CAAAA,cAAAA;AACH;;AACD,QAAA,WAAA,EAAiB;AACbA,MAAAA,OAAO,CAAPA,IAAAA,CAAAA,cAAAA;AACH;;AACD,QAAA,UAAA,EAAgB;AACZA,MAAAA,OAAO,CAAPA,IAAAA,CAAAA,WAAAA;;AACA,UAAI0iB,UAAU,CAAd,UAAA,EAA2B;AACvB1iB,QAAAA,OAAO,CAAPA,IAAAA,CAAAA,aAAAA;AACH;;AACD,UAAI0iB,UAAU,CAAd,UAAA,EAA2B;AACvB1iB,QAAAA,OAAO,CAAPA,IAAAA,CAAAA,aAAAA;AACH;AACJ;;AACD,WAAA,OAAA;AAlFyC,GA6D7CsiB,CA7D6C,CAoF7C;AACA;AACA;AACA;AACA;;;AACAA,EAAAA,eAAe,CAAfA,SAAAA,CAAAA,WAAAA,GAAwC,UAAA,UAAA,EAAA,SAAA,EAAA,UAAA,EAA6C;AACjF,QAAI96B,GAAG,GAAGm7B,UAAU,CAApB,GAAA;AAAA,QAA0Bp7B,QAAQ,GAAGo7B,UAAU,CAA/C,QAAA;AACA,WAAO,KAAA,YAAA,CAAkBp7B,QAAQ,CAARA,KAAAA,CAAlB,KAAA,EAAwCC,GAAG,CAAHA,MAAAA,GAAaD,QAAQ,CAARA,KAAAA,CAAbC,GAAAA,GAAxC,IAAA,EAAgFA,GAAG,CAAnF,MAAA,EAAA,SAAA,EAAA,UAAA,EAAmHD,QAAQ,CAA3H,cAAA,EAA4IA,QAAQ,CAA3J,YAAO,CAAP;AAFJ+6B,GAAAA;;AAIAA,EAAAA,eAAe,CAAfA,SAAAA,CAAAA,YAAAA,GAAyC,UAAA,KAAA,EAAA,GAAA,EAAA,MAAA,EAAA,SAAA,EAAA,UAAA,EAAA,cAAA,EAAA,YAAA,EAAmF;AACxH,QAAI19B,OAAO,GAAG,KAAA,OAAA,CAAd,OAAA;;AACA,QAAI6M,SAAS,IAAb,IAAA,EAAuB;AACnBA,MAAAA,SAAS,GAAG,KAAZA,eAAAA;AACH;;AACD,QAAImxB,UAAU,IAAd,IAAA,EAAwB;AACpBA,MAAAA,UAAU,GAAG,KAAbA,eAAAA;AACH;;AACD,QAAI,KAAA,gBAAA,IAAyB,CAA7B,MAAA,EAAsC;AAClC,UAAIA,UAAU,IAAd,GAAA,EAAuB;AACnB,eAAO,OAAO,CAAP,WAAA,CAAA,KAAA,EAAA,GAAA,EAAA,SAAA,EAA2C;AAC9CjxB,UAAAA,cAAc,EADgC,cAAA;AAE9CC,UAAAA,YAAY,EAAEA;AAFgC,SAA3C,CAAP;AADJ,OAAA,MAMK;AACD,eAAO,OAAO,CAAP,MAAA,CAAA,KAAA,EAAA,SAAA,EAAiC;AACpCC,UAAAA,SAAS,EAAEF;AADyB,SAAjC,CAAP;AAGH;AACJ;;AACD,WAAA,EAAA;AArBJ2wB,GAAAA;;AAuBAA,EAAAA,eAAe,CAAfA,SAAAA,CAAAA,sBAAAA,GAAmD,YAAY;AAC3D,WAAO;AACHx3B,MAAAA,IAAI,EADD,SAAA;AAEHC,MAAAA,MAAM,EAFH,SAAA;AAGHX,MAAAA,cAAc,EAAE;AAHb,KAAP;AADJk4B,GAAAA;;AAOAA,EAAAA,eAAe,CAAfA,SAAAA,CAAAA,uBAAAA,GAAoD,YAAY;AAC5D,WAAA,IAAA;AADJA,GAAAA;;AAGAA,EAAAA,eAAe,CAAfA,SAAAA,CAAAA,sBAAAA,GAAmD,YAAY;AAC3D,WAAA,IAAA;AA/HyC,GA8H7CA,CA9H6C,CAiI7C;;;AACAA,EAAAA,eAAe,CAAfA,SAAAA,CAAAA,UAAAA,GAAuC,UAAA,EAAA,EAAc;AACjD,WAAO;AACH,0BAAoBhyB,EAAE,CADnB,eAAA;AAEH,sBAAgBA,EAAE,CAFf,WAAA;AAGHyJ,MAAAA,KAAK,EAAEzJ,EAAE,CAAC4F;AAHP,KAAP;AADJosB,GAAAA;;AAOAA,EAAAA,eAAe,CAAfA,SAAAA,CAAAA,aAAAA,GAA0C,UAAA,IAAA,EAAgB;AACtD,QAAI7gC,KAAK,GAAG,KAAA,OAAA,CAAA,IAAA,CAAZ,eAAA;AACA,QAAIohC,IAAI,GAAGvvB,IAAI,CAAJA,GAAAA,CAAX,kBAAWA,CAAX;AACAuvB,IAAAA,IAAI,CAAJA,IAAAA,CAAU,UAAA,IAAA,EAAA,IAAA,EAAsB;AAC5B,aAAOC,mBAAmB,CAAA,IAAA,EAAA,IAAA,EAA1B,KAA0B,CAA1B;AADJD,KAAAA;AAGA,WAAO,IAAI,CAAJ,GAAA,CAAS,UAAA,CAAA,EAAa;AACzB,aAAOE,CAAC,CAAR,IAAA;AADJ,KAAO,CAAP;AANJT,GAAAA;;AAUAA,EAAAA,eAAe,CAAfA,SAAAA,CAAAA,YAAAA,GAAyC,UAAA,KAAA,EAAiB;AACtD,QAAIU,KAAK,IAAI,KAAb,WAAA,EAA+B;AAC3B,WAAA,eAAA,CAAqB,KAArB,IAAA;AACH;AAHLV,GAAAA;;AAKAA,EAAAA,eAAe,CAAfA,SAAAA,CAAAA,WAAAA,GAAwC,UAAA,KAAA,EAAiB;AACrD,QAAIU,KAAK,IAAI,KAAb,WAAA,EAA+B;AAC3B,WAAA,cAAA,CAAoB,KAApB,IAAA;AACA,WAAA,WAAA,GAAA,KAAA;AACH;AAJLV,GAAAA;;AAMAA,EAAAA,eAAe,CAAfA,SAAAA,CAAAA,eAAAA,GAA4C,UAAA,IAAA,EAAgB,CAA5DA,CAAAA;;AAEAA,EAAAA,eAAe,CAAfA,SAAAA,CAAAA,cAAAA,GAA2C,UAAA,IAAA,EAAgB,CAhKd,CAgK7CA,CAhK6C,CAkK7C;;;AACAA,EAAAA,eAAe,CAAfA,SAAAA,CAAAA,UAAAA,GAAuC,UAAA,IAAA,EAAgB;AACnD,QAAA,IAAA,EAAU;AACN,WAAK,IAAIv/B,EAAE,GAAN,CAAA,EAAY5D,EAAE,GAAG,KAAtB,IAAA,EAAiC4D,EAAE,GAAG5D,EAAE,CAAxC,MAAA,EAAiD4D,EAAjD,EAAA,EAAuD;AACnD,YAAI0Q,GAAG,GAAGtU,EAAE,CAAZ,EAAY,CAAZ;;AACA,YAAIoH,IAAI,CAACkN,GAAG,CAAHA,UAAAA,CAAAA,QAAAA,CAAT,UAAQ,CAAR,EAA8C;AAC1CA,UAAAA,GAAG,CAAHA,EAAAA,CAAAA,KAAAA,CAAAA,UAAAA,GAAAA,QAAAA;AACH;AACJ;AACJ;AARL6uB,GAAAA;;AAUAA,EAAAA,eAAe,CAAfA,SAAAA,CAAAA,UAAAA,GAAuC,UAAA,IAAA,EAAgB;AACnD,QAAA,IAAA,EAAU;AACN,WAAK,IAAIv/B,EAAE,GAAN,CAAA,EAAY5D,EAAE,GAAG,KAAtB,IAAA,EAAiC4D,EAAE,GAAG5D,EAAE,CAAxC,MAAA,EAAiD4D,EAAjD,EAAA,EAAuD;AACnD,YAAI0Q,GAAG,GAAGtU,EAAE,CAAZ,EAAY,CAAZ;;AACA,YAAIoH,IAAI,CAACkN,GAAG,CAAHA,UAAAA,CAAAA,QAAAA,CAAT,UAAQ,CAAR,EAA8C;AAC1CA,UAAAA,GAAG,CAAHA,EAAAA,CAAAA,KAAAA,CAAAA,UAAAA,GAAAA,EAAAA;AACH;AACJ;AACJ;AARL6uB,GAAAA;;AAUAA,EAAAA,eAAe,CAAfA,SAAAA,CAAAA,kBAAAA,GAA+C,UAAA,UAAA,EAAsB;AACjE,QAAA,UAAA,EAAgB;AACZ,WAAK,IAAIv/B,EAAE,GAAN,CAAA,EAAY5D,EAAE,GAAG,KAAtB,IAAA,EAAiC4D,EAAE,GAAG5D,EAAE,CAAxC,MAAA,EAAiD4D,EAAjD,EAAA,EAAuD;AACnD,YAAI0Q,GAAG,GAAGtU,EAAE,CAAZ,EAAY,CAAZ;AACA,YAAI8jC,aAAa,GAAGxvB,GAAG,CAAHA,UAAAA,CAApB,QAAA;;AACA,YAAIwvB,aAAa,IAAIA,aAAa,CAAbA,UAAAA,KAAjBA,UAAAA,IACAxvB,GAAG,CADP,EAAA,CACW;AADX,UAEE;AACEA,YAAAA,GAAG,CAAHA,EAAAA,CAAAA,SAAAA,CAAAA,GAAAA,CAAAA,aAAAA;AACH;AACJ;AACJ;AAXL6uB,GAAAA;;AAaAA,EAAAA,eAAe,CAAfA,SAAAA,CAAAA,oBAAAA,GAAiD,UAAA,UAAA,EAAsB;AACnE,QAAA,UAAA,EAAgB;AACZ,WAAK,IAAIv/B,EAAE,GAAN,CAAA,EAAY5D,EAAE,GAAG,KAAtB,IAAA,EAAiC4D,EAAE,GAAG5D,EAAE,CAAxC,MAAA,EAAiD4D,EAAjD,EAAA,EAAuD;AACnD,YAAI0Q,GAAG,GAAGtU,EAAE,CAAZ,EAAY,CAAZ;;AACA,YAAIsU,GAAG,CAAP,EAAA,EAAY;AAAE;AACVA,UAAAA,GAAG,CAAHA,EAAAA,CAAAA,SAAAA,CAAAA,MAAAA,CAAAA,aAAAA;AACH;AACJ;AACJ;AARL6uB,GAAAA;;AAUA,SAAA,eAAA;AA9MJ,CAAqC,EAArC,C,CAgNA;;;AACA,SAAA,kBAAA,CAAA,GAAA,EAAiC;AAC7B,MAAI18B,QAAQ,GAAG6N,GAAG,CAAHA,UAAAA,CAAf,GAAA;AACA,MAAIlK,KAAK,GAAGkK,GAAG,CAAHA,UAAAA,CAAAA,QAAAA,CAAZ,KAAA;AACA,MAAIxP,KAAK,GAAGsF,KAAK,CAALA,KAAAA,GAAcA,KAAK,CAALA,KAAAA,CAAdA,OAAcA,EAAdA,GAHiB,CAG7B,CAH6B,CAGwB;;AACrD,MAAIrF,GAAG,GAAGqF,KAAK,CAALA,GAAAA,GAAYA,KAAK,CAALA,GAAAA,CAAZA,OAAYA,EAAZA,GAJmB,CAI7B,CAJ6B,CAIkB;;AAC/C,SAAOrE,OAAQ,CAAA,EAAA,EAAKU,QAAQ,CAAb,aAAA,EAAA,QAAA,EAAuC;AAAEiV,IAAAA,EAAE,EAAEjV,QAAQ,CAAd,QAAA;AAAyB3B,IAAAA,KAAK,EAA9B,KAAA;AAClDC,IAAAA,GAAG,EAD+C,GAAA;AACxCsB,IAAAA,QAAQ,EAAEtB,GAAG,GAD2B,KAAA;AACjBqB,IAAAA,MAAM,EAAE4pB,MAAM,CAACvpB,QAAQ,CADN,MACH,CADG;AACgBs9B,IAAAA,IAAI,EADpB,GAAA,CAC0B;;AAD1B,GAAvC,CAAf;AAGH;;AAED,IAAIC,YAAY;AAAG;AAAe,YAAY;AAC1C,WAAA,YAAA,CAAA,OAAA,EAA+B;AAC3B,SAAA,UAAA,GAAA,KAAA;AACA,SAAA,cAAA,GAAA,EAAA;AACA,SAAA,OAAA,GAAA,OAAA;AACA,SAAA,kBAAA,GAAA,EAAA;AACA,SAAA,UAAA,GAAA,EAAA;AACH;;AACDA,EAAAA,YAAY,CAAZA,SAAAA,CAAAA,aAAAA,GAAuC,UAAA,IAAA,EAAgB;AACnD,WAAO,KAAA,UAAA,CAAA,IAAA,KAAP,EAAA;AADJA,GAAAA;;AAGAA,EAAAA,YAAY,CAAZA,SAAAA,CAAAA,UAAAA,GAAoC,UAAA,IAAA,EAAA,IAAA,EAAsB;AACtD,QAAA,EAAA;;AACA,QAAIC,YAAY,GAAG,KAAA,YAAA,CAAA,IAAA,EAFmC,IAEnC,CAAnB,CAFsD,CAEJ;;AAClD,QAAIC,YAAY,GAAG,KAAA,UAAA,CAAA,IAAA,EAAnB,YAAmB,CAAnB;;AACA,QAAA,YAAA,EAAkB;AACd,OAAClkC,EAAE,GAAI,KAAA,kBAAA,CAAA,IAAA,MAAkC,KAAA,kBAAA,CAAA,IAAA,IAAzC,EAAO,CAAP,EAAA,IAAA,CAAA,KAAA,CAAA,EAAA,EAAA,YAAA;AACH;;AACD,SAAA,UAAA,CAAA,IAAA,IAAA,YAAA;;AACA,QAAI0Q,IAAI,KAAR,SAAA,EAAwB;AACpB,WAAA,OAAA,CAAA,IAAA,CAAA,mBAAA,CAAA,YAAA,EADoB,KACpB,EADoB,CACwC;AAC/D;;AACD,SAAA,cAAA,CAAA,IAAA,IAAA,IAAA;AAtBsC,GAW1CszB,CAX0C,CAwB1C;;;AACAA,EAAAA,YAAY,CAAZA,SAAAA,CAAAA,QAAAA,GAAkC,UAAA,IAAA,EAAgB;AAC9C,QAAI7vB,IAAI,GAAG,KAAA,UAAA,CAAX,IAAW,CAAX;;AACA,QAAA,IAAA,EAAU;AACN,UAAIzD,IAAI,KAAR,SAAA,EAAwB;AACpB,aAAA,OAAA,CAAA,IAAA,CAAA,qBAAA,CAAA,IAAA,EADoB,KACpB,EADoB,CACkC;AACzD;;AACD,WAAA,UAAA,CAAA,IAAA,EAAA,IAAA;AACH;AAhCqC,GAyB1CszB,CAzB0C,CAkC1C;AACA;;;AACAA,EAAAA,YAAY,CAAZA,SAAAA,CAAAA,YAAAA,GAAsC,UAAA,IAAA,EAAA,IAAA,EAAsB;AACxD,QAAIxlB,KAAK,GAAT,IAAA;;AACA,QAAIxmB,IAAI,GAAR,EAAA;AACA,QAAA,CAAA;;AACA,QAAImc,IAAI,CAAR,MAAA,EAAiB;AACb;AACA,WAAK5b,CAAC,GAAN,CAAA,EAAYA,CAAC,GAAG4b,IAAI,CAApB,MAAA,EAA6B5b,CAA7B,EAAA,EAAkC;AAC9BP,QAAAA,IAAI,IAAI,KAAA,aAAA,CAAA,IAAA,EAAyBmc,IAAI,CAArCnc,CAAqC,CAA7B,CAARA;AAHS,OAAA,CAKb;AACA;;;AACAa,MAAAA,cAAc,CAAdA,IAAc,CAAdA,CAAAA,OAAAA,CAA6B,UAAA,EAAA,EAAA,CAAA,EAAiB;AAC1C,YAAIyb,GAAG,GAAGH,IAAI,CAAd,CAAc,CAAd;;AACA,YAAA,EAAA,EAAQ;AACJG,UAAAA,GAAG,CAAHA,EAAAA,GAAAA,EAAAA;AACH;AAJLzb,OAAAA;;AAMA,UAAI6X,IAAI,KAAR,SAAA,EAAwB;AACpByD,QAAAA,IAAI,GAAGmvB,gBAAgB,CAAC,KAAA,OAAA,CAAD,IAAA,EAAA,IAAA,EAAA,KAAA,CAAgC;AAAhC,SAAvBnvB;AAdS,OAAA,CAiBb;;;AACAA,MAAAA,IAAI,GAAG,IAAI,CAAJ,MAAA,CAAY,UAAA,GAAA,EAAe;AAC9B,eAAOlb,cAAc,CAACqb,GAAG,CAAJ,EAAA,EAASkK,KAAK,CAAnC,UAAqB,CAArB;AADJrK,OAAO,CAAPA;AAGH;;AACD,WAAA,IAAA;AA9DsC,GAoC1C6vB,CApC0C,CAgE1C;;;AACAA,EAAAA,YAAY,CAAZA,SAAAA,CAAAA,aAAAA,GAAuC,UAAA,IAAA,EAAA,GAAA,EAAqB;AACxD,QAAIG,GAAG,GAAP,IAAA;AACA,QAAIntB,UAAU,GAAd,EAAA;;AACA,QAAItG,IAAI,KAAJA,WAAAA,IAAwBA,IAAI,KAAhC,eAAA,EAAsD;AAClDyzB,MAAAA,GAAG,GAAG;AACF,4BAAoB7vB,GAAG,CAAHA,UAAAA,CAAAA,EAAAA,CAAkBjD;AADpC,OAAN8yB;AAGH;;AACD,QAAIzzB,IAAI,KAAR,WAAA,EAA0B;AACtBsG,MAAAA,UAAU,GAAGA,UAAU,CAAVA,MAAAA,CAAkB1C,GAAG,CAAHA,UAAAA,CAAAA,EAAAA,CAA/B0C,UAAaA,CAAbA;AACH;;AACD,QAAItG,IAAI,KAAR,eAAA,EAA8B;AAC1BsG,MAAAA,UAAU,CAAVA,IAAAA,CAAAA,YAAAA;AADJ,KAAA,MAGK;AACDA,MAAAA,UAAU,CAAVA,IAAAA,CAAgB,QAAQtG,IAAI,CAA5BsG,WAAwBtG,EAAxBsG;AACH;;AACD,WAAO,MAAM,KAAN,UAAA,IACFA,UAAU,CAAVA,MAAAA,GAAoB,aAAaA,UAAU,CAAVA,IAAAA,CAAb,GAAaA,CAAb,GAApBA,GAAAA,GADE,EAAA,KAEFmtB,GAAG,GAAG,aAAaC,QAAQ,CAArB,GAAqB,CAArB,GAAH,GAAA,GAFD,EAAA,IAAA,KAAA,GAGK,KAHL,UAAA,GAAP,GAAA;AAjBJJ,GAAAA;;AAsBAA,EAAAA,YAAY,CAAZA,SAAAA,CAAAA,UAAAA,GAAoC,UAAA,IAAA,EAAA,IAAA,EAAsB;AACtD,QAAIE,YAAY,GAAG,KAAA,kBAAA,CAAnB,IAAmB,CAAnB;;AACA,QAAA,YAAA,EAAkB;AACdA,MAAAA,YAAY,CAAZA,OAAAA,CAAAA,aAAAA;AACA,aAAO,KAAA,kBAAA,CAAP,IAAO,CAAP;AACH;AALLF,GAAAA;;AAOAA,EAAAA,YAAY,CAAZA,SAAAA,CAAAA,YAAAA,GAAsC,UAAA,KAAA,EAAiB;AACnD,SAAK,IAAL,IAAA,IAAiB,KAAjB,UAAA,EAAkC;AAC9B,UAAIH,KAAK,IAAI,KAAA,cAAA,CAAb,IAAa,CAAb,EAAwC;AACpC,aAAA,eAAA,CAAqB,KAAA,UAAA,CAArB,IAAqB,CAArB;AACH;AACJ;AALLG,GAAAA;;AAOAA,EAAAA,YAAY,CAAZA,SAAAA,CAAAA,WAAAA,GAAqC,UAAA,KAAA,EAAiB;AAClD,SAAK,IAAL,IAAA,IAAiB,KAAjB,UAAA,EAAkC;AAC9B,UAAIH,KAAK,IAAI,KAAA,cAAA,CAAb,IAAa,CAAb,EAAwC;AACpC,aAAA,cAAA,CAAoB,KAAA,UAAA,CAApB,IAAoB,CAApB;AACH;AACJ;;AACD,SAAA,cAAA,GAAA,EAAA;AANJG,GAAAA;;AAQAA,EAAAA,YAAY,CAAZA,SAAAA,CAAAA,eAAAA,GAAyC,UAAA,IAAA,EAAgB,CAAzDA,CAAAA;;AAEAA,EAAAA,YAAY,CAAZA,SAAAA,CAAAA,cAAAA,GAAwC,UAAA,IAAA,EAAgB,CAAxDA,CAAAA;;AAEA,SAAA,YAAA;AAjHJ,CAAkC,EAAlC;;AAoHA,IAAIK,iBAAiB;AAAG;AAAe,YAAY;AAC/C,WAAA,iBAAA,CAAA,YAAA,EAAyC;AACrC,SAAA,YAAA,GAAA,YAAA;AACH;;AACD,SAAA,iBAAA;AAJJ,CAAuC,EAAvC;AAOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA,IAAIC,eAAe;AAAG;AAAe,YAAY;AAC7C,WAAA,eAAA,CAAA,EAAA,EAA6B;AACzB,SAAA,OAAA,GAAe,IAAf,YAAe,EAAf;AACH;;AACDA,EAAAA,eAAe,CAAfA,SAAAA,CAAAA,OAAAA,GAAoC,YAAY,CAAhDA,CAAAA;;AAEAA,EAAAA,eAAe,CAAfA,SAAAA,CAAAA,kBAAAA,GAA+C,UAAA,IAAA,EAAgB,CAC3D;AADJA,GAAAA;;AAGAA,EAAAA,eAAe,CAAfA,SAAAA,CAAAA,oBAAAA,GAAiD,UAAA,IAAA,EAAgB,CAC7D;AADJA,GAAAA;;AAGAA,EAAAA,eAAe,CAAfA,SAAAA,CAAAA,oBAAAA,GAAiD,UAAA,IAAA,EAAgB,CAC7D;AADJA,GAAAA;;AAGA,SAAA,eAAA;AAfJ,CAAqC,EAArC;;AAkBA,SAAA,UAAA,CAAA,SAAA,EAAA,QAAA,EAAyC;AACrC,MAAIlU,QAAQ,KAAK,KAAjB,CAAA,EAAyB;AAAEA,IAAAA,QAAQ,GAARA,EAAAA;AAAgB;;AAC3C,MAAI3qB,OAAO,GAAG8+B,cAAc,CAA5B,QAA4B,CAA5B;AACA,MAAIjyB,SAAS,GAAGC,eAAe,CAA/B,QAA+B,CAA/B;AACA,MAAIiyB,QAAQ,GAAG/+B,OAAO,CAAPA,gBAAAA,CAAf,SAAeA,CAAf;;AACA,MAAI,CAAJ,QAAA,EAAe;AAAE;AACb,WAAA,EAAA;AACH;;AACD,SAAO,OAAO,CAAP,MAAA,CAAe++B,QAAQ,CAAvB,MAAA,EAAA,SAAA,EAA2C;AAC9C9xB,IAAAA,SAAS,EAAE8xB,QAAQ,CAAC9xB;AAD0B,GAA3C,CAAP;AAGH;;AACD,SAAA,WAAA,CAAA,UAAA,EAAA,QAAA,EAAA,QAAA,CAAoD;AAApD,EACE;AACE,MAAIjN,OAAO,GAAG8+B,cAAc,CAAC,OAAA,QAAA,KAAA,QAAA,IAAA,QAAA,GAAA,QAAA,GAD/B,EAC8B,CAA5B,CADF,CAC0F;;AACxF,MAAIjyB,SAAS,GAAGC,eAAe,CAAA,QAAA,EAAW4X,cAAc,CAAxD,qBAA+B,CAA/B;AACA,MAAInN,SAAS,GAAGvX,OAAO,CAAPA,gBAAAA,CAAhB,UAAgBA,CAAhB;AACA,MAAIwX,OAAO,GAAGxX,OAAO,CAAPA,gBAAAA,CAAd,QAAcA,CAAd;;AACA,MAAI,CAAA,SAAA,IAAc,CAAlB,OAAA,EAA4B;AAAE;AAC1B,WAAA,EAAA;AACH;;AACD,SAAO,OAAO,CAAP,WAAA,CAAoBuX,SAAS,CAA7B,MAAA,EAAsCC,OAAO,CAA7C,MAAA,EAAA,SAAA,EAAiE;AACpEzK,IAAAA,cAAc,EAAEwK,SAAS,CAD2C,SAAA;AAEpEvK,IAAAA,YAAY,EAAEwK,OAAO,CAF+C,SAAA;AAGpE6f,IAAAA,cAAc,EAAE1M,QAAQ,CAAC0M;AAH2C,GAAjE,CAAP;EAMJ;;;AACA,SAAA,cAAA,CAAA,QAAA,EAAkC;AAC9B,MAAIxuB,MAAM,GAAGmhB,WAAW,CAACW,QAAQ,CAARA,MAAAA,IAAD,IAAA,EAA0Bb,eAAe,CAAfA,EAAe,CAAfA,CADpB,GACN,CAAxB,CAD8B,CAC8C;AAC5E;;AACAa,EAAAA,QAAQ,GAAGrqB,OAAQ,CAAC;AAAEqK,IAAAA,QAAQ,EAAE+Z,cAAc,CAA1B,QAAA;AAAqC7Z,IAAAA,cAAc,EAAE;AAArD,GAAD,EAAA,QAAA,EAA6E;AAAEhC,IAAAA,MAAM,EAAEA;AAAV,GAA7E,CAAnB8hB;AACA,SAAO,IAAA,OAAA,CAAP,QAAO,CAAP;AACH;;AAED,IAAIqU,eAAe,GAAG;AAClBpnB,EAAAA,SAAS,EADS,cAAA;AAElBhX,EAAAA,QAAQ,EAFU,cAAA;AAGlBq+B,EAAAA,MAAM,EAHY,OAAA;AAIlB/zB,EAAAA,QAAQ,EAAEtN;AAJQ,CAAtB;AAMA,IAAIshC,kBAAkB,GAAG;AACrBD,EAAAA,MAAM,EAAE;AADa,CAAzB;;AAGA,SAAA,aAAA,CAAA,GAAA,EAA4B;AACxB,MAAI//B,aAAa,GAAjB,EAAA;AACA,MAAIJ,OAAO,GAAGsW,WAAW,CAAA,GAAA,EAAA,eAAA,EAAA,kBAAA,EAAzB,aAAyB,CAAzB;AACAtW,EAAAA,OAAO,CAAPA,aAAAA,GAAAA,aAAAA;AACA,SAAA,OAAA;EAGJ;;;AACA,SAAA,2BAAA,CAAA,oBAAA,EAAA,MAAA,EAAmE;AAC/D;AACA;AACA,MAAI,CAAA,oBAAA,IAAyBK,MAAM,GAAnC,EAAA,EAA0C;AACtC,WAAO;AAAE8G,MAAAA,OAAO,EAAE;AAAX,KAAP,CADsC,CACT;AADjC,GAAA,MAGK,IAAI9G,MAAM,GAAV,CAAA,EAAgB;AACjB,WAAO;AAAE8G,MAAAA,OAAO,EAAT,OAAA;AAAoBF,MAAAA,KAAK,EAAzB,SAAA;AAAsCC,MAAAA,GAAG,EAAzC,SAAA;AAAsDN,MAAAA,UAAU,EAAE;AAAlE,KAAP,CADiB,CACgE;AADhF,GAAA,MAGA;AACD,WAAO;AAAEO,MAAAA,OAAO,EAAE;AAAX,KAAP,CADC,CAC2B;AAC/B;AACJ;;AACD,SAAA,cAAA,CAAA,UAAA,EAAA,WAAA,EAAA,oBAAA,EAAA,MAAA,EAAA,aAAA,EAAA,OAAA,EAAA,OAAA,EAAA,UAAA,EAA4H;AACxH,MAAIwI,IAAI,GAAG9P,OAAO,CAAlB,IAAA;AAAA,MAAyBqB,OAAO,GAAGrB,OAAO,CAA1C,OAAA;AAAA,MAAoDwc,KAAK,GAAGxc,OAAO,CAAnE,KAAA;AAAA,MAA2EsK,OAAO,GAAGtK,OAAO,CAA5F,OAAA;AACA,MAAIwgC,WAAW,GAAG9jB,mBAAmB,CAAClL,WAAW,CAAZ,WAAA,EAFmF,UAEnF,CAArC,CAFwH,CAE5C;;AAC5E,MAAIoB,UAAU,GAAG,CAAA,eAAA,EAEb4J,KAAK,CAALA,QAAAA,CAFJ,cAEIA,CAFa,CAAjB;AAIA,MAAA,SAAA;;AACA,MAAI,OAAOlS,OAAO,CAAd,gBAAA,KAAJ,UAAA,EAAoD;AAChD+R,IAAAA,SAAS,GAAG/R,OAAO,CAAPA,gBAAAA,CAAyBjJ,OAAO,CAAPA,MAAAA,CAArCgb,UAAqChb,CAAzBiJ,CAAZ+R;AADJ,GAAA,MAGK,IAAI,OAAO/R,OAAO,CAAd,gBAAA,KAAJ,UAAA,EAAoD;AACrD+R,IAAAA,SAAS,GAAGjG,UAAU,CAAC9L,OAAO,CAAPA,gBAAAA,CAAyBjJ,OAAO,CAAPA,MAAAA,CAAhDgb,UAAgDhb,CAAzBiJ,CAAD,CAAtB+R;AADC,GAAA,MAGA;AACDA,IAAAA,SAAS,GAAGjG,UAAU,CAAC/U,OAAO,CAAPA,MAAAA,CAAAA,UAAAA,EAAvBgb,aAAuBhb,CAAD,CAAtBgb;AAfoH,GAAA,CAiBxH;;;AACA,MAAA,oBAAA,EAA0B;AACtBzJ,IAAAA,UAAU,GAAGA,UAAU,CAAVA,MAAAA,EACb;AACA;AACA6tB,IAAAA,aAAa,CAAA,UAAA,EAAA,WAAA,EAAA,OAAA,EAHb7tB,IAGa,CAHAA,CAAbA;AADJ,GAAA,MAMK;AACDA,IAAAA,UAAU,CAAVA,IAAAA,CAAgB,QAAQpZ,OAAO,CAACghC,UAAU,CADzC,SAC+BA,EAAD,CAA/B5nB,EADC,CACyD;AAC7D;;AACD,SAAO,KAAA,aAAA,GACaA,UAAU,CAAVA,IAAAA,CADb,GACaA,CADb,GAAA,GAAA,IAED4tB,WAAW,IAAZ,oBAACA,GACE,iBAAiB,OAAO,CAAP,SAAA,CAAA,UAAA,EAA8B;AAAEpkB,IAAAA,QAAQ,EAAE;AAAZ,GAA9B,CAAjB,GADH,GAACokB,GAFC,EAAA,KAKFE,OAAO,GAAPA,CAAAA,GACG,eAAA,OAAA,GADHA,GAAAA,GALE,EAAA,KAQFC,UAAU,GACP,MADO,UAAA,GARR,EAAA,IAAA,GAAA,IAYFH,WAAW,GACR;AACAI,EAAAA,mBAAmB,CAAA,IAAA,EAAO;AAAEvlC,IAAAA,IAAI,EAAN,UAAA;AAAoB6gB,IAAAA,QAAQ,EAAE,CAAA,oBAAA,IAAyB2kB,MAAM,KAAK;AAAlE,GAAP,EAFX,SAEW,CAFX,GAGR;AAfD,EAAA,SAAA,IAAP,OAAA;AAkBH;;AAED,IAAIC,SAAS;AAAG;AAAe,UAAA,MAAA,EAAkB;AAC7CvjB,EAAAA,SAAS,CAAA,SAAA,EAATA,MAAS,CAATA;;AACA,WAAA,SAAA,CAAA,OAAA,EAAA,QAAA,EAAsC;AAClC,QAAInD,KAAK,GAAGoD,MAAM,CAANA,IAAAA,CAAAA,IAAAA,EAAAA,OAAAA,KAAZ,IAAA;;AACA6a,IAAAA,QAAQ,CAARA,SAAAA,GAFkC,EAElCA,CAFkC,CAET;;AACzBA,IAAAA,QAAQ,CAARA,WAAAA,CAAqBje,KAAK,CAALA,EAAAA,GAAW4b,aAAa,CAAC,wBAAwB5b,KAAK,CAALA,KAAAA,CAAAA,QAAAA,CAAxB,WAAwBA,CAAxB,GAAA,IAAA,GAAA,gBAAA,GACvBA,KAAK,CAALA,KAAAA,CAAAA,QAAAA,CADuB,WACvBA,CADuB,GAAA,IAAA,GAAA,iBAAA,GAAA,UAAA,GAA9Cie,QAA6C,CAA7CA;AAKAje,IAAAA,KAAK,CAALA,KAAAA,GAAcA,KAAK,CAALA,EAAAA,CAAAA,aAAAA,CAAdA,OAAcA,CAAdA;AACA,WAAA,KAAA;AACH;;AACD0mB,EAAAA,SAAS,CAATA,SAAAA,CAAAA,OAAAA,GAA8B,YAAY;AACtC9pC,IAAAA,aAAa,CAAC,KAAdA,EAAa,CAAbA;AADJ8pC,GAAAA;;AAGAA,EAAAA,SAAS,CAATA,SAAAA,CAAAA,MAAAA,GAA6B,UAAA,KAAA,EAAiB;AAC1C,QAAIC,KAAK,GAAGzrC,KAAK,CAAjB,KAAA;AAAA,QAAyB0rC,oBAAoB,GAAG1rC,KAAK,CAArD,oBAAA;AACA,QAAI0U,KAAK,GAAT,EAAA;;AACA,QAAI1U,KAAK,CAAT,eAAA,EAA2B;AACvB0U,MAAAA,KAAK,CAALA,IAAAA,CAAW1U,KAAK,CAAhB0U,eAAW1U,EAAX0U;AACH;;AACD,QAAIi3B,aAAa,GAAG9yB,eAAe,CAAC,KAAA,GAAA,CAAA,oBAAA,KAChC+yB,2BAA2B,CAAA,oBAAA,EAAuBH,KAAK,CAD3D,MAC+B,CADI,CAAnC;;AAEA,SAAK,IAAIvhC,EAAE,GAAN,CAAA,EAAY2hC,OAAO,GAAxB,KAAA,EAAkC3hC,EAAE,GAAG2hC,OAAO,CAA9C,MAAA,EAAuD3hC,EAAvD,EAAA,EAA6D;AACzD,UAAInE,IAAI,GAAG8lC,OAAO,CAAlB,EAAkB,CAAlB;AACAn3B,MAAAA,KAAK,CAALA,IAAAA,CAAWo3B,cAAc,CAAA,IAAA,EAAO9rC,KAAK,CAAZ,WAAA,EAAA,oBAAA,EAAgDyrC,KAAK,CAArD,MAAA,EAAA,aAAA,EAA6E,KAAtG/2B,OAAyB,CAAzBA;AACH;;AACD,QAAI,KAAJ,KAAA,EAAgB;AACZA,MAAAA,KAAK,CAALA,OAAAA;AACH;;AACD,SAAA,KAAA,CAAA,SAAA,GAAuB,SAASA,KAAK,CAALA,IAAAA,CAAT,EAASA,CAAT,GAAvB,OAAA;AAfJ82B,GAAAA;;AAiBA,SAAA,SAAA;AAjC2B,CAAA,CAA/B,SAA+B,CAA/B;;AAoCA,IAAIO,SAAS;AAAG;AAAe,YAAY;AACvC,WAAA,SAAA,CAAA,KAAA,EAAA,oBAAA,EAAgD;AAC5C,QAAIhmC,IAAI,GAAG2K,KAAK,CAAhB,KAAA;AACA,QAAIrF,GAAG,GAAGqF,KAAK,CAAf,GAAA;AACA,QAAIs7B,OAAO,GAAX,EAAA;AACA,QAAIP,KAAK,GAAT,EAAA;AACA,QAAIQ,QAAQ,GAAG,CAAf,CAAA;;AACA,WAAOlmC,IAAI,GAAX,GAAA,EAAmB;AAAE;AACjB,UAAIi8B,oBAAoB,CAApBA,WAAAA,CAAJ,IAAIA,CAAJ,EAA4C;AACxCgK,QAAAA,OAAO,CAAPA,IAAAA,CAAaC,QAAQ,GADmB,GACxCD,EADwC,CACV;AADlC,OAAA,MAGK;AACDC,QAAAA,QAAQ;AACRD,QAAAA,OAAO,CAAPA,IAAAA,CAAAA,QAAAA;AACAP,QAAAA,KAAK,CAALA,IAAAA,CAAAA,IAAAA;AACH;;AACD1lC,MAAAA,IAAI,GAAGuF,OAAO,CAAA,IAAA,EAAdvF,CAAc,CAAdA;AACH;;AACD,SAAA,KAAA,GAAA,KAAA;AACA,SAAA,OAAA,GAAA,OAAA;AACA,SAAA,GAAA,GAAW0lC,KAAK,CAAhB,MAAA;AACH;;AACDM,EAAAA,SAAS,CAATA,SAAAA,CAAAA,UAAAA,GAAiC,UAAA,KAAA,EAAiB;AAC9C,QAAIG,UAAU,GAAG,KAAA,eAAA,CAAqBx7B,KAAK,CADG,KAC7B,CAAjB,CAD8C,CACM;;AACpD,QAAIy7B,SAAS,GAAG,KAAA,eAAA,CAAqB7gC,OAAO,CAACoF,KAAK,CAAN,GAAA,EAAY,CAFV,CAEF,CAA5B,CAAhB,CAF8C,CAEgB;;AAC9D,QAAI07B,iBAAiB,GAAG9rC,IAAI,CAAJA,GAAAA,CAAAA,CAAAA,EAAxB,UAAwBA,CAAxB;AACA,QAAI+rC,gBAAgB,GAAG/rC,IAAI,CAAJA,GAAAA,CAAS,KAAA,GAAA,GAATA,CAAAA,EAJuB,SAIvBA,CAAvB,CAJ8C,CAK9C;;AACA8rC,IAAAA,iBAAiB,GAAG9rC,IAAI,CAAJA,IAAAA,CAN0B,iBAM1BA,CAApB8rC,CAN8C,CAMI;;AAClDC,IAAAA,gBAAgB,GAAG/rC,IAAI,CAAJA,KAAAA,CAP2B,gBAO3BA,CAAnB+rC,CAP8C,CAOG;;AACjD,QAAID,iBAAiB,IAArB,gBAAA,EAA2C;AACvC,aAAO;AACHF,QAAAA,UAAU,EADP,iBAAA;AAEHC,QAAAA,SAAS,EAFN,gBAAA;AAGHnyB,QAAAA,OAAO,EAAEkyB,UAAU,KAHhB,iBAAA;AAIHjyB,QAAAA,KAAK,EAAEkyB,SAAS,KAAKE;AAJlB,OAAP;AADJ,KAAA,MAQK;AACD,aAAA,IAAA;AACH;AAxCkC,GAsBvCN,CAtBuC,CA0CvC;AACA;AACA;AACA;AACA;;;AACAA,EAAAA,SAAS,CAATA,SAAAA,CAAAA,eAAAA,GAAsC,UAAA,IAAA,EAAgB;AAClD,QAAIC,OAAO,GAAG,KAAd,OAAA;AACA,QAAIM,SAAS,GAAGhsC,IAAI,CAAJA,KAAAA,CAAWiE,QAAQ,CAAC,KAAA,KAAA,CAAD,CAAC,CAAD,EAAnC,IAAmC,CAAnBjE,CAAhB;;AACA,QAAIgsC,SAAS,GAAb,CAAA,EAAmB;AACf,aAAON,OAAO,CAAPA,CAAO,CAAPA,GAAP,CAAA;AADJ,KAAA,MAGK,IAAIM,SAAS,IAAIN,OAAO,CAAxB,MAAA,EAAiC;AAClC,aAAOA,OAAO,CAACA,OAAO,CAAPA,MAAAA,GAARA,CAAO,CAAPA,GAAP,CAAA;AADC,KAAA,MAGA;AACD,aAAOA,OAAO,CAAd,SAAc,CAAd;AACH;AAXLD,GAAAA;;AAaA,SAAA,SAAA;AA5DJ,CAA+B,EAA/B;;AA+DA,IAAIQ,QAAQ;AAAG;AAAe,YAAY;AACtC,WAAA,QAAA,CAAA,SAAA,EAAA,YAAA,EAA2C;AACvC,QAAId,KAAK,GAAGe,SAAS,CAArB,KAAA;AACA,QAAA,UAAA;AACA,QAAA,QAAA;AACA,QAAA,MAAA;;AACA,QAAA,YAAA,EAAkB;AACd;AACA9D,MAAAA,QAAQ,GAAG+C,KAAK,CAALA,CAAK,CAALA,CAAX/C,SAAW+C,EAAX/C;;AACA,WAAK+D,UAAU,GAAf,CAAA,EAAqBA,UAAU,GAAGhB,KAAK,CAAvC,MAAA,EAAgDgB,UAAhD,EAAA,EAA8D;AAC1D,YAAIhB,KAAK,CAALA,UAAK,CAALA,CAAAA,SAAAA,OAAJ,QAAA,EAAgD;AAC5C;AACH;AACJ;;AACDiB,MAAAA,MAAM,GAAGpsC,IAAI,CAAJA,IAAAA,CAAUmrC,KAAK,CAALA,MAAAA,GAAnBiB,UAASpsC,CAATosC;AARJ,KAAA,MAUK;AACDA,MAAAA,MAAM,GAANA,CAAAA;AACAD,MAAAA,UAAU,GAAGhB,KAAK,CAAlBgB,MAAAA;AACH;;AACD,SAAA,MAAA,GAAA,MAAA;AACA,SAAA,MAAA,GAAA,UAAA;AACA,SAAA,SAAA,GAAA,SAAA;AACA,SAAA,KAAA,GAAa,KAAb,UAAa,EAAb;AACA,SAAA,WAAA,GAAmB,KAAnB,gBAAmB,EAAnB;AACH;;AACDF,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,UAAAA,GAAgC,YAAY;AACxC,QAAII,IAAI,GAAR,EAAA;;AACA,SAAK,IAAIC,GAAG,GAAZ,CAAA,EAAkBA,GAAG,GAAG,KAAxB,MAAA,EAAqCA,GAArC,EAAA,EAA4C;AACxC,UAAIC,KAAK,GAAT,EAAA;;AACA,WAAK,IAAIC,GAAG,GAAZ,CAAA,EAAkBA,GAAG,GAAG,KAAxB,MAAA,EAAqCA,GAArC,EAAA,EAA4C;AACxCD,QAAAA,KAAK,CAALA,IAAAA,CAAW,KAAA,SAAA,CAAA,GAAA,EAAXA,GAAW,CAAXA;AACH;;AACDF,MAAAA,IAAI,CAAJA,IAAAA,CAAAA,KAAAA;AACH;;AACD,WAAA,IAAA;AATJJ,GAAAA;;AAWAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,SAAAA,GAA+B,UAAA,GAAA,EAAA,GAAA,EAAoB;AAC/C,WAAO;AACHxmC,MAAAA,IAAI,EAAE,KAAA,SAAA,CAAA,KAAA,CAAqB6mC,GAAG,GAAG,KAANA,MAAAA,GAArB,GAAA;AADH,KAAP;AADJL,GAAAA;;AAKAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,gBAAAA,GAAsC,YAAY;AAC9C,QAAId,KAAK,GAAT,EAAA;;AACA,SAAK,IAAIqB,GAAG,GAAZ,CAAA,EAAkBA,GAAG,GAAG,KAAxB,MAAA,EAAqCA,GAArC,EAAA,EAA4C;AACxCrB,MAAAA,KAAK,CAALA,IAAAA,CAAW,KAAA,KAAA,CAAA,CAAA,EAAA,GAAA,EAAXA,IAAAA;AACH;;AACD,WAAA,KAAA;AALJc,GAAAA;;AAOAA,EAAAA,QAAQ,CAARA,SAAAA,CAAAA,UAAAA,GAAgC,UAAA,KAAA,EAAiB;AAC7C,QAAIhB,MAAM,GAAG,KAAb,MAAA;AACA,QAAIwB,SAAS,GAAG,KAAA,SAAA,CAAA,UAAA,CAAhB,KAAgB,CAAhB;AACA,QAAItyB,IAAI,GAAR,EAAA;;AACA,QAAA,SAAA,EAAe;AACX,UAAIyxB,UAAU,GAAGa,SAAS,CAA1B,UAAA;AAAA,UAAuCZ,SAAS,GAAGY,SAAS,CAA5D,SAAA;AACA,UAAIC,KAAK,GAAT,UAAA;;AACA,aAAOA,KAAK,IAAZ,SAAA,EAA2B;AACvB,YAAIJ,GAAG,GAAGtsC,IAAI,CAAJA,KAAAA,CAAW0sC,KAAK,GAA1B,MAAU1sC,CAAV;AACA,YAAI2sC,SAAS,GAAG3sC,IAAI,CAAJA,GAAAA,CAAS,CAACssC,GAAG,GAAJ,CAAA,IAATtsC,MAAAA,EAA6B6rC,SAAS,GAAtD,CAAgB7rC,CAAhB;AACAma,QAAAA,IAAI,CAAJA,IAAAA,CAAU;AACNmyB,UAAAA,GAAG,EADG,GAAA;AAENM,UAAAA,QAAQ,EAAEF,KAAK,GAFT,MAAA;AAGNG,UAAAA,OAAO,EAAE,CAACF,SAAS,GAAV,CAAA,IAHH,MAAA;AAINjzB,UAAAA,OAAO,EAAE+yB,SAAS,CAATA,OAAAA,IAAqBC,KAAK,KAJ7B,UAAA;AAKN/yB,UAAAA,KAAK,EAAE8yB,SAAS,CAATA,KAAAA,IAAoBE,SAAS,GAAV,CAACA,KAAmBd;AALxC,SAAV1xB;AAOAuyB,QAAAA,KAAK,GAALA,SAAAA;AACH;AACJ;;AACD,WAAA,IAAA;AApBJT,GAAAA;;AAsBA,SAAA,QAAA;AAvEJ,CAA8B,EAA9B;;AA0EA,IAAIa,MAAM;AAAG;AAAe,YAAY;AACpC,WAAA,MAAA,GAAkB;AACd,SAAA,kBAAA,GAA0Br6B,OAAO,CAAC,KAAlC,mBAAiC,CAAjC;AACA,SAAA,kBAAA,GAA0BA,OAAO,CAAC,KAAlC,cAAiC,CAAjC;AACA,SAAA,eAAA,GAAuBA,OAAO,CAAC,KAA/B,gBAA8B,CAA9B;AACA,SAAA,cAAA,GAAsBA,OAAO,CAAC,KAA9B,iBAA6B,CAA7B;AACA,SAAA,gBAAA,GAAwBA,OAAO,CAAC,KAAhC,iBAA+B,CAA/B;AACH;;AACDq6B,EAAAA,MAAM,CAANA,SAAAA,CAAAA,UAAAA,GAA8B,UAAA,KAAA,EAAA,WAAA,EAAA,gBAAA,EAAA,SAAA,EAA2D;AACrF,QAAIC,SAAS,GAAb,EAAA;;AACA,SAAK,IAAInjC,EAAE,GAAX,CAAA,EAAiBA,EAAE,GAAGC,SAAS,CAA/B,MAAA,EAAwCD,EAAxC,EAAA,EAA8C;AAC1CmjC,MAAAA,SAAS,CAACnjC,EAAE,GAAZmjC,CAAS,CAATA,GAAoBljC,SAAS,CAA7BkjC,EAA6B,CAA7BA;AACH;;AACD,QAAIlyB,YAAY,GAAGnb,KAAK,CAAxB,YAAA;AACA,QAAIstC,SAAS,GAAG,KAAA,eAAA,CAAA,KAAA,CAAA,IAAA,EAAiC,CAACttC,KAAK,CAAN,UAAA,EAAA,YAAA,EAAA,WAAA,EAAA,gBAAA,EAAA,SAAA,EAAA,MAAA,CAAjD,SAAiD,CAAjC,CAAhB;AACA,WAAO;AACHutC,MAAAA,iBAAiB,EAAE,KAAA,kBAAA,CAAA,KAAA,CAAA,IAAA,EAAoC,CAACvtC,KAAK,CAAN,aAAA,EAAA,YAAA,EAAA,SAAA,EAAA,MAAA,CADpD,SACoD,CAApC,CADhB;AAEHwtC,MAAAA,gBAAgB,EAAE,KAAA,kBAAA,CAAA,KAAA,CAAA,IAAA,EAAoC,CAACxtC,KAAK,CAAN,aAAA,EAAA,WAAA,EAAA,gBAAA,EAAA,SAAA,EAAA,MAAA,CAFnD,SAEmD,CAApC,CAFf;AAGHytC,MAAAA,WAAW,EAAEH,SAAS,CAHnB,EAAA;AAIHI,MAAAA,WAAW,EAAEJ,SAAS,CAJnB,EAAA;AAKH5vB,MAAAA,SAAS,EAAE,KAAA,cAAA,CAAA,KAAA,CAAA,IAAA,EAAgC,CAAC1d,KAAK,CAAN,SAAA,EAAA,YAAA,EAAA,WAAA,EAAA,gBAAA,EAAA,SAAA,EAAA,MAAA,CALxC,SAKwC,CAAhC,CALR;AAMH+d,MAAAA,WAAW,EAAE,KAAA,gBAAA,CAAA,KAAA,CAAA,IAAA,EAAkC,CAAC/d,KAAK,CAAN,WAAA,EAAA,YAAA,EAAA,WAAA,EAAA,gBAAA,EAAA,SAAA,EAAA,MAAA,CAN5C,SAM4C,CAAlC,CANV;AAOH8d,MAAAA,cAAc,EAAE9d,KAAK,CAAC8d;AAPnB,KAAP,CAPqF,CAelF;AAfPsvB,GAAAA;;AAiBAA,EAAAA,MAAM,CAANA,SAAAA,CAAAA,YAAAA,GAAgC,WAAU;AAAV,EAAA,IAAA,EAAA,SAAA,EACf;AACb,QAAIC,SAAS,GAAb,EAAA;;AACA,SAAK,IAAInjC,EAAE,GAAX,CAAA,EAAiBA,EAAE,GAAGC,SAAS,CAA/B,MAAA,EAAwCD,EAAxC,EAAA,EAA8C;AAC1CmjC,MAAAA,SAAS,CAACnjC,EAAE,GAAZmjC,CAAS,CAATA,GAAoBljC,SAAS,CAA7BkjC,EAA6B,CAA7BA;AACH;;AACD,WAAO,KAAA,cAAA,CAAA,KAAA,CAAA,IAAA,EAAgC,CAAC;AAAE38B,MAAAA,KAAK,EAAE;AAAEtF,QAAAA,KAAK,EAAP,IAAA;AAAeC,QAAAA,GAAG,EAAEosB,KAAK,CAAA,IAAA,EAAA,CAAA;AAAzB,OAAT;AAA+C/qB,MAAAA,MAAM,EAAE;AAAvD,KAAD,EAAA,EAAA,EAAA,SAAA,EAAA,MAAA,CAAvC,SAAuC,CAAhC,CAAP;AANJ0gC,GAAAA;;AAUAA,EAAAA,MAAM,CAANA,SAAAA,CAAAA,mBAAAA,GAAuC,UAAA,aAAA,EAAA,WAAA,EAAA,gBAAA,EAAA,SAAA,EAAmE;AACtG,QAAIC,SAAS,GAAb,EAAA;;AACA,SAAK,IAAInjC,EAAE,GAAX,CAAA,EAAiBA,EAAE,GAAGC,SAAS,CAA/B,MAAA,EAAwCD,EAAxC,EAAA,EAA8C;AAC1CmjC,MAAAA,SAAS,CAACnjC,EAAE,GAAZmjC,CAAS,CAATA,GAAoBljC,SAAS,CAA7BkjC,EAA6B,CAA7BA;AACH;;AACD,QAAI,CAAJ,aAAA,EAAoB;AAChB,aAAA,EAAA;AACH;;AACD,WAAO,KAAA,gBAAA,CAAA,KAAA,CAAA,IAAA,EAAkC,CAACjxB,eAAe,CAAA,aAAA,EAAgBuxB,kBAAkB,CAAA,WAAA,EAAcv+B,OAAO,CAAvD,gBAAuD,CAArB,CAAlC,EAA4EsX,SAAS,CAArG,QAAgB,CAAhB,EAAA,EAAA,EAAA,WAAA,EAAA,gBAAA,EAAA,SAAA,EAAA,MAAA,CAAlC,SAAkC,CAAlC,EAAP,EAAA;AARJ0mB,GAAAA;;AAcAA,EAAAA,MAAM,CAANA,SAAAA,CAAAA,gBAAAA,GAAoC,UAAA,UAAA,EAAA,YAAA,EAAA,WAAA,EAAA,gBAAA,EAAA,SAAA,EAA8E;AAC9G,QAAIC,SAAS,GAAb,EAAA;;AACA,SAAK,IAAInjC,EAAE,GAAX,CAAA,EAAiBA,EAAE,GAAGC,SAAS,CAA/B,MAAA,EAAwCD,EAAxC,EAAA,EAA8C;AAC1CmjC,MAAAA,SAAS,CAACnjC,EAAE,GAAZmjC,CAAS,CAATA,GAAoBljC,SAAS,CAA7BkjC,EAA6B,CAA7BA;AACH;;AACD,QAAA,UAAA,EAAgB;AACZ,UAAIO,QAAQ,GAAG5E,eAAe,CAAA,UAAA,EAAA,YAAA,EAA2B2E,kBAAkB,CAAA,WAAA,EAAcv+B,OAAO,CAAlE,gBAAkE,CAArB,CAA7C,EAA9B,gBAA8B,CAA9B;AACA,aAAO;AACHkL,QAAAA,EAAE,EAAE,KAAA,gBAAA,CAAsBszB,QAAQ,CAA9B,EAAA,EAAA,SAAA,EADD,SACC,CADD;AAEHrzB,QAAAA,EAAE,EAAE,KAAA,gBAAA,CAAsBqzB,QAAQ,CAA9B,EAAA,EAAA,SAAA,EAAA,SAAA;AAFD,OAAP;AAFJ,KAAA,MAOK;AACD,aAAO;AAAEtzB,QAAAA,EAAE,EAAJ,EAAA;AAAUC,QAAAA,EAAE,EAAE;AAAd,OAAP;AACH;AAdL6yB,GAAAA;;AAgBAA,EAAAA,MAAM,CAANA,SAAAA,CAAAA,iBAAAA,GAAqC,UAAA,WAAA,EAAA,YAAA,EAAA,WAAA,EAAA,gBAAA,EAAA,SAAA,EAA+E;AAChH,QAAIC,SAAS,GAAb,EAAA;;AACA,SAAK,IAAInjC,EAAE,GAAX,CAAA,EAAiBA,EAAE,GAAGC,SAAS,CAA/B,MAAA,EAAwCD,EAAxC,EAAA,EAA8C;AAC1CmjC,MAAAA,SAAS,CAACnjC,EAAE,GAAZmjC,CAAS,CAATA,GAAoBljC,SAAS,CAA7BkjC,EAA6B,CAA7BA;AACH;;AACD,QAAI,CAAJ,WAAA,EAAkB;AACd,aAAA,IAAA;AACH;;AACD,QAAIO,QAAQ,GAAG5E,eAAe,CAACrrB,WAAW,CAAZ,aAAA,EAAA,YAAA,EAA0CgwB,kBAAkB,CAAA,WAAA,EAAcv+B,OAAO,CAAjF,gBAAiF,CAArB,CAA5D,EAA9B,gBAA8B,CAA9B;AACA,WAAO;AACHqL,MAAAA,IAAI,EAAE,KAAA,gBAAA,CAAsBmzB,QAAQ,CAA9B,EAAA,EAAA,SAAA,EADH,SACG,CADH;AAEHC,MAAAA,iBAAiB,EAAElwB,WAAW,CAAXA,cAAAA,CAFhB,SAAA;AAGH2I,MAAAA,OAAO,EAAE3I,WAAW,CAHjB,OAAA;AAIHmwB,MAAAA,SAAS,EAAEnwB,WAAW,CAAC4I;AAJpB,KAAP;AATJ6mB,GAAAA;;AAgBAA,EAAAA,MAAM,CAANA,SAAAA,CAAAA,cAAAA,GAAkC,UAAA,QAAA,EAAA,YAAA,EAAA,SAAA,EAA6C;AAC3E,QAAIC,SAAS,GAAb,EAAA;;AACA,SAAK,IAAInjC,EAAE,GAAX,CAAA,EAAiBA,EAAE,GAAGC,SAAS,CAA/B,MAAA,EAAwCD,EAAxC,EAAA,EAA8C;AAC1CmjC,MAAAA,SAAS,CAACnjC,EAAE,GAAZmjC,CAAS,CAATA,GAAoBljC,SAAS,CAA7BkjC,EAA6B,CAA7BA;AACH;;AACD,QAAI,CAAJ,QAAA,EAAe;AACX,aAAA,EAAA;AACH;;AACD,QAAIvD,UAAU,GAAGiE,mBAAmB,CAAA,QAAA,EAAA,YAAA,EAAyBrnB,SAAS,CAAtE,QAAoC,CAApC;AACA,QAAIjM,IAAI,GAAG,KAAA,UAAA,CAAA,KAAA,CAAA,IAAA,EAA4B,CAACijB,QAAQ,CAAT,KAAA,EAAA,MAAA,CAAvC,SAAuC,CAA5B,CAAX;;AACA,SAAK,IAAIp3B,EAAE,GAAN,CAAA,EAAYwU,MAAM,GAAvB,IAAA,EAAgCxU,EAAE,GAAGwU,MAAM,CAA3C,MAAA,EAAoDxU,EAApD,EAAA,EAA0D;AACtD,UAAIsU,GAAG,GAAGE,MAAM,CAAhB,EAAgB,CAAhB;AACAF,MAAAA,GAAG,CAAHA,SAAAA,GAAAA,SAAAA;AACAA,MAAAA,GAAG,CAAHA,UAAAA,GAAAA,UAAAA;AACH;;AACD,WAAA,IAAA;AAfJwyB,GAAAA;AAiBA;AACJ;AACA;;;AACIA,EAAAA,MAAM,CAANA,SAAAA,CAAAA,gBAAAA,GAAoC,UAAA,WAAA,EAAA,SAAA,EAAkC;AAAlC,EAAA,SAAA,EACzB;AACP,QAAI3yB,IAAI,GAAR,EAAA;;AACA,SAAK,IAAIvQ,EAAE,GAAN,CAAA,EAAY8jC,aAAa,GAA9B,WAAA,EAA8C9jC,EAAE,GAAG8jC,aAAa,CAAhE,MAAA,EAAyE9jC,EAAzE,EAAA,EAA+E;AAC3E,UAAI4/B,UAAU,GAAGkE,aAAa,CAA9B,EAA8B,CAA9B;AACAvzB,MAAAA,IAAI,CAAJA,IAAAA,CAAAA,KAAAA,CAAAA,IAAAA,EAAsB,KAAA,eAAA,CAAA,UAAA,EAAA,SAAA,EAAtBA,SAAsB,CAAtBA;AACH;;AACD,WAAA,IAAA;AAPJ2yB,GAAAA;AASA;AACJ;AACA;;;AACIA,EAAAA,MAAM,CAANA,SAAAA,CAAAA,eAAAA,GAAmC,UAAA,UAAA,EAAA,SAAA,EAAiC;AAAjC,EAAA,SAAA,EACxB;AACP,QAAI3yB,IAAI,GAAG,KAAA,UAAA,CAAA,KAAA,CAAA,IAAA,EAA4B,CAACqvB,UAAU,CAAX,KAAA,EAAA,MAAA,CAAvC,SAAuC,CAA5B,CAAX;;AACA,SAAK,IAAI5/B,EAAE,GAAN,CAAA,EAAYkgB,MAAM,GAAvB,IAAA,EAAgClgB,EAAE,GAAGkgB,MAAM,CAA3C,MAAA,EAAoDlgB,EAApD,EAAA,EAA0D;AACtD,UAAI0Q,GAAG,GAAGwP,MAAM,CAAhB,EAAgB,CAAhB;AACAxP,MAAAA,GAAG,CAAHA,SAAAA,GAAAA,SAAAA;AACAA,MAAAA,GAAG,CAAHA,UAAAA,GAAAA,UAAAA;AACAA,MAAAA,GAAG,CAAHA,OAAAA,GAAckvB,UAAU,CAAVA,OAAAA,IAAsBlvB,GAAG,CAAvCA,OAAAA;AACAA,MAAAA,GAAG,CAAHA,KAAAA,GAAYkvB,UAAU,CAAVA,KAAAA,IAAoBlvB,GAAG,CAAnCA,KAAAA;AACH;;AACD,WAAA,IAAA;AAVJwyB,GAAAA;;AAYA,SAAA,MAAA;AA7HJ,CAA4B,EAA5B;AA+HA;AACA;AACA;AACA;AACA;;;AACA,SAAA,kBAAA,CAAA,WAAA,EAAA,iBAAA,EAA4D;AACxD,MAAI18B,KAAK,GAAGwL,WAAW,CAAvB,WAAA;;AACA,MAAA,iBAAA,EAAuB;AACnB,WAAA,KAAA;AACH;;AACD,SAAO;AACH9Q,IAAAA,KAAK,EAAEqsB,KAAK,CAAC/mB,KAAK,CAAN,KAAA,EAAcwL,WAAW,CAAXA,OAAAA,CADvB,YACS,CADT;AAEH7Q,IAAAA,GAAG,EAAEosB,KAAK,CAAC/mB,KAAK,CAAN,GAAA,EAAYwL,WAAW,CAAXA,OAAAA,CAAAA,YAAAA,GAFnB,KAEO,CAFP,CAE6D;;AAF7D,GAAP;EAMJ;AACA;;;AACA,IAAI+xB,OAAO,GAAX,OAAA;AAEA,SAAA,QAAA,EAAA,SAAA,EAAA,aAAA,EAAA,OAAA,EAAA,oBAAA,EAAA,SAAA,EAAA,SAAA,EAAA,QAAA,EAAA,eAAA,EAAA,uBAAA,EAAA,YAAA,EAAA,QAAA,EAAA,eAAA,EAAA,YAAA,EAAA,WAAA,EAAA,KAAA,EAAA,iBAAA,EAAA,aAAA,EAAA,eAAA,EAAA,gBAAA,EAAA,MAAA,EAAA,QAAA,EAAA,KAAA,EAAA,IAAA,EAAA,sBAAA,EAAA,OAAA,EAAA,YAAA,EAAA,KAAA,EAAA,QAAA,EAAA,gBAAA,EAAA,cAAA,EAAA,eAAA,EAAA,QAAA,EAAA,yBAAA,EAAA,UAAA,EAAA,cAAA,EAAA,cAAA,EAAA,SAAA,EAAA,cAAA,EAAA,mBAAA,EAAA,kBAAA,EAAA,qBAAA,EAAA,eAAA,EAAA,kBAAA,EAAA,mBAAA,EAAA,cAAA,EAAA,gBAAA,EAAA,mBAAA,EAAA,YAAA,EAAA,2BAAA,EAAA,uBAAA,EAAA,gBAAA,EAAA,WAAA,EAAA,sBAAA,EAAA,MAAA,EAAA,cAAA,EAAA,cAAA,EAAA,aAAA,EAAA,qBAAA,EAAA,mBAAA,EAAA,eAAA,EAAA,YAAA,EAAA,QAAA,EAAA,QAAA,EAAA,SAAA,EAAA,cAAA,EAAA,QAAA,EAAA,UAAA,EAAA,SAAA,EAAA,aAAA,EAAA,cAAA,EAAA,aAAA,EAAA,gBAAA,EAAA,cAAA,EAAA,cAAA,EAAA,YAAA,EAAA,iBAAA,EAAA,oBAAA,EAAA,UAAA,EAAA,YAAA,EAAA,YAAA,EAAA,eAAA,EAAA,cAAA,EAAA,UAAA,EAAA,mBAAA,EAAA,WAAA,EAAA,aAAA,EAAA,kBAAA,EAAA,aAAA,EAAA,QAAA,EAAA,aAAA,EAAA,iBAAA,EAAA,cAAA,EAAA,2BAAA,EAAA,cAAA,EAAA,UAAA,EAAA,aAAA,EAAA,kBAAA,EAAA,wBAAA,EAAA,0BAAA,EAAA,eAAA,EAAA,cAAA,EAAA,aAAA,EAAA,gBAAA,EAAA,KAAA,EAAA,kBAAA,EAAA,eAAA,EAAA,YAAA,EAAA,YAAA,EAAA,WAAA,EAAA,WAAA,EAAA,gBAAA,EAAA,OAAA,EAAA,eAAA,EAAA,OAAA,EAAA,aAAA,EAAA,gBAAA,EAAA,gBAAA,EAAA,gBAAA,EAAA,QAAA,EAAA,kBAAA,EAAA,aAAA,EAAA,aAAA,EAAA,eAAA,EAA25Dxf,KAAK,IAAh6D,WAAA,EAAA,eAAA,EAAA,gBAAA,EAAA,kBAAA,EAAA,cAAA,EAAA,gBAAA,EAAA,oBAAA,EAAA,mBAAA,EAAA,kBAAA,EAAA,WAAA,EAAA,eAAA,EAAA,WAAA,EAAA,aAAA,EAAA,WAAA,EAAA,cAAA,EAAA,WAAA,EAAA,eAAA,EAAA,UAAA,EAAA,qBAAA,EAAA,aAAA,EAAA,kBAAA,EAAA,kBAAA,EAAA,WAAA,EAAA,OAAA,EAAA,kBAAA,EAAA,oBAAA","sourcesContent":["/*!\r\nFullCalendar Core Package v4.3.1\r\nDocs & License: https://fullcalendar.io/\r\n(c) 2019 Adam Shaw\r\n*/\r\n\r\n// Creating\r\n// ----------------------------------------------------------------------------------------------------------------\r\nvar elementPropHash = {\r\n    className: true,\r\n    colSpan: true,\r\n    rowSpan: true\r\n};\r\nvar containerTagHash = {\r\n    '<tr': 'tbody',\r\n    '<td': 'tr'\r\n};\r\nfunction createElement(tagName, attrs, content) {\r\n    var el = document.createElement(tagName);\r\n    if (attrs) {\r\n        for (var attrName in attrs) {\r\n            if (attrName === 'style') {\r\n                applyStyle(el, attrs[attrName]);\r\n            }\r\n            else if (elementPropHash[attrName]) {\r\n                el[attrName] = attrs[attrName];\r\n            }\r\n            else {\r\n                el.setAttribute(attrName, attrs[attrName]);\r\n            }\r\n        }\r\n    }\r\n    if (typeof content === 'string') {\r\n        el.innerHTML = content; // shortcut. no need to process HTML in any way\r\n    }\r\n    else if (content != null) {\r\n        appendToElement(el, content);\r\n    }\r\n    return el;\r\n}\r\nfunction htmlToElement(html) {\r\n    html = html.trim();\r\n    var container = document.createElement(computeContainerTag(html));\r\n    container.innerHTML = html;\r\n    return container.firstChild;\r\n}\r\nfunction htmlToElements(html) {\r\n    return Array.prototype.slice.call(htmlToNodeList(html));\r\n}\r\nfunction htmlToNodeList(html) {\r\n    html = html.trim();\r\n    var container = document.createElement(computeContainerTag(html));\r\n    container.innerHTML = html;\r\n    return container.childNodes;\r\n}\r\n// assumes html already trimmed and tag names are lowercase\r\nfunction computeContainerTag(html) {\r\n    return containerTagHash[html.substr(0, 3) // faster than using regex\r\n    ] || 'div';\r\n}\r\nfunction appendToElement(el, content) {\r\n    var childNodes = normalizeContent(content);\r\n    for (var i = 0; i < childNodes.length; i++) {\r\n        el.appendChild(childNodes[i]);\r\n    }\r\n}\r\nfunction prependToElement(parent, content) {\r\n    var newEls = normalizeContent(content);\r\n    var afterEl = parent.firstChild || null; // if no firstChild, will append to end, but that's okay, b/c there were no children\r\n    for (var i = 0; i < newEls.length; i++) {\r\n        parent.insertBefore(newEls[i], afterEl);\r\n    }\r\n}\r\nfunction insertAfterElement(refEl, content) {\r\n    var newEls = normalizeContent(content);\r\n    var afterEl = refEl.nextSibling || null;\r\n    for (var i = 0; i < newEls.length; i++) {\r\n        refEl.parentNode.insertBefore(newEls[i], afterEl);\r\n    }\r\n}\r\nfunction normalizeContent(content) {\r\n    var els;\r\n    if (typeof content === 'string') {\r\n        els = htmlToElements(content);\r\n    }\r\n    else if (content instanceof Node) {\r\n        els = [content];\r\n    }\r\n    else { // Node[] or NodeList\r\n        els = Array.prototype.slice.call(content);\r\n    }\r\n    return els;\r\n}\r\nfunction removeElement(el) {\r\n    if (el.parentNode) {\r\n        el.parentNode.removeChild(el);\r\n    }\r\n}\r\n// Querying\r\n// ----------------------------------------------------------------------------------------------------------------\r\n// from https://developer.mozilla.org/en-US/docs/Web/API/Element/closest\r\nvar matchesMethod = Element.prototype.matches ||\r\n    Element.prototype.matchesSelector ||\r\n    Element.prototype.msMatchesSelector;\r\nvar closestMethod = Element.prototype.closest || function (selector) {\r\n    // polyfill\r\n    var el = this;\r\n    if (!document.documentElement.contains(el)) {\r\n        return null;\r\n    }\r\n    do {\r\n        if (elementMatches(el, selector)) {\r\n            return el;\r\n        }\r\n        el = el.parentElement || el.parentNode;\r\n    } while (el !== null && el.nodeType === 1);\r\n    return null;\r\n};\r\nfunction elementClosest(el, selector) {\r\n    return closestMethod.call(el, selector);\r\n}\r\nfunction elementMatches(el, selector) {\r\n    return matchesMethod.call(el, selector);\r\n}\r\n// accepts multiple subject els\r\n// returns a real array. good for methods like forEach\r\nfunction findElements(container, selector) {\r\n    var containers = container instanceof HTMLElement ? [container] : container;\r\n    var allMatches = [];\r\n    for (var i = 0; i < containers.length; i++) {\r\n        var matches = containers[i].querySelectorAll(selector);\r\n        for (var j = 0; j < matches.length; j++) {\r\n            allMatches.push(matches[j]);\r\n        }\r\n    }\r\n    return allMatches;\r\n}\r\n// accepts multiple subject els\r\n// only queries direct child elements\r\nfunction findChildren(parent, selector) {\r\n    var parents = parent instanceof HTMLElement ? [parent] : parent;\r\n    var allMatches = [];\r\n    for (var i = 0; i < parents.length; i++) {\r\n        var childNodes = parents[i].children; // only ever elements\r\n        for (var j = 0; j < childNodes.length; j++) {\r\n            var childNode = childNodes[j];\r\n            if (!selector || elementMatches(childNode, selector)) {\r\n                allMatches.push(childNode);\r\n            }\r\n        }\r\n    }\r\n    return allMatches;\r\n}\r\n// Attributes\r\n// ----------------------------------------------------------------------------------------------------------------\r\nfunction forceClassName(el, className, bool) {\r\n    if (bool) {\r\n        el.classList.add(className);\r\n    }\r\n    else {\r\n        el.classList.remove(className);\r\n    }\r\n}\r\n// Style\r\n// ----------------------------------------------------------------------------------------------------------------\r\nvar PIXEL_PROP_RE = /(top|left|right|bottom|width|height)$/i;\r\nfunction applyStyle(el, props) {\r\n    for (var propName in props) {\r\n        applyStyleProp(el, propName, props[propName]);\r\n    }\r\n}\r\nfunction applyStyleProp(el, name, val) {\r\n    if (val == null) {\r\n        el.style[name] = '';\r\n    }\r\n    else if (typeof val === 'number' && PIXEL_PROP_RE.test(name)) {\r\n        el.style[name] = val + 'px';\r\n    }\r\n    else {\r\n        el.style[name] = val;\r\n    }\r\n}\r\n\r\nfunction pointInsideRect(point, rect) {\r\n    return point.left >= rect.left &&\r\n        point.left < rect.right &&\r\n        point.top >= rect.top &&\r\n        point.top < rect.bottom;\r\n}\r\n// Returns a new rectangle that is the intersection of the two rectangles. If they don't intersect, returns false\r\nfunction intersectRects(rect1, rect2) {\r\n    var res = {\r\n        left: Math.max(rect1.left, rect2.left),\r\n        right: Math.min(rect1.right, rect2.right),\r\n        top: Math.max(rect1.top, rect2.top),\r\n        bottom: Math.min(rect1.bottom, rect2.bottom)\r\n    };\r\n    if (res.left < res.right && res.top < res.bottom) {\r\n        return res;\r\n    }\r\n    return false;\r\n}\r\nfunction translateRect(rect, deltaX, deltaY) {\r\n    return {\r\n        left: rect.left + deltaX,\r\n        right: rect.right + deltaX,\r\n        top: rect.top + deltaY,\r\n        bottom: rect.bottom + deltaY\r\n    };\r\n}\r\n// Returns a new point that will have been moved to reside within the given rectangle\r\nfunction constrainPoint(point, rect) {\r\n    return {\r\n        left: Math.min(Math.max(point.left, rect.left), rect.right),\r\n        top: Math.min(Math.max(point.top, rect.top), rect.bottom)\r\n    };\r\n}\r\n// Returns a point that is the center of the given rectangle\r\nfunction getRectCenter(rect) {\r\n    return {\r\n        left: (rect.left + rect.right) / 2,\r\n        top: (rect.top + rect.bottom) / 2\r\n    };\r\n}\r\n// Subtracts point2's coordinates from point1's coordinates, returning a delta\r\nfunction diffPoints(point1, point2) {\r\n    return {\r\n        left: point1.left - point2.left,\r\n        top: point1.top - point2.top\r\n    };\r\n}\r\n\r\n// Logic for determining if, when the element is right-to-left, the scrollbar appears on the left side\r\nvar isRtlScrollbarOnLeft = null;\r\nfunction getIsRtlScrollbarOnLeft() {\r\n    if (isRtlScrollbarOnLeft === null) {\r\n        isRtlScrollbarOnLeft = computeIsRtlScrollbarOnLeft();\r\n    }\r\n    return isRtlScrollbarOnLeft;\r\n}\r\nfunction computeIsRtlScrollbarOnLeft() {\r\n    var outerEl = createElement('div', {\r\n        style: {\r\n            position: 'absolute',\r\n            top: -1000,\r\n            left: 0,\r\n            border: 0,\r\n            padding: 0,\r\n            overflow: 'scroll',\r\n            direction: 'rtl'\r\n        }\r\n    }, '<div></div>');\r\n    document.body.appendChild(outerEl);\r\n    var innerEl = outerEl.firstChild;\r\n    var res = innerEl.getBoundingClientRect().left > outerEl.getBoundingClientRect().left;\r\n    removeElement(outerEl);\r\n    return res;\r\n}\r\n// The scrollbar width computations in computeEdges are sometimes flawed when it comes to\r\n// retina displays, rounding, and IE11. Massage them into a usable value.\r\nfunction sanitizeScrollbarWidth(width) {\r\n    width = Math.max(0, width); // no negatives\r\n    width = Math.round(width);\r\n    return width;\r\n}\r\n\r\nfunction computeEdges(el, getPadding) {\r\n    if (getPadding === void 0) { getPadding = false; }\r\n    var computedStyle = window.getComputedStyle(el);\r\n    var borderLeft = parseInt(computedStyle.borderLeftWidth, 10) || 0;\r\n    var borderRight = parseInt(computedStyle.borderRightWidth, 10) || 0;\r\n    var borderTop = parseInt(computedStyle.borderTopWidth, 10) || 0;\r\n    var borderBottom = parseInt(computedStyle.borderBottomWidth, 10) || 0;\r\n    // must use offset(Width|Height) because compatible with client(Width|Height)\r\n    var scrollbarLeftRight = sanitizeScrollbarWidth(el.offsetWidth - el.clientWidth - borderLeft - borderRight);\r\n    var scrollbarBottom = sanitizeScrollbarWidth(el.offsetHeight - el.clientHeight - borderTop - borderBottom);\r\n    var res = {\r\n        borderLeft: borderLeft,\r\n        borderRight: borderRight,\r\n        borderTop: borderTop,\r\n        borderBottom: borderBottom,\r\n        scrollbarBottom: scrollbarBottom,\r\n        scrollbarLeft: 0,\r\n        scrollbarRight: 0\r\n    };\r\n    if (getIsRtlScrollbarOnLeft() && computedStyle.direction === 'rtl') { // is the scrollbar on the left side?\r\n        res.scrollbarLeft = scrollbarLeftRight;\r\n    }\r\n    else {\r\n        res.scrollbarRight = scrollbarLeftRight;\r\n    }\r\n    if (getPadding) {\r\n        res.paddingLeft = parseInt(computedStyle.paddingLeft, 10) || 0;\r\n        res.paddingRight = parseInt(computedStyle.paddingRight, 10) || 0;\r\n        res.paddingTop = parseInt(computedStyle.paddingTop, 10) || 0;\r\n        res.paddingBottom = parseInt(computedStyle.paddingBottom, 10) || 0;\r\n    }\r\n    return res;\r\n}\r\nfunction computeInnerRect(el, goWithinPadding) {\r\n    if (goWithinPadding === void 0) { goWithinPadding = false; }\r\n    var outerRect = computeRect(el);\r\n    var edges = computeEdges(el, goWithinPadding);\r\n    var res = {\r\n        left: outerRect.left + edges.borderLeft + edges.scrollbarLeft,\r\n        right: outerRect.right - edges.borderRight - edges.scrollbarRight,\r\n        top: outerRect.top + edges.borderTop,\r\n        bottom: outerRect.bottom - edges.borderBottom - edges.scrollbarBottom\r\n    };\r\n    if (goWithinPadding) {\r\n        res.left += edges.paddingLeft;\r\n        res.right -= edges.paddingRight;\r\n        res.top += edges.paddingTop;\r\n        res.bottom -= edges.paddingBottom;\r\n    }\r\n    return res;\r\n}\r\nfunction computeRect(el) {\r\n    var rect = el.getBoundingClientRect();\r\n    return {\r\n        left: rect.left + window.pageXOffset,\r\n        top: rect.top + window.pageYOffset,\r\n        right: rect.right + window.pageXOffset,\r\n        bottom: rect.bottom + window.pageYOffset\r\n    };\r\n}\r\nfunction computeViewportRect() {\r\n    return {\r\n        left: window.pageXOffset,\r\n        right: window.pageXOffset + document.documentElement.clientWidth,\r\n        top: window.pageYOffset,\r\n        bottom: window.pageYOffset + document.documentElement.clientHeight\r\n    };\r\n}\r\nfunction computeHeightAndMargins(el) {\r\n    return el.getBoundingClientRect().height + computeVMargins(el);\r\n}\r\nfunction computeVMargins(el) {\r\n    var computed = window.getComputedStyle(el);\r\n    return parseInt(computed.marginTop, 10) +\r\n        parseInt(computed.marginBottom, 10);\r\n}\r\n// does not return window\r\nfunction getClippingParents(el) {\r\n    var parents = [];\r\n    while (el instanceof HTMLElement) { // will stop when gets to document or null\r\n        var computedStyle = window.getComputedStyle(el);\r\n        if (computedStyle.position === 'fixed') {\r\n            break;\r\n        }\r\n        if ((/(auto|scroll)/).test(computedStyle.overflow + computedStyle.overflowY + computedStyle.overflowX)) {\r\n            parents.push(el);\r\n        }\r\n        el = el.parentNode;\r\n    }\r\n    return parents;\r\n}\r\nfunction computeClippingRect(el) {\r\n    return getClippingParents(el)\r\n        .map(function (el) {\r\n        return computeInnerRect(el);\r\n    })\r\n        .concat(computeViewportRect())\r\n        .reduce(function (rect0, rect1) {\r\n        return intersectRects(rect0, rect1) || rect1; // should always intersect\r\n    });\r\n}\r\n\r\n// Stops a mouse/touch event from doing it's native browser action\r\nfunction preventDefault(ev) {\r\n    ev.preventDefault();\r\n}\r\n// Event Delegation\r\n// ----------------------------------------------------------------------------------------------------------------\r\nfunction listenBySelector(container, eventType, selector, handler) {\r\n    function realHandler(ev) {\r\n        var matchedChild = elementClosest(ev.target, selector);\r\n        if (matchedChild) {\r\n            handler.call(matchedChild, ev, matchedChild);\r\n        }\r\n    }\r\n    container.addEventListener(eventType, realHandler);\r\n    return function () {\r\n        container.removeEventListener(eventType, realHandler);\r\n    };\r\n}\r\nfunction listenToHoverBySelector(container, selector, onMouseEnter, onMouseLeave) {\r\n    var currentMatchedChild;\r\n    return listenBySelector(container, 'mouseover', selector, function (ev, matchedChild) {\r\n        if (matchedChild !== currentMatchedChild) {\r\n            currentMatchedChild = matchedChild;\r\n            onMouseEnter(ev, matchedChild);\r\n            var realOnMouseLeave_1 = function (ev) {\r\n                currentMatchedChild = null;\r\n                onMouseLeave(ev, matchedChild);\r\n                matchedChild.removeEventListener('mouseleave', realOnMouseLeave_1);\r\n            };\r\n            // listen to the next mouseleave, and then unattach\r\n            matchedChild.addEventListener('mouseleave', realOnMouseLeave_1);\r\n        }\r\n    });\r\n}\r\n// Animation\r\n// ----------------------------------------------------------------------------------------------------------------\r\nvar transitionEventNames = [\r\n    'webkitTransitionEnd',\r\n    'otransitionend',\r\n    'oTransitionEnd',\r\n    'msTransitionEnd',\r\n    'transitionend'\r\n];\r\n// triggered only when the next single subsequent transition finishes\r\nfunction whenTransitionDone(el, callback) {\r\n    var realCallback = function (ev) {\r\n        callback(ev);\r\n        transitionEventNames.forEach(function (eventName) {\r\n            el.removeEventListener(eventName, realCallback);\r\n        });\r\n    };\r\n    transitionEventNames.forEach(function (eventName) {\r\n        el.addEventListener(eventName, realCallback); // cross-browser way to determine when the transition finishes\r\n    });\r\n}\r\n\r\nvar DAY_IDS = ['sun', 'mon', 'tue', 'wed', 'thu', 'fri', 'sat'];\r\n// Adding\r\nfunction addWeeks(m, n) {\r\n    var a = dateToUtcArray(m);\r\n    a[2] += n * 7;\r\n    return arrayToUtcDate(a);\r\n}\r\nfunction addDays(m, n) {\r\n    var a = dateToUtcArray(m);\r\n    a[2] += n;\r\n    return arrayToUtcDate(a);\r\n}\r\nfunction addMs(m, n) {\r\n    var a = dateToUtcArray(m);\r\n    a[6] += n;\r\n    return arrayToUtcDate(a);\r\n}\r\n// Diffing (all return floats)\r\nfunction diffWeeks(m0, m1) {\r\n    return diffDays(m0, m1) / 7;\r\n}\r\nfunction diffDays(m0, m1) {\r\n    return (m1.valueOf() - m0.valueOf()) / (1000 * 60 * 60 * 24);\r\n}\r\nfunction diffHours(m0, m1) {\r\n    return (m1.valueOf() - m0.valueOf()) / (1000 * 60 * 60);\r\n}\r\nfunction diffMinutes(m0, m1) {\r\n    return (m1.valueOf() - m0.valueOf()) / (1000 * 60);\r\n}\r\nfunction diffSeconds(m0, m1) {\r\n    return (m1.valueOf() - m0.valueOf()) / 1000;\r\n}\r\nfunction diffDayAndTime(m0, m1) {\r\n    var m0day = startOfDay(m0);\r\n    var m1day = startOfDay(m1);\r\n    return {\r\n        years: 0,\r\n        months: 0,\r\n        days: Math.round(diffDays(m0day, m1day)),\r\n        milliseconds: (m1.valueOf() - m1day.valueOf()) - (m0.valueOf() - m0day.valueOf())\r\n    };\r\n}\r\n// Diffing Whole Units\r\nfunction diffWholeWeeks(m0, m1) {\r\n    var d = diffWholeDays(m0, m1);\r\n    if (d !== null && d % 7 === 0) {\r\n        return d / 7;\r\n    }\r\n    return null;\r\n}\r\nfunction diffWholeDays(m0, m1) {\r\n    if (timeAsMs(m0) === timeAsMs(m1)) {\r\n        return Math.round(diffDays(m0, m1));\r\n    }\r\n    return null;\r\n}\r\n// Start-Of\r\nfunction startOfDay(m) {\r\n    return arrayToUtcDate([\r\n        m.getUTCFullYear(),\r\n        m.getUTCMonth(),\r\n        m.getUTCDate()\r\n    ]);\r\n}\r\nfunction startOfHour(m) {\r\n    return arrayToUtcDate([\r\n        m.getUTCFullYear(),\r\n        m.getUTCMonth(),\r\n        m.getUTCDate(),\r\n        m.getUTCHours()\r\n    ]);\r\n}\r\nfunction startOfMinute(m) {\r\n    return arrayToUtcDate([\r\n        m.getUTCFullYear(),\r\n        m.getUTCMonth(),\r\n        m.getUTCDate(),\r\n        m.getUTCHours(),\r\n        m.getUTCMinutes()\r\n    ]);\r\n}\r\nfunction startOfSecond(m) {\r\n    return arrayToUtcDate([\r\n        m.getUTCFullYear(),\r\n        m.getUTCMonth(),\r\n        m.getUTCDate(),\r\n        m.getUTCHours(),\r\n        m.getUTCMinutes(),\r\n        m.getUTCSeconds()\r\n    ]);\r\n}\r\n// Week Computation\r\nfunction weekOfYear(marker, dow, doy) {\r\n    var y = marker.getUTCFullYear();\r\n    var w = weekOfGivenYear(marker, y, dow, doy);\r\n    if (w < 1) {\r\n        return weekOfGivenYear(marker, y - 1, dow, doy);\r\n    }\r\n    var nextW = weekOfGivenYear(marker, y + 1, dow, doy);\r\n    if (nextW >= 1) {\r\n        return Math.min(w, nextW);\r\n    }\r\n    return w;\r\n}\r\nfunction weekOfGivenYear(marker, year, dow, doy) {\r\n    var firstWeekStart = arrayToUtcDate([year, 0, 1 + firstWeekOffset(year, dow, doy)]);\r\n    var dayStart = startOfDay(marker);\r\n    var days = Math.round(diffDays(firstWeekStart, dayStart));\r\n    return Math.floor(days / 7) + 1; // zero-indexed\r\n}\r\n// start-of-first-week - start-of-year\r\nfunction firstWeekOffset(year, dow, doy) {\r\n    // first-week day -- which january is always in the first week (4 for iso, 1 for other)\r\n    var fwd = 7 + dow - doy;\r\n    // first-week day local weekday -- which local weekday is fwd\r\n    var fwdlw = (7 + arrayToUtcDate([year, 0, fwd]).getUTCDay() - dow) % 7;\r\n    return -fwdlw + fwd - 1;\r\n}\r\n// Array Conversion\r\nfunction dateToLocalArray(date) {\r\n    return [\r\n        date.getFullYear(),\r\n        date.getMonth(),\r\n        date.getDate(),\r\n        date.getHours(),\r\n        date.getMinutes(),\r\n        date.getSeconds(),\r\n        date.getMilliseconds()\r\n    ];\r\n}\r\nfunction arrayToLocalDate(a) {\r\n    return new Date(a[0], a[1] || 0, a[2] == null ? 1 : a[2], // day of month\r\n    a[3] || 0, a[4] || 0, a[5] || 0);\r\n}\r\nfunction dateToUtcArray(date) {\r\n    return [\r\n        date.getUTCFullYear(),\r\n        date.getUTCMonth(),\r\n        date.getUTCDate(),\r\n        date.getUTCHours(),\r\n        date.getUTCMinutes(),\r\n        date.getUTCSeconds(),\r\n        date.getUTCMilliseconds()\r\n    ];\r\n}\r\nfunction arrayToUtcDate(a) {\r\n    // according to web standards (and Safari), a month index is required.\r\n    // massage if only given a year.\r\n    if (a.length === 1) {\r\n        a = a.concat([0]);\r\n    }\r\n    return new Date(Date.UTC.apply(Date, a));\r\n}\r\n// Other Utils\r\nfunction isValidDate(m) {\r\n    return !isNaN(m.valueOf());\r\n}\r\nfunction timeAsMs(m) {\r\n    return m.getUTCHours() * 1000 * 60 * 60 +\r\n        m.getUTCMinutes() * 1000 * 60 +\r\n        m.getUTCSeconds() * 1000 +\r\n        m.getUTCMilliseconds();\r\n}\r\n\r\nvar INTERNAL_UNITS = ['years', 'months', 'days', 'milliseconds'];\r\nvar PARSE_RE = /^(-?)(?:(\\d+)\\.)?(\\d+):(\\d\\d)(?::(\\d\\d)(?:\\.(\\d\\d\\d))?)?/;\r\n// Parsing and Creation\r\nfunction createDuration(input, unit) {\r\n    var _a;\r\n    if (typeof input === 'string') {\r\n        return parseString(input);\r\n    }\r\n    else if (typeof input === 'object' && input) { // non-null object\r\n        return normalizeObject(input);\r\n    }\r\n    else if (typeof input === 'number') {\r\n        return normalizeObject((_a = {}, _a[unit || 'milliseconds'] = input, _a));\r\n    }\r\n    else {\r\n        return null;\r\n    }\r\n}\r\nfunction parseString(s) {\r\n    var m = PARSE_RE.exec(s);\r\n    if (m) {\r\n        var sign = m[1] ? -1 : 1;\r\n        return {\r\n            years: 0,\r\n            months: 0,\r\n            days: sign * (m[2] ? parseInt(m[2], 10) : 0),\r\n            milliseconds: sign * ((m[3] ? parseInt(m[3], 10) : 0) * 60 * 60 * 1000 + // hours\r\n                (m[4] ? parseInt(m[4], 10) : 0) * 60 * 1000 + // minutes\r\n                (m[5] ? parseInt(m[5], 10) : 0) * 1000 + // seconds\r\n                (m[6] ? parseInt(m[6], 10) : 0) // ms\r\n            )\r\n        };\r\n    }\r\n    return null;\r\n}\r\nfunction normalizeObject(obj) {\r\n    return {\r\n        years: obj.years || obj.year || 0,\r\n        months: obj.months || obj.month || 0,\r\n        days: (obj.days || obj.day || 0) +\r\n            getWeeksFromInput(obj) * 7,\r\n        milliseconds: (obj.hours || obj.hour || 0) * 60 * 60 * 1000 + // hours\r\n            (obj.minutes || obj.minute || 0) * 60 * 1000 + // minutes\r\n            (obj.seconds || obj.second || 0) * 1000 + // seconds\r\n            (obj.milliseconds || obj.millisecond || obj.ms || 0) // ms\r\n    };\r\n}\r\nfunction getWeeksFromInput(obj) {\r\n    return obj.weeks || obj.week || 0;\r\n}\r\n// Equality\r\nfunction durationsEqual(d0, d1) {\r\n    return d0.years === d1.years &&\r\n        d0.months === d1.months &&\r\n        d0.days === d1.days &&\r\n        d0.milliseconds === d1.milliseconds;\r\n}\r\nfunction isSingleDay(dur) {\r\n    return dur.years === 0 && dur.months === 0 && dur.days === 1 && dur.milliseconds === 0;\r\n}\r\n// Simple Math\r\nfunction addDurations(d0, d1) {\r\n    return {\r\n        years: d0.years + d1.years,\r\n        months: d0.months + d1.months,\r\n        days: d0.days + d1.days,\r\n        milliseconds: d0.milliseconds + d1.milliseconds\r\n    };\r\n}\r\nfunction subtractDurations(d1, d0) {\r\n    return {\r\n        years: d1.years - d0.years,\r\n        months: d1.months - d0.months,\r\n        days: d1.days - d0.days,\r\n        milliseconds: d1.milliseconds - d0.milliseconds\r\n    };\r\n}\r\nfunction multiplyDuration(d, n) {\r\n    return {\r\n        years: d.years * n,\r\n        months: d.months * n,\r\n        days: d.days * n,\r\n        milliseconds: d.milliseconds * n\r\n    };\r\n}\r\n// Conversions\r\n// \"Rough\" because they are based on average-case Gregorian months/years\r\nfunction asRoughYears(dur) {\r\n    return asRoughDays(dur) / 365;\r\n}\r\nfunction asRoughMonths(dur) {\r\n    return asRoughDays(dur) / 30;\r\n}\r\nfunction asRoughDays(dur) {\r\n    return asRoughMs(dur) / 864e5;\r\n}\r\nfunction asRoughMinutes(dur) {\r\n    return asRoughMs(dur) / (1000 * 60);\r\n}\r\nfunction asRoughSeconds(dur) {\r\n    return asRoughMs(dur) / 1000;\r\n}\r\nfunction asRoughMs(dur) {\r\n    return dur.years * (365 * 864e5) +\r\n        dur.months * (30 * 864e5) +\r\n        dur.days * 864e5 +\r\n        dur.milliseconds;\r\n}\r\n// Advanced Math\r\nfunction wholeDivideDurations(numerator, denominator) {\r\n    var res = null;\r\n    for (var i = 0; i < INTERNAL_UNITS.length; i++) {\r\n        var unit = INTERNAL_UNITS[i];\r\n        if (denominator[unit]) {\r\n            var localRes = numerator[unit] / denominator[unit];\r\n            if (!isInt(localRes) || (res !== null && res !== localRes)) {\r\n                return null;\r\n            }\r\n            res = localRes;\r\n        }\r\n        else if (numerator[unit]) {\r\n            // needs to divide by something but can't!\r\n            return null;\r\n        }\r\n    }\r\n    return res;\r\n}\r\nfunction greatestDurationDenominator(dur, dontReturnWeeks) {\r\n    var ms = dur.milliseconds;\r\n    if (ms) {\r\n        if (ms % 1000 !== 0) {\r\n            return { unit: 'millisecond', value: ms };\r\n        }\r\n        if (ms % (1000 * 60) !== 0) {\r\n            return { unit: 'second', value: ms / 1000 };\r\n        }\r\n        if (ms % (1000 * 60 * 60) !== 0) {\r\n            return { unit: 'minute', value: ms / (1000 * 60) };\r\n        }\r\n        if (ms) {\r\n            return { unit: 'hour', value: ms / (1000 * 60 * 60) };\r\n        }\r\n    }\r\n    if (dur.days) {\r\n        if (!dontReturnWeeks && dur.days % 7 === 0) {\r\n            return { unit: 'week', value: dur.days / 7 };\r\n        }\r\n        return { unit: 'day', value: dur.days };\r\n    }\r\n    if (dur.months) {\r\n        return { unit: 'month', value: dur.months };\r\n    }\r\n    if (dur.years) {\r\n        return { unit: 'year', value: dur.years };\r\n    }\r\n    return { unit: 'millisecond', value: 0 };\r\n}\r\n\r\n/* FullCalendar-specific DOM Utilities\r\n----------------------------------------------------------------------------------------------------------------------*/\r\n// Given the scrollbar widths of some other container, create borders/margins on rowEls in order to match the left\r\n// and right space that was offset by the scrollbars. A 1-pixel border first, then margin beyond that.\r\nfunction compensateScroll(rowEl, scrollbarWidths) {\r\n    if (scrollbarWidths.left) {\r\n        applyStyle(rowEl, {\r\n            borderLeftWidth: 1,\r\n            marginLeft: scrollbarWidths.left - 1\r\n        });\r\n    }\r\n    if (scrollbarWidths.right) {\r\n        applyStyle(rowEl, {\r\n            borderRightWidth: 1,\r\n            marginRight: scrollbarWidths.right - 1\r\n        });\r\n    }\r\n}\r\n// Undoes compensateScroll and restores all borders/margins\r\nfunction uncompensateScroll(rowEl) {\r\n    applyStyle(rowEl, {\r\n        marginLeft: '',\r\n        marginRight: '',\r\n        borderLeftWidth: '',\r\n        borderRightWidth: ''\r\n    });\r\n}\r\n// Make the mouse cursor express that an event is not allowed in the current area\r\nfunction disableCursor() {\r\n    document.body.classList.add('fc-not-allowed');\r\n}\r\n// Returns the mouse cursor to its original look\r\nfunction enableCursor() {\r\n    document.body.classList.remove('fc-not-allowed');\r\n}\r\n// Given a total available height to fill, have `els` (essentially child rows) expand to accomodate.\r\n// By default, all elements that are shorter than the recommended height are expanded uniformly, not considering\r\n// any other els that are already too tall. if `shouldRedistribute` is on, it considers these tall rows and\r\n// reduces the available height.\r\nfunction distributeHeight(els, availableHeight, shouldRedistribute) {\r\n    // *FLOORING NOTE*: we floor in certain places because zoom can give inaccurate floating-point dimensions,\r\n    // and it is better to be shorter than taller, to avoid creating unnecessary scrollbars.\r\n    var minOffset1 = Math.floor(availableHeight / els.length); // for non-last element\r\n    var minOffset2 = Math.floor(availableHeight - minOffset1 * (els.length - 1)); // for last element *FLOORING NOTE*\r\n    var flexEls = []; // elements that are allowed to expand. array of DOM nodes\r\n    var flexOffsets = []; // amount of vertical space it takes up\r\n    var flexHeights = []; // actual css height\r\n    var usedHeight = 0;\r\n    undistributeHeight(els); // give all elements their natural height\r\n    // find elements that are below the recommended height (expandable).\r\n    // important to query for heights in a single first pass (to avoid reflow oscillation).\r\n    els.forEach(function (el, i) {\r\n        var minOffset = i === els.length - 1 ? minOffset2 : minOffset1;\r\n        var naturalHeight = el.getBoundingClientRect().height;\r\n        var naturalOffset = naturalHeight + computeVMargins(el);\r\n        if (naturalOffset < minOffset) {\r\n            flexEls.push(el);\r\n            flexOffsets.push(naturalOffset);\r\n            flexHeights.push(naturalHeight);\r\n        }\r\n        else {\r\n            // this element stretches past recommended height (non-expandable). mark the space as occupied.\r\n            usedHeight += naturalOffset;\r\n        }\r\n    });\r\n    // readjust the recommended height to only consider the height available to non-maxed-out rows.\r\n    if (shouldRedistribute) {\r\n        availableHeight -= usedHeight;\r\n        minOffset1 = Math.floor(availableHeight / flexEls.length);\r\n        minOffset2 = Math.floor(availableHeight - minOffset1 * (flexEls.length - 1)); // *FLOORING NOTE*\r\n    }\r\n    // assign heights to all expandable elements\r\n    flexEls.forEach(function (el, i) {\r\n        var minOffset = i === flexEls.length - 1 ? minOffset2 : minOffset1;\r\n        var naturalOffset = flexOffsets[i];\r\n        var naturalHeight = flexHeights[i];\r\n        var newHeight = minOffset - (naturalOffset - naturalHeight); // subtract the margin/padding\r\n        if (naturalOffset < minOffset) { // we check this again because redistribution might have changed things\r\n            el.style.height = newHeight + 'px';\r\n        }\r\n    });\r\n}\r\n// Undoes distrubuteHeight, restoring all els to their natural height\r\nfunction undistributeHeight(els) {\r\n    els.forEach(function (el) {\r\n        el.style.height = '';\r\n    });\r\n}\r\n// Given `els`, a set of <td> cells, find the cell with the largest natural width and set the widths of all the\r\n// cells to be that width.\r\n// PREREQUISITE: if you want a cell to take up width, it needs to have a single inner element w/ display:inline\r\nfunction matchCellWidths(els) {\r\n    var maxInnerWidth = 0;\r\n    els.forEach(function (el) {\r\n        var innerEl = el.firstChild; // hopefully an element\r\n        if (innerEl instanceof HTMLElement) {\r\n            var innerWidth_1 = innerEl.getBoundingClientRect().width;\r\n            if (innerWidth_1 > maxInnerWidth) {\r\n                maxInnerWidth = innerWidth_1;\r\n            }\r\n        }\r\n    });\r\n    maxInnerWidth++; // sometimes not accurate of width the text needs to stay on one line. insurance\r\n    els.forEach(function (el) {\r\n        el.style.width = maxInnerWidth + 'px';\r\n    });\r\n    return maxInnerWidth;\r\n}\r\n// Given one element that resides inside another,\r\n// Subtracts the height of the inner element from the outer element.\r\nfunction subtractInnerElHeight(outerEl, innerEl) {\r\n    // effin' IE8/9/10/11 sometimes returns 0 for dimensions. this weird hack was the only thing that worked\r\n    var reflowStyleProps = {\r\n        position: 'relative',\r\n        left: -1 // ensure reflow in case the el was already relative. negative is less likely to cause new scroll\r\n    };\r\n    applyStyle(outerEl, reflowStyleProps);\r\n    applyStyle(innerEl, reflowStyleProps);\r\n    var diff = // grab the dimensions\r\n     outerEl.getBoundingClientRect().height -\r\n        innerEl.getBoundingClientRect().height;\r\n    // undo hack\r\n    var resetStyleProps = { position: '', left: '' };\r\n    applyStyle(outerEl, resetStyleProps);\r\n    applyStyle(innerEl, resetStyleProps);\r\n    return diff;\r\n}\r\n/* Selection\r\n----------------------------------------------------------------------------------------------------------------------*/\r\nfunction preventSelection(el) {\r\n    el.classList.add('fc-unselectable');\r\n    el.addEventListener('selectstart', preventDefault);\r\n}\r\nfunction allowSelection(el) {\r\n    el.classList.remove('fc-unselectable');\r\n    el.removeEventListener('selectstart', preventDefault);\r\n}\r\n/* Context Menu\r\n----------------------------------------------------------------------------------------------------------------------*/\r\nfunction preventContextMenu(el) {\r\n    el.addEventListener('contextmenu', preventDefault);\r\n}\r\nfunction allowContextMenu(el) {\r\n    el.removeEventListener('contextmenu', preventDefault);\r\n}\r\n/* Object Ordering by Field\r\n----------------------------------------------------------------------------------------------------------------------*/\r\nfunction parseFieldSpecs(input) {\r\n    var specs = [];\r\n    var tokens = [];\r\n    var i;\r\n    var token;\r\n    if (typeof input === 'string') {\r\n        tokens = input.split(/\\s*,\\s*/);\r\n    }\r\n    else if (typeof input === 'function') {\r\n        tokens = [input];\r\n    }\r\n    else if (Array.isArray(input)) {\r\n        tokens = input;\r\n    }\r\n    for (i = 0; i < tokens.length; i++) {\r\n        token = tokens[i];\r\n        if (typeof token === 'string') {\r\n            specs.push(token.charAt(0) === '-' ?\r\n                { field: token.substring(1), order: -1 } :\r\n                { field: token, order: 1 });\r\n        }\r\n        else if (typeof token === 'function') {\r\n            specs.push({ func: token });\r\n        }\r\n    }\r\n    return specs;\r\n}\r\nfunction compareByFieldSpecs(obj0, obj1, fieldSpecs) {\r\n    var i;\r\n    var cmp;\r\n    for (i = 0; i < fieldSpecs.length; i++) {\r\n        cmp = compareByFieldSpec(obj0, obj1, fieldSpecs[i]);\r\n        if (cmp) {\r\n            return cmp;\r\n        }\r\n    }\r\n    return 0;\r\n}\r\nfunction compareByFieldSpec(obj0, obj1, fieldSpec) {\r\n    if (fieldSpec.func) {\r\n        return fieldSpec.func(obj0, obj1);\r\n    }\r\n    return flexibleCompare(obj0[fieldSpec.field], obj1[fieldSpec.field])\r\n        * (fieldSpec.order || 1);\r\n}\r\nfunction flexibleCompare(a, b) {\r\n    if (!a && !b) {\r\n        return 0;\r\n    }\r\n    if (b == null) {\r\n        return -1;\r\n    }\r\n    if (a == null) {\r\n        return 1;\r\n    }\r\n    if (typeof a === 'string' || typeof b === 'string') {\r\n        return String(a).localeCompare(String(b));\r\n    }\r\n    return a - b;\r\n}\r\n/* String Utilities\r\n----------------------------------------------------------------------------------------------------------------------*/\r\nfunction capitaliseFirstLetter(str) {\r\n    return str.charAt(0).toUpperCase() + str.slice(1);\r\n}\r\nfunction padStart(val, len) {\r\n    var s = String(val);\r\n    return '000'.substr(0, len - s.length) + s;\r\n}\r\n/* Number Utilities\r\n----------------------------------------------------------------------------------------------------------------------*/\r\nfunction compareNumbers(a, b) {\r\n    return a - b;\r\n}\r\nfunction isInt(n) {\r\n    return n % 1 === 0;\r\n}\r\n/* Weird Utilities\r\n----------------------------------------------------------------------------------------------------------------------*/\r\nfunction applyAll(functions, thisObj, args) {\r\n    if (typeof functions === 'function') { // supplied a single function\r\n        functions = [functions];\r\n    }\r\n    if (functions) {\r\n        var i = void 0;\r\n        var ret = void 0;\r\n        for (i = 0; i < functions.length; i++) {\r\n            ret = functions[i].apply(thisObj, args) || ret;\r\n        }\r\n        return ret;\r\n    }\r\n}\r\nfunction firstDefined() {\r\n    var args = [];\r\n    for (var _i = 0; _i < arguments.length; _i++) {\r\n        args[_i] = arguments[_i];\r\n    }\r\n    for (var i = 0; i < args.length; i++) {\r\n        if (args[i] !== undefined) {\r\n            return args[i];\r\n        }\r\n    }\r\n}\r\n// Returns a function, that, as long as it continues to be invoked, will not\r\n// be triggered. The function will be called after it stops being called for\r\n// N milliseconds. If `immediate` is passed, trigger the function on the\r\n// leading edge, instead of the trailing.\r\n// https://github.com/jashkenas/underscore/blob/1.6.0/underscore.js#L714\r\nfunction debounce(func, wait) {\r\n    var timeout;\r\n    var args;\r\n    var context;\r\n    var timestamp;\r\n    var result;\r\n    var later = function () {\r\n        var last = new Date().valueOf() - timestamp;\r\n        if (last < wait) {\r\n            timeout = setTimeout(later, wait - last);\r\n        }\r\n        else {\r\n            timeout = null;\r\n            result = func.apply(context, args);\r\n            context = args = null;\r\n        }\r\n    };\r\n    return function () {\r\n        context = this;\r\n        args = arguments;\r\n        timestamp = new Date().valueOf();\r\n        if (!timeout) {\r\n            timeout = setTimeout(later, wait);\r\n        }\r\n        return result;\r\n    };\r\n}\r\n// Number and Boolean are only types that defaults or not computed for\r\n// TODO: write more comments\r\nfunction refineProps(rawProps, processors, defaults, leftoverProps) {\r\n    if (defaults === void 0) { defaults = {}; }\r\n    var refined = {};\r\n    for (var key in processors) {\r\n        var processor = processors[key];\r\n        if (rawProps[key] !== undefined) {\r\n            // found\r\n            if (processor === Function) {\r\n                refined[key] = typeof rawProps[key] === 'function' ? rawProps[key] : null;\r\n            }\r\n            else if (processor) { // a refining function?\r\n                refined[key] = processor(rawProps[key]);\r\n            }\r\n            else {\r\n                refined[key] = rawProps[key];\r\n            }\r\n        }\r\n        else if (defaults[key] !== undefined) {\r\n            // there's an explicit default\r\n            refined[key] = defaults[key];\r\n        }\r\n        else {\r\n            // must compute a default\r\n            if (processor === String) {\r\n                refined[key] = ''; // empty string is default for String\r\n            }\r\n            else if (!processor || processor === Number || processor === Boolean || processor === Function) {\r\n                refined[key] = null; // assign null for other non-custom processor funcs\r\n            }\r\n            else {\r\n                refined[key] = processor(null); // run the custom processor func\r\n            }\r\n        }\r\n    }\r\n    if (leftoverProps) {\r\n        for (var key in rawProps) {\r\n            if (processors[key] === undefined) {\r\n                leftoverProps[key] = rawProps[key];\r\n            }\r\n        }\r\n    }\r\n    return refined;\r\n}\r\n/* Date stuff that doesn't belong in datelib core\r\n----------------------------------------------------------------------------------------------------------------------*/\r\n// given a timed range, computes an all-day range that has the same exact duration,\r\n// but whose start time is aligned with the start of the day.\r\nfunction computeAlignedDayRange(timedRange) {\r\n    var dayCnt = Math.floor(diffDays(timedRange.start, timedRange.end)) || 1;\r\n    var start = startOfDay(timedRange.start);\r\n    var end = addDays(start, dayCnt);\r\n    return { start: start, end: end };\r\n}\r\n// given a timed range, computes an all-day range based on how for the end date bleeds into the next day\r\n// TODO: give nextDayThreshold a default arg\r\nfunction computeVisibleDayRange(timedRange, nextDayThreshold) {\r\n    if (nextDayThreshold === void 0) { nextDayThreshold = createDuration(0); }\r\n    var startDay = null;\r\n    var endDay = null;\r\n    if (timedRange.end) {\r\n        endDay = startOfDay(timedRange.end);\r\n        var endTimeMS = timedRange.end.valueOf() - endDay.valueOf(); // # of milliseconds into `endDay`\r\n        // If the end time is actually inclusively part of the next day and is equal to or\r\n        // beyond the next day threshold, adjust the end to be the exclusive end of `endDay`.\r\n        // Otherwise, leaving it as inclusive will cause it to exclude `endDay`.\r\n        if (endTimeMS && endTimeMS >= asRoughMs(nextDayThreshold)) {\r\n            endDay = addDays(endDay, 1);\r\n        }\r\n    }\r\n    if (timedRange.start) {\r\n        startDay = startOfDay(timedRange.start); // the beginning of the day the range starts\r\n        // If end is within `startDay` but not past nextDayThreshold, assign the default duration of one day.\r\n        if (endDay && endDay <= startDay) {\r\n            endDay = addDays(startDay, 1);\r\n        }\r\n    }\r\n    return { start: startDay, end: endDay };\r\n}\r\n// spans from one day into another?\r\nfunction isMultiDayRange(range) {\r\n    var visibleRange = computeVisibleDayRange(range);\r\n    return diffDays(visibleRange.start, visibleRange.end) > 1;\r\n}\r\nfunction diffDates(date0, date1, dateEnv, largeUnit) {\r\n    if (largeUnit === 'year') {\r\n        return createDuration(dateEnv.diffWholeYears(date0, date1), 'year');\r\n    }\r\n    else if (largeUnit === 'month') {\r\n        return createDuration(dateEnv.diffWholeMonths(date0, date1), 'month');\r\n    }\r\n    else {\r\n        return diffDayAndTime(date0, date1); // returns a duration\r\n    }\r\n}\r\n\r\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nfunction __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nvar __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\n\r\nfunction parseRecurring(eventInput, allDayDefault, dateEnv, recurringTypes, leftovers) {\r\n    for (var i = 0; i < recurringTypes.length; i++) {\r\n        var localLeftovers = {};\r\n        var parsed = recurringTypes[i].parse(eventInput, localLeftovers, dateEnv);\r\n        if (parsed) {\r\n            var allDay = localLeftovers.allDay;\r\n            delete localLeftovers.allDay; // remove from leftovers\r\n            if (allDay == null) {\r\n                allDay = allDayDefault;\r\n                if (allDay == null) {\r\n                    allDay = parsed.allDayGuess;\r\n                    if (allDay == null) {\r\n                        allDay = false;\r\n                    }\r\n                }\r\n            }\r\n            __assign(leftovers, localLeftovers);\r\n            return {\r\n                allDay: allDay,\r\n                duration: parsed.duration,\r\n                typeData: parsed.typeData,\r\n                typeId: i\r\n            };\r\n        }\r\n    }\r\n    return null;\r\n}\r\n/*\r\nEvent MUST have a recurringDef\r\n*/\r\nfunction expandRecurringRanges(eventDef, duration, framingRange, dateEnv, recurringTypes) {\r\n    var typeDef = recurringTypes[eventDef.recurringDef.typeId];\r\n    var markers = typeDef.expand(eventDef.recurringDef.typeData, {\r\n        start: dateEnv.subtract(framingRange.start, duration),\r\n        end: framingRange.end\r\n    }, dateEnv);\r\n    // the recurrence plugins don't guarantee that all-day events are start-of-day, so we have to\r\n    if (eventDef.allDay) {\r\n        markers = markers.map(startOfDay);\r\n    }\r\n    return markers;\r\n}\r\n\r\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\r\n// Merges an array of objects into a single object.\r\n// The second argument allows for an array of property names who's object values will be merged together.\r\nfunction mergeProps(propObjs, complexProps) {\r\n    var dest = {};\r\n    var i;\r\n    var name;\r\n    var complexObjs;\r\n    var j;\r\n    var val;\r\n    var props;\r\n    if (complexProps) {\r\n        for (i = 0; i < complexProps.length; i++) {\r\n            name = complexProps[i];\r\n            complexObjs = [];\r\n            // collect the trailing object values, stopping when a non-object is discovered\r\n            for (j = propObjs.length - 1; j >= 0; j--) {\r\n                val = propObjs[j][name];\r\n                if (typeof val === 'object' && val) { // non-null object\r\n                    complexObjs.unshift(val);\r\n                }\r\n                else if (val !== undefined) {\r\n                    dest[name] = val; // if there were no objects, this value will be used\r\n                    break;\r\n                }\r\n            }\r\n            // if the trailing values were objects, use the merged value\r\n            if (complexObjs.length) {\r\n                dest[name] = mergeProps(complexObjs);\r\n            }\r\n        }\r\n    }\r\n    // copy values into the destination, going from last to first\r\n    for (i = propObjs.length - 1; i >= 0; i--) {\r\n        props = propObjs[i];\r\n        for (name in props) {\r\n            if (!(name in dest)) { // if already assigned by previous props or complex props, don't reassign\r\n                dest[name] = props[name];\r\n            }\r\n        }\r\n    }\r\n    return dest;\r\n}\r\nfunction filterHash(hash, func) {\r\n    var filtered = {};\r\n    for (var key in hash) {\r\n        if (func(hash[key], key)) {\r\n            filtered[key] = hash[key];\r\n        }\r\n    }\r\n    return filtered;\r\n}\r\nfunction mapHash(hash, func) {\r\n    var newHash = {};\r\n    for (var key in hash) {\r\n        newHash[key] = func(hash[key], key);\r\n    }\r\n    return newHash;\r\n}\r\nfunction arrayToHash(a) {\r\n    var hash = {};\r\n    for (var _i = 0, a_1 = a; _i < a_1.length; _i++) {\r\n        var item = a_1[_i];\r\n        hash[item] = true;\r\n    }\r\n    return hash;\r\n}\r\nfunction hashValuesToArray(obj) {\r\n    var a = [];\r\n    for (var key in obj) {\r\n        a.push(obj[key]);\r\n    }\r\n    return a;\r\n}\r\nfunction isPropsEqual(obj0, obj1) {\r\n    for (var key in obj0) {\r\n        if (hasOwnProperty.call(obj0, key)) {\r\n            if (!(key in obj1)) {\r\n                return false;\r\n            }\r\n        }\r\n    }\r\n    for (var key in obj1) {\r\n        if (hasOwnProperty.call(obj1, key)) {\r\n            if (obj0[key] !== obj1[key]) {\r\n                return false;\r\n            }\r\n        }\r\n    }\r\n    return true;\r\n}\r\n\r\nfunction parseEvents(rawEvents, sourceId, calendar, allowOpenRange) {\r\n    var eventStore = createEmptyEventStore();\r\n    for (var _i = 0, rawEvents_1 = rawEvents; _i < rawEvents_1.length; _i++) {\r\n        var rawEvent = rawEvents_1[_i];\r\n        var tuple = parseEvent(rawEvent, sourceId, calendar, allowOpenRange);\r\n        if (tuple) {\r\n            eventTupleToStore(tuple, eventStore);\r\n        }\r\n    }\r\n    return eventStore;\r\n}\r\nfunction eventTupleToStore(tuple, eventStore) {\r\n    if (eventStore === void 0) { eventStore = createEmptyEventStore(); }\r\n    eventStore.defs[tuple.def.defId] = tuple.def;\r\n    if (tuple.instance) {\r\n        eventStore.instances[tuple.instance.instanceId] = tuple.instance;\r\n    }\r\n    return eventStore;\r\n}\r\nfunction expandRecurring(eventStore, framingRange, calendar) {\r\n    var dateEnv = calendar.dateEnv;\r\n    var defs = eventStore.defs, instances = eventStore.instances;\r\n    // remove existing recurring instances\r\n    instances = filterHash(instances, function (instance) {\r\n        return !defs[instance.defId].recurringDef;\r\n    });\r\n    for (var defId in defs) {\r\n        var def = defs[defId];\r\n        if (def.recurringDef) {\r\n            var duration = def.recurringDef.duration;\r\n            if (!duration) {\r\n                duration = def.allDay ?\r\n                    calendar.defaultAllDayEventDuration :\r\n                    calendar.defaultTimedEventDuration;\r\n            }\r\n            var starts = expandRecurringRanges(def, duration, framingRange, calendar.dateEnv, calendar.pluginSystem.hooks.recurringTypes);\r\n            for (var _i = 0, starts_1 = starts; _i < starts_1.length; _i++) {\r\n                var start = starts_1[_i];\r\n                var instance = createEventInstance(defId, {\r\n                    start: start,\r\n                    end: dateEnv.add(start, duration)\r\n                });\r\n                instances[instance.instanceId] = instance;\r\n            }\r\n        }\r\n    }\r\n    return { defs: defs, instances: instances };\r\n}\r\n// retrieves events that have the same groupId as the instance specified by `instanceId`\r\n// or they are the same as the instance.\r\n// why might instanceId not be in the store? an event from another calendar?\r\nfunction getRelevantEvents(eventStore, instanceId) {\r\n    var instance = eventStore.instances[instanceId];\r\n    if (instance) {\r\n        var def_1 = eventStore.defs[instance.defId];\r\n        // get events/instances with same group\r\n        var newStore = filterEventStoreDefs(eventStore, function (lookDef) {\r\n            return isEventDefsGrouped(def_1, lookDef);\r\n        });\r\n        // add the original\r\n        // TODO: wish we could use eventTupleToStore or something like it\r\n        newStore.defs[def_1.defId] = def_1;\r\n        newStore.instances[instance.instanceId] = instance;\r\n        return newStore;\r\n    }\r\n    return createEmptyEventStore();\r\n}\r\nfunction isEventDefsGrouped(def0, def1) {\r\n    return Boolean(def0.groupId && def0.groupId === def1.groupId);\r\n}\r\nfunction transformRawEvents(rawEvents, eventSource, calendar) {\r\n    var calEachTransform = calendar.opt('eventDataTransform');\r\n    var sourceEachTransform = eventSource ? eventSource.eventDataTransform : null;\r\n    if (sourceEachTransform) {\r\n        rawEvents = transformEachRawEvent(rawEvents, sourceEachTransform);\r\n    }\r\n    if (calEachTransform) {\r\n        rawEvents = transformEachRawEvent(rawEvents, calEachTransform);\r\n    }\r\n    return rawEvents;\r\n}\r\nfunction transformEachRawEvent(rawEvents, func) {\r\n    var refinedEvents;\r\n    if (!func) {\r\n        refinedEvents = rawEvents;\r\n    }\r\n    else {\r\n        refinedEvents = [];\r\n        for (var _i = 0, rawEvents_2 = rawEvents; _i < rawEvents_2.length; _i++) {\r\n            var rawEvent = rawEvents_2[_i];\r\n            var refinedEvent = func(rawEvent);\r\n            if (refinedEvent) {\r\n                refinedEvents.push(refinedEvent);\r\n            }\r\n            else if (refinedEvent == null) {\r\n                refinedEvents.push(rawEvent);\r\n            } // if a different falsy value, do nothing\r\n        }\r\n    }\r\n    return refinedEvents;\r\n}\r\nfunction createEmptyEventStore() {\r\n    return { defs: {}, instances: {} };\r\n}\r\nfunction mergeEventStores(store0, store1) {\r\n    return {\r\n        defs: __assign({}, store0.defs, store1.defs),\r\n        instances: __assign({}, store0.instances, store1.instances)\r\n    };\r\n}\r\nfunction filterEventStoreDefs(eventStore, filterFunc) {\r\n    var defs = filterHash(eventStore.defs, filterFunc);\r\n    var instances = filterHash(eventStore.instances, function (instance) {\r\n        return defs[instance.defId]; // still exists?\r\n    });\r\n    return { defs: defs, instances: instances };\r\n}\r\n\r\nfunction parseRange(input, dateEnv) {\r\n    var start = null;\r\n    var end = null;\r\n    if (input.start) {\r\n        start = dateEnv.createMarker(input.start);\r\n    }\r\n    if (input.end) {\r\n        end = dateEnv.createMarker(input.end);\r\n    }\r\n    if (!start && !end) {\r\n        return null;\r\n    }\r\n    if (start && end && end < start) {\r\n        return null;\r\n    }\r\n    return { start: start, end: end };\r\n}\r\n// SIDE-EFFECT: will mutate ranges.\r\n// Will return a new array result.\r\nfunction invertRanges(ranges, constraintRange) {\r\n    var invertedRanges = [];\r\n    var start = constraintRange.start; // the end of the previous range. the start of the new range\r\n    var i;\r\n    var dateRange;\r\n    // ranges need to be in order. required for our date-walking algorithm\r\n    ranges.sort(compareRanges);\r\n    for (i = 0; i < ranges.length; i++) {\r\n        dateRange = ranges[i];\r\n        // add the span of time before the event (if there is any)\r\n        if (dateRange.start > start) { // compare millisecond time (skip any ambig logic)\r\n            invertedRanges.push({ start: start, end: dateRange.start });\r\n        }\r\n        if (dateRange.end > start) {\r\n            start = dateRange.end;\r\n        }\r\n    }\r\n    // add the span of time after the last event (if there is any)\r\n    if (start < constraintRange.end) { // compare millisecond time (skip any ambig logic)\r\n        invertedRanges.push({ start: start, end: constraintRange.end });\r\n    }\r\n    return invertedRanges;\r\n}\r\nfunction compareRanges(range0, range1) {\r\n    return range0.start.valueOf() - range1.start.valueOf(); // earlier ranges go first\r\n}\r\nfunction intersectRanges(range0, range1) {\r\n    var start = range0.start;\r\n    var end = range0.end;\r\n    var newRange = null;\r\n    if (range1.start !== null) {\r\n        if (start === null) {\r\n            start = range1.start;\r\n        }\r\n        else {\r\n            start = new Date(Math.max(start.valueOf(), range1.start.valueOf()));\r\n        }\r\n    }\r\n    if (range1.end != null) {\r\n        if (end === null) {\r\n            end = range1.end;\r\n        }\r\n        else {\r\n            end = new Date(Math.min(end.valueOf(), range1.end.valueOf()));\r\n        }\r\n    }\r\n    if (start === null || end === null || start < end) {\r\n        newRange = { start: start, end: end };\r\n    }\r\n    return newRange;\r\n}\r\nfunction rangesEqual(range0, range1) {\r\n    return (range0.start === null ? null : range0.start.valueOf()) === (range1.start === null ? null : range1.start.valueOf()) &&\r\n        (range0.end === null ? null : range0.end.valueOf()) === (range1.end === null ? null : range1.end.valueOf());\r\n}\r\nfunction rangesIntersect(range0, range1) {\r\n    return (range0.end === null || range1.start === null || range0.end > range1.start) &&\r\n        (range0.start === null || range1.end === null || range0.start < range1.end);\r\n}\r\nfunction rangeContainsRange(outerRange, innerRange) {\r\n    return (outerRange.start === null || (innerRange.start !== null && innerRange.start >= outerRange.start)) &&\r\n        (outerRange.end === null || (innerRange.end !== null && innerRange.end <= outerRange.end));\r\n}\r\nfunction rangeContainsMarker(range, date) {\r\n    return (range.start === null || date >= range.start) &&\r\n        (range.end === null || date < range.end);\r\n}\r\n// If the given date is not within the given range, move it inside.\r\n// (If it's past the end, make it one millisecond before the end).\r\nfunction constrainMarkerToRange(date, range) {\r\n    if (range.start != null && date < range.start) {\r\n        return range.start;\r\n    }\r\n    if (range.end != null && date >= range.end) {\r\n        return new Date(range.end.valueOf() - 1);\r\n    }\r\n    return date;\r\n}\r\n\r\nfunction removeExact(array, exactVal) {\r\n    var removeCnt = 0;\r\n    var i = 0;\r\n    while (i < array.length) {\r\n        if (array[i] === exactVal) {\r\n            array.splice(i, 1);\r\n            removeCnt++;\r\n        }\r\n        else {\r\n            i++;\r\n        }\r\n    }\r\n    return removeCnt;\r\n}\r\nfunction isArraysEqual(a0, a1) {\r\n    var len = a0.length;\r\n    var i;\r\n    if (len !== a1.length) { // not array? or not same length?\r\n        return false;\r\n    }\r\n    for (i = 0; i < len; i++) {\r\n        if (a0[i] !== a1[i]) {\r\n            return false;\r\n        }\r\n    }\r\n    return true;\r\n}\r\n\r\nfunction memoize(workerFunc) {\r\n    var args;\r\n    var res;\r\n    return function () {\r\n        if (!args || !isArraysEqual(args, arguments)) {\r\n            args = arguments;\r\n            res = workerFunc.apply(this, arguments);\r\n        }\r\n        return res;\r\n    };\r\n}\r\n/*\r\nalways executes the workerFunc, but if the result is equal to the previous result,\r\nreturn the previous result instead.\r\n*/\r\nfunction memoizeOutput(workerFunc, equalityFunc) {\r\n    var cachedRes = null;\r\n    return function () {\r\n        var newRes = workerFunc.apply(this, arguments);\r\n        if (cachedRes === null || !(cachedRes === newRes || equalityFunc(cachedRes, newRes))) {\r\n            cachedRes = newRes;\r\n        }\r\n        return cachedRes;\r\n    };\r\n}\r\n\r\nvar EXTENDED_SETTINGS_AND_SEVERITIES = {\r\n    week: 3,\r\n    separator: 0,\r\n    omitZeroMinute: 0,\r\n    meridiem: 0,\r\n    omitCommas: 0\r\n};\r\nvar STANDARD_DATE_PROP_SEVERITIES = {\r\n    timeZoneName: 7,\r\n    era: 6,\r\n    year: 5,\r\n    month: 4,\r\n    day: 2,\r\n    weekday: 2,\r\n    hour: 1,\r\n    minute: 1,\r\n    second: 1\r\n};\r\nvar MERIDIEM_RE = /\\s*([ap])\\.?m\\.?/i; // eats up leading spaces too\r\nvar COMMA_RE = /,/g; // we need re for globalness\r\nvar MULTI_SPACE_RE = /\\s+/g;\r\nvar LTR_RE = /\\u200e/g; // control character\r\nvar UTC_RE = /UTC|GMT/;\r\nvar NativeFormatter = /** @class */ (function () {\r\n    function NativeFormatter(formatSettings) {\r\n        var standardDateProps = {};\r\n        var extendedSettings = {};\r\n        var severity = 0;\r\n        for (var name_1 in formatSettings) {\r\n            if (name_1 in EXTENDED_SETTINGS_AND_SEVERITIES) {\r\n                extendedSettings[name_1] = formatSettings[name_1];\r\n                severity = Math.max(EXTENDED_SETTINGS_AND_SEVERITIES[name_1], severity);\r\n            }\r\n            else {\r\n                standardDateProps[name_1] = formatSettings[name_1];\r\n                if (name_1 in STANDARD_DATE_PROP_SEVERITIES) {\r\n                    severity = Math.max(STANDARD_DATE_PROP_SEVERITIES[name_1], severity);\r\n                }\r\n            }\r\n        }\r\n        this.standardDateProps = standardDateProps;\r\n        this.extendedSettings = extendedSettings;\r\n        this.severity = severity;\r\n        this.buildFormattingFunc = memoize(buildFormattingFunc);\r\n    }\r\n    NativeFormatter.prototype.format = function (date, context) {\r\n        return this.buildFormattingFunc(this.standardDateProps, this.extendedSettings, context)(date);\r\n    };\r\n    NativeFormatter.prototype.formatRange = function (start, end, context) {\r\n        var _a = this, standardDateProps = _a.standardDateProps, extendedSettings = _a.extendedSettings;\r\n        var diffSeverity = computeMarkerDiffSeverity(start.marker, end.marker, context.calendarSystem);\r\n        if (!diffSeverity) {\r\n            return this.format(start, context);\r\n        }\r\n        var biggestUnitForPartial = diffSeverity;\r\n        if (biggestUnitForPartial > 1 && // the two dates are different in a way that's larger scale than time\r\n            (standardDateProps.year === 'numeric' || standardDateProps.year === '2-digit') &&\r\n            (standardDateProps.month === 'numeric' || standardDateProps.month === '2-digit') &&\r\n            (standardDateProps.day === 'numeric' || standardDateProps.day === '2-digit')) {\r\n            biggestUnitForPartial = 1; // make it look like the dates are only different in terms of time\r\n        }\r\n        var full0 = this.format(start, context);\r\n        var full1 = this.format(end, context);\r\n        if (full0 === full1) {\r\n            return full0;\r\n        }\r\n        var partialDateProps = computePartialFormattingOptions(standardDateProps, biggestUnitForPartial);\r\n        var partialFormattingFunc = buildFormattingFunc(partialDateProps, extendedSettings, context);\r\n        var partial0 = partialFormattingFunc(start);\r\n        var partial1 = partialFormattingFunc(end);\r\n        var insertion = findCommonInsertion(full0, partial0, full1, partial1);\r\n        var separator = extendedSettings.separator || '';\r\n        if (insertion) {\r\n            return insertion.before + partial0 + separator + partial1 + insertion.after;\r\n        }\r\n        return full0 + separator + full1;\r\n    };\r\n    NativeFormatter.prototype.getLargestUnit = function () {\r\n        switch (this.severity) {\r\n            case 7:\r\n            case 6:\r\n            case 5:\r\n                return 'year';\r\n            case 4:\r\n                return 'month';\r\n            case 3:\r\n                return 'week';\r\n            default:\r\n                return 'day';\r\n        }\r\n    };\r\n    return NativeFormatter;\r\n}());\r\nfunction buildFormattingFunc(standardDateProps, extendedSettings, context) {\r\n    var standardDatePropCnt = Object.keys(standardDateProps).length;\r\n    if (standardDatePropCnt === 1 && standardDateProps.timeZoneName === 'short') {\r\n        return function (date) {\r\n            return formatTimeZoneOffset(date.timeZoneOffset);\r\n        };\r\n    }\r\n    if (standardDatePropCnt === 0 && extendedSettings.week) {\r\n        return function (date) {\r\n            return formatWeekNumber(context.computeWeekNumber(date.marker), context.weekLabel, context.locale, extendedSettings.week);\r\n        };\r\n    }\r\n    return buildNativeFormattingFunc(standardDateProps, extendedSettings, context);\r\n}\r\nfunction buildNativeFormattingFunc(standardDateProps, extendedSettings, context) {\r\n    standardDateProps = __assign({}, standardDateProps); // copy\r\n    extendedSettings = __assign({}, extendedSettings); // copy\r\n    sanitizeSettings(standardDateProps, extendedSettings);\r\n    standardDateProps.timeZone = 'UTC'; // we leverage the only guaranteed timeZone for our UTC markers\r\n    var normalFormat = new Intl.DateTimeFormat(context.locale.codes, standardDateProps);\r\n    var zeroFormat; // needed?\r\n    if (extendedSettings.omitZeroMinute) {\r\n        var zeroProps = __assign({}, standardDateProps);\r\n        delete zeroProps.minute; // seconds and ms were already considered in sanitizeSettings\r\n        zeroFormat = new Intl.DateTimeFormat(context.locale.codes, zeroProps);\r\n    }\r\n    return function (date) {\r\n        var marker = date.marker;\r\n        var format;\r\n        if (zeroFormat && !marker.getUTCMinutes()) {\r\n            format = zeroFormat;\r\n        }\r\n        else {\r\n            format = normalFormat;\r\n        }\r\n        var s = format.format(marker);\r\n        return postProcess(s, date, standardDateProps, extendedSettings, context);\r\n    };\r\n}\r\nfunction sanitizeSettings(standardDateProps, extendedSettings) {\r\n    // deal with a browser inconsistency where formatting the timezone\r\n    // requires that the hour/minute be present.\r\n    if (standardDateProps.timeZoneName) {\r\n        if (!standardDateProps.hour) {\r\n            standardDateProps.hour = '2-digit';\r\n        }\r\n        if (!standardDateProps.minute) {\r\n            standardDateProps.minute = '2-digit';\r\n        }\r\n    }\r\n    // only support short timezone names\r\n    if (standardDateProps.timeZoneName === 'long') {\r\n        standardDateProps.timeZoneName = 'short';\r\n    }\r\n    // if requesting to display seconds, MUST display minutes\r\n    if (extendedSettings.omitZeroMinute && (standardDateProps.second || standardDateProps.millisecond)) {\r\n        delete extendedSettings.omitZeroMinute;\r\n    }\r\n}\r\nfunction postProcess(s, date, standardDateProps, extendedSettings, context) {\r\n    s = s.replace(LTR_RE, ''); // remove left-to-right control chars. do first. good for other regexes\r\n    if (standardDateProps.timeZoneName === 'short') {\r\n        s = injectTzoStr(s, (context.timeZone === 'UTC' || date.timeZoneOffset == null) ?\r\n            'UTC' : // important to normalize for IE, which does \"GMT\"\r\n            formatTimeZoneOffset(date.timeZoneOffset));\r\n    }\r\n    if (extendedSettings.omitCommas) {\r\n        s = s.replace(COMMA_RE, '').trim();\r\n    }\r\n    if (extendedSettings.omitZeroMinute) {\r\n        s = s.replace(':00', ''); // zeroFormat doesn't always achieve this\r\n    }\r\n    // ^ do anything that might create adjacent spaces before this point,\r\n    // because MERIDIEM_RE likes to eat up loading spaces\r\n    if (extendedSettings.meridiem === false) {\r\n        s = s.replace(MERIDIEM_RE, '').trim();\r\n    }\r\n    else if (extendedSettings.meridiem === 'narrow') { // a/p\r\n        s = s.replace(MERIDIEM_RE, function (m0, m1) {\r\n            return m1.toLocaleLowerCase();\r\n        });\r\n    }\r\n    else if (extendedSettings.meridiem === 'short') { // am/pm\r\n        s = s.replace(MERIDIEM_RE, function (m0, m1) {\r\n            return m1.toLocaleLowerCase() + 'm';\r\n        });\r\n    }\r\n    else if (extendedSettings.meridiem === 'lowercase') { // other meridiem transformers already converted to lowercase\r\n        s = s.replace(MERIDIEM_RE, function (m0) {\r\n            return m0.toLocaleLowerCase();\r\n        });\r\n    }\r\n    s = s.replace(MULTI_SPACE_RE, ' ');\r\n    s = s.trim();\r\n    return s;\r\n}\r\nfunction injectTzoStr(s, tzoStr) {\r\n    var replaced = false;\r\n    s = s.replace(UTC_RE, function () {\r\n        replaced = true;\r\n        return tzoStr;\r\n    });\r\n    // IE11 doesn't include UTC/GMT in the original string, so append to end\r\n    if (!replaced) {\r\n        s += ' ' + tzoStr;\r\n    }\r\n    return s;\r\n}\r\nfunction formatWeekNumber(num, weekLabel, locale, display) {\r\n    var parts = [];\r\n    if (display === 'narrow') {\r\n        parts.push(weekLabel);\r\n    }\r\n    else if (display === 'short') {\r\n        parts.push(weekLabel, ' ');\r\n    }\r\n    // otherwise, considered 'numeric'\r\n    parts.push(locale.simpleNumberFormat.format(num));\r\n    if (locale.options.isRtl) { // TODO: use control characters instead?\r\n        parts.reverse();\r\n    }\r\n    return parts.join('');\r\n}\r\n// Range Formatting Utils\r\n// 0 = exactly the same\r\n// 1 = different by time\r\n// and bigger\r\nfunction computeMarkerDiffSeverity(d0, d1, ca) {\r\n    if (ca.getMarkerYear(d0) !== ca.getMarkerYear(d1)) {\r\n        return 5;\r\n    }\r\n    if (ca.getMarkerMonth(d0) !== ca.getMarkerMonth(d1)) {\r\n        return 4;\r\n    }\r\n    if (ca.getMarkerDay(d0) !== ca.getMarkerDay(d1)) {\r\n        return 2;\r\n    }\r\n    if (timeAsMs(d0) !== timeAsMs(d1)) {\r\n        return 1;\r\n    }\r\n    return 0;\r\n}\r\nfunction computePartialFormattingOptions(options, biggestUnit) {\r\n    var partialOptions = {};\r\n    for (var name_2 in options) {\r\n        if (!(name_2 in STANDARD_DATE_PROP_SEVERITIES) || // not a date part prop (like timeZone)\r\n            STANDARD_DATE_PROP_SEVERITIES[name_2] <= biggestUnit) {\r\n            partialOptions[name_2] = options[name_2];\r\n        }\r\n    }\r\n    return partialOptions;\r\n}\r\nfunction findCommonInsertion(full0, partial0, full1, partial1) {\r\n    var i0 = 0;\r\n    while (i0 < full0.length) {\r\n        var found0 = full0.indexOf(partial0, i0);\r\n        if (found0 === -1) {\r\n            break;\r\n        }\r\n        var before0 = full0.substr(0, found0);\r\n        i0 = found0 + partial0.length;\r\n        var after0 = full0.substr(i0);\r\n        var i1 = 0;\r\n        while (i1 < full1.length) {\r\n            var found1 = full1.indexOf(partial1, i1);\r\n            if (found1 === -1) {\r\n                break;\r\n            }\r\n            var before1 = full1.substr(0, found1);\r\n            i1 = found1 + partial1.length;\r\n            var after1 = full1.substr(i1);\r\n            if (before0 === before1 && after0 === after1) {\r\n                return {\r\n                    before: before0,\r\n                    after: after0\r\n                };\r\n            }\r\n        }\r\n    }\r\n    return null;\r\n}\r\n\r\n/*\r\nTODO: fix the terminology of \"formatter\" vs \"formatting func\"\r\n*/\r\n/*\r\nAt the time of instantiation, this object does not know which cmd-formatting system it will use.\r\nIt receives this at the time of formatting, as a setting.\r\n*/\r\nvar CmdFormatter = /** @class */ (function () {\r\n    function CmdFormatter(cmdStr, separator) {\r\n        this.cmdStr = cmdStr;\r\n        this.separator = separator;\r\n    }\r\n    CmdFormatter.prototype.format = function (date, context) {\r\n        return context.cmdFormatter(this.cmdStr, createVerboseFormattingArg(date, null, context, this.separator));\r\n    };\r\n    CmdFormatter.prototype.formatRange = function (start, end, context) {\r\n        return context.cmdFormatter(this.cmdStr, createVerboseFormattingArg(start, end, context, this.separator));\r\n    };\r\n    return CmdFormatter;\r\n}());\r\n\r\nvar FuncFormatter = /** @class */ (function () {\r\n    function FuncFormatter(func) {\r\n        this.func = func;\r\n    }\r\n    FuncFormatter.prototype.format = function (date, context) {\r\n        return this.func(createVerboseFormattingArg(date, null, context));\r\n    };\r\n    FuncFormatter.prototype.formatRange = function (start, end, context) {\r\n        return this.func(createVerboseFormattingArg(start, end, context));\r\n    };\r\n    return FuncFormatter;\r\n}());\r\n\r\n// Formatter Object Creation\r\nfunction createFormatter(input, defaultSeparator) {\r\n    if (typeof input === 'object' && input) { // non-null object\r\n        if (typeof defaultSeparator === 'string') {\r\n            input = __assign({ separator: defaultSeparator }, input);\r\n        }\r\n        return new NativeFormatter(input);\r\n    }\r\n    else if (typeof input === 'string') {\r\n        return new CmdFormatter(input, defaultSeparator);\r\n    }\r\n    else if (typeof input === 'function') {\r\n        return new FuncFormatter(input);\r\n    }\r\n}\r\n// String Utils\r\n// timeZoneOffset is in minutes\r\nfunction buildIsoString(marker, timeZoneOffset, stripZeroTime) {\r\n    if (stripZeroTime === void 0) { stripZeroTime = false; }\r\n    var s = marker.toISOString();\r\n    s = s.replace('.000', '');\r\n    if (stripZeroTime) {\r\n        s = s.replace('T00:00:00Z', '');\r\n    }\r\n    if (s.length > 10) { // time part wasn't stripped, can add timezone info\r\n        if (timeZoneOffset == null) {\r\n            s = s.replace('Z', '');\r\n        }\r\n        else if (timeZoneOffset !== 0) {\r\n            s = s.replace('Z', formatTimeZoneOffset(timeZoneOffset, true));\r\n        }\r\n        // otherwise, its UTC-0 and we want to keep the Z\r\n    }\r\n    return s;\r\n}\r\nfunction formatIsoTimeString(marker) {\r\n    return padStart(marker.getUTCHours(), 2) + ':' +\r\n        padStart(marker.getUTCMinutes(), 2) + ':' +\r\n        padStart(marker.getUTCSeconds(), 2);\r\n}\r\nfunction formatTimeZoneOffset(minutes, doIso) {\r\n    if (doIso === void 0) { doIso = false; }\r\n    var sign = minutes < 0 ? '-' : '+';\r\n    var abs = Math.abs(minutes);\r\n    var hours = Math.floor(abs / 60);\r\n    var mins = Math.round(abs % 60);\r\n    if (doIso) {\r\n        return sign + padStart(hours, 2) + ':' + padStart(mins, 2);\r\n    }\r\n    else {\r\n        return 'GMT' + sign + hours + (mins ? ':' + padStart(mins, 2) : '');\r\n    }\r\n}\r\n// Arg Utils\r\nfunction createVerboseFormattingArg(start, end, context, separator) {\r\n    var startInfo = expandZonedMarker(start, context.calendarSystem);\r\n    var endInfo = end ? expandZonedMarker(end, context.calendarSystem) : null;\r\n    return {\r\n        date: startInfo,\r\n        start: startInfo,\r\n        end: endInfo,\r\n        timeZone: context.timeZone,\r\n        localeCodes: context.locale.codes,\r\n        separator: separator\r\n    };\r\n}\r\nfunction expandZonedMarker(dateInfo, calendarSystem) {\r\n    var a = calendarSystem.markerToArray(dateInfo.marker);\r\n    return {\r\n        marker: dateInfo.marker,\r\n        timeZoneOffset: dateInfo.timeZoneOffset,\r\n        array: a,\r\n        year: a[0],\r\n        month: a[1],\r\n        day: a[2],\r\n        hour: a[3],\r\n        minute: a[4],\r\n        second: a[5],\r\n        millisecond: a[6]\r\n    };\r\n}\r\n\r\nvar EventSourceApi = /** @class */ (function () {\r\n    function EventSourceApi(calendar, internalEventSource) {\r\n        this.calendar = calendar;\r\n        this.internalEventSource = internalEventSource;\r\n    }\r\n    EventSourceApi.prototype.remove = function () {\r\n        this.calendar.dispatch({\r\n            type: 'REMOVE_EVENT_SOURCE',\r\n            sourceId: this.internalEventSource.sourceId\r\n        });\r\n    };\r\n    EventSourceApi.prototype.refetch = function () {\r\n        this.calendar.dispatch({\r\n            type: 'FETCH_EVENT_SOURCES',\r\n            sourceIds: [this.internalEventSource.sourceId]\r\n        });\r\n    };\r\n    Object.defineProperty(EventSourceApi.prototype, \"id\", {\r\n        get: function () {\r\n            return this.internalEventSource.publicId;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(EventSourceApi.prototype, \"url\", {\r\n        // only relevant to json-feed event sources\r\n        get: function () {\r\n            return this.internalEventSource.meta.url;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return EventSourceApi;\r\n}());\r\n\r\nvar EventApi = /** @class */ (function () {\r\n    function EventApi(calendar, def, instance) {\r\n        this._calendar = calendar;\r\n        this._def = def;\r\n        this._instance = instance || null;\r\n    }\r\n    /*\r\n    TODO: make event struct more responsible for this\r\n    */\r\n    EventApi.prototype.setProp = function (name, val) {\r\n        var _a, _b;\r\n        if (name in DATE_PROPS) ;\r\n        else if (name in NON_DATE_PROPS) {\r\n            if (typeof NON_DATE_PROPS[name] === 'function') {\r\n                val = NON_DATE_PROPS[name](val);\r\n            }\r\n            this.mutate({\r\n                standardProps: (_a = {}, _a[name] = val, _a)\r\n            });\r\n        }\r\n        else if (name in UNSCOPED_EVENT_UI_PROPS) {\r\n            var ui = void 0;\r\n            if (typeof UNSCOPED_EVENT_UI_PROPS[name] === 'function') {\r\n                val = UNSCOPED_EVENT_UI_PROPS[name](val);\r\n            }\r\n            if (name === 'color') {\r\n                ui = { backgroundColor: val, borderColor: val };\r\n            }\r\n            else if (name === 'editable') {\r\n                ui = { startEditable: val, durationEditable: val };\r\n            }\r\n            else {\r\n                ui = (_b = {}, _b[name] = val, _b);\r\n            }\r\n            this.mutate({\r\n                standardProps: { ui: ui }\r\n            });\r\n        }\r\n    };\r\n    EventApi.prototype.setExtendedProp = function (name, val) {\r\n        var _a;\r\n        this.mutate({\r\n            extendedProps: (_a = {}, _a[name] = val, _a)\r\n        });\r\n    };\r\n    EventApi.prototype.setStart = function (startInput, options) {\r\n        if (options === void 0) { options = {}; }\r\n        var dateEnv = this._calendar.dateEnv;\r\n        var start = dateEnv.createMarker(startInput);\r\n        if (start && this._instance) { // TODO: warning if parsed bad\r\n            var instanceRange = this._instance.range;\r\n            var startDelta = diffDates(instanceRange.start, start, dateEnv, options.granularity); // what if parsed bad!?\r\n            if (options.maintainDuration) {\r\n                this.mutate({ datesDelta: startDelta });\r\n            }\r\n            else {\r\n                this.mutate({ startDelta: startDelta });\r\n            }\r\n        }\r\n    };\r\n    EventApi.prototype.setEnd = function (endInput, options) {\r\n        if (options === void 0) { options = {}; }\r\n        var dateEnv = this._calendar.dateEnv;\r\n        var end;\r\n        if (endInput != null) {\r\n            end = dateEnv.createMarker(endInput);\r\n            if (!end) {\r\n                return; // TODO: warning if parsed bad\r\n            }\r\n        }\r\n        if (this._instance) {\r\n            if (end) {\r\n                var endDelta = diffDates(this._instance.range.end, end, dateEnv, options.granularity);\r\n                this.mutate({ endDelta: endDelta });\r\n            }\r\n            else {\r\n                this.mutate({ standardProps: { hasEnd: false } });\r\n            }\r\n        }\r\n    };\r\n    EventApi.prototype.setDates = function (startInput, endInput, options) {\r\n        if (options === void 0) { options = {}; }\r\n        var dateEnv = this._calendar.dateEnv;\r\n        var standardProps = { allDay: options.allDay };\r\n        var start = dateEnv.createMarker(startInput);\r\n        var end;\r\n        if (!start) {\r\n            return; // TODO: warning if parsed bad\r\n        }\r\n        if (endInput != null) {\r\n            end = dateEnv.createMarker(endInput);\r\n            if (!end) { // TODO: warning if parsed bad\r\n                return;\r\n            }\r\n        }\r\n        if (this._instance) {\r\n            var instanceRange = this._instance.range;\r\n            // when computing the diff for an event being converted to all-day,\r\n            // compute diff off of the all-day values the way event-mutation does.\r\n            if (options.allDay === true) {\r\n                instanceRange = computeAlignedDayRange(instanceRange);\r\n            }\r\n            var startDelta = diffDates(instanceRange.start, start, dateEnv, options.granularity);\r\n            if (end) {\r\n                var endDelta = diffDates(instanceRange.end, end, dateEnv, options.granularity);\r\n                if (durationsEqual(startDelta, endDelta)) {\r\n                    this.mutate({ datesDelta: startDelta, standardProps: standardProps });\r\n                }\r\n                else {\r\n                    this.mutate({ startDelta: startDelta, endDelta: endDelta, standardProps: standardProps });\r\n                }\r\n            }\r\n            else { // means \"clear the end\"\r\n                standardProps.hasEnd = false;\r\n                this.mutate({ datesDelta: startDelta, standardProps: standardProps });\r\n            }\r\n        }\r\n    };\r\n    EventApi.prototype.moveStart = function (deltaInput) {\r\n        var delta = createDuration(deltaInput);\r\n        if (delta) { // TODO: warning if parsed bad\r\n            this.mutate({ startDelta: delta });\r\n        }\r\n    };\r\n    EventApi.prototype.moveEnd = function (deltaInput) {\r\n        var delta = createDuration(deltaInput);\r\n        if (delta) { // TODO: warning if parsed bad\r\n            this.mutate({ endDelta: delta });\r\n        }\r\n    };\r\n    EventApi.prototype.moveDates = function (deltaInput) {\r\n        var delta = createDuration(deltaInput);\r\n        if (delta) { // TODO: warning if parsed bad\r\n            this.mutate({ datesDelta: delta });\r\n        }\r\n    };\r\n    EventApi.prototype.setAllDay = function (allDay, options) {\r\n        if (options === void 0) { options = {}; }\r\n        var standardProps = { allDay: allDay };\r\n        var maintainDuration = options.maintainDuration;\r\n        if (maintainDuration == null) {\r\n            maintainDuration = this._calendar.opt('allDayMaintainDuration');\r\n        }\r\n        if (this._def.allDay !== allDay) {\r\n            standardProps.hasEnd = maintainDuration;\r\n        }\r\n        this.mutate({ standardProps: standardProps });\r\n    };\r\n    EventApi.prototype.formatRange = function (formatInput) {\r\n        var dateEnv = this._calendar.dateEnv;\r\n        var instance = this._instance;\r\n        var formatter = createFormatter(formatInput, this._calendar.opt('defaultRangeSeparator'));\r\n        if (this._def.hasEnd) {\r\n            return dateEnv.formatRange(instance.range.start, instance.range.end, formatter, {\r\n                forcedStartTzo: instance.forcedStartTzo,\r\n                forcedEndTzo: instance.forcedEndTzo\r\n            });\r\n        }\r\n        else {\r\n            return dateEnv.format(instance.range.start, formatter, {\r\n                forcedTzo: instance.forcedStartTzo\r\n            });\r\n        }\r\n    };\r\n    EventApi.prototype.mutate = function (mutation) {\r\n        var def = this._def;\r\n        var instance = this._instance;\r\n        if (instance) {\r\n            this._calendar.dispatch({\r\n                type: 'MUTATE_EVENTS',\r\n                instanceId: instance.instanceId,\r\n                mutation: mutation,\r\n                fromApi: true\r\n            });\r\n            var eventStore = this._calendar.state.eventStore;\r\n            this._def = eventStore.defs[def.defId];\r\n            this._instance = eventStore.instances[instance.instanceId];\r\n        }\r\n    };\r\n    EventApi.prototype.remove = function () {\r\n        this._calendar.dispatch({\r\n            type: 'REMOVE_EVENT_DEF',\r\n            defId: this._def.defId\r\n        });\r\n    };\r\n    Object.defineProperty(EventApi.prototype, \"source\", {\r\n        get: function () {\r\n            var sourceId = this._def.sourceId;\r\n            if (sourceId) {\r\n                return new EventSourceApi(this._calendar, this._calendar.state.eventSources[sourceId]);\r\n            }\r\n            return null;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(EventApi.prototype, \"start\", {\r\n        get: function () {\r\n            return this._instance ?\r\n                this._calendar.dateEnv.toDate(this._instance.range.start) :\r\n                null;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(EventApi.prototype, \"end\", {\r\n        get: function () {\r\n            return (this._instance && this._def.hasEnd) ?\r\n                this._calendar.dateEnv.toDate(this._instance.range.end) :\r\n                null;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(EventApi.prototype, \"id\", {\r\n        // computable props that all access the def\r\n        // TODO: find a TypeScript-compatible way to do this at scale\r\n        get: function () { return this._def.publicId; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(EventApi.prototype, \"groupId\", {\r\n        get: function () { return this._def.groupId; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(EventApi.prototype, \"allDay\", {\r\n        get: function () { return this._def.allDay; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(EventApi.prototype, \"title\", {\r\n        get: function () { return this._def.title; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(EventApi.prototype, \"url\", {\r\n        get: function () { return this._def.url; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(EventApi.prototype, \"rendering\", {\r\n        get: function () { return this._def.rendering; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(EventApi.prototype, \"startEditable\", {\r\n        get: function () { return this._def.ui.startEditable; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(EventApi.prototype, \"durationEditable\", {\r\n        get: function () { return this._def.ui.durationEditable; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(EventApi.prototype, \"constraint\", {\r\n        get: function () { return this._def.ui.constraints[0] || null; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(EventApi.prototype, \"overlap\", {\r\n        get: function () { return this._def.ui.overlap; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(EventApi.prototype, \"allow\", {\r\n        get: function () { return this._def.ui.allows[0] || null; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(EventApi.prototype, \"backgroundColor\", {\r\n        get: function () { return this._def.ui.backgroundColor; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(EventApi.prototype, \"borderColor\", {\r\n        get: function () { return this._def.ui.borderColor; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(EventApi.prototype, \"textColor\", {\r\n        get: function () { return this._def.ui.textColor; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(EventApi.prototype, \"classNames\", {\r\n        // NOTE: user can't modify these because Object.freeze was called in event-def parsing\r\n        get: function () { return this._def.ui.classNames; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(EventApi.prototype, \"extendedProps\", {\r\n        get: function () { return this._def.extendedProps; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return EventApi;\r\n}());\r\n\r\n/*\r\nSpecifying nextDayThreshold signals that all-day ranges should be sliced.\r\n*/\r\nfunction sliceEventStore(eventStore, eventUiBases, framingRange, nextDayThreshold) {\r\n    var inverseBgByGroupId = {};\r\n    var inverseBgByDefId = {};\r\n    var defByGroupId = {};\r\n    var bgRanges = [];\r\n    var fgRanges = [];\r\n    var eventUis = compileEventUis(eventStore.defs, eventUiBases);\r\n    for (var defId in eventStore.defs) {\r\n        var def = eventStore.defs[defId];\r\n        if (def.rendering === 'inverse-background') {\r\n            if (def.groupId) {\r\n                inverseBgByGroupId[def.groupId] = [];\r\n                if (!defByGroupId[def.groupId]) {\r\n                    defByGroupId[def.groupId] = def;\r\n                }\r\n            }\r\n            else {\r\n                inverseBgByDefId[defId] = [];\r\n            }\r\n        }\r\n    }\r\n    for (var instanceId in eventStore.instances) {\r\n        var instance = eventStore.instances[instanceId];\r\n        var def = eventStore.defs[instance.defId];\r\n        var ui = eventUis[def.defId];\r\n        var origRange = instance.range;\r\n        var normalRange = (!def.allDay && nextDayThreshold) ?\r\n            computeVisibleDayRange(origRange, nextDayThreshold) :\r\n            origRange;\r\n        var slicedRange = intersectRanges(normalRange, framingRange);\r\n        if (slicedRange) {\r\n            if (def.rendering === 'inverse-background') {\r\n                if (def.groupId) {\r\n                    inverseBgByGroupId[def.groupId].push(slicedRange);\r\n                }\r\n                else {\r\n                    inverseBgByDefId[instance.defId].push(slicedRange);\r\n                }\r\n            }\r\n            else {\r\n                (def.rendering === 'background' ? bgRanges : fgRanges).push({\r\n                    def: def,\r\n                    ui: ui,\r\n                    instance: instance,\r\n                    range: slicedRange,\r\n                    isStart: normalRange.start && normalRange.start.valueOf() === slicedRange.start.valueOf(),\r\n                    isEnd: normalRange.end && normalRange.end.valueOf() === slicedRange.end.valueOf()\r\n                });\r\n            }\r\n        }\r\n    }\r\n    for (var groupId in inverseBgByGroupId) { // BY GROUP\r\n        var ranges = inverseBgByGroupId[groupId];\r\n        var invertedRanges = invertRanges(ranges, framingRange);\r\n        for (var _i = 0, invertedRanges_1 = invertedRanges; _i < invertedRanges_1.length; _i++) {\r\n            var invertedRange = invertedRanges_1[_i];\r\n            var def = defByGroupId[groupId];\r\n            var ui = eventUis[def.defId];\r\n            bgRanges.push({\r\n                def: def,\r\n                ui: ui,\r\n                instance: null,\r\n                range: invertedRange,\r\n                isStart: false,\r\n                isEnd: false\r\n            });\r\n        }\r\n    }\r\n    for (var defId in inverseBgByDefId) {\r\n        var ranges = inverseBgByDefId[defId];\r\n        var invertedRanges = invertRanges(ranges, framingRange);\r\n        for (var _a = 0, invertedRanges_2 = invertedRanges; _a < invertedRanges_2.length; _a++) {\r\n            var invertedRange = invertedRanges_2[_a];\r\n            bgRanges.push({\r\n                def: eventStore.defs[defId],\r\n                ui: eventUis[defId],\r\n                instance: null,\r\n                range: invertedRange,\r\n                isStart: false,\r\n                isEnd: false\r\n            });\r\n        }\r\n    }\r\n    return { bg: bgRanges, fg: fgRanges };\r\n}\r\nfunction hasBgRendering(def) {\r\n    return def.rendering === 'background' || def.rendering === 'inverse-background';\r\n}\r\nfunction filterSegsViaEls(view, segs, isMirror) {\r\n    if (view.hasPublicHandlers('eventRender')) {\r\n        segs = segs.filter(function (seg) {\r\n            var custom = view.publiclyTrigger('eventRender', [\r\n                {\r\n                    event: new EventApi(view.calendar, seg.eventRange.def, seg.eventRange.instance),\r\n                    isMirror: isMirror,\r\n                    isStart: seg.isStart,\r\n                    isEnd: seg.isEnd,\r\n                    // TODO: include seg.range once all components consistently generate it\r\n                    el: seg.el,\r\n                    view: view\r\n                }\r\n            ]);\r\n            if (custom === false) { // means don't render at all\r\n                return false;\r\n            }\r\n            else if (custom && custom !== true) {\r\n                seg.el = custom;\r\n            }\r\n            return true;\r\n        });\r\n    }\r\n    for (var _i = 0, segs_1 = segs; _i < segs_1.length; _i++) {\r\n        var seg = segs_1[_i];\r\n        setElSeg(seg.el, seg);\r\n    }\r\n    return segs;\r\n}\r\nfunction setElSeg(el, seg) {\r\n    el.fcSeg = seg;\r\n}\r\nfunction getElSeg(el) {\r\n    return el.fcSeg || null;\r\n}\r\n// event ui computation\r\nfunction compileEventUis(eventDefs, eventUiBases) {\r\n    return mapHash(eventDefs, function (eventDef) {\r\n        return compileEventUi(eventDef, eventUiBases);\r\n    });\r\n}\r\nfunction compileEventUi(eventDef, eventUiBases) {\r\n    var uis = [];\r\n    if (eventUiBases['']) {\r\n        uis.push(eventUiBases['']);\r\n    }\r\n    if (eventUiBases[eventDef.defId]) {\r\n        uis.push(eventUiBases[eventDef.defId]);\r\n    }\r\n    uis.push(eventDef.ui);\r\n    return combineEventUis(uis);\r\n}\r\n\r\n// applies the mutation to ALL defs/instances within the event store\r\nfunction applyMutationToEventStore(eventStore, eventConfigBase, mutation, calendar) {\r\n    var eventConfigs = compileEventUis(eventStore.defs, eventConfigBase);\r\n    var dest = createEmptyEventStore();\r\n    for (var defId in eventStore.defs) {\r\n        var def = eventStore.defs[defId];\r\n        dest.defs[defId] = applyMutationToEventDef(def, eventConfigs[defId], mutation, calendar.pluginSystem.hooks.eventDefMutationAppliers, calendar);\r\n    }\r\n    for (var instanceId in eventStore.instances) {\r\n        var instance = eventStore.instances[instanceId];\r\n        var def = dest.defs[instance.defId]; // important to grab the newly modified def\r\n        dest.instances[instanceId] = applyMutationToEventInstance(instance, def, eventConfigs[instance.defId], mutation, calendar);\r\n    }\r\n    return dest;\r\n}\r\nfunction applyMutationToEventDef(eventDef, eventConfig, mutation, appliers, calendar) {\r\n    var standardProps = mutation.standardProps || {};\r\n    // if hasEnd has not been specified, guess a good value based on deltas.\r\n    // if duration will change, there's no way the default duration will persist,\r\n    // and thus, we need to mark the event as having a real end\r\n    if (standardProps.hasEnd == null &&\r\n        eventConfig.durationEditable &&\r\n        (mutation.startDelta || mutation.endDelta)) {\r\n        standardProps.hasEnd = true; // TODO: is this mutation okay?\r\n    }\r\n    var copy = __assign({}, eventDef, standardProps, { ui: __assign({}, eventDef.ui, standardProps.ui) });\r\n    if (mutation.extendedProps) {\r\n        copy.extendedProps = __assign({}, copy.extendedProps, mutation.extendedProps);\r\n    }\r\n    for (var _i = 0, appliers_1 = appliers; _i < appliers_1.length; _i++) {\r\n        var applier = appliers_1[_i];\r\n        applier(copy, mutation, calendar);\r\n    }\r\n    if (!copy.hasEnd && calendar.opt('forceEventDuration')) {\r\n        copy.hasEnd = true;\r\n    }\r\n    return copy;\r\n}\r\nfunction applyMutationToEventInstance(eventInstance, eventDef, // must first be modified by applyMutationToEventDef\r\neventConfig, mutation, calendar) {\r\n    var dateEnv = calendar.dateEnv;\r\n    var forceAllDay = mutation.standardProps && mutation.standardProps.allDay === true;\r\n    var clearEnd = mutation.standardProps && mutation.standardProps.hasEnd === false;\r\n    var copy = __assign({}, eventInstance);\r\n    if (forceAllDay) {\r\n        copy.range = computeAlignedDayRange(copy.range);\r\n    }\r\n    if (mutation.datesDelta && eventConfig.startEditable) {\r\n        copy.range = {\r\n            start: dateEnv.add(copy.range.start, mutation.datesDelta),\r\n            end: dateEnv.add(copy.range.end, mutation.datesDelta)\r\n        };\r\n    }\r\n    if (mutation.startDelta && eventConfig.durationEditable) {\r\n        copy.range = {\r\n            start: dateEnv.add(copy.range.start, mutation.startDelta),\r\n            end: copy.range.end\r\n        };\r\n    }\r\n    if (mutation.endDelta && eventConfig.durationEditable) {\r\n        copy.range = {\r\n            start: copy.range.start,\r\n            end: dateEnv.add(copy.range.end, mutation.endDelta)\r\n        };\r\n    }\r\n    if (clearEnd) {\r\n        copy.range = {\r\n            start: copy.range.start,\r\n            end: calendar.getDefaultEventEnd(eventDef.allDay, copy.range.start)\r\n        };\r\n    }\r\n    // in case event was all-day but the supplied deltas were not\r\n    // better util for this?\r\n    if (eventDef.allDay) {\r\n        copy.range = {\r\n            start: startOfDay(copy.range.start),\r\n            end: startOfDay(copy.range.end)\r\n        };\r\n    }\r\n    // handle invalid durations\r\n    if (copy.range.end < copy.range.start) {\r\n        copy.range.end = calendar.getDefaultEventEnd(eventDef.allDay, copy.range.start);\r\n    }\r\n    return copy;\r\n}\r\n\r\nfunction reduceEventStore (eventStore, action, eventSources, dateProfile, calendar) {\r\n    switch (action.type) {\r\n        case 'RECEIVE_EVENTS': // raw\r\n            return receiveRawEvents(eventStore, eventSources[action.sourceId], action.fetchId, action.fetchRange, action.rawEvents, calendar);\r\n        case 'ADD_EVENTS': // already parsed, but not expanded\r\n            return addEvent(eventStore, action.eventStore, // new ones\r\n            dateProfile ? dateProfile.activeRange : null, calendar);\r\n        case 'MERGE_EVENTS': // already parsed and expanded\r\n            return mergeEventStores(eventStore, action.eventStore);\r\n        case 'PREV': // TODO: how do we track all actions that affect dateProfile :(\r\n        case 'NEXT':\r\n        case 'SET_DATE':\r\n        case 'SET_VIEW_TYPE':\r\n            if (dateProfile) {\r\n                return expandRecurring(eventStore, dateProfile.activeRange, calendar);\r\n            }\r\n            else {\r\n                return eventStore;\r\n            }\r\n        case 'CHANGE_TIMEZONE':\r\n            return rezoneDates(eventStore, action.oldDateEnv, calendar.dateEnv);\r\n        case 'MUTATE_EVENTS':\r\n            return applyMutationToRelated(eventStore, action.instanceId, action.mutation, action.fromApi, calendar);\r\n        case 'REMOVE_EVENT_INSTANCES':\r\n            return excludeInstances(eventStore, action.instances);\r\n        case 'REMOVE_EVENT_DEF':\r\n            return filterEventStoreDefs(eventStore, function (eventDef) {\r\n                return eventDef.defId !== action.defId;\r\n            });\r\n        case 'REMOVE_EVENT_SOURCE':\r\n            return excludeEventsBySourceId(eventStore, action.sourceId);\r\n        case 'REMOVE_ALL_EVENT_SOURCES':\r\n            return filterEventStoreDefs(eventStore, function (eventDef) {\r\n                return !eventDef.sourceId; // only keep events with no source id\r\n            });\r\n        case 'REMOVE_ALL_EVENTS':\r\n            return createEmptyEventStore();\r\n        case 'RESET_EVENTS':\r\n            return {\r\n                defs: eventStore.defs,\r\n                instances: eventStore.instances\r\n            };\r\n        default:\r\n            return eventStore;\r\n    }\r\n}\r\nfunction receiveRawEvents(eventStore, eventSource, fetchId, fetchRange, rawEvents, calendar) {\r\n    if (eventSource && // not already removed\r\n        fetchId === eventSource.latestFetchId // TODO: wish this logic was always in event-sources\r\n    ) {\r\n        var subset = parseEvents(transformRawEvents(rawEvents, eventSource, calendar), eventSource.sourceId, calendar);\r\n        if (fetchRange) {\r\n            subset = expandRecurring(subset, fetchRange, calendar);\r\n        }\r\n        return mergeEventStores(excludeEventsBySourceId(eventStore, eventSource.sourceId), subset);\r\n    }\r\n    return eventStore;\r\n}\r\nfunction addEvent(eventStore, subset, expandRange, calendar) {\r\n    if (expandRange) {\r\n        subset = expandRecurring(subset, expandRange, calendar);\r\n    }\r\n    return mergeEventStores(eventStore, subset);\r\n}\r\nfunction rezoneDates(eventStore, oldDateEnv, newDateEnv) {\r\n    var defs = eventStore.defs;\r\n    var instances = mapHash(eventStore.instances, function (instance) {\r\n        var def = defs[instance.defId];\r\n        if (def.allDay || def.recurringDef) {\r\n            return instance; // isn't dependent on timezone\r\n        }\r\n        else {\r\n            return __assign({}, instance, { range: {\r\n                    start: newDateEnv.createMarker(oldDateEnv.toDate(instance.range.start, instance.forcedStartTzo)),\r\n                    end: newDateEnv.createMarker(oldDateEnv.toDate(instance.range.end, instance.forcedEndTzo))\r\n                }, forcedStartTzo: newDateEnv.canComputeOffset ? null : instance.forcedStartTzo, forcedEndTzo: newDateEnv.canComputeOffset ? null : instance.forcedEndTzo });\r\n        }\r\n    });\r\n    return { defs: defs, instances: instances };\r\n}\r\nfunction applyMutationToRelated(eventStore, instanceId, mutation, fromApi, calendar) {\r\n    var relevant = getRelevantEvents(eventStore, instanceId);\r\n    var eventConfigBase = fromApi ?\r\n        { '': {\r\n                startEditable: true,\r\n                durationEditable: true,\r\n                constraints: [],\r\n                overlap: null,\r\n                allows: [],\r\n                backgroundColor: '',\r\n                borderColor: '',\r\n                textColor: '',\r\n                classNames: []\r\n            } } :\r\n        calendar.eventUiBases;\r\n    relevant = applyMutationToEventStore(relevant, eventConfigBase, mutation, calendar);\r\n    return mergeEventStores(eventStore, relevant);\r\n}\r\nfunction excludeEventsBySourceId(eventStore, sourceId) {\r\n    return filterEventStoreDefs(eventStore, function (eventDef) {\r\n        return eventDef.sourceId !== sourceId;\r\n    });\r\n}\r\n// QUESTION: why not just return instances? do a general object-property-exclusion util\r\nfunction excludeInstances(eventStore, removals) {\r\n    return {\r\n        defs: eventStore.defs,\r\n        instances: filterHash(eventStore.instances, function (instance) {\r\n            return !removals[instance.instanceId];\r\n        })\r\n    };\r\n}\r\n\r\n// high-level segmenting-aware tester functions\r\n// ------------------------------------------------------------------------------------------------------------------------\r\nfunction isInteractionValid(interaction, calendar) {\r\n    return isNewPropsValid({ eventDrag: interaction }, calendar); // HACK: the eventDrag props is used for ALL interactions\r\n}\r\nfunction isDateSelectionValid(dateSelection, calendar) {\r\n    return isNewPropsValid({ dateSelection: dateSelection }, calendar);\r\n}\r\nfunction isNewPropsValid(newProps, calendar) {\r\n    var view = calendar.view;\r\n    var props = __assign({ businessHours: view ? view.props.businessHours : createEmptyEventStore(), dateSelection: '', eventStore: calendar.state.eventStore, eventUiBases: calendar.eventUiBases, eventSelection: '', eventDrag: null, eventResize: null }, newProps);\r\n    return (calendar.pluginSystem.hooks.isPropsValid || isPropsValid)(props, calendar);\r\n}\r\nfunction isPropsValid(state, calendar, dateSpanMeta, filterConfig) {\r\n    if (dateSpanMeta === void 0) { dateSpanMeta = {}; }\r\n    if (state.eventDrag && !isInteractionPropsValid(state, calendar, dateSpanMeta, filterConfig)) {\r\n        return false;\r\n    }\r\n    if (state.dateSelection && !isDateSelectionPropsValid(state, calendar, dateSpanMeta, filterConfig)) {\r\n        return false;\r\n    }\r\n    return true;\r\n}\r\n// Moving Event Validation\r\n// ------------------------------------------------------------------------------------------------------------------------\r\nfunction isInteractionPropsValid(state, calendar, dateSpanMeta, filterConfig) {\r\n    var interaction = state.eventDrag; // HACK: the eventDrag props is used for ALL interactions\r\n    var subjectEventStore = interaction.mutatedEvents;\r\n    var subjectDefs = subjectEventStore.defs;\r\n    var subjectInstances = subjectEventStore.instances;\r\n    var subjectConfigs = compileEventUis(subjectDefs, interaction.isEvent ?\r\n        state.eventUiBases :\r\n        { '': calendar.selectionConfig } // if not a real event, validate as a selection\r\n    );\r\n    if (filterConfig) {\r\n        subjectConfigs = mapHash(subjectConfigs, filterConfig);\r\n    }\r\n    var otherEventStore = excludeInstances(state.eventStore, interaction.affectedEvents.instances); // exclude the subject events. TODO: exclude defs too?\r\n    var otherDefs = otherEventStore.defs;\r\n    var otherInstances = otherEventStore.instances;\r\n    var otherConfigs = compileEventUis(otherDefs, state.eventUiBases);\r\n    for (var subjectInstanceId in subjectInstances) {\r\n        var subjectInstance = subjectInstances[subjectInstanceId];\r\n        var subjectRange = subjectInstance.range;\r\n        var subjectConfig = subjectConfigs[subjectInstance.defId];\r\n        var subjectDef = subjectDefs[subjectInstance.defId];\r\n        // constraint\r\n        if (!allConstraintsPass(subjectConfig.constraints, subjectRange, otherEventStore, state.businessHours, calendar)) {\r\n            return false;\r\n        }\r\n        // overlap\r\n        var overlapFunc = calendar.opt('eventOverlap');\r\n        if (typeof overlapFunc !== 'function') {\r\n            overlapFunc = null;\r\n        }\r\n        for (var otherInstanceId in otherInstances) {\r\n            var otherInstance = otherInstances[otherInstanceId];\r\n            // intersect! evaluate\r\n            if (rangesIntersect(subjectRange, otherInstance.range)) {\r\n                var otherOverlap = otherConfigs[otherInstance.defId].overlap;\r\n                // consider the other event's overlap. only do this if the subject event is a \"real\" event\r\n                if (otherOverlap === false && interaction.isEvent) {\r\n                    return false;\r\n                }\r\n                if (subjectConfig.overlap === false) {\r\n                    return false;\r\n                }\r\n                if (overlapFunc && !overlapFunc(new EventApi(calendar, otherDefs[otherInstance.defId], otherInstance), // still event\r\n                new EventApi(calendar, subjectDef, subjectInstance) // moving event\r\n                )) {\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n        // allow (a function)\r\n        var calendarEventStore = calendar.state.eventStore; // need global-to-calendar, not local to component (splittable)state\r\n        for (var _i = 0, _a = subjectConfig.allows; _i < _a.length; _i++) {\r\n            var subjectAllow = _a[_i];\r\n            var subjectDateSpan = __assign({}, dateSpanMeta, { range: subjectInstance.range, allDay: subjectDef.allDay });\r\n            var origDef = calendarEventStore.defs[subjectDef.defId];\r\n            var origInstance = calendarEventStore.instances[subjectInstanceId];\r\n            var eventApi = void 0;\r\n            if (origDef) { // was previously in the calendar\r\n                eventApi = new EventApi(calendar, origDef, origInstance);\r\n            }\r\n            else { // was an external event\r\n                eventApi = new EventApi(calendar, subjectDef); // no instance, because had no dates\r\n            }\r\n            if (!subjectAllow(calendar.buildDateSpanApi(subjectDateSpan), eventApi)) {\r\n                return false;\r\n            }\r\n        }\r\n    }\r\n    return true;\r\n}\r\n// Date Selection Validation\r\n// ------------------------------------------------------------------------------------------------------------------------\r\nfunction isDateSelectionPropsValid(state, calendar, dateSpanMeta, filterConfig) {\r\n    var relevantEventStore = state.eventStore;\r\n    var relevantDefs = relevantEventStore.defs;\r\n    var relevantInstances = relevantEventStore.instances;\r\n    var selection = state.dateSelection;\r\n    var selectionRange = selection.range;\r\n    var selectionConfig = calendar.selectionConfig;\r\n    if (filterConfig) {\r\n        selectionConfig = filterConfig(selectionConfig);\r\n    }\r\n    // constraint\r\n    if (!allConstraintsPass(selectionConfig.constraints, selectionRange, relevantEventStore, state.businessHours, calendar)) {\r\n        return false;\r\n    }\r\n    // overlap\r\n    var overlapFunc = calendar.opt('selectOverlap');\r\n    if (typeof overlapFunc !== 'function') {\r\n        overlapFunc = null;\r\n    }\r\n    for (var relevantInstanceId in relevantInstances) {\r\n        var relevantInstance = relevantInstances[relevantInstanceId];\r\n        // intersect! evaluate\r\n        if (rangesIntersect(selectionRange, relevantInstance.range)) {\r\n            if (selectionConfig.overlap === false) {\r\n                return false;\r\n            }\r\n            if (overlapFunc && !overlapFunc(new EventApi(calendar, relevantDefs[relevantInstance.defId], relevantInstance))) {\r\n                return false;\r\n            }\r\n        }\r\n    }\r\n    // allow (a function)\r\n    for (var _i = 0, _a = selectionConfig.allows; _i < _a.length; _i++) {\r\n        var selectionAllow = _a[_i];\r\n        var fullDateSpan = __assign({}, dateSpanMeta, selection);\r\n        if (!selectionAllow(calendar.buildDateSpanApi(fullDateSpan), null)) {\r\n            return false;\r\n        }\r\n    }\r\n    return true;\r\n}\r\n// Constraint Utils\r\n// ------------------------------------------------------------------------------------------------------------------------\r\nfunction allConstraintsPass(constraints, subjectRange, otherEventStore, businessHoursUnexpanded, calendar) {\r\n    for (var _i = 0, constraints_1 = constraints; _i < constraints_1.length; _i++) {\r\n        var constraint = constraints_1[_i];\r\n        if (!anyRangesContainRange(constraintToRanges(constraint, subjectRange, otherEventStore, businessHoursUnexpanded, calendar), subjectRange)) {\r\n            return false;\r\n        }\r\n    }\r\n    return true;\r\n}\r\nfunction constraintToRanges(constraint, subjectRange, // for expanding a recurring constraint, or expanding business hours\r\notherEventStore, // for if constraint is an even group ID\r\nbusinessHoursUnexpanded, // for if constraint is 'businessHours'\r\ncalendar // for expanding businesshours\r\n) {\r\n    if (constraint === 'businessHours') {\r\n        return eventStoreToRanges(expandRecurring(businessHoursUnexpanded, subjectRange, calendar));\r\n    }\r\n    else if (typeof constraint === 'string') { // an group ID\r\n        return eventStoreToRanges(filterEventStoreDefs(otherEventStore, function (eventDef) {\r\n            return eventDef.groupId === constraint;\r\n        }));\r\n    }\r\n    else if (typeof constraint === 'object' && constraint) { // non-null object\r\n        return eventStoreToRanges(expandRecurring(constraint, subjectRange, calendar));\r\n    }\r\n    return []; // if it's false\r\n}\r\n// TODO: move to event-store file?\r\nfunction eventStoreToRanges(eventStore) {\r\n    var instances = eventStore.instances;\r\n    var ranges = [];\r\n    for (var instanceId in instances) {\r\n        ranges.push(instances[instanceId].range);\r\n    }\r\n    return ranges;\r\n}\r\n// TODO: move to geom file?\r\nfunction anyRangesContainRange(outerRanges, innerRange) {\r\n    for (var _i = 0, outerRanges_1 = outerRanges; _i < outerRanges_1.length; _i++) {\r\n        var outerRange = outerRanges_1[_i];\r\n        if (rangeContainsRange(outerRange, innerRange)) {\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n}\r\n// Parsing\r\n// ------------------------------------------------------------------------------------------------------------------------\r\nfunction normalizeConstraint(input, calendar) {\r\n    if (Array.isArray(input)) {\r\n        return parseEvents(input, '', calendar, true); // allowOpenRange=true\r\n    }\r\n    else if (typeof input === 'object' && input) { // non-null object\r\n        return parseEvents([input], '', calendar, true); // allowOpenRange=true\r\n    }\r\n    else if (input != null) {\r\n        return String(input);\r\n    }\r\n    else {\r\n        return null;\r\n    }\r\n}\r\n\r\nfunction htmlEscape(s) {\r\n    return (s + '').replace(/&/g, '&amp;')\r\n        .replace(/</g, '&lt;')\r\n        .replace(/>/g, '&gt;')\r\n        .replace(/'/g, '&#039;')\r\n        .replace(/\"/g, '&quot;')\r\n        .replace(/\\n/g, '<br />');\r\n}\r\n// Given a hash of CSS properties, returns a string of CSS.\r\n// Uses property names as-is (no camel-case conversion). Will not make statements for null/undefined values.\r\nfunction cssToStr(cssProps) {\r\n    var statements = [];\r\n    for (var name_1 in cssProps) {\r\n        var val = cssProps[name_1];\r\n        if (val != null && val !== '') {\r\n            statements.push(name_1 + ':' + val);\r\n        }\r\n    }\r\n    return statements.join(';');\r\n}\r\n// Given an object hash of HTML attribute names to values,\r\n// generates a string that can be injected between < > in HTML\r\nfunction attrsToStr(attrs) {\r\n    var parts = [];\r\n    for (var name_2 in attrs) {\r\n        var val = attrs[name_2];\r\n        if (val != null) {\r\n            parts.push(name_2 + '=\"' + htmlEscape(val) + '\"');\r\n        }\r\n    }\r\n    return parts.join(' ');\r\n}\r\nfunction parseClassName(raw) {\r\n    if (Array.isArray(raw)) {\r\n        return raw;\r\n    }\r\n    else if (typeof raw === 'string') {\r\n        return raw.split(/\\s+/);\r\n    }\r\n    else {\r\n        return [];\r\n    }\r\n}\r\n\r\nvar UNSCOPED_EVENT_UI_PROPS = {\r\n    editable: Boolean,\r\n    startEditable: Boolean,\r\n    durationEditable: Boolean,\r\n    constraint: null,\r\n    overlap: null,\r\n    allow: null,\r\n    className: parseClassName,\r\n    classNames: parseClassName,\r\n    color: String,\r\n    backgroundColor: String,\r\n    borderColor: String,\r\n    textColor: String\r\n};\r\nfunction processUnscopedUiProps(rawProps, calendar, leftovers) {\r\n    var props = refineProps(rawProps, UNSCOPED_EVENT_UI_PROPS, {}, leftovers);\r\n    var constraint = normalizeConstraint(props.constraint, calendar);\r\n    return {\r\n        startEditable: props.startEditable != null ? props.startEditable : props.editable,\r\n        durationEditable: props.durationEditable != null ? props.durationEditable : props.editable,\r\n        constraints: constraint != null ? [constraint] : [],\r\n        overlap: props.overlap,\r\n        allows: props.allow != null ? [props.allow] : [],\r\n        backgroundColor: props.backgroundColor || props.color,\r\n        borderColor: props.borderColor || props.color,\r\n        textColor: props.textColor,\r\n        classNames: props.classNames.concat(props.className)\r\n    };\r\n}\r\nfunction processScopedUiProps(prefix, rawScoped, calendar, leftovers) {\r\n    var rawUnscoped = {};\r\n    var wasFound = {};\r\n    for (var key in UNSCOPED_EVENT_UI_PROPS) {\r\n        var scopedKey = prefix + capitaliseFirstLetter(key);\r\n        rawUnscoped[key] = rawScoped[scopedKey];\r\n        wasFound[scopedKey] = true;\r\n    }\r\n    if (prefix === 'event') {\r\n        rawUnscoped.editable = rawScoped.editable; // special case. there is no 'eventEditable', just 'editable'\r\n    }\r\n    if (leftovers) {\r\n        for (var key in rawScoped) {\r\n            if (!wasFound[key]) {\r\n                leftovers[key] = rawScoped[key];\r\n            }\r\n        }\r\n    }\r\n    return processUnscopedUiProps(rawUnscoped, calendar);\r\n}\r\nvar EMPTY_EVENT_UI = {\r\n    startEditable: null,\r\n    durationEditable: null,\r\n    constraints: [],\r\n    overlap: null,\r\n    allows: [],\r\n    backgroundColor: '',\r\n    borderColor: '',\r\n    textColor: '',\r\n    classNames: []\r\n};\r\n// prevent against problems with <2 args!\r\nfunction combineEventUis(uis) {\r\n    return uis.reduce(combineTwoEventUis, EMPTY_EVENT_UI);\r\n}\r\nfunction combineTwoEventUis(item0, item1) {\r\n    return {\r\n        startEditable: item1.startEditable != null ? item1.startEditable : item0.startEditable,\r\n        durationEditable: item1.durationEditable != null ? item1.durationEditable : item0.durationEditable,\r\n        constraints: item0.constraints.concat(item1.constraints),\r\n        overlap: typeof item1.overlap === 'boolean' ? item1.overlap : item0.overlap,\r\n        allows: item0.allows.concat(item1.allows),\r\n        backgroundColor: item1.backgroundColor || item0.backgroundColor,\r\n        borderColor: item1.borderColor || item0.borderColor,\r\n        textColor: item1.textColor || item0.textColor,\r\n        classNames: item0.classNames.concat(item1.classNames)\r\n    };\r\n}\r\n\r\nvar NON_DATE_PROPS = {\r\n    id: String,\r\n    groupId: String,\r\n    title: String,\r\n    url: String,\r\n    rendering: String,\r\n    extendedProps: null\r\n};\r\nvar DATE_PROPS = {\r\n    start: null,\r\n    date: null,\r\n    end: null,\r\n    allDay: null\r\n};\r\nvar uid = 0;\r\nfunction parseEvent(raw, sourceId, calendar, allowOpenRange) {\r\n    var allDayDefault = computeIsAllDayDefault(sourceId, calendar);\r\n    var leftovers0 = {};\r\n    var recurringRes = parseRecurring(raw, // raw, but with single-event stuff stripped out\r\n    allDayDefault, calendar.dateEnv, calendar.pluginSystem.hooks.recurringTypes, leftovers0 // will populate with non-recurring props\r\n    );\r\n    if (recurringRes) {\r\n        var def = parseEventDef(leftovers0, sourceId, recurringRes.allDay, Boolean(recurringRes.duration), calendar);\r\n        def.recurringDef = {\r\n            typeId: recurringRes.typeId,\r\n            typeData: recurringRes.typeData,\r\n            duration: recurringRes.duration\r\n        };\r\n        return { def: def, instance: null };\r\n    }\r\n    else {\r\n        var leftovers1 = {};\r\n        var singleRes = parseSingle(raw, allDayDefault, calendar, leftovers1, allowOpenRange);\r\n        if (singleRes) {\r\n            var def = parseEventDef(leftovers1, sourceId, singleRes.allDay, singleRes.hasEnd, calendar);\r\n            var instance = createEventInstance(def.defId, singleRes.range, singleRes.forcedStartTzo, singleRes.forcedEndTzo);\r\n            return { def: def, instance: instance };\r\n        }\r\n    }\r\n    return null;\r\n}\r\n/*\r\nWill NOT populate extendedProps with the leftover properties.\r\nWill NOT populate date-related props.\r\nThe EventNonDateInput has been normalized (id => publicId, etc).\r\n*/\r\nfunction parseEventDef(raw, sourceId, allDay, hasEnd, calendar) {\r\n    var leftovers = {};\r\n    var def = pluckNonDateProps(raw, calendar, leftovers);\r\n    def.defId = String(uid++);\r\n    def.sourceId = sourceId;\r\n    def.allDay = allDay;\r\n    def.hasEnd = hasEnd;\r\n    for (var _i = 0, _a = calendar.pluginSystem.hooks.eventDefParsers; _i < _a.length; _i++) {\r\n        var eventDefParser = _a[_i];\r\n        var newLeftovers = {};\r\n        eventDefParser(def, leftovers, newLeftovers);\r\n        leftovers = newLeftovers;\r\n    }\r\n    def.extendedProps = __assign(leftovers, def.extendedProps || {});\r\n    // help out EventApi from having user modify props\r\n    Object.freeze(def.ui.classNames);\r\n    Object.freeze(def.extendedProps);\r\n    return def;\r\n}\r\nfunction createEventInstance(defId, range, forcedStartTzo, forcedEndTzo) {\r\n    return {\r\n        instanceId: String(uid++),\r\n        defId: defId,\r\n        range: range,\r\n        forcedStartTzo: forcedStartTzo == null ? null : forcedStartTzo,\r\n        forcedEndTzo: forcedEndTzo == null ? null : forcedEndTzo\r\n    };\r\n}\r\nfunction parseSingle(raw, allDayDefault, calendar, leftovers, allowOpenRange) {\r\n    var props = pluckDateProps(raw, leftovers);\r\n    var allDay = props.allDay;\r\n    var startMeta;\r\n    var startMarker = null;\r\n    var hasEnd = false;\r\n    var endMeta;\r\n    var endMarker = null;\r\n    startMeta = calendar.dateEnv.createMarkerMeta(props.start);\r\n    if (startMeta) {\r\n        startMarker = startMeta.marker;\r\n    }\r\n    else if (!allowOpenRange) {\r\n        return null;\r\n    }\r\n    if (props.end != null) {\r\n        endMeta = calendar.dateEnv.createMarkerMeta(props.end);\r\n    }\r\n    if (allDay == null) {\r\n        if (allDayDefault != null) {\r\n            allDay = allDayDefault;\r\n        }\r\n        else {\r\n            // fall back to the date props LAST\r\n            allDay = (!startMeta || startMeta.isTimeUnspecified) &&\r\n                (!endMeta || endMeta.isTimeUnspecified);\r\n        }\r\n    }\r\n    if (allDay && startMarker) {\r\n        startMarker = startOfDay(startMarker);\r\n    }\r\n    if (endMeta) {\r\n        endMarker = endMeta.marker;\r\n        if (allDay) {\r\n            endMarker = startOfDay(endMarker);\r\n        }\r\n        if (startMarker && endMarker <= startMarker) {\r\n            endMarker = null;\r\n        }\r\n    }\r\n    if (endMarker) {\r\n        hasEnd = true;\r\n    }\r\n    else if (!allowOpenRange) {\r\n        hasEnd = calendar.opt('forceEventDuration') || false;\r\n        endMarker = calendar.dateEnv.add(startMarker, allDay ?\r\n            calendar.defaultAllDayEventDuration :\r\n            calendar.defaultTimedEventDuration);\r\n    }\r\n    return {\r\n        allDay: allDay,\r\n        hasEnd: hasEnd,\r\n        range: { start: startMarker, end: endMarker },\r\n        forcedStartTzo: startMeta ? startMeta.forcedTzo : null,\r\n        forcedEndTzo: endMeta ? endMeta.forcedTzo : null\r\n    };\r\n}\r\nfunction pluckDateProps(raw, leftovers) {\r\n    var props = refineProps(raw, DATE_PROPS, {}, leftovers);\r\n    props.start = (props.start !== null) ? props.start : props.date;\r\n    delete props.date;\r\n    return props;\r\n}\r\nfunction pluckNonDateProps(raw, calendar, leftovers) {\r\n    var preLeftovers = {};\r\n    var props = refineProps(raw, NON_DATE_PROPS, {}, preLeftovers);\r\n    var ui = processUnscopedUiProps(preLeftovers, calendar, leftovers);\r\n    props.publicId = props.id;\r\n    delete props.id;\r\n    props.ui = ui;\r\n    return props;\r\n}\r\nfunction computeIsAllDayDefault(sourceId, calendar) {\r\n    var res = null;\r\n    if (sourceId) {\r\n        var source = calendar.state.eventSources[sourceId];\r\n        res = source.allDayDefault;\r\n    }\r\n    if (res == null) {\r\n        res = calendar.opt('allDayDefault');\r\n    }\r\n    return res;\r\n}\r\n\r\nvar DEF_DEFAULTS = {\r\n    startTime: '09:00',\r\n    endTime: '17:00',\r\n    daysOfWeek: [1, 2, 3, 4, 5],\r\n    rendering: 'inverse-background',\r\n    classNames: 'fc-nonbusiness',\r\n    groupId: '_businessHours' // so multiple defs get grouped\r\n};\r\n/*\r\nTODO: pass around as EventDefHash!!!\r\n*/\r\nfunction parseBusinessHours(input, calendar) {\r\n    return parseEvents(refineInputs(input), '', calendar);\r\n}\r\nfunction refineInputs(input) {\r\n    var rawDefs;\r\n    if (input === true) {\r\n        rawDefs = [{}]; // will get DEF_DEFAULTS verbatim\r\n    }\r\n    else if (Array.isArray(input)) {\r\n        // if specifying an array, every sub-definition NEEDS a day-of-week\r\n        rawDefs = input.filter(function (rawDef) {\r\n            return rawDef.daysOfWeek;\r\n        });\r\n    }\r\n    else if (typeof input === 'object' && input) { // non-null object\r\n        rawDefs = [input];\r\n    }\r\n    else { // is probably false\r\n        rawDefs = [];\r\n    }\r\n    rawDefs = rawDefs.map(function (rawDef) {\r\n        return __assign({}, DEF_DEFAULTS, rawDef);\r\n    });\r\n    return rawDefs;\r\n}\r\n\r\nfunction memoizeRendering(renderFunc, unrenderFunc, dependencies) {\r\n    if (dependencies === void 0) { dependencies = []; }\r\n    var dependents = [];\r\n    var thisContext;\r\n    var prevArgs;\r\n    function unrender() {\r\n        if (prevArgs) {\r\n            for (var _i = 0, dependents_1 = dependents; _i < dependents_1.length; _i++) {\r\n                var dependent = dependents_1[_i];\r\n                dependent.unrender();\r\n            }\r\n            if (unrenderFunc) {\r\n                unrenderFunc.apply(thisContext, prevArgs);\r\n            }\r\n            prevArgs = null;\r\n        }\r\n    }\r\n    function res() {\r\n        if (!prevArgs || !isArraysEqual(prevArgs, arguments)) {\r\n            unrender();\r\n            thisContext = this;\r\n            prevArgs = arguments;\r\n            renderFunc.apply(this, arguments);\r\n        }\r\n    }\r\n    res.dependents = dependents;\r\n    res.unrender = unrender;\r\n    for (var _i = 0, dependencies_1 = dependencies; _i < dependencies_1.length; _i++) {\r\n        var dependency = dependencies_1[_i];\r\n        dependency.dependents.push(res);\r\n    }\r\n    return res;\r\n}\r\n\r\nvar EMPTY_EVENT_STORE = createEmptyEventStore(); // for purecomponents. TODO: keep elsewhere\r\nvar Splitter = /** @class */ (function () {\r\n    function Splitter() {\r\n        this.getKeysForEventDefs = memoize(this._getKeysForEventDefs);\r\n        this.splitDateSelection = memoize(this._splitDateSpan);\r\n        this.splitEventStore = memoize(this._splitEventStore);\r\n        this.splitIndividualUi = memoize(this._splitIndividualUi);\r\n        this.splitEventDrag = memoize(this._splitInteraction);\r\n        this.splitEventResize = memoize(this._splitInteraction);\r\n        this.eventUiBuilders = {}; // TODO: typescript protection\r\n    }\r\n    Splitter.prototype.splitProps = function (props) {\r\n        var _this = this;\r\n        var keyInfos = this.getKeyInfo(props);\r\n        var defKeys = this.getKeysForEventDefs(props.eventStore);\r\n        var dateSelections = this.splitDateSelection(props.dateSelection);\r\n        var individualUi = this.splitIndividualUi(props.eventUiBases, defKeys); // the individual *bases*\r\n        var eventStores = this.splitEventStore(props.eventStore, defKeys);\r\n        var eventDrags = this.splitEventDrag(props.eventDrag);\r\n        var eventResizes = this.splitEventResize(props.eventResize);\r\n        var splitProps = {};\r\n        this.eventUiBuilders = mapHash(keyInfos, function (info, key) {\r\n            return _this.eventUiBuilders[key] || memoize(buildEventUiForKey);\r\n        });\r\n        for (var key in keyInfos) {\r\n            var keyInfo = keyInfos[key];\r\n            var eventStore = eventStores[key] || EMPTY_EVENT_STORE;\r\n            var buildEventUi = this.eventUiBuilders[key];\r\n            splitProps[key] = {\r\n                businessHours: keyInfo.businessHours || props.businessHours,\r\n                dateSelection: dateSelections[key] || null,\r\n                eventStore: eventStore,\r\n                eventUiBases: buildEventUi(props.eventUiBases[''], keyInfo.ui, individualUi[key]),\r\n                eventSelection: eventStore.instances[props.eventSelection] ? props.eventSelection : '',\r\n                eventDrag: eventDrags[key] || null,\r\n                eventResize: eventResizes[key] || null\r\n            };\r\n        }\r\n        return splitProps;\r\n    };\r\n    Splitter.prototype._splitDateSpan = function (dateSpan) {\r\n        var dateSpans = {};\r\n        if (dateSpan) {\r\n            var keys = this.getKeysForDateSpan(dateSpan);\r\n            for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {\r\n                var key = keys_1[_i];\r\n                dateSpans[key] = dateSpan;\r\n            }\r\n        }\r\n        return dateSpans;\r\n    };\r\n    Splitter.prototype._getKeysForEventDefs = function (eventStore) {\r\n        var _this = this;\r\n        return mapHash(eventStore.defs, function (eventDef) {\r\n            return _this.getKeysForEventDef(eventDef);\r\n        });\r\n    };\r\n    Splitter.prototype._splitEventStore = function (eventStore, defKeys) {\r\n        var defs = eventStore.defs, instances = eventStore.instances;\r\n        var splitStores = {};\r\n        for (var defId in defs) {\r\n            for (var _i = 0, _a = defKeys[defId]; _i < _a.length; _i++) {\r\n                var key = _a[_i];\r\n                if (!splitStores[key]) {\r\n                    splitStores[key] = createEmptyEventStore();\r\n                }\r\n                splitStores[key].defs[defId] = defs[defId];\r\n            }\r\n        }\r\n        for (var instanceId in instances) {\r\n            var instance = instances[instanceId];\r\n            for (var _b = 0, _c = defKeys[instance.defId]; _b < _c.length; _b++) {\r\n                var key = _c[_b];\r\n                if (splitStores[key]) { // must have already been created\r\n                    splitStores[key].instances[instanceId] = instance;\r\n                }\r\n            }\r\n        }\r\n        return splitStores;\r\n    };\r\n    Splitter.prototype._splitIndividualUi = function (eventUiBases, defKeys) {\r\n        var splitHashes = {};\r\n        for (var defId in eventUiBases) {\r\n            if (defId) { // not the '' key\r\n                for (var _i = 0, _a = defKeys[defId]; _i < _a.length; _i++) {\r\n                    var key = _a[_i];\r\n                    if (!splitHashes[key]) {\r\n                        splitHashes[key] = {};\r\n                    }\r\n                    splitHashes[key][defId] = eventUiBases[defId];\r\n                }\r\n            }\r\n        }\r\n        return splitHashes;\r\n    };\r\n    Splitter.prototype._splitInteraction = function (interaction) {\r\n        var splitStates = {};\r\n        if (interaction) {\r\n            var affectedStores_1 = this._splitEventStore(interaction.affectedEvents, this._getKeysForEventDefs(interaction.affectedEvents) // can't use cached. might be events from other calendar\r\n            );\r\n            // can't rely on defKeys because event data is mutated\r\n            var mutatedKeysByDefId = this._getKeysForEventDefs(interaction.mutatedEvents);\r\n            var mutatedStores_1 = this._splitEventStore(interaction.mutatedEvents, mutatedKeysByDefId);\r\n            var populate = function (key) {\r\n                if (!splitStates[key]) {\r\n                    splitStates[key] = {\r\n                        affectedEvents: affectedStores_1[key] || EMPTY_EVENT_STORE,\r\n                        mutatedEvents: mutatedStores_1[key] || EMPTY_EVENT_STORE,\r\n                        isEvent: interaction.isEvent,\r\n                        origSeg: interaction.origSeg\r\n                    };\r\n                }\r\n            };\r\n            for (var key in affectedStores_1) {\r\n                populate(key);\r\n            }\r\n            for (var key in mutatedStores_1) {\r\n                populate(key);\r\n            }\r\n        }\r\n        return splitStates;\r\n    };\r\n    return Splitter;\r\n}());\r\nfunction buildEventUiForKey(allUi, eventUiForKey, individualUi) {\r\n    var baseParts = [];\r\n    if (allUi) {\r\n        baseParts.push(allUi);\r\n    }\r\n    if (eventUiForKey) {\r\n        baseParts.push(eventUiForKey);\r\n    }\r\n    var stuff = {\r\n        '': combineEventUis(baseParts)\r\n    };\r\n    if (individualUi) {\r\n        __assign(stuff, individualUi);\r\n    }\r\n    return stuff;\r\n}\r\n\r\n// Generates HTML for an anchor to another view into the calendar.\r\n// Will either generate an <a> tag or a non-clickable <span> tag, depending on enabled settings.\r\n// `gotoOptions` can either be a DateMarker, or an object with the form:\r\n// { date, type, forceOff }\r\n// `type` is a view-type like \"day\" or \"week\". default value is \"day\".\r\n// `attrs` and `innerHtml` are use to generate the rest of the HTML tag.\r\nfunction buildGotoAnchorHtml(component, gotoOptions, attrs, innerHtml) {\r\n    var dateEnv = component.dateEnv;\r\n    var date;\r\n    var type;\r\n    var forceOff;\r\n    var finalOptions;\r\n    if (gotoOptions instanceof Date) {\r\n        date = gotoOptions; // a single date-like input\r\n    }\r\n    else {\r\n        date = gotoOptions.date;\r\n        type = gotoOptions.type;\r\n        forceOff = gotoOptions.forceOff;\r\n    }\r\n    finalOptions = {\r\n        date: dateEnv.formatIso(date, { omitTime: true }),\r\n        type: type || 'day'\r\n    };\r\n    if (typeof attrs === 'string') {\r\n        innerHtml = attrs;\r\n        attrs = null;\r\n    }\r\n    attrs = attrs ? ' ' + attrsToStr(attrs) : ''; // will have a leading space\r\n    innerHtml = innerHtml || '';\r\n    if (!forceOff && component.opt('navLinks')) {\r\n        return '<a' + attrs +\r\n            ' data-goto=\"' + htmlEscape(JSON.stringify(finalOptions)) + '\">' +\r\n            innerHtml +\r\n            '</a>';\r\n    }\r\n    else {\r\n        return '<span' + attrs + '>' +\r\n            innerHtml +\r\n            '</span>';\r\n    }\r\n}\r\nfunction getAllDayHtml(component) {\r\n    return component.opt('allDayHtml') || htmlEscape(component.opt('allDayText'));\r\n}\r\n// Computes HTML classNames for a single-day element\r\nfunction getDayClasses(date, dateProfile, context, noThemeHighlight) {\r\n    var calendar = context.calendar, view = context.view, theme = context.theme, dateEnv = context.dateEnv;\r\n    var classes = [];\r\n    var todayStart;\r\n    var todayEnd;\r\n    if (!rangeContainsMarker(dateProfile.activeRange, date)) {\r\n        classes.push('fc-disabled-day');\r\n    }\r\n    else {\r\n        classes.push('fc-' + DAY_IDS[date.getUTCDay()]);\r\n        if (view.opt('monthMode') &&\r\n            dateEnv.getMonth(date) !== dateEnv.getMonth(dateProfile.currentRange.start)) {\r\n            classes.push('fc-other-month');\r\n        }\r\n        todayStart = startOfDay(calendar.getNow());\r\n        todayEnd = addDays(todayStart, 1);\r\n        if (date < todayStart) {\r\n            classes.push('fc-past');\r\n        }\r\n        else if (date >= todayEnd) {\r\n            classes.push('fc-future');\r\n        }\r\n        else {\r\n            classes.push('fc-today');\r\n            if (noThemeHighlight !== true) {\r\n                classes.push(theme.getClass('today'));\r\n            }\r\n        }\r\n    }\r\n    return classes;\r\n}\r\n\r\n// given a function that resolves a result asynchronously.\r\n// the function can either call passed-in success and failure callbacks,\r\n// or it can return a promise.\r\n// if you need to pass additional params to func, bind them first.\r\nfunction unpromisify(func, success, failure) {\r\n    // guard against success/failure callbacks being called more than once\r\n    // and guard against a promise AND callback being used together.\r\n    var isResolved = false;\r\n    var wrappedSuccess = function () {\r\n        if (!isResolved) {\r\n            isResolved = true;\r\n            success.apply(this, arguments);\r\n        }\r\n    };\r\n    var wrappedFailure = function () {\r\n        if (!isResolved) {\r\n            isResolved = true;\r\n            if (failure) {\r\n                failure.apply(this, arguments);\r\n            }\r\n        }\r\n    };\r\n    var res = func(wrappedSuccess, wrappedFailure);\r\n    if (res && typeof res.then === 'function') {\r\n        res.then(wrappedSuccess, wrappedFailure);\r\n    }\r\n}\r\n\r\nvar Mixin = /** @class */ (function () {\r\n    function Mixin() {\r\n    }\r\n    // mix into a CLASS\r\n    Mixin.mixInto = function (destClass) {\r\n        this.mixIntoObj(destClass.prototype);\r\n    };\r\n    // mix into ANY object\r\n    Mixin.mixIntoObj = function (destObj) {\r\n        var _this = this;\r\n        Object.getOwnPropertyNames(this.prototype).forEach(function (name) {\r\n            if (!destObj[name]) { // if destination doesn't already define it\r\n                destObj[name] = _this.prototype[name];\r\n            }\r\n        });\r\n    };\r\n    /*\r\n    will override existing methods\r\n    TODO: remove! not used anymore\r\n    */\r\n    Mixin.mixOver = function (destClass) {\r\n        var _this = this;\r\n        Object.getOwnPropertyNames(this.prototype).forEach(function (name) {\r\n            destClass.prototype[name] = _this.prototype[name];\r\n        });\r\n    };\r\n    return Mixin;\r\n}());\r\n\r\n/*\r\nUSAGE:\r\n  import { default as EmitterMixin, EmitterInterface } from './EmitterMixin'\r\nin class:\r\n  on: EmitterInterface['on']\r\n  one: EmitterInterface['one']\r\n  off: EmitterInterface['off']\r\n  trigger: EmitterInterface['trigger']\r\n  triggerWith: EmitterInterface['triggerWith']\r\n  hasHandlers: EmitterInterface['hasHandlers']\r\nafter class:\r\n  EmitterMixin.mixInto(TheClass)\r\n*/\r\nvar EmitterMixin = /** @class */ (function (_super) {\r\n    __extends(EmitterMixin, _super);\r\n    function EmitterMixin() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    EmitterMixin.prototype.on = function (type, handler) {\r\n        addToHash(this._handlers || (this._handlers = {}), type, handler);\r\n        return this; // for chaining\r\n    };\r\n    // todo: add comments\r\n    EmitterMixin.prototype.one = function (type, handler) {\r\n        addToHash(this._oneHandlers || (this._oneHandlers = {}), type, handler);\r\n        return this; // for chaining\r\n    };\r\n    EmitterMixin.prototype.off = function (type, handler) {\r\n        if (this._handlers) {\r\n            removeFromHash(this._handlers, type, handler);\r\n        }\r\n        if (this._oneHandlers) {\r\n            removeFromHash(this._oneHandlers, type, handler);\r\n        }\r\n        return this; // for chaining\r\n    };\r\n    EmitterMixin.prototype.trigger = function (type) {\r\n        var args = [];\r\n        for (var _i = 1; _i < arguments.length; _i++) {\r\n            args[_i - 1] = arguments[_i];\r\n        }\r\n        this.triggerWith(type, this, args);\r\n        return this; // for chaining\r\n    };\r\n    EmitterMixin.prototype.triggerWith = function (type, context, args) {\r\n        if (this._handlers) {\r\n            applyAll(this._handlers[type], context, args);\r\n        }\r\n        if (this._oneHandlers) {\r\n            applyAll(this._oneHandlers[type], context, args);\r\n            delete this._oneHandlers[type]; // will never fire again\r\n        }\r\n        return this; // for chaining\r\n    };\r\n    EmitterMixin.prototype.hasHandlers = function (type) {\r\n        return (this._handlers && this._handlers[type] && this._handlers[type].length) ||\r\n            (this._oneHandlers && this._oneHandlers[type] && this._oneHandlers[type].length);\r\n    };\r\n    return EmitterMixin;\r\n}(Mixin));\r\nfunction addToHash(hash, type, handler) {\r\n    (hash[type] || (hash[type] = []))\r\n        .push(handler);\r\n}\r\nfunction removeFromHash(hash, type, handler) {\r\n    if (handler) {\r\n        if (hash[type]) {\r\n            hash[type] = hash[type].filter(function (func) {\r\n                return func !== handler;\r\n            });\r\n        }\r\n    }\r\n    else {\r\n        delete hash[type]; // remove all handler funcs for this type\r\n    }\r\n}\r\n\r\n/*\r\nRecords offset information for a set of elements, relative to an origin element.\r\nCan record the left/right OR the top/bottom OR both.\r\nProvides methods for querying the cache by position.\r\n*/\r\nvar PositionCache = /** @class */ (function () {\r\n    function PositionCache(originEl, els, isHorizontal, isVertical) {\r\n        this.originEl = originEl;\r\n        this.els = els;\r\n        this.isHorizontal = isHorizontal;\r\n        this.isVertical = isVertical;\r\n    }\r\n    // Queries the els for coordinates and stores them.\r\n    // Call this method before using and of the get* methods below.\r\n    PositionCache.prototype.build = function () {\r\n        var originEl = this.originEl;\r\n        var originClientRect = this.originClientRect =\r\n            originEl.getBoundingClientRect(); // relative to viewport top-left\r\n        if (this.isHorizontal) {\r\n            this.buildElHorizontals(originClientRect.left);\r\n        }\r\n        if (this.isVertical) {\r\n            this.buildElVerticals(originClientRect.top);\r\n        }\r\n    };\r\n    // Populates the left/right internal coordinate arrays\r\n    PositionCache.prototype.buildElHorizontals = function (originClientLeft) {\r\n        var lefts = [];\r\n        var rights = [];\r\n        for (var _i = 0, _a = this.els; _i < _a.length; _i++) {\r\n            var el = _a[_i];\r\n            var rect = el.getBoundingClientRect();\r\n            lefts.push(rect.left - originClientLeft);\r\n            rights.push(rect.right - originClientLeft);\r\n        }\r\n        this.lefts = lefts;\r\n        this.rights = rights;\r\n    };\r\n    // Populates the top/bottom internal coordinate arrays\r\n    PositionCache.prototype.buildElVerticals = function (originClientTop) {\r\n        var tops = [];\r\n        var bottoms = [];\r\n        for (var _i = 0, _a = this.els; _i < _a.length; _i++) {\r\n            var el = _a[_i];\r\n            var rect = el.getBoundingClientRect();\r\n            tops.push(rect.top - originClientTop);\r\n            bottoms.push(rect.bottom - originClientTop);\r\n        }\r\n        this.tops = tops;\r\n        this.bottoms = bottoms;\r\n    };\r\n    // Given a left offset (from document left), returns the index of the el that it horizontally intersects.\r\n    // If no intersection is made, returns undefined.\r\n    PositionCache.prototype.leftToIndex = function (leftPosition) {\r\n        var lefts = this.lefts;\r\n        var rights = this.rights;\r\n        var len = lefts.length;\r\n        var i;\r\n        for (i = 0; i < len; i++) {\r\n            if (leftPosition >= lefts[i] && leftPosition < rights[i]) {\r\n                return i;\r\n            }\r\n        }\r\n    };\r\n    // Given a top offset (from document top), returns the index of the el that it vertically intersects.\r\n    // If no intersection is made, returns undefined.\r\n    PositionCache.prototype.topToIndex = function (topPosition) {\r\n        var tops = this.tops;\r\n        var bottoms = this.bottoms;\r\n        var len = tops.length;\r\n        var i;\r\n        for (i = 0; i < len; i++) {\r\n            if (topPosition >= tops[i] && topPosition < bottoms[i]) {\r\n                return i;\r\n            }\r\n        }\r\n    };\r\n    // Gets the width of the element at the given index\r\n    PositionCache.prototype.getWidth = function (leftIndex) {\r\n        return this.rights[leftIndex] - this.lefts[leftIndex];\r\n    };\r\n    // Gets the height of the element at the given index\r\n    PositionCache.prototype.getHeight = function (topIndex) {\r\n        return this.bottoms[topIndex] - this.tops[topIndex];\r\n    };\r\n    return PositionCache;\r\n}());\r\n\r\n/*\r\nAn object for getting/setting scroll-related information for an element.\r\nInternally, this is done very differently for window versus DOM element,\r\nso this object serves as a common interface.\r\n*/\r\nvar ScrollController = /** @class */ (function () {\r\n    function ScrollController() {\r\n    }\r\n    ScrollController.prototype.getMaxScrollTop = function () {\r\n        return this.getScrollHeight() - this.getClientHeight();\r\n    };\r\n    ScrollController.prototype.getMaxScrollLeft = function () {\r\n        return this.getScrollWidth() - this.getClientWidth();\r\n    };\r\n    ScrollController.prototype.canScrollVertically = function () {\r\n        return this.getMaxScrollTop() > 0;\r\n    };\r\n    ScrollController.prototype.canScrollHorizontally = function () {\r\n        return this.getMaxScrollLeft() > 0;\r\n    };\r\n    ScrollController.prototype.canScrollUp = function () {\r\n        return this.getScrollTop() > 0;\r\n    };\r\n    ScrollController.prototype.canScrollDown = function () {\r\n        return this.getScrollTop() < this.getMaxScrollTop();\r\n    };\r\n    ScrollController.prototype.canScrollLeft = function () {\r\n        return this.getScrollLeft() > 0;\r\n    };\r\n    ScrollController.prototype.canScrollRight = function () {\r\n        return this.getScrollLeft() < this.getMaxScrollLeft();\r\n    };\r\n    return ScrollController;\r\n}());\r\nvar ElementScrollController = /** @class */ (function (_super) {\r\n    __extends(ElementScrollController, _super);\r\n    function ElementScrollController(el) {\r\n        var _this = _super.call(this) || this;\r\n        _this.el = el;\r\n        return _this;\r\n    }\r\n    ElementScrollController.prototype.getScrollTop = function () {\r\n        return this.el.scrollTop;\r\n    };\r\n    ElementScrollController.prototype.getScrollLeft = function () {\r\n        return this.el.scrollLeft;\r\n    };\r\n    ElementScrollController.prototype.setScrollTop = function (top) {\r\n        this.el.scrollTop = top;\r\n    };\r\n    ElementScrollController.prototype.setScrollLeft = function (left) {\r\n        this.el.scrollLeft = left;\r\n    };\r\n    ElementScrollController.prototype.getScrollWidth = function () {\r\n        return this.el.scrollWidth;\r\n    };\r\n    ElementScrollController.prototype.getScrollHeight = function () {\r\n        return this.el.scrollHeight;\r\n    };\r\n    ElementScrollController.prototype.getClientHeight = function () {\r\n        return this.el.clientHeight;\r\n    };\r\n    ElementScrollController.prototype.getClientWidth = function () {\r\n        return this.el.clientWidth;\r\n    };\r\n    return ElementScrollController;\r\n}(ScrollController));\r\nvar WindowScrollController = /** @class */ (function (_super) {\r\n    __extends(WindowScrollController, _super);\r\n    function WindowScrollController() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    WindowScrollController.prototype.getScrollTop = function () {\r\n        return window.pageYOffset;\r\n    };\r\n    WindowScrollController.prototype.getScrollLeft = function () {\r\n        return window.pageXOffset;\r\n    };\r\n    WindowScrollController.prototype.setScrollTop = function (n) {\r\n        window.scroll(window.pageXOffset, n);\r\n    };\r\n    WindowScrollController.prototype.setScrollLeft = function (n) {\r\n        window.scroll(n, window.pageYOffset);\r\n    };\r\n    WindowScrollController.prototype.getScrollWidth = function () {\r\n        return document.documentElement.scrollWidth;\r\n    };\r\n    WindowScrollController.prototype.getScrollHeight = function () {\r\n        return document.documentElement.scrollHeight;\r\n    };\r\n    WindowScrollController.prototype.getClientHeight = function () {\r\n        return document.documentElement.clientHeight;\r\n    };\r\n    WindowScrollController.prototype.getClientWidth = function () {\r\n        return document.documentElement.clientWidth;\r\n    };\r\n    return WindowScrollController;\r\n}(ScrollController));\r\n\r\n/*\r\nEmbodies a div that has potential scrollbars\r\n*/\r\nvar ScrollComponent = /** @class */ (function (_super) {\r\n    __extends(ScrollComponent, _super);\r\n    function ScrollComponent(overflowX, overflowY) {\r\n        var _this = _super.call(this, createElement('div', {\r\n            className: 'fc-scroller'\r\n        })) || this;\r\n        _this.overflowX = overflowX;\r\n        _this.overflowY = overflowY;\r\n        _this.applyOverflow();\r\n        return _this;\r\n    }\r\n    // sets to natural height, unlocks overflow\r\n    ScrollComponent.prototype.clear = function () {\r\n        this.setHeight('auto');\r\n        this.applyOverflow();\r\n    };\r\n    ScrollComponent.prototype.destroy = function () {\r\n        removeElement(this.el);\r\n    };\r\n    // Overflow\r\n    // -----------------------------------------------------------------------------------------------------------------\r\n    ScrollComponent.prototype.applyOverflow = function () {\r\n        applyStyle(this.el, {\r\n            overflowX: this.overflowX,\r\n            overflowY: this.overflowY\r\n        });\r\n    };\r\n    // Causes any 'auto' overflow values to resolves to 'scroll' or 'hidden'.\r\n    // Useful for preserving scrollbar widths regardless of future resizes.\r\n    // Can pass in scrollbarWidths for optimization.\r\n    ScrollComponent.prototype.lockOverflow = function (scrollbarWidths) {\r\n        var overflowX = this.overflowX;\r\n        var overflowY = this.overflowY;\r\n        scrollbarWidths = scrollbarWidths || this.getScrollbarWidths();\r\n        if (overflowX === 'auto') {\r\n            overflowX = (scrollbarWidths.bottom || // horizontal scrollbars?\r\n                this.canScrollHorizontally() // OR scrolling pane with massless scrollbars?\r\n            ) ? 'scroll' : 'hidden';\r\n        }\r\n        if (overflowY === 'auto') {\r\n            overflowY = (scrollbarWidths.left || scrollbarWidths.right || // horizontal scrollbars?\r\n                this.canScrollVertically() // OR scrolling pane with massless scrollbars?\r\n            ) ? 'scroll' : 'hidden';\r\n        }\r\n        applyStyle(this.el, { overflowX: overflowX, overflowY: overflowY });\r\n    };\r\n    ScrollComponent.prototype.setHeight = function (height) {\r\n        applyStyleProp(this.el, 'height', height);\r\n    };\r\n    ScrollComponent.prototype.getScrollbarWidths = function () {\r\n        var edges = computeEdges(this.el);\r\n        return {\r\n            left: edges.scrollbarLeft,\r\n            right: edges.scrollbarRight,\r\n            bottom: edges.scrollbarBottom\r\n        };\r\n    };\r\n    return ScrollComponent;\r\n}(ElementScrollController));\r\n\r\nvar Theme = /** @class */ (function () {\r\n    function Theme(calendarOptions) {\r\n        this.calendarOptions = calendarOptions;\r\n        this.processIconOverride();\r\n    }\r\n    Theme.prototype.processIconOverride = function () {\r\n        if (this.iconOverrideOption) {\r\n            this.setIconOverride(this.calendarOptions[this.iconOverrideOption]);\r\n        }\r\n    };\r\n    Theme.prototype.setIconOverride = function (iconOverrideHash) {\r\n        var iconClassesCopy;\r\n        var buttonName;\r\n        if (typeof iconOverrideHash === 'object' && iconOverrideHash) { // non-null object\r\n            iconClassesCopy = __assign({}, this.iconClasses);\r\n            for (buttonName in iconOverrideHash) {\r\n                iconClassesCopy[buttonName] = this.applyIconOverridePrefix(iconOverrideHash[buttonName]);\r\n            }\r\n            this.iconClasses = iconClassesCopy;\r\n        }\r\n        else if (iconOverrideHash === false) {\r\n            this.iconClasses = {};\r\n        }\r\n    };\r\n    Theme.prototype.applyIconOverridePrefix = function (className) {\r\n        var prefix = this.iconOverridePrefix;\r\n        if (prefix && className.indexOf(prefix) !== 0) { // if not already present\r\n            className = prefix + className;\r\n        }\r\n        return className;\r\n    };\r\n    Theme.prototype.getClass = function (key) {\r\n        return this.classes[key] || '';\r\n    };\r\n    Theme.prototype.getIconClass = function (buttonName) {\r\n        var className = this.iconClasses[buttonName];\r\n        if (className) {\r\n            return this.baseIconClass + ' ' + className;\r\n        }\r\n        return '';\r\n    };\r\n    Theme.prototype.getCustomButtonIconClass = function (customButtonProps) {\r\n        var className;\r\n        if (this.iconOverrideCustomButtonOption) {\r\n            className = customButtonProps[this.iconOverrideCustomButtonOption];\r\n            if (className) {\r\n                return this.baseIconClass + ' ' + this.applyIconOverridePrefix(className);\r\n            }\r\n        }\r\n        return '';\r\n    };\r\n    return Theme;\r\n}());\r\nTheme.prototype.classes = {};\r\nTheme.prototype.iconClasses = {};\r\nTheme.prototype.baseIconClass = '';\r\nTheme.prototype.iconOverridePrefix = '';\r\n\r\nvar guid = 0;\r\nvar Component = /** @class */ (function () {\r\n    function Component(context, isView) {\r\n        // HACK to populate view at top of component instantiation call chain\r\n        if (isView) {\r\n            context.view = this;\r\n        }\r\n        this.uid = String(guid++);\r\n        this.context = context;\r\n        this.dateEnv = context.dateEnv;\r\n        this.theme = context.theme;\r\n        this.view = context.view;\r\n        this.calendar = context.calendar;\r\n        this.isRtl = this.opt('dir') === 'rtl';\r\n    }\r\n    Component.addEqualityFuncs = function (newFuncs) {\r\n        this.prototype.equalityFuncs = __assign({}, this.prototype.equalityFuncs, newFuncs);\r\n    };\r\n    Component.prototype.opt = function (name) {\r\n        return this.context.options[name];\r\n    };\r\n    Component.prototype.receiveProps = function (props) {\r\n        var _a = recycleProps(this.props || {}, props, this.equalityFuncs), anyChanges = _a.anyChanges, comboProps = _a.comboProps;\r\n        this.props = comboProps;\r\n        if (anyChanges) {\r\n            this.render(comboProps);\r\n        }\r\n    };\r\n    Component.prototype.render = function (props) {\r\n    };\r\n    // after destroy is called, this component won't ever be used again\r\n    Component.prototype.destroy = function () {\r\n    };\r\n    return Component;\r\n}());\r\nComponent.prototype.equalityFuncs = {};\r\n/*\r\nReuses old values when equal. If anything is unequal, returns newProps as-is.\r\nGreat for PureComponent, but won't be feasible with React, so just eliminate and use React's DOM diffing.\r\n*/\r\nfunction recycleProps(oldProps, newProps, equalityFuncs) {\r\n    var comboProps = {}; // some old, some new\r\n    var anyChanges = false;\r\n    for (var key in newProps) {\r\n        if (key in oldProps && (oldProps[key] === newProps[key] ||\r\n            (equalityFuncs[key] && equalityFuncs[key](oldProps[key], newProps[key])))) {\r\n            // equal to old? use old prop\r\n            comboProps[key] = oldProps[key];\r\n        }\r\n        else {\r\n            comboProps[key] = newProps[key];\r\n            anyChanges = true;\r\n        }\r\n    }\r\n    for (var key in oldProps) {\r\n        if (!(key in newProps)) {\r\n            anyChanges = true;\r\n            break;\r\n        }\r\n    }\r\n    return { anyChanges: anyChanges, comboProps: comboProps };\r\n}\r\n\r\n/*\r\nPURPOSES:\r\n- hook up to fg, fill, and mirror renderers\r\n- interface for dragging and hits\r\n*/\r\nvar DateComponent = /** @class */ (function (_super) {\r\n    __extends(DateComponent, _super);\r\n    function DateComponent(context, el, isView) {\r\n        var _this = _super.call(this, context, isView) || this;\r\n        _this.el = el;\r\n        return _this;\r\n    }\r\n    DateComponent.prototype.destroy = function () {\r\n        _super.prototype.destroy.call(this);\r\n        removeElement(this.el);\r\n    };\r\n    // TODO: WHAT ABOUT (sourceSeg && sourceSeg.component.doesDragMirror)\r\n    //\r\n    // Event Drag-n-Drop Rendering (for both events and external elements)\r\n    // ---------------------------------------------------------------------------------------------------------------\r\n    /*\r\n    renderEventDragSegs(state: EventSegUiInteractionState) {\r\n      if (state) {\r\n        let { isEvent, segs, sourceSeg } = state\r\n  \r\n        if (this.eventRenderer) {\r\n          this.eventRenderer.hideByHash(state.affectedInstances)\r\n        }\r\n  \r\n        // if the user is dragging something that is considered an event with real event data,\r\n        // and this component likes to do drag mirrors OR the component where the seg came from\r\n        // likes to do drag mirrors, then render a drag mirror.\r\n        if (isEvent && (this.doesDragMirror || sourceSeg && sourceSeg.component.doesDragMirror)) {\r\n          if (this.mirrorRenderer) {\r\n            this.mirrorRenderer.renderSegs(segs, { isDragging: true, sourceSeg })\r\n          }\r\n        }\r\n  \r\n        // if it would be impossible to render a drag mirror OR this component likes to render\r\n        // highlights, then render a highlight.\r\n        if (!isEvent || this.doesDragHighlight) {\r\n          if (this.fillRenderer) {\r\n            this.fillRenderer.renderSegs('highlight', segs)\r\n          }\r\n        }\r\n      }\r\n    }\r\n    */\r\n    // Hit System\r\n    // -----------------------------------------------------------------------------------------------------------------\r\n    DateComponent.prototype.buildPositionCaches = function () {\r\n    };\r\n    DateComponent.prototype.queryHit = function (positionLeft, positionTop, elWidth, elHeight) {\r\n        return null; // this should be abstract\r\n    };\r\n    // Validation\r\n    // -----------------------------------------------------------------------------------------------------------------\r\n    DateComponent.prototype.isInteractionValid = function (interaction) {\r\n        var calendar = this.calendar;\r\n        var dateProfile = this.props.dateProfile; // HACK\r\n        var instances = interaction.mutatedEvents.instances;\r\n        if (dateProfile) { // HACK for DayTile\r\n            for (var instanceId in instances) {\r\n                if (!rangeContainsRange(dateProfile.validRange, instances[instanceId].range)) {\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n        return isInteractionValid(interaction, calendar);\r\n    };\r\n    DateComponent.prototype.isDateSelectionValid = function (selection) {\r\n        var dateProfile = this.props.dateProfile; // HACK\r\n        if (dateProfile && // HACK for DayTile\r\n            !rangeContainsRange(dateProfile.validRange, selection.range)) {\r\n            return false;\r\n        }\r\n        return isDateSelectionValid(selection, this.calendar);\r\n    };\r\n    // Triggering\r\n    // -----------------------------------------------------------------------------------------------------------------\r\n    // TODO: move to Calendar\r\n    DateComponent.prototype.publiclyTrigger = function (name, args) {\r\n        var calendar = this.calendar;\r\n        return calendar.publiclyTrigger(name, args);\r\n    };\r\n    DateComponent.prototype.publiclyTriggerAfterSizing = function (name, args) {\r\n        var calendar = this.calendar;\r\n        return calendar.publiclyTriggerAfterSizing(name, args);\r\n    };\r\n    DateComponent.prototype.hasPublicHandlers = function (name) {\r\n        var calendar = this.calendar;\r\n        return calendar.hasPublicHandlers(name);\r\n    };\r\n    DateComponent.prototype.triggerRenderedSegs = function (segs, isMirrors) {\r\n        var calendar = this.calendar;\r\n        if (this.hasPublicHandlers('eventPositioned')) {\r\n            for (var _i = 0, segs_1 = segs; _i < segs_1.length; _i++) {\r\n                var seg = segs_1[_i];\r\n                this.publiclyTriggerAfterSizing('eventPositioned', [\r\n                    {\r\n                        event: new EventApi(calendar, seg.eventRange.def, seg.eventRange.instance),\r\n                        isMirror: isMirrors,\r\n                        isStart: seg.isStart,\r\n                        isEnd: seg.isEnd,\r\n                        el: seg.el,\r\n                        view: this // safe to cast because this method is only called on context.view\r\n                    }\r\n                ]);\r\n            }\r\n        }\r\n        if (!calendar.state.loadingLevel) { // avoid initial empty state while pending\r\n            calendar.afterSizingTriggers._eventsPositioned = [null]; // fire once\r\n        }\r\n    };\r\n    DateComponent.prototype.triggerWillRemoveSegs = function (segs, isMirrors) {\r\n        var calendar = this.calendar;\r\n        for (var _i = 0, segs_2 = segs; _i < segs_2.length; _i++) {\r\n            var seg = segs_2[_i];\r\n            calendar.trigger('eventElRemove', seg.el);\r\n        }\r\n        if (this.hasPublicHandlers('eventDestroy')) {\r\n            for (var _a = 0, segs_3 = segs; _a < segs_3.length; _a++) {\r\n                var seg = segs_3[_a];\r\n                this.publiclyTrigger('eventDestroy', [\r\n                    {\r\n                        event: new EventApi(calendar, seg.eventRange.def, seg.eventRange.instance),\r\n                        isMirror: isMirrors,\r\n                        el: seg.el,\r\n                        view: this // safe to cast because this method is only called on context.view\r\n                    }\r\n                ]);\r\n            }\r\n        }\r\n    };\r\n    // Pointer Interaction Utils\r\n    // -----------------------------------------------------------------------------------------------------------------\r\n    DateComponent.prototype.isValidSegDownEl = function (el) {\r\n        return !this.props.eventDrag && // HACK\r\n            !this.props.eventResize && // HACK\r\n            !elementClosest(el, '.fc-mirror') &&\r\n            (this.isPopover() || !this.isInPopover(el));\r\n        // ^above line ensures we don't detect a seg interaction within a nested component.\r\n        // it's a HACK because it only supports a popover as the nested component.\r\n    };\r\n    DateComponent.prototype.isValidDateDownEl = function (el) {\r\n        var segEl = elementClosest(el, this.fgSegSelector);\r\n        return (!segEl || segEl.classList.contains('fc-mirror')) &&\r\n            !elementClosest(el, '.fc-more') && // a \"more..\" link\r\n            !elementClosest(el, 'a[data-goto]') && // a clickable nav link\r\n            !this.isInPopover(el);\r\n    };\r\n    DateComponent.prototype.isPopover = function () {\r\n        return this.el.classList.contains('fc-popover');\r\n    };\r\n    DateComponent.prototype.isInPopover = function (el) {\r\n        return Boolean(elementClosest(el, '.fc-popover'));\r\n    };\r\n    return DateComponent;\r\n}(Component));\r\nDateComponent.prototype.fgSegSelector = '.fc-event-container > *';\r\nDateComponent.prototype.bgSegSelector = '.fc-bgevent:not(.fc-nonbusiness)';\r\n\r\nvar uid$1 = 0;\r\nfunction createPlugin(input) {\r\n    return {\r\n        id: String(uid$1++),\r\n        deps: input.deps || [],\r\n        reducers: input.reducers || [],\r\n        eventDefParsers: input.eventDefParsers || [],\r\n        isDraggableTransformers: input.isDraggableTransformers || [],\r\n        eventDragMutationMassagers: input.eventDragMutationMassagers || [],\r\n        eventDefMutationAppliers: input.eventDefMutationAppliers || [],\r\n        dateSelectionTransformers: input.dateSelectionTransformers || [],\r\n        datePointTransforms: input.datePointTransforms || [],\r\n        dateSpanTransforms: input.dateSpanTransforms || [],\r\n        views: input.views || {},\r\n        viewPropsTransformers: input.viewPropsTransformers || [],\r\n        isPropsValid: input.isPropsValid || null,\r\n        externalDefTransforms: input.externalDefTransforms || [],\r\n        eventResizeJoinTransforms: input.eventResizeJoinTransforms || [],\r\n        viewContainerModifiers: input.viewContainerModifiers || [],\r\n        eventDropTransformers: input.eventDropTransformers || [],\r\n        componentInteractions: input.componentInteractions || [],\r\n        calendarInteractions: input.calendarInteractions || [],\r\n        themeClasses: input.themeClasses || {},\r\n        eventSourceDefs: input.eventSourceDefs || [],\r\n        cmdFormatter: input.cmdFormatter,\r\n        recurringTypes: input.recurringTypes || [],\r\n        namedTimeZonedImpl: input.namedTimeZonedImpl,\r\n        defaultView: input.defaultView || '',\r\n        elementDraggingImpl: input.elementDraggingImpl,\r\n        optionChangeHandlers: input.optionChangeHandlers || {}\r\n    };\r\n}\r\nvar PluginSystem = /** @class */ (function () {\r\n    function PluginSystem() {\r\n        this.hooks = {\r\n            reducers: [],\r\n            eventDefParsers: [],\r\n            isDraggableTransformers: [],\r\n            eventDragMutationMassagers: [],\r\n            eventDefMutationAppliers: [],\r\n            dateSelectionTransformers: [],\r\n            datePointTransforms: [],\r\n            dateSpanTransforms: [],\r\n            views: {},\r\n            viewPropsTransformers: [],\r\n            isPropsValid: null,\r\n            externalDefTransforms: [],\r\n            eventResizeJoinTransforms: [],\r\n            viewContainerModifiers: [],\r\n            eventDropTransformers: [],\r\n            componentInteractions: [],\r\n            calendarInteractions: [],\r\n            themeClasses: {},\r\n            eventSourceDefs: [],\r\n            cmdFormatter: null,\r\n            recurringTypes: [],\r\n            namedTimeZonedImpl: null,\r\n            defaultView: '',\r\n            elementDraggingImpl: null,\r\n            optionChangeHandlers: {}\r\n        };\r\n        this.addedHash = {};\r\n    }\r\n    PluginSystem.prototype.add = function (plugin) {\r\n        if (!this.addedHash[plugin.id]) {\r\n            this.addedHash[plugin.id] = true;\r\n            for (var _i = 0, _a = plugin.deps; _i < _a.length; _i++) {\r\n                var dep = _a[_i];\r\n                this.add(dep);\r\n            }\r\n            this.hooks = combineHooks(this.hooks, plugin);\r\n        }\r\n    };\r\n    return PluginSystem;\r\n}());\r\nfunction combineHooks(hooks0, hooks1) {\r\n    return {\r\n        reducers: hooks0.reducers.concat(hooks1.reducers),\r\n        eventDefParsers: hooks0.eventDefParsers.concat(hooks1.eventDefParsers),\r\n        isDraggableTransformers: hooks0.isDraggableTransformers.concat(hooks1.isDraggableTransformers),\r\n        eventDragMutationMassagers: hooks0.eventDragMutationMassagers.concat(hooks1.eventDragMutationMassagers),\r\n        eventDefMutationAppliers: hooks0.eventDefMutationAppliers.concat(hooks1.eventDefMutationAppliers),\r\n        dateSelectionTransformers: hooks0.dateSelectionTransformers.concat(hooks1.dateSelectionTransformers),\r\n        datePointTransforms: hooks0.datePointTransforms.concat(hooks1.datePointTransforms),\r\n        dateSpanTransforms: hooks0.dateSpanTransforms.concat(hooks1.dateSpanTransforms),\r\n        views: __assign({}, hooks0.views, hooks1.views),\r\n        viewPropsTransformers: hooks0.viewPropsTransformers.concat(hooks1.viewPropsTransformers),\r\n        isPropsValid: hooks1.isPropsValid || hooks0.isPropsValid,\r\n        externalDefTransforms: hooks0.externalDefTransforms.concat(hooks1.externalDefTransforms),\r\n        eventResizeJoinTransforms: hooks0.eventResizeJoinTransforms.concat(hooks1.eventResizeJoinTransforms),\r\n        viewContainerModifiers: hooks0.viewContainerModifiers.concat(hooks1.viewContainerModifiers),\r\n        eventDropTransformers: hooks0.eventDropTransformers.concat(hooks1.eventDropTransformers),\r\n        calendarInteractions: hooks0.calendarInteractions.concat(hooks1.calendarInteractions),\r\n        componentInteractions: hooks0.componentInteractions.concat(hooks1.componentInteractions),\r\n        themeClasses: __assign({}, hooks0.themeClasses, hooks1.themeClasses),\r\n        eventSourceDefs: hooks0.eventSourceDefs.concat(hooks1.eventSourceDefs),\r\n        cmdFormatter: hooks1.cmdFormatter || hooks0.cmdFormatter,\r\n        recurringTypes: hooks0.recurringTypes.concat(hooks1.recurringTypes),\r\n        namedTimeZonedImpl: hooks1.namedTimeZonedImpl || hooks0.namedTimeZonedImpl,\r\n        defaultView: hooks0.defaultView || hooks1.defaultView,\r\n        elementDraggingImpl: hooks0.elementDraggingImpl || hooks1.elementDraggingImpl,\r\n        optionChangeHandlers: __assign({}, hooks0.optionChangeHandlers, hooks1.optionChangeHandlers)\r\n    };\r\n}\r\n\r\nvar eventSourceDef = {\r\n    ignoreRange: true,\r\n    parseMeta: function (raw) {\r\n        if (Array.isArray(raw)) { // short form\r\n            return raw;\r\n        }\r\n        else if (Array.isArray(raw.events)) {\r\n            return raw.events;\r\n        }\r\n        return null;\r\n    },\r\n    fetch: function (arg, success) {\r\n        success({\r\n            rawEvents: arg.eventSource.meta\r\n        });\r\n    }\r\n};\r\nvar ArrayEventSourcePlugin = createPlugin({\r\n    eventSourceDefs: [eventSourceDef]\r\n});\r\n\r\nvar eventSourceDef$1 = {\r\n    parseMeta: function (raw) {\r\n        if (typeof raw === 'function') { // short form\r\n            return raw;\r\n        }\r\n        else if (typeof raw.events === 'function') {\r\n            return raw.events;\r\n        }\r\n        return null;\r\n    },\r\n    fetch: function (arg, success, failure) {\r\n        var dateEnv = arg.calendar.dateEnv;\r\n        var func = arg.eventSource.meta;\r\n        unpromisify(func.bind(null, {\r\n            start: dateEnv.toDate(arg.range.start),\r\n            end: dateEnv.toDate(arg.range.end),\r\n            startStr: dateEnv.formatIso(arg.range.start),\r\n            endStr: dateEnv.formatIso(arg.range.end),\r\n            timeZone: dateEnv.timeZone\r\n        }), function (rawEvents) {\r\n            success({ rawEvents: rawEvents }); // needs an object response\r\n        }, failure // send errorObj directly to failure callback\r\n        );\r\n    }\r\n};\r\nvar FuncEventSourcePlugin = createPlugin({\r\n    eventSourceDefs: [eventSourceDef$1]\r\n});\r\n\r\nfunction requestJson(method, url, params, successCallback, failureCallback) {\r\n    method = method.toUpperCase();\r\n    var body = null;\r\n    if (method === 'GET') {\r\n        url = injectQueryStringParams(url, params);\r\n    }\r\n    else {\r\n        body = encodeParams(params);\r\n    }\r\n    var xhr = new XMLHttpRequest();\r\n    xhr.open(method, url, true);\r\n    if (method !== 'GET') {\r\n        xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');\r\n    }\r\n    xhr.onload = function () {\r\n        if (xhr.status >= 200 && xhr.status < 400) {\r\n            try {\r\n                var res = JSON.parse(xhr.responseText);\r\n                successCallback(res, xhr);\r\n            }\r\n            catch (err) {\r\n                failureCallback('Failure parsing JSON', xhr);\r\n            }\r\n        }\r\n        else {\r\n            failureCallback('Request failed', xhr);\r\n        }\r\n    };\r\n    xhr.onerror = function () {\r\n        failureCallback('Request failed', xhr);\r\n    };\r\n    xhr.send(body);\r\n}\r\nfunction injectQueryStringParams(url, params) {\r\n    return url +\r\n        (url.indexOf('?') === -1 ? '?' : '&') +\r\n        encodeParams(params);\r\n}\r\nfunction encodeParams(params) {\r\n    var parts = [];\r\n    for (var key in params) {\r\n        parts.push(encodeURIComponent(key) + '=' + encodeURIComponent(params[key]));\r\n    }\r\n    return parts.join('&');\r\n}\r\n\r\nvar eventSourceDef$2 = {\r\n    parseMeta: function (raw) {\r\n        if (typeof raw === 'string') { // short form\r\n            raw = { url: raw };\r\n        }\r\n        else if (!raw || typeof raw !== 'object' || !raw.url) {\r\n            return null;\r\n        }\r\n        return {\r\n            url: raw.url,\r\n            method: (raw.method || 'GET').toUpperCase(),\r\n            extraParams: raw.extraParams,\r\n            startParam: raw.startParam,\r\n            endParam: raw.endParam,\r\n            timeZoneParam: raw.timeZoneParam\r\n        };\r\n    },\r\n    fetch: function (arg, success, failure) {\r\n        var meta = arg.eventSource.meta;\r\n        var requestParams = buildRequestParams(meta, arg.range, arg.calendar);\r\n        requestJson(meta.method, meta.url, requestParams, function (rawEvents, xhr) {\r\n            success({ rawEvents: rawEvents, xhr: xhr });\r\n        }, function (errorMessage, xhr) {\r\n            failure({ message: errorMessage, xhr: xhr });\r\n        });\r\n    }\r\n};\r\nvar JsonFeedEventSourcePlugin = createPlugin({\r\n    eventSourceDefs: [eventSourceDef$2]\r\n});\r\nfunction buildRequestParams(meta, range, calendar) {\r\n    var dateEnv = calendar.dateEnv;\r\n    var startParam;\r\n    var endParam;\r\n    var timeZoneParam;\r\n    var customRequestParams;\r\n    var params = {};\r\n    startParam = meta.startParam;\r\n    if (startParam == null) {\r\n        startParam = calendar.opt('startParam');\r\n    }\r\n    endParam = meta.endParam;\r\n    if (endParam == null) {\r\n        endParam = calendar.opt('endParam');\r\n    }\r\n    timeZoneParam = meta.timeZoneParam;\r\n    if (timeZoneParam == null) {\r\n        timeZoneParam = calendar.opt('timeZoneParam');\r\n    }\r\n    // retrieve any outbound GET/POST data from the options\r\n    if (typeof meta.extraParams === 'function') {\r\n        // supplied as a function that returns a key/value object\r\n        customRequestParams = meta.extraParams();\r\n    }\r\n    else {\r\n        // probably supplied as a straight key/value object\r\n        customRequestParams = meta.extraParams || {};\r\n    }\r\n    __assign(params, customRequestParams);\r\n    params[startParam] = dateEnv.formatIso(range.start);\r\n    params[endParam] = dateEnv.formatIso(range.end);\r\n    if (dateEnv.timeZone !== 'local') {\r\n        params[timeZoneParam] = dateEnv.timeZone;\r\n    }\r\n    return params;\r\n}\r\n\r\nvar recurring = {\r\n    parse: function (rawEvent, leftoverProps, dateEnv) {\r\n        var createMarker = dateEnv.createMarker.bind(dateEnv);\r\n        var processors = {\r\n            daysOfWeek: null,\r\n            startTime: createDuration,\r\n            endTime: createDuration,\r\n            startRecur: createMarker,\r\n            endRecur: createMarker\r\n        };\r\n        var props = refineProps(rawEvent, processors, {}, leftoverProps);\r\n        var anyValid = false;\r\n        for (var propName in props) {\r\n            if (props[propName] != null) {\r\n                anyValid = true;\r\n                break;\r\n            }\r\n        }\r\n        if (anyValid) {\r\n            var duration = null;\r\n            if ('duration' in leftoverProps) {\r\n                duration = createDuration(leftoverProps.duration);\r\n                delete leftoverProps.duration;\r\n            }\r\n            if (!duration && props.startTime && props.endTime) {\r\n                duration = subtractDurations(props.endTime, props.startTime);\r\n            }\r\n            return {\r\n                allDayGuess: Boolean(!props.startTime && !props.endTime),\r\n                duration: duration,\r\n                typeData: props // doesn't need endTime anymore but oh well\r\n            };\r\n        }\r\n        return null;\r\n    },\r\n    expand: function (typeData, framingRange, dateEnv) {\r\n        var clippedFramingRange = intersectRanges(framingRange, { start: typeData.startRecur, end: typeData.endRecur });\r\n        if (clippedFramingRange) {\r\n            return expandRanges(typeData.daysOfWeek, typeData.startTime, clippedFramingRange, dateEnv);\r\n        }\r\n        else {\r\n            return [];\r\n        }\r\n    }\r\n};\r\nvar SimpleRecurrencePlugin = createPlugin({\r\n    recurringTypes: [recurring]\r\n});\r\nfunction expandRanges(daysOfWeek, startTime, framingRange, dateEnv) {\r\n    var dowHash = daysOfWeek ? arrayToHash(daysOfWeek) : null;\r\n    var dayMarker = startOfDay(framingRange.start);\r\n    var endMarker = framingRange.end;\r\n    var instanceStarts = [];\r\n    while (dayMarker < endMarker) {\r\n        var instanceStart \r\n        // if everyday, or this particular day-of-week\r\n        = void 0;\r\n        // if everyday, or this particular day-of-week\r\n        if (!dowHash || dowHash[dayMarker.getUTCDay()]) {\r\n            if (startTime) {\r\n                instanceStart = dateEnv.add(dayMarker, startTime);\r\n            }\r\n            else {\r\n                instanceStart = dayMarker;\r\n            }\r\n            instanceStarts.push(instanceStart);\r\n        }\r\n        dayMarker = addDays(dayMarker, 1);\r\n    }\r\n    return instanceStarts;\r\n}\r\n\r\nvar DefaultOptionChangeHandlers = createPlugin({\r\n    optionChangeHandlers: {\r\n        events: function (events, calendar, deepEqual) {\r\n            handleEventSources([events], calendar, deepEqual);\r\n        },\r\n        eventSources: handleEventSources,\r\n        plugins: handlePlugins\r\n    }\r\n});\r\nfunction handleEventSources(inputs, calendar, deepEqual) {\r\n    var unfoundSources = hashValuesToArray(calendar.state.eventSources);\r\n    var newInputs = [];\r\n    for (var _i = 0, inputs_1 = inputs; _i < inputs_1.length; _i++) {\r\n        var input = inputs_1[_i];\r\n        var inputFound = false;\r\n        for (var i = 0; i < unfoundSources.length; i++) {\r\n            if (deepEqual(unfoundSources[i]._raw, input)) {\r\n                unfoundSources.splice(i, 1); // delete\r\n                inputFound = true;\r\n                break;\r\n            }\r\n        }\r\n        if (!inputFound) {\r\n            newInputs.push(input);\r\n        }\r\n    }\r\n    for (var _a = 0, unfoundSources_1 = unfoundSources; _a < unfoundSources_1.length; _a++) {\r\n        var unfoundSource = unfoundSources_1[_a];\r\n        calendar.dispatch({\r\n            type: 'REMOVE_EVENT_SOURCE',\r\n            sourceId: unfoundSource.sourceId\r\n        });\r\n    }\r\n    for (var _b = 0, newInputs_1 = newInputs; _b < newInputs_1.length; _b++) {\r\n        var newInput = newInputs_1[_b];\r\n        calendar.addEventSource(newInput);\r\n    }\r\n}\r\n// shortcoming: won't remove plugins\r\nfunction handlePlugins(inputs, calendar) {\r\n    calendar.addPluginInputs(inputs); // will gracefully handle duplicates\r\n}\r\n\r\nvar config = {}; // TODO: make these options\r\nvar globalDefaults = {\r\n    defaultRangeSeparator: ' - ',\r\n    titleRangeSeparator: ' \\u2013 ',\r\n    defaultTimedEventDuration: '01:00:00',\r\n    defaultAllDayEventDuration: { day: 1 },\r\n    forceEventDuration: false,\r\n    nextDayThreshold: '00:00:00',\r\n    // display\r\n    columnHeader: true,\r\n    defaultView: '',\r\n    aspectRatio: 1.35,\r\n    header: {\r\n        left: 'title',\r\n        center: '',\r\n        right: 'today prev,next'\r\n    },\r\n    weekends: true,\r\n    weekNumbers: false,\r\n    weekNumberCalculation: 'local',\r\n    editable: false,\r\n    // nowIndicator: false,\r\n    scrollTime: '06:00:00',\r\n    minTime: '00:00:00',\r\n    maxTime: '24:00:00',\r\n    showNonCurrentDates: true,\r\n    // event ajax\r\n    lazyFetching: true,\r\n    startParam: 'start',\r\n    endParam: 'end',\r\n    timeZoneParam: 'timeZone',\r\n    timeZone: 'local',\r\n    // allDayDefault: undefined,\r\n    // locale\r\n    locales: [],\r\n    locale: '',\r\n    // dir: will get this from the default locale\r\n    // buttonIcons: null,\r\n    // allows setting a min-height to the event segment to prevent short events overlapping each other\r\n    timeGridEventMinHeight: 0,\r\n    themeSystem: 'standard',\r\n    // eventResizableFromStart: false,\r\n    dragRevertDuration: 500,\r\n    dragScroll: true,\r\n    allDayMaintainDuration: false,\r\n    // selectable: false,\r\n    unselectAuto: true,\r\n    // selectMinDistance: 0,\r\n    dropAccept: '*',\r\n    eventOrder: 'start,-duration,allDay,title',\r\n    // ^ if start tie, longer events go before shorter. final tie-breaker is title text\r\n    // rerenderDelay: null,\r\n    eventLimit: false,\r\n    eventLimitClick: 'popover',\r\n    dayPopoverFormat: { month: 'long', day: 'numeric', year: 'numeric' },\r\n    handleWindowResize: true,\r\n    windowResizeDelay: 100,\r\n    longPressDelay: 1000,\r\n    eventDragMinDistance: 5 // only applies to mouse\r\n};\r\nvar rtlDefaults = {\r\n    header: {\r\n        left: 'next,prev today',\r\n        center: '',\r\n        right: 'title'\r\n    },\r\n    buttonIcons: {\r\n        // TODO: make RTL support the responibility of the theme\r\n        prev: 'fc-icon-chevron-right',\r\n        next: 'fc-icon-chevron-left',\r\n        prevYear: 'fc-icon-chevrons-right',\r\n        nextYear: 'fc-icon-chevrons-left'\r\n    }\r\n};\r\nvar complexOptions = [\r\n    'header',\r\n    'footer',\r\n    'buttonText',\r\n    'buttonIcons'\r\n];\r\n// Merges an array of option objects into a single object\r\nfunction mergeOptions(optionObjs) {\r\n    return mergeProps(optionObjs, complexOptions);\r\n}\r\n// TODO: move this stuff to a \"plugin\"-related file...\r\nvar INTERNAL_PLUGINS = [\r\n    ArrayEventSourcePlugin,\r\n    FuncEventSourcePlugin,\r\n    JsonFeedEventSourcePlugin,\r\n    SimpleRecurrencePlugin,\r\n    DefaultOptionChangeHandlers\r\n];\r\nfunction refinePluginDefs(pluginInputs) {\r\n    var plugins = [];\r\n    for (var _i = 0, pluginInputs_1 = pluginInputs; _i < pluginInputs_1.length; _i++) {\r\n        var pluginInput = pluginInputs_1[_i];\r\n        if (typeof pluginInput === 'string') {\r\n            var globalName = 'FullCalendar' + capitaliseFirstLetter(pluginInput);\r\n            if (!window[globalName]) {\r\n                console.warn('Plugin file not loaded for ' + pluginInput);\r\n            }\r\n            else {\r\n                plugins.push(window[globalName].default); // is an ES6 module\r\n            }\r\n        }\r\n        else {\r\n            plugins.push(pluginInput);\r\n        }\r\n    }\r\n    return INTERNAL_PLUGINS.concat(plugins);\r\n}\r\n\r\nvar RAW_EN_LOCALE = {\r\n    code: 'en',\r\n    week: {\r\n        dow: 0,\r\n        doy: 4 // 4 days need to be within the year to be considered the first week\r\n    },\r\n    dir: 'ltr',\r\n    buttonText: {\r\n        prev: 'prev',\r\n        next: 'next',\r\n        prevYear: 'prev year',\r\n        nextYear: 'next year',\r\n        year: 'year',\r\n        today: 'today',\r\n        month: 'month',\r\n        week: 'week',\r\n        day: 'day',\r\n        list: 'list'\r\n    },\r\n    weekLabel: 'W',\r\n    allDayText: 'all-day',\r\n    eventLimitText: 'more',\r\n    noEventsMessage: 'No events to display'\r\n};\r\nfunction parseRawLocales(explicitRawLocales) {\r\n    var defaultCode = explicitRawLocales.length > 0 ? explicitRawLocales[0].code : 'en';\r\n    var globalArray = window['FullCalendarLocalesAll'] || []; // from locales-all.js\r\n    var globalObject = window['FullCalendarLocales'] || {}; // from locales/*.js. keys are meaningless\r\n    var allRawLocales = globalArray.concat(// globalArray is low prio\r\n    hashValuesToArray(globalObject), // medium prio\r\n    explicitRawLocales // highest prio\r\n    );\r\n    var rawLocaleMap = {\r\n        en: RAW_EN_LOCALE // necessary?\r\n    };\r\n    for (var _i = 0, allRawLocales_1 = allRawLocales; _i < allRawLocales_1.length; _i++) {\r\n        var rawLocale = allRawLocales_1[_i];\r\n        rawLocaleMap[rawLocale.code] = rawLocale;\r\n    }\r\n    return {\r\n        map: rawLocaleMap,\r\n        defaultCode: defaultCode\r\n    };\r\n}\r\nfunction buildLocale(inputSingular, available) {\r\n    if (typeof inputSingular === 'object' && !Array.isArray(inputSingular)) {\r\n        return parseLocale(inputSingular.code, [inputSingular.code], inputSingular);\r\n    }\r\n    else {\r\n        return queryLocale(inputSingular, available);\r\n    }\r\n}\r\nfunction queryLocale(codeArg, available) {\r\n    var codes = [].concat(codeArg || []); // will convert to array\r\n    var raw = queryRawLocale(codes, available) || RAW_EN_LOCALE;\r\n    return parseLocale(codeArg, codes, raw);\r\n}\r\nfunction queryRawLocale(codes, available) {\r\n    for (var i = 0; i < codes.length; i++) {\r\n        var parts = codes[i].toLocaleLowerCase().split('-');\r\n        for (var j = parts.length; j > 0; j--) {\r\n            var simpleId = parts.slice(0, j).join('-');\r\n            if (available[simpleId]) {\r\n                return available[simpleId];\r\n            }\r\n        }\r\n    }\r\n    return null;\r\n}\r\nfunction parseLocale(codeArg, codes, raw) {\r\n    var merged = mergeProps([RAW_EN_LOCALE, raw], ['buttonText']);\r\n    delete merged.code; // don't want this part of the options\r\n    var week = merged.week;\r\n    delete merged.week;\r\n    return {\r\n        codeArg: codeArg,\r\n        codes: codes,\r\n        week: week,\r\n        simpleNumberFormat: new Intl.NumberFormat(codeArg),\r\n        options: merged\r\n    };\r\n}\r\n\r\nvar OptionsManager = /** @class */ (function () {\r\n    function OptionsManager(overrides) {\r\n        this.overrides = __assign({}, overrides); // make a copy\r\n        this.dynamicOverrides = {};\r\n        this.compute();\r\n    }\r\n    OptionsManager.prototype.mutate = function (updates, removals, isDynamic) {\r\n        var overrideHash = isDynamic ? this.dynamicOverrides : this.overrides;\r\n        __assign(overrideHash, updates);\r\n        for (var _i = 0, removals_1 = removals; _i < removals_1.length; _i++) {\r\n            var propName = removals_1[_i];\r\n            delete overrideHash[propName];\r\n        }\r\n        this.compute();\r\n    };\r\n    // Computes the flattened options hash for the calendar and assigns to `this.options`.\r\n    // Assumes this.overrides and this.dynamicOverrides have already been initialized.\r\n    OptionsManager.prototype.compute = function () {\r\n        // TODO: not a very efficient system\r\n        var locales = firstDefined(// explicit locale option given?\r\n        this.dynamicOverrides.locales, this.overrides.locales, globalDefaults.locales);\r\n        var locale = firstDefined(// explicit locales option given?\r\n        this.dynamicOverrides.locale, this.overrides.locale, globalDefaults.locale);\r\n        var available = parseRawLocales(locales);\r\n        var localeDefaults = buildLocale(locale || available.defaultCode, available.map).options;\r\n        var dir = firstDefined(// based on options computed so far, is direction RTL?\r\n        this.dynamicOverrides.dir, this.overrides.dir, localeDefaults.dir);\r\n        var dirDefaults = dir === 'rtl' ? rtlDefaults : {};\r\n        this.dirDefaults = dirDefaults;\r\n        this.localeDefaults = localeDefaults;\r\n        this.computed = mergeOptions([\r\n            globalDefaults,\r\n            dirDefaults,\r\n            localeDefaults,\r\n            this.overrides,\r\n            this.dynamicOverrides\r\n        ]);\r\n    };\r\n    return OptionsManager;\r\n}());\r\n\r\nvar calendarSystemClassMap = {};\r\nfunction registerCalendarSystem(name, theClass) {\r\n    calendarSystemClassMap[name] = theClass;\r\n}\r\nfunction createCalendarSystem(name) {\r\n    return new calendarSystemClassMap[name]();\r\n}\r\nvar GregorianCalendarSystem = /** @class */ (function () {\r\n    function GregorianCalendarSystem() {\r\n    }\r\n    GregorianCalendarSystem.prototype.getMarkerYear = function (d) {\r\n        return d.getUTCFullYear();\r\n    };\r\n    GregorianCalendarSystem.prototype.getMarkerMonth = function (d) {\r\n        return d.getUTCMonth();\r\n    };\r\n    GregorianCalendarSystem.prototype.getMarkerDay = function (d) {\r\n        return d.getUTCDate();\r\n    };\r\n    GregorianCalendarSystem.prototype.arrayToMarker = function (arr) {\r\n        return arrayToUtcDate(arr);\r\n    };\r\n    GregorianCalendarSystem.prototype.markerToArray = function (marker) {\r\n        return dateToUtcArray(marker);\r\n    };\r\n    return GregorianCalendarSystem;\r\n}());\r\nregisterCalendarSystem('gregory', GregorianCalendarSystem);\r\n\r\nvar ISO_RE = /^\\s*(\\d{4})(-(\\d{2})(-(\\d{2})([T ](\\d{2}):(\\d{2})(:(\\d{2})(\\.(\\d+))?)?(Z|(([-+])(\\d{2})(:?(\\d{2}))?))?)?)?)?$/;\r\nfunction parse(str) {\r\n    var m = ISO_RE.exec(str);\r\n    if (m) {\r\n        var marker = new Date(Date.UTC(Number(m[1]), m[3] ? Number(m[3]) - 1 : 0, Number(m[5] || 1), Number(m[7] || 0), Number(m[8] || 0), Number(m[10] || 0), m[12] ? Number('0.' + m[12]) * 1000 : 0));\r\n        if (isValidDate(marker)) {\r\n            var timeZoneOffset = null;\r\n            if (m[13]) {\r\n                timeZoneOffset = (m[15] === '-' ? -1 : 1) * (Number(m[16] || 0) * 60 +\r\n                    Number(m[18] || 0));\r\n            }\r\n            return {\r\n                marker: marker,\r\n                isTimeUnspecified: !m[6],\r\n                timeZoneOffset: timeZoneOffset\r\n            };\r\n        }\r\n    }\r\n    return null;\r\n}\r\n\r\nvar DateEnv = /** @class */ (function () {\r\n    function DateEnv(settings) {\r\n        var timeZone = this.timeZone = settings.timeZone;\r\n        var isNamedTimeZone = timeZone !== 'local' && timeZone !== 'UTC';\r\n        if (settings.namedTimeZoneImpl && isNamedTimeZone) {\r\n            this.namedTimeZoneImpl = new settings.namedTimeZoneImpl(timeZone);\r\n        }\r\n        this.canComputeOffset = Boolean(!isNamedTimeZone || this.namedTimeZoneImpl);\r\n        this.calendarSystem = createCalendarSystem(settings.calendarSystem);\r\n        this.locale = settings.locale;\r\n        this.weekDow = settings.locale.week.dow;\r\n        this.weekDoy = settings.locale.week.doy;\r\n        if (settings.weekNumberCalculation === 'ISO') {\r\n            this.weekDow = 1;\r\n            this.weekDoy = 4;\r\n        }\r\n        if (typeof settings.firstDay === 'number') {\r\n            this.weekDow = settings.firstDay;\r\n        }\r\n        if (typeof settings.weekNumberCalculation === 'function') {\r\n            this.weekNumberFunc = settings.weekNumberCalculation;\r\n        }\r\n        this.weekLabel = settings.weekLabel != null ? settings.weekLabel : settings.locale.options.weekLabel;\r\n        this.cmdFormatter = settings.cmdFormatter;\r\n    }\r\n    // Creating / Parsing\r\n    DateEnv.prototype.createMarker = function (input) {\r\n        var meta = this.createMarkerMeta(input);\r\n        if (meta === null) {\r\n            return null;\r\n        }\r\n        return meta.marker;\r\n    };\r\n    DateEnv.prototype.createNowMarker = function () {\r\n        if (this.canComputeOffset) {\r\n            return this.timestampToMarker(new Date().valueOf());\r\n        }\r\n        else {\r\n            // if we can't compute the current date val for a timezone,\r\n            // better to give the current local date vals than UTC\r\n            return arrayToUtcDate(dateToLocalArray(new Date()));\r\n        }\r\n    };\r\n    DateEnv.prototype.createMarkerMeta = function (input) {\r\n        if (typeof input === 'string') {\r\n            return this.parse(input);\r\n        }\r\n        var marker = null;\r\n        if (typeof input === 'number') {\r\n            marker = this.timestampToMarker(input);\r\n        }\r\n        else if (input instanceof Date) {\r\n            input = input.valueOf();\r\n            if (!isNaN(input)) {\r\n                marker = this.timestampToMarker(input);\r\n            }\r\n        }\r\n        else if (Array.isArray(input)) {\r\n            marker = arrayToUtcDate(input);\r\n        }\r\n        if (marker === null || !isValidDate(marker)) {\r\n            return null;\r\n        }\r\n        return { marker: marker, isTimeUnspecified: false, forcedTzo: null };\r\n    };\r\n    DateEnv.prototype.parse = function (s) {\r\n        var parts = parse(s);\r\n        if (parts === null) {\r\n            return null;\r\n        }\r\n        var marker = parts.marker;\r\n        var forcedTzo = null;\r\n        if (parts.timeZoneOffset !== null) {\r\n            if (this.canComputeOffset) {\r\n                marker = this.timestampToMarker(marker.valueOf() - parts.timeZoneOffset * 60 * 1000);\r\n            }\r\n            else {\r\n                forcedTzo = parts.timeZoneOffset;\r\n            }\r\n        }\r\n        return { marker: marker, isTimeUnspecified: parts.isTimeUnspecified, forcedTzo: forcedTzo };\r\n    };\r\n    // Accessors\r\n    DateEnv.prototype.getYear = function (marker) {\r\n        return this.calendarSystem.getMarkerYear(marker);\r\n    };\r\n    DateEnv.prototype.getMonth = function (marker) {\r\n        return this.calendarSystem.getMarkerMonth(marker);\r\n    };\r\n    // Adding / Subtracting\r\n    DateEnv.prototype.add = function (marker, dur) {\r\n        var a = this.calendarSystem.markerToArray(marker);\r\n        a[0] += dur.years;\r\n        a[1] += dur.months;\r\n        a[2] += dur.days;\r\n        a[6] += dur.milliseconds;\r\n        return this.calendarSystem.arrayToMarker(a);\r\n    };\r\n    DateEnv.prototype.subtract = function (marker, dur) {\r\n        var a = this.calendarSystem.markerToArray(marker);\r\n        a[0] -= dur.years;\r\n        a[1] -= dur.months;\r\n        a[2] -= dur.days;\r\n        a[6] -= dur.milliseconds;\r\n        return this.calendarSystem.arrayToMarker(a);\r\n    };\r\n    DateEnv.prototype.addYears = function (marker, n) {\r\n        var a = this.calendarSystem.markerToArray(marker);\r\n        a[0] += n;\r\n        return this.calendarSystem.arrayToMarker(a);\r\n    };\r\n    DateEnv.prototype.addMonths = function (marker, n) {\r\n        var a = this.calendarSystem.markerToArray(marker);\r\n        a[1] += n;\r\n        return this.calendarSystem.arrayToMarker(a);\r\n    };\r\n    // Diffing Whole Units\r\n    DateEnv.prototype.diffWholeYears = function (m0, m1) {\r\n        var calendarSystem = this.calendarSystem;\r\n        if (timeAsMs(m0) === timeAsMs(m1) &&\r\n            calendarSystem.getMarkerDay(m0) === calendarSystem.getMarkerDay(m1) &&\r\n            calendarSystem.getMarkerMonth(m0) === calendarSystem.getMarkerMonth(m1)) {\r\n            return calendarSystem.getMarkerYear(m1) - calendarSystem.getMarkerYear(m0);\r\n        }\r\n        return null;\r\n    };\r\n    DateEnv.prototype.diffWholeMonths = function (m0, m1) {\r\n        var calendarSystem = this.calendarSystem;\r\n        if (timeAsMs(m0) === timeAsMs(m1) &&\r\n            calendarSystem.getMarkerDay(m0) === calendarSystem.getMarkerDay(m1)) {\r\n            return (calendarSystem.getMarkerMonth(m1) - calendarSystem.getMarkerMonth(m0)) +\r\n                (calendarSystem.getMarkerYear(m1) - calendarSystem.getMarkerYear(m0)) * 12;\r\n        }\r\n        return null;\r\n    };\r\n    // Range / Duration\r\n    DateEnv.prototype.greatestWholeUnit = function (m0, m1) {\r\n        var n = this.diffWholeYears(m0, m1);\r\n        if (n !== null) {\r\n            return { unit: 'year', value: n };\r\n        }\r\n        n = this.diffWholeMonths(m0, m1);\r\n        if (n !== null) {\r\n            return { unit: 'month', value: n };\r\n        }\r\n        n = diffWholeWeeks(m0, m1);\r\n        if (n !== null) {\r\n            return { unit: 'week', value: n };\r\n        }\r\n        n = diffWholeDays(m0, m1);\r\n        if (n !== null) {\r\n            return { unit: 'day', value: n };\r\n        }\r\n        n = diffHours(m0, m1);\r\n        if (isInt(n)) {\r\n            return { unit: 'hour', value: n };\r\n        }\r\n        n = diffMinutes(m0, m1);\r\n        if (isInt(n)) {\r\n            return { unit: 'minute', value: n };\r\n        }\r\n        n = diffSeconds(m0, m1);\r\n        if (isInt(n)) {\r\n            return { unit: 'second', value: n };\r\n        }\r\n        return { unit: 'millisecond', value: m1.valueOf() - m0.valueOf() };\r\n    };\r\n    DateEnv.prototype.countDurationsBetween = function (m0, m1, d) {\r\n        // TODO: can use greatestWholeUnit\r\n        var diff;\r\n        if (d.years) {\r\n            diff = this.diffWholeYears(m0, m1);\r\n            if (diff !== null) {\r\n                return diff / asRoughYears(d);\r\n            }\r\n        }\r\n        if (d.months) {\r\n            diff = this.diffWholeMonths(m0, m1);\r\n            if (diff !== null) {\r\n                return diff / asRoughMonths(d);\r\n            }\r\n        }\r\n        if (d.days) {\r\n            diff = diffWholeDays(m0, m1);\r\n            if (diff !== null) {\r\n                return diff / asRoughDays(d);\r\n            }\r\n        }\r\n        return (m1.valueOf() - m0.valueOf()) / asRoughMs(d);\r\n    };\r\n    // Start-Of\r\n    DateEnv.prototype.startOf = function (m, unit) {\r\n        if (unit === 'year') {\r\n            return this.startOfYear(m);\r\n        }\r\n        else if (unit === 'month') {\r\n            return this.startOfMonth(m);\r\n        }\r\n        else if (unit === 'week') {\r\n            return this.startOfWeek(m);\r\n        }\r\n        else if (unit === 'day') {\r\n            return startOfDay(m);\r\n        }\r\n        else if (unit === 'hour') {\r\n            return startOfHour(m);\r\n        }\r\n        else if (unit === 'minute') {\r\n            return startOfMinute(m);\r\n        }\r\n        else if (unit === 'second') {\r\n            return startOfSecond(m);\r\n        }\r\n    };\r\n    DateEnv.prototype.startOfYear = function (m) {\r\n        return this.calendarSystem.arrayToMarker([\r\n            this.calendarSystem.getMarkerYear(m)\r\n        ]);\r\n    };\r\n    DateEnv.prototype.startOfMonth = function (m) {\r\n        return this.calendarSystem.arrayToMarker([\r\n            this.calendarSystem.getMarkerYear(m),\r\n            this.calendarSystem.getMarkerMonth(m)\r\n        ]);\r\n    };\r\n    DateEnv.prototype.startOfWeek = function (m) {\r\n        return this.calendarSystem.arrayToMarker([\r\n            this.calendarSystem.getMarkerYear(m),\r\n            this.calendarSystem.getMarkerMonth(m),\r\n            m.getUTCDate() - ((m.getUTCDay() - this.weekDow + 7) % 7)\r\n        ]);\r\n    };\r\n    // Week Number\r\n    DateEnv.prototype.computeWeekNumber = function (marker) {\r\n        if (this.weekNumberFunc) {\r\n            return this.weekNumberFunc(this.toDate(marker));\r\n        }\r\n        else {\r\n            return weekOfYear(marker, this.weekDow, this.weekDoy);\r\n        }\r\n    };\r\n    // TODO: choke on timeZoneName: long\r\n    DateEnv.prototype.format = function (marker, formatter, dateOptions) {\r\n        if (dateOptions === void 0) { dateOptions = {}; }\r\n        return formatter.format({\r\n            marker: marker,\r\n            timeZoneOffset: dateOptions.forcedTzo != null ?\r\n                dateOptions.forcedTzo :\r\n                this.offsetForMarker(marker)\r\n        }, this);\r\n    };\r\n    DateEnv.prototype.formatRange = function (start, end, formatter, dateOptions) {\r\n        if (dateOptions === void 0) { dateOptions = {}; }\r\n        if (dateOptions.isEndExclusive) {\r\n            end = addMs(end, -1);\r\n        }\r\n        return formatter.formatRange({\r\n            marker: start,\r\n            timeZoneOffset: dateOptions.forcedStartTzo != null ?\r\n                dateOptions.forcedStartTzo :\r\n                this.offsetForMarker(start)\r\n        }, {\r\n            marker: end,\r\n            timeZoneOffset: dateOptions.forcedEndTzo != null ?\r\n                dateOptions.forcedEndTzo :\r\n                this.offsetForMarker(end)\r\n        }, this);\r\n    };\r\n    DateEnv.prototype.formatIso = function (marker, extraOptions) {\r\n        if (extraOptions === void 0) { extraOptions = {}; }\r\n        var timeZoneOffset = null;\r\n        if (!extraOptions.omitTimeZoneOffset) {\r\n            if (extraOptions.forcedTzo != null) {\r\n                timeZoneOffset = extraOptions.forcedTzo;\r\n            }\r\n            else {\r\n                timeZoneOffset = this.offsetForMarker(marker);\r\n            }\r\n        }\r\n        return buildIsoString(marker, timeZoneOffset, extraOptions.omitTime);\r\n    };\r\n    // TimeZone\r\n    DateEnv.prototype.timestampToMarker = function (ms) {\r\n        if (this.timeZone === 'local') {\r\n            return arrayToUtcDate(dateToLocalArray(new Date(ms)));\r\n        }\r\n        else if (this.timeZone === 'UTC' || !this.namedTimeZoneImpl) {\r\n            return new Date(ms);\r\n        }\r\n        else {\r\n            return arrayToUtcDate(this.namedTimeZoneImpl.timestampToArray(ms));\r\n        }\r\n    };\r\n    DateEnv.prototype.offsetForMarker = function (m) {\r\n        if (this.timeZone === 'local') {\r\n            return -arrayToLocalDate(dateToUtcArray(m)).getTimezoneOffset(); // convert \"inverse\" offset to \"normal\" offset\r\n        }\r\n        else if (this.timeZone === 'UTC') {\r\n            return 0;\r\n        }\r\n        else if (this.namedTimeZoneImpl) {\r\n            return this.namedTimeZoneImpl.offsetForArray(dateToUtcArray(m));\r\n        }\r\n        return null;\r\n    };\r\n    // Conversion\r\n    DateEnv.prototype.toDate = function (m, forcedTzo) {\r\n        if (this.timeZone === 'local') {\r\n            return arrayToLocalDate(dateToUtcArray(m));\r\n        }\r\n        else if (this.timeZone === 'UTC') {\r\n            return new Date(m.valueOf()); // make sure it's a copy\r\n        }\r\n        else if (!this.namedTimeZoneImpl) {\r\n            return new Date(m.valueOf() - (forcedTzo || 0));\r\n        }\r\n        else {\r\n            return new Date(m.valueOf() -\r\n                this.namedTimeZoneImpl.offsetForArray(dateToUtcArray(m)) * 1000 * 60 // convert minutes -> ms\r\n            );\r\n        }\r\n    };\r\n    return DateEnv;\r\n}());\r\n\r\nvar SIMPLE_SOURCE_PROPS = {\r\n    id: String,\r\n    allDayDefault: Boolean,\r\n    eventDataTransform: Function,\r\n    success: Function,\r\n    failure: Function\r\n};\r\nvar uid$2 = 0;\r\nfunction doesSourceNeedRange(eventSource, calendar) {\r\n    var defs = calendar.pluginSystem.hooks.eventSourceDefs;\r\n    return !defs[eventSource.sourceDefId].ignoreRange;\r\n}\r\nfunction parseEventSource(raw, calendar) {\r\n    var defs = calendar.pluginSystem.hooks.eventSourceDefs;\r\n    for (var i = defs.length - 1; i >= 0; i--) { // later-added plugins take precedence\r\n        var def = defs[i];\r\n        var meta = def.parseMeta(raw);\r\n        if (meta) {\r\n            var res = parseEventSourceProps(typeof raw === 'object' ? raw : {}, meta, i, calendar);\r\n            res._raw = raw;\r\n            return res;\r\n        }\r\n    }\r\n    return null;\r\n}\r\nfunction parseEventSourceProps(raw, meta, sourceDefId, calendar) {\r\n    var leftovers0 = {};\r\n    var props = refineProps(raw, SIMPLE_SOURCE_PROPS, {}, leftovers0);\r\n    var leftovers1 = {};\r\n    var ui = processUnscopedUiProps(leftovers0, calendar, leftovers1);\r\n    props.isFetching = false;\r\n    props.latestFetchId = '';\r\n    props.fetchRange = null;\r\n    props.publicId = String(raw.id || '');\r\n    props.sourceId = String(uid$2++);\r\n    props.sourceDefId = sourceDefId;\r\n    props.meta = meta;\r\n    props.ui = ui;\r\n    props.extendedProps = leftovers1;\r\n    return props;\r\n}\r\n\r\nfunction reduceEventSources (eventSources, action, dateProfile, calendar) {\r\n    switch (action.type) {\r\n        case 'ADD_EVENT_SOURCES': // already parsed\r\n            return addSources(eventSources, action.sources, dateProfile ? dateProfile.activeRange : null, calendar);\r\n        case 'REMOVE_EVENT_SOURCE':\r\n            return removeSource(eventSources, action.sourceId);\r\n        case 'PREV': // TODO: how do we track all actions that affect dateProfile :(\r\n        case 'NEXT':\r\n        case 'SET_DATE':\r\n        case 'SET_VIEW_TYPE':\r\n            if (dateProfile) {\r\n                return fetchDirtySources(eventSources, dateProfile.activeRange, calendar);\r\n            }\r\n            else {\r\n                return eventSources;\r\n            }\r\n        case 'FETCH_EVENT_SOURCES':\r\n        case 'CHANGE_TIMEZONE':\r\n            return fetchSourcesByIds(eventSources, action.sourceIds ?\r\n                arrayToHash(action.sourceIds) :\r\n                excludeStaticSources(eventSources, calendar), dateProfile ? dateProfile.activeRange : null, calendar);\r\n        case 'RECEIVE_EVENTS':\r\n        case 'RECEIVE_EVENT_ERROR':\r\n            return receiveResponse(eventSources, action.sourceId, action.fetchId, action.fetchRange);\r\n        case 'REMOVE_ALL_EVENT_SOURCES':\r\n            return {};\r\n        default:\r\n            return eventSources;\r\n    }\r\n}\r\nvar uid$3 = 0;\r\nfunction addSources(eventSourceHash, sources, fetchRange, calendar) {\r\n    var hash = {};\r\n    for (var _i = 0, sources_1 = sources; _i < sources_1.length; _i++) {\r\n        var source = sources_1[_i];\r\n        hash[source.sourceId] = source;\r\n    }\r\n    if (fetchRange) {\r\n        hash = fetchDirtySources(hash, fetchRange, calendar);\r\n    }\r\n    return __assign({}, eventSourceHash, hash);\r\n}\r\nfunction removeSource(eventSourceHash, sourceId) {\r\n    return filterHash(eventSourceHash, function (eventSource) {\r\n        return eventSource.sourceId !== sourceId;\r\n    });\r\n}\r\nfunction fetchDirtySources(sourceHash, fetchRange, calendar) {\r\n    return fetchSourcesByIds(sourceHash, filterHash(sourceHash, function (eventSource) {\r\n        return isSourceDirty(eventSource, fetchRange, calendar);\r\n    }), fetchRange, calendar);\r\n}\r\nfunction isSourceDirty(eventSource, fetchRange, calendar) {\r\n    if (!doesSourceNeedRange(eventSource, calendar)) {\r\n        return !eventSource.latestFetchId;\r\n    }\r\n    else {\r\n        return !calendar.opt('lazyFetching') ||\r\n            !eventSource.fetchRange ||\r\n            fetchRange.start < eventSource.fetchRange.start ||\r\n            fetchRange.end > eventSource.fetchRange.end;\r\n    }\r\n}\r\nfunction fetchSourcesByIds(prevSources, sourceIdHash, fetchRange, calendar) {\r\n    var nextSources = {};\r\n    for (var sourceId in prevSources) {\r\n        var source = prevSources[sourceId];\r\n        if (sourceIdHash[sourceId]) {\r\n            nextSources[sourceId] = fetchSource(source, fetchRange, calendar);\r\n        }\r\n        else {\r\n            nextSources[sourceId] = source;\r\n        }\r\n    }\r\n    return nextSources;\r\n}\r\nfunction fetchSource(eventSource, fetchRange, calendar) {\r\n    var sourceDef = calendar.pluginSystem.hooks.eventSourceDefs[eventSource.sourceDefId];\r\n    var fetchId = String(uid$3++);\r\n    sourceDef.fetch({\r\n        eventSource: eventSource,\r\n        calendar: calendar,\r\n        range: fetchRange\r\n    }, function (res) {\r\n        var rawEvents = res.rawEvents;\r\n        var calSuccess = calendar.opt('eventSourceSuccess');\r\n        var calSuccessRes;\r\n        var sourceSuccessRes;\r\n        if (eventSource.success) {\r\n            sourceSuccessRes = eventSource.success(rawEvents, res.xhr);\r\n        }\r\n        if (calSuccess) {\r\n            calSuccessRes = calSuccess(rawEvents, res.xhr);\r\n        }\r\n        rawEvents = sourceSuccessRes || calSuccessRes || rawEvents;\r\n        calendar.dispatch({\r\n            type: 'RECEIVE_EVENTS',\r\n            sourceId: eventSource.sourceId,\r\n            fetchId: fetchId,\r\n            fetchRange: fetchRange,\r\n            rawEvents: rawEvents\r\n        });\r\n    }, function (error) {\r\n        var callFailure = calendar.opt('eventSourceFailure');\r\n        console.warn(error.message, error);\r\n        if (eventSource.failure) {\r\n            eventSource.failure(error);\r\n        }\r\n        if (callFailure) {\r\n            callFailure(error);\r\n        }\r\n        calendar.dispatch({\r\n            type: 'RECEIVE_EVENT_ERROR',\r\n            sourceId: eventSource.sourceId,\r\n            fetchId: fetchId,\r\n            fetchRange: fetchRange,\r\n            error: error\r\n        });\r\n    });\r\n    return __assign({}, eventSource, { isFetching: true, latestFetchId: fetchId });\r\n}\r\nfunction receiveResponse(sourceHash, sourceId, fetchId, fetchRange) {\r\n    var _a;\r\n    var eventSource = sourceHash[sourceId];\r\n    if (eventSource && // not already removed\r\n        fetchId === eventSource.latestFetchId) {\r\n        return __assign({}, sourceHash, (_a = {}, _a[sourceId] = __assign({}, eventSource, { isFetching: false, fetchRange: fetchRange }), _a));\r\n    }\r\n    return sourceHash;\r\n}\r\nfunction excludeStaticSources(eventSources, calendar) {\r\n    return filterHash(eventSources, function (eventSource) {\r\n        return doesSourceNeedRange(eventSource, calendar);\r\n    });\r\n}\r\n\r\nvar DateProfileGenerator = /** @class */ (function () {\r\n    function DateProfileGenerator(viewSpec, calendar) {\r\n        this.viewSpec = viewSpec;\r\n        this.options = viewSpec.options;\r\n        this.dateEnv = calendar.dateEnv;\r\n        this.calendar = calendar;\r\n        this.initHiddenDays();\r\n    }\r\n    /* Date Range Computation\r\n    ------------------------------------------------------------------------------------------------------------------*/\r\n    // Builds a structure with info about what the dates/ranges will be for the \"prev\" view.\r\n    DateProfileGenerator.prototype.buildPrev = function (currentDateProfile, currentDate) {\r\n        var dateEnv = this.dateEnv;\r\n        var prevDate = dateEnv.subtract(dateEnv.startOf(currentDate, currentDateProfile.currentRangeUnit), // important for start-of-month\r\n        currentDateProfile.dateIncrement);\r\n        return this.build(prevDate, -1);\r\n    };\r\n    // Builds a structure with info about what the dates/ranges will be for the \"next\" view.\r\n    DateProfileGenerator.prototype.buildNext = function (currentDateProfile, currentDate) {\r\n        var dateEnv = this.dateEnv;\r\n        var nextDate = dateEnv.add(dateEnv.startOf(currentDate, currentDateProfile.currentRangeUnit), // important for start-of-month\r\n        currentDateProfile.dateIncrement);\r\n        return this.build(nextDate, 1);\r\n    };\r\n    // Builds a structure holding dates/ranges for rendering around the given date.\r\n    // Optional direction param indicates whether the date is being incremented/decremented\r\n    // from its previous value. decremented = -1, incremented = 1 (default).\r\n    DateProfileGenerator.prototype.build = function (currentDate, direction, forceToValid) {\r\n        if (forceToValid === void 0) { forceToValid = false; }\r\n        var validRange;\r\n        var minTime = null;\r\n        var maxTime = null;\r\n        var currentInfo;\r\n        var isRangeAllDay;\r\n        var renderRange;\r\n        var activeRange;\r\n        var isValid;\r\n        validRange = this.buildValidRange();\r\n        validRange = this.trimHiddenDays(validRange);\r\n        if (forceToValid) {\r\n            currentDate = constrainMarkerToRange(currentDate, validRange);\r\n        }\r\n        currentInfo = this.buildCurrentRangeInfo(currentDate, direction);\r\n        isRangeAllDay = /^(year|month|week|day)$/.test(currentInfo.unit);\r\n        renderRange = this.buildRenderRange(this.trimHiddenDays(currentInfo.range), currentInfo.unit, isRangeAllDay);\r\n        renderRange = this.trimHiddenDays(renderRange);\r\n        activeRange = renderRange;\r\n        if (!this.options.showNonCurrentDates) {\r\n            activeRange = intersectRanges(activeRange, currentInfo.range);\r\n        }\r\n        minTime = createDuration(this.options.minTime);\r\n        maxTime = createDuration(this.options.maxTime);\r\n        activeRange = this.adjustActiveRange(activeRange, minTime, maxTime);\r\n        activeRange = intersectRanges(activeRange, validRange); // might return null\r\n        // it's invalid if the originally requested date is not contained,\r\n        // or if the range is completely outside of the valid range.\r\n        isValid = rangesIntersect(currentInfo.range, validRange);\r\n        return {\r\n            // constraint for where prev/next operations can go and where events can be dragged/resized to.\r\n            // an object with optional start and end properties.\r\n            validRange: validRange,\r\n            // range the view is formally responsible for.\r\n            // for example, a month view might have 1st-31st, excluding padded dates\r\n            currentRange: currentInfo.range,\r\n            // name of largest unit being displayed, like \"month\" or \"week\"\r\n            currentRangeUnit: currentInfo.unit,\r\n            isRangeAllDay: isRangeAllDay,\r\n            // dates that display events and accept drag-n-drop\r\n            // will be `null` if no dates accept events\r\n            activeRange: activeRange,\r\n            // date range with a rendered skeleton\r\n            // includes not-active days that need some sort of DOM\r\n            renderRange: renderRange,\r\n            // Duration object that denotes the first visible time of any given day\r\n            minTime: minTime,\r\n            // Duration object that denotes the exclusive visible end time of any given day\r\n            maxTime: maxTime,\r\n            isValid: isValid,\r\n            // how far the current date will move for a prev/next operation\r\n            dateIncrement: this.buildDateIncrement(currentInfo.duration)\r\n            // pass a fallback (might be null) ^\r\n        };\r\n    };\r\n    // Builds an object with optional start/end properties.\r\n    // Indicates the minimum/maximum dates to display.\r\n    // not responsible for trimming hidden days.\r\n    DateProfileGenerator.prototype.buildValidRange = function () {\r\n        return this.getRangeOption('validRange', this.calendar.getNow()) ||\r\n            { start: null, end: null }; // completely open-ended\r\n    };\r\n    // Builds a structure with info about the \"current\" range, the range that is\r\n    // highlighted as being the current month for example.\r\n    // See build() for a description of `direction`.\r\n    // Guaranteed to have `range` and `unit` properties. `duration` is optional.\r\n    DateProfileGenerator.prototype.buildCurrentRangeInfo = function (date, direction) {\r\n        var _a = this, viewSpec = _a.viewSpec, dateEnv = _a.dateEnv;\r\n        var duration = null;\r\n        var unit = null;\r\n        var range = null;\r\n        var dayCount;\r\n        if (viewSpec.duration) {\r\n            duration = viewSpec.duration;\r\n            unit = viewSpec.durationUnit;\r\n            range = this.buildRangeFromDuration(date, direction, duration, unit);\r\n        }\r\n        else if ((dayCount = this.options.dayCount)) {\r\n            unit = 'day';\r\n            range = this.buildRangeFromDayCount(date, direction, dayCount);\r\n        }\r\n        else if ((range = this.buildCustomVisibleRange(date))) {\r\n            unit = dateEnv.greatestWholeUnit(range.start, range.end).unit;\r\n        }\r\n        else {\r\n            duration = this.getFallbackDuration();\r\n            unit = greatestDurationDenominator(duration).unit;\r\n            range = this.buildRangeFromDuration(date, direction, duration, unit);\r\n        }\r\n        return { duration: duration, unit: unit, range: range };\r\n    };\r\n    DateProfileGenerator.prototype.getFallbackDuration = function () {\r\n        return createDuration({ day: 1 });\r\n    };\r\n    // Returns a new activeRange to have time values (un-ambiguate)\r\n    // minTime or maxTime causes the range to expand.\r\n    DateProfileGenerator.prototype.adjustActiveRange = function (range, minTime, maxTime) {\r\n        var dateEnv = this.dateEnv;\r\n        var start = range.start;\r\n        var end = range.end;\r\n        if (this.viewSpec.class.prototype.usesMinMaxTime) {\r\n            // expand active range if minTime is negative (why not when positive?)\r\n            if (asRoughDays(minTime) < 0) {\r\n                start = startOfDay(start); // necessary?\r\n                start = dateEnv.add(start, minTime);\r\n            }\r\n            // expand active range if maxTime is beyond one day (why not when positive?)\r\n            if (asRoughDays(maxTime) > 1) {\r\n                end = startOfDay(end); // necessary?\r\n                end = addDays(end, -1);\r\n                end = dateEnv.add(end, maxTime);\r\n            }\r\n        }\r\n        return { start: start, end: end };\r\n    };\r\n    // Builds the \"current\" range when it is specified as an explicit duration.\r\n    // `unit` is the already-computed greatestDurationDenominator unit of duration.\r\n    DateProfileGenerator.prototype.buildRangeFromDuration = function (date, direction, duration, unit) {\r\n        var dateEnv = this.dateEnv;\r\n        var alignment = this.options.dateAlignment;\r\n        var dateIncrementInput;\r\n        var dateIncrementDuration;\r\n        var start;\r\n        var end;\r\n        var res;\r\n        // compute what the alignment should be\r\n        if (!alignment) {\r\n            dateIncrementInput = this.options.dateIncrement;\r\n            if (dateIncrementInput) {\r\n                dateIncrementDuration = createDuration(dateIncrementInput);\r\n                // use the smaller of the two units\r\n                if (asRoughMs(dateIncrementDuration) < asRoughMs(duration)) {\r\n                    alignment = greatestDurationDenominator(dateIncrementDuration, !getWeeksFromInput(dateIncrementInput)).unit;\r\n                }\r\n                else {\r\n                    alignment = unit;\r\n                }\r\n            }\r\n            else {\r\n                alignment = unit;\r\n            }\r\n        }\r\n        // if the view displays a single day or smaller\r\n        if (asRoughDays(duration) <= 1) {\r\n            if (this.isHiddenDay(start)) {\r\n                start = this.skipHiddenDays(start, direction);\r\n                start = startOfDay(start);\r\n            }\r\n        }\r\n        function computeRes() {\r\n            start = dateEnv.startOf(date, alignment);\r\n            end = dateEnv.add(start, duration);\r\n            res = { start: start, end: end };\r\n        }\r\n        computeRes();\r\n        // if range is completely enveloped by hidden days, go past the hidden days\r\n        if (!this.trimHiddenDays(res)) {\r\n            date = this.skipHiddenDays(date, direction);\r\n            computeRes();\r\n        }\r\n        return res;\r\n    };\r\n    // Builds the \"current\" range when a dayCount is specified.\r\n    DateProfileGenerator.prototype.buildRangeFromDayCount = function (date, direction, dayCount) {\r\n        var dateEnv = this.dateEnv;\r\n        var customAlignment = this.options.dateAlignment;\r\n        var runningCount = 0;\r\n        var start = date;\r\n        var end;\r\n        if (customAlignment) {\r\n            start = dateEnv.startOf(start, customAlignment);\r\n        }\r\n        start = startOfDay(start);\r\n        start = this.skipHiddenDays(start, direction);\r\n        end = start;\r\n        do {\r\n            end = addDays(end, 1);\r\n            if (!this.isHiddenDay(end)) {\r\n                runningCount++;\r\n            }\r\n        } while (runningCount < dayCount);\r\n        return { start: start, end: end };\r\n    };\r\n    // Builds a normalized range object for the \"visible\" range,\r\n    // which is a way to define the currentRange and activeRange at the same time.\r\n    DateProfileGenerator.prototype.buildCustomVisibleRange = function (date) {\r\n        var dateEnv = this.dateEnv;\r\n        var visibleRange = this.getRangeOption('visibleRange', dateEnv.toDate(date));\r\n        if (visibleRange && (visibleRange.start == null || visibleRange.end == null)) {\r\n            return null;\r\n        }\r\n        return visibleRange;\r\n    };\r\n    // Computes the range that will represent the element/cells for *rendering*,\r\n    // but which may have voided days/times.\r\n    // not responsible for trimming hidden days.\r\n    DateProfileGenerator.prototype.buildRenderRange = function (currentRange, currentRangeUnit, isRangeAllDay) {\r\n        return currentRange;\r\n    };\r\n    // Compute the duration value that should be added/substracted to the current date\r\n    // when a prev/next operation happens.\r\n    DateProfileGenerator.prototype.buildDateIncrement = function (fallback) {\r\n        var dateIncrementInput = this.options.dateIncrement;\r\n        var customAlignment;\r\n        if (dateIncrementInput) {\r\n            return createDuration(dateIncrementInput);\r\n        }\r\n        else if ((customAlignment = this.options.dateAlignment)) {\r\n            return createDuration(1, customAlignment);\r\n        }\r\n        else if (fallback) {\r\n            return fallback;\r\n        }\r\n        else {\r\n            return createDuration({ days: 1 });\r\n        }\r\n    };\r\n    // Arguments after name will be forwarded to a hypothetical function value\r\n    // WARNING: passed-in arguments will be given to generator functions as-is and can cause side-effects.\r\n    // Always clone your objects if you fear mutation.\r\n    DateProfileGenerator.prototype.getRangeOption = function (name) {\r\n        var otherArgs = [];\r\n        for (var _i = 1; _i < arguments.length; _i++) {\r\n            otherArgs[_i - 1] = arguments[_i];\r\n        }\r\n        var val = this.options[name];\r\n        if (typeof val === 'function') {\r\n            val = val.apply(null, otherArgs);\r\n        }\r\n        if (val) {\r\n            val = parseRange(val, this.dateEnv);\r\n        }\r\n        if (val) {\r\n            val = computeVisibleDayRange(val);\r\n        }\r\n        return val;\r\n    };\r\n    /* Hidden Days\r\n    ------------------------------------------------------------------------------------------------------------------*/\r\n    // Initializes internal variables related to calculating hidden days-of-week\r\n    DateProfileGenerator.prototype.initHiddenDays = function () {\r\n        var hiddenDays = this.options.hiddenDays || []; // array of day-of-week indices that are hidden\r\n        var isHiddenDayHash = []; // is the day-of-week hidden? (hash with day-of-week-index -> bool)\r\n        var dayCnt = 0;\r\n        var i;\r\n        if (this.options.weekends === false) {\r\n            hiddenDays.push(0, 6); // 0=sunday, 6=saturday\r\n        }\r\n        for (i = 0; i < 7; i++) {\r\n            if (!(isHiddenDayHash[i] = hiddenDays.indexOf(i) !== -1)) {\r\n                dayCnt++;\r\n            }\r\n        }\r\n        if (!dayCnt) {\r\n            throw new Error('invalid hiddenDays'); // all days were hidden? bad.\r\n        }\r\n        this.isHiddenDayHash = isHiddenDayHash;\r\n    };\r\n    // Remove days from the beginning and end of the range that are computed as hidden.\r\n    // If the whole range is trimmed off, returns null\r\n    DateProfileGenerator.prototype.trimHiddenDays = function (range) {\r\n        var start = range.start;\r\n        var end = range.end;\r\n        if (start) {\r\n            start = this.skipHiddenDays(start);\r\n        }\r\n        if (end) {\r\n            end = this.skipHiddenDays(end, -1, true);\r\n        }\r\n        if (start == null || end == null || start < end) {\r\n            return { start: start, end: end };\r\n        }\r\n        return null;\r\n    };\r\n    // Is the current day hidden?\r\n    // `day` is a day-of-week index (0-6), or a Date (used for UTC)\r\n    DateProfileGenerator.prototype.isHiddenDay = function (day) {\r\n        if (day instanceof Date) {\r\n            day = day.getUTCDay();\r\n        }\r\n        return this.isHiddenDayHash[day];\r\n    };\r\n    // Incrementing the current day until it is no longer a hidden day, returning a copy.\r\n    // DOES NOT CONSIDER validRange!\r\n    // If the initial value of `date` is not a hidden day, don't do anything.\r\n    // Pass `isExclusive` as `true` if you are dealing with an end date.\r\n    // `inc` defaults to `1` (increment one day forward each time)\r\n    DateProfileGenerator.prototype.skipHiddenDays = function (date, inc, isExclusive) {\r\n        if (inc === void 0) { inc = 1; }\r\n        if (isExclusive === void 0) { isExclusive = false; }\r\n        while (this.isHiddenDayHash[(date.getUTCDay() + (isExclusive ? inc : 0) + 7) % 7]) {\r\n            date = addDays(date, inc);\r\n        }\r\n        return date;\r\n    };\r\n    return DateProfileGenerator;\r\n}());\r\n// TODO: find a way to avoid comparing DateProfiles. it's tedious\r\nfunction isDateProfilesEqual(p0, p1) {\r\n    return rangesEqual(p0.validRange, p1.validRange) &&\r\n        rangesEqual(p0.activeRange, p1.activeRange) &&\r\n        rangesEqual(p0.renderRange, p1.renderRange) &&\r\n        durationsEqual(p0.minTime, p1.minTime) &&\r\n        durationsEqual(p0.maxTime, p1.maxTime);\r\n    /*\r\n    TODO: compare more?\r\n      currentRange: DateRange\r\n      currentRangeUnit: string\r\n      isRangeAllDay: boolean\r\n      isValid: boolean\r\n      dateIncrement: Duration\r\n    */\r\n}\r\n\r\nfunction reduce (state, action, calendar) {\r\n    var viewType = reduceViewType(state.viewType, action);\r\n    var dateProfile = reduceDateProfile(state.dateProfile, action, state.currentDate, viewType, calendar);\r\n    var eventSources = reduceEventSources(state.eventSources, action, dateProfile, calendar);\r\n    var nextState = __assign({}, state, { viewType: viewType,\r\n        dateProfile: dateProfile, currentDate: reduceCurrentDate(state.currentDate, action, dateProfile), eventSources: eventSources, eventStore: reduceEventStore(state.eventStore, action, eventSources, dateProfile, calendar), dateSelection: reduceDateSelection(state.dateSelection, action, calendar), eventSelection: reduceSelectedEvent(state.eventSelection, action), eventDrag: reduceEventDrag(state.eventDrag, action, eventSources, calendar), eventResize: reduceEventResize(state.eventResize, action, eventSources, calendar), eventSourceLoadingLevel: computeLoadingLevel(eventSources), loadingLevel: computeLoadingLevel(eventSources) });\r\n    for (var _i = 0, _a = calendar.pluginSystem.hooks.reducers; _i < _a.length; _i++) {\r\n        var reducerFunc = _a[_i];\r\n        nextState = reducerFunc(nextState, action, calendar);\r\n    }\r\n    // console.log(action.type, nextState)\r\n    return nextState;\r\n}\r\nfunction reduceViewType(currentViewType, action) {\r\n    switch (action.type) {\r\n        case 'SET_VIEW_TYPE':\r\n            return action.viewType;\r\n        default:\r\n            return currentViewType;\r\n    }\r\n}\r\nfunction reduceDateProfile(currentDateProfile, action, currentDate, viewType, calendar) {\r\n    var newDateProfile;\r\n    switch (action.type) {\r\n        case 'PREV':\r\n            newDateProfile = calendar.dateProfileGenerators[viewType].buildPrev(currentDateProfile, currentDate);\r\n            break;\r\n        case 'NEXT':\r\n            newDateProfile = calendar.dateProfileGenerators[viewType].buildNext(currentDateProfile, currentDate);\r\n            break;\r\n        case 'SET_DATE':\r\n            if (!currentDateProfile.activeRange ||\r\n                !rangeContainsMarker(currentDateProfile.currentRange, action.dateMarker)) {\r\n                newDateProfile = calendar.dateProfileGenerators[viewType].build(action.dateMarker, undefined, true // forceToValid\r\n                );\r\n            }\r\n            break;\r\n        case 'SET_VIEW_TYPE':\r\n            var generator = calendar.dateProfileGenerators[viewType];\r\n            if (!generator) {\r\n                throw new Error(viewType ?\r\n                    'The FullCalendar view \"' + viewType + '\" does not exist. Make sure your plugins are loaded correctly.' :\r\n                    'No available FullCalendar view plugins.');\r\n            }\r\n            newDateProfile = generator.build(action.dateMarker || currentDate, undefined, true // forceToValid\r\n            );\r\n            break;\r\n    }\r\n    if (newDateProfile &&\r\n        newDateProfile.isValid &&\r\n        !(currentDateProfile && isDateProfilesEqual(currentDateProfile, newDateProfile))) {\r\n        return newDateProfile;\r\n    }\r\n    else {\r\n        return currentDateProfile;\r\n    }\r\n}\r\nfunction reduceCurrentDate(currentDate, action, dateProfile) {\r\n    switch (action.type) {\r\n        case 'PREV':\r\n        case 'NEXT':\r\n            if (!rangeContainsMarker(dateProfile.currentRange, currentDate)) {\r\n                return dateProfile.currentRange.start;\r\n            }\r\n            else {\r\n                return currentDate;\r\n            }\r\n        case 'SET_DATE':\r\n        case 'SET_VIEW_TYPE':\r\n            var newDate = action.dateMarker || currentDate;\r\n            if (dateProfile.activeRange && !rangeContainsMarker(dateProfile.activeRange, newDate)) {\r\n                return dateProfile.currentRange.start;\r\n            }\r\n            else {\r\n                return newDate;\r\n            }\r\n        default:\r\n            return currentDate;\r\n    }\r\n}\r\nfunction reduceDateSelection(currentSelection, action, calendar) {\r\n    switch (action.type) {\r\n        case 'SELECT_DATES':\r\n            return action.selection;\r\n        case 'UNSELECT_DATES':\r\n            return null;\r\n        default:\r\n            return currentSelection;\r\n    }\r\n}\r\nfunction reduceSelectedEvent(currentInstanceId, action) {\r\n    switch (action.type) {\r\n        case 'SELECT_EVENT':\r\n            return action.eventInstanceId;\r\n        case 'UNSELECT_EVENT':\r\n            return '';\r\n        default:\r\n            return currentInstanceId;\r\n    }\r\n}\r\nfunction reduceEventDrag(currentDrag, action, sources, calendar) {\r\n    switch (action.type) {\r\n        case 'SET_EVENT_DRAG':\r\n            var newDrag = action.state;\r\n            return {\r\n                affectedEvents: newDrag.affectedEvents,\r\n                mutatedEvents: newDrag.mutatedEvents,\r\n                isEvent: newDrag.isEvent,\r\n                origSeg: newDrag.origSeg\r\n            };\r\n        case 'UNSET_EVENT_DRAG':\r\n            return null;\r\n        default:\r\n            return currentDrag;\r\n    }\r\n}\r\nfunction reduceEventResize(currentResize, action, sources, calendar) {\r\n    switch (action.type) {\r\n        case 'SET_EVENT_RESIZE':\r\n            var newResize = action.state;\r\n            return {\r\n                affectedEvents: newResize.affectedEvents,\r\n                mutatedEvents: newResize.mutatedEvents,\r\n                isEvent: newResize.isEvent,\r\n                origSeg: newResize.origSeg\r\n            };\r\n        case 'UNSET_EVENT_RESIZE':\r\n            return null;\r\n        default:\r\n            return currentResize;\r\n    }\r\n}\r\nfunction computeLoadingLevel(eventSources) {\r\n    var cnt = 0;\r\n    for (var sourceId in eventSources) {\r\n        if (eventSources[sourceId].isFetching) {\r\n            cnt++;\r\n        }\r\n    }\r\n    return cnt;\r\n}\r\n\r\nvar STANDARD_PROPS = {\r\n    start: null,\r\n    end: null,\r\n    allDay: Boolean\r\n};\r\nfunction parseDateSpan(raw, dateEnv, defaultDuration) {\r\n    var span = parseOpenDateSpan(raw, dateEnv);\r\n    var range = span.range;\r\n    if (!range.start) {\r\n        return null;\r\n    }\r\n    if (!range.end) {\r\n        if (defaultDuration == null) {\r\n            return null;\r\n        }\r\n        else {\r\n            range.end = dateEnv.add(range.start, defaultDuration);\r\n        }\r\n    }\r\n    return span;\r\n}\r\n/*\r\nTODO: somehow combine with parseRange?\r\nWill return null if the start/end props were present but parsed invalidly.\r\n*/\r\nfunction parseOpenDateSpan(raw, dateEnv) {\r\n    var leftovers = {};\r\n    var standardProps = refineProps(raw, STANDARD_PROPS, {}, leftovers);\r\n    var startMeta = standardProps.start ? dateEnv.createMarkerMeta(standardProps.start) : null;\r\n    var endMeta = standardProps.end ? dateEnv.createMarkerMeta(standardProps.end) : null;\r\n    var allDay = standardProps.allDay;\r\n    if (allDay == null) {\r\n        allDay = (startMeta && startMeta.isTimeUnspecified) &&\r\n            (!endMeta || endMeta.isTimeUnspecified);\r\n    }\r\n    // use this leftover object as the selection object\r\n    leftovers.range = {\r\n        start: startMeta ? startMeta.marker : null,\r\n        end: endMeta ? endMeta.marker : null\r\n    };\r\n    leftovers.allDay = allDay;\r\n    return leftovers;\r\n}\r\nfunction isDateSpansEqual(span0, span1) {\r\n    return rangesEqual(span0.range, span1.range) &&\r\n        span0.allDay === span1.allDay &&\r\n        isSpanPropsEqual(span0, span1);\r\n}\r\n// the NON-DATE-RELATED props\r\nfunction isSpanPropsEqual(span0, span1) {\r\n    for (var propName in span1) {\r\n        if (propName !== 'range' && propName !== 'allDay') {\r\n            if (span0[propName] !== span1[propName]) {\r\n                return false;\r\n            }\r\n        }\r\n    }\r\n    // are there any props that span0 has that span1 DOESN'T have?\r\n    // both have range/allDay, so no need to special-case.\r\n    for (var propName in span0) {\r\n        if (!(propName in span1)) {\r\n            return false;\r\n        }\r\n    }\r\n    return true;\r\n}\r\nfunction buildDateSpanApi(span, dateEnv) {\r\n    return {\r\n        start: dateEnv.toDate(span.range.start),\r\n        end: dateEnv.toDate(span.range.end),\r\n        startStr: dateEnv.formatIso(span.range.start, { omitTime: span.allDay }),\r\n        endStr: dateEnv.formatIso(span.range.end, { omitTime: span.allDay }),\r\n        allDay: span.allDay\r\n    };\r\n}\r\nfunction buildDatePointApi(span, dateEnv) {\r\n    return {\r\n        date: dateEnv.toDate(span.range.start),\r\n        dateStr: dateEnv.formatIso(span.range.start, { omitTime: span.allDay }),\r\n        allDay: span.allDay\r\n    };\r\n}\r\nfunction fabricateEventRange(dateSpan, eventUiBases, calendar) {\r\n    var def = parseEventDef({ editable: false }, '', // sourceId\r\n    dateSpan.allDay, true, // hasEnd\r\n    calendar);\r\n    return {\r\n        def: def,\r\n        ui: compileEventUi(def, eventUiBases),\r\n        instance: createEventInstance(def.defId, dateSpan.range),\r\n        range: dateSpan.range,\r\n        isStart: true,\r\n        isEnd: true\r\n    };\r\n}\r\n\r\nfunction compileViewDefs(defaultConfigs, overrideConfigs) {\r\n    var hash = {};\r\n    var viewType;\r\n    for (viewType in defaultConfigs) {\r\n        ensureViewDef(viewType, hash, defaultConfigs, overrideConfigs);\r\n    }\r\n    for (viewType in overrideConfigs) {\r\n        ensureViewDef(viewType, hash, defaultConfigs, overrideConfigs);\r\n    }\r\n    return hash;\r\n}\r\nfunction ensureViewDef(viewType, hash, defaultConfigs, overrideConfigs) {\r\n    if (hash[viewType]) {\r\n        return hash[viewType];\r\n    }\r\n    var viewDef = buildViewDef(viewType, hash, defaultConfigs, overrideConfigs);\r\n    if (viewDef) {\r\n        hash[viewType] = viewDef;\r\n    }\r\n    return viewDef;\r\n}\r\nfunction buildViewDef(viewType, hash, defaultConfigs, overrideConfigs) {\r\n    var defaultConfig = defaultConfigs[viewType];\r\n    var overrideConfig = overrideConfigs[viewType];\r\n    var queryProp = function (name) {\r\n        return (defaultConfig && defaultConfig[name] !== null) ? defaultConfig[name] :\r\n            ((overrideConfig && overrideConfig[name] !== null) ? overrideConfig[name] : null);\r\n    };\r\n    var theClass = queryProp('class');\r\n    var superType = queryProp('superType');\r\n    if (!superType && theClass) {\r\n        superType =\r\n            findViewNameBySubclass(theClass, overrideConfigs) ||\r\n                findViewNameBySubclass(theClass, defaultConfigs);\r\n    }\r\n    var superDef = null;\r\n    if (superType) {\r\n        if (superType === viewType) {\r\n            throw new Error('Can\\'t have a custom view type that references itself');\r\n        }\r\n        superDef = ensureViewDef(superType, hash, defaultConfigs, overrideConfigs);\r\n    }\r\n    if (!theClass && superDef) {\r\n        theClass = superDef.class;\r\n    }\r\n    if (!theClass) {\r\n        return null; // don't throw a warning, might be settings for a single-unit view\r\n    }\r\n    return {\r\n        type: viewType,\r\n        class: theClass,\r\n        defaults: __assign({}, (superDef ? superDef.defaults : {}), (defaultConfig ? defaultConfig.options : {})),\r\n        overrides: __assign({}, (superDef ? superDef.overrides : {}), (overrideConfig ? overrideConfig.options : {}))\r\n    };\r\n}\r\nfunction findViewNameBySubclass(viewSubclass, configs) {\r\n    var superProto = Object.getPrototypeOf(viewSubclass.prototype);\r\n    for (var viewType in configs) {\r\n        var parsed = configs[viewType];\r\n        // need DIRECT subclass, so instanceof won't do it\r\n        if (parsed.class && parsed.class.prototype === superProto) {\r\n            return viewType;\r\n        }\r\n    }\r\n    return '';\r\n}\r\n\r\nfunction parseViewConfigs(inputs) {\r\n    return mapHash(inputs, parseViewConfig);\r\n}\r\nvar VIEW_DEF_PROPS = {\r\n    type: String,\r\n    class: null\r\n};\r\nfunction parseViewConfig(input) {\r\n    if (typeof input === 'function') {\r\n        input = { class: input };\r\n    }\r\n    var options = {};\r\n    var props = refineProps(input, VIEW_DEF_PROPS, {}, options);\r\n    return {\r\n        superType: props.type,\r\n        class: props.class,\r\n        options: options\r\n    };\r\n}\r\n\r\nfunction buildViewSpecs(defaultInputs, optionsManager) {\r\n    var defaultConfigs = parseViewConfigs(defaultInputs);\r\n    var overrideConfigs = parseViewConfigs(optionsManager.overrides.views);\r\n    var viewDefs = compileViewDefs(defaultConfigs, overrideConfigs);\r\n    return mapHash(viewDefs, function (viewDef) {\r\n        return buildViewSpec(viewDef, overrideConfigs, optionsManager);\r\n    });\r\n}\r\nfunction buildViewSpec(viewDef, overrideConfigs, optionsManager) {\r\n    var durationInput = viewDef.overrides.duration ||\r\n        viewDef.defaults.duration ||\r\n        optionsManager.dynamicOverrides.duration ||\r\n        optionsManager.overrides.duration;\r\n    var duration = null;\r\n    var durationUnit = '';\r\n    var singleUnit = '';\r\n    var singleUnitOverrides = {};\r\n    if (durationInput) {\r\n        duration = createDuration(durationInput);\r\n        if (duration) { // valid?\r\n            var denom = greatestDurationDenominator(duration, !getWeeksFromInput(durationInput));\r\n            durationUnit = denom.unit;\r\n            if (denom.value === 1) {\r\n                singleUnit = durationUnit;\r\n                singleUnitOverrides = overrideConfigs[durationUnit] ? overrideConfigs[durationUnit].options : {};\r\n            }\r\n        }\r\n    }\r\n    var queryButtonText = function (options) {\r\n        var buttonTextMap = options.buttonText || {};\r\n        var buttonTextKey = viewDef.defaults.buttonTextKey;\r\n        if (buttonTextKey != null && buttonTextMap[buttonTextKey] != null) {\r\n            return buttonTextMap[buttonTextKey];\r\n        }\r\n        if (buttonTextMap[viewDef.type] != null) {\r\n            return buttonTextMap[viewDef.type];\r\n        }\r\n        if (buttonTextMap[singleUnit] != null) {\r\n            return buttonTextMap[singleUnit];\r\n        }\r\n    };\r\n    return {\r\n        type: viewDef.type,\r\n        class: viewDef.class,\r\n        duration: duration,\r\n        durationUnit: durationUnit,\r\n        singleUnit: singleUnit,\r\n        options: __assign({}, globalDefaults, viewDef.defaults, optionsManager.dirDefaults, optionsManager.localeDefaults, optionsManager.overrides, singleUnitOverrides, viewDef.overrides, optionsManager.dynamicOverrides),\r\n        buttonTextOverride: queryButtonText(optionsManager.dynamicOverrides) ||\r\n            queryButtonText(optionsManager.overrides) || // constructor-specified buttonText lookup hash takes precedence\r\n            viewDef.overrides.buttonText,\r\n        buttonTextDefault: queryButtonText(optionsManager.localeDefaults) ||\r\n            queryButtonText(optionsManager.dirDefaults) ||\r\n            viewDef.defaults.buttonText ||\r\n            queryButtonText(globalDefaults) ||\r\n            viewDef.type // fall back to given view name\r\n    };\r\n}\r\n\r\nvar Toolbar = /** @class */ (function (_super) {\r\n    __extends(Toolbar, _super);\r\n    function Toolbar(context, extraClassName) {\r\n        var _this = _super.call(this, context) || this;\r\n        _this._renderLayout = memoizeRendering(_this.renderLayout, _this.unrenderLayout);\r\n        _this._updateTitle = memoizeRendering(_this.updateTitle, null, [_this._renderLayout]);\r\n        _this._updateActiveButton = memoizeRendering(_this.updateActiveButton, null, [_this._renderLayout]);\r\n        _this._updateToday = memoizeRendering(_this.updateToday, null, [_this._renderLayout]);\r\n        _this._updatePrev = memoizeRendering(_this.updatePrev, null, [_this._renderLayout]);\r\n        _this._updateNext = memoizeRendering(_this.updateNext, null, [_this._renderLayout]);\r\n        _this.el = createElement('div', { className: 'fc-toolbar ' + extraClassName });\r\n        return _this;\r\n    }\r\n    Toolbar.prototype.destroy = function () {\r\n        _super.prototype.destroy.call(this);\r\n        this._renderLayout.unrender(); // should unrender everything else\r\n        removeElement(this.el);\r\n    };\r\n    Toolbar.prototype.render = function (props) {\r\n        this._renderLayout(props.layout);\r\n        this._updateTitle(props.title);\r\n        this._updateActiveButton(props.activeButton);\r\n        this._updateToday(props.isTodayEnabled);\r\n        this._updatePrev(props.isPrevEnabled);\r\n        this._updateNext(props.isNextEnabled);\r\n    };\r\n    Toolbar.prototype.renderLayout = function (layout) {\r\n        var el = this.el;\r\n        this.viewsWithButtons = [];\r\n        appendToElement(el, this.renderSection('left', layout.left));\r\n        appendToElement(el, this.renderSection('center', layout.center));\r\n        appendToElement(el, this.renderSection('right', layout.right));\r\n    };\r\n    Toolbar.prototype.unrenderLayout = function () {\r\n        this.el.innerHTML = '';\r\n    };\r\n    Toolbar.prototype.renderSection = function (position, buttonStr) {\r\n        var _this = this;\r\n        var _a = this, theme = _a.theme, calendar = _a.calendar;\r\n        var optionsManager = calendar.optionsManager;\r\n        var viewSpecs = calendar.viewSpecs;\r\n        var sectionEl = createElement('div', { className: 'fc-' + position });\r\n        var calendarCustomButtons = optionsManager.computed.customButtons || {};\r\n        var calendarButtonTextOverrides = optionsManager.overrides.buttonText || {};\r\n        var calendarButtonText = optionsManager.computed.buttonText || {};\r\n        if (buttonStr) {\r\n            buttonStr.split(' ').forEach(function (buttonGroupStr, i) {\r\n                var groupChildren = [];\r\n                var isOnlyButtons = true;\r\n                var groupEl;\r\n                buttonGroupStr.split(',').forEach(function (buttonName, j) {\r\n                    var customButtonProps;\r\n                    var viewSpec;\r\n                    var buttonClick;\r\n                    var buttonIcon; // only one of these will be set\r\n                    var buttonText; // \"\r\n                    var buttonInnerHtml;\r\n                    var buttonClasses;\r\n                    var buttonEl;\r\n                    var buttonAriaAttr;\r\n                    if (buttonName === 'title') {\r\n                        groupChildren.push(htmlToElement('<h2>&nbsp;</h2>')); // we always want it to take up height\r\n                        isOnlyButtons = false;\r\n                    }\r\n                    else {\r\n                        if ((customButtonProps = calendarCustomButtons[buttonName])) {\r\n                            buttonClick = function (ev) {\r\n                                if (customButtonProps.click) {\r\n                                    customButtonProps.click.call(buttonEl, ev);\r\n                                }\r\n                            };\r\n                            (buttonIcon = theme.getCustomButtonIconClass(customButtonProps)) ||\r\n                                (buttonIcon = theme.getIconClass(buttonName)) ||\r\n                                (buttonText = customButtonProps.text);\r\n                        }\r\n                        else if ((viewSpec = viewSpecs[buttonName])) {\r\n                            _this.viewsWithButtons.push(buttonName);\r\n                            buttonClick = function () {\r\n                                calendar.changeView(buttonName);\r\n                            };\r\n                            (buttonText = viewSpec.buttonTextOverride) ||\r\n                                (buttonIcon = theme.getIconClass(buttonName)) ||\r\n                                (buttonText = viewSpec.buttonTextDefault);\r\n                        }\r\n                        else if (calendar[buttonName]) { // a calendar method\r\n                            buttonClick = function () {\r\n                                calendar[buttonName]();\r\n                            };\r\n                            (buttonText = calendarButtonTextOverrides[buttonName]) ||\r\n                                (buttonIcon = theme.getIconClass(buttonName)) ||\r\n                                (buttonText = calendarButtonText[buttonName]);\r\n                            //            ^ everything else is considered default\r\n                        }\r\n                        if (buttonClick) {\r\n                            buttonClasses = [\r\n                                'fc-' + buttonName + '-button',\r\n                                theme.getClass('button')\r\n                            ];\r\n                            if (buttonText) {\r\n                                buttonInnerHtml = htmlEscape(buttonText);\r\n                                buttonAriaAttr = '';\r\n                            }\r\n                            else if (buttonIcon) {\r\n                                buttonInnerHtml = \"<span class='\" + buttonIcon + \"'></span>\";\r\n                                buttonAriaAttr = ' aria-label=\"' + buttonName + '\"';\r\n                            }\r\n                            buttonEl = htmlToElement(// type=\"button\" so that it doesn't submit a form\r\n                            '<button type=\"button\" class=\"' + buttonClasses.join(' ') + '\"' +\r\n                                buttonAriaAttr +\r\n                                '>' + buttonInnerHtml + '</button>');\r\n                            buttonEl.addEventListener('click', buttonClick);\r\n                            groupChildren.push(buttonEl);\r\n                        }\r\n                    }\r\n                });\r\n                if (groupChildren.length > 1) {\r\n                    groupEl = document.createElement('div');\r\n                    var buttonGroupClassName = theme.getClass('buttonGroup');\r\n                    if (isOnlyButtons && buttonGroupClassName) {\r\n                        groupEl.classList.add(buttonGroupClassName);\r\n                    }\r\n                    appendToElement(groupEl, groupChildren);\r\n                    sectionEl.appendChild(groupEl);\r\n                }\r\n                else {\r\n                    appendToElement(sectionEl, groupChildren); // 1 or 0 children\r\n                }\r\n            });\r\n        }\r\n        return sectionEl;\r\n    };\r\n    Toolbar.prototype.updateToday = function (isTodayEnabled) {\r\n        this.toggleButtonEnabled('today', isTodayEnabled);\r\n    };\r\n    Toolbar.prototype.updatePrev = function (isPrevEnabled) {\r\n        this.toggleButtonEnabled('prev', isPrevEnabled);\r\n    };\r\n    Toolbar.prototype.updateNext = function (isNextEnabled) {\r\n        this.toggleButtonEnabled('next', isNextEnabled);\r\n    };\r\n    Toolbar.prototype.updateTitle = function (text) {\r\n        findElements(this.el, 'h2').forEach(function (titleEl) {\r\n            titleEl.innerText = text;\r\n        });\r\n    };\r\n    Toolbar.prototype.updateActiveButton = function (buttonName) {\r\n        var className = this.theme.getClass('buttonActive');\r\n        findElements(this.el, 'button').forEach(function (buttonEl) {\r\n            if (buttonName && buttonEl.classList.contains('fc-' + buttonName + '-button')) {\r\n                buttonEl.classList.add(className);\r\n            }\r\n            else {\r\n                buttonEl.classList.remove(className);\r\n            }\r\n        });\r\n    };\r\n    Toolbar.prototype.toggleButtonEnabled = function (buttonName, bool) {\r\n        findElements(this.el, '.fc-' + buttonName + '-button').forEach(function (buttonEl) {\r\n            buttonEl.disabled = !bool;\r\n        });\r\n    };\r\n    return Toolbar;\r\n}(Component));\r\n\r\nvar CalendarComponent = /** @class */ (function (_super) {\r\n    __extends(CalendarComponent, _super);\r\n    function CalendarComponent(context, el) {\r\n        var _this = _super.call(this, context) || this;\r\n        _this._renderToolbars = memoizeRendering(_this.renderToolbars);\r\n        _this.buildViewPropTransformers = memoize(buildViewPropTransformers);\r\n        _this.el = el;\r\n        prependToElement(el, _this.contentEl = createElement('div', { className: 'fc-view-container' }));\r\n        var calendar = _this.calendar;\r\n        for (var _i = 0, _a = calendar.pluginSystem.hooks.viewContainerModifiers; _i < _a.length; _i++) {\r\n            var modifyViewContainer = _a[_i];\r\n            modifyViewContainer(_this.contentEl, calendar);\r\n        }\r\n        _this.toggleElClassNames(true);\r\n        _this.computeTitle = memoize(computeTitle);\r\n        _this.parseBusinessHours = memoize(function (input) {\r\n            return parseBusinessHours(input, _this.calendar);\r\n        });\r\n        return _this;\r\n    }\r\n    CalendarComponent.prototype.destroy = function () {\r\n        if (this.header) {\r\n            this.header.destroy();\r\n        }\r\n        if (this.footer) {\r\n            this.footer.destroy();\r\n        }\r\n        if (this.view) {\r\n            this.view.destroy();\r\n        }\r\n        removeElement(this.contentEl);\r\n        this.toggleElClassNames(false);\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    CalendarComponent.prototype.toggleElClassNames = function (bool) {\r\n        var classList = this.el.classList;\r\n        var dirClassName = 'fc-' + this.opt('dir');\r\n        var themeClassName = this.theme.getClass('widget');\r\n        if (bool) {\r\n            classList.add('fc');\r\n            classList.add(dirClassName);\r\n            classList.add(themeClassName);\r\n        }\r\n        else {\r\n            classList.remove('fc');\r\n            classList.remove(dirClassName);\r\n            classList.remove(themeClassName);\r\n        }\r\n    };\r\n    CalendarComponent.prototype.render = function (props) {\r\n        this.freezeHeight();\r\n        var title = this.computeTitle(props.dateProfile, props.viewSpec.options);\r\n        this._renderToolbars(props.viewSpec, props.dateProfile, props.currentDate, props.dateProfileGenerator, title);\r\n        this.renderView(props, title);\r\n        this.updateSize();\r\n        this.thawHeight();\r\n    };\r\n    CalendarComponent.prototype.renderToolbars = function (viewSpec, dateProfile, currentDate, dateProfileGenerator, title) {\r\n        var headerLayout = this.opt('header');\r\n        var footerLayout = this.opt('footer');\r\n        var now = this.calendar.getNow();\r\n        var todayInfo = dateProfileGenerator.build(now);\r\n        var prevInfo = dateProfileGenerator.buildPrev(dateProfile, currentDate);\r\n        var nextInfo = dateProfileGenerator.buildNext(dateProfile, currentDate);\r\n        var toolbarProps = {\r\n            title: title,\r\n            activeButton: viewSpec.type,\r\n            isTodayEnabled: todayInfo.isValid && !rangeContainsMarker(dateProfile.currentRange, now),\r\n            isPrevEnabled: prevInfo.isValid,\r\n            isNextEnabled: nextInfo.isValid\r\n        };\r\n        if (headerLayout) {\r\n            if (!this.header) {\r\n                this.header = new Toolbar(this.context, 'fc-header-toolbar');\r\n                prependToElement(this.el, this.header.el);\r\n            }\r\n            this.header.receiveProps(__assign({ layout: headerLayout }, toolbarProps));\r\n        }\r\n        else if (this.header) {\r\n            this.header.destroy();\r\n            this.header = null;\r\n        }\r\n        if (footerLayout) {\r\n            if (!this.footer) {\r\n                this.footer = new Toolbar(this.context, 'fc-footer-toolbar');\r\n                appendToElement(this.el, this.footer.el);\r\n            }\r\n            this.footer.receiveProps(__assign({ layout: footerLayout }, toolbarProps));\r\n        }\r\n        else if (this.footer) {\r\n            this.footer.destroy();\r\n            this.footer = null;\r\n        }\r\n    };\r\n    CalendarComponent.prototype.renderView = function (props, title) {\r\n        var view = this.view;\r\n        var viewSpec = props.viewSpec, dateProfileGenerator = props.dateProfileGenerator;\r\n        if (!view || view.viewSpec !== viewSpec) {\r\n            if (view) {\r\n                view.destroy();\r\n            }\r\n            view = this.view = new viewSpec['class']({\r\n                calendar: this.calendar,\r\n                view: null,\r\n                dateEnv: this.dateEnv,\r\n                theme: this.theme,\r\n                options: viewSpec.options\r\n            }, viewSpec, dateProfileGenerator, this.contentEl);\r\n        }\r\n        else {\r\n            view.addScroll(view.queryScroll());\r\n        }\r\n        view.title = title; // for the API\r\n        var viewProps = {\r\n            dateProfile: props.dateProfile,\r\n            businessHours: this.parseBusinessHours(viewSpec.options.businessHours),\r\n            eventStore: props.eventStore,\r\n            eventUiBases: props.eventUiBases,\r\n            dateSelection: props.dateSelection,\r\n            eventSelection: props.eventSelection,\r\n            eventDrag: props.eventDrag,\r\n            eventResize: props.eventResize\r\n        };\r\n        var transformers = this.buildViewPropTransformers(this.calendar.pluginSystem.hooks.viewPropsTransformers);\r\n        for (var _i = 0, transformers_1 = transformers; _i < transformers_1.length; _i++) {\r\n            var transformer = transformers_1[_i];\r\n            __assign(viewProps, transformer.transform(viewProps, viewSpec, props, view));\r\n        }\r\n        view.receiveProps(viewProps);\r\n    };\r\n    // Sizing\r\n    // -----------------------------------------------------------------------------------------------------------------\r\n    CalendarComponent.prototype.updateSize = function (isResize) {\r\n        if (isResize === void 0) { isResize = false; }\r\n        var view = this.view;\r\n        if (isResize) {\r\n            view.addScroll(view.queryScroll());\r\n        }\r\n        if (isResize || this.isHeightAuto == null) {\r\n            this.computeHeightVars();\r\n        }\r\n        view.updateSize(isResize, this.viewHeight, this.isHeightAuto);\r\n        view.updateNowIndicator(); // we need to guarantee this will run after updateSize\r\n        view.popScroll(isResize);\r\n    };\r\n    CalendarComponent.prototype.computeHeightVars = function () {\r\n        var calendar = this.calendar; // yuck. need to handle dynamic options\r\n        var heightInput = calendar.opt('height');\r\n        var contentHeightInput = calendar.opt('contentHeight');\r\n        this.isHeightAuto = heightInput === 'auto' || contentHeightInput === 'auto';\r\n        if (typeof contentHeightInput === 'number') { // exists and not 'auto'\r\n            this.viewHeight = contentHeightInput;\r\n        }\r\n        else if (typeof contentHeightInput === 'function') { // exists and is a function\r\n            this.viewHeight = contentHeightInput();\r\n        }\r\n        else if (typeof heightInput === 'number') { // exists and not 'auto'\r\n            this.viewHeight = heightInput - this.queryToolbarsHeight();\r\n        }\r\n        else if (typeof heightInput === 'function') { // exists and is a function\r\n            this.viewHeight = heightInput() - this.queryToolbarsHeight();\r\n        }\r\n        else if (heightInput === 'parent') { // set to height of parent element\r\n            var parentEl = this.el.parentNode;\r\n            this.viewHeight = parentEl.getBoundingClientRect().height - this.queryToolbarsHeight();\r\n        }\r\n        else {\r\n            this.viewHeight = Math.round(this.contentEl.getBoundingClientRect().width /\r\n                Math.max(calendar.opt('aspectRatio'), .5));\r\n        }\r\n    };\r\n    CalendarComponent.prototype.queryToolbarsHeight = function () {\r\n        var height = 0;\r\n        if (this.header) {\r\n            height += computeHeightAndMargins(this.header.el);\r\n        }\r\n        if (this.footer) {\r\n            height += computeHeightAndMargins(this.footer.el);\r\n        }\r\n        return height;\r\n    };\r\n    // Height \"Freezing\"\r\n    // -----------------------------------------------------------------------------------------------------------------\r\n    CalendarComponent.prototype.freezeHeight = function () {\r\n        applyStyle(this.el, {\r\n            height: this.el.getBoundingClientRect().height,\r\n            overflow: 'hidden'\r\n        });\r\n    };\r\n    CalendarComponent.prototype.thawHeight = function () {\r\n        applyStyle(this.el, {\r\n            height: '',\r\n            overflow: ''\r\n        });\r\n    };\r\n    return CalendarComponent;\r\n}(Component));\r\n// Title and Date Formatting\r\n// -----------------------------------------------------------------------------------------------------------------\r\n// Computes what the title at the top of the calendar should be for this view\r\nfunction computeTitle(dateProfile, viewOptions) {\r\n    var range;\r\n    // for views that span a large unit of time, show the proper interval, ignoring stray days before and after\r\n    if (/^(year|month)$/.test(dateProfile.currentRangeUnit)) {\r\n        range = dateProfile.currentRange;\r\n    }\r\n    else { // for day units or smaller, use the actual day range\r\n        range = dateProfile.activeRange;\r\n    }\r\n    return this.dateEnv.formatRange(range.start, range.end, createFormatter(viewOptions.titleFormat || computeTitleFormat(dateProfile), viewOptions.titleRangeSeparator), { isEndExclusive: dateProfile.isRangeAllDay });\r\n}\r\n// Generates the format string that should be used to generate the title for the current date range.\r\n// Attempts to compute the most appropriate format if not explicitly specified with `titleFormat`.\r\nfunction computeTitleFormat(dateProfile) {\r\n    var currentRangeUnit = dateProfile.currentRangeUnit;\r\n    if (currentRangeUnit === 'year') {\r\n        return { year: 'numeric' };\r\n    }\r\n    else if (currentRangeUnit === 'month') {\r\n        return { year: 'numeric', month: 'long' }; // like \"September 2014\"\r\n    }\r\n    else {\r\n        var days = diffWholeDays(dateProfile.currentRange.start, dateProfile.currentRange.end);\r\n        if (days !== null && days > 1) {\r\n            // multi-day range. shorter, like \"Sep 9 - 10 2014\"\r\n            return { year: 'numeric', month: 'short', day: 'numeric' };\r\n        }\r\n        else {\r\n            // one day. longer, like \"September 9 2014\"\r\n            return { year: 'numeric', month: 'long', day: 'numeric' };\r\n        }\r\n    }\r\n}\r\n// Plugin\r\n// -----------------------------------------------------------------------------------------------------------------\r\nfunction buildViewPropTransformers(theClasses) {\r\n    return theClasses.map(function (theClass) {\r\n        return new theClass();\r\n    });\r\n}\r\n\r\nvar Interaction = /** @class */ (function () {\r\n    function Interaction(settings) {\r\n        this.component = settings.component;\r\n    }\r\n    Interaction.prototype.destroy = function () {\r\n    };\r\n    return Interaction;\r\n}());\r\nfunction parseInteractionSettings(component, input) {\r\n    return {\r\n        component: component,\r\n        el: input.el,\r\n        useEventCenter: input.useEventCenter != null ? input.useEventCenter : true\r\n    };\r\n}\r\nfunction interactionSettingsToStore(settings) {\r\n    var _a;\r\n    return _a = {},\r\n        _a[settings.component.uid] = settings,\r\n        _a;\r\n}\r\n// global state\r\nvar interactionSettingsStore = {};\r\n\r\n/*\r\nDetects when the user clicks on an event within a DateComponent\r\n*/\r\nvar EventClicking = /** @class */ (function (_super) {\r\n    __extends(EventClicking, _super);\r\n    function EventClicking(settings) {\r\n        var _this = _super.call(this, settings) || this;\r\n        _this.handleSegClick = function (ev, segEl) {\r\n            var component = _this.component;\r\n            var seg = getElSeg(segEl);\r\n            if (seg && // might be the <div> surrounding the more link\r\n                component.isValidSegDownEl(ev.target)) {\r\n                // our way to simulate a link click for elements that can't be <a> tags\r\n                // grab before trigger fired in case trigger trashes DOM thru rerendering\r\n                var hasUrlContainer = elementClosest(ev.target, '.fc-has-url');\r\n                var url = hasUrlContainer ? hasUrlContainer.querySelector('a[href]').href : '';\r\n                component.publiclyTrigger('eventClick', [\r\n                    {\r\n                        el: segEl,\r\n                        event: new EventApi(component.calendar, seg.eventRange.def, seg.eventRange.instance),\r\n                        jsEvent: ev,\r\n                        view: component.view\r\n                    }\r\n                ]);\r\n                if (url && !ev.defaultPrevented) {\r\n                    window.location.href = url;\r\n                }\r\n            }\r\n        };\r\n        var component = settings.component;\r\n        _this.destroy = listenBySelector(component.el, 'click', component.fgSegSelector + ',' + component.bgSegSelector, _this.handleSegClick);\r\n        return _this;\r\n    }\r\n    return EventClicking;\r\n}(Interaction));\r\n\r\n/*\r\nTriggers events and adds/removes core classNames when the user's pointer\r\nenters/leaves event-elements of a component.\r\n*/\r\nvar EventHovering = /** @class */ (function (_super) {\r\n    __extends(EventHovering, _super);\r\n    function EventHovering(settings) {\r\n        var _this = _super.call(this, settings) || this;\r\n        // for simulating an eventMouseLeave when the event el is destroyed while mouse is over it\r\n        _this.handleEventElRemove = function (el) {\r\n            if (el === _this.currentSegEl) {\r\n                _this.handleSegLeave(null, _this.currentSegEl);\r\n            }\r\n        };\r\n        _this.handleSegEnter = function (ev, segEl) {\r\n            if (getElSeg(segEl)) { // TODO: better way to make sure not hovering over more+ link or its wrapper\r\n                segEl.classList.add('fc-allow-mouse-resize');\r\n                _this.currentSegEl = segEl;\r\n                _this.triggerEvent('eventMouseEnter', ev, segEl);\r\n            }\r\n        };\r\n        _this.handleSegLeave = function (ev, segEl) {\r\n            if (_this.currentSegEl) {\r\n                segEl.classList.remove('fc-allow-mouse-resize');\r\n                _this.currentSegEl = null;\r\n                _this.triggerEvent('eventMouseLeave', ev, segEl);\r\n            }\r\n        };\r\n        var component = settings.component;\r\n        _this.removeHoverListeners = listenToHoverBySelector(component.el, component.fgSegSelector + ',' + component.bgSegSelector, _this.handleSegEnter, _this.handleSegLeave);\r\n        component.calendar.on('eventElRemove', _this.handleEventElRemove);\r\n        return _this;\r\n    }\r\n    EventHovering.prototype.destroy = function () {\r\n        this.removeHoverListeners();\r\n        this.component.calendar.off('eventElRemove', this.handleEventElRemove);\r\n    };\r\n    EventHovering.prototype.triggerEvent = function (publicEvName, ev, segEl) {\r\n        var component = this.component;\r\n        var seg = getElSeg(segEl);\r\n        if (!ev || component.isValidSegDownEl(ev.target)) {\r\n            component.publiclyTrigger(publicEvName, [\r\n                {\r\n                    el: segEl,\r\n                    event: new EventApi(this.component.calendar, seg.eventRange.def, seg.eventRange.instance),\r\n                    jsEvent: ev,\r\n                    view: component.view\r\n                }\r\n            ]);\r\n        }\r\n    };\r\n    return EventHovering;\r\n}(Interaction));\r\n\r\nvar StandardTheme = /** @class */ (function (_super) {\r\n    __extends(StandardTheme, _super);\r\n    function StandardTheme() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    return StandardTheme;\r\n}(Theme));\r\nStandardTheme.prototype.classes = {\r\n    widget: 'fc-unthemed',\r\n    widgetHeader: 'fc-widget-header',\r\n    widgetContent: 'fc-widget-content',\r\n    buttonGroup: 'fc-button-group',\r\n    button: 'fc-button fc-button-primary',\r\n    buttonActive: 'fc-button-active',\r\n    popoverHeader: 'fc-widget-header',\r\n    popoverContent: 'fc-widget-content',\r\n    // day grid\r\n    headerRow: 'fc-widget-header',\r\n    dayRow: 'fc-widget-content',\r\n    // list view\r\n    listView: 'fc-widget-content'\r\n};\r\nStandardTheme.prototype.baseIconClass = 'fc-icon';\r\nStandardTheme.prototype.iconClasses = {\r\n    close: 'fc-icon-x',\r\n    prev: 'fc-icon-chevron-left',\r\n    next: 'fc-icon-chevron-right',\r\n    prevYear: 'fc-icon-chevrons-left',\r\n    nextYear: 'fc-icon-chevrons-right'\r\n};\r\nStandardTheme.prototype.iconOverrideOption = 'buttonIcons';\r\nStandardTheme.prototype.iconOverrideCustomButtonOption = 'icon';\r\nStandardTheme.prototype.iconOverridePrefix = 'fc-icon-';\r\n\r\nvar Calendar = /** @class */ (function () {\r\n    function Calendar(el, overrides) {\r\n        var _this = this;\r\n        this.parseRawLocales = memoize(parseRawLocales);\r\n        this.buildLocale = memoize(buildLocale);\r\n        this.buildDateEnv = memoize(buildDateEnv);\r\n        this.buildTheme = memoize(buildTheme);\r\n        this.buildEventUiSingleBase = memoize(this._buildEventUiSingleBase);\r\n        this.buildSelectionConfig = memoize(this._buildSelectionConfig);\r\n        this.buildEventUiBySource = memoizeOutput(buildEventUiBySource, isPropsEqual);\r\n        this.buildEventUiBases = memoize(buildEventUiBases);\r\n        this.interactionsStore = {};\r\n        this.actionQueue = [];\r\n        this.isReducing = false;\r\n        // isDisplaying: boolean = false // installed in DOM? accepting renders?\r\n        this.needsRerender = false; // needs a render?\r\n        this.needsFullRerender = false;\r\n        this.isRendering = false; // currently in the executeRender function?\r\n        this.renderingPauseDepth = 0;\r\n        this.buildDelayedRerender = memoize(buildDelayedRerender);\r\n        this.afterSizingTriggers = {};\r\n        this.isViewUpdated = false;\r\n        this.isDatesUpdated = false;\r\n        this.isEventsUpdated = false;\r\n        this.el = el;\r\n        this.optionsManager = new OptionsManager(overrides || {});\r\n        this.pluginSystem = new PluginSystem();\r\n        // only do once. don't do in handleOptions. because can't remove plugins\r\n        this.addPluginInputs(this.optionsManager.computed.plugins || []);\r\n        this.handleOptions(this.optionsManager.computed);\r\n        this.publiclyTrigger('_init'); // for tests\r\n        this.hydrate();\r\n        this.calendarInteractions = this.pluginSystem.hooks.calendarInteractions\r\n            .map(function (calendarInteractionClass) {\r\n            return new calendarInteractionClass(_this);\r\n        });\r\n    }\r\n    Calendar.prototype.addPluginInputs = function (pluginInputs) {\r\n        var pluginDefs = refinePluginDefs(pluginInputs);\r\n        for (var _i = 0, pluginDefs_1 = pluginDefs; _i < pluginDefs_1.length; _i++) {\r\n            var pluginDef = pluginDefs_1[_i];\r\n            this.pluginSystem.add(pluginDef);\r\n        }\r\n    };\r\n    Object.defineProperty(Calendar.prototype, \"view\", {\r\n        // public API\r\n        get: function () {\r\n            return this.component ? this.component.view : null;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    // Public API for rendering\r\n    // -----------------------------------------------------------------------------------------------------------------\r\n    Calendar.prototype.render = function () {\r\n        if (!this.component) {\r\n            this.renderableEventStore = createEmptyEventStore();\r\n            this.bindHandlers();\r\n            this.executeRender();\r\n        }\r\n        else {\r\n            this.requestRerender(true);\r\n        }\r\n    };\r\n    Calendar.prototype.destroy = function () {\r\n        if (this.component) {\r\n            this.unbindHandlers();\r\n            this.component.destroy(); // don't null-out. in case API needs access\r\n            this.component = null; // umm ???\r\n            for (var _i = 0, _a = this.calendarInteractions; _i < _a.length; _i++) {\r\n                var interaction = _a[_i];\r\n                interaction.destroy();\r\n            }\r\n            this.publiclyTrigger('_destroyed');\r\n        }\r\n    };\r\n    // Handlers\r\n    // -----------------------------------------------------------------------------------------------------------------\r\n    Calendar.prototype.bindHandlers = function () {\r\n        var _this = this;\r\n        // event delegation for nav links\r\n        this.removeNavLinkListener = listenBySelector(this.el, 'click', 'a[data-goto]', function (ev, anchorEl) {\r\n            var gotoOptions = anchorEl.getAttribute('data-goto');\r\n            gotoOptions = gotoOptions ? JSON.parse(gotoOptions) : {};\r\n            var dateEnv = _this.dateEnv;\r\n            var dateMarker = dateEnv.createMarker(gotoOptions.date);\r\n            var viewType = gotoOptions.type;\r\n            // property like \"navLinkDayClick\". might be a string or a function\r\n            var customAction = _this.viewOpt('navLink' + capitaliseFirstLetter(viewType) + 'Click');\r\n            if (typeof customAction === 'function') {\r\n                customAction(dateEnv.toDate(dateMarker), ev);\r\n            }\r\n            else {\r\n                if (typeof customAction === 'string') {\r\n                    viewType = customAction;\r\n                }\r\n                _this.zoomTo(dateMarker, viewType);\r\n            }\r\n        });\r\n        if (this.opt('handleWindowResize')) {\r\n            window.addEventListener('resize', this.windowResizeProxy = debounce(// prevents rapid calls\r\n            this.windowResize.bind(this), this.opt('windowResizeDelay')));\r\n        }\r\n    };\r\n    Calendar.prototype.unbindHandlers = function () {\r\n        this.removeNavLinkListener();\r\n        if (this.windowResizeProxy) {\r\n            window.removeEventListener('resize', this.windowResizeProxy);\r\n            this.windowResizeProxy = null;\r\n        }\r\n    };\r\n    // Dispatcher\r\n    // -----------------------------------------------------------------------------------------------------------------\r\n    Calendar.prototype.hydrate = function () {\r\n        var _this = this;\r\n        this.state = this.buildInitialState();\r\n        var rawSources = this.opt('eventSources') || [];\r\n        var singleRawSource = this.opt('events');\r\n        var sources = []; // parsed\r\n        if (singleRawSource) {\r\n            rawSources.unshift(singleRawSource);\r\n        }\r\n        for (var _i = 0, rawSources_1 = rawSources; _i < rawSources_1.length; _i++) {\r\n            var rawSource = rawSources_1[_i];\r\n            var source = parseEventSource(rawSource, this);\r\n            if (source) {\r\n                sources.push(source);\r\n            }\r\n        }\r\n        this.batchRendering(function () {\r\n            _this.dispatch({ type: 'INIT' }); // pass in sources here?\r\n            _this.dispatch({ type: 'ADD_EVENT_SOURCES', sources: sources });\r\n            _this.dispatch({\r\n                type: 'SET_VIEW_TYPE',\r\n                viewType: _this.opt('defaultView') || _this.pluginSystem.hooks.defaultView\r\n            });\r\n        });\r\n    };\r\n    Calendar.prototype.buildInitialState = function () {\r\n        return {\r\n            viewType: null,\r\n            loadingLevel: 0,\r\n            eventSourceLoadingLevel: 0,\r\n            currentDate: this.getInitialDate(),\r\n            dateProfile: null,\r\n            eventSources: {},\r\n            eventStore: createEmptyEventStore(),\r\n            dateSelection: null,\r\n            eventSelection: '',\r\n            eventDrag: null,\r\n            eventResize: null\r\n        };\r\n    };\r\n    Calendar.prototype.dispatch = function (action) {\r\n        this.actionQueue.push(action);\r\n        if (!this.isReducing) {\r\n            this.isReducing = true;\r\n            var oldState = this.state;\r\n            while (this.actionQueue.length) {\r\n                this.state = this.reduce(this.state, this.actionQueue.shift(), this);\r\n            }\r\n            var newState = this.state;\r\n            this.isReducing = false;\r\n            if (!oldState.loadingLevel && newState.loadingLevel) {\r\n                this.publiclyTrigger('loading', [true]);\r\n            }\r\n            else if (oldState.loadingLevel && !newState.loadingLevel) {\r\n                this.publiclyTrigger('loading', [false]);\r\n            }\r\n            var view = this.component && this.component.view;\r\n            if (oldState.eventStore !== newState.eventStore || this.needsFullRerender) {\r\n                if (oldState.eventStore) {\r\n                    this.isEventsUpdated = true;\r\n                }\r\n            }\r\n            if (oldState.dateProfile !== newState.dateProfile || this.needsFullRerender) {\r\n                if (oldState.dateProfile && view) { // why would view be null!?\r\n                    this.publiclyTrigger('datesDestroy', [\r\n                        {\r\n                            view: view,\r\n                            el: view.el\r\n                        }\r\n                    ]);\r\n                }\r\n                this.isDatesUpdated = true;\r\n            }\r\n            if (oldState.viewType !== newState.viewType || this.needsFullRerender) {\r\n                if (oldState.viewType && view) { // why would view be null!?\r\n                    this.publiclyTrigger('viewSkeletonDestroy', [\r\n                        {\r\n                            view: view,\r\n                            el: view.el\r\n                        }\r\n                    ]);\r\n                }\r\n                this.isViewUpdated = true;\r\n            }\r\n            this.requestRerender();\r\n        }\r\n    };\r\n    Calendar.prototype.reduce = function (state, action, calendar) {\r\n        return reduce(state, action, calendar);\r\n    };\r\n    // Render Queue\r\n    // -----------------------------------------------------------------------------------------------------------------\r\n    Calendar.prototype.requestRerender = function (needsFull) {\r\n        if (needsFull === void 0) { needsFull = false; }\r\n        this.needsRerender = true;\r\n        this.needsFullRerender = this.needsFullRerender || needsFull;\r\n        this.delayedRerender(); // will call a debounced-version of tryRerender\r\n    };\r\n    Calendar.prototype.tryRerender = function () {\r\n        if (this.component && // must be accepting renders\r\n            this.needsRerender && // indicates that a rerender was requested\r\n            !this.renderingPauseDepth && // not paused\r\n            !this.isRendering // not currently in the render loop\r\n        ) {\r\n            this.executeRender();\r\n        }\r\n    };\r\n    Calendar.prototype.batchRendering = function (func) {\r\n        this.renderingPauseDepth++;\r\n        func();\r\n        this.renderingPauseDepth--;\r\n        if (this.needsRerender) {\r\n            this.requestRerender();\r\n        }\r\n    };\r\n    // Rendering\r\n    // -----------------------------------------------------------------------------------------------------------------\r\n    Calendar.prototype.executeRender = function () {\r\n        var needsFullRerender = this.needsFullRerender; // save before clearing\r\n        // clear these BEFORE the render so that new values will accumulate during render\r\n        this.needsRerender = false;\r\n        this.needsFullRerender = false;\r\n        this.isRendering = true;\r\n        this.renderComponent(needsFullRerender);\r\n        this.isRendering = false;\r\n        // received a rerender request while rendering\r\n        if (this.needsRerender) {\r\n            this.delayedRerender();\r\n        }\r\n    };\r\n    /*\r\n    don't call this directly. use executeRender instead\r\n    */\r\n    Calendar.prototype.renderComponent = function (needsFull) {\r\n        var _a = this, state = _a.state, component = _a.component;\r\n        var viewType = state.viewType;\r\n        var viewSpec = this.viewSpecs[viewType];\r\n        var savedScroll = (needsFull && component) ? component.view.queryScroll() : null;\r\n        if (!viewSpec) {\r\n            throw new Error(\"View type \\\"\" + viewType + \"\\\" is not valid\");\r\n        }\r\n        // if event sources are still loading and progressive rendering hasn't been enabled,\r\n        // keep rendering the last fully loaded set of events\r\n        var renderableEventStore = this.renderableEventStore =\r\n            (state.eventSourceLoadingLevel && !this.opt('progressiveEventRendering')) ?\r\n                this.renderableEventStore :\r\n                state.eventStore;\r\n        var eventUiSingleBase = this.buildEventUiSingleBase(viewSpec.options);\r\n        var eventUiBySource = this.buildEventUiBySource(state.eventSources);\r\n        var eventUiBases = this.eventUiBases = this.buildEventUiBases(renderableEventStore.defs, eventUiSingleBase, eventUiBySource);\r\n        if (needsFull || !component) {\r\n            if (component) {\r\n                component.freezeHeight(); // next component will unfreeze it\r\n                component.destroy();\r\n            }\r\n            component = this.component = new CalendarComponent({\r\n                calendar: this,\r\n                view: null,\r\n                dateEnv: this.dateEnv,\r\n                theme: this.theme,\r\n                options: this.optionsManager.computed\r\n            }, this.el);\r\n            this.isViewUpdated = true;\r\n            this.isDatesUpdated = true;\r\n            this.isEventsUpdated = true;\r\n        }\r\n        component.receiveProps(__assign({}, state, { viewSpec: viewSpec, dateProfile: state.dateProfile, dateProfileGenerator: this.dateProfileGenerators[viewType], eventStore: renderableEventStore, eventUiBases: eventUiBases, dateSelection: state.dateSelection, eventSelection: state.eventSelection, eventDrag: state.eventDrag, eventResize: state.eventResize }));\r\n        if (savedScroll) {\r\n            component.view.applyScroll(savedScroll, false);\r\n        }\r\n        if (this.isViewUpdated) {\r\n            this.isViewUpdated = false;\r\n            this.publiclyTrigger('viewSkeletonRender', [\r\n                {\r\n                    view: component.view,\r\n                    el: component.view.el\r\n                }\r\n            ]);\r\n        }\r\n        if (this.isDatesUpdated) {\r\n            this.isDatesUpdated = false;\r\n            this.publiclyTrigger('datesRender', [\r\n                {\r\n                    view: component.view,\r\n                    el: component.view.el\r\n                }\r\n            ]);\r\n        }\r\n        if (this.isEventsUpdated) {\r\n            this.isEventsUpdated = false;\r\n        }\r\n        this.releaseAfterSizingTriggers();\r\n    };\r\n    // Options\r\n    // -----------------------------------------------------------------------------------------------------------------\r\n    Calendar.prototype.setOption = function (name, val) {\r\n        var _a;\r\n        this.mutateOptions((_a = {}, _a[name] = val, _a), [], true);\r\n    };\r\n    Calendar.prototype.getOption = function (name) {\r\n        return this.optionsManager.computed[name];\r\n    };\r\n    Calendar.prototype.opt = function (name) {\r\n        return this.optionsManager.computed[name];\r\n    };\r\n    Calendar.prototype.viewOpt = function (name) {\r\n        return this.viewOpts()[name];\r\n    };\r\n    Calendar.prototype.viewOpts = function () {\r\n        return this.viewSpecs[this.state.viewType].options;\r\n    };\r\n    /*\r\n    handles option changes (like a diff)\r\n    */\r\n    Calendar.prototype.mutateOptions = function (updates, removals, isDynamic, deepEqual) {\r\n        var _this = this;\r\n        var changeHandlers = this.pluginSystem.hooks.optionChangeHandlers;\r\n        var normalUpdates = {};\r\n        var specialUpdates = {};\r\n        var oldDateEnv = this.dateEnv; // do this before handleOptions\r\n        var isTimeZoneDirty = false;\r\n        var isSizeDirty = false;\r\n        var anyDifficultOptions = Boolean(removals.length);\r\n        for (var name_1 in updates) {\r\n            if (changeHandlers[name_1]) {\r\n                specialUpdates[name_1] = updates[name_1];\r\n            }\r\n            else {\r\n                normalUpdates[name_1] = updates[name_1];\r\n            }\r\n        }\r\n        for (var name_2 in normalUpdates) {\r\n            if (/^(height|contentHeight|aspectRatio)$/.test(name_2)) {\r\n                isSizeDirty = true;\r\n            }\r\n            else if (/^(defaultDate|defaultView)$/.test(name_2)) ;\r\n            else {\r\n                anyDifficultOptions = true;\r\n                if (name_2 === 'timeZone') {\r\n                    isTimeZoneDirty = true;\r\n                }\r\n            }\r\n        }\r\n        this.optionsManager.mutate(normalUpdates, removals, isDynamic);\r\n        if (anyDifficultOptions) {\r\n            this.handleOptions(this.optionsManager.computed);\r\n            this.needsFullRerender = true;\r\n        }\r\n        this.batchRendering(function () {\r\n            if (anyDifficultOptions) {\r\n                if (isTimeZoneDirty) {\r\n                    _this.dispatch({\r\n                        type: 'CHANGE_TIMEZONE',\r\n                        oldDateEnv: oldDateEnv\r\n                    });\r\n                }\r\n                /* HACK\r\n                has the same effect as calling this.requestRerender(true)\r\n                but recomputes the state's dateProfile\r\n                */\r\n                _this.dispatch({\r\n                    type: 'SET_VIEW_TYPE',\r\n                    viewType: _this.state.viewType\r\n                });\r\n            }\r\n            else if (isSizeDirty) {\r\n                _this.updateSize();\r\n            }\r\n            // special updates\r\n            if (deepEqual) {\r\n                for (var name_3 in specialUpdates) {\r\n                    changeHandlers[name_3](specialUpdates[name_3], _this, deepEqual);\r\n                }\r\n            }\r\n        });\r\n    };\r\n    /*\r\n    rebuilds things based off of a complete set of refined options\r\n    */\r\n    Calendar.prototype.handleOptions = function (options) {\r\n        var _this = this;\r\n        var pluginHooks = this.pluginSystem.hooks;\r\n        this.defaultAllDayEventDuration = createDuration(options.defaultAllDayEventDuration);\r\n        this.defaultTimedEventDuration = createDuration(options.defaultTimedEventDuration);\r\n        this.delayedRerender = this.buildDelayedRerender(options.rerenderDelay);\r\n        this.theme = this.buildTheme(options);\r\n        var available = this.parseRawLocales(options.locales);\r\n        this.availableRawLocales = available.map;\r\n        var locale = this.buildLocale(options.locale || available.defaultCode, available.map);\r\n        this.dateEnv = this.buildDateEnv(locale, options.timeZone, pluginHooks.namedTimeZonedImpl, options.firstDay, options.weekNumberCalculation, options.weekLabel, pluginHooks.cmdFormatter);\r\n        this.selectionConfig = this.buildSelectionConfig(options); // needs dateEnv. do after :(\r\n        // ineffecient to do every time?\r\n        this.viewSpecs = buildViewSpecs(pluginHooks.views, this.optionsManager);\r\n        // ineffecient to do every time?\r\n        this.dateProfileGenerators = mapHash(this.viewSpecs, function (viewSpec) {\r\n            return new viewSpec.class.prototype.dateProfileGeneratorClass(viewSpec, _this);\r\n        });\r\n    };\r\n    Calendar.prototype.getAvailableLocaleCodes = function () {\r\n        return Object.keys(this.availableRawLocales);\r\n    };\r\n    Calendar.prototype._buildSelectionConfig = function (rawOpts) {\r\n        return processScopedUiProps('select', rawOpts, this);\r\n    };\r\n    Calendar.prototype._buildEventUiSingleBase = function (rawOpts) {\r\n        if (rawOpts.editable) { // so 'editable' affected events\r\n            rawOpts = __assign({}, rawOpts, { eventEditable: true });\r\n        }\r\n        return processScopedUiProps('event', rawOpts, this);\r\n    };\r\n    // Trigger\r\n    // -----------------------------------------------------------------------------------------------------------------\r\n    Calendar.prototype.hasPublicHandlers = function (name) {\r\n        return this.hasHandlers(name) ||\r\n            this.opt(name); // handler specified in options\r\n    };\r\n    Calendar.prototype.publiclyTrigger = function (name, args) {\r\n        var optHandler = this.opt(name);\r\n        this.triggerWith(name, this, args);\r\n        if (optHandler) {\r\n            return optHandler.apply(this, args);\r\n        }\r\n    };\r\n    Calendar.prototype.publiclyTriggerAfterSizing = function (name, args) {\r\n        var afterSizingTriggers = this.afterSizingTriggers;\r\n        (afterSizingTriggers[name] || (afterSizingTriggers[name] = [])).push(args);\r\n    };\r\n    Calendar.prototype.releaseAfterSizingTriggers = function () {\r\n        var afterSizingTriggers = this.afterSizingTriggers;\r\n        for (var name_4 in afterSizingTriggers) {\r\n            for (var _i = 0, _a = afterSizingTriggers[name_4]; _i < _a.length; _i++) {\r\n                var args = _a[_i];\r\n                this.publiclyTrigger(name_4, args);\r\n            }\r\n        }\r\n        this.afterSizingTriggers = {};\r\n    };\r\n    // View\r\n    // -----------------------------------------------------------------------------------------------------------------\r\n    // Returns a boolean about whether the view is okay to instantiate at some point\r\n    Calendar.prototype.isValidViewType = function (viewType) {\r\n        return Boolean(this.viewSpecs[viewType]);\r\n    };\r\n    Calendar.prototype.changeView = function (viewType, dateOrRange) {\r\n        var dateMarker = null;\r\n        if (dateOrRange) {\r\n            if (dateOrRange.start && dateOrRange.end) { // a range\r\n                this.optionsManager.mutate({ visibleRange: dateOrRange }, []); // will not rerender\r\n                this.handleOptions(this.optionsManager.computed); // ...but yuck\r\n            }\r\n            else { // a date\r\n                dateMarker = this.dateEnv.createMarker(dateOrRange); // just like gotoDate\r\n            }\r\n        }\r\n        this.unselect();\r\n        this.dispatch({\r\n            type: 'SET_VIEW_TYPE',\r\n            viewType: viewType,\r\n            dateMarker: dateMarker\r\n        });\r\n    };\r\n    // Forces navigation to a view for the given date.\r\n    // `viewType` can be a specific view name or a generic one like \"week\" or \"day\".\r\n    // needs to change\r\n    Calendar.prototype.zoomTo = function (dateMarker, viewType) {\r\n        var spec;\r\n        viewType = viewType || 'day'; // day is default zoom\r\n        spec = this.viewSpecs[viewType] ||\r\n            this.getUnitViewSpec(viewType);\r\n        this.unselect();\r\n        if (spec) {\r\n            this.dispatch({\r\n                type: 'SET_VIEW_TYPE',\r\n                viewType: spec.type,\r\n                dateMarker: dateMarker\r\n            });\r\n        }\r\n        else {\r\n            this.dispatch({\r\n                type: 'SET_DATE',\r\n                dateMarker: dateMarker\r\n            });\r\n        }\r\n    };\r\n    // Given a duration singular unit, like \"week\" or \"day\", finds a matching view spec.\r\n    // Preference is given to views that have corresponding buttons.\r\n    Calendar.prototype.getUnitViewSpec = function (unit) {\r\n        var component = this.component;\r\n        var viewTypes = [];\r\n        var i;\r\n        var spec;\r\n        // put views that have buttons first. there will be duplicates, but oh\r\n        if (component.header) {\r\n            viewTypes.push.apply(viewTypes, component.header.viewsWithButtons);\r\n        }\r\n        if (component.footer) {\r\n            viewTypes.push.apply(viewTypes, component.footer.viewsWithButtons);\r\n        }\r\n        for (var viewType in this.viewSpecs) {\r\n            viewTypes.push(viewType);\r\n        }\r\n        for (i = 0; i < viewTypes.length; i++) {\r\n            spec = this.viewSpecs[viewTypes[i]];\r\n            if (spec) {\r\n                if (spec.singleUnit === unit) {\r\n                    return spec;\r\n                }\r\n            }\r\n        }\r\n    };\r\n    // Current Date\r\n    // -----------------------------------------------------------------------------------------------------------------\r\n    Calendar.prototype.getInitialDate = function () {\r\n        var defaultDateInput = this.opt('defaultDate');\r\n        // compute the initial ambig-timezone date\r\n        if (defaultDateInput != null) {\r\n            return this.dateEnv.createMarker(defaultDateInput);\r\n        }\r\n        else {\r\n            return this.getNow(); // getNow already returns unzoned\r\n        }\r\n    };\r\n    Calendar.prototype.prev = function () {\r\n        this.unselect();\r\n        this.dispatch({ type: 'PREV' });\r\n    };\r\n    Calendar.prototype.next = function () {\r\n        this.unselect();\r\n        this.dispatch({ type: 'NEXT' });\r\n    };\r\n    Calendar.prototype.prevYear = function () {\r\n        this.unselect();\r\n        this.dispatch({\r\n            type: 'SET_DATE',\r\n            dateMarker: this.dateEnv.addYears(this.state.currentDate, -1)\r\n        });\r\n    };\r\n    Calendar.prototype.nextYear = function () {\r\n        this.unselect();\r\n        this.dispatch({\r\n            type: 'SET_DATE',\r\n            dateMarker: this.dateEnv.addYears(this.state.currentDate, 1)\r\n        });\r\n    };\r\n    Calendar.prototype.today = function () {\r\n        this.unselect();\r\n        this.dispatch({\r\n            type: 'SET_DATE',\r\n            dateMarker: this.getNow()\r\n        });\r\n    };\r\n    Calendar.prototype.gotoDate = function (zonedDateInput) {\r\n        this.unselect();\r\n        this.dispatch({\r\n            type: 'SET_DATE',\r\n            dateMarker: this.dateEnv.createMarker(zonedDateInput)\r\n        });\r\n    };\r\n    Calendar.prototype.incrementDate = function (deltaInput) {\r\n        var delta = createDuration(deltaInput);\r\n        if (delta) { // else, warn about invalid input?\r\n            this.unselect();\r\n            this.dispatch({\r\n                type: 'SET_DATE',\r\n                dateMarker: this.dateEnv.add(this.state.currentDate, delta)\r\n            });\r\n        }\r\n    };\r\n    // for external API\r\n    Calendar.prototype.getDate = function () {\r\n        return this.dateEnv.toDate(this.state.currentDate);\r\n    };\r\n    // Date Formatting Utils\r\n    // -----------------------------------------------------------------------------------------------------------------\r\n    Calendar.prototype.formatDate = function (d, formatter) {\r\n        var dateEnv = this.dateEnv;\r\n        return dateEnv.format(dateEnv.createMarker(d), createFormatter(formatter));\r\n    };\r\n    // `settings` is for formatter AND isEndExclusive\r\n    Calendar.prototype.formatRange = function (d0, d1, settings) {\r\n        var dateEnv = this.dateEnv;\r\n        return dateEnv.formatRange(dateEnv.createMarker(d0), dateEnv.createMarker(d1), createFormatter(settings, this.opt('defaultRangeSeparator')), settings);\r\n    };\r\n    Calendar.prototype.formatIso = function (d, omitTime) {\r\n        var dateEnv = this.dateEnv;\r\n        return dateEnv.formatIso(dateEnv.createMarker(d), { omitTime: omitTime });\r\n    };\r\n    // Sizing\r\n    // -----------------------------------------------------------------------------------------------------------------\r\n    Calendar.prototype.windowResize = function (ev) {\r\n        if (!this.isHandlingWindowResize &&\r\n            this.component && // why?\r\n            ev.target === window // not a jqui resize event\r\n        ) {\r\n            this.isHandlingWindowResize = true;\r\n            this.updateSize();\r\n            this.publiclyTrigger('windowResize', [this.view]);\r\n            this.isHandlingWindowResize = false;\r\n        }\r\n    };\r\n    Calendar.prototype.updateSize = function () {\r\n        if (this.component) { // when?\r\n            this.component.updateSize(true);\r\n        }\r\n    };\r\n    // Component Registration\r\n    // -----------------------------------------------------------------------------------------------------------------\r\n    Calendar.prototype.registerInteractiveComponent = function (component, settingsInput) {\r\n        var settings = parseInteractionSettings(component, settingsInput);\r\n        var DEFAULT_INTERACTIONS = [\r\n            EventClicking,\r\n            EventHovering\r\n        ];\r\n        var interactionClasses = DEFAULT_INTERACTIONS.concat(this.pluginSystem.hooks.componentInteractions);\r\n        var interactions = interactionClasses.map(function (interactionClass) {\r\n            return new interactionClass(settings);\r\n        });\r\n        this.interactionsStore[component.uid] = interactions;\r\n        interactionSettingsStore[component.uid] = settings;\r\n    };\r\n    Calendar.prototype.unregisterInteractiveComponent = function (component) {\r\n        for (var _i = 0, _a = this.interactionsStore[component.uid]; _i < _a.length; _i++) {\r\n            var listener = _a[_i];\r\n            listener.destroy();\r\n        }\r\n        delete this.interactionsStore[component.uid];\r\n        delete interactionSettingsStore[component.uid];\r\n    };\r\n    // Date Selection / Event Selection / DayClick\r\n    // -----------------------------------------------------------------------------------------------------------------\r\n    // this public method receives start/end dates in any format, with any timezone\r\n    // NOTE: args were changed from v3\r\n    Calendar.prototype.select = function (dateOrObj, endDate) {\r\n        var selectionInput;\r\n        if (endDate == null) {\r\n            if (dateOrObj.start != null) {\r\n                selectionInput = dateOrObj;\r\n            }\r\n            else {\r\n                selectionInput = {\r\n                    start: dateOrObj,\r\n                    end: null\r\n                };\r\n            }\r\n        }\r\n        else {\r\n            selectionInput = {\r\n                start: dateOrObj,\r\n                end: endDate\r\n            };\r\n        }\r\n        var selection = parseDateSpan(selectionInput, this.dateEnv, createDuration({ days: 1 }) // TODO: cache this?\r\n        );\r\n        if (selection) { // throw parse error otherwise?\r\n            this.dispatch({ type: 'SELECT_DATES', selection: selection });\r\n            this.triggerDateSelect(selection);\r\n        }\r\n    };\r\n    // public method\r\n    Calendar.prototype.unselect = function (pev) {\r\n        if (this.state.dateSelection) {\r\n            this.dispatch({ type: 'UNSELECT_DATES' });\r\n            this.triggerDateUnselect(pev);\r\n        }\r\n    };\r\n    Calendar.prototype.triggerDateSelect = function (selection, pev) {\r\n        var arg = __assign({}, this.buildDateSpanApi(selection), { jsEvent: pev ? pev.origEvent : null, view: this.view });\r\n        this.publiclyTrigger('select', [arg]);\r\n    };\r\n    Calendar.prototype.triggerDateUnselect = function (pev) {\r\n        this.publiclyTrigger('unselect', [\r\n            {\r\n                jsEvent: pev ? pev.origEvent : null,\r\n                view: this.view\r\n            }\r\n        ]);\r\n    };\r\n    // TODO: receive pev?\r\n    Calendar.prototype.triggerDateClick = function (dateSpan, dayEl, view, ev) {\r\n        var arg = __assign({}, this.buildDatePointApi(dateSpan), { dayEl: dayEl, jsEvent: ev, // Is this always a mouse event? See #4655\r\n            view: view });\r\n        this.publiclyTrigger('dateClick', [arg]);\r\n    };\r\n    Calendar.prototype.buildDatePointApi = function (dateSpan) {\r\n        var props = {};\r\n        for (var _i = 0, _a = this.pluginSystem.hooks.datePointTransforms; _i < _a.length; _i++) {\r\n            var transform = _a[_i];\r\n            __assign(props, transform(dateSpan, this));\r\n        }\r\n        __assign(props, buildDatePointApi(dateSpan, this.dateEnv));\r\n        return props;\r\n    };\r\n    Calendar.prototype.buildDateSpanApi = function (dateSpan) {\r\n        var props = {};\r\n        for (var _i = 0, _a = this.pluginSystem.hooks.dateSpanTransforms; _i < _a.length; _i++) {\r\n            var transform = _a[_i];\r\n            __assign(props, transform(dateSpan, this));\r\n        }\r\n        __assign(props, buildDateSpanApi(dateSpan, this.dateEnv));\r\n        return props;\r\n    };\r\n    // Date Utils\r\n    // -----------------------------------------------------------------------------------------------------------------\r\n    // Returns a DateMarker for the current date, as defined by the client's computer or from the `now` option\r\n    Calendar.prototype.getNow = function () {\r\n        var now = this.opt('now');\r\n        if (typeof now === 'function') {\r\n            now = now();\r\n        }\r\n        if (now == null) {\r\n            return this.dateEnv.createNowMarker();\r\n        }\r\n        return this.dateEnv.createMarker(now);\r\n    };\r\n    // Event-Date Utilities\r\n    // -----------------------------------------------------------------------------------------------------------------\r\n    // Given an event's allDay status and start date, return what its fallback end date should be.\r\n    // TODO: rename to computeDefaultEventEnd\r\n    Calendar.prototype.getDefaultEventEnd = function (allDay, marker) {\r\n        var end = marker;\r\n        if (allDay) {\r\n            end = startOfDay(end);\r\n            end = this.dateEnv.add(end, this.defaultAllDayEventDuration);\r\n        }\r\n        else {\r\n            end = this.dateEnv.add(end, this.defaultTimedEventDuration);\r\n        }\r\n        return end;\r\n    };\r\n    // Public Events API\r\n    // -----------------------------------------------------------------------------------------------------------------\r\n    Calendar.prototype.addEvent = function (eventInput, sourceInput) {\r\n        if (eventInput instanceof EventApi) {\r\n            var def = eventInput._def;\r\n            var instance = eventInput._instance;\r\n            // not already present? don't want to add an old snapshot\r\n            if (!this.state.eventStore.defs[def.defId]) {\r\n                this.dispatch({\r\n                    type: 'ADD_EVENTS',\r\n                    eventStore: eventTupleToStore({ def: def, instance: instance }) // TODO: better util for two args?\r\n                });\r\n            }\r\n            return eventInput;\r\n        }\r\n        var sourceId;\r\n        if (sourceInput instanceof EventSourceApi) {\r\n            sourceId = sourceInput.internalEventSource.sourceId;\r\n        }\r\n        else if (sourceInput != null) {\r\n            var sourceApi = this.getEventSourceById(sourceInput); // TODO: use an internal function\r\n            if (!sourceApi) {\r\n                console.warn('Could not find an event source with ID \"' + sourceInput + '\"'); // TODO: test\r\n                return null;\r\n            }\r\n            else {\r\n                sourceId = sourceApi.internalEventSource.sourceId;\r\n            }\r\n        }\r\n        var tuple = parseEvent(eventInput, sourceId, this);\r\n        if (tuple) {\r\n            this.dispatch({\r\n                type: 'ADD_EVENTS',\r\n                eventStore: eventTupleToStore(tuple)\r\n            });\r\n            return new EventApi(this, tuple.def, tuple.def.recurringDef ? null : tuple.instance);\r\n        }\r\n        return null;\r\n    };\r\n    // TODO: optimize\r\n    Calendar.prototype.getEventById = function (id) {\r\n        var _a = this.state.eventStore, defs = _a.defs, instances = _a.instances;\r\n        id = String(id);\r\n        for (var defId in defs) {\r\n            var def = defs[defId];\r\n            if (def.publicId === id) {\r\n                if (def.recurringDef) {\r\n                    return new EventApi(this, def, null);\r\n                }\r\n                else {\r\n                    for (var instanceId in instances) {\r\n                        var instance = instances[instanceId];\r\n                        if (instance.defId === def.defId) {\r\n                            return new EventApi(this, def, instance);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    Calendar.prototype.getEvents = function () {\r\n        var _a = this.state.eventStore, defs = _a.defs, instances = _a.instances;\r\n        var eventApis = [];\r\n        for (var id in instances) {\r\n            var instance = instances[id];\r\n            var def = defs[instance.defId];\r\n            eventApis.push(new EventApi(this, def, instance));\r\n        }\r\n        return eventApis;\r\n    };\r\n    Calendar.prototype.removeAllEvents = function () {\r\n        this.dispatch({ type: 'REMOVE_ALL_EVENTS' });\r\n    };\r\n    Calendar.prototype.rerenderEvents = function () {\r\n        this.dispatch({ type: 'RESET_EVENTS' });\r\n    };\r\n    // Public Event Sources API\r\n    // -----------------------------------------------------------------------------------------------------------------\r\n    Calendar.prototype.getEventSources = function () {\r\n        var sourceHash = this.state.eventSources;\r\n        var sourceApis = [];\r\n        for (var internalId in sourceHash) {\r\n            sourceApis.push(new EventSourceApi(this, sourceHash[internalId]));\r\n        }\r\n        return sourceApis;\r\n    };\r\n    Calendar.prototype.getEventSourceById = function (id) {\r\n        var sourceHash = this.state.eventSources;\r\n        id = String(id);\r\n        for (var sourceId in sourceHash) {\r\n            if (sourceHash[sourceId].publicId === id) {\r\n                return new EventSourceApi(this, sourceHash[sourceId]);\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    Calendar.prototype.addEventSource = function (sourceInput) {\r\n        if (sourceInput instanceof EventSourceApi) {\r\n            // not already present? don't want to add an old snapshot\r\n            if (!this.state.eventSources[sourceInput.internalEventSource.sourceId]) {\r\n                this.dispatch({\r\n                    type: 'ADD_EVENT_SOURCES',\r\n                    sources: [sourceInput.internalEventSource]\r\n                });\r\n            }\r\n            return sourceInput;\r\n        }\r\n        var eventSource = parseEventSource(sourceInput, this);\r\n        if (eventSource) { // TODO: error otherwise?\r\n            this.dispatch({ type: 'ADD_EVENT_SOURCES', sources: [eventSource] });\r\n            return new EventSourceApi(this, eventSource);\r\n        }\r\n        return null;\r\n    };\r\n    Calendar.prototype.removeAllEventSources = function () {\r\n        this.dispatch({ type: 'REMOVE_ALL_EVENT_SOURCES' });\r\n    };\r\n    Calendar.prototype.refetchEvents = function () {\r\n        this.dispatch({ type: 'FETCH_EVENT_SOURCES' });\r\n    };\r\n    // Scroll\r\n    // -----------------------------------------------------------------------------------------------------------------\r\n    Calendar.prototype.scrollToTime = function (timeInput) {\r\n        var duration = createDuration(timeInput);\r\n        if (duration) {\r\n            this.component.view.scrollToDuration(duration);\r\n        }\r\n    };\r\n    return Calendar;\r\n}());\r\nEmitterMixin.mixInto(Calendar);\r\n// for memoizers\r\n// -----------------------------------------------------------------------------------------------------------------\r\nfunction buildDateEnv(locale, timeZone, namedTimeZoneImpl, firstDay, weekNumberCalculation, weekLabel, cmdFormatter) {\r\n    return new DateEnv({\r\n        calendarSystem: 'gregory',\r\n        timeZone: timeZone,\r\n        namedTimeZoneImpl: namedTimeZoneImpl,\r\n        locale: locale,\r\n        weekNumberCalculation: weekNumberCalculation,\r\n        firstDay: firstDay,\r\n        weekLabel: weekLabel,\r\n        cmdFormatter: cmdFormatter\r\n    });\r\n}\r\nfunction buildTheme(calendarOptions) {\r\n    var themeClass = this.pluginSystem.hooks.themeClasses[calendarOptions.themeSystem] || StandardTheme;\r\n    return new themeClass(calendarOptions);\r\n}\r\nfunction buildDelayedRerender(wait) {\r\n    var func = this.tryRerender.bind(this);\r\n    if (wait != null) {\r\n        func = debounce(func, wait);\r\n    }\r\n    return func;\r\n}\r\nfunction buildEventUiBySource(eventSources) {\r\n    return mapHash(eventSources, function (eventSource) {\r\n        return eventSource.ui;\r\n    });\r\n}\r\nfunction buildEventUiBases(eventDefs, eventUiSingleBase, eventUiBySource) {\r\n    var eventUiBases = { '': eventUiSingleBase };\r\n    for (var defId in eventDefs) {\r\n        var def = eventDefs[defId];\r\n        if (def.sourceId && eventUiBySource[def.sourceId]) {\r\n            eventUiBases[defId] = eventUiBySource[def.sourceId];\r\n        }\r\n    }\r\n    return eventUiBases;\r\n}\r\n\r\nvar View = /** @class */ (function (_super) {\r\n    __extends(View, _super);\r\n    function View(context, viewSpec, dateProfileGenerator, parentEl) {\r\n        var _this = _super.call(this, context, createElement('div', { className: 'fc-view fc-' + viewSpec.type + '-view' }), true // isView (HACK)\r\n        ) || this;\r\n        _this.renderDatesMem = memoizeRendering(_this.renderDatesWrap, _this.unrenderDatesWrap);\r\n        _this.renderBusinessHoursMem = memoizeRendering(_this.renderBusinessHours, _this.unrenderBusinessHours, [_this.renderDatesMem]);\r\n        _this.renderDateSelectionMem = memoizeRendering(_this.renderDateSelectionWrap, _this.unrenderDateSelectionWrap, [_this.renderDatesMem]);\r\n        _this.renderEventsMem = memoizeRendering(_this.renderEvents, _this.unrenderEvents, [_this.renderDatesMem]);\r\n        _this.renderEventSelectionMem = memoizeRendering(_this.renderEventSelectionWrap, _this.unrenderEventSelectionWrap, [_this.renderEventsMem]);\r\n        _this.renderEventDragMem = memoizeRendering(_this.renderEventDragWrap, _this.unrenderEventDragWrap, [_this.renderDatesMem]);\r\n        _this.renderEventResizeMem = memoizeRendering(_this.renderEventResizeWrap, _this.unrenderEventResizeWrap, [_this.renderDatesMem]);\r\n        _this.viewSpec = viewSpec;\r\n        _this.dateProfileGenerator = dateProfileGenerator;\r\n        _this.type = viewSpec.type;\r\n        _this.eventOrderSpecs = parseFieldSpecs(_this.opt('eventOrder'));\r\n        _this.nextDayThreshold = createDuration(_this.opt('nextDayThreshold'));\r\n        parentEl.appendChild(_this.el);\r\n        _this.initialize();\r\n        return _this;\r\n    }\r\n    View.prototype.initialize = function () {\r\n    };\r\n    Object.defineProperty(View.prototype, \"activeStart\", {\r\n        // Date Setting/Unsetting\r\n        // -----------------------------------------------------------------------------------------------------------------\r\n        get: function () {\r\n            return this.dateEnv.toDate(this.props.dateProfile.activeRange.start);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(View.prototype, \"activeEnd\", {\r\n        get: function () {\r\n            return this.dateEnv.toDate(this.props.dateProfile.activeRange.end);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(View.prototype, \"currentStart\", {\r\n        get: function () {\r\n            return this.dateEnv.toDate(this.props.dateProfile.currentRange.start);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(View.prototype, \"currentEnd\", {\r\n        get: function () {\r\n            return this.dateEnv.toDate(this.props.dateProfile.currentRange.end);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    // General Rendering\r\n    // -----------------------------------------------------------------------------------------------------------------\r\n    View.prototype.render = function (props) {\r\n        this.renderDatesMem(props.dateProfile);\r\n        this.renderBusinessHoursMem(props.businessHours);\r\n        this.renderDateSelectionMem(props.dateSelection);\r\n        this.renderEventsMem(props.eventStore);\r\n        this.renderEventSelectionMem(props.eventSelection);\r\n        this.renderEventDragMem(props.eventDrag);\r\n        this.renderEventResizeMem(props.eventResize);\r\n    };\r\n    View.prototype.destroy = function () {\r\n        _super.prototype.destroy.call(this);\r\n        this.renderDatesMem.unrender(); // should unrender everything else\r\n    };\r\n    // Sizing\r\n    // -----------------------------------------------------------------------------------------------------------------\r\n    View.prototype.updateSize = function (isResize, viewHeight, isAuto) {\r\n        var calendar = this.calendar;\r\n        if (isResize || // HACKS...\r\n            calendar.isViewUpdated ||\r\n            calendar.isDatesUpdated ||\r\n            calendar.isEventsUpdated) {\r\n            // sort of the catch-all sizing\r\n            // anything that might cause dimension changes\r\n            this.updateBaseSize(isResize, viewHeight, isAuto);\r\n        }\r\n    };\r\n    View.prototype.updateBaseSize = function (isResize, viewHeight, isAuto) {\r\n    };\r\n    // Date Rendering\r\n    // -----------------------------------------------------------------------------------------------------------------\r\n    View.prototype.renderDatesWrap = function (dateProfile) {\r\n        this.renderDates(dateProfile);\r\n        this.addScroll({\r\n            duration: createDuration(this.opt('scrollTime'))\r\n        });\r\n        this.startNowIndicator(dateProfile); // shouldn't render yet because updateSize will be called soon\r\n    };\r\n    View.prototype.unrenderDatesWrap = function () {\r\n        this.stopNowIndicator();\r\n        this.unrenderDates();\r\n    };\r\n    View.prototype.renderDates = function (dateProfile) { };\r\n    View.prototype.unrenderDates = function () { };\r\n    // Business Hours\r\n    // -----------------------------------------------------------------------------------------------------------------\r\n    View.prototype.renderBusinessHours = function (businessHours) { };\r\n    View.prototype.unrenderBusinessHours = function () { };\r\n    // Date Selection\r\n    // -----------------------------------------------------------------------------------------------------------------\r\n    View.prototype.renderDateSelectionWrap = function (selection) {\r\n        if (selection) {\r\n            this.renderDateSelection(selection);\r\n        }\r\n    };\r\n    View.prototype.unrenderDateSelectionWrap = function (selection) {\r\n        if (selection) {\r\n            this.unrenderDateSelection(selection);\r\n        }\r\n    };\r\n    View.prototype.renderDateSelection = function (selection) { };\r\n    View.prototype.unrenderDateSelection = function (selection) { };\r\n    // Event Rendering\r\n    // -----------------------------------------------------------------------------------------------------------------\r\n    View.prototype.renderEvents = function (eventStore) { };\r\n    View.prototype.unrenderEvents = function () { };\r\n    // util for subclasses\r\n    View.prototype.sliceEvents = function (eventStore, allDay) {\r\n        var props = this.props;\r\n        return sliceEventStore(eventStore, props.eventUiBases, props.dateProfile.activeRange, allDay ? this.nextDayThreshold : null).fg;\r\n    };\r\n    View.prototype.computeEventDraggable = function (eventDef, eventUi) {\r\n        var transformers = this.calendar.pluginSystem.hooks.isDraggableTransformers;\r\n        var val = eventUi.startEditable;\r\n        for (var _i = 0, transformers_1 = transformers; _i < transformers_1.length; _i++) {\r\n            var transformer = transformers_1[_i];\r\n            val = transformer(val, eventDef, eventUi, this);\r\n        }\r\n        return val;\r\n    };\r\n    View.prototype.computeEventStartResizable = function (eventDef, eventUi) {\r\n        return eventUi.durationEditable && this.opt('eventResizableFromStart');\r\n    };\r\n    View.prototype.computeEventEndResizable = function (eventDef, eventUi) {\r\n        return eventUi.durationEditable;\r\n    };\r\n    // Event Selection\r\n    // -----------------------------------------------------------------------------------------------------------------\r\n    View.prototype.renderEventSelectionWrap = function (instanceId) {\r\n        if (instanceId) {\r\n            this.renderEventSelection(instanceId);\r\n        }\r\n    };\r\n    View.prototype.unrenderEventSelectionWrap = function (instanceId) {\r\n        if (instanceId) {\r\n            this.unrenderEventSelection(instanceId);\r\n        }\r\n    };\r\n    View.prototype.renderEventSelection = function (instanceId) { };\r\n    View.prototype.unrenderEventSelection = function (instanceId) { };\r\n    // Event Drag\r\n    // -----------------------------------------------------------------------------------------------------------------\r\n    View.prototype.renderEventDragWrap = function (state) {\r\n        if (state) {\r\n            this.renderEventDrag(state);\r\n        }\r\n    };\r\n    View.prototype.unrenderEventDragWrap = function (state) {\r\n        if (state) {\r\n            this.unrenderEventDrag(state);\r\n        }\r\n    };\r\n    View.prototype.renderEventDrag = function (state) { };\r\n    View.prototype.unrenderEventDrag = function (state) { };\r\n    // Event Resize\r\n    // -----------------------------------------------------------------------------------------------------------------\r\n    View.prototype.renderEventResizeWrap = function (state) {\r\n        if (state) {\r\n            this.renderEventResize(state);\r\n        }\r\n    };\r\n    View.prototype.unrenderEventResizeWrap = function (state) {\r\n        if (state) {\r\n            this.unrenderEventResize(state);\r\n        }\r\n    };\r\n    View.prototype.renderEventResize = function (state) { };\r\n    View.prototype.unrenderEventResize = function (state) { };\r\n    /* Now Indicator\r\n    ------------------------------------------------------------------------------------------------------------------*/\r\n    // Immediately render the current time indicator and begins re-rendering it at an interval,\r\n    // which is defined by this.getNowIndicatorUnit().\r\n    // TODO: somehow do this for the current whole day's background too\r\n    View.prototype.startNowIndicator = function (dateProfile) {\r\n        var _this = this;\r\n        var dateEnv = this.dateEnv;\r\n        var unit;\r\n        var update;\r\n        var delay; // ms wait value\r\n        if (this.opt('nowIndicator')) {\r\n            unit = this.getNowIndicatorUnit(dateProfile);\r\n            if (unit) {\r\n                update = this.updateNowIndicator.bind(this);\r\n                this.initialNowDate = this.calendar.getNow();\r\n                this.initialNowQueriedMs = new Date().valueOf();\r\n                // wait until the beginning of the next interval\r\n                delay = dateEnv.add(dateEnv.startOf(this.initialNowDate, unit), createDuration(1, unit)).valueOf() - this.initialNowDate.valueOf();\r\n                // TODO: maybe always use setTimeout, waiting until start of next unit\r\n                this.nowIndicatorTimeoutID = setTimeout(function () {\r\n                    _this.nowIndicatorTimeoutID = null;\r\n                    update();\r\n                    if (unit === 'second') {\r\n                        delay = 1000; // every second\r\n                    }\r\n                    else {\r\n                        delay = 1000 * 60; // otherwise, every minute\r\n                    }\r\n                    _this.nowIndicatorIntervalID = setInterval(update, delay); // update every interval\r\n                }, delay);\r\n            }\r\n            // rendering will be initiated in updateSize\r\n        }\r\n    };\r\n    // rerenders the now indicator, computing the new current time from the amount of time that has passed\r\n    // since the initial getNow call.\r\n    View.prototype.updateNowIndicator = function () {\r\n        if (this.props.dateProfile && // a way to determine if dates were rendered yet\r\n            this.initialNowDate // activated before?\r\n        ) {\r\n            this.unrenderNowIndicator(); // won't unrender if unnecessary\r\n            this.renderNowIndicator(addMs(this.initialNowDate, new Date().valueOf() - this.initialNowQueriedMs));\r\n            this.isNowIndicatorRendered = true;\r\n        }\r\n    };\r\n    // Immediately unrenders the view's current time indicator and stops any re-rendering timers.\r\n    // Won't cause side effects if indicator isn't rendered.\r\n    View.prototype.stopNowIndicator = function () {\r\n        if (this.isNowIndicatorRendered) {\r\n            if (this.nowIndicatorTimeoutID) {\r\n                clearTimeout(this.nowIndicatorTimeoutID);\r\n                this.nowIndicatorTimeoutID = null;\r\n            }\r\n            if (this.nowIndicatorIntervalID) {\r\n                clearInterval(this.nowIndicatorIntervalID);\r\n                this.nowIndicatorIntervalID = null;\r\n            }\r\n            this.unrenderNowIndicator();\r\n            this.isNowIndicatorRendered = false;\r\n        }\r\n    };\r\n    View.prototype.getNowIndicatorUnit = function (dateProfile) {\r\n        // subclasses should implement\r\n    };\r\n    // Renders a current time indicator at the given datetime\r\n    View.prototype.renderNowIndicator = function (date) {\r\n        // SUBCLASSES MUST PASS TO CHILDREN!\r\n    };\r\n    // Undoes the rendering actions from renderNowIndicator\r\n    View.prototype.unrenderNowIndicator = function () {\r\n        // SUBCLASSES MUST PASS TO CHILDREN!\r\n    };\r\n    /* Scroller\r\n    ------------------------------------------------------------------------------------------------------------------*/\r\n    View.prototype.addScroll = function (scroll) {\r\n        var queuedScroll = this.queuedScroll || (this.queuedScroll = {});\r\n        __assign(queuedScroll, scroll);\r\n    };\r\n    View.prototype.popScroll = function (isResize) {\r\n        this.applyQueuedScroll(isResize);\r\n        this.queuedScroll = null;\r\n    };\r\n    View.prototype.applyQueuedScroll = function (isResize) {\r\n        this.applyScroll(this.queuedScroll || {}, isResize);\r\n    };\r\n    View.prototype.queryScroll = function () {\r\n        var scroll = {};\r\n        if (this.props.dateProfile) { // dates rendered yet?\r\n            __assign(scroll, this.queryDateScroll());\r\n        }\r\n        return scroll;\r\n    };\r\n    View.prototype.applyScroll = function (scroll, isResize) {\r\n        var duration = scroll.duration;\r\n        if (duration != null) {\r\n            delete scroll.duration;\r\n            if (this.props.dateProfile) { // dates rendered yet?\r\n                __assign(scroll, this.computeDateScroll(duration));\r\n            }\r\n        }\r\n        if (this.props.dateProfile) { // dates rendered yet?\r\n            this.applyDateScroll(scroll);\r\n        }\r\n    };\r\n    View.prototype.computeDateScroll = function (duration) {\r\n        return {}; // subclasses must implement\r\n    };\r\n    View.prototype.queryDateScroll = function () {\r\n        return {}; // subclasses must implement\r\n    };\r\n    View.prototype.applyDateScroll = function (scroll) {\r\n        // subclasses must implement\r\n    };\r\n    // for API\r\n    View.prototype.scrollToDuration = function (duration) {\r\n        this.applyScroll({ duration: duration }, false);\r\n    };\r\n    return View;\r\n}(DateComponent));\r\nEmitterMixin.mixInto(View);\r\nView.prototype.usesMinMaxTime = false;\r\nView.prototype.dateProfileGeneratorClass = DateProfileGenerator;\r\n\r\nvar FgEventRenderer = /** @class */ (function () {\r\n    function FgEventRenderer(context) {\r\n        this.segs = [];\r\n        this.isSizeDirty = false;\r\n        this.context = context;\r\n    }\r\n    FgEventRenderer.prototype.renderSegs = function (segs, mirrorInfo) {\r\n        this.rangeUpdated(); // called too frequently :(\r\n        // render an `.el` on each seg\r\n        // returns a subset of the segs. segs that were actually rendered\r\n        segs = this.renderSegEls(segs, mirrorInfo);\r\n        this.segs = segs;\r\n        this.attachSegs(segs, mirrorInfo);\r\n        this.isSizeDirty = true;\r\n        this.context.view.triggerRenderedSegs(this.segs, Boolean(mirrorInfo));\r\n    };\r\n    FgEventRenderer.prototype.unrender = function (_segs, mirrorInfo) {\r\n        this.context.view.triggerWillRemoveSegs(this.segs, Boolean(mirrorInfo));\r\n        this.detachSegs(this.segs);\r\n        this.segs = [];\r\n    };\r\n    // Updates values that rely on options and also relate to range\r\n    FgEventRenderer.prototype.rangeUpdated = function () {\r\n        var options = this.context.options;\r\n        var displayEventTime;\r\n        var displayEventEnd;\r\n        this.eventTimeFormat = createFormatter(options.eventTimeFormat || this.computeEventTimeFormat(), options.defaultRangeSeparator);\r\n        displayEventTime = options.displayEventTime;\r\n        if (displayEventTime == null) {\r\n            displayEventTime = this.computeDisplayEventTime(); // might be based off of range\r\n        }\r\n        displayEventEnd = options.displayEventEnd;\r\n        if (displayEventEnd == null) {\r\n            displayEventEnd = this.computeDisplayEventEnd(); // might be based off of range\r\n        }\r\n        this.displayEventTime = displayEventTime;\r\n        this.displayEventEnd = displayEventEnd;\r\n    };\r\n    // Renders and assigns an `el` property for each foreground event segment.\r\n    // Only returns segments that successfully rendered.\r\n    FgEventRenderer.prototype.renderSegEls = function (segs, mirrorInfo) {\r\n        var html = '';\r\n        var i;\r\n        if (segs.length) { // don't build an empty html string\r\n            // build a large concatenation of event segment HTML\r\n            for (i = 0; i < segs.length; i++) {\r\n                html += this.renderSegHtml(segs[i], mirrorInfo);\r\n            }\r\n            // Grab individual elements from the combined HTML string. Use each as the default rendering.\r\n            // Then, compute the 'el' for each segment. An el might be null if the eventRender callback returned false.\r\n            htmlToElements(html).forEach(function (el, i) {\r\n                var seg = segs[i];\r\n                if (el) {\r\n                    seg.el = el;\r\n                }\r\n            });\r\n            segs = filterSegsViaEls(this.context.view, segs, Boolean(mirrorInfo));\r\n        }\r\n        return segs;\r\n    };\r\n    // Generic utility for generating the HTML classNames for an event segment's element\r\n    FgEventRenderer.prototype.getSegClasses = function (seg, isDraggable, isResizable, mirrorInfo) {\r\n        var classes = [\r\n            'fc-event',\r\n            seg.isStart ? 'fc-start' : 'fc-not-start',\r\n            seg.isEnd ? 'fc-end' : 'fc-not-end'\r\n        ].concat(seg.eventRange.ui.classNames);\r\n        if (isDraggable) {\r\n            classes.push('fc-draggable');\r\n        }\r\n        if (isResizable) {\r\n            classes.push('fc-resizable');\r\n        }\r\n        if (mirrorInfo) {\r\n            classes.push('fc-mirror');\r\n            if (mirrorInfo.isDragging) {\r\n                classes.push('fc-dragging');\r\n            }\r\n            if (mirrorInfo.isResizing) {\r\n                classes.push('fc-resizing');\r\n            }\r\n        }\r\n        return classes;\r\n    };\r\n    // Compute the text that should be displayed on an event's element.\r\n    // `range` can be the Event object itself, or something range-like, with at least a `start`.\r\n    // If event times are disabled, or the event has no time, will return a blank string.\r\n    // If not specified, formatter will default to the eventTimeFormat setting,\r\n    // and displayEnd will default to the displayEventEnd setting.\r\n    FgEventRenderer.prototype.getTimeText = function (eventRange, formatter, displayEnd) {\r\n        var def = eventRange.def, instance = eventRange.instance;\r\n        return this._getTimeText(instance.range.start, def.hasEnd ? instance.range.end : null, def.allDay, formatter, displayEnd, instance.forcedStartTzo, instance.forcedEndTzo);\r\n    };\r\n    FgEventRenderer.prototype._getTimeText = function (start, end, allDay, formatter, displayEnd, forcedStartTzo, forcedEndTzo) {\r\n        var dateEnv = this.context.dateEnv;\r\n        if (formatter == null) {\r\n            formatter = this.eventTimeFormat;\r\n        }\r\n        if (displayEnd == null) {\r\n            displayEnd = this.displayEventEnd;\r\n        }\r\n        if (this.displayEventTime && !allDay) {\r\n            if (displayEnd && end) {\r\n                return dateEnv.formatRange(start, end, formatter, {\r\n                    forcedStartTzo: forcedStartTzo,\r\n                    forcedEndTzo: forcedEndTzo\r\n                });\r\n            }\r\n            else {\r\n                return dateEnv.format(start, formatter, {\r\n                    forcedTzo: forcedStartTzo\r\n                });\r\n            }\r\n        }\r\n        return '';\r\n    };\r\n    FgEventRenderer.prototype.computeEventTimeFormat = function () {\r\n        return {\r\n            hour: 'numeric',\r\n            minute: '2-digit',\r\n            omitZeroMinute: true\r\n        };\r\n    };\r\n    FgEventRenderer.prototype.computeDisplayEventTime = function () {\r\n        return true;\r\n    };\r\n    FgEventRenderer.prototype.computeDisplayEventEnd = function () {\r\n        return true;\r\n    };\r\n    // Utility for generating event skin-related CSS properties\r\n    FgEventRenderer.prototype.getSkinCss = function (ui) {\r\n        return {\r\n            'background-color': ui.backgroundColor,\r\n            'border-color': ui.borderColor,\r\n            color: ui.textColor\r\n        };\r\n    };\r\n    FgEventRenderer.prototype.sortEventSegs = function (segs) {\r\n        var specs = this.context.view.eventOrderSpecs;\r\n        var objs = segs.map(buildSegCompareObj);\r\n        objs.sort(function (obj0, obj1) {\r\n            return compareByFieldSpecs(obj0, obj1, specs);\r\n        });\r\n        return objs.map(function (c) {\r\n            return c._seg;\r\n        });\r\n    };\r\n    FgEventRenderer.prototype.computeSizes = function (force) {\r\n        if (force || this.isSizeDirty) {\r\n            this.computeSegSizes(this.segs);\r\n        }\r\n    };\r\n    FgEventRenderer.prototype.assignSizes = function (force) {\r\n        if (force || this.isSizeDirty) {\r\n            this.assignSegSizes(this.segs);\r\n            this.isSizeDirty = false;\r\n        }\r\n    };\r\n    FgEventRenderer.prototype.computeSegSizes = function (segs) {\r\n    };\r\n    FgEventRenderer.prototype.assignSegSizes = function (segs) {\r\n    };\r\n    // Manipulation on rendered segs\r\n    FgEventRenderer.prototype.hideByHash = function (hash) {\r\n        if (hash) {\r\n            for (var _i = 0, _a = this.segs; _i < _a.length; _i++) {\r\n                var seg = _a[_i];\r\n                if (hash[seg.eventRange.instance.instanceId]) {\r\n                    seg.el.style.visibility = 'hidden';\r\n                }\r\n            }\r\n        }\r\n    };\r\n    FgEventRenderer.prototype.showByHash = function (hash) {\r\n        if (hash) {\r\n            for (var _i = 0, _a = this.segs; _i < _a.length; _i++) {\r\n                var seg = _a[_i];\r\n                if (hash[seg.eventRange.instance.instanceId]) {\r\n                    seg.el.style.visibility = '';\r\n                }\r\n            }\r\n        }\r\n    };\r\n    FgEventRenderer.prototype.selectByInstanceId = function (instanceId) {\r\n        if (instanceId) {\r\n            for (var _i = 0, _a = this.segs; _i < _a.length; _i++) {\r\n                var seg = _a[_i];\r\n                var eventInstance = seg.eventRange.instance;\r\n                if (eventInstance && eventInstance.instanceId === instanceId &&\r\n                    seg.el // necessary?\r\n                ) {\r\n                    seg.el.classList.add('fc-selected');\r\n                }\r\n            }\r\n        }\r\n    };\r\n    FgEventRenderer.prototype.unselectByInstanceId = function (instanceId) {\r\n        if (instanceId) {\r\n            for (var _i = 0, _a = this.segs; _i < _a.length; _i++) {\r\n                var seg = _a[_i];\r\n                if (seg.el) { // necessary?\r\n                    seg.el.classList.remove('fc-selected');\r\n                }\r\n            }\r\n        }\r\n    };\r\n    return FgEventRenderer;\r\n}());\r\n// returns a object with all primitive props that can be compared\r\nfunction buildSegCompareObj(seg) {\r\n    var eventDef = seg.eventRange.def;\r\n    var range = seg.eventRange.instance.range;\r\n    var start = range.start ? range.start.valueOf() : 0; // TODO: better support for open-range events\r\n    var end = range.end ? range.end.valueOf() : 0; // \"\r\n    return __assign({}, eventDef.extendedProps, eventDef, { id: eventDef.publicId, start: start,\r\n        end: end, duration: end - start, allDay: Number(eventDef.allDay), _seg: seg // for later retrieval\r\n     });\r\n}\r\n\r\nvar FillRenderer = /** @class */ (function () {\r\n    function FillRenderer(context) {\r\n        this.fillSegTag = 'div';\r\n        this.dirtySizeFlags = {};\r\n        this.context = context;\r\n        this.containerElsByType = {};\r\n        this.segsByType = {};\r\n    }\r\n    FillRenderer.prototype.getSegsByType = function (type) {\r\n        return this.segsByType[type] || [];\r\n    };\r\n    FillRenderer.prototype.renderSegs = function (type, segs) {\r\n        var _a;\r\n        var renderedSegs = this.renderSegEls(type, segs); // assignes `.el` to each seg. returns successfully rendered segs\r\n        var containerEls = this.attachSegs(type, renderedSegs);\r\n        if (containerEls) {\r\n            (_a = (this.containerElsByType[type] || (this.containerElsByType[type] = []))).push.apply(_a, containerEls);\r\n        }\r\n        this.segsByType[type] = renderedSegs;\r\n        if (type === 'bgEvent') {\r\n            this.context.view.triggerRenderedSegs(renderedSegs, false); // isMirror=false\r\n        }\r\n        this.dirtySizeFlags[type] = true;\r\n    };\r\n    // Unrenders a specific type of fill that is currently rendered on the grid\r\n    FillRenderer.prototype.unrender = function (type) {\r\n        var segs = this.segsByType[type];\r\n        if (segs) {\r\n            if (type === 'bgEvent') {\r\n                this.context.view.triggerWillRemoveSegs(segs, false); // isMirror=false\r\n            }\r\n            this.detachSegs(type, segs);\r\n        }\r\n    };\r\n    // Renders and assigns an `el` property for each fill segment. Generic enough to work with different types.\r\n    // Only returns segments that successfully rendered.\r\n    FillRenderer.prototype.renderSegEls = function (type, segs) {\r\n        var _this = this;\r\n        var html = '';\r\n        var i;\r\n        if (segs.length) {\r\n            // build a large concatenation of segment HTML\r\n            for (i = 0; i < segs.length; i++) {\r\n                html += this.renderSegHtml(type, segs[i]);\r\n            }\r\n            // Grab individual elements from the combined HTML string. Use each as the default rendering.\r\n            // Then, compute the 'el' for each segment.\r\n            htmlToElements(html).forEach(function (el, i) {\r\n                var seg = segs[i];\r\n                if (el) {\r\n                    seg.el = el;\r\n                }\r\n            });\r\n            if (type === 'bgEvent') {\r\n                segs = filterSegsViaEls(this.context.view, segs, false // isMirror. background events can never be mirror elements\r\n                );\r\n            }\r\n            // correct element type? (would be bad if a non-TD were inserted into a table for example)\r\n            segs = segs.filter(function (seg) {\r\n                return elementMatches(seg.el, _this.fillSegTag);\r\n            });\r\n        }\r\n        return segs;\r\n    };\r\n    // Builds the HTML needed for one fill segment. Generic enough to work with different types.\r\n    FillRenderer.prototype.renderSegHtml = function (type, seg) {\r\n        var css = null;\r\n        var classNames = [];\r\n        if (type !== 'highlight' && type !== 'businessHours') {\r\n            css = {\r\n                'background-color': seg.eventRange.ui.backgroundColor\r\n            };\r\n        }\r\n        if (type !== 'highlight') {\r\n            classNames = classNames.concat(seg.eventRange.ui.classNames);\r\n        }\r\n        if (type === 'businessHours') {\r\n            classNames.push('fc-bgevent');\r\n        }\r\n        else {\r\n            classNames.push('fc-' + type.toLowerCase());\r\n        }\r\n        return '<' + this.fillSegTag +\r\n            (classNames.length ? ' class=\"' + classNames.join(' ') + '\"' : '') +\r\n            (css ? ' style=\"' + cssToStr(css) + '\"' : '') +\r\n            '></' + this.fillSegTag + '>';\r\n    };\r\n    FillRenderer.prototype.detachSegs = function (type, segs) {\r\n        var containerEls = this.containerElsByType[type];\r\n        if (containerEls) {\r\n            containerEls.forEach(removeElement);\r\n            delete this.containerElsByType[type];\r\n        }\r\n    };\r\n    FillRenderer.prototype.computeSizes = function (force) {\r\n        for (var type in this.segsByType) {\r\n            if (force || this.dirtySizeFlags[type]) {\r\n                this.computeSegSizes(this.segsByType[type]);\r\n            }\r\n        }\r\n    };\r\n    FillRenderer.prototype.assignSizes = function (force) {\r\n        for (var type in this.segsByType) {\r\n            if (force || this.dirtySizeFlags[type]) {\r\n                this.assignSegSizes(this.segsByType[type]);\r\n            }\r\n        }\r\n        this.dirtySizeFlags = {};\r\n    };\r\n    FillRenderer.prototype.computeSegSizes = function (segs) {\r\n    };\r\n    FillRenderer.prototype.assignSegSizes = function (segs) {\r\n    };\r\n    return FillRenderer;\r\n}());\r\n\r\nvar NamedTimeZoneImpl = /** @class */ (function () {\r\n    function NamedTimeZoneImpl(timeZoneName) {\r\n        this.timeZoneName = timeZoneName;\r\n    }\r\n    return NamedTimeZoneImpl;\r\n}());\r\n\r\n/*\r\nAn abstraction for a dragging interaction originating on an event.\r\nDoes higher-level things than PointerDragger, such as possibly:\r\n- a \"mirror\" that moves with the pointer\r\n- a minimum number of pixels or other criteria for a true drag to begin\r\n\r\nsubclasses must emit:\r\n- pointerdown\r\n- dragstart\r\n- dragmove\r\n- pointerup\r\n- dragend\r\n*/\r\nvar ElementDragging = /** @class */ (function () {\r\n    function ElementDragging(el) {\r\n        this.emitter = new EmitterMixin();\r\n    }\r\n    ElementDragging.prototype.destroy = function () {\r\n    };\r\n    ElementDragging.prototype.setMirrorIsVisible = function (bool) {\r\n        // optional if subclass doesn't want to support a mirror\r\n    };\r\n    ElementDragging.prototype.setMirrorNeedsRevert = function (bool) {\r\n        // optional if subclass doesn't want to support a mirror\r\n    };\r\n    ElementDragging.prototype.setAutoScrollEnabled = function (bool) {\r\n        // optional\r\n    };\r\n    return ElementDragging;\r\n}());\r\n\r\nfunction formatDate(dateInput, settings) {\r\n    if (settings === void 0) { settings = {}; }\r\n    var dateEnv = buildDateEnv$1(settings);\r\n    var formatter = createFormatter(settings);\r\n    var dateMeta = dateEnv.createMarkerMeta(dateInput);\r\n    if (!dateMeta) { // TODO: warning?\r\n        return '';\r\n    }\r\n    return dateEnv.format(dateMeta.marker, formatter, {\r\n        forcedTzo: dateMeta.forcedTzo\r\n    });\r\n}\r\nfunction formatRange(startInput, endInput, settings // mixture of env and formatter settings\r\n) {\r\n    var dateEnv = buildDateEnv$1(typeof settings === 'object' && settings ? settings : {}); // pass in if non-null object\r\n    var formatter = createFormatter(settings, globalDefaults.defaultRangeSeparator);\r\n    var startMeta = dateEnv.createMarkerMeta(startInput);\r\n    var endMeta = dateEnv.createMarkerMeta(endInput);\r\n    if (!startMeta || !endMeta) { // TODO: warning?\r\n        return '';\r\n    }\r\n    return dateEnv.formatRange(startMeta.marker, endMeta.marker, formatter, {\r\n        forcedStartTzo: startMeta.forcedTzo,\r\n        forcedEndTzo: endMeta.forcedTzo,\r\n        isEndExclusive: settings.isEndExclusive\r\n    });\r\n}\r\n// TODO: more DRY and optimized\r\nfunction buildDateEnv$1(settings) {\r\n    var locale = buildLocale(settings.locale || 'en', parseRawLocales([]).map); // TODO: don't hardcode 'en' everywhere\r\n    // ensure required settings\r\n    settings = __assign({ timeZone: globalDefaults.timeZone, calendarSystem: 'gregory' }, settings, { locale: locale });\r\n    return new DateEnv(settings);\r\n}\r\n\r\nvar DRAG_META_PROPS = {\r\n    startTime: createDuration,\r\n    duration: createDuration,\r\n    create: Boolean,\r\n    sourceId: String\r\n};\r\nvar DRAG_META_DEFAULTS = {\r\n    create: true\r\n};\r\nfunction parseDragMeta(raw) {\r\n    var leftoverProps = {};\r\n    var refined = refineProps(raw, DRAG_META_PROPS, DRAG_META_DEFAULTS, leftoverProps);\r\n    refined.leftoverProps = leftoverProps;\r\n    return refined;\r\n}\r\n\r\n// Computes a default column header formatting string if `colFormat` is not explicitly defined\r\nfunction computeFallbackHeaderFormat(datesRepDistinctDays, dayCnt) {\r\n    // if more than one week row, or if there are a lot of columns with not much space,\r\n    // put just the day numbers will be in each cell\r\n    if (!datesRepDistinctDays || dayCnt > 10) {\r\n        return { weekday: 'short' }; // \"Sat\"\r\n    }\r\n    else if (dayCnt > 1) {\r\n        return { weekday: 'short', month: 'numeric', day: 'numeric', omitCommas: true }; // \"Sat 11/12\"\r\n    }\r\n    else {\r\n        return { weekday: 'long' }; // \"Saturday\"\r\n    }\r\n}\r\nfunction renderDateCell(dateMarker, dateProfile, datesRepDistinctDays, colCnt, colHeadFormat, context, colspan, otherAttrs) {\r\n    var view = context.view, dateEnv = context.dateEnv, theme = context.theme, options = context.options;\r\n    var isDateValid = rangeContainsMarker(dateProfile.activeRange, dateMarker); // TODO: called too frequently. cache somehow.\r\n    var classNames = [\r\n        'fc-day-header',\r\n        theme.getClass('widgetHeader')\r\n    ];\r\n    var innerHtml;\r\n    if (typeof options.columnHeaderHtml === 'function') {\r\n        innerHtml = options.columnHeaderHtml(dateEnv.toDate(dateMarker));\r\n    }\r\n    else if (typeof options.columnHeaderText === 'function') {\r\n        innerHtml = htmlEscape(options.columnHeaderText(dateEnv.toDate(dateMarker)));\r\n    }\r\n    else {\r\n        innerHtml = htmlEscape(dateEnv.format(dateMarker, colHeadFormat));\r\n    }\r\n    // if only one row of days, the classNames on the header can represent the specific days beneath\r\n    if (datesRepDistinctDays) {\r\n        classNames = classNames.concat(\r\n        // includes the day-of-week class\r\n        // noThemeHighlight=true (don't highlight the header)\r\n        getDayClasses(dateMarker, dateProfile, context, true));\r\n    }\r\n    else {\r\n        classNames.push('fc-' + DAY_IDS[dateMarker.getUTCDay()]); // only add the day-of-week class\r\n    }\r\n    return '' +\r\n        '<th class=\"' + classNames.join(' ') + '\"' +\r\n        ((isDateValid && datesRepDistinctDays) ?\r\n            ' data-date=\"' + dateEnv.formatIso(dateMarker, { omitTime: true }) + '\"' :\r\n            '') +\r\n        (colspan > 1 ?\r\n            ' colspan=\"' + colspan + '\"' :\r\n            '') +\r\n        (otherAttrs ?\r\n            ' ' + otherAttrs :\r\n            '') +\r\n        '>' +\r\n        (isDateValid ?\r\n            // don't make a link if the heading could represent multiple days, or if there's only one day (forceOff)\r\n            buildGotoAnchorHtml(view, { date: dateMarker, forceOff: !datesRepDistinctDays || colCnt === 1 }, innerHtml) :\r\n            // if not valid, display text, but no link\r\n            innerHtml) +\r\n        '</th>';\r\n}\r\n\r\nvar DayHeader = /** @class */ (function (_super) {\r\n    __extends(DayHeader, _super);\r\n    function DayHeader(context, parentEl) {\r\n        var _this = _super.call(this, context) || this;\r\n        parentEl.innerHTML = ''; // because might be nbsp\r\n        parentEl.appendChild(_this.el = htmlToElement('<div class=\"fc-row ' + _this.theme.getClass('headerRow') + '\">' +\r\n            '<table class=\"' + _this.theme.getClass('tableGrid') + '\">' +\r\n            '<thead></thead>' +\r\n            '</table>' +\r\n            '</div>'));\r\n        _this.thead = _this.el.querySelector('thead');\r\n        return _this;\r\n    }\r\n    DayHeader.prototype.destroy = function () {\r\n        removeElement(this.el);\r\n    };\r\n    DayHeader.prototype.render = function (props) {\r\n        var dates = props.dates, datesRepDistinctDays = props.datesRepDistinctDays;\r\n        var parts = [];\r\n        if (props.renderIntroHtml) {\r\n            parts.push(props.renderIntroHtml());\r\n        }\r\n        var colHeadFormat = createFormatter(this.opt('columnHeaderFormat') ||\r\n            computeFallbackHeaderFormat(datesRepDistinctDays, dates.length));\r\n        for (var _i = 0, dates_1 = dates; _i < dates_1.length; _i++) {\r\n            var date = dates_1[_i];\r\n            parts.push(renderDateCell(date, props.dateProfile, datesRepDistinctDays, dates.length, colHeadFormat, this.context));\r\n        }\r\n        if (this.isRtl) {\r\n            parts.reverse();\r\n        }\r\n        this.thead.innerHTML = '<tr>' + parts.join('') + '</tr>';\r\n    };\r\n    return DayHeader;\r\n}(Component));\r\n\r\nvar DaySeries = /** @class */ (function () {\r\n    function DaySeries(range, dateProfileGenerator) {\r\n        var date = range.start;\r\n        var end = range.end;\r\n        var indices = [];\r\n        var dates = [];\r\n        var dayIndex = -1;\r\n        while (date < end) { // loop each day from start to end\r\n            if (dateProfileGenerator.isHiddenDay(date)) {\r\n                indices.push(dayIndex + 0.5); // mark that it's between indices\r\n            }\r\n            else {\r\n                dayIndex++;\r\n                indices.push(dayIndex);\r\n                dates.push(date);\r\n            }\r\n            date = addDays(date, 1);\r\n        }\r\n        this.dates = dates;\r\n        this.indices = indices;\r\n        this.cnt = dates.length;\r\n    }\r\n    DaySeries.prototype.sliceRange = function (range) {\r\n        var firstIndex = this.getDateDayIndex(range.start); // inclusive first index\r\n        var lastIndex = this.getDateDayIndex(addDays(range.end, -1)); // inclusive last index\r\n        var clippedFirstIndex = Math.max(0, firstIndex);\r\n        var clippedLastIndex = Math.min(this.cnt - 1, lastIndex);\r\n        // deal with in-between indices\r\n        clippedFirstIndex = Math.ceil(clippedFirstIndex); // in-between starts round to next cell\r\n        clippedLastIndex = Math.floor(clippedLastIndex); // in-between ends round to prev cell\r\n        if (clippedFirstIndex <= clippedLastIndex) {\r\n            return {\r\n                firstIndex: clippedFirstIndex,\r\n                lastIndex: clippedLastIndex,\r\n                isStart: firstIndex === clippedFirstIndex,\r\n                isEnd: lastIndex === clippedLastIndex\r\n            };\r\n        }\r\n        else {\r\n            return null;\r\n        }\r\n    };\r\n    // Given a date, returns its chronolocial cell-index from the first cell of the grid.\r\n    // If the date lies between cells (because of hiddenDays), returns a floating-point value between offsets.\r\n    // If before the first offset, returns a negative number.\r\n    // If after the last offset, returns an offset past the last cell offset.\r\n    // Only works for *start* dates of cells. Will not work for exclusive end dates for cells.\r\n    DaySeries.prototype.getDateDayIndex = function (date) {\r\n        var indices = this.indices;\r\n        var dayOffset = Math.floor(diffDays(this.dates[0], date));\r\n        if (dayOffset < 0) {\r\n            return indices[0] - 1;\r\n        }\r\n        else if (dayOffset >= indices.length) {\r\n            return indices[indices.length - 1] + 1;\r\n        }\r\n        else {\r\n            return indices[dayOffset];\r\n        }\r\n    };\r\n    return DaySeries;\r\n}());\r\n\r\nvar DayTable = /** @class */ (function () {\r\n    function DayTable(daySeries, breakOnWeeks) {\r\n        var dates = daySeries.dates;\r\n        var daysPerRow;\r\n        var firstDay;\r\n        var rowCnt;\r\n        if (breakOnWeeks) {\r\n            // count columns until the day-of-week repeats\r\n            firstDay = dates[0].getUTCDay();\r\n            for (daysPerRow = 1; daysPerRow < dates.length; daysPerRow++) {\r\n                if (dates[daysPerRow].getUTCDay() === firstDay) {\r\n                    break;\r\n                }\r\n            }\r\n            rowCnt = Math.ceil(dates.length / daysPerRow);\r\n        }\r\n        else {\r\n            rowCnt = 1;\r\n            daysPerRow = dates.length;\r\n        }\r\n        this.rowCnt = rowCnt;\r\n        this.colCnt = daysPerRow;\r\n        this.daySeries = daySeries;\r\n        this.cells = this.buildCells();\r\n        this.headerDates = this.buildHeaderDates();\r\n    }\r\n    DayTable.prototype.buildCells = function () {\r\n        var rows = [];\r\n        for (var row = 0; row < this.rowCnt; row++) {\r\n            var cells = [];\r\n            for (var col = 0; col < this.colCnt; col++) {\r\n                cells.push(this.buildCell(row, col));\r\n            }\r\n            rows.push(cells);\r\n        }\r\n        return rows;\r\n    };\r\n    DayTable.prototype.buildCell = function (row, col) {\r\n        return {\r\n            date: this.daySeries.dates[row * this.colCnt + col]\r\n        };\r\n    };\r\n    DayTable.prototype.buildHeaderDates = function () {\r\n        var dates = [];\r\n        for (var col = 0; col < this.colCnt; col++) {\r\n            dates.push(this.cells[0][col].date);\r\n        }\r\n        return dates;\r\n    };\r\n    DayTable.prototype.sliceRange = function (range) {\r\n        var colCnt = this.colCnt;\r\n        var seriesSeg = this.daySeries.sliceRange(range);\r\n        var segs = [];\r\n        if (seriesSeg) {\r\n            var firstIndex = seriesSeg.firstIndex, lastIndex = seriesSeg.lastIndex;\r\n            var index = firstIndex;\r\n            while (index <= lastIndex) {\r\n                var row = Math.floor(index / colCnt);\r\n                var nextIndex = Math.min((row + 1) * colCnt, lastIndex + 1);\r\n                segs.push({\r\n                    row: row,\r\n                    firstCol: index % colCnt,\r\n                    lastCol: (nextIndex - 1) % colCnt,\r\n                    isStart: seriesSeg.isStart && index === firstIndex,\r\n                    isEnd: seriesSeg.isEnd && (nextIndex - 1) === lastIndex\r\n                });\r\n                index = nextIndex;\r\n            }\r\n        }\r\n        return segs;\r\n    };\r\n    return DayTable;\r\n}());\r\n\r\nvar Slicer = /** @class */ (function () {\r\n    function Slicer() {\r\n        this.sliceBusinessHours = memoize(this._sliceBusinessHours);\r\n        this.sliceDateSelection = memoize(this._sliceDateSpan);\r\n        this.sliceEventStore = memoize(this._sliceEventStore);\r\n        this.sliceEventDrag = memoize(this._sliceInteraction);\r\n        this.sliceEventResize = memoize(this._sliceInteraction);\r\n    }\r\n    Slicer.prototype.sliceProps = function (props, dateProfile, nextDayThreshold, component) {\r\n        var extraArgs = [];\r\n        for (var _i = 4; _i < arguments.length; _i++) {\r\n            extraArgs[_i - 4] = arguments[_i];\r\n        }\r\n        var eventUiBases = props.eventUiBases;\r\n        var eventSegs = this.sliceEventStore.apply(this, [props.eventStore, eventUiBases, dateProfile, nextDayThreshold, component].concat(extraArgs));\r\n        return {\r\n            dateSelectionSegs: this.sliceDateSelection.apply(this, [props.dateSelection, eventUiBases, component].concat(extraArgs)),\r\n            businessHourSegs: this.sliceBusinessHours.apply(this, [props.businessHours, dateProfile, nextDayThreshold, component].concat(extraArgs)),\r\n            fgEventSegs: eventSegs.fg,\r\n            bgEventSegs: eventSegs.bg,\r\n            eventDrag: this.sliceEventDrag.apply(this, [props.eventDrag, eventUiBases, dateProfile, nextDayThreshold, component].concat(extraArgs)),\r\n            eventResize: this.sliceEventResize.apply(this, [props.eventResize, eventUiBases, dateProfile, nextDayThreshold, component].concat(extraArgs)),\r\n            eventSelection: props.eventSelection\r\n        }; // TODO: give interactionSegs?\r\n    };\r\n    Slicer.prototype.sliceNowDate = function (// does not memoize\r\n    date, component) {\r\n        var extraArgs = [];\r\n        for (var _i = 2; _i < arguments.length; _i++) {\r\n            extraArgs[_i - 2] = arguments[_i];\r\n        }\r\n        return this._sliceDateSpan.apply(this, [{ range: { start: date, end: addMs(date, 1) }, allDay: false },\r\n            {},\r\n            component].concat(extraArgs));\r\n    };\r\n    Slicer.prototype._sliceBusinessHours = function (businessHours, dateProfile, nextDayThreshold, component) {\r\n        var extraArgs = [];\r\n        for (var _i = 4; _i < arguments.length; _i++) {\r\n            extraArgs[_i - 4] = arguments[_i];\r\n        }\r\n        if (!businessHours) {\r\n            return [];\r\n        }\r\n        return this._sliceEventStore.apply(this, [expandRecurring(businessHours, computeActiveRange(dateProfile, Boolean(nextDayThreshold)), component.calendar),\r\n            {},\r\n            dateProfile,\r\n            nextDayThreshold,\r\n            component].concat(extraArgs)).bg;\r\n    };\r\n    Slicer.prototype._sliceEventStore = function (eventStore, eventUiBases, dateProfile, nextDayThreshold, component) {\r\n        var extraArgs = [];\r\n        for (var _i = 5; _i < arguments.length; _i++) {\r\n            extraArgs[_i - 5] = arguments[_i];\r\n        }\r\n        if (eventStore) {\r\n            var rangeRes = sliceEventStore(eventStore, eventUiBases, computeActiveRange(dateProfile, Boolean(nextDayThreshold)), nextDayThreshold);\r\n            return {\r\n                bg: this.sliceEventRanges(rangeRes.bg, component, extraArgs),\r\n                fg: this.sliceEventRanges(rangeRes.fg, component, extraArgs)\r\n            };\r\n        }\r\n        else {\r\n            return { bg: [], fg: [] };\r\n        }\r\n    };\r\n    Slicer.prototype._sliceInteraction = function (interaction, eventUiBases, dateProfile, nextDayThreshold, component) {\r\n        var extraArgs = [];\r\n        for (var _i = 5; _i < arguments.length; _i++) {\r\n            extraArgs[_i - 5] = arguments[_i];\r\n        }\r\n        if (!interaction) {\r\n            return null;\r\n        }\r\n        var rangeRes = sliceEventStore(interaction.mutatedEvents, eventUiBases, computeActiveRange(dateProfile, Boolean(nextDayThreshold)), nextDayThreshold);\r\n        return {\r\n            segs: this.sliceEventRanges(rangeRes.fg, component, extraArgs),\r\n            affectedInstances: interaction.affectedEvents.instances,\r\n            isEvent: interaction.isEvent,\r\n            sourceSeg: interaction.origSeg\r\n        };\r\n    };\r\n    Slicer.prototype._sliceDateSpan = function (dateSpan, eventUiBases, component) {\r\n        var extraArgs = [];\r\n        for (var _i = 3; _i < arguments.length; _i++) {\r\n            extraArgs[_i - 3] = arguments[_i];\r\n        }\r\n        if (!dateSpan) {\r\n            return [];\r\n        }\r\n        var eventRange = fabricateEventRange(dateSpan, eventUiBases, component.calendar);\r\n        var segs = this.sliceRange.apply(this, [dateSpan.range].concat(extraArgs));\r\n        for (var _a = 0, segs_1 = segs; _a < segs_1.length; _a++) {\r\n            var seg = segs_1[_a];\r\n            seg.component = component;\r\n            seg.eventRange = eventRange;\r\n        }\r\n        return segs;\r\n    };\r\n    /*\r\n    \"complete\" seg means it has component and eventRange\r\n    */\r\n    Slicer.prototype.sliceEventRanges = function (eventRanges, component, // TODO: kill\r\n    extraArgs) {\r\n        var segs = [];\r\n        for (var _i = 0, eventRanges_1 = eventRanges; _i < eventRanges_1.length; _i++) {\r\n            var eventRange = eventRanges_1[_i];\r\n            segs.push.apply(segs, this.sliceEventRange(eventRange, component, extraArgs));\r\n        }\r\n        return segs;\r\n    };\r\n    /*\r\n    \"complete\" seg means it has component and eventRange\r\n    */\r\n    Slicer.prototype.sliceEventRange = function (eventRange, component, // TODO: kill\r\n    extraArgs) {\r\n        var segs = this.sliceRange.apply(this, [eventRange.range].concat(extraArgs));\r\n        for (var _i = 0, segs_2 = segs; _i < segs_2.length; _i++) {\r\n            var seg = segs_2[_i];\r\n            seg.component = component;\r\n            seg.eventRange = eventRange;\r\n            seg.isStart = eventRange.isStart && seg.isStart;\r\n            seg.isEnd = eventRange.isEnd && seg.isEnd;\r\n        }\r\n        return segs;\r\n    };\r\n    return Slicer;\r\n}());\r\n/*\r\nfor incorporating minTime/maxTime if appropriate\r\nTODO: should be part of DateProfile!\r\nTimelineDateProfile already does this btw\r\n*/\r\nfunction computeActiveRange(dateProfile, isComponentAllDay) {\r\n    var range = dateProfile.activeRange;\r\n    if (isComponentAllDay) {\r\n        return range;\r\n    }\r\n    return {\r\n        start: addMs(range.start, dateProfile.minTime.milliseconds),\r\n        end: addMs(range.end, dateProfile.maxTime.milliseconds - 864e5) // 864e5 = ms in a day\r\n    };\r\n}\r\n\r\n// exports\r\n// --------------------------------------------------------------------------------------------------\r\nvar version = '4.3.1';\r\n\r\nexport { Calendar, Component, DateComponent, DateEnv, DateProfileGenerator, DayHeader, DaySeries, DayTable, ElementDragging, ElementScrollController, EmitterMixin, EventApi, FgEventRenderer, FillRenderer, Interaction, Mixin, NamedTimeZoneImpl, PositionCache, ScrollComponent, ScrollController, Slicer, Splitter, Theme, View, WindowScrollController, addDays, addDurations, addMs, addWeeks, allowContextMenu, allowSelection, appendToElement, applyAll, applyMutationToEventStore, applyStyle, applyStyleProp, asRoughMinutes, asRoughMs, asRoughSeconds, buildGotoAnchorHtml, buildSegCompareObj, capitaliseFirstLetter, combineEventUis, compareByFieldSpec, compareByFieldSpecs, compareNumbers, compensateScroll, computeClippingRect, computeEdges, computeFallbackHeaderFormat, computeHeightAndMargins, computeInnerRect, computeRect, computeVisibleDayRange, config, constrainPoint, createDuration, createElement, createEmptyEventStore, createEventInstance, createFormatter, createPlugin, cssToStr, debounce, diffDates, diffDayAndTime, diffDays, diffPoints, diffWeeks, diffWholeDays, diffWholeWeeks, disableCursor, distributeHeight, elementClosest, elementMatches, enableCursor, eventTupleToStore, filterEventStoreDefs, filterHash, findChildren, findElements, flexibleCompare, forceClassName, formatDate, formatIsoTimeString, formatRange, getAllDayHtml, getClippingParents, getDayClasses, getElSeg, getRectCenter, getRelevantEvents, globalDefaults, greatestDurationDenominator, hasBgRendering, htmlEscape, htmlToElement, insertAfterElement, interactionSettingsStore, interactionSettingsToStore, intersectRanges, intersectRects, isArraysEqual, isDateSpansEqual, isInt, isInteractionValid, isMultiDayRange, isPropsEqual, isPropsValid, isSingleDay, isValidDate, listenBySelector, mapHash, matchCellWidths, memoize, memoizeOutput, memoizeRendering, mergeEventStores, multiplyDuration, padStart, parseBusinessHours, parseDragMeta, parseEventDef, parseFieldSpecs, parse as parseMarker, pointInsideRect, prependToElement, preventContextMenu, preventDefault, preventSelection, processScopedUiProps, rangeContainsMarker, rangeContainsRange, rangesEqual, rangesIntersect, refineProps, removeElement, removeExact, renderDateCell, requestJson, sliceEventStore, startOfDay, subtractInnerElHeight, translateRect, uncompensateScroll, undistributeHeight, unpromisify, version, whenTransitionDone, wholeDivideDurations };\r\n"]},"metadata":{},"sourceType":"module"}