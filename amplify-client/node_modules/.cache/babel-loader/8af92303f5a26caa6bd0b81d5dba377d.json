{"ast":null,"code":"/**\r\n * DevExtreme (ui/scheduler/ui.scheduler.appointments.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar _renderer = require(\"../../core/renderer\");\n\nvar _renderer2 = _interopRequireDefault(_renderer);\n\nvar _dom_adapter = require(\"../../core/dom_adapter\");\n\nvar _dom_adapter2 = _interopRequireDefault(_dom_adapter);\n\nvar _events_engine = require(\"../../events/core/events_engine\");\n\nvar _events_engine2 = _interopRequireDefault(_events_engine);\n\nvar _element_data = require(\"../../core/element_data\");\n\nvar _element_data2 = _interopRequireDefault(_element_data);\n\nvar _translator = require(\"../../animation/translator\");\n\nvar _translator2 = _interopRequireDefault(_translator);\n\nvar _date = require(\"../../core/utils/date\");\n\nvar _date2 = _interopRequireDefault(_date);\n\nvar _common = require(\"../../core/utils/common\");\n\nvar _common2 = _interopRequireDefault(_common);\n\nvar _type = require(\"../../core/utils/type\");\n\nvar _type2 = _interopRequireDefault(_type);\n\nvar _iterator = require(\"../../core/utils/iterator\");\n\nvar _object = require(\"../../core/utils/object\");\n\nvar _object2 = _interopRequireDefault(_object);\n\nvar _array = require(\"../../core/utils/array\");\n\nvar _array2 = _interopRequireDefault(_array);\n\nvar _extend = require(\"../../core/utils/extend\");\n\nvar _dom = require(\"../../core/utils/dom\");\n\nvar _utils = require(\"./utils.recurrence\");\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nvar _component_registrator = require(\"../../core/component_registrator\");\n\nvar _component_registrator2 = _interopRequireDefault(_component_registrator);\n\nvar _uiScheduler = require(\"./ui.scheduler.publisher_mixin\");\n\nvar _uiScheduler2 = _interopRequireDefault(_uiScheduler);\n\nvar _uiScheduler3 = require(\"./ui.scheduler.appointment\");\n\nvar _uiScheduler4 = _interopRequireDefault(_uiScheduler3);\n\nvar _utils3 = require(\"../../events/utils\");\n\nvar _utils4 = _interopRequireDefault(_utils3);\n\nvar _double_click = require(\"../../events/double_click\");\n\nvar _double_click2 = _interopRequireDefault(_double_click);\n\nvar _message = require(\"../../localization/message\");\n\nvar _message2 = _interopRequireDefault(_message);\n\nvar _uiCollection_widget = require(\"../collection/ui.collection_widget.edit\");\n\nvar _uiCollection_widget2 = _interopRequireDefault(_uiCollection_widget);\n\nvar _deferred = require(\"../../core/utils/deferred\");\n\nvar _utils5 = require(\"./utils.js\");\n\nvar _utils6 = _interopRequireDefault(_utils5);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nvar APPOINTMENT_SETTINGS_NAME = \"dxAppointmentSettings\";\nvar COMPONENT_CLASS = \"dx-scheduler-scrollable-appointments\";\nvar APPOINTMENT_ITEM_CLASS = \"dx-scheduler-appointment\";\nvar APPOINTMENT_TITLE_CLASS = \"dx-scheduler-appointment-title\";\nvar APPOINTMENT_CONTENT_DETAILS_CLASS = \"dx-scheduler-appointment-content-details\";\nvar APPOINTMENT_DATE_CLASS = \"dx-scheduler-appointment-content-date\";\nvar RECURRING_ICON_CLASS = \"dx-scheduler-appointment-recurrence-icon\";\nvar ALL_DAY_CONTENT_CLASS = \"dx-scheduler-appointment-content-allday\";\n\nvar DBLCLICK_EVENT_NAME = _utils4.default.addNamespace(_double_click2.default.name, \"dxSchedulerAppointment\");\n\nvar toMs = _date2.default.dateToMilliseconds;\n\nvar SchedulerAppointments = _uiCollection_widget2.default.inherit({\n  ctor: function ctor(element, options) {\n    this.callBase(element, options);\n  },\n  _supportedKeys: function _supportedKeys() {\n    var parent = this.callBase();\n\n    var tabHandler = function tabHandler(e) {\n      var appointments = this._getAccessAppointments();\n\n      var focusedAppointment = appointments.filter(\".dx-state-focused\");\n      var index = focusedAppointment.data(APPOINTMENT_SETTINGS_NAME).sortedIndex;\n      var lastIndex = appointments.length - 1;\n\n      if (index > 0 && e.shiftKey || index < lastIndex && !e.shiftKey) {\n        e.preventDefault();\n        e.shiftKey ? index-- : index++;\n\n        var $nextAppointment = this._getAppointmentByIndex(index);\n\n        this._resetTabIndex($nextAppointment);\n\n        _events_engine2.default.trigger($nextAppointment, \"focus\");\n      }\n    };\n\n    return (0, _extend.extend)(parent, {\n      escape: function () {\n        this.moveAppointmentBack();\n        this._escPressed = true;\n      }.bind(this),\n      del: function (e) {\n        if (this.option(\"allowDelete\")) {\n          e.preventDefault();\n\n          var data = this._getItemData(e.target);\n\n          this.notifyObserver(\"deleteAppointment\", {\n            data: data,\n            target: e.target\n          });\n          this.notifyObserver(\"hideAppointmentTooltip\");\n        }\n      }.bind(this),\n      tab: tabHandler\n    });\n  },\n  _getAppointmentByIndex: function _getAppointmentByIndex(sortedIndex) {\n    var appointments = this._getAccessAppointments();\n\n    return appointments.filter(function (_, $item) {\n      return _element_data2.default.data($item, APPOINTMENT_SETTINGS_NAME).sortedIndex === sortedIndex;\n    }).eq(0);\n  },\n  _getAccessAppointments: function _getAccessAppointments() {\n    return this._itemElements().filter(\":visible\").not(\".dx-state-disabled\");\n  },\n  _resetTabIndex: function _resetTabIndex($appointment) {\n    this._focusTarget().attr(\"tabIndex\", -1);\n\n    $appointment.attr(\"tabIndex\", this.option(\"tabIndex\"));\n  },\n  _moveFocus: _common2.default.noop,\n  _focusTarget: function _focusTarget() {\n    return this._itemElements();\n  },\n  _renderFocusTarget: function _renderFocusTarget() {\n    var $appointment = this._getAppointmentByIndex(0);\n\n    this._resetTabIndex($appointment);\n  },\n  _focusInHandler: function _focusInHandler(e) {\n    clearTimeout(this._appointmentFocusedTimeout);\n    this.callBase.apply(this, arguments);\n    this._$currentAppointment = (0, _renderer2.default)(e.target);\n    this.option(\"focusedElement\", (0, _dom.getPublicElement)((0, _renderer2.default)(e.target)));\n    var that = this;\n    this._appointmentFocusedTimeout = setTimeout(function () {\n      that.notifyObserver(\"appointmentFocused\");\n    });\n  },\n  _focusOutHandler: function _focusOutHandler() {\n    var $appointment = this._getAppointmentByIndex(0);\n\n    this.option(\"focusedElement\", (0, _dom.getPublicElement)($appointment));\n    this.callBase.apply(this, arguments);\n  },\n  _eventBindingTarget: function _eventBindingTarget() {\n    return this._itemContainer();\n  },\n  _getDefaultOptions: function _getDefaultOptions() {\n    return (0, _extend.extend)(this.callBase(), {\n      noDataText: null,\n      activeStateEnabled: true,\n      hoverStateEnabled: true,\n      tabIndex: 0,\n      fixedContainer: null,\n      allDayContainer: null,\n      allowDrag: true,\n      allowResize: true,\n      allowAllDayResize: true,\n      onAppointmentDblClick: null,\n      _collectorOffset: 0\n    });\n  },\n  _optionChanged: function _optionChanged(args) {\n    switch (args.name) {\n      case \"items\":\n        this._cleanFocusState();\n\n        this._clearDropDownItems();\n\n        this._clearDropDownItemsElements();\n\n        this._repaintAppointments(args.value);\n\n        this._renderDropDownAppointments();\n\n        this._attachAppointmentsEvents();\n\n        break;\n\n      case \"fixedContainer\":\n      case \"allDayContainer\":\n      case \"onAppointmentDblClick\":\n        break;\n\n      case \"allowDrag\":\n      case \"allowResize\":\n      case \"allowAllDayResize\":\n        this._invalidate();\n\n        break;\n\n      case \"focusedElement\":\n        this._resetTabIndex((0, _renderer2.default)(args.value));\n\n        this.callBase(args);\n        break;\n\n      case \"allowDelete\":\n        break;\n\n      case \"focusStateEnabled\":\n        this._clearDropDownItemsElements();\n\n        this._renderDropDownAppointments();\n\n        this.callBase(args);\n        break;\n\n      default:\n        this.callBase(args);\n    }\n  },\n  _isAllDayAppointment: function _isAllDayAppointment(appointment) {\n    return appointment.settings.length && appointment.settings[0].allDay || false;\n  },\n  _isRepaintAppointment: function _isRepaintAppointment(appointment) {\n    return !_type2.default.isDefined(appointment.needRepaint) || true === appointment.needRepaint;\n  },\n  _isRepaintAll: function _isRepaintAll(appointments) {\n    if (this.invoke(\"isCurrentViewAgenda\")) {\n      return true;\n    }\n\n    for (var i = 0; i < appointments.length; i++) {\n      var appointment = appointments[i];\n\n      if (!this._isRepaintAppointment(appointment)) {\n        return false;\n      }\n    }\n\n    return true;\n  },\n  _applyFragment: function _applyFragment(fragment, allDay) {\n    if (fragment.children().length > 0) {\n      this._getAppointmentContainer(allDay).append(fragment);\n    }\n  },\n  _onEachAppointment: function _onEachAppointment(appointment, index, container, isRepaintAll) {\n    if (appointment && true === appointment.needRemove) {\n      this._clearItem(appointment);\n\n      return;\n    }\n\n    if (this._isRepaintAppointment(appointment)) {\n      appointment.needRepaint = false;\n      !isRepaintAll && this._clearItem(appointment);\n\n      this._renderItem(index, appointment, container);\n    }\n  },\n  _repaintAppointments: function _repaintAppointments(appointments) {\n    var _this = this;\n\n    var isRepaintAll = this._isRepaintAll(appointments);\n\n    var allDayFragment = (0, _renderer2.default)(this._getAppointmentContainer(true));\n    var commonFragment = (0, _renderer2.default)(this._getAppointmentContainer(false));\n\n    if (isRepaintAll) {\n      this._getAppointmentContainer(true).html(\"\");\n\n      this._getAppointmentContainer(false).html(\"\");\n    }\n\n    !appointments.length && this._cleanItemContainer();\n    appointments.forEach(function (appointment, index) {\n      var container = _this._isAllDayAppointment(appointment) ? allDayFragment : commonFragment;\n\n      _this._onEachAppointment(appointment, index, container, isRepaintAll);\n    });\n\n    this._applyFragment(allDayFragment, true);\n\n    this._applyFragment(commonFragment, false);\n  },\n  _attachAppointmentsEvents: function _attachAppointmentsEvents() {\n    this._attachClickEvent();\n\n    this._attachHoldEvent();\n\n    this._attachContextMenuEvent();\n\n    this._attachAppointmentDblClick();\n\n    this._renderFocusState();\n\n    this._attachFeedbackEvents();\n\n    this._attachHoverEvents();\n  },\n  _clearItem: function _clearItem(item) {\n    var $items = this._findItemElementByItem(item.itemData);\n\n    if (!$items.length) {\n      return;\n    }\n\n    (0, _iterator.each)($items, function (_, $item) {\n      $item.detach();\n      $item.remove();\n    });\n  },\n  _clearDropDownItems: function _clearDropDownItems() {\n    this._virtualAppointments = {};\n  },\n  _clearDropDownItemsElements: function _clearDropDownItemsElements() {\n    this.invoke(\"clearCompactAppointments\");\n  },\n  _findItemElementByItem: function _findItemElementByItem(item) {\n    var result = [];\n    var that = this;\n    this.itemElements().each(function () {\n      var $item = (0, _renderer2.default)(this);\n\n      if ($item.data(that._itemDataKey()) === item) {\n        result.push($item);\n      }\n    });\n    return result;\n  },\n  _itemClass: function _itemClass() {\n    return APPOINTMENT_ITEM_CLASS;\n  },\n  _itemContainer: function _itemContainer() {\n    var $container = this.callBase();\n    var $result = $container;\n    var $allDayContainer = this.option(\"allDayContainer\");\n\n    if ($allDayContainer) {\n      $result = $container.add($allDayContainer);\n    }\n\n    return $result;\n  },\n  _cleanItemContainer: function _cleanItemContainer() {\n    this.callBase();\n    var $allDayContainer = this.option(\"allDayContainer\");\n\n    if ($allDayContainer) {\n      $allDayContainer.empty();\n    }\n\n    this._virtualAppointments = {};\n  },\n  _clean: function _clean() {\n    this.callBase();\n    delete this._$currentAppointment;\n    delete this._initialSize;\n    delete this._initialCoordinates;\n  },\n  _init: function _init() {\n    this.callBase();\n    this.$element().addClass(COMPONENT_CLASS);\n    this._preventSingleAppointmentClick = false;\n  },\n  _renderAppointmentTemplate: function _renderAppointmentTemplate($container, data, model) {\n    var formatText = this.invoke(\"getTextAndFormatDate\", model.appointmentData, model.appointmentData.settings || data.recurrenceRule && model.targetedAppointmentData || {}, \"TIME\");\n    (0, _renderer2.default)(\"<div>\").text(formatText.text).addClass(APPOINTMENT_TITLE_CLASS).appendTo($container);\n\n    if (_type2.default.isPlainObject(data)) {\n      if (data.html) {\n        $container.html(data.html);\n      }\n    }\n\n    var $contentDetails = (0, _renderer2.default)(\"<div>\").addClass(APPOINTMENT_CONTENT_DETAILS_CLASS);\n    (0, _renderer2.default)(\"<div>\").addClass(APPOINTMENT_DATE_CLASS).text(formatText.formatDate).appendTo($contentDetails);\n    $contentDetails.appendTo($container);\n\n    if (data.recurrenceRule) {\n      (0, _renderer2.default)(\"<span>\").addClass(RECURRING_ICON_CLASS + \" dx-icon-repeat\").appendTo($container);\n    }\n\n    if (data.allDay) {\n      (0, _renderer2.default)(\"<div>\").text(\" \" + _message2.default.format(\"dxScheduler-allDay\") + \": \").addClass(ALL_DAY_CONTENT_CLASS).prependTo($contentDetails);\n    }\n  },\n  _executeItemRenderAction: function _executeItemRenderAction(index, itemData, itemElement) {\n    var action = this._getItemRenderAction();\n\n    if (action) {\n      action(this.invoke(\"mapAppointmentFields\", {\n        itemData: itemData,\n        itemElement: itemElement\n      }));\n    }\n\n    delete this._currentAppointmentSettings;\n  },\n  _itemClickHandler: function _itemClickHandler(e) {\n    this.callBase(e, {}, {\n      afterExecute: function (e) {\n        this._processItemClick(e.args[0].event);\n      }.bind(this)\n    });\n  },\n  _processItemClick: function _processItemClick(e) {\n    var $target = (0, _renderer2.default)(e.currentTarget);\n\n    var data = this._getItemData($target);\n\n    if (\"keydown\" === e.type || _utils4.default.isFakeClickEvent(e)) {\n      this.notifyObserver(\"showEditAppointmentPopup\", {\n        data: data,\n        target: $target\n      });\n      return;\n    }\n\n    this._appointmentClickTimeout = setTimeout(function () {\n      if (!this._preventSingleAppointmentClick && _dom_adapter2.default.getBody().contains($target[0])) {\n        this.notifyObserver(\"showAppointmentTooltip\", {\n          data: data,\n          target: $target\n        });\n      }\n\n      this._preventSingleAppointmentClick = false;\n    }.bind(this), 300);\n  },\n  _extendActionArgs: function _extendActionArgs() {\n    var args = this.callBase.apply(this, arguments);\n    return this.invoke(\"mapAppointmentFields\", args);\n  },\n  _render: function _render() {\n    this.callBase.apply(this, arguments);\n\n    this._attachAppointmentDblClick();\n  },\n  _attachAppointmentDblClick: function _attachAppointmentDblClick() {\n    var that = this;\n\n    var itemSelector = that._itemSelector();\n\n    var itemContainer = this._itemContainer();\n\n    _events_engine2.default.off(itemContainer, DBLCLICK_EVENT_NAME, itemSelector);\n\n    _events_engine2.default.on(itemContainer, DBLCLICK_EVENT_NAME, itemSelector, function (e) {\n      that._itemDXEventHandler(e, \"onAppointmentDblClick\", {}, {\n        afterExecute: function afterExecute(e) {\n          that._dblClickHandler(e.args[0].event);\n        }\n      });\n    });\n  },\n  _dblClickHandler: function _dblClickHandler(e) {\n    var $targetAppointment = (0, _renderer2.default)(e.currentTarget);\n\n    var appointmentData = this._getItemData($targetAppointment);\n\n    clearTimeout(this._appointmentClickTimeout);\n    this._preventSingleAppointmentClick = true;\n    this.notifyObserver(\"showEditAppointmentPopup\", {\n      data: appointmentData,\n      target: $targetAppointment\n    });\n  },\n  _renderItem: function _renderItem(index, item, container) {\n    var itemData = item.itemData;\n\n    for (var i = 0; i < item.settings.length; i++) {\n      var setting = item.settings[i];\n      this._currentAppointmentSettings = setting;\n      var $item = this.callBase(index, itemData, container);\n      $item.data(APPOINTMENT_SETTINGS_NAME, setting);\n    }\n  },\n  _getItemContent: function _getItemContent($itemFrame) {\n    $itemFrame.data(APPOINTMENT_SETTINGS_NAME, this._currentAppointmentSettings);\n    var $itemContent = this.callBase($itemFrame);\n    return $itemContent;\n  },\n  _createItemByTemplate: function _createItemByTemplate(itemTemplate, renderArgs) {\n    var itemData = renderArgs.itemData,\n        container = renderArgs.container,\n        index = renderArgs.index;\n    return itemTemplate.render({\n      model: {\n        appointmentData: itemData,\n        targetedAppointmentData: this.invoke(\"getTargetedAppointmentData\", itemData, (0, _renderer2.default)(container).parent())\n      },\n      container: container,\n      index: index\n    });\n  },\n  _getAppointmentContainer: function _getAppointmentContainer(allDay) {\n    var $allDayContainer = this.option(\"allDayContainer\");\n    var $container = this.itemsContainer().not($allDayContainer);\n\n    if (allDay && $allDayContainer) {\n      $container = $allDayContainer;\n    }\n\n    return $container;\n  },\n  _postprocessRenderItem: function _postprocessRenderItem(args) {\n    this._renderAppointment(args.itemElement, this._currentAppointmentSettings);\n  },\n  _renderAppointment: function _renderAppointment($appointment, settings) {\n    $appointment.data(APPOINTMENT_SETTINGS_NAME, settings);\n\n    this._applyResourceDataAttr($appointment);\n\n    var data = this._getItemData($appointment);\n\n    var geometry = this.invoke(\"getAppointmentGeometry\", settings);\n\n    var allowResize = !settings.isCompact && this.option(\"allowResize\") && (!_type2.default.isDefined(settings.skipResizing) || _type2.default.isString(settings.skipResizing));\n\n    var allowDrag = this.option(\"allowDrag\");\n    var allDay = settings.allDay;\n    this.invoke(\"setCellDataCacheAlias\", this._currentAppointmentSettings, geometry);\n\n    var deferredColor = this._getAppointmentColor($appointment, settings.groupIndex);\n\n    if (settings.virtual) {\n      this._processVirtualAppointment(settings, $appointment, data, deferredColor);\n    } else {\n      this._createComponent($appointment, _uiScheduler4.default, {\n        observer: this.option(\"observer\"),\n        data: data,\n        geometry: geometry,\n        direction: settings.direction || \"vertical\",\n        allowResize: allowResize,\n        allowDrag: allowDrag,\n        allDay: allDay,\n        reduced: settings.appointmentReduced,\n        isCompact: settings.isCompact,\n        startDate: new Date(settings.startDate),\n        cellWidth: this.invoke(\"getCellWidth\"),\n        cellHeight: this.invoke(\"getCellHeight\"),\n        resizableConfig: this._resizableConfig(data, settings)\n      });\n\n      deferredColor.done(function (color) {\n        if (color) {\n          $appointment.css(\"backgroundColor\", color);\n        }\n      });\n    }\n  },\n  _applyResourceDataAttr: function _applyResourceDataAttr($appointment) {\n    var resources = this.invoke(\"getResourcesFromItem\", this._getItemData($appointment));\n\n    if (resources) {\n      (0, _iterator.each)(resources, function (name, values) {\n        var attr = \"data-\" + _common2.default.normalizeKey(name.toLowerCase()) + \"-\";\n\n        for (var i = 0; i < values.length; i++) {\n          $appointment.attr(attr + _common2.default.normalizeKey(values[i]), true);\n        }\n      });\n    }\n  },\n  _resizableConfig: function _resizableConfig(appointmentData, itemSetting) {\n    return {\n      area: this._calculateResizableArea(itemSetting, appointmentData),\n      onResizeStart: function (e) {\n        this._$currentAppointment = (0, _renderer2.default)(e.element);\n\n        if (this.invoke(\"needRecalculateResizableArea\")) {\n          var updatedArea = this._calculateResizableArea(this._$currentAppointment.data(APPOINTMENT_SETTINGS_NAME), this._$currentAppointment.data(\"dxItemData\"));\n\n          e.component.option(\"area\", updatedArea);\n\n          e.component._renderDragOffsets(e.event);\n        }\n\n        this._initialSize = {\n          width: e.width,\n          height: e.height\n        };\n        this._initialCoordinates = _translator2.default.locate(this._$currentAppointment);\n      }.bind(this),\n      onResizeEnd: function (e) {\n        if (this._escPressed) {\n          e.event.cancel = true;\n          return;\n        }\n\n        this._resizeEndHandler(e);\n      }.bind(this)\n    };\n  },\n  _calculateResizableArea: function _calculateResizableArea(itemSetting, appointmentData) {\n    var area = this.$element().closest(\".dx-scrollable-content\");\n    return this.invoke(\"getResizableAppointmentArea\", {\n      coordinates: {\n        left: itemSetting.left,\n        top: 0,\n        groupIndex: itemSetting.groupIndex\n      },\n      allDay: itemSetting.allDay\n    }) || area;\n  },\n  _resizeEndHandler: function _resizeEndHandler(e) {\n    var $element = (0, _renderer2.default)(e.element);\n\n    var itemData = this._getItemData($element);\n\n    var startDate = this.invoke(\"getStartDate\", itemData, true);\n    var endDate = this.invoke(\"getEndDate\", itemData, true);\n\n    var dateRange = this._getDateRange(e, startDate, endDate);\n\n    var updatedDates = {};\n    this.invoke(\"setField\", \"startDate\", updatedDates, new Date(dateRange[0]));\n    this.invoke(\"setField\", \"endDate\", updatedDates, new Date(dateRange[1]));\n    var data = (0, _extend.extend)({}, itemData, updatedDates);\n    this.notifyObserver(\"updateAppointmentAfterResize\", {\n      target: itemData,\n      data: data,\n      $appointment: $element\n    });\n  },\n  _getDateRange: function _getDateRange(e, startDate, endDate) {\n    var itemData = this._getItemData(e.element);\n\n    var deltaTime = this.invoke(\"getDeltaTime\", e, this._initialSize, itemData);\n    var renderingStrategyDirection = this.invoke(\"getRenderingStrategyDirection\");\n    var isStartDateChanged = false;\n    var isAllDay = this.invoke(\"isAllDay\", itemData);\n    var needCorrectDates = this.invoke(\"needCorrectAppointmentDates\") && !isAllDay;\n    var startTime;\n    var endTime;\n\n    if (\"vertical\" !== renderingStrategyDirection || isAllDay) {\n      isStartDateChanged = this.option(\"rtlEnabled\") ? e.handles.right : e.handles.left;\n    } else {\n      isStartDateChanged = e.handles.top;\n    }\n\n    if (isStartDateChanged) {\n      startTime = needCorrectDates ? this._correctStartDateByDelta(startDate, deltaTime) : startDate.getTime() - deltaTime;\n      startTime += _utils6.default.getTimezoneOffsetChangeInMs(startDate, endDate, startTime, endDate);\n      endTime = endDate.getTime();\n    } else {\n      startTime = startDate.getTime();\n      endTime = needCorrectDates ? this._correctEndDateByDelta(endDate, deltaTime) : endDate.getTime() + deltaTime;\n      endTime += _utils6.default.getTimezoneOffsetChangeInMs(startDate, endDate, startDate, endTime);\n    }\n\n    return [startTime, endTime];\n  },\n  _correctEndDateByDelta: function _correctEndDateByDelta(endDate, deltaTime) {\n    var endDayHour = this.invoke(\"getEndDayHour\");\n    var startDayHour = this.invoke(\"getStartDayHour\");\n    var result = endDate.getTime() + deltaTime;\n    var visibleDayDuration = (endDayHour - startDayHour) * toMs(\"hour\");\n    var daysCount = deltaTime > 0 ? Math.ceil(deltaTime / visibleDayDuration) : Math.floor(deltaTime / visibleDayDuration);\n    var maxDate = new Date(endDate);\n    var minDate = new Date(endDate);\n    minDate.setHours(startDayHour, 0, 0, 0);\n    maxDate.setHours(endDayHour, 0, 0, 0);\n\n    if (result > maxDate.getTime() || result <= minDate.getTime()) {\n      var tailOfCurrentDay = maxDate.getTime() - endDate.getTime();\n      var tailOfPrevDays = deltaTime - tailOfCurrentDay;\n      var lastDay = new Date(endDate.setDate(endDate.getDate() + daysCount));\n      lastDay.setHours(startDayHour, 0, 0, 0);\n      result = lastDay.getTime() + tailOfPrevDays - visibleDayDuration * (daysCount - 1);\n    }\n\n    return result;\n  },\n  _correctStartDateByDelta: function _correctStartDateByDelta(startDate, deltaTime) {\n    var endDayHour = this.invoke(\"getEndDayHour\");\n    var startDayHour = this.invoke(\"getStartDayHour\");\n    var result = startDate.getTime() - deltaTime;\n    var visibleDayDuration = (endDayHour - startDayHour) * toMs(\"hour\");\n    var daysCount = deltaTime > 0 ? Math.ceil(deltaTime / visibleDayDuration) : Math.floor(deltaTime / visibleDayDuration);\n    var maxDate = new Date(startDate);\n    var minDate = new Date(startDate);\n    minDate.setHours(startDayHour, 0, 0, 0);\n    maxDate.setHours(endDayHour, 0, 0, 0);\n\n    if (result < minDate.getTime() || result >= maxDate.getTime()) {\n      var tailOfCurrentDay = startDate.getTime() - minDate.getTime();\n      var tailOfPrevDays = deltaTime - tailOfCurrentDay;\n      var firstDay = new Date(startDate.setDate(startDate.getDate() - daysCount));\n      firstDay.setHours(endDayHour, 0, 0, 0);\n      result = firstDay.getTime() - tailOfPrevDays + visibleDayDuration * (daysCount - 1);\n    }\n\n    return result;\n  },\n  _tryGetAppointmentColor: function _tryGetAppointmentColor(appointment) {\n    var settings = (0, _renderer2.default)(appointment).data(APPOINTMENT_SETTINGS_NAME);\n\n    if (!settings) {\n      return;\n    }\n\n    return this._getAppointmentColor(appointment, settings.groupIndex);\n  },\n  _getAppointmentColor: function _getAppointmentColor($appointment, groupIndex) {\n    var res = new _deferred.Deferred();\n    var response = this.invoke(\"getAppointmentColor\", {\n      itemData: this._getItemData($appointment),\n      groupIndex: groupIndex\n    });\n    response.done(function (color) {\n      return res.resolve(color);\n    });\n    return res.promise();\n  },\n  _calculateBoundOffset: function _calculateBoundOffset() {\n    return this.invoke(\"getBoundOffset\");\n  },\n  _virtualAppointments: {},\n  _processVirtualAppointment: function _processVirtualAppointment(appointmentSetting, $appointment, appointmentData, color) {\n    var virtualAppointment = appointmentSetting.virtual;\n    var virtualGroupIndex = virtualAppointment.index;\n\n    if (!_type2.default.isDefined(this._virtualAppointments[virtualGroupIndex])) {\n      this._virtualAppointments[virtualGroupIndex] = {\n        coordinates: {\n          top: virtualAppointment.top,\n          left: virtualAppointment.left\n        },\n        items: {\n          data: [],\n          colors: [],\n          settings: []\n        },\n        isAllDay: virtualAppointment.isAllDay ? true : false,\n        buttonColor: color\n      };\n    }\n\n    appointmentSetting.targetedAppointmentData = this.invoke(\"getTargetedAppointmentData\", appointmentData, $appointment, true);\n\n    this._virtualAppointments[virtualGroupIndex].items.settings.push(appointmentSetting);\n\n    this._virtualAppointments[virtualGroupIndex].items.data.push(appointmentData);\n\n    this._virtualAppointments[virtualGroupIndex].items.colors.push(color);\n\n    $appointment.remove();\n  },\n  _renderContentImpl: function _renderContentImpl() {\n    this.callBase();\n\n    this._renderDropDownAppointments();\n  },\n  _renderDropDownAppointments: function _renderDropDownAppointments() {\n    (0, _iterator.each)(this._virtualAppointments, function (groupIndex) {\n      var virtualGroup = this._virtualAppointments[groupIndex];\n      var virtualItems = virtualGroup.items;\n      var virtualCoordinates = virtualGroup.coordinates;\n      var $container = virtualGroup.isAllDay ? this.option(\"allDayContainer\") : this.$element();\n      var left = virtualCoordinates.left;\n      var buttonWidth = this.invoke(\"getDropDownAppointmentWidth\", virtualGroup.isAllDay);\n      var buttonHeight = this.invoke(\"getDropDownAppointmentHeight\");\n      var rtlOffset = this.option(\"rtlEnabled\") ? buttonWidth : 0;\n      this.notifyObserver(\"renderCompactAppointments\", {\n        $container: $container,\n        coordinates: {\n          top: virtualCoordinates.top,\n          left: left + rtlOffset\n        },\n        items: virtualItems,\n        buttonColor: virtualGroup.buttonColor,\n        width: buttonWidth - this.option(\"_collectorOffset\"),\n        height: buttonHeight,\n        onAppointmentClick: this.option(\"onItemClick\"),\n        allowDrag: this.option(\"allowDrag\"),\n        cellWidth: this.invoke(\"getCellWidth\"),\n        isCompact: this.invoke(\"isAdaptive\") || this._isGroupCompact(virtualGroup),\n        applyOffset: !virtualGroup.isAllDay && this.invoke(\"isApplyCompactAppointmentOffset\")\n      });\n    }.bind(this));\n  },\n  _isGroupCompact: function _isGroupCompact(virtualGroup) {\n    return !virtualGroup.isAllDay && this.invoke(\"supportCompactDropDownAppointments\");\n  },\n  _sortAppointmentsByStartDate: function _sortAppointmentsByStartDate(appointments) {\n    appointments.sort(function (a, b) {\n      var result = 0;\n      var firstDate = new Date(this.invoke(\"getField\", \"startDate\", a.settings || a)).getTime();\n      var secondDate = new Date(this.invoke(\"getField\", \"startDate\", b.settings || b)).getTime();\n\n      if (firstDate < secondDate) {\n        result = -1;\n      }\n\n      if (firstDate > secondDate) {\n        result = 1;\n      }\n\n      return result;\n    }.bind(this));\n  },\n  _processRecurrenceAppointment: function _processRecurrenceAppointment(appointment, index, skipLongAppointments) {\n    var recurrenceRule = this.invoke(\"getField\", \"recurrenceRule\", appointment);\n    var result = {\n      parts: [],\n      indexes: []\n    };\n\n    if (recurrenceRule) {\n      var dates = appointment.settings || appointment;\n      var startDate = new Date(this.invoke(\"getField\", \"startDate\", dates));\n      var endDate = new Date(this.invoke(\"getField\", \"endDate\", dates));\n      var appointmentDuration = endDate.getTime() - startDate.getTime();\n      var recurrenceException = this.invoke(\"getField\", \"recurrenceException\", appointment);\n      var startViewDate = this.invoke(\"getStartViewDate\");\n      var endViewDate = this.invoke(\"getEndViewDate\");\n\n      var recurrentDates = _utils2.default.getDatesByRecurrence({\n        rule: recurrenceRule,\n        exception: recurrenceException,\n        start: startDate,\n        end: endDate,\n        min: startViewDate,\n        max: endViewDate\n      });\n\n      var recurrentDateCount = appointment.settings ? 1 : recurrentDates.length;\n\n      for (var i = 0; i < recurrentDateCount; i++) {\n        var appointmentPart = (0, _extend.extend)({}, appointment, true);\n\n        if (recurrentDates[i]) {\n          var appointmentSettings = this._applyStartDateToObj(recurrentDates[i], {});\n\n          this._applyEndDateToObj(new Date(recurrentDates[i].getTime() + appointmentDuration), appointmentSettings);\n\n          appointmentPart.settings = appointmentSettings;\n        } else {\n          appointmentPart.settings = dates;\n        }\n\n        result.parts.push(appointmentPart);\n\n        if (!skipLongAppointments) {\n          this._processLongAppointment(appointmentPart, result);\n        }\n      }\n\n      result.indexes.push(index);\n    }\n\n    return result;\n  },\n  _processLongAppointment: function _processLongAppointment(appointment, result) {\n    var parts = this.splitAppointmentByDay(appointment);\n    var partCount = parts.length;\n    var endViewDate = this.invoke(\"getEndViewDate\").getTime();\n    var startViewDate = this.invoke(\"getStartViewDate\").getTime();\n    var startDateTimeZone = this.invoke(\"getField\", \"startDateTimeZone\", appointment);\n    result = result || {\n      parts: []\n    };\n\n    if (partCount > 1) {\n      (0, _extend.extend)(appointment, parts[0]);\n\n      for (var i = 1; i < partCount; i++) {\n        var startDate = this.invoke(\"getField\", \"startDate\", parts[i].settings).getTime();\n        startDate = this.invoke(\"convertDateByTimezone\", startDate, startDateTimeZone);\n\n        if (startDate < endViewDate && startDate > startViewDate) {\n          result.parts.push(parts[i]);\n        }\n      }\n    }\n\n    return result;\n  },\n  _reduceRecurrenceAppointments: function _reduceRecurrenceAppointments(recurrenceIndexes, appointments) {\n    (0, _iterator.each)(recurrenceIndexes, function (i, index) {\n      appointments.splice(index - i, 1);\n    });\n  },\n  _combineAppointments: function _combineAppointments(appointments, additionalAppointments) {\n    if (additionalAppointments.length) {\n      _array2.default.merge(appointments, additionalAppointments);\n    }\n\n    this._sortAppointmentsByStartDate(appointments);\n  },\n  _applyStartDateToObj: function _applyStartDateToObj(startDate, obj) {\n    this.invoke(\"setField\", \"startDate\", obj, startDate);\n    return obj;\n  },\n  _applyEndDateToObj: function _applyEndDateToObj(endDate, obj) {\n    this.invoke(\"setField\", \"endDate\", obj, endDate);\n    return obj;\n  },\n  moveAppointmentBack: function moveAppointmentBack(dragEvent) {\n    var $appointment = this._$currentAppointment;\n    var size = this._initialSize;\n    var coords = this._initialCoordinates;\n\n    if (dragEvent) {\n      if (_type2.default.isDeferred(dragEvent.cancel)) {\n        dragEvent.cancel.resolve(true);\n      } else {\n        dragEvent.cancel = true;\n      }\n    }\n\n    this.notifyObserver(\"moveBack\");\n\n    if ($appointment && !dragEvent) {\n      if (coords) {\n        _translator2.default.move($appointment, coords);\n\n        delete this._initialSize;\n      }\n\n      if (size) {\n        $appointment.outerWidth(size.width);\n        $appointment.outerHeight(size.height);\n        delete this._initialCoordinates;\n      }\n    }\n  },\n  focus: function focus() {\n    if (this._$currentAppointment) {\n      var focusedElement = (0, _dom.getPublicElement)(this._$currentAppointment);\n      this.option(\"focusedElement\", focusedElement);\n\n      _events_engine2.default.trigger(focusedElement, \"focus\");\n    }\n  },\n  splitAppointmentByDay: function splitAppointmentByDay(appointment) {\n    var dates = appointment.settings || appointment;\n    var originalStartDate = new Date(this.invoke(\"getField\", \"startDate\", dates));\n\n    var startDate = _date2.default.makeDate(originalStartDate);\n\n    var endDate = _date2.default.makeDate(this.invoke(\"getField\", \"endDate\", dates));\n\n    var startDateTimeZone = this.invoke(\"getField\", \"startDateTimeZone\", appointment);\n    var endDateTimeZone = this.invoke(\"getField\", \"endDateTimeZone\", appointment);\n    var maxAllowedDate = this.invoke(\"getEndViewDate\");\n    var startDayHour = this.invoke(\"getStartDayHour\");\n    var endDayHour = this.invoke(\"getEndDayHour\");\n    var appointmentIsLong = this.invoke(\"appointmentTakesSeveralDays\", appointment);\n    var result = [];\n    startDate = this.invoke(\"convertDateByTimezone\", startDate, startDateTimeZone);\n    endDate = this.invoke(\"convertDateByTimezone\", endDate, endDateTimeZone);\n\n    if (startDate.getHours() <= endDayHour && startDate.getHours() >= startDayHour && !appointmentIsLong) {\n      result.push(this._applyStartDateToObj(new Date(startDate), {\n        appointmentData: appointment\n      }));\n      startDate.setDate(startDate.getDate() + 1);\n    }\n\n    while (appointmentIsLong && startDate.getTime() < endDate.getTime() - 1 && startDate < maxAllowedDate) {\n      var currentStartDate = new Date(startDate);\n      var currentEndDate = new Date(startDate);\n\n      this._checkStartDate(currentStartDate, originalStartDate, startDayHour);\n\n      this._checkEndDate(currentEndDate, endDate, endDayHour);\n\n      var appointmentData = _object2.default.deepExtendArraySafe({}, appointment, true);\n\n      var appointmentSettings = {};\n\n      this._applyStartDateToObj(currentStartDate, appointmentSettings);\n\n      this._applyEndDateToObj(currentEndDate, appointmentSettings);\n\n      appointmentData.settings = appointmentSettings;\n      result.push(appointmentData);\n      startDate.setDate(startDate.getDate() + 1);\n      startDate.setHours(startDayHour);\n    }\n\n    return result;\n  },\n  _checkStartDate: function _checkStartDate(currentDate, originalDate, startDayHour) {\n    if (!_date2.default.sameDate(currentDate, originalDate) || currentDate.getHours() <= startDayHour) {\n      currentDate.setHours(startDayHour, 0, 0, 0);\n    } else {\n      currentDate.setHours(originalDate.getHours(), originalDate.getMinutes(), originalDate.getSeconds(), originalDate.getMilliseconds());\n    }\n  },\n  _checkEndDate: function _checkEndDate(currentDate, originalDate, endDayHour) {\n    if (!_date2.default.sameDate(currentDate, originalDate) || currentDate.getHours() > endDayHour) {\n      currentDate.setHours(endDayHour, 0, 0, 0);\n    } else {\n      currentDate.setHours(originalDate.getHours(), originalDate.getMinutes(), originalDate.getSeconds(), originalDate.getMilliseconds());\n    }\n  }\n}).include(_uiScheduler2.default);\n\n(0, _component_registrator2.default)(\"dxSchedulerAppointments\", SchedulerAppointments);\nmodule.exports = SchedulerAppointments;","map":{"version":3,"sources":["C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/devextreme/ui/scheduler/ui.scheduler.appointments.js"],"names":["_renderer","require","_renderer2","_interopRequireDefault","_dom_adapter","_dom_adapter2","_events_engine","_events_engine2","_element_data","_element_data2","_translator","_translator2","_date","_date2","_common","_common2","_type","_type2","_iterator","_object","_object2","_array","_array2","_extend","_dom","_utils","_utils2","_component_registrator","_component_registrator2","_uiScheduler","_uiScheduler2","_uiScheduler3","_uiScheduler4","_utils3","_utils4","_double_click","_double_click2","_message","_message2","_uiCollection_widget","_uiCollection_widget2","_deferred","_utils5","_utils6","obj","APPOINTMENT_SETTINGS_NAME","COMPONENT_CLASS","APPOINTMENT_ITEM_CLASS","APPOINTMENT_TITLE_CLASS","APPOINTMENT_CONTENT_DETAILS_CLASS","APPOINTMENT_DATE_CLASS","RECURRING_ICON_CLASS","ALL_DAY_CONTENT_CLASS","DBLCLICK_EVENT_NAME","toMs","SchedulerAppointments","ctor","_supportedKeys","parent","tabHandler","appointments","focusedAppointment","index","lastIndex","e","$nextAppointment","escape","del","data","target","tab","_getAppointmentByIndex","_getAccessAppointments","_resetTabIndex","$appointment","_moveFocus","_focusTarget","_renderFocusTarget","_focusInHandler","clearTimeout","that","setTimeout","_focusOutHandler","_eventBindingTarget","_getDefaultOptions","noDataText","activeStateEnabled","hoverStateEnabled","tabIndex","fixedContainer","allDayContainer","allowDrag","allowResize","allowAllDayResize","onAppointmentDblClick","_collectorOffset","_optionChanged","args","_isAllDayAppointment","appointment","_isRepaintAppointment","_isRepaintAll","i","_applyFragment","fragment","_onEachAppointment","_repaintAppointments","_this","isRepaintAll","allDayFragment","commonFragment","container","_attachAppointmentsEvents","_clearItem","$items","item","$item","_clearDropDownItems","_clearDropDownItemsElements","_findItemElementByItem","result","_itemClass","_itemContainer","$container","$result","$allDayContainer","_cleanItemContainer","_clean","_init","_renderAppointmentTemplate","formatText","model","$contentDetails","_executeItemRenderAction","action","itemData","itemElement","_itemClickHandler","afterExecute","_processItemClick","$target","_extendActionArgs","_render","_attachAppointmentDblClick","itemSelector","itemContainer","_dblClickHandler","$targetAppointment","appointmentData","_renderItem","setting","_getItemContent","$itemFrame","$itemContent","_createItemByTemplate","renderArgs","targetedAppointmentData","_getAppointmentContainer","allDay","_postprocessRenderItem","_renderAppointment","geometry","settings","deferredColor","observer","direction","reduced","isCompact","startDate","cellWidth","cellHeight","resizableConfig","_applyResourceDataAttr","resources","attr","name","values","_resizableConfig","area","onResizeStart","updatedArea","width","height","onResizeEnd","_calculateResizableArea","coordinates","left","itemSetting","top","groupIndex","_resizeEndHandler","$element","endDate","dateRange","updatedDates","_getDateRange","deltaTime","renderingStrategyDirection","isStartDateChanged","isAllDay","needCorrectDates","startTime","endTime","_correctEndDateByDelta","endDayHour","startDayHour","visibleDayDuration","daysCount","Math","maxDate","minDate","tailOfCurrentDay","tailOfPrevDays","lastDay","_correctStartDateByDelta","firstDay","_tryGetAppointmentColor","_getAppointmentColor","res","response","_calculateBoundOffset","_virtualAppointments","_processVirtualAppointment","virtualAppointment","appointmentSetting","virtualGroupIndex","items","colors","buttonColor","color","_renderContentImpl","_renderDropDownAppointments","virtualGroup","virtualItems","virtualCoordinates","buttonWidth","buttonHeight","rtlOffset","onAppointmentClick","applyOffset","_isGroupCompact","_sortAppointmentsByStartDate","firstDate","a","secondDate","b","_processRecurrenceAppointment","recurrenceRule","parts","indexes","dates","appointmentDuration","recurrenceException","startViewDate","endViewDate","recurrentDates","rule","exception","start","end","min","max","recurrentDateCount","appointmentPart","appointmentSettings","_processLongAppointment","partCount","startDateTimeZone","_reduceRecurrenceAppointments","_combineAppointments","additionalAppointments","_applyStartDateToObj","_applyEndDateToObj","moveAppointmentBack","size","coords","dragEvent","focus","focusedElement","splitAppointmentByDay","originalStartDate","endDateTimeZone","maxAllowedDate","appointmentIsLong","currentStartDate","currentEndDate","_checkStartDate","currentDate","originalDate","_checkEndDate","module"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/scheduler/ui.scheduler.appointments.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar _renderer = require(\"../../core/renderer\");\r\nvar _renderer2 = _interopRequireDefault(_renderer);\r\nvar _dom_adapter = require(\"../../core/dom_adapter\");\r\nvar _dom_adapter2 = _interopRequireDefault(_dom_adapter);\r\nvar _events_engine = require(\"../../events/core/events_engine\");\r\nvar _events_engine2 = _interopRequireDefault(_events_engine);\r\nvar _element_data = require(\"../../core/element_data\");\r\nvar _element_data2 = _interopRequireDefault(_element_data);\r\nvar _translator = require(\"../../animation/translator\");\r\nvar _translator2 = _interopRequireDefault(_translator);\r\nvar _date = require(\"../../core/utils/date\");\r\nvar _date2 = _interopRequireDefault(_date);\r\nvar _common = require(\"../../core/utils/common\");\r\nvar _common2 = _interopRequireDefault(_common);\r\nvar _type = require(\"../../core/utils/type\");\r\nvar _type2 = _interopRequireDefault(_type);\r\nvar _iterator = require(\"../../core/utils/iterator\");\r\nvar _object = require(\"../../core/utils/object\");\r\nvar _object2 = _interopRequireDefault(_object);\r\nvar _array = require(\"../../core/utils/array\");\r\nvar _array2 = _interopRequireDefault(_array);\r\nvar _extend = require(\"../../core/utils/extend\");\r\nvar _dom = require(\"../../core/utils/dom\");\r\nvar _utils = require(\"./utils.recurrence\");\r\nvar _utils2 = _interopRequireDefault(_utils);\r\nvar _component_registrator = require(\"../../core/component_registrator\");\r\nvar _component_registrator2 = _interopRequireDefault(_component_registrator);\r\nvar _uiScheduler = require(\"./ui.scheduler.publisher_mixin\");\r\nvar _uiScheduler2 = _interopRequireDefault(_uiScheduler);\r\nvar _uiScheduler3 = require(\"./ui.scheduler.appointment\");\r\nvar _uiScheduler4 = _interopRequireDefault(_uiScheduler3);\r\nvar _utils3 = require(\"../../events/utils\");\r\nvar _utils4 = _interopRequireDefault(_utils3);\r\nvar _double_click = require(\"../../events/double_click\");\r\nvar _double_click2 = _interopRequireDefault(_double_click);\r\nvar _message = require(\"../../localization/message\");\r\nvar _message2 = _interopRequireDefault(_message);\r\nvar _uiCollection_widget = require(\"../collection/ui.collection_widget.edit\");\r\nvar _uiCollection_widget2 = _interopRequireDefault(_uiCollection_widget);\r\nvar _deferred = require(\"../../core/utils/deferred\");\r\nvar _utils5 = require(\"./utils.js\");\r\nvar _utils6 = _interopRequireDefault(_utils5);\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\nvar APPOINTMENT_SETTINGS_NAME = \"dxAppointmentSettings\";\r\nvar COMPONENT_CLASS = \"dx-scheduler-scrollable-appointments\";\r\nvar APPOINTMENT_ITEM_CLASS = \"dx-scheduler-appointment\";\r\nvar APPOINTMENT_TITLE_CLASS = \"dx-scheduler-appointment-title\";\r\nvar APPOINTMENT_CONTENT_DETAILS_CLASS = \"dx-scheduler-appointment-content-details\";\r\nvar APPOINTMENT_DATE_CLASS = \"dx-scheduler-appointment-content-date\";\r\nvar RECURRING_ICON_CLASS = \"dx-scheduler-appointment-recurrence-icon\";\r\nvar ALL_DAY_CONTENT_CLASS = \"dx-scheduler-appointment-content-allday\";\r\nvar DBLCLICK_EVENT_NAME = _utils4.default.addNamespace(_double_click2.default.name, \"dxSchedulerAppointment\");\r\nvar toMs = _date2.default.dateToMilliseconds;\r\nvar SchedulerAppointments = _uiCollection_widget2.default.inherit({\r\n    ctor: function(element, options) {\r\n        this.callBase(element, options)\r\n    },\r\n    _supportedKeys: function() {\r\n        var parent = this.callBase();\r\n        var tabHandler = function(e) {\r\n            var appointments = this._getAccessAppointments();\r\n            var focusedAppointment = appointments.filter(\".dx-state-focused\");\r\n            var index = focusedAppointment.data(APPOINTMENT_SETTINGS_NAME).sortedIndex;\r\n            var lastIndex = appointments.length - 1;\r\n            if (index > 0 && e.shiftKey || index < lastIndex && !e.shiftKey) {\r\n                e.preventDefault();\r\n                e.shiftKey ? index-- : index++;\r\n                var $nextAppointment = this._getAppointmentByIndex(index);\r\n                this._resetTabIndex($nextAppointment);\r\n                _events_engine2.default.trigger($nextAppointment, \"focus\")\r\n            }\r\n        };\r\n        return (0, _extend.extend)(parent, {\r\n            escape: function() {\r\n                this.moveAppointmentBack();\r\n                this._escPressed = true\r\n            }.bind(this),\r\n            del: function(e) {\r\n                if (this.option(\"allowDelete\")) {\r\n                    e.preventDefault();\r\n                    var data = this._getItemData(e.target);\r\n                    this.notifyObserver(\"deleteAppointment\", {\r\n                        data: data,\r\n                        target: e.target\r\n                    });\r\n                    this.notifyObserver(\"hideAppointmentTooltip\")\r\n                }\r\n            }.bind(this),\r\n            tab: tabHandler\r\n        })\r\n    },\r\n    _getAppointmentByIndex: function(sortedIndex) {\r\n        var appointments = this._getAccessAppointments();\r\n        return appointments.filter(function(_, $item) {\r\n            return _element_data2.default.data($item, APPOINTMENT_SETTINGS_NAME).sortedIndex === sortedIndex\r\n        }).eq(0)\r\n    },\r\n    _getAccessAppointments: function() {\r\n        return this._itemElements().filter(\":visible\").not(\".dx-state-disabled\")\r\n    },\r\n    _resetTabIndex: function($appointment) {\r\n        this._focusTarget().attr(\"tabIndex\", -1);\r\n        $appointment.attr(\"tabIndex\", this.option(\"tabIndex\"))\r\n    },\r\n    _moveFocus: _common2.default.noop,\r\n    _focusTarget: function() {\r\n        return this._itemElements()\r\n    },\r\n    _renderFocusTarget: function() {\r\n        var $appointment = this._getAppointmentByIndex(0);\r\n        this._resetTabIndex($appointment)\r\n    },\r\n    _focusInHandler: function(e) {\r\n        clearTimeout(this._appointmentFocusedTimeout);\r\n        this.callBase.apply(this, arguments);\r\n        this._$currentAppointment = (0, _renderer2.default)(e.target);\r\n        this.option(\"focusedElement\", (0, _dom.getPublicElement)((0, _renderer2.default)(e.target)));\r\n        var that = this;\r\n        this._appointmentFocusedTimeout = setTimeout(function() {\r\n            that.notifyObserver(\"appointmentFocused\")\r\n        })\r\n    },\r\n    _focusOutHandler: function() {\r\n        var $appointment = this._getAppointmentByIndex(0);\r\n        this.option(\"focusedElement\", (0, _dom.getPublicElement)($appointment));\r\n        this.callBase.apply(this, arguments)\r\n    },\r\n    _eventBindingTarget: function() {\r\n        return this._itemContainer()\r\n    },\r\n    _getDefaultOptions: function() {\r\n        return (0, _extend.extend)(this.callBase(), {\r\n            noDataText: null,\r\n            activeStateEnabled: true,\r\n            hoverStateEnabled: true,\r\n            tabIndex: 0,\r\n            fixedContainer: null,\r\n            allDayContainer: null,\r\n            allowDrag: true,\r\n            allowResize: true,\r\n            allowAllDayResize: true,\r\n            onAppointmentDblClick: null,\r\n            _collectorOffset: 0\r\n        })\r\n    },\r\n    _optionChanged: function(args) {\r\n        switch (args.name) {\r\n            case \"items\":\r\n                this._cleanFocusState();\r\n                this._clearDropDownItems();\r\n                this._clearDropDownItemsElements();\r\n                this._repaintAppointments(args.value);\r\n                this._renderDropDownAppointments();\r\n                this._attachAppointmentsEvents();\r\n                break;\r\n            case \"fixedContainer\":\r\n            case \"allDayContainer\":\r\n            case \"onAppointmentDblClick\":\r\n                break;\r\n            case \"allowDrag\":\r\n            case \"allowResize\":\r\n            case \"allowAllDayResize\":\r\n                this._invalidate();\r\n                break;\r\n            case \"focusedElement\":\r\n                this._resetTabIndex((0, _renderer2.default)(args.value));\r\n                this.callBase(args);\r\n                break;\r\n            case \"allowDelete\":\r\n                break;\r\n            case \"focusStateEnabled\":\r\n                this._clearDropDownItemsElements();\r\n                this._renderDropDownAppointments();\r\n                this.callBase(args);\r\n                break;\r\n            default:\r\n                this.callBase(args)\r\n        }\r\n    },\r\n    _isAllDayAppointment: function(appointment) {\r\n        return appointment.settings.length && appointment.settings[0].allDay || false\r\n    },\r\n    _isRepaintAppointment: function(appointment) {\r\n        return !_type2.default.isDefined(appointment.needRepaint) || true === appointment.needRepaint\r\n    },\r\n    _isRepaintAll: function(appointments) {\r\n        if (this.invoke(\"isCurrentViewAgenda\")) {\r\n            return true\r\n        }\r\n        for (var i = 0; i < appointments.length; i++) {\r\n            var appointment = appointments[i];\r\n            if (!this._isRepaintAppointment(appointment)) {\r\n                return false\r\n            }\r\n        }\r\n        return true\r\n    },\r\n    _applyFragment: function(fragment, allDay) {\r\n        if (fragment.children().length > 0) {\r\n            this._getAppointmentContainer(allDay).append(fragment)\r\n        }\r\n    },\r\n    _onEachAppointment: function(appointment, index, container, isRepaintAll) {\r\n        if (appointment && true === appointment.needRemove) {\r\n            this._clearItem(appointment);\r\n            return\r\n        }\r\n        if (this._isRepaintAppointment(appointment)) {\r\n            appointment.needRepaint = false;\r\n            !isRepaintAll && this._clearItem(appointment);\r\n            this._renderItem(index, appointment, container)\r\n        }\r\n    },\r\n    _repaintAppointments: function(appointments) {\r\n        var _this = this;\r\n        var isRepaintAll = this._isRepaintAll(appointments);\r\n        var allDayFragment = (0, _renderer2.default)(this._getAppointmentContainer(true));\r\n        var commonFragment = (0, _renderer2.default)(this._getAppointmentContainer(false));\r\n        if (isRepaintAll) {\r\n            this._getAppointmentContainer(true).html(\"\");\r\n            this._getAppointmentContainer(false).html(\"\")\r\n        }!appointments.length && this._cleanItemContainer();\r\n        appointments.forEach(function(appointment, index) {\r\n            var container = _this._isAllDayAppointment(appointment) ? allDayFragment : commonFragment;\r\n            _this._onEachAppointment(appointment, index, container, isRepaintAll)\r\n        });\r\n        this._applyFragment(allDayFragment, true);\r\n        this._applyFragment(commonFragment, false)\r\n    },\r\n    _attachAppointmentsEvents: function() {\r\n        this._attachClickEvent();\r\n        this._attachHoldEvent();\r\n        this._attachContextMenuEvent();\r\n        this._attachAppointmentDblClick();\r\n        this._renderFocusState();\r\n        this._attachFeedbackEvents();\r\n        this._attachHoverEvents()\r\n    },\r\n    _clearItem: function(item) {\r\n        var $items = this._findItemElementByItem(item.itemData);\r\n        if (!$items.length) {\r\n            return\r\n        }(0, _iterator.each)($items, function(_, $item) {\r\n            $item.detach();\r\n            $item.remove()\r\n        })\r\n    },\r\n    _clearDropDownItems: function() {\r\n        this._virtualAppointments = {}\r\n    },\r\n    _clearDropDownItemsElements: function() {\r\n        this.invoke(\"clearCompactAppointments\")\r\n    },\r\n    _findItemElementByItem: function(item) {\r\n        var result = [];\r\n        var that = this;\r\n        this.itemElements().each(function() {\r\n            var $item = (0, _renderer2.default)(this);\r\n            if ($item.data(that._itemDataKey()) === item) {\r\n                result.push($item)\r\n            }\r\n        });\r\n        return result\r\n    },\r\n    _itemClass: function() {\r\n        return APPOINTMENT_ITEM_CLASS\r\n    },\r\n    _itemContainer: function() {\r\n        var $container = this.callBase();\r\n        var $result = $container;\r\n        var $allDayContainer = this.option(\"allDayContainer\");\r\n        if ($allDayContainer) {\r\n            $result = $container.add($allDayContainer)\r\n        }\r\n        return $result\r\n    },\r\n    _cleanItemContainer: function() {\r\n        this.callBase();\r\n        var $allDayContainer = this.option(\"allDayContainer\");\r\n        if ($allDayContainer) {\r\n            $allDayContainer.empty()\r\n        }\r\n        this._virtualAppointments = {}\r\n    },\r\n    _clean: function() {\r\n        this.callBase();\r\n        delete this._$currentAppointment;\r\n        delete this._initialSize;\r\n        delete this._initialCoordinates\r\n    },\r\n    _init: function() {\r\n        this.callBase();\r\n        this.$element().addClass(COMPONENT_CLASS);\r\n        this._preventSingleAppointmentClick = false\r\n    },\r\n    _renderAppointmentTemplate: function($container, data, model) {\r\n        var formatText = this.invoke(\"getTextAndFormatDate\", model.appointmentData, model.appointmentData.settings || data.recurrenceRule && model.targetedAppointmentData || {}, \"TIME\");\r\n        (0, _renderer2.default)(\"<div>\").text(formatText.text).addClass(APPOINTMENT_TITLE_CLASS).appendTo($container);\r\n        if (_type2.default.isPlainObject(data)) {\r\n            if (data.html) {\r\n                $container.html(data.html)\r\n            }\r\n        }\r\n        var $contentDetails = (0, _renderer2.default)(\"<div>\").addClass(APPOINTMENT_CONTENT_DETAILS_CLASS);\r\n        (0, _renderer2.default)(\"<div>\").addClass(APPOINTMENT_DATE_CLASS).text(formatText.formatDate).appendTo($contentDetails);\r\n        $contentDetails.appendTo($container);\r\n        if (data.recurrenceRule) {\r\n            (0, _renderer2.default)(\"<span>\").addClass(RECURRING_ICON_CLASS + \" dx-icon-repeat\").appendTo($container)\r\n        }\r\n        if (data.allDay) {\r\n            (0, _renderer2.default)(\"<div>\").text(\" \" + _message2.default.format(\"dxScheduler-allDay\") + \": \").addClass(ALL_DAY_CONTENT_CLASS).prependTo($contentDetails)\r\n        }\r\n    },\r\n    _executeItemRenderAction: function(index, itemData, itemElement) {\r\n        var action = this._getItemRenderAction();\r\n        if (action) {\r\n            action(this.invoke(\"mapAppointmentFields\", {\r\n                itemData: itemData,\r\n                itemElement: itemElement\r\n            }))\r\n        }\r\n        delete this._currentAppointmentSettings\r\n    },\r\n    _itemClickHandler: function(e) {\r\n        this.callBase(e, {}, {\r\n            afterExecute: function(e) {\r\n                this._processItemClick(e.args[0].event)\r\n            }.bind(this)\r\n        })\r\n    },\r\n    _processItemClick: function(e) {\r\n        var $target = (0, _renderer2.default)(e.currentTarget);\r\n        var data = this._getItemData($target);\r\n        if (\"keydown\" === e.type || _utils4.default.isFakeClickEvent(e)) {\r\n            this.notifyObserver(\"showEditAppointmentPopup\", {\r\n                data: data,\r\n                target: $target\r\n            });\r\n            return\r\n        }\r\n        this._appointmentClickTimeout = setTimeout(function() {\r\n            if (!this._preventSingleAppointmentClick && _dom_adapter2.default.getBody().contains($target[0])) {\r\n                this.notifyObserver(\"showAppointmentTooltip\", {\r\n                    data: data,\r\n                    target: $target\r\n                })\r\n            }\r\n            this._preventSingleAppointmentClick = false\r\n        }.bind(this), 300)\r\n    },\r\n    _extendActionArgs: function() {\r\n        var args = this.callBase.apply(this, arguments);\r\n        return this.invoke(\"mapAppointmentFields\", args)\r\n    },\r\n    _render: function() {\r\n        this.callBase.apply(this, arguments);\r\n        this._attachAppointmentDblClick()\r\n    },\r\n    _attachAppointmentDblClick: function() {\r\n        var that = this;\r\n        var itemSelector = that._itemSelector();\r\n        var itemContainer = this._itemContainer();\r\n        _events_engine2.default.off(itemContainer, DBLCLICK_EVENT_NAME, itemSelector);\r\n        _events_engine2.default.on(itemContainer, DBLCLICK_EVENT_NAME, itemSelector, function(e) {\r\n            that._itemDXEventHandler(e, \"onAppointmentDblClick\", {}, {\r\n                afterExecute: function(e) {\r\n                    that._dblClickHandler(e.args[0].event)\r\n                }\r\n            })\r\n        })\r\n    },\r\n    _dblClickHandler: function(e) {\r\n        var $targetAppointment = (0, _renderer2.default)(e.currentTarget);\r\n        var appointmentData = this._getItemData($targetAppointment);\r\n        clearTimeout(this._appointmentClickTimeout);\r\n        this._preventSingleAppointmentClick = true;\r\n        this.notifyObserver(\"showEditAppointmentPopup\", {\r\n            data: appointmentData,\r\n            target: $targetAppointment\r\n        })\r\n    },\r\n    _renderItem: function(index, item, container) {\r\n        var itemData = item.itemData;\r\n        for (var i = 0; i < item.settings.length; i++) {\r\n            var setting = item.settings[i];\r\n            this._currentAppointmentSettings = setting;\r\n            var $item = this.callBase(index, itemData, container);\r\n            $item.data(APPOINTMENT_SETTINGS_NAME, setting)\r\n        }\r\n    },\r\n    _getItemContent: function($itemFrame) {\r\n        $itemFrame.data(APPOINTMENT_SETTINGS_NAME, this._currentAppointmentSettings);\r\n        var $itemContent = this.callBase($itemFrame);\r\n        return $itemContent\r\n    },\r\n    _createItemByTemplate: function(itemTemplate, renderArgs) {\r\n        var itemData = renderArgs.itemData,\r\n            container = renderArgs.container,\r\n            index = renderArgs.index;\r\n        return itemTemplate.render({\r\n            model: {\r\n                appointmentData: itemData,\r\n                targetedAppointmentData: this.invoke(\"getTargetedAppointmentData\", itemData, (0, _renderer2.default)(container).parent())\r\n            },\r\n            container: container,\r\n            index: index\r\n        })\r\n    },\r\n    _getAppointmentContainer: function(allDay) {\r\n        var $allDayContainer = this.option(\"allDayContainer\");\r\n        var $container = this.itemsContainer().not($allDayContainer);\r\n        if (allDay && $allDayContainer) {\r\n            $container = $allDayContainer\r\n        }\r\n        return $container\r\n    },\r\n    _postprocessRenderItem: function(args) {\r\n        this._renderAppointment(args.itemElement, this._currentAppointmentSettings)\r\n    },\r\n    _renderAppointment: function($appointment, settings) {\r\n        $appointment.data(APPOINTMENT_SETTINGS_NAME, settings);\r\n        this._applyResourceDataAttr($appointment);\r\n        var data = this._getItemData($appointment);\r\n        var geometry = this.invoke(\"getAppointmentGeometry\", settings);\r\n        var allowResize = !settings.isCompact && this.option(\"allowResize\") && (!_type2.default.isDefined(settings.skipResizing) || _type2.default.isString(settings.skipResizing));\r\n        var allowDrag = this.option(\"allowDrag\");\r\n        var allDay = settings.allDay;\r\n        this.invoke(\"setCellDataCacheAlias\", this._currentAppointmentSettings, geometry);\r\n        var deferredColor = this._getAppointmentColor($appointment, settings.groupIndex);\r\n        if (settings.virtual) {\r\n            this._processVirtualAppointment(settings, $appointment, data, deferredColor)\r\n        } else {\r\n            this._createComponent($appointment, _uiScheduler4.default, {\r\n                observer: this.option(\"observer\"),\r\n                data: data,\r\n                geometry: geometry,\r\n                direction: settings.direction || \"vertical\",\r\n                allowResize: allowResize,\r\n                allowDrag: allowDrag,\r\n                allDay: allDay,\r\n                reduced: settings.appointmentReduced,\r\n                isCompact: settings.isCompact,\r\n                startDate: new Date(settings.startDate),\r\n                cellWidth: this.invoke(\"getCellWidth\"),\r\n                cellHeight: this.invoke(\"getCellHeight\"),\r\n                resizableConfig: this._resizableConfig(data, settings)\r\n            });\r\n            deferredColor.done(function(color) {\r\n                if (color) {\r\n                    $appointment.css(\"backgroundColor\", color)\r\n                }\r\n            })\r\n        }\r\n    },\r\n    _applyResourceDataAttr: function($appointment) {\r\n        var resources = this.invoke(\"getResourcesFromItem\", this._getItemData($appointment));\r\n        if (resources) {\r\n            (0, _iterator.each)(resources, function(name, values) {\r\n                var attr = \"data-\" + _common2.default.normalizeKey(name.toLowerCase()) + \"-\";\r\n                for (var i = 0; i < values.length; i++) {\r\n                    $appointment.attr(attr + _common2.default.normalizeKey(values[i]), true)\r\n                }\r\n            })\r\n        }\r\n    },\r\n    _resizableConfig: function(appointmentData, itemSetting) {\r\n        return {\r\n            area: this._calculateResizableArea(itemSetting, appointmentData),\r\n            onResizeStart: function(e) {\r\n                this._$currentAppointment = (0, _renderer2.default)(e.element);\r\n                if (this.invoke(\"needRecalculateResizableArea\")) {\r\n                    var updatedArea = this._calculateResizableArea(this._$currentAppointment.data(APPOINTMENT_SETTINGS_NAME), this._$currentAppointment.data(\"dxItemData\"));\r\n                    e.component.option(\"area\", updatedArea);\r\n                    e.component._renderDragOffsets(e.event)\r\n                }\r\n                this._initialSize = {\r\n                    width: e.width,\r\n                    height: e.height\r\n                };\r\n                this._initialCoordinates = _translator2.default.locate(this._$currentAppointment)\r\n            }.bind(this),\r\n            onResizeEnd: function(e) {\r\n                if (this._escPressed) {\r\n                    e.event.cancel = true;\r\n                    return\r\n                }\r\n                this._resizeEndHandler(e)\r\n            }.bind(this)\r\n        }\r\n    },\r\n    _calculateResizableArea: function(itemSetting, appointmentData) {\r\n        var area = this.$element().closest(\".dx-scrollable-content\");\r\n        return this.invoke(\"getResizableAppointmentArea\", {\r\n            coordinates: {\r\n                left: itemSetting.left,\r\n                top: 0,\r\n                groupIndex: itemSetting.groupIndex\r\n            },\r\n            allDay: itemSetting.allDay\r\n        }) || area\r\n    },\r\n    _resizeEndHandler: function(e) {\r\n        var $element = (0, _renderer2.default)(e.element);\r\n        var itemData = this._getItemData($element);\r\n        var startDate = this.invoke(\"getStartDate\", itemData, true);\r\n        var endDate = this.invoke(\"getEndDate\", itemData, true);\r\n        var dateRange = this._getDateRange(e, startDate, endDate);\r\n        var updatedDates = {};\r\n        this.invoke(\"setField\", \"startDate\", updatedDates, new Date(dateRange[0]));\r\n        this.invoke(\"setField\", \"endDate\", updatedDates, new Date(dateRange[1]));\r\n        var data = (0, _extend.extend)({}, itemData, updatedDates);\r\n        this.notifyObserver(\"updateAppointmentAfterResize\", {\r\n            target: itemData,\r\n            data: data,\r\n            $appointment: $element\r\n        })\r\n    },\r\n    _getDateRange: function(e, startDate, endDate) {\r\n        var itemData = this._getItemData(e.element);\r\n        var deltaTime = this.invoke(\"getDeltaTime\", e, this._initialSize, itemData);\r\n        var renderingStrategyDirection = this.invoke(\"getRenderingStrategyDirection\");\r\n        var isStartDateChanged = false;\r\n        var isAllDay = this.invoke(\"isAllDay\", itemData);\r\n        var needCorrectDates = this.invoke(\"needCorrectAppointmentDates\") && !isAllDay;\r\n        var startTime;\r\n        var endTime;\r\n        if (\"vertical\" !== renderingStrategyDirection || isAllDay) {\r\n            isStartDateChanged = this.option(\"rtlEnabled\") ? e.handles.right : e.handles.left\r\n        } else {\r\n            isStartDateChanged = e.handles.top\r\n        }\r\n        if (isStartDateChanged) {\r\n            startTime = needCorrectDates ? this._correctStartDateByDelta(startDate, deltaTime) : startDate.getTime() - deltaTime;\r\n            startTime += _utils6.default.getTimezoneOffsetChangeInMs(startDate, endDate, startTime, endDate);\r\n            endTime = endDate.getTime()\r\n        } else {\r\n            startTime = startDate.getTime();\r\n            endTime = needCorrectDates ? this._correctEndDateByDelta(endDate, deltaTime) : endDate.getTime() + deltaTime;\r\n            endTime += _utils6.default.getTimezoneOffsetChangeInMs(startDate, endDate, startDate, endTime)\r\n        }\r\n        return [startTime, endTime]\r\n    },\r\n    _correctEndDateByDelta: function(endDate, deltaTime) {\r\n        var endDayHour = this.invoke(\"getEndDayHour\");\r\n        var startDayHour = this.invoke(\"getStartDayHour\");\r\n        var result = endDate.getTime() + deltaTime;\r\n        var visibleDayDuration = (endDayHour - startDayHour) * toMs(\"hour\");\r\n        var daysCount = deltaTime > 0 ? Math.ceil(deltaTime / visibleDayDuration) : Math.floor(deltaTime / visibleDayDuration);\r\n        var maxDate = new Date(endDate);\r\n        var minDate = new Date(endDate);\r\n        minDate.setHours(startDayHour, 0, 0, 0);\r\n        maxDate.setHours(endDayHour, 0, 0, 0);\r\n        if (result > maxDate.getTime() || result <= minDate.getTime()) {\r\n            var tailOfCurrentDay = maxDate.getTime() - endDate.getTime();\r\n            var tailOfPrevDays = deltaTime - tailOfCurrentDay;\r\n            var lastDay = new Date(endDate.setDate(endDate.getDate() + daysCount));\r\n            lastDay.setHours(startDayHour, 0, 0, 0);\r\n            result = lastDay.getTime() + tailOfPrevDays - visibleDayDuration * (daysCount - 1)\r\n        }\r\n        return result\r\n    },\r\n    _correctStartDateByDelta: function(startDate, deltaTime) {\r\n        var endDayHour = this.invoke(\"getEndDayHour\");\r\n        var startDayHour = this.invoke(\"getStartDayHour\");\r\n        var result = startDate.getTime() - deltaTime;\r\n        var visibleDayDuration = (endDayHour - startDayHour) * toMs(\"hour\");\r\n        var daysCount = deltaTime > 0 ? Math.ceil(deltaTime / visibleDayDuration) : Math.floor(deltaTime / visibleDayDuration);\r\n        var maxDate = new Date(startDate);\r\n        var minDate = new Date(startDate);\r\n        minDate.setHours(startDayHour, 0, 0, 0);\r\n        maxDate.setHours(endDayHour, 0, 0, 0);\r\n        if (result < minDate.getTime() || result >= maxDate.getTime()) {\r\n            var tailOfCurrentDay = startDate.getTime() - minDate.getTime();\r\n            var tailOfPrevDays = deltaTime - tailOfCurrentDay;\r\n            var firstDay = new Date(startDate.setDate(startDate.getDate() - daysCount));\r\n            firstDay.setHours(endDayHour, 0, 0, 0);\r\n            result = firstDay.getTime() - tailOfPrevDays + visibleDayDuration * (daysCount - 1)\r\n        }\r\n        return result\r\n    },\r\n    _tryGetAppointmentColor: function(appointment) {\r\n        var settings = (0, _renderer2.default)(appointment).data(APPOINTMENT_SETTINGS_NAME);\r\n        if (!settings) {\r\n            return\r\n        }\r\n        return this._getAppointmentColor(appointment, settings.groupIndex)\r\n    },\r\n    _getAppointmentColor: function($appointment, groupIndex) {\r\n        var res = new _deferred.Deferred;\r\n        var response = this.invoke(\"getAppointmentColor\", {\r\n            itemData: this._getItemData($appointment),\r\n            groupIndex: groupIndex\r\n        });\r\n        response.done(function(color) {\r\n            return res.resolve(color)\r\n        });\r\n        return res.promise()\r\n    },\r\n    _calculateBoundOffset: function() {\r\n        return this.invoke(\"getBoundOffset\")\r\n    },\r\n    _virtualAppointments: {},\r\n    _processVirtualAppointment: function(appointmentSetting, $appointment, appointmentData, color) {\r\n        var virtualAppointment = appointmentSetting.virtual;\r\n        var virtualGroupIndex = virtualAppointment.index;\r\n        if (!_type2.default.isDefined(this._virtualAppointments[virtualGroupIndex])) {\r\n            this._virtualAppointments[virtualGroupIndex] = {\r\n                coordinates: {\r\n                    top: virtualAppointment.top,\r\n                    left: virtualAppointment.left\r\n                },\r\n                items: {\r\n                    data: [],\r\n                    colors: [],\r\n                    settings: []\r\n                },\r\n                isAllDay: virtualAppointment.isAllDay ? true : false,\r\n                buttonColor: color\r\n            }\r\n        }\r\n        appointmentSetting.targetedAppointmentData = this.invoke(\"getTargetedAppointmentData\", appointmentData, $appointment, true);\r\n        this._virtualAppointments[virtualGroupIndex].items.settings.push(appointmentSetting);\r\n        this._virtualAppointments[virtualGroupIndex].items.data.push(appointmentData);\r\n        this._virtualAppointments[virtualGroupIndex].items.colors.push(color);\r\n        $appointment.remove()\r\n    },\r\n    _renderContentImpl: function() {\r\n        this.callBase();\r\n        this._renderDropDownAppointments()\r\n    },\r\n    _renderDropDownAppointments: function() {\r\n        (0, _iterator.each)(this._virtualAppointments, function(groupIndex) {\r\n            var virtualGroup = this._virtualAppointments[groupIndex];\r\n            var virtualItems = virtualGroup.items;\r\n            var virtualCoordinates = virtualGroup.coordinates;\r\n            var $container = virtualGroup.isAllDay ? this.option(\"allDayContainer\") : this.$element();\r\n            var left = virtualCoordinates.left;\r\n            var buttonWidth = this.invoke(\"getDropDownAppointmentWidth\", virtualGroup.isAllDay);\r\n            var buttonHeight = this.invoke(\"getDropDownAppointmentHeight\");\r\n            var rtlOffset = this.option(\"rtlEnabled\") ? buttonWidth : 0;\r\n            this.notifyObserver(\"renderCompactAppointments\", {\r\n                $container: $container,\r\n                coordinates: {\r\n                    top: virtualCoordinates.top,\r\n                    left: left + rtlOffset\r\n                },\r\n                items: virtualItems,\r\n                buttonColor: virtualGroup.buttonColor,\r\n                width: buttonWidth - this.option(\"_collectorOffset\"),\r\n                height: buttonHeight,\r\n                onAppointmentClick: this.option(\"onItemClick\"),\r\n                allowDrag: this.option(\"allowDrag\"),\r\n                cellWidth: this.invoke(\"getCellWidth\"),\r\n                isCompact: this.invoke(\"isAdaptive\") || this._isGroupCompact(virtualGroup),\r\n                applyOffset: !virtualGroup.isAllDay && this.invoke(\"isApplyCompactAppointmentOffset\")\r\n            })\r\n        }.bind(this))\r\n    },\r\n    _isGroupCompact: function(virtualGroup) {\r\n        return !virtualGroup.isAllDay && this.invoke(\"supportCompactDropDownAppointments\")\r\n    },\r\n    _sortAppointmentsByStartDate: function(appointments) {\r\n        appointments.sort(function(a, b) {\r\n            var result = 0;\r\n            var firstDate = new Date(this.invoke(\"getField\", \"startDate\", a.settings || a)).getTime();\r\n            var secondDate = new Date(this.invoke(\"getField\", \"startDate\", b.settings || b)).getTime();\r\n            if (firstDate < secondDate) {\r\n                result = -1\r\n            }\r\n            if (firstDate > secondDate) {\r\n                result = 1\r\n            }\r\n            return result\r\n        }.bind(this))\r\n    },\r\n    _processRecurrenceAppointment: function(appointment, index, skipLongAppointments) {\r\n        var recurrenceRule = this.invoke(\"getField\", \"recurrenceRule\", appointment);\r\n        var result = {\r\n            parts: [],\r\n            indexes: []\r\n        };\r\n        if (recurrenceRule) {\r\n            var dates = appointment.settings || appointment;\r\n            var startDate = new Date(this.invoke(\"getField\", \"startDate\", dates));\r\n            var endDate = new Date(this.invoke(\"getField\", \"endDate\", dates));\r\n            var appointmentDuration = endDate.getTime() - startDate.getTime();\r\n            var recurrenceException = this.invoke(\"getField\", \"recurrenceException\", appointment);\r\n            var startViewDate = this.invoke(\"getStartViewDate\");\r\n            var endViewDate = this.invoke(\"getEndViewDate\");\r\n            var recurrentDates = _utils2.default.getDatesByRecurrence({\r\n                rule: recurrenceRule,\r\n                exception: recurrenceException,\r\n                start: startDate,\r\n                end: endDate,\r\n                min: startViewDate,\r\n                max: endViewDate\r\n            });\r\n            var recurrentDateCount = appointment.settings ? 1 : recurrentDates.length;\r\n            for (var i = 0; i < recurrentDateCount; i++) {\r\n                var appointmentPart = (0, _extend.extend)({}, appointment, true);\r\n                if (recurrentDates[i]) {\r\n                    var appointmentSettings = this._applyStartDateToObj(recurrentDates[i], {});\r\n                    this._applyEndDateToObj(new Date(recurrentDates[i].getTime() + appointmentDuration), appointmentSettings);\r\n                    appointmentPart.settings = appointmentSettings\r\n                } else {\r\n                    appointmentPart.settings = dates\r\n                }\r\n                result.parts.push(appointmentPart);\r\n                if (!skipLongAppointments) {\r\n                    this._processLongAppointment(appointmentPart, result)\r\n                }\r\n            }\r\n            result.indexes.push(index)\r\n        }\r\n        return result\r\n    },\r\n    _processLongAppointment: function(appointment, result) {\r\n        var parts = this.splitAppointmentByDay(appointment);\r\n        var partCount = parts.length;\r\n        var endViewDate = this.invoke(\"getEndViewDate\").getTime();\r\n        var startViewDate = this.invoke(\"getStartViewDate\").getTime();\r\n        var startDateTimeZone = this.invoke(\"getField\", \"startDateTimeZone\", appointment);\r\n        result = result || {\r\n            parts: []\r\n        };\r\n        if (partCount > 1) {\r\n            (0, _extend.extend)(appointment, parts[0]);\r\n            for (var i = 1; i < partCount; i++) {\r\n                var startDate = this.invoke(\"getField\", \"startDate\", parts[i].settings).getTime();\r\n                startDate = this.invoke(\"convertDateByTimezone\", startDate, startDateTimeZone);\r\n                if (startDate < endViewDate && startDate > startViewDate) {\r\n                    result.parts.push(parts[i])\r\n                }\r\n            }\r\n        }\r\n        return result\r\n    },\r\n    _reduceRecurrenceAppointments: function(recurrenceIndexes, appointments) {\r\n        (0, _iterator.each)(recurrenceIndexes, function(i, index) {\r\n            appointments.splice(index - i, 1)\r\n        })\r\n    },\r\n    _combineAppointments: function(appointments, additionalAppointments) {\r\n        if (additionalAppointments.length) {\r\n            _array2.default.merge(appointments, additionalAppointments)\r\n        }\r\n        this._sortAppointmentsByStartDate(appointments)\r\n    },\r\n    _applyStartDateToObj: function(startDate, obj) {\r\n        this.invoke(\"setField\", \"startDate\", obj, startDate);\r\n        return obj\r\n    },\r\n    _applyEndDateToObj: function(endDate, obj) {\r\n        this.invoke(\"setField\", \"endDate\", obj, endDate);\r\n        return obj\r\n    },\r\n    moveAppointmentBack: function(dragEvent) {\r\n        var $appointment = this._$currentAppointment;\r\n        var size = this._initialSize;\r\n        var coords = this._initialCoordinates;\r\n        if (dragEvent) {\r\n            if (_type2.default.isDeferred(dragEvent.cancel)) {\r\n                dragEvent.cancel.resolve(true)\r\n            } else {\r\n                dragEvent.cancel = true\r\n            }\r\n        }\r\n        this.notifyObserver(\"moveBack\");\r\n        if ($appointment && !dragEvent) {\r\n            if (coords) {\r\n                _translator2.default.move($appointment, coords);\r\n                delete this._initialSize\r\n            }\r\n            if (size) {\r\n                $appointment.outerWidth(size.width);\r\n                $appointment.outerHeight(size.height);\r\n                delete this._initialCoordinates\r\n            }\r\n        }\r\n    },\r\n    focus: function() {\r\n        if (this._$currentAppointment) {\r\n            var focusedElement = (0, _dom.getPublicElement)(this._$currentAppointment);\r\n            this.option(\"focusedElement\", focusedElement);\r\n            _events_engine2.default.trigger(focusedElement, \"focus\")\r\n        }\r\n    },\r\n    splitAppointmentByDay: function(appointment) {\r\n        var dates = appointment.settings || appointment;\r\n        var originalStartDate = new Date(this.invoke(\"getField\", \"startDate\", dates));\r\n        var startDate = _date2.default.makeDate(originalStartDate);\r\n        var endDate = _date2.default.makeDate(this.invoke(\"getField\", \"endDate\", dates));\r\n        var startDateTimeZone = this.invoke(\"getField\", \"startDateTimeZone\", appointment);\r\n        var endDateTimeZone = this.invoke(\"getField\", \"endDateTimeZone\", appointment);\r\n        var maxAllowedDate = this.invoke(\"getEndViewDate\");\r\n        var startDayHour = this.invoke(\"getStartDayHour\");\r\n        var endDayHour = this.invoke(\"getEndDayHour\");\r\n        var appointmentIsLong = this.invoke(\"appointmentTakesSeveralDays\", appointment);\r\n        var result = [];\r\n        startDate = this.invoke(\"convertDateByTimezone\", startDate, startDateTimeZone);\r\n        endDate = this.invoke(\"convertDateByTimezone\", endDate, endDateTimeZone);\r\n        if (startDate.getHours() <= endDayHour && startDate.getHours() >= startDayHour && !appointmentIsLong) {\r\n            result.push(this._applyStartDateToObj(new Date(startDate), {\r\n                appointmentData: appointment\r\n            }));\r\n            startDate.setDate(startDate.getDate() + 1)\r\n        }\r\n        while (appointmentIsLong && startDate.getTime() < endDate.getTime() - 1 && startDate < maxAllowedDate) {\r\n            var currentStartDate = new Date(startDate);\r\n            var currentEndDate = new Date(startDate);\r\n            this._checkStartDate(currentStartDate, originalStartDate, startDayHour);\r\n            this._checkEndDate(currentEndDate, endDate, endDayHour);\r\n            var appointmentData = _object2.default.deepExtendArraySafe({}, appointment, true);\r\n            var appointmentSettings = {};\r\n            this._applyStartDateToObj(currentStartDate, appointmentSettings);\r\n            this._applyEndDateToObj(currentEndDate, appointmentSettings);\r\n            appointmentData.settings = appointmentSettings;\r\n            result.push(appointmentData);\r\n            startDate.setDate(startDate.getDate() + 1);\r\n            startDate.setHours(startDayHour)\r\n        }\r\n        return result\r\n    },\r\n    _checkStartDate: function(currentDate, originalDate, startDayHour) {\r\n        if (!_date2.default.sameDate(currentDate, originalDate) || currentDate.getHours() <= startDayHour) {\r\n            currentDate.setHours(startDayHour, 0, 0, 0)\r\n        } else {\r\n            currentDate.setHours(originalDate.getHours(), originalDate.getMinutes(), originalDate.getSeconds(), originalDate.getMilliseconds())\r\n        }\r\n    },\r\n    _checkEndDate: function(currentDate, originalDate, endDayHour) {\r\n        if (!_date2.default.sameDate(currentDate, originalDate) || currentDate.getHours() > endDayHour) {\r\n            currentDate.setHours(endDayHour, 0, 0, 0)\r\n        } else {\r\n            currentDate.setHours(originalDate.getHours(), originalDate.getMinutes(), originalDate.getSeconds(), originalDate.getMilliseconds())\r\n        }\r\n    }\r\n}).include(_uiScheduler2.default);\r\n(0, _component_registrator2.default)(\"dxSchedulerAppointments\", SchedulerAppointments);\r\nmodule.exports = SchedulerAppointments;\r\n"]},"metadata":{},"sourceType":"module"}