{"ast":null,"code":"/**\r\n * DevExtreme (ui/pivot_grid/ui.pivot_grid.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar _renderer = require(\"../../core/renderer\");\n\nvar _renderer2 = _interopRequireDefault(_renderer);\n\nvar _window = require(\"../../core/utils/window\");\n\nvar _browser = require(\"../../core/utils/browser\");\n\nvar _events_engine = require(\"../../events/core/events_engine\");\n\nvar _events_engine2 = _interopRequireDefault(_events_engine);\n\nvar _component_registrator = require(\"../../core/component_registrator\");\n\nvar _component_registrator2 = _interopRequireDefault(_component_registrator);\n\nvar _dom = require(\"../../core/utils/dom\");\n\nvar _string = require(\"../../core/utils/string\");\n\nvar _common = require(\"../../core/utils/common\");\n\nvar _iterator = require(\"../../core/utils/iterator\");\n\nvar _type = require(\"../../core/utils/type\");\n\nvar _extend = require(\"../../core/utils/extend\");\n\nvar _click = require(\"../../events/click\");\n\nvar _message = require(\"../../localization/message\");\n\nvar _ui = require(\"../widget/ui.widget\");\n\nvar _ui2 = _interopRequireDefault(_ui);\n\nvar _utils = require(\"../../events/utils\");\n\nvar _uiGrid_core = require(\"../grid_core/ui.grid_core.utils\");\n\nvar _uiPivot_grid = require(\"./ui.pivot_grid.utils\");\n\nvar _uiPivot_grid2 = require(\"./ui.pivot_grid.data_controller\");\n\nvar _uiPivot_grid3 = require(\"./ui.pivot_grid.data_area\");\n\nvar _uiPivot_grid4 = require(\"./ui.pivot_grid.headers_area\");\n\nvar _size = require(\"../../core/utils/size\");\n\nvar _uiPivot_grid5 = require(\"./ui.pivot_grid.fields_area\");\n\nvar _uiPivot_grid6 = require(\"./ui.pivot_grid.field_chooser\");\n\nvar _uiPivot_grid7 = _interopRequireDefault(_uiPivot_grid6);\n\nvar _uiPivot_grid8 = require(\"./ui.pivot_grid.field_chooser_base\");\n\nvar _uiPivot_grid9 = _interopRequireDefault(_uiPivot_grid8);\n\nvar _uiPivot_grid10 = require(\"./ui.pivot_grid.export\");\n\nvar _uiPivot_grid11 = require(\"./ui.pivot_grid.chart_integration\");\n\nvar _uiPivot_grid12 = _interopRequireDefault(_uiPivot_grid11);\n\nvar _popup = require(\"../popup\");\n\nvar _popup2 = _interopRequireDefault(_popup);\n\nvar _context_menu = require(\"../context_menu\");\n\nvar _context_menu2 = _interopRequireDefault(_context_menu);\n\nvar _deferred = require(\"../../core/utils/deferred\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nvar window = (0, _window.getWindow)();\nvar DATA_AREA_CELL_CLASS = \"dx-area-data-cell\";\nvar ROW_AREA_CELL_CLASS = \"dx-area-row-cell\";\nvar COLUMN_AREA_CELL_CLASS = \"dx-area-column-cell\";\nvar DESCRIPTION_AREA_CELL_CLASS = \"dx-area-description-cell\";\nvar BORDERS_CLASS = \"dx-pivotgrid-border\";\nvar PIVOTGRID_CLASS = \"dx-pivotgrid\";\nvar ROW_LINES_CLASS = \"dx-row-lines\";\nvar BOTTOM_ROW_CLASS = \"dx-bottom-row\";\nvar BOTTOM_BORDER_CLASS = \"dx-bottom-border\";\nvar FIELDS_CONTAINER_CLASS = \"dx-pivotgrid-fields-container\";\nvar FIELDS_CLASS = \"dx-area-fields\";\nvar FIELD_CHOOSER_POPUP_CLASS = \"dx-fieldchooser-popup\";\nvar INCOMPRESSIBLE_FIELDS_CLASS = \"dx-incompressible-fields\";\nvar OVERFLOW_HIDDEN_CLASS = \"dx-overflow-hidden\";\nvar TR = \"<tr>\";\nvar TD = \"<td>\";\nvar DIV = \"<div>\";\nvar TEST_HEIGHT = 66666;\n\nfunction getArraySum(array) {\n  var sum = 0;\n  (0, _iterator.each)(array, function (_, value) {\n    sum += value || 0;\n  });\n  return sum;\n}\n\nfunction adjustSizeArray(sizeArray, space) {\n  var delta = space / sizeArray.length;\n\n  for (var i = 0; i < sizeArray.length; i++) {\n    sizeArray[i] -= delta;\n  }\n}\n\nfunction unsubscribeScrollEvents(area) {\n  area.off(\"scroll\").off(\"stop\");\n}\n\nfunction subscribeToScrollEvent(area, handler) {\n  unsubscribeScrollEvents(area);\n  area.on(\"scroll\", handler).on(\"stop\", handler);\n}\n\nvar scrollBarInfoCache = {};\n\nfunction getScrollBarInfo(useNativeScrolling) {\n  if (scrollBarInfoCache[useNativeScrolling]) {\n    return scrollBarInfoCache[useNativeScrolling];\n  }\n\n  var scrollBarWidth = 0;\n  var options = {};\n  var container = (0, _renderer2.default)(DIV).css({\n    position: \"absolute\",\n    visibility: \"hidden\",\n    top: -1e3,\n    left: -1e3,\n    width: 100,\n    height: 100\n  }).appendTo(\"body\");\n  var content = (0, _renderer2.default)(\"<p>\").css({\n    width: \"100%\",\n    height: 200\n  }).appendTo(container);\n\n  if (\"auto\" !== useNativeScrolling) {\n    options.useNative = !!useNativeScrolling;\n    options.useSimulatedScrollbar = !useNativeScrolling;\n  }\n\n  container.dxScrollable(options);\n  var scrollBarUseNative = container.dxScrollable(\"instance\").option(\"useNative\");\n  scrollBarWidth = scrollBarUseNative ? container.width() - content.width() : 0;\n  container.remove();\n  scrollBarInfoCache[useNativeScrolling] = {\n    scrollBarWidth: scrollBarWidth,\n    scrollBarUseNative: scrollBarUseNative\n  };\n  return scrollBarInfoCache[useNativeScrolling];\n}\n\nfunction getCommonBorderWidth(elements, direction) {\n  var borderStyleNames = \"width\" === direction ? [\"borderLeftWidth\", \"borderRightWidth\"] : [\"borderTopWidth\", \"borderBottomWidth\"];\n  var width = 0;\n  (0, _iterator.each)(elements, function (_, elem) {\n    var computedStyle = window.getComputedStyle(elem.get(0));\n    borderStyleNames.forEach(function (borderStyleName) {\n      width += parseFloat(computedStyle[borderStyleName]) || 0;\n    });\n  });\n  return width;\n}\n\nfunction clickedOnFieldsArea($targetElement) {\n  return $targetElement.closest(\".\" + FIELDS_CLASS).length || $targetElement.find(\".\" + FIELDS_CLASS).length;\n}\n\nvar PivotGrid = _ui2.default.inherit({\n  _getDefaultOptions: function _getDefaultOptions() {\n    return (0, _extend.extend)(this.callBase(), {\n      scrolling: {\n        timeout: 300,\n        renderingThreshold: 150,\n        minTimeout: 10,\n        mode: \"standard\",\n        useNative: \"auto\",\n        removeInvisiblePages: true,\n        virtualRowHeight: 50,\n        virtualColumnWidth: 100\n      },\n      encodeHtml: true,\n      dataSource: null,\n      activeStateEnabled: false,\n      fieldChooser: {\n        minWidth: 250,\n        minHeight: 250,\n        enabled: true,\n        allowSearch: false,\n        searchTimeout: 500,\n        layout: 0,\n        title: (0, _message.format)(\"dxPivotGrid-fieldChooserTitle\"),\n        width: 600,\n        height: 600,\n        applyChangesMode: \"instantly\"\n      },\n      onContextMenuPreparing: null,\n      allowSorting: false,\n      allowSortingBySummary: false,\n      allowFiltering: false,\n      allowExpandAll: false,\n      wordWrapEnabled: true,\n      fieldPanel: {\n        showColumnFields: true,\n        showFilterFields: true,\n        showDataFields: true,\n        showRowFields: true,\n        allowFieldDragging: true,\n        visible: false,\n        texts: {\n          columnFieldArea: (0, _message.format)(\"dxPivotGrid-columnFieldArea\"),\n          rowFieldArea: (0, _message.format)(\"dxPivotGrid-rowFieldArea\"),\n          filterFieldArea: (0, _message.format)(\"dxPivotGrid-filterFieldArea\"),\n          dataFieldArea: (0, _message.format)(\"dxPivotGrid-dataFieldArea\")\n        }\n      },\n      dataFieldArea: \"column\",\n      \"export\": {\n        enabled: false,\n        fileName: \"PivotGrid\",\n        proxyUrl: void 0,\n        ignoreExcelErrors: true\n      },\n      showRowTotals: true,\n      showRowGrandTotals: true,\n      showColumnTotals: true,\n      showColumnGrandTotals: true,\n      hideEmptySummaryCells: true,\n      showTotalsPrior: \"none\",\n      rowHeaderLayout: \"standard\",\n      loadPanel: {\n        enabled: true,\n        text: (0, _message.format)(\"Loading\"),\n        width: 200,\n        height: 70,\n        showIndicator: true,\n        indicatorSrc: \"\",\n        showPane: true\n      },\n      texts: {\n        grandTotal: (0, _message.format)(\"dxPivotGrid-grandTotal\"),\n        total: (0, _message.getFormatter)(\"dxPivotGrid-total\"),\n        noData: (0, _message.format)(\"dxDataGrid-noDataText\"),\n        showFieldChooser: (0, _message.format)(\"dxPivotGrid-showFieldChooser\"),\n        expandAll: (0, _message.format)(\"dxPivotGrid-expandAll\"),\n        collapseAll: (0, _message.format)(\"dxPivotGrid-collapseAll\"),\n        sortColumnBySummary: (0, _message.getFormatter)(\"dxPivotGrid-sortColumnBySummary\"),\n        sortRowBySummary: (0, _message.getFormatter)(\"dxPivotGrid-sortRowBySummary\"),\n        removeAllSorting: (0, _message.format)(\"dxPivotGrid-removeAllSorting\"),\n        exportToExcel: (0, _message.format)(\"dxDataGrid-exportToExcel\"),\n        dataNotAvailable: (0, _message.format)(\"dxPivotGrid-dataNotAvailable\")\n      },\n      onCellClick: null,\n      onCellPrepared: null,\n      showBorders: false,\n      stateStoring: {\n        enabled: false,\n        storageKey: null,\n        type: \"localStorage\",\n        customLoad: null,\n        customSave: null,\n        savingTimeout: 2e3\n      },\n      onExpandValueChanging: null,\n      renderCellCountLimit: 2e4,\n      onExporting: null,\n      onExported: null,\n      onFileSaving: null,\n      headerFilter: {\n        width: 252,\n        height: 325,\n        allowSearch: false,\n        showRelevantValues: false,\n        searchTimeout: 500,\n        texts: {\n          emptyValue: (0, _message.format)(\"dxDataGrid-headerFilterEmptyValue\"),\n          ok: (0, _message.format)(\"dxDataGrid-headerFilterOK\"),\n          cancel: (0, _message.format)(\"dxDataGrid-headerFilterCancel\")\n        }\n      }\n    });\n  },\n  _getDataControllerOptions: function _getDataControllerOptions() {\n    var that = this;\n    return {\n      component: that,\n      dataSource: that.option(\"dataSource\"),\n      texts: that.option(\"texts\"),\n      showRowTotals: that.option(\"showRowTotals\"),\n      showRowGrandTotals: that.option(\"showRowGrandTotals\"),\n      showColumnTotals: that.option(\"showColumnTotals\"),\n      showTotalsPrior: that.option(\"showTotalsPrior\"),\n      showColumnGrandTotals: that.option(\"showColumnGrandTotals\"),\n      dataFieldArea: that.option(\"dataFieldArea\"),\n      rowHeaderLayout: that.option(\"rowHeaderLayout\"),\n      hideEmptySummaryCells: that.option(\"hideEmptySummaryCells\"),\n      onFieldsPrepared: function onFieldsPrepared(fields) {\n        (0, _iterator.each)(fields, function (index, field) {\n          (0, _iterator.each)([\"allowSorting\", \"allowSortingBySummary\", \"allowFiltering\", \"allowExpandAll\"], function (_, optionName) {\n            if (void 0 === field[optionName]) {\n              (0, _uiPivot_grid.setFieldProperty)(field, optionName, that.option(optionName));\n            }\n          });\n        });\n      }\n    };\n  },\n  _initDataController: function _initDataController() {\n    var that = this;\n    that._dataController && that._dataController.dispose();\n    that._dataController = new _uiPivot_grid2.DataController(that._getDataControllerOptions());\n\n    if ((0, _window.hasWindow)()) {\n      that._dataController.changed.add(function () {\n        that._render();\n      });\n    }\n\n    that._dataController.scrollChanged.add(function (options) {\n      that._scrollLeft = options.left;\n      that._scrollTop = options.top;\n    });\n\n    that._dataController.loadingChanged.add(function (isLoading) {\n      that._updateLoading();\n    });\n\n    that._dataController.progressChanged.add(that._updateLoading.bind(that));\n\n    that._dataController.dataSourceChanged.add(function () {\n      that._trigger(\"onChanged\");\n    });\n\n    var expandValueChanging = that.option(\"onExpandValueChanging\");\n\n    if (expandValueChanging) {\n      that._dataController.expandValueChanging.add(function (e) {\n        expandValueChanging(e);\n      });\n    }\n  },\n  _init: function _init() {\n    var that = this;\n    that.callBase();\n\n    that._initDataController();\n\n    that._scrollLeft = that._scrollTop = null;\n\n    that._initActions();\n  },\n  _initActions: function _initActions() {\n    var that = this;\n    that._actions = {\n      onChanged: that._createActionByOption(\"onChanged\"),\n      onContextMenuPreparing: that._createActionByOption(\"onContextMenuPreparing\"),\n      onCellClick: that._createActionByOption(\"onCellClick\"),\n      onExporting: that._createActionByOption(\"onExporting\"),\n      onExported: that._createActionByOption(\"onExported\"),\n      onFileSaving: that._createActionByOption(\"onFileSaving\"),\n      onCellPrepared: that._createActionByOption(\"onCellPrepared\")\n    };\n  },\n  _trigger: function _trigger(eventName, eventArg) {\n    this._actions[eventName](eventArg);\n  },\n  _optionChanged: function _optionChanged(args) {\n    var that = this;\n\n    switch (args.name) {\n      case \"dataSource\":\n      case \"allowSorting\":\n      case \"allowFiltering\":\n      case \"allowExpandAll\":\n      case \"allowSortingBySummary\":\n      case \"scrolling\":\n      case \"stateStoring\":\n        that._initDataController();\n\n        that._fieldChooserPopup.hide();\n\n        that._renderFieldChooser();\n\n        that._invalidate();\n\n        break;\n\n      case \"texts\":\n      case \"showTotalsPrior\":\n      case \"showRowTotals\":\n      case \"showRowGrandTotals\":\n      case \"showColumnTotals\":\n      case \"showColumnGrandTotals\":\n      case \"hideEmptySummaryCells\":\n      case \"dataFieldArea\":\n        that._dataController.updateViewOptions(that._getDataControllerOptions());\n\n        break;\n\n      case \"useNativeScrolling\":\n      case \"encodeHtml\":\n      case \"renderCellCountLimit\":\n        break;\n\n      case \"rtlEnabled\":\n        that.callBase(args);\n\n        that._renderFieldChooser();\n\n        that._renderContextMenu();\n\n        (0, _window.hasWindow)() && that._renderLoadPanel(that._dataArea.groupElement(), that.$element());\n\n        that._invalidate();\n\n        break;\n\n      case \"export\":\n        that._renderDescriptionArea();\n\n        break;\n\n      case \"onExpandValueChanging\":\n        break;\n\n      case \"onCellClick\":\n      case \"onContextMenuPreparing\":\n      case \"onExporting\":\n      case \"onExported\":\n      case \"onFileSaving\":\n      case \"onCellPrepared\":\n        that._actions[args.name] = that._createActionByOption(args.name);\n        break;\n\n      case \"fieldChooser\":\n        that._renderFieldChooser();\n\n        that._renderDescriptionArea();\n\n        break;\n\n      case \"loadPanel\":\n        if ((0, _window.hasWindow)()) {\n          that._renderLoadPanel(that._dataArea.groupElement(), that.$element());\n\n          that._invalidate();\n        }\n\n        break;\n\n      case \"fieldPanel\":\n        that._renderDescriptionArea();\n\n        that._invalidate();\n\n        break;\n\n      case \"headerFilter\":\n        that._renderFieldChooser();\n\n        that._invalidate();\n\n        break;\n\n      case \"showBorders\":\n        that._tableElement().toggleClass(BORDERS_CLASS, !!args.value);\n\n        that.updateDimensions();\n        break;\n\n      case \"wordWrapEnabled\":\n        that._tableElement().toggleClass(\"dx-word-wrap\", !!args.value);\n\n        that.updateDimensions();\n        break;\n\n      case \"rowHeaderLayout\":\n        that._tableElement().find(\".\" + ROW_AREA_CELL_CLASS).toggleClass(\"dx-area-tree-view\", \"tree\" === args.value);\n\n        that._dataController.updateViewOptions(that._getDataControllerOptions());\n\n        break;\n\n      case \"height\":\n      case \"width\":\n        that._hasHeight = null;\n        that.callBase(args);\n        that.resize();\n        break;\n\n      default:\n        that.callBase(args);\n    }\n  },\n  _updateScrollPosition: function _updateScrollPosition(columnsArea, rowsArea, dataArea) {\n    var that = this;\n    var scrollTop;\n    var scrollLeft;\n    var scrolled = that._scrollTop || that._scrollLeft;\n\n    if (that._scrollUpdating) {\n      return;\n    }\n\n    that._scrollUpdating = true;\n\n    if (rowsArea && !rowsArea.hasScroll() && that._hasHeight) {\n      that._scrollTop = null;\n    }\n\n    if (columnsArea && !columnsArea.hasScroll()) {\n      that._scrollLeft = null;\n    }\n\n    if (null !== that._scrollTop || null !== that._scrollLeft || scrolled || that.option(\"rtlEnabled\")) {\n      scrollTop = that._scrollTop || 0;\n      scrollLeft = that._scrollLeft || 0;\n      dataArea.scrollTo({\n        x: scrollLeft,\n        y: scrollTop\n      });\n      columnsArea.scrollTo(scrollLeft);\n      rowsArea.scrollTo(scrollTop);\n\n      that._dataController.updateWindowScrollPosition(that._scrollTop);\n    }\n\n    that._scrollUpdating = false;\n  },\n  _subscribeToEvents: function _subscribeToEvents(columnsArea, rowsArea, dataArea) {\n    var that = this;\n\n    var scrollHandler = function scrollHandler(e) {\n      var scrollOffset = e.scrollOffset;\n      var leftOffset = (0, _type.isDefined)(scrollOffset.left) ? scrollOffset.left : that._scrollLeft;\n      var topOffset = (0, _type.isDefined)(scrollOffset.top) && that._hasHeight ? scrollOffset.top : that._scrollTop;\n\n      if ((that._scrollLeft || 0) !== (leftOffset || 0) || (that._scrollTop || 0) !== (topOffset || 0)) {\n        that._scrollLeft = leftOffset;\n        that._scrollTop = topOffset;\n\n        that._updateScrollPosition(columnsArea, rowsArea, dataArea);\n\n        if (\"virtual\" === that.option(\"scrolling.mode\")) {\n          that._dataController.setViewportPosition(that._scrollLeft, that._scrollTop);\n        }\n      }\n    };\n\n    (0, _iterator.each)([columnsArea, rowsArea, dataArea], function (_, area) {\n      subscribeToScrollEvent(area, scrollHandler);\n    });\n    !that._hasHeight && that._dataController.subscribeToWindowScrollEvents(dataArea.groupElement());\n  },\n  _clean: _common.noop,\n  _needDelayResizing: function _needDelayResizing(cellsInfo) {\n    var cellsCount = cellsInfo.length * (cellsInfo.length ? cellsInfo[0].length : 0);\n    return cellsCount > this.option(\"renderCellCountLimit\");\n  },\n  _renderFieldChooser: function _renderFieldChooser() {\n    var that = this;\n    var container = that._pivotGridContainer;\n    var fieldChooserOptions = that.option(\"fieldChooser\") || {};\n    var toolbarItems = \"onDemand\" === fieldChooserOptions.applyChangesMode ? [{\n      toolbar: \"bottom\",\n      location: \"after\",\n      widget: \"dxButton\",\n      options: {\n        text: (0, _message.format)(\"OK\"),\n        onClick: function onClick(e) {\n          that._fieldChooserPopup.$content().dxPivotGridFieldChooser(\"applyChanges\");\n\n          that._fieldChooserPopup.hide();\n        }\n      }\n    }, {\n      toolbar: \"bottom\",\n      location: \"after\",\n      widget: \"dxButton\",\n      options: {\n        text: (0, _message.format)(\"Cancel\"),\n        onClick: function onClick(e) {\n          that._fieldChooserPopup.hide();\n        }\n      }\n    }] : [];\n    var fieldChooserComponentOptions = {\n      layout: fieldChooserOptions.layout,\n      texts: fieldChooserOptions.texts || {},\n      dataSource: that.getDataSource(),\n      allowSearch: fieldChooserOptions.allowSearch,\n      searchTimeout: fieldChooserOptions.searchTimeout,\n      width: void 0,\n      height: void 0,\n      headerFilter: that.option(\"headerFilter\"),\n      encodeHtml: that.option(\"encodeHtml\"),\n      applyChangesMode: fieldChooserOptions.applyChangesMode,\n      onContextMenuPreparing: function onContextMenuPreparing(e) {\n        that._trigger(\"onContextMenuPreparing\", e);\n      }\n    };\n    var popupOptions = {\n      shading: false,\n      title: fieldChooserOptions.title,\n      width: fieldChooserOptions.width,\n      height: fieldChooserOptions.height,\n      showCloseButton: true,\n      resizeEnabled: true,\n      minWidth: fieldChooserOptions.minWidth,\n      minHeight: fieldChooserOptions.minHeight,\n      toolbarItems: toolbarItems,\n      onResize: function onResize(e) {\n        e.component.$content().dxPivotGridFieldChooser(\"updateDimensions\");\n      },\n      onShown: function onShown(e) {\n        that._createComponent(e.component.content(), _uiPivot_grid7.default, fieldChooserComponentOptions);\n      },\n      onHidden: function onHidden(e) {\n        var fieldChooser = e.component.$content().dxPivotGridFieldChooser(\"instance\");\n        fieldChooser.resetTreeView();\n        fieldChooser.cancelChanges();\n      }\n    };\n\n    if (that._fieldChooserPopup) {\n      that._fieldChooserPopup.option(popupOptions);\n\n      that._fieldChooserPopup.$content().dxPivotGridFieldChooser(fieldChooserComponentOptions);\n    } else {\n      that._fieldChooserPopup = that._createComponent((0, _renderer2.default)(DIV).addClass(FIELD_CHOOSER_POPUP_CLASS).appendTo(container), _popup2.default, popupOptions);\n    }\n  },\n  _renderContextMenu: function _renderContextMenu() {\n    var that = this;\n    var $container = that._pivotGridContainer;\n\n    if (that._contextMenu) {\n      that._contextMenu.$element().remove();\n    }\n\n    that._contextMenu = that._createComponent((0, _renderer2.default)(DIV).appendTo($container), _context_menu2.default, {\n      onPositioning: function onPositioning(actionArgs) {\n        var event = actionArgs.event;\n        actionArgs.cancel = true;\n\n        if (!event) {\n          return;\n        }\n\n        var targetElement = event.target.cellIndex >= 0 ? event.target : (0, _renderer2.default)(event.target).closest(\"td\").get(0);\n\n        if (!targetElement) {\n          return;\n        }\n\n        var args = that._createEventArgs(targetElement, event);\n\n        var items = that._getContextMenuItems(args);\n\n        if (items) {\n          actionArgs.component.option(\"items\", items);\n          actionArgs.cancel = false;\n          return;\n        }\n      },\n      onItemClick: function onItemClick(params) {\n        params.itemData.onItemClick && params.itemData.onItemClick(params);\n      },\n      cssClass: PIVOTGRID_CLASS,\n      target: that.$element()\n    });\n  },\n  _getContextMenuItems: function _getContextMenuItems(e) {\n    var that = this;\n    var items = [];\n    var texts = that.option(\"texts\");\n\n    if (\"row\" === e.area || \"column\" === e.area) {\n      var areaFields = e[e.area + \"Fields\"];\n      var oppositeAreaFields = e[\"column\" === e.area ? \"rowFields\" : \"columnFields\"];\n      var field = e.cell.path && areaFields[e.cell.path.length - 1];\n      var dataSource = that.getDataSource();\n\n      if (field && field.allowExpandAll && e.cell.path.length < e[e.area + \"Fields\"].length && !dataSource.paginate()) {\n        items.push({\n          beginGroup: true,\n          icon: \"none\",\n          text: texts.expandAll,\n          onItemClick: function onItemClick() {\n            dataSource.expandAll(field.index);\n          }\n        });\n        items.push({\n          text: texts.collapseAll,\n          icon: \"none\",\n          onItemClick: function onItemClick() {\n            dataSource.collapseAll(field.index);\n          }\n        });\n      }\n\n      if (e.cell.isLast && !dataSource.paginate()) {\n        var sortingBySummaryItemCount = 0;\n        (0, _iterator.each)(oppositeAreaFields, function (index, field) {\n          if (!field.allowSortingBySummary) {\n            return;\n          }\n\n          (0, _iterator.each)(e.dataFields, function (dataIndex, dataField) {\n            if ((0, _type.isDefined)(e.cell.dataIndex) && e.cell.dataIndex !== dataIndex) {\n              return;\n            }\n\n            var showDataFieldCaption = !(0, _type.isDefined)(e.cell.dataIndex) && e.dataFields.length > 1;\n            var textFormat = \"column\" === e.area ? texts.sortColumnBySummary : texts.sortRowBySummary;\n            var checked = (0, _uiPivot_grid.findField)(e.dataFields, field.sortBySummaryField) === dataIndex && (e.cell.path || []).join(\"/\") === (field.sortBySummaryPath || []).join(\"/\");\n            var text = (0, _string.format)(textFormat, showDataFieldCaption ? field.caption + \" - \" + dataField.caption : field.caption);\n            items.push({\n              beginGroup: 0 === sortingBySummaryItemCount,\n              icon: checked ? \"desc\" === field.sortOrder ? \"sortdowntext\" : \"sortuptext\" : \"none\",\n              text: text,\n              onItemClick: function onItemClick() {\n                dataSource.field(field.index, {\n                  sortBySummaryField: dataField.name || dataField.caption || dataField.dataField,\n                  sortBySummaryPath: e.cell.path,\n                  sortOrder: \"desc\" === field.sortOrder ? \"asc\" : \"desc\"\n                });\n                dataSource.load();\n              }\n            });\n            sortingBySummaryItemCount++;\n          });\n        });\n        (0, _iterator.each)(oppositeAreaFields, function (index, field) {\n          if (!field.allowSortingBySummary || !(0, _type.isDefined)(field.sortBySummaryField)) {\n            return;\n          }\n\n          items.push({\n            beginGroup: 0 === sortingBySummaryItemCount,\n            icon: \"none\",\n            text: texts.removeAllSorting,\n            onItemClick: function onItemClick() {\n              (0, _iterator.each)(oppositeAreaFields, function (index, field) {\n                dataSource.field(field.index, {\n                  sortBySummaryField: void 0,\n                  sortBySummaryPath: void 0,\n                  sortOrder: void 0\n                });\n              });\n              dataSource.load();\n            }\n          });\n          return false;\n        });\n      }\n    }\n\n    if (that.option(\"fieldChooser.enabled\")) {\n      items.push({\n        beginGroup: true,\n        icon: \"columnchooser\",\n        text: texts.showFieldChooser,\n        onItemClick: function onItemClick() {\n          that._fieldChooserPopup.show();\n        }\n      });\n    }\n\n    if (that.option(\"export.enabled\")) {\n      items.push({\n        beginGroup: true,\n        icon: \"xlsxfile\",\n        text: texts.exportToExcel,\n        onItemClick: function onItemClick() {\n          that.exportToExcel();\n        }\n      });\n    }\n\n    e.items = items;\n\n    that._trigger(\"onContextMenuPreparing\", e);\n\n    items = e.items;\n\n    if (items && items.length) {\n      return items;\n    }\n  },\n  _createEventArgs: function _createEventArgs(targetElement, dxEvent) {\n    var that = this;\n    var dataSource = that.getDataSource();\n    var args = {\n      rowFields: dataSource.getAreaFields(\"row\"),\n      columnFields: dataSource.getAreaFields(\"column\"),\n      dataFields: dataSource.getAreaFields(\"data\"),\n      event: dxEvent\n    };\n\n    if (clickedOnFieldsArea((0, _renderer2.default)(targetElement))) {\n      return (0, _extend.extend)(that._createFieldArgs(targetElement), args);\n    } else {\n      return (0, _extend.extend)(that._createCellArgs(targetElement), args);\n    }\n  },\n  _createFieldArgs: function _createFieldArgs(targetElement) {\n    var field = (0, _renderer2.default)(targetElement).children().data(\"field\");\n    var args = {\n      field: field\n    };\n    return (0, _type.isDefined)(field) ? args : {};\n  },\n  _createCellArgs: function _createCellArgs(cellElement) {\n    var $cellElement = (0, _renderer2.default)(cellElement);\n    var columnIndex = cellElement.cellIndex;\n    var rowIndex = cellElement.parentElement.rowIndex;\n    var $table = $cellElement.closest(\"table\");\n    var data = $table.data(\"data\");\n    var cell = data && data[rowIndex] && data[rowIndex][columnIndex];\n    var args = {\n      area: $table.data(\"area\"),\n      rowIndex: rowIndex,\n      columnIndex: columnIndex,\n      cellElement: (0, _dom.getPublicElement)($cellElement),\n      cell: cell\n    };\n    return args;\n  },\n  _handleCellClick: function _handleCellClick(e) {\n    var that = this;\n\n    var args = that._createEventArgs(e.currentTarget, e);\n\n    var cell = args.cell;\n\n    if (!cell || !args.area && (args.rowIndex || args.columnIndex)) {\n      return;\n    }\n\n    that._trigger(\"onCellClick\", args);\n\n    cell && !args.cancel && (0, _type.isDefined)(cell.expanded) && setTimeout(function () {\n      that._dataController[cell.expanded ? \"collapseHeaderItem\" : \"expandHeaderItem\"](args.area, cell.path);\n    });\n  },\n  _getNoDataText: function _getNoDataText() {\n    return this.option(\"texts.noData\");\n  },\n  _renderNoDataText: _uiGrid_core.renderNoDataText,\n  _renderLoadPanel: _uiGrid_core.renderLoadPanel,\n  _updateLoading: function _updateLoading(progress) {\n    var that = this;\n\n    var isLoading = that._dataController.isLoading();\n\n    if (!that._loadPanel) {\n      return;\n    }\n\n    var loadPanelVisible = that._loadPanel.option(\"visible\");\n\n    if (!loadPanelVisible) {\n      that._startLoadingTime = new Date();\n    }\n\n    if (isLoading) {\n      if (progress) {\n        if (new Date() - that._startLoadingTime >= 1e3) {\n          that._loadPanel.option(\"message\", Math.floor(100 * progress) + \"%\");\n        }\n      } else {\n        that._loadPanel.option(\"message\", that.option(\"loadPanel.text\"));\n      }\n    }\n\n    clearTimeout(that._hideLoadingTimeoutID);\n\n    if (loadPanelVisible && !isLoading) {\n      that._hideLoadingTimeoutID = setTimeout(function () {\n        that._loadPanel.option(\"visible\", false);\n\n        that.$element().removeClass(OVERFLOW_HIDDEN_CLASS);\n      });\n    } else {\n      that._loadPanel.option(\"visible\", isLoading);\n\n      that.$element().toggleClass(OVERFLOW_HIDDEN_CLASS, !isLoading);\n    }\n  },\n  _renderDescriptionArea: function _renderDescriptionArea() {\n    var _this = this;\n\n    var $element = this.$element();\n    var $descriptionCell = $element.find(\".\" + DESCRIPTION_AREA_CELL_CLASS);\n    var $toolbarContainer = (0, _renderer2.default)(DIV).addClass(\"dx-pivotgrid-toolbar\");\n    var fieldPanel = this.option(\"fieldPanel\");\n    var $filterHeader = $element.find(\".dx-filter-header\");\n    var $columnHeader = $element.find(\".dx-column-header\");\n    var $targetContainer;\n\n    if (fieldPanel.visible && fieldPanel.showFilterFields) {\n      $targetContainer = $filterHeader;\n    } else {\n      if (fieldPanel.visible && (fieldPanel.showDataFields || fieldPanel.showColumnFields)) {\n        $targetContainer = $columnHeader;\n      } else {\n        $targetContainer = $descriptionCell;\n      }\n    }\n\n    $columnHeader.toggleClass(BOTTOM_BORDER_CLASS, !!(fieldPanel.visible && (fieldPanel.showDataFields || fieldPanel.showColumnFields)));\n    $filterHeader.toggleClass(BOTTOM_BORDER_CLASS, !!(fieldPanel.visible && fieldPanel.showFilterFields));\n    $descriptionCell.toggleClass(\"dx-pivotgrid-background\", fieldPanel.visible && (fieldPanel.showDataFields || fieldPanel.showColumnFields || fieldPanel.showRowFields));\n    this.$element().find(\".dx-pivotgrid-toolbar\").remove();\n    $toolbarContainer.prependTo($targetContainer);\n\n    if (this.option(\"fieldChooser.enabled\")) {\n      var $buttonElement = (0, _renderer2.default)(DIV).appendTo($toolbarContainer).addClass(\"dx-pivotgrid-field-chooser-button\");\n      var buttonOptions = {\n        icon: \"columnchooser\",\n        hint: this.option(\"texts.showFieldChooser\"),\n        onClick: function onClick() {\n          _this.getFieldChooserPopup().show();\n        }\n      };\n\n      this._createComponent($buttonElement, \"dxButton\", buttonOptions);\n    }\n\n    if (this.option(\"export.enabled\")) {\n      var _$buttonElement = (0, _renderer2.default)(DIV).appendTo($toolbarContainer).addClass(\"dx-pivotgrid-export-button\");\n\n      var _buttonOptions = {\n        icon: \"xlsxfile\",\n        hint: this.option(\"texts.exportToExcel\"),\n        onClick: function onClick() {\n          _this.exportToExcel();\n        }\n      };\n\n      this._createComponent(_$buttonElement, \"dxButton\", _buttonOptions);\n    }\n  },\n  _detectHasContainerHeight: function _detectHasContainerHeight() {\n    var that = this;\n    var element = that.$element();\n\n    if ((0, _type.isDefined)(that._hasHeight) || element.is(\":hidden\")) {\n      return;\n    }\n\n    that._pivotGridContainer.addClass(\"dx-hidden\");\n\n    var testElement = (0, _renderer2.default)(DIV).height(TEST_HEIGHT);\n    element.append(testElement);\n    that._hasHeight = element.height() !== TEST_HEIGHT;\n\n    that._pivotGridContainer.removeClass(\"dx-hidden\");\n\n    testElement.remove();\n  },\n  _renderHeaders: function _renderHeaders(rowHeaderContainer, columnHeaderContainer, filterHeaderContainer, dataHeaderContainer) {\n    var that = this;\n    var dataSource = that.getDataSource();\n    that._rowFields = that._rowFields || new _uiPivot_grid5.FieldsArea(that, \"row\");\n\n    that._rowFields.render(rowHeaderContainer, dataSource.getAreaFields(\"row\"));\n\n    that._columnFields = that._columnFields || new _uiPivot_grid5.FieldsArea(that, \"column\");\n\n    that._columnFields.render(columnHeaderContainer, dataSource.getAreaFields(\"column\"));\n\n    that._filterFields = that._filterFields || new _uiPivot_grid5.FieldsArea(that, \"filter\");\n\n    that._filterFields.render(filterHeaderContainer, dataSource.getAreaFields(\"filter\"));\n\n    that._dataFields = that._dataFields || new _uiPivot_grid5.FieldsArea(that, \"data\");\n\n    that._dataFields.render(dataHeaderContainer, dataSource.getAreaFields(\"data\"));\n\n    that.$element().dxPivotGridFieldChooserBase(\"instance\").renderSortable();\n  },\n  _createTableElement: function _createTableElement() {\n    var that = this;\n    var $table = (0, _renderer2.default)(\"<table>\").css({\n      width: \"100%\"\n    }).toggleClass(BORDERS_CLASS, !!that.option(\"showBorders\")).toggleClass(\"dx-word-wrap\", !!that.option(\"wordWrapEnabled\"));\n\n    _events_engine2.default.on($table, (0, _utils.addNamespace)(_click.name, \"dxPivotGrid\"), \"td\", that._handleCellClick.bind(that));\n\n    return $table;\n  },\n  _renderDataArea: function _renderDataArea(dataAreaElement) {\n    var that = this;\n    var dataArea = that._dataArea || new _uiPivot_grid3.DataArea(that);\n    that._dataArea = dataArea;\n    dataArea.render(dataAreaElement, that._dataController.getCellsInfo());\n    return dataArea;\n  },\n  _renderRowsArea: function _renderRowsArea(rowsAreaElement) {\n    var that = this;\n    var rowsArea = that._rowsArea || new _uiPivot_grid4.VerticalHeadersArea(that);\n    that._rowsArea = rowsArea;\n    rowsArea.render(rowsAreaElement, that._dataController.getRowsInfo());\n    return rowsArea;\n  },\n  _renderColumnsArea: function _renderColumnsArea(columnsAreaElement) {\n    var that = this;\n    var columnsArea = that._columnsArea || new _uiPivot_grid4.HorizontalHeadersArea(that);\n    that._columnsArea = columnsArea;\n    columnsArea.render(columnsAreaElement, that._dataController.getColumnsInfo());\n    return columnsArea;\n  },\n  _initMarkup: function _initMarkup() {\n    var that = this;\n    that.callBase.apply(this, arguments);\n    that.$element().addClass(PIVOTGRID_CLASS);\n  },\n  _renderContentImpl: function _renderContentImpl() {\n    var that = this;\n    var columnsAreaElement;\n    var rowsAreaElement;\n    var dataAreaElement;\n    var tableElement;\n    var isFirstDrawing = !that._pivotGridContainer;\n    var rowHeaderContainer;\n    var columnHeaderContainer;\n    var filterHeaderContainer;\n    var dataHeaderContainer;\n    tableElement = !isFirstDrawing && that._tableElement();\n\n    if (!tableElement) {\n      that.$element().addClass(ROW_LINES_CLASS).addClass(FIELDS_CONTAINER_CLASS);\n      that._pivotGridContainer = (0, _renderer2.default)(DIV).addClass(\"dx-pivotgrid-container\");\n\n      that._renderFieldChooser();\n\n      that._renderContextMenu();\n\n      columnsAreaElement = (0, _renderer2.default)(TD).addClass(COLUMN_AREA_CELL_CLASS);\n      rowsAreaElement = (0, _renderer2.default)(TD).addClass(ROW_AREA_CELL_CLASS);\n      dataAreaElement = (0, _renderer2.default)(TD).addClass(DATA_AREA_CELL_CLASS);\n      tableElement = that._createTableElement();\n      dataHeaderContainer = (0, _renderer2.default)(TD).addClass(\"dx-data-header\");\n      filterHeaderContainer = (0, _renderer2.default)(\"<td>\").attr(\"colspan\", \"2\").addClass(\"dx-filter-header\");\n      columnHeaderContainer = (0, _renderer2.default)(TD).addClass(\"dx-column-header\");\n      rowHeaderContainer = (0, _renderer2.default)(TD).addClass(DESCRIPTION_AREA_CELL_CLASS);\n      (0, _renderer2.default)(TR).append(filterHeaderContainer).appendTo(tableElement);\n      (0, _renderer2.default)(TR).append(dataHeaderContainer).append(columnHeaderContainer).appendTo(tableElement);\n      (0, _renderer2.default)(TR).toggleClass(\"dx-ie\", true === _browser.msie).append(rowHeaderContainer).append(columnsAreaElement).appendTo(tableElement);\n      (0, _renderer2.default)(TR).addClass(BOTTOM_ROW_CLASS).append(rowsAreaElement).append(dataAreaElement).appendTo(tableElement);\n\n      that._pivotGridContainer.append(tableElement);\n\n      that.$element().append(that._pivotGridContainer);\n\n      if (\"tree\" === that.option(\"rowHeaderLayout\")) {\n        rowsAreaElement.addClass(\"dx-area-tree-view\");\n      }\n    }\n\n    that.$element().addClass(OVERFLOW_HIDDEN_CLASS);\n\n    that._createComponent(that.$element(), _uiPivot_grid9.default, {\n      dataSource: that.getDataSource(),\n      encodeHtml: that.option(\"encodeHtml\"),\n      allowFieldDragging: that.option(\"fieldPanel.allowFieldDragging\"),\n      headerFilter: that.option(\"headerFilter\"),\n      visible: that.option(\"visible\")\n    });\n\n    var dataArea = that._renderDataArea(dataAreaElement);\n\n    var rowsArea = that._renderRowsArea(rowsAreaElement);\n\n    var columnsArea = that._renderColumnsArea(columnsAreaElement);\n\n    dataArea.tableElement().prepend(columnsArea.headElement());\n\n    if (isFirstDrawing) {\n      that._renderLoadPanel(dataArea.groupElement().parent(), that.$element());\n\n      that._renderDescriptionArea();\n\n      rowsArea.processScroll();\n      columnsArea.processScroll();\n    }\n\n    [dataArea, rowsArea, columnsArea].forEach(function (area) {\n      unsubscribeScrollEvents(area);\n    });\n\n    that._renderHeaders(rowHeaderContainer, columnHeaderContainer, filterHeaderContainer, dataHeaderContainer);\n\n    that._update(isFirstDrawing);\n  },\n  _update: function _update(isFirstDrawing) {\n    var that = this;\n    var updateHandler;\n\n    updateHandler = function updateHandler() {\n      that.updateDimensions().done(function () {\n        that._subscribeToEvents(that._columnsArea, that._rowsArea, that._dataArea);\n      });\n    };\n\n    if (that._needDelayResizing(that._dataArea.getData()) && isFirstDrawing) {\n      setTimeout(updateHandler);\n    } else {\n      updateHandler();\n    }\n  },\n  _fireContentReadyAction: function _fireContentReadyAction() {\n    if (!this._dataController.isLoading()) {\n      this.callBase();\n    }\n  },\n  getScrollPath: function getScrollPath(area) {\n    var that = this;\n\n    if (\"column\" === area) {\n      return that._columnsArea.getScrollPath(that._scrollLeft);\n    } else {\n      return that._rowsArea.getScrollPath(that._scrollTop);\n    }\n  },\n  getDataSource: function getDataSource() {\n    return this._dataController.getDataSource();\n  },\n  getFieldChooserPopup: function getFieldChooserPopup() {\n    return this._fieldChooserPopup;\n  },\n  hasScroll: function hasScroll(area) {\n    var that = this;\n    return \"column\" === area ? that._columnsArea.hasScroll() : that._rowsArea.hasScroll();\n  },\n  _dimensionChanged: function _dimensionChanged() {\n    this.updateDimensions();\n  },\n  _visibilityChanged: function _visibilityChanged(visible) {\n    if (visible) {\n      this.updateDimensions();\n    }\n  },\n  _dispose: function _dispose() {\n    var that = this;\n    clearTimeout(that._hideLoadingTimeoutID);\n    that.callBase.apply(that, arguments);\n\n    if (that._dataController) {\n      that._dataController.dispose();\n    }\n  },\n  _tableElement: function _tableElement() {\n    return this.$element().find(\"table\").first();\n  },\n  addWidgetPrefix: function addWidgetPrefix(className) {\n    return \"dx-pivotgrid-\" + className;\n  },\n  resize: function resize() {\n    this.updateDimensions();\n  },\n  isReady: function isReady() {\n    return this.callBase() && !this._dataController.isLoading();\n  },\n  updateDimensions: function updateDimensions() {\n    var that = this;\n    var groupWidth;\n\n    var tableElement = that._tableElement();\n\n    var rowsArea = that._rowsArea;\n    var columnsArea = that._columnsArea;\n    var dataArea = that._dataArea;\n    var dataAreaHeights;\n    var rowsAreaHeights;\n    var resultHeights;\n    var resultWidths;\n    var rowsAreaColumnWidths;\n    var bordersWidth;\n    var totalWidth = 0;\n    var totalHeight = 0;\n    var rowsAreaWidth = 0;\n    var hasRowsScroll;\n    var hasColumnsScroll;\n    var scrollingOptions = that.option(\"scrolling\") || {};\n    var scrollBarInfo = getScrollBarInfo(scrollingOptions.useNative);\n    var scrollBarWidth = scrollBarInfo.scrollBarWidth;\n    var dataAreaCell = tableElement.find(\".\" + DATA_AREA_CELL_CLASS);\n    var rowAreaCell = tableElement.find(\".\" + ROW_AREA_CELL_CLASS);\n    var columnAreaCell = tableElement.find(\".\" + COLUMN_AREA_CELL_CLASS);\n    var descriptionCell = tableElement.find(\".\" + DESCRIPTION_AREA_CELL_CLASS);\n    var filterHeaderCell = tableElement.find(\".dx-filter-header\");\n    var columnHeaderCell = tableElement.find(\".dx-column-header\");\n    var elementWidth;\n    var columnsAreaHeight;\n    var descriptionCellHeight;\n    var columnsAreaRowHeights;\n    var rowHeights;\n    var rowFieldsHeader = that._rowFields;\n    var columnsAreaRowCount;\n    var needSynchronizeFieldPanel;\n    var d = new _deferred.Deferred();\n\n    if (!(0, _window.hasWindow)()) {\n      return;\n    }\n\n    needSynchronizeFieldPanel = rowFieldsHeader.isVisible() && \"tree\" !== that.option(\"rowHeaderLayout\"), that._detectHasContainerHeight();\n\n    if (!dataArea.headElement().length) {\n      dataArea.tableElement().prepend(columnsArea.headElement());\n    }\n\n    if (needSynchronizeFieldPanel) {\n      rowsArea.updateColspans(rowFieldsHeader.getColumnsCount());\n      rowsArea.tableElement().prepend(rowFieldsHeader.headElement());\n    }\n\n    tableElement.addClass(INCOMPRESSIBLE_FIELDS_CLASS);\n    dataArea.reset();\n    rowsArea.reset();\n    columnsArea.reset();\n    rowFieldsHeader.reset();\n\n    var calculateHasScroll = function calculateHasScroll(areaSize, totalSize) {\n      return totalSize - areaSize >= 1;\n    };\n\n    var calculateGroupHeight = function calculateGroupHeight(dataAreaHeight, totalHeight, hasRowsScroll, hasColumnsScroll, scrollBarWidth) {\n      return hasRowsScroll ? dataAreaHeight : totalHeight + (hasColumnsScroll ? scrollBarWidth : 0);\n    };\n\n    (0, _common.deferUpdate)(function () {\n      resultWidths = dataArea.getColumnsWidth();\n      rowHeights = rowsArea.getRowsHeight();\n      rowsAreaHeights = needSynchronizeFieldPanel ? rowHeights.slice(1) : rowHeights;\n      dataAreaHeights = dataArea.getRowsHeight();\n      descriptionCellHeight = (0, _size.getSize)(descriptionCell[0], \"height\", {\n        paddings: true,\n        borders: true,\n        margins: true\n      }) + (needSynchronizeFieldPanel ? rowHeights[0] : 0);\n      columnsAreaRowCount = that._dataController.getColumnsInfo().length;\n      resultHeights = (0, _uiPivot_grid.mergeArraysByMaxValue)(rowsAreaHeights, dataAreaHeights.slice(columnsAreaRowCount));\n      columnsAreaRowHeights = dataAreaHeights.slice(0, columnsAreaRowCount);\n      columnsAreaHeight = getArraySum(columnsAreaRowHeights);\n      rowsAreaColumnWidths = rowsArea.getColumnsWidth();\n      var filterAreaHeight = 0;\n      var dataAreaHeight = 0;\n\n      if (that._hasHeight) {\n        filterAreaHeight = filterHeaderCell.height();\n        bordersWidth = getCommonBorderWidth([columnAreaCell, dataAreaCell, tableElement, columnHeaderCell, filterHeaderCell], \"height\");\n        dataAreaHeight = that.$element().height() - filterAreaHeight - tableElement.find(\".dx-data-header\").height() - (Math.max(dataArea.headElement().height(), columnAreaCell.height(), descriptionCellHeight) + bordersWidth);\n      }\n\n      totalWidth = dataArea.tableElement().width();\n      totalHeight = getArraySum(resultHeights);\n\n      if (!totalWidth || !totalHeight) {\n        d.resolve();\n        return;\n      }\n\n      rowsAreaWidth = getArraySum(rowsAreaColumnWidths);\n      elementWidth = that.$element().width();\n      bordersWidth = getCommonBorderWidth([rowAreaCell, dataAreaCell, tableElement], \"width\");\n      groupWidth = elementWidth - rowsAreaWidth - bordersWidth;\n      groupWidth = groupWidth > 0 ? groupWidth : totalWidth;\n      hasRowsScroll = that._hasHeight && calculateHasScroll(dataAreaHeight, totalHeight);\n      hasColumnsScroll = calculateHasScroll(groupWidth, totalWidth);\n      var groupHeight = calculateGroupHeight(dataAreaHeight, totalHeight, hasRowsScroll, hasColumnsScroll, scrollBarWidth);\n      (0, _common.deferRender)(function () {\n        columnsArea.tableElement().append(dataArea.headElement());\n        rowFieldsHeader.tableElement().append(rowsArea.headElement());\n\n        if (!hasColumnsScroll && hasRowsScroll && scrollBarWidth) {\n          adjustSizeArray(resultWidths, scrollBarWidth);\n          totalWidth -= scrollBarWidth;\n        }\n\n        if (descriptionCellHeight > columnsAreaHeight) {\n          adjustSizeArray(columnsAreaRowHeights, columnsAreaHeight - descriptionCellHeight);\n          columnsArea.setRowsHeight(columnsAreaRowHeights);\n        }\n\n        tableElement.removeClass(INCOMPRESSIBLE_FIELDS_CLASS);\n        columnHeaderCell.children().css(\"maxWidth\", groupWidth);\n        columnsArea.groupWidth(groupWidth);\n        columnsArea.processScrollBarSpacing(hasRowsScroll ? scrollBarWidth : 0);\n        columnsArea.setColumnsWidth(resultWidths);\n        rowsArea.groupHeight(that._hasHeight ? groupHeight : \"auto\");\n        rowsArea.processScrollBarSpacing(hasColumnsScroll ? scrollBarWidth : 0);\n        rowsArea.setColumnsWidth(rowsAreaColumnWidths);\n        rowsArea.setRowsHeight(resultHeights);\n        dataArea.setColumnsWidth(resultWidths);\n        dataArea.setRowsHeight(resultHeights);\n        dataArea.groupWidth(groupWidth);\n        dataArea.groupHeight(that._hasHeight ? groupHeight : \"auto\");\n        needSynchronizeFieldPanel && rowFieldsHeader.setColumnsWidth(rowsAreaColumnWidths);\n        dataAreaCell.toggleClass(BOTTOM_BORDER_CLASS, !hasRowsScroll);\n        rowAreaCell.toggleClass(BOTTOM_BORDER_CLASS, !hasRowsScroll);\n\n        if (!that._hasHeight && elementWidth !== that.$element().width()) {\n          var diff = elementWidth - that.$element().width();\n\n          if (!hasColumnsScroll) {\n            adjustSizeArray(resultWidths, diff);\n            columnsArea.setColumnsWidth(resultWidths);\n            dataArea.setColumnsWidth(resultWidths);\n          }\n\n          dataArea.groupWidth(groupWidth - diff);\n          columnsArea.groupWidth(groupWidth - diff);\n        }\n\n        if (that._hasHeight && that._filterFields.isVisible() && filterHeaderCell.height() !== filterAreaHeight) {\n          var _diff = filterHeaderCell.height() - filterAreaHeight;\n\n          if (_diff > 0) {\n            hasRowsScroll = calculateHasScroll(dataAreaHeight - _diff, totalHeight);\n\n            var _groupHeight = calculateGroupHeight(dataAreaHeight - _diff, totalHeight, hasRowsScroll, hasColumnsScroll, scrollBarWidth);\n\n            dataArea.groupHeight(_groupHeight);\n            rowsArea.groupHeight(_groupHeight);\n          }\n        }\n\n        if (\"virtual\" === scrollingOptions.mode) {\n          var virtualContentParams = that._dataController.calculateVirtualContentParams({\n            virtualRowHeight: scrollingOptions.virtualRowHeight,\n            virtualColumnWidth: scrollingOptions.virtualColumnWidth,\n            itemWidths: resultWidths,\n            itemHeights: resultHeights,\n            rowCount: resultHeights.length,\n            columnCount: resultWidths.length,\n            viewportWidth: groupWidth,\n            viewportHeight: that._hasHeight ? groupHeight : (0, _renderer2.default)(window).outerHeight()\n          });\n\n          dataArea.setVirtualContentParams({\n            top: virtualContentParams.contentTop,\n            left: virtualContentParams.contentLeft,\n            width: virtualContentParams.width,\n            height: virtualContentParams.height\n          });\n          rowsArea.setVirtualContentParams({\n            top: virtualContentParams.contentTop,\n            width: rowsAreaWidth,\n            height: virtualContentParams.height\n          });\n          columnsArea.setVirtualContentParams({\n            left: virtualContentParams.contentLeft,\n            width: virtualContentParams.width,\n            height: columnsArea.groupElement().height()\n          });\n        }\n\n        var updateScrollableResults = [];\n        dataArea.processScroll(scrollBarInfo.scrollBarUseNative, hasColumnsScroll, hasRowsScroll);\n        (0, _iterator.each)([columnsArea, rowsArea, dataArea], function (_, area) {\n          updateScrollableResults.push(area && area.updateScrollable());\n        });\n\n        that._updateLoading();\n\n        that._renderNoDataText(dataAreaCell);\n\n        _deferred.when.apply(_renderer2.default, updateScrollableResults).done(function () {\n          that._updateScrollPosition(columnsArea, rowsArea, dataArea);\n\n          d.resolve();\n        });\n      });\n    });\n    return d;\n  },\n  applyPartialDataSource: function applyPartialDataSource(area, path, dataSource) {\n    this._dataController.applyPartialDataSource(area, path, dataSource);\n  }\n}).inherit(_uiPivot_grid10.ExportMixin).include(_uiPivot_grid12.default);\n\n(0, _component_registrator2.default)(\"dxPivotGrid\", PivotGrid);\nmodule.exports = PivotGrid;","map":{"version":3,"sources":["C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/devextreme/ui/pivot_grid/ui.pivot_grid.js"],"names":["_renderer","require","_renderer2","_interopRequireDefault","_window","_browser","_events_engine","_events_engine2","_component_registrator","_component_registrator2","_dom","_string","_common","_iterator","_type","_extend","_click","_message","_ui","_ui2","_utils","_uiGrid_core","_uiPivot_grid","_uiPivot_grid2","_uiPivot_grid3","_uiPivot_grid4","_size","_uiPivot_grid5","_uiPivot_grid6","_uiPivot_grid7","_uiPivot_grid8","_uiPivot_grid9","_uiPivot_grid10","_uiPivot_grid11","_uiPivot_grid12","_popup","_popup2","_context_menu","_context_menu2","_deferred","obj","window","DATA_AREA_CELL_CLASS","ROW_AREA_CELL_CLASS","COLUMN_AREA_CELL_CLASS","DESCRIPTION_AREA_CELL_CLASS","BORDERS_CLASS","PIVOTGRID_CLASS","ROW_LINES_CLASS","BOTTOM_ROW_CLASS","BOTTOM_BORDER_CLASS","FIELDS_CONTAINER_CLASS","FIELDS_CLASS","FIELD_CHOOSER_POPUP_CLASS","INCOMPRESSIBLE_FIELDS_CLASS","OVERFLOW_HIDDEN_CLASS","TR","TD","DIV","TEST_HEIGHT","sum","value","delta","space","sizeArray","i","area","unsubscribeScrollEvents","scrollBarInfoCache","scrollBarWidth","options","container","position","visibility","top","left","width","height","content","scrollBarUseNative","borderStyleNames","computedStyle","elem","parseFloat","$targetElement","PivotGrid","_getDefaultOptions","scrolling","timeout","renderingThreshold","minTimeout","mode","useNative","removeInvisiblePages","virtualRowHeight","virtualColumnWidth","encodeHtml","dataSource","activeStateEnabled","fieldChooser","minWidth","minHeight","enabled","allowSearch","searchTimeout","layout","title","applyChangesMode","onContextMenuPreparing","allowSorting","allowSortingBySummary","allowFiltering","allowExpandAll","wordWrapEnabled","fieldPanel","showColumnFields","showFilterFields","showDataFields","showRowFields","allowFieldDragging","visible","texts","columnFieldArea","rowFieldArea","filterFieldArea","dataFieldArea","fileName","proxyUrl","ignoreExcelErrors","showRowTotals","showRowGrandTotals","showColumnTotals","showColumnGrandTotals","hideEmptySummaryCells","showTotalsPrior","rowHeaderLayout","loadPanel","text","showIndicator","indicatorSrc","showPane","grandTotal","total","noData","showFieldChooser","expandAll","collapseAll","sortColumnBySummary","sortRowBySummary","removeAllSorting","exportToExcel","dataNotAvailable","onCellClick","onCellPrepared","showBorders","stateStoring","storageKey","type","customLoad","customSave","savingTimeout","onExpandValueChanging","renderCellCountLimit","onExporting","onExported","onFileSaving","headerFilter","showRelevantValues","emptyValue","ok","cancel","_getDataControllerOptions","that","component","onFieldsPrepared","field","_initDataController","expandValueChanging","_init","_initActions","onChanged","_trigger","_optionChanged","args","_updateScrollPosition","scrolled","rowsArea","columnsArea","scrollTop","scrollLeft","dataArea","x","y","_subscribeToEvents","scrollHandler","scrollOffset","e","leftOffset","topOffset","subscribeToScrollEvent","_clean","_needDelayResizing","cellsCount","cellsInfo","_renderFieldChooser","fieldChooserOptions","toolbarItems","toolbar","location","widget","onClick","fieldChooserComponentOptions","popupOptions","shading","showCloseButton","resizeEnabled","onResize","onShown","onHidden","_renderContextMenu","$container","onPositioning","event","actionArgs","targetElement","items","onItemClick","params","cssClass","target","_getContextMenuItems","areaFields","oppositeAreaFields","beginGroup","icon","sortingBySummaryItemCount","showDataFieldCaption","textFormat","checked","dataField","sortBySummaryField","sortBySummaryPath","sortOrder","_createEventArgs","rowFields","columnFields","dataFields","dxEvent","clickedOnFieldsArea","_createFieldArgs","_createCellArgs","$cellElement","columnIndex","cellElement","rowIndex","$table","data","cell","_handleCellClick","setTimeout","_getNoDataText","_renderNoDataText","_renderLoadPanel","_updateLoading","isLoading","loadPanelVisible","Math","clearTimeout","_renderDescriptionArea","_this","$element","$descriptionCell","$toolbarContainer","$filterHeader","$columnHeader","$targetContainer","$buttonElement","buttonOptions","hint","_$buttonElement","_buttonOptions","_detectHasContainerHeight","element","testElement","_renderHeaders","_createTableElement","_renderDataArea","_renderRowsArea","_renderColumnsArea","_initMarkup","_renderContentImpl","isFirstDrawing","tableElement","columnsAreaElement","rowsAreaElement","dataAreaElement","dataHeaderContainer","filterHeaderContainer","columnHeaderContainer","rowHeaderContainer","_update","updateHandler","_fireContentReadyAction","getScrollPath","getDataSource","getFieldChooserPopup","hasScroll","_dimensionChanged","_visibilityChanged","_dispose","_tableElement","addWidgetPrefix","resize","isReady","updateDimensions","totalWidth","totalHeight","rowsAreaWidth","scrollingOptions","scrollBarInfo","getScrollBarInfo","dataAreaCell","rowAreaCell","columnAreaCell","descriptionCell","filterHeaderCell","columnHeaderCell","rowFieldsHeader","d","needSynchronizeFieldPanel","calculateHasScroll","totalSize","calculateGroupHeight","hasRowsScroll","hasColumnsScroll","resultWidths","rowHeights","rowsAreaHeights","dataAreaHeights","descriptionCellHeight","paddings","borders","margins","columnsAreaRowCount","resultHeights","columnsAreaRowHeights","columnsAreaHeight","getArraySum","rowsAreaColumnWidths","filterAreaHeight","dataAreaHeight","bordersWidth","getCommonBorderWidth","elementWidth","groupWidth","groupHeight","adjustSizeArray","diff","_diff","_groupHeight","virtualContentParams","itemWidths","itemHeights","rowCount","columnCount","viewportWidth","viewportHeight","updateScrollableResults","applyPartialDataSource","module"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/pivot_grid/ui.pivot_grid.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar _renderer = require(\"../../core/renderer\");\r\nvar _renderer2 = _interopRequireDefault(_renderer);\r\nvar _window = require(\"../../core/utils/window\");\r\nvar _browser = require(\"../../core/utils/browser\");\r\nvar _events_engine = require(\"../../events/core/events_engine\");\r\nvar _events_engine2 = _interopRequireDefault(_events_engine);\r\nvar _component_registrator = require(\"../../core/component_registrator\");\r\nvar _component_registrator2 = _interopRequireDefault(_component_registrator);\r\nvar _dom = require(\"../../core/utils/dom\");\r\nvar _string = require(\"../../core/utils/string\");\r\nvar _common = require(\"../../core/utils/common\");\r\nvar _iterator = require(\"../../core/utils/iterator\");\r\nvar _type = require(\"../../core/utils/type\");\r\nvar _extend = require(\"../../core/utils/extend\");\r\nvar _click = require(\"../../events/click\");\r\nvar _message = require(\"../../localization/message\");\r\nvar _ui = require(\"../widget/ui.widget\");\r\nvar _ui2 = _interopRequireDefault(_ui);\r\nvar _utils = require(\"../../events/utils\");\r\nvar _uiGrid_core = require(\"../grid_core/ui.grid_core.utils\");\r\nvar _uiPivot_grid = require(\"./ui.pivot_grid.utils\");\r\nvar _uiPivot_grid2 = require(\"./ui.pivot_grid.data_controller\");\r\nvar _uiPivot_grid3 = require(\"./ui.pivot_grid.data_area\");\r\nvar _uiPivot_grid4 = require(\"./ui.pivot_grid.headers_area\");\r\nvar _size = require(\"../../core/utils/size\");\r\nvar _uiPivot_grid5 = require(\"./ui.pivot_grid.fields_area\");\r\nvar _uiPivot_grid6 = require(\"./ui.pivot_grid.field_chooser\");\r\nvar _uiPivot_grid7 = _interopRequireDefault(_uiPivot_grid6);\r\nvar _uiPivot_grid8 = require(\"./ui.pivot_grid.field_chooser_base\");\r\nvar _uiPivot_grid9 = _interopRequireDefault(_uiPivot_grid8);\r\nvar _uiPivot_grid10 = require(\"./ui.pivot_grid.export\");\r\nvar _uiPivot_grid11 = require(\"./ui.pivot_grid.chart_integration\");\r\nvar _uiPivot_grid12 = _interopRequireDefault(_uiPivot_grid11);\r\nvar _popup = require(\"../popup\");\r\nvar _popup2 = _interopRequireDefault(_popup);\r\nvar _context_menu = require(\"../context_menu\");\r\nvar _context_menu2 = _interopRequireDefault(_context_menu);\r\nvar _deferred = require(\"../../core/utils/deferred\");\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\nvar window = (0, _window.getWindow)();\r\nvar DATA_AREA_CELL_CLASS = \"dx-area-data-cell\";\r\nvar ROW_AREA_CELL_CLASS = \"dx-area-row-cell\";\r\nvar COLUMN_AREA_CELL_CLASS = \"dx-area-column-cell\";\r\nvar DESCRIPTION_AREA_CELL_CLASS = \"dx-area-description-cell\";\r\nvar BORDERS_CLASS = \"dx-pivotgrid-border\";\r\nvar PIVOTGRID_CLASS = \"dx-pivotgrid\";\r\nvar ROW_LINES_CLASS = \"dx-row-lines\";\r\nvar BOTTOM_ROW_CLASS = \"dx-bottom-row\";\r\nvar BOTTOM_BORDER_CLASS = \"dx-bottom-border\";\r\nvar FIELDS_CONTAINER_CLASS = \"dx-pivotgrid-fields-container\";\r\nvar FIELDS_CLASS = \"dx-area-fields\";\r\nvar FIELD_CHOOSER_POPUP_CLASS = \"dx-fieldchooser-popup\";\r\nvar INCOMPRESSIBLE_FIELDS_CLASS = \"dx-incompressible-fields\";\r\nvar OVERFLOW_HIDDEN_CLASS = \"dx-overflow-hidden\";\r\nvar TR = \"<tr>\";\r\nvar TD = \"<td>\";\r\nvar DIV = \"<div>\";\r\nvar TEST_HEIGHT = 66666;\r\n\r\nfunction getArraySum(array) {\r\n    var sum = 0;\r\n    (0, _iterator.each)(array, function(_, value) {\r\n        sum += value || 0\r\n    });\r\n    return sum\r\n}\r\n\r\nfunction adjustSizeArray(sizeArray, space) {\r\n    var delta = space / sizeArray.length;\r\n    for (var i = 0; i < sizeArray.length; i++) {\r\n        sizeArray[i] -= delta\r\n    }\r\n}\r\n\r\nfunction unsubscribeScrollEvents(area) {\r\n    area.off(\"scroll\").off(\"stop\")\r\n}\r\n\r\nfunction subscribeToScrollEvent(area, handler) {\r\n    unsubscribeScrollEvents(area);\r\n    area.on(\"scroll\", handler).on(\"stop\", handler)\r\n}\r\nvar scrollBarInfoCache = {};\r\n\r\nfunction getScrollBarInfo(useNativeScrolling) {\r\n    if (scrollBarInfoCache[useNativeScrolling]) {\r\n        return scrollBarInfoCache[useNativeScrolling]\r\n    }\r\n    var scrollBarWidth = 0;\r\n    var options = {};\r\n    var container = (0, _renderer2.default)(DIV).css({\r\n        position: \"absolute\",\r\n        visibility: \"hidden\",\r\n        top: -1e3,\r\n        left: -1e3,\r\n        width: 100,\r\n        height: 100\r\n    }).appendTo(\"body\");\r\n    var content = (0, _renderer2.default)(\"<p>\").css({\r\n        width: \"100%\",\r\n        height: 200\r\n    }).appendTo(container);\r\n    if (\"auto\" !== useNativeScrolling) {\r\n        options.useNative = !!useNativeScrolling;\r\n        options.useSimulatedScrollbar = !useNativeScrolling\r\n    }\r\n    container.dxScrollable(options);\r\n    var scrollBarUseNative = container.dxScrollable(\"instance\").option(\"useNative\");\r\n    scrollBarWidth = scrollBarUseNative ? container.width() - content.width() : 0;\r\n    container.remove();\r\n    scrollBarInfoCache[useNativeScrolling] = {\r\n        scrollBarWidth: scrollBarWidth,\r\n        scrollBarUseNative: scrollBarUseNative\r\n    };\r\n    return scrollBarInfoCache[useNativeScrolling]\r\n}\r\n\r\nfunction getCommonBorderWidth(elements, direction) {\r\n    var borderStyleNames = \"width\" === direction ? [\"borderLeftWidth\", \"borderRightWidth\"] : [\"borderTopWidth\", \"borderBottomWidth\"];\r\n    var width = 0;\r\n    (0, _iterator.each)(elements, function(_, elem) {\r\n        var computedStyle = window.getComputedStyle(elem.get(0));\r\n        borderStyleNames.forEach(function(borderStyleName) {\r\n            width += parseFloat(computedStyle[borderStyleName]) || 0\r\n        })\r\n    });\r\n    return width\r\n}\r\n\r\nfunction clickedOnFieldsArea($targetElement) {\r\n    return $targetElement.closest(\".\" + FIELDS_CLASS).length || $targetElement.find(\".\" + FIELDS_CLASS).length\r\n}\r\nvar PivotGrid = _ui2.default.inherit({\r\n    _getDefaultOptions: function() {\r\n        return (0, _extend.extend)(this.callBase(), {\r\n            scrolling: {\r\n                timeout: 300,\r\n                renderingThreshold: 150,\r\n                minTimeout: 10,\r\n                mode: \"standard\",\r\n                useNative: \"auto\",\r\n                removeInvisiblePages: true,\r\n                virtualRowHeight: 50,\r\n                virtualColumnWidth: 100\r\n            },\r\n            encodeHtml: true,\r\n            dataSource: null,\r\n            activeStateEnabled: false,\r\n            fieldChooser: {\r\n                minWidth: 250,\r\n                minHeight: 250,\r\n                enabled: true,\r\n                allowSearch: false,\r\n                searchTimeout: 500,\r\n                layout: 0,\r\n                title: (0, _message.format)(\"dxPivotGrid-fieldChooserTitle\"),\r\n                width: 600,\r\n                height: 600,\r\n                applyChangesMode: \"instantly\"\r\n            },\r\n            onContextMenuPreparing: null,\r\n            allowSorting: false,\r\n            allowSortingBySummary: false,\r\n            allowFiltering: false,\r\n            allowExpandAll: false,\r\n            wordWrapEnabled: true,\r\n            fieldPanel: {\r\n                showColumnFields: true,\r\n                showFilterFields: true,\r\n                showDataFields: true,\r\n                showRowFields: true,\r\n                allowFieldDragging: true,\r\n                visible: false,\r\n                texts: {\r\n                    columnFieldArea: (0, _message.format)(\"dxPivotGrid-columnFieldArea\"),\r\n                    rowFieldArea: (0, _message.format)(\"dxPivotGrid-rowFieldArea\"),\r\n                    filterFieldArea: (0, _message.format)(\"dxPivotGrid-filterFieldArea\"),\r\n                    dataFieldArea: (0, _message.format)(\"dxPivotGrid-dataFieldArea\")\r\n                }\r\n            },\r\n            dataFieldArea: \"column\",\r\n            \"export\": {\r\n                enabled: false,\r\n                fileName: \"PivotGrid\",\r\n                proxyUrl: void 0,\r\n                ignoreExcelErrors: true\r\n            },\r\n            showRowTotals: true,\r\n            showRowGrandTotals: true,\r\n            showColumnTotals: true,\r\n            showColumnGrandTotals: true,\r\n            hideEmptySummaryCells: true,\r\n            showTotalsPrior: \"none\",\r\n            rowHeaderLayout: \"standard\",\r\n            loadPanel: {\r\n                enabled: true,\r\n                text: (0, _message.format)(\"Loading\"),\r\n                width: 200,\r\n                height: 70,\r\n                showIndicator: true,\r\n                indicatorSrc: \"\",\r\n                showPane: true\r\n            },\r\n            texts: {\r\n                grandTotal: (0, _message.format)(\"dxPivotGrid-grandTotal\"),\r\n                total: (0, _message.getFormatter)(\"dxPivotGrid-total\"),\r\n                noData: (0, _message.format)(\"dxDataGrid-noDataText\"),\r\n                showFieldChooser: (0, _message.format)(\"dxPivotGrid-showFieldChooser\"),\r\n                expandAll: (0, _message.format)(\"dxPivotGrid-expandAll\"),\r\n                collapseAll: (0, _message.format)(\"dxPivotGrid-collapseAll\"),\r\n                sortColumnBySummary: (0, _message.getFormatter)(\"dxPivotGrid-sortColumnBySummary\"),\r\n                sortRowBySummary: (0, _message.getFormatter)(\"dxPivotGrid-sortRowBySummary\"),\r\n                removeAllSorting: (0, _message.format)(\"dxPivotGrid-removeAllSorting\"),\r\n                exportToExcel: (0, _message.format)(\"dxDataGrid-exportToExcel\"),\r\n                dataNotAvailable: (0, _message.format)(\"dxPivotGrid-dataNotAvailable\")\r\n            },\r\n            onCellClick: null,\r\n            onCellPrepared: null,\r\n            showBorders: false,\r\n            stateStoring: {\r\n                enabled: false,\r\n                storageKey: null,\r\n                type: \"localStorage\",\r\n                customLoad: null,\r\n                customSave: null,\r\n                savingTimeout: 2e3\r\n            },\r\n            onExpandValueChanging: null,\r\n            renderCellCountLimit: 2e4,\r\n            onExporting: null,\r\n            onExported: null,\r\n            onFileSaving: null,\r\n            headerFilter: {\r\n                width: 252,\r\n                height: 325,\r\n                allowSearch: false,\r\n                showRelevantValues: false,\r\n                searchTimeout: 500,\r\n                texts: {\r\n                    emptyValue: (0, _message.format)(\"dxDataGrid-headerFilterEmptyValue\"),\r\n                    ok: (0, _message.format)(\"dxDataGrid-headerFilterOK\"),\r\n                    cancel: (0, _message.format)(\"dxDataGrid-headerFilterCancel\")\r\n                }\r\n            }\r\n        })\r\n    },\r\n    _getDataControllerOptions: function() {\r\n        var that = this;\r\n        return {\r\n            component: that,\r\n            dataSource: that.option(\"dataSource\"),\r\n            texts: that.option(\"texts\"),\r\n            showRowTotals: that.option(\"showRowTotals\"),\r\n            showRowGrandTotals: that.option(\"showRowGrandTotals\"),\r\n            showColumnTotals: that.option(\"showColumnTotals\"),\r\n            showTotalsPrior: that.option(\"showTotalsPrior\"),\r\n            showColumnGrandTotals: that.option(\"showColumnGrandTotals\"),\r\n            dataFieldArea: that.option(\"dataFieldArea\"),\r\n            rowHeaderLayout: that.option(\"rowHeaderLayout\"),\r\n            hideEmptySummaryCells: that.option(\"hideEmptySummaryCells\"),\r\n            onFieldsPrepared: function(fields) {\r\n                (0, _iterator.each)(fields, function(index, field) {\r\n                    (0, _iterator.each)([\"allowSorting\", \"allowSortingBySummary\", \"allowFiltering\", \"allowExpandAll\"], function(_, optionName) {\r\n                        if (void 0 === field[optionName]) {\r\n                            (0, _uiPivot_grid.setFieldProperty)(field, optionName, that.option(optionName))\r\n                        }\r\n                    })\r\n                })\r\n            }\r\n        }\r\n    },\r\n    _initDataController: function() {\r\n        var that = this;\r\n        that._dataController && that._dataController.dispose();\r\n        that._dataController = new _uiPivot_grid2.DataController(that._getDataControllerOptions());\r\n        if ((0, _window.hasWindow)()) {\r\n            that._dataController.changed.add(function() {\r\n                that._render()\r\n            })\r\n        }\r\n        that._dataController.scrollChanged.add(function(options) {\r\n            that._scrollLeft = options.left;\r\n            that._scrollTop = options.top\r\n        });\r\n        that._dataController.loadingChanged.add(function(isLoading) {\r\n            that._updateLoading()\r\n        });\r\n        that._dataController.progressChanged.add(that._updateLoading.bind(that));\r\n        that._dataController.dataSourceChanged.add(function() {\r\n            that._trigger(\"onChanged\")\r\n        });\r\n        var expandValueChanging = that.option(\"onExpandValueChanging\");\r\n        if (expandValueChanging) {\r\n            that._dataController.expandValueChanging.add(function(e) {\r\n                expandValueChanging(e)\r\n            })\r\n        }\r\n    },\r\n    _init: function() {\r\n        var that = this;\r\n        that.callBase();\r\n        that._initDataController();\r\n        that._scrollLeft = that._scrollTop = null;\r\n        that._initActions()\r\n    },\r\n    _initActions: function() {\r\n        var that = this;\r\n        that._actions = {\r\n            onChanged: that._createActionByOption(\"onChanged\"),\r\n            onContextMenuPreparing: that._createActionByOption(\"onContextMenuPreparing\"),\r\n            onCellClick: that._createActionByOption(\"onCellClick\"),\r\n            onExporting: that._createActionByOption(\"onExporting\"),\r\n            onExported: that._createActionByOption(\"onExported\"),\r\n            onFileSaving: that._createActionByOption(\"onFileSaving\"),\r\n            onCellPrepared: that._createActionByOption(\"onCellPrepared\")\r\n        }\r\n    },\r\n    _trigger: function(eventName, eventArg) {\r\n        this._actions[eventName](eventArg)\r\n    },\r\n    _optionChanged: function(args) {\r\n        var that = this;\r\n        switch (args.name) {\r\n            case \"dataSource\":\r\n            case \"allowSorting\":\r\n            case \"allowFiltering\":\r\n            case \"allowExpandAll\":\r\n            case \"allowSortingBySummary\":\r\n            case \"scrolling\":\r\n            case \"stateStoring\":\r\n                that._initDataController();\r\n                that._fieldChooserPopup.hide();\r\n                that._renderFieldChooser();\r\n                that._invalidate();\r\n                break;\r\n            case \"texts\":\r\n            case \"showTotalsPrior\":\r\n            case \"showRowTotals\":\r\n            case \"showRowGrandTotals\":\r\n            case \"showColumnTotals\":\r\n            case \"showColumnGrandTotals\":\r\n            case \"hideEmptySummaryCells\":\r\n            case \"dataFieldArea\":\r\n                that._dataController.updateViewOptions(that._getDataControllerOptions());\r\n                break;\r\n            case \"useNativeScrolling\":\r\n            case \"encodeHtml\":\r\n            case \"renderCellCountLimit\":\r\n                break;\r\n            case \"rtlEnabled\":\r\n                that.callBase(args);\r\n                that._renderFieldChooser();\r\n                that._renderContextMenu();\r\n                (0, _window.hasWindow)() && that._renderLoadPanel(that._dataArea.groupElement(), that.$element());\r\n                that._invalidate();\r\n                break;\r\n            case \"export\":\r\n                that._renderDescriptionArea();\r\n                break;\r\n            case \"onExpandValueChanging\":\r\n                break;\r\n            case \"onCellClick\":\r\n            case \"onContextMenuPreparing\":\r\n            case \"onExporting\":\r\n            case \"onExported\":\r\n            case \"onFileSaving\":\r\n            case \"onCellPrepared\":\r\n                that._actions[args.name] = that._createActionByOption(args.name);\r\n                break;\r\n            case \"fieldChooser\":\r\n                that._renderFieldChooser();\r\n                that._renderDescriptionArea();\r\n                break;\r\n            case \"loadPanel\":\r\n                if ((0, _window.hasWindow)()) {\r\n                    that._renderLoadPanel(that._dataArea.groupElement(), that.$element());\r\n                    that._invalidate()\r\n                }\r\n                break;\r\n            case \"fieldPanel\":\r\n                that._renderDescriptionArea();\r\n                that._invalidate();\r\n                break;\r\n            case \"headerFilter\":\r\n                that._renderFieldChooser();\r\n                that._invalidate();\r\n                break;\r\n            case \"showBorders\":\r\n                that._tableElement().toggleClass(BORDERS_CLASS, !!args.value);\r\n                that.updateDimensions();\r\n                break;\r\n            case \"wordWrapEnabled\":\r\n                that._tableElement().toggleClass(\"dx-word-wrap\", !!args.value);\r\n                that.updateDimensions();\r\n                break;\r\n            case \"rowHeaderLayout\":\r\n                that._tableElement().find(\".\" + ROW_AREA_CELL_CLASS).toggleClass(\"dx-area-tree-view\", \"tree\" === args.value);\r\n                that._dataController.updateViewOptions(that._getDataControllerOptions());\r\n                break;\r\n            case \"height\":\r\n            case \"width\":\r\n                that._hasHeight = null;\r\n                that.callBase(args);\r\n                that.resize();\r\n                break;\r\n            default:\r\n                that.callBase(args)\r\n        }\r\n    },\r\n    _updateScrollPosition: function(columnsArea, rowsArea, dataArea) {\r\n        var that = this;\r\n        var scrollTop;\r\n        var scrollLeft;\r\n        var scrolled = that._scrollTop || that._scrollLeft;\r\n        if (that._scrollUpdating) {\r\n            return\r\n        }\r\n        that._scrollUpdating = true;\r\n        if (rowsArea && !rowsArea.hasScroll() && that._hasHeight) {\r\n            that._scrollTop = null\r\n        }\r\n        if (columnsArea && !columnsArea.hasScroll()) {\r\n            that._scrollLeft = null\r\n        }\r\n        if (null !== that._scrollTop || null !== that._scrollLeft || scrolled || that.option(\"rtlEnabled\")) {\r\n            scrollTop = that._scrollTop || 0;\r\n            scrollLeft = that._scrollLeft || 0;\r\n            dataArea.scrollTo({\r\n                x: scrollLeft,\r\n                y: scrollTop\r\n            });\r\n            columnsArea.scrollTo(scrollLeft);\r\n            rowsArea.scrollTo(scrollTop);\r\n            that._dataController.updateWindowScrollPosition(that._scrollTop)\r\n        }\r\n        that._scrollUpdating = false\r\n    },\r\n    _subscribeToEvents: function(columnsArea, rowsArea, dataArea) {\r\n        var that = this;\r\n        var scrollHandler = function(e) {\r\n            var scrollOffset = e.scrollOffset;\r\n            var leftOffset = (0, _type.isDefined)(scrollOffset.left) ? scrollOffset.left : that._scrollLeft;\r\n            var topOffset = (0, _type.isDefined)(scrollOffset.top) && that._hasHeight ? scrollOffset.top : that._scrollTop;\r\n            if ((that._scrollLeft || 0) !== (leftOffset || 0) || (that._scrollTop || 0) !== (topOffset || 0)) {\r\n                that._scrollLeft = leftOffset;\r\n                that._scrollTop = topOffset;\r\n                that._updateScrollPosition(columnsArea, rowsArea, dataArea);\r\n                if (\"virtual\" === that.option(\"scrolling.mode\")) {\r\n                    that._dataController.setViewportPosition(that._scrollLeft, that._scrollTop)\r\n                }\r\n            }\r\n        };\r\n        (0, _iterator.each)([columnsArea, rowsArea, dataArea], function(_, area) {\r\n            subscribeToScrollEvent(area, scrollHandler)\r\n        });\r\n        !that._hasHeight && that._dataController.subscribeToWindowScrollEvents(dataArea.groupElement())\r\n    },\r\n    _clean: _common.noop,\r\n    _needDelayResizing: function(cellsInfo) {\r\n        var cellsCount = cellsInfo.length * (cellsInfo.length ? cellsInfo[0].length : 0);\r\n        return cellsCount > this.option(\"renderCellCountLimit\")\r\n    },\r\n    _renderFieldChooser: function() {\r\n        var that = this;\r\n        var container = that._pivotGridContainer;\r\n        var fieldChooserOptions = that.option(\"fieldChooser\") || {};\r\n        var toolbarItems = \"onDemand\" === fieldChooserOptions.applyChangesMode ? [{\r\n            toolbar: \"bottom\",\r\n            location: \"after\",\r\n            widget: \"dxButton\",\r\n            options: {\r\n                text: (0, _message.format)(\"OK\"),\r\n                onClick: function(e) {\r\n                    that._fieldChooserPopup.$content().dxPivotGridFieldChooser(\"applyChanges\");\r\n                    that._fieldChooserPopup.hide()\r\n                }\r\n            }\r\n        }, {\r\n            toolbar: \"bottom\",\r\n            location: \"after\",\r\n            widget: \"dxButton\",\r\n            options: {\r\n                text: (0, _message.format)(\"Cancel\"),\r\n                onClick: function(e) {\r\n                    that._fieldChooserPopup.hide()\r\n                }\r\n            }\r\n        }] : [];\r\n        var fieldChooserComponentOptions = {\r\n            layout: fieldChooserOptions.layout,\r\n            texts: fieldChooserOptions.texts || {},\r\n            dataSource: that.getDataSource(),\r\n            allowSearch: fieldChooserOptions.allowSearch,\r\n            searchTimeout: fieldChooserOptions.searchTimeout,\r\n            width: void 0,\r\n            height: void 0,\r\n            headerFilter: that.option(\"headerFilter\"),\r\n            encodeHtml: that.option(\"encodeHtml\"),\r\n            applyChangesMode: fieldChooserOptions.applyChangesMode,\r\n            onContextMenuPreparing: function(e) {\r\n                that._trigger(\"onContextMenuPreparing\", e)\r\n            }\r\n        };\r\n        var popupOptions = {\r\n            shading: false,\r\n            title: fieldChooserOptions.title,\r\n            width: fieldChooserOptions.width,\r\n            height: fieldChooserOptions.height,\r\n            showCloseButton: true,\r\n            resizeEnabled: true,\r\n            minWidth: fieldChooserOptions.minWidth,\r\n            minHeight: fieldChooserOptions.minHeight,\r\n            toolbarItems: toolbarItems,\r\n            onResize: function(e) {\r\n                e.component.$content().dxPivotGridFieldChooser(\"updateDimensions\")\r\n            },\r\n            onShown: function(e) {\r\n                that._createComponent(e.component.content(), _uiPivot_grid7.default, fieldChooserComponentOptions)\r\n            },\r\n            onHidden: function(e) {\r\n                var fieldChooser = e.component.$content().dxPivotGridFieldChooser(\"instance\");\r\n                fieldChooser.resetTreeView();\r\n                fieldChooser.cancelChanges()\r\n            }\r\n        };\r\n        if (that._fieldChooserPopup) {\r\n            that._fieldChooserPopup.option(popupOptions);\r\n            that._fieldChooserPopup.$content().dxPivotGridFieldChooser(fieldChooserComponentOptions)\r\n        } else {\r\n            that._fieldChooserPopup = that._createComponent((0, _renderer2.default)(DIV).addClass(FIELD_CHOOSER_POPUP_CLASS).appendTo(container), _popup2.default, popupOptions)\r\n        }\r\n    },\r\n    _renderContextMenu: function() {\r\n        var that = this;\r\n        var $container = that._pivotGridContainer;\r\n        if (that._contextMenu) {\r\n            that._contextMenu.$element().remove()\r\n        }\r\n        that._contextMenu = that._createComponent((0, _renderer2.default)(DIV).appendTo($container), _context_menu2.default, {\r\n            onPositioning: function(actionArgs) {\r\n                var event = actionArgs.event;\r\n                actionArgs.cancel = true;\r\n                if (!event) {\r\n                    return\r\n                }\r\n                var targetElement = event.target.cellIndex >= 0 ? event.target : (0, _renderer2.default)(event.target).closest(\"td\").get(0);\r\n                if (!targetElement) {\r\n                    return\r\n                }\r\n                var args = that._createEventArgs(targetElement, event);\r\n                var items = that._getContextMenuItems(args);\r\n                if (items) {\r\n                    actionArgs.component.option(\"items\", items);\r\n                    actionArgs.cancel = false;\r\n                    return\r\n                }\r\n            },\r\n            onItemClick: function(params) {\r\n                params.itemData.onItemClick && params.itemData.onItemClick(params)\r\n            },\r\n            cssClass: PIVOTGRID_CLASS,\r\n            target: that.$element()\r\n        })\r\n    },\r\n    _getContextMenuItems: function(e) {\r\n        var that = this;\r\n        var items = [];\r\n        var texts = that.option(\"texts\");\r\n        if (\"row\" === e.area || \"column\" === e.area) {\r\n            var areaFields = e[e.area + \"Fields\"];\r\n            var oppositeAreaFields = e[\"column\" === e.area ? \"rowFields\" : \"columnFields\"];\r\n            var field = e.cell.path && areaFields[e.cell.path.length - 1];\r\n            var dataSource = that.getDataSource();\r\n            if (field && field.allowExpandAll && e.cell.path.length < e[e.area + \"Fields\"].length && !dataSource.paginate()) {\r\n                items.push({\r\n                    beginGroup: true,\r\n                    icon: \"none\",\r\n                    text: texts.expandAll,\r\n                    onItemClick: function() {\r\n                        dataSource.expandAll(field.index)\r\n                    }\r\n                });\r\n                items.push({\r\n                    text: texts.collapseAll,\r\n                    icon: \"none\",\r\n                    onItemClick: function() {\r\n                        dataSource.collapseAll(field.index)\r\n                    }\r\n                })\r\n            }\r\n            if (e.cell.isLast && !dataSource.paginate()) {\r\n                var sortingBySummaryItemCount = 0;\r\n                (0, _iterator.each)(oppositeAreaFields, function(index, field) {\r\n                    if (!field.allowSortingBySummary) {\r\n                        return\r\n                    }(0, _iterator.each)(e.dataFields, function(dataIndex, dataField) {\r\n                        if ((0, _type.isDefined)(e.cell.dataIndex) && e.cell.dataIndex !== dataIndex) {\r\n                            return\r\n                        }\r\n                        var showDataFieldCaption = !(0, _type.isDefined)(e.cell.dataIndex) && e.dataFields.length > 1;\r\n                        var textFormat = \"column\" === e.area ? texts.sortColumnBySummary : texts.sortRowBySummary;\r\n                        var checked = (0, _uiPivot_grid.findField)(e.dataFields, field.sortBySummaryField) === dataIndex && (e.cell.path || []).join(\"/\") === (field.sortBySummaryPath || []).join(\"/\");\r\n                        var text = (0, _string.format)(textFormat, showDataFieldCaption ? field.caption + \" - \" + dataField.caption : field.caption);\r\n                        items.push({\r\n                            beginGroup: 0 === sortingBySummaryItemCount,\r\n                            icon: checked ? \"desc\" === field.sortOrder ? \"sortdowntext\" : \"sortuptext\" : \"none\",\r\n                            text: text,\r\n                            onItemClick: function() {\r\n                                dataSource.field(field.index, {\r\n                                    sortBySummaryField: dataField.name || dataField.caption || dataField.dataField,\r\n                                    sortBySummaryPath: e.cell.path,\r\n                                    sortOrder: \"desc\" === field.sortOrder ? \"asc\" : \"desc\"\r\n                                });\r\n                                dataSource.load()\r\n                            }\r\n                        });\r\n                        sortingBySummaryItemCount++\r\n                    })\r\n                });\r\n                (0, _iterator.each)(oppositeAreaFields, function(index, field) {\r\n                    if (!field.allowSortingBySummary || !(0, _type.isDefined)(field.sortBySummaryField)) {\r\n                        return\r\n                    }\r\n                    items.push({\r\n                        beginGroup: 0 === sortingBySummaryItemCount,\r\n                        icon: \"none\",\r\n                        text: texts.removeAllSorting,\r\n                        onItemClick: function() {\r\n                            (0, _iterator.each)(oppositeAreaFields, function(index, field) {\r\n                                dataSource.field(field.index, {\r\n                                    sortBySummaryField: void 0,\r\n                                    sortBySummaryPath: void 0,\r\n                                    sortOrder: void 0\r\n                                })\r\n                            });\r\n                            dataSource.load()\r\n                        }\r\n                    });\r\n                    return false\r\n                })\r\n            }\r\n        }\r\n        if (that.option(\"fieldChooser.enabled\")) {\r\n            items.push({\r\n                beginGroup: true,\r\n                icon: \"columnchooser\",\r\n                text: texts.showFieldChooser,\r\n                onItemClick: function() {\r\n                    that._fieldChooserPopup.show()\r\n                }\r\n            })\r\n        }\r\n        if (that.option(\"export.enabled\")) {\r\n            items.push({\r\n                beginGroup: true,\r\n                icon: \"xlsxfile\",\r\n                text: texts.exportToExcel,\r\n                onItemClick: function() {\r\n                    that.exportToExcel()\r\n                }\r\n            })\r\n        }\r\n        e.items = items;\r\n        that._trigger(\"onContextMenuPreparing\", e);\r\n        items = e.items;\r\n        if (items && items.length) {\r\n            return items\r\n        }\r\n    },\r\n    _createEventArgs: function(targetElement, dxEvent) {\r\n        var that = this;\r\n        var dataSource = that.getDataSource();\r\n        var args = {\r\n            rowFields: dataSource.getAreaFields(\"row\"),\r\n            columnFields: dataSource.getAreaFields(\"column\"),\r\n            dataFields: dataSource.getAreaFields(\"data\"),\r\n            event: dxEvent\r\n        };\r\n        if (clickedOnFieldsArea((0, _renderer2.default)(targetElement))) {\r\n            return (0, _extend.extend)(that._createFieldArgs(targetElement), args)\r\n        } else {\r\n            return (0, _extend.extend)(that._createCellArgs(targetElement), args)\r\n        }\r\n    },\r\n    _createFieldArgs: function(targetElement) {\r\n        var field = (0, _renderer2.default)(targetElement).children().data(\"field\");\r\n        var args = {\r\n            field: field\r\n        };\r\n        return (0, _type.isDefined)(field) ? args : {}\r\n    },\r\n    _createCellArgs: function(cellElement) {\r\n        var $cellElement = (0, _renderer2.default)(cellElement);\r\n        var columnIndex = cellElement.cellIndex;\r\n        var rowIndex = cellElement.parentElement.rowIndex;\r\n        var $table = $cellElement.closest(\"table\");\r\n        var data = $table.data(\"data\");\r\n        var cell = data && data[rowIndex] && data[rowIndex][columnIndex];\r\n        var args = {\r\n            area: $table.data(\"area\"),\r\n            rowIndex: rowIndex,\r\n            columnIndex: columnIndex,\r\n            cellElement: (0, _dom.getPublicElement)($cellElement),\r\n            cell: cell\r\n        };\r\n        return args\r\n    },\r\n    _handleCellClick: function(e) {\r\n        var that = this;\r\n        var args = that._createEventArgs(e.currentTarget, e);\r\n        var cell = args.cell;\r\n        if (!cell || !args.area && (args.rowIndex || args.columnIndex)) {\r\n            return\r\n        }\r\n        that._trigger(\"onCellClick\", args);\r\n        cell && !args.cancel && (0, _type.isDefined)(cell.expanded) && setTimeout(function() {\r\n            that._dataController[cell.expanded ? \"collapseHeaderItem\" : \"expandHeaderItem\"](args.area, cell.path)\r\n        })\r\n    },\r\n    _getNoDataText: function() {\r\n        return this.option(\"texts.noData\")\r\n    },\r\n    _renderNoDataText: _uiGrid_core.renderNoDataText,\r\n    _renderLoadPanel: _uiGrid_core.renderLoadPanel,\r\n    _updateLoading: function(progress) {\r\n        var that = this;\r\n        var isLoading = that._dataController.isLoading();\r\n        if (!that._loadPanel) {\r\n            return\r\n        }\r\n        var loadPanelVisible = that._loadPanel.option(\"visible\");\r\n        if (!loadPanelVisible) {\r\n            that._startLoadingTime = new Date\r\n        }\r\n        if (isLoading) {\r\n            if (progress) {\r\n                if (new Date - that._startLoadingTime >= 1e3) {\r\n                    that._loadPanel.option(\"message\", Math.floor(100 * progress) + \"%\")\r\n                }\r\n            } else {\r\n                that._loadPanel.option(\"message\", that.option(\"loadPanel.text\"))\r\n            }\r\n        }\r\n        clearTimeout(that._hideLoadingTimeoutID);\r\n        if (loadPanelVisible && !isLoading) {\r\n            that._hideLoadingTimeoutID = setTimeout(function() {\r\n                that._loadPanel.option(\"visible\", false);\r\n                that.$element().removeClass(OVERFLOW_HIDDEN_CLASS)\r\n            })\r\n        } else {\r\n            that._loadPanel.option(\"visible\", isLoading);\r\n            that.$element().toggleClass(OVERFLOW_HIDDEN_CLASS, !isLoading)\r\n        }\r\n    },\r\n    _renderDescriptionArea: function() {\r\n        var _this = this;\r\n        var $element = this.$element();\r\n        var $descriptionCell = $element.find(\".\" + DESCRIPTION_AREA_CELL_CLASS);\r\n        var $toolbarContainer = (0, _renderer2.default)(DIV).addClass(\"dx-pivotgrid-toolbar\");\r\n        var fieldPanel = this.option(\"fieldPanel\");\r\n        var $filterHeader = $element.find(\".dx-filter-header\");\r\n        var $columnHeader = $element.find(\".dx-column-header\");\r\n        var $targetContainer;\r\n        if (fieldPanel.visible && fieldPanel.showFilterFields) {\r\n            $targetContainer = $filterHeader\r\n        } else {\r\n            if (fieldPanel.visible && (fieldPanel.showDataFields || fieldPanel.showColumnFields)) {\r\n                $targetContainer = $columnHeader\r\n            } else {\r\n                $targetContainer = $descriptionCell\r\n            }\r\n        }\r\n        $columnHeader.toggleClass(BOTTOM_BORDER_CLASS, !!(fieldPanel.visible && (fieldPanel.showDataFields || fieldPanel.showColumnFields)));\r\n        $filterHeader.toggleClass(BOTTOM_BORDER_CLASS, !!(fieldPanel.visible && fieldPanel.showFilterFields));\r\n        $descriptionCell.toggleClass(\"dx-pivotgrid-background\", fieldPanel.visible && (fieldPanel.showDataFields || fieldPanel.showColumnFields || fieldPanel.showRowFields));\r\n        this.$element().find(\".dx-pivotgrid-toolbar\").remove();\r\n        $toolbarContainer.prependTo($targetContainer);\r\n        if (this.option(\"fieldChooser.enabled\")) {\r\n            var $buttonElement = (0, _renderer2.default)(DIV).appendTo($toolbarContainer).addClass(\"dx-pivotgrid-field-chooser-button\");\r\n            var buttonOptions = {\r\n                icon: \"columnchooser\",\r\n                hint: this.option(\"texts.showFieldChooser\"),\r\n                onClick: function() {\r\n                    _this.getFieldChooserPopup().show()\r\n                }\r\n            };\r\n            this._createComponent($buttonElement, \"dxButton\", buttonOptions)\r\n        }\r\n        if (this.option(\"export.enabled\")) {\r\n            var _$buttonElement = (0, _renderer2.default)(DIV).appendTo($toolbarContainer).addClass(\"dx-pivotgrid-export-button\");\r\n            var _buttonOptions = {\r\n                icon: \"xlsxfile\",\r\n                hint: this.option(\"texts.exportToExcel\"),\r\n                onClick: function() {\r\n                    _this.exportToExcel()\r\n                }\r\n            };\r\n            this._createComponent(_$buttonElement, \"dxButton\", _buttonOptions)\r\n        }\r\n    },\r\n    _detectHasContainerHeight: function() {\r\n        var that = this;\r\n        var element = that.$element();\r\n        if ((0, _type.isDefined)(that._hasHeight) || element.is(\":hidden\")) {\r\n            return\r\n        }\r\n        that._pivotGridContainer.addClass(\"dx-hidden\");\r\n        var testElement = (0, _renderer2.default)(DIV).height(TEST_HEIGHT);\r\n        element.append(testElement);\r\n        that._hasHeight = element.height() !== TEST_HEIGHT;\r\n        that._pivotGridContainer.removeClass(\"dx-hidden\");\r\n        testElement.remove()\r\n    },\r\n    _renderHeaders: function(rowHeaderContainer, columnHeaderContainer, filterHeaderContainer, dataHeaderContainer) {\r\n        var that = this;\r\n        var dataSource = that.getDataSource();\r\n        that._rowFields = that._rowFields || new _uiPivot_grid5.FieldsArea(that, \"row\");\r\n        that._rowFields.render(rowHeaderContainer, dataSource.getAreaFields(\"row\"));\r\n        that._columnFields = that._columnFields || new _uiPivot_grid5.FieldsArea(that, \"column\");\r\n        that._columnFields.render(columnHeaderContainer, dataSource.getAreaFields(\"column\"));\r\n        that._filterFields = that._filterFields || new _uiPivot_grid5.FieldsArea(that, \"filter\");\r\n        that._filterFields.render(filterHeaderContainer, dataSource.getAreaFields(\"filter\"));\r\n        that._dataFields = that._dataFields || new _uiPivot_grid5.FieldsArea(that, \"data\");\r\n        that._dataFields.render(dataHeaderContainer, dataSource.getAreaFields(\"data\"));\r\n        that.$element().dxPivotGridFieldChooserBase(\"instance\").renderSortable()\r\n    },\r\n    _createTableElement: function() {\r\n        var that = this;\r\n        var $table = (0, _renderer2.default)(\"<table>\").css({\r\n            width: \"100%\"\r\n        }).toggleClass(BORDERS_CLASS, !!that.option(\"showBorders\")).toggleClass(\"dx-word-wrap\", !!that.option(\"wordWrapEnabled\"));\r\n        _events_engine2.default.on($table, (0, _utils.addNamespace)(_click.name, \"dxPivotGrid\"), \"td\", that._handleCellClick.bind(that));\r\n        return $table\r\n    },\r\n    _renderDataArea: function(dataAreaElement) {\r\n        var that = this;\r\n        var dataArea = that._dataArea || new _uiPivot_grid3.DataArea(that);\r\n        that._dataArea = dataArea;\r\n        dataArea.render(dataAreaElement, that._dataController.getCellsInfo());\r\n        return dataArea\r\n    },\r\n    _renderRowsArea: function(rowsAreaElement) {\r\n        var that = this;\r\n        var rowsArea = that._rowsArea || new _uiPivot_grid4.VerticalHeadersArea(that);\r\n        that._rowsArea = rowsArea;\r\n        rowsArea.render(rowsAreaElement, that._dataController.getRowsInfo());\r\n        return rowsArea\r\n    },\r\n    _renderColumnsArea: function(columnsAreaElement) {\r\n        var that = this;\r\n        var columnsArea = that._columnsArea || new _uiPivot_grid4.HorizontalHeadersArea(that);\r\n        that._columnsArea = columnsArea;\r\n        columnsArea.render(columnsAreaElement, that._dataController.getColumnsInfo());\r\n        return columnsArea\r\n    },\r\n    _initMarkup: function() {\r\n        var that = this;\r\n        that.callBase.apply(this, arguments);\r\n        that.$element().addClass(PIVOTGRID_CLASS)\r\n    },\r\n    _renderContentImpl: function() {\r\n        var that = this;\r\n        var columnsAreaElement;\r\n        var rowsAreaElement;\r\n        var dataAreaElement;\r\n        var tableElement;\r\n        var isFirstDrawing = !that._pivotGridContainer;\r\n        var rowHeaderContainer;\r\n        var columnHeaderContainer;\r\n        var filterHeaderContainer;\r\n        var dataHeaderContainer;\r\n        tableElement = !isFirstDrawing && that._tableElement();\r\n        if (!tableElement) {\r\n            that.$element().addClass(ROW_LINES_CLASS).addClass(FIELDS_CONTAINER_CLASS);\r\n            that._pivotGridContainer = (0, _renderer2.default)(DIV).addClass(\"dx-pivotgrid-container\");\r\n            that._renderFieldChooser();\r\n            that._renderContextMenu();\r\n            columnsAreaElement = (0, _renderer2.default)(TD).addClass(COLUMN_AREA_CELL_CLASS);\r\n            rowsAreaElement = (0, _renderer2.default)(TD).addClass(ROW_AREA_CELL_CLASS);\r\n            dataAreaElement = (0, _renderer2.default)(TD).addClass(DATA_AREA_CELL_CLASS);\r\n            tableElement = that._createTableElement();\r\n            dataHeaderContainer = (0, _renderer2.default)(TD).addClass(\"dx-data-header\");\r\n            filterHeaderContainer = (0, _renderer2.default)(\"<td>\").attr(\"colspan\", \"2\").addClass(\"dx-filter-header\");\r\n            columnHeaderContainer = (0, _renderer2.default)(TD).addClass(\"dx-column-header\");\r\n            rowHeaderContainer = (0, _renderer2.default)(TD).addClass(DESCRIPTION_AREA_CELL_CLASS);\r\n            (0, _renderer2.default)(TR).append(filterHeaderContainer).appendTo(tableElement);\r\n            (0, _renderer2.default)(TR).append(dataHeaderContainer).append(columnHeaderContainer).appendTo(tableElement);\r\n            (0, _renderer2.default)(TR).toggleClass(\"dx-ie\", true === _browser.msie).append(rowHeaderContainer).append(columnsAreaElement).appendTo(tableElement);\r\n            (0, _renderer2.default)(TR).addClass(BOTTOM_ROW_CLASS).append(rowsAreaElement).append(dataAreaElement).appendTo(tableElement);\r\n            that._pivotGridContainer.append(tableElement);\r\n            that.$element().append(that._pivotGridContainer);\r\n            if (\"tree\" === that.option(\"rowHeaderLayout\")) {\r\n                rowsAreaElement.addClass(\"dx-area-tree-view\")\r\n            }\r\n        }\r\n        that.$element().addClass(OVERFLOW_HIDDEN_CLASS);\r\n        that._createComponent(that.$element(), _uiPivot_grid9.default, {\r\n            dataSource: that.getDataSource(),\r\n            encodeHtml: that.option(\"encodeHtml\"),\r\n            allowFieldDragging: that.option(\"fieldPanel.allowFieldDragging\"),\r\n            headerFilter: that.option(\"headerFilter\"),\r\n            visible: that.option(\"visible\")\r\n        });\r\n        var dataArea = that._renderDataArea(dataAreaElement);\r\n        var rowsArea = that._renderRowsArea(rowsAreaElement);\r\n        var columnsArea = that._renderColumnsArea(columnsAreaElement);\r\n        dataArea.tableElement().prepend(columnsArea.headElement());\r\n        if (isFirstDrawing) {\r\n            that._renderLoadPanel(dataArea.groupElement().parent(), that.$element());\r\n            that._renderDescriptionArea();\r\n            rowsArea.processScroll();\r\n            columnsArea.processScroll()\r\n        } [dataArea, rowsArea, columnsArea].forEach(function(area) {\r\n            unsubscribeScrollEvents(area)\r\n        });\r\n        that._renderHeaders(rowHeaderContainer, columnHeaderContainer, filterHeaderContainer, dataHeaderContainer);\r\n        that._update(isFirstDrawing)\r\n    },\r\n    _update: function(isFirstDrawing) {\r\n        var that = this;\r\n        var updateHandler;\r\n        updateHandler = function() {\r\n            that.updateDimensions().done(function() {\r\n                that._subscribeToEvents(that._columnsArea, that._rowsArea, that._dataArea)\r\n            })\r\n        };\r\n        if (that._needDelayResizing(that._dataArea.getData()) && isFirstDrawing) {\r\n            setTimeout(updateHandler)\r\n        } else {\r\n            updateHandler()\r\n        }\r\n    },\r\n    _fireContentReadyAction: function() {\r\n        if (!this._dataController.isLoading()) {\r\n            this.callBase()\r\n        }\r\n    },\r\n    getScrollPath: function(area) {\r\n        var that = this;\r\n        if (\"column\" === area) {\r\n            return that._columnsArea.getScrollPath(that._scrollLeft)\r\n        } else {\r\n            return that._rowsArea.getScrollPath(that._scrollTop)\r\n        }\r\n    },\r\n    getDataSource: function() {\r\n        return this._dataController.getDataSource()\r\n    },\r\n    getFieldChooserPopup: function() {\r\n        return this._fieldChooserPopup\r\n    },\r\n    hasScroll: function(area) {\r\n        var that = this;\r\n        return \"column\" === area ? that._columnsArea.hasScroll() : that._rowsArea.hasScroll()\r\n    },\r\n    _dimensionChanged: function() {\r\n        this.updateDimensions()\r\n    },\r\n    _visibilityChanged: function(visible) {\r\n        if (visible) {\r\n            this.updateDimensions()\r\n        }\r\n    },\r\n    _dispose: function() {\r\n        var that = this;\r\n        clearTimeout(that._hideLoadingTimeoutID);\r\n        that.callBase.apply(that, arguments);\r\n        if (that._dataController) {\r\n            that._dataController.dispose()\r\n        }\r\n    },\r\n    _tableElement: function() {\r\n        return this.$element().find(\"table\").first()\r\n    },\r\n    addWidgetPrefix: function(className) {\r\n        return \"dx-pivotgrid-\" + className\r\n    },\r\n    resize: function() {\r\n        this.updateDimensions()\r\n    },\r\n    isReady: function() {\r\n        return this.callBase() && !this._dataController.isLoading()\r\n    },\r\n    updateDimensions: function() {\r\n        var that = this;\r\n        var groupWidth;\r\n        var tableElement = that._tableElement();\r\n        var rowsArea = that._rowsArea;\r\n        var columnsArea = that._columnsArea;\r\n        var dataArea = that._dataArea;\r\n        var dataAreaHeights;\r\n        var rowsAreaHeights;\r\n        var resultHeights;\r\n        var resultWidths;\r\n        var rowsAreaColumnWidths;\r\n        var bordersWidth;\r\n        var totalWidth = 0;\r\n        var totalHeight = 0;\r\n        var rowsAreaWidth = 0;\r\n        var hasRowsScroll;\r\n        var hasColumnsScroll;\r\n        var scrollingOptions = that.option(\"scrolling\") || {};\r\n        var scrollBarInfo = getScrollBarInfo(scrollingOptions.useNative);\r\n        var scrollBarWidth = scrollBarInfo.scrollBarWidth;\r\n        var dataAreaCell = tableElement.find(\".\" + DATA_AREA_CELL_CLASS);\r\n        var rowAreaCell = tableElement.find(\".\" + ROW_AREA_CELL_CLASS);\r\n        var columnAreaCell = tableElement.find(\".\" + COLUMN_AREA_CELL_CLASS);\r\n        var descriptionCell = tableElement.find(\".\" + DESCRIPTION_AREA_CELL_CLASS);\r\n        var filterHeaderCell = tableElement.find(\".dx-filter-header\");\r\n        var columnHeaderCell = tableElement.find(\".dx-column-header\");\r\n        var elementWidth;\r\n        var columnsAreaHeight;\r\n        var descriptionCellHeight;\r\n        var columnsAreaRowHeights;\r\n        var rowHeights;\r\n        var rowFieldsHeader = that._rowFields;\r\n        var columnsAreaRowCount;\r\n        var needSynchronizeFieldPanel;\r\n        var d = new _deferred.Deferred;\r\n        if (!(0, _window.hasWindow)()) {\r\n            return\r\n        }\r\n        needSynchronizeFieldPanel = rowFieldsHeader.isVisible() && \"tree\" !== that.option(\"rowHeaderLayout\"), that._detectHasContainerHeight();\r\n        if (!dataArea.headElement().length) {\r\n            dataArea.tableElement().prepend(columnsArea.headElement())\r\n        }\r\n        if (needSynchronizeFieldPanel) {\r\n            rowsArea.updateColspans(rowFieldsHeader.getColumnsCount());\r\n            rowsArea.tableElement().prepend(rowFieldsHeader.headElement())\r\n        }\r\n        tableElement.addClass(INCOMPRESSIBLE_FIELDS_CLASS);\r\n        dataArea.reset();\r\n        rowsArea.reset();\r\n        columnsArea.reset();\r\n        rowFieldsHeader.reset();\r\n        var calculateHasScroll = function(areaSize, totalSize) {\r\n            return totalSize - areaSize >= 1\r\n        };\r\n        var calculateGroupHeight = function(dataAreaHeight, totalHeight, hasRowsScroll, hasColumnsScroll, scrollBarWidth) {\r\n            return hasRowsScroll ? dataAreaHeight : totalHeight + (hasColumnsScroll ? scrollBarWidth : 0)\r\n        };\r\n        (0, _common.deferUpdate)(function() {\r\n            resultWidths = dataArea.getColumnsWidth();\r\n            rowHeights = rowsArea.getRowsHeight();\r\n            rowsAreaHeights = needSynchronizeFieldPanel ? rowHeights.slice(1) : rowHeights;\r\n            dataAreaHeights = dataArea.getRowsHeight();\r\n            descriptionCellHeight = (0, _size.getSize)(descriptionCell[0], \"height\", {\r\n                paddings: true,\r\n                borders: true,\r\n                margins: true\r\n            }) + (needSynchronizeFieldPanel ? rowHeights[0] : 0);\r\n            columnsAreaRowCount = that._dataController.getColumnsInfo().length;\r\n            resultHeights = (0, _uiPivot_grid.mergeArraysByMaxValue)(rowsAreaHeights, dataAreaHeights.slice(columnsAreaRowCount));\r\n            columnsAreaRowHeights = dataAreaHeights.slice(0, columnsAreaRowCount);\r\n            columnsAreaHeight = getArraySum(columnsAreaRowHeights);\r\n            rowsAreaColumnWidths = rowsArea.getColumnsWidth();\r\n            var filterAreaHeight = 0;\r\n            var dataAreaHeight = 0;\r\n            if (that._hasHeight) {\r\n                filterAreaHeight = filterHeaderCell.height();\r\n                bordersWidth = getCommonBorderWidth([columnAreaCell, dataAreaCell, tableElement, columnHeaderCell, filterHeaderCell], \"height\");\r\n                dataAreaHeight = that.$element().height() - filterAreaHeight - tableElement.find(\".dx-data-header\").height() - (Math.max(dataArea.headElement().height(), columnAreaCell.height(), descriptionCellHeight) + bordersWidth)\r\n            }\r\n            totalWidth = dataArea.tableElement().width();\r\n            totalHeight = getArraySum(resultHeights);\r\n            if (!totalWidth || !totalHeight) {\r\n                d.resolve();\r\n                return\r\n            }\r\n            rowsAreaWidth = getArraySum(rowsAreaColumnWidths);\r\n            elementWidth = that.$element().width();\r\n            bordersWidth = getCommonBorderWidth([rowAreaCell, dataAreaCell, tableElement], \"width\");\r\n            groupWidth = elementWidth - rowsAreaWidth - bordersWidth;\r\n            groupWidth = groupWidth > 0 ? groupWidth : totalWidth;\r\n            hasRowsScroll = that._hasHeight && calculateHasScroll(dataAreaHeight, totalHeight);\r\n            hasColumnsScroll = calculateHasScroll(groupWidth, totalWidth);\r\n            var groupHeight = calculateGroupHeight(dataAreaHeight, totalHeight, hasRowsScroll, hasColumnsScroll, scrollBarWidth);\r\n            (0, _common.deferRender)(function() {\r\n                columnsArea.tableElement().append(dataArea.headElement());\r\n                rowFieldsHeader.tableElement().append(rowsArea.headElement());\r\n                if (!hasColumnsScroll && hasRowsScroll && scrollBarWidth) {\r\n                    adjustSizeArray(resultWidths, scrollBarWidth);\r\n                    totalWidth -= scrollBarWidth\r\n                }\r\n                if (descriptionCellHeight > columnsAreaHeight) {\r\n                    adjustSizeArray(columnsAreaRowHeights, columnsAreaHeight - descriptionCellHeight);\r\n                    columnsArea.setRowsHeight(columnsAreaRowHeights)\r\n                }\r\n                tableElement.removeClass(INCOMPRESSIBLE_FIELDS_CLASS);\r\n                columnHeaderCell.children().css(\"maxWidth\", groupWidth);\r\n                columnsArea.groupWidth(groupWidth);\r\n                columnsArea.processScrollBarSpacing(hasRowsScroll ? scrollBarWidth : 0);\r\n                columnsArea.setColumnsWidth(resultWidths);\r\n                rowsArea.groupHeight(that._hasHeight ? groupHeight : \"auto\");\r\n                rowsArea.processScrollBarSpacing(hasColumnsScroll ? scrollBarWidth : 0);\r\n                rowsArea.setColumnsWidth(rowsAreaColumnWidths);\r\n                rowsArea.setRowsHeight(resultHeights);\r\n                dataArea.setColumnsWidth(resultWidths);\r\n                dataArea.setRowsHeight(resultHeights);\r\n                dataArea.groupWidth(groupWidth);\r\n                dataArea.groupHeight(that._hasHeight ? groupHeight : \"auto\");\r\n                needSynchronizeFieldPanel && rowFieldsHeader.setColumnsWidth(rowsAreaColumnWidths);\r\n                dataAreaCell.toggleClass(BOTTOM_BORDER_CLASS, !hasRowsScroll);\r\n                rowAreaCell.toggleClass(BOTTOM_BORDER_CLASS, !hasRowsScroll);\r\n                if (!that._hasHeight && elementWidth !== that.$element().width()) {\r\n                    var diff = elementWidth - that.$element().width();\r\n                    if (!hasColumnsScroll) {\r\n                        adjustSizeArray(resultWidths, diff);\r\n                        columnsArea.setColumnsWidth(resultWidths);\r\n                        dataArea.setColumnsWidth(resultWidths)\r\n                    }\r\n                    dataArea.groupWidth(groupWidth - diff);\r\n                    columnsArea.groupWidth(groupWidth - diff)\r\n                }\r\n                if (that._hasHeight && that._filterFields.isVisible() && filterHeaderCell.height() !== filterAreaHeight) {\r\n                    var _diff = filterHeaderCell.height() - filterAreaHeight;\r\n                    if (_diff > 0) {\r\n                        hasRowsScroll = calculateHasScroll(dataAreaHeight - _diff, totalHeight);\r\n                        var _groupHeight = calculateGroupHeight(dataAreaHeight - _diff, totalHeight, hasRowsScroll, hasColumnsScroll, scrollBarWidth);\r\n                        dataArea.groupHeight(_groupHeight);\r\n                        rowsArea.groupHeight(_groupHeight)\r\n                    }\r\n                }\r\n                if (\"virtual\" === scrollingOptions.mode) {\r\n                    var virtualContentParams = that._dataController.calculateVirtualContentParams({\r\n                        virtualRowHeight: scrollingOptions.virtualRowHeight,\r\n                        virtualColumnWidth: scrollingOptions.virtualColumnWidth,\r\n                        itemWidths: resultWidths,\r\n                        itemHeights: resultHeights,\r\n                        rowCount: resultHeights.length,\r\n                        columnCount: resultWidths.length,\r\n                        viewportWidth: groupWidth,\r\n                        viewportHeight: that._hasHeight ? groupHeight : (0, _renderer2.default)(window).outerHeight()\r\n                    });\r\n                    dataArea.setVirtualContentParams({\r\n                        top: virtualContentParams.contentTop,\r\n                        left: virtualContentParams.contentLeft,\r\n                        width: virtualContentParams.width,\r\n                        height: virtualContentParams.height\r\n                    });\r\n                    rowsArea.setVirtualContentParams({\r\n                        top: virtualContentParams.contentTop,\r\n                        width: rowsAreaWidth,\r\n                        height: virtualContentParams.height\r\n                    });\r\n                    columnsArea.setVirtualContentParams({\r\n                        left: virtualContentParams.contentLeft,\r\n                        width: virtualContentParams.width,\r\n                        height: columnsArea.groupElement().height()\r\n                    })\r\n                }\r\n                var updateScrollableResults = [];\r\n                dataArea.processScroll(scrollBarInfo.scrollBarUseNative, hasColumnsScroll, hasRowsScroll);\r\n                (0, _iterator.each)([columnsArea, rowsArea, dataArea], function(_, area) {\r\n                    updateScrollableResults.push(area && area.updateScrollable())\r\n                });\r\n                that._updateLoading();\r\n                that._renderNoDataText(dataAreaCell);\r\n                _deferred.when.apply(_renderer2.default, updateScrollableResults).done(function() {\r\n                    that._updateScrollPosition(columnsArea, rowsArea, dataArea);\r\n                    d.resolve()\r\n                })\r\n            })\r\n        });\r\n        return d\r\n    },\r\n    applyPartialDataSource: function(area, path, dataSource) {\r\n        this._dataController.applyPartialDataSource(area, path, dataSource)\r\n    }\r\n}).inherit(_uiPivot_grid10.ExportMixin).include(_uiPivot_grid12.default);\r\n(0, _component_registrator2.default)(\"dxPivotGrid\", PivotGrid);\r\nmodule.exports = PivotGrid;\r\n"]},"metadata":{},"sourceType":"module"}