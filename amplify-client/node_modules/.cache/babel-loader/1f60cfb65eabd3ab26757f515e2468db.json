{"ast":null,"code":"/**\r\n * DevExtreme (viz/range_selector/sliders_controller.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar noop = require(\"../../core/utils/common\").noop;\n\nvar commonModule = require(\"./common\");\n\nvar animationSettings = commonModule.utils.animationSettings;\nvar emptySliderMarkerText = commonModule.consts.emptySliderMarkerText;\n\nvar Slider = require(\"./slider\");\n\nvar _normalizeEnum = require(\"../core/utils\").normalizeEnum;\n\nvar typeUtils = require(\"../../core/utils/type\");\n\nvar isNumeric = typeUtils.isNumeric;\n\nvar vizUtils = require(\"../core/utils\");\n\nvar adjust = require(\"../../core/utils/math\").adjust;\n\nfunction buildRectPoints(left, top, right, bottom) {\n  return [left, top, right, top, right, bottom, left, bottom];\n}\n\nfunction valueOf(value) {\n  return value && value.valueOf();\n}\n\nfunction isLess(a, b) {\n  return a < b;\n}\n\nfunction isGreater(a, b) {\n  return a > b;\n}\n\nfunction selectClosestValue(target, values) {\n  var start = 0;\n  var end = values ? values.length - 1 : 0;\n  var middle;\n  var val = target;\n\n  while (end - start > 1) {\n    middle = start + end >> 1;\n    val = values[middle];\n\n    if (val === target) {\n      return target;\n    } else {\n      if (target < val) {\n        end = middle;\n      } else {\n        start = middle;\n      }\n    }\n  }\n\n  if (values) {\n    val = values[target - values[start] <= values[end] - target ? start : end];\n  }\n\n  return val;\n}\n\nfunction dummyProcessSelectionChanged() {\n  this._lastSelectedRange = this.getSelectedRange();\n  delete this._processSelectionChanged;\n}\n\nfunction suppressSetSelectedRange(controller) {\n  controller.setSelectedRange = noop;\n\n  if (controller._processSelectionChanged === dummyProcessSelectionChanged) {\n    controller._processSelectionChanged();\n  }\n}\n\nfunction restoreSetSelectedRange(controller) {\n  delete controller.setSelectedRange;\n}\n\nfunction SlidersController(params) {\n  var that = this;\n  var sliderParams = {\n    renderer: params.renderer,\n    root: params.root,\n    trackersGroup: params.trackersGroup,\n    translator: params.translator\n  };\n  that._params = params;\n  that._areaTracker = params.renderer.path(null, \"area\").attr({\n    \"class\": \"area-tracker\",\n    fill: \"#000000\",\n    opacity: 1e-4\n  }).append(params.trackersGroup);\n  that._selectedAreaTracker = params.renderer.path(null, \"area\").attr({\n    \"class\": \"selected-area-tracker\",\n    fill: \"#000000\",\n    opacity: 1e-4\n  }).append(params.trackersGroup);\n  that._shutter = params.renderer.path(null, \"area\").append(params.root);\n  that._sliders = [new Slider(sliderParams, 0), new Slider(sliderParams, 1)];\n  that._processSelectionChanged = dummyProcessSelectionChanged;\n}\n\nSlidersController.prototype = {\n  constructor: SlidersController,\n  dispose: function dispose() {\n    this._sliders[0].dispose();\n\n    this._sliders[1].dispose();\n  },\n  getTrackerTargets: function getTrackerTargets() {\n    return {\n      area: this._areaTracker,\n      selectedArea: this._selectedAreaTracker,\n      sliders: this._sliders\n    };\n  },\n  _processSelectionChanged: function _processSelectionChanged(e) {\n    var that = this;\n    var selectedRange = that.getSelectedRange();\n\n    if (valueOf(selectedRange.startValue) !== valueOf(that._lastSelectedRange.startValue) || valueOf(selectedRange.endValue) !== valueOf(that._lastSelectedRange.endValue)) {\n      that._params.updateSelectedRange(selectedRange, that._lastSelectedRange, e);\n\n      that._lastSelectedRange = selectedRange;\n    }\n  },\n  update: function update(verticalRange, behavior, isCompactMode, sliderHandleOptions, sliderMarkerOptions, shutterOptions, rangeBounds, fullTicks, selectedRangeColor) {\n    var that = this;\n\n    var screenRange = that._params.translator.getScreenRange();\n\n    that._verticalRange = verticalRange;\n    that._minRange = rangeBounds.minRange;\n    that._maxRange = rangeBounds.maxRange;\n    that._animationEnabled = behavior.animationEnabled && that._params.renderer.animationEnabled();\n    that._allowSlidersSwap = behavior.allowSlidersSwap;\n\n    that._sliders[0].update(verticalRange, sliderHandleOptions, sliderMarkerOptions);\n\n    that._sliders[1].update(verticalRange, sliderHandleOptions, sliderMarkerOptions);\n\n    that._sliders[0]._position = that._sliders[1]._position = screenRange[0];\n    that._values = !that._params.translator.isValueProlonged && behavior.snapToTicks ? fullTicks : null;\n\n    that._areaTracker.attr({\n      points: buildRectPoints(screenRange[0], verticalRange[0], screenRange[1], verticalRange[1])\n    });\n\n    that._isCompactMode = isCompactMode;\n    that._shutterOffset = sliderHandleOptions.width / 2;\n\n    that._updateSelectedView(shutterOptions, selectedRangeColor);\n\n    that._isOnMoving = \"onmoving\" === _normalizeEnum(behavior.callValueChanged);\n\n    that._updateSelectedRange();\n\n    that._applyTotalPosition(false);\n  },\n  _updateSelectedView: function _updateSelectedView(shutterOptions, selectedRangeColor) {\n    var settings = {\n      fill: null,\n      \"fill-opacity\": null,\n      stroke: null,\n      \"stroke-width\": null\n    };\n\n    if (this._isCompactMode) {\n      settings.stroke = selectedRangeColor;\n      settings[\"stroke-width\"] = 3;\n      settings.sharp = \"v\";\n    } else {\n      settings.fill = shutterOptions.color;\n      settings[\"fill-opacity\"] = shutterOptions.opacity;\n    }\n\n    this._shutter.attr(settings);\n  },\n  _updateSelectedRange: function _updateSelectedRange() {\n    var that = this;\n    var sliders = that._sliders;\n    sliders[0].cancelAnimation();\n    sliders[1].cancelAnimation();\n\n    that._shutter.stopAnimation();\n\n    if (that._params.translator.getBusinessRange().isEmpty()) {\n      sliders[0]._setText(emptySliderMarkerText);\n\n      sliders[1]._setText(emptySliderMarkerText);\n\n      sliders[0]._value = sliders[1]._value = void 0;\n      sliders[0]._position = that._params.translator.getScreenRange()[0];\n      sliders[1]._position = that._params.translator.getScreenRange()[1];\n\n      that._applyTotalPosition(false);\n\n      suppressSetSelectedRange(that);\n    } else {\n      restoreSetSelectedRange(that);\n    }\n  },\n  _applyTotalPosition: function _applyTotalPosition(isAnimated) {\n    var sliders = this._sliders;\n    var areOverlapped;\n    isAnimated = this._animationEnabled && isAnimated;\n    sliders[0].applyPosition(isAnimated);\n    sliders[1].applyPosition(isAnimated);\n    areOverlapped = sliders[0].getCloudBorder() > sliders[1].getCloudBorder();\n    sliders[0].setOverlapped(areOverlapped);\n    sliders[1].setOverlapped(areOverlapped);\n\n    this._applyAreaTrackersPosition();\n\n    this._applySelectedRangePosition(isAnimated);\n  },\n  _applyAreaTrackersPosition: function _applyAreaTrackersPosition() {\n    var that = this;\n\n    var position1 = that._sliders[0].getPosition();\n\n    var position2 = that._sliders[1].getPosition();\n\n    that._selectedAreaTracker.attr({\n      points: buildRectPoints(position1, that._verticalRange[0], position2, that._verticalRange[1])\n    }).css({\n      cursor: Math.abs(that._params.translator.getScreenRange()[1] - that._params.translator.getScreenRange()[0] - position2 + position1) < .001 ? \"default\" : \"pointer\"\n    });\n  },\n  _applySelectedRangePosition: function _applySelectedRangePosition(isAnimated) {\n    var that = this;\n    var verticalRange = that._verticalRange;\n\n    var pos1 = that._sliders[0].getPosition();\n\n    var pos2 = that._sliders[1].getPosition();\n\n    var screenRange;\n    var points;\n\n    if (that._isCompactMode) {\n      points = [pos1 + Math.ceil(that._shutterOffset), (verticalRange[0] + verticalRange[1]) / 2, pos2 - Math.floor(that._shutterOffset), (verticalRange[0] + verticalRange[1]) / 2];\n    } else {\n      screenRange = that._params.axis.getVisibleArea();\n      points = [buildRectPoints(screenRange[0], verticalRange[0], Math.max(pos1 - Math.floor(that._shutterOffset), screenRange[0]), verticalRange[1]), buildRectPoints(screenRange[1], verticalRange[0], Math.min(pos2 + Math.ceil(that._shutterOffset), screenRange[1]), verticalRange[1])];\n    }\n\n    if (isAnimated) {\n      that._shutter.animate({\n        points: points\n      }, animationSettings);\n    } else {\n      that._shutter.attr({\n        points: points\n      });\n    }\n  },\n  getSelectedRange: function getSelectedRange() {\n    return {\n      startValue: this._sliders[0].getValue(),\n      endValue: this._sliders[1].getValue()\n    };\n  },\n  setSelectedRange: function setSelectedRange(visualRange, e) {\n    visualRange = visualRange || {};\n    var that = this;\n    var translator = that._params.translator;\n    var businessRange = translator.getBusinessRange();\n    var compare = \"discrete\" === businessRange.axisType ? function (a, b) {\n      return a < b;\n    } : function (a, b) {\n      return a <= b;\n    };\n\n    var _vizUtils$adjustVisua = vizUtils.adjustVisualRange({\n      dataType: businessRange.dataType,\n      axisType: businessRange.axisType,\n      base: businessRange.base\n    }, {\n      startValue: translator.isValid(visualRange.startValue) ? translator.getCorrectValue(visualRange.startValue, 1) : void 0,\n      endValue: translator.isValid(visualRange.endValue) ? translator.getCorrectValue(visualRange.endValue, -1) : void 0,\n      length: visualRange.length\n    }, {\n      min: businessRange.minVisible,\n      max: businessRange.maxVisible,\n      categories: businessRange.categories\n    }),\n        startValue = _vizUtils$adjustVisua.startValue,\n        endValue = _vizUtils$adjustVisua.endValue;\n\n    startValue = isNumeric(startValue) ? adjust(startValue) : startValue;\n    endValue = isNumeric(endValue) ? adjust(endValue) : endValue;\n    var values = compare(translator.to(startValue, -1), translator.to(endValue, 1)) ? [startValue, endValue] : [endValue, startValue];\n\n    that._sliders[0].setDisplayValue(values[0]);\n\n    that._sliders[1].setDisplayValue(values[1]);\n\n    that._sliders[0]._position = translator.to(values[0], -1);\n    that._sliders[1]._position = translator.to(values[1], 1);\n\n    that._applyTotalPosition(true);\n\n    that._processSelectionChanged(e);\n  },\n  beginSelectedAreaMoving: function beginSelectedAreaMoving(initialPosition) {\n    var that = this;\n    var sliders = that._sliders;\n    var offset = (sliders[0].getPosition() + sliders[1].getPosition()) / 2 - initialPosition;\n    var currentPosition = initialPosition;\n\n    move.complete = function (e) {\n      that._dockSelectedArea(e);\n    };\n\n    return move;\n\n    function move(position, e) {\n      if (position !== currentPosition && position > currentPosition === position > (sliders[0].getPosition() + sliders[1].getPosition()) / 2 - offset) {\n        that._moveSelectedArea(position + offset, false, e);\n      }\n\n      currentPosition = position;\n    }\n  },\n  _dockSelectedArea: function _dockSelectedArea(e) {\n    var translator = this._params.translator;\n    var sliders = this._sliders;\n    sliders[0]._position = translator.to(sliders[0].getValue(), -1);\n    sliders[1]._position = translator.to(sliders[1].getValue(), 1);\n\n    this._applyTotalPosition(true);\n\n    this._processSelectionChanged(e);\n  },\n  moveSelectedArea: function moveSelectedArea(screenPosition, e) {\n    this._moveSelectedArea(screenPosition, true, e);\n\n    this._dockSelectedArea(e);\n  },\n  _moveSelectedArea: function _moveSelectedArea(screenPosition, isAnimated, e) {\n    var that = this;\n    var translator = that._params.translator;\n    var sliders = that._sliders;\n    var interval = sliders[1].getPosition() - sliders[0].getPosition();\n    var startPosition = screenPosition - interval / 2;\n    var endPosition = screenPosition + interval / 2;\n    var startValue;\n\n    if (startPosition < translator.getScreenRange()[0]) {\n      startPosition = translator.getScreenRange()[0];\n      endPosition = startPosition + interval;\n    }\n\n    if (endPosition > translator.getScreenRange()[1]) {\n      endPosition = translator.getScreenRange()[1];\n      startPosition = endPosition - interval;\n    }\n\n    startValue = selectClosestValue(translator.from(startPosition, -1), that._values);\n    sliders[0].setDisplayValue(startValue);\n    sliders[1].setDisplayValue(selectClosestValue(translator.from(translator.to(startValue, -1) + interval, 1), that._values));\n    sliders[0]._position = startPosition;\n    sliders[1]._position = endPosition;\n\n    that._applyTotalPosition(isAnimated);\n\n    if (that._isOnMoving) {\n      that._processSelectionChanged(e);\n    }\n  },\n  placeSliderAndBeginMoving: function placeSliderAndBeginMoving(firstPosition, secondPosition, e) {\n    var that = this;\n    var translator = that._params.translator;\n    var sliders = that._sliders;\n    var index = firstPosition < secondPosition ? 0 : 1;\n    var dir = index > 0 ? 1 : -1;\n    var compare = index > 0 ? isGreater : isLess;\n    var antiCompare = index > 0 ? isLess : isGreater;\n    var thresholdPosition;\n    var positions = [];\n    var values = [];\n    var handler;\n    values[index] = translator.from(firstPosition, dir);\n    values[1 - index] = translator.from(secondPosition, -dir);\n    positions[1 - index] = secondPosition;\n\n    if (translator.isValueProlonged) {\n      if (compare(firstPosition, translator.to(values[index], dir))) {\n        values[index] = translator.from(firstPosition, -dir);\n      }\n\n      if (compare(secondPosition, translator.to(values[index], -dir))) {\n        values[1 - index] = values[index];\n      }\n    }\n\n    if (that._minRange) {\n      thresholdPosition = translator.to(translator.add(selectClosestValue(values[index], that._values), that._minRange, -dir), -dir);\n\n      if (compare(secondPosition, thresholdPosition)) {\n        values[1 - index] = translator.add(values[index], that._minRange, -dir);\n      }\n\n      thresholdPosition = translator.to(translator.add(translator.getRange()[1 - index], that._minRange, dir), -dir);\n\n      if (antiCompare(firstPosition, thresholdPosition)) {\n        values[1 - index] = translator.getRange()[1 - index];\n        values[index] = translator.add(values[1 - index], that._minRange, dir);\n        positions[1 - index] = firstPosition;\n      }\n    }\n\n    values[0] = selectClosestValue(values[0], that._values);\n    values[1] = selectClosestValue(values[1], that._values);\n    positions[index] = translator.to(values[index], dir);\n    sliders[0].setDisplayValue(values[0]);\n    sliders[1].setDisplayValue(values[1]);\n    sliders[0]._position = positions[0];\n    sliders[1]._position = positions[1];\n\n    that._applyTotalPosition(true);\n\n    if (that._isOnMoving) {\n      that._processSelectionChanged(e);\n    }\n\n    handler = that.beginSliderMoving(1 - index, secondPosition);\n\n    sliders[1 - index]._sliderGroup.stopAnimation();\n\n    that._shutter.stopAnimation();\n\n    handler(secondPosition);\n    return handler;\n  },\n  beginSliderMoving: function beginSliderMoving(initialIndex, initialPosition) {\n    var that = this;\n    var translator = that._params.translator;\n    var sliders = that._sliders;\n    var minPosition = translator.getScreenRange()[0];\n    var maxPosition = translator.getScreenRange()[1];\n    var index = initialIndex;\n    var staticPosition = sliders[1 - index].getPosition();\n    var currentPosition = initialPosition;\n    var dir = index > 0 ? 1 : -1;\n    var compareMin = index > 0 ? isLess : isGreater;\n    var compareMax = index > 0 ? isGreater : isLess;\n    var moveOffset = sliders[index].getPosition() - initialPosition;\n    var swapOffset = compareMin(sliders[index].getPosition(), initialPosition) ? -moveOffset : moveOffset;\n\n    move.complete = function (e) {\n      sliders[index]._setValid(true);\n\n      that._dockSelectedArea(e);\n    };\n\n    return move;\n\n    function move(position, e) {\n      var isValid;\n      var temp;\n      var pos;\n      var slider;\n      var value;\n\n      if (position !== currentPosition) {\n        if (compareMin(position + swapOffset, staticPosition)) {\n          isValid = that._allowSlidersSwap;\n\n          if (isValid && !translator.isValueProlonged && that._minRange) {\n            isValid = translator.isValid(translator.add(sliders[1 - index].getValue(), that._minRange, -dir));\n          }\n\n          if (isValid) {\n            that._changeMovingSlider(index);\n\n            index = 1 - index;\n            dir = -dir;\n            temp = compareMin;\n            compareMin = compareMax;\n            compareMax = temp;\n            moveOffset = -dir * Math.abs(moveOffset);\n            swapOffset = -moveOffset;\n          }\n        }\n\n        if (compareMax(position + moveOffset, staticPosition)) {\n          isValid = true;\n          slider = sliders[index];\n          value = sliders[1 - index].getValue();\n          pos = Math.max(Math.min(position + moveOffset, maxPosition), minPosition);\n\n          if (isValid && translator.isValueProlonged) {\n            isValid = !compareMin(pos, translator.to(value, dir));\n          }\n\n          if (isValid && that._minRange) {\n            isValid = !compareMin(pos, translator.to(translator.add(value, that._minRange, dir), dir));\n          }\n\n          if (isValid && that._maxRange) {\n            isValid = !compareMax(pos, translator.to(translator.add(value, that._maxRange, dir), dir));\n          }\n\n          slider._setValid(isValid);\n\n          slider.setDisplayValue(isValid ? selectClosestValue(translator.from(pos, dir), that._values) : slider.getValue());\n          slider._position = pos;\n\n          that._applyTotalPosition(false);\n\n          slider.toForeground();\n\n          if (that._isOnMoving) {\n            that._processSelectionChanged(e);\n          }\n        }\n      }\n\n      currentPosition = position;\n    }\n  },\n  _changeMovingSlider: function _changeMovingSlider(index) {\n    var that = this;\n    var translator = that._params.translator;\n    var sliders = that._sliders;\n    var position = sliders[1 - index].getPosition();\n    var dir = index > 0 ? 1 : -1;\n    var newValue;\n    sliders[index].setDisplayValue(selectClosestValue(translator.from(position, dir), that._values));\n    newValue = translator.from(position, -dir);\n\n    if (translator.isValueProlonged) {\n      newValue = translator.from(position, dir);\n    } else {\n      if (that._minRange) {\n        newValue = translator.add(newValue, that._minRange, -dir);\n      }\n    }\n\n    sliders[1 - index].setDisplayValue(selectClosestValue(newValue, that._values));\n\n    sliders[index]._setValid(true);\n\n    sliders[index]._marker._update();\n\n    sliders[0]._position = sliders[1]._position = position;\n  },\n  foregroundSlider: function foregroundSlider(index) {\n    this._sliders[index].toForeground();\n  }\n};\nexports.SlidersController = SlidersController;","map":{"version":3,"sources":["C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/devextreme/viz/range_selector/sliders_controller.js"],"names":["noop","require","commonModule","animationSettings","emptySliderMarkerText","Slider","_normalizeEnum","typeUtils","isNumeric","vizUtils","adjust","value","a","start","end","values","val","middle","target","controller","that","sliderParams","renderer","params","root","trackersGroup","translator","fill","opacity","SlidersController","constructor","dispose","getTrackerTargets","area","selectedArea","sliders","_sliders","_processSelectionChanged","selectedRange","valueOf","update","screenRange","rangeBounds","behavior","points","buildRectPoints","verticalRange","sliderHandleOptions","_updateSelectedView","settings","stroke","shutterOptions","_updateSelectedRange","suppressSetSelectedRange","restoreSetSelectedRange","_applyTotalPosition","isAnimated","areOverlapped","_applyAreaTrackersPosition","position1","position2","cursor","Math","_applySelectedRangePosition","pos1","pos2","getSelectedRange","startValue","endValue","setSelectedRange","visualRange","businessRange","compare","_vizUtils$adjustVisua","dataType","axisType","base","length","min","max","categories","beginSelectedAreaMoving","offset","currentPosition","move","position","_dockSelectedArea","moveSelectedArea","_moveSelectedArea","interval","startPosition","screenPosition","endPosition","selectClosestValue","placeSliderAndBeginMoving","index","firstPosition","dir","antiCompare","positions","thresholdPosition","handler","beginSliderMoving","minPosition","maxPosition","staticPosition","compareMin","compareMax","moveOffset","swapOffset","isValid","temp","slider","pos","_changeMovingSlider","newValue","foregroundSlider","exports"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (viz/range_selector/sliders_controller.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar noop = require(\"../../core/utils/common\").noop;\r\nvar commonModule = require(\"./common\");\r\nvar animationSettings = commonModule.utils.animationSettings;\r\nvar emptySliderMarkerText = commonModule.consts.emptySliderMarkerText;\r\nvar Slider = require(\"./slider\");\r\nvar _normalizeEnum = require(\"../core/utils\").normalizeEnum;\r\nvar typeUtils = require(\"../../core/utils/type\");\r\nvar isNumeric = typeUtils.isNumeric;\r\nvar vizUtils = require(\"../core/utils\");\r\nvar adjust = require(\"../../core/utils/math\").adjust;\r\n\r\nfunction buildRectPoints(left, top, right, bottom) {\r\n    return [left, top, right, top, right, bottom, left, bottom]\r\n}\r\n\r\nfunction valueOf(value) {\r\n    return value && value.valueOf()\r\n}\r\n\r\nfunction isLess(a, b) {\r\n    return a < b\r\n}\r\n\r\nfunction isGreater(a, b) {\r\n    return a > b\r\n}\r\n\r\nfunction selectClosestValue(target, values) {\r\n    var start = 0;\r\n    var end = values ? values.length - 1 : 0;\r\n    var middle;\r\n    var val = target;\r\n    while (end - start > 1) {\r\n        middle = start + end >> 1;\r\n        val = values[middle];\r\n        if (val === target) {\r\n            return target\r\n        } else {\r\n            if (target < val) {\r\n                end = middle\r\n            } else {\r\n                start = middle\r\n            }\r\n        }\r\n    }\r\n    if (values) {\r\n        val = values[target - values[start] <= values[end] - target ? start : end]\r\n    }\r\n    return val\r\n}\r\n\r\nfunction dummyProcessSelectionChanged() {\r\n    this._lastSelectedRange = this.getSelectedRange();\r\n    delete this._processSelectionChanged\r\n}\r\n\r\nfunction suppressSetSelectedRange(controller) {\r\n    controller.setSelectedRange = noop;\r\n    if (controller._processSelectionChanged === dummyProcessSelectionChanged) {\r\n        controller._processSelectionChanged()\r\n    }\r\n}\r\n\r\nfunction restoreSetSelectedRange(controller) {\r\n    delete controller.setSelectedRange\r\n}\r\n\r\nfunction SlidersController(params) {\r\n    var that = this;\r\n    var sliderParams = {\r\n        renderer: params.renderer,\r\n        root: params.root,\r\n        trackersGroup: params.trackersGroup,\r\n        translator: params.translator\r\n    };\r\n    that._params = params;\r\n    that._areaTracker = params.renderer.path(null, \"area\").attr({\r\n        \"class\": \"area-tracker\",\r\n        fill: \"#000000\",\r\n        opacity: 1e-4\r\n    }).append(params.trackersGroup);\r\n    that._selectedAreaTracker = params.renderer.path(null, \"area\").attr({\r\n        \"class\": \"selected-area-tracker\",\r\n        fill: \"#000000\",\r\n        opacity: 1e-4\r\n    }).append(params.trackersGroup);\r\n    that._shutter = params.renderer.path(null, \"area\").append(params.root);\r\n    that._sliders = [new Slider(sliderParams, 0), new Slider(sliderParams, 1)];\r\n    that._processSelectionChanged = dummyProcessSelectionChanged\r\n}\r\nSlidersController.prototype = {\r\n    constructor: SlidersController,\r\n    dispose: function() {\r\n        this._sliders[0].dispose();\r\n        this._sliders[1].dispose()\r\n    },\r\n    getTrackerTargets: function() {\r\n        return {\r\n            area: this._areaTracker,\r\n            selectedArea: this._selectedAreaTracker,\r\n            sliders: this._sliders\r\n        }\r\n    },\r\n    _processSelectionChanged: function(e) {\r\n        var that = this;\r\n        var selectedRange = that.getSelectedRange();\r\n        if (valueOf(selectedRange.startValue) !== valueOf(that._lastSelectedRange.startValue) || valueOf(selectedRange.endValue) !== valueOf(that._lastSelectedRange.endValue)) {\r\n            that._params.updateSelectedRange(selectedRange, that._lastSelectedRange, e);\r\n            that._lastSelectedRange = selectedRange\r\n        }\r\n    },\r\n    update: function(verticalRange, behavior, isCompactMode, sliderHandleOptions, sliderMarkerOptions, shutterOptions, rangeBounds, fullTicks, selectedRangeColor) {\r\n        var that = this;\r\n        var screenRange = that._params.translator.getScreenRange();\r\n        that._verticalRange = verticalRange;\r\n        that._minRange = rangeBounds.minRange;\r\n        that._maxRange = rangeBounds.maxRange;\r\n        that._animationEnabled = behavior.animationEnabled && that._params.renderer.animationEnabled();\r\n        that._allowSlidersSwap = behavior.allowSlidersSwap;\r\n        that._sliders[0].update(verticalRange, sliderHandleOptions, sliderMarkerOptions);\r\n        that._sliders[1].update(verticalRange, sliderHandleOptions, sliderMarkerOptions);\r\n        that._sliders[0]._position = that._sliders[1]._position = screenRange[0];\r\n        that._values = !that._params.translator.isValueProlonged && behavior.snapToTicks ? fullTicks : null;\r\n        that._areaTracker.attr({\r\n            points: buildRectPoints(screenRange[0], verticalRange[0], screenRange[1], verticalRange[1])\r\n        });\r\n        that._isCompactMode = isCompactMode;\r\n        that._shutterOffset = sliderHandleOptions.width / 2;\r\n        that._updateSelectedView(shutterOptions, selectedRangeColor);\r\n        that._isOnMoving = \"onmoving\" === _normalizeEnum(behavior.callValueChanged);\r\n        that._updateSelectedRange();\r\n        that._applyTotalPosition(false)\r\n    },\r\n    _updateSelectedView: function(shutterOptions, selectedRangeColor) {\r\n        var settings = {\r\n            fill: null,\r\n            \"fill-opacity\": null,\r\n            stroke: null,\r\n            \"stroke-width\": null\r\n        };\r\n        if (this._isCompactMode) {\r\n            settings.stroke = selectedRangeColor;\r\n            settings[\"stroke-width\"] = 3;\r\n            settings.sharp = \"v\"\r\n        } else {\r\n            settings.fill = shutterOptions.color;\r\n            settings[\"fill-opacity\"] = shutterOptions.opacity\r\n        }\r\n        this._shutter.attr(settings)\r\n    },\r\n    _updateSelectedRange: function() {\r\n        var that = this;\r\n        var sliders = that._sliders;\r\n        sliders[0].cancelAnimation();\r\n        sliders[1].cancelAnimation();\r\n        that._shutter.stopAnimation();\r\n        if (that._params.translator.getBusinessRange().isEmpty()) {\r\n            sliders[0]._setText(emptySliderMarkerText);\r\n            sliders[1]._setText(emptySliderMarkerText);\r\n            sliders[0]._value = sliders[1]._value = void 0;\r\n            sliders[0]._position = that._params.translator.getScreenRange()[0];\r\n            sliders[1]._position = that._params.translator.getScreenRange()[1];\r\n            that._applyTotalPosition(false);\r\n            suppressSetSelectedRange(that)\r\n        } else {\r\n            restoreSetSelectedRange(that)\r\n        }\r\n    },\r\n    _applyTotalPosition: function(isAnimated) {\r\n        var sliders = this._sliders;\r\n        var areOverlapped;\r\n        isAnimated = this._animationEnabled && isAnimated;\r\n        sliders[0].applyPosition(isAnimated);\r\n        sliders[1].applyPosition(isAnimated);\r\n        areOverlapped = sliders[0].getCloudBorder() > sliders[1].getCloudBorder();\r\n        sliders[0].setOverlapped(areOverlapped);\r\n        sliders[1].setOverlapped(areOverlapped);\r\n        this._applyAreaTrackersPosition();\r\n        this._applySelectedRangePosition(isAnimated)\r\n    },\r\n    _applyAreaTrackersPosition: function() {\r\n        var that = this;\r\n        var position1 = that._sliders[0].getPosition();\r\n        var position2 = that._sliders[1].getPosition();\r\n        that._selectedAreaTracker.attr({\r\n            points: buildRectPoints(position1, that._verticalRange[0], position2, that._verticalRange[1])\r\n        }).css({\r\n            cursor: Math.abs(that._params.translator.getScreenRange()[1] - that._params.translator.getScreenRange()[0] - position2 + position1) < .001 ? \"default\" : \"pointer\"\r\n        })\r\n    },\r\n    _applySelectedRangePosition: function(isAnimated) {\r\n        var that = this;\r\n        var verticalRange = that._verticalRange;\r\n        var pos1 = that._sliders[0].getPosition();\r\n        var pos2 = that._sliders[1].getPosition();\r\n        var screenRange;\r\n        var points;\r\n        if (that._isCompactMode) {\r\n            points = [pos1 + Math.ceil(that._shutterOffset), (verticalRange[0] + verticalRange[1]) / 2, pos2 - Math.floor(that._shutterOffset), (verticalRange[0] + verticalRange[1]) / 2]\r\n        } else {\r\n            screenRange = that._params.axis.getVisibleArea();\r\n            points = [buildRectPoints(screenRange[0], verticalRange[0], Math.max(pos1 - Math.floor(that._shutterOffset), screenRange[0]), verticalRange[1]), buildRectPoints(screenRange[1], verticalRange[0], Math.min(pos2 + Math.ceil(that._shutterOffset), screenRange[1]), verticalRange[1])]\r\n        }\r\n        if (isAnimated) {\r\n            that._shutter.animate({\r\n                points: points\r\n            }, animationSettings)\r\n        } else {\r\n            that._shutter.attr({\r\n                points: points\r\n            })\r\n        }\r\n    },\r\n    getSelectedRange: function() {\r\n        return {\r\n            startValue: this._sliders[0].getValue(),\r\n            endValue: this._sliders[1].getValue()\r\n        }\r\n    },\r\n    setSelectedRange: function(visualRange, e) {\r\n        visualRange = visualRange || {};\r\n        var that = this;\r\n        var translator = that._params.translator;\r\n        var businessRange = translator.getBusinessRange();\r\n        var compare = \"discrete\" === businessRange.axisType ? function(a, b) {\r\n            return a < b\r\n        } : function(a, b) {\r\n            return a <= b\r\n        };\r\n        var _vizUtils$adjustVisua = vizUtils.adjustVisualRange({\r\n                dataType: businessRange.dataType,\r\n                axisType: businessRange.axisType,\r\n                base: businessRange.base\r\n            }, {\r\n                startValue: translator.isValid(visualRange.startValue) ? translator.getCorrectValue(visualRange.startValue, 1) : void 0,\r\n                endValue: translator.isValid(visualRange.endValue) ? translator.getCorrectValue(visualRange.endValue, -1) : void 0,\r\n                length: visualRange.length\r\n            }, {\r\n                min: businessRange.minVisible,\r\n                max: businessRange.maxVisible,\r\n                categories: businessRange.categories\r\n            }),\r\n            startValue = _vizUtils$adjustVisua.startValue,\r\n            endValue = _vizUtils$adjustVisua.endValue;\r\n        startValue = isNumeric(startValue) ? adjust(startValue) : startValue;\r\n        endValue = isNumeric(endValue) ? adjust(endValue) : endValue;\r\n        var values = compare(translator.to(startValue, -1), translator.to(endValue, 1)) ? [startValue, endValue] : [endValue, startValue];\r\n        that._sliders[0].setDisplayValue(values[0]);\r\n        that._sliders[1].setDisplayValue(values[1]);\r\n        that._sliders[0]._position = translator.to(values[0], -1);\r\n        that._sliders[1]._position = translator.to(values[1], 1);\r\n        that._applyTotalPosition(true);\r\n        that._processSelectionChanged(e)\r\n    },\r\n    beginSelectedAreaMoving: function(initialPosition) {\r\n        var that = this;\r\n        var sliders = that._sliders;\r\n        var offset = (sliders[0].getPosition() + sliders[1].getPosition()) / 2 - initialPosition;\r\n        var currentPosition = initialPosition;\r\n        move.complete = function(e) {\r\n            that._dockSelectedArea(e)\r\n        };\r\n        return move;\r\n\r\n        function move(position, e) {\r\n            if (position !== currentPosition && position > currentPosition === position > (sliders[0].getPosition() + sliders[1].getPosition()) / 2 - offset) {\r\n                that._moveSelectedArea(position + offset, false, e)\r\n            }\r\n            currentPosition = position\r\n        }\r\n    },\r\n    _dockSelectedArea: function(e) {\r\n        var translator = this._params.translator;\r\n        var sliders = this._sliders;\r\n        sliders[0]._position = translator.to(sliders[0].getValue(), -1);\r\n        sliders[1]._position = translator.to(sliders[1].getValue(), 1);\r\n        this._applyTotalPosition(true);\r\n        this._processSelectionChanged(e)\r\n    },\r\n    moveSelectedArea: function(screenPosition, e) {\r\n        this._moveSelectedArea(screenPosition, true, e);\r\n        this._dockSelectedArea(e)\r\n    },\r\n    _moveSelectedArea: function(screenPosition, isAnimated, e) {\r\n        var that = this;\r\n        var translator = that._params.translator;\r\n        var sliders = that._sliders;\r\n        var interval = sliders[1].getPosition() - sliders[0].getPosition();\r\n        var startPosition = screenPosition - interval / 2;\r\n        var endPosition = screenPosition + interval / 2;\r\n        var startValue;\r\n        if (startPosition < translator.getScreenRange()[0]) {\r\n            startPosition = translator.getScreenRange()[0];\r\n            endPosition = startPosition + interval\r\n        }\r\n        if (endPosition > translator.getScreenRange()[1]) {\r\n            endPosition = translator.getScreenRange()[1];\r\n            startPosition = endPosition - interval\r\n        }\r\n        startValue = selectClosestValue(translator.from(startPosition, -1), that._values);\r\n        sliders[0].setDisplayValue(startValue);\r\n        sliders[1].setDisplayValue(selectClosestValue(translator.from(translator.to(startValue, -1) + interval, 1), that._values));\r\n        sliders[0]._position = startPosition;\r\n        sliders[1]._position = endPosition;\r\n        that._applyTotalPosition(isAnimated);\r\n        if (that._isOnMoving) {\r\n            that._processSelectionChanged(e)\r\n        }\r\n    },\r\n    placeSliderAndBeginMoving: function(firstPosition, secondPosition, e) {\r\n        var that = this;\r\n        var translator = that._params.translator;\r\n        var sliders = that._sliders;\r\n        var index = firstPosition < secondPosition ? 0 : 1;\r\n        var dir = index > 0 ? 1 : -1;\r\n        var compare = index > 0 ? isGreater : isLess;\r\n        var antiCompare = index > 0 ? isLess : isGreater;\r\n        var thresholdPosition;\r\n        var positions = [];\r\n        var values = [];\r\n        var handler;\r\n        values[index] = translator.from(firstPosition, dir);\r\n        values[1 - index] = translator.from(secondPosition, -dir);\r\n        positions[1 - index] = secondPosition;\r\n        if (translator.isValueProlonged) {\r\n            if (compare(firstPosition, translator.to(values[index], dir))) {\r\n                values[index] = translator.from(firstPosition, -dir)\r\n            }\r\n            if (compare(secondPosition, translator.to(values[index], -dir))) {\r\n                values[1 - index] = values[index]\r\n            }\r\n        }\r\n        if (that._minRange) {\r\n            thresholdPosition = translator.to(translator.add(selectClosestValue(values[index], that._values), that._minRange, -dir), -dir);\r\n            if (compare(secondPosition, thresholdPosition)) {\r\n                values[1 - index] = translator.add(values[index], that._minRange, -dir)\r\n            }\r\n            thresholdPosition = translator.to(translator.add(translator.getRange()[1 - index], that._minRange, dir), -dir);\r\n            if (antiCompare(firstPosition, thresholdPosition)) {\r\n                values[1 - index] = translator.getRange()[1 - index];\r\n                values[index] = translator.add(values[1 - index], that._minRange, dir);\r\n                positions[1 - index] = firstPosition\r\n            }\r\n        }\r\n        values[0] = selectClosestValue(values[0], that._values);\r\n        values[1] = selectClosestValue(values[1], that._values);\r\n        positions[index] = translator.to(values[index], dir);\r\n        sliders[0].setDisplayValue(values[0]);\r\n        sliders[1].setDisplayValue(values[1]);\r\n        sliders[0]._position = positions[0];\r\n        sliders[1]._position = positions[1];\r\n        that._applyTotalPosition(true);\r\n        if (that._isOnMoving) {\r\n            that._processSelectionChanged(e)\r\n        }\r\n        handler = that.beginSliderMoving(1 - index, secondPosition);\r\n        sliders[1 - index]._sliderGroup.stopAnimation();\r\n        that._shutter.stopAnimation();\r\n        handler(secondPosition);\r\n        return handler\r\n    },\r\n    beginSliderMoving: function(initialIndex, initialPosition) {\r\n        var that = this;\r\n        var translator = that._params.translator;\r\n        var sliders = that._sliders;\r\n        var minPosition = translator.getScreenRange()[0];\r\n        var maxPosition = translator.getScreenRange()[1];\r\n        var index = initialIndex;\r\n        var staticPosition = sliders[1 - index].getPosition();\r\n        var currentPosition = initialPosition;\r\n        var dir = index > 0 ? 1 : -1;\r\n        var compareMin = index > 0 ? isLess : isGreater;\r\n        var compareMax = index > 0 ? isGreater : isLess;\r\n        var moveOffset = sliders[index].getPosition() - initialPosition;\r\n        var swapOffset = compareMin(sliders[index].getPosition(), initialPosition) ? -moveOffset : moveOffset;\r\n        move.complete = function(e) {\r\n            sliders[index]._setValid(true);\r\n            that._dockSelectedArea(e)\r\n        };\r\n        return move;\r\n\r\n        function move(position, e) {\r\n            var isValid;\r\n            var temp;\r\n            var pos;\r\n            var slider;\r\n            var value;\r\n            if (position !== currentPosition) {\r\n                if (compareMin(position + swapOffset, staticPosition)) {\r\n                    isValid = that._allowSlidersSwap;\r\n                    if (isValid && !translator.isValueProlonged && that._minRange) {\r\n                        isValid = translator.isValid(translator.add(sliders[1 - index].getValue(), that._minRange, -dir))\r\n                    }\r\n                    if (isValid) {\r\n                        that._changeMovingSlider(index);\r\n                        index = 1 - index;\r\n                        dir = -dir;\r\n                        temp = compareMin;\r\n                        compareMin = compareMax;\r\n                        compareMax = temp;\r\n                        moveOffset = -dir * Math.abs(moveOffset);\r\n                        swapOffset = -moveOffset\r\n                    }\r\n                }\r\n                if (compareMax(position + moveOffset, staticPosition)) {\r\n                    isValid = true;\r\n                    slider = sliders[index];\r\n                    value = sliders[1 - index].getValue();\r\n                    pos = Math.max(Math.min(position + moveOffset, maxPosition), minPosition);\r\n                    if (isValid && translator.isValueProlonged) {\r\n                        isValid = !compareMin(pos, translator.to(value, dir))\r\n                    }\r\n                    if (isValid && that._minRange) {\r\n                        isValid = !compareMin(pos, translator.to(translator.add(value, that._minRange, dir), dir))\r\n                    }\r\n                    if (isValid && that._maxRange) {\r\n                        isValid = !compareMax(pos, translator.to(translator.add(value, that._maxRange, dir), dir))\r\n                    }\r\n                    slider._setValid(isValid);\r\n                    slider.setDisplayValue(isValid ? selectClosestValue(translator.from(pos, dir), that._values) : slider.getValue());\r\n                    slider._position = pos;\r\n                    that._applyTotalPosition(false);\r\n                    slider.toForeground();\r\n                    if (that._isOnMoving) {\r\n                        that._processSelectionChanged(e)\r\n                    }\r\n                }\r\n            }\r\n            currentPosition = position\r\n        }\r\n    },\r\n    _changeMovingSlider: function(index) {\r\n        var that = this;\r\n        var translator = that._params.translator;\r\n        var sliders = that._sliders;\r\n        var position = sliders[1 - index].getPosition();\r\n        var dir = index > 0 ? 1 : -1;\r\n        var newValue;\r\n        sliders[index].setDisplayValue(selectClosestValue(translator.from(position, dir), that._values));\r\n        newValue = translator.from(position, -dir);\r\n        if (translator.isValueProlonged) {\r\n            newValue = translator.from(position, dir)\r\n        } else {\r\n            if (that._minRange) {\r\n                newValue = translator.add(newValue, that._minRange, -dir)\r\n            }\r\n        }\r\n        sliders[1 - index].setDisplayValue(selectClosestValue(newValue, that._values));\r\n        sliders[index]._setValid(true);\r\n        sliders[index]._marker._update();\r\n        sliders[0]._position = sliders[1]._position = position\r\n    },\r\n    foregroundSlider: function(index) {\r\n        this._sliders[index].toForeground()\r\n    }\r\n};\r\nexports.SlidersController = SlidersController;\r\n"]},"metadata":{},"sourceType":"module"}