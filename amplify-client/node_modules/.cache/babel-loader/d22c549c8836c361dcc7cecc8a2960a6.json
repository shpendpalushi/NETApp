{"ast":null,"code":"/**\r\n * DevExtreme (ui/filter_builder/filter_builder.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar _renderer = require(\"../../core/renderer\");\n\nvar _renderer2 = _interopRequireDefault(_renderer);\n\nvar _dom_adapter = require(\"../../core/dom_adapter\");\n\nvar _dom_adapter2 = _interopRequireDefault(_dom_adapter);\n\nvar _class = require(\"../../core/class\");\n\nvar _class2 = _interopRequireDefault(_class);\n\nvar _events_engine = require(\"../../events/core/events_engine\");\n\nvar _events_engine2 = _interopRequireDefault(_events_engine);\n\nvar _ui = require(\"../widget/ui.widget\");\n\nvar _ui2 = _interopRequireDefault(_ui);\n\nvar _component_registrator = require(\"../../core/component_registrator\");\n\nvar _component_registrator2 = _interopRequireDefault(_component_registrator);\n\nvar _extend = require(\"../../core/utils/extend\");\n\nvar _message = require(\"../../localization/message\");\n\nvar _message2 = _interopRequireDefault(_message);\n\nvar _utils = require(\"./utils\");\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nvar _deferred = require(\"../../core/utils/deferred\");\n\nvar _deferred2 = _interopRequireDefault(_deferred);\n\nvar _type = require(\"../../core/utils/type\");\n\nvar _tree_view = require(\"../tree_view\");\n\nvar _tree_view2 = _interopRequireDefault(_tree_view);\n\nvar _popup = require(\"../popup\");\n\nvar _popup2 = _interopRequireDefault(_popup);\n\nvar _utils3 = require(\"../overlay/utils\");\n\nvar _ui3 = require(\"../shared/ui.editor_factory_mixin\");\n\nvar _ui4 = _interopRequireDefault(_ui3);\n\nvar _utils4 = require(\"../../events/utils\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nvar FILTER_BUILDER_CLASS = \"dx-filterbuilder\";\nvar FILTER_BUILDER_GROUP_CLASS = FILTER_BUILDER_CLASS + \"-group\";\nvar FILTER_BUILDER_GROUP_ITEM_CLASS = FILTER_BUILDER_GROUP_CLASS + \"-item\";\nvar FILTER_BUILDER_GROUP_CONTENT_CLASS = FILTER_BUILDER_GROUP_CLASS + \"-content\";\nvar FILTER_BUILDER_GROUP_OPERATIONS_CLASS = FILTER_BUILDER_GROUP_CLASS + \"-operations\";\nvar FILTER_BUILDER_GROUP_OPERATION_CLASS = FILTER_BUILDER_GROUP_CLASS + \"-operation\";\nvar FILTER_BUILDER_ACTION_CLASS = FILTER_BUILDER_CLASS + \"-action\";\nvar FILTER_BUILDER_IMAGE_CLASS = FILTER_BUILDER_ACTION_CLASS + \"-icon\";\nvar FILTER_BUILDER_IMAGE_ADD_CLASS = \"dx-icon-plus\";\nvar FILTER_BUILDER_IMAGE_REMOVE_CLASS = \"dx-icon-remove\";\nvar FILTER_BUILDER_ITEM_TEXT_CLASS = FILTER_BUILDER_CLASS + \"-text\";\nvar FILTER_BUILDER_ITEM_TEXT_PART_CLASS = FILTER_BUILDER_ITEM_TEXT_CLASS + \"-part\";\nvar FILTER_BUILDER_ITEM_TEXT_SEPARATOR_CLASS = FILTER_BUILDER_ITEM_TEXT_CLASS + \"-separator\";\nvar FILTER_BUILDER_ITEM_TEXT_SEPARATOR_EMPTY_CLASS = FILTER_BUILDER_ITEM_TEXT_SEPARATOR_CLASS + \"-empty\";\nvar FILTER_BUILDER_ITEM_FIELD_CLASS = FILTER_BUILDER_CLASS + \"-item-field\";\nvar FILTER_BUILDER_ITEM_OPERATION_CLASS = FILTER_BUILDER_CLASS + \"-item-operation\";\nvar FILTER_BUILDER_ITEM_VALUE_CLASS = FILTER_BUILDER_CLASS + \"-item-value\";\nvar FILTER_BUILDER_ITEM_VALUE_TEXT_CLASS = FILTER_BUILDER_CLASS + \"-item-value-text\";\nvar FILTER_BUILDER_OVERLAY_CLASS = FILTER_BUILDER_CLASS + \"-overlay\";\nvar FILTER_BUILDER_FILTER_OPERATIONS_CLASS = FILTER_BUILDER_CLASS + \"-operations\";\nvar FILTER_BUILDER_FIELDS_CLASS = FILTER_BUILDER_CLASS + \"-fields\";\nvar FILTER_BUILDER_ADD_CONDITION_CLASS = FILTER_BUILDER_CLASS + \"-add-condition\";\nvar ACTIVE_CLASS = \"dx-state-active\";\nvar FILTER_BUILDER_MENU_CUSTOM_OPERATION_CLASS = FILTER_BUILDER_CLASS + \"-menu-custom-operation\";\nvar SOURCE = \"filterBuilder\";\nvar DISABLED_STATE_CLASS = \"dx-state-disabled\";\nvar TAB_KEY = \"tab\";\nvar ENTER_KEY = \"enter\";\nvar ESCAPE_KEY = \"escape\";\nvar ACTIONS = [{\n  name: \"onEditorPreparing\",\n  config: {\n    excludeValidators: [\"disabled\", \"readOnly\"],\n    category: \"rendering\"\n  }\n}, {\n  name: \"onEditorPrepared\",\n  config: {\n    excludeValidators: [\"disabled\", \"readOnly\"],\n    category: \"rendering\"\n  }\n}, {\n  name: \"onValueChanged\",\n  config: {\n    excludeValidators: [\"disabled\", \"readOnly\"]\n  }\n}];\nvar OPERATORS = {\n  and: \"and\",\n  or: \"or\",\n  notAnd: \"!and\",\n  notOr: \"!or\"\n};\n\nvar EditorFactory = _class2.default.inherit(_ui4.default);\n\nvar renderValueText = function renderValueText($container, value, customOperation) {\n  if (Array.isArray(value)) {\n    var lastItemIndex = value.length - 1;\n    $container.empty();\n    value.forEach(function (t, i) {\n      (0, _renderer2.default)(\"<span>\").addClass(FILTER_BUILDER_ITEM_TEXT_PART_CLASS).text(t).appendTo($container);\n\n      if (i !== lastItemIndex) {\n        (0, _renderer2.default)(\"<span>\").addClass(FILTER_BUILDER_ITEM_TEXT_SEPARATOR_CLASS).text(customOperation && customOperation.valueSeparator ? customOperation.valueSeparator : \"|\").addClass(FILTER_BUILDER_ITEM_TEXT_SEPARATOR_EMPTY_CLASS).appendTo($container);\n      }\n    });\n  } else {\n    if (value) {\n      $container.text(value);\n    } else {\n      $container.text(_message2.default.format(\"dxFilterBuilder-enterValueText\"));\n    }\n  }\n};\n\nvar FilterBuilder = _ui2.default.inherit({\n  _getDefaultOptions: function _getDefaultOptions() {\n    return (0, _extend.extend)(this.callBase(), {\n      onEditorPreparing: null,\n      onEditorPrepared: null,\n      onValueChanged: null,\n      fields: [],\n      defaultGroupOperation: \"and\",\n      groupOperations: [\"and\", \"or\", \"notAnd\", \"notOr\"],\n      maxGroupLevel: void 0,\n      value: null,\n      allowHierarchicalFields: false,\n      groupOperationDescriptions: {\n        and: _message2.default.format(\"dxFilterBuilder-and\"),\n        or: _message2.default.format(\"dxFilterBuilder-or\"),\n        notAnd: _message2.default.format(\"dxFilterBuilder-notAnd\"),\n        notOr: _message2.default.format(\"dxFilterBuilder-notOr\")\n      },\n      customOperations: [],\n      closePopupOnTargetScroll: true,\n      filterOperationDescriptions: {\n        between: _message2.default.format(\"dxFilterBuilder-filterOperationBetween\"),\n        equal: _message2.default.format(\"dxFilterBuilder-filterOperationEquals\"),\n        notEqual: _message2.default.format(\"dxFilterBuilder-filterOperationNotEquals\"),\n        lessThan: _message2.default.format(\"dxFilterBuilder-filterOperationLess\"),\n        lessThanOrEqual: _message2.default.format(\"dxFilterBuilder-filterOperationLessOrEquals\"),\n        greaterThan: _message2.default.format(\"dxFilterBuilder-filterOperationGreater\"),\n        greaterThanOrEqual: _message2.default.format(\"dxFilterBuilder-filterOperationGreaterOrEquals\"),\n        startsWith: _message2.default.format(\"dxFilterBuilder-filterOperationStartsWith\"),\n        contains: _message2.default.format(\"dxFilterBuilder-filterOperationContains\"),\n        notContains: _message2.default.format(\"dxFilterBuilder-filterOperationNotContains\"),\n        endsWith: _message2.default.format(\"dxFilterBuilder-filterOperationEndsWith\"),\n        isBlank: _message2.default.format(\"dxFilterBuilder-filterOperationIsBlank\"),\n        isNotBlank: _message2.default.format(\"dxFilterBuilder-filterOperationIsNotBlank\")\n      }\n    });\n  },\n  _optionChanged: function _optionChanged(args) {\n    switch (args.name) {\n      case \"closePopupOnTargetScroll\":\n        break;\n\n      case \"onEditorPreparing\":\n      case \"onEditorPrepared\":\n      case \"onValueChanged\":\n        this._initActions();\n\n        break;\n\n      case \"customOperations\":\n        this._initCustomOperations();\n\n        this._invalidate();\n\n        break;\n\n      case \"fields\":\n      case \"defaultGroupOperation\":\n      case \"maxGroupLevel\":\n      case \"groupOperations\":\n      case \"allowHierarchicalFields\":\n      case \"groupOperationDescriptions\":\n      case \"filterOperationDescriptions\":\n        this._invalidate();\n\n        break;\n\n      case \"value\":\n        if (args.value !== args.previousValue) {\n          var disableInvalidateForValue = this._disableInvalidateForValue;\n\n          if (!disableInvalidateForValue) {\n            this._initModel();\n\n            this._invalidate();\n          }\n\n          this._disableInvalidateForValue = false;\n          this.executeAction(\"onValueChanged\", {\n            value: args.value,\n            previousValue: args.previousValue\n          });\n          this._disableInvalidateForValue = disableInvalidateForValue;\n        }\n\n        break;\n\n      default:\n        this.callBase(args);\n    }\n  },\n  getFilterExpression: function getFilterExpression() {\n    var fields = this._getNormalizedFields();\n\n    var value = (0, _extend.extend)(true, [], this._model);\n    return _utils2.default.getFilterExpression(_utils2.default.getNormalizedFilter(value), fields, this._customOperations, SOURCE);\n  },\n  _getNormalizedFields: function _getNormalizedFields() {\n    return _utils2.default.getNormalizedFields(this.option(\"fields\"));\n  },\n  _updateFilter: function _updateFilter() {\n    this._disableInvalidateForValue = true;\n    var value = (0, _extend.extend)(true, [], this._model);\n\n    var normalizedValue = _utils2.default.getNormalizedFilter(value);\n\n    var oldValue = _utils2.default.getNormalizedFilter(this._getModel(this.option(\"value\")));\n\n    if (JSON.stringify(oldValue) !== JSON.stringify(normalizedValue)) {\n      this.option(\"value\", normalizedValue);\n    }\n\n    this._disableInvalidateForValue = false;\n\n    this._fireContentReadyAction();\n  },\n  _init: function _init() {\n    this._initCustomOperations();\n\n    this._initModel();\n\n    this._initEditorFactory();\n\n    this._initActions();\n\n    this.callBase();\n  },\n  _initEditorFactory: function _initEditorFactory() {\n    this._editorFactory = new EditorFactory();\n  },\n  _initCustomOperations: function _initCustomOperations() {\n    this._customOperations = _utils2.default.getMergedOperations(this.option(\"customOperations\"), this.option(\"filterOperationDescriptions.between\"));\n  },\n  _getModel: function _getModel(value) {\n    return _utils2.default.convertToInnerStructure(value, this._customOperations);\n  },\n  _initModel: function _initModel() {\n    this._model = this._getModel(this.option(\"value\"));\n  },\n  _initActions: function _initActions() {\n    var that = this;\n    that._actions = {};\n    ACTIONS.forEach(function (action) {\n      that._actions[action.name] = that._createActionByOption(action.name, action.config);\n    });\n  },\n  executeAction: function executeAction(actionName, options) {\n    var action = this._actions[actionName];\n    return action && action(options);\n  },\n  _initMarkup: function _initMarkup() {\n    this.$element().addClass(FILTER_BUILDER_CLASS);\n    this.callBase();\n\n    this._createGroupElementByCriteria(this._model).appendTo(this.$element());\n  },\n  _createConditionElement: function _createConditionElement(condition, parent) {\n    return (0, _renderer2.default)(\"<div>\").addClass(FILTER_BUILDER_GROUP_CLASS).append(this._createConditionItem(condition, parent));\n  },\n  _createGroupElementByCriteria: function _createGroupElementByCriteria(criteria, parent) {\n    var groupLevel = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 0;\n\n    var $group = this._createGroupElement(criteria, parent, groupLevel);\n\n    var $groupContent = $group.find(\".\" + FILTER_BUILDER_GROUP_CONTENT_CLASS);\n\n    var groupCriteria = _utils2.default.getGroupCriteria(criteria);\n\n    for (var i = 0; i < groupCriteria.length; i++) {\n      var innerCriteria = groupCriteria[i];\n\n      if (_utils2.default.isGroup(innerCriteria)) {\n        this._createGroupElementByCriteria(innerCriteria, groupCriteria, groupLevel + 1).appendTo($groupContent);\n      } else {\n        if (_utils2.default.isCondition(innerCriteria)) {\n          this._createConditionElement(innerCriteria, groupCriteria).appendTo($groupContent);\n        }\n      }\n    }\n\n    return $group;\n  },\n  _createGroupElement: function _createGroupElement(criteria, parent, groupLevel) {\n    var _this = this;\n\n    var $groupItem = (0, _renderer2.default)(\"<div>\").addClass(FILTER_BUILDER_GROUP_ITEM_CLASS);\n    var $groupContent = (0, _renderer2.default)(\"<div>\").addClass(FILTER_BUILDER_GROUP_CONTENT_CLASS);\n    var $group = (0, _renderer2.default)(\"<div>\").addClass(FILTER_BUILDER_GROUP_CLASS).append($groupItem).append($groupContent);\n\n    if (null != parent) {\n      this._createRemoveButton(function () {\n        _utils2.default.removeItem(parent, criteria);\n\n        $group.remove();\n\n        _this._updateFilter();\n      }).appendTo($groupItem);\n    }\n\n    this._createGroupOperationButton(criteria).appendTo($groupItem);\n\n    this._createAddButton(function () {\n      var newGroup = _utils2.default.createEmptyGroup(_this.option(\"defaultGroupOperation\"));\n\n      _utils2.default.addItem(newGroup, criteria);\n\n      _this._createGroupElement(newGroup, criteria, groupLevel + 1).appendTo($groupContent);\n\n      _this._updateFilter();\n    }, function () {\n      var field = _this.option(\"fields\")[0];\n\n      var newCondition = _utils2.default.createCondition(field, _this._customOperations);\n\n      _utils2.default.addItem(newCondition, criteria);\n\n      _this._createConditionElement(newCondition, criteria).appendTo($groupContent);\n\n      _this._updateFilter();\n    }, groupLevel).appendTo($groupItem);\n\n    return $group;\n  },\n  _createButton: function _createButton(caption) {\n    return (0, _renderer2.default)(\"<div>\").text(caption);\n  },\n  _createGroupOperationButton: function _createGroupOperationButton(criteria) {\n    var _this2 = this;\n\n    var groupOperations = this._getGroupOperations(criteria);\n\n    var groupMenuItem = _utils2.default.getGroupMenuItem(criteria, groupOperations);\n\n    var caption = groupMenuItem.text;\n    var $operationButton = groupOperations && groupOperations.length < 2 ? this._createButton(caption).addClass(DISABLED_STATE_CLASS) : this._createButtonWithMenu({\n      caption: caption,\n      menu: {\n        items: groupOperations,\n        displayExpr: \"text\",\n        keyExpr: \"value\",\n        onItemClick: function onItemClick(e) {\n          if (groupMenuItem !== e.itemData) {\n            _utils2.default.setGroupValue(criteria, e.itemData.value);\n\n            $operationButton.html(e.itemData.text);\n            groupMenuItem = e.itemData;\n\n            _this2._updateFilter();\n          }\n        },\n        onContentReady: function onContentReady(e) {\n          e.component.selectItem(groupMenuItem);\n        },\n        cssClass: FILTER_BUILDER_GROUP_OPERATIONS_CLASS\n      }\n    });\n    return $operationButton.addClass(FILTER_BUILDER_ITEM_TEXT_CLASS).addClass(FILTER_BUILDER_GROUP_OPERATION_CLASS).attr(\"tabindex\", 0);\n  },\n  _createButtonWithMenu: function _createButtonWithMenu(options) {\n    var that = this;\n\n    var removeMenu = function removeMenu() {\n      that.$element().find(\".\" + ACTIVE_CLASS).removeClass(ACTIVE_CLASS);\n      that.$element().find(\".dx-overlay .dx-treeview\").remove();\n      that.$element().find(\".dx-overlay\").remove();\n    };\n\n    var rtlEnabled = this.option(\"rtlEnabled\");\n\n    var menuOnItemClickWrapper = function menuOnItemClickWrapper(handler) {\n      return function (e) {\n        handler(e);\n\n        if (\"dxclick\" === e.event.type) {\n          removeMenu();\n        }\n      };\n    };\n\n    var position = rtlEnabled ? \"right\" : \"left\";\n\n    var $button = this._createButton(options.caption);\n\n    (0, _extend.extend)(options.menu, {\n      focusStateEnabled: true,\n      selectionMode: \"single\",\n      onItemClick: menuOnItemClickWrapper(options.menu.onItemClick),\n      onHiding: function onHiding(e) {\n        $button.removeClass(ACTIVE_CLASS);\n      },\n      position: {\n        my: position + \" top\",\n        at: position + \" bottom\",\n        offset: \"0 1\",\n        of: $button,\n        collision: \"flip\"\n      },\n      animation: null,\n      onHidden: function onHidden() {\n        removeMenu();\n      },\n      cssClass: FILTER_BUILDER_OVERLAY_CLASS + \" \" + options.menu.cssClass,\n      rtlEnabled: rtlEnabled\n    });\n    options.popup = {\n      onShown: function onShown(info) {\n        var treeViewElement = (0, _renderer2.default)(info.component.content()).find(\".dx-treeview\");\n        var treeView = treeViewElement.dxTreeView(\"instance\");\n\n        _events_engine2.default.on(treeViewElement, \"keyup keydown\", function (e) {\n          var keyName = (0, _utils4.normalizeKeyName)(e);\n\n          if (\"keydown\" === e.type && keyName === TAB_KEY || \"keyup\" === e.type && (keyName === ESCAPE_KEY || keyName === ENTER_KEY)) {\n            info.component.hide();\n\n            _events_engine2.default.trigger(options.menu.position.of, \"focus\");\n          }\n        });\n\n        treeView.focus();\n        treeView.option(\"focusedElement\", null);\n      }\n    };\n\n    this._subscribeOnClickAndEnterKey($button, function () {\n      removeMenu();\n\n      that._createPopupWithTreeView(options, that.$element());\n\n      $button.addClass(ACTIVE_CLASS);\n    });\n\n    return $button;\n  },\n  _hasValueButton: function _hasValueButton(condition) {\n    var customOperation = _utils2.default.getCustomOperation(this._customOperations, condition[1]);\n\n    return customOperation ? false !== customOperation.hasValue : null !== condition[2];\n  },\n  _createOperationButtonWithMenu: function _createOperationButtonWithMenu(condition, field) {\n    var _this3 = this;\n\n    var that = this;\n\n    var availableOperations = _utils2.default.getAvailableOperations(field, this.option(\"filterOperationDescriptions\"), this._customOperations);\n\n    var currentOperation = _utils2.default.getOperationFromAvailable(_utils2.default.getOperationValue(condition), availableOperations);\n\n    var $operationButton = this._createButtonWithMenu({\n      caption: currentOperation.text,\n      menu: {\n        items: availableOperations,\n        displayExpr: \"text\",\n        onItemRendered: function onItemRendered(e) {\n          e.itemData.isCustom && (0, _renderer2.default)(e.itemElement).addClass(FILTER_BUILDER_MENU_CUSTOM_OPERATION_CLASS);\n        },\n        onContentReady: function onContentReady(e) {\n          e.component.selectItem(currentOperation);\n        },\n        onItemClick: function onItemClick(e) {\n          if (currentOperation !== e.itemData) {\n            currentOperation = e.itemData;\n\n            _utils2.default.updateConditionByOperation(condition, currentOperation.value, that._customOperations);\n\n            var $valueButton = $operationButton.siblings().filter(\".\" + FILTER_BUILDER_ITEM_VALUE_CLASS);\n\n            if (that._hasValueButton(condition)) {\n              if (0 !== $valueButton.length) {\n                $valueButton.remove();\n              }\n\n              that._createValueButton(condition, field).appendTo($operationButton.parent());\n            } else {\n              $valueButton.remove();\n            }\n\n            $operationButton.html(currentOperation.text);\n\n            _this3._updateFilter();\n          }\n        },\n        cssClass: FILTER_BUILDER_FILTER_OPERATIONS_CLASS\n      }\n    }).addClass(FILTER_BUILDER_ITEM_TEXT_CLASS).addClass(FILTER_BUILDER_ITEM_OPERATION_CLASS).attr(\"tabindex\", 0);\n\n    return $operationButton;\n  },\n  _createOperationAndValueButtons: function _createOperationAndValueButtons(condition, field, $item) {\n    this._createOperationButtonWithMenu(condition, field).appendTo($item);\n\n    if (this._hasValueButton(condition)) {\n      this._createValueButton(condition, field).appendTo($item);\n    }\n  },\n  _createFieldButtonWithMenu: function _createFieldButtonWithMenu(fields, condition, field) {\n    var _this4 = this;\n\n    var that = this;\n    var allowHierarchicalFields = this.option(\"allowHierarchicalFields\");\n\n    var items = _utils2.default.getItems(fields, allowHierarchicalFields);\n\n    var item = _utils2.default.getField(field.name || field.dataField, items);\n\n    var getFullCaption = function getFullCaption(item, items) {\n      return allowHierarchicalFields ? _utils2.default.getCaptionWithParents(item, items) : item.caption;\n    };\n\n    var $fieldButton = this._createButtonWithMenu({\n      caption: getFullCaption(item, items),\n      menu: {\n        items: items,\n        dataStructure: \"plain\",\n        keyExpr: \"id\",\n        parentId: \"parentId\",\n        displayExpr: \"caption\",\n        onItemClick: function onItemClick(e) {\n          if (item !== e.itemData) {\n            item = e.itemData;\n            condition[0] = item.name || item.dataField;\n            condition[2] = \"object\" === item.dataType ? null : \"\";\n\n            _utils2.default.updateConditionByOperation(condition, _utils2.default.getDefaultOperation(item), that._customOperations);\n\n            $fieldButton.siblings().filter(\".\" + FILTER_BUILDER_ITEM_TEXT_CLASS).remove();\n\n            that._createOperationAndValueButtons(condition, item, $fieldButton.parent());\n\n            var caption = getFullCaption(item, e.component.option(\"items\"));\n            $fieldButton.html(caption);\n\n            _this4._updateFilter();\n          }\n        },\n        onContentReady: function onContentReady(e) {\n          e.component.selectItem(item);\n        },\n        cssClass: FILTER_BUILDER_FIELDS_CLASS\n      }\n    }).addClass(FILTER_BUILDER_ITEM_TEXT_CLASS).addClass(FILTER_BUILDER_ITEM_FIELD_CLASS).attr(\"tabindex\", 0);\n\n    return $fieldButton;\n  },\n  _createConditionItem: function _createConditionItem(condition, parent) {\n    var _this5 = this;\n\n    var $item = (0, _renderer2.default)(\"<div>\").addClass(FILTER_BUILDER_GROUP_ITEM_CLASS);\n\n    var fields = this._getNormalizedFields();\n\n    var field = _utils2.default.getField(condition[0], fields);\n\n    this._createRemoveButton(function () {\n      _utils2.default.removeItem(parent, condition);\n\n      var isSingleChild = 1 === $item.parent().children().length;\n\n      if (isSingleChild) {\n        $item.parent().remove();\n      } else {\n        $item.remove();\n      }\n\n      _this5._updateFilter();\n    }).appendTo($item);\n\n    this._createFieldButtonWithMenu(fields, condition, field).appendTo($item);\n\n    this._createOperationAndValueButtons(condition, field, $item);\n\n    return $item;\n  },\n  _getGroupOperations: function _getGroupOperations(criteria) {\n    var groupOperations = this.option(\"groupOperations\");\n    var groupOperationDescriptions = this.option(\"groupOperationDescriptions\");\n\n    if (!groupOperations || !groupOperations.length) {\n      groupOperations = [_utils2.default.getGroupValue(criteria).replace(\"!\", \"not\")];\n    }\n\n    return groupOperations.map(function (operation) {\n      return {\n        text: groupOperationDescriptions[operation],\n        value: OPERATORS[operation]\n      };\n    });\n  },\n  _createRemoveButton: function _createRemoveButton(handler) {\n    var $removeButton = (0, _renderer2.default)(\"<div>\").addClass(FILTER_BUILDER_IMAGE_CLASS).addClass(FILTER_BUILDER_IMAGE_REMOVE_CLASS).addClass(FILTER_BUILDER_ACTION_CLASS).attr(\"tabindex\", 0);\n\n    this._subscribeOnClickAndEnterKey($removeButton, handler);\n\n    return $removeButton;\n  },\n  _createAddButton: function _createAddButton(addGroupHandler, addConditionHandler, groupLevel) {\n    var $button;\n    var maxGroupLevel = this.option(\"maxGroupLevel\");\n\n    if ((0, _type.isDefined)(maxGroupLevel) && groupLevel >= maxGroupLevel) {\n      $button = this._createButton();\n\n      this._subscribeOnClickAndEnterKey($button, addConditionHandler);\n    } else {\n      $button = this._createButtonWithMenu({\n        menu: {\n          items: [{\n            caption: _message2.default.format(\"dxFilterBuilder-addCondition\"),\n            click: addConditionHandler\n          }, {\n            caption: _message2.default.format(\"dxFilterBuilder-addGroup\"),\n            click: addGroupHandler\n          }],\n          displayExpr: \"caption\",\n          onItemClick: function onItemClick(e) {\n            e.itemData.click();\n          },\n          cssClass: FILTER_BUILDER_ADD_CONDITION_CLASS\n        }\n      });\n    }\n\n    return $button.addClass(FILTER_BUILDER_IMAGE_CLASS).addClass(FILTER_BUILDER_IMAGE_ADD_CLASS).addClass(FILTER_BUILDER_ACTION_CLASS).attr(\"tabindex\", 0);\n  },\n  _createValueText: function _createValueText(item, field, $container) {\n    var that = this;\n    var $text = (0, _renderer2.default)(\"<div>\").html(\"&nbsp;\").addClass(FILTER_BUILDER_ITEM_VALUE_TEXT_CLASS).attr(\"tabindex\", 0).appendTo($container);\n    var value = item[2];\n\n    var customOperation = _utils2.default.getCustomOperation(that._customOperations, item[1]);\n\n    if (!customOperation && field.lookup) {\n      _utils2.default.getCurrentLookupValueText(field, value, function (result) {\n        renderValueText($text, result);\n      });\n    } else {\n      _deferred2.default.when(_utils2.default.getCurrentValueText(field, value, customOperation)).done(function (result) {\n        renderValueText($text, result, customOperation);\n      });\n    }\n\n    that._subscribeOnClickAndEnterKey($text, function (e) {\n      if (\"keyup\" === e.type) {\n        e.stopPropagation();\n      }\n\n      that._createValueEditorWithEvents(item, field, $container);\n    });\n\n    return $text;\n  },\n  _updateConditionValue: function _updateConditionValue(item, value, callback) {\n    var areValuesDifferent = item[2] !== value;\n\n    if (areValuesDifferent) {\n      item[2] = value;\n    }\n\n    callback();\n\n    this._updateFilter();\n  },\n  _addDocumentKeyUp: function _addDocumentKeyUp($editor, handler) {\n    var document = _dom_adapter2.default.getDocument();\n\n    var documentKeyUpHandler = function documentKeyUpHandler(e) {\n      if (isComposing || hasCompositionJustEnded) {\n        hasCompositionJustEnded = false;\n        return;\n      }\n\n      handler(e);\n    };\n\n    _events_engine2.default.on(document, \"keyup\", documentKeyUpHandler);\n\n    var isComposing = false;\n    var hasCompositionJustEnded = false;\n    var input = $editor.find(\"input\");\n\n    _events_engine2.default.on(input, \"compositionstart\", function () {\n      isComposing = true;\n    });\n\n    _events_engine2.default.on(input, \"compositionend\", function () {\n      isComposing = false;\n      hasCompositionJustEnded = true;\n    });\n\n    _events_engine2.default.on(input, \"keydown\", function (event) {\n      if (229 !== event.which) {\n        hasCompositionJustEnded = false;\n      }\n    });\n\n    this._documentKeyUpHandler = documentKeyUpHandler;\n  },\n  _addDocumentClick: function _addDocumentClick($editor, closeEditorFunc) {\n    var _this6 = this;\n\n    var document = _dom_adapter2.default.getDocument();\n\n    var documentClickHandler = function documentClickHandler(e) {\n      if (!_this6._isFocusOnEditorParts($editor, e.target)) {\n        _events_engine2.default.trigger($editor.find(\"input\"), \"change\");\n\n        closeEditorFunc();\n      }\n    };\n\n    _events_engine2.default.on(document, \"dxpointerdown\", documentClickHandler);\n\n    this._documentClickHandler = documentClickHandler;\n  },\n  _isFocusOnEditorParts: function _isFocusOnEditorParts($editor, target) {\n    var activeElement = target || _dom_adapter2.default.getActiveElement();\n\n    return (0, _renderer2.default)(activeElement).closest($editor.children()).length || (0, _renderer2.default)(activeElement).closest(\".dx-dropdowneditor-overlay\").length;\n  },\n  _removeEvents: function _removeEvents() {\n    var document = _dom_adapter2.default.getDocument();\n\n    (0, _type.isDefined)(this._documentKeyUpHandler) && _events_engine2.default.off(document, \"keyup\", this._documentKeyUpHandler);\n    (0, _type.isDefined)(this._documentClickHandler) && _events_engine2.default.off(document, \"dxpointerdown\", this._documentClickHandler);\n  },\n  _dispose: function _dispose() {\n    this._removeEvents();\n\n    this.callBase();\n  },\n  _createValueEditorWithEvents: function _createValueEditorWithEvents(item, field, $container) {\n    var _this7 = this;\n\n    var value = item[2];\n\n    var createValueText = function createValueText() {\n      $container.empty();\n\n      _this7._removeEvents();\n\n      return _this7._createValueText(item, field, $container);\n    };\n\n    var closeEditor = function closeEditor() {\n      _this7._updateConditionValue(item, value, function () {\n        createValueText();\n      });\n    };\n\n    var options = {\n      value: \"\" === value ? null : value,\n      filterOperation: _utils2.default.getOperationValue(item),\n      setValue: function setValue(data) {\n        value = null === data ? \"\" : data;\n      },\n      closeEditor: closeEditor,\n      text: $container.text()\n    };\n    $container.empty();\n\n    var $editor = this._createValueEditor($container, field, options);\n\n    _events_engine2.default.trigger($editor.find(\"input\").not(\":hidden\").eq(0), \"focus\");\n\n    this._removeEvents();\n\n    this._addDocumentClick($editor, closeEditor);\n\n    this._addDocumentKeyUp($editor, function (e) {\n      var keyName = (0, _utils4.normalizeKeyName)(e);\n\n      if (keyName === TAB_KEY) {\n        if (_this7._isFocusOnEditorParts($editor)) {\n          return;\n        }\n\n        _this7._updateConditionValue(item, value, function () {\n          createValueText();\n\n          if (e.shiftKey) {\n            _events_engine2.default.trigger($container.prev(), \"focus\");\n          }\n        });\n      }\n\n      if (keyName === ESCAPE_KEY) {\n        _events_engine2.default.trigger(createValueText(), \"focus\");\n      }\n\n      if (keyName === ENTER_KEY) {\n        _this7._updateConditionValue(item, value, function () {\n          _events_engine2.default.trigger(createValueText(), \"focus\");\n        });\n      }\n    });\n\n    this._fireContentReadyAction();\n  },\n  _createValueButton: function _createValueButton(item, field) {\n    var $valueButton = (0, _renderer2.default)(\"<div>\").addClass(FILTER_BUILDER_ITEM_TEXT_CLASS).addClass(FILTER_BUILDER_ITEM_VALUE_CLASS);\n\n    this._createValueText(item, field, $valueButton);\n\n    return $valueButton;\n  },\n  _createValueEditor: function _createValueEditor($container, field, options) {\n    var $editor = (0, _renderer2.default)(\"<div>\").attr(\"tabindex\", 0).appendTo($container);\n\n    var customOperation = _utils2.default.getCustomOperation(this._customOperations, options.filterOperation);\n\n    var editorTemplate = customOperation && customOperation.editorTemplate ? customOperation.editorTemplate : field.editorTemplate;\n\n    if (editorTemplate) {\n      var template = this._getTemplate(editorTemplate);\n\n      template.render({\n        model: (0, _extend.extend)({\n          field: field\n        }, options),\n        container: $editor\n      });\n    } else {\n      this._editorFactory.createEditor.call(this, $editor, (0, _extend.extend)({}, field, options, {\n        parentType: SOURCE\n      }));\n    }\n\n    return $editor;\n  },\n  _createPopupWithTreeView: function _createPopupWithTreeView(options, $container) {\n    var that = this;\n    var $popup = (0, _renderer2.default)(\"<div>\").addClass(options.menu.cssClass).appendTo($container);\n\n    this._createComponent($popup, _popup2.default, {\n      onHiding: options.menu.onHiding,\n      onHidden: options.menu.onHidden,\n      rtlEnabled: options.menu.rtlEnabled,\n      position: options.menu.position,\n      animation: options.menu.animation,\n      contentTemplate: function contentTemplate(contentElement) {\n        var $menuContainer = (0, _renderer2.default)(\"<div>\").appendTo(contentElement);\n\n        that._createComponent($menuContainer, _tree_view2.default, options.menu);\n\n        this.repaint();\n      },\n      maxHeight: function maxHeight() {\n        return (0, _utils3.getElementMaxHeightByWindow)(options.menu.position.of);\n      },\n      visible: true,\n      focusStateEnabled: false,\n      closeOnTargetScroll: this.option(\"closePopupOnTargetScroll\"),\n      closeOnOutsideClick: true,\n      onShown: options.popup.onShown,\n      shading: false,\n      width: \"auto\",\n      height: \"auto\",\n      showTitle: false\n    });\n  },\n  _subscribeOnClickAndEnterKey: function _subscribeOnClickAndEnterKey($button, handler) {\n    _events_engine2.default.on($button, \"dxclick\", handler);\n\n    _events_engine2.default.on($button, \"keyup\", function (e) {\n      if ((0, _utils4.normalizeKeyName)(e) === ENTER_KEY) {\n        handler(e);\n      }\n    });\n  }\n});\n\n(0, _component_registrator2.default)(\"dxFilterBuilder\", FilterBuilder);\nmodule.exports = FilterBuilder;\nmodule.exports.renderValueText = renderValueText;","map":{"version":3,"sources":["C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/devextreme/ui/filter_builder/filter_builder.js"],"names":["_renderer","require","_renderer2","_interopRequireDefault","_dom_adapter","_dom_adapter2","_class","_class2","_events_engine","_events_engine2","_ui","_ui2","_component_registrator","_component_registrator2","_extend","_message","_message2","_utils","_utils2","_deferred","_deferred2","_type","_tree_view","_tree_view2","_popup","_popup2","_utils3","_ui3","_ui4","_utils4","obj","FILTER_BUILDER_CLASS","FILTER_BUILDER_GROUP_CLASS","FILTER_BUILDER_GROUP_ITEM_CLASS","FILTER_BUILDER_GROUP_CONTENT_CLASS","FILTER_BUILDER_GROUP_OPERATIONS_CLASS","FILTER_BUILDER_GROUP_OPERATION_CLASS","FILTER_BUILDER_ACTION_CLASS","FILTER_BUILDER_IMAGE_CLASS","FILTER_BUILDER_IMAGE_ADD_CLASS","FILTER_BUILDER_IMAGE_REMOVE_CLASS","FILTER_BUILDER_ITEM_TEXT_CLASS","FILTER_BUILDER_ITEM_TEXT_PART_CLASS","FILTER_BUILDER_ITEM_TEXT_SEPARATOR_CLASS","FILTER_BUILDER_ITEM_TEXT_SEPARATOR_EMPTY_CLASS","FILTER_BUILDER_ITEM_FIELD_CLASS","FILTER_BUILDER_ITEM_OPERATION_CLASS","FILTER_BUILDER_ITEM_VALUE_CLASS","FILTER_BUILDER_ITEM_VALUE_TEXT_CLASS","FILTER_BUILDER_OVERLAY_CLASS","FILTER_BUILDER_FILTER_OPERATIONS_CLASS","FILTER_BUILDER_FIELDS_CLASS","FILTER_BUILDER_ADD_CONDITION_CLASS","ACTIVE_CLASS","FILTER_BUILDER_MENU_CUSTOM_OPERATION_CLASS","SOURCE","DISABLED_STATE_CLASS","TAB_KEY","ENTER_KEY","ESCAPE_KEY","ACTIONS","name","config","excludeValidators","category","OPERATORS","and","or","notAnd","notOr","EditorFactory","renderValueText","Array","lastItemIndex","value","$container","i","customOperation","FilterBuilder","_getDefaultOptions","onEditorPreparing","onEditorPrepared","onValueChanged","fields","defaultGroupOperation","groupOperations","maxGroupLevel","allowHierarchicalFields","groupOperationDescriptions","customOperations","closePopupOnTargetScroll","filterOperationDescriptions","between","equal","notEqual","lessThan","lessThanOrEqual","greaterThan","greaterThanOrEqual","startsWith","contains","notContains","endsWith","isBlank","isNotBlank","_optionChanged","args","disableInvalidateForValue","previousValue","getFilterExpression","_getNormalizedFields","_updateFilter","normalizedValue","oldValue","JSON","_init","_initEditorFactory","_initCustomOperations","_getModel","_initModel","_initActions","that","action","executeAction","_initMarkup","_createConditionElement","_createGroupElementByCriteria","groupLevel","arguments","$group","$groupContent","groupCriteria","innerCriteria","_createGroupElement","_this","$groupItem","newGroup","field","newCondition","_createButton","_createGroupOperationButton","_this2","groupMenuItem","caption","$operationButton","menu","items","displayExpr","keyExpr","onItemClick","e","onContentReady","cssClass","_createButtonWithMenu","removeMenu","rtlEnabled","menuOnItemClickWrapper","handler","position","$button","options","focusStateEnabled","selectionMode","onHiding","my","at","offset","of","collision","animation","onHidden","onShown","treeViewElement","info","treeView","keyName","_hasValueButton","condition","_createOperationButtonWithMenu","_this3","availableOperations","currentOperation","onItemRendered","$valueButton","_createOperationAndValueButtons","_createFieldButtonWithMenu","_this4","item","getFullCaption","$fieldButton","dataStructure","parentId","_createConditionItem","_this5","$item","isSingleChild","_getGroupOperations","text","_createRemoveButton","$removeButton","_createAddButton","click","addConditionHandler","addGroupHandler","_createValueText","$text","_updateConditionValue","areValuesDifferent","callback","_addDocumentKeyUp","document","documentKeyUpHandler","isComposing","hasCompositionJustEnded","input","$editor","event","_addDocumentClick","_this6","documentClickHandler","closeEditorFunc","_isFocusOnEditorParts","activeElement","target","_removeEvents","_dispose","_createValueEditorWithEvents","_this7","createValueText","closeEditor","filterOperation","setValue","_createValueButton","_createValueEditor","editorTemplate","template","model","container","parentType","_createPopupWithTreeView","$popup","contentTemplate","$menuContainer","maxHeight","visible","closeOnTargetScroll","closeOnOutsideClick","shading","width","height","showTitle","_subscribeOnClickAndEnterKey","module"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,IAAIA,SAAS,GAAGC,OAAO,CAAvB,qBAAuB,CAAvB;;AACA,IAAIC,UAAU,GAAGC,sBAAsB,CAAvC,SAAuC,CAAvC;;AACA,IAAIC,YAAY,GAAGH,OAAO,CAA1B,wBAA0B,CAA1B;;AACA,IAAII,aAAa,GAAGF,sBAAsB,CAA1C,YAA0C,CAA1C;;AACA,IAAIG,MAAM,GAAGL,OAAO,CAApB,kBAAoB,CAApB;;AACA,IAAIM,OAAO,GAAGJ,sBAAsB,CAApC,MAAoC,CAApC;;AACA,IAAIK,cAAc,GAAGP,OAAO,CAA5B,iCAA4B,CAA5B;;AACA,IAAIQ,eAAe,GAAGN,sBAAsB,CAA5C,cAA4C,CAA5C;;AACA,IAAIO,GAAG,GAAGT,OAAO,CAAjB,qBAAiB,CAAjB;;AACA,IAAIU,IAAI,GAAGR,sBAAsB,CAAjC,GAAiC,CAAjC;;AACA,IAAIS,sBAAsB,GAAGX,OAAO,CAApC,kCAAoC,CAApC;;AACA,IAAIY,uBAAuB,GAAGV,sBAAsB,CAApD,sBAAoD,CAApD;;AACA,IAAIW,OAAO,GAAGb,OAAO,CAArB,yBAAqB,CAArB;;AACA,IAAIc,QAAQ,GAAGd,OAAO,CAAtB,4BAAsB,CAAtB;;AACA,IAAIe,SAAS,GAAGb,sBAAsB,CAAtC,QAAsC,CAAtC;;AACA,IAAIc,MAAM,GAAGhB,OAAO,CAApB,SAAoB,CAApB;;AACA,IAAIiB,OAAO,GAAGf,sBAAsB,CAApC,MAAoC,CAApC;;AACA,IAAIgB,SAAS,GAAGlB,OAAO,CAAvB,2BAAuB,CAAvB;;AACA,IAAImB,UAAU,GAAGjB,sBAAsB,CAAvC,SAAuC,CAAvC;;AACA,IAAIkB,KAAK,GAAGpB,OAAO,CAAnB,uBAAmB,CAAnB;;AACA,IAAIqB,UAAU,GAAGrB,OAAO,CAAxB,cAAwB,CAAxB;;AACA,IAAIsB,WAAW,GAAGpB,sBAAsB,CAAxC,UAAwC,CAAxC;;AACA,IAAIqB,MAAM,GAAGvB,OAAO,CAApB,UAAoB,CAApB;;AACA,IAAIwB,OAAO,GAAGtB,sBAAsB,CAApC,MAAoC,CAApC;;AACA,IAAIuB,OAAO,GAAGzB,OAAO,CAArB,kBAAqB,CAArB;;AACA,IAAI0B,IAAI,GAAG1B,OAAO,CAAlB,mCAAkB,CAAlB;;AACA,IAAI2B,IAAI,GAAGzB,sBAAsB,CAAjC,IAAiC,CAAjC;;AACA,IAAI0B,OAAO,GAAG5B,OAAO,CAArB,oBAAqB,CAArB;;AAEA,SAAA,sBAAA,CAAA,GAAA,EAAqC;AACjC,SAAO6B,GAAG,IAAIA,GAAG,CAAVA,UAAAA,GAAAA,GAAAA,GAA8B;AACjC,eAAWA;AADsB,GAArC;AAGH;;AACD,IAAIC,oBAAoB,GAAxB,kBAAA;AACA,IAAIC,0BAA0B,GAAGD,oBAAoB,GAArD,QAAA;AACA,IAAIE,+BAA+B,GAAGD,0BAA0B,GAAhE,OAAA;AACA,IAAIE,kCAAkC,GAAGF,0BAA0B,GAAnE,UAAA;AACA,IAAIG,qCAAqC,GAAGH,0BAA0B,GAAtE,aAAA;AACA,IAAII,oCAAoC,GAAGJ,0BAA0B,GAArE,YAAA;AACA,IAAIK,2BAA2B,GAAGN,oBAAoB,GAAtD,SAAA;AACA,IAAIO,0BAA0B,GAAGD,2BAA2B,GAA5D,OAAA;AACA,IAAIE,8BAA8B,GAAlC,cAAA;AACA,IAAIC,iCAAiC,GAArC,gBAAA;AACA,IAAIC,8BAA8B,GAAGV,oBAAoB,GAAzD,OAAA;AACA,IAAIW,mCAAmC,GAAGD,8BAA8B,GAAxE,OAAA;AACA,IAAIE,wCAAwC,GAAGF,8BAA8B,GAA7E,YAAA;AACA,IAAIG,8CAA8C,GAAGD,wCAAwC,GAA7F,QAAA;AACA,IAAIE,+BAA+B,GAAGd,oBAAoB,GAA1D,aAAA;AACA,IAAIe,mCAAmC,GAAGf,oBAAoB,GAA9D,iBAAA;AACA,IAAIgB,+BAA+B,GAAGhB,oBAAoB,GAA1D,aAAA;AACA,IAAIiB,oCAAoC,GAAGjB,oBAAoB,GAA/D,kBAAA;AACA,IAAIkB,4BAA4B,GAAGlB,oBAAoB,GAAvD,UAAA;AACA,IAAImB,sCAAsC,GAAGnB,oBAAoB,GAAjE,aAAA;AACA,IAAIoB,2BAA2B,GAAGpB,oBAAoB,GAAtD,SAAA;AACA,IAAIqB,kCAAkC,GAAGrB,oBAAoB,GAA7D,gBAAA;AACA,IAAIsB,YAAY,GAAhB,iBAAA;AACA,IAAIC,0CAA0C,GAAGvB,oBAAoB,GAArE,wBAAA;AACA,IAAIwB,MAAM,GAAV,eAAA;AACA,IAAIC,oBAAoB,GAAxB,mBAAA;AACA,IAAIC,OAAO,GAAX,KAAA;AACA,IAAIC,SAAS,GAAb,OAAA;AACA,IAAIC,UAAU,GAAd,QAAA;AACA,IAAIC,OAAO,GAAG,CAAC;AACXC,EAAAA,IAAI,EADO,mBAAA;AAEXC,EAAAA,MAAM,EAAE;AACJC,IAAAA,iBAAiB,EAAE,CAAA,UAAA,EADf,UACe,CADf;AAEJC,IAAAA,QAAQ,EAAE;AAFN;AAFG,CAAD,EAMX;AACCH,EAAAA,IAAI,EADL,kBAAA;AAECC,EAAAA,MAAM,EAAE;AACJC,IAAAA,iBAAiB,EAAE,CAAA,UAAA,EADf,UACe,CADf;AAEJC,IAAAA,QAAQ,EAAE;AAFN;AAFT,CANW,EAYX;AACCH,EAAAA,IAAI,EADL,gBAAA;AAECC,EAAAA,MAAM,EAAE;AACJC,IAAAA,iBAAiB,EAAE,CAAA,UAAA,EAAA,UAAA;AADf;AAFT,CAZW,CAAd;AAkBA,IAAIE,SAAS,GAAG;AACZC,EAAAA,GAAG,EADS,KAAA;AAEZC,EAAAA,EAAE,EAFU,IAAA;AAGZC,EAAAA,MAAM,EAHM,MAAA;AAIZC,EAAAA,KAAK,EAAE;AAJK,CAAhB;;AAMA,IAAIC,aAAa,GAAG/D,OAAO,CAAPA,OAAAA,CAAAA,OAAAA,CAAwBqB,IAAI,CAAhD,OAAoBrB,CAApB;;AACA,IAAIgE,eAAe,GAAG,SAAlBA,eAAkB,CAAA,UAAA,EAAA,KAAA,EAAA,eAAA,EAA6C;AAC/D,MAAIC,KAAK,CAALA,OAAAA,CAAJ,KAAIA,CAAJ,EAA0B;AACtB,QAAIC,aAAa,GAAGC,KAAK,CAALA,MAAAA,GAApB,CAAA;AACAC,IAAAA,UAAU,CAAVA,KAAAA;AACAD,IAAAA,KAAK,CAALA,OAAAA,CAAc,UAAA,CAAA,EAAA,CAAA,EAAe;AACzB,OAAC,GAAGxE,UAAU,CAAd,OAAA,EAAA,QAAA,EAAA,QAAA,CAAA,mCAAA,EAAA,IAAA,CAAA,CAAA,EAAA,QAAA,CAAA,UAAA;;AACA,UAAI0E,CAAC,KAAL,aAAA,EAAyB;AACrB,SAAC,GAAG1E,UAAU,CAAd,OAAA,EAAA,QAAA,EAAA,QAAA,CAAA,wCAAA,EAAA,IAAA,CAA0F2E,eAAe,IAAIA,eAAe,CAAlCA,cAAAA,GAAoDA,eAAe,CAAnEA,cAAAA,GAA1F,GAAA,EAAA,QAAA,CAAA,8CAAA,EAAA,QAAA,CAAA,UAAA;AACH;AAJLH,KAAAA;AAHJ,GAAA,MASO;AACH,QAAA,KAAA,EAAW;AACPC,MAAAA,UAAU,CAAVA,IAAAA,CAAAA,KAAAA;AADJ,KAAA,MAEO;AACHA,MAAAA,UAAU,CAAVA,IAAAA,CAAgB3D,SAAS,CAATA,OAAAA,CAAAA,MAAAA,CAAhB2D,gCAAgB3D,CAAhB2D;AACH;AACJ;AAhBL,CAAA;;AAkBA,IAAIG,aAAa,GAAG,IAAI,CAAJ,OAAA,CAAA,OAAA,CAAqB;AACrCC,EAAAA,kBAAkB,EAAE,SAAA,kBAAA,GAAW;AAC3B,WAAO,CAAC,GAAGjE,OAAO,CAAX,MAAA,EAAoB,KAApB,QAAoB,EAApB,EAAqC;AACxCkE,MAAAA,iBAAiB,EADuB,IAAA;AAExCC,MAAAA,gBAAgB,EAFwB,IAAA;AAGxCC,MAAAA,cAAc,EAH0B,IAAA;AAIxCC,MAAAA,MAAM,EAJkC,EAAA;AAKxCC,MAAAA,qBAAqB,EALmB,KAAA;AAMxCC,MAAAA,eAAe,EAAE,CAAA,KAAA,EAAA,IAAA,EAAA,QAAA,EANuB,OAMvB,CANuB;AAOxCC,MAAAA,aAAa,EAAE,KAPyB,CAAA;AAQxCZ,MAAAA,KAAK,EARmC,IAAA;AASxCa,MAAAA,uBAAuB,EATiB,KAAA;AAUxCC,MAAAA,0BAA0B,EAAE;AACxBtB,QAAAA,GAAG,EAAElD,SAAS,CAATA,OAAAA,CAAAA,MAAAA,CADmB,qBACnBA,CADmB;AAExBmD,QAAAA,EAAE,EAAEnD,SAAS,CAATA,OAAAA,CAAAA,MAAAA,CAFoB,oBAEpBA,CAFoB;AAGxBoD,QAAAA,MAAM,EAAEpD,SAAS,CAATA,OAAAA,CAAAA,MAAAA,CAHgB,wBAGhBA,CAHgB;AAIxBqD,QAAAA,KAAK,EAAErD,SAAS,CAATA,OAAAA,CAAAA,MAAAA,CAAAA,uBAAAA;AAJiB,OAVY;AAgBxCyE,MAAAA,gBAAgB,EAhBwB,EAAA;AAiBxCC,MAAAA,wBAAwB,EAjBgB,IAAA;AAkBxCC,MAAAA,2BAA2B,EAAE;AACzBC,QAAAA,OAAO,EAAE5E,SAAS,CAATA,OAAAA,CAAAA,MAAAA,CADgB,wCAChBA,CADgB;AAEzB6E,QAAAA,KAAK,EAAE7E,SAAS,CAATA,OAAAA,CAAAA,MAAAA,CAFkB,uCAElBA,CAFkB;AAGzB8E,QAAAA,QAAQ,EAAE9E,SAAS,CAATA,OAAAA,CAAAA,MAAAA,CAHe,0CAGfA,CAHe;AAIzB+E,QAAAA,QAAQ,EAAE/E,SAAS,CAATA,OAAAA,CAAAA,MAAAA,CAJe,qCAIfA,CAJe;AAKzBgF,QAAAA,eAAe,EAAEhF,SAAS,CAATA,OAAAA,CAAAA,MAAAA,CALQ,6CAKRA,CALQ;AAMzBiF,QAAAA,WAAW,EAAEjF,SAAS,CAATA,OAAAA,CAAAA,MAAAA,CANY,wCAMZA,CANY;AAOzBkF,QAAAA,kBAAkB,EAAElF,SAAS,CAATA,OAAAA,CAAAA,MAAAA,CAPK,gDAOLA,CAPK;AAQzBmF,QAAAA,UAAU,EAAEnF,SAAS,CAATA,OAAAA,CAAAA,MAAAA,CARa,2CAQbA,CARa;AASzBoF,QAAAA,QAAQ,EAAEpF,SAAS,CAATA,OAAAA,CAAAA,MAAAA,CATe,yCASfA,CATe;AAUzBqF,QAAAA,WAAW,EAAErF,SAAS,CAATA,OAAAA,CAAAA,MAAAA,CAVY,4CAUZA,CAVY;AAWzBsF,QAAAA,QAAQ,EAAEtF,SAAS,CAATA,OAAAA,CAAAA,MAAAA,CAXe,yCAWfA,CAXe;AAYzBuF,QAAAA,OAAO,EAAEvF,SAAS,CAATA,OAAAA,CAAAA,MAAAA,CAZgB,wCAYhBA,CAZgB;AAazBwF,QAAAA,UAAU,EAAExF,SAAS,CAATA,OAAAA,CAAAA,MAAAA,CAAAA,2CAAAA;AAba;AAlBW,KAArC,CAAP;AAFiC,GAAA;AAqCrCyF,EAAAA,cAAc,EAAE,SAAA,cAAA,CAAA,IAAA,EAAe;AAC3B,YAAQC,IAAI,CAAZ,IAAA;AACI,WAAA,0BAAA;AACI;;AACJ,WAAA,mBAAA;AACA,WAAA,kBAAA;AACA,WAAA,gBAAA;AACI,aAAA,YAAA;;AACA;;AACJ,WAAA,kBAAA;AACI,aAAA,qBAAA;;AACA,aAAA,WAAA;;AACA;;AACJ,WAAA,QAAA;AACA,WAAA,uBAAA;AACA,WAAA,eAAA;AACA,WAAA,iBAAA;AACA,WAAA,yBAAA;AACA,WAAA,4BAAA;AACA,WAAA,6BAAA;AACI,aAAA,WAAA;;AACA;;AACJ,WAAA,OAAA;AACI,YAAIA,IAAI,CAAJA,KAAAA,KAAeA,IAAI,CAAvB,aAAA,EAAuC;AACnC,cAAIC,yBAAyB,GAAG,KAAhC,0BAAA;;AACA,cAAI,CAAJ,yBAAA,EAAgC;AAC5B,iBAAA,UAAA;;AACA,iBAAA,WAAA;AACH;;AACD,eAAA,0BAAA,GAAA,KAAA;AACA,eAAA,aAAA,CAAA,gBAAA,EAAqC;AACjCjC,YAAAA,KAAK,EAAEgC,IAAI,CADsB,KAAA;AAEjCE,YAAAA,aAAa,EAAEF,IAAI,CAACE;AAFa,WAArC;AAIA,eAAA,0BAAA,GAAA,yBAAA;AACH;;AACD;;AACJ;AACI,aAAA,QAAA,CAAA,IAAA;AArCR;AAtCiC,GAAA;AA8ErCC,EAAAA,mBAAmB,EAAE,SAAA,mBAAA,GAAW;AAC5B,QAAI1B,MAAM,GAAG,KAAb,oBAAa,EAAb;;AACA,QAAIT,KAAK,GAAG,CAAC,GAAG5D,OAAO,CAAX,MAAA,EAAA,IAAA,EAAA,EAAA,EAA8B,KAA1C,MAAY,CAAZ;AACA,WAAOI,OAAO,CAAPA,OAAAA,CAAAA,mBAAAA,CAAoCA,OAAO,CAAPA,OAAAA,CAAAA,mBAAAA,CAApCA,KAAoCA,CAApCA,EAAAA,MAAAA,EAAwF,KAAxFA,iBAAAA,EAAP,MAAOA,CAAP;AAjFiC,GAAA;AAmFrC4F,EAAAA,oBAAoB,EAAE,SAAA,oBAAA,GAAW;AAC7B,WAAO5F,OAAO,CAAPA,OAAAA,CAAAA,mBAAAA,CAAoC,KAAA,MAAA,CAA3C,QAA2C,CAApCA,CAAP;AApFiC,GAAA;AAsFrC6F,EAAAA,aAAa,EAAE,SAAA,aAAA,GAAW;AACtB,SAAA,0BAAA,GAAA,IAAA;AACA,QAAIrC,KAAK,GAAG,CAAC,GAAG5D,OAAO,CAAX,MAAA,EAAA,IAAA,EAAA,EAAA,EAA8B,KAA1C,MAAY,CAAZ;;AACA,QAAIkG,eAAe,GAAG9F,OAAO,CAAPA,OAAAA,CAAAA,mBAAAA,CAAtB,KAAsBA,CAAtB;;AACA,QAAI+F,QAAQ,GAAG/F,OAAO,CAAPA,OAAAA,CAAAA,mBAAAA,CAAoC,KAAA,SAAA,CAAe,KAAA,MAAA,CAAlE,OAAkE,CAAf,CAApCA,CAAf;;AACA,QAAIgG,IAAI,CAAJA,SAAAA,CAAAA,QAAAA,MAA6BA,IAAI,CAAJA,SAAAA,CAAjC,eAAiCA,CAAjC,EAAkE;AAC9D,WAAA,MAAA,CAAA,OAAA,EAAA,eAAA;AACH;;AACD,SAAA,0BAAA,GAAA,KAAA;;AACA,SAAA,uBAAA;AA/FiC,GAAA;AAiGrCC,EAAAA,KAAK,EAAE,SAAA,KAAA,GAAW;AACd,SAAA,qBAAA;;AACA,SAAA,UAAA;;AACA,SAAA,kBAAA;;AACA,SAAA,YAAA;;AACA,SAAA,QAAA;AAtGiC,GAAA;AAwGrCC,EAAAA,kBAAkB,EAAE,SAAA,kBAAA,GAAW;AAC3B,SAAA,cAAA,GAAsB,IAAtB,aAAsB,EAAtB;AAzGiC,GAAA;AA2GrCC,EAAAA,qBAAqB,EAAE,SAAA,qBAAA,GAAW;AAC9B,SAAA,iBAAA,GAAyBnG,OAAO,CAAPA,OAAAA,CAAAA,mBAAAA,CAAoC,KAAA,MAAA,CAApCA,kBAAoC,CAApCA,EAAqE,KAAA,MAAA,CAA9F,qCAA8F,CAArEA,CAAzB;AA5GiC,GAAA;AA8GrCoG,EAAAA,SAAS,EAAE,SAAA,SAAA,CAAA,KAAA,EAAgB;AACvB,WAAOpG,OAAO,CAAPA,OAAAA,CAAAA,uBAAAA,CAAAA,KAAAA,EAA+C,KAAtD,iBAAOA,CAAP;AA/GiC,GAAA;AAiHrCqG,EAAAA,UAAU,EAAE,SAAA,UAAA,GAAW;AACnB,SAAA,MAAA,GAAc,KAAA,SAAA,CAAe,KAAA,MAAA,CAA7B,OAA6B,CAAf,CAAd;AAlHiC,GAAA;AAoHrCC,EAAAA,YAAY,EAAE,SAAA,YAAA,GAAW;AACrB,QAAIC,IAAI,GAAR,IAAA;AACAA,IAAAA,IAAI,CAAJA,QAAAA,GAAAA,EAAAA;AACA7D,IAAAA,OAAO,CAAPA,OAAAA,CAAgB,UAAA,MAAA,EAAiB;AAC7B6D,MAAAA,IAAI,CAAJA,QAAAA,CAAcC,MAAM,CAApBD,IAAAA,IAA6BA,IAAI,CAAJA,qBAAAA,CAA2BC,MAAM,CAAjCD,IAAAA,EAAwCC,MAAM,CAA3ED,MAA6BA,CAA7BA;AADJ7D,KAAAA;AAvHiC,GAAA;AA2HrC+D,EAAAA,aAAa,EAAE,SAAA,aAAA,CAAA,UAAA,EAAA,OAAA,EAA8B;AACzC,QAAID,MAAM,GAAG,KAAA,QAAA,CAAb,UAAa,CAAb;AACA,WAAOA,MAAM,IAAIA,MAAM,CAAvB,OAAuB,CAAvB;AA7HiC,GAAA;AA+HrCE,EAAAA,WAAW,EAAE,SAAA,WAAA,GAAW;AACpB,SAAA,QAAA,GAAA,QAAA,CAAA,oBAAA;AACA,SAAA,QAAA;;AACA,SAAA,6BAAA,CAAmC,KAAnC,MAAA,EAAA,QAAA,CAAyD,KAAzD,QAAyD,EAAzD;AAlIiC,GAAA;AAoIrCC,EAAAA,uBAAuB,EAAE,SAAA,uBAAA,CAAA,SAAA,EAAA,MAAA,EAA4B;AACjD,WAAO,CAAC,GAAG3H,UAAU,CAAd,OAAA,EAAA,OAAA,EAAA,QAAA,CAAA,0BAAA,EAAA,MAAA,CAA6E,KAAA,oBAAA,CAAA,SAAA,EAApF,MAAoF,CAA7E,CAAP;AArIiC,GAAA;AAuIrC4H,EAAAA,6BAA6B,EAAE,SAAA,6BAAA,CAAA,QAAA,EAAA,MAAA,EAA2B;AACtD,QAAIC,UAAU,GAAGC,SAAS,CAATA,MAAAA,GAAAA,CAAAA,IAAwB,KAAA,CAAA,KAAWA,SAAS,CAA5CA,CAA4C,CAA5CA,GAAkDA,SAAS,CAA3DA,CAA2D,CAA3DA,GAAjB,CAAA;;AACA,QAAIC,MAAM,GAAG,KAAA,mBAAA,CAAA,QAAA,EAAA,MAAA,EAAb,UAAa,CAAb;;AACA,QAAIC,aAAa,GAAGD,MAAM,CAANA,IAAAA,CAAY,MAAhC,kCAAoBA,CAApB;;AACA,QAAIE,aAAa,GAAGjH,OAAO,CAAPA,OAAAA,CAAAA,gBAAAA,CAApB,QAAoBA,CAApB;;AACA,SAAK,IAAI0D,CAAC,GAAV,CAAA,EAAgBA,CAAC,GAAGuD,aAAa,CAAjC,MAAA,EAA0CvD,CAA1C,EAAA,EAA+C;AAC3C,UAAIwD,aAAa,GAAGD,aAAa,CAAjC,CAAiC,CAAjC;;AACA,UAAIjH,OAAO,CAAPA,OAAAA,CAAAA,OAAAA,CAAJ,aAAIA,CAAJ,EAA4C;AACxC,aAAA,6BAAA,CAAA,aAAA,EAAA,aAAA,EAAiE6G,UAAU,GAA3E,CAAA,EAAA,QAAA,CAAA,aAAA;AADJ,OAAA,MAEO;AACH,YAAI7G,OAAO,CAAPA,OAAAA,CAAAA,WAAAA,CAAJ,aAAIA,CAAJ,EAAgD;AAC5C,eAAA,uBAAA,CAAA,aAAA,EAAA,aAAA,EAAA,QAAA,CAAA,aAAA;AACH;AACJ;AACJ;;AACD,WAAA,MAAA;AAtJiC,GAAA;AAwJrCmH,EAAAA,mBAAmB,EAAE,SAAA,mBAAA,CAAA,QAAA,EAAA,MAAA,EAAA,UAAA,EAAuC;AACxD,QAAIC,KAAK,GAAT,IAAA;;AACA,QAAIC,UAAU,GAAG,CAAC,GAAGrI,UAAU,CAAd,OAAA,EAAA,OAAA,EAAA,QAAA,CAAjB,+BAAiB,CAAjB;AACA,QAAIgI,aAAa,GAAG,CAAC,GAAGhI,UAAU,CAAd,OAAA,EAAA,OAAA,EAAA,QAAA,CAApB,kCAAoB,CAApB;AACA,QAAI+H,MAAM,GAAG,CAAC,GAAG/H,UAAU,CAAd,OAAA,EAAA,OAAA,EAAA,QAAA,CAAA,0BAAA,EAAA,MAAA,CAAA,UAAA,EAAA,MAAA,CAAb,aAAa,CAAb;;AACA,QAAI,QAAJ,MAAA,EAAoB;AAChB,WAAA,mBAAA,CAAyB,YAAW;AAChCgB,QAAAA,OAAO,CAAPA,OAAAA,CAAAA,UAAAA,CAAAA,MAAAA,EAAAA,QAAAA;;AACA+G,QAAAA,MAAM,CAANA,MAAAA;;AACAK,QAAAA,KAAK,CAALA,aAAAA;AAHJ,OAAA,EAAA,QAAA,CAAA,UAAA;AAKH;;AACD,SAAA,2BAAA,CAAA,QAAA,EAAA,QAAA,CAAA,UAAA;;AACA,SAAA,gBAAA,CAAsB,YAAW;AAC7B,UAAIE,QAAQ,GAAGtH,OAAO,CAAPA,OAAAA,CAAAA,gBAAAA,CAAiCoH,KAAK,CAALA,MAAAA,CAAhD,uBAAgDA,CAAjCpH,CAAf;;AACAA,MAAAA,OAAO,CAAPA,OAAAA,CAAAA,OAAAA,CAAAA,QAAAA,EAAAA,QAAAA;;AACAoH,MAAAA,KAAK,CAALA,mBAAAA,CAAAA,QAAAA,EAAAA,QAAAA,EAA8CP,UAAU,GAAxDO,CAAAA,EAAAA,QAAAA,CAAAA,aAAAA;;AACAA,MAAAA,KAAK,CAALA,aAAAA;AAJJ,KAAA,EAKG,YAAW;AACV,UAAIG,KAAK,GAAGH,KAAK,CAALA,MAAAA,CAAAA,QAAAA,EAAZ,CAAYA,CAAZ;;AACA,UAAII,YAAY,GAAGxH,OAAO,CAAPA,OAAAA,CAAAA,eAAAA,CAAAA,KAAAA,EAAuCoH,KAAK,CAA/D,iBAAmBpH,CAAnB;;AACAA,MAAAA,OAAO,CAAPA,OAAAA,CAAAA,OAAAA,CAAAA,YAAAA,EAAAA,QAAAA;;AACAoH,MAAAA,KAAK,CAALA,uBAAAA,CAAAA,YAAAA,EAAAA,QAAAA,EAAAA,QAAAA,CAAAA,aAAAA;;AACAA,MAAAA,KAAK,CAALA,aAAAA;AAVJ,KAAA,EAAA,UAAA,EAAA,QAAA,CAAA,UAAA;;AAYA,WAAA,MAAA;AAjLiC,GAAA;AAmLrCK,EAAAA,aAAa,EAAE,SAAA,aAAA,CAAA,OAAA,EAAkB;AAC7B,WAAO,CAAC,GAAGzI,UAAU,CAAd,OAAA,EAAA,OAAA,EAAA,IAAA,CAAP,OAAO,CAAP;AApLiC,GAAA;AAsLrC0I,EAAAA,2BAA2B,EAAE,SAAA,2BAAA,CAAA,QAAA,EAAmB;AAC5C,QAAIC,MAAM,GAAV,IAAA;;AACA,QAAIxD,eAAe,GAAG,KAAA,mBAAA,CAAtB,QAAsB,CAAtB;;AACA,QAAIyD,aAAa,GAAG5H,OAAO,CAAPA,OAAAA,CAAAA,gBAAAA,CAAAA,QAAAA,EAApB,eAAoBA,CAApB;;AACA,QAAI6H,OAAO,GAAGD,aAAa,CAA3B,IAAA;AACA,QAAIE,gBAAgB,GAAG3D,eAAe,IAAIA,eAAe,CAAfA,MAAAA,GAAnBA,CAAAA,GAAgD,KAAA,aAAA,CAAA,OAAA,EAAA,QAAA,CAAhDA,oBAAgD,CAAhDA,GAA6G,KAAA,qBAAA,CAA2B;AAC3J0D,MAAAA,OAAO,EADoJ,OAAA;AAE3JE,MAAAA,IAAI,EAAE;AACFC,QAAAA,KAAK,EADH,eAAA;AAEFC,QAAAA,WAAW,EAFT,MAAA;AAGFC,QAAAA,OAAO,EAHL,OAAA;AAIFC,QAAAA,WAAW,EAAE,SAAA,WAAA,CAAA,CAAA,EAAY;AACrB,cAAIP,aAAa,KAAKQ,CAAC,CAAvB,QAAA,EAAkC;AAC9BpI,YAAAA,OAAO,CAAPA,OAAAA,CAAAA,aAAAA,CAAAA,QAAAA,EAAwCoI,CAAC,CAADA,QAAAA,CAAxCpI,KAAAA;;AACA8H,YAAAA,gBAAgB,CAAhBA,IAAAA,CAAsBM,CAAC,CAADA,QAAAA,CAAtBN,IAAAA;AACAF,YAAAA,aAAa,GAAGQ,CAAC,CAAjBR,QAAAA;;AACAD,YAAAA,MAAM,CAANA,aAAAA;AACH;AAVH,SAAA;AAYFU,QAAAA,cAAc,EAAE,SAAA,cAAA,CAAA,CAAA,EAAY;AACxBD,UAAAA,CAAC,CAADA,SAAAA,CAAAA,UAAAA,CAAAA,aAAAA;AAbF,SAAA;AAeFE,QAAAA,QAAQ,EAAErH;AAfR;AAFqJ,KAA3B,CAApI;AAoBA,WAAO6G,gBAAgB,CAAhBA,QAAAA,CAAAA,8BAAAA,EAAAA,QAAAA,CAAAA,oCAAAA,EAAAA,IAAAA,CAAAA,UAAAA,EAAP,CAAOA,CAAP;AA/MiC,GAAA;AAiNrCS,EAAAA,qBAAqB,EAAE,SAAA,qBAAA,CAAA,OAAA,EAAkB;AACrC,QAAIhC,IAAI,GAAR,IAAA;;AACA,QAAIiC,UAAU,GAAG,SAAbA,UAAa,GAAW;AACxBjC,MAAAA,IAAI,CAAJA,QAAAA,GAAAA,IAAAA,CAAqB,MAArBA,YAAAA,EAAAA,WAAAA,CAAAA,YAAAA;AACAA,MAAAA,IAAI,CAAJA,QAAAA,GAAAA,IAAAA,CAAAA,0BAAAA,EAAAA,MAAAA;AACAA,MAAAA,IAAI,CAAJA,QAAAA,GAAAA,IAAAA,CAAAA,aAAAA,EAAAA,MAAAA;AAHJ,KAAA;;AAKA,QAAIkC,UAAU,GAAG,KAAA,MAAA,CAAjB,YAAiB,CAAjB;;AACA,QAAIC,sBAAsB,GAAG,SAAzBA,sBAAyB,CAAA,OAAA,EAAkB;AAC3C,aAAO,UAAA,CAAA,EAAY;AACfC,QAAAA,OAAO,CAAPA,CAAO,CAAPA;;AACA,YAAI,cAAcP,CAAC,CAADA,KAAAA,CAAlB,IAAA,EAAgC;AAC5BI,UAAAA,UAAU;AACb;AAJL,OAAA;AADJ,KAAA;;AAQA,QAAII,QAAQ,GAAGH,UAAU,GAAA,OAAA,GAAzB,MAAA;;AACA,QAAII,OAAO,GAAG,KAAA,aAAA,CAAmBC,OAAO,CAAxC,OAAc,CAAd;;AACA,KAAC,GAAGlJ,OAAO,CAAX,MAAA,EAAoBkJ,OAAO,CAA3B,IAAA,EAAkC;AAC9BC,MAAAA,iBAAiB,EADa,IAAA;AAE9BC,MAAAA,aAAa,EAFiB,QAAA;AAG9Bb,MAAAA,WAAW,EAAEO,sBAAsB,CAACI,OAAO,CAAPA,IAAAA,CAHN,WAGK,CAHL;AAI9BG,MAAAA,QAAQ,EAAE,SAAA,QAAA,CAAA,CAAA,EAAY;AAClBJ,QAAAA,OAAO,CAAPA,WAAAA,CAAAA,YAAAA;AAL0B,OAAA;AAO9BD,MAAAA,QAAQ,EAAE;AACNM,QAAAA,EAAE,EAAEN,QAAQ,GADN,MAAA;AAENO,QAAAA,EAAE,EAAEP,QAAQ,GAFN,SAAA;AAGNQ,QAAAA,MAAM,EAHA,KAAA;AAINC,QAAAA,EAAE,EAJI,OAAA;AAKNC,QAAAA,SAAS,EAAE;AALL,OAPoB;AAc9BC,MAAAA,SAAS,EAdqB,IAAA;AAe9BC,MAAAA,QAAQ,EAAE,SAAA,QAAA,GAAW;AACjBhB,QAAAA,UAAU;AAhBgB,OAAA;AAkB9BF,MAAAA,QAAQ,EAAEvG,4BAA4B,GAA5BA,GAAAA,GAAqC+G,OAAO,CAAPA,IAAAA,CAlBjB,QAAA;AAmB9BL,MAAAA,UAAU,EAAEA;AAnBkB,KAAlC;AAqBAK,IAAAA,OAAO,CAAPA,KAAAA,GAAgB;AACZW,MAAAA,OAAO,EAAE,SAAA,OAAA,CAAA,IAAA,EAAe;AACpB,YAAIC,eAAe,GAAG,CAAC,GAAG1K,UAAU,CAAd,OAAA,EAAwB2K,IAAI,CAAJA,SAAAA,CAAxB,OAAwBA,EAAxB,EAAA,IAAA,CAAtB,cAAsB,CAAtB;AACA,YAAIC,QAAQ,GAAGF,eAAe,CAAfA,UAAAA,CAAf,UAAeA,CAAf;;AACAnK,QAAAA,eAAe,CAAfA,OAAAA,CAAAA,EAAAA,CAAAA,eAAAA,EAAAA,eAAAA,EAA6D,UAAA,CAAA,EAAY;AACrE,cAAIsK,OAAO,GAAG,CAAC,GAAGlJ,OAAO,CAAX,gBAAA,EAAd,CAAc,CAAd;;AACA,cAAI,cAAcyH,CAAC,CAAf,IAAA,IAAwByB,OAAO,KAA/B,OAAA,IAA+C,YAAYzB,CAAC,CAAb,IAAA,KAAuByB,OAAO,KAAPA,UAAAA,IAA0BA,OAAO,KAA3G,SAAmD,CAAnD,EAA4H;AACxHF,YAAAA,IAAI,CAAJA,SAAAA,CAAAA,IAAAA;;AACApK,YAAAA,eAAe,CAAfA,OAAAA,CAAAA,OAAAA,CAAgCuJ,OAAO,CAAPA,IAAAA,CAAAA,QAAAA,CAAhCvJ,EAAAA,EAAAA,OAAAA;AACH;AALLA,SAAAA;;AAOAqK,QAAAA,QAAQ,CAARA,KAAAA;AACAA,QAAAA,QAAQ,CAARA,MAAAA,CAAAA,gBAAAA,EAAAA,IAAAA;AACH;AAbW,KAAhBd;;AAeA,SAAA,4BAAA,CAAA,OAAA,EAA2C,YAAW;AAClDN,MAAAA,UAAU;;AACVjC,MAAAA,IAAI,CAAJA,wBAAAA,CAAAA,OAAAA,EAAuCA,IAAI,CAA3CA,QAAuCA,EAAvCA;;AACAsC,MAAAA,OAAO,CAAPA,QAAAA,CAAAA,YAAAA;AAHJ,KAAA;;AAKA,WAAA,OAAA;AA5QiC,GAAA;AA8QrCiB,EAAAA,eAAe,EAAE,SAAA,eAAA,CAAA,SAAA,EAAoB;AACjC,QAAInG,eAAe,GAAG3D,OAAO,CAAPA,OAAAA,CAAAA,kBAAAA,CAAmC,KAAnCA,iBAAAA,EAA2D+J,SAAS,CAA1F,CAA0F,CAApE/J,CAAtB;;AACA,WAAO2D,eAAe,GAAG,UAAUA,eAAe,CAA5B,QAAA,GAAwC,SAASoG,SAAS,CAAhF,CAAgF,CAAhF;AAhRiC,GAAA;AAkRrCC,EAAAA,8BAA8B,EAAE,SAAA,8BAAA,CAAA,SAAA,EAAA,KAAA,EAA2B;AACvD,QAAIC,MAAM,GAAV,IAAA;;AACA,QAAI1D,IAAI,GAAR,IAAA;;AACA,QAAI2D,mBAAmB,GAAGlK,OAAO,CAAPA,OAAAA,CAAAA,sBAAAA,CAAAA,KAAAA,EAA8C,KAAA,MAAA,CAA9CA,6BAA8C,CAA9CA,EAA0F,KAApH,iBAA0BA,CAA1B;;AACA,QAAImK,gBAAgB,GAAGnK,OAAO,CAAPA,OAAAA,CAAAA,yBAAAA,CAA0CA,OAAO,CAAPA,OAAAA,CAAAA,iBAAAA,CAA1CA,SAA0CA,CAA1CA,EAAvB,mBAAuBA,CAAvB;;AACA,QAAI8H,gBAAgB,GAAG,KAAA,qBAAA,CAA2B;AAC9CD,MAAAA,OAAO,EAAEsC,gBAAgB,CADqB,IAAA;AAE9CpC,MAAAA,IAAI,EAAE;AACFC,QAAAA,KAAK,EADH,mBAAA;AAEFC,QAAAA,WAAW,EAFT,MAAA;AAGFmC,QAAAA,cAAc,EAAE,SAAA,cAAA,CAAA,CAAA,EAAY;AACxBhC,UAAAA,CAAC,CAADA,QAAAA,CAAAA,QAAAA,IAAuB,CAAC,GAAGpJ,UAAU,CAAd,OAAA,EAAwBoJ,CAAC,CAAzB,WAAA,EAAA,QAAA,CAAvBA,0CAAuB,CAAvBA;AAJF,SAAA;AAMFC,QAAAA,cAAc,EAAE,SAAA,cAAA,CAAA,CAAA,EAAY;AACxBD,UAAAA,CAAC,CAADA,SAAAA,CAAAA,UAAAA,CAAAA,gBAAAA;AAPF,SAAA;AASFD,QAAAA,WAAW,EAAE,SAAA,WAAA,CAAA,CAAA,EAAY;AACrB,cAAIgC,gBAAgB,KAAK/B,CAAC,CAA1B,QAAA,EAAqC;AACjC+B,YAAAA,gBAAgB,GAAG/B,CAAC,CAApB+B,QAAAA;;AACAnK,YAAAA,OAAO,CAAPA,OAAAA,CAAAA,0BAAAA,CAAAA,SAAAA,EAAsDmK,gBAAgB,CAAtEnK,KAAAA,EAA8EuG,IAAI,CAAlFvG,iBAAAA;;AACA,gBAAIqK,YAAY,GAAGvC,gBAAgB,CAAhBA,QAAAA,GAAAA,MAAAA,CAAmC,MAAtD,+BAAmBA,CAAnB;;AACA,gBAAIvB,IAAI,CAAJA,eAAAA,CAAJ,SAAIA,CAAJ,EAAqC;AACjC,kBAAI,MAAM8D,YAAY,CAAtB,MAAA,EAA+B;AAC3BA,gBAAAA,YAAY,CAAZA,MAAAA;AACH;;AACD9D,cAAAA,IAAI,CAAJA,kBAAAA,CAAAA,SAAAA,EAAAA,KAAAA,EAAAA,QAAAA,CAAmDuB,gBAAgB,CAAnEvB,MAAmDuB,EAAnDvB;AAJJ,aAAA,MAKO;AACH8D,cAAAA,YAAY,CAAZA,MAAAA;AACH;;AACDvC,YAAAA,gBAAgB,CAAhBA,IAAAA,CAAsBqC,gBAAgB,CAAtCrC,IAAAA;;AACAmC,YAAAA,MAAM,CAANA,aAAAA;AACH;AAxBH,SAAA;AA0BF3B,QAAAA,QAAQ,EAAEtG;AA1BR;AAFwC,KAA3B,EAAA,QAAA,CAAA,8BAAA,EAAA,QAAA,CAAA,mCAAA,EAAA,IAAA,CAAA,UAAA,EAAvB,CAAuB,CAAvB;;AA+BA,WAAA,gBAAA;AAtTiC,GAAA;AAwTrCsI,EAAAA,+BAA+B,EAAE,SAAA,+BAAA,CAAA,SAAA,EAAA,KAAA,EAAA,KAAA,EAAkC;AAC/D,SAAA,8BAAA,CAAA,SAAA,EAAA,KAAA,EAAA,QAAA,CAAA,KAAA;;AACA,QAAI,KAAA,eAAA,CAAJ,SAAI,CAAJ,EAAqC;AACjC,WAAA,kBAAA,CAAA,SAAA,EAAA,KAAA,EAAA,QAAA,CAAA,KAAA;AACH;AA5TgC,GAAA;AA8TrCC,EAAAA,0BAA0B,EAAE,SAAA,0BAAA,CAAA,MAAA,EAAA,SAAA,EAAA,KAAA,EAAmC;AAC3D,QAAIC,MAAM,GAAV,IAAA;;AACA,QAAIjE,IAAI,GAAR,IAAA;AACA,QAAIlC,uBAAuB,GAAG,KAAA,MAAA,CAA9B,yBAA8B,CAA9B;;AACA,QAAI2D,KAAK,GAAGhI,OAAO,CAAPA,OAAAA,CAAAA,QAAAA,CAAAA,MAAAA,EAAZ,uBAAYA,CAAZ;;AACA,QAAIyK,IAAI,GAAGzK,OAAO,CAAPA,OAAAA,CAAAA,QAAAA,CAAyBuH,KAAK,CAALA,IAAAA,IAAcA,KAAK,CAA5CvH,SAAAA,EAAX,KAAWA,CAAX;;AACA,QAAI0K,cAAc,GAAG,SAAjBA,cAAiB,CAAA,IAAA,EAAA,KAAA,EAAsB;AACvC,aAAOrG,uBAAuB,GAAGrE,OAAO,CAAPA,OAAAA,CAAAA,qBAAAA,CAAAA,IAAAA,EAAH,KAAGA,CAAH,GAAwDyK,IAAI,CAA1F,OAAA;AADJ,KAAA;;AAGA,QAAIE,YAAY,GAAG,KAAA,qBAAA,CAA2B;AAC1C9C,MAAAA,OAAO,EAAE6C,cAAc,CAAA,IAAA,EADmB,KACnB,CADmB;AAE1C3C,MAAAA,IAAI,EAAE;AACFC,QAAAA,KAAK,EADH,KAAA;AAEF4C,QAAAA,aAAa,EAFX,OAAA;AAGF1C,QAAAA,OAAO,EAHL,IAAA;AAIF2C,QAAAA,QAAQ,EAJN,UAAA;AAKF5C,QAAAA,WAAW,EALT,SAAA;AAMFE,QAAAA,WAAW,EAAE,SAAA,WAAA,CAAA,CAAA,EAAY;AACrB,cAAIsC,IAAI,KAAKrC,CAAC,CAAd,QAAA,EAAyB;AACrBqC,YAAAA,IAAI,GAAGrC,CAAC,CAARqC,QAAAA;AACAV,YAAAA,SAAS,CAATA,CAAS,CAATA,GAAeU,IAAI,CAAJA,IAAAA,IAAaA,IAAI,CAAhCV,SAAAA;AACAA,YAAAA,SAAS,CAATA,CAAS,CAATA,GAAe,aAAaU,IAAI,CAAjB,QAAA,GAAA,IAAA,GAAfV,EAAAA;;AACA/J,YAAAA,OAAO,CAAPA,OAAAA,CAAAA,0BAAAA,CAAAA,SAAAA,EAAsDA,OAAO,CAAPA,OAAAA,CAAAA,mBAAAA,CAAtDA,IAAsDA,CAAtDA,EAAiGuG,IAAI,CAArGvG,iBAAAA;;AACA2K,YAAAA,YAAY,CAAZA,QAAAA,GAAAA,MAAAA,CAA+B,MAA/BA,8BAAAA,EAAAA,MAAAA;;AACApE,YAAAA,IAAI,CAAJA,+BAAAA,CAAAA,SAAAA,EAAAA,IAAAA,EAAsDoE,YAAY,CAAlEpE,MAAsDoE,EAAtDpE;;AACA,gBAAIsB,OAAO,GAAG6C,cAAc,CAAA,IAAA,EAAOtC,CAAC,CAADA,SAAAA,CAAAA,MAAAA,CAAnC,OAAmCA,CAAP,CAA5B;AACAuC,YAAAA,YAAY,CAAZA,IAAAA,CAAAA,OAAAA;;AACAH,YAAAA,MAAM,CAANA,aAAAA;AACH;AAjBH,SAAA;AAmBFnC,QAAAA,cAAc,EAAE,SAAA,cAAA,CAAA,CAAA,EAAY;AACxBD,UAAAA,CAAC,CAADA,SAAAA,CAAAA,UAAAA,CAAAA,IAAAA;AApBF,SAAA;AAsBFE,QAAAA,QAAQ,EAAErG;AAtBR;AAFoC,KAA3B,EAAA,QAAA,CAAA,8BAAA,EAAA,QAAA,CAAA,+BAAA,EAAA,IAAA,CAAA,UAAA,EAAnB,CAAmB,CAAnB;;AA2BA,WAAA,YAAA;AAlWiC,GAAA;AAoWrC6I,EAAAA,oBAAoB,EAAE,SAAA,oBAAA,CAAA,SAAA,EAAA,MAAA,EAA4B;AAC9C,QAAIC,MAAM,GAAV,IAAA;;AACA,QAAIC,KAAK,GAAG,CAAC,GAAGhM,UAAU,CAAd,OAAA,EAAA,OAAA,EAAA,QAAA,CAAZ,+BAAY,CAAZ;;AACA,QAAIiF,MAAM,GAAG,KAAb,oBAAa,EAAb;;AACA,QAAIsD,KAAK,GAAGvH,OAAO,CAAPA,OAAAA,CAAAA,QAAAA,CAAyB+J,SAAS,CAAlC/J,CAAkC,CAAlCA,EAAZ,MAAYA,CAAZ;;AACA,SAAA,mBAAA,CAAyB,YAAW;AAChCA,MAAAA,OAAO,CAAPA,OAAAA,CAAAA,UAAAA,CAAAA,MAAAA,EAAAA,SAAAA;;AACA,UAAIiL,aAAa,GAAG,MAAMD,KAAK,CAALA,MAAAA,GAAAA,QAAAA,GAA1B,MAAA;;AACA,UAAA,aAAA,EAAmB;AACfA,QAAAA,KAAK,CAALA,MAAAA,GAAAA,MAAAA;AADJ,OAAA,MAEO;AACHA,QAAAA,KAAK,CAALA,MAAAA;AACH;;AACDD,MAAAA,MAAM,CAANA,aAAAA;AARJ,KAAA,EAAA,QAAA,CAAA,KAAA;;AAUA,SAAA,0BAAA,CAAA,MAAA,EAAA,SAAA,EAAA,KAAA,EAAA,QAAA,CAAA,KAAA;;AACA,SAAA,+BAAA,CAAA,SAAA,EAAA,KAAA,EAAA,KAAA;;AACA,WAAA,KAAA;AArXiC,GAAA;AAuXrCG,EAAAA,mBAAmB,EAAE,SAAA,mBAAA,CAAA,QAAA,EAAmB;AACpC,QAAI/G,eAAe,GAAG,KAAA,MAAA,CAAtB,iBAAsB,CAAtB;AACA,QAAIG,0BAA0B,GAAG,KAAA,MAAA,CAAjC,4BAAiC,CAAjC;;AACA,QAAI,CAAA,eAAA,IAAoB,CAACH,eAAe,CAAxC,MAAA,EAAiD;AAC7CA,MAAAA,eAAe,GAAG,CAACnE,OAAO,CAAPA,OAAAA,CAAAA,aAAAA,CAAAA,QAAAA,EAAAA,OAAAA,CAAAA,GAAAA,EAAnBmE,KAAmBnE,CAAD,CAAlBmE;AACH;;AACD,WAAO,eAAe,CAAf,GAAA,CAAoB,UAAA,SAAA,EAAoB;AAC3C,aAAO;AACHgH,QAAAA,IAAI,EAAE7G,0BAA0B,CAD7B,SAC6B,CAD7B;AAEHd,QAAAA,KAAK,EAAET,SAAS,CAAA,SAAA;AAFb,OAAP;AADJ,KAAO,CAAP;AA7XiC,GAAA;AAoYrCqI,EAAAA,mBAAmB,EAAE,SAAA,mBAAA,CAAA,OAAA,EAAkB;AACnC,QAAIC,aAAa,GAAG,CAAC,GAAGrM,UAAU,CAAd,OAAA,EAAA,OAAA,EAAA,QAAA,CAAA,0BAAA,EAAA,QAAA,CAAA,iCAAA,EAAA,QAAA,CAAA,2BAAA,EAAA,IAAA,CAAA,UAAA,EAApB,CAAoB,CAApB;;AACA,SAAA,4BAAA,CAAA,aAAA,EAAA,OAAA;;AACA,WAAA,aAAA;AAvYiC,GAAA;AAyYrCsM,EAAAA,gBAAgB,EAAE,SAAA,gBAAA,CAAA,eAAA,EAAA,mBAAA,EAAA,UAAA,EAA2D;AACzE,QAAA,OAAA;AACA,QAAIlH,aAAa,GAAG,KAAA,MAAA,CAApB,eAAoB,CAApB;;AACA,QAAI,CAAC,GAAGjE,KAAK,CAAT,SAAA,EAAA,aAAA,KAAuC0G,UAAU,IAArD,aAAA,EAAwE;AACpEgC,MAAAA,OAAO,GAAG,KAAVA,aAAU,EAAVA;;AACA,WAAA,4BAAA,CAAA,OAAA,EAAA,mBAAA;AAFJ,KAAA,MAGO;AACHA,MAAAA,OAAO,GAAG,KAAA,qBAAA,CAA2B;AACjCd,QAAAA,IAAI,EAAE;AACFC,UAAAA,KAAK,EAAE,CAAC;AACJH,YAAAA,OAAO,EAAE/H,SAAS,CAATA,OAAAA,CAAAA,MAAAA,CADL,8BACKA,CADL;AAEJyL,YAAAA,KAAK,EAAEC;AAFH,WAAD,EAGJ;AACC3D,YAAAA,OAAO,EAAE/H,SAAS,CAATA,OAAAA,CAAAA,MAAAA,CADV,0BACUA,CADV;AAECyL,YAAAA,KAAK,EAAEE;AAFR,WAHI,CADL;AAQFxD,UAAAA,WAAW,EART,SAAA;AASFE,UAAAA,WAAW,EAAE,SAAA,WAAA,CAAA,CAAA,EAAY;AACrBC,YAAAA,CAAC,CAADA,QAAAA,CAAAA,KAAAA;AAVF,WAAA;AAYFE,UAAAA,QAAQ,EAAEpG;AAZR;AAD2B,OAA3B,CAAV2G;AAgBH;;AACD,WAAOA,OAAO,CAAPA,QAAAA,CAAAA,0BAAAA,EAAAA,QAAAA,CAAAA,8BAAAA,EAAAA,QAAAA,CAAAA,2BAAAA,EAAAA,IAAAA,CAAAA,UAAAA,EAAP,CAAOA,CAAP;AAjaiC,GAAA;AAmarC6C,EAAAA,gBAAgB,EAAE,SAAA,gBAAA,CAAA,IAAA,EAAA,KAAA,EAAA,UAAA,EAAkC;AAChD,QAAInF,IAAI,GAAR,IAAA;AACA,QAAIoF,KAAK,GAAG,CAAC,GAAG3M,UAAU,CAAd,OAAA,EAAA,OAAA,EAAA,IAAA,CAAA,QAAA,EAAA,QAAA,CAAA,oCAAA,EAAA,IAAA,CAAA,UAAA,EAAA,CAAA,EAAA,QAAA,CAAZ,UAAY,CAAZ;AACA,QAAIwE,KAAK,GAAGiH,IAAI,CAAhB,CAAgB,CAAhB;;AACA,QAAI9G,eAAe,GAAG3D,OAAO,CAAPA,OAAAA,CAAAA,kBAAAA,CAAmCuG,IAAI,CAAvCvG,iBAAAA,EAA2DyK,IAAI,CAArF,CAAqF,CAA/DzK,CAAtB;;AACA,QAAI,CAAA,eAAA,IAAoBuH,KAAK,CAA7B,MAAA,EAAsC;AAClCvH,MAAAA,OAAO,CAAPA,OAAAA,CAAAA,yBAAAA,CAAAA,KAAAA,EAAAA,KAAAA,EAAwD,UAAA,MAAA,EAAiB;AACrEqD,QAAAA,eAAe,CAAA,KAAA,EAAfA,MAAe,CAAfA;AADJrD,OAAAA;AADJ,KAAA,MAIO;AACHE,MAAAA,UAAU,CAAVA,OAAAA,CAAAA,IAAAA,CAAwBF,OAAO,CAAPA,OAAAA,CAAAA,mBAAAA,CAAAA,KAAAA,EAAAA,KAAAA,EAAxBE,eAAwBF,CAAxBE,EAAAA,IAAAA,CAAiG,UAAA,MAAA,EAAiB;AAC9GmD,QAAAA,eAAe,CAAA,KAAA,EAAA,MAAA,EAAfA,eAAe,CAAfA;AADJnD,OAAAA;AAGH;;AACDqG,IAAAA,IAAI,CAAJA,4BAAAA,CAAAA,KAAAA,EAAyC,UAAA,CAAA,EAAY;AACjD,UAAI,YAAY6B,CAAC,CAAjB,IAAA,EAAwB;AACpBA,QAAAA,CAAC,CAADA,eAAAA;AACH;;AACD7B,MAAAA,IAAI,CAAJA,4BAAAA,CAAAA,IAAAA,EAAAA,KAAAA,EAAAA,UAAAA;AAJJA,KAAAA;;AAMA,WAAA,KAAA;AAvbiC,GAAA;AAybrCqF,EAAAA,qBAAqB,EAAE,SAAA,qBAAA,CAAA,IAAA,EAAA,KAAA,EAAA,QAAA,EAAgC;AACnD,QAAIC,kBAAkB,GAAGpB,IAAI,CAAJA,CAAI,CAAJA,KAAzB,KAAA;;AACA,QAAA,kBAAA,EAAwB;AACpBA,MAAAA,IAAI,CAAJA,CAAI,CAAJA,GAAAA,KAAAA;AACH;;AACDqB,IAAAA,QAAQ;;AACR,SAAA,aAAA;AA/biC,GAAA;AAicrCC,EAAAA,iBAAiB,EAAE,SAAA,iBAAA,CAAA,OAAA,EAAA,OAAA,EAA2B;AAC1C,QAAIC,QAAQ,GAAG7M,aAAa,CAAbA,OAAAA,CAAf,WAAeA,EAAf;;AACA,QAAI8M,oBAAoB,GAAG,SAAvBA,oBAAuB,CAAA,CAAA,EAAY;AACnC,UAAIC,WAAW,IAAf,uBAAA,EAA4C;AACxCC,QAAAA,uBAAuB,GAAvBA,KAAAA;AACA;AACH;;AACDxD,MAAAA,OAAO,CAAPA,CAAO,CAAPA;AALJ,KAAA;;AAOApJ,IAAAA,eAAe,CAAfA,OAAAA,CAAAA,EAAAA,CAAAA,QAAAA,EAAAA,OAAAA,EAAAA,oBAAAA;;AACA,QAAI2M,WAAW,GAAf,KAAA;AACA,QAAIC,uBAAuB,GAA3B,KAAA;AACA,QAAIC,KAAK,GAAGC,OAAO,CAAPA,IAAAA,CAAZ,OAAYA,CAAZ;;AACA9M,IAAAA,eAAe,CAAfA,OAAAA,CAAAA,EAAAA,CAAAA,KAAAA,EAAAA,kBAAAA,EAAsD,YAAW;AAC7D2M,MAAAA,WAAW,GAAXA,IAAAA;AADJ3M,KAAAA;;AAGAA,IAAAA,eAAe,CAAfA,OAAAA,CAAAA,EAAAA,CAAAA,KAAAA,EAAAA,gBAAAA,EAAoD,YAAW;AAC3D2M,MAAAA,WAAW,GAAXA,KAAAA;AACAC,MAAAA,uBAAuB,GAAvBA,IAAAA;AAFJ5M,KAAAA;;AAIAA,IAAAA,eAAe,CAAfA,OAAAA,CAAAA,EAAAA,CAAAA,KAAAA,EAAAA,SAAAA,EAA6C,UAAA,KAAA,EAAgB;AACzD,UAAI,QAAQ+M,KAAK,CAAjB,KAAA,EAAyB;AACrBH,QAAAA,uBAAuB,GAAvBA,KAAAA;AACH;AAHL5M,KAAAA;;AAKA,SAAA,qBAAA,GAAA,oBAAA;AA1diC,GAAA;AA4drCgN,EAAAA,iBAAiB,EAAE,SAAA,iBAAA,CAAA,OAAA,EAAA,eAAA,EAAmC;AAClD,QAAIC,MAAM,GAAV,IAAA;;AACA,QAAIR,QAAQ,GAAG7M,aAAa,CAAbA,OAAAA,CAAf,WAAeA,EAAf;;AACA,QAAIsN,oBAAoB,GAAG,SAAvBA,oBAAuB,CAAA,CAAA,EAAY;AACnC,UAAI,CAACD,MAAM,CAANA,qBAAAA,CAAAA,OAAAA,EAAsCpE,CAAC,CAA5C,MAAKoE,CAAL,EAAsD;AAClDjN,QAAAA,eAAe,CAAfA,OAAAA,CAAAA,OAAAA,CAAgC8M,OAAO,CAAPA,IAAAA,CAAhC9M,OAAgC8M,CAAhC9M,EAAAA,QAAAA;;AACAmN,QAAAA,eAAe;AAClB;AAJL,KAAA;;AAMAnN,IAAAA,eAAe,CAAfA,OAAAA,CAAAA,EAAAA,CAAAA,QAAAA,EAAAA,eAAAA,EAAAA,oBAAAA;;AACA,SAAA,qBAAA,GAAA,oBAAA;AAteiC,GAAA;AAwerCoN,EAAAA,qBAAqB,EAAE,SAAA,qBAAA,CAAA,OAAA,EAAA,MAAA,EAA0B;AAC7C,QAAIC,aAAa,GAAGC,MAAM,IAAI1N,aAAa,CAAbA,OAAAA,CAA9B,gBAA8BA,EAA9B;;AACA,WAAO,CAAC,GAAGH,UAAU,CAAd,OAAA,EAAA,aAAA,EAAA,OAAA,CAA+CqN,OAAO,CAAtD,QAA+CA,EAA/C,EAAA,MAAA,IAA6E,CAAC,GAAGrN,UAAU,CAAd,OAAA,EAAA,aAAA,EAAA,OAAA,CAAA,4BAAA,EAApF,MAAA;AA1eiC,GAAA;AA4erC8N,EAAAA,aAAa,EAAE,SAAA,aAAA,GAAW;AACtB,QAAId,QAAQ,GAAG7M,aAAa,CAAbA,OAAAA,CAAf,WAAeA,EAAf;;AACA,KAAC,GAAGgB,KAAK,CAAT,SAAA,EAAqB,KAArB,qBAAA,KAAoDZ,eAAe,CAAfA,OAAAA,CAAAA,GAAAA,CAAAA,QAAAA,EAAAA,OAAAA,EAA+C,KAAnG,qBAAoDA,CAApD;AACA,KAAC,GAAGY,KAAK,CAAT,SAAA,EAAqB,KAArB,qBAAA,KAAoDZ,eAAe,CAAfA,OAAAA,CAAAA,GAAAA,CAAAA,QAAAA,EAAAA,eAAAA,EAAuD,KAA3G,qBAAoDA,CAApD;AA/eiC,GAAA;AAifrCwN,EAAAA,QAAQ,EAAE,SAAA,QAAA,GAAW;AACjB,SAAA,aAAA;;AACA,SAAA,QAAA;AAnfiC,GAAA;AAqfrCC,EAAAA,4BAA4B,EAAE,SAAA,4BAAA,CAAA,IAAA,EAAA,KAAA,EAAA,UAAA,EAAkC;AAC5D,QAAIC,MAAM,GAAV,IAAA;;AACA,QAAIzJ,KAAK,GAAGiH,IAAI,CAAhB,CAAgB,CAAhB;;AACA,QAAIyC,eAAe,GAAG,SAAlBA,eAAkB,GAAW;AAC7BzJ,MAAAA,UAAU,CAAVA,KAAAA;;AACAwJ,MAAAA,MAAM,CAANA,aAAAA;;AACA,aAAOA,MAAM,CAANA,gBAAAA,CAAAA,IAAAA,EAAAA,KAAAA,EAAP,UAAOA,CAAP;AAHJ,KAAA;;AAKA,QAAIE,WAAW,GAAG,SAAdA,WAAc,GAAW;AACzBF,MAAAA,MAAM,CAANA,qBAAAA,CAAAA,IAAAA,EAAAA,KAAAA,EAA0C,YAAW;AACjDC,QAAAA,eAAe;AADnBD,OAAAA;AADJ,KAAA;;AAKA,QAAInE,OAAO,GAAG;AACVtF,MAAAA,KAAK,EAAE,OAAA,KAAA,GAAA,IAAA,GADG,KAAA;AAEV4J,MAAAA,eAAe,EAAEpN,OAAO,CAAPA,OAAAA,CAAAA,iBAAAA,CAFP,IAEOA,CAFP;AAGVqN,MAAAA,QAAQ,EAAE,SAAA,QAAA,CAAA,IAAA,EAAe;AACrB7J,QAAAA,KAAK,GAAG,SAAA,IAAA,GAAA,EAAA,GAARA,IAAAA;AAJM,OAAA;AAMV2J,MAAAA,WAAW,EAND,WAAA;AAOVhC,MAAAA,IAAI,EAAE1H,UAAU,CAAVA,IAAAA;AAPI,KAAd;AASAA,IAAAA,UAAU,CAAVA,KAAAA;;AACA,QAAI4I,OAAO,GAAG,KAAA,kBAAA,CAAA,UAAA,EAAA,KAAA,EAAd,OAAc,CAAd;;AACA9M,IAAAA,eAAe,CAAfA,OAAAA,CAAAA,OAAAA,CAAgC8M,OAAO,CAAPA,IAAAA,CAAAA,OAAAA,EAAAA,GAAAA,CAAAA,SAAAA,EAAAA,EAAAA,CAAhC9M,CAAgC8M,CAAhC9M,EAAAA,OAAAA;;AACA,SAAA,aAAA;;AACA,SAAA,iBAAA,CAAA,OAAA,EAAA,WAAA;;AACA,SAAA,iBAAA,CAAA,OAAA,EAAgC,UAAA,CAAA,EAAY;AACxC,UAAIsK,OAAO,GAAG,CAAC,GAAGlJ,OAAO,CAAX,gBAAA,EAAd,CAAc,CAAd;;AACA,UAAIkJ,OAAO,KAAX,OAAA,EAAyB;AACrB,YAAIoD,MAAM,CAANA,qBAAAA,CAAJ,OAAIA,CAAJ,EAA2C;AACvC;AACH;;AACDA,QAAAA,MAAM,CAANA,qBAAAA,CAAAA,IAAAA,EAAAA,KAAAA,EAA0C,YAAW;AACjDC,UAAAA,eAAe;;AACf,cAAI9E,CAAC,CAAL,QAAA,EAAgB;AACZ7I,YAAAA,eAAe,CAAfA,OAAAA,CAAAA,OAAAA,CAAgCkE,UAAU,CAA1ClE,IAAgCkE,EAAhClE,EAAAA,OAAAA;AACH;AAJL0N,SAAAA;AAMH;;AACD,UAAIpD,OAAO,KAAX,UAAA,EAA4B;AACxBtK,QAAAA,eAAe,CAAfA,OAAAA,CAAAA,OAAAA,CAAgC2N,eAAhC3N,EAAAA,EAAAA,OAAAA;AACH;;AACD,UAAIsK,OAAO,KAAX,SAAA,EAA2B;AACvBoD,QAAAA,MAAM,CAANA,qBAAAA,CAAAA,IAAAA,EAAAA,KAAAA,EAA0C,YAAW;AACjD1N,UAAAA,eAAe,CAAfA,OAAAA,CAAAA,OAAAA,CAAgC2N,eAAhC3N,EAAAA,EAAAA,OAAAA;AADJ0N,SAAAA;AAGH;AApBL,KAAA;;AAsBA,SAAA,uBAAA;AAtiBiC,GAAA;AAwiBrCK,EAAAA,kBAAkB,EAAE,SAAA,kBAAA,CAAA,IAAA,EAAA,KAAA,EAAsB;AACtC,QAAIjD,YAAY,GAAG,CAAC,GAAGrL,UAAU,CAAd,OAAA,EAAA,OAAA,EAAA,QAAA,CAAA,8BAAA,EAAA,QAAA,CAAnB,+BAAmB,CAAnB;;AACA,SAAA,gBAAA,CAAA,IAAA,EAAA,KAAA,EAAA,YAAA;;AACA,WAAA,YAAA;AA3iBiC,GAAA;AA6iBrCuO,EAAAA,kBAAkB,EAAE,SAAA,kBAAA,CAAA,UAAA,EAAA,KAAA,EAAA,OAAA,EAAqC;AACrD,QAAIlB,OAAO,GAAG,CAAC,GAAGrN,UAAU,CAAd,OAAA,EAAA,OAAA,EAAA,IAAA,CAAA,UAAA,EAAA,CAAA,EAAA,QAAA,CAAd,UAAc,CAAd;;AACA,QAAI2E,eAAe,GAAG3D,OAAO,CAAPA,OAAAA,CAAAA,kBAAAA,CAAmC,KAAnCA,iBAAAA,EAA2D8I,OAAO,CAAxF,eAAsB9I,CAAtB;;AACA,QAAIwN,cAAc,GAAG7J,eAAe,IAAIA,eAAe,CAAlCA,cAAAA,GAAoDA,eAAe,CAAnEA,cAAAA,GAAqF4D,KAAK,CAA/G,cAAA;;AACA,QAAA,cAAA,EAAoB;AAChB,UAAIkG,QAAQ,GAAG,KAAA,YAAA,CAAf,cAAe,CAAf;;AACAA,MAAAA,QAAQ,CAARA,MAAAA,CAAgB;AACZC,QAAAA,KAAK,EAAE,CAAC,GAAG9N,OAAO,CAAX,MAAA,EAAoB;AACvB2H,UAAAA,KAAK,EAAEA;AADgB,SAApB,EADK,OACL,CADK;AAIZoG,QAAAA,SAAS,EAAEtB;AAJC,OAAhBoB;AAFJ,KAAA,MAQO;AACH,WAAA,cAAA,CAAA,YAAA,CAAA,IAAA,CAAA,IAAA,EAAA,OAAA,EAAqD,CAAC,GAAG7N,OAAO,CAAX,MAAA,EAAA,EAAA,EAAA,KAAA,EAAA,OAAA,EAAwC;AACzFgO,QAAAA,UAAU,EAAEvL;AAD6E,OAAxC,CAArD;AAGH;;AACD,WAAA,OAAA;AA9jBiC,GAAA;AAgkBrCwL,EAAAA,wBAAwB,EAAE,SAAA,wBAAA,CAAA,OAAA,EAAA,UAAA,EAA8B;AACpD,QAAItH,IAAI,GAAR,IAAA;AACA,QAAIuH,MAAM,GAAG,CAAC,GAAG9O,UAAU,CAAd,OAAA,EAAA,OAAA,EAAA,QAAA,CAA0C8J,OAAO,CAAPA,IAAAA,CAA1C,QAAA,EAAA,QAAA,CAAb,UAAa,CAAb;;AACA,SAAA,gBAAA,CAAA,MAAA,EAA8BvI,OAAO,CAArC,OAAA,EAA+C;AAC3C0I,MAAAA,QAAQ,EAAEH,OAAO,CAAPA,IAAAA,CADiC,QAAA;AAE3CU,MAAAA,QAAQ,EAAEV,OAAO,CAAPA,IAAAA,CAFiC,QAAA;AAG3CL,MAAAA,UAAU,EAAEK,OAAO,CAAPA,IAAAA,CAH+B,UAAA;AAI3CF,MAAAA,QAAQ,EAAEE,OAAO,CAAPA,IAAAA,CAJiC,QAAA;AAK3CS,MAAAA,SAAS,EAAET,OAAO,CAAPA,IAAAA,CALgC,SAAA;AAM3CiF,MAAAA,eAAe,EAAE,SAAA,eAAA,CAAA,cAAA,EAAyB;AACtC,YAAIC,cAAc,GAAG,CAAC,GAAGhP,UAAU,CAAd,OAAA,EAAA,OAAA,EAAA,QAAA,CAArB,cAAqB,CAArB;;AACAuH,QAAAA,IAAI,CAAJA,gBAAAA,CAAAA,cAAAA,EAAsClG,WAAW,CAAjDkG,OAAAA,EAA2DuC,OAAO,CAAlEvC,IAAAA;;AACA,aAAA,OAAA;AATuC,OAAA;AAW3C0H,MAAAA,SAAS,EAAE,SAAA,SAAA,GAAW;AAClB,eAAO,CAAC,GAAGzN,OAAO,CAAX,2BAAA,EAAyCsI,OAAO,CAAPA,IAAAA,CAAAA,QAAAA,CAAhD,EAAO,CAAP;AAZuC,OAAA;AAc3CoF,MAAAA,OAAO,EAdoC,IAAA;AAe3CnF,MAAAA,iBAAiB,EAf0B,KAAA;AAgB3CoF,MAAAA,mBAAmB,EAAE,KAAA,MAAA,CAhBsB,0BAgBtB,CAhBsB;AAiB3CC,MAAAA,mBAAmB,EAjBwB,IAAA;AAkB3C3E,MAAAA,OAAO,EAAEX,OAAO,CAAPA,KAAAA,CAlBkC,OAAA;AAmB3CuF,MAAAA,OAAO,EAnBoC,KAAA;AAoB3CC,MAAAA,KAAK,EApBsC,MAAA;AAqB3CC,MAAAA,MAAM,EArBqC,MAAA;AAsB3CC,MAAAA,SAAS,EAAE;AAtBgC,KAA/C;AAnkBiC,GAAA;AA4lBrCC,EAAAA,4BAA4B,EAAE,SAAA,4BAAA,CAAA,OAAA,EAAA,OAAA,EAA2B;AACrDlP,IAAAA,eAAe,CAAfA,OAAAA,CAAAA,EAAAA,CAAAA,OAAAA,EAAAA,SAAAA,EAAAA,OAAAA;;AACAA,IAAAA,eAAe,CAAfA,OAAAA,CAAAA,EAAAA,CAAAA,OAAAA,EAAAA,OAAAA,EAA6C,UAAA,CAAA,EAAY;AACrD,UAAI,CAAC,GAAGoB,OAAO,CAAX,gBAAA,EAAA,CAAA,MAAJ,SAAA,EAAoD;AAChDgI,QAAAA,OAAO,CAAPA,CAAO,CAAPA;AACH;AAHLpJ,KAAAA;AAKH;AAnmBoC,CAArB,CAApB;;AAqmBA,CAAC,GAAGI,uBAAuB,CAA3B,OAAA,EAAA,iBAAA,EAAA,aAAA;AACA+O,MAAM,CAANA,OAAAA,GAAAA,aAAAA;AACAA,MAAM,CAANA,OAAAA,CAAAA,eAAAA,GAAAA,eAAAA","sourcesContent":["/**\r\n * DevExtreme (ui/filter_builder/filter_builder.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar _renderer = require(\"../../core/renderer\");\r\nvar _renderer2 = _interopRequireDefault(_renderer);\r\nvar _dom_adapter = require(\"../../core/dom_adapter\");\r\nvar _dom_adapter2 = _interopRequireDefault(_dom_adapter);\r\nvar _class = require(\"../../core/class\");\r\nvar _class2 = _interopRequireDefault(_class);\r\nvar _events_engine = require(\"../../events/core/events_engine\");\r\nvar _events_engine2 = _interopRequireDefault(_events_engine);\r\nvar _ui = require(\"../widget/ui.widget\");\r\nvar _ui2 = _interopRequireDefault(_ui);\r\nvar _component_registrator = require(\"../../core/component_registrator\");\r\nvar _component_registrator2 = _interopRequireDefault(_component_registrator);\r\nvar _extend = require(\"../../core/utils/extend\");\r\nvar _message = require(\"../../localization/message\");\r\nvar _message2 = _interopRequireDefault(_message);\r\nvar _utils = require(\"./utils\");\r\nvar _utils2 = _interopRequireDefault(_utils);\r\nvar _deferred = require(\"../../core/utils/deferred\");\r\nvar _deferred2 = _interopRequireDefault(_deferred);\r\nvar _type = require(\"../../core/utils/type\");\r\nvar _tree_view = require(\"../tree_view\");\r\nvar _tree_view2 = _interopRequireDefault(_tree_view);\r\nvar _popup = require(\"../popup\");\r\nvar _popup2 = _interopRequireDefault(_popup);\r\nvar _utils3 = require(\"../overlay/utils\");\r\nvar _ui3 = require(\"../shared/ui.editor_factory_mixin\");\r\nvar _ui4 = _interopRequireDefault(_ui3);\r\nvar _utils4 = require(\"../../events/utils\");\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\nvar FILTER_BUILDER_CLASS = \"dx-filterbuilder\";\r\nvar FILTER_BUILDER_GROUP_CLASS = FILTER_BUILDER_CLASS + \"-group\";\r\nvar FILTER_BUILDER_GROUP_ITEM_CLASS = FILTER_BUILDER_GROUP_CLASS + \"-item\";\r\nvar FILTER_BUILDER_GROUP_CONTENT_CLASS = FILTER_BUILDER_GROUP_CLASS + \"-content\";\r\nvar FILTER_BUILDER_GROUP_OPERATIONS_CLASS = FILTER_BUILDER_GROUP_CLASS + \"-operations\";\r\nvar FILTER_BUILDER_GROUP_OPERATION_CLASS = FILTER_BUILDER_GROUP_CLASS + \"-operation\";\r\nvar FILTER_BUILDER_ACTION_CLASS = FILTER_BUILDER_CLASS + \"-action\";\r\nvar FILTER_BUILDER_IMAGE_CLASS = FILTER_BUILDER_ACTION_CLASS + \"-icon\";\r\nvar FILTER_BUILDER_IMAGE_ADD_CLASS = \"dx-icon-plus\";\r\nvar FILTER_BUILDER_IMAGE_REMOVE_CLASS = \"dx-icon-remove\";\r\nvar FILTER_BUILDER_ITEM_TEXT_CLASS = FILTER_BUILDER_CLASS + \"-text\";\r\nvar FILTER_BUILDER_ITEM_TEXT_PART_CLASS = FILTER_BUILDER_ITEM_TEXT_CLASS + \"-part\";\r\nvar FILTER_BUILDER_ITEM_TEXT_SEPARATOR_CLASS = FILTER_BUILDER_ITEM_TEXT_CLASS + \"-separator\";\r\nvar FILTER_BUILDER_ITEM_TEXT_SEPARATOR_EMPTY_CLASS = FILTER_BUILDER_ITEM_TEXT_SEPARATOR_CLASS + \"-empty\";\r\nvar FILTER_BUILDER_ITEM_FIELD_CLASS = FILTER_BUILDER_CLASS + \"-item-field\";\r\nvar FILTER_BUILDER_ITEM_OPERATION_CLASS = FILTER_BUILDER_CLASS + \"-item-operation\";\r\nvar FILTER_BUILDER_ITEM_VALUE_CLASS = FILTER_BUILDER_CLASS + \"-item-value\";\r\nvar FILTER_BUILDER_ITEM_VALUE_TEXT_CLASS = FILTER_BUILDER_CLASS + \"-item-value-text\";\r\nvar FILTER_BUILDER_OVERLAY_CLASS = FILTER_BUILDER_CLASS + \"-overlay\";\r\nvar FILTER_BUILDER_FILTER_OPERATIONS_CLASS = FILTER_BUILDER_CLASS + \"-operations\";\r\nvar FILTER_BUILDER_FIELDS_CLASS = FILTER_BUILDER_CLASS + \"-fields\";\r\nvar FILTER_BUILDER_ADD_CONDITION_CLASS = FILTER_BUILDER_CLASS + \"-add-condition\";\r\nvar ACTIVE_CLASS = \"dx-state-active\";\r\nvar FILTER_BUILDER_MENU_CUSTOM_OPERATION_CLASS = FILTER_BUILDER_CLASS + \"-menu-custom-operation\";\r\nvar SOURCE = \"filterBuilder\";\r\nvar DISABLED_STATE_CLASS = \"dx-state-disabled\";\r\nvar TAB_KEY = \"tab\";\r\nvar ENTER_KEY = \"enter\";\r\nvar ESCAPE_KEY = \"escape\";\r\nvar ACTIONS = [{\r\n    name: \"onEditorPreparing\",\r\n    config: {\r\n        excludeValidators: [\"disabled\", \"readOnly\"],\r\n        category: \"rendering\"\r\n    }\r\n}, {\r\n    name: \"onEditorPrepared\",\r\n    config: {\r\n        excludeValidators: [\"disabled\", \"readOnly\"],\r\n        category: \"rendering\"\r\n    }\r\n}, {\r\n    name: \"onValueChanged\",\r\n    config: {\r\n        excludeValidators: [\"disabled\", \"readOnly\"]\r\n    }\r\n}];\r\nvar OPERATORS = {\r\n    and: \"and\",\r\n    or: \"or\",\r\n    notAnd: \"!and\",\r\n    notOr: \"!or\"\r\n};\r\nvar EditorFactory = _class2.default.inherit(_ui4.default);\r\nvar renderValueText = function($container, value, customOperation) {\r\n    if (Array.isArray(value)) {\r\n        var lastItemIndex = value.length - 1;\r\n        $container.empty();\r\n        value.forEach(function(t, i) {\r\n            (0, _renderer2.default)(\"<span>\").addClass(FILTER_BUILDER_ITEM_TEXT_PART_CLASS).text(t).appendTo($container);\r\n            if (i !== lastItemIndex) {\r\n                (0, _renderer2.default)(\"<span>\").addClass(FILTER_BUILDER_ITEM_TEXT_SEPARATOR_CLASS).text(customOperation && customOperation.valueSeparator ? customOperation.valueSeparator : \"|\").addClass(FILTER_BUILDER_ITEM_TEXT_SEPARATOR_EMPTY_CLASS).appendTo($container)\r\n            }\r\n        })\r\n    } else {\r\n        if (value) {\r\n            $container.text(value)\r\n        } else {\r\n            $container.text(_message2.default.format(\"dxFilterBuilder-enterValueText\"))\r\n        }\r\n    }\r\n};\r\nvar FilterBuilder = _ui2.default.inherit({\r\n    _getDefaultOptions: function() {\r\n        return (0, _extend.extend)(this.callBase(), {\r\n            onEditorPreparing: null,\r\n            onEditorPrepared: null,\r\n            onValueChanged: null,\r\n            fields: [],\r\n            defaultGroupOperation: \"and\",\r\n            groupOperations: [\"and\", \"or\", \"notAnd\", \"notOr\"],\r\n            maxGroupLevel: void 0,\r\n            value: null,\r\n            allowHierarchicalFields: false,\r\n            groupOperationDescriptions: {\r\n                and: _message2.default.format(\"dxFilterBuilder-and\"),\r\n                or: _message2.default.format(\"dxFilterBuilder-or\"),\r\n                notAnd: _message2.default.format(\"dxFilterBuilder-notAnd\"),\r\n                notOr: _message2.default.format(\"dxFilterBuilder-notOr\")\r\n            },\r\n            customOperations: [],\r\n            closePopupOnTargetScroll: true,\r\n            filterOperationDescriptions: {\r\n                between: _message2.default.format(\"dxFilterBuilder-filterOperationBetween\"),\r\n                equal: _message2.default.format(\"dxFilterBuilder-filterOperationEquals\"),\r\n                notEqual: _message2.default.format(\"dxFilterBuilder-filterOperationNotEquals\"),\r\n                lessThan: _message2.default.format(\"dxFilterBuilder-filterOperationLess\"),\r\n                lessThanOrEqual: _message2.default.format(\"dxFilterBuilder-filterOperationLessOrEquals\"),\r\n                greaterThan: _message2.default.format(\"dxFilterBuilder-filterOperationGreater\"),\r\n                greaterThanOrEqual: _message2.default.format(\"dxFilterBuilder-filterOperationGreaterOrEquals\"),\r\n                startsWith: _message2.default.format(\"dxFilterBuilder-filterOperationStartsWith\"),\r\n                contains: _message2.default.format(\"dxFilterBuilder-filterOperationContains\"),\r\n                notContains: _message2.default.format(\"dxFilterBuilder-filterOperationNotContains\"),\r\n                endsWith: _message2.default.format(\"dxFilterBuilder-filterOperationEndsWith\"),\r\n                isBlank: _message2.default.format(\"dxFilterBuilder-filterOperationIsBlank\"),\r\n                isNotBlank: _message2.default.format(\"dxFilterBuilder-filterOperationIsNotBlank\")\r\n            }\r\n        })\r\n    },\r\n    _optionChanged: function(args) {\r\n        switch (args.name) {\r\n            case \"closePopupOnTargetScroll\":\r\n                break;\r\n            case \"onEditorPreparing\":\r\n            case \"onEditorPrepared\":\r\n            case \"onValueChanged\":\r\n                this._initActions();\r\n                break;\r\n            case \"customOperations\":\r\n                this._initCustomOperations();\r\n                this._invalidate();\r\n                break;\r\n            case \"fields\":\r\n            case \"defaultGroupOperation\":\r\n            case \"maxGroupLevel\":\r\n            case \"groupOperations\":\r\n            case \"allowHierarchicalFields\":\r\n            case \"groupOperationDescriptions\":\r\n            case \"filterOperationDescriptions\":\r\n                this._invalidate();\r\n                break;\r\n            case \"value\":\r\n                if (args.value !== args.previousValue) {\r\n                    var disableInvalidateForValue = this._disableInvalidateForValue;\r\n                    if (!disableInvalidateForValue) {\r\n                        this._initModel();\r\n                        this._invalidate()\r\n                    }\r\n                    this._disableInvalidateForValue = false;\r\n                    this.executeAction(\"onValueChanged\", {\r\n                        value: args.value,\r\n                        previousValue: args.previousValue\r\n                    });\r\n                    this._disableInvalidateForValue = disableInvalidateForValue\r\n                }\r\n                break;\r\n            default:\r\n                this.callBase(args)\r\n        }\r\n    },\r\n    getFilterExpression: function() {\r\n        var fields = this._getNormalizedFields();\r\n        var value = (0, _extend.extend)(true, [], this._model);\r\n        return _utils2.default.getFilterExpression(_utils2.default.getNormalizedFilter(value), fields, this._customOperations, SOURCE)\r\n    },\r\n    _getNormalizedFields: function() {\r\n        return _utils2.default.getNormalizedFields(this.option(\"fields\"))\r\n    },\r\n    _updateFilter: function() {\r\n        this._disableInvalidateForValue = true;\r\n        var value = (0, _extend.extend)(true, [], this._model);\r\n        var normalizedValue = _utils2.default.getNormalizedFilter(value);\r\n        var oldValue = _utils2.default.getNormalizedFilter(this._getModel(this.option(\"value\")));\r\n        if (JSON.stringify(oldValue) !== JSON.stringify(normalizedValue)) {\r\n            this.option(\"value\", normalizedValue)\r\n        }\r\n        this._disableInvalidateForValue = false;\r\n        this._fireContentReadyAction()\r\n    },\r\n    _init: function() {\r\n        this._initCustomOperations();\r\n        this._initModel();\r\n        this._initEditorFactory();\r\n        this._initActions();\r\n        this.callBase()\r\n    },\r\n    _initEditorFactory: function() {\r\n        this._editorFactory = new EditorFactory\r\n    },\r\n    _initCustomOperations: function() {\r\n        this._customOperations = _utils2.default.getMergedOperations(this.option(\"customOperations\"), this.option(\"filterOperationDescriptions.between\"))\r\n    },\r\n    _getModel: function(value) {\r\n        return _utils2.default.convertToInnerStructure(value, this._customOperations)\r\n    },\r\n    _initModel: function() {\r\n        this._model = this._getModel(this.option(\"value\"))\r\n    },\r\n    _initActions: function() {\r\n        var that = this;\r\n        that._actions = {};\r\n        ACTIONS.forEach(function(action) {\r\n            that._actions[action.name] = that._createActionByOption(action.name, action.config)\r\n        })\r\n    },\r\n    executeAction: function(actionName, options) {\r\n        var action = this._actions[actionName];\r\n        return action && action(options)\r\n    },\r\n    _initMarkup: function() {\r\n        this.$element().addClass(FILTER_BUILDER_CLASS);\r\n        this.callBase();\r\n        this._createGroupElementByCriteria(this._model).appendTo(this.$element())\r\n    },\r\n    _createConditionElement: function(condition, parent) {\r\n        return (0, _renderer2.default)(\"<div>\").addClass(FILTER_BUILDER_GROUP_CLASS).append(this._createConditionItem(condition, parent))\r\n    },\r\n    _createGroupElementByCriteria: function(criteria, parent) {\r\n        var groupLevel = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 0;\r\n        var $group = this._createGroupElement(criteria, parent, groupLevel);\r\n        var $groupContent = $group.find(\".\" + FILTER_BUILDER_GROUP_CONTENT_CLASS);\r\n        var groupCriteria = _utils2.default.getGroupCriteria(criteria);\r\n        for (var i = 0; i < groupCriteria.length; i++) {\r\n            var innerCriteria = groupCriteria[i];\r\n            if (_utils2.default.isGroup(innerCriteria)) {\r\n                this._createGroupElementByCriteria(innerCriteria, groupCriteria, groupLevel + 1).appendTo($groupContent)\r\n            } else {\r\n                if (_utils2.default.isCondition(innerCriteria)) {\r\n                    this._createConditionElement(innerCriteria, groupCriteria).appendTo($groupContent)\r\n                }\r\n            }\r\n        }\r\n        return $group\r\n    },\r\n    _createGroupElement: function(criteria, parent, groupLevel) {\r\n        var _this = this;\r\n        var $groupItem = (0, _renderer2.default)(\"<div>\").addClass(FILTER_BUILDER_GROUP_ITEM_CLASS);\r\n        var $groupContent = (0, _renderer2.default)(\"<div>\").addClass(FILTER_BUILDER_GROUP_CONTENT_CLASS);\r\n        var $group = (0, _renderer2.default)(\"<div>\").addClass(FILTER_BUILDER_GROUP_CLASS).append($groupItem).append($groupContent);\r\n        if (null != parent) {\r\n            this._createRemoveButton(function() {\r\n                _utils2.default.removeItem(parent, criteria);\r\n                $group.remove();\r\n                _this._updateFilter()\r\n            }).appendTo($groupItem)\r\n        }\r\n        this._createGroupOperationButton(criteria).appendTo($groupItem);\r\n        this._createAddButton(function() {\r\n            var newGroup = _utils2.default.createEmptyGroup(_this.option(\"defaultGroupOperation\"));\r\n            _utils2.default.addItem(newGroup, criteria);\r\n            _this._createGroupElement(newGroup, criteria, groupLevel + 1).appendTo($groupContent);\r\n            _this._updateFilter()\r\n        }, function() {\r\n            var field = _this.option(\"fields\")[0];\r\n            var newCondition = _utils2.default.createCondition(field, _this._customOperations);\r\n            _utils2.default.addItem(newCondition, criteria);\r\n            _this._createConditionElement(newCondition, criteria).appendTo($groupContent);\r\n            _this._updateFilter()\r\n        }, groupLevel).appendTo($groupItem);\r\n        return $group\r\n    },\r\n    _createButton: function(caption) {\r\n        return (0, _renderer2.default)(\"<div>\").text(caption)\r\n    },\r\n    _createGroupOperationButton: function(criteria) {\r\n        var _this2 = this;\r\n        var groupOperations = this._getGroupOperations(criteria);\r\n        var groupMenuItem = _utils2.default.getGroupMenuItem(criteria, groupOperations);\r\n        var caption = groupMenuItem.text;\r\n        var $operationButton = groupOperations && groupOperations.length < 2 ? this._createButton(caption).addClass(DISABLED_STATE_CLASS) : this._createButtonWithMenu({\r\n            caption: caption,\r\n            menu: {\r\n                items: groupOperations,\r\n                displayExpr: \"text\",\r\n                keyExpr: \"value\",\r\n                onItemClick: function(e) {\r\n                    if (groupMenuItem !== e.itemData) {\r\n                        _utils2.default.setGroupValue(criteria, e.itemData.value);\r\n                        $operationButton.html(e.itemData.text);\r\n                        groupMenuItem = e.itemData;\r\n                        _this2._updateFilter()\r\n                    }\r\n                },\r\n                onContentReady: function(e) {\r\n                    e.component.selectItem(groupMenuItem)\r\n                },\r\n                cssClass: FILTER_BUILDER_GROUP_OPERATIONS_CLASS\r\n            }\r\n        });\r\n        return $operationButton.addClass(FILTER_BUILDER_ITEM_TEXT_CLASS).addClass(FILTER_BUILDER_GROUP_OPERATION_CLASS).attr(\"tabindex\", 0)\r\n    },\r\n    _createButtonWithMenu: function(options) {\r\n        var that = this;\r\n        var removeMenu = function() {\r\n            that.$element().find(\".\" + ACTIVE_CLASS).removeClass(ACTIVE_CLASS);\r\n            that.$element().find(\".dx-overlay .dx-treeview\").remove();\r\n            that.$element().find(\".dx-overlay\").remove()\r\n        };\r\n        var rtlEnabled = this.option(\"rtlEnabled\");\r\n        var menuOnItemClickWrapper = function(handler) {\r\n            return function(e) {\r\n                handler(e);\r\n                if (\"dxclick\" === e.event.type) {\r\n                    removeMenu()\r\n                }\r\n            }\r\n        };\r\n        var position = rtlEnabled ? \"right\" : \"left\";\r\n        var $button = this._createButton(options.caption);\r\n        (0, _extend.extend)(options.menu, {\r\n            focusStateEnabled: true,\r\n            selectionMode: \"single\",\r\n            onItemClick: menuOnItemClickWrapper(options.menu.onItemClick),\r\n            onHiding: function(e) {\r\n                $button.removeClass(ACTIVE_CLASS)\r\n            },\r\n            position: {\r\n                my: position + \" top\",\r\n                at: position + \" bottom\",\r\n                offset: \"0 1\",\r\n                of: $button,\r\n                collision: \"flip\"\r\n            },\r\n            animation: null,\r\n            onHidden: function() {\r\n                removeMenu()\r\n            },\r\n            cssClass: FILTER_BUILDER_OVERLAY_CLASS + \" \" + options.menu.cssClass,\r\n            rtlEnabled: rtlEnabled\r\n        });\r\n        options.popup = {\r\n            onShown: function(info) {\r\n                var treeViewElement = (0, _renderer2.default)(info.component.content()).find(\".dx-treeview\");\r\n                var treeView = treeViewElement.dxTreeView(\"instance\");\r\n                _events_engine2.default.on(treeViewElement, \"keyup keydown\", function(e) {\r\n                    var keyName = (0, _utils4.normalizeKeyName)(e);\r\n                    if (\"keydown\" === e.type && keyName === TAB_KEY || \"keyup\" === e.type && (keyName === ESCAPE_KEY || keyName === ENTER_KEY)) {\r\n                        info.component.hide();\r\n                        _events_engine2.default.trigger(options.menu.position.of, \"focus\")\r\n                    }\r\n                });\r\n                treeView.focus();\r\n                treeView.option(\"focusedElement\", null)\r\n            }\r\n        };\r\n        this._subscribeOnClickAndEnterKey($button, function() {\r\n            removeMenu();\r\n            that._createPopupWithTreeView(options, that.$element());\r\n            $button.addClass(ACTIVE_CLASS)\r\n        });\r\n        return $button\r\n    },\r\n    _hasValueButton: function(condition) {\r\n        var customOperation = _utils2.default.getCustomOperation(this._customOperations, condition[1]);\r\n        return customOperation ? false !== customOperation.hasValue : null !== condition[2]\r\n    },\r\n    _createOperationButtonWithMenu: function(condition, field) {\r\n        var _this3 = this;\r\n        var that = this;\r\n        var availableOperations = _utils2.default.getAvailableOperations(field, this.option(\"filterOperationDescriptions\"), this._customOperations);\r\n        var currentOperation = _utils2.default.getOperationFromAvailable(_utils2.default.getOperationValue(condition), availableOperations);\r\n        var $operationButton = this._createButtonWithMenu({\r\n            caption: currentOperation.text,\r\n            menu: {\r\n                items: availableOperations,\r\n                displayExpr: \"text\",\r\n                onItemRendered: function(e) {\r\n                    e.itemData.isCustom && (0, _renderer2.default)(e.itemElement).addClass(FILTER_BUILDER_MENU_CUSTOM_OPERATION_CLASS)\r\n                },\r\n                onContentReady: function(e) {\r\n                    e.component.selectItem(currentOperation)\r\n                },\r\n                onItemClick: function(e) {\r\n                    if (currentOperation !== e.itemData) {\r\n                        currentOperation = e.itemData;\r\n                        _utils2.default.updateConditionByOperation(condition, currentOperation.value, that._customOperations);\r\n                        var $valueButton = $operationButton.siblings().filter(\".\" + FILTER_BUILDER_ITEM_VALUE_CLASS);\r\n                        if (that._hasValueButton(condition)) {\r\n                            if (0 !== $valueButton.length) {\r\n                                $valueButton.remove()\r\n                            }\r\n                            that._createValueButton(condition, field).appendTo($operationButton.parent())\r\n                        } else {\r\n                            $valueButton.remove()\r\n                        }\r\n                        $operationButton.html(currentOperation.text);\r\n                        _this3._updateFilter()\r\n                    }\r\n                },\r\n                cssClass: FILTER_BUILDER_FILTER_OPERATIONS_CLASS\r\n            }\r\n        }).addClass(FILTER_BUILDER_ITEM_TEXT_CLASS).addClass(FILTER_BUILDER_ITEM_OPERATION_CLASS).attr(\"tabindex\", 0);\r\n        return $operationButton\r\n    },\r\n    _createOperationAndValueButtons: function(condition, field, $item) {\r\n        this._createOperationButtonWithMenu(condition, field).appendTo($item);\r\n        if (this._hasValueButton(condition)) {\r\n            this._createValueButton(condition, field).appendTo($item)\r\n        }\r\n    },\r\n    _createFieldButtonWithMenu: function(fields, condition, field) {\r\n        var _this4 = this;\r\n        var that = this;\r\n        var allowHierarchicalFields = this.option(\"allowHierarchicalFields\");\r\n        var items = _utils2.default.getItems(fields, allowHierarchicalFields);\r\n        var item = _utils2.default.getField(field.name || field.dataField, items);\r\n        var getFullCaption = function(item, items) {\r\n            return allowHierarchicalFields ? _utils2.default.getCaptionWithParents(item, items) : item.caption\r\n        };\r\n        var $fieldButton = this._createButtonWithMenu({\r\n            caption: getFullCaption(item, items),\r\n            menu: {\r\n                items: items,\r\n                dataStructure: \"plain\",\r\n                keyExpr: \"id\",\r\n                parentId: \"parentId\",\r\n                displayExpr: \"caption\",\r\n                onItemClick: function(e) {\r\n                    if (item !== e.itemData) {\r\n                        item = e.itemData;\r\n                        condition[0] = item.name || item.dataField;\r\n                        condition[2] = \"object\" === item.dataType ? null : \"\";\r\n                        _utils2.default.updateConditionByOperation(condition, _utils2.default.getDefaultOperation(item), that._customOperations);\r\n                        $fieldButton.siblings().filter(\".\" + FILTER_BUILDER_ITEM_TEXT_CLASS).remove();\r\n                        that._createOperationAndValueButtons(condition, item, $fieldButton.parent());\r\n                        var caption = getFullCaption(item, e.component.option(\"items\"));\r\n                        $fieldButton.html(caption);\r\n                        _this4._updateFilter()\r\n                    }\r\n                },\r\n                onContentReady: function(e) {\r\n                    e.component.selectItem(item)\r\n                },\r\n                cssClass: FILTER_BUILDER_FIELDS_CLASS\r\n            }\r\n        }).addClass(FILTER_BUILDER_ITEM_TEXT_CLASS).addClass(FILTER_BUILDER_ITEM_FIELD_CLASS).attr(\"tabindex\", 0);\r\n        return $fieldButton\r\n    },\r\n    _createConditionItem: function(condition, parent) {\r\n        var _this5 = this;\r\n        var $item = (0, _renderer2.default)(\"<div>\").addClass(FILTER_BUILDER_GROUP_ITEM_CLASS);\r\n        var fields = this._getNormalizedFields();\r\n        var field = _utils2.default.getField(condition[0], fields);\r\n        this._createRemoveButton(function() {\r\n            _utils2.default.removeItem(parent, condition);\r\n            var isSingleChild = 1 === $item.parent().children().length;\r\n            if (isSingleChild) {\r\n                $item.parent().remove()\r\n            } else {\r\n                $item.remove()\r\n            }\r\n            _this5._updateFilter()\r\n        }).appendTo($item);\r\n        this._createFieldButtonWithMenu(fields, condition, field).appendTo($item);\r\n        this._createOperationAndValueButtons(condition, field, $item);\r\n        return $item\r\n    },\r\n    _getGroupOperations: function(criteria) {\r\n        var groupOperations = this.option(\"groupOperations\");\r\n        var groupOperationDescriptions = this.option(\"groupOperationDescriptions\");\r\n        if (!groupOperations || !groupOperations.length) {\r\n            groupOperations = [_utils2.default.getGroupValue(criteria).replace(\"!\", \"not\")]\r\n        }\r\n        return groupOperations.map(function(operation) {\r\n            return {\r\n                text: groupOperationDescriptions[operation],\r\n                value: OPERATORS[operation]\r\n            }\r\n        })\r\n    },\r\n    _createRemoveButton: function(handler) {\r\n        var $removeButton = (0, _renderer2.default)(\"<div>\").addClass(FILTER_BUILDER_IMAGE_CLASS).addClass(FILTER_BUILDER_IMAGE_REMOVE_CLASS).addClass(FILTER_BUILDER_ACTION_CLASS).attr(\"tabindex\", 0);\r\n        this._subscribeOnClickAndEnterKey($removeButton, handler);\r\n        return $removeButton\r\n    },\r\n    _createAddButton: function(addGroupHandler, addConditionHandler, groupLevel) {\r\n        var $button;\r\n        var maxGroupLevel = this.option(\"maxGroupLevel\");\r\n        if ((0, _type.isDefined)(maxGroupLevel) && groupLevel >= maxGroupLevel) {\r\n            $button = this._createButton();\r\n            this._subscribeOnClickAndEnterKey($button, addConditionHandler)\r\n        } else {\r\n            $button = this._createButtonWithMenu({\r\n                menu: {\r\n                    items: [{\r\n                        caption: _message2.default.format(\"dxFilterBuilder-addCondition\"),\r\n                        click: addConditionHandler\r\n                    }, {\r\n                        caption: _message2.default.format(\"dxFilterBuilder-addGroup\"),\r\n                        click: addGroupHandler\r\n                    }],\r\n                    displayExpr: \"caption\",\r\n                    onItemClick: function(e) {\r\n                        e.itemData.click()\r\n                    },\r\n                    cssClass: FILTER_BUILDER_ADD_CONDITION_CLASS\r\n                }\r\n            })\r\n        }\r\n        return $button.addClass(FILTER_BUILDER_IMAGE_CLASS).addClass(FILTER_BUILDER_IMAGE_ADD_CLASS).addClass(FILTER_BUILDER_ACTION_CLASS).attr(\"tabindex\", 0)\r\n    },\r\n    _createValueText: function(item, field, $container) {\r\n        var that = this;\r\n        var $text = (0, _renderer2.default)(\"<div>\").html(\"&nbsp;\").addClass(FILTER_BUILDER_ITEM_VALUE_TEXT_CLASS).attr(\"tabindex\", 0).appendTo($container);\r\n        var value = item[2];\r\n        var customOperation = _utils2.default.getCustomOperation(that._customOperations, item[1]);\r\n        if (!customOperation && field.lookup) {\r\n            _utils2.default.getCurrentLookupValueText(field, value, function(result) {\r\n                renderValueText($text, result)\r\n            })\r\n        } else {\r\n            _deferred2.default.when(_utils2.default.getCurrentValueText(field, value, customOperation)).done(function(result) {\r\n                renderValueText($text, result, customOperation)\r\n            })\r\n        }\r\n        that._subscribeOnClickAndEnterKey($text, function(e) {\r\n            if (\"keyup\" === e.type) {\r\n                e.stopPropagation()\r\n            }\r\n            that._createValueEditorWithEvents(item, field, $container)\r\n        });\r\n        return $text\r\n    },\r\n    _updateConditionValue: function(item, value, callback) {\r\n        var areValuesDifferent = item[2] !== value;\r\n        if (areValuesDifferent) {\r\n            item[2] = value\r\n        }\r\n        callback();\r\n        this._updateFilter()\r\n    },\r\n    _addDocumentKeyUp: function($editor, handler) {\r\n        var document = _dom_adapter2.default.getDocument();\r\n        var documentKeyUpHandler = function(e) {\r\n            if (isComposing || hasCompositionJustEnded) {\r\n                hasCompositionJustEnded = false;\r\n                return\r\n            }\r\n            handler(e)\r\n        };\r\n        _events_engine2.default.on(document, \"keyup\", documentKeyUpHandler);\r\n        var isComposing = false;\r\n        var hasCompositionJustEnded = false;\r\n        var input = $editor.find(\"input\");\r\n        _events_engine2.default.on(input, \"compositionstart\", function() {\r\n            isComposing = true\r\n        });\r\n        _events_engine2.default.on(input, \"compositionend\", function() {\r\n            isComposing = false;\r\n            hasCompositionJustEnded = true\r\n        });\r\n        _events_engine2.default.on(input, \"keydown\", function(event) {\r\n            if (229 !== event.which) {\r\n                hasCompositionJustEnded = false\r\n            }\r\n        });\r\n        this._documentKeyUpHandler = documentKeyUpHandler\r\n    },\r\n    _addDocumentClick: function($editor, closeEditorFunc) {\r\n        var _this6 = this;\r\n        var document = _dom_adapter2.default.getDocument();\r\n        var documentClickHandler = function(e) {\r\n            if (!_this6._isFocusOnEditorParts($editor, e.target)) {\r\n                _events_engine2.default.trigger($editor.find(\"input\"), \"change\");\r\n                closeEditorFunc()\r\n            }\r\n        };\r\n        _events_engine2.default.on(document, \"dxpointerdown\", documentClickHandler);\r\n        this._documentClickHandler = documentClickHandler\r\n    },\r\n    _isFocusOnEditorParts: function($editor, target) {\r\n        var activeElement = target || _dom_adapter2.default.getActiveElement();\r\n        return (0, _renderer2.default)(activeElement).closest($editor.children()).length || (0, _renderer2.default)(activeElement).closest(\".dx-dropdowneditor-overlay\").length\r\n    },\r\n    _removeEvents: function() {\r\n        var document = _dom_adapter2.default.getDocument();\r\n        (0, _type.isDefined)(this._documentKeyUpHandler) && _events_engine2.default.off(document, \"keyup\", this._documentKeyUpHandler);\r\n        (0, _type.isDefined)(this._documentClickHandler) && _events_engine2.default.off(document, \"dxpointerdown\", this._documentClickHandler)\r\n    },\r\n    _dispose: function() {\r\n        this._removeEvents();\r\n        this.callBase()\r\n    },\r\n    _createValueEditorWithEvents: function(item, field, $container) {\r\n        var _this7 = this;\r\n        var value = item[2];\r\n        var createValueText = function() {\r\n            $container.empty();\r\n            _this7._removeEvents();\r\n            return _this7._createValueText(item, field, $container)\r\n        };\r\n        var closeEditor = function() {\r\n            _this7._updateConditionValue(item, value, function() {\r\n                createValueText()\r\n            })\r\n        };\r\n        var options = {\r\n            value: \"\" === value ? null : value,\r\n            filterOperation: _utils2.default.getOperationValue(item),\r\n            setValue: function(data) {\r\n                value = null === data ? \"\" : data\r\n            },\r\n            closeEditor: closeEditor,\r\n            text: $container.text()\r\n        };\r\n        $container.empty();\r\n        var $editor = this._createValueEditor($container, field, options);\r\n        _events_engine2.default.trigger($editor.find(\"input\").not(\":hidden\").eq(0), \"focus\");\r\n        this._removeEvents();\r\n        this._addDocumentClick($editor, closeEditor);\r\n        this._addDocumentKeyUp($editor, function(e) {\r\n            var keyName = (0, _utils4.normalizeKeyName)(e);\r\n            if (keyName === TAB_KEY) {\r\n                if (_this7._isFocusOnEditorParts($editor)) {\r\n                    return\r\n                }\r\n                _this7._updateConditionValue(item, value, function() {\r\n                    createValueText();\r\n                    if (e.shiftKey) {\r\n                        _events_engine2.default.trigger($container.prev(), \"focus\")\r\n                    }\r\n                })\r\n            }\r\n            if (keyName === ESCAPE_KEY) {\r\n                _events_engine2.default.trigger(createValueText(), \"focus\")\r\n            }\r\n            if (keyName === ENTER_KEY) {\r\n                _this7._updateConditionValue(item, value, function() {\r\n                    _events_engine2.default.trigger(createValueText(), \"focus\")\r\n                })\r\n            }\r\n        });\r\n        this._fireContentReadyAction()\r\n    },\r\n    _createValueButton: function(item, field) {\r\n        var $valueButton = (0, _renderer2.default)(\"<div>\").addClass(FILTER_BUILDER_ITEM_TEXT_CLASS).addClass(FILTER_BUILDER_ITEM_VALUE_CLASS);\r\n        this._createValueText(item, field, $valueButton);\r\n        return $valueButton\r\n    },\r\n    _createValueEditor: function($container, field, options) {\r\n        var $editor = (0, _renderer2.default)(\"<div>\").attr(\"tabindex\", 0).appendTo($container);\r\n        var customOperation = _utils2.default.getCustomOperation(this._customOperations, options.filterOperation);\r\n        var editorTemplate = customOperation && customOperation.editorTemplate ? customOperation.editorTemplate : field.editorTemplate;\r\n        if (editorTemplate) {\r\n            var template = this._getTemplate(editorTemplate);\r\n            template.render({\r\n                model: (0, _extend.extend)({\r\n                    field: field\r\n                }, options),\r\n                container: $editor\r\n            })\r\n        } else {\r\n            this._editorFactory.createEditor.call(this, $editor, (0, _extend.extend)({}, field, options, {\r\n                parentType: SOURCE\r\n            }))\r\n        }\r\n        return $editor\r\n    },\r\n    _createPopupWithTreeView: function(options, $container) {\r\n        var that = this;\r\n        var $popup = (0, _renderer2.default)(\"<div>\").addClass(options.menu.cssClass).appendTo($container);\r\n        this._createComponent($popup, _popup2.default, {\r\n            onHiding: options.menu.onHiding,\r\n            onHidden: options.menu.onHidden,\r\n            rtlEnabled: options.menu.rtlEnabled,\r\n            position: options.menu.position,\r\n            animation: options.menu.animation,\r\n            contentTemplate: function(contentElement) {\r\n                var $menuContainer = (0, _renderer2.default)(\"<div>\").appendTo(contentElement);\r\n                that._createComponent($menuContainer, _tree_view2.default, options.menu);\r\n                this.repaint()\r\n            },\r\n            maxHeight: function() {\r\n                return (0, _utils3.getElementMaxHeightByWindow)(options.menu.position.of)\r\n            },\r\n            visible: true,\r\n            focusStateEnabled: false,\r\n            closeOnTargetScroll: this.option(\"closePopupOnTargetScroll\"),\r\n            closeOnOutsideClick: true,\r\n            onShown: options.popup.onShown,\r\n            shading: false,\r\n            width: \"auto\",\r\n            height: \"auto\",\r\n            showTitle: false\r\n        })\r\n    },\r\n    _subscribeOnClickAndEnterKey: function($button, handler) {\r\n        _events_engine2.default.on($button, \"dxclick\", handler);\r\n        _events_engine2.default.on($button, \"keyup\", function(e) {\r\n            if ((0, _utils4.normalizeKeyName)(e) === ENTER_KEY) {\r\n                handler(e)\r\n            }\r\n        })\r\n    }\r\n});\r\n(0, _component_registrator2.default)(\"dxFilterBuilder\", FilterBuilder);\r\nmodule.exports = FilterBuilder;\r\nmodule.exports.renderValueText = renderValueText;\r\n"]},"metadata":{},"sourceType":"module"}