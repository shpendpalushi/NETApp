{"ast":null,"code":"/**\r\n * DevExtreme (ui/scroll_view/ui.scroll_view.native.pull_down.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar $ = require(\"../../core/renderer\");\n\nvar Callbacks = require(\"../../core/utils/callbacks\");\n\nvar translator = require(\"../../animation/translator\");\n\nvar NativeStrategy = require(\"./ui.scrollable.native\");\n\nvar LoadIndicator = require(\"../load_indicator\");\n\nvar each = require(\"../../core/utils/iterator\").each;\n\nvar browser = require(\"../../core/utils/browser\");\n\nvar Deferred = require(\"../../core/utils/deferred\").Deferred;\n\nvar SCROLLVIEW_PULLDOWN_REFRESHING_CLASS = \"dx-scrollview-pull-down-loading\";\nvar SCROLLVIEW_PULLDOWN_READY_CLASS = \"dx-scrollview-pull-down-ready\";\nvar SCROLLVIEW_PULLDOWN_IMAGE_CLASS = \"dx-scrollview-pull-down-image\";\nvar SCROLLVIEW_PULLDOWN_INDICATOR_CLASS = \"dx-scrollview-pull-down-indicator\";\nvar SCROLLVIEW_PULLDOWN_TEXT_CLASS = \"dx-scrollview-pull-down-text\";\nvar SCROLLVIEW_PULLDOWN_VISIBLE_TEXT_CLASS = \"dx-scrollview-pull-down-text-visible\";\nvar STATE_RELEASED = 0;\nvar STATE_READY = 1;\nvar STATE_REFRESHING = 2;\nvar STATE_LOADING = 3;\nvar PULLDOWN_RELEASE_TIME = 400;\nvar PullDownNativeScrollViewStrategy = NativeStrategy.inherit({\n  _init: function _init(scrollView) {\n    this.callBase(scrollView);\n    this._$topPocket = scrollView._$topPocket;\n    this._$pullDown = scrollView._$pullDown;\n    this._$bottomPocket = scrollView._$bottomPocket;\n    this._$refreshingText = scrollView._$refreshingText;\n    this._$scrollViewContent = $(scrollView.content());\n\n    this._initCallbacks();\n  },\n  _initCallbacks: function _initCallbacks() {\n    this.pullDownCallbacks = Callbacks();\n    this.releaseCallbacks = Callbacks();\n    this.reachBottomCallbacks = Callbacks();\n  },\n  render: function render() {\n    this.callBase();\n\n    this._renderPullDown();\n\n    this._releaseState();\n  },\n  _renderPullDown: function _renderPullDown() {\n    var $image = $(\"<div>\").addClass(SCROLLVIEW_PULLDOWN_IMAGE_CLASS);\n    var $loadContainer = $(\"<div>\").addClass(SCROLLVIEW_PULLDOWN_INDICATOR_CLASS);\n    var $loadIndicator = new LoadIndicator($(\"<div>\")).$element();\n    var $text = this._$pullDownText = $(\"<div>\").addClass(SCROLLVIEW_PULLDOWN_TEXT_CLASS);\n    this._$pullingDownText = $(\"<div>\").text(this.option(\"pullingDownText\")).appendTo($text);\n    this._$pulledDownText = $(\"<div>\").text(this.option(\"pulledDownText\")).appendTo($text);\n    this._$refreshingText = $(\"<div>\").text(this.option(\"refreshingText\")).appendTo($text);\n\n    this._$pullDown.empty().append($image).append($loadContainer.append($loadIndicator)).append($text);\n  },\n  _releaseState: function _releaseState() {\n    this._state = STATE_RELEASED;\n\n    this._refreshPullDownText();\n  },\n  _pushBackFromBoundary: function _pushBackFromBoundary() {\n    if (!this._isLocked() && !this._component.isEmpty()) {\n      this.callBase();\n    }\n  },\n  _refreshPullDownText: function _refreshPullDownText() {\n    var that = this;\n    var pullDownTextItems = [{\n      element: this._$pullingDownText,\n      visibleState: STATE_RELEASED\n    }, {\n      element: this._$pulledDownText,\n      visibleState: STATE_READY\n    }, {\n      element: this._$refreshingText,\n      visibleState: STATE_REFRESHING\n    }];\n    each(pullDownTextItems, function (_, item) {\n      var action = that._state === item.visibleState ? \"addClass\" : \"removeClass\";\n      item.element[action](SCROLLVIEW_PULLDOWN_VISIBLE_TEXT_CLASS);\n    });\n  },\n  update: function update() {\n    this.callBase();\n\n    this._setTopPocketOffset();\n  },\n  _updateDimensions: function _updateDimensions() {\n    this.callBase();\n    this._topPocketSize = this._$topPocket.height();\n    this._bottomPocketSize = this._$bottomPocket.height();\n\n    if (browser.msie) {\n      this._scrollOffset = Math.round(100 * (this._$container.height() - this._$content.height())) / 100;\n    } else {\n      this._scrollOffset = this._$container.height() - this._$content.height();\n    }\n  },\n  _allowedDirections: function _allowedDirections() {\n    var allowedDirections = this.callBase();\n    allowedDirections.vertical = allowedDirections.vertical || this._pullDownEnabled;\n    return allowedDirections;\n  },\n  _setTopPocketOffset: function _setTopPocketOffset() {\n    this._$topPocket.css({\n      top: -this._topPocketSize\n    });\n  },\n  handleEnd: function handleEnd() {\n    this.callBase();\n\n    this._complete();\n  },\n  handleStop: function handleStop() {\n    this.callBase();\n\n    this._complete();\n  },\n  _complete: function _complete() {\n    if (this._state === STATE_READY) {\n      this._setPullDownOffset(this._topPocketSize);\n\n      clearTimeout(this._pullDownRefreshTimeout);\n      this._pullDownRefreshTimeout = setTimeout(function () {\n        this._pullDownRefreshing();\n      }.bind(this), 400);\n    }\n  },\n  _setPullDownOffset: function _setPullDownOffset(offset) {\n    translator.move(this._$topPocket, {\n      top: offset\n    });\n    translator.move(this._$scrollViewContent, {\n      top: offset\n    });\n  },\n  handleScroll: function handleScroll(e) {\n    this.callBase(e);\n\n    if (this._state === STATE_REFRESHING) {\n      return;\n    }\n\n    var currentLocation = this.location().top;\n    var scrollDelta = (this._location || 0) - currentLocation;\n    this._location = currentLocation;\n\n    if (this._isPullDown()) {\n      this._pullDownReady();\n    } else {\n      if (scrollDelta > 0 && this._isReachBottom()) {\n        this._reachBottom();\n      } else {\n        this._stateReleased();\n      }\n    }\n  },\n  _isPullDown: function _isPullDown() {\n    return this._pullDownEnabled && this._location >= this._topPocketSize;\n  },\n  _isReachBottom: function _isReachBottom() {\n    if (browser.msie) {\n      return this._reachBottomEnabled && this._location - (this._scrollOffset + this._bottomPocketSize) <= .1;\n    } else {\n      return this._reachBottomEnabled && this._location <= this._scrollOffset + this._bottomPocketSize;\n    }\n  },\n  _reachBottom: function _reachBottom() {\n    if (this._state === STATE_LOADING) {\n      return;\n    }\n\n    this._state = STATE_LOADING;\n    this.reachBottomCallbacks.fire();\n  },\n  _pullDownReady: function _pullDownReady() {\n    if (this._state === STATE_READY) {\n      return;\n    }\n\n    this._state = STATE_READY;\n\n    this._$pullDown.addClass(SCROLLVIEW_PULLDOWN_READY_CLASS);\n\n    this._refreshPullDownText();\n  },\n  _stateReleased: function _stateReleased() {\n    if (this._state === STATE_RELEASED) {\n      return;\n    }\n\n    this._$pullDown.removeClass(SCROLLVIEW_PULLDOWN_REFRESHING_CLASS).removeClass(SCROLLVIEW_PULLDOWN_READY_CLASS);\n\n    this._releaseState();\n  },\n  _pullDownRefreshing: function _pullDownRefreshing() {\n    if (this._state === STATE_REFRESHING) {\n      return;\n    }\n\n    this._state = STATE_REFRESHING;\n\n    this._$pullDown.addClass(SCROLLVIEW_PULLDOWN_REFRESHING_CLASS).removeClass(SCROLLVIEW_PULLDOWN_READY_CLASS);\n\n    this._refreshPullDownText();\n\n    this.pullDownCallbacks.fire();\n  },\n  pullDownEnable: function pullDownEnable(enabled) {\n    if (enabled) {\n      this._updateDimensions();\n\n      this._setTopPocketOffset();\n    }\n\n    this._pullDownEnabled = enabled;\n  },\n  reachBottomEnable: function reachBottomEnable(enabled) {\n    this._reachBottomEnabled = enabled;\n  },\n  pendingRelease: function pendingRelease() {\n    this._state = STATE_READY;\n  },\n  release: function release() {\n    var deferred = new Deferred();\n\n    this._updateDimensions();\n\n    clearTimeout(this._releaseTimeout);\n\n    if (this._state === STATE_LOADING) {\n      this._state = STATE_RELEASED;\n    }\n\n    this._releaseTimeout = setTimeout(function () {\n      this._setPullDownOffset(0);\n\n      this._stateReleased();\n\n      this.releaseCallbacks.fire();\n\n      this._updateAction();\n\n      deferred.resolve();\n    }.bind(this), PULLDOWN_RELEASE_TIME);\n    return deferred.promise();\n  },\n  dispose: function dispose() {\n    clearTimeout(this._pullDownRefreshTimeout);\n    clearTimeout(this._releaseTimeout);\n    this.callBase();\n  }\n});\nmodule.exports = PullDownNativeScrollViewStrategy;","map":{"version":3,"sources":["C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/devextreme/ui/scroll_view/ui.scroll_view.native.pull_down.js"],"names":["$","require","Callbacks","translator","NativeStrategy","LoadIndicator","each","browser","Deferred","SCROLLVIEW_PULLDOWN_REFRESHING_CLASS","SCROLLVIEW_PULLDOWN_READY_CLASS","SCROLLVIEW_PULLDOWN_IMAGE_CLASS","SCROLLVIEW_PULLDOWN_INDICATOR_CLASS","SCROLLVIEW_PULLDOWN_TEXT_CLASS","SCROLLVIEW_PULLDOWN_VISIBLE_TEXT_CLASS","STATE_RELEASED","STATE_READY","STATE_REFRESHING","STATE_LOADING","PULLDOWN_RELEASE_TIME","PullDownNativeScrollViewStrategy","_init","scrollView","_initCallbacks","render","_renderPullDown","$image","$loadContainer","$loadIndicator","$text","_releaseState","_pushBackFromBoundary","_refreshPullDownText","that","pullDownTextItems","element","visibleState","action","item","update","_updateDimensions","Math","_allowedDirections","allowedDirections","_setTopPocketOffset","top","_topPocketSize","handleEnd","handleStop","_complete","clearTimeout","setTimeout","_setPullDownOffset","offset","handleScroll","currentLocation","scrollDelta","_isPullDown","_isReachBottom","_reachBottom","_pullDownReady","_stateReleased","_pullDownRefreshing","pullDownEnable","reachBottomEnable","pendingRelease","release","deferred","dispose","module"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/scroll_view/ui.scroll_view.native.pull_down.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar $ = require(\"../../core/renderer\");\r\nvar Callbacks = require(\"../../core/utils/callbacks\");\r\nvar translator = require(\"../../animation/translator\");\r\nvar NativeStrategy = require(\"./ui.scrollable.native\");\r\nvar LoadIndicator = require(\"../load_indicator\");\r\nvar each = require(\"../../core/utils/iterator\").each;\r\nvar browser = require(\"../../core/utils/browser\");\r\nvar Deferred = require(\"../../core/utils/deferred\").Deferred;\r\nvar SCROLLVIEW_PULLDOWN_REFRESHING_CLASS = \"dx-scrollview-pull-down-loading\";\r\nvar SCROLLVIEW_PULLDOWN_READY_CLASS = \"dx-scrollview-pull-down-ready\";\r\nvar SCROLLVIEW_PULLDOWN_IMAGE_CLASS = \"dx-scrollview-pull-down-image\";\r\nvar SCROLLVIEW_PULLDOWN_INDICATOR_CLASS = \"dx-scrollview-pull-down-indicator\";\r\nvar SCROLLVIEW_PULLDOWN_TEXT_CLASS = \"dx-scrollview-pull-down-text\";\r\nvar SCROLLVIEW_PULLDOWN_VISIBLE_TEXT_CLASS = \"dx-scrollview-pull-down-text-visible\";\r\nvar STATE_RELEASED = 0;\r\nvar STATE_READY = 1;\r\nvar STATE_REFRESHING = 2;\r\nvar STATE_LOADING = 3;\r\nvar PULLDOWN_RELEASE_TIME = 400;\r\nvar PullDownNativeScrollViewStrategy = NativeStrategy.inherit({\r\n    _init: function(scrollView) {\r\n        this.callBase(scrollView);\r\n        this._$topPocket = scrollView._$topPocket;\r\n        this._$pullDown = scrollView._$pullDown;\r\n        this._$bottomPocket = scrollView._$bottomPocket;\r\n        this._$refreshingText = scrollView._$refreshingText;\r\n        this._$scrollViewContent = $(scrollView.content());\r\n        this._initCallbacks()\r\n    },\r\n    _initCallbacks: function() {\r\n        this.pullDownCallbacks = Callbacks();\r\n        this.releaseCallbacks = Callbacks();\r\n        this.reachBottomCallbacks = Callbacks()\r\n    },\r\n    render: function() {\r\n        this.callBase();\r\n        this._renderPullDown();\r\n        this._releaseState()\r\n    },\r\n    _renderPullDown: function() {\r\n        var $image = $(\"<div>\").addClass(SCROLLVIEW_PULLDOWN_IMAGE_CLASS);\r\n        var $loadContainer = $(\"<div>\").addClass(SCROLLVIEW_PULLDOWN_INDICATOR_CLASS);\r\n        var $loadIndicator = new LoadIndicator($(\"<div>\")).$element();\r\n        var $text = this._$pullDownText = $(\"<div>\").addClass(SCROLLVIEW_PULLDOWN_TEXT_CLASS);\r\n        this._$pullingDownText = $(\"<div>\").text(this.option(\"pullingDownText\")).appendTo($text);\r\n        this._$pulledDownText = $(\"<div>\").text(this.option(\"pulledDownText\")).appendTo($text);\r\n        this._$refreshingText = $(\"<div>\").text(this.option(\"refreshingText\")).appendTo($text);\r\n        this._$pullDown.empty().append($image).append($loadContainer.append($loadIndicator)).append($text)\r\n    },\r\n    _releaseState: function() {\r\n        this._state = STATE_RELEASED;\r\n        this._refreshPullDownText()\r\n    },\r\n    _pushBackFromBoundary: function() {\r\n        if (!this._isLocked() && !this._component.isEmpty()) {\r\n            this.callBase()\r\n        }\r\n    },\r\n    _refreshPullDownText: function() {\r\n        var that = this;\r\n        var pullDownTextItems = [{\r\n            element: this._$pullingDownText,\r\n            visibleState: STATE_RELEASED\r\n        }, {\r\n            element: this._$pulledDownText,\r\n            visibleState: STATE_READY\r\n        }, {\r\n            element: this._$refreshingText,\r\n            visibleState: STATE_REFRESHING\r\n        }];\r\n        each(pullDownTextItems, function(_, item) {\r\n            var action = that._state === item.visibleState ? \"addClass\" : \"removeClass\";\r\n            item.element[action](SCROLLVIEW_PULLDOWN_VISIBLE_TEXT_CLASS)\r\n        })\r\n    },\r\n    update: function() {\r\n        this.callBase();\r\n        this._setTopPocketOffset()\r\n    },\r\n    _updateDimensions: function() {\r\n        this.callBase();\r\n        this._topPocketSize = this._$topPocket.height();\r\n        this._bottomPocketSize = this._$bottomPocket.height();\r\n        if (browser.msie) {\r\n            this._scrollOffset = Math.round(100 * (this._$container.height() - this._$content.height())) / 100\r\n        } else {\r\n            this._scrollOffset = this._$container.height() - this._$content.height()\r\n        }\r\n    },\r\n    _allowedDirections: function() {\r\n        var allowedDirections = this.callBase();\r\n        allowedDirections.vertical = allowedDirections.vertical || this._pullDownEnabled;\r\n        return allowedDirections\r\n    },\r\n    _setTopPocketOffset: function() {\r\n        this._$topPocket.css({\r\n            top: -this._topPocketSize\r\n        })\r\n    },\r\n    handleEnd: function() {\r\n        this.callBase();\r\n        this._complete()\r\n    },\r\n    handleStop: function() {\r\n        this.callBase();\r\n        this._complete()\r\n    },\r\n    _complete: function() {\r\n        if (this._state === STATE_READY) {\r\n            this._setPullDownOffset(this._topPocketSize);\r\n            clearTimeout(this._pullDownRefreshTimeout);\r\n            this._pullDownRefreshTimeout = setTimeout(function() {\r\n                this._pullDownRefreshing()\r\n            }.bind(this), 400)\r\n        }\r\n    },\r\n    _setPullDownOffset: function(offset) {\r\n        translator.move(this._$topPocket, {\r\n            top: offset\r\n        });\r\n        translator.move(this._$scrollViewContent, {\r\n            top: offset\r\n        })\r\n    },\r\n    handleScroll: function(e) {\r\n        this.callBase(e);\r\n        if (this._state === STATE_REFRESHING) {\r\n            return\r\n        }\r\n        var currentLocation = this.location().top;\r\n        var scrollDelta = (this._location || 0) - currentLocation;\r\n        this._location = currentLocation;\r\n        if (this._isPullDown()) {\r\n            this._pullDownReady()\r\n        } else {\r\n            if (scrollDelta > 0 && this._isReachBottom()) {\r\n                this._reachBottom()\r\n            } else {\r\n                this._stateReleased()\r\n            }\r\n        }\r\n    },\r\n    _isPullDown: function() {\r\n        return this._pullDownEnabled && this._location >= this._topPocketSize\r\n    },\r\n    _isReachBottom: function() {\r\n        if (browser.msie) {\r\n            return this._reachBottomEnabled && this._location - (this._scrollOffset + this._bottomPocketSize) <= .1\r\n        } else {\r\n            return this._reachBottomEnabled && this._location <= this._scrollOffset + this._bottomPocketSize\r\n        }\r\n    },\r\n    _reachBottom: function() {\r\n        if (this._state === STATE_LOADING) {\r\n            return\r\n        }\r\n        this._state = STATE_LOADING;\r\n        this.reachBottomCallbacks.fire()\r\n    },\r\n    _pullDownReady: function() {\r\n        if (this._state === STATE_READY) {\r\n            return\r\n        }\r\n        this._state = STATE_READY;\r\n        this._$pullDown.addClass(SCROLLVIEW_PULLDOWN_READY_CLASS);\r\n        this._refreshPullDownText()\r\n    },\r\n    _stateReleased: function() {\r\n        if (this._state === STATE_RELEASED) {\r\n            return\r\n        }\r\n        this._$pullDown.removeClass(SCROLLVIEW_PULLDOWN_REFRESHING_CLASS).removeClass(SCROLLVIEW_PULLDOWN_READY_CLASS);\r\n        this._releaseState()\r\n    },\r\n    _pullDownRefreshing: function() {\r\n        if (this._state === STATE_REFRESHING) {\r\n            return\r\n        }\r\n        this._state = STATE_REFRESHING;\r\n        this._$pullDown.addClass(SCROLLVIEW_PULLDOWN_REFRESHING_CLASS).removeClass(SCROLLVIEW_PULLDOWN_READY_CLASS);\r\n        this._refreshPullDownText();\r\n        this.pullDownCallbacks.fire()\r\n    },\r\n    pullDownEnable: function(enabled) {\r\n        if (enabled) {\r\n            this._updateDimensions();\r\n            this._setTopPocketOffset()\r\n        }\r\n        this._pullDownEnabled = enabled\r\n    },\r\n    reachBottomEnable: function(enabled) {\r\n        this._reachBottomEnabled = enabled\r\n    },\r\n    pendingRelease: function() {\r\n        this._state = STATE_READY\r\n    },\r\n    release: function() {\r\n        var deferred = new Deferred;\r\n        this._updateDimensions();\r\n        clearTimeout(this._releaseTimeout);\r\n        if (this._state === STATE_LOADING) {\r\n            this._state = STATE_RELEASED\r\n        }\r\n        this._releaseTimeout = setTimeout(function() {\r\n            this._setPullDownOffset(0);\r\n            this._stateReleased();\r\n            this.releaseCallbacks.fire();\r\n            this._updateAction();\r\n            deferred.resolve()\r\n        }.bind(this), PULLDOWN_RELEASE_TIME);\r\n        return deferred.promise()\r\n    },\r\n    dispose: function() {\r\n        clearTimeout(this._pullDownRefreshTimeout);\r\n        clearTimeout(this._releaseTimeout);\r\n        this.callBase()\r\n    }\r\n});\r\nmodule.exports = PullDownNativeScrollViewStrategy;\r\n"]},"metadata":{},"sourceType":"module"}