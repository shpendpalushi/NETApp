{"ast":null,"code":"/**\r\n * DevExtreme (ui/tree_list/ui.tree_list.selection.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar _renderer = require(\"../../core/renderer\");\n\nvar _renderer2 = _interopRequireDefault(_renderer);\n\nvar _uiTree_list = require(\"./ui.tree_list.core\");\n\nvar _uiTree_list2 = _interopRequireDefault(_uiTree_list);\n\nvar _common = require(\"../../core/utils/common\");\n\nvar _uiGrid_core = require(\"../grid_core/ui.grid_core.selection\");\n\nvar _uiGrid_core2 = _interopRequireDefault(_uiGrid_core);\n\nvar _ui = require(\"../widget/ui.errors\");\n\nvar _ui2 = _interopRequireDefault(_ui);\n\nvar _extend = require(\"../../core/utils/extend\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nvar TREELIST_SELECT_ALL_CLASS = \"dx-treelist-select-all\";\nvar CELL_FOCUS_DISABLED_CLASS = \"dx-cell-focus-disabled\";\nvar SELECT_CHECKBOX_CLASS = \"dx-select-checkbox\";\nvar originalRowClick = _uiGrid_core2.default.extenders.views.rowsView._rowClick;\nvar originalHandleDataChanged = _uiGrid_core2.default.extenders.controllers.data._handleDataChanged;\n\nvar nodeExists = function nodeExists(array, currentKey) {\n  return !!array.filter(function (key) {\n    return key === currentKey;\n  }).length;\n};\n\n_uiTree_list2.default.registerModule(\"selection\", (0, _extend.extend)(true, {}, _uiGrid_core2.default, {\n  defaultOptions: function defaultOptions() {\n    return (0, _extend.extend)(true, _uiGrid_core2.default.defaultOptions(), {\n      selection: {\n        showCheckBoxesMode: \"always\",\n        recursive: false\n      }\n    });\n  },\n  extenders: {\n    controllers: {\n      data: {\n        _handleDataChanged: function _handleDataChanged(e) {\n          var selectionController = this.getController(\"selection\");\n          var isRecursiveSelection = selectionController.isRecursiveSelection();\n\n          if (isRecursiveSelection && (!e || \"updateSelectionState\" !== e.changeType)) {\n            selectionController.updateSelectionState({\n              selectedItemKeys: this.option(\"selectedRowKeys\")\n            });\n          }\n\n          originalHandleDataChanged.apply(this, arguments);\n        },\n        loadDescendants: function loadDescendants() {\n          var that = this;\n          var d = that.callBase.apply(that, arguments);\n          var selectionController = that.getController(\"selection\");\n          var isRecursiveSelection = selectionController.isRecursiveSelection();\n\n          if (isRecursiveSelection) {\n            d.done(function () {\n              selectionController.updateSelectionState({\n                selectedItemKeys: that.option(\"selectedRowKeys\")\n              });\n            });\n          }\n\n          return d;\n        }\n      },\n      selection: {\n        init: function init() {\n          this.callBase.apply(this, arguments);\n          this._selectionStateByKey = {};\n        },\n        _getSelectionConfig: function _getSelectionConfig() {\n          var _arguments = arguments,\n              _this = this;\n\n          var config = this.callBase.apply(this, arguments);\n          var plainItems = config.plainItems;\n\n          config.plainItems = function (all) {\n            if (all) {\n              return _this._dataController.getCachedStoreData() || [];\n            }\n\n            return plainItems.apply(_this, _arguments).map(function (item) {\n              return item.data;\n            });\n          };\n\n          config.isItemSelected = function (item) {\n            var key = _this._dataController.keyOf(item);\n\n            return _this.isRowSelected(key);\n          };\n\n          config.isSelectableItem = function () {\n            return true;\n          };\n\n          config.getItemData = function (item) {\n            return item;\n          };\n\n          return config;\n        },\n        renderSelectCheckBoxContainer: function renderSelectCheckBoxContainer($container, model) {\n          var that = this;\n          var rowsView = that.component.getView(\"rowsView\");\n          $container.addClass(CELL_FOCUS_DISABLED_CLASS);\n\n          var $checkbox = rowsView._renderSelectCheckBox($container, {\n            value: model.row.isSelected,\n            row: model.row,\n            column: model.column\n          });\n\n          rowsView._attachCheckBoxClickEvent($checkbox);\n        },\n        _updateSelectColumn: _common.noop,\n        _getVisibleNodeKeys: function _getVisibleNodeKeys(isRecursiveSelection) {\n          var component = this.component;\n          var root = component.getRootNode();\n          var cache = {};\n          var keys = [];\n          root && _uiTree_list2.default.foreachNodes(root.children, function (node) {\n            if (void 0 !== node.key && (node.visible || isRecursiveSelection)) {\n              keys.push(node.key);\n            }\n\n            return isRecursiveSelection ? false : component.isRowExpanded(node.key, cache);\n          });\n          return keys;\n        },\n        isSelectAll: function isSelectAll() {\n          var component = this.component;\n          var hasIndeterminateState;\n\n          var visibleKeys = this._getVisibleNodeKeys();\n\n          var selectedVisibleKeys = visibleKeys.filter(function (key) {\n            return component.isRowSelected(key);\n          });\n\n          if (!selectedVisibleKeys.length) {\n            hasIndeterminateState = visibleKeys.some(function (key) {\n              return void 0 === component.isRowSelected(key);\n            });\n            return hasIndeterminateState ? void 0 : false;\n          } else {\n            if (selectedVisibleKeys.length === visibleKeys.length) {\n              return true;\n            }\n          }\n        },\n        selectAll: function selectAll() {\n          var that = this;\n          var isRecursiveSelection = that.isRecursiveSelection();\n\n          var visibleKeys = that._getVisibleNodeKeys(isRecursiveSelection).filter(function (key) {\n            return !that.isRowSelected(key);\n          });\n\n          return that.selectRows(visibleKeys, true);\n        },\n        deselectAll: function deselectAll() {\n          var isRecursiveSelection = this.isRecursiveSelection();\n\n          var visibleKeys = this._getVisibleNodeKeys(isRecursiveSelection);\n\n          return this.deselectRows(visibleKeys);\n        },\n        selectedItemKeys: function selectedItemKeys(value, preserve, isDeselect, isSelectAll) {\n          var that = this;\n          var selectedRowKeys = that.option(\"selectedRowKeys\");\n          var isRecursiveSelection = this.isRecursiveSelection();\n\n          var normalizedArgs = isRecursiveSelection && that._normalizeSelectionArgs({\n            keys: value || []\n          }, !isDeselect);\n\n          if (normalizedArgs && !(0, _common.equalByValue)(normalizedArgs.selectedRowKeys, selectedRowKeys)) {\n            that._isSelectionNormalizing = true;\n            return this.callBase(normalizedArgs.selectedRowKeys, false, false, false).always(function () {\n              that._isSelectionNormalizing = false;\n            }).done(function (items) {\n              normalizedArgs.selectedRowsData = items;\n\n              that._fireSelectionChanged(normalizedArgs);\n            });\n          }\n\n          return this.callBase(value, preserve, isDeselect, isSelectAll);\n        },\n        changeItemSelection: function changeItemSelection(itemIndex, keyboardKeys) {\n          var isRecursiveSelection = this.isRecursiveSelection();\n\n          if (isRecursiveSelection && !keyboardKeys.shift) {\n            var key = this._dataController.getKeyByRowIndex(itemIndex);\n\n            return this.selectedItemKeys(key, true, this.isRowSelected(key));\n          }\n\n          return this.callBase.apply(this, arguments);\n        },\n        _updateParentSelectionState: function _updateParentSelectionState(node, isSelected) {\n          var that = this;\n          var state = isSelected;\n          var parentNode = node.parent;\n          var hasNonSelectedState;\n          var hasSelectedState;\n\n          if (parentNode) {\n            if (parentNode.children.length > 1) {\n              if (false === isSelected) {\n                hasSelectedState = parentNode.children.some(function (childNode, index, children) {\n                  return that._selectionStateByKey[childNode.key];\n                });\n                state = hasSelectedState ? void 0 : false;\n              } else {\n                if (true === isSelected) {\n                  hasNonSelectedState = parentNode.children.some(function (childNode) {\n                    return !that._selectionStateByKey[childNode.key];\n                  });\n                  state = hasNonSelectedState ? void 0 : true;\n                }\n              }\n            }\n\n            this._selectionStateByKey[parentNode.key] = state;\n\n            if (parentNode.parent && parentNode.parent.level >= 0) {\n              this._updateParentSelectionState(parentNode, state);\n            }\n          }\n        },\n        _updateChildrenSelectionState: function _updateChildrenSelectionState(node, isSelected) {\n          var that = this;\n          var children = node.children;\n          children && children.forEach(function (childNode) {\n            that._selectionStateByKey[childNode.key] = isSelected;\n\n            if (childNode.children.length > 0) {\n              that._updateChildrenSelectionState(childNode, isSelected);\n            }\n          });\n        },\n        _updateSelectionStateCore: function _updateSelectionStateCore(keys, isSelected) {\n          var node;\n          var dataController = this._dataController;\n\n          for (var i = 0; i < keys.length; i++) {\n            this._selectionStateByKey[keys[i]] = isSelected;\n            node = dataController.getNodeByKey(keys[i]);\n\n            if (node) {\n              this._updateParentSelectionState(node, isSelected);\n\n              this._updateChildrenSelectionState(node, isSelected);\n            }\n          }\n        },\n        _getSelectedParentKeys: function _getSelectedParentKeys(key, selectedItemKeys, useCash) {\n          var isSelected;\n          var selectedParentNode;\n\n          var node = this._dataController.getNodeByKey(key);\n\n          var parentNode = node && node.parent;\n          var result = [];\n\n          while (parentNode && parentNode.level >= 0) {\n            result.unshift(parentNode.key);\n            isSelected = useCash ? !nodeExists(selectedItemKeys, parentNode.key) && this.isRowSelected(parentNode.key) : selectedItemKeys.indexOf(parentNode.key) >= 0;\n\n            if (isSelected) {\n              selectedParentNode = parentNode;\n              result = this._getSelectedParentKeys(selectedParentNode.key, selectedItemKeys, useCash).concat(result);\n              break;\n            } else {\n              if (useCash) {\n                break;\n              }\n            }\n\n            parentNode = parentNode.parent;\n          }\n\n          return selectedParentNode && result || [];\n        },\n        _getSelectedChildKeys: function _getSelectedChildKeys(node, keysToIgnore) {\n          var that = this;\n          var childKeys = [];\n          node && _uiTree_list2.default.foreachNodes(node.children, function (childNode) {\n            var ignoreKeyIndex = keysToIgnore.indexOf(childNode.key);\n\n            if (ignoreKeyIndex < 0) {\n              childKeys.push(childNode.key);\n            }\n\n            return ignoreKeyIndex > 0 || ignoreKeyIndex < 0 && void 0 === that._selectionStateByKey[childNode.key];\n          });\n          return childKeys;\n        },\n        _normalizeParentKeys: function _normalizeParentKeys(key, args) {\n          var that = this;\n          var index;\n          var childKeys;\n          var parentNode;\n          var keysToIgnore = [key];\n\n          var parentNodeKeys = that._getSelectedParentKeys(key, args.selectedRowKeys);\n\n          if (parentNodeKeys.length) {\n            keysToIgnore = keysToIgnore.concat(parentNodeKeys);\n            keysToIgnore.forEach(function (key) {\n              index = args.selectedRowKeys.indexOf(key);\n\n              if (index >= 0) {\n                args.selectedRowKeys.splice(index, 1);\n              }\n            });\n            parentNode = that._dataController.getNodeByKey(parentNodeKeys[0]);\n            childKeys = that._getSelectedChildKeys(parentNode, keysToIgnore);\n            args.selectedRowKeys = args.selectedRowKeys.concat(childKeys);\n          }\n        },\n        _normalizeChildrenKeys: function _normalizeChildrenKeys(key, args) {\n          var that = this;\n          var index;\n\n          var node = that._dataController.getNodeByKey(key);\n\n          node && node.children.forEach(function (childNode) {\n            index = args.selectedRowKeys.indexOf(childNode.key);\n\n            if (index >= 0) {\n              args.selectedRowKeys.splice(index, 1);\n            }\n\n            that._normalizeChildrenKeys(childNode.key, args);\n          });\n        },\n        _normalizeSelectedRowKeysCore: function _normalizeSelectedRowKeysCore(keys, args, isSelect) {\n          var that = this;\n          var index;\n          keys.forEach(function (key) {\n            if (that.isRowSelected(key) === isSelect) {\n              return;\n            }\n\n            that._normalizeChildrenKeys(key, args);\n\n            index = args.selectedRowKeys.indexOf(key);\n\n            if (isSelect) {\n              if (index < 0) {\n                args.selectedRowKeys.push(key);\n              }\n\n              args.currentSelectedRowKeys.push(key);\n            } else {\n              if (index >= 0) {\n                args.selectedRowKeys.splice(index, 1);\n              }\n\n              args.currentDeselectedRowKeys.push(key);\n\n              that._normalizeParentKeys(key, args);\n            }\n          });\n        },\n        _normalizeSelectionArgs: function _normalizeSelectionArgs(args, isSelect) {\n          var result;\n          var keys = Array.isArray(args.keys) ? args.keys : [args.keys];\n          var selectedRowKeys = this.option(\"selectedRowKeys\") || [];\n\n          if (keys.length) {\n            result = {\n              currentSelectedRowKeys: [],\n              currentDeselectedRowKeys: [],\n              selectedRowKeys: selectedRowKeys.slice(0)\n            };\n\n            this._normalizeSelectedRowKeysCore(keys, result, isSelect);\n          }\n\n          return result;\n        },\n        _updateSelectedItems: function _updateSelectedItems(args) {\n          this.updateSelectionState(args);\n          this.callBase(args);\n        },\n        _fireSelectionChanged: function _fireSelectionChanged() {\n          if (!this._isSelectionNormalizing) {\n            this.callBase.apply(this, arguments);\n          }\n        },\n        _isModeLeavesOnly: function _isModeLeavesOnly(mode) {\n          return \"leavesOnly\" === mode || true === mode;\n        },\n        _getAllSelectedRowKeys: function _getAllSelectedRowKeys(parentKeys) {\n          var that = this;\n          var result = [];\n          parentKeys.forEach(function (key) {\n            var insertIndex = result.length;\n\n            var parentKeys = that._getSelectedParentKeys(key, result, true);\n\n            var childKeys = that._dataController.getChildNodeKeys(key);\n\n            result.splice.apply(result, [insertIndex, 0].concat(parentKeys));\n            result.push(key);\n            result = result.concat(childKeys);\n          });\n          return result;\n        },\n        _getParentSelectedRowKeys: function _getParentSelectedRowKeys(keys) {\n          var that = this;\n          var result = [];\n          keys.forEach(function (key) {\n            var parentKeys = that._getSelectedParentKeys(key, keys);\n\n            !parentKeys.length && result.push(key);\n          });\n          return result;\n        },\n        _getLeafSelectedRowKeys: function _getLeafSelectedRowKeys(keys) {\n          var that = this;\n          var result = [];\n          var dataController = that._dataController;\n          keys.forEach(function (key) {\n            var node = dataController.getNodeByKey(key);\n            node && !node.hasChildren && result.push(key);\n          });\n          return result;\n        },\n        isRecursiveSelection: function isRecursiveSelection() {\n          var selectionMode = this.option(\"selection.mode\");\n          var isRecursive = this.option(\"selection.recursive\");\n          return \"multiple\" === selectionMode && isRecursive;\n        },\n        updateSelectionState: function updateSelectionState(options) {\n          var removedItemKeys = options.removedItemKeys || [];\n          var selectedItemKeys = options.selectedItemKeys || [];\n\n          this._updateSelectionStateCore(removedItemKeys, false);\n\n          this._updateSelectionStateCore(selectedItemKeys, true);\n        },\n        isRowSelected: function isRowSelected(key) {\n          var result = this.callBase.apply(this, arguments);\n          var isRecursiveSelection = this.isRecursiveSelection();\n\n          if (!result && isRecursiveSelection) {\n            if (key in this._selectionStateByKey) {\n              return this._selectionStateByKey[key];\n            }\n\n            return false;\n          }\n\n          return result;\n        },\n        getSelectedRowKeys: function getSelectedRowKeys(mode) {\n          var that = this;\n\n          if (!that._dataController) {\n            return [];\n          }\n\n          if (true === mode) {\n            _ui2.default.log(\"W0002\", \"dxTreeList\", \"getSelectedRowKeys(leavesOnly)\", \"18.1\", \"Use the 'getSelectedRowKeys(mode)' method with a string parameter instead\");\n          }\n\n          var selectedRowKeys = that.callBase.apply(that, arguments);\n\n          if (mode) {\n            if (this.isRecursiveSelection()) {\n              selectedRowKeys = this._getAllSelectedRowKeys(selectedRowKeys);\n            }\n\n            if (\"all\" !== mode) {\n              if (\"excludeRecursive\" === mode) {\n                selectedRowKeys = that._getParentSelectedRowKeys(selectedRowKeys);\n              } else {\n                if (that._isModeLeavesOnly(mode)) {\n                  selectedRowKeys = that._getLeafSelectedRowKeys(selectedRowKeys);\n                }\n              }\n            }\n          }\n\n          return selectedRowKeys;\n        },\n        getSelectedRowsData: function getSelectedRowsData(mode) {\n          var that = this;\n          var dataController = that._dataController;\n          var selectedKeys = this.getSelectedRowKeys(mode) || [];\n          var selectedRowsData = [];\n          selectedKeys.forEach(function (key) {\n            var node = dataController.getNodeByKey(key);\n            node && selectedRowsData.push(node.data);\n          });\n          return selectedRowsData;\n        },\n        refresh: function refresh() {\n          this._selectionStateByKey = {};\n          return this.callBase.apply(this, arguments);\n        }\n      }\n    },\n    views: {\n      columnHeadersView: {\n        _processTemplate: function _processTemplate(template, options) {\n          var that = this;\n          var resultTemplate;\n          var renderingTemplate = this.callBase(template, options);\n\n          var firstDataColumnIndex = that._columnsController.getFirstDataColumnIndex();\n\n          if (renderingTemplate && \"header\" === options.rowType && options.column.index === firstDataColumnIndex) {\n            resultTemplate = {\n              render: function render(options) {\n                if (\"multiple\" === that.option(\"selection.mode\")) {\n                  that.renderSelectAll(options.container, options.model);\n                }\n\n                renderingTemplate.render(options);\n              }\n            };\n          } else {\n            resultTemplate = renderingTemplate;\n          }\n\n          return resultTemplate;\n        },\n        renderSelectAll: function renderSelectAll($cell, options) {\n          $cell.addClass(TREELIST_SELECT_ALL_CLASS);\n\n          this._renderSelectAllCheckBox($cell);\n        },\n        _isSortableElement: function _isSortableElement($target) {\n          return this.callBase($target) && !$target.closest(\".\" + SELECT_CHECKBOX_CLASS).length;\n        }\n      },\n      rowsView: {\n        _renderIcons: function _renderIcons($iconContainer, options) {\n          this.callBase.apply(this, arguments);\n\n          if (\"multiple\" === this.option(\"selection.mode\")) {\n            this.getController(\"selection\").renderSelectCheckBoxContainer($iconContainer, options);\n          }\n\n          return $iconContainer;\n        },\n        _rowClick: function _rowClick(e) {\n          var $targetElement = (0, _renderer2.default)(e.event.target);\n\n          if (this.isExpandIcon($targetElement)) {\n            this.callBase.apply(this, arguments);\n          } else {\n            originalRowClick.apply(this, arguments);\n          }\n        }\n      }\n    }\n  }\n}));","map":{"version":3,"sources":["C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/devextreme/ui/tree_list/ui.tree_list.selection.js"],"names":["_renderer","require","_renderer2","_interopRequireDefault","_uiTree_list","_uiTree_list2","_common","_uiGrid_core","_uiGrid_core2","_ui","_ui2","_extend","obj","TREELIST_SELECT_ALL_CLASS","CELL_FOCUS_DISABLED_CLASS","SELECT_CHECKBOX_CLASS","originalRowClick","originalHandleDataChanged","nodeExists","key","defaultOptions","selection","showCheckBoxesMode","recursive","extenders","controllers","data","_handleDataChanged","selectionController","isRecursiveSelection","e","selectedItemKeys","loadDescendants","that","d","init","_getSelectionConfig","_arguments","_this","config","plainItems","item","renderSelectCheckBoxContainer","rowsView","$container","$checkbox","value","model","row","column","_updateSelectColumn","_getVisibleNodeKeys","component","root","cache","keys","node","isSelectAll","visibleKeys","selectedVisibleKeys","hasIndeterminateState","selectAll","deselectAll","selectedRowKeys","normalizedArgs","changeItemSelection","keyboardKeys","_updateParentSelectionState","state","parentNode","hasSelectedState","childNode","hasNonSelectedState","_updateChildrenSelectionState","children","_updateSelectionStateCore","dataController","i","_getSelectedParentKeys","result","isSelected","useCash","selectedParentNode","_getSelectedChildKeys","childKeys","ignoreKeyIndex","keysToIgnore","_normalizeParentKeys","parentNodeKeys","args","index","_normalizeChildrenKeys","_normalizeSelectedRowKeysCore","_normalizeSelectionArgs","Array","currentSelectedRowKeys","currentDeselectedRowKeys","_updateSelectedItems","_fireSelectionChanged","_isModeLeavesOnly","_getAllSelectedRowKeys","parentKeys","insertIndex","_getParentSelectedRowKeys","_getLeafSelectedRowKeys","selectionMode","isRecursive","updateSelectionState","removedItemKeys","options","isRowSelected","getSelectedRowKeys","getSelectedRowsData","selectedKeys","selectedRowsData","refresh","views","columnHeadersView","_processTemplate","renderingTemplate","firstDataColumnIndex","resultTemplate","render","renderSelectAll","$cell","_isSortableElement","$target","_renderIcons","_rowClick","$targetElement"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/tree_list/ui.tree_list.selection.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar _renderer = require(\"../../core/renderer\");\r\nvar _renderer2 = _interopRequireDefault(_renderer);\r\nvar _uiTree_list = require(\"./ui.tree_list.core\");\r\nvar _uiTree_list2 = _interopRequireDefault(_uiTree_list);\r\nvar _common = require(\"../../core/utils/common\");\r\nvar _uiGrid_core = require(\"../grid_core/ui.grid_core.selection\");\r\nvar _uiGrid_core2 = _interopRequireDefault(_uiGrid_core);\r\nvar _ui = require(\"../widget/ui.errors\");\r\nvar _ui2 = _interopRequireDefault(_ui);\r\nvar _extend = require(\"../../core/utils/extend\");\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\nvar TREELIST_SELECT_ALL_CLASS = \"dx-treelist-select-all\";\r\nvar CELL_FOCUS_DISABLED_CLASS = \"dx-cell-focus-disabled\";\r\nvar SELECT_CHECKBOX_CLASS = \"dx-select-checkbox\";\r\nvar originalRowClick = _uiGrid_core2.default.extenders.views.rowsView._rowClick;\r\nvar originalHandleDataChanged = _uiGrid_core2.default.extenders.controllers.data._handleDataChanged;\r\nvar nodeExists = function(array, currentKey) {\r\n    return !!array.filter(function(key) {\r\n        return key === currentKey\r\n    }).length\r\n};\r\n_uiTree_list2.default.registerModule(\"selection\", (0, _extend.extend)(true, {}, _uiGrid_core2.default, {\r\n    defaultOptions: function() {\r\n        return (0, _extend.extend)(true, _uiGrid_core2.default.defaultOptions(), {\r\n            selection: {\r\n                showCheckBoxesMode: \"always\",\r\n                recursive: false\r\n            }\r\n        })\r\n    },\r\n    extenders: {\r\n        controllers: {\r\n            data: {\r\n                _handleDataChanged: function(e) {\r\n                    var selectionController = this.getController(\"selection\");\r\n                    var isRecursiveSelection = selectionController.isRecursiveSelection();\r\n                    if (isRecursiveSelection && (!e || \"updateSelectionState\" !== e.changeType)) {\r\n                        selectionController.updateSelectionState({\r\n                            selectedItemKeys: this.option(\"selectedRowKeys\")\r\n                        })\r\n                    }\r\n                    originalHandleDataChanged.apply(this, arguments)\r\n                },\r\n                loadDescendants: function() {\r\n                    var that = this;\r\n                    var d = that.callBase.apply(that, arguments);\r\n                    var selectionController = that.getController(\"selection\");\r\n                    var isRecursiveSelection = selectionController.isRecursiveSelection();\r\n                    if (isRecursiveSelection) {\r\n                        d.done(function() {\r\n                            selectionController.updateSelectionState({\r\n                                selectedItemKeys: that.option(\"selectedRowKeys\")\r\n                            })\r\n                        })\r\n                    }\r\n                    return d\r\n                }\r\n            },\r\n            selection: {\r\n                init: function() {\r\n                    this.callBase.apply(this, arguments);\r\n                    this._selectionStateByKey = {}\r\n                },\r\n                _getSelectionConfig: function() {\r\n                    var _arguments = arguments,\r\n                        _this = this;\r\n                    var config = this.callBase.apply(this, arguments);\r\n                    var plainItems = config.plainItems;\r\n                    config.plainItems = function(all) {\r\n                        if (all) {\r\n                            return _this._dataController.getCachedStoreData() || []\r\n                        }\r\n                        return plainItems.apply(_this, _arguments).map(function(item) {\r\n                            return item.data\r\n                        })\r\n                    };\r\n                    config.isItemSelected = function(item) {\r\n                        var key = _this._dataController.keyOf(item);\r\n                        return _this.isRowSelected(key)\r\n                    };\r\n                    config.isSelectableItem = function() {\r\n                        return true\r\n                    };\r\n                    config.getItemData = function(item) {\r\n                        return item\r\n                    };\r\n                    return config\r\n                },\r\n                renderSelectCheckBoxContainer: function($container, model) {\r\n                    var that = this;\r\n                    var rowsView = that.component.getView(\"rowsView\");\r\n                    $container.addClass(CELL_FOCUS_DISABLED_CLASS);\r\n                    var $checkbox = rowsView._renderSelectCheckBox($container, {\r\n                        value: model.row.isSelected,\r\n                        row: model.row,\r\n                        column: model.column\r\n                    });\r\n                    rowsView._attachCheckBoxClickEvent($checkbox)\r\n                },\r\n                _updateSelectColumn: _common.noop,\r\n                _getVisibleNodeKeys: function(isRecursiveSelection) {\r\n                    var component = this.component;\r\n                    var root = component.getRootNode();\r\n                    var cache = {};\r\n                    var keys = [];\r\n                    root && _uiTree_list2.default.foreachNodes(root.children, function(node) {\r\n                        if (void 0 !== node.key && (node.visible || isRecursiveSelection)) {\r\n                            keys.push(node.key)\r\n                        }\r\n                        return isRecursiveSelection ? false : component.isRowExpanded(node.key, cache)\r\n                    });\r\n                    return keys\r\n                },\r\n                isSelectAll: function() {\r\n                    var component = this.component;\r\n                    var hasIndeterminateState;\r\n                    var visibleKeys = this._getVisibleNodeKeys();\r\n                    var selectedVisibleKeys = visibleKeys.filter(function(key) {\r\n                        return component.isRowSelected(key)\r\n                    });\r\n                    if (!selectedVisibleKeys.length) {\r\n                        hasIndeterminateState = visibleKeys.some(function(key) {\r\n                            return void 0 === component.isRowSelected(key)\r\n                        });\r\n                        return hasIndeterminateState ? void 0 : false\r\n                    } else {\r\n                        if (selectedVisibleKeys.length === visibleKeys.length) {\r\n                            return true\r\n                        }\r\n                    }\r\n                },\r\n                selectAll: function() {\r\n                    var that = this;\r\n                    var isRecursiveSelection = that.isRecursiveSelection();\r\n                    var visibleKeys = that._getVisibleNodeKeys(isRecursiveSelection).filter(function(key) {\r\n                        return !that.isRowSelected(key)\r\n                    });\r\n                    return that.selectRows(visibleKeys, true)\r\n                },\r\n                deselectAll: function() {\r\n                    var isRecursiveSelection = this.isRecursiveSelection();\r\n                    var visibleKeys = this._getVisibleNodeKeys(isRecursiveSelection);\r\n                    return this.deselectRows(visibleKeys)\r\n                },\r\n                selectedItemKeys: function(value, preserve, isDeselect, isSelectAll) {\r\n                    var that = this;\r\n                    var selectedRowKeys = that.option(\"selectedRowKeys\");\r\n                    var isRecursiveSelection = this.isRecursiveSelection();\r\n                    var normalizedArgs = isRecursiveSelection && that._normalizeSelectionArgs({\r\n                        keys: value || []\r\n                    }, !isDeselect);\r\n                    if (normalizedArgs && !(0, _common.equalByValue)(normalizedArgs.selectedRowKeys, selectedRowKeys)) {\r\n                        that._isSelectionNormalizing = true;\r\n                        return this.callBase(normalizedArgs.selectedRowKeys, false, false, false).always(function() {\r\n                            that._isSelectionNormalizing = false\r\n                        }).done(function(items) {\r\n                            normalizedArgs.selectedRowsData = items;\r\n                            that._fireSelectionChanged(normalizedArgs)\r\n                        })\r\n                    }\r\n                    return this.callBase(value, preserve, isDeselect, isSelectAll)\r\n                },\r\n                changeItemSelection: function(itemIndex, keyboardKeys) {\r\n                    var isRecursiveSelection = this.isRecursiveSelection();\r\n                    if (isRecursiveSelection && !keyboardKeys.shift) {\r\n                        var key = this._dataController.getKeyByRowIndex(itemIndex);\r\n                        return this.selectedItemKeys(key, true, this.isRowSelected(key))\r\n                    }\r\n                    return this.callBase.apply(this, arguments)\r\n                },\r\n                _updateParentSelectionState: function(node, isSelected) {\r\n                    var that = this;\r\n                    var state = isSelected;\r\n                    var parentNode = node.parent;\r\n                    var hasNonSelectedState;\r\n                    var hasSelectedState;\r\n                    if (parentNode) {\r\n                        if (parentNode.children.length > 1) {\r\n                            if (false === isSelected) {\r\n                                hasSelectedState = parentNode.children.some(function(childNode, index, children) {\r\n                                    return that._selectionStateByKey[childNode.key]\r\n                                });\r\n                                state = hasSelectedState ? void 0 : false\r\n                            } else {\r\n                                if (true === isSelected) {\r\n                                    hasNonSelectedState = parentNode.children.some(function(childNode) {\r\n                                        return !that._selectionStateByKey[childNode.key]\r\n                                    });\r\n                                    state = hasNonSelectedState ? void 0 : true\r\n                                }\r\n                            }\r\n                        }\r\n                        this._selectionStateByKey[parentNode.key] = state;\r\n                        if (parentNode.parent && parentNode.parent.level >= 0) {\r\n                            this._updateParentSelectionState(parentNode, state)\r\n                        }\r\n                    }\r\n                },\r\n                _updateChildrenSelectionState: function(node, isSelected) {\r\n                    var that = this;\r\n                    var children = node.children;\r\n                    children && children.forEach(function(childNode) {\r\n                        that._selectionStateByKey[childNode.key] = isSelected;\r\n                        if (childNode.children.length > 0) {\r\n                            that._updateChildrenSelectionState(childNode, isSelected)\r\n                        }\r\n                    })\r\n                },\r\n                _updateSelectionStateCore: function(keys, isSelected) {\r\n                    var node;\r\n                    var dataController = this._dataController;\r\n                    for (var i = 0; i < keys.length; i++) {\r\n                        this._selectionStateByKey[keys[i]] = isSelected;\r\n                        node = dataController.getNodeByKey(keys[i]);\r\n                        if (node) {\r\n                            this._updateParentSelectionState(node, isSelected);\r\n                            this._updateChildrenSelectionState(node, isSelected)\r\n                        }\r\n                    }\r\n                },\r\n                _getSelectedParentKeys: function(key, selectedItemKeys, useCash) {\r\n                    var isSelected;\r\n                    var selectedParentNode;\r\n                    var node = this._dataController.getNodeByKey(key);\r\n                    var parentNode = node && node.parent;\r\n                    var result = [];\r\n                    while (parentNode && parentNode.level >= 0) {\r\n                        result.unshift(parentNode.key);\r\n                        isSelected = useCash ? !nodeExists(selectedItemKeys, parentNode.key) && this.isRowSelected(parentNode.key) : selectedItemKeys.indexOf(parentNode.key) >= 0;\r\n                        if (isSelected) {\r\n                            selectedParentNode = parentNode;\r\n                            result = this._getSelectedParentKeys(selectedParentNode.key, selectedItemKeys, useCash).concat(result);\r\n                            break\r\n                        } else {\r\n                            if (useCash) {\r\n                                break\r\n                            }\r\n                        }\r\n                        parentNode = parentNode.parent\r\n                    }\r\n                    return selectedParentNode && result || []\r\n                },\r\n                _getSelectedChildKeys: function(node, keysToIgnore) {\r\n                    var that = this;\r\n                    var childKeys = [];\r\n                    node && _uiTree_list2.default.foreachNodes(node.children, function(childNode) {\r\n                        var ignoreKeyIndex = keysToIgnore.indexOf(childNode.key);\r\n                        if (ignoreKeyIndex < 0) {\r\n                            childKeys.push(childNode.key)\r\n                        }\r\n                        return ignoreKeyIndex > 0 || ignoreKeyIndex < 0 && void 0 === that._selectionStateByKey[childNode.key]\r\n                    });\r\n                    return childKeys\r\n                },\r\n                _normalizeParentKeys: function(key, args) {\r\n                    var that = this;\r\n                    var index;\r\n                    var childKeys;\r\n                    var parentNode;\r\n                    var keysToIgnore = [key];\r\n                    var parentNodeKeys = that._getSelectedParentKeys(key, args.selectedRowKeys);\r\n                    if (parentNodeKeys.length) {\r\n                        keysToIgnore = keysToIgnore.concat(parentNodeKeys);\r\n                        keysToIgnore.forEach(function(key) {\r\n                            index = args.selectedRowKeys.indexOf(key);\r\n                            if (index >= 0) {\r\n                                args.selectedRowKeys.splice(index, 1)\r\n                            }\r\n                        });\r\n                        parentNode = that._dataController.getNodeByKey(parentNodeKeys[0]);\r\n                        childKeys = that._getSelectedChildKeys(parentNode, keysToIgnore);\r\n                        args.selectedRowKeys = args.selectedRowKeys.concat(childKeys)\r\n                    }\r\n                },\r\n                _normalizeChildrenKeys: function(key, args) {\r\n                    var that = this;\r\n                    var index;\r\n                    var node = that._dataController.getNodeByKey(key);\r\n                    node && node.children.forEach(function(childNode) {\r\n                        index = args.selectedRowKeys.indexOf(childNode.key);\r\n                        if (index >= 0) {\r\n                            args.selectedRowKeys.splice(index, 1)\r\n                        }\r\n                        that._normalizeChildrenKeys(childNode.key, args)\r\n                    })\r\n                },\r\n                _normalizeSelectedRowKeysCore: function(keys, args, isSelect) {\r\n                    var that = this;\r\n                    var index;\r\n                    keys.forEach(function(key) {\r\n                        if (that.isRowSelected(key) === isSelect) {\r\n                            return\r\n                        }\r\n                        that._normalizeChildrenKeys(key, args);\r\n                        index = args.selectedRowKeys.indexOf(key);\r\n                        if (isSelect) {\r\n                            if (index < 0) {\r\n                                args.selectedRowKeys.push(key)\r\n                            }\r\n                            args.currentSelectedRowKeys.push(key)\r\n                        } else {\r\n                            if (index >= 0) {\r\n                                args.selectedRowKeys.splice(index, 1)\r\n                            }\r\n                            args.currentDeselectedRowKeys.push(key);\r\n                            that._normalizeParentKeys(key, args)\r\n                        }\r\n                    })\r\n                },\r\n                _normalizeSelectionArgs: function(args, isSelect) {\r\n                    var result;\r\n                    var keys = Array.isArray(args.keys) ? args.keys : [args.keys];\r\n                    var selectedRowKeys = this.option(\"selectedRowKeys\") || [];\r\n                    if (keys.length) {\r\n                        result = {\r\n                            currentSelectedRowKeys: [],\r\n                            currentDeselectedRowKeys: [],\r\n                            selectedRowKeys: selectedRowKeys.slice(0)\r\n                        };\r\n                        this._normalizeSelectedRowKeysCore(keys, result, isSelect)\r\n                    }\r\n                    return result\r\n                },\r\n                _updateSelectedItems: function(args) {\r\n                    this.updateSelectionState(args);\r\n                    this.callBase(args)\r\n                },\r\n                _fireSelectionChanged: function() {\r\n                    if (!this._isSelectionNormalizing) {\r\n                        this.callBase.apply(this, arguments)\r\n                    }\r\n                },\r\n                _isModeLeavesOnly: function(mode) {\r\n                    return \"leavesOnly\" === mode || true === mode\r\n                },\r\n                _getAllSelectedRowKeys: function(parentKeys) {\r\n                    var that = this;\r\n                    var result = [];\r\n                    parentKeys.forEach(function(key) {\r\n                        var insertIndex = result.length;\r\n                        var parentKeys = that._getSelectedParentKeys(key, result, true);\r\n                        var childKeys = that._dataController.getChildNodeKeys(key);\r\n                        result.splice.apply(result, [insertIndex, 0].concat(parentKeys));\r\n                        result.push(key);\r\n                        result = result.concat(childKeys)\r\n                    });\r\n                    return result\r\n                },\r\n                _getParentSelectedRowKeys: function(keys) {\r\n                    var that = this;\r\n                    var result = [];\r\n                    keys.forEach(function(key) {\r\n                        var parentKeys = that._getSelectedParentKeys(key, keys);\r\n                        !parentKeys.length && result.push(key)\r\n                    });\r\n                    return result\r\n                },\r\n                _getLeafSelectedRowKeys: function(keys) {\r\n                    var that = this;\r\n                    var result = [];\r\n                    var dataController = that._dataController;\r\n                    keys.forEach(function(key) {\r\n                        var node = dataController.getNodeByKey(key);\r\n                        node && !node.hasChildren && result.push(key)\r\n                    });\r\n                    return result\r\n                },\r\n                isRecursiveSelection: function() {\r\n                    var selectionMode = this.option(\"selection.mode\");\r\n                    var isRecursive = this.option(\"selection.recursive\");\r\n                    return \"multiple\" === selectionMode && isRecursive\r\n                },\r\n                updateSelectionState: function(options) {\r\n                    var removedItemKeys = options.removedItemKeys || [];\r\n                    var selectedItemKeys = options.selectedItemKeys || [];\r\n                    this._updateSelectionStateCore(removedItemKeys, false);\r\n                    this._updateSelectionStateCore(selectedItemKeys, true)\r\n                },\r\n                isRowSelected: function(key) {\r\n                    var result = this.callBase.apply(this, arguments);\r\n                    var isRecursiveSelection = this.isRecursiveSelection();\r\n                    if (!result && isRecursiveSelection) {\r\n                        if (key in this._selectionStateByKey) {\r\n                            return this._selectionStateByKey[key]\r\n                        }\r\n                        return false\r\n                    }\r\n                    return result\r\n                },\r\n                getSelectedRowKeys: function(mode) {\r\n                    var that = this;\r\n                    if (!that._dataController) {\r\n                        return []\r\n                    }\r\n                    if (true === mode) {\r\n                        _ui2.default.log(\"W0002\", \"dxTreeList\", \"getSelectedRowKeys(leavesOnly)\", \"18.1\", \"Use the 'getSelectedRowKeys(mode)' method with a string parameter instead\")\r\n                    }\r\n                    var selectedRowKeys = that.callBase.apply(that, arguments);\r\n                    if (mode) {\r\n                        if (this.isRecursiveSelection()) {\r\n                            selectedRowKeys = this._getAllSelectedRowKeys(selectedRowKeys)\r\n                        }\r\n                        if (\"all\" !== mode) {\r\n                            if (\"excludeRecursive\" === mode) {\r\n                                selectedRowKeys = that._getParentSelectedRowKeys(selectedRowKeys)\r\n                            } else {\r\n                                if (that._isModeLeavesOnly(mode)) {\r\n                                    selectedRowKeys = that._getLeafSelectedRowKeys(selectedRowKeys)\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                    return selectedRowKeys\r\n                },\r\n                getSelectedRowsData: function(mode) {\r\n                    var that = this;\r\n                    var dataController = that._dataController;\r\n                    var selectedKeys = this.getSelectedRowKeys(mode) || [];\r\n                    var selectedRowsData = [];\r\n                    selectedKeys.forEach(function(key) {\r\n                        var node = dataController.getNodeByKey(key);\r\n                        node && selectedRowsData.push(node.data)\r\n                    });\r\n                    return selectedRowsData\r\n                },\r\n                refresh: function() {\r\n                    this._selectionStateByKey = {};\r\n                    return this.callBase.apply(this, arguments)\r\n                }\r\n            }\r\n        },\r\n        views: {\r\n            columnHeadersView: {\r\n                _processTemplate: function(template, options) {\r\n                    var that = this;\r\n                    var resultTemplate;\r\n                    var renderingTemplate = this.callBase(template, options);\r\n                    var firstDataColumnIndex = that._columnsController.getFirstDataColumnIndex();\r\n                    if (renderingTemplate && \"header\" === options.rowType && options.column.index === firstDataColumnIndex) {\r\n                        resultTemplate = {\r\n                            render: function(options) {\r\n                                if (\"multiple\" === that.option(\"selection.mode\")) {\r\n                                    that.renderSelectAll(options.container, options.model)\r\n                                }\r\n                                renderingTemplate.render(options)\r\n                            }\r\n                        }\r\n                    } else {\r\n                        resultTemplate = renderingTemplate\r\n                    }\r\n                    return resultTemplate\r\n                },\r\n                renderSelectAll: function($cell, options) {\r\n                    $cell.addClass(TREELIST_SELECT_ALL_CLASS);\r\n                    this._renderSelectAllCheckBox($cell)\r\n                },\r\n                _isSortableElement: function($target) {\r\n                    return this.callBase($target) && !$target.closest(\".\" + SELECT_CHECKBOX_CLASS).length\r\n                }\r\n            },\r\n            rowsView: {\r\n                _renderIcons: function($iconContainer, options) {\r\n                    this.callBase.apply(this, arguments);\r\n                    if (\"multiple\" === this.option(\"selection.mode\")) {\r\n                        this.getController(\"selection\").renderSelectCheckBoxContainer($iconContainer, options)\r\n                    }\r\n                    return $iconContainer\r\n                },\r\n                _rowClick: function(e) {\r\n                    var $targetElement = (0, _renderer2.default)(e.event.target);\r\n                    if (this.isExpandIcon($targetElement)) {\r\n                        this.callBase.apply(this, arguments)\r\n                    } else {\r\n                        originalRowClick.apply(this, arguments)\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n}));\r\n"]},"metadata":{},"sourceType":"module"}