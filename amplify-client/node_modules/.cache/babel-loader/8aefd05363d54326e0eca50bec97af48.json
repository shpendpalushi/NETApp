{"ast":null,"code":"/**\r\n * DevExtreme (viz/core/export.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.plugin = exports.ExportMenu = exports.combineMarkups = exports.exportWidgets = exports.getMarkup = exports.exportFromMarkup = void 0;\n\nvar _extend = require(\"../../core/utils/extend\");\n\nvar _window = require(\"../../core/utils/window\");\n\nvar _utils = require(\"./utils\");\n\nvar _exporter = require(\"../../exporter\");\n\nvar _exporter2 = _interopRequireDefault(_exporter);\n\nvar _message = require(\"../../localization/message\");\n\nvar _message2 = _interopRequireDefault(_message);\n\nvar _type = require(\"../../core/utils/type\");\n\nvar _themes = require(\"../themes\");\n\nvar _themes2 = _interopRequireDefault(_themes);\n\nvar _hover = require(\"../../events/hover\");\n\nvar _hover2 = _interopRequireDefault(_hover);\n\nvar _pointer = require(\"../../events/pointer\");\n\nvar _pointer2 = _interopRequireDefault(_pointer);\n\nvar _console = require(\"../../core/utils/console\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nvar imageExporter = _exporter2.default.image;\nvar svgExporter = _exporter2.default.svg;\nvar pdfExporter = _exporter2.default.pdf;\nvar pointerActions = [_pointer2.default.down, _pointer2.default.move].join(\" \");\nvar BUTTON_SIZE = 35;\nvar ICON_COORDS = [[9, 12, 26, 12, 26, 14, 9, 14], [9, 17, 26, 17, 26, 19, 9, 19], [9, 22, 26, 22, 26, 24, 9, 24]];\nvar LIST_PADDING_TOP = 4;\nvar LIST_WIDTH = 120;\nvar VERTICAL_TEXT_MARGIN = 8;\nvar HORIZONTAL_TEXT_MARGIN = 15;\nvar MENU_ITEM_HEIGHT = 30;\nvar LIST_STROKE_WIDTH = 1;\nvar MARGIN = 10;\nvar SHADOW_OFFSET = 2;\nvar SHADOW_BLUR = 3;\nvar DEFAULT_EXPORT_FORMAT = \"PNG\";\nvar ALLOWED_IMAGE_FORMATS = [DEFAULT_EXPORT_FORMAT, \"JPEG\", \"GIF\"];\nvar ALLOWED_EXTRA_FORMATS = [\"PDF\", \"SVG\"];\nvar EXPORT_CSS_CLASS = \"dx-export-menu\";\nvar EXPORT_DATA_KEY = \"export-element-type\";\nvar FORMAT_DATA_KEY = \"export-element-format\";\nvar GET_COLOR_REGEX = /data-backgroundcolor=\"([^\"]*)\"/;\n\nfunction getValidFormats() {\n  var imageFormats = imageExporter.testFormats(ALLOWED_IMAGE_FORMATS);\n  return {\n    unsupported: imageFormats.unsupported,\n    supported: imageFormats.supported.concat(ALLOWED_EXTRA_FORMATS)\n  };\n}\n\nfunction validateFormat(format, incidentOccurred, validFormats) {\n  validFormats = validFormats || getValidFormats();\n  format = String(format).toUpperCase();\n\n  if (validFormats.supported.indexOf(format) !== -1) {\n    return format;\n  }\n\n  if (validFormats.unsupported.indexOf(format) !== -1) {\n    incidentOccurred && incidentOccurred(\"W2108\", [format]);\n  }\n}\n\nfunction getCreatorFunc(format) {\n  if (\"SVG\" === format) {\n    return svgExporter.getData;\n  } else {\n    if (\"PDF\" === format) {\n      return pdfExporter.getData;\n    } else {\n      return imageExporter.getData;\n    }\n  }\n}\n\nfunction _print(imageSrc, options) {\n  var document = (0, _window.getWindow)().document;\n  var iFrame = document.createElement(\"iframe\");\n  iFrame.onload = setPrint(imageSrc, options);\n  iFrame.style.visibility = \"hidden\";\n  iFrame.style.position = \"fixed\";\n  iFrame.style.right = \"0\";\n  iFrame.style.bottom = \"0\";\n  document.body.appendChild(iFrame);\n}\n\nfunction setPrint(imageSrc, options) {\n  return function () {\n    var _this = this;\n\n    var window = this.contentWindow;\n    var img = window.document.createElement(\"img\");\n    window.document.body.appendChild(img);\n\n    var removeFrame = function removeFrame() {\n      _this.parentElement.removeChild(_this);\n    };\n\n    img.addEventListener(\"load\", function () {\n      window.focus();\n      window.print();\n      removeFrame();\n    });\n    img.addEventListener(\"error\", removeFrame);\n    img.src = imageSrc;\n  };\n}\n\nfunction getItemAttributes(options, type, itemIndex) {\n  var x = BUTTON_SIZE - LIST_WIDTH;\n  var y = BUTTON_SIZE + LIST_PADDING_TOP + LIST_STROKE_WIDTH + itemIndex * MENU_ITEM_HEIGHT;\n  var attr = {\n    rect: {\n      width: LIST_WIDTH - 2 * LIST_STROKE_WIDTH,\n      height: MENU_ITEM_HEIGHT,\n      x: x + LIST_STROKE_WIDTH,\n      y: y\n    },\n    text: {\n      x: x + (options.rtl ? LIST_WIDTH - HORIZONTAL_TEXT_MARGIN : HORIZONTAL_TEXT_MARGIN),\n      y: y + MENU_ITEM_HEIGHT - VERTICAL_TEXT_MARGIN\n    }\n  };\n\n  if (\"printing\" === type) {\n    attr.separator = {\n      stroke: options.button.default.borderColor,\n      \"stroke-width\": LIST_STROKE_WIDTH,\n      cursor: \"pointer\",\n      sharp: \"v\",\n      d: \"M \" + x + \" \" + (y + MENU_ITEM_HEIGHT - LIST_STROKE_WIDTH) + \" L \" + (x + LIST_WIDTH) + \" \" + (y + MENU_ITEM_HEIGHT - LIST_STROKE_WIDTH)\n    };\n  }\n\n  return attr;\n}\n\nfunction createMenuItem(renderer, options, settings) {\n  var itemData = {};\n  var type = settings.type;\n  var format = settings.format;\n  var attr = getItemAttributes(options, type, settings.itemIndex);\n  var fontStyle = (0, _utils.patchFontOptions)(options.font);\n  fontStyle[\"pointer-events\"] = \"none\";\n  var menuItem = renderer.g().attr({\n    \"class\": EXPORT_CSS_CLASS + \"-list-item\"\n  });\n  itemData[EXPORT_DATA_KEY] = type;\n\n  if (format) {\n    itemData[FORMAT_DATA_KEY] = format;\n  }\n\n  var rect = renderer.rect();\n  rect.attr(attr.rect).css({\n    cursor: \"pointer\",\n    \"pointer-events\": \"all\"\n  }).data(itemData);\n  rect.on(_hover2.default.start + \".export\", function () {\n    return rect.attr({\n      fill: options.button.hover.backgroundColor\n    });\n  }).on(_hover2.default.end + \".export\", function () {\n    return rect.attr({\n      fill: null\n    });\n  });\n  rect.append(menuItem);\n  var text = renderer.text(settings.text).css(fontStyle).attr(attr.text).append(menuItem);\n\n  if (\"printing\" === type) {\n    renderer.path(null, \"line\").attr(attr.separator).append(menuItem);\n  }\n\n  return {\n    g: menuItem,\n    rect: rect,\n    resetState: function resetState() {\n      return rect.attr({\n        fill: null\n      });\n    },\n    fixPosition: function fixPosition() {\n      var textBBox = text.getBBox();\n      text.move(attr.text.x - textBBox.x - (options.rtl ? textBBox.width : 0));\n    }\n  };\n}\n\nfunction createMenuItems(renderer, options) {\n  var items = [];\n\n  if (options.printingEnabled) {\n    items.push(createMenuItem(renderer, options, {\n      type: \"printing\",\n      text: _message2.default.format(\"vizExport-printingButtonText\"),\n      itemIndex: items.length\n    }));\n  }\n\n  items = options.formats.reduce(function (r, format) {\n    r.push(createMenuItem(renderer, options, {\n      type: \"exporting\",\n      text: _message2.default.getFormatter(\"vizExport-exportButtonText\")(format),\n      format: format,\n      itemIndex: r.length\n    }));\n    return r;\n  }, items);\n  return items;\n}\n\nfunction getBackgroundColorFromMarkup(markup) {\n  var parsedMarkup = GET_COLOR_REGEX.exec(markup);\n  return parsedMarkup ? parsedMarkup[1] : void 0;\n}\n\nvar exportFromMarkup = exports.exportFromMarkup = function (markup, options) {\n  options.format = validateFormat(options.format) || DEFAULT_EXPORT_FORMAT;\n  options.fileName = options.fileName || \"file\";\n  options.exportingAction = options.onExporting;\n  options.exportedAction = options.onExported;\n  options.fileSavingAction = options.onFileSaving;\n  options.margin = (0, _type.isDefined)(options.margin) ? options.margin : MARGIN;\n  options.backgroundColor = (0, _type.isDefined)(options.backgroundColor) ? options.backgroundColor : getBackgroundColorFromMarkup(markup) || _themes2.default.getTheme().backgroundColor;\n\n  _exporter2.default.export(markup, options, getCreatorFunc(options.format));\n};\n\nvar getMarkup = exports.getMarkup = function (widgets) {\n  return combineMarkups(widgets).markup;\n};\n\nvar exportWidgets = exports.exportWidgets = function (widgets, options) {\n  options = options || {};\n  var markupInfo = exports.combineMarkups(widgets, {\n    gridLayout: options.gridLayout,\n    verticalAlignment: options.verticalAlignment,\n    horizontalAlignment: options.horizontalAlignment\n  });\n  options.width = markupInfo.width;\n  options.height = markupInfo.height;\n  exportFromMarkup(markupInfo.markup, options);\n};\n\nvar combineMarkups = exports.combineMarkups = function (widgets) {\n  var options = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {};\n\n  if (!Array.isArray(widgets)) {\n    widgets = [[widgets]];\n  } else {\n    if (!Array.isArray(widgets[0])) {\n      widgets = widgets.map(function (item) {\n        return [item];\n      });\n    }\n  }\n\n  var compactView = !options.gridLayout;\n  var exportItems = widgets.reduce(function (r, row, rowIndex) {\n    var rowInfo = row.reduce(function (r, item, colIndex) {\n      var size = item.getSize();\n\n      var backgroundColor = item.option(\"backgroundColor\") || _themes2.default.getTheme(item.option(\"theme\")).backgroundColor;\n\n      backgroundColor && r.backgroundColors.indexOf(backgroundColor) === -1 && r.backgroundColors.push(backgroundColor);\n      r.hOffset = r.width;\n      r.width += size.width;\n      r.height = Math.max(r.height, size.height);\n      r.itemWidth = Math.max(r.itemWidth, size.width);\n      r.items.push({\n        markup: item.svg(),\n        width: size.width,\n        height: size.height,\n        c: colIndex,\n        r: rowIndex,\n        hOffset: r.hOffset\n      });\n      return r;\n    }, {\n      items: [],\n      height: 0,\n      itemWidth: 0,\n      hOffset: 0,\n      width: 0,\n      backgroundColors: r.backgroundColors\n    });\n    r.rowOffsets.push(r.totalHeight);\n    r.rowHeights.push(rowInfo.height);\n    r.totalHeight += rowInfo.height;\n    r.items = r.items.concat(rowInfo.items);\n    r.itemWidth = Math.max(r.itemWidth, rowInfo.itemWidth);\n    r.maxItemLen = Math.max(r.maxItemLen, rowInfo.items.length);\n    r.totalWidth = compactView ? Math.max(r.totalWidth, rowInfo.width) : r.maxItemLen * r.itemWidth;\n    return r;\n  }, {\n    items: [],\n    rowOffsets: [],\n    rowHeights: [],\n    itemWidth: 0,\n    totalHeight: 0,\n    maxItemLen: 0,\n    totalWidth: 0,\n    backgroundColors: []\n  });\n  var backgroundColor = 'data-backgroundcolor=\"'.concat(1 === exportItems.backgroundColors.length ? exportItems.backgroundColors[0] : \"\", '\" ');\n\n  var getVOffset = function getVOffset(item) {\n    var align = options.verticalAlignment;\n    var dy = exportItems.rowHeights[item.r] - item.height;\n    return exportItems.rowOffsets[item.r] + (\"bottom\" === align ? dy : \"center\" === align ? dy / 2 : 0);\n  };\n\n  var getHOffset = function getHOffset(item) {\n    if (compactView) {\n      return item.hOffset;\n    }\n\n    var align = options.horizontalAlignment;\n    var colWidth = exportItems.itemWidth;\n    var dx = colWidth - item.width;\n    return item.c * colWidth + (\"right\" === align ? dx : \"center\" === align ? dx / 2 : 0);\n  };\n\n  var totalHeight = exportItems.totalHeight;\n  var totalWidth = exportItems.totalWidth;\n  return {\n    markup: \"<svg \" + backgroundColor + 'height=\"' + totalHeight + '\" width=\"' + totalWidth + '\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\">' + exportItems.items.map(function (item) {\n      return '<g transform=\"translate('.concat(getHOffset(item), \",\").concat(getVOffset(item), ')\">').concat(item.markup, \"</g>\");\n    }).join(\"\") + \"</svg>\",\n    width: totalWidth,\n    height: totalHeight\n  };\n};\n\nvar ExportMenu = exports.ExportMenu = function (params) {\n  var renderer = this._renderer = params.renderer;\n  this._incidentOccurred = params.incidentOccurred;\n  this._exportTo = params.exportTo;\n  this._print = params.print;\n  this._shadow = renderer.shadowFilter(\"-50%\", \"-50%\", \"200%\", \"200%\", SHADOW_OFFSET, 6, SHADOW_BLUR);\n\n  this._shadow.attr({\n    opacity: .8\n  });\n\n  this._group = renderer.g().attr({\n    \"class\": EXPORT_CSS_CLASS,\n    \"hidden-for-export\": true\n  }).linkOn(renderer.root, {\n    name: \"export-menu\",\n    after: \"peripheral\"\n  });\n  this._buttonGroup = renderer.g().attr({\n    \"class\": EXPORT_CSS_CLASS + \"-button\"\n  }).append(this._group);\n  this._listGroup = renderer.g().attr({\n    \"class\": EXPORT_CSS_CLASS + \"-list\"\n  }).append(this._group);\n  this._overlay = renderer.rect(-LIST_WIDTH + BUTTON_SIZE, BUTTON_SIZE + LIST_PADDING_TOP, LIST_WIDTH, 0);\n\n  this._overlay.attr({\n    \"stroke-width\": LIST_STROKE_WIDTH,\n    cursor: \"pointer\",\n    rx: 4,\n    ry: 4,\n    filter: this._shadow.id\n  });\n\n  this._overlay.data({\n    \"export-element-type\": \"list\"\n  });\n\n  this.validFormats = getValidFormats();\n\n  this._subscribeEvents();\n};\n\n(0, _extend.extend)(ExportMenu.prototype, {\n  getLayoutOptions: function getLayoutOptions() {\n    if (this._hiddenDueToLayout) {\n      return {\n        width: 0,\n        height: 0,\n        cutSide: \"vertical\",\n        cutLayoutSide: \"top\"\n      };\n    }\n\n    var bBox = this._buttonGroup.getBBox();\n\n    bBox.cutSide = \"vertical\";\n    bBox.cutLayoutSide = \"top\";\n    bBox.height += MARGIN;\n    bBox.position = {\n      vertical: \"top\",\n      horizontal: \"right\"\n    };\n    bBox.verticalAlignment = \"top\";\n    bBox.horizontalAlignment = \"right\";\n    return bBox;\n  },\n  probeDraw: function probeDraw() {\n    this._fillSpace();\n\n    this.show();\n  },\n  shift: function shift(_, y) {\n    this._group.attr({\n      translateY: this._group.attr(\"translateY\") + y\n    });\n  },\n  draw: function draw(width, height, canvas) {\n    this._group.move(width - BUTTON_SIZE - SHADOW_OFFSET - SHADOW_BLUR + canvas.left, Math.floor(height / 2 - BUTTON_SIZE / 2));\n\n    var layoutOptions = this.getLayoutOptions();\n\n    if (layoutOptions.width > width || layoutOptions.height > height) {\n      this.freeSpace();\n    }\n\n    return this;\n  },\n  show: function show() {\n    this._group.linkAppend();\n  },\n  hide: function hide() {\n    this._group.linkRemove();\n  },\n  setOptions: function setOptions(options) {\n    var _this2 = this;\n\n    this._options = options;\n\n    if (options.formats) {\n      options.formats = options.formats.reduce(function (r, format) {\n        format = validateFormat(format, _this2._incidentOccurred, _this2.validFormats);\n        format && r.push(format);\n        return r;\n      }, []);\n    } else {\n      options.formats = this.validFormats.supported.slice();\n    }\n\n    options.printingEnabled = void 0 === options.printingEnabled ? true : options.printingEnabled;\n\n    if (options.enabled && (options.formats.length || options.printingEnabled)) {\n      this.show();\n\n      this._updateButton();\n\n      this._updateList();\n\n      this._hideList();\n    } else {\n      this.hide();\n    }\n  },\n  dispose: function dispose() {\n    this._unsubscribeEvents();\n\n    this._group.linkRemove().linkOff();\n\n    this._group.dispose();\n\n    this._shadow.dispose();\n  },\n  layoutOptions: function layoutOptions() {\n    return this._options.enabled && {\n      horizontalAlignment: \"right\",\n      verticalAlignment: \"top\",\n      weak: true\n    };\n  },\n  measure: function measure() {\n    this._fillSpace();\n\n    var margin = this._options.button.margin;\n    return [BUTTON_SIZE + margin.left + margin.right, BUTTON_SIZE + margin.top + margin.bottom];\n  },\n  move: function move(rect) {\n    var margin = this._options.button.margin;\n\n    this._group.attr({\n      translateX: Math.round(rect[0]) + margin.left,\n      translateY: Math.round(rect[1]) + margin.top\n    });\n  },\n  _fillSpace: function _fillSpace() {\n    this._hiddenDueToLayout = false;\n    this.show();\n  },\n  freeSpace: function freeSpace() {\n    this._incidentOccurred(\"W2107\");\n\n    this._hiddenDueToLayout = true;\n    this.hide();\n  },\n  _hideList: function _hideList() {\n    this._listGroup.remove();\n\n    this._listShown = false;\n\n    this._setButtonState(\"default\");\n\n    this._menuItems.forEach(function (item) {\n      return item.resetState();\n    });\n  },\n  _showList: function _showList() {\n    this._listGroup.append(this._group);\n\n    this._listShown = true;\n\n    this._menuItems.forEach(function (item) {\n      return item.fixPosition();\n    });\n  },\n  _setButtonState: function _setButtonState(state) {\n    var style = this._options.button[state];\n\n    this._button.attr({\n      stroke: style.borderColor,\n      fill: style.backgroundColor\n    });\n\n    this._icon.attr({\n      fill: style.color\n    });\n  },\n  _subscribeEvents: function _subscribeEvents() {\n    var _this3 = this;\n\n    this._renderer.root.on(_pointer2.default.up + \".export\", function (e) {\n      var elementType = e.target[EXPORT_DATA_KEY];\n\n      if (!elementType) {\n        if (_this3._button) {\n          _this3._hideList();\n        }\n\n        return;\n      }\n\n      if (\"button\" === elementType) {\n        if (_this3._listShown) {\n          _this3._setButtonState(\"default\");\n\n          _this3._hideList();\n        } else {\n          _this3._setButtonState(\"focus\");\n\n          _this3._showList();\n        }\n      } else {\n        if (\"printing\" === elementType) {\n          _this3._print();\n\n          _this3._hideList();\n        } else {\n          if (\"exporting\" === elementType) {\n            _this3._exportTo(e.target[FORMAT_DATA_KEY]);\n\n            _this3._hideList();\n          }\n        }\n      }\n    });\n\n    this._listGroup.on(pointerActions, function (e) {\n      return e.stopPropagation();\n    });\n\n    this._buttonGroup.on(_pointer2.default.enter, function () {\n      return _this3._setButtonState(\"hover\");\n    });\n\n    this._buttonGroup.on(_pointer2.default.leave, function () {\n      return _this3._setButtonState(_this3._listShown ? \"focus\" : \"default\");\n    });\n\n    this._buttonGroup.on(_pointer2.default.down + \".export\", function () {\n      return _this3._setButtonState(\"active\");\n    });\n  },\n  _unsubscribeEvents: function _unsubscribeEvents() {\n    this._renderer.root.off(\".export\");\n\n    this._listGroup.off();\n\n    this._buttonGroup.off();\n  },\n  _updateButton: function _updateButton() {\n    var renderer = this._renderer;\n    var options = this._options;\n    var exportData = {\n      \"export-element-type\": \"button\"\n    };\n\n    if (!this._button) {\n      this._button = renderer.rect(0, 0, BUTTON_SIZE, BUTTON_SIZE).append(this._buttonGroup);\n\n      this._button.attr({\n        rx: 4,\n        ry: 4,\n        fill: options.button.default.backgroundColor,\n        stroke: options.button.default.borderColor,\n        \"stroke-width\": 1,\n        cursor: \"pointer\"\n      });\n\n      this._button.data(exportData);\n\n      this._icon = renderer.path(ICON_COORDS).append(this._buttonGroup);\n\n      this._icon.attr({\n        fill: options.button.default.color,\n        cursor: \"pointer\"\n      });\n\n      this._icon.data(exportData);\n\n      this._buttonGroup.setTitle(_message2.default.format(\"vizExport-titleMenuText\"));\n    }\n  },\n  _updateList: function _updateList() {\n    var options = this._options;\n    var buttonDefault = options.button.default;\n    var listGroup = this._listGroup;\n    var items = createMenuItems(this._renderer, options);\n\n    this._shadow.attr({\n      color: options.shadowColor\n    });\n\n    this._overlay.attr({\n      height: items.length * MENU_ITEM_HEIGHT + 2 * LIST_STROKE_WIDTH,\n      fill: buttonDefault.backgroundColor,\n      stroke: buttonDefault.borderColor\n    });\n\n    listGroup.clear();\n\n    this._overlay.append(listGroup);\n\n    items.forEach(function (item) {\n      return item.g.append(listGroup);\n    });\n    this._menuItems = items;\n  }\n});\n\nfunction getExportOptions(widget, exportOptions, fileName, format) {\n  if (format || exportOptions.format) {\n    format = validateFormat(format || exportOptions.format, widget._incidentOccurred);\n  }\n\n  return {\n    format: format || DEFAULT_EXPORT_FORMAT,\n    fileName: fileName || exportOptions.fileName || \"file\",\n    proxyUrl: exportOptions.proxyUrl,\n    backgroundColor: exportOptions.backgroundColor,\n    width: widget._canvas.width,\n    height: widget._canvas.height,\n    margin: exportOptions.margin,\n    svgToCanvas: exportOptions.svgToCanvas,\n    forceProxy: exportOptions.forceProxy,\n    exportingAction: widget._createActionByOption(\"onExporting\"),\n    exportedAction: widget._createActionByOption(\"onExported\"),\n    fileSavingAction: widget._createActionByOption(\"onFileSaving\")\n  };\n}\n\nvar plugin = exports.plugin = {\n  name: \"export\",\n  init: function init() {\n    var _this4 = this;\n\n    this._exportMenu = new exports.ExportMenu({\n      renderer: this._renderer,\n      incidentOccurred: this._incidentOccurred,\n      print: function print() {\n        return _this4.print();\n      },\n      exportTo: function exportTo(format) {\n        return _this4.exportTo(void 0, format);\n      }\n    });\n\n    this._layout.add(this._exportMenu);\n  },\n  dispose: function dispose() {\n    this._exportMenu.dispose();\n  },\n  members: {\n    _getExportMenuOptions: function _getExportMenuOptions() {\n      return (0, _extend.extend)({}, this._getOption(\"export\"), {\n        rtl: this._getOption(\"rtlEnabled\", true)\n      });\n    },\n    _disablePointerEvents: function _disablePointerEvents() {\n      var pointerEventsValue = this._renderer.root.attr(\"pointer-events\");\n\n      this._renderer.root.attr({\n        \"pointer-events\": \"none\"\n      });\n\n      return pointerEventsValue;\n    },\n    exportTo: function exportTo(fileName, format) {\n      var _this5 = this;\n\n      var menu = this._exportMenu;\n      var options = getExportOptions(this, this._getOption(\"export\") || {}, fileName, format);\n      menu && menu.hide();\n\n      var pointerEventsValue = this._disablePointerEvents();\n\n      var promise = _exporter2.default.export(this._renderer.root.element, options, getCreatorFunc(options.format)).fail(_console.logger.error).always(function () {\n        _this5._renderer.root.attr({\n          \"pointer-events\": pointerEventsValue\n        });\n      });\n\n      menu && menu.show();\n      return promise;\n    },\n    print: function print() {\n      var _this6 = this;\n\n      var menu = this._exportMenu;\n      var options = getExportOptions(this, this._getOption(\"export\") || {});\n      options.exportingAction = null;\n      options.exportedAction = null;\n      options.margin = 0;\n      options.format = \"PNG\";\n      options.forceProxy = true;\n\n      options.fileSavingAction = function (eventArgs) {\n        _print(\"data:image/png;base64,\".concat(eventArgs.data), {\n          __test: options.__test\n        });\n\n        eventArgs.cancel = true;\n      };\n\n      var pointerEventsValue = this._disablePointerEvents();\n\n      menu && menu.hide();\n\n      var promise = _exporter2.default.export(this._renderer.root.element, options, getCreatorFunc(options.format)).fail(_console.logger.error).always(function () {\n        _this6._renderer.root.attr({\n          \"pointer-events\": pointerEventsValue\n        });\n      });\n\n      menu && menu.show();\n      return promise;\n    }\n  },\n  customize: function customize(constructor) {\n    var proto = constructor.prototype;\n    constructor.addChange({\n      code: \"EXPORT\",\n      handler: function handler() {\n        this._exportMenu.setOptions(this._getExportMenuOptions());\n\n        this._change([\"LAYOUT\"]);\n      },\n      isThemeDependent: true,\n      isOptionChange: true,\n      option: \"export\"\n    });\n    proto._optionChangesMap.onExporting = \"EXPORT\";\n    proto._optionChangesMap.onExported = \"EXPORT\";\n    proto._optionChangesMap.onFileSaving = \"EXPORT\";\n  },\n  fontFields: [\"export.font\"]\n};","map":{"version":3,"sources":["C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/devextreme/viz/core/export.js"],"names":["Object","value","exports","_extend","require","_window","_utils","_exporter","_exporter2","_interopRequireDefault","_message","_message2","_type","_themes","_themes2","_hover","_hover2","_pointer","_pointer2","_console","obj","imageExporter","svgExporter","pdfExporter","pointerActions","BUTTON_SIZE","ICON_COORDS","LIST_PADDING_TOP","LIST_WIDTH","VERTICAL_TEXT_MARGIN","HORIZONTAL_TEXT_MARGIN","MENU_ITEM_HEIGHT","LIST_STROKE_WIDTH","MARGIN","SHADOW_OFFSET","SHADOW_BLUR","DEFAULT_EXPORT_FORMAT","ALLOWED_IMAGE_FORMATS","ALLOWED_EXTRA_FORMATS","EXPORT_CSS_CLASS","EXPORT_DATA_KEY","FORMAT_DATA_KEY","GET_COLOR_REGEX","imageFormats","unsupported","supported","validFormats","getValidFormats","format","String","incidentOccurred","document","iFrame","setPrint","_this","window","img","removeFrame","x","y","itemIndex","attr","rect","width","height","text","options","stroke","cursor","sharp","d","itemData","type","settings","getItemAttributes","fontStyle","menuItem","renderer","fill","backgroundColor","g","resetState","fixPosition","textBBox","items","createMenuItem","length","r","parsedMarkup","exportFromMarkup","validateFormat","getBackgroundColorFromMarkup","getCreatorFunc","getMarkup","combineMarkups","exportWidgets","markupInfo","gridLayout","verticalAlignment","horizontalAlignment","arguments","Array","widgets","compactView","exportItems","rowInfo","size","item","Math","markup","c","hOffset","itemWidth","backgroundColors","rowOffsets","rowHeights","totalHeight","maxItemLen","totalWidth","getVOffset","align","dy","getHOffset","colWidth","dx","ExportMenu","params","opacity","name","after","rx","ry","filter","id","getLayoutOptions","cutSide","cutLayoutSide","bBox","vertical","horizontal","probeDraw","shift","translateY","draw","canvas","layoutOptions","show","hide","setOptions","_this2","dispose","weak","measure","margin","move","translateX","top","_fillSpace","freeSpace","_hideList","_showList","_setButtonState","style","color","_subscribeEvents","_this3","elementType","e","_unsubscribeEvents","_updateButton","exportData","_updateList","buttonDefault","listGroup","createMenuItems","shadowColor","borderColor","exportOptions","widget","fileName","proxyUrl","svgToCanvas","forceProxy","exportingAction","exportedAction","fileSavingAction","plugin","init","_this4","print","exportTo","members","_getExportMenuOptions","rtl","_disablePointerEvents","pointerEventsValue","_this5","menu","getExportOptions","promise","_this6","_print","eventArgs","__test","customize","proto","constructor","code","handler","isThemeDependent","isOptionChange","option","fontFields"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (viz/core/export.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", {\r\n    value: true\r\n});\r\nexports.plugin = exports.ExportMenu = exports.combineMarkups = exports.exportWidgets = exports.getMarkup = exports.exportFromMarkup = void 0;\r\nvar _extend = require(\"../../core/utils/extend\");\r\nvar _window = require(\"../../core/utils/window\");\r\nvar _utils = require(\"./utils\");\r\nvar _exporter = require(\"../../exporter\");\r\nvar _exporter2 = _interopRequireDefault(_exporter);\r\nvar _message = require(\"../../localization/message\");\r\nvar _message2 = _interopRequireDefault(_message);\r\nvar _type = require(\"../../core/utils/type\");\r\nvar _themes = require(\"../themes\");\r\nvar _themes2 = _interopRequireDefault(_themes);\r\nvar _hover = require(\"../../events/hover\");\r\nvar _hover2 = _interopRequireDefault(_hover);\r\nvar _pointer = require(\"../../events/pointer\");\r\nvar _pointer2 = _interopRequireDefault(_pointer);\r\nvar _console = require(\"../../core/utils/console\");\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\nvar imageExporter = _exporter2.default.image;\r\nvar svgExporter = _exporter2.default.svg;\r\nvar pdfExporter = _exporter2.default.pdf;\r\nvar pointerActions = [_pointer2.default.down, _pointer2.default.move].join(\" \");\r\nvar BUTTON_SIZE = 35;\r\nvar ICON_COORDS = [\r\n    [9, 12, 26, 12, 26, 14, 9, 14],\r\n    [9, 17, 26, 17, 26, 19, 9, 19],\r\n    [9, 22, 26, 22, 26, 24, 9, 24]\r\n];\r\nvar LIST_PADDING_TOP = 4;\r\nvar LIST_WIDTH = 120;\r\nvar VERTICAL_TEXT_MARGIN = 8;\r\nvar HORIZONTAL_TEXT_MARGIN = 15;\r\nvar MENU_ITEM_HEIGHT = 30;\r\nvar LIST_STROKE_WIDTH = 1;\r\nvar MARGIN = 10;\r\nvar SHADOW_OFFSET = 2;\r\nvar SHADOW_BLUR = 3;\r\nvar DEFAULT_EXPORT_FORMAT = \"PNG\";\r\nvar ALLOWED_IMAGE_FORMATS = [DEFAULT_EXPORT_FORMAT, \"JPEG\", \"GIF\"];\r\nvar ALLOWED_EXTRA_FORMATS = [\"PDF\", \"SVG\"];\r\nvar EXPORT_CSS_CLASS = \"dx-export-menu\";\r\nvar EXPORT_DATA_KEY = \"export-element-type\";\r\nvar FORMAT_DATA_KEY = \"export-element-format\";\r\nvar GET_COLOR_REGEX = /data-backgroundcolor=\"([^\"]*)\"/;\r\n\r\nfunction getValidFormats() {\r\n    var imageFormats = imageExporter.testFormats(ALLOWED_IMAGE_FORMATS);\r\n    return {\r\n        unsupported: imageFormats.unsupported,\r\n        supported: imageFormats.supported.concat(ALLOWED_EXTRA_FORMATS)\r\n    }\r\n}\r\n\r\nfunction validateFormat(format, incidentOccurred, validFormats) {\r\n    validFormats = validFormats || getValidFormats();\r\n    format = String(format).toUpperCase();\r\n    if (validFormats.supported.indexOf(format) !== -1) {\r\n        return format\r\n    }\r\n    if (validFormats.unsupported.indexOf(format) !== -1) {\r\n        incidentOccurred && incidentOccurred(\"W2108\", [format])\r\n    }\r\n}\r\n\r\nfunction getCreatorFunc(format) {\r\n    if (\"SVG\" === format) {\r\n        return svgExporter.getData\r\n    } else {\r\n        if (\"PDF\" === format) {\r\n            return pdfExporter.getData\r\n        } else {\r\n            return imageExporter.getData\r\n        }\r\n    }\r\n}\r\n\r\nfunction _print(imageSrc, options) {\r\n    var document = (0, _window.getWindow)().document;\r\n    var iFrame = document.createElement(\"iframe\");\r\n    iFrame.onload = setPrint(imageSrc, options);\r\n    iFrame.style.visibility = \"hidden\";\r\n    iFrame.style.position = \"fixed\";\r\n    iFrame.style.right = \"0\";\r\n    iFrame.style.bottom = \"0\";\r\n    document.body.appendChild(iFrame)\r\n}\r\n\r\nfunction setPrint(imageSrc, options) {\r\n    return function() {\r\n        var _this = this;\r\n        var window = this.contentWindow;\r\n        var img = window.document.createElement(\"img\");\r\n        window.document.body.appendChild(img);\r\n        var removeFrame = function() {\r\n            _this.parentElement.removeChild(_this)\r\n        };\r\n        img.addEventListener(\"load\", function() {\r\n            window.focus();\r\n            window.print();\r\n            removeFrame()\r\n        });\r\n        img.addEventListener(\"error\", removeFrame);\r\n        img.src = imageSrc\r\n    }\r\n}\r\n\r\nfunction getItemAttributes(options, type, itemIndex) {\r\n    var x = BUTTON_SIZE - LIST_WIDTH;\r\n    var y = BUTTON_SIZE + LIST_PADDING_TOP + LIST_STROKE_WIDTH + itemIndex * MENU_ITEM_HEIGHT;\r\n    var attr = {\r\n        rect: {\r\n            width: LIST_WIDTH - 2 * LIST_STROKE_WIDTH,\r\n            height: MENU_ITEM_HEIGHT,\r\n            x: x + LIST_STROKE_WIDTH,\r\n            y: y\r\n        },\r\n        text: {\r\n            x: x + (options.rtl ? LIST_WIDTH - HORIZONTAL_TEXT_MARGIN : HORIZONTAL_TEXT_MARGIN),\r\n            y: y + MENU_ITEM_HEIGHT - VERTICAL_TEXT_MARGIN\r\n        }\r\n    };\r\n    if (\"printing\" === type) {\r\n        attr.separator = {\r\n            stroke: options.button.default.borderColor,\r\n            \"stroke-width\": LIST_STROKE_WIDTH,\r\n            cursor: \"pointer\",\r\n            sharp: \"v\",\r\n            d: \"M \" + x + \" \" + (y + MENU_ITEM_HEIGHT - LIST_STROKE_WIDTH) + \" L \" + (x + LIST_WIDTH) + \" \" + (y + MENU_ITEM_HEIGHT - LIST_STROKE_WIDTH)\r\n        }\r\n    }\r\n    return attr\r\n}\r\n\r\nfunction createMenuItem(renderer, options, settings) {\r\n    var itemData = {};\r\n    var type = settings.type;\r\n    var format = settings.format;\r\n    var attr = getItemAttributes(options, type, settings.itemIndex);\r\n    var fontStyle = (0, _utils.patchFontOptions)(options.font);\r\n    fontStyle[\"pointer-events\"] = \"none\";\r\n    var menuItem = renderer.g().attr({\r\n        \"class\": EXPORT_CSS_CLASS + \"-list-item\"\r\n    });\r\n    itemData[EXPORT_DATA_KEY] = type;\r\n    if (format) {\r\n        itemData[FORMAT_DATA_KEY] = format\r\n    }\r\n    var rect = renderer.rect();\r\n    rect.attr(attr.rect).css({\r\n        cursor: \"pointer\",\r\n        \"pointer-events\": \"all\"\r\n    }).data(itemData);\r\n    rect.on(_hover2.default.start + \".export\", function() {\r\n        return rect.attr({\r\n            fill: options.button.hover.backgroundColor\r\n        })\r\n    }).on(_hover2.default.end + \".export\", function() {\r\n        return rect.attr({\r\n            fill: null\r\n        })\r\n    });\r\n    rect.append(menuItem);\r\n    var text = renderer.text(settings.text).css(fontStyle).attr(attr.text).append(menuItem);\r\n    if (\"printing\" === type) {\r\n        renderer.path(null, \"line\").attr(attr.separator).append(menuItem)\r\n    }\r\n    return {\r\n        g: menuItem,\r\n        rect: rect,\r\n        resetState: function() {\r\n            return rect.attr({\r\n                fill: null\r\n            })\r\n        },\r\n        fixPosition: function() {\r\n            var textBBox = text.getBBox();\r\n            text.move(attr.text.x - textBBox.x - (options.rtl ? textBBox.width : 0))\r\n        }\r\n    }\r\n}\r\n\r\nfunction createMenuItems(renderer, options) {\r\n    var items = [];\r\n    if (options.printingEnabled) {\r\n        items.push(createMenuItem(renderer, options, {\r\n            type: \"printing\",\r\n            text: _message2.default.format(\"vizExport-printingButtonText\"),\r\n            itemIndex: items.length\r\n        }))\r\n    }\r\n    items = options.formats.reduce(function(r, format) {\r\n        r.push(createMenuItem(renderer, options, {\r\n            type: \"exporting\",\r\n            text: _message2.default.getFormatter(\"vizExport-exportButtonText\")(format),\r\n            format: format,\r\n            itemIndex: r.length\r\n        }));\r\n        return r\r\n    }, items);\r\n    return items\r\n}\r\n\r\nfunction getBackgroundColorFromMarkup(markup) {\r\n    var parsedMarkup = GET_COLOR_REGEX.exec(markup);\r\n    return parsedMarkup ? parsedMarkup[1] : void 0\r\n}\r\nvar exportFromMarkup = exports.exportFromMarkup = function(markup, options) {\r\n    options.format = validateFormat(options.format) || DEFAULT_EXPORT_FORMAT;\r\n    options.fileName = options.fileName || \"file\";\r\n    options.exportingAction = options.onExporting;\r\n    options.exportedAction = options.onExported;\r\n    options.fileSavingAction = options.onFileSaving;\r\n    options.margin = (0, _type.isDefined)(options.margin) ? options.margin : MARGIN;\r\n    options.backgroundColor = (0, _type.isDefined)(options.backgroundColor) ? options.backgroundColor : getBackgroundColorFromMarkup(markup) || _themes2.default.getTheme().backgroundColor;\r\n    _exporter2.default.export(markup, options, getCreatorFunc(options.format))\r\n};\r\nvar getMarkup = exports.getMarkup = function(widgets) {\r\n    return combineMarkups(widgets).markup\r\n};\r\nvar exportWidgets = exports.exportWidgets = function(widgets, options) {\r\n    options = options || {};\r\n    var markupInfo = exports.combineMarkups(widgets, {\r\n        gridLayout: options.gridLayout,\r\n        verticalAlignment: options.verticalAlignment,\r\n        horizontalAlignment: options.horizontalAlignment\r\n    });\r\n    options.width = markupInfo.width;\r\n    options.height = markupInfo.height;\r\n    exportFromMarkup(markupInfo.markup, options)\r\n};\r\nvar combineMarkups = exports.combineMarkups = function(widgets) {\r\n    var options = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {};\r\n    if (!Array.isArray(widgets)) {\r\n        widgets = [\r\n            [widgets]\r\n        ]\r\n    } else {\r\n        if (!Array.isArray(widgets[0])) {\r\n            widgets = widgets.map(function(item) {\r\n                return [item]\r\n            })\r\n        }\r\n    }\r\n    var compactView = !options.gridLayout;\r\n    var exportItems = widgets.reduce(function(r, row, rowIndex) {\r\n        var rowInfo = row.reduce(function(r, item, colIndex) {\r\n            var size = item.getSize();\r\n            var backgroundColor = item.option(\"backgroundColor\") || _themes2.default.getTheme(item.option(\"theme\")).backgroundColor;\r\n            backgroundColor && r.backgroundColors.indexOf(backgroundColor) === -1 && r.backgroundColors.push(backgroundColor);\r\n            r.hOffset = r.width;\r\n            r.width += size.width;\r\n            r.height = Math.max(r.height, size.height);\r\n            r.itemWidth = Math.max(r.itemWidth, size.width);\r\n            r.items.push({\r\n                markup: item.svg(),\r\n                width: size.width,\r\n                height: size.height,\r\n                c: colIndex,\r\n                r: rowIndex,\r\n                hOffset: r.hOffset\r\n            });\r\n            return r\r\n        }, {\r\n            items: [],\r\n            height: 0,\r\n            itemWidth: 0,\r\n            hOffset: 0,\r\n            width: 0,\r\n            backgroundColors: r.backgroundColors\r\n        });\r\n        r.rowOffsets.push(r.totalHeight);\r\n        r.rowHeights.push(rowInfo.height);\r\n        r.totalHeight += rowInfo.height;\r\n        r.items = r.items.concat(rowInfo.items);\r\n        r.itemWidth = Math.max(r.itemWidth, rowInfo.itemWidth);\r\n        r.maxItemLen = Math.max(r.maxItemLen, rowInfo.items.length);\r\n        r.totalWidth = compactView ? Math.max(r.totalWidth, rowInfo.width) : r.maxItemLen * r.itemWidth;\r\n        return r\r\n    }, {\r\n        items: [],\r\n        rowOffsets: [],\r\n        rowHeights: [],\r\n        itemWidth: 0,\r\n        totalHeight: 0,\r\n        maxItemLen: 0,\r\n        totalWidth: 0,\r\n        backgroundColors: []\r\n    });\r\n    var backgroundColor = 'data-backgroundcolor=\"'.concat(1 === exportItems.backgroundColors.length ? exportItems.backgroundColors[0] : \"\", '\" ');\r\n    var getVOffset = function(item) {\r\n        var align = options.verticalAlignment;\r\n        var dy = exportItems.rowHeights[item.r] - item.height;\r\n        return exportItems.rowOffsets[item.r] + (\"bottom\" === align ? dy : \"center\" === align ? dy / 2 : 0)\r\n    };\r\n    var getHOffset = function(item) {\r\n        if (compactView) {\r\n            return item.hOffset\r\n        }\r\n        var align = options.horizontalAlignment;\r\n        var colWidth = exportItems.itemWidth;\r\n        var dx = colWidth - item.width;\r\n        return item.c * colWidth + (\"right\" === align ? dx : \"center\" === align ? dx / 2 : 0)\r\n    };\r\n    var totalHeight = exportItems.totalHeight;\r\n    var totalWidth = exportItems.totalWidth;\r\n    return {\r\n        markup: \"<svg \" + backgroundColor + 'height=\"' + totalHeight + '\" width=\"' + totalWidth + '\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\">' + exportItems.items.map(function(item) {\r\n            return '<g transform=\"translate('.concat(getHOffset(item), \",\").concat(getVOffset(item), ')\">').concat(item.markup, \"</g>\")\r\n        }).join(\"\") + \"</svg>\",\r\n        width: totalWidth,\r\n        height: totalHeight\r\n    }\r\n};\r\nvar ExportMenu = exports.ExportMenu = function(params) {\r\n    var renderer = this._renderer = params.renderer;\r\n    this._incidentOccurred = params.incidentOccurred;\r\n    this._exportTo = params.exportTo;\r\n    this._print = params.print;\r\n    this._shadow = renderer.shadowFilter(\"-50%\", \"-50%\", \"200%\", \"200%\", SHADOW_OFFSET, 6, SHADOW_BLUR);\r\n    this._shadow.attr({\r\n        opacity: .8\r\n    });\r\n    this._group = renderer.g().attr({\r\n        \"class\": EXPORT_CSS_CLASS,\r\n        \"hidden-for-export\": true\r\n    }).linkOn(renderer.root, {\r\n        name: \"export-menu\",\r\n        after: \"peripheral\"\r\n    });\r\n    this._buttonGroup = renderer.g().attr({\r\n        \"class\": EXPORT_CSS_CLASS + \"-button\"\r\n    }).append(this._group);\r\n    this._listGroup = renderer.g().attr({\r\n        \"class\": EXPORT_CSS_CLASS + \"-list\"\r\n    }).append(this._group);\r\n    this._overlay = renderer.rect(-LIST_WIDTH + BUTTON_SIZE, BUTTON_SIZE + LIST_PADDING_TOP, LIST_WIDTH, 0);\r\n    this._overlay.attr({\r\n        \"stroke-width\": LIST_STROKE_WIDTH,\r\n        cursor: \"pointer\",\r\n        rx: 4,\r\n        ry: 4,\r\n        filter: this._shadow.id\r\n    });\r\n    this._overlay.data({\r\n        \"export-element-type\": \"list\"\r\n    });\r\n    this.validFormats = getValidFormats();\r\n    this._subscribeEvents()\r\n};\r\n(0, _extend.extend)(ExportMenu.prototype, {\r\n    getLayoutOptions: function() {\r\n        if (this._hiddenDueToLayout) {\r\n            return {\r\n                width: 0,\r\n                height: 0,\r\n                cutSide: \"vertical\",\r\n                cutLayoutSide: \"top\"\r\n            }\r\n        }\r\n        var bBox = this._buttonGroup.getBBox();\r\n        bBox.cutSide = \"vertical\";\r\n        bBox.cutLayoutSide = \"top\";\r\n        bBox.height += MARGIN;\r\n        bBox.position = {\r\n            vertical: \"top\",\r\n            horizontal: \"right\"\r\n        };\r\n        bBox.verticalAlignment = \"top\";\r\n        bBox.horizontalAlignment = \"right\";\r\n        return bBox\r\n    },\r\n    probeDraw: function() {\r\n        this._fillSpace();\r\n        this.show()\r\n    },\r\n    shift: function(_, y) {\r\n        this._group.attr({\r\n            translateY: this._group.attr(\"translateY\") + y\r\n        })\r\n    },\r\n    draw: function(width, height, canvas) {\r\n        this._group.move(width - BUTTON_SIZE - SHADOW_OFFSET - SHADOW_BLUR + canvas.left, Math.floor(height / 2 - BUTTON_SIZE / 2));\r\n        var layoutOptions = this.getLayoutOptions();\r\n        if (layoutOptions.width > width || layoutOptions.height > height) {\r\n            this.freeSpace()\r\n        }\r\n        return this\r\n    },\r\n    show: function() {\r\n        this._group.linkAppend()\r\n    },\r\n    hide: function() {\r\n        this._group.linkRemove()\r\n    },\r\n    setOptions: function(options) {\r\n        var _this2 = this;\r\n        this._options = options;\r\n        if (options.formats) {\r\n            options.formats = options.formats.reduce(function(r, format) {\r\n                format = validateFormat(format, _this2._incidentOccurred, _this2.validFormats);\r\n                format && r.push(format);\r\n                return r\r\n            }, [])\r\n        } else {\r\n            options.formats = this.validFormats.supported.slice()\r\n        }\r\n        options.printingEnabled = void 0 === options.printingEnabled ? true : options.printingEnabled;\r\n        if (options.enabled && (options.formats.length || options.printingEnabled)) {\r\n            this.show();\r\n            this._updateButton();\r\n            this._updateList();\r\n            this._hideList()\r\n        } else {\r\n            this.hide()\r\n        }\r\n    },\r\n    dispose: function() {\r\n        this._unsubscribeEvents();\r\n        this._group.linkRemove().linkOff();\r\n        this._group.dispose();\r\n        this._shadow.dispose()\r\n    },\r\n    layoutOptions: function() {\r\n        return this._options.enabled && {\r\n            horizontalAlignment: \"right\",\r\n            verticalAlignment: \"top\",\r\n            weak: true\r\n        }\r\n    },\r\n    measure: function() {\r\n        this._fillSpace();\r\n        var margin = this._options.button.margin;\r\n        return [BUTTON_SIZE + margin.left + margin.right, BUTTON_SIZE + margin.top + margin.bottom]\r\n    },\r\n    move: function(rect) {\r\n        var margin = this._options.button.margin;\r\n        this._group.attr({\r\n            translateX: Math.round(rect[0]) + margin.left,\r\n            translateY: Math.round(rect[1]) + margin.top\r\n        })\r\n    },\r\n    _fillSpace: function() {\r\n        this._hiddenDueToLayout = false;\r\n        this.show()\r\n    },\r\n    freeSpace: function() {\r\n        this._incidentOccurred(\"W2107\");\r\n        this._hiddenDueToLayout = true;\r\n        this.hide()\r\n    },\r\n    _hideList: function() {\r\n        this._listGroup.remove();\r\n        this._listShown = false;\r\n        this._setButtonState(\"default\");\r\n        this._menuItems.forEach(function(item) {\r\n            return item.resetState()\r\n        })\r\n    },\r\n    _showList: function() {\r\n        this._listGroup.append(this._group);\r\n        this._listShown = true;\r\n        this._menuItems.forEach(function(item) {\r\n            return item.fixPosition()\r\n        })\r\n    },\r\n    _setButtonState: function(state) {\r\n        var style = this._options.button[state];\r\n        this._button.attr({\r\n            stroke: style.borderColor,\r\n            fill: style.backgroundColor\r\n        });\r\n        this._icon.attr({\r\n            fill: style.color\r\n        })\r\n    },\r\n    _subscribeEvents: function() {\r\n        var _this3 = this;\r\n        this._renderer.root.on(_pointer2.default.up + \".export\", function(e) {\r\n            var elementType = e.target[EXPORT_DATA_KEY];\r\n            if (!elementType) {\r\n                if (_this3._button) {\r\n                    _this3._hideList()\r\n                }\r\n                return\r\n            }\r\n            if (\"button\" === elementType) {\r\n                if (_this3._listShown) {\r\n                    _this3._setButtonState(\"default\");\r\n                    _this3._hideList()\r\n                } else {\r\n                    _this3._setButtonState(\"focus\");\r\n                    _this3._showList()\r\n                }\r\n            } else {\r\n                if (\"printing\" === elementType) {\r\n                    _this3._print();\r\n                    _this3._hideList()\r\n                } else {\r\n                    if (\"exporting\" === elementType) {\r\n                        _this3._exportTo(e.target[FORMAT_DATA_KEY]);\r\n                        _this3._hideList()\r\n                    }\r\n                }\r\n            }\r\n        });\r\n        this._listGroup.on(pointerActions, function(e) {\r\n            return e.stopPropagation()\r\n        });\r\n        this._buttonGroup.on(_pointer2.default.enter, function() {\r\n            return _this3._setButtonState(\"hover\")\r\n        });\r\n        this._buttonGroup.on(_pointer2.default.leave, function() {\r\n            return _this3._setButtonState(_this3._listShown ? \"focus\" : \"default\")\r\n        });\r\n        this._buttonGroup.on(_pointer2.default.down + \".export\", function() {\r\n            return _this3._setButtonState(\"active\")\r\n        })\r\n    },\r\n    _unsubscribeEvents: function() {\r\n        this._renderer.root.off(\".export\");\r\n        this._listGroup.off();\r\n        this._buttonGroup.off()\r\n    },\r\n    _updateButton: function() {\r\n        var renderer = this._renderer;\r\n        var options = this._options;\r\n        var exportData = {\r\n            \"export-element-type\": \"button\"\r\n        };\r\n        if (!this._button) {\r\n            this._button = renderer.rect(0, 0, BUTTON_SIZE, BUTTON_SIZE).append(this._buttonGroup);\r\n            this._button.attr({\r\n                rx: 4,\r\n                ry: 4,\r\n                fill: options.button.default.backgroundColor,\r\n                stroke: options.button.default.borderColor,\r\n                \"stroke-width\": 1,\r\n                cursor: \"pointer\"\r\n            });\r\n            this._button.data(exportData);\r\n            this._icon = renderer.path(ICON_COORDS).append(this._buttonGroup);\r\n            this._icon.attr({\r\n                fill: options.button.default.color,\r\n                cursor: \"pointer\"\r\n            });\r\n            this._icon.data(exportData);\r\n            this._buttonGroup.setTitle(_message2.default.format(\"vizExport-titleMenuText\"))\r\n        }\r\n    },\r\n    _updateList: function() {\r\n        var options = this._options;\r\n        var buttonDefault = options.button.default;\r\n        var listGroup = this._listGroup;\r\n        var items = createMenuItems(this._renderer, options);\r\n        this._shadow.attr({\r\n            color: options.shadowColor\r\n        });\r\n        this._overlay.attr({\r\n            height: items.length * MENU_ITEM_HEIGHT + 2 * LIST_STROKE_WIDTH,\r\n            fill: buttonDefault.backgroundColor,\r\n            stroke: buttonDefault.borderColor\r\n        });\r\n        listGroup.clear();\r\n        this._overlay.append(listGroup);\r\n        items.forEach(function(item) {\r\n            return item.g.append(listGroup)\r\n        });\r\n        this._menuItems = items\r\n    }\r\n});\r\n\r\nfunction getExportOptions(widget, exportOptions, fileName, format) {\r\n    if (format || exportOptions.format) {\r\n        format = validateFormat(format || exportOptions.format, widget._incidentOccurred)\r\n    }\r\n    return {\r\n        format: format || DEFAULT_EXPORT_FORMAT,\r\n        fileName: fileName || exportOptions.fileName || \"file\",\r\n        proxyUrl: exportOptions.proxyUrl,\r\n        backgroundColor: exportOptions.backgroundColor,\r\n        width: widget._canvas.width,\r\n        height: widget._canvas.height,\r\n        margin: exportOptions.margin,\r\n        svgToCanvas: exportOptions.svgToCanvas,\r\n        forceProxy: exportOptions.forceProxy,\r\n        exportingAction: widget._createActionByOption(\"onExporting\"),\r\n        exportedAction: widget._createActionByOption(\"onExported\"),\r\n        fileSavingAction: widget._createActionByOption(\"onFileSaving\")\r\n    }\r\n}\r\nvar plugin = exports.plugin = {\r\n    name: \"export\",\r\n    init: function() {\r\n        var _this4 = this;\r\n        this._exportMenu = new exports.ExportMenu({\r\n            renderer: this._renderer,\r\n            incidentOccurred: this._incidentOccurred,\r\n            print: function() {\r\n                return _this4.print()\r\n            },\r\n            exportTo: function(format) {\r\n                return _this4.exportTo(void 0, format)\r\n            }\r\n        });\r\n        this._layout.add(this._exportMenu)\r\n    },\r\n    dispose: function() {\r\n        this._exportMenu.dispose()\r\n    },\r\n    members: {\r\n        _getExportMenuOptions: function() {\r\n            return (0, _extend.extend)({}, this._getOption(\"export\"), {\r\n                rtl: this._getOption(\"rtlEnabled\", true)\r\n            })\r\n        },\r\n        _disablePointerEvents: function() {\r\n            var pointerEventsValue = this._renderer.root.attr(\"pointer-events\");\r\n            this._renderer.root.attr({\r\n                \"pointer-events\": \"none\"\r\n            });\r\n            return pointerEventsValue\r\n        },\r\n        exportTo: function(fileName, format) {\r\n            var _this5 = this;\r\n            var menu = this._exportMenu;\r\n            var options = getExportOptions(this, this._getOption(\"export\") || {}, fileName, format);\r\n            menu && menu.hide();\r\n            var pointerEventsValue = this._disablePointerEvents();\r\n            var promise = _exporter2.default.export(this._renderer.root.element, options, getCreatorFunc(options.format)).fail(_console.logger.error).always(function() {\r\n                _this5._renderer.root.attr({\r\n                    \"pointer-events\": pointerEventsValue\r\n                })\r\n            });\r\n            menu && menu.show();\r\n            return promise\r\n        },\r\n        print: function() {\r\n            var _this6 = this;\r\n            var menu = this._exportMenu;\r\n            var options = getExportOptions(this, this._getOption(\"export\") || {});\r\n            options.exportingAction = null;\r\n            options.exportedAction = null;\r\n            options.margin = 0;\r\n            options.format = \"PNG\";\r\n            options.forceProxy = true;\r\n            options.fileSavingAction = function(eventArgs) {\r\n                _print(\"data:image/png;base64,\".concat(eventArgs.data), {\r\n                    __test: options.__test\r\n                });\r\n                eventArgs.cancel = true\r\n            };\r\n            var pointerEventsValue = this._disablePointerEvents();\r\n            menu && menu.hide();\r\n            var promise = _exporter2.default.export(this._renderer.root.element, options, getCreatorFunc(options.format)).fail(_console.logger.error).always(function() {\r\n                _this6._renderer.root.attr({\r\n                    \"pointer-events\": pointerEventsValue\r\n                })\r\n            });\r\n            menu && menu.show();\r\n            return promise\r\n        }\r\n    },\r\n    customize: function(constructor) {\r\n        var proto = constructor.prototype;\r\n        constructor.addChange({\r\n            code: \"EXPORT\",\r\n            handler: function() {\r\n                this._exportMenu.setOptions(this._getExportMenuOptions());\r\n                this._change([\"LAYOUT\"])\r\n            },\r\n            isThemeDependent: true,\r\n            isOptionChange: true,\r\n            option: \"export\"\r\n        });\r\n        proto._optionChangesMap.onExporting = \"EXPORT\";\r\n        proto._optionChangesMap.onExported = \"EXPORT\";\r\n        proto._optionChangesMap.onFileSaving = \"EXPORT\"\r\n    },\r\n    fontFields: [\"export.font\"]\r\n};\r\n"]},"metadata":{},"sourceType":"module"}