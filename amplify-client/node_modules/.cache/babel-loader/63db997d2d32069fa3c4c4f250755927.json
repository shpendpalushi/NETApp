{"ast":null,"code":"/**\r\n * DevExtreme (ui/shared/ui.editor_factory_mixin.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar $ = require(\"../../core/renderer\");\n\nvar noop = require(\"../../core/utils/common\").noop;\n\nvar eventsEngine = require(\"../../events/core/events_engine\");\n\nvar typeUtils = require(\"../../core/utils/type\");\n\nvar isWrapped = require(\"../../core/utils/variable_wrapper\").isWrapped;\n\nvar compileGetter = require(\"../../core/utils/data\").compileGetter;\n\nvar browser = require(\"../../core/utils/browser\");\n\nvar extend = require(\"../../core/utils/extend\").extend;\n\nvar devices = require(\"../../core/devices\");\n\nvar getPublicElement = require(\"../../core/utils/dom\").getPublicElement;\n\nvar normalizeDataSourceOptions = require(\"../../data/data_source/data_source\").normalizeDataSourceOptions;\n\nvar normalizeKeyName = require(\"../../events/utils\").normalizeKeyName;\n\nrequire(\"../text_box\");\n\nrequire(\"../number_box\");\n\nrequire(\"../check_box\");\n\nrequire(\"../select_box\");\n\nrequire(\"../date_box\");\n\nvar CHECKBOX_SIZE_CLASS = \"checkbox-size\";\nvar CELL_FOCUS_DISABLED_CLASS = \"dx-cell-focus-disabled\";\nvar EDITOR_INLINE_BLOCK = \"dx-editor-inline-block\";\n\nvar EditorFactoryMixin = function () {\n  var getResultConfig = function getResultConfig(config, options) {\n    return extend(config, {\n      readOnly: options.readOnly,\n      placeholder: options.placeholder,\n      inputAttr: {\n        id: options.id\n      },\n      tabIndex: options.tabIndex\n    }, options.editorOptions);\n  };\n\n  var checkEnterBug = function checkEnterBug() {\n    return browser.msie || browser.mozilla || devices.real().ios;\n  };\n\n  var getTextEditorConfig = function getTextEditorConfig(options) {\n    var data = {};\n    var isEnterBug = checkEnterBug();\n    var sharedData = options.sharedData || data;\n    return getResultConfig({\n      placeholder: options.placeholder,\n      width: options.width,\n      value: options.value,\n      onValueChanged: function onValueChanged(e) {\n        var needDelayedUpdate = \"filterRow\" === options.parentType || \"searchPanel\" === options.parentType;\n        var isInputOrKeyUpEvent = e.event && (\"input\" === e.event.type || \"keyup\" === e.event.type);\n\n        var updateValue = function updateValue(e, notFireEvent) {\n          options && options.setValue(e.value, notFireEvent);\n        };\n\n        clearTimeout(data.valueChangeTimeout);\n\n        if (isInputOrKeyUpEvent && needDelayedUpdate) {\n          sharedData.valueChangeTimeout = data.valueChangeTimeout = setTimeout(function () {\n            updateValue(e, data.valueChangeTimeout !== sharedData.valueChangeTimeout);\n          }, typeUtils.isDefined(options.updateValueTimeout) ? options.updateValueTimeout : 0);\n        } else {\n          updateValue(e);\n        }\n      },\n      onKeyDown: function onKeyDown(e) {\n        if (isEnterBug && \"enter\" === normalizeKeyName(e.event)) {\n          eventsEngine.trigger($(e.component._input()), \"change\");\n        }\n      },\n      valueChangeEvent: \"change\" + (\"filterRow\" === options.parentType ? \" keyup input\" : \"\")\n    }, options);\n  };\n\n  var prepareDateBox = function prepareDateBox(options) {\n    options.editorName = \"dxDateBox\";\n    options.editorOptions = getResultConfig({\n      value: options.value,\n      onValueChanged: function onValueChanged(args) {\n        options.setValue(args.value);\n      },\n      onKeyDown: function onKeyDown(e) {\n        if (checkEnterBug() && \"enter\" === normalizeKeyName(e.event)) {\n          e.component.blur();\n          e.component.focus();\n        }\n      },\n      displayFormat: options.format,\n      type: options.dataType,\n      formatWidthCalculator: null,\n      dateSerializationFormat: null,\n      width: \"filterBuilder\" === options.parentType ? void 0 : \"auto\"\n    }, options);\n  };\n\n  var prepareTextBox = function prepareTextBox(options) {\n    var config = getTextEditorConfig(options);\n    var isSearching = \"searchPanel\" === options.parentType;\n\n    var toString = function toString(value) {\n      return typeUtils.isDefined(value) ? value.toString() : \"\";\n    };\n\n    if (options.editorType && \"dxTextBox\" !== options.editorType) {\n      config.value = options.value;\n    } else {\n      config.value = toString(options.value);\n    }\n\n    config.valueChangeEvent += isSearching ? \" keyup input search\" : \"\";\n    config.mode = config.mode || (isSearching ? \"search\" : \"text\");\n    options.editorName = \"dxTextBox\";\n    options.editorOptions = config;\n  };\n\n  var prepareNumberBox = function prepareNumberBox(options) {\n    var config = getTextEditorConfig(options);\n    config.value = typeUtils.isDefined(options.value) ? options.value : null;\n    options.editorName = \"dxNumberBox\";\n    options.editorOptions = config;\n  };\n\n  var prepareBooleanEditor = function prepareBooleanEditor(options) {\n    if (\"filterRow\" === options.parentType || \"filterBuilder\" === options.parentType) {\n      prepareSelectBox(extend(options, {\n        lookup: {\n          displayExpr: function displayExpr(data) {\n            if (true === data) {\n              return options.trueText || \"true\";\n            } else {\n              if (false === data) {\n                return options.falseText || \"false\";\n              }\n            }\n          },\n          dataSource: [true, false]\n        }\n      }));\n    } else {\n      prepareCheckBox(options);\n    }\n  };\n\n  var prepareSelectBox = function prepareSelectBox(options) {\n    var lookup = options.lookup;\n    var displayGetter;\n    var dataSource;\n    var postProcess;\n    var isFilterRow = \"filterRow\" === options.parentType;\n\n    if (lookup) {\n      displayGetter = compileGetter(lookup.displayExpr);\n      dataSource = lookup.dataSource;\n\n      if (typeUtils.isFunction(dataSource) && !isWrapped(dataSource)) {\n        dataSource = dataSource(options.row || {});\n      }\n\n      if (typeUtils.isObject(dataSource) || Array.isArray(dataSource)) {\n        dataSource = normalizeDataSourceOptions(dataSource);\n\n        if (isFilterRow) {\n          postProcess = dataSource.postProcess;\n\n          dataSource.postProcess = function (items) {\n            if (0 === this.pageIndex()) {\n              items = items.slice(0);\n              items.unshift(null);\n            }\n\n            if (postProcess) {\n              return postProcess.call(this, items);\n            }\n\n            return items;\n          };\n        }\n      }\n\n      var allowClearing = Boolean(lookup.allowClearing && !isFilterRow);\n      options.editorName = \"dxSelectBox\";\n      options.editorOptions = getResultConfig({\n        searchEnabled: true,\n        value: options.value,\n        valueExpr: options.lookup.valueExpr,\n        searchExpr: options.lookup.searchExpr || options.lookup.displayExpr,\n        allowClearing: allowClearing,\n        showClearButton: allowClearing,\n        displayExpr: function displayExpr(data) {\n          if (null === data) {\n            return options.showAllText;\n          }\n\n          return displayGetter(data);\n        },\n        dataSource: dataSource,\n        onValueChanged: function onValueChanged(e) {\n          var params = [e.value];\n          !isFilterRow && params.push(e.component.option(\"text\"));\n          options.setValue.apply(this, params);\n        }\n      }, options);\n    }\n  };\n\n  var prepareCheckBox = function prepareCheckBox(options) {\n    options.editorName = \"dxCheckBox\";\n    options.editorOptions = getResultConfig({\n      value: typeUtils.isDefined(options.value) ? options.value : void 0,\n      hoverStateEnabled: !options.readOnly,\n      focusStateEnabled: !options.readOnly,\n      activeStateEnabled: false,\n      onValueChanged: function onValueChanged(e) {\n        options.setValue && options.setValue(e.value, e);\n      }\n    }, options);\n  };\n\n  var createEditorCore = function createEditorCore(that, options) {\n    var $editorElement = $(options.editorElement);\n\n    if (options.editorName && options.editorOptions && $editorElement[options.editorName]) {\n      if (\"dxCheckBox\" === options.editorName) {\n        if (!options.isOnForm) {\n          $editorElement.addClass(that.addWidgetPrefix(CHECKBOX_SIZE_CLASS));\n          $editorElement.parent().addClass(EDITOR_INLINE_BLOCK);\n        }\n\n        if (options.command || options.editorOptions.readOnly) {\n          $editorElement.parent().addClass(CELL_FOCUS_DISABLED_CLASS);\n        }\n      }\n\n      that._createComponent($editorElement, options.editorName, options.editorOptions);\n\n      if (\"dxTextBox\" === options.editorName) {\n        $editorElement.dxTextBox(\"instance\").registerKeyHandler(\"enter\", noop);\n      }\n\n      if (\"dxDateBox\" === options.editorName) {\n        $editorElement.dxDateBox(\"instance\").registerKeyHandler(\"enter\", function () {\n          return true;\n        });\n      }\n\n      if (\"dxTextArea\" === options.editorName) {\n        $editorElement.dxTextArea(\"instance\").registerKeyHandler(\"enter\", function (event) {\n          if (\"enter\" === normalizeKeyName(event) && !event.ctrlKey && !event.shiftKey) {\n            event.stopPropagation();\n          }\n        });\n      }\n    }\n  };\n\n  return {\n    createEditor: function createEditor($container, options) {\n      var editorName;\n      options.cancel = false;\n      options.editorElement = getPublicElement($container);\n\n      if (!typeUtils.isDefined(options.tabIndex)) {\n        options.tabIndex = this.option(\"tabIndex\");\n      }\n\n      if (options.lookup) {\n        prepareSelectBox(options);\n      } else {\n        switch (options.dataType) {\n          case \"date\":\n          case \"datetime\":\n            prepareDateBox(options);\n            break;\n\n          case \"boolean\":\n            prepareBooleanEditor(options);\n            break;\n\n          case \"number\":\n            prepareNumberBox(options);\n            break;\n\n          default:\n            prepareTextBox(options);\n        }\n      }\n\n      editorName = options.editorName;\n      this.executeAction(\"onEditorPreparing\", options);\n\n      if (options.cancel) {\n        return;\n      } else {\n        if (\"dataRow\" === options.parentType && options.editorType && editorName === options.editorName) {\n          options.editorName = options.editorType;\n        }\n      }\n\n      createEditorCore(this, options);\n      this.executeAction(\"onEditorPrepared\", options);\n    }\n  };\n}();\n\nmodule.exports = EditorFactoryMixin;","map":{"version":3,"sources":["C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/devextreme/ui/shared/ui.editor_factory_mixin.js"],"names":["$","require","noop","eventsEngine","typeUtils","isWrapped","compileGetter","browser","extend","devices","getPublicElement","normalizeDataSourceOptions","normalizeKeyName","CHECKBOX_SIZE_CLASS","CELL_FOCUS_DISABLED_CLASS","EDITOR_INLINE_BLOCK","EditorFactoryMixin","getResultConfig","readOnly","options","placeholder","inputAttr","id","tabIndex","checkEnterBug","getTextEditorConfig","data","isEnterBug","sharedData","width","value","onValueChanged","needDelayedUpdate","isInputOrKeyUpEvent","e","updateValue","clearTimeout","setTimeout","onKeyDown","valueChangeEvent","prepareDateBox","args","displayFormat","type","formatWidthCalculator","dateSerializationFormat","prepareTextBox","config","isSearching","toString","prepareNumberBox","prepareBooleanEditor","prepareSelectBox","lookup","displayExpr","dataSource","prepareCheckBox","isFilterRow","displayGetter","Array","postProcess","items","allowClearing","Boolean","searchEnabled","valueExpr","searchExpr","showClearButton","params","hoverStateEnabled","focusStateEnabled","activeStateEnabled","createEditorCore","$editorElement","that","event","createEditor","editorName","module"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/shared/ui.editor_factory_mixin.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar $ = require(\"../../core/renderer\");\r\nvar noop = require(\"../../core/utils/common\").noop;\r\nvar eventsEngine = require(\"../../events/core/events_engine\");\r\nvar typeUtils = require(\"../../core/utils/type\");\r\nvar isWrapped = require(\"../../core/utils/variable_wrapper\").isWrapped;\r\nvar compileGetter = require(\"../../core/utils/data\").compileGetter;\r\nvar browser = require(\"../../core/utils/browser\");\r\nvar extend = require(\"../../core/utils/extend\").extend;\r\nvar devices = require(\"../../core/devices\");\r\nvar getPublicElement = require(\"../../core/utils/dom\").getPublicElement;\r\nvar normalizeDataSourceOptions = require(\"../../data/data_source/data_source\").normalizeDataSourceOptions;\r\nvar normalizeKeyName = require(\"../../events/utils\").normalizeKeyName;\r\nrequire(\"../text_box\");\r\nrequire(\"../number_box\");\r\nrequire(\"../check_box\");\r\nrequire(\"../select_box\");\r\nrequire(\"../date_box\");\r\nvar CHECKBOX_SIZE_CLASS = \"checkbox-size\";\r\nvar CELL_FOCUS_DISABLED_CLASS = \"dx-cell-focus-disabled\";\r\nvar EDITOR_INLINE_BLOCK = \"dx-editor-inline-block\";\r\nvar EditorFactoryMixin = function() {\r\n    var getResultConfig = function(config, options) {\r\n        return extend(config, {\r\n            readOnly: options.readOnly,\r\n            placeholder: options.placeholder,\r\n            inputAttr: {\r\n                id: options.id\r\n            },\r\n            tabIndex: options.tabIndex\r\n        }, options.editorOptions)\r\n    };\r\n    var checkEnterBug = function() {\r\n        return browser.msie || browser.mozilla || devices.real().ios\r\n    };\r\n    var getTextEditorConfig = function(options) {\r\n        var data = {};\r\n        var isEnterBug = checkEnterBug();\r\n        var sharedData = options.sharedData || data;\r\n        return getResultConfig({\r\n            placeholder: options.placeholder,\r\n            width: options.width,\r\n            value: options.value,\r\n            onValueChanged: function(e) {\r\n                var needDelayedUpdate = \"filterRow\" === options.parentType || \"searchPanel\" === options.parentType;\r\n                var isInputOrKeyUpEvent = e.event && (\"input\" === e.event.type || \"keyup\" === e.event.type);\r\n                var updateValue = function(e, notFireEvent) {\r\n                    options && options.setValue(e.value, notFireEvent)\r\n                };\r\n                clearTimeout(data.valueChangeTimeout);\r\n                if (isInputOrKeyUpEvent && needDelayedUpdate) {\r\n                    sharedData.valueChangeTimeout = data.valueChangeTimeout = setTimeout(function() {\r\n                        updateValue(e, data.valueChangeTimeout !== sharedData.valueChangeTimeout)\r\n                    }, typeUtils.isDefined(options.updateValueTimeout) ? options.updateValueTimeout : 0)\r\n                } else {\r\n                    updateValue(e)\r\n                }\r\n            },\r\n            onKeyDown: function(e) {\r\n                if (isEnterBug && \"enter\" === normalizeKeyName(e.event)) {\r\n                    eventsEngine.trigger($(e.component._input()), \"change\")\r\n                }\r\n            },\r\n            valueChangeEvent: \"change\" + (\"filterRow\" === options.parentType ? \" keyup input\" : \"\")\r\n        }, options)\r\n    };\r\n    var prepareDateBox = function(options) {\r\n        options.editorName = \"dxDateBox\";\r\n        options.editorOptions = getResultConfig({\r\n            value: options.value,\r\n            onValueChanged: function(args) {\r\n                options.setValue(args.value)\r\n            },\r\n            onKeyDown: function(e) {\r\n                if (checkEnterBug() && \"enter\" === normalizeKeyName(e.event)) {\r\n                    e.component.blur();\r\n                    e.component.focus()\r\n                }\r\n            },\r\n            displayFormat: options.format,\r\n            type: options.dataType,\r\n            formatWidthCalculator: null,\r\n            dateSerializationFormat: null,\r\n            width: \"filterBuilder\" === options.parentType ? void 0 : \"auto\"\r\n        }, options)\r\n    };\r\n    var prepareTextBox = function(options) {\r\n        var config = getTextEditorConfig(options);\r\n        var isSearching = \"searchPanel\" === options.parentType;\r\n        var toString = function(value) {\r\n            return typeUtils.isDefined(value) ? value.toString() : \"\"\r\n        };\r\n        if (options.editorType && \"dxTextBox\" !== options.editorType) {\r\n            config.value = options.value\r\n        } else {\r\n            config.value = toString(options.value)\r\n        }\r\n        config.valueChangeEvent += isSearching ? \" keyup input search\" : \"\";\r\n        config.mode = config.mode || (isSearching ? \"search\" : \"text\");\r\n        options.editorName = \"dxTextBox\";\r\n        options.editorOptions = config\r\n    };\r\n    var prepareNumberBox = function(options) {\r\n        var config = getTextEditorConfig(options);\r\n        config.value = typeUtils.isDefined(options.value) ? options.value : null;\r\n        options.editorName = \"dxNumberBox\";\r\n        options.editorOptions = config\r\n    };\r\n    var prepareBooleanEditor = function(options) {\r\n        if (\"filterRow\" === options.parentType || \"filterBuilder\" === options.parentType) {\r\n            prepareSelectBox(extend(options, {\r\n                lookup: {\r\n                    displayExpr: function(data) {\r\n                        if (true === data) {\r\n                            return options.trueText || \"true\"\r\n                        } else {\r\n                            if (false === data) {\r\n                                return options.falseText || \"false\"\r\n                            }\r\n                        }\r\n                    },\r\n                    dataSource: [true, false]\r\n                }\r\n            }))\r\n        } else {\r\n            prepareCheckBox(options)\r\n        }\r\n    };\r\n    var prepareSelectBox = function(options) {\r\n        var lookup = options.lookup;\r\n        var displayGetter;\r\n        var dataSource;\r\n        var postProcess;\r\n        var isFilterRow = \"filterRow\" === options.parentType;\r\n        if (lookup) {\r\n            displayGetter = compileGetter(lookup.displayExpr);\r\n            dataSource = lookup.dataSource;\r\n            if (typeUtils.isFunction(dataSource) && !isWrapped(dataSource)) {\r\n                dataSource = dataSource(options.row || {})\r\n            }\r\n            if (typeUtils.isObject(dataSource) || Array.isArray(dataSource)) {\r\n                dataSource = normalizeDataSourceOptions(dataSource);\r\n                if (isFilterRow) {\r\n                    postProcess = dataSource.postProcess;\r\n                    dataSource.postProcess = function(items) {\r\n                        if (0 === this.pageIndex()) {\r\n                            items = items.slice(0);\r\n                            items.unshift(null)\r\n                        }\r\n                        if (postProcess) {\r\n                            return postProcess.call(this, items)\r\n                        }\r\n                        return items\r\n                    }\r\n                }\r\n            }\r\n            var allowClearing = Boolean(lookup.allowClearing && !isFilterRow);\r\n            options.editorName = \"dxSelectBox\";\r\n            options.editorOptions = getResultConfig({\r\n                searchEnabled: true,\r\n                value: options.value,\r\n                valueExpr: options.lookup.valueExpr,\r\n                searchExpr: options.lookup.searchExpr || options.lookup.displayExpr,\r\n                allowClearing: allowClearing,\r\n                showClearButton: allowClearing,\r\n                displayExpr: function(data) {\r\n                    if (null === data) {\r\n                        return options.showAllText\r\n                    }\r\n                    return displayGetter(data)\r\n                },\r\n                dataSource: dataSource,\r\n                onValueChanged: function(e) {\r\n                    var params = [e.value];\r\n                    !isFilterRow && params.push(e.component.option(\"text\"));\r\n                    options.setValue.apply(this, params)\r\n                }\r\n            }, options)\r\n        }\r\n    };\r\n    var prepareCheckBox = function(options) {\r\n        options.editorName = \"dxCheckBox\";\r\n        options.editorOptions = getResultConfig({\r\n            value: typeUtils.isDefined(options.value) ? options.value : void 0,\r\n            hoverStateEnabled: !options.readOnly,\r\n            focusStateEnabled: !options.readOnly,\r\n            activeStateEnabled: false,\r\n            onValueChanged: function(e) {\r\n                options.setValue && options.setValue(e.value, e)\r\n            }\r\n        }, options)\r\n    };\r\n    var createEditorCore = function(that, options) {\r\n        var $editorElement = $(options.editorElement);\r\n        if (options.editorName && options.editorOptions && $editorElement[options.editorName]) {\r\n            if (\"dxCheckBox\" === options.editorName) {\r\n                if (!options.isOnForm) {\r\n                    $editorElement.addClass(that.addWidgetPrefix(CHECKBOX_SIZE_CLASS));\r\n                    $editorElement.parent().addClass(EDITOR_INLINE_BLOCK)\r\n                }\r\n                if (options.command || options.editorOptions.readOnly) {\r\n                    $editorElement.parent().addClass(CELL_FOCUS_DISABLED_CLASS)\r\n                }\r\n            }\r\n            that._createComponent($editorElement, options.editorName, options.editorOptions);\r\n            if (\"dxTextBox\" === options.editorName) {\r\n                $editorElement.dxTextBox(\"instance\").registerKeyHandler(\"enter\", noop)\r\n            }\r\n            if (\"dxDateBox\" === options.editorName) {\r\n                $editorElement.dxDateBox(\"instance\").registerKeyHandler(\"enter\", function() {\r\n                    return true\r\n                })\r\n            }\r\n            if (\"dxTextArea\" === options.editorName) {\r\n                $editorElement.dxTextArea(\"instance\").registerKeyHandler(\"enter\", function(event) {\r\n                    if (\"enter\" === normalizeKeyName(event) && !event.ctrlKey && !event.shiftKey) {\r\n                        event.stopPropagation()\r\n                    }\r\n                })\r\n            }\r\n        }\r\n    };\r\n    return {\r\n        createEditor: function($container, options) {\r\n            var editorName;\r\n            options.cancel = false;\r\n            options.editorElement = getPublicElement($container);\r\n            if (!typeUtils.isDefined(options.tabIndex)) {\r\n                options.tabIndex = this.option(\"tabIndex\")\r\n            }\r\n            if (options.lookup) {\r\n                prepareSelectBox(options)\r\n            } else {\r\n                switch (options.dataType) {\r\n                    case \"date\":\r\n                    case \"datetime\":\r\n                        prepareDateBox(options);\r\n                        break;\r\n                    case \"boolean\":\r\n                        prepareBooleanEditor(options);\r\n                        break;\r\n                    case \"number\":\r\n                        prepareNumberBox(options);\r\n                        break;\r\n                    default:\r\n                        prepareTextBox(options)\r\n                }\r\n            }\r\n            editorName = options.editorName;\r\n            this.executeAction(\"onEditorPreparing\", options);\r\n            if (options.cancel) {\r\n                return\r\n            } else {\r\n                if (\"dataRow\" === options.parentType && options.editorType && editorName === options.editorName) {\r\n                    options.editorName = options.editorType\r\n                }\r\n            }\r\n            createEditorCore(this, options);\r\n            this.executeAction(\"onEditorPrepared\", options)\r\n        }\r\n    }\r\n}();\r\nmodule.exports = EditorFactoryMixin;\r\n"]},"metadata":{},"sourceType":"module"}