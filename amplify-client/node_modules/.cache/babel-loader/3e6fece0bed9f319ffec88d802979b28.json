{"ast":null,"code":"/**\r\n * DevExtreme (viz/vector_map/tracker.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar _events_engine = require(\"../../events/core/events_engine\");\n\nvar _events_engine2 = _interopRequireDefault(_events_engine);\n\nvar _window = require(\"../../core/utils/window\");\n\nvar _window2 = _interopRequireDefault(_window);\n\nvar _dom_adapter = require(\"../../core/dom_adapter\");\n\nvar _dom_adapter2 = _interopRequireDefault(_dom_adapter);\n\nvar _event_emitter = require(\"./event_emitter\");\n\nvar _event_emitter2 = _interopRequireDefault(_event_emitter);\n\nvar _utils = require(\"../../events/utils\");\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nvar _wheel = require(\"../../events/core/wheel\");\n\nvar _utils3 = require(\"../core/utils\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nvar navigator = _window2.default.getNavigator();\n\nvar _math = Math;\nvar _abs = _math.abs;\nvar _sqrt = _math.sqrt;\nvar _round = _math.round;\nvar _addNamespace = _utils2.default.addNamespace;\nvar _now = Date.now;\nvar _NAME = \"dxVectorMap\";\nvar EVENT_START = \"start\";\nvar EVENT_MOVE = \"move\";\nvar EVENT_END = \"end\";\nvar EVENT_ZOOM = \"zoom\";\nvar EVENT_HOVER_ON = \"hover-on\";\nvar EVENT_HOVER_OFF = \"hover-off\";\nvar EVENT_CLICK = \"click\";\nvar EVENT_FOCUS_ON = \"focus-on\";\nvar EVENT_FOCUS_MOVE = \"focus-move\";\nvar EVENT_FOCUS_OFF = \"focus-off\";\nvar CLICK_TIME_THRESHOLD = 500;\nvar CLICK_COORD_THRESHOLD_MOUSE = 5;\nvar CLICK_COORD_THRESHOLD_TOUCH = 20;\nvar DRAG_COORD_THRESHOLD_MOUSE = 5;\nvar DRAG_COORD_THRESHOLD_TOUCH = 10;\nvar FOCUS_OFF_DELAY = 100;\nvar WHEEL_COOLDOWN = 50;\nvar WHEEL_DIRECTION_COOLDOWN = 300;\nvar EVENTS;\nsetupEvents();\n\nfunction Tracker(parameters) {\n  var that = this;\n  that._root = parameters.root;\n\n  that._createEventHandlers(parameters.dataKey);\n\n  that._createProjectionHandlers(parameters.projection);\n\n  that._initEvents();\n\n  that._focus = new Focus(function (name, arg) {\n    that._fire(name, arg);\n  });\n\n  that._attachHandlers();\n}\n\nTracker.prototype = {\n  constructor: Tracker,\n  dispose: function dispose() {\n    var that = this;\n\n    that._detachHandlers();\n\n    that._disposeEvents();\n\n    that._focus.dispose();\n\n    that._root = that._focus = that._docHandlers = that._rootHandlers = null;\n  },\n  _eventNames: [EVENT_START, EVENT_MOVE, EVENT_END, EVENT_ZOOM, EVENT_CLICK, EVENT_HOVER_ON, EVENT_HOVER_OFF, EVENT_FOCUS_ON, EVENT_FOCUS_OFF, EVENT_FOCUS_MOVE],\n  _startClick: function _startClick(event, data) {\n    if (!data) {\n      return;\n    }\n\n    var coords = getEventCoords(event);\n    this._clickState = {\n      x: coords.x,\n      y: coords.y,\n      threshold: isTouchEvent(event) ? CLICK_COORD_THRESHOLD_TOUCH : CLICK_COORD_THRESHOLD_MOUSE,\n      time: _now()\n    };\n  },\n  _endClick: function _endClick(event, data) {\n    var state = this._clickState;\n    var threshold;\n    var coords;\n\n    if (!state) {\n      return;\n    }\n\n    if (data && _now() - state.time <= CLICK_TIME_THRESHOLD) {\n      threshold = state.threshold;\n      coords = getEventCoords(event);\n\n      if (_abs(coords.x - state.x) <= threshold && _abs(coords.y - state.y) <= threshold) {\n        this._fire(EVENT_CLICK, {\n          data: data,\n          x: coords.x,\n          y: coords.y,\n          $event: event\n        });\n      }\n    }\n\n    this._clickState = null;\n  },\n  _startDrag: function _startDrag(event, data) {\n    if (!data) {\n      return;\n    }\n\n    var coords = getEventCoords(event);\n    var state = this._dragState = {\n      x: coords.x,\n      y: coords.y,\n      data: data\n    };\n\n    this._fire(EVENT_START, {\n      x: state.x,\n      y: state.y,\n      data: state.data\n    });\n  },\n  _moveDrag: function _moveDrag(event, data) {\n    var state = this._dragState;\n    var coords;\n    var threshold;\n\n    if (!state) {\n      return;\n    }\n\n    coords = getEventCoords(event);\n    threshold = isTouchEvent(event) ? DRAG_COORD_THRESHOLD_TOUCH : DRAG_COORD_THRESHOLD_MOUSE;\n\n    if (state.active || _abs(coords.x - state.x) > threshold || _abs(coords.y - state.y) > threshold) {\n      state.x = coords.x;\n      state.y = coords.y;\n      state.active = true;\n      state.data = data || {};\n\n      this._fire(EVENT_MOVE, {\n        x: state.x,\n        y: state.y,\n        data: state.data\n      });\n    }\n  },\n  _endDrag: function _endDrag() {\n    var state = this._dragState;\n\n    if (!state) {\n      return;\n    }\n\n    this._dragState = null;\n\n    this._fire(EVENT_END, {\n      x: state.x,\n      y: state.y,\n      data: state.data\n    });\n  },\n  _wheelZoom: function _wheelZoom(event, data) {\n    if (!data) {\n      return;\n    }\n\n    var that = this;\n    var lock = that._wheelLock;\n\n    var time = _now();\n\n    var delta;\n    var coords;\n\n    if (time - lock.time <= WHEEL_COOLDOWN) {\n      return;\n    }\n\n    if (time - lock.dirTime > WHEEL_DIRECTION_COOLDOWN) {\n      lock.dir = 0;\n    }\n\n    delta = adjustWheelDelta(event.delta / 120 || 0, lock);\n\n    if (0 === delta) {\n      return;\n    }\n\n    coords = getEventCoords(event);\n\n    that._fire(EVENT_ZOOM, {\n      delta: delta,\n      x: coords.x,\n      y: coords.y\n    });\n\n    lock.time = lock.dirTime = time;\n  },\n  _startZoom: function _startZoom(event, data) {\n    if (!isTouchEvent(event) || !data) {\n      return;\n    }\n\n    var state = this._zoomState = this._zoomState || {};\n    var coords;\n    var pointer2;\n\n    if (state.pointer1 && state.pointer2) {\n      return;\n    }\n\n    if (void 0 === state.pointer1) {\n      state.pointer1 = getPointerId(event) || 0;\n      coords = getMultitouchEventCoords(event, state.pointer1);\n      state.x1 = state.x1_0 = coords.x;\n      state.y1 = state.y1_0 = coords.y;\n    }\n\n    if (void 0 === state.pointer2) {\n      pointer2 = getPointerId(event) || 1;\n\n      if (pointer2 !== state.pointer1) {\n        coords = getMultitouchEventCoords(event, pointer2);\n\n        if (coords) {\n          state.x2 = state.x2_0 = coords.x;\n          state.y2 = state.y2_0 = coords.y;\n          state.pointer2 = pointer2;\n          state.ready = true;\n\n          this._endDrag();\n        }\n      }\n    }\n  },\n  _moveZoom: function _moveZoom(event) {\n    var state = this._zoomState;\n    var coords;\n\n    if (!state || !isTouchEvent(event)) {\n      return;\n    }\n\n    if (void 0 !== state.pointer1) {\n      coords = getMultitouchEventCoords(event, state.pointer1);\n\n      if (coords) {\n        state.x1 = coords.x;\n        state.y1 = coords.y;\n      }\n    }\n\n    if (void 0 !== state.pointer2) {\n      coords = getMultitouchEventCoords(event, state.pointer2);\n\n      if (coords) {\n        state.x2 = coords.x;\n        state.y2 = coords.y;\n      }\n    }\n  },\n  _endZoom: function _endZoom(event) {\n    var state = this._zoomState;\n    var startDistance;\n    var currentDistance;\n\n    if (!state || !isTouchEvent(event)) {\n      return;\n    }\n\n    if (state.ready) {\n      startDistance = getDistance(state.x1_0, state.y1_0, state.x2_0, state.y2_0);\n      currentDistance = getDistance(state.x1, state.y1, state.x2, state.y2);\n\n      this._fire(EVENT_ZOOM, {\n        ratio: currentDistance / startDistance,\n        x: (state.x1_0 + state.x2_0) / 2,\n        y: (state.y1_0 + state.y2_0) / 2\n      });\n    }\n\n    this._zoomState = null;\n  },\n  _startHover: function _startHover(event, data) {\n    this._doHover(event, data, true);\n  },\n  _moveHover: function _moveHover(event, data) {\n    this._doHover(event, data, false);\n  },\n  _doHover: function _doHover(event, data, isTouch) {\n    var that = this;\n\n    if (that._dragState && that._dragState.active || that._zoomState && that._zoomState.ready) {\n      that._cancelHover();\n\n      return;\n    }\n\n    if (isTouchEvent(event) !== isTouch || that._hoverTarget === event.target || that._hoverState && that._hoverState.data === data) {\n      return;\n    }\n\n    that._cancelHover();\n\n    if (data) {\n      that._hoverState = {\n        data: data\n      };\n\n      that._fire(EVENT_HOVER_ON, {\n        data: data\n      });\n    }\n\n    that._hoverTarget = event.target;\n  },\n  _cancelHover: function _cancelHover() {\n    var state = this._hoverState;\n    this._hoverState = this._hoverTarget = null;\n\n    if (state) {\n      this._fire(EVENT_HOVER_OFF, {\n        data: state.data\n      });\n    }\n  },\n  _startFocus: function _startFocus(event, data) {\n    this._doFocus(event, data, true);\n  },\n  _moveFocus: function _moveFocus(event, data) {\n    this._doFocus(event, data, false);\n  },\n  _doFocus: function _doFocus(event, data, isTouch) {\n    var that = this;\n\n    if (that._dragState && that._dragState.active || that._zoomState && that._zoomState.ready) {\n      that._cancelFocus();\n\n      return;\n    }\n\n    if (isTouchEvent(event) !== isTouch) {\n      return;\n    }\n\n    that._focus.turnOff();\n\n    data && that._focus.turnOn(data, getEventCoords(event));\n  },\n  _cancelFocus: function _cancelFocus() {\n    this._focus.cancel();\n  },\n  _createEventHandlers: function _createEventHandlers(DATA_KEY) {\n    var that = this;\n    that._docHandlers = {};\n    that._rootHandlers = {};\n\n    that._rootHandlers[EVENTS.start] = that._docHandlers[EVENTS.start] = function (event) {\n      var isTouch = isTouchEvent(event);\n      var data = getData(event);\n\n      if (isTouch && !that._isTouchEnabled) {\n        return;\n      }\n\n      if (data) {\n        event.preventDefault();\n        event.stopPropagation();\n      }\n\n      that._startClick(event, data);\n\n      that._startDrag(event, data);\n\n      that._startZoom(event, data);\n\n      that._startHover(event, data);\n\n      that._startFocus(event, data);\n    };\n\n    that._docHandlers[EVENTS.move] = function (event) {\n      var isTouch = isTouchEvent(event);\n      var data = getData(event);\n\n      if (isTouch && !that._isTouchEnabled) {\n        return;\n      }\n\n      that._moveDrag(event, data);\n\n      that._moveZoom(event, data);\n\n      that._moveHover(event, data);\n\n      that._moveFocus(event, data);\n    };\n\n    that._docHandlers[EVENTS.end] = function (event) {\n      var isTouch = isTouchEvent(event);\n      var data = getData(event);\n\n      if (isTouch && !that._isTouchEnabled) {\n        return;\n      }\n\n      that._endClick(event, data);\n\n      that._endDrag(event, data);\n\n      that._endZoom(event, data);\n    };\n\n    that._rootHandlers[EVENTS.wheel] = function (event) {\n      that._cancelFocus();\n\n      if (!that._isWheelEnabled) {\n        return;\n      }\n\n      var data = getData(event);\n\n      if (data) {\n        event.preventDefault();\n        event.stopPropagation();\n\n        that._wheelZoom(event, data);\n      }\n    };\n\n    that._wheelLock = {\n      dir: 0\n    };\n\n    function getData(event) {\n      var target = event.target;\n      return (\"tspan\" === target.tagName ? target.parentNode : target)[DATA_KEY];\n    }\n  },\n  _createProjectionHandlers: function _createProjectionHandlers(projection) {\n    var that = this;\n    projection.on({\n      center: handler,\n      zoom: handler\n    });\n\n    function handler() {\n      that._cancelFocus();\n    }\n  },\n  reset: function reset() {\n    var that = this;\n    that._clickState = null;\n\n    that._endDrag();\n\n    that._cancelHover();\n\n    that._cancelFocus();\n  },\n  setOptions: function setOptions(options) {\n    var that = this;\n    that.reset();\n\n    that._detachHandlers();\n\n    that._isTouchEnabled = !!(0, _utils3.parseScalar)(options.touchEnabled, true);\n    that._isWheelEnabled = !!(0, _utils3.parseScalar)(options.wheelEnabled, true);\n\n    that._attachHandlers();\n  },\n  _detachHandlers: function _detachHandlers() {\n    var that = this;\n\n    if (that._isTouchEnabled) {\n      that._root.css({\n        \"touch-action\": \"\",\n        \"-webkit-user-select\": \"\"\n      }).off(_addNamespace(\"MSHoldVisual\", _NAME)).off(_addNamespace(\"contextmenu\", _NAME));\n    }\n\n    _events_engine2.default.off(_dom_adapter2.default.getDocument(), that._docHandlers);\n\n    that._root.off(that._rootHandlers);\n  },\n  _attachHandlers: function _attachHandlers() {\n    var that = this;\n\n    if (that._isTouchEnabled) {\n      that._root.css({\n        \"touch-action\": \"none\",\n        \"-webkit-user-select\": \"none\"\n      }).on(_addNamespace(\"MSHoldVisual\", _NAME), function (event) {\n        event.preventDefault();\n      }).on(_addNamespace(\"contextmenu\", _NAME), function (event) {\n        isTouchEvent(event) && event.preventDefault();\n      });\n    }\n\n    _events_engine2.default.on(_dom_adapter2.default.getDocument(), that._docHandlers);\n\n    that._root.on(that._rootHandlers);\n  }\n};\n\nvar Focus = function Focus(fire) {\n  var that = this;\n  var _activeData = null;\n  var _data = null;\n  var _disabled = false;\n  var _offTimer = null;\n\n  var _x;\n\n  var _y;\n\n  that.dispose = function () {\n    clearTimeout(_offTimer);\n    that.turnOn = that.turnOff = that.cancel = that.dispose = that = fire = _activeData = _data = _offTimer = null;\n  };\n\n  that.turnOn = function (data, coords) {\n    if (data === _data && _disabled) {\n      return;\n    }\n\n    _disabled = false;\n    _data = data;\n\n    if (_activeData) {\n      _x = coords.x;\n      _y = coords.y;\n\n      if (_data === _activeData) {\n        fire(EVENT_FOCUS_MOVE, {\n          data: _data,\n          x: _x,\n          y: _y\n        });\n        onCheck(true);\n      } else {\n        fire(EVENT_FOCUS_ON, {\n          data: _data,\n          x: _x,\n          y: _y,\n          done: onCheck\n        });\n      }\n    } else {\n      _x = coords.x;\n      _y = coords.y;\n      fire(EVENT_FOCUS_ON, {\n        data: _data,\n        x: _x,\n        y: _y,\n        done: onCheck\n      });\n    }\n\n    function onCheck(result) {\n      _disabled = !result;\n\n      if (result) {\n        _activeData = _data;\n        clearTimeout(_offTimer);\n        _offTimer = null;\n      }\n    }\n  };\n\n  that.turnOff = function () {\n    _data = null;\n\n    if (_activeData && !_disabled) {\n      _offTimer = _offTimer || setTimeout(function () {\n        _offTimer = null;\n        fire(EVENT_FOCUS_OFF, {\n          data: _activeData\n        });\n        _activeData = null;\n      }, FOCUS_OFF_DELAY);\n    }\n  };\n\n  that.cancel = function () {\n    clearTimeout(_offTimer);\n\n    if (_activeData) {\n      fire(EVENT_FOCUS_OFF, {\n        data: _activeData\n      });\n    }\n\n    _activeData = _data = _offTimer = null;\n  };\n};\n\n_event_emitter2.default.makeEventEmitter(Tracker);\n\nexports.Tracker = Tracker;\n\nfunction getDistance(x1, y1, x2, y2) {\n  return _sqrt((x1 - x2) * (x1 - x2) + (y1 - y2) * (y1 - y2));\n}\n\nfunction isTouchEvent(event) {\n  var type = event.originalEvent.type;\n  var pointerType = event.originalEvent.pointerType;\n  return /^touch/.test(type) || /^MSPointer/.test(type) && 4 !== pointerType || /^pointer/.test(type) && \"mouse\" !== pointerType;\n}\n\nfunction selectItem(flags, items) {\n  var i = 0;\n  var ii = flags.length;\n  var item;\n\n  for (; i < ii; ++i) {\n    if (flags[i]) {\n      item = items[i];\n      break;\n    }\n  }\n\n  return _addNamespace(item || items[i], _NAME);\n}\n\nfunction setupEvents() {\n  var flags = [navigator.pointerEnabled, navigator.msPointerEnabled, _window2.default.hasProperty(\"ontouchstart\")];\n  EVENTS = {\n    start: selectItem(flags, [\"pointerdown\", \"MSPointerDown\", \"touchstart mousedown\", \"mousedown\"]),\n    move: selectItem(flags, [\"pointermove\", \"MSPointerMove\", \"touchmove mousemove\", \"mousemove\"]),\n    end: selectItem(flags, [\"pointerup\", \"MSPointerUp\", \"touchend mouseup\", \"mouseup\"]),\n    wheel: _addNamespace(_wheel.name, _NAME)\n  };\n}\n\nfunction getEventCoords(event) {\n  var originalEvent = event.originalEvent;\n  var touch = originalEvent.touches && originalEvent.touches[0] || {};\n  return {\n    x: touch.pageX || originalEvent.pageX || event.pageX,\n    y: touch.pageY || originalEvent.pageY || event.pageY\n  };\n}\n\nfunction getPointerId(event) {\n  return event.originalEvent.pointerId;\n}\n\nfunction getMultitouchEventCoords(event, pointerId) {\n  var originalEvent = event.originalEvent;\n\n  if (void 0 !== originalEvent.pointerId) {\n    originalEvent = originalEvent.pointerId === pointerId ? originalEvent : null;\n  } else {\n    originalEvent = originalEvent.touches[pointerId];\n  }\n\n  return originalEvent ? {\n    x: originalEvent.pageX || event.pageX,\n    y: originalEvent.pageY || event.pageY\n  } : null;\n}\n\nfunction adjustWheelDelta(delta, lock) {\n  if (0 === delta) {\n    return 0;\n  }\n\n  var _delta = _abs(delta);\n\n  var sign = _round(delta / _delta);\n\n  if (lock.dir && sign !== lock.dir) {\n    return 0;\n  }\n\n  lock.dir = sign;\n\n  if (_delta < .1) {\n    _delta = 0;\n  } else {\n    if (_delta < 1) {\n      _delta = 1;\n    } else {\n      if (_delta > 4) {\n        _delta = 4;\n      } else {\n        _delta = _round(_delta);\n      }\n    }\n  }\n\n  return sign * _delta;\n}","map":{"version":3,"sources":["C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/devextreme/viz/vector_map/tracker.js"],"names":["_events_engine","require","_events_engine2","_interopRequireDefault","_window","_window2","_dom_adapter","_dom_adapter2","_event_emitter","_event_emitter2","_utils","_utils2","_wheel","_utils3","obj","navigator","_math","_abs","_sqrt","_round","_addNamespace","_now","Date","_NAME","EVENT_START","EVENT_MOVE","EVENT_END","EVENT_ZOOM","EVENT_HOVER_ON","EVENT_HOVER_OFF","EVENT_CLICK","EVENT_FOCUS_ON","EVENT_FOCUS_MOVE","EVENT_FOCUS_OFF","CLICK_TIME_THRESHOLD","CLICK_COORD_THRESHOLD_MOUSE","CLICK_COORD_THRESHOLD_TOUCH","DRAG_COORD_THRESHOLD_MOUSE","DRAG_COORD_THRESHOLD_TOUCH","FOCUS_OFF_DELAY","WHEEL_COOLDOWN","WHEEL_DIRECTION_COOLDOWN","setupEvents","that","parameters","Tracker","constructor","dispose","_eventNames","_startClick","coords","getEventCoords","x","y","threshold","isTouchEvent","time","_endClick","state","data","$event","event","_startDrag","_moveDrag","_endDrag","_wheelZoom","lock","delta","adjustWheelDelta","_startZoom","getPointerId","getMultitouchEventCoords","pointer2","_moveZoom","_endZoom","startDistance","getDistance","currentDistance","ratio","_startHover","_moveHover","_doHover","_cancelHover","_startFocus","_moveFocus","_doFocus","_cancelFocus","_createEventHandlers","EVENTS","isTouch","getData","dir","target","_createProjectionHandlers","projection","center","zoom","handler","reset","setOptions","options","_detachHandlers","_attachHandlers","Focus","_activeData","_data","_disabled","_offTimer","clearTimeout","fire","_x","_y","onCheck","done","setTimeout","exports","x1","y1","type","pointerType","i","ii","flags","item","items","start","selectItem","move","end","wheel","originalEvent","touch","pageY","_delta","sign"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (viz/vector_map/tracker.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar _events_engine = require(\"../../events/core/events_engine\");\r\nvar _events_engine2 = _interopRequireDefault(_events_engine);\r\nvar _window = require(\"../../core/utils/window\");\r\nvar _window2 = _interopRequireDefault(_window);\r\nvar _dom_adapter = require(\"../../core/dom_adapter\");\r\nvar _dom_adapter2 = _interopRequireDefault(_dom_adapter);\r\nvar _event_emitter = require(\"./event_emitter\");\r\nvar _event_emitter2 = _interopRequireDefault(_event_emitter);\r\nvar _utils = require(\"../../events/utils\");\r\nvar _utils2 = _interopRequireDefault(_utils);\r\nvar _wheel = require(\"../../events/core/wheel\");\r\nvar _utils3 = require(\"../core/utils\");\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\nvar navigator = _window2.default.getNavigator();\r\nvar _math = Math;\r\nvar _abs = _math.abs;\r\nvar _sqrt = _math.sqrt;\r\nvar _round = _math.round;\r\nvar _addNamespace = _utils2.default.addNamespace;\r\nvar _now = Date.now;\r\nvar _NAME = \"dxVectorMap\";\r\nvar EVENT_START = \"start\";\r\nvar EVENT_MOVE = \"move\";\r\nvar EVENT_END = \"end\";\r\nvar EVENT_ZOOM = \"zoom\";\r\nvar EVENT_HOVER_ON = \"hover-on\";\r\nvar EVENT_HOVER_OFF = \"hover-off\";\r\nvar EVENT_CLICK = \"click\";\r\nvar EVENT_FOCUS_ON = \"focus-on\";\r\nvar EVENT_FOCUS_MOVE = \"focus-move\";\r\nvar EVENT_FOCUS_OFF = \"focus-off\";\r\nvar CLICK_TIME_THRESHOLD = 500;\r\nvar CLICK_COORD_THRESHOLD_MOUSE = 5;\r\nvar CLICK_COORD_THRESHOLD_TOUCH = 20;\r\nvar DRAG_COORD_THRESHOLD_MOUSE = 5;\r\nvar DRAG_COORD_THRESHOLD_TOUCH = 10;\r\nvar FOCUS_OFF_DELAY = 100;\r\nvar WHEEL_COOLDOWN = 50;\r\nvar WHEEL_DIRECTION_COOLDOWN = 300;\r\nvar EVENTS;\r\nsetupEvents();\r\n\r\nfunction Tracker(parameters) {\r\n    var that = this;\r\n    that._root = parameters.root;\r\n    that._createEventHandlers(parameters.dataKey);\r\n    that._createProjectionHandlers(parameters.projection);\r\n    that._initEvents();\r\n    that._focus = new Focus(function(name, arg) {\r\n        that._fire(name, arg)\r\n    });\r\n    that._attachHandlers()\r\n}\r\nTracker.prototype = {\r\n    constructor: Tracker,\r\n    dispose: function() {\r\n        var that = this;\r\n        that._detachHandlers();\r\n        that._disposeEvents();\r\n        that._focus.dispose();\r\n        that._root = that._focus = that._docHandlers = that._rootHandlers = null\r\n    },\r\n    _eventNames: [EVENT_START, EVENT_MOVE, EVENT_END, EVENT_ZOOM, EVENT_CLICK, EVENT_HOVER_ON, EVENT_HOVER_OFF, EVENT_FOCUS_ON, EVENT_FOCUS_OFF, EVENT_FOCUS_MOVE],\r\n    _startClick: function(event, data) {\r\n        if (!data) {\r\n            return\r\n        }\r\n        var coords = getEventCoords(event);\r\n        this._clickState = {\r\n            x: coords.x,\r\n            y: coords.y,\r\n            threshold: isTouchEvent(event) ? CLICK_COORD_THRESHOLD_TOUCH : CLICK_COORD_THRESHOLD_MOUSE,\r\n            time: _now()\r\n        }\r\n    },\r\n    _endClick: function(event, data) {\r\n        var state = this._clickState;\r\n        var threshold;\r\n        var coords;\r\n        if (!state) {\r\n            return\r\n        }\r\n        if (data && _now() - state.time <= CLICK_TIME_THRESHOLD) {\r\n            threshold = state.threshold;\r\n            coords = getEventCoords(event);\r\n            if (_abs(coords.x - state.x) <= threshold && _abs(coords.y - state.y) <= threshold) {\r\n                this._fire(EVENT_CLICK, {\r\n                    data: data,\r\n                    x: coords.x,\r\n                    y: coords.y,\r\n                    $event: event\r\n                })\r\n            }\r\n        }\r\n        this._clickState = null\r\n    },\r\n    _startDrag: function(event, data) {\r\n        if (!data) {\r\n            return\r\n        }\r\n        var coords = getEventCoords(event);\r\n        var state = this._dragState = {\r\n            x: coords.x,\r\n            y: coords.y,\r\n            data: data\r\n        };\r\n        this._fire(EVENT_START, {\r\n            x: state.x,\r\n            y: state.y,\r\n            data: state.data\r\n        })\r\n    },\r\n    _moveDrag: function(event, data) {\r\n        var state = this._dragState;\r\n        var coords;\r\n        var threshold;\r\n        if (!state) {\r\n            return\r\n        }\r\n        coords = getEventCoords(event);\r\n        threshold = isTouchEvent(event) ? DRAG_COORD_THRESHOLD_TOUCH : DRAG_COORD_THRESHOLD_MOUSE;\r\n        if (state.active || _abs(coords.x - state.x) > threshold || _abs(coords.y - state.y) > threshold) {\r\n            state.x = coords.x;\r\n            state.y = coords.y;\r\n            state.active = true;\r\n            state.data = data || {};\r\n            this._fire(EVENT_MOVE, {\r\n                x: state.x,\r\n                y: state.y,\r\n                data: state.data\r\n            })\r\n        }\r\n    },\r\n    _endDrag: function() {\r\n        var state = this._dragState;\r\n        if (!state) {\r\n            return\r\n        }\r\n        this._dragState = null;\r\n        this._fire(EVENT_END, {\r\n            x: state.x,\r\n            y: state.y,\r\n            data: state.data\r\n        })\r\n    },\r\n    _wheelZoom: function(event, data) {\r\n        if (!data) {\r\n            return\r\n        }\r\n        var that = this;\r\n        var lock = that._wheelLock;\r\n        var time = _now();\r\n        var delta;\r\n        var coords;\r\n        if (time - lock.time <= WHEEL_COOLDOWN) {\r\n            return\r\n        }\r\n        if (time - lock.dirTime > WHEEL_DIRECTION_COOLDOWN) {\r\n            lock.dir = 0\r\n        }\r\n        delta = adjustWheelDelta(event.delta / 120 || 0, lock);\r\n        if (0 === delta) {\r\n            return\r\n        }\r\n        coords = getEventCoords(event);\r\n        that._fire(EVENT_ZOOM, {\r\n            delta: delta,\r\n            x: coords.x,\r\n            y: coords.y\r\n        });\r\n        lock.time = lock.dirTime = time\r\n    },\r\n    _startZoom: function(event, data) {\r\n        if (!isTouchEvent(event) || !data) {\r\n            return\r\n        }\r\n        var state = this._zoomState = this._zoomState || {};\r\n        var coords;\r\n        var pointer2;\r\n        if (state.pointer1 && state.pointer2) {\r\n            return\r\n        }\r\n        if (void 0 === state.pointer1) {\r\n            state.pointer1 = getPointerId(event) || 0;\r\n            coords = getMultitouchEventCoords(event, state.pointer1);\r\n            state.x1 = state.x1_0 = coords.x;\r\n            state.y1 = state.y1_0 = coords.y\r\n        }\r\n        if (void 0 === state.pointer2) {\r\n            pointer2 = getPointerId(event) || 1;\r\n            if (pointer2 !== state.pointer1) {\r\n                coords = getMultitouchEventCoords(event, pointer2);\r\n                if (coords) {\r\n                    state.x2 = state.x2_0 = coords.x;\r\n                    state.y2 = state.y2_0 = coords.y;\r\n                    state.pointer2 = pointer2;\r\n                    state.ready = true;\r\n                    this._endDrag()\r\n                }\r\n            }\r\n        }\r\n    },\r\n    _moveZoom: function(event) {\r\n        var state = this._zoomState;\r\n        var coords;\r\n        if (!state || !isTouchEvent(event)) {\r\n            return\r\n        }\r\n        if (void 0 !== state.pointer1) {\r\n            coords = getMultitouchEventCoords(event, state.pointer1);\r\n            if (coords) {\r\n                state.x1 = coords.x;\r\n                state.y1 = coords.y\r\n            }\r\n        }\r\n        if (void 0 !== state.pointer2) {\r\n            coords = getMultitouchEventCoords(event, state.pointer2);\r\n            if (coords) {\r\n                state.x2 = coords.x;\r\n                state.y2 = coords.y\r\n            }\r\n        }\r\n    },\r\n    _endZoom: function(event) {\r\n        var state = this._zoomState;\r\n        var startDistance;\r\n        var currentDistance;\r\n        if (!state || !isTouchEvent(event)) {\r\n            return\r\n        }\r\n        if (state.ready) {\r\n            startDistance = getDistance(state.x1_0, state.y1_0, state.x2_0, state.y2_0);\r\n            currentDistance = getDistance(state.x1, state.y1, state.x2, state.y2);\r\n            this._fire(EVENT_ZOOM, {\r\n                ratio: currentDistance / startDistance,\r\n                x: (state.x1_0 + state.x2_0) / 2,\r\n                y: (state.y1_0 + state.y2_0) / 2\r\n            })\r\n        }\r\n        this._zoomState = null\r\n    },\r\n    _startHover: function(event, data) {\r\n        this._doHover(event, data, true)\r\n    },\r\n    _moveHover: function(event, data) {\r\n        this._doHover(event, data, false)\r\n    },\r\n    _doHover: function(event, data, isTouch) {\r\n        var that = this;\r\n        if (that._dragState && that._dragState.active || that._zoomState && that._zoomState.ready) {\r\n            that._cancelHover();\r\n            return\r\n        }\r\n        if (isTouchEvent(event) !== isTouch || that._hoverTarget === event.target || that._hoverState && that._hoverState.data === data) {\r\n            return\r\n        }\r\n        that._cancelHover();\r\n        if (data) {\r\n            that._hoverState = {\r\n                data: data\r\n            };\r\n            that._fire(EVENT_HOVER_ON, {\r\n                data: data\r\n            })\r\n        }\r\n        that._hoverTarget = event.target\r\n    },\r\n    _cancelHover: function() {\r\n        var state = this._hoverState;\r\n        this._hoverState = this._hoverTarget = null;\r\n        if (state) {\r\n            this._fire(EVENT_HOVER_OFF, {\r\n                data: state.data\r\n            })\r\n        }\r\n    },\r\n    _startFocus: function(event, data) {\r\n        this._doFocus(event, data, true)\r\n    },\r\n    _moveFocus: function(event, data) {\r\n        this._doFocus(event, data, false)\r\n    },\r\n    _doFocus: function(event, data, isTouch) {\r\n        var that = this;\r\n        if (that._dragState && that._dragState.active || that._zoomState && that._zoomState.ready) {\r\n            that._cancelFocus();\r\n            return\r\n        }\r\n        if (isTouchEvent(event) !== isTouch) {\r\n            return\r\n        }\r\n        that._focus.turnOff();\r\n        data && that._focus.turnOn(data, getEventCoords(event))\r\n    },\r\n    _cancelFocus: function() {\r\n        this._focus.cancel()\r\n    },\r\n    _createEventHandlers: function(DATA_KEY) {\r\n        var that = this;\r\n        that._docHandlers = {};\r\n        that._rootHandlers = {};\r\n        that._rootHandlers[EVENTS.start] = that._docHandlers[EVENTS.start] = function(event) {\r\n            var isTouch = isTouchEvent(event);\r\n            var data = getData(event);\r\n            if (isTouch && !that._isTouchEnabled) {\r\n                return\r\n            }\r\n            if (data) {\r\n                event.preventDefault();\r\n                event.stopPropagation()\r\n            }\r\n            that._startClick(event, data);\r\n            that._startDrag(event, data);\r\n            that._startZoom(event, data);\r\n            that._startHover(event, data);\r\n            that._startFocus(event, data)\r\n        };\r\n        that._docHandlers[EVENTS.move] = function(event) {\r\n            var isTouch = isTouchEvent(event);\r\n            var data = getData(event);\r\n            if (isTouch && !that._isTouchEnabled) {\r\n                return\r\n            }\r\n            that._moveDrag(event, data);\r\n            that._moveZoom(event, data);\r\n            that._moveHover(event, data);\r\n            that._moveFocus(event, data)\r\n        };\r\n        that._docHandlers[EVENTS.end] = function(event) {\r\n            var isTouch = isTouchEvent(event);\r\n            var data = getData(event);\r\n            if (isTouch && !that._isTouchEnabled) {\r\n                return\r\n            }\r\n            that._endClick(event, data);\r\n            that._endDrag(event, data);\r\n            that._endZoom(event, data)\r\n        };\r\n        that._rootHandlers[EVENTS.wheel] = function(event) {\r\n            that._cancelFocus();\r\n            if (!that._isWheelEnabled) {\r\n                return\r\n            }\r\n            var data = getData(event);\r\n            if (data) {\r\n                event.preventDefault();\r\n                event.stopPropagation();\r\n                that._wheelZoom(event, data)\r\n            }\r\n        };\r\n        that._wheelLock = {\r\n            dir: 0\r\n        };\r\n\r\n        function getData(event) {\r\n            var target = event.target;\r\n            return (\"tspan\" === target.tagName ? target.parentNode : target)[DATA_KEY]\r\n        }\r\n    },\r\n    _createProjectionHandlers: function(projection) {\r\n        var that = this;\r\n        projection.on({\r\n            center: handler,\r\n            zoom: handler\r\n        });\r\n\r\n        function handler() {\r\n            that._cancelFocus()\r\n        }\r\n    },\r\n    reset: function() {\r\n        var that = this;\r\n        that._clickState = null;\r\n        that._endDrag();\r\n        that._cancelHover();\r\n        that._cancelFocus()\r\n    },\r\n    setOptions: function(options) {\r\n        var that = this;\r\n        that.reset();\r\n        that._detachHandlers();\r\n        that._isTouchEnabled = !!(0, _utils3.parseScalar)(options.touchEnabled, true);\r\n        that._isWheelEnabled = !!(0, _utils3.parseScalar)(options.wheelEnabled, true);\r\n        that._attachHandlers()\r\n    },\r\n    _detachHandlers: function() {\r\n        var that = this;\r\n        if (that._isTouchEnabled) {\r\n            that._root.css({\r\n                \"touch-action\": \"\",\r\n                \"-webkit-user-select\": \"\"\r\n            }).off(_addNamespace(\"MSHoldVisual\", _NAME)).off(_addNamespace(\"contextmenu\", _NAME))\r\n        }\r\n        _events_engine2.default.off(_dom_adapter2.default.getDocument(), that._docHandlers);\r\n        that._root.off(that._rootHandlers)\r\n    },\r\n    _attachHandlers: function() {\r\n        var that = this;\r\n        if (that._isTouchEnabled) {\r\n            that._root.css({\r\n                \"touch-action\": \"none\",\r\n                \"-webkit-user-select\": \"none\"\r\n            }).on(_addNamespace(\"MSHoldVisual\", _NAME), function(event) {\r\n                event.preventDefault()\r\n            }).on(_addNamespace(\"contextmenu\", _NAME), function(event) {\r\n                isTouchEvent(event) && event.preventDefault()\r\n            })\r\n        }\r\n        _events_engine2.default.on(_dom_adapter2.default.getDocument(), that._docHandlers);\r\n        that._root.on(that._rootHandlers)\r\n    }\r\n};\r\nvar Focus = function(fire) {\r\n    var that = this;\r\n    var _activeData = null;\r\n    var _data = null;\r\n    var _disabled = false;\r\n    var _offTimer = null;\r\n    var _x;\r\n    var _y;\r\n    that.dispose = function() {\r\n        clearTimeout(_offTimer);\r\n        that.turnOn = that.turnOff = that.cancel = that.dispose = that = fire = _activeData = _data = _offTimer = null\r\n    };\r\n    that.turnOn = function(data, coords) {\r\n        if (data === _data && _disabled) {\r\n            return\r\n        }\r\n        _disabled = false;\r\n        _data = data;\r\n        if (_activeData) {\r\n            _x = coords.x;\r\n            _y = coords.y;\r\n            if (_data === _activeData) {\r\n                fire(EVENT_FOCUS_MOVE, {\r\n                    data: _data,\r\n                    x: _x,\r\n                    y: _y\r\n                });\r\n                onCheck(true)\r\n            } else {\r\n                fire(EVENT_FOCUS_ON, {\r\n                    data: _data,\r\n                    x: _x,\r\n                    y: _y,\r\n                    done: onCheck\r\n                })\r\n            }\r\n        } else {\r\n            _x = coords.x;\r\n            _y = coords.y;\r\n            fire(EVENT_FOCUS_ON, {\r\n                data: _data,\r\n                x: _x,\r\n                y: _y,\r\n                done: onCheck\r\n            })\r\n        }\r\n\r\n        function onCheck(result) {\r\n            _disabled = !result;\r\n            if (result) {\r\n                _activeData = _data;\r\n                clearTimeout(_offTimer);\r\n                _offTimer = null\r\n            }\r\n        }\r\n    };\r\n    that.turnOff = function() {\r\n        _data = null;\r\n        if (_activeData && !_disabled) {\r\n            _offTimer = _offTimer || setTimeout(function() {\r\n                _offTimer = null;\r\n                fire(EVENT_FOCUS_OFF, {\r\n                    data: _activeData\r\n                });\r\n                _activeData = null\r\n            }, FOCUS_OFF_DELAY)\r\n        }\r\n    };\r\n    that.cancel = function() {\r\n        clearTimeout(_offTimer);\r\n        if (_activeData) {\r\n            fire(EVENT_FOCUS_OFF, {\r\n                data: _activeData\r\n            })\r\n        }\r\n        _activeData = _data = _offTimer = null\r\n    }\r\n};\r\n_event_emitter2.default.makeEventEmitter(Tracker);\r\nexports.Tracker = Tracker;\r\n\r\nfunction getDistance(x1, y1, x2, y2) {\r\n    return _sqrt((x1 - x2) * (x1 - x2) + (y1 - y2) * (y1 - y2))\r\n}\r\n\r\nfunction isTouchEvent(event) {\r\n    var type = event.originalEvent.type;\r\n    var pointerType = event.originalEvent.pointerType;\r\n    return /^touch/.test(type) || /^MSPointer/.test(type) && 4 !== pointerType || /^pointer/.test(type) && \"mouse\" !== pointerType\r\n}\r\n\r\nfunction selectItem(flags, items) {\r\n    var i = 0;\r\n    var ii = flags.length;\r\n    var item;\r\n    for (; i < ii; ++i) {\r\n        if (flags[i]) {\r\n            item = items[i];\r\n            break\r\n        }\r\n    }\r\n    return _addNamespace(item || items[i], _NAME)\r\n}\r\n\r\nfunction setupEvents() {\r\n    var flags = [navigator.pointerEnabled, navigator.msPointerEnabled, _window2.default.hasProperty(\"ontouchstart\")];\r\n    EVENTS = {\r\n        start: selectItem(flags, [\"pointerdown\", \"MSPointerDown\", \"touchstart mousedown\", \"mousedown\"]),\r\n        move: selectItem(flags, [\"pointermove\", \"MSPointerMove\", \"touchmove mousemove\", \"mousemove\"]),\r\n        end: selectItem(flags, [\"pointerup\", \"MSPointerUp\", \"touchend mouseup\", \"mouseup\"]),\r\n        wheel: _addNamespace(_wheel.name, _NAME)\r\n    }\r\n}\r\n\r\nfunction getEventCoords(event) {\r\n    var originalEvent = event.originalEvent;\r\n    var touch = originalEvent.touches && originalEvent.touches[0] || {};\r\n    return {\r\n        x: touch.pageX || originalEvent.pageX || event.pageX,\r\n        y: touch.pageY || originalEvent.pageY || event.pageY\r\n    }\r\n}\r\n\r\nfunction getPointerId(event) {\r\n    return event.originalEvent.pointerId\r\n}\r\n\r\nfunction getMultitouchEventCoords(event, pointerId) {\r\n    var originalEvent = event.originalEvent;\r\n    if (void 0 !== originalEvent.pointerId) {\r\n        originalEvent = originalEvent.pointerId === pointerId ? originalEvent : null\r\n    } else {\r\n        originalEvent = originalEvent.touches[pointerId]\r\n    }\r\n    return originalEvent ? {\r\n        x: originalEvent.pageX || event.pageX,\r\n        y: originalEvent.pageY || event.pageY\r\n    } : null\r\n}\r\n\r\nfunction adjustWheelDelta(delta, lock) {\r\n    if (0 === delta) {\r\n        return 0\r\n    }\r\n    var _delta = _abs(delta);\r\n    var sign = _round(delta / _delta);\r\n    if (lock.dir && sign !== lock.dir) {\r\n        return 0\r\n    }\r\n    lock.dir = sign;\r\n    if (_delta < .1) {\r\n        _delta = 0\r\n    } else {\r\n        if (_delta < 1) {\r\n            _delta = 1\r\n        } else {\r\n            if (_delta > 4) {\r\n                _delta = 4\r\n            } else {\r\n                _delta = _round(_delta)\r\n            }\r\n        }\r\n    }\r\n    return sign * _delta\r\n}\r\n"]},"metadata":{},"sourceType":"module"}