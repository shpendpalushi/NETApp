{"ast":null,"code":"/**\r\n * DevExtreme (viz/chart_components/layout_manager.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar extend = require(\"../../core/utils/extend\").extend;\n\nvar layoutElementModule = require(\"../core/layout_element\");\n\nvar _isNumber = require(\"../../core/utils/type\").isNumeric;\n\nvar _min = Math.min;\nvar _max = Math.max;\nvar _floor = Math.floor;\nvar _sqrt = Math.sqrt;\n\nvar consts = require(\"../components/consts\");\n\nvar RADIAL_LABEL_INDENT = consts.radialLabelIndent;\n\nfunction getNearestCoord(firstCoord, secondCoord, pointCenterCoord) {\n  var nearestCoord;\n\n  if (pointCenterCoord < firstCoord) {\n    nearestCoord = firstCoord;\n  } else {\n    if (secondCoord < pointCenterCoord) {\n      nearestCoord = secondCoord;\n    } else {\n      nearestCoord = pointCenterCoord;\n    }\n  }\n\n  return nearestCoord;\n}\n\nfunction getLabelLayout(point) {\n  if (point._label.isVisible() && \"inside\" !== point._label.getLayoutOptions().position) {\n    return point._label.getBoundingRect();\n  }\n}\n\nfunction getPieRadius(series, paneCenterX, paneCenterY, accessibleRadius, minR) {\n  series.some(function (singleSeries) {\n    return singleSeries.getVisiblePoints().reduce(function (radiusIsFound, point) {\n      var labelBBox = getLabelLayout(point);\n\n      if (labelBBox) {\n        var xCoords = getNearestCoord(labelBBox.x, labelBBox.x + labelBBox.width, paneCenterX);\n        var yCoords = getNearestCoord(labelBBox.y, labelBBox.y + labelBBox.height, paneCenterY);\n        accessibleRadius = _min(_max(getLengthFromCenter(xCoords, yCoords, paneCenterX, paneCenterY) - RADIAL_LABEL_INDENT, minR), accessibleRadius);\n        radiusIsFound = true;\n      }\n\n      return radiusIsFound;\n    }, false);\n  });\n  return accessibleRadius;\n}\n\nfunction getSizeLabels(series) {\n  return series.reduce(function (res, singleSeries) {\n    var maxWidth = singleSeries.getVisiblePoints().reduce(function (width, point) {\n      var labelBBox = getLabelLayout(point);\n\n      if (labelBBox && labelBBox.width > width) {\n        width = labelBBox.width;\n      }\n\n      return width;\n    }, 0);\n    var rWidth = maxWidth;\n\n    if (maxWidth) {\n      res.outerLabelsCount++;\n\n      if (res.outerLabelsCount > 1) {\n        maxWidth += consts.pieLabelSpacing;\n      }\n\n      rWidth += consts.pieLabelSpacing;\n    }\n\n    res.sizes.push(maxWidth);\n    res.rSizes.push(rWidth);\n    res.common += maxWidth;\n    return res;\n  }, {\n    sizes: [],\n    rSizes: [],\n    common: 0,\n    outerLabelsCount: 0\n  });\n}\n\nfunction correctLabelRadius(labelSizes, radius, series, canvas, averageWidthLabels, centerX) {\n  var curRadius;\n  var i;\n  var runningWidth = 0;\n  var sizes = labelSizes.sizes;\n  var rSizes = labelSizes.rSizes;\n\n  for (i = 0; i < series.length; i++) {\n    if (0 === sizes[i]) {\n      curRadius && (curRadius += rSizes[i - 1]);\n      continue;\n    }\n\n    curRadius = _floor(curRadius ? curRadius + rSizes[i - 1] : radius);\n    series[i].correctLabelRadius(curRadius);\n    runningWidth += averageWidthLabels || sizes[i];\n    rSizes[i] = averageWidthLabels || rSizes[i];\n    series[i].setVisibleArea({\n      left: _floor(centerX - radius - runningWidth),\n      right: _floor(canvas.width - (centerX + radius + runningWidth)),\n      top: canvas.top,\n      bottom: canvas.bottom,\n      width: canvas.width,\n      height: canvas.height\n    });\n  }\n}\n\nfunction getLengthFromCenter(x, y, paneCenterX, paneCenterY) {\n  return _sqrt((x - paneCenterX) * (x - paneCenterX) + (y - paneCenterY) * (y - paneCenterY));\n}\n\nfunction getInnerRadius(series) {\n  var innerRadius;\n\n  if (\"pie\" === series.type) {\n    innerRadius = 0;\n  } else {\n    innerRadius = _isNumber(series.innerRadius) ? Number(series.innerRadius) : .5;\n    innerRadius = innerRadius < .2 ? .2 : innerRadius;\n    innerRadius = innerRadius > .8 ? .8 : innerRadius;\n  }\n\n  return innerRadius;\n}\n\nvar inverseAlign = {\n  left: \"right\",\n  right: \"left\",\n  top: \"bottom\",\n  bottom: \"top\",\n  center: \"center\"\n};\n\nfunction downSize(canvas, layoutOptions) {\n  canvas[layoutOptions.cutLayoutSide] += \"horizontal\" === layoutOptions.cutSide ? layoutOptions.width : layoutOptions.height;\n}\n\nfunction getOffset(layoutOptions, offsets) {\n  var side = layoutOptions.cutLayoutSide;\n  var offset = {\n    horizontal: 0,\n    vertical: 0\n  };\n\n  switch (side) {\n    case \"top\":\n    case \"left\":\n      offset[layoutOptions.cutSide] = -offsets[side];\n      break;\n\n    case \"bottom\":\n    case \"right\":\n      offset[layoutOptions.cutSide] = offsets[side];\n  }\n\n  return offset;\n}\n\nfunction LayoutManager() {}\n\nfunction toLayoutElementCoords(canvas) {\n  return new layoutElementModule.WrapperLayoutElement(null, {\n    x: canvas.left,\n    y: canvas.top,\n    width: canvas.width - canvas.left - canvas.right,\n    height: canvas.height - canvas.top - canvas.bottom\n  });\n}\n\nfunction getAverageLabelWidth(centerX, radius, canvas, sizeLabels) {\n  return (centerX - radius - RADIAL_LABEL_INDENT - canvas.left) / sizeLabels.outerLabelsCount;\n}\n\nfunction getFullRadiusWithLabels(centerX, canvas, sizeLabels) {\n  return centerX - canvas.left - (sizeLabels.outerLabelsCount > 0 ? sizeLabels.common + RADIAL_LABEL_INDENT : 0);\n}\n\nfunction correctAvailableRadius(availableRadius, canvas, series, minR, paneCenterX, paneCenterY) {\n  var sizeLabels = getSizeLabels(series);\n  var averageWidthLabels;\n  var fullRadiusWithLabels = getFullRadiusWithLabels(paneCenterX, canvas, sizeLabels);\n\n  if (fullRadiusWithLabels < minR) {\n    availableRadius = minR;\n    averageWidthLabels = getAverageLabelWidth(paneCenterX, availableRadius, canvas, sizeLabels);\n  } else {\n    availableRadius = _min(getPieRadius(series, paneCenterX, paneCenterY, availableRadius, minR), fullRadiusWithLabels);\n  }\n\n  correctLabelRadius(sizeLabels, availableRadius + RADIAL_LABEL_INDENT, series, canvas, averageWidthLabels, paneCenterX);\n  return availableRadius;\n}\n\nLayoutManager.prototype = {\n  constructor: LayoutManager,\n  setOptions: function setOptions(options) {\n    this._options = options;\n  },\n  applyPieChartSeriesLayout: function applyPieChartSeriesLayout(canvas, series, hideLayoutLabels) {\n    var paneSpaceHeight = canvas.height - canvas.top - canvas.bottom;\n    var paneSpaceWidth = canvas.width - canvas.left - canvas.right;\n    var paneCenterX = paneSpaceWidth / 2 + canvas.left;\n    var paneCenterY = paneSpaceHeight / 2 + canvas.top;\n    var piePercentage = this._options.piePercentage;\n    var availableRadius;\n    var minR;\n\n    if (_isNumber(piePercentage)) {\n      availableRadius = minR = piePercentage * _min(canvas.height, canvas.width) / 2;\n    } else {\n      availableRadius = _min(paneSpaceWidth, paneSpaceHeight) / 2;\n      minR = this._options.minPiePercentage * availableRadius;\n    }\n\n    if (!hideLayoutLabels) {\n      availableRadius = correctAvailableRadius(availableRadius, canvas, series, minR, paneCenterX, paneCenterY);\n    }\n\n    return {\n      centerX: _floor(paneCenterX),\n      centerY: _floor(paneCenterY),\n      radiusInner: _floor(availableRadius * getInnerRadius(series[0])),\n      radiusOuter: _floor(availableRadius)\n    };\n  },\n  applyEqualPieChartLayout: function applyEqualPieChartLayout(series, layout) {\n    var radius = layout.radius;\n    return {\n      centerX: _floor(layout.x),\n      centerY: _floor(layout.y),\n      radiusInner: _floor(radius * getInnerRadius(series[0])),\n      radiusOuter: _floor(radius)\n    };\n  },\n  correctPieLabelRadius: function correctPieLabelRadius(series, layout, canvas) {\n    var sizeLabels = getSizeLabels(series);\n    var averageWidthLabels;\n    var radius = layout.radiusOuter + RADIAL_LABEL_INDENT;\n    var availableLabelWidth = layout.centerX - canvas.left - radius;\n\n    if (sizeLabels.common + RADIAL_LABEL_INDENT > availableLabelWidth) {\n      averageWidthLabels = getAverageLabelWidth(layout.centerX, layout.radiusOuter, canvas, sizeLabels);\n    }\n\n    correctLabelRadius(sizeLabels, radius, series, canvas, averageWidthLabels, layout.centerX);\n  },\n  needMoreSpaceForPanesCanvas: function needMoreSpaceForPanesCanvas(panes, rotated, fixedSizeCallback) {\n    var options = this._options;\n    var width = options.width;\n    var height = options.height;\n    var piePercentage = options.piePercentage;\n\n    var percentageIsValid = _isNumber(piePercentage);\n\n    var needHorizontalSpace = 0;\n    var needVerticalSpace = 0;\n    panes.forEach(function (pane) {\n      var paneCanvas = pane.canvas;\n      var minSize = percentageIsValid ? _min(paneCanvas.width, paneCanvas.height) * piePercentage : void 0;\n      var paneSized = fixedSizeCallback ? fixedSizeCallback(pane) : {\n        width: false,\n        height: false\n      };\n      var needPaneHorizontalSpace = !paneSized.width ? (percentageIsValid ? minSize : width) - (paneCanvas.width - paneCanvas.left - paneCanvas.right) : 0;\n      var needPaneVerticalSpace = !paneSized.height ? (percentageIsValid ? minSize : height) - (paneCanvas.height - paneCanvas.top - paneCanvas.bottom) : 0;\n\n      if (rotated) {\n        needHorizontalSpace += needPaneHorizontalSpace > 0 ? needPaneHorizontalSpace : 0;\n        needVerticalSpace = _max(needPaneVerticalSpace > 0 ? needPaneVerticalSpace : 0, needVerticalSpace);\n      } else {\n        needHorizontalSpace = _max(needPaneHorizontalSpace > 0 ? needPaneHorizontalSpace : 0, needHorizontalSpace);\n        needVerticalSpace += needPaneVerticalSpace > 0 ? needPaneVerticalSpace : 0;\n      }\n    });\n    return needHorizontalSpace > 0 || needVerticalSpace > 0 ? {\n      width: needHorizontalSpace,\n      height: needVerticalSpace\n    } : false;\n  },\n  layoutElements: function layoutElements(elements, canvas, funcAxisDrawer, panes, rotated) {\n    this._elements = elements;\n\n    this._probeDrawing(canvas);\n\n    this._drawElements(canvas);\n\n    funcAxisDrawer();\n\n    this._processAdaptiveLayout(panes, rotated, canvas, funcAxisDrawer);\n\n    this._positionElements(canvas);\n  },\n  _processAdaptiveLayout: function _processAdaptiveLayout(panes, rotated, canvas, funcAxisDrawer) {\n    var that = this;\n    var size = that.needMoreSpaceForPanesCanvas(panes, rotated);\n    var items = this._elements;\n\n    if (!size) {\n      return;\n    }\n\n    function processCanvases(item, layoutOptions, side) {\n      if (!item.getLayoutOptions()[side]) {\n        canvas[layoutOptions.cutLayoutSide] -= layoutOptions[side];\n        size[side] = size[side] - layoutOptions[side];\n      }\n    }\n\n    items.slice().reverse().forEach(function (item) {\n      var layoutOptions = item.getLayoutOptions();\n      var needRedraw = false;\n      var sizeObject;\n      var cutSide;\n\n      if (!layoutOptions) {\n        return;\n      }\n\n      sizeObject = extend({}, layoutOptions);\n      needRedraw = \"vertical\" === layoutOptions.cutSide && size.width < 0 || \"horizontal\" === layoutOptions.cutSide && size.height < 0 || \"vertical\" === layoutOptions.cutSide && size.height > 0 || \"horizontal\" === layoutOptions.cutSide && size.width > 0;\n      cutSide = \"horizontal\" === layoutOptions.cutSide ? \"width\" : \"height\";\n\n      if (needRedraw) {\n        var width = sizeObject.width - size.width;\n        var height = sizeObject.height - size.height;\n\n        if (\"height\" === cutSide && size.width < 0) {\n          width = canvas.width - canvas.left - canvas.right;\n        }\n\n        if (\"width\" === cutSide && size.height < 0) {\n          height = canvas.height - canvas.top - canvas.bottom;\n        }\n\n        item.draw(width, height);\n      }\n\n      processCanvases(item, layoutOptions, cutSide);\n    });\n    funcAxisDrawer(size);\n  },\n  _probeDrawing: function _probeDrawing(canvas) {\n    var that = this;\n\n    this._elements.forEach(function (item) {\n      var layoutOptions = item.getLayoutOptions();\n      var sizeObject;\n\n      if (!layoutOptions) {\n        return;\n      }\n\n      sizeObject = {\n        width: canvas.width - canvas.left - canvas.right,\n        height: canvas.height - canvas.top - canvas.bottom\n      };\n\n      if (\"vertical\" === layoutOptions.cutSide) {\n        sizeObject.height -= that._options.height;\n      } else {\n        sizeObject.width -= that._options.width;\n      }\n\n      item.probeDraw(sizeObject.width, sizeObject.height);\n      downSize(canvas, item.getLayoutOptions());\n    });\n  },\n  _drawElements: function _drawElements(canvas) {\n    this._elements.slice().reverse().forEach(function (item) {\n      var layoutOptions = item.getLayoutOptions();\n      var sizeObject;\n      var cutSide;\n      var length;\n\n      if (!layoutOptions) {\n        return;\n      }\n\n      sizeObject = {\n        width: canvas.width - canvas.left - canvas.right,\n        height: canvas.height - canvas.top - canvas.bottom\n      };\n      cutSide = layoutOptions.cutSide;\n      length = \"horizontal\" === cutSide ? \"width\" : \"height\";\n      sizeObject[length] = layoutOptions[length];\n      item.draw(sizeObject.width, sizeObject.height);\n    });\n  },\n  _positionElements: function _positionElements(canvas) {\n    var offsets = {\n      left: 0,\n      right: 0,\n      top: 0,\n      bottom: 0\n    };\n\n    this._elements.slice().reverse().forEach(function (item) {\n      var layoutOptions = item.getLayoutOptions();\n      var position;\n      var cutSide;\n      var my;\n\n      if (!layoutOptions) {\n        return;\n      }\n\n      position = layoutOptions.position;\n      cutSide = layoutOptions.cutSide;\n      my = {\n        horizontal: position.horizontal,\n        vertical: position.vertical\n      };\n      my[cutSide] = inverseAlign[my[cutSide]];\n      item.position({\n        of: toLayoutElementCoords(canvas),\n        my: my,\n        at: position,\n        offset: getOffset(layoutOptions, offsets)\n      });\n      offsets[layoutOptions.cutLayoutSide] += layoutOptions[\"horizontal\" === layoutOptions.cutSide ? \"width\" : \"height\"];\n    });\n  }\n};\nexports.LayoutManager = LayoutManager;","map":{"version":3,"sources":["C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/devextreme/viz/chart_components/layout_manager.js"],"names":["extend","require","layoutElementModule","_isNumber","_min","Math","_max","_floor","_sqrt","consts","RADIAL_LABEL_INDENT","pointCenterCoord","nearestCoord","secondCoord","point","series","labelBBox","getLabelLayout","xCoords","getNearestCoord","yCoords","accessibleRadius","getLengthFromCenter","radiusIsFound","maxWidth","width","rWidth","res","sizes","rSizes","common","outerLabelsCount","runningWidth","labelSizes","i","curRadius","averageWidthLabels","left","centerX","right","canvas","top","bottom","height","x","y","innerRadius","Number","inverseAlign","center","layoutOptions","side","offset","horizontal","vertical","offsets","sizeLabels","getSizeLabels","fullRadiusWithLabels","getFullRadiusWithLabels","availableRadius","getAverageLabelWidth","getPieRadius","correctLabelRadius","LayoutManager","constructor","setOptions","applyPieChartSeriesLayout","paneSpaceHeight","paneSpaceWidth","paneCenterX","paneCenterY","piePercentage","minR","correctAvailableRadius","centerY","radiusInner","getInnerRadius","radiusOuter","applyEqualPieChartLayout","radius","layout","correctPieLabelRadius","availableLabelWidth","needMoreSpaceForPanesCanvas","options","percentageIsValid","needHorizontalSpace","needVerticalSpace","panes","paneCanvas","pane","minSize","paneSized","fixedSizeCallback","needPaneHorizontalSpace","needPaneVerticalSpace","layoutElements","funcAxisDrawer","_processAdaptiveLayout","that","size","items","item","needRedraw","sizeObject","cutSide","processCanvases","_probeDrawing","downSize","_drawElements","length","_positionElements","position","my","of","toLayoutElementCoords","at","getOffset","exports"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (viz/chart_components/layout_manager.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar extend = require(\"../../core/utils/extend\").extend;\r\nvar layoutElementModule = require(\"../core/layout_element\");\r\nvar _isNumber = require(\"../../core/utils/type\").isNumeric;\r\nvar _min = Math.min;\r\nvar _max = Math.max;\r\nvar _floor = Math.floor;\r\nvar _sqrt = Math.sqrt;\r\nvar consts = require(\"../components/consts\");\r\nvar RADIAL_LABEL_INDENT = consts.radialLabelIndent;\r\n\r\nfunction getNearestCoord(firstCoord, secondCoord, pointCenterCoord) {\r\n    var nearestCoord;\r\n    if (pointCenterCoord < firstCoord) {\r\n        nearestCoord = firstCoord\r\n    } else {\r\n        if (secondCoord < pointCenterCoord) {\r\n            nearestCoord = secondCoord\r\n        } else {\r\n            nearestCoord = pointCenterCoord\r\n        }\r\n    }\r\n    return nearestCoord\r\n}\r\n\r\nfunction getLabelLayout(point) {\r\n    if (point._label.isVisible() && \"inside\" !== point._label.getLayoutOptions().position) {\r\n        return point._label.getBoundingRect()\r\n    }\r\n}\r\n\r\nfunction getPieRadius(series, paneCenterX, paneCenterY, accessibleRadius, minR) {\r\n    series.some(function(singleSeries) {\r\n        return singleSeries.getVisiblePoints().reduce(function(radiusIsFound, point) {\r\n            var labelBBox = getLabelLayout(point);\r\n            if (labelBBox) {\r\n                var xCoords = getNearestCoord(labelBBox.x, labelBBox.x + labelBBox.width, paneCenterX);\r\n                var yCoords = getNearestCoord(labelBBox.y, labelBBox.y + labelBBox.height, paneCenterY);\r\n                accessibleRadius = _min(_max(getLengthFromCenter(xCoords, yCoords, paneCenterX, paneCenterY) - RADIAL_LABEL_INDENT, minR), accessibleRadius);\r\n                radiusIsFound = true\r\n            }\r\n            return radiusIsFound\r\n        }, false)\r\n    });\r\n    return accessibleRadius\r\n}\r\n\r\nfunction getSizeLabels(series) {\r\n    return series.reduce(function(res, singleSeries) {\r\n        var maxWidth = singleSeries.getVisiblePoints().reduce(function(width, point) {\r\n            var labelBBox = getLabelLayout(point);\r\n            if (labelBBox && labelBBox.width > width) {\r\n                width = labelBBox.width\r\n            }\r\n            return width\r\n        }, 0);\r\n        var rWidth = maxWidth;\r\n        if (maxWidth) {\r\n            res.outerLabelsCount++;\r\n            if (res.outerLabelsCount > 1) {\r\n                maxWidth += consts.pieLabelSpacing\r\n            }\r\n            rWidth += consts.pieLabelSpacing\r\n        }\r\n        res.sizes.push(maxWidth);\r\n        res.rSizes.push(rWidth);\r\n        res.common += maxWidth;\r\n        return res\r\n    }, {\r\n        sizes: [],\r\n        rSizes: [],\r\n        common: 0,\r\n        outerLabelsCount: 0\r\n    })\r\n}\r\n\r\nfunction correctLabelRadius(labelSizes, radius, series, canvas, averageWidthLabels, centerX) {\r\n    var curRadius;\r\n    var i;\r\n    var runningWidth = 0;\r\n    var sizes = labelSizes.sizes;\r\n    var rSizes = labelSizes.rSizes;\r\n    for (i = 0; i < series.length; i++) {\r\n        if (0 === sizes[i]) {\r\n            curRadius && (curRadius += rSizes[i - 1]);\r\n            continue\r\n        }\r\n        curRadius = _floor(curRadius ? curRadius + rSizes[i - 1] : radius);\r\n        series[i].correctLabelRadius(curRadius);\r\n        runningWidth += averageWidthLabels || sizes[i];\r\n        rSizes[i] = averageWidthLabels || rSizes[i];\r\n        series[i].setVisibleArea({\r\n            left: _floor(centerX - radius - runningWidth),\r\n            right: _floor(canvas.width - (centerX + radius + runningWidth)),\r\n            top: canvas.top,\r\n            bottom: canvas.bottom,\r\n            width: canvas.width,\r\n            height: canvas.height\r\n        })\r\n    }\r\n}\r\n\r\nfunction getLengthFromCenter(x, y, paneCenterX, paneCenterY) {\r\n    return _sqrt((x - paneCenterX) * (x - paneCenterX) + (y - paneCenterY) * (y - paneCenterY))\r\n}\r\n\r\nfunction getInnerRadius(series) {\r\n    var innerRadius;\r\n    if (\"pie\" === series.type) {\r\n        innerRadius = 0\r\n    } else {\r\n        innerRadius = _isNumber(series.innerRadius) ? Number(series.innerRadius) : .5;\r\n        innerRadius = innerRadius < .2 ? .2 : innerRadius;\r\n        innerRadius = innerRadius > .8 ? .8 : innerRadius\r\n    }\r\n    return innerRadius\r\n}\r\nvar inverseAlign = {\r\n    left: \"right\",\r\n    right: \"left\",\r\n    top: \"bottom\",\r\n    bottom: \"top\",\r\n    center: \"center\"\r\n};\r\n\r\nfunction downSize(canvas, layoutOptions) {\r\n    canvas[layoutOptions.cutLayoutSide] += \"horizontal\" === layoutOptions.cutSide ? layoutOptions.width : layoutOptions.height\r\n}\r\n\r\nfunction getOffset(layoutOptions, offsets) {\r\n    var side = layoutOptions.cutLayoutSide;\r\n    var offset = {\r\n        horizontal: 0,\r\n        vertical: 0\r\n    };\r\n    switch (side) {\r\n        case \"top\":\r\n        case \"left\":\r\n            offset[layoutOptions.cutSide] = -offsets[side];\r\n            break;\r\n        case \"bottom\":\r\n        case \"right\":\r\n            offset[layoutOptions.cutSide] = offsets[side]\r\n    }\r\n    return offset\r\n}\r\n\r\nfunction LayoutManager() {}\r\n\r\nfunction toLayoutElementCoords(canvas) {\r\n    return new layoutElementModule.WrapperLayoutElement(null, {\r\n        x: canvas.left,\r\n        y: canvas.top,\r\n        width: canvas.width - canvas.left - canvas.right,\r\n        height: canvas.height - canvas.top - canvas.bottom\r\n    })\r\n}\r\n\r\nfunction getAverageLabelWidth(centerX, radius, canvas, sizeLabels) {\r\n    return (centerX - radius - RADIAL_LABEL_INDENT - canvas.left) / sizeLabels.outerLabelsCount\r\n}\r\n\r\nfunction getFullRadiusWithLabels(centerX, canvas, sizeLabels) {\r\n    return centerX - canvas.left - (sizeLabels.outerLabelsCount > 0 ? sizeLabels.common + RADIAL_LABEL_INDENT : 0)\r\n}\r\n\r\nfunction correctAvailableRadius(availableRadius, canvas, series, minR, paneCenterX, paneCenterY) {\r\n    var sizeLabels = getSizeLabels(series);\r\n    var averageWidthLabels;\r\n    var fullRadiusWithLabels = getFullRadiusWithLabels(paneCenterX, canvas, sizeLabels);\r\n    if (fullRadiusWithLabels < minR) {\r\n        availableRadius = minR;\r\n        averageWidthLabels = getAverageLabelWidth(paneCenterX, availableRadius, canvas, sizeLabels)\r\n    } else {\r\n        availableRadius = _min(getPieRadius(series, paneCenterX, paneCenterY, availableRadius, minR), fullRadiusWithLabels)\r\n    }\r\n    correctLabelRadius(sizeLabels, availableRadius + RADIAL_LABEL_INDENT, series, canvas, averageWidthLabels, paneCenterX);\r\n    return availableRadius\r\n}\r\nLayoutManager.prototype = {\r\n    constructor: LayoutManager,\r\n    setOptions: function(options) {\r\n        this._options = options\r\n    },\r\n    applyPieChartSeriesLayout: function(canvas, series, hideLayoutLabels) {\r\n        var paneSpaceHeight = canvas.height - canvas.top - canvas.bottom;\r\n        var paneSpaceWidth = canvas.width - canvas.left - canvas.right;\r\n        var paneCenterX = paneSpaceWidth / 2 + canvas.left;\r\n        var paneCenterY = paneSpaceHeight / 2 + canvas.top;\r\n        var piePercentage = this._options.piePercentage;\r\n        var availableRadius;\r\n        var minR;\r\n        if (_isNumber(piePercentage)) {\r\n            availableRadius = minR = piePercentage * _min(canvas.height, canvas.width) / 2\r\n        } else {\r\n            availableRadius = _min(paneSpaceWidth, paneSpaceHeight) / 2;\r\n            minR = this._options.minPiePercentage * availableRadius\r\n        }\r\n        if (!hideLayoutLabels) {\r\n            availableRadius = correctAvailableRadius(availableRadius, canvas, series, minR, paneCenterX, paneCenterY)\r\n        }\r\n        return {\r\n            centerX: _floor(paneCenterX),\r\n            centerY: _floor(paneCenterY),\r\n            radiusInner: _floor(availableRadius * getInnerRadius(series[0])),\r\n            radiusOuter: _floor(availableRadius)\r\n        }\r\n    },\r\n    applyEqualPieChartLayout: function(series, layout) {\r\n        var radius = layout.radius;\r\n        return {\r\n            centerX: _floor(layout.x),\r\n            centerY: _floor(layout.y),\r\n            radiusInner: _floor(radius * getInnerRadius(series[0])),\r\n            radiusOuter: _floor(radius)\r\n        }\r\n    },\r\n    correctPieLabelRadius: function(series, layout, canvas) {\r\n        var sizeLabels = getSizeLabels(series);\r\n        var averageWidthLabels;\r\n        var radius = layout.radiusOuter + RADIAL_LABEL_INDENT;\r\n        var availableLabelWidth = layout.centerX - canvas.left - radius;\r\n        if (sizeLabels.common + RADIAL_LABEL_INDENT > availableLabelWidth) {\r\n            averageWidthLabels = getAverageLabelWidth(layout.centerX, layout.radiusOuter, canvas, sizeLabels)\r\n        }\r\n        correctLabelRadius(sizeLabels, radius, series, canvas, averageWidthLabels, layout.centerX)\r\n    },\r\n    needMoreSpaceForPanesCanvas: function(panes, rotated, fixedSizeCallback) {\r\n        var options = this._options;\r\n        var width = options.width;\r\n        var height = options.height;\r\n        var piePercentage = options.piePercentage;\r\n        var percentageIsValid = _isNumber(piePercentage);\r\n        var needHorizontalSpace = 0;\r\n        var needVerticalSpace = 0;\r\n        panes.forEach(function(pane) {\r\n            var paneCanvas = pane.canvas;\r\n            var minSize = percentageIsValid ? _min(paneCanvas.width, paneCanvas.height) * piePercentage : void 0;\r\n            var paneSized = fixedSizeCallback ? fixedSizeCallback(pane) : {\r\n                width: false,\r\n                height: false\r\n            };\r\n            var needPaneHorizontalSpace = !paneSized.width ? (percentageIsValid ? minSize : width) - (paneCanvas.width - paneCanvas.left - paneCanvas.right) : 0;\r\n            var needPaneVerticalSpace = !paneSized.height ? (percentageIsValid ? minSize : height) - (paneCanvas.height - paneCanvas.top - paneCanvas.bottom) : 0;\r\n            if (rotated) {\r\n                needHorizontalSpace += needPaneHorizontalSpace > 0 ? needPaneHorizontalSpace : 0;\r\n                needVerticalSpace = _max(needPaneVerticalSpace > 0 ? needPaneVerticalSpace : 0, needVerticalSpace)\r\n            } else {\r\n                needHorizontalSpace = _max(needPaneHorizontalSpace > 0 ? needPaneHorizontalSpace : 0, needHorizontalSpace);\r\n                needVerticalSpace += needPaneVerticalSpace > 0 ? needPaneVerticalSpace : 0\r\n            }\r\n        });\r\n        return needHorizontalSpace > 0 || needVerticalSpace > 0 ? {\r\n            width: needHorizontalSpace,\r\n            height: needVerticalSpace\r\n        } : false\r\n    },\r\n    layoutElements: function(elements, canvas, funcAxisDrawer, panes, rotated) {\r\n        this._elements = elements;\r\n        this._probeDrawing(canvas);\r\n        this._drawElements(canvas);\r\n        funcAxisDrawer();\r\n        this._processAdaptiveLayout(panes, rotated, canvas, funcAxisDrawer);\r\n        this._positionElements(canvas)\r\n    },\r\n    _processAdaptiveLayout: function(panes, rotated, canvas, funcAxisDrawer) {\r\n        var that = this;\r\n        var size = that.needMoreSpaceForPanesCanvas(panes, rotated);\r\n        var items = this._elements;\r\n        if (!size) {\r\n            return\r\n        }\r\n\r\n        function processCanvases(item, layoutOptions, side) {\r\n            if (!item.getLayoutOptions()[side]) {\r\n                canvas[layoutOptions.cutLayoutSide] -= layoutOptions[side];\r\n                size[side] = size[side] - layoutOptions[side]\r\n            }\r\n        }\r\n        items.slice().reverse().forEach(function(item) {\r\n            var layoutOptions = item.getLayoutOptions();\r\n            var needRedraw = false;\r\n            var sizeObject;\r\n            var cutSide;\r\n            if (!layoutOptions) {\r\n                return\r\n            }\r\n            sizeObject = extend({}, layoutOptions);\r\n            needRedraw = \"vertical\" === layoutOptions.cutSide && size.width < 0 || \"horizontal\" === layoutOptions.cutSide && size.height < 0 || \"vertical\" === layoutOptions.cutSide && size.height > 0 || \"horizontal\" === layoutOptions.cutSide && size.width > 0;\r\n            cutSide = \"horizontal\" === layoutOptions.cutSide ? \"width\" : \"height\";\r\n            if (needRedraw) {\r\n                var width = sizeObject.width - size.width;\r\n                var height = sizeObject.height - size.height;\r\n                if (\"height\" === cutSide && size.width < 0) {\r\n                    width = canvas.width - canvas.left - canvas.right\r\n                }\r\n                if (\"width\" === cutSide && size.height < 0) {\r\n                    height = canvas.height - canvas.top - canvas.bottom\r\n                }\r\n                item.draw(width, height)\r\n            }\r\n            processCanvases(item, layoutOptions, cutSide)\r\n        });\r\n        funcAxisDrawer(size)\r\n    },\r\n    _probeDrawing: function(canvas) {\r\n        var that = this;\r\n        this._elements.forEach(function(item) {\r\n            var layoutOptions = item.getLayoutOptions();\r\n            var sizeObject;\r\n            if (!layoutOptions) {\r\n                return\r\n            }\r\n            sizeObject = {\r\n                width: canvas.width - canvas.left - canvas.right,\r\n                height: canvas.height - canvas.top - canvas.bottom\r\n            };\r\n            if (\"vertical\" === layoutOptions.cutSide) {\r\n                sizeObject.height -= that._options.height\r\n            } else {\r\n                sizeObject.width -= that._options.width\r\n            }\r\n            item.probeDraw(sizeObject.width, sizeObject.height);\r\n            downSize(canvas, item.getLayoutOptions())\r\n        })\r\n    },\r\n    _drawElements: function(canvas) {\r\n        this._elements.slice().reverse().forEach(function(item) {\r\n            var layoutOptions = item.getLayoutOptions();\r\n            var sizeObject;\r\n            var cutSide;\r\n            var length;\r\n            if (!layoutOptions) {\r\n                return\r\n            }\r\n            sizeObject = {\r\n                width: canvas.width - canvas.left - canvas.right,\r\n                height: canvas.height - canvas.top - canvas.bottom\r\n            };\r\n            cutSide = layoutOptions.cutSide;\r\n            length = \"horizontal\" === cutSide ? \"width\" : \"height\";\r\n            sizeObject[length] = layoutOptions[length];\r\n            item.draw(sizeObject.width, sizeObject.height)\r\n        })\r\n    },\r\n    _positionElements: function(canvas) {\r\n        var offsets = {\r\n            left: 0,\r\n            right: 0,\r\n            top: 0,\r\n            bottom: 0\r\n        };\r\n        this._elements.slice().reverse().forEach(function(item) {\r\n            var layoutOptions = item.getLayoutOptions();\r\n            var position;\r\n            var cutSide;\r\n            var my;\r\n            if (!layoutOptions) {\r\n                return\r\n            }\r\n            position = layoutOptions.position;\r\n            cutSide = layoutOptions.cutSide;\r\n            my = {\r\n                horizontal: position.horizontal,\r\n                vertical: position.vertical\r\n            };\r\n            my[cutSide] = inverseAlign[my[cutSide]];\r\n            item.position({\r\n                of: toLayoutElementCoords(canvas),\r\n                my: my,\r\n                at: position,\r\n                offset: getOffset(layoutOptions, offsets)\r\n            });\r\n            offsets[layoutOptions.cutLayoutSide] += layoutOptions[\"horizontal\" === layoutOptions.cutSide ? \"width\" : \"height\"]\r\n        })\r\n    }\r\n};\r\nexports.LayoutManager = LayoutManager;\r\n"]},"metadata":{},"sourceType":"module"}