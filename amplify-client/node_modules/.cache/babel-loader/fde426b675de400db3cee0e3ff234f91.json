{"ast":null,"code":"/**\r\n * DevExtreme (ui/grid_core/ui.grid_core.selection.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar _renderer = require(\"../../core/renderer\");\n\nvar _renderer2 = _interopRequireDefault(_renderer);\n\nvar _events_engine = require(\"../../events/core/events_engine\");\n\nvar _events_engine2 = _interopRequireDefault(_events_engine);\n\nvar _uiData_grid = require(\"../data_grid/ui.data_grid.core\");\n\nvar _uiData_grid2 = _interopRequireDefault(_uiData_grid);\n\nvar _uiGrid_core = require(\"./ui.grid_core.utils\");\n\nvar _type = require(\"../../core/utils/type\");\n\nvar _iterator = require(\"../../core/utils/iterator\");\n\nvar _extend = require(\"../../core/utils/extend\");\n\nvar _support = require(\"../../core/utils/support\");\n\nvar _support2 = _interopRequireDefault(_support);\n\nvar _click = require(\"../../events/click\");\n\nvar _click2 = _interopRequireDefault(_click);\n\nvar _message = require(\"../../localization/message\");\n\nvar _message2 = _interopRequireDefault(_message);\n\nvar _utils = require(\"../../events/utils\");\n\nvar _hold = require(\"../../events/hold\");\n\nvar _hold2 = _interopRequireDefault(_hold);\n\nvar _selection = require(\"../selection/selection\");\n\nvar _selection2 = _interopRequireDefault(_selection);\n\nvar _deferred = require(\"../../core/utils/deferred\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nvar EDITOR_CELL_CLASS = \"dx-editor-cell\";\nvar ROW_CLASS = \"dx-row\";\nvar ROW_SELECTION_CLASS = \"dx-selection\";\nvar SELECT_CHECKBOX_CLASS = \"dx-select-checkbox\";\nvar CHECKBOXES_HIDDEN_CLASS = \"dx-select-checkboxes-hidden\";\nvar COMMAND_SELECT_CLASS = \"dx-command-select\";\nvar SELECTION_DISABLED_CLASS = \"dx-selection-disabled\";\nvar DATA_ROW_CLASS = \"dx-data-row\";\nvar SHOW_CHECKBOXES_MODE = \"selection.showCheckBoxesMode\";\nvar SELECTION_MODE = \"selection.mode\";\n\nvar processLongTap = function processLongTap(that, dxEvent) {\n  var selectionController = that.getController(\"selection\");\n  var rowsView = that.getView(\"rowsView\");\n  var $row = (0, _renderer2.default)(dxEvent.target).closest(\".\" + DATA_ROW_CLASS);\n  var rowIndex = rowsView.getRowIndex($row);\n\n  if (rowIndex < 0) {\n    return;\n  }\n\n  if (\"onLongTap\" === that.option(SHOW_CHECKBOXES_MODE)) {\n    if (selectionController.isSelectionWithCheckboxes()) {\n      selectionController.stopSelectionWithCheckboxes();\n    } else {\n      selectionController.startSelectionWithCheckboxes();\n    }\n  } else {\n    if (\"onClick\" === that.option(SHOW_CHECKBOXES_MODE)) {\n      selectionController.startSelectionWithCheckboxes();\n    }\n\n    if (\"always\" !== that.option(SHOW_CHECKBOXES_MODE)) {\n      selectionController.changeItemSelection(rowIndex, {\n        control: true\n      });\n    }\n  }\n};\n\nexports.SelectionController = _uiData_grid2.default.Controller.inherit(function () {\n  var isSeveralRowsSelected = function isSeveralRowsSelected(that, selectionFilter) {\n    var keyIndex = 0;\n\n    var store = that._dataController.store();\n\n    var key = store && store.key();\n    var isComplexKey = Array.isArray(key);\n\n    if (!selectionFilter.length) {\n      return false;\n    }\n\n    if (isComplexKey && Array.isArray(selectionFilter[0]) && \"and\" === selectionFilter[1]) {\n      for (var i = 0; i < selectionFilter.length; i++) {\n        if (Array.isArray(selectionFilter[i])) {\n          if (selectionFilter[i][0] !== key[keyIndex] || \"=\" !== selectionFilter[i][1]) {\n            return true;\n          }\n\n          keyIndex++;\n        }\n      }\n\n      return false;\n    }\n\n    return key !== selectionFilter[0];\n  };\n\n  var selectionCellTemplate = function selectionCellTemplate(container, options) {\n    var rowsView = options.component.getView(\"rowsView\");\n    rowsView.renderSelectCheckBoxContainer((0, _renderer2.default)(container), options);\n  };\n\n  var selectionHeaderTemplate = function selectionHeaderTemplate(container, options) {\n    var column = options.column;\n    var $cellElement = (0, _renderer2.default)(container);\n    var columnHeadersView = options.component.getView(\"columnHeadersView\");\n    $cellElement.addClass(EDITOR_CELL_CLASS);\n\n    columnHeadersView._renderSelectAllCheckBox($cellElement, column);\n\n    columnHeadersView._attachSelectAllCheckBoxClickEvent($cellElement);\n  };\n\n  return {\n    init: function init() {\n      this._dataController = this.getController(\"data\");\n      this._selectionMode = this.option(SELECTION_MODE);\n      this._isSelectionWithCheckboxes = false;\n      this._selection = this._createSelection();\n\n      this._updateSelectColumn();\n\n      this.createAction(\"onSelectionChanged\", {\n        excludeValidators: [\"disabled\", \"readOnly\"]\n      });\n    },\n    _getSelectionConfig: function _getSelectionConfig() {\n      var that = this;\n      var dataController = that._dataController;\n      var selectionOptions = that.option(\"selection\") || {};\n      return {\n        selectedKeys: that.option(\"selectedRowKeys\"),\n        mode: that._selectionMode,\n        deferred: selectionOptions.deferred,\n        maxFilterLengthInRequest: selectionOptions.maxFilterLengthInRequest,\n        selectionFilter: that.option(\"selectionFilter\"),\n        key: function key() {\n          return dataController && dataController.key();\n        },\n        keyOf: function keyOf(item) {\n          return dataController && dataController.keyOf(item);\n        },\n        dataFields: function dataFields() {\n          return dataController.dataSource() && dataController.dataSource().select();\n        },\n        load: function load(options) {\n          return dataController.dataSource() && dataController.dataSource().load(options) || new _deferred.Deferred().resolve([]);\n        },\n        plainItems: function plainItems() {\n          return dataController.items(true);\n        },\n        isItemSelected: function isItemSelected(item) {\n          return item.selected;\n        },\n        isSelectableItem: function isSelectableItem(item) {\n          return item && \"data\" === item.rowType && !item.isNewRow;\n        },\n        getItemData: function getItemData(item) {\n          return item && (item.oldData || item.data || item);\n        },\n        filter: function filter() {\n          return dataController.getCombinedFilter();\n        },\n        totalCount: function totalCount() {\n          return dataController.totalCount();\n        },\n        onSelectionChanged: that._updateSelectedItems.bind(this)\n      };\n    },\n    _updateSelectColumn: function _updateSelectColumn() {\n      var columnsController = this.getController(\"columns\");\n      var isSelectColumnVisible = this.isSelectColumnVisible();\n      columnsController.addCommandColumn({\n        type: \"selection\",\n        command: \"select\",\n        visible: isSelectColumnVisible,\n        visibleIndex: -1,\n        dataType: \"boolean\",\n        alignment: \"center\",\n        cssClass: COMMAND_SELECT_CLASS,\n        width: \"auto\",\n        cellTemplate: selectionCellTemplate,\n        headerCellTemplate: selectionHeaderTemplate\n      });\n      columnsController.columnOption(\"command:select\", \"visible\", isSelectColumnVisible);\n    },\n    _createSelection: function _createSelection() {\n      var options = this._getSelectionConfig();\n\n      return new _selection2.default(options);\n    },\n    _fireSelectionChanged: function _fireSelectionChanged(options) {\n      if (options) {\n        this.executeAction(\"onSelectionChanged\", options);\n      }\n\n      var argument = this.option(\"selection.deferred\") ? {\n        selectionFilter: this.option(\"selectionFilter\")\n      } : {\n        selectedRowKeys: this.option(\"selectedRowKeys\")\n      };\n      this.selectionChanged.fire(argument);\n    },\n    _updateCheckboxesState: function _updateCheckboxesState(options) {\n      var isDeferredMode = options.isDeferredMode;\n      var selectionFilter = options.selectionFilter;\n      var selectedItemKeys = options.selectedItemKeys;\n      var removedItemKeys = options.removedItemKeys;\n\n      if (\"onClick\" === this.option(SHOW_CHECKBOXES_MODE)) {\n        if (isDeferredMode ? selectionFilter && isSeveralRowsSelected(this, selectionFilter) : selectedItemKeys.length > 1) {\n          this.startSelectionWithCheckboxes();\n        } else {\n          if (isDeferredMode ? selectionFilter && !selectionFilter.length : 0 === selectedItemKeys.length && removedItemKeys.length) {\n            this.stopSelectionWithCheckboxes();\n          }\n        }\n      }\n    },\n    _updateSelectedItems: function _updateSelectedItems(args) {\n      var that = this;\n      var selectionChangedOptions;\n      var isDeferredMode = that.option(\"selection.deferred\");\n\n      var selectionFilter = that._selection.selectionFilter();\n\n      var dataController = that._dataController;\n      var items = dataController.items();\n\n      if (!items) {\n        return;\n      }\n\n      var isSelectionWithCheckboxes = that.isSelectionWithCheckboxes();\n      var changedItemIndexes = that.getChangedItemIndexes(items);\n\n      that._updateCheckboxesState({\n        selectedItemKeys: args.selectedItemKeys,\n        removedItemKeys: args.removedItemKeys,\n        selectionFilter: selectionFilter,\n        isDeferredMode: isDeferredMode\n      });\n\n      if (changedItemIndexes.length || isSelectionWithCheckboxes !== that.isSelectionWithCheckboxes()) {\n        dataController.updateItems({\n          changeType: \"updateSelection\",\n          itemIndexes: changedItemIndexes\n        });\n      }\n\n      if (isDeferredMode) {\n        that.option(\"selectionFilter\", selectionFilter);\n        selectionChangedOptions = {};\n      } else {\n        if (args.addedItemKeys.length || args.removedItemKeys.length) {\n          that._selectedItemsInternalChange = true;\n          that.option(\"selectedRowKeys\", args.selectedItemKeys.slice(0));\n          that._selectedItemsInternalChange = false;\n          selectionChangedOptions = {\n            selectedRowsData: args.selectedItems.slice(0),\n            selectedRowKeys: args.selectedItemKeys.slice(0),\n            currentSelectedRowKeys: args.addedItemKeys.slice(0),\n            currentDeselectedRowKeys: args.removedItemKeys.slice(0)\n          };\n        }\n      }\n\n      that._fireSelectionChanged(selectionChangedOptions);\n    },\n    getChangedItemIndexes: function getChangedItemIndexes(items) {\n      var that = this;\n      var itemIndexes = [];\n      var isDeferredSelection = this.option(\"selection.deferred\");\n\n      for (var i = 0, length = items.length; i < length; i++) {\n        var row = items[i];\n        var isItemSelected = that.isRowSelected(isDeferredSelection ? row.data : row.key);\n\n        if (that._selection.isDataItem(row) && row.isSelected !== isItemSelected) {\n          itemIndexes.push(i);\n        }\n      }\n\n      return itemIndexes;\n    },\n    callbackNames: function callbackNames() {\n      return [\"selectionChanged\"];\n    },\n    optionChanged: function optionChanged(args) {\n      var that = this;\n      that.callBase(args);\n\n      switch (args.name) {\n        case \"selection\":\n          var oldSelectionMode = that._selectionMode;\n          that.init();\n          var selectionMode = that._selectionMode;\n          var selectedRowKeys = that.option(\"selectedRowKeys\");\n\n          if (oldSelectionMode !== selectionMode) {\n            if (\"single\" === selectionMode) {\n              if (selectedRowKeys.length > 1) {\n                selectedRowKeys = [selectedRowKeys[0]];\n              }\n            } else {\n              if (\"multiple\" !== selectionMode) {\n                selectedRowKeys = [];\n              }\n            }\n          }\n\n          that.selectRows(selectedRowKeys).always(function () {\n            that._fireSelectionChanged();\n          });\n          that.getController(\"columns\").updateColumns();\n          args.handled = true;\n          break;\n\n        case \"selectionFilter\":\n          this._selection.selectionFilter(args.value);\n\n          args.handled = true;\n          break;\n\n        case \"selectedRowKeys\":\n          var value = args.value || [];\n\n          if (Array.isArray(value) && !that._selectedItemsInternalChange && (that.component.getDataSource() || !value.length)) {\n            that.selectRows(value);\n          }\n\n          args.handled = true;\n      }\n    },\n    publicMethods: function publicMethods() {\n      return [\"selectRows\", \"deselectRows\", \"selectRowsByIndexes\", \"getSelectedRowKeys\", \"getSelectedRowsData\", \"clearSelection\", \"selectAll\", \"deselectAll\", \"startSelectionWithCheckboxes\", \"stopSelectionWithCheckboxes\", \"isRowSelected\"];\n    },\n    isRowSelected: function isRowSelected(arg) {\n      return this._selection.isItemSelected(arg);\n    },\n    isSelectColumnVisible: function isSelectColumnVisible() {\n      return \"multiple\" === this.option(SELECTION_MODE) && (\"always\" === this.option(SHOW_CHECKBOXES_MODE) || \"onClick\" === this.option(SHOW_CHECKBOXES_MODE) || this._isSelectionWithCheckboxes);\n    },\n    _isOnePageSelectAll: function _isOnePageSelectAll() {\n      return \"page\" === this.option(\"selection.selectAllMode\");\n    },\n    isSelectAll: function isSelectAll() {\n      return this._selection.getSelectAllState(this._isOnePageSelectAll());\n    },\n    selectAll: function selectAll() {\n      if (\"onClick\" === this.option(SHOW_CHECKBOXES_MODE)) {\n        this.startSelectionWithCheckboxes();\n      }\n\n      return this._selection.selectAll(this._isOnePageSelectAll());\n    },\n    deselectAll: function deselectAll() {\n      return this._selection.deselectAll(this._isOnePageSelectAll());\n    },\n    clearSelection: function clearSelection() {\n      return this.selectedItemKeys([]);\n    },\n    refresh: function refresh() {\n      var selectedRowKeys = this.option(\"selectedRowKeys\") || [];\n\n      if (!this.option(\"selection.deferred\") && selectedRowKeys.length) {\n        return this.selectedItemKeys(selectedRowKeys);\n      }\n\n      return new _deferred.Deferred().resolve().promise();\n    },\n    selectedItemKeys: function selectedItemKeys(value, preserve, isDeselect, isSelectAll) {\n      return this._selection.selectedItemKeys(value, preserve, isDeselect, isSelectAll);\n    },\n    getSelectedRowKeys: function getSelectedRowKeys() {\n      return this._selection.getSelectedItemKeys();\n    },\n    selectRows: function selectRows(keys, preserve) {\n      return this.selectedItemKeys(keys, preserve);\n    },\n    deselectRows: function deselectRows(keys) {\n      return this.selectedItemKeys(keys, true, true);\n    },\n    selectRowsByIndexes: function selectRowsByIndexes(indexes) {\n      var items = this._dataController.items();\n\n      var keys = [];\n\n      if (!Array.isArray(indexes)) {\n        indexes = Array.prototype.slice.call(arguments, 0);\n      }\n\n      (0, _iterator.each)(indexes, function () {\n        var item = items[this];\n\n        if (item && \"data\" === item.rowType) {\n          keys.push(item.key);\n        }\n      });\n      return this.selectRows(keys);\n    },\n    getSelectedRowsData: function getSelectedRowsData() {\n      return this._selection.getSelectedItems();\n    },\n    changeItemSelection: function changeItemSelection(itemIndex, keys) {\n      keys = keys || {};\n\n      if (this.isSelectionWithCheckboxes()) {\n        keys.control = true;\n      }\n\n      return this._selection.changeItemSelection(this._dataController.getRowIndexDelta() + itemIndex, keys);\n    },\n    focusedItemIndex: function focusedItemIndex(itemIndex) {\n      var that = this;\n\n      if ((0, _type.isDefined)(itemIndex)) {\n        that._selection._focusedItemIndex = itemIndex;\n      } else {\n        return that._selection._focusedItemIndex;\n      }\n    },\n    isSelectionWithCheckboxes: function isSelectionWithCheckboxes() {\n      return \"multiple\" === this.option(SELECTION_MODE) && (\"always\" === this.option(SHOW_CHECKBOXES_MODE) || this._isSelectionWithCheckboxes);\n    },\n    startSelectionWithCheckboxes: function startSelectionWithCheckboxes() {\n      var that = this;\n\n      if (\"multiple\" === that.option(SELECTION_MODE) && !that.isSelectionWithCheckboxes()) {\n        that._isSelectionWithCheckboxes = true;\n\n        that._updateSelectColumn();\n\n        return true;\n      }\n\n      return false;\n    },\n    stopSelectionWithCheckboxes: function stopSelectionWithCheckboxes() {\n      var that = this;\n\n      if (that._isSelectionWithCheckboxes) {\n        that._isSelectionWithCheckboxes = false;\n\n        that._updateSelectColumn();\n\n        return true;\n      }\n\n      return false;\n    }\n  };\n}());\nmodule.exports = {\n  defaultOptions: function defaultOptions() {\n    return {\n      selection: {\n        mode: \"none\",\n        showCheckBoxesMode: \"onClick\",\n        allowSelectAll: true,\n        selectAllMode: \"allPages\",\n        maxFilterLengthInRequest: 1500,\n        deferred: false\n      },\n      selectionFilter: [],\n      selectedRowKeys: []\n    };\n  },\n  controllers: {\n    selection: exports.SelectionController\n  },\n  extenders: {\n    controllers: {\n      data: {\n        init: function init() {\n          var selectionController = this.getController(\"selection\");\n          var isDeferredMode = this.option(\"selection.deferred\");\n          this.callBase.apply(this, arguments);\n\n          if (isDeferredMode) {\n            selectionController._updateCheckboxesState({\n              isDeferredMode: true,\n              selectionFilter: this.option(\"selectionFilter\")\n            });\n          }\n        },\n        _loadDataSource: function _loadDataSource() {\n          var that = this;\n          return that.callBase().done(function () {\n            that.getController(\"selection\").refresh();\n          });\n        },\n        _processDataItem: function _processDataItem(item, options) {\n          var that = this;\n          var selectionController = that.getController(\"selection\");\n          var hasSelectColumn = selectionController.isSelectColumnVisible();\n          var isDeferredSelection = options.isDeferredSelection = void 0 === options.isDeferredSelection ? this.option(\"selection.deferred\") : options.isDeferredSelection;\n          var dataItem = this.callBase.apply(this, arguments);\n          dataItem.isSelected = selectionController.isRowSelected(isDeferredSelection ? dataItem.data : dataItem.key);\n\n          if (hasSelectColumn && dataItem.values) {\n            for (var i = 0; i < options.visibleColumns.length; i++) {\n              if (\"select\" === options.visibleColumns[i].command) {\n                dataItem.values[i] = dataItem.isSelected;\n                break;\n              }\n            }\n          }\n\n          return dataItem;\n        },\n        refresh: function refresh(options) {\n          var that = this;\n          var d = new _deferred.Deferred();\n          this.callBase.apply(this, arguments).done(function () {\n            if (!options || options.selection) {\n              that.getController(\"selection\").refresh().done(d.resolve).fail(d.reject);\n            } else {\n              d.resolve();\n            }\n          }).fail(d.reject);\n          return d.promise();\n        },\n        _handleDataChanged: function _handleDataChanged(e) {\n          this.callBase.apply(this, arguments);\n\n          if ((!e || \"refresh\" === e.changeType) && !this._repaintChangesOnly) {\n            this.getController(\"selection\").focusedItemIndex(-1);\n          }\n        },\n        _applyChange: function _applyChange(change) {\n          var _this = this;\n\n          if (change && \"updateSelection\" === change.changeType) {\n            change.items.forEach(function (item, index) {\n              var currentItem = _this._items[index];\n\n              if (currentItem) {\n                currentItem.isSelected = item.isSelected;\n                currentItem.values = item.values;\n              }\n            });\n            return;\n          }\n\n          return this.callBase.apply(this, arguments);\n        },\n        _endUpdateCore: function _endUpdateCore() {\n          var changes = this._changes;\n          var isUpdateSelection = changes.length > 1 && changes.every(function (change) {\n            return \"updateSelection\" === change.changeType;\n          });\n\n          if (isUpdateSelection) {\n            var itemIndexes = changes.map(function (change) {\n              return change.itemIndexes || [];\n            }).reduce(function (a, b) {\n              return a.concat(b);\n            });\n            this._changes = [{\n              changeType: \"updateSelection\",\n              itemIndexes: itemIndexes\n            }];\n          }\n\n          this.callBase.apply(this, arguments);\n        }\n      },\n      contextMenu: {\n        _contextMenuPrepared: function _contextMenuPrepared(options) {\n          var dxEvent = options.event;\n\n          if (dxEvent.originalEvent && \"dxhold\" !== dxEvent.originalEvent.type || options.items && options.items.length > 0) {\n            return;\n          }\n\n          processLongTap(this, dxEvent);\n        }\n      }\n    },\n    views: {\n      columnHeadersView: {\n        init: function init() {\n          var that = this;\n          that.callBase();\n          that.getController(\"selection\").selectionChanged.add(that._updateSelectAllValue.bind(that));\n        },\n        _updateSelectAllValue: function _updateSelectAllValue() {\n          var that = this;\n          var $element = that.element();\n          var $editor = $element && $element.find(\".\" + SELECT_CHECKBOX_CLASS);\n\n          if ($element && $editor.length && \"multiple\" === that.option(\"selection.mode\")) {\n            $editor.dxCheckBox(\"instance\").option(\"value\", that.getController(\"selection\").isSelectAll());\n          }\n        },\n        _handleDataChanged: function _handleDataChanged(e) {\n          this.callBase(e);\n\n          if (!e || \"refresh\" === e.changeType) {\n            this._updateSelectAllValue();\n          }\n        },\n        _renderSelectAllCheckBox: function _renderSelectAllCheckBox($container, column) {\n          var that = this;\n          var groupElement;\n          var selectionController = that.getController(\"selection\");\n          groupElement = (0, _renderer2.default)(\"<div>\").appendTo($container).addClass(SELECT_CHECKBOX_CLASS);\n          that.setAria(\"label\", _message2.default.format(\"dxDataGrid-ariaSelectAll\"), $container);\n          that.getController(\"editorFactory\").createEditor(groupElement, (0, _extend.extend)({}, column, {\n            parentType: \"headerRow\",\n            dataType: \"boolean\",\n            value: selectionController.isSelectAll(),\n            editorOptions: {\n              visible: that.option(\"selection.allowSelectAll\") || false !== selectionController.isSelectAll()\n            },\n            tabIndex: that.option(\"useLegacyKeyboardNavigation\") ? -1 : that.option(\"tabIndex\") || 0,\n            setValue: function setValue(value, e) {\n              var allowSelectAll = that.option(\"selection.allowSelectAll\");\n              e.component.option(\"visible\", allowSelectAll || false !== e.component.option(\"value\"));\n\n              if (!e.event || selectionController.isSelectAll() === value) {\n                return;\n              }\n\n              if (e.value && !allowSelectAll) {\n                e.component.option(\"value\", false);\n              } else {\n                e.value ? selectionController.selectAll() : selectionController.deselectAll();\n              }\n\n              e.event.preventDefault();\n            }\n          }));\n          return groupElement;\n        },\n        _attachSelectAllCheckBoxClickEvent: function _attachSelectAllCheckBoxClickEvent($element) {\n          _events_engine2.default.on($element, _click2.default.name, this.createAction(function (e) {\n            var event = e.event;\n\n            if (!(0, _renderer2.default)(event.target).closest(\".\" + SELECT_CHECKBOX_CLASS).length) {\n              _events_engine2.default.trigger((0, _renderer2.default)(event.currentTarget).children(\".\" + SELECT_CHECKBOX_CLASS), _click2.default.name);\n            }\n\n            event.preventDefault();\n          }));\n        }\n      },\n      rowsView: {\n        renderSelectCheckBoxContainer: function renderSelectCheckBoxContainer($container, options) {\n          if (\"data\" === options.rowType && !options.row.isNewRow) {\n            $container.addClass(EDITOR_CELL_CLASS);\n\n            this._attachCheckBoxClickEvent($container);\n\n            this.setAria(\"label\", _message2.default.format(\"dxDataGrid-ariaSelectRow\"), $container);\n\n            this._renderSelectCheckBox($container, options);\n          } else {\n            (0, _uiGrid_core.setEmptyText)($container);\n          }\n        },\n        _renderSelectCheckBox: function _renderSelectCheckBox(container, options) {\n          var groupElement = (0, _renderer2.default)(\"<div>\").addClass(SELECT_CHECKBOX_CLASS).appendTo(container);\n          this.getController(\"editorFactory\").createEditor(groupElement, (0, _extend.extend)({}, options.column, {\n            parentType: \"dataRow\",\n            dataType: \"boolean\",\n            lookup: null,\n            value: options.value,\n            tabIndex: -1,\n            setValue: function setValue(value, e) {\n              if (e && e.event && \"keydown\" === e.event.type) {\n                _events_engine2.default.trigger(container, _click2.default.name, e);\n              }\n            },\n            row: options.row\n          }));\n          return groupElement;\n        },\n        _attachCheckBoxClickEvent: function _attachCheckBoxClickEvent($element) {\n          _events_engine2.default.on($element, _click2.default.name, this.createAction(function (e) {\n            var selectionController = this.getController(\"selection\");\n            var event = e.event;\n            var rowIndex = this.getRowIndex((0, _renderer2.default)(event.currentTarget).closest(\".\" + ROW_CLASS));\n\n            if (rowIndex >= 0) {\n              selectionController.startSelectionWithCheckboxes();\n              selectionController.changeItemSelection(rowIndex, {\n                shift: event.shiftKey\n              });\n\n              if ((0, _renderer2.default)(event.target).closest(\".\" + SELECT_CHECKBOX_CLASS).length) {\n                this.getController(\"data\").updateItems({\n                  changeType: \"updateSelection\",\n                  itemIndexes: [rowIndex]\n                });\n              }\n            }\n          }));\n        },\n        _update: function _update(change) {\n          var that = this;\n          var tableElements = that.getTableElements();\n\n          if (\"updateSelection\" === change.changeType) {\n            if (tableElements.length > 0) {\n              (0, _iterator.each)(tableElements, function (_, tableElement) {\n                (0, _iterator.each)(change.itemIndexes || [], function (_, index) {\n                  var $row;\n                  var isSelected;\n\n                  if (change.items[index]) {\n                    $row = that._getRowElements((0, _renderer2.default)(tableElement)).eq(index);\n\n                    if ($row.length) {\n                      isSelected = change.items[index].isSelected;\n                      $row.toggleClass(ROW_SELECTION_CLASS, void 0 === isSelected ? false : isSelected).find(\".\" + SELECT_CHECKBOX_CLASS).dxCheckBox(\"option\", \"value\", isSelected);\n                      that.setAria(\"selected\", isSelected, $row);\n                    }\n                  }\n                });\n              });\n\n              that._updateCheckboxesClass();\n            }\n          } else {\n            that.callBase(change);\n          }\n        },\n        _createTable: function _createTable() {\n          var that = this;\n          var selectionMode = that.option(\"selection.mode\");\n          var $table = that.callBase.apply(that, arguments);\n\n          if (\"none\" !== selectionMode) {\n            if (\"onLongTap\" === that.option(SHOW_CHECKBOXES_MODE) || !_support2.default.touch) {\n              _events_engine2.default.on($table, (0, _utils.addNamespace)(_hold2.default.name, \"dxDataGridRowsView\"), \".\" + DATA_ROW_CLASS, that.createAction(function (e) {\n                processLongTap(that.component, e.event);\n                e.event.stopPropagation();\n              }));\n            }\n\n            _events_engine2.default.on($table, \"mousedown selectstart\", that.createAction(function (e) {\n              var event = e.event;\n\n              if (event.shiftKey) {\n                event.preventDefault();\n              }\n            }));\n          }\n\n          return $table;\n        },\n        _createRow: function _createRow(row) {\n          var $row = this.callBase(row);\n          var isSelected;\n\n          if (row) {\n            isSelected = !!row.isSelected;\n\n            if (isSelected) {\n              $row.addClass(ROW_SELECTION_CLASS);\n            }\n\n            this.setAria(\"selected\", isSelected, $row);\n          }\n\n          return $row;\n        },\n        _rowClick: function _rowClick(e) {\n          var that = this;\n          var dxEvent = e.event;\n          var isSelectionDisabled = (0, _renderer2.default)(dxEvent.target).closest(\".\" + SELECTION_DISABLED_CLASS).length;\n\n          if (!that.isClickableElement((0, _renderer2.default)(dxEvent.target))) {\n            if (!isSelectionDisabled && (\"multiple\" !== that.option(SELECTION_MODE) || \"always\" !== that.option(SHOW_CHECKBOXES_MODE))) {\n              if (that.getController(\"selection\").changeItemSelection(e.rowIndex, {\n                control: dxEvent.ctrlKey || dxEvent.metaKey,\n                shift: dxEvent.shiftKey\n              })) {\n                dxEvent.preventDefault();\n                e.handled = true;\n              }\n            }\n\n            that.callBase(e);\n          }\n        },\n        isClickableElement: function isClickableElement($target) {\n          var isCommandSelect = $target.closest(\".\" + COMMAND_SELECT_CLASS).length;\n          return !!isCommandSelect;\n        },\n        _renderCore: function _renderCore(change) {\n          this.callBase(change);\n\n          this._updateCheckboxesClass();\n        },\n        _updateCheckboxesClass: function _updateCheckboxesClass() {\n          var tableElements = this.getTableElements();\n          var selectionController = this.getController(\"selection\");\n          var isCheckBoxesHidden = selectionController.isSelectColumnVisible() && !selectionController.isSelectionWithCheckboxes();\n          (0, _iterator.each)(tableElements, function (_, tableElement) {\n            (0, _renderer2.default)(tableElement).toggleClass(CHECKBOXES_HIDDEN_CLASS, isCheckBoxesHidden);\n          });\n        }\n      }\n    }\n  }\n};","map":{"version":3,"sources":["C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/devextreme/ui/grid_core/ui.grid_core.selection.js"],"names":["_renderer","require","_renderer2","_interopRequireDefault","_events_engine","_events_engine2","_uiData_grid","_uiData_grid2","_uiGrid_core","_type","_iterator","_extend","_support","_support2","_click","_click2","_message","_message2","_utils","_hold","_hold2","_selection","_selection2","_deferred","obj","EDITOR_CELL_CLASS","ROW_CLASS","ROW_SELECTION_CLASS","SELECT_CHECKBOX_CLASS","CHECKBOXES_HIDDEN_CLASS","COMMAND_SELECT_CLASS","SELECTION_DISABLED_CLASS","DATA_ROW_CLASS","SHOW_CHECKBOXES_MODE","SELECTION_MODE","processLongTap","selectionController","that","rowsView","$row","dxEvent","rowIndex","control","exports","isSeveralRowsSelected","keyIndex","store","key","isComplexKey","Array","selectionFilter","i","selectionCellTemplate","options","selectionHeaderTemplate","column","$cellElement","columnHeadersView","init","excludeValidators","_getSelectionConfig","dataController","selectionOptions","selectedKeys","mode","deferred","maxFilterLengthInRequest","keyOf","dataFields","load","plainItems","isItemSelected","item","isSelectableItem","getItemData","filter","totalCount","onSelectionChanged","_updateSelectColumn","columnsController","isSelectColumnVisible","type","command","visible","visibleIndex","dataType","alignment","cssClass","width","cellTemplate","headerCellTemplate","_createSelection","_fireSelectionChanged","argument","selectedRowKeys","_updateCheckboxesState","isDeferredMode","selectedItemKeys","removedItemKeys","_updateSelectedItems","items","isSelectionWithCheckboxes","changedItemIndexes","args","changeType","itemIndexes","selectionChangedOptions","selectedRowsData","currentSelectedRowKeys","currentDeselectedRowKeys","getChangedItemIndexes","isDeferredSelection","length","row","callbackNames","optionChanged","oldSelectionMode","selectionMode","value","publicMethods","isRowSelected","_isOnePageSelectAll","isSelectAll","selectAll","deselectAll","clearSelection","refresh","getSelectedRowKeys","selectRows","deselectRows","selectRowsByIndexes","keys","indexes","getSelectedRowsData","changeItemSelection","focusedItemIndex","startSelectionWithCheckboxes","stopSelectionWithCheckboxes","module","defaultOptions","selection","showCheckBoxesMode","allowSelectAll","selectAllMode","controllers","SelectionController","extenders","data","_loadDataSource","_processDataItem","hasSelectColumn","dataItem","d","_handleDataChanged","e","_applyChange","_this","change","currentItem","_endUpdateCore","changes","isUpdateSelection","a","contextMenu","_contextMenuPrepared","views","_updateSelectAllValue","$element","$editor","_renderSelectAllCheckBox","groupElement","parentType","editorOptions","tabIndex","setValue","_attachSelectAllCheckBoxClickEvent","event","renderSelectCheckBoxContainer","$container","_renderSelectCheckBox","lookup","_attachCheckBoxClickEvent","shift","shiftKey","_update","tableElements","isSelected","_createTable","$table","_createRow","_rowClick","isSelectionDisabled","isClickableElement","isCommandSelect","$target","_renderCore","_updateCheckboxesClass","isCheckBoxesHidden"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/grid_core/ui.grid_core.selection.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar _renderer = require(\"../../core/renderer\");\r\nvar _renderer2 = _interopRequireDefault(_renderer);\r\nvar _events_engine = require(\"../../events/core/events_engine\");\r\nvar _events_engine2 = _interopRequireDefault(_events_engine);\r\nvar _uiData_grid = require(\"../data_grid/ui.data_grid.core\");\r\nvar _uiData_grid2 = _interopRequireDefault(_uiData_grid);\r\nvar _uiGrid_core = require(\"./ui.grid_core.utils\");\r\nvar _type = require(\"../../core/utils/type\");\r\nvar _iterator = require(\"../../core/utils/iterator\");\r\nvar _extend = require(\"../../core/utils/extend\");\r\nvar _support = require(\"../../core/utils/support\");\r\nvar _support2 = _interopRequireDefault(_support);\r\nvar _click = require(\"../../events/click\");\r\nvar _click2 = _interopRequireDefault(_click);\r\nvar _message = require(\"../../localization/message\");\r\nvar _message2 = _interopRequireDefault(_message);\r\nvar _utils = require(\"../../events/utils\");\r\nvar _hold = require(\"../../events/hold\");\r\nvar _hold2 = _interopRequireDefault(_hold);\r\nvar _selection = require(\"../selection/selection\");\r\nvar _selection2 = _interopRequireDefault(_selection);\r\nvar _deferred = require(\"../../core/utils/deferred\");\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\nvar EDITOR_CELL_CLASS = \"dx-editor-cell\";\r\nvar ROW_CLASS = \"dx-row\";\r\nvar ROW_SELECTION_CLASS = \"dx-selection\";\r\nvar SELECT_CHECKBOX_CLASS = \"dx-select-checkbox\";\r\nvar CHECKBOXES_HIDDEN_CLASS = \"dx-select-checkboxes-hidden\";\r\nvar COMMAND_SELECT_CLASS = \"dx-command-select\";\r\nvar SELECTION_DISABLED_CLASS = \"dx-selection-disabled\";\r\nvar DATA_ROW_CLASS = \"dx-data-row\";\r\nvar SHOW_CHECKBOXES_MODE = \"selection.showCheckBoxesMode\";\r\nvar SELECTION_MODE = \"selection.mode\";\r\nvar processLongTap = function(that, dxEvent) {\r\n    var selectionController = that.getController(\"selection\");\r\n    var rowsView = that.getView(\"rowsView\");\r\n    var $row = (0, _renderer2.default)(dxEvent.target).closest(\".\" + DATA_ROW_CLASS);\r\n    var rowIndex = rowsView.getRowIndex($row);\r\n    if (rowIndex < 0) {\r\n        return\r\n    }\r\n    if (\"onLongTap\" === that.option(SHOW_CHECKBOXES_MODE)) {\r\n        if (selectionController.isSelectionWithCheckboxes()) {\r\n            selectionController.stopSelectionWithCheckboxes()\r\n        } else {\r\n            selectionController.startSelectionWithCheckboxes()\r\n        }\r\n    } else {\r\n        if (\"onClick\" === that.option(SHOW_CHECKBOXES_MODE)) {\r\n            selectionController.startSelectionWithCheckboxes()\r\n        }\r\n        if (\"always\" !== that.option(SHOW_CHECKBOXES_MODE)) {\r\n            selectionController.changeItemSelection(rowIndex, {\r\n                control: true\r\n            })\r\n        }\r\n    }\r\n};\r\nexports.SelectionController = _uiData_grid2.default.Controller.inherit(function() {\r\n    var isSeveralRowsSelected = function(that, selectionFilter) {\r\n        var keyIndex = 0;\r\n        var store = that._dataController.store();\r\n        var key = store && store.key();\r\n        var isComplexKey = Array.isArray(key);\r\n        if (!selectionFilter.length) {\r\n            return false\r\n        }\r\n        if (isComplexKey && Array.isArray(selectionFilter[0]) && \"and\" === selectionFilter[1]) {\r\n            for (var i = 0; i < selectionFilter.length; i++) {\r\n                if (Array.isArray(selectionFilter[i])) {\r\n                    if (selectionFilter[i][0] !== key[keyIndex] || \"=\" !== selectionFilter[i][1]) {\r\n                        return true\r\n                    }\r\n                    keyIndex++\r\n                }\r\n            }\r\n            return false\r\n        }\r\n        return key !== selectionFilter[0]\r\n    };\r\n    var selectionCellTemplate = function(container, options) {\r\n        var rowsView = options.component.getView(\"rowsView\");\r\n        rowsView.renderSelectCheckBoxContainer((0, _renderer2.default)(container), options)\r\n    };\r\n    var selectionHeaderTemplate = function(container, options) {\r\n        var column = options.column;\r\n        var $cellElement = (0, _renderer2.default)(container);\r\n        var columnHeadersView = options.component.getView(\"columnHeadersView\");\r\n        $cellElement.addClass(EDITOR_CELL_CLASS);\r\n        columnHeadersView._renderSelectAllCheckBox($cellElement, column);\r\n        columnHeadersView._attachSelectAllCheckBoxClickEvent($cellElement)\r\n    };\r\n    return {\r\n        init: function() {\r\n            this._dataController = this.getController(\"data\");\r\n            this._selectionMode = this.option(SELECTION_MODE);\r\n            this._isSelectionWithCheckboxes = false;\r\n            this._selection = this._createSelection();\r\n            this._updateSelectColumn();\r\n            this.createAction(\"onSelectionChanged\", {\r\n                excludeValidators: [\"disabled\", \"readOnly\"]\r\n            })\r\n        },\r\n        _getSelectionConfig: function() {\r\n            var that = this;\r\n            var dataController = that._dataController;\r\n            var selectionOptions = that.option(\"selection\") || {};\r\n            return {\r\n                selectedKeys: that.option(\"selectedRowKeys\"),\r\n                mode: that._selectionMode,\r\n                deferred: selectionOptions.deferred,\r\n                maxFilterLengthInRequest: selectionOptions.maxFilterLengthInRequest,\r\n                selectionFilter: that.option(\"selectionFilter\"),\r\n                key: function() {\r\n                    return dataController && dataController.key()\r\n                },\r\n                keyOf: function(item) {\r\n                    return dataController && dataController.keyOf(item)\r\n                },\r\n                dataFields: function() {\r\n                    return dataController.dataSource() && dataController.dataSource().select()\r\n                },\r\n                load: function(options) {\r\n                    return dataController.dataSource() && dataController.dataSource().load(options) || (new _deferred.Deferred).resolve([])\r\n                },\r\n                plainItems: function() {\r\n                    return dataController.items(true)\r\n                },\r\n                isItemSelected: function(item) {\r\n                    return item.selected\r\n                },\r\n                isSelectableItem: function(item) {\r\n                    return item && \"data\" === item.rowType && !item.isNewRow\r\n                },\r\n                getItemData: function(item) {\r\n                    return item && (item.oldData || item.data || item)\r\n                },\r\n                filter: function() {\r\n                    return dataController.getCombinedFilter()\r\n                },\r\n                totalCount: function() {\r\n                    return dataController.totalCount()\r\n                },\r\n                onSelectionChanged: that._updateSelectedItems.bind(this)\r\n            }\r\n        },\r\n        _updateSelectColumn: function() {\r\n            var columnsController = this.getController(\"columns\");\r\n            var isSelectColumnVisible = this.isSelectColumnVisible();\r\n            columnsController.addCommandColumn({\r\n                type: \"selection\",\r\n                command: \"select\",\r\n                visible: isSelectColumnVisible,\r\n                visibleIndex: -1,\r\n                dataType: \"boolean\",\r\n                alignment: \"center\",\r\n                cssClass: COMMAND_SELECT_CLASS,\r\n                width: \"auto\",\r\n                cellTemplate: selectionCellTemplate,\r\n                headerCellTemplate: selectionHeaderTemplate\r\n            });\r\n            columnsController.columnOption(\"command:select\", \"visible\", isSelectColumnVisible)\r\n        },\r\n        _createSelection: function() {\r\n            var options = this._getSelectionConfig();\r\n            return new _selection2.default(options)\r\n        },\r\n        _fireSelectionChanged: function(options) {\r\n            if (options) {\r\n                this.executeAction(\"onSelectionChanged\", options)\r\n            }\r\n            var argument = this.option(\"selection.deferred\") ? {\r\n                selectionFilter: this.option(\"selectionFilter\")\r\n            } : {\r\n                selectedRowKeys: this.option(\"selectedRowKeys\")\r\n            };\r\n            this.selectionChanged.fire(argument)\r\n        },\r\n        _updateCheckboxesState: function(options) {\r\n            var isDeferredMode = options.isDeferredMode;\r\n            var selectionFilter = options.selectionFilter;\r\n            var selectedItemKeys = options.selectedItemKeys;\r\n            var removedItemKeys = options.removedItemKeys;\r\n            if (\"onClick\" === this.option(SHOW_CHECKBOXES_MODE)) {\r\n                if (isDeferredMode ? selectionFilter && isSeveralRowsSelected(this, selectionFilter) : selectedItemKeys.length > 1) {\r\n                    this.startSelectionWithCheckboxes()\r\n                } else {\r\n                    if (isDeferredMode ? selectionFilter && !selectionFilter.length : 0 === selectedItemKeys.length && removedItemKeys.length) {\r\n                        this.stopSelectionWithCheckboxes()\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        _updateSelectedItems: function(args) {\r\n            var that = this;\r\n            var selectionChangedOptions;\r\n            var isDeferredMode = that.option(\"selection.deferred\");\r\n            var selectionFilter = that._selection.selectionFilter();\r\n            var dataController = that._dataController;\r\n            var items = dataController.items();\r\n            if (!items) {\r\n                return\r\n            }\r\n            var isSelectionWithCheckboxes = that.isSelectionWithCheckboxes();\r\n            var changedItemIndexes = that.getChangedItemIndexes(items);\r\n            that._updateCheckboxesState({\r\n                selectedItemKeys: args.selectedItemKeys,\r\n                removedItemKeys: args.removedItemKeys,\r\n                selectionFilter: selectionFilter,\r\n                isDeferredMode: isDeferredMode\r\n            });\r\n            if (changedItemIndexes.length || isSelectionWithCheckboxes !== that.isSelectionWithCheckboxes()) {\r\n                dataController.updateItems({\r\n                    changeType: \"updateSelection\",\r\n                    itemIndexes: changedItemIndexes\r\n                })\r\n            }\r\n            if (isDeferredMode) {\r\n                that.option(\"selectionFilter\", selectionFilter);\r\n                selectionChangedOptions = {}\r\n            } else {\r\n                if (args.addedItemKeys.length || args.removedItemKeys.length) {\r\n                    that._selectedItemsInternalChange = true;\r\n                    that.option(\"selectedRowKeys\", args.selectedItemKeys.slice(0));\r\n                    that._selectedItemsInternalChange = false;\r\n                    selectionChangedOptions = {\r\n                        selectedRowsData: args.selectedItems.slice(0),\r\n                        selectedRowKeys: args.selectedItemKeys.slice(0),\r\n                        currentSelectedRowKeys: args.addedItemKeys.slice(0),\r\n                        currentDeselectedRowKeys: args.removedItemKeys.slice(0)\r\n                    }\r\n                }\r\n            }\r\n            that._fireSelectionChanged(selectionChangedOptions)\r\n        },\r\n        getChangedItemIndexes: function(items) {\r\n            var that = this;\r\n            var itemIndexes = [];\r\n            var isDeferredSelection = this.option(\"selection.deferred\");\r\n            for (var i = 0, length = items.length; i < length; i++) {\r\n                var row = items[i];\r\n                var isItemSelected = that.isRowSelected(isDeferredSelection ? row.data : row.key);\r\n                if (that._selection.isDataItem(row) && row.isSelected !== isItemSelected) {\r\n                    itemIndexes.push(i)\r\n                }\r\n            }\r\n            return itemIndexes\r\n        },\r\n        callbackNames: function() {\r\n            return [\"selectionChanged\"]\r\n        },\r\n        optionChanged: function(args) {\r\n            var that = this;\r\n            that.callBase(args);\r\n            switch (args.name) {\r\n                case \"selection\":\r\n                    var oldSelectionMode = that._selectionMode;\r\n                    that.init();\r\n                    var selectionMode = that._selectionMode;\r\n                    var selectedRowKeys = that.option(\"selectedRowKeys\");\r\n                    if (oldSelectionMode !== selectionMode) {\r\n                        if (\"single\" === selectionMode) {\r\n                            if (selectedRowKeys.length > 1) {\r\n                                selectedRowKeys = [selectedRowKeys[0]]\r\n                            }\r\n                        } else {\r\n                            if (\"multiple\" !== selectionMode) {\r\n                                selectedRowKeys = []\r\n                            }\r\n                        }\r\n                    }\r\n                    that.selectRows(selectedRowKeys).always(function() {\r\n                        that._fireSelectionChanged()\r\n                    });\r\n                    that.getController(\"columns\").updateColumns();\r\n                    args.handled = true;\r\n                    break;\r\n                case \"selectionFilter\":\r\n                    this._selection.selectionFilter(args.value);\r\n                    args.handled = true;\r\n                    break;\r\n                case \"selectedRowKeys\":\r\n                    var value = args.value || [];\r\n                    if (Array.isArray(value) && !that._selectedItemsInternalChange && (that.component.getDataSource() || !value.length)) {\r\n                        that.selectRows(value)\r\n                    }\r\n                    args.handled = true\r\n            }\r\n        },\r\n        publicMethods: function() {\r\n            return [\"selectRows\", \"deselectRows\", \"selectRowsByIndexes\", \"getSelectedRowKeys\", \"getSelectedRowsData\", \"clearSelection\", \"selectAll\", \"deselectAll\", \"startSelectionWithCheckboxes\", \"stopSelectionWithCheckboxes\", \"isRowSelected\"]\r\n        },\r\n        isRowSelected: function(arg) {\r\n            return this._selection.isItemSelected(arg)\r\n        },\r\n        isSelectColumnVisible: function() {\r\n            return \"multiple\" === this.option(SELECTION_MODE) && (\"always\" === this.option(SHOW_CHECKBOXES_MODE) || \"onClick\" === this.option(SHOW_CHECKBOXES_MODE) || this._isSelectionWithCheckboxes)\r\n        },\r\n        _isOnePageSelectAll: function() {\r\n            return \"page\" === this.option(\"selection.selectAllMode\")\r\n        },\r\n        isSelectAll: function() {\r\n            return this._selection.getSelectAllState(this._isOnePageSelectAll())\r\n        },\r\n        selectAll: function() {\r\n            if (\"onClick\" === this.option(SHOW_CHECKBOXES_MODE)) {\r\n                this.startSelectionWithCheckboxes()\r\n            }\r\n            return this._selection.selectAll(this._isOnePageSelectAll())\r\n        },\r\n        deselectAll: function() {\r\n            return this._selection.deselectAll(this._isOnePageSelectAll())\r\n        },\r\n        clearSelection: function() {\r\n            return this.selectedItemKeys([])\r\n        },\r\n        refresh: function() {\r\n            var selectedRowKeys = this.option(\"selectedRowKeys\") || [];\r\n            if (!this.option(\"selection.deferred\") && selectedRowKeys.length) {\r\n                return this.selectedItemKeys(selectedRowKeys)\r\n            }\r\n            return (new _deferred.Deferred).resolve().promise()\r\n        },\r\n        selectedItemKeys: function(value, preserve, isDeselect, isSelectAll) {\r\n            return this._selection.selectedItemKeys(value, preserve, isDeselect, isSelectAll)\r\n        },\r\n        getSelectedRowKeys: function() {\r\n            return this._selection.getSelectedItemKeys()\r\n        },\r\n        selectRows: function(keys, preserve) {\r\n            return this.selectedItemKeys(keys, preserve)\r\n        },\r\n        deselectRows: function(keys) {\r\n            return this.selectedItemKeys(keys, true, true)\r\n        },\r\n        selectRowsByIndexes: function(indexes) {\r\n            var items = this._dataController.items();\r\n            var keys = [];\r\n            if (!Array.isArray(indexes)) {\r\n                indexes = Array.prototype.slice.call(arguments, 0)\r\n            }(0, _iterator.each)(indexes, function() {\r\n                var item = items[this];\r\n                if (item && \"data\" === item.rowType) {\r\n                    keys.push(item.key)\r\n                }\r\n            });\r\n            return this.selectRows(keys)\r\n        },\r\n        getSelectedRowsData: function() {\r\n            return this._selection.getSelectedItems()\r\n        },\r\n        changeItemSelection: function(itemIndex, keys) {\r\n            keys = keys || {};\r\n            if (this.isSelectionWithCheckboxes()) {\r\n                keys.control = true\r\n            }\r\n            return this._selection.changeItemSelection(this._dataController.getRowIndexDelta() + itemIndex, keys)\r\n        },\r\n        focusedItemIndex: function(itemIndex) {\r\n            var that = this;\r\n            if ((0, _type.isDefined)(itemIndex)) {\r\n                that._selection._focusedItemIndex = itemIndex\r\n            } else {\r\n                return that._selection._focusedItemIndex\r\n            }\r\n        },\r\n        isSelectionWithCheckboxes: function() {\r\n            return \"multiple\" === this.option(SELECTION_MODE) && (\"always\" === this.option(SHOW_CHECKBOXES_MODE) || this._isSelectionWithCheckboxes)\r\n        },\r\n        startSelectionWithCheckboxes: function() {\r\n            var that = this;\r\n            if (\"multiple\" === that.option(SELECTION_MODE) && !that.isSelectionWithCheckboxes()) {\r\n                that._isSelectionWithCheckboxes = true;\r\n                that._updateSelectColumn();\r\n                return true\r\n            }\r\n            return false\r\n        },\r\n        stopSelectionWithCheckboxes: function() {\r\n            var that = this;\r\n            if (that._isSelectionWithCheckboxes) {\r\n                that._isSelectionWithCheckboxes = false;\r\n                that._updateSelectColumn();\r\n                return true\r\n            }\r\n            return false\r\n        }\r\n    }\r\n}());\r\nmodule.exports = {\r\n    defaultOptions: function() {\r\n        return {\r\n            selection: {\r\n                mode: \"none\",\r\n                showCheckBoxesMode: \"onClick\",\r\n                allowSelectAll: true,\r\n                selectAllMode: \"allPages\",\r\n                maxFilterLengthInRequest: 1500,\r\n                deferred: false\r\n            },\r\n            selectionFilter: [],\r\n            selectedRowKeys: []\r\n        }\r\n    },\r\n    controllers: {\r\n        selection: exports.SelectionController\r\n    },\r\n    extenders: {\r\n        controllers: {\r\n            data: {\r\n                init: function() {\r\n                    var selectionController = this.getController(\"selection\");\r\n                    var isDeferredMode = this.option(\"selection.deferred\");\r\n                    this.callBase.apply(this, arguments);\r\n                    if (isDeferredMode) {\r\n                        selectionController._updateCheckboxesState({\r\n                            isDeferredMode: true,\r\n                            selectionFilter: this.option(\"selectionFilter\")\r\n                        })\r\n                    }\r\n                },\r\n                _loadDataSource: function() {\r\n                    var that = this;\r\n                    return that.callBase().done(function() {\r\n                        that.getController(\"selection\").refresh()\r\n                    })\r\n                },\r\n                _processDataItem: function(item, options) {\r\n                    var that = this;\r\n                    var selectionController = that.getController(\"selection\");\r\n                    var hasSelectColumn = selectionController.isSelectColumnVisible();\r\n                    var isDeferredSelection = options.isDeferredSelection = void 0 === options.isDeferredSelection ? this.option(\"selection.deferred\") : options.isDeferredSelection;\r\n                    var dataItem = this.callBase.apply(this, arguments);\r\n                    dataItem.isSelected = selectionController.isRowSelected(isDeferredSelection ? dataItem.data : dataItem.key);\r\n                    if (hasSelectColumn && dataItem.values) {\r\n                        for (var i = 0; i < options.visibleColumns.length; i++) {\r\n                            if (\"select\" === options.visibleColumns[i].command) {\r\n                                dataItem.values[i] = dataItem.isSelected;\r\n                                break\r\n                            }\r\n                        }\r\n                    }\r\n                    return dataItem\r\n                },\r\n                refresh: function(options) {\r\n                    var that = this;\r\n                    var d = new _deferred.Deferred;\r\n                    this.callBase.apply(this, arguments).done(function() {\r\n                        if (!options || options.selection) {\r\n                            that.getController(\"selection\").refresh().done(d.resolve).fail(d.reject)\r\n                        } else {\r\n                            d.resolve()\r\n                        }\r\n                    }).fail(d.reject);\r\n                    return d.promise()\r\n                },\r\n                _handleDataChanged: function(e) {\r\n                    this.callBase.apply(this, arguments);\r\n                    if ((!e || \"refresh\" === e.changeType) && !this._repaintChangesOnly) {\r\n                        this.getController(\"selection\").focusedItemIndex(-1)\r\n                    }\r\n                },\r\n                _applyChange: function(change) {\r\n                    var _this = this;\r\n                    if (change && \"updateSelection\" === change.changeType) {\r\n                        change.items.forEach(function(item, index) {\r\n                            var currentItem = _this._items[index];\r\n                            if (currentItem) {\r\n                                currentItem.isSelected = item.isSelected;\r\n                                currentItem.values = item.values\r\n                            }\r\n                        });\r\n                        return\r\n                    }\r\n                    return this.callBase.apply(this, arguments)\r\n                },\r\n                _endUpdateCore: function() {\r\n                    var changes = this._changes;\r\n                    var isUpdateSelection = changes.length > 1 && changes.every(function(change) {\r\n                        return \"updateSelection\" === change.changeType\r\n                    });\r\n                    if (isUpdateSelection) {\r\n                        var itemIndexes = changes.map(function(change) {\r\n                            return change.itemIndexes || []\r\n                        }).reduce(function(a, b) {\r\n                            return a.concat(b)\r\n                        });\r\n                        this._changes = [{\r\n                            changeType: \"updateSelection\",\r\n                            itemIndexes: itemIndexes\r\n                        }]\r\n                    }\r\n                    this.callBase.apply(this, arguments)\r\n                }\r\n            },\r\n            contextMenu: {\r\n                _contextMenuPrepared: function(options) {\r\n                    var dxEvent = options.event;\r\n                    if (dxEvent.originalEvent && \"dxhold\" !== dxEvent.originalEvent.type || options.items && options.items.length > 0) {\r\n                        return\r\n                    }\r\n                    processLongTap(this, dxEvent)\r\n                }\r\n            }\r\n        },\r\n        views: {\r\n            columnHeadersView: {\r\n                init: function() {\r\n                    var that = this;\r\n                    that.callBase();\r\n                    that.getController(\"selection\").selectionChanged.add(that._updateSelectAllValue.bind(that))\r\n                },\r\n                _updateSelectAllValue: function() {\r\n                    var that = this;\r\n                    var $element = that.element();\r\n                    var $editor = $element && $element.find(\".\" + SELECT_CHECKBOX_CLASS);\r\n                    if ($element && $editor.length && \"multiple\" === that.option(\"selection.mode\")) {\r\n                        $editor.dxCheckBox(\"instance\").option(\"value\", that.getController(\"selection\").isSelectAll())\r\n                    }\r\n                },\r\n                _handleDataChanged: function(e) {\r\n                    this.callBase(e);\r\n                    if (!e || \"refresh\" === e.changeType) {\r\n                        this._updateSelectAllValue()\r\n                    }\r\n                },\r\n                _renderSelectAllCheckBox: function($container, column) {\r\n                    var that = this;\r\n                    var groupElement;\r\n                    var selectionController = that.getController(\"selection\");\r\n                    groupElement = (0, _renderer2.default)(\"<div>\").appendTo($container).addClass(SELECT_CHECKBOX_CLASS);\r\n                    that.setAria(\"label\", _message2.default.format(\"dxDataGrid-ariaSelectAll\"), $container);\r\n                    that.getController(\"editorFactory\").createEditor(groupElement, (0, _extend.extend)({}, column, {\r\n                        parentType: \"headerRow\",\r\n                        dataType: \"boolean\",\r\n                        value: selectionController.isSelectAll(),\r\n                        editorOptions: {\r\n                            visible: that.option(\"selection.allowSelectAll\") || false !== selectionController.isSelectAll()\r\n                        },\r\n                        tabIndex: that.option(\"useLegacyKeyboardNavigation\") ? -1 : that.option(\"tabIndex\") || 0,\r\n                        setValue: function(value, e) {\r\n                            var allowSelectAll = that.option(\"selection.allowSelectAll\");\r\n                            e.component.option(\"visible\", allowSelectAll || false !== e.component.option(\"value\"));\r\n                            if (!e.event || selectionController.isSelectAll() === value) {\r\n                                return\r\n                            }\r\n                            if (e.value && !allowSelectAll) {\r\n                                e.component.option(\"value\", false)\r\n                            } else {\r\n                                e.value ? selectionController.selectAll() : selectionController.deselectAll()\r\n                            }\r\n                            e.event.preventDefault()\r\n                        }\r\n                    }));\r\n                    return groupElement\r\n                },\r\n                _attachSelectAllCheckBoxClickEvent: function($element) {\r\n                    _events_engine2.default.on($element, _click2.default.name, this.createAction(function(e) {\r\n                        var event = e.event;\r\n                        if (!(0, _renderer2.default)(event.target).closest(\".\" + SELECT_CHECKBOX_CLASS).length) {\r\n                            _events_engine2.default.trigger((0, _renderer2.default)(event.currentTarget).children(\".\" + SELECT_CHECKBOX_CLASS), _click2.default.name)\r\n                        }\r\n                        event.preventDefault()\r\n                    }))\r\n                }\r\n            },\r\n            rowsView: {\r\n                renderSelectCheckBoxContainer: function($container, options) {\r\n                    if (\"data\" === options.rowType && !options.row.isNewRow) {\r\n                        $container.addClass(EDITOR_CELL_CLASS);\r\n                        this._attachCheckBoxClickEvent($container);\r\n                        this.setAria(\"label\", _message2.default.format(\"dxDataGrid-ariaSelectRow\"), $container);\r\n                        this._renderSelectCheckBox($container, options)\r\n                    } else {\r\n                        (0, _uiGrid_core.setEmptyText)($container)\r\n                    }\r\n                },\r\n                _renderSelectCheckBox: function(container, options) {\r\n                    var groupElement = (0, _renderer2.default)(\"<div>\").addClass(SELECT_CHECKBOX_CLASS).appendTo(container);\r\n                    this.getController(\"editorFactory\").createEditor(groupElement, (0, _extend.extend)({}, options.column, {\r\n                        parentType: \"dataRow\",\r\n                        dataType: \"boolean\",\r\n                        lookup: null,\r\n                        value: options.value,\r\n                        tabIndex: -1,\r\n                        setValue: function(value, e) {\r\n                            if (e && e.event && \"keydown\" === e.event.type) {\r\n                                _events_engine2.default.trigger(container, _click2.default.name, e)\r\n                            }\r\n                        },\r\n                        row: options.row\r\n                    }));\r\n                    return groupElement\r\n                },\r\n                _attachCheckBoxClickEvent: function($element) {\r\n                    _events_engine2.default.on($element, _click2.default.name, this.createAction(function(e) {\r\n                        var selectionController = this.getController(\"selection\");\r\n                        var event = e.event;\r\n                        var rowIndex = this.getRowIndex((0, _renderer2.default)(event.currentTarget).closest(\".\" + ROW_CLASS));\r\n                        if (rowIndex >= 0) {\r\n                            selectionController.startSelectionWithCheckboxes();\r\n                            selectionController.changeItemSelection(rowIndex, {\r\n                                shift: event.shiftKey\r\n                            });\r\n                            if ((0, _renderer2.default)(event.target).closest(\".\" + SELECT_CHECKBOX_CLASS).length) {\r\n                                this.getController(\"data\").updateItems({\r\n                                    changeType: \"updateSelection\",\r\n                                    itemIndexes: [rowIndex]\r\n                                })\r\n                            }\r\n                        }\r\n                    }))\r\n                },\r\n                _update: function(change) {\r\n                    var that = this;\r\n                    var tableElements = that.getTableElements();\r\n                    if (\"updateSelection\" === change.changeType) {\r\n                        if (tableElements.length > 0) {\r\n                            (0, _iterator.each)(tableElements, function(_, tableElement) {\r\n                                (0, _iterator.each)(change.itemIndexes || [], function(_, index) {\r\n                                    var $row;\r\n                                    var isSelected;\r\n                                    if (change.items[index]) {\r\n                                        $row = that._getRowElements((0, _renderer2.default)(tableElement)).eq(index);\r\n                                        if ($row.length) {\r\n                                            isSelected = change.items[index].isSelected;\r\n                                            $row.toggleClass(ROW_SELECTION_CLASS, void 0 === isSelected ? false : isSelected).find(\".\" + SELECT_CHECKBOX_CLASS).dxCheckBox(\"option\", \"value\", isSelected);\r\n                                            that.setAria(\"selected\", isSelected, $row)\r\n                                        }\r\n                                    }\r\n                                })\r\n                            });\r\n                            that._updateCheckboxesClass()\r\n                        }\r\n                    } else {\r\n                        that.callBase(change)\r\n                    }\r\n                },\r\n                _createTable: function() {\r\n                    var that = this;\r\n                    var selectionMode = that.option(\"selection.mode\");\r\n                    var $table = that.callBase.apply(that, arguments);\r\n                    if (\"none\" !== selectionMode) {\r\n                        if (\"onLongTap\" === that.option(SHOW_CHECKBOXES_MODE) || !_support2.default.touch) {\r\n                            _events_engine2.default.on($table, (0, _utils.addNamespace)(_hold2.default.name, \"dxDataGridRowsView\"), \".\" + DATA_ROW_CLASS, that.createAction(function(e) {\r\n                                processLongTap(that.component, e.event);\r\n                                e.event.stopPropagation()\r\n                            }))\r\n                        }\r\n                        _events_engine2.default.on($table, \"mousedown selectstart\", that.createAction(function(e) {\r\n                            var event = e.event;\r\n                            if (event.shiftKey) {\r\n                                event.preventDefault()\r\n                            }\r\n                        }))\r\n                    }\r\n                    return $table\r\n                },\r\n                _createRow: function(row) {\r\n                    var $row = this.callBase(row);\r\n                    var isSelected;\r\n                    if (row) {\r\n                        isSelected = !!row.isSelected;\r\n                        if (isSelected) {\r\n                            $row.addClass(ROW_SELECTION_CLASS)\r\n                        }\r\n                        this.setAria(\"selected\", isSelected, $row)\r\n                    }\r\n                    return $row\r\n                },\r\n                _rowClick: function(e) {\r\n                    var that = this;\r\n                    var dxEvent = e.event;\r\n                    var isSelectionDisabled = (0, _renderer2.default)(dxEvent.target).closest(\".\" + SELECTION_DISABLED_CLASS).length;\r\n                    if (!that.isClickableElement((0, _renderer2.default)(dxEvent.target))) {\r\n                        if (!isSelectionDisabled && (\"multiple\" !== that.option(SELECTION_MODE) || \"always\" !== that.option(SHOW_CHECKBOXES_MODE))) {\r\n                            if (that.getController(\"selection\").changeItemSelection(e.rowIndex, {\r\n                                    control: dxEvent.ctrlKey || dxEvent.metaKey,\r\n                                    shift: dxEvent.shiftKey\r\n                                })) {\r\n                                dxEvent.preventDefault();\r\n                                e.handled = true\r\n                            }\r\n                        }\r\n                        that.callBase(e)\r\n                    }\r\n                },\r\n                isClickableElement: function($target) {\r\n                    var isCommandSelect = $target.closest(\".\" + COMMAND_SELECT_CLASS).length;\r\n                    return !!isCommandSelect\r\n                },\r\n                _renderCore: function(change) {\r\n                    this.callBase(change);\r\n                    this._updateCheckboxesClass()\r\n                },\r\n                _updateCheckboxesClass: function() {\r\n                    var tableElements = this.getTableElements();\r\n                    var selectionController = this.getController(\"selection\");\r\n                    var isCheckBoxesHidden = selectionController.isSelectColumnVisible() && !selectionController.isSelectionWithCheckboxes();\r\n                    (0, _iterator.each)(tableElements, function(_, tableElement) {\r\n                        (0, _renderer2.default)(tableElement).toggleClass(CHECKBOXES_HIDDEN_CLASS, isCheckBoxesHidden)\r\n                    })\r\n                }\r\n            }\r\n        }\r\n    }\r\n};\r\n"]},"metadata":{},"sourceType":"module"}