{"ast":null,"code":"/**\r\n * DevExtreme (ui/scheduler/ui.scheduler.resource_manager.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _array = require(\"../../core/utils/array\");\n\nvar _array2 = _interopRequireDefault(_array);\n\nvar _common = require(\"../../core/utils/common\");\n\nvar _type = require(\"../../core/utils/type\");\n\nvar _object = require(\"../../core/utils/object\");\n\nvar _object2 = _interopRequireDefault(_object);\n\nvar _iterator = require(\"../../core/utils/iterator\");\n\nvar _iterator2 = _interopRequireDefault(_iterator);\n\nvar _extend = require(\"../../core/utils/extend\");\n\nvar _query = require(\"../../data/query\");\n\nvar _query2 = _interopRequireDefault(_query);\n\nvar _data = require(\"../../core/utils/data\");\n\nvar _data2 = _interopRequireDefault(_data);\n\nvar _data_source = require(\"../../data/data_source/data_source\");\n\nvar _data_source2 = _interopRequireDefault(_data_source);\n\nvar _deferred = require(\"../../core/utils/deferred\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n\n    if (\"value\" in descriptor) {\n      descriptor.writable = true;\n    }\n\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) {\n    _defineProperties(Constructor.prototype, protoProps);\n  }\n\n  if (staticProps) {\n    _defineProperties(Constructor, staticProps);\n  }\n\n  return Constructor;\n}\n\nvar getValueExpr = function getValueExpr(resource) {\n  return resource.valueExpr || \"id\";\n};\n\nvar getDisplayExpr = function getDisplayExpr(resource) {\n  return resource.displayExpr || \"text\";\n};\n\nvar ResourceManager = function () {\n  function ResourceManager(resources) {\n    _classCallCheck(this, ResourceManager);\n\n    this._resourceLoader = {};\n    this.setResources(resources);\n  }\n\n  _createClass(ResourceManager, [{\n    key: \"_wrapDataSource\",\n    value: function value(dataSource) {\n      if (dataSource instanceof _data_source2.default.DataSource) {\n        return dataSource;\n      } else {\n        return new _data_source2.default.DataSource({\n          store: _data_source2.default.normalizeDataSourceOptions(dataSource).store,\n          pageSize: 0\n        });\n      }\n    }\n  }, {\n    key: \"_mapResourceData\",\n    value: function value(resource, data) {\n      var valueGetter = _data2.default.compileGetter(getValueExpr(resource));\n\n      var displayGetter = _data2.default.compileGetter(getDisplayExpr(resource));\n\n      return _iterator2.default.map(data, function (item) {\n        var result = {\n          id: valueGetter(item),\n          text: displayGetter(item)\n        };\n\n        if (item.color) {\n          result.color = item.color;\n        }\n\n        return result;\n      });\n    }\n  }, {\n    key: \"_isMultipleResource\",\n    value: function value(resourceField) {\n      var result = false;\n\n      _iterator2.default.each(this.getResources(), function (_, resource) {\n        var field = this.getField(resource);\n\n        if (field === resourceField) {\n          result = resource.allowMultiple;\n          return false;\n        }\n      }.bind(this));\n\n      return result;\n    }\n  }, {\n    key: \"getDataAccessors\",\n    value: function value(field, type) {\n      var result = null;\n\n      _iterator2.default.each(this._dataAccessors[type], function (accessorName, accessors) {\n        if (field === accessorName) {\n          result = accessors;\n          return false;\n        }\n      });\n\n      return result;\n    }\n  }, {\n    key: \"getField\",\n    value: function value(resource) {\n      return resource.fieldExpr || resource.field;\n    }\n  }, {\n    key: \"setResources\",\n    value: function value(resources) {\n      this._resources = resources;\n      this._dataAccessors = {\n        getter: {},\n        setter: {}\n      };\n      this._resourceFields = _iterator2.default.map(resources || [], function (resource) {\n        var field = this.getField(resource);\n        this._dataAccessors.getter[field] = _data2.default.compileGetter(field);\n        this._dataAccessors.setter[field] = _data2.default.compileSetter(field);\n        return field;\n      }.bind(this));\n    }\n  }, {\n    key: \"getResources\",\n    value: function value() {\n      return this._resources || [];\n    }\n  }, {\n    key: \"getResourcesData\",\n    value: function value() {\n      return this._resourcesData || [];\n    }\n  }, {\n    key: \"getEditors\",\n    value: function value() {\n      var result = [];\n      var that = this;\n\n      _iterator2.default.each(this.getResources(), function (i, resource) {\n        var field = that.getField(resource);\n\n        var currentResourceItems = that._getResourceDataByField(field);\n\n        result.push({\n          editorOptions: {\n            dataSource: currentResourceItems.length ? currentResourceItems : that._wrapDataSource(resource.dataSource),\n            displayExpr: getDisplayExpr(resource),\n            valueExpr: getValueExpr(resource)\n          },\n          dataField: field,\n          editorType: resource.allowMultiple ? \"dxTagBox\" : \"dxSelectBox\",\n          label: {\n            text: resource.label || field\n          }\n        });\n      });\n\n      return result;\n    }\n  }, {\n    key: \"getResourceDataByValue\",\n    value: function value(field, _value) {\n      var that = this;\n      var result = new _deferred.Deferred();\n\n      _iterator2.default.each(this.getResources(), function (_, resource) {\n        var resourceField = that.getField(resource);\n\n        if (resourceField === field) {\n          var dataSource = that._wrapDataSource(resource.dataSource);\n\n          var valueExpr = getValueExpr(resource);\n\n          if (!that._resourceLoader[field]) {\n            that._resourceLoader[field] = dataSource.load();\n          }\n\n          that._resourceLoader[field].done(function (data) {\n            var filteredData = (0, _query2.default)(data).filter(valueExpr, _value).toArray();\n            delete that._resourceLoader[field];\n            result.resolve(filteredData[0]);\n          }).fail(function () {\n            delete that._resourceLoader[field];\n            result.reject();\n          });\n\n          return false;\n        }\n      });\n\n      return result.promise();\n    }\n  }, {\n    key: \"setResourcesToItem\",\n    value: function value(itemData, resources) {\n      var resourcesSetter = this._dataAccessors.setter;\n\n      for (var name in resources) {\n        if (Object.prototype.hasOwnProperty.call(resources, name)) {\n          var resourceData = resources[name];\n          resourcesSetter[name](itemData, this._isMultipleResource(name) ? _array2.default.wrapToArray(resourceData) : resourceData);\n        }\n      }\n    }\n  }, {\n    key: \"getResourcesFromItem\",\n    value: function value(itemData, wrapOnlyMultipleResources) {\n      var _this = this;\n\n      var result = null;\n\n      if (!(0, _type.isDefined)(wrapOnlyMultipleResources)) {\n        wrapOnlyMultipleResources = false;\n      }\n\n      this._resourceFields.forEach(function (field) {\n        _iterator2.default.each(itemData, function (fieldName, fieldValue) {\n          var tempObject = {};\n          tempObject[fieldName] = fieldValue;\n\n          var resourceData = _this.getDataAccessors(field, \"getter\")(tempObject);\n\n          if ((0, _type.isDefined)(resourceData)) {\n            if (!result) {\n              result = {};\n            }\n\n            if (1 === resourceData.length) {\n              resourceData = resourceData[0];\n            }\n\n            if (!wrapOnlyMultipleResources || wrapOnlyMultipleResources && _this._isMultipleResource(field)) {\n              _this.getDataAccessors(field, \"setter\")(tempObject, _array2.default.wrapToArray(resourceData));\n            } else {\n              _this.getDataAccessors(field, \"setter\")(tempObject, resourceData);\n            }\n\n            (0, _extend.extend)(result, tempObject);\n            return true;\n          }\n        });\n      });\n\n      return result;\n    }\n  }, {\n    key: \"loadResources\",\n    value: function value(groups) {\n      var result = new _deferred.Deferred();\n      var that = this;\n      var deferreds = [];\n\n      _iterator2.default.each(this.getResourcesByFields(groups), function (i, resource) {\n        var deferred = new _deferred.Deferred();\n        var field = that.getField(resource);\n        deferreds.push(deferred);\n\n        that._wrapDataSource(resource.dataSource).load().done(function (data) {\n          deferred.resolve({\n            name: field,\n            items: that._mapResourceData(resource, data),\n            data: data\n          });\n        }).fail(function () {\n          deferred.reject();\n        });\n      });\n\n      if (!deferreds.length) {\n        that._resourcesData = [];\n        return result.resolve([]);\n      }\n\n      _deferred.when.apply(null, deferreds).done(function () {\n        var data = Array.prototype.slice.call(arguments);\n\n        var mapFunction = function mapFunction(obj) {\n          return {\n            name: obj.name,\n            items: obj.items,\n            data: obj.data\n          };\n        };\n\n        that._resourcesData = data;\n        result.resolve(data.map(mapFunction));\n      }).fail(function () {\n        result.reject();\n      });\n\n      return result.promise();\n    }\n  }, {\n    key: \"getResourcesByFields\",\n    value: function value(fields) {\n      return (0, _common.grep)(this.getResources(), function (resource) {\n        var field = this.getField(resource);\n        return (0, _array.inArray)(field, fields) > -1;\n      }.bind(this));\n    }\n  }, {\n    key: \"getResourceByField\",\n    value: function value(field) {\n      return this.getResourcesByFields([field])[0] || {};\n    }\n  }, {\n    key: \"getResourceColor\",\n    value: function value(field, _value2) {\n      var valueExpr = this.getResourceByField(field).valueExpr || \"id\";\n\n      var valueGetter = _data2.default.compileGetter(valueExpr);\n\n      var colorExpr = this.getResourceByField(field).colorExpr || \"color\";\n\n      var colorGetter = _data2.default.compileGetter(colorExpr);\n\n      var result = new _deferred.Deferred();\n\n      var resourceData = this._getResourceDataByField(field);\n\n      var resourceDataLength = resourceData.length;\n      var color;\n\n      if (resourceDataLength) {\n        for (var i = 0; i < resourceDataLength; i++) {\n          if (valueGetter(resourceData[i]) === _value2) {\n            color = colorGetter(resourceData[i]);\n            break;\n          }\n        }\n\n        result.resolve(color);\n      } else {\n        this.getResourceDataByValue(field, _value2).done(function (resourceData) {\n          if (resourceData) {\n            color = colorGetter(resourceData);\n          }\n\n          result.resolve(color);\n        }).fail(function () {\n          result.reject();\n        });\n      }\n\n      return result.promise();\n    }\n  }, {\n    key: \"getResourceForPainting\",\n    value: function value(groups) {\n      var resources = this.getResources();\n      var result;\n\n      _iterator2.default.each(resources, function (index, resource) {\n        if (resource.useColorAsDefault) {\n          result = resource;\n          return false;\n        }\n      });\n\n      if (!result) {\n        if (Array.isArray(groups) && groups.length) {\n          resources = this.getResourcesByFields(groups);\n        }\n\n        result = resources[resources.length - 1];\n      }\n\n      return result;\n    }\n  }, {\n    key: \"createResourcesTree\",\n    value: function value(groups) {\n      var leafIndex = 0;\n      var groupIndex = groupIndex || 0;\n\n      function make(group, groupIndex, result, parent) {\n        result = result || [];\n\n        for (var i = 0; i < group.items.length; i++) {\n          var currentGroupItem = group.items[i];\n          var resultItem = {\n            name: group.name,\n            value: currentGroupItem.id,\n            title: currentGroupItem.text,\n            data: group.data && group.data[i],\n            children: [],\n            parent: parent ? parent : null\n          };\n          result.push(resultItem);\n          var nextGroupIndex = groupIndex + 1;\n\n          if (groups[nextGroupIndex]) {\n            make.call(this, groups[nextGroupIndex], nextGroupIndex, resultItem.children, resultItem);\n          }\n\n          if (!resultItem.children.length) {\n            resultItem.leafIndex = leafIndex;\n            leafIndex++;\n          }\n        }\n\n        return result;\n      }\n\n      return make.call(this, groups[0], 0);\n    }\n  }, {\n    key: \"_hasGroupItem\",\n    value: function value(appointmentResources, groupName, itemValue) {\n      var group = this.getDataAccessors(groupName, \"getter\")(appointmentResources);\n\n      if (group) {\n        if ((0, _array.inArray)(itemValue, group) > -1) {\n          return true;\n        }\n      }\n\n      return false;\n    }\n  }, {\n    key: \"_getResourceDataByField\",\n    value: function value(fieldName) {\n      var loadedResources = this.getResourcesData();\n      var currentResourceData = [];\n\n      for (var i = 0, resourceCount = loadedResources.length; i < resourceCount; i++) {\n        if (loadedResources[i].name === fieldName) {\n          currentResourceData = loadedResources[i].data;\n          break;\n        }\n      }\n\n      return currentResourceData;\n    }\n  }, {\n    key: \"getResourceTreeLeaves\",\n    value: function value(tree, appointmentResources, result) {\n      result = result || [];\n\n      for (var i = 0; i < tree.length; i++) {\n        if (!this._hasGroupItem(appointmentResources, tree[i].name, tree[i].value)) {\n          continue;\n        }\n\n        if ((0, _type.isDefined)(tree[i].leafIndex)) {\n          result.push(tree[i].leafIndex);\n        }\n\n        if (tree[i].children) {\n          this.getResourceTreeLeaves(tree[i].children, appointmentResources, result);\n        }\n      }\n\n      return result;\n    }\n  }, {\n    key: \"groupAppointmentsByResources\",\n    value: function value(appointments, resources) {\n      var tree = this.createResourcesTree(resources);\n      var result = {};\n\n      _iterator2.default.each(appointments, function (_, appointment) {\n        var appointmentResources = this.getResourcesFromItem(appointment);\n        var treeLeaves = this.getResourceTreeLeaves(tree, appointmentResources);\n\n        for (var i = 0; i < treeLeaves.length; i++) {\n          if (!result[treeLeaves[i]]) {\n            result[treeLeaves[i]] = [];\n          }\n\n          result[treeLeaves[i]].push(_object2.default.deepExtendArraySafe({}, appointment, true));\n        }\n      }.bind(this));\n\n      return result;\n    }\n  }, {\n    key: \"reduceResourcesTree\",\n    value: function value(tree, existingAppointments, _result) {\n      _result = _result ? _result.children : [];\n      var that = this;\n      tree.forEach(function (node, index) {\n        var ok = false;\n        var resourceName = node.name;\n        var resourceValue = node.value;\n        var resourceTitle = node.title;\n        var resourceData = node.data;\n        var resourceGetter = that.getDataAccessors(resourceName, \"getter\");\n        existingAppointments.forEach(function (appointment) {\n          if (!ok) {\n            var resourceFromAppointment = resourceGetter(appointment);\n\n            if (Array.isArray(resourceFromAppointment)) {\n              if (resourceFromAppointment.indexOf(resourceValue) > -1) {\n                _result.push({\n                  name: resourceName,\n                  value: resourceValue,\n                  title: resourceTitle,\n                  data: resourceData,\n                  children: []\n                });\n\n                ok = true;\n              }\n            } else {\n              if (resourceFromAppointment === resourceValue) {\n                _result.push({\n                  name: resourceName,\n                  value: resourceValue,\n                  title: resourceTitle,\n                  data: resourceData,\n                  children: []\n                });\n\n                ok = true;\n              }\n            }\n          }\n        });\n\n        if (ok && node.children && node.children.length) {\n          that.reduceResourcesTree(node.children, existingAppointments, _result[index]);\n        }\n      });\n      return _result;\n    }\n  }]);\n\n  return ResourceManager;\n}();\n\nexports.default = ResourceManager;","map":{"version":3,"sources":["C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/devextreme/ui/scheduler/ui.scheduler.resource_manager.js"],"names":["Object","value","exports","_array","require","_array2","_interopRequireDefault","_common","_type","_object","_object2","_iterator","_iterator2","_extend","_query","_query2","_data","_data2","_data_source","_data_source2","_deferred","obj","instance","i","props","descriptor","_defineProperties","Constructor","getValueExpr","resource","getDisplayExpr","ResourceManager","_classCallCheck","_createClass","key","dataSource","store","pageSize","valueGetter","displayGetter","result","id","text","item","field","getter","setter","resources","that","currentResourceItems","editorOptions","displayExpr","valueExpr","dataField","editorType","label","resourceField","filteredData","resourcesSetter","resourceData","_this","wrapOnlyMultipleResources","tempObject","deferreds","deferred","name","items","data","Array","mapFunction","colorExpr","colorGetter","resourceDataLength","color","groups","leafIndex","groupIndex","group","currentGroupItem","resultItem","title","children","parent","nextGroupIndex","make","loadedResources","currentResourceData","resourceCount","tree","appointmentResources","treeLeaves","_result","ok","resourceName","node","resourceValue","resourceTitle","resourceGetter","existingAppointments","resourceFromAppointment"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/scheduler/ui.scheduler.resource_manager.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", {\r\n    value: true\r\n});\r\nexports.default = void 0;\r\nvar _array = require(\"../../core/utils/array\");\r\nvar _array2 = _interopRequireDefault(_array);\r\nvar _common = require(\"../../core/utils/common\");\r\nvar _type = require(\"../../core/utils/type\");\r\nvar _object = require(\"../../core/utils/object\");\r\nvar _object2 = _interopRequireDefault(_object);\r\nvar _iterator = require(\"../../core/utils/iterator\");\r\nvar _iterator2 = _interopRequireDefault(_iterator);\r\nvar _extend = require(\"../../core/utils/extend\");\r\nvar _query = require(\"../../data/query\");\r\nvar _query2 = _interopRequireDefault(_query);\r\nvar _data = require(\"../../core/utils/data\");\r\nvar _data2 = _interopRequireDefault(_data);\r\nvar _data_source = require(\"../../data/data_source/data_source\");\r\nvar _data_source2 = _interopRequireDefault(_data_source);\r\nvar _deferred = require(\"../../core/utils/deferred\");\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\n\r\nfunction _classCallCheck(instance, Constructor) {\r\n    if (!(instance instanceof Constructor)) {\r\n        throw new TypeError(\"Cannot call a class as a function\")\r\n    }\r\n}\r\n\r\nfunction _defineProperties(target, props) {\r\n    for (var i = 0; i < props.length; i++) {\r\n        var descriptor = props[i];\r\n        descriptor.enumerable = descriptor.enumerable || false;\r\n        descriptor.configurable = true;\r\n        if (\"value\" in descriptor) {\r\n            descriptor.writable = true\r\n        }\r\n        Object.defineProperty(target, descriptor.key, descriptor)\r\n    }\r\n}\r\n\r\nfunction _createClass(Constructor, protoProps, staticProps) {\r\n    if (protoProps) {\r\n        _defineProperties(Constructor.prototype, protoProps)\r\n    }\r\n    if (staticProps) {\r\n        _defineProperties(Constructor, staticProps)\r\n    }\r\n    return Constructor\r\n}\r\nvar getValueExpr = function(resource) {\r\n    return resource.valueExpr || \"id\"\r\n};\r\nvar getDisplayExpr = function(resource) {\r\n    return resource.displayExpr || \"text\"\r\n};\r\nvar ResourceManager = function() {\r\n    function ResourceManager(resources) {\r\n        _classCallCheck(this, ResourceManager);\r\n        this._resourceLoader = {};\r\n        this.setResources(resources)\r\n    }\r\n    _createClass(ResourceManager, [{\r\n        key: \"_wrapDataSource\",\r\n        value: function(dataSource) {\r\n            if (dataSource instanceof _data_source2.default.DataSource) {\r\n                return dataSource\r\n            } else {\r\n                return new _data_source2.default.DataSource({\r\n                    store: _data_source2.default.normalizeDataSourceOptions(dataSource).store,\r\n                    pageSize: 0\r\n                })\r\n            }\r\n        }\r\n    }, {\r\n        key: \"_mapResourceData\",\r\n        value: function(resource, data) {\r\n            var valueGetter = _data2.default.compileGetter(getValueExpr(resource));\r\n            var displayGetter = _data2.default.compileGetter(getDisplayExpr(resource));\r\n            return _iterator2.default.map(data, function(item) {\r\n                var result = {\r\n                    id: valueGetter(item),\r\n                    text: displayGetter(item)\r\n                };\r\n                if (item.color) {\r\n                    result.color = item.color\r\n                }\r\n                return result\r\n            })\r\n        }\r\n    }, {\r\n        key: \"_isMultipleResource\",\r\n        value: function(resourceField) {\r\n            var result = false;\r\n            _iterator2.default.each(this.getResources(), function(_, resource) {\r\n                var field = this.getField(resource);\r\n                if (field === resourceField) {\r\n                    result = resource.allowMultiple;\r\n                    return false\r\n                }\r\n            }.bind(this));\r\n            return result\r\n        }\r\n    }, {\r\n        key: \"getDataAccessors\",\r\n        value: function(field, type) {\r\n            var result = null;\r\n            _iterator2.default.each(this._dataAccessors[type], function(accessorName, accessors) {\r\n                if (field === accessorName) {\r\n                    result = accessors;\r\n                    return false\r\n                }\r\n            });\r\n            return result\r\n        }\r\n    }, {\r\n        key: \"getField\",\r\n        value: function(resource) {\r\n            return resource.fieldExpr || resource.field\r\n        }\r\n    }, {\r\n        key: \"setResources\",\r\n        value: function(resources) {\r\n            this._resources = resources;\r\n            this._dataAccessors = {\r\n                getter: {},\r\n                setter: {}\r\n            };\r\n            this._resourceFields = _iterator2.default.map(resources || [], function(resource) {\r\n                var field = this.getField(resource);\r\n                this._dataAccessors.getter[field] = _data2.default.compileGetter(field);\r\n                this._dataAccessors.setter[field] = _data2.default.compileSetter(field);\r\n                return field\r\n            }.bind(this))\r\n        }\r\n    }, {\r\n        key: \"getResources\",\r\n        value: function() {\r\n            return this._resources || []\r\n        }\r\n    }, {\r\n        key: \"getResourcesData\",\r\n        value: function() {\r\n            return this._resourcesData || []\r\n        }\r\n    }, {\r\n        key: \"getEditors\",\r\n        value: function() {\r\n            var result = [];\r\n            var that = this;\r\n            _iterator2.default.each(this.getResources(), function(i, resource) {\r\n                var field = that.getField(resource);\r\n                var currentResourceItems = that._getResourceDataByField(field);\r\n                result.push({\r\n                    editorOptions: {\r\n                        dataSource: currentResourceItems.length ? currentResourceItems : that._wrapDataSource(resource.dataSource),\r\n                        displayExpr: getDisplayExpr(resource),\r\n                        valueExpr: getValueExpr(resource)\r\n                    },\r\n                    dataField: field,\r\n                    editorType: resource.allowMultiple ? \"dxTagBox\" : \"dxSelectBox\",\r\n                    label: {\r\n                        text: resource.label || field\r\n                    }\r\n                })\r\n            });\r\n            return result\r\n        }\r\n    }, {\r\n        key: \"getResourceDataByValue\",\r\n        value: function(field, value) {\r\n            var that = this;\r\n            var result = new _deferred.Deferred;\r\n            _iterator2.default.each(this.getResources(), function(_, resource) {\r\n                var resourceField = that.getField(resource);\r\n                if (resourceField === field) {\r\n                    var dataSource = that._wrapDataSource(resource.dataSource);\r\n                    var valueExpr = getValueExpr(resource);\r\n                    if (!that._resourceLoader[field]) {\r\n                        that._resourceLoader[field] = dataSource.load()\r\n                    }\r\n                    that._resourceLoader[field].done(function(data) {\r\n                        var filteredData = (0, _query2.default)(data).filter(valueExpr, value).toArray();\r\n                        delete that._resourceLoader[field];\r\n                        result.resolve(filteredData[0])\r\n                    }).fail(function() {\r\n                        delete that._resourceLoader[field];\r\n                        result.reject()\r\n                    });\r\n                    return false\r\n                }\r\n            });\r\n            return result.promise()\r\n        }\r\n    }, {\r\n        key: \"setResourcesToItem\",\r\n        value: function(itemData, resources) {\r\n            var resourcesSetter = this._dataAccessors.setter;\r\n            for (var name in resources) {\r\n                if (Object.prototype.hasOwnProperty.call(resources, name)) {\r\n                    var resourceData = resources[name];\r\n                    resourcesSetter[name](itemData, this._isMultipleResource(name) ? _array2.default.wrapToArray(resourceData) : resourceData)\r\n                }\r\n            }\r\n        }\r\n    }, {\r\n        key: \"getResourcesFromItem\",\r\n        value: function(itemData, wrapOnlyMultipleResources) {\r\n            var _this = this;\r\n            var result = null;\r\n            if (!(0, _type.isDefined)(wrapOnlyMultipleResources)) {\r\n                wrapOnlyMultipleResources = false\r\n            }\r\n            this._resourceFields.forEach(function(field) {\r\n                _iterator2.default.each(itemData, function(fieldName, fieldValue) {\r\n                    var tempObject = {};\r\n                    tempObject[fieldName] = fieldValue;\r\n                    var resourceData = _this.getDataAccessors(field, \"getter\")(tempObject);\r\n                    if ((0, _type.isDefined)(resourceData)) {\r\n                        if (!result) {\r\n                            result = {}\r\n                        }\r\n                        if (1 === resourceData.length) {\r\n                            resourceData = resourceData[0]\r\n                        }\r\n                        if (!wrapOnlyMultipleResources || wrapOnlyMultipleResources && _this._isMultipleResource(field)) {\r\n                            _this.getDataAccessors(field, \"setter\")(tempObject, _array2.default.wrapToArray(resourceData))\r\n                        } else {\r\n                            _this.getDataAccessors(field, \"setter\")(tempObject, resourceData)\r\n                        }(0, _extend.extend)(result, tempObject);\r\n                        return true\r\n                    }\r\n                })\r\n            });\r\n            return result\r\n        }\r\n    }, {\r\n        key: \"loadResources\",\r\n        value: function(groups) {\r\n            var result = new _deferred.Deferred;\r\n            var that = this;\r\n            var deferreds = [];\r\n            _iterator2.default.each(this.getResourcesByFields(groups), function(i, resource) {\r\n                var deferred = new _deferred.Deferred;\r\n                var field = that.getField(resource);\r\n                deferreds.push(deferred);\r\n                that._wrapDataSource(resource.dataSource).load().done(function(data) {\r\n                    deferred.resolve({\r\n                        name: field,\r\n                        items: that._mapResourceData(resource, data),\r\n                        data: data\r\n                    })\r\n                }).fail(function() {\r\n                    deferred.reject()\r\n                })\r\n            });\r\n            if (!deferreds.length) {\r\n                that._resourcesData = [];\r\n                return result.resolve([])\r\n            }\r\n            _deferred.when.apply(null, deferreds).done(function() {\r\n                var data = Array.prototype.slice.call(arguments);\r\n                var mapFunction = function(obj) {\r\n                    return {\r\n                        name: obj.name,\r\n                        items: obj.items,\r\n                        data: obj.data\r\n                    }\r\n                };\r\n                that._resourcesData = data;\r\n                result.resolve(data.map(mapFunction))\r\n            }).fail(function() {\r\n                result.reject()\r\n            });\r\n            return result.promise()\r\n        }\r\n    }, {\r\n        key: \"getResourcesByFields\",\r\n        value: function(fields) {\r\n            return (0, _common.grep)(this.getResources(), function(resource) {\r\n                var field = this.getField(resource);\r\n                return (0, _array.inArray)(field, fields) > -1\r\n            }.bind(this))\r\n        }\r\n    }, {\r\n        key: \"getResourceByField\",\r\n        value: function(field) {\r\n            return this.getResourcesByFields([field])[0] || {}\r\n        }\r\n    }, {\r\n        key: \"getResourceColor\",\r\n        value: function(field, value) {\r\n            var valueExpr = this.getResourceByField(field).valueExpr || \"id\";\r\n            var valueGetter = _data2.default.compileGetter(valueExpr);\r\n            var colorExpr = this.getResourceByField(field).colorExpr || \"color\";\r\n            var colorGetter = _data2.default.compileGetter(colorExpr);\r\n            var result = new _deferred.Deferred;\r\n            var resourceData = this._getResourceDataByField(field);\r\n            var resourceDataLength = resourceData.length;\r\n            var color;\r\n            if (resourceDataLength) {\r\n                for (var i = 0; i < resourceDataLength; i++) {\r\n                    if (valueGetter(resourceData[i]) === value) {\r\n                        color = colorGetter(resourceData[i]);\r\n                        break\r\n                    }\r\n                }\r\n                result.resolve(color)\r\n            } else {\r\n                this.getResourceDataByValue(field, value).done(function(resourceData) {\r\n                    if (resourceData) {\r\n                        color = colorGetter(resourceData)\r\n                    }\r\n                    result.resolve(color)\r\n                }).fail(function() {\r\n                    result.reject()\r\n                })\r\n            }\r\n            return result.promise()\r\n        }\r\n    }, {\r\n        key: \"getResourceForPainting\",\r\n        value: function(groups) {\r\n            var resources = this.getResources();\r\n            var result;\r\n            _iterator2.default.each(resources, function(index, resource) {\r\n                if (resource.useColorAsDefault) {\r\n                    result = resource;\r\n                    return false\r\n                }\r\n            });\r\n            if (!result) {\r\n                if (Array.isArray(groups) && groups.length) {\r\n                    resources = this.getResourcesByFields(groups)\r\n                }\r\n                result = resources[resources.length - 1]\r\n            }\r\n            return result\r\n        }\r\n    }, {\r\n        key: \"createResourcesTree\",\r\n        value: function(groups) {\r\n            var leafIndex = 0;\r\n            var groupIndex = groupIndex || 0;\r\n\r\n            function make(group, groupIndex, result, parent) {\r\n                result = result || [];\r\n                for (var i = 0; i < group.items.length; i++) {\r\n                    var currentGroupItem = group.items[i];\r\n                    var resultItem = {\r\n                        name: group.name,\r\n                        value: currentGroupItem.id,\r\n                        title: currentGroupItem.text,\r\n                        data: group.data && group.data[i],\r\n                        children: [],\r\n                        parent: parent ? parent : null\r\n                    };\r\n                    result.push(resultItem);\r\n                    var nextGroupIndex = groupIndex + 1;\r\n                    if (groups[nextGroupIndex]) {\r\n                        make.call(this, groups[nextGroupIndex], nextGroupIndex, resultItem.children, resultItem)\r\n                    }\r\n                    if (!resultItem.children.length) {\r\n                        resultItem.leafIndex = leafIndex;\r\n                        leafIndex++\r\n                    }\r\n                }\r\n                return result\r\n            }\r\n            return make.call(this, groups[0], 0)\r\n        }\r\n    }, {\r\n        key: \"_hasGroupItem\",\r\n        value: function(appointmentResources, groupName, itemValue) {\r\n            var group = this.getDataAccessors(groupName, \"getter\")(appointmentResources);\r\n            if (group) {\r\n                if ((0, _array.inArray)(itemValue, group) > -1) {\r\n                    return true\r\n                }\r\n            }\r\n            return false\r\n        }\r\n    }, {\r\n        key: \"_getResourceDataByField\",\r\n        value: function(fieldName) {\r\n            var loadedResources = this.getResourcesData();\r\n            var currentResourceData = [];\r\n            for (var i = 0, resourceCount = loadedResources.length; i < resourceCount; i++) {\r\n                if (loadedResources[i].name === fieldName) {\r\n                    currentResourceData = loadedResources[i].data;\r\n                    break\r\n                }\r\n            }\r\n            return currentResourceData\r\n        }\r\n    }, {\r\n        key: \"getResourceTreeLeaves\",\r\n        value: function(tree, appointmentResources, result) {\r\n            result = result || [];\r\n            for (var i = 0; i < tree.length; i++) {\r\n                if (!this._hasGroupItem(appointmentResources, tree[i].name, tree[i].value)) {\r\n                    continue\r\n                }\r\n                if ((0, _type.isDefined)(tree[i].leafIndex)) {\r\n                    result.push(tree[i].leafIndex)\r\n                }\r\n                if (tree[i].children) {\r\n                    this.getResourceTreeLeaves(tree[i].children, appointmentResources, result)\r\n                }\r\n            }\r\n            return result\r\n        }\r\n    }, {\r\n        key: \"groupAppointmentsByResources\",\r\n        value: function(appointments, resources) {\r\n            var tree = this.createResourcesTree(resources);\r\n            var result = {};\r\n            _iterator2.default.each(appointments, function(_, appointment) {\r\n                var appointmentResources = this.getResourcesFromItem(appointment);\r\n                var treeLeaves = this.getResourceTreeLeaves(tree, appointmentResources);\r\n                for (var i = 0; i < treeLeaves.length; i++) {\r\n                    if (!result[treeLeaves[i]]) {\r\n                        result[treeLeaves[i]] = []\r\n                    }\r\n                    result[treeLeaves[i]].push(_object2.default.deepExtendArraySafe({}, appointment, true))\r\n                }\r\n            }.bind(this));\r\n            return result\r\n        }\r\n    }, {\r\n        key: \"reduceResourcesTree\",\r\n        value: function(tree, existingAppointments, _result) {\r\n            _result = _result ? _result.children : [];\r\n            var that = this;\r\n            tree.forEach(function(node, index) {\r\n                var ok = false;\r\n                var resourceName = node.name;\r\n                var resourceValue = node.value;\r\n                var resourceTitle = node.title;\r\n                var resourceData = node.data;\r\n                var resourceGetter = that.getDataAccessors(resourceName, \"getter\");\r\n                existingAppointments.forEach(function(appointment) {\r\n                    if (!ok) {\r\n                        var resourceFromAppointment = resourceGetter(appointment);\r\n                        if (Array.isArray(resourceFromAppointment)) {\r\n                            if (resourceFromAppointment.indexOf(resourceValue) > -1) {\r\n                                _result.push({\r\n                                    name: resourceName,\r\n                                    value: resourceValue,\r\n                                    title: resourceTitle,\r\n                                    data: resourceData,\r\n                                    children: []\r\n                                });\r\n                                ok = true\r\n                            }\r\n                        } else {\r\n                            if (resourceFromAppointment === resourceValue) {\r\n                                _result.push({\r\n                                    name: resourceName,\r\n                                    value: resourceValue,\r\n                                    title: resourceTitle,\r\n                                    data: resourceData,\r\n                                    children: []\r\n                                });\r\n                                ok = true\r\n                            }\r\n                        }\r\n                    }\r\n                });\r\n                if (ok && node.children && node.children.length) {\r\n                    that.reduceResourcesTree(node.children, existingAppointments, _result[index])\r\n                }\r\n            });\r\n            return _result\r\n        }\r\n    }]);\r\n    return ResourceManager\r\n}();\r\nexports.default = ResourceManager;\r\n"]},"metadata":{},"sourceType":"module"}