{"ast":null,"code":"/**\r\n * DevExtreme (ui/tree_view/ui.tree_view.base.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar _renderer = require(\"../../core/renderer\");\n\nvar _renderer2 = _interopRequireDefault(_renderer);\n\nvar _dom_adapter = require(\"../../core/dom_adapter\");\n\nvar _events_engine = require(\"../../events/core/events_engine\");\n\nvar _message = require(\"../../localization/message\");\n\nvar _message2 = _interopRequireDefault(_message);\n\nvar _click = require(\"../../events/click\");\n\nvar _click2 = _interopRequireDefault(_click);\n\nvar _common = require(\"../../core/utils/common\");\n\nvar _common2 = _interopRequireDefault(_common);\n\nvar _window = require(\"../../core/utils/window\");\n\nvar _window2 = _interopRequireDefault(_window);\n\nvar _type = require(\"../../core/utils/type\");\n\nvar _extend = require(\"../../core/utils/extend\");\n\nvar _iterator = require(\"../../core/utils/iterator\");\n\nvar _dom = require(\"../../core/utils/dom\");\n\nvar _check_box = require(\"../check_box\");\n\nvar _check_box2 = _interopRequireDefault(_check_box);\n\nvar _ui = require(\"../hierarchical_collection/ui.hierarchical_collection_widget\");\n\nvar _ui2 = _interopRequireDefault(_ui);\n\nvar _utils = require(\"../../events/utils\");\n\nvar _pointer = require(\"../../events/pointer\");\n\nvar _double_click = require(\"../../events/double_click\");\n\nvar _double_click2 = _interopRequireDefault(_double_click);\n\nvar _fx = require(\"../../animation/fx\");\n\nvar _fx2 = _interopRequireDefault(_fx);\n\nvar _ui3 = require(\"../scroll_view/ui.scrollable\");\n\nvar _ui4 = _interopRequireDefault(_ui3);\n\nvar _load_indicator = require(\"../load_indicator\");\n\nvar _load_indicator2 = _interopRequireDefault(_load_indicator);\n\nvar _deferred = require(\"../../core/utils/deferred\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nvar WIDGET_CLASS = \"dx-treeview\";\nvar NODE_CLASS = \"\".concat(WIDGET_CLASS, \"-node\");\nvar NODE_CONTAINER_CLASS = \"\".concat(NODE_CLASS, \"-container\");\nvar NODE_LOAD_INDICATOR_CLASS = \"\".concat(NODE_CLASS, \"-loadindicator\");\nvar OPENED_NODE_CONTAINER_CLASS = \"\".concat(NODE_CLASS, \"-container-opened\");\nvar IS_LEAF = \"\".concat(NODE_CLASS, \"-is-leaf\");\nvar ITEM_CLASS = \"\".concat(WIDGET_CLASS, \"-item\");\nvar ITEM_WITH_CHECKBOX_CLASS = \"\".concat(ITEM_CLASS, \"-with-checkbox\");\nvar ITEM_WITHOUT_CHECKBOX_CLASS = \"\".concat(ITEM_CLASS, \"-without-checkbox\");\nvar ITEM_DATA_KEY = \"\".concat(ITEM_CLASS, \"-data\");\nvar TOGGLE_ITEM_VISIBILITY_CLASS = \"\".concat(WIDGET_CLASS, \"-toggle-item-visibility\");\nvar LOAD_INDICATOR_CLASS = \"\".concat(WIDGET_CLASS, \"-loadindicator\");\nvar LOAD_INDICATOR_WRAPPER_CLASS = \"\".concat(WIDGET_CLASS, \"-loadindicator-wrapper\");\nvar TOGGLE_ITEM_VISIBILITY_OPENED_CLASS = \"\".concat(WIDGET_CLASS, \"-toggle-item-visibility-opened\");\nvar SELECT_ALL_ITEM_CLASS = \"\".concat(WIDGET_CLASS, \"-select-all-item\");\nvar INVISIBLE_STATE_CLASS = \"dx-state-invisible\";\nvar DISABLED_STATE_CLASS = \"dx-state-disabled\";\nvar SELECTED_ITEM_CLASS = \"dx-state-selected\";\nvar EXPAND_EVENT_NAMESPACE = \"dxTreeView_expand\";\nvar DATA_ITEM_ID = \"data-item-id\";\n\nvar TreeViewBase = _ui2.default.inherit({\n  _supportedKeys: function _supportedKeys(e) {\n    var _this = this;\n\n    var click = function click(e) {\n      var $itemElement = (0, _renderer2.default)(_this.option(\"focusedElement\"));\n\n      if (!$itemElement.length) {\n        return;\n      }\n\n      e.target = $itemElement;\n      e.currentTarget = $itemElement;\n\n      _this._itemClickHandler(e, $itemElement.children(\".\" + ITEM_CLASS));\n\n      var expandEventName = _this._getEventNameByOption(_this.option(\"expandEvent\"));\n\n      var expandByClick = expandEventName === (0, _utils.addNamespace)(_click2.default.name, EXPAND_EVENT_NAMESPACE);\n\n      if (expandByClick) {\n        _this._expandEventHandler(e);\n      }\n    };\n\n    var select = function select(e) {\n      e.preventDefault();\n\n      _this._changeCheckBoxState((0, _renderer2.default)(_this.option(\"focusedElement\")));\n    };\n\n    var toggleExpandedNestedItems = function toggleExpandedNestedItems(state, e) {\n      if (!this.option(\"expandAllEnabled\")) {\n        return;\n      }\n\n      e.preventDefault();\n      var $rootElement = (0, _renderer2.default)(this.option(\"focusedElement\"));\n\n      if (!$rootElement.length) {\n        return;\n      }\n\n      var rootItem = this._getItemData($rootElement.find(\".\".concat(ITEM_CLASS)));\n\n      this._toggleExpandedNestedItems([rootItem], state);\n    };\n\n    return (0, _extend.extend)(this.callBase(), {\n      enter: this._showCheckboxes() ? select : click,\n      space: this._showCheckboxes() ? select : click,\n      asterisk: toggleExpandedNestedItems.bind(this, true),\n      minus: toggleExpandedNestedItems.bind(this, false)\n    });\n  },\n  _changeCheckBoxState: function _changeCheckBoxState($element) {\n    var checkboxInstance = this._getCheckBoxInstance($element);\n\n    var currentState = checkboxInstance.option(\"value\");\n\n    if (!checkboxInstance.option(\"disabled\")) {\n      this._updateItemSelection(!currentState, $element.find(\".\" + ITEM_CLASS).get(0), true, $element);\n    }\n  },\n  _toggleExpandedNestedItems: function _toggleExpandedNestedItems(items, state) {\n    if (!items) {\n      return;\n    }\n\n    for (var i = 0, len = items.length; i < len; i++) {\n      var item = items[i];\n\n      var node = this._dataAdapter.getNodeByItem(item);\n\n      this._toggleExpandedState(node, state);\n\n      this._toggleExpandedNestedItems(item.items, state);\n    }\n  },\n  _getNodeElement: function _getNodeElement(node, cache) {\n    var key = this._encodeString(node.internalFields.key);\n\n    if (cache) {\n      if (!cache.$nodeByKey) {\n        cache.$nodeByKey = {};\n        this.$element().find(\".\".concat(NODE_CLASS)).each(function () {\n          var $node = (0, _renderer2.default)(this);\n          var key = $node.attr(DATA_ITEM_ID);\n          cache.$nodeByKey[key] = $node;\n        });\n      }\n\n      return cache.$nodeByKey[key] || (0, _renderer2.default)();\n    }\n\n    var element = this.$element().get(0).querySelector(\"[\".concat(DATA_ITEM_ID, '=\"').concat(key, '\"]'));\n    return (0, _renderer2.default)(element);\n  },\n  _activeStateUnit: \".\" + ITEM_CLASS,\n  _widgetClass: function _widgetClass() {\n    return WIDGET_CLASS;\n  },\n  _getDefaultOptions: function _getDefaultOptions() {\n    return (0, _extend.extend)(this.callBase(), {\n      animationEnabled: true,\n      dataStructure: \"tree\",\n      deferRendering: true,\n      expandAllEnabled: false,\n      hasItemsExpr: \"hasItems\",\n      selectNodesRecursive: true,\n      expandNodesRecursive: true,\n      showCheckBoxesMode: \"none\",\n      selectAllText: _message2.default.format(\"dxList-selectAll\"),\n      onItemSelectionChanged: null,\n      onItemExpanded: null,\n      onItemCollapsed: null,\n      scrollDirection: \"vertical\",\n      virtualModeEnabled: false,\n      rootValue: 0,\n      focusStateEnabled: false,\n      selectionMode: \"multiple\",\n      expandEvent: \"dblclick\",\n      selectByClick: false,\n      createChildren: null,\n      onSelectAllValueChanged: null\n    });\n  },\n  _initSelectedItems: _common2.default.noop,\n  _syncSelectionOptions: _common2.default.asyncNoop,\n  _fireSelectionChanged: function _fireSelectionChanged() {\n    var selectionChangePromise = this._selectionChangePromise;\n    (0, _deferred.when)(selectionChangePromise).done(function () {\n      this._createActionByOption(\"onSelectionChanged\", {\n        excludeValidators: [\"disabled\", \"readOnly\"]\n      })();\n    }.bind(this));\n  },\n  _createSelectAllValueChangedAction: function _createSelectAllValueChangedAction() {\n    this._selectAllValueChangedAction = this._createActionByOption(\"onSelectAllValueChanged\", {\n      excludeValidators: [\"disabled\", \"readOnly\"]\n    });\n  },\n  _fireSelectAllValueChanged: function _fireSelectAllValueChanged(value) {\n    this._selectAllValueChangedAction({\n      value: value\n    });\n  },\n  _checkBoxModeChange: function _checkBoxModeChange(value, previousValue) {\n    if (\"none\" === previousValue || \"none\" === value) {\n      this.repaint();\n      return;\n    }\n\n    var selectAllExists = this._$selectAllItem && this._$selectAllItem.length;\n\n    switch (value) {\n      case \"selectAll\":\n        !selectAllExists && this._renderSelectAllItem();\n        break;\n\n      case \"normal\":\n        if (selectAllExists) {\n          this._$selectAllItem.remove();\n\n          delete this._$selectAllItem;\n        }\n\n    }\n  },\n  _removeSelection: function _removeSelection() {\n    var that = this;\n    (0, _iterator.each)(this._dataAdapter.getFullData(), function (_, node) {\n      if (!that._hasChildren(node)) {\n        return;\n      }\n\n      that._dataAdapter.toggleSelection(node.internalFields.key, false, true);\n    });\n  },\n  _optionChanged: function _optionChanged(args) {\n    var name = args.name,\n        value = args.value,\n        previousValue = args.previousValue;\n\n    switch (name) {\n      case \"selectAllText\":\n        if (this._$selectAllItem) {\n          this._$selectAllItem.dxCheckBox(\"instance\").option(\"text\", value);\n        }\n\n        break;\n\n      case \"showCheckBoxesMode\":\n        this._checkBoxModeChange(value, previousValue);\n\n        break;\n\n      case \"scrollDirection\":\n        this._scrollableContainer.option(\"direction\", value);\n\n        break;\n\n      case \"items\":\n        delete this._$selectAllItem;\n        this.callBase(args);\n        break;\n\n      case \"dataSource\":\n        this.callBase(args);\n\n        this._initDataAdapter();\n\n        this._filter = {};\n        break;\n\n      case \"hasItemsExpr\":\n        this._initAccessors();\n\n        this.repaint();\n        break;\n\n      case \"expandEvent\":\n        this._initExpandEvent();\n\n        break;\n\n      case \"deferRendering\":\n      case \"dataStructure\":\n      case \"rootValue\":\n      case \"createChildren\":\n      case \"expandNodesRecursive\":\n      case \"onItemSelectionChanged\":\n      case \"onItemExpanded\":\n      case \"onItemCollapsed\":\n      case \"expandAllEnabled\":\n      case \"animationEnabled\":\n      case \"virtualModeEnabled\":\n      case \"selectByClick\":\n        break;\n\n      case \"selectionMode\":\n        this._initDataAdapter();\n\n        this.callBase(args);\n        break;\n\n      case \"onSelectAllValueChanged\":\n        this._createSelectAllValueChangedAction();\n\n        break;\n\n      case \"selectNodesRecursive\":\n        this._dataAdapter.setOption(\"recursiveSelection\", args.value);\n\n        this.repaint();\n        break;\n\n      default:\n        this.callBase(args);\n    }\n  },\n  _initDataSource: function _initDataSource() {\n    if (this._useCustomChildrenLoader()) {\n      this._loadChildrenByCustomLoader(null).done(function (newItems) {\n        if (newItems && newItems.length) {\n          this.option(\"items\", newItems);\n        }\n      }.bind(this));\n    } else {\n      this.callBase();\n      this._isVirtualMode() && this._initVirtualMode();\n    }\n  },\n  _initVirtualMode: function _initVirtualMode() {\n    var filter = this._filter;\n\n    if (!filter.custom) {\n      filter.custom = this._dataSource.filter();\n    }\n\n    if (!filter.internal) {\n      filter.internal = [this.option(\"parentIdExpr\"), this.option(\"rootValue\")];\n    }\n  },\n  _useCustomChildrenLoader: function _useCustomChildrenLoader() {\n    return (0, _type.isFunction)(this.option(\"createChildren\")) && this._isDataStructurePlain();\n  },\n  _loadChildrenByCustomLoader: function _loadChildrenByCustomLoader(parentNode) {\n    var invocationResult = this.option(\"createChildren\").call(this, parentNode);\n\n    if (Array.isArray(invocationResult)) {\n      return new _deferred.Deferred().resolve(invocationResult).promise();\n    }\n\n    if (invocationResult && (0, _type.isFunction)(invocationResult.then)) {\n      return (0, _deferred.fromPromise)(invocationResult);\n    }\n\n    return new _deferred.Deferred().resolve([]).promise();\n  },\n  _combineFilter: function _combineFilter() {\n    if (!this._filter.custom || !this._filter.custom.length) {\n      return this._filter.internal;\n    }\n\n    return [this._filter.custom, this._filter.internal];\n  },\n  _dataSourceLoadErrorHandler: function _dataSourceLoadErrorHandler() {\n    this._renderEmptyMessage();\n  },\n  _init: function _init() {\n    this._filter = {};\n    this.callBase();\n\n    this._initStoreChangeHandlers();\n  },\n  _dataSourceChangedHandler: function _dataSourceChangedHandler(newItems) {\n    var items = this.option(\"items\");\n\n    if (this._initialized && this._isVirtualMode() && items.length) {\n      return;\n    }\n\n    this.option(\"items\", newItems);\n  },\n  _removeTreeViewLoadIndicator: function _removeTreeViewLoadIndicator() {\n    if (!this._treeViewLoadIndicator) {\n      return;\n    }\n\n    this._treeViewLoadIndicator.remove();\n\n    this._treeViewLoadIndicator = null;\n  },\n  _createTreeViewLoadIndicator: function _createTreeViewLoadIndicator() {\n    this._treeViewLoadIndicator = (0, _renderer2.default)(\"<div>\").addClass(LOAD_INDICATOR_CLASS);\n\n    this._createComponent(this._treeViewLoadIndicator, _load_indicator2.default, {});\n\n    return this._treeViewLoadIndicator;\n  },\n  _dataSourceLoadingChangedHandler: function _dataSourceLoadingChangedHandler(isLoading) {\n    var resultFilter;\n\n    if (this._isVirtualMode()) {\n      resultFilter = this._combineFilter();\n\n      this._dataSource.filter(resultFilter);\n    }\n\n    if (isLoading && !this._dataSource.isLoaded()) {\n      this.option(\"items\", []);\n      var $wrapper = (0, _renderer2.default)(\"<div>\").addClass(LOAD_INDICATOR_WRAPPER_CLASS);\n\n      this._createTreeViewLoadIndicator().appendTo($wrapper);\n\n      this.itemsContainer().append($wrapper);\n\n      if (this._isVirtualMode() && this._dataSource.filter() !== resultFilter) {\n        this._dataSource.filter([]);\n      }\n    } else {\n      this._removeTreeViewLoadIndicator();\n    }\n  },\n  _initStoreChangeHandlers: function _initStoreChangeHandlers() {\n    var _this2 = this;\n\n    if (\"plain\" !== this.option(\"dataStructure\")) {\n      return;\n    }\n\n    this._dataSource && this._dataSource.store().on(\"inserted\", function (newItem) {\n      _this2.option().items = _this2.option(\"items\").concat(newItem);\n\n      _this2._dataAdapter.addItem(newItem);\n\n      if (!_this2._dataAdapter.isFiltered(newItem)) {\n        return;\n      }\n\n      _this2._updateLevel(_this2._parentIdGetter(newItem));\n    }).on(\"removed\", function (removedKey) {\n      var node = _this2._dataAdapter.getNodeByKey(removedKey);\n\n      _this2.option(\"items\")[_this2._dataAdapter.getIndexByKey(node.internalFields.key)] = 0;\n\n      _this2._markChildrenItemsToRemove(node);\n\n      _this2._removeItems();\n\n      _this2._dataAdapter.removeItem(removedKey);\n\n      _this2._updateLevel(_this2._parentIdGetter(node));\n    });\n  },\n  _markChildrenItemsToRemove: function _markChildrenItemsToRemove(node) {\n    var _this3 = this;\n\n    var keys = node.internalFields.childrenKeys;\n    (0, _iterator.each)(keys, function (_, key) {\n      _this3.option(\"items\")[_this3._dataAdapter.getIndexByKey(key)] = 0;\n\n      _this3._markChildrenItemsToRemove(_this3._dataAdapter.getNodeByKey(key));\n    });\n  },\n  _removeItems: function _removeItems() {\n    var _this4 = this;\n\n    var items = (0, _extend.extend)(true, [], this.option(\"items\"));\n    var counter = 0;\n    (0, _iterator.each)(items, function (index, item) {\n      if (!item) {\n        _this4.option(\"items\").splice(index - counter, 1);\n\n        counter++;\n      }\n    });\n  },\n  _updateLevel: function _updateLevel(parentId) {\n    var $container = this._getContainerByParentKey(parentId);\n\n    this._renderItems($container, this._dataAdapter.getChildrenNodes(parentId));\n  },\n  _getOldContainer: function _getOldContainer($itemElement) {\n    if ($itemElement.length) {\n      return $itemElement.children(\".\".concat(NODE_CONTAINER_CLASS));\n    }\n\n    if (this._scrollableContainer) {\n      return this._scrollableContainer.$content().children();\n    }\n\n    return (0, _renderer2.default)();\n  },\n  _getContainerByParentKey: function _getContainerByParentKey(parentId) {\n    var node = this._dataAdapter.getNodeByKey(parentId);\n\n    var $itemElement = node ? this._getNodeElement(node) : [];\n\n    this._getOldContainer($itemElement).remove();\n\n    var $container = this._renderNodeContainer($itemElement);\n\n    if (this._isRootLevel(parentId)) {\n      if (!this._scrollableContainer) {\n        this._renderScrollableContainer();\n      }\n\n      this._scrollableContainer.$content().append($container);\n    }\n\n    return $container;\n  },\n  _isRootLevel: function _isRootLevel(parentId) {\n    return parentId === this.option(\"rootValue\");\n  },\n  _getAccessors: function _getAccessors() {\n    var accessors = this.callBase();\n    accessors.push(\"hasItems\");\n    return accessors;\n  },\n  _getDataAdapterOptions: function _getDataAdapterOptions() {\n    return {\n      rootValue: this.option(\"rootValue\"),\n      multipleSelection: !this._isSingleSelection(),\n      recursiveSelection: this._isRecursiveSelection(),\n      recursiveExpansion: this.option(\"expandNodesRecursive\"),\n      selectionRequired: this.option(\"selectionRequired\"),\n      dataType: this.option(\"dataStructure\"),\n      sort: this._dataSource && this._dataSource.sort()\n    };\n  },\n  _initMarkup: function _initMarkup() {\n    this._renderScrollableContainer();\n\n    this._renderEmptyMessage(this._dataAdapter.getRootNodes());\n\n    this.callBase();\n    this.setAria(\"role\", \"tree\");\n  },\n  _renderContentImpl: function _renderContentImpl() {\n    var $nodeContainer = this._renderNodeContainer();\n\n    this._scrollableContainer.$content().append($nodeContainer);\n\n    if (!this.option(\"items\") || !this.option(\"items\").length) {\n      return;\n    }\n\n    this._renderItems($nodeContainer, this._dataAdapter.getRootNodes());\n\n    this._initExpandEvent();\n\n    if (this._selectAllEnabled()) {\n      this._createSelectAllValueChangedAction();\n\n      this._renderSelectAllItem($nodeContainer);\n    }\n  },\n  _isVirtualMode: function _isVirtualMode() {\n    return this.option(\"virtualModeEnabled\") && this._isDataStructurePlain() && !!this.option(\"dataSource\");\n  },\n  _isDataStructurePlain: function _isDataStructurePlain() {\n    return \"plain\" === this.option(\"dataStructure\");\n  },\n  _fireContentReadyAction: function _fireContentReadyAction() {\n    var dataSource = this.getDataSource();\n    var skipContentReadyAction = dataSource && !dataSource.isLoaded();\n\n    if (!skipContentReadyAction) {\n      this.callBase();\n    }\n\n    if (this._scrollableContainer && _window2.default.hasWindow()) {\n      this._scrollableContainer.update();\n    }\n  },\n  _renderScrollableContainer: function _renderScrollableContainer() {\n    this._scrollableContainer = this._createComponent((0, _renderer2.default)(\"<div>\").appendTo(this.$element()), _ui4.default, {\n      direction: this.option(\"scrollDirection\"),\n      useKeyboard: false\n    });\n  },\n  _renderNodeContainer: function _renderNodeContainer($parent) {\n    var $container = (0, _renderer2.default)(\"<ul>\").addClass(NODE_CONTAINER_CLASS);\n    this.setAria(\"role\", \"group\", $container);\n\n    if ($parent && $parent.length) {\n      var itemData = this._getItemData($parent.children(\".\" + ITEM_CLASS));\n\n      if (this._expandedGetter(itemData)) {\n        $container.addClass(OPENED_NODE_CONTAINER_CLASS);\n      }\n\n      $container.appendTo($parent);\n    }\n\n    return $container;\n  },\n  _createDOMElement: function _createDOMElement($nodeContainer, node) {\n    var $node = (0, _renderer2.default)(\"<li>\").addClass(NODE_CLASS).attr(DATA_ITEM_ID, this._encodeString(node.internalFields.key)).prependTo($nodeContainer);\n    this.setAria({\n      role: \"treeitem\",\n      label: this._displayGetter(node.internalFields.item) || \"\",\n      expanded: node.internalFields.expanded || false,\n      level: this._getLevel($nodeContainer)\n    }, $node);\n    return $node;\n  },\n  _getLevel: function _getLevel($nodeContainer) {\n    var parent = $nodeContainer.parent();\n    return parent.hasClass(\"dx-scrollable-content\") ? 1 : parseInt(parent.attr(\"aria-level\")) + 1;\n  },\n  _showCheckboxes: function _showCheckboxes() {\n    return \"none\" !== this.option(\"showCheckBoxesMode\");\n  },\n  _selectAllEnabled: function _selectAllEnabled() {\n    return \"selectAll\" === this.option(\"showCheckBoxesMode\") && !this._isSingleSelection();\n  },\n  _renderItems: function _renderItems($nodeContainer, nodes) {\n    var length = nodes.length - 1;\n\n    for (var i = length; i >= 0; i--) {\n      this._renderItem(i, nodes[i], $nodeContainer);\n    }\n\n    this._renderedItemsCount += nodes.length;\n  },\n  _renderItem: function _renderItem(nodeIndex, node, $nodeContainer) {\n    var $node = this._createDOMElement($nodeContainer, node);\n\n    var nodeData = node.internalFields;\n\n    var showCheckBox = this._showCheckboxes();\n\n    $node.addClass(showCheckBox ? ITEM_WITH_CHECKBOX_CLASS : ITEM_WITHOUT_CHECKBOX_CLASS);\n    showCheckBox && this._renderCheckBox($node, node);\n    this.setAria(\"selected\", nodeData.selected, $node);\n\n    this._toggleSelectedClass($node, nodeData.selected);\n\n    this.callBase(this._renderedItemsCount + nodeIndex, nodeData.item, $node);\n\n    if (false !== nodeData.item.visible) {\n      this._renderChildren($node, node);\n    }\n  },\n  _setAriaSelected: function _setAriaSelected() {},\n  _renderChildren: function _renderChildren($node, node) {\n    var _this5 = this;\n\n    if (!this._hasChildren(node)) {\n      this._addLeafClass($node);\n\n      return;\n    }\n\n    this._renderToggleItemVisibilityIcon($node, node);\n\n    if (this.option(\"deferRendering\") && !node.internalFields.expanded) {\n      return;\n    }\n\n    this._loadSublevel(node).done(function (childNodes) {\n      _this5._renderSublevel($node, _this5._getActualNode(node), childNodes);\n    });\n  },\n  _getActualNode: function _getActualNode(cachedNode) {\n    return this._dataAdapter.getNodeByKey(cachedNode.internalFields.key);\n  },\n  _hasChildren: function _hasChildren(node) {\n    if (this._isVirtualMode() || this._useCustomChildrenLoader()) {\n      return false !== this._hasItemsGetter(node.internalFields.item);\n    }\n\n    return this.callBase(node);\n  },\n  _loadSublevel: function _loadSublevel(node) {\n    var _this6 = this;\n\n    var deferred = new _deferred.Deferred();\n\n    var childrenNodes = this._getChildNodes(node);\n\n    if (childrenNodes.length) {\n      deferred.resolve(childrenNodes);\n    } else {\n      this._loadNestedItems(node).done(function (items) {\n        deferred.resolve(_this6._dataAdapter.getNodesByItems(items));\n      });\n    }\n\n    return deferred.promise();\n  },\n  _renderSublevel: function _renderSublevel($node, node, childNodes) {\n    var $nestedNodeContainer = this._renderNodeContainer($node, node);\n\n    var childNodesByChildrenKeys = childNodes.filter(function (childNode) {\n      return node.internalFields.childrenKeys.indexOf(childNode.internalFields.key) !== -1;\n    });\n\n    this._renderItems($nestedNodeContainer, childNodesByChildrenKeys);\n\n    if (childNodesByChildrenKeys.length && !node.internalFields.selected) {\n      var firstChild = childNodesByChildrenKeys[0];\n\n      this._updateParentsState(firstChild, this._getNodeElement(firstChild));\n    }\n\n    this._normalizeIconState($node, childNodesByChildrenKeys.length);\n\n    if (node.internalFields.expanded) {\n      $nestedNodeContainer.addClass(OPENED_NODE_CONTAINER_CLASS);\n    }\n  },\n  _executeItemRenderAction: function _executeItemRenderAction(itemIndex, itemData, itemElement) {\n    var node = this._getNode(itemElement);\n\n    this._getItemRenderAction()({\n      itemElement: itemElement,\n      itemIndex: itemIndex,\n      itemData: itemData,\n      node: this._dataAdapter.getPublicNode(node)\n    });\n  },\n  _addLeafClass: function _addLeafClass($node) {\n    $node.addClass(IS_LEAF);\n  },\n  _expandEventHandler: function _expandEventHandler(e) {\n    var $nodeElement = (0, _renderer2.default)(e.currentTarget.parentNode);\n\n    if (!$nodeElement.hasClass(IS_LEAF)) {\n      this._toggleExpandedState(e.currentTarget, void 0, e);\n    }\n  },\n  _initExpandEvent: function _initExpandEvent() {\n    var expandedEventName = this._getEventNameByOption(this.option(\"expandEvent\"));\n\n    var $itemsContainer = this._itemContainer();\n\n    var itemSelector = this._itemSelector();\n\n    (0, _events_engine.off)($itemsContainer, \".\" + EXPAND_EVENT_NAMESPACE, itemSelector);\n    (0, _events_engine.on)($itemsContainer, expandedEventName, itemSelector, this._expandEventHandler.bind(this));\n  },\n  _getEventNameByOption: function _getEventNameByOption(name) {\n    var event = \"click\" === name ? _click2.default : _double_click2.default;\n    return (0, _utils.addNamespace)(event.name, EXPAND_EVENT_NAMESPACE);\n  },\n  _getNode: function _getNode(identifier) {\n    if (!(0, _type.isDefined)(identifier)) {\n      return null;\n    }\n\n    if (identifier.internalFields) {\n      return identifier;\n    }\n\n    if ((0, _type.isPrimitive)(identifier)) {\n      return this._dataAdapter.getNodeByKey(identifier);\n    }\n\n    var itemElement = (0, _renderer2.default)(identifier).get(0);\n\n    if (!itemElement) {\n      return null;\n    }\n\n    if ((0, _dom_adapter.isElementNode)(itemElement)) {\n      return this._getNodeByElement(itemElement);\n    }\n\n    return this._dataAdapter.getNodeByItem(itemElement);\n  },\n  _getNodeByElement: function _getNodeByElement(itemElement) {\n    var $node = (0, _renderer2.default)(itemElement).closest(\".\" + NODE_CLASS);\n\n    var key = this._decodeString($node.attr(DATA_ITEM_ID));\n\n    return this._dataAdapter.getNodeByKey(key);\n  },\n  _toggleExpandedState: function _toggleExpandedState(itemElement, state, e) {\n    var node = this._getNode(itemElement);\n\n    var currentState = node.internalFields.expanded;\n\n    if (node.internalFields.disabled || currentState === state) {\n      return;\n    }\n\n    if (this._hasChildren(node)) {\n      var $node = this._getNodeElement(node);\n\n      if ($node.find(\".\".concat(NODE_LOAD_INDICATOR_CLASS, \":not(.\").concat(INVISIBLE_STATE_CLASS, \")\")).length) {\n        return;\n      }\n\n      this._createLoadIndicator($node);\n    }\n\n    if (!(0, _type.isDefined)(state)) {\n      state = !currentState;\n    }\n\n    this._dataAdapter.toggleExpansion(node.internalFields.key, state);\n\n    this._updateExpandedItemsUI(node, state, e);\n  },\n  _createLoadIndicator: function _createLoadIndicator($node) {\n    var $icon = $node.children(\".\" + TOGGLE_ITEM_VISIBILITY_CLASS);\n    var $nodeContainer = $node.children(\".\".concat(NODE_CONTAINER_CLASS));\n\n    if ($icon.hasClass(TOGGLE_ITEM_VISIBILITY_OPENED_CLASS) || $nodeContainer.not(\":empty\").length) {\n      return;\n    }\n\n    this._createComponent((0, _renderer2.default)(\"<div>\").addClass(NODE_LOAD_INDICATOR_CLASS), _load_indicator2.default, {}).$element().appendTo($node);\n\n    $icon.hide();\n  },\n  _renderToggleItemVisibilityIcon: function _renderToggleItemVisibilityIcon($node, node) {\n    var $icon = (0, _renderer2.default)(\"<div>\").addClass(TOGGLE_ITEM_VISIBILITY_CLASS).appendTo($node);\n\n    if (node.internalFields.expanded) {\n      $icon.addClass(TOGGLE_ITEM_VISIBILITY_OPENED_CLASS);\n      $node.parent().addClass(OPENED_NODE_CONTAINER_CLASS);\n    }\n\n    if (node.internalFields.disabled) {\n      $icon.addClass(DISABLED_STATE_CLASS);\n    }\n\n    this._renderToggleItemVisibilityIconClick($icon, node);\n  },\n  _renderToggleItemVisibilityIconClick: function _renderToggleItemVisibilityIconClick($icon, node) {\n    var _this7 = this;\n\n    var eventName = (0, _utils.addNamespace)(_click2.default.name, this.NAME);\n    (0, _events_engine.off)($icon, eventName);\n    (0, _events_engine.on)($icon, eventName, function (e) {\n      _this7._toggleExpandedState(node.internalFields.key, void 0, e);\n    });\n  },\n  _updateExpandedItemsUI: function _updateExpandedItemsUI(node, state, e) {\n    var $node = this._getNodeElement(node);\n\n    var isHiddenNode = !$node.length || state && $node.is(\":hidden\");\n\n    if (this.option(\"expandNodesRecursive\") && isHiddenNode) {\n      var parentNode = this._getNode(node.internalFields.parentKey);\n\n      if (parentNode) {\n        this._updateExpandedItemsUI(parentNode, state, e);\n      }\n    }\n\n    var $icon = $node.children(\".\" + TOGGLE_ITEM_VISIBILITY_CLASS);\n    var $nodeContainer = $node.children(\".\".concat(NODE_CONTAINER_CLASS));\n    $icon.toggleClass(TOGGLE_ITEM_VISIBILITY_OPENED_CLASS, state);\n    var nodeContainerExists = $nodeContainer.length > 0;\n\n    if (!state || nodeContainerExists && !$nodeContainer.is(\":empty\")) {\n      this._updateExpandedItem(node, state, e);\n\n      return;\n    }\n\n    if (this._isVirtualMode() || this._useCustomChildrenLoader()) {\n      this._loadNestedItemsWithUpdate(node, state, e);\n\n      return;\n    }\n\n    this._renderSublevel($node, node, this._getChildNodes(node));\n\n    this._fireContentReadyAction();\n\n    this._updateExpandedItem(node, state, e);\n  },\n  _loadNestedItemsWithUpdate: function _loadNestedItemsWithUpdate(node, state, e) {\n    var _this8 = this;\n\n    var $node = this._getNodeElement(node);\n\n    this._loadNestedItems(node).done(function (items) {\n      var actualNodeData = _this8._getActualNode(node);\n\n      _this8._renderSublevel($node, actualNodeData, _this8._dataAdapter.getNodesByItems(items));\n\n      if (!items || !items.length) {\n        return;\n      }\n\n      _this8._fireContentReadyAction();\n\n      _this8._updateExpandedItem(actualNodeData, state, e);\n    });\n  },\n  _loadNestedItems: function _loadNestedItems(node) {\n    var _this9 = this;\n\n    if (this._useCustomChildrenLoader()) {\n      var publicNode = this._dataAdapter.getPublicNode(node);\n\n      return this._loadChildrenByCustomLoader(publicNode).done(function (newItems) {\n        if (!_this9._areNodesExists(newItems)) {\n          _this9._appendItems(newItems);\n        }\n      });\n    }\n\n    if (!this._isVirtualMode()) {\n      return new _deferred.Deferred().resolve([]).promise();\n    }\n\n    this._filter.internal = [this.option(\"parentIdExpr\"), node.internalFields.key];\n\n    this._dataSource.filter(this._combineFilter());\n\n    return this._dataSource.load().done(function (newItems) {\n      if (!_this9._areNodesExists(newItems)) {\n        _this9._appendItems(newItems);\n      }\n    });\n  },\n  _areNodesExists: function _areNodesExists(newItems, items) {\n    var keyOfRootItem = this.keyOf(newItems[0]);\n\n    var fullData = this._dataAdapter.getFullData();\n\n    return !!this._dataAdapter.getNodeByKey(keyOfRootItem, fullData);\n  },\n  _appendItems: function _appendItems(newItems) {\n    this.option().items = this.option(\"items\").concat(newItems);\n\n    this._initDataAdapter();\n  },\n  _updateExpandedItem: function _updateExpandedItem(node, state, e) {\n    this._animateNodeContainer(node, state, e);\n  },\n  _animateNodeContainer: function _animateNodeContainer(node, state, e) {\n    var $node = this._getNodeElement(node);\n\n    var $nodeContainer = $node.children(\".\".concat(NODE_CONTAINER_CLASS));\n    var nodeHeight;\n    $nodeContainer.addClass(OPENED_NODE_CONTAINER_CLASS);\n    nodeHeight = $nodeContainer.height();\n\n    _fx2.default.stop($nodeContainer, true);\n\n    _fx2.default.animate($nodeContainer, {\n      type: \"custom\",\n      duration: this.option(\"animationEnabled\") ? 400 : 0,\n      from: {\n        maxHeight: state ? 0 : nodeHeight\n      },\n      to: {\n        maxHeight: state ? nodeHeight : 0\n      },\n      complete: function () {\n        $nodeContainer.css(\"maxHeight\", \"none\");\n        $nodeContainer.toggleClass(OPENED_NODE_CONTAINER_CLASS, state);\n        this.setAria(\"expanded\", state, $node);\n\n        this._scrollableContainer.update();\n\n        this._fireExpandedStateUpdatedEvent(state, node, e);\n      }.bind(this)\n    });\n  },\n  _fireExpandedStateUpdatedEvent: function _fireExpandedStateUpdatedEvent(isExpanded, node, e) {\n    if (!this._hasChildren(node)) {\n      return;\n    }\n\n    var optionName = isExpanded ? \"onItemExpanded\" : \"onItemCollapsed\";\n\n    if ((0, _type.isDefined)(e)) {\n      this._itemDXEventHandler(e, optionName, {\n        node: this._dataAdapter.getPublicNode(node)\n      });\n    } else {\n      var target = this._getNodeElement(node);\n\n      this._itemEventHandler(target, optionName, {\n        event: e,\n        node: this._dataAdapter.getPublicNode(node)\n      });\n    }\n  },\n  _normalizeIconState: function _normalizeIconState($node, hasNewItems) {\n    var $loadIndicator = $node.find(\".dx-loadindicator\");\n    $loadIndicator.length && _load_indicator2.default.getInstance($loadIndicator).option(\"visible\", false);\n\n    if (hasNewItems) {\n      var $icon = $node.find(\".\" + TOGGLE_ITEM_VISIBILITY_CLASS);\n      $icon.show();\n      return;\n    }\n\n    $node.find(\".\" + TOGGLE_ITEM_VISIBILITY_CLASS).removeClass(TOGGLE_ITEM_VISIBILITY_CLASS);\n    $node.addClass(IS_LEAF);\n  },\n  _emptyMessageContainer: function _emptyMessageContainer() {\n    return this._scrollableContainer ? this._scrollableContainer.content() : this.callBase();\n  },\n  _renderContent: function _renderContent() {\n    var items = this.option(\"items\");\n\n    if (items && items.length) {\n      this._contentAlreadyRendered = true;\n    }\n\n    this.callBase();\n  },\n  _renderSelectAllItem: function _renderSelectAllItem($container) {\n    $container = $container || this.$element().find(\".\".concat(NODE_CONTAINER_CLASS)).first();\n    this._$selectAllItem = (0, _renderer2.default)(\"<div>\").addClass(SELECT_ALL_ITEM_CLASS);\n\n    var value = this._dataAdapter.isAllSelected();\n\n    this._createComponent(this._$selectAllItem, _check_box2.default, {\n      value: value,\n      text: this.option(\"selectAllText\"),\n      onValueChanged: function (args) {\n        this._toggleSelectAll(args);\n\n        this._fireSelectAllValueChanged(args.value);\n      }.bind(this)\n    });\n\n    this._toggleSelectedClass(this._$selectAllItem, value);\n\n    $container.before(this._$selectAllItem);\n  },\n  _toggleSelectAll: function _toggleSelectAll(args) {\n    this._dataAdapter.toggleSelectAll(args.value);\n\n    this._updateItemsUI();\n\n    this._fireSelectionChanged();\n  },\n  _renderCheckBox: function _renderCheckBox($node, node) {\n    var $checkbox = (0, _renderer2.default)(\"<div>\").appendTo($node);\n\n    this._createComponent($checkbox, _check_box2.default, {\n      value: node.internalFields.selected,\n      onValueChanged: this._changeCheckboxValue.bind(this),\n      focusStateEnabled: false,\n      disabled: this._disabledGetter(node)\n    });\n  },\n  _toggleSelectedClass: function _toggleSelectedClass($node, value) {\n    $node.toggleClass(SELECTED_ITEM_CLASS, !!value);\n  },\n  _toggleNodeDisabledState: function _toggleNodeDisabledState(node, state) {\n    var $node = this._getNodeElement(node);\n\n    var $item = $node.find(\".\" + ITEM_CLASS).eq(0);\n\n    this._dataAdapter.toggleNodeDisabledState(node.internalFields.key, state);\n\n    $item.toggleClass(DISABLED_STATE_CLASS, !!state);\n\n    if (this._showCheckboxes()) {\n      var checkbox = this._getCheckBoxInstance($node);\n\n      checkbox.option(\"disabled\", !!state);\n    }\n  },\n  _itemOptionChanged: function _itemOptionChanged(item, property, value) {\n    var node = this._dataAdapter.getNodeByItem(item);\n\n    if (property === this.option(\"disabledExpr\")) {\n      this._toggleNodeDisabledState(node, value);\n    }\n  },\n  _changeCheckboxValue: function _changeCheckboxValue(e) {\n    var $node = (0, _renderer2.default)(e.element).parent(\".\" + NODE_CLASS);\n    var $item = $node.children(\".\" + ITEM_CLASS);\n\n    var item = this._getItemData($item);\n\n    var node = this._getNodeByElement($item);\n\n    var value = e.value;\n\n    if (node && node.internalFields.selected === value) {\n      return;\n    }\n\n    this._updateItemSelection(value, item, e.event);\n  },\n  _isSingleSelection: function _isSingleSelection() {\n    return \"single\" === this.option(\"selectionMode\");\n  },\n  _isRecursiveSelection: function _isRecursiveSelection() {\n    return this.option(\"selectNodesRecursive\") && \"single\" !== this.option(\"selectionMode\");\n  },\n  _isLastSelectedBranch: function _isLastSelectedBranch(publicNode, selectedNodesKeys, deep) {\n    var keyIndex = selectedNodesKeys.indexOf(publicNode.key);\n\n    if (keyIndex >= 0) {\n      selectedNodesKeys.splice(keyIndex, 1);\n    }\n\n    if (deep) {\n      (0, _iterator.each)(publicNode.children, function (_, childNode) {\n        this._isLastSelectedBranch(childNode, selectedNodesKeys, true);\n      }.bind(this));\n    }\n\n    if (publicNode.parent) {\n      this._isLastSelectedBranch(publicNode.parent, selectedNodesKeys);\n    }\n\n    return 0 === selectedNodesKeys.length;\n  },\n  _isLastRequired: function _isLastRequired(node) {\n    var selectionRequired = this.option(\"selectionRequired\");\n\n    var isSingleMode = this._isSingleSelection();\n\n    var selectedNodesKeys = this.getSelectedNodesKeys();\n\n    if (!selectionRequired) {\n      return;\n    }\n\n    if (isSingleMode) {\n      return 1 === selectedNodesKeys.length;\n    } else {\n      return this._isLastSelectedBranch(node.internalFields.publicNode, selectedNodesKeys.slice(), true);\n    }\n  },\n  _updateItemSelection: function _updateItemSelection(value, itemElement, dxEvent) {\n    var _this10 = this;\n\n    var node = this._getNode(itemElement);\n\n    if (!node || node.internalFields.selected === value) {\n      return;\n    }\n\n    if (!value && this._isLastRequired(node)) {\n      if (this._showCheckboxes()) {\n        var $node = this._getNodeElement(node);\n\n        var checkbox = this._getCheckBoxInstance($node);\n\n        checkbox && checkbox.option(\"value\", true);\n      }\n\n      return;\n    }\n\n    var selectedNodesKeys = this.getSelectedNodesKeys();\n\n    if (this._isSingleSelection() && value) {\n      (0, _iterator.each)(selectedNodesKeys, function (index, nodeKey) {\n        _this10.unselectItem(nodeKey);\n      });\n    }\n\n    this._dataAdapter.toggleSelection(node.internalFields.key, value);\n\n    this._updateItemsUI();\n\n    var initiator = dxEvent || this._findItemElementByItem(node.internalFields.item);\n\n    var handler = dxEvent ? this._itemDXEventHandler : this._itemEventHandler;\n    handler.call(this, initiator, \"onItemSelectionChanged\", {\n      node: this._dataAdapter.getPublicNode(node),\n      itemData: node.internalFields.item\n    });\n\n    this._fireSelectionChanged();\n  },\n  _getCheckBoxInstance: function _getCheckBoxInstance($node) {\n    return $node.children(\".dx-checkbox\").dxCheckBox(\"instance\");\n  },\n  _updateItemsUI: function _updateItemsUI() {\n    var _this11 = this;\n\n    var cache = {};\n    (0, _iterator.each)(this._dataAdapter.getData(), function (_, node) {\n      var $node = _this11._getNodeElement(node, cache);\n\n      var nodeSelection = node.internalFields.selected;\n\n      if (!$node.length) {\n        return;\n      }\n\n      _this11._toggleSelectedClass($node, nodeSelection);\n\n      _this11.setAria(\"selected\", nodeSelection, $node);\n\n      if (_this11._showCheckboxes()) {\n        var checkbox = _this11._getCheckBoxInstance($node);\n\n        checkbox.option(\"value\", nodeSelection);\n      }\n    });\n\n    if (this._selectAllEnabled()) {\n      this._$selectAllItem.dxCheckBox(\"instance\").option(\"value\", this._dataAdapter.isAllSelected());\n    }\n  },\n  _updateParentsState: function _updateParentsState(node, $node) {\n    if (!$node) {\n      return;\n    }\n\n    var parentNode = this._dataAdapter.getNodeByKey(node.internalFields.parentKey);\n\n    var $parentNode = (0, _renderer2.default)($node.parents(\".\" + NODE_CLASS)[0]);\n\n    if (this._showCheckboxes()) {\n      var parentValue = parentNode.internalFields.selected;\n\n      this._getCheckBoxInstance($parentNode).option(\"value\", parentValue);\n\n      this._toggleSelectedClass($parentNode, parentValue);\n    }\n\n    if (parentNode.internalFields.parentKey !== this.option(\"rootValue\")) {\n      this._updateParentsState(parentNode, $parentNode);\n    }\n  },\n  _itemEventHandlerImpl: function _itemEventHandlerImpl(initiator, action, actionArgs) {\n    var $itemElement = (0, _renderer2.default)(initiator).closest(\".\" + NODE_CLASS).children(\".\" + ITEM_CLASS);\n    return action((0, _extend.extend)(this._extendActionArgs($itemElement), actionArgs));\n  },\n  _itemContextMenuHandler: function _itemContextMenuHandler(e) {\n    this._createEventHandler(\"onItemContextMenu\", e);\n  },\n  _itemHoldHandler: function _itemHoldHandler(e) {\n    this._createEventHandler(\"onItemHold\", e);\n  },\n  _createEventHandler: function _createEventHandler(eventName, e) {\n    var node = this._getNodeByElement(e.currentTarget);\n\n    this._itemDXEventHandler(e, eventName, {\n      node: this._dataAdapter.getPublicNode(node)\n    });\n  },\n  _itemClass: function _itemClass() {\n    return ITEM_CLASS;\n  },\n  _itemDataKey: function _itemDataKey() {\n    return ITEM_DATA_KEY;\n  },\n  _attachClickEvent: function _attachClickEvent() {\n    var clickSelector = \".\" + this._itemClass();\n\n    var pointerDownSelector = \".\" + NODE_CLASS + \", .\" + SELECT_ALL_ITEM_CLASS;\n    var eventName = (0, _utils.addNamespace)(_click2.default.name, this.NAME);\n    var pointerDownEvent = (0, _utils.addNamespace)(_pointer.down, this.NAME);\n\n    var $itemContainer = this._itemContainer();\n\n    var that = this;\n    (0, _events_engine.off)($itemContainer, eventName, clickSelector);\n    (0, _events_engine.off)($itemContainer, pointerDownEvent, pointerDownSelector);\n    (0, _events_engine.on)($itemContainer, eventName, clickSelector, function (e) {\n      that._itemClickHandler(e, (0, _renderer2.default)(this));\n    });\n    (0, _events_engine.on)($itemContainer, pointerDownEvent, pointerDownSelector, function (e) {\n      that._itemPointerDownHandler(e);\n    });\n  },\n  _itemClickHandler: function _itemClickHandler(e, $item) {\n    var itemData = this._getItemData($item);\n\n    var node = this._getNodeByElement($item);\n\n    this._itemDXEventHandler(e, \"onItemClick\", {\n      node: this._dataAdapter.getPublicNode(node)\n    });\n\n    if (this.option(\"selectByClick\") && !e.isDefaultPrevented()) {\n      this._updateItemSelection(!node.internalFields.selected, itemData, e);\n    }\n  },\n  _updateSelectionToFirstItem: function _updateSelectionToFirstItem($items, startIndex) {\n    var itemIndex = startIndex;\n\n    while (itemIndex >= 0) {\n      var $item = (0, _renderer2.default)($items[itemIndex]);\n\n      this._updateItemSelection(true, $item.find(\".\" + ITEM_CLASS).get(0));\n\n      itemIndex--;\n    }\n  },\n  _updateSelectionToLastItem: function _updateSelectionToLastItem($items, startIndex) {\n    var length = $items.length;\n    var itemIndex = startIndex;\n\n    while (itemIndex < length) {\n      var $item = (0, _renderer2.default)($items[itemIndex]);\n\n      this._updateItemSelection(true, $item.find(\".\" + ITEM_CLASS).get(0));\n\n      itemIndex++;\n    }\n  },\n  _focusInHandler: function _focusInHandler(e) {\n    var _this12 = this;\n\n    this._updateFocusState(e, true);\n\n    if (this.option(\"focusedElement\")) {\n      clearTimeout(this._setFocusedItemTimeout);\n      this._setFocusedItemTimeout = setTimeout(function () {\n        _this12._setFocusedItem((0, _renderer2.default)(_this12.option(\"focusedElement\")));\n      });\n      return;\n    }\n\n    var $activeItem = this._getActiveItem();\n\n    this.option(\"focusedElement\", (0, _dom.getPublicElement)($activeItem.closest(\".\" + NODE_CLASS)));\n  },\n  _setFocusedItem: function _setFocusedItem($target) {\n    if (!$target || !$target.length) {\n      return;\n    }\n\n    if (!$target.children().hasClass(DISABLED_STATE_CLASS)) {\n      this.callBase($target);\n    }\n\n    this._scrollableContainer.scrollToElement($target.find(\".\" + ITEM_CLASS).first());\n  },\n  _itemPointerDownHandler: function _itemPointerDownHandler(e) {\n    if (!this.option(\"focusStateEnabled\")) {\n      return;\n    }\n\n    var $target = (0, _renderer2.default)(e.target).closest(\".\" + NODE_CLASS + \", .\" + SELECT_ALL_ITEM_CLASS);\n\n    if (!$target.length) {\n      return;\n    }\n\n    var itemElement = $target.hasClass(DISABLED_STATE_CLASS) ? null : $target;\n    this.option(\"focusedElement\", (0, _dom.getPublicElement)(itemElement));\n  },\n  _findNonDisabledNodes: function _findNonDisabledNodes($nodes) {\n    return $nodes.not(function () {\n      return (0, _renderer2.default)(this).children(\".\" + ITEM_CLASS).hasClass(DISABLED_STATE_CLASS);\n    });\n  },\n  _moveFocus: function _moveFocus(location, e) {\n    var FOCUS_UP = \"up\";\n    var FOCUS_DOWN = \"down\";\n    var FOCUS_FIRST = \"first\";\n    var FOCUS_LAST = \"last\";\n    var FOCUS_LEFT = this.option(\"rtlEnabled\") ? \"right\" : \"left\";\n    var FOCUS_RIGHT = this.option(\"rtlEnabled\") ? \"left\" : \"right\";\n    this.$element().find(\".\".concat(NODE_CONTAINER_CLASS)).each(function () {\n      _fx2.default.stop(this, true);\n    });\n\n    var $items = this._findNonDisabledNodes(this._nodeElements());\n\n    if (!$items || !$items.length) {\n      return;\n    }\n\n    switch (location) {\n      case FOCUS_UP:\n        var $prevItem = this._prevItem($items);\n\n        this.option(\"focusedElement\", (0, _dom.getPublicElement)($prevItem));\n\n        if (e.shiftKey && this._showCheckboxes()) {\n          this._updateItemSelection(true, $prevItem.find(\".\" + ITEM_CLASS).get(0));\n        }\n\n        break;\n\n      case FOCUS_DOWN:\n        var $nextItem = this._nextItem($items);\n\n        this.option(\"focusedElement\", (0, _dom.getPublicElement)($nextItem));\n\n        if (e.shiftKey && this._showCheckboxes()) {\n          this._updateItemSelection(true, $nextItem.find(\".\" + ITEM_CLASS).get(0));\n        }\n\n        break;\n\n      case FOCUS_FIRST:\n        var $firstItem = $items.first();\n\n        if (e.shiftKey && this._showCheckboxes()) {\n          this._updateSelectionToFirstItem($items, $items.index(this._prevItem($items)));\n        }\n\n        this.option(\"focusedElement\", (0, _dom.getPublicElement)($firstItem));\n        break;\n\n      case FOCUS_LAST:\n        var $lastItem = $items.last();\n\n        if (e.shiftKey && this._showCheckboxes()) {\n          this._updateSelectionToLastItem($items, $items.index(this._nextItem($items)));\n        }\n\n        this.option(\"focusedElement\", (0, _dom.getPublicElement)($lastItem));\n        break;\n\n      case FOCUS_RIGHT:\n        this._expandFocusedContainer();\n\n        break;\n\n      case FOCUS_LEFT:\n        this._collapseFocusedContainer();\n\n        break;\n\n      default:\n        this.callBase.apply(this, arguments);\n        return;\n    }\n  },\n  _nodeElements: function _nodeElements() {\n    return this.$element().find(\".\" + NODE_CLASS).not(\":hidden\");\n  },\n  _expandFocusedContainer: function _expandFocusedContainer() {\n    var $focusedNode = (0, _renderer2.default)(this.option(\"focusedElement\"));\n\n    if (!$focusedNode.length || $focusedNode.hasClass(IS_LEAF)) {\n      return;\n    }\n\n    var $node = $focusedNode.find(\".\".concat(NODE_CONTAINER_CLASS)).eq(0);\n\n    if ($node.hasClass(OPENED_NODE_CONTAINER_CLASS)) {\n      var $nextItem = this._nextItem(this._findNonDisabledNodes(this._nodeElements()));\n\n      this.option(\"focusedElement\", (0, _dom.getPublicElement)($nextItem));\n      return;\n    }\n\n    var node = this._getNodeByElement($focusedNode.children(\".\" + ITEM_CLASS));\n\n    this._toggleExpandedState(node, true);\n  },\n  _getClosestNonDisabledNode: function _getClosestNonDisabledNode($node) {\n    do {\n      $node = $node.parent().closest(\".\" + NODE_CLASS);\n    } while ($node.children(\".dx-treeview-item.dx-state-disabled\").length);\n\n    return $node;\n  },\n  _collapseFocusedContainer: function _collapseFocusedContainer() {\n    var $focusedNode = (0, _renderer2.default)(this.option(\"focusedElement\"));\n\n    if (!$focusedNode.length) {\n      return;\n    }\n\n    var nodeElement = $focusedNode.find(\".\".concat(NODE_CONTAINER_CLASS)).eq(0);\n\n    if (!$focusedNode.hasClass(IS_LEAF) && nodeElement.hasClass(OPENED_NODE_CONTAINER_CLASS)) {\n      var node = this._getNodeByElement($focusedNode.children(\".\" + ITEM_CLASS));\n\n      this._toggleExpandedState(node, false);\n    } else {\n      var collapsedNode = this._getClosestNonDisabledNode($focusedNode);\n\n      collapsedNode.length && this.option(\"focusedElement\", (0, _dom.getPublicElement)(collapsedNode));\n    }\n  },\n  _encodeString: function _encodeString(value) {\n    return (0, _type.isString)(value) ? encodeURI(value) : value;\n  },\n  _decodeString: function _decodeString(value) {\n    return (0, _type.isString)(value) ? decodeURI(value) : value;\n  },\n  updateDimensions: function updateDimensions() {\n    var _this13 = this;\n\n    var deferred = new _deferred.Deferred();\n\n    if (this._scrollableContainer) {\n      this._scrollableContainer.update().done(function () {\n        deferred.resolveWith(_this13);\n      });\n    } else {\n      deferred.resolveWith(this);\n    }\n\n    return deferred.promise();\n  },\n  selectItem: function selectItem(itemElement) {\n    this._updateItemSelection(true, itemElement);\n  },\n  unselectItem: function unselectItem(itemElement) {\n    this._updateItemSelection(false, itemElement);\n  },\n  expandItem: function expandItem(itemElement) {\n    this._toggleExpandedState(itemElement, true);\n  },\n  collapseItem: function collapseItem(itemElement) {\n    this._toggleExpandedState(itemElement, false);\n  },\n  getNodes: function getNodes() {\n    return this._dataAdapter.getTreeNodes();\n  },\n  getSelectedNodesKeys: function getSelectedNodesKeys() {\n    return this._dataAdapter.getSelectedNodesKeys();\n  },\n  selectAll: function selectAll() {\n    if (this._selectAllEnabled()) {\n      this._$selectAllItem.dxCheckBox(\"instance\").option(\"value\", true);\n    } else {\n      this._toggleSelectAll({\n        value: true\n      });\n    }\n  },\n  unselectAll: function unselectAll() {\n    if (this._selectAllEnabled()) {\n      this._$selectAllItem.dxCheckBox(\"instance\").option(\"value\", false);\n    } else {\n      this._toggleSelectAll({\n        value: false\n      });\n    }\n  },\n  expandAll: function expandAll() {\n    var dataAdapter = this._dataAdapter;\n    (0, _iterator.each)(dataAdapter.getData(), function (_, node) {\n      return dataAdapter.toggleExpansion(node.internalFields.key, true);\n    });\n    this.repaint();\n  },\n  collapseAll: function collapseAll() {\n    (0, _iterator.each)(this._dataAdapter.getExpandedNodesKeys(), function (_, key) {\n      this._toggleExpandedState(key, false);\n    }.bind(this));\n  }\n});\n\nmodule.exports = TreeViewBase;","map":{"version":3,"sources":["C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/devextreme/ui/tree_view/ui.tree_view.base.js"],"names":["_renderer","require","_renderer2","_interopRequireDefault","_dom_adapter","_events_engine","_message","_message2","_click","_click2","_common","_common2","_window","_window2","_type","_extend","_iterator","_dom","_check_box","_check_box2","_ui","_ui2","_utils","_pointer","_double_click","_double_click2","_fx","_fx2","_ui3","_ui4","_load_indicator","_load_indicator2","_deferred","obj","__esModule","WIDGET_CLASS","NODE_CLASS","concat","NODE_CONTAINER_CLASS","NODE_LOAD_INDICATOR_CLASS","OPENED_NODE_CONTAINER_CLASS","IS_LEAF","ITEM_CLASS","ITEM_WITH_CHECKBOX_CLASS","ITEM_WITHOUT_CHECKBOX_CLASS","ITEM_DATA_KEY","TOGGLE_ITEM_VISIBILITY_CLASS","LOAD_INDICATOR_CLASS","LOAD_INDICATOR_WRAPPER_CLASS","TOGGLE_ITEM_VISIBILITY_OPENED_CLASS","SELECT_ALL_ITEM_CLASS","INVISIBLE_STATE_CLASS","DISABLED_STATE_CLASS","SELECTED_ITEM_CLASS","EXPAND_EVENT_NAMESPACE","DATA_ITEM_ID","TreeViewBase","default","inherit","_supportedKeys","e","_this","click","$itemElement","option","length","target","currentTarget","_itemClickHandler","children","expandEventName","_getEventNameByOption","expandByClick","addNamespace","name","_expandEventHandler","select","preventDefault","_changeCheckBoxState","toggleExpandedNestedItems","state","$rootElement","rootItem","_getItemData","find","_toggleExpandedNestedItems","extend","callBase","enter","_showCheckboxes","space","asterisk","bind","minus","$element","checkboxInstance","_getCheckBoxInstance","currentState","_updateItemSelection","get","items","i","len","item","node","_dataAdapter","getNodeByItem","_toggleExpandedState","_getNodeElement","cache","key","_encodeString","internalFields","$nodeByKey","each","$node","attr","element","querySelector","_activeStateUnit","_widgetClass","_getDefaultOptions","animationEnabled","dataStructure","deferRendering","expandAllEnabled","hasItemsExpr","selectNodesRecursive","expandNodesRecursive","showCheckBoxesMode","selectAllText","format","onItemSelectionChanged","onItemExpanded","onItemCollapsed","scrollDirection","virtualModeEnabled","rootValue","focusStateEnabled","selectionMode","expandEvent","selectByClick","createChildren","onSelectAllValueChanged","_initSelectedItems","noop","_syncSelectionOptions","asyncNoop","_fireSelectionChanged","selectionChangePromise","_selectionChangePromise","when","done","_createActionByOption","excludeValidators","_createSelectAllValueChangedAction","_selectAllValueChangedAction","_fireSelectAllValueChanged","value","_checkBoxModeChange","previousValue","repaint","selectAllExists","_$selectAllItem","_renderSelectAllItem","remove","_removeSelection","that","getFullData","_","_hasChildren","toggleSelection","_optionChanged","args","dxCheckBox","_scrollableContainer","_initDataAdapter","_filter","_initAccessors","_initExpandEvent","setOption","_initDataSource","_useCustomChildrenLoader","_loadChildrenByCustomLoader","newItems","_isVirtualMode","_initVirtualMode","filter","custom","_dataSource","internal","isFunction","_isDataStructurePlain","parentNode","invocationResult","call","Array","isArray","Deferred","resolve","promise","then","fromPromise","_combineFilter","_dataSourceLoadErrorHandler","_renderEmptyMessage","_init","_initStoreChangeHandlers","_dataSourceChangedHandler","_initialized","_removeTreeViewLoadIndicator","_treeViewLoadIndicator","_createTreeViewLoadIndicator","addClass","_createComponent","_dataSourceLoadingChangedHandler","isLoading","resultFilter","isLoaded","$wrapper","appendTo","itemsContainer","append","_this2","store","on","newItem","addItem","isFiltered","_updateLevel","_parentIdGetter","removedKey","getNodeByKey","getIndexByKey","_markChildrenItemsToRemove","_removeItems","removeItem","_this3","keys","childrenKeys","_this4","counter","index","splice","parentId","$container","_getContainerByParentKey","_renderItems","getChildrenNodes","_getOldContainer","$content","_renderNodeContainer","_isRootLevel","_renderScrollableContainer","_getAccessors","accessors","push","_getDataAdapterOptions","multipleSelection","_isSingleSelection","recursiveSelection","_isRecursiveSelection","recursiveExpansion","selectionRequired","dataType","sort","_initMarkup","getRootNodes","setAria","_renderContentImpl","$nodeContainer","_selectAllEnabled","_fireContentReadyAction","dataSource","getDataSource","skipContentReadyAction","hasWindow","update","direction","useKeyboard","$parent","itemData","_expandedGetter","_createDOMElement","prependTo","role","label","_displayGetter","expanded","level","_getLevel","parent","hasClass","parseInt","nodes","_renderItem","_renderedItemsCount","nodeIndex","nodeData","showCheckBox","_renderCheckBox","selected","_toggleSelectedClass","visible","_renderChildren","_setAriaSelected","_this5","_addLeafClass","_renderToggleItemVisibilityIcon","_loadSublevel","childNodes","_renderSublevel","_getActualNode","cachedNode","_hasItemsGetter","_this6","deferred","childrenNodes","_getChildNodes","_loadNestedItems","getNodesByItems","$nestedNodeContainer","childNodesByChildrenKeys","childNode","indexOf","firstChild","_updateParentsState","_normalizeIconState","_executeItemRenderAction","itemIndex","itemElement","_getNode","_getItemRenderAction","getPublicNode","$nodeElement","expandedEventName","$itemsContainer","_itemContainer","itemSelector","_itemSelector","off","event","identifier","isDefined","isPrimitive","isElementNode","_getNodeByElement","closest","_decodeString","disabled","_createLoadIndicator","toggleExpansion","_updateExpandedItemsUI","$icon","not","hide","_renderToggleItemVisibilityIconClick","_this7","eventName","NAME","isHiddenNode","is","parentKey","toggleClass","nodeContainerExists","_updateExpandedItem","_loadNestedItemsWithUpdate","_this8","actualNodeData","_this9","publicNode","_areNodesExists","_appendItems","load","keyOfRootItem","keyOf","fullData","_animateNodeContainer","nodeHeight","height","stop","animate","type","duration","from","maxHeight","to","complete","css","_fireExpandedStateUpdatedEvent","isExpanded","optionName","_itemDXEventHandler","_itemEventHandler","hasNewItems","$loadIndicator","getInstance","show","removeClass","_emptyMessageContainer","content","_renderContent","_contentAlreadyRendered","first","isAllSelected","text","onValueChanged","_toggleSelectAll","before","toggleSelectAll","_updateItemsUI","$checkbox","_changeCheckboxValue","_disabledGetter","_toggleNodeDisabledState","$item","eq","toggleNodeDisabledState","checkbox","_itemOptionChanged","property","_isLastSelectedBranch","selectedNodesKeys","deep","keyIndex","_isLastRequired","isSingleMode","getSelectedNodesKeys","slice","dxEvent","_this10","nodeKey","unselectItem","initiator","_findItemElementByItem","handler","_this11","getData","nodeSelection","$parentNode","parents","parentValue","_itemEventHandlerImpl","action","actionArgs","_extendActionArgs","_itemContextMenuHandler","_createEventHandler","_itemHoldHandler","_itemClass","_itemDataKey","_attachClickEvent","clickSelector","pointerDownSelector","pointerDownEvent","down","$itemContainer","_itemPointerDownHandler","isDefaultPrevented","_updateSelectionToFirstItem","$items","startIndex","_updateSelectionToLastItem","_focusInHandler","_this12","_updateFocusState","clearTimeout","_setFocusedItemTimeout","setTimeout","_setFocusedItem","$activeItem","_getActiveItem","getPublicElement","$target","scrollToElement","_findNonDisabledNodes","$nodes","_moveFocus","location","FOCUS_UP","FOCUS_DOWN","FOCUS_FIRST","FOCUS_LAST","FOCUS_LEFT","FOCUS_RIGHT","_nodeElements","$prevItem","_prevItem","shiftKey","$nextItem","_nextItem","$firstItem","$lastItem","last","_expandFocusedContainer","_collapseFocusedContainer","apply","arguments","$focusedNode","_getClosestNonDisabledNode","nodeElement","collapsedNode","isString","encodeURI","decodeURI","updateDimensions","_this13","resolveWith","selectItem","expandItem","collapseItem","getNodes","getTreeNodes","selectAll","unselectAll","expandAll","dataAdapter","collapseAll","getExpandedNodesKeys","module","exports"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/tree_view/ui.tree_view.base.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar _renderer = require(\"../../core/renderer\");\r\nvar _renderer2 = _interopRequireDefault(_renderer);\r\nvar _dom_adapter = require(\"../../core/dom_adapter\");\r\nvar _events_engine = require(\"../../events/core/events_engine\");\r\nvar _message = require(\"../../localization/message\");\r\nvar _message2 = _interopRequireDefault(_message);\r\nvar _click = require(\"../../events/click\");\r\nvar _click2 = _interopRequireDefault(_click);\r\nvar _common = require(\"../../core/utils/common\");\r\nvar _common2 = _interopRequireDefault(_common);\r\nvar _window = require(\"../../core/utils/window\");\r\nvar _window2 = _interopRequireDefault(_window);\r\nvar _type = require(\"../../core/utils/type\");\r\nvar _extend = require(\"../../core/utils/extend\");\r\nvar _iterator = require(\"../../core/utils/iterator\");\r\nvar _dom = require(\"../../core/utils/dom\");\r\nvar _check_box = require(\"../check_box\");\r\nvar _check_box2 = _interopRequireDefault(_check_box);\r\nvar _ui = require(\"../hierarchical_collection/ui.hierarchical_collection_widget\");\r\nvar _ui2 = _interopRequireDefault(_ui);\r\nvar _utils = require(\"../../events/utils\");\r\nvar _pointer = require(\"../../events/pointer\");\r\nvar _double_click = require(\"../../events/double_click\");\r\nvar _double_click2 = _interopRequireDefault(_double_click);\r\nvar _fx = require(\"../../animation/fx\");\r\nvar _fx2 = _interopRequireDefault(_fx);\r\nvar _ui3 = require(\"../scroll_view/ui.scrollable\");\r\nvar _ui4 = _interopRequireDefault(_ui3);\r\nvar _load_indicator = require(\"../load_indicator\");\r\nvar _load_indicator2 = _interopRequireDefault(_load_indicator);\r\nvar _deferred = require(\"../../core/utils/deferred\");\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\nvar WIDGET_CLASS = \"dx-treeview\";\r\nvar NODE_CLASS = \"\".concat(WIDGET_CLASS, \"-node\");\r\nvar NODE_CONTAINER_CLASS = \"\".concat(NODE_CLASS, \"-container\");\r\nvar NODE_LOAD_INDICATOR_CLASS = \"\".concat(NODE_CLASS, \"-loadindicator\");\r\nvar OPENED_NODE_CONTAINER_CLASS = \"\".concat(NODE_CLASS, \"-container-opened\");\r\nvar IS_LEAF = \"\".concat(NODE_CLASS, \"-is-leaf\");\r\nvar ITEM_CLASS = \"\".concat(WIDGET_CLASS, \"-item\");\r\nvar ITEM_WITH_CHECKBOX_CLASS = \"\".concat(ITEM_CLASS, \"-with-checkbox\");\r\nvar ITEM_WITHOUT_CHECKBOX_CLASS = \"\".concat(ITEM_CLASS, \"-without-checkbox\");\r\nvar ITEM_DATA_KEY = \"\".concat(ITEM_CLASS, \"-data\");\r\nvar TOGGLE_ITEM_VISIBILITY_CLASS = \"\".concat(WIDGET_CLASS, \"-toggle-item-visibility\");\r\nvar LOAD_INDICATOR_CLASS = \"\".concat(WIDGET_CLASS, \"-loadindicator\");\r\nvar LOAD_INDICATOR_WRAPPER_CLASS = \"\".concat(WIDGET_CLASS, \"-loadindicator-wrapper\");\r\nvar TOGGLE_ITEM_VISIBILITY_OPENED_CLASS = \"\".concat(WIDGET_CLASS, \"-toggle-item-visibility-opened\");\r\nvar SELECT_ALL_ITEM_CLASS = \"\".concat(WIDGET_CLASS, \"-select-all-item\");\r\nvar INVISIBLE_STATE_CLASS = \"dx-state-invisible\";\r\nvar DISABLED_STATE_CLASS = \"dx-state-disabled\";\r\nvar SELECTED_ITEM_CLASS = \"dx-state-selected\";\r\nvar EXPAND_EVENT_NAMESPACE = \"dxTreeView_expand\";\r\nvar DATA_ITEM_ID = \"data-item-id\";\r\nvar TreeViewBase = _ui2.default.inherit({\r\n    _supportedKeys: function(e) {\r\n        var _this = this;\r\n        var click = function(e) {\r\n            var $itemElement = (0, _renderer2.default)(_this.option(\"focusedElement\"));\r\n            if (!$itemElement.length) {\r\n                return\r\n            }\r\n            e.target = $itemElement;\r\n            e.currentTarget = $itemElement;\r\n            _this._itemClickHandler(e, $itemElement.children(\".\" + ITEM_CLASS));\r\n            var expandEventName = _this._getEventNameByOption(_this.option(\"expandEvent\"));\r\n            var expandByClick = expandEventName === (0, _utils.addNamespace)(_click2.default.name, EXPAND_EVENT_NAMESPACE);\r\n            if (expandByClick) {\r\n                _this._expandEventHandler(e)\r\n            }\r\n        };\r\n        var select = function(e) {\r\n            e.preventDefault();\r\n            _this._changeCheckBoxState((0, _renderer2.default)(_this.option(\"focusedElement\")))\r\n        };\r\n        var toggleExpandedNestedItems = function(state, e) {\r\n            if (!this.option(\"expandAllEnabled\")) {\r\n                return\r\n            }\r\n            e.preventDefault();\r\n            var $rootElement = (0, _renderer2.default)(this.option(\"focusedElement\"));\r\n            if (!$rootElement.length) {\r\n                return\r\n            }\r\n            var rootItem = this._getItemData($rootElement.find(\".\".concat(ITEM_CLASS)));\r\n            this._toggleExpandedNestedItems([rootItem], state)\r\n        };\r\n        return (0, _extend.extend)(this.callBase(), {\r\n            enter: this._showCheckboxes() ? select : click,\r\n            space: this._showCheckboxes() ? select : click,\r\n            asterisk: toggleExpandedNestedItems.bind(this, true),\r\n            minus: toggleExpandedNestedItems.bind(this, false)\r\n        })\r\n    },\r\n    _changeCheckBoxState: function($element) {\r\n        var checkboxInstance = this._getCheckBoxInstance($element);\r\n        var currentState = checkboxInstance.option(\"value\");\r\n        if (!checkboxInstance.option(\"disabled\")) {\r\n            this._updateItemSelection(!currentState, $element.find(\".\" + ITEM_CLASS).get(0), true, $element)\r\n        }\r\n    },\r\n    _toggleExpandedNestedItems: function(items, state) {\r\n        if (!items) {\r\n            return\r\n        }\r\n        for (var i = 0, len = items.length; i < len; i++) {\r\n            var item = items[i];\r\n            var node = this._dataAdapter.getNodeByItem(item);\r\n            this._toggleExpandedState(node, state);\r\n            this._toggleExpandedNestedItems(item.items, state)\r\n        }\r\n    },\r\n    _getNodeElement: function(node, cache) {\r\n        var key = this._encodeString(node.internalFields.key);\r\n        if (cache) {\r\n            if (!cache.$nodeByKey) {\r\n                cache.$nodeByKey = {};\r\n                this.$element().find(\".\".concat(NODE_CLASS)).each(function() {\r\n                    var $node = (0, _renderer2.default)(this);\r\n                    var key = $node.attr(DATA_ITEM_ID);\r\n                    cache.$nodeByKey[key] = $node\r\n                })\r\n            }\r\n            return cache.$nodeByKey[key] || (0, _renderer2.default)()\r\n        }\r\n        var element = this.$element().get(0).querySelector(\"[\".concat(DATA_ITEM_ID, '=\"').concat(key, '\"]'));\r\n        return (0, _renderer2.default)(element)\r\n    },\r\n    _activeStateUnit: \".\" + ITEM_CLASS,\r\n    _widgetClass: function() {\r\n        return WIDGET_CLASS\r\n    },\r\n    _getDefaultOptions: function() {\r\n        return (0, _extend.extend)(this.callBase(), {\r\n            animationEnabled: true,\r\n            dataStructure: \"tree\",\r\n            deferRendering: true,\r\n            expandAllEnabled: false,\r\n            hasItemsExpr: \"hasItems\",\r\n            selectNodesRecursive: true,\r\n            expandNodesRecursive: true,\r\n            showCheckBoxesMode: \"none\",\r\n            selectAllText: _message2.default.format(\"dxList-selectAll\"),\r\n            onItemSelectionChanged: null,\r\n            onItemExpanded: null,\r\n            onItemCollapsed: null,\r\n            scrollDirection: \"vertical\",\r\n            virtualModeEnabled: false,\r\n            rootValue: 0,\r\n            focusStateEnabled: false,\r\n            selectionMode: \"multiple\",\r\n            expandEvent: \"dblclick\",\r\n            selectByClick: false,\r\n            createChildren: null,\r\n            onSelectAllValueChanged: null\r\n        })\r\n    },\r\n    _initSelectedItems: _common2.default.noop,\r\n    _syncSelectionOptions: _common2.default.asyncNoop,\r\n    _fireSelectionChanged: function() {\r\n        var selectionChangePromise = this._selectionChangePromise;\r\n        (0, _deferred.when)(selectionChangePromise).done(function() {\r\n            this._createActionByOption(\"onSelectionChanged\", {\r\n                excludeValidators: [\"disabled\", \"readOnly\"]\r\n            })()\r\n        }.bind(this))\r\n    },\r\n    _createSelectAllValueChangedAction: function() {\r\n        this._selectAllValueChangedAction = this._createActionByOption(\"onSelectAllValueChanged\", {\r\n            excludeValidators: [\"disabled\", \"readOnly\"]\r\n        })\r\n    },\r\n    _fireSelectAllValueChanged: function(value) {\r\n        this._selectAllValueChangedAction({\r\n            value: value\r\n        })\r\n    },\r\n    _checkBoxModeChange: function(value, previousValue) {\r\n        if (\"none\" === previousValue || \"none\" === value) {\r\n            this.repaint();\r\n            return\r\n        }\r\n        var selectAllExists = this._$selectAllItem && this._$selectAllItem.length;\r\n        switch (value) {\r\n            case \"selectAll\":\r\n                !selectAllExists && this._renderSelectAllItem();\r\n                break;\r\n            case \"normal\":\r\n                if (selectAllExists) {\r\n                    this._$selectAllItem.remove();\r\n                    delete this._$selectAllItem\r\n                }\r\n        }\r\n    },\r\n    _removeSelection: function() {\r\n        var that = this;\r\n        (0, _iterator.each)(this._dataAdapter.getFullData(), function(_, node) {\r\n            if (!that._hasChildren(node)) {\r\n                return\r\n            }\r\n            that._dataAdapter.toggleSelection(node.internalFields.key, false, true)\r\n        })\r\n    },\r\n    _optionChanged: function(args) {\r\n        var name = args.name,\r\n            value = args.value,\r\n            previousValue = args.previousValue;\r\n        switch (name) {\r\n            case \"selectAllText\":\r\n                if (this._$selectAllItem) {\r\n                    this._$selectAllItem.dxCheckBox(\"instance\").option(\"text\", value)\r\n                }\r\n                break;\r\n            case \"showCheckBoxesMode\":\r\n                this._checkBoxModeChange(value, previousValue);\r\n                break;\r\n            case \"scrollDirection\":\r\n                this._scrollableContainer.option(\"direction\", value);\r\n                break;\r\n            case \"items\":\r\n                delete this._$selectAllItem;\r\n                this.callBase(args);\r\n                break;\r\n            case \"dataSource\":\r\n                this.callBase(args);\r\n                this._initDataAdapter();\r\n                this._filter = {};\r\n                break;\r\n            case \"hasItemsExpr\":\r\n                this._initAccessors();\r\n                this.repaint();\r\n                break;\r\n            case \"expandEvent\":\r\n                this._initExpandEvent();\r\n                break;\r\n            case \"deferRendering\":\r\n            case \"dataStructure\":\r\n            case \"rootValue\":\r\n            case \"createChildren\":\r\n            case \"expandNodesRecursive\":\r\n            case \"onItemSelectionChanged\":\r\n            case \"onItemExpanded\":\r\n            case \"onItemCollapsed\":\r\n            case \"expandAllEnabled\":\r\n            case \"animationEnabled\":\r\n            case \"virtualModeEnabled\":\r\n            case \"selectByClick\":\r\n                break;\r\n            case \"selectionMode\":\r\n                this._initDataAdapter();\r\n                this.callBase(args);\r\n                break;\r\n            case \"onSelectAllValueChanged\":\r\n                this._createSelectAllValueChangedAction();\r\n                break;\r\n            case \"selectNodesRecursive\":\r\n                this._dataAdapter.setOption(\"recursiveSelection\", args.value);\r\n                this.repaint();\r\n                break;\r\n            default:\r\n                this.callBase(args)\r\n        }\r\n    },\r\n    _initDataSource: function() {\r\n        if (this._useCustomChildrenLoader()) {\r\n            this._loadChildrenByCustomLoader(null).done(function(newItems) {\r\n                if (newItems && newItems.length) {\r\n                    this.option(\"items\", newItems)\r\n                }\r\n            }.bind(this))\r\n        } else {\r\n            this.callBase();\r\n            this._isVirtualMode() && this._initVirtualMode()\r\n        }\r\n    },\r\n    _initVirtualMode: function() {\r\n        var filter = this._filter;\r\n        if (!filter.custom) {\r\n            filter.custom = this._dataSource.filter()\r\n        }\r\n        if (!filter.internal) {\r\n            filter.internal = [this.option(\"parentIdExpr\"), this.option(\"rootValue\")]\r\n        }\r\n    },\r\n    _useCustomChildrenLoader: function() {\r\n        return (0, _type.isFunction)(this.option(\"createChildren\")) && this._isDataStructurePlain()\r\n    },\r\n    _loadChildrenByCustomLoader: function(parentNode) {\r\n        var invocationResult = this.option(\"createChildren\").call(this, parentNode);\r\n        if (Array.isArray(invocationResult)) {\r\n            return (new _deferred.Deferred).resolve(invocationResult).promise()\r\n        }\r\n        if (invocationResult && (0, _type.isFunction)(invocationResult.then)) {\r\n            return (0, _deferred.fromPromise)(invocationResult)\r\n        }\r\n        return (new _deferred.Deferred).resolve([]).promise()\r\n    },\r\n    _combineFilter: function() {\r\n        if (!this._filter.custom || !this._filter.custom.length) {\r\n            return this._filter.internal\r\n        }\r\n        return [this._filter.custom, this._filter.internal]\r\n    },\r\n    _dataSourceLoadErrorHandler: function() {\r\n        this._renderEmptyMessage()\r\n    },\r\n    _init: function() {\r\n        this._filter = {};\r\n        this.callBase();\r\n        this._initStoreChangeHandlers()\r\n    },\r\n    _dataSourceChangedHandler: function(newItems) {\r\n        var items = this.option(\"items\");\r\n        if (this._initialized && this._isVirtualMode() && items.length) {\r\n            return\r\n        }\r\n        this.option(\"items\", newItems)\r\n    },\r\n    _removeTreeViewLoadIndicator: function() {\r\n        if (!this._treeViewLoadIndicator) {\r\n            return\r\n        }\r\n        this._treeViewLoadIndicator.remove();\r\n        this._treeViewLoadIndicator = null\r\n    },\r\n    _createTreeViewLoadIndicator: function() {\r\n        this._treeViewLoadIndicator = (0, _renderer2.default)(\"<div>\").addClass(LOAD_INDICATOR_CLASS);\r\n        this._createComponent(this._treeViewLoadIndicator, _load_indicator2.default, {});\r\n        return this._treeViewLoadIndicator\r\n    },\r\n    _dataSourceLoadingChangedHandler: function(isLoading) {\r\n        var resultFilter;\r\n        if (this._isVirtualMode()) {\r\n            resultFilter = this._combineFilter();\r\n            this._dataSource.filter(resultFilter)\r\n        }\r\n        if (isLoading && !this._dataSource.isLoaded()) {\r\n            this.option(\"items\", []);\r\n            var $wrapper = (0, _renderer2.default)(\"<div>\").addClass(LOAD_INDICATOR_WRAPPER_CLASS);\r\n            this._createTreeViewLoadIndicator().appendTo($wrapper);\r\n            this.itemsContainer().append($wrapper);\r\n            if (this._isVirtualMode() && this._dataSource.filter() !== resultFilter) {\r\n                this._dataSource.filter([])\r\n            }\r\n        } else {\r\n            this._removeTreeViewLoadIndicator()\r\n        }\r\n    },\r\n    _initStoreChangeHandlers: function() {\r\n        var _this2 = this;\r\n        if (\"plain\" !== this.option(\"dataStructure\")) {\r\n            return\r\n        }\r\n        this._dataSource && this._dataSource.store().on(\"inserted\", function(newItem) {\r\n            _this2.option().items = _this2.option(\"items\").concat(newItem);\r\n            _this2._dataAdapter.addItem(newItem);\r\n            if (!_this2._dataAdapter.isFiltered(newItem)) {\r\n                return\r\n            }\r\n            _this2._updateLevel(_this2._parentIdGetter(newItem))\r\n        }).on(\"removed\", function(removedKey) {\r\n            var node = _this2._dataAdapter.getNodeByKey(removedKey);\r\n            _this2.option(\"items\")[_this2._dataAdapter.getIndexByKey(node.internalFields.key)] = 0;\r\n            _this2._markChildrenItemsToRemove(node);\r\n            _this2._removeItems();\r\n            _this2._dataAdapter.removeItem(removedKey);\r\n            _this2._updateLevel(_this2._parentIdGetter(node))\r\n        })\r\n    },\r\n    _markChildrenItemsToRemove: function(node) {\r\n        var _this3 = this;\r\n        var keys = node.internalFields.childrenKeys;\r\n        (0, _iterator.each)(keys, function(_, key) {\r\n            _this3.option(\"items\")[_this3._dataAdapter.getIndexByKey(key)] = 0;\r\n            _this3._markChildrenItemsToRemove(_this3._dataAdapter.getNodeByKey(key))\r\n        })\r\n    },\r\n    _removeItems: function() {\r\n        var _this4 = this;\r\n        var items = (0, _extend.extend)(true, [], this.option(\"items\"));\r\n        var counter = 0;\r\n        (0, _iterator.each)(items, function(index, item) {\r\n            if (!item) {\r\n                _this4.option(\"items\").splice(index - counter, 1);\r\n                counter++\r\n            }\r\n        })\r\n    },\r\n    _updateLevel: function(parentId) {\r\n        var $container = this._getContainerByParentKey(parentId);\r\n        this._renderItems($container, this._dataAdapter.getChildrenNodes(parentId))\r\n    },\r\n    _getOldContainer: function($itemElement) {\r\n        if ($itemElement.length) {\r\n            return $itemElement.children(\".\".concat(NODE_CONTAINER_CLASS))\r\n        }\r\n        if (this._scrollableContainer) {\r\n            return this._scrollableContainer.$content().children()\r\n        }\r\n        return (0, _renderer2.default)()\r\n    },\r\n    _getContainerByParentKey: function(parentId) {\r\n        var node = this._dataAdapter.getNodeByKey(parentId);\r\n        var $itemElement = node ? this._getNodeElement(node) : [];\r\n        this._getOldContainer($itemElement).remove();\r\n        var $container = this._renderNodeContainer($itemElement);\r\n        if (this._isRootLevel(parentId)) {\r\n            if (!this._scrollableContainer) {\r\n                this._renderScrollableContainer()\r\n            }\r\n            this._scrollableContainer.$content().append($container)\r\n        }\r\n        return $container\r\n    },\r\n    _isRootLevel: function(parentId) {\r\n        return parentId === this.option(\"rootValue\")\r\n    },\r\n    _getAccessors: function() {\r\n        var accessors = this.callBase();\r\n        accessors.push(\"hasItems\");\r\n        return accessors\r\n    },\r\n    _getDataAdapterOptions: function() {\r\n        return {\r\n            rootValue: this.option(\"rootValue\"),\r\n            multipleSelection: !this._isSingleSelection(),\r\n            recursiveSelection: this._isRecursiveSelection(),\r\n            recursiveExpansion: this.option(\"expandNodesRecursive\"),\r\n            selectionRequired: this.option(\"selectionRequired\"),\r\n            dataType: this.option(\"dataStructure\"),\r\n            sort: this._dataSource && this._dataSource.sort()\r\n        }\r\n    },\r\n    _initMarkup: function() {\r\n        this._renderScrollableContainer();\r\n        this._renderEmptyMessage(this._dataAdapter.getRootNodes());\r\n        this.callBase();\r\n        this.setAria(\"role\", \"tree\")\r\n    },\r\n    _renderContentImpl: function() {\r\n        var $nodeContainer = this._renderNodeContainer();\r\n        this._scrollableContainer.$content().append($nodeContainer);\r\n        if (!this.option(\"items\") || !this.option(\"items\").length) {\r\n            return\r\n        }\r\n        this._renderItems($nodeContainer, this._dataAdapter.getRootNodes());\r\n        this._initExpandEvent();\r\n        if (this._selectAllEnabled()) {\r\n            this._createSelectAllValueChangedAction();\r\n            this._renderSelectAllItem($nodeContainer)\r\n        }\r\n    },\r\n    _isVirtualMode: function() {\r\n        return this.option(\"virtualModeEnabled\") && this._isDataStructurePlain() && !!this.option(\"dataSource\")\r\n    },\r\n    _isDataStructurePlain: function() {\r\n        return \"plain\" === this.option(\"dataStructure\")\r\n    },\r\n    _fireContentReadyAction: function() {\r\n        var dataSource = this.getDataSource();\r\n        var skipContentReadyAction = dataSource && !dataSource.isLoaded();\r\n        if (!skipContentReadyAction) {\r\n            this.callBase()\r\n        }\r\n        if (this._scrollableContainer && _window2.default.hasWindow()) {\r\n            this._scrollableContainer.update()\r\n        }\r\n    },\r\n    _renderScrollableContainer: function() {\r\n        this._scrollableContainer = this._createComponent((0, _renderer2.default)(\"<div>\").appendTo(this.$element()), _ui4.default, {\r\n            direction: this.option(\"scrollDirection\"),\r\n            useKeyboard: false\r\n        })\r\n    },\r\n    _renderNodeContainer: function($parent) {\r\n        var $container = (0, _renderer2.default)(\"<ul>\").addClass(NODE_CONTAINER_CLASS);\r\n        this.setAria(\"role\", \"group\", $container);\r\n        if ($parent && $parent.length) {\r\n            var itemData = this._getItemData($parent.children(\".\" + ITEM_CLASS));\r\n            if (this._expandedGetter(itemData)) {\r\n                $container.addClass(OPENED_NODE_CONTAINER_CLASS)\r\n            }\r\n            $container.appendTo($parent)\r\n        }\r\n        return $container\r\n    },\r\n    _createDOMElement: function($nodeContainer, node) {\r\n        var $node = (0, _renderer2.default)(\"<li>\").addClass(NODE_CLASS).attr(DATA_ITEM_ID, this._encodeString(node.internalFields.key)).prependTo($nodeContainer);\r\n        this.setAria({\r\n            role: \"treeitem\",\r\n            label: this._displayGetter(node.internalFields.item) || \"\",\r\n            expanded: node.internalFields.expanded || false,\r\n            level: this._getLevel($nodeContainer)\r\n        }, $node);\r\n        return $node\r\n    },\r\n    _getLevel: function($nodeContainer) {\r\n        var parent = $nodeContainer.parent();\r\n        return parent.hasClass(\"dx-scrollable-content\") ? 1 : parseInt(parent.attr(\"aria-level\")) + 1\r\n    },\r\n    _showCheckboxes: function() {\r\n        return \"none\" !== this.option(\"showCheckBoxesMode\")\r\n    },\r\n    _selectAllEnabled: function() {\r\n        return \"selectAll\" === this.option(\"showCheckBoxesMode\") && !this._isSingleSelection()\r\n    },\r\n    _renderItems: function($nodeContainer, nodes) {\r\n        var length = nodes.length - 1;\r\n        for (var i = length; i >= 0; i--) {\r\n            this._renderItem(i, nodes[i], $nodeContainer)\r\n        }\r\n        this._renderedItemsCount += nodes.length\r\n    },\r\n    _renderItem: function(nodeIndex, node, $nodeContainer) {\r\n        var $node = this._createDOMElement($nodeContainer, node);\r\n        var nodeData = node.internalFields;\r\n        var showCheckBox = this._showCheckboxes();\r\n        $node.addClass(showCheckBox ? ITEM_WITH_CHECKBOX_CLASS : ITEM_WITHOUT_CHECKBOX_CLASS);\r\n        showCheckBox && this._renderCheckBox($node, node);\r\n        this.setAria(\"selected\", nodeData.selected, $node);\r\n        this._toggleSelectedClass($node, nodeData.selected);\r\n        this.callBase(this._renderedItemsCount + nodeIndex, nodeData.item, $node);\r\n        if (false !== nodeData.item.visible) {\r\n            this._renderChildren($node, node)\r\n        }\r\n    },\r\n    _setAriaSelected: function() {},\r\n    _renderChildren: function($node, node) {\r\n        var _this5 = this;\r\n        if (!this._hasChildren(node)) {\r\n            this._addLeafClass($node);\r\n            return\r\n        }\r\n        this._renderToggleItemVisibilityIcon($node, node);\r\n        if (this.option(\"deferRendering\") && !node.internalFields.expanded) {\r\n            return\r\n        }\r\n        this._loadSublevel(node).done(function(childNodes) {\r\n            _this5._renderSublevel($node, _this5._getActualNode(node), childNodes)\r\n        })\r\n    },\r\n    _getActualNode: function(cachedNode) {\r\n        return this._dataAdapter.getNodeByKey(cachedNode.internalFields.key)\r\n    },\r\n    _hasChildren: function(node) {\r\n        if (this._isVirtualMode() || this._useCustomChildrenLoader()) {\r\n            return false !== this._hasItemsGetter(node.internalFields.item)\r\n        }\r\n        return this.callBase(node)\r\n    },\r\n    _loadSublevel: function(node) {\r\n        var _this6 = this;\r\n        var deferred = new _deferred.Deferred;\r\n        var childrenNodes = this._getChildNodes(node);\r\n        if (childrenNodes.length) {\r\n            deferred.resolve(childrenNodes)\r\n        } else {\r\n            this._loadNestedItems(node).done(function(items) {\r\n                deferred.resolve(_this6._dataAdapter.getNodesByItems(items))\r\n            })\r\n        }\r\n        return deferred.promise()\r\n    },\r\n    _renderSublevel: function($node, node, childNodes) {\r\n        var $nestedNodeContainer = this._renderNodeContainer($node, node);\r\n        var childNodesByChildrenKeys = childNodes.filter(function(childNode) {\r\n            return node.internalFields.childrenKeys.indexOf(childNode.internalFields.key) !== -1\r\n        });\r\n        this._renderItems($nestedNodeContainer, childNodesByChildrenKeys);\r\n        if (childNodesByChildrenKeys.length && !node.internalFields.selected) {\r\n            var firstChild = childNodesByChildrenKeys[0];\r\n            this._updateParentsState(firstChild, this._getNodeElement(firstChild))\r\n        }\r\n        this._normalizeIconState($node, childNodesByChildrenKeys.length);\r\n        if (node.internalFields.expanded) {\r\n            $nestedNodeContainer.addClass(OPENED_NODE_CONTAINER_CLASS)\r\n        }\r\n    },\r\n    _executeItemRenderAction: function(itemIndex, itemData, itemElement) {\r\n        var node = this._getNode(itemElement);\r\n        this._getItemRenderAction()({\r\n            itemElement: itemElement,\r\n            itemIndex: itemIndex,\r\n            itemData: itemData,\r\n            node: this._dataAdapter.getPublicNode(node)\r\n        })\r\n    },\r\n    _addLeafClass: function($node) {\r\n        $node.addClass(IS_LEAF)\r\n    },\r\n    _expandEventHandler: function(e) {\r\n        var $nodeElement = (0, _renderer2.default)(e.currentTarget.parentNode);\r\n        if (!$nodeElement.hasClass(IS_LEAF)) {\r\n            this._toggleExpandedState(e.currentTarget, void 0, e)\r\n        }\r\n    },\r\n    _initExpandEvent: function() {\r\n        var expandedEventName = this._getEventNameByOption(this.option(\"expandEvent\"));\r\n        var $itemsContainer = this._itemContainer();\r\n        var itemSelector = this._itemSelector();\r\n        (0, _events_engine.off)($itemsContainer, \".\" + EXPAND_EVENT_NAMESPACE, itemSelector);\r\n        (0, _events_engine.on)($itemsContainer, expandedEventName, itemSelector, this._expandEventHandler.bind(this))\r\n    },\r\n    _getEventNameByOption: function(name) {\r\n        var event = \"click\" === name ? _click2.default : _double_click2.default;\r\n        return (0, _utils.addNamespace)(event.name, EXPAND_EVENT_NAMESPACE)\r\n    },\r\n    _getNode: function(identifier) {\r\n        if (!(0, _type.isDefined)(identifier)) {\r\n            return null\r\n        }\r\n        if (identifier.internalFields) {\r\n            return identifier\r\n        }\r\n        if ((0, _type.isPrimitive)(identifier)) {\r\n            return this._dataAdapter.getNodeByKey(identifier)\r\n        }\r\n        var itemElement = (0, _renderer2.default)(identifier).get(0);\r\n        if (!itemElement) {\r\n            return null\r\n        }\r\n        if ((0, _dom_adapter.isElementNode)(itemElement)) {\r\n            return this._getNodeByElement(itemElement)\r\n        }\r\n        return this._dataAdapter.getNodeByItem(itemElement)\r\n    },\r\n    _getNodeByElement: function(itemElement) {\r\n        var $node = (0, _renderer2.default)(itemElement).closest(\".\" + NODE_CLASS);\r\n        var key = this._decodeString($node.attr(DATA_ITEM_ID));\r\n        return this._dataAdapter.getNodeByKey(key)\r\n    },\r\n    _toggleExpandedState: function(itemElement, state, e) {\r\n        var node = this._getNode(itemElement);\r\n        var currentState = node.internalFields.expanded;\r\n        if (node.internalFields.disabled || currentState === state) {\r\n            return\r\n        }\r\n        if (this._hasChildren(node)) {\r\n            var $node = this._getNodeElement(node);\r\n            if ($node.find(\".\".concat(NODE_LOAD_INDICATOR_CLASS, \":not(.\").concat(INVISIBLE_STATE_CLASS, \")\")).length) {\r\n                return\r\n            }\r\n            this._createLoadIndicator($node)\r\n        }\r\n        if (!(0, _type.isDefined)(state)) {\r\n            state = !currentState\r\n        }\r\n        this._dataAdapter.toggleExpansion(node.internalFields.key, state);\r\n        this._updateExpandedItemsUI(node, state, e)\r\n    },\r\n    _createLoadIndicator: function($node) {\r\n        var $icon = $node.children(\".\" + TOGGLE_ITEM_VISIBILITY_CLASS);\r\n        var $nodeContainer = $node.children(\".\".concat(NODE_CONTAINER_CLASS));\r\n        if ($icon.hasClass(TOGGLE_ITEM_VISIBILITY_OPENED_CLASS) || $nodeContainer.not(\":empty\").length) {\r\n            return\r\n        }\r\n        this._createComponent((0, _renderer2.default)(\"<div>\").addClass(NODE_LOAD_INDICATOR_CLASS), _load_indicator2.default, {}).$element().appendTo($node);\r\n        $icon.hide()\r\n    },\r\n    _renderToggleItemVisibilityIcon: function($node, node) {\r\n        var $icon = (0, _renderer2.default)(\"<div>\").addClass(TOGGLE_ITEM_VISIBILITY_CLASS).appendTo($node);\r\n        if (node.internalFields.expanded) {\r\n            $icon.addClass(TOGGLE_ITEM_VISIBILITY_OPENED_CLASS);\r\n            $node.parent().addClass(OPENED_NODE_CONTAINER_CLASS)\r\n        }\r\n        if (node.internalFields.disabled) {\r\n            $icon.addClass(DISABLED_STATE_CLASS)\r\n        }\r\n        this._renderToggleItemVisibilityIconClick($icon, node)\r\n    },\r\n    _renderToggleItemVisibilityIconClick: function($icon, node) {\r\n        var _this7 = this;\r\n        var eventName = (0, _utils.addNamespace)(_click2.default.name, this.NAME);\r\n        (0, _events_engine.off)($icon, eventName);\r\n        (0, _events_engine.on)($icon, eventName, function(e) {\r\n            _this7._toggleExpandedState(node.internalFields.key, void 0, e)\r\n        })\r\n    },\r\n    _updateExpandedItemsUI: function(node, state, e) {\r\n        var $node = this._getNodeElement(node);\r\n        var isHiddenNode = !$node.length || state && $node.is(\":hidden\");\r\n        if (this.option(\"expandNodesRecursive\") && isHiddenNode) {\r\n            var parentNode = this._getNode(node.internalFields.parentKey);\r\n            if (parentNode) {\r\n                this._updateExpandedItemsUI(parentNode, state, e)\r\n            }\r\n        }\r\n        var $icon = $node.children(\".\" + TOGGLE_ITEM_VISIBILITY_CLASS);\r\n        var $nodeContainer = $node.children(\".\".concat(NODE_CONTAINER_CLASS));\r\n        $icon.toggleClass(TOGGLE_ITEM_VISIBILITY_OPENED_CLASS, state);\r\n        var nodeContainerExists = $nodeContainer.length > 0;\r\n        if (!state || nodeContainerExists && !$nodeContainer.is(\":empty\")) {\r\n            this._updateExpandedItem(node, state, e);\r\n            return\r\n        }\r\n        if (this._isVirtualMode() || this._useCustomChildrenLoader()) {\r\n            this._loadNestedItemsWithUpdate(node, state, e);\r\n            return\r\n        }\r\n        this._renderSublevel($node, node, this._getChildNodes(node));\r\n        this._fireContentReadyAction();\r\n        this._updateExpandedItem(node, state, e)\r\n    },\r\n    _loadNestedItemsWithUpdate: function(node, state, e) {\r\n        var _this8 = this;\r\n        var $node = this._getNodeElement(node);\r\n        this._loadNestedItems(node).done(function(items) {\r\n            var actualNodeData = _this8._getActualNode(node);\r\n            _this8._renderSublevel($node, actualNodeData, _this8._dataAdapter.getNodesByItems(items));\r\n            if (!items || !items.length) {\r\n                return\r\n            }\r\n            _this8._fireContentReadyAction();\r\n            _this8._updateExpandedItem(actualNodeData, state, e)\r\n        })\r\n    },\r\n    _loadNestedItems: function(node) {\r\n        var _this9 = this;\r\n        if (this._useCustomChildrenLoader()) {\r\n            var publicNode = this._dataAdapter.getPublicNode(node);\r\n            return this._loadChildrenByCustomLoader(publicNode).done(function(newItems) {\r\n                if (!_this9._areNodesExists(newItems)) {\r\n                    _this9._appendItems(newItems)\r\n                }\r\n            })\r\n        }\r\n        if (!this._isVirtualMode()) {\r\n            return (new _deferred.Deferred).resolve([]).promise()\r\n        }\r\n        this._filter.internal = [this.option(\"parentIdExpr\"), node.internalFields.key];\r\n        this._dataSource.filter(this._combineFilter());\r\n        return this._dataSource.load().done(function(newItems) {\r\n            if (!_this9._areNodesExists(newItems)) {\r\n                _this9._appendItems(newItems)\r\n            }\r\n        })\r\n    },\r\n    _areNodesExists: function(newItems, items) {\r\n        var keyOfRootItem = this.keyOf(newItems[0]);\r\n        var fullData = this._dataAdapter.getFullData();\r\n        return !!this._dataAdapter.getNodeByKey(keyOfRootItem, fullData)\r\n    },\r\n    _appendItems: function(newItems) {\r\n        this.option().items = this.option(\"items\").concat(newItems);\r\n        this._initDataAdapter()\r\n    },\r\n    _updateExpandedItem: function(node, state, e) {\r\n        this._animateNodeContainer(node, state, e)\r\n    },\r\n    _animateNodeContainer: function(node, state, e) {\r\n        var $node = this._getNodeElement(node);\r\n        var $nodeContainer = $node.children(\".\".concat(NODE_CONTAINER_CLASS));\r\n        var nodeHeight;\r\n        $nodeContainer.addClass(OPENED_NODE_CONTAINER_CLASS);\r\n        nodeHeight = $nodeContainer.height();\r\n        _fx2.default.stop($nodeContainer, true);\r\n        _fx2.default.animate($nodeContainer, {\r\n            type: \"custom\",\r\n            duration: this.option(\"animationEnabled\") ? 400 : 0,\r\n            from: {\r\n                maxHeight: state ? 0 : nodeHeight\r\n            },\r\n            to: {\r\n                maxHeight: state ? nodeHeight : 0\r\n            },\r\n            complete: function() {\r\n                $nodeContainer.css(\"maxHeight\", \"none\");\r\n                $nodeContainer.toggleClass(OPENED_NODE_CONTAINER_CLASS, state);\r\n                this.setAria(\"expanded\", state, $node);\r\n                this._scrollableContainer.update();\r\n                this._fireExpandedStateUpdatedEvent(state, node, e)\r\n            }.bind(this)\r\n        })\r\n    },\r\n    _fireExpandedStateUpdatedEvent: function(isExpanded, node, e) {\r\n        if (!this._hasChildren(node)) {\r\n            return\r\n        }\r\n        var optionName = isExpanded ? \"onItemExpanded\" : \"onItemCollapsed\";\r\n        if ((0, _type.isDefined)(e)) {\r\n            this._itemDXEventHandler(e, optionName, {\r\n                node: this._dataAdapter.getPublicNode(node)\r\n            })\r\n        } else {\r\n            var target = this._getNodeElement(node);\r\n            this._itemEventHandler(target, optionName, {\r\n                event: e,\r\n                node: this._dataAdapter.getPublicNode(node)\r\n            })\r\n        }\r\n    },\r\n    _normalizeIconState: function($node, hasNewItems) {\r\n        var $loadIndicator = $node.find(\".dx-loadindicator\");\r\n        $loadIndicator.length && _load_indicator2.default.getInstance($loadIndicator).option(\"visible\", false);\r\n        if (hasNewItems) {\r\n            var $icon = $node.find(\".\" + TOGGLE_ITEM_VISIBILITY_CLASS);\r\n            $icon.show();\r\n            return\r\n        }\r\n        $node.find(\".\" + TOGGLE_ITEM_VISIBILITY_CLASS).removeClass(TOGGLE_ITEM_VISIBILITY_CLASS);\r\n        $node.addClass(IS_LEAF)\r\n    },\r\n    _emptyMessageContainer: function() {\r\n        return this._scrollableContainer ? this._scrollableContainer.content() : this.callBase()\r\n    },\r\n    _renderContent: function() {\r\n        var items = this.option(\"items\");\r\n        if (items && items.length) {\r\n            this._contentAlreadyRendered = true\r\n        }\r\n        this.callBase()\r\n    },\r\n    _renderSelectAllItem: function($container) {\r\n        $container = $container || this.$element().find(\".\".concat(NODE_CONTAINER_CLASS)).first();\r\n        this._$selectAllItem = (0, _renderer2.default)(\"<div>\").addClass(SELECT_ALL_ITEM_CLASS);\r\n        var value = this._dataAdapter.isAllSelected();\r\n        this._createComponent(this._$selectAllItem, _check_box2.default, {\r\n            value: value,\r\n            text: this.option(\"selectAllText\"),\r\n            onValueChanged: function(args) {\r\n                this._toggleSelectAll(args);\r\n                this._fireSelectAllValueChanged(args.value)\r\n            }.bind(this)\r\n        });\r\n        this._toggleSelectedClass(this._$selectAllItem, value);\r\n        $container.before(this._$selectAllItem)\r\n    },\r\n    _toggleSelectAll: function(args) {\r\n        this._dataAdapter.toggleSelectAll(args.value);\r\n        this._updateItemsUI();\r\n        this._fireSelectionChanged()\r\n    },\r\n    _renderCheckBox: function($node, node) {\r\n        var $checkbox = (0, _renderer2.default)(\"<div>\").appendTo($node);\r\n        this._createComponent($checkbox, _check_box2.default, {\r\n            value: node.internalFields.selected,\r\n            onValueChanged: this._changeCheckboxValue.bind(this),\r\n            focusStateEnabled: false,\r\n            disabled: this._disabledGetter(node)\r\n        })\r\n    },\r\n    _toggleSelectedClass: function($node, value) {\r\n        $node.toggleClass(SELECTED_ITEM_CLASS, !!value)\r\n    },\r\n    _toggleNodeDisabledState: function(node, state) {\r\n        var $node = this._getNodeElement(node);\r\n        var $item = $node.find(\".\" + ITEM_CLASS).eq(0);\r\n        this._dataAdapter.toggleNodeDisabledState(node.internalFields.key, state);\r\n        $item.toggleClass(DISABLED_STATE_CLASS, !!state);\r\n        if (this._showCheckboxes()) {\r\n            var checkbox = this._getCheckBoxInstance($node);\r\n            checkbox.option(\"disabled\", !!state)\r\n        }\r\n    },\r\n    _itemOptionChanged: function(item, property, value) {\r\n        var node = this._dataAdapter.getNodeByItem(item);\r\n        if (property === this.option(\"disabledExpr\")) {\r\n            this._toggleNodeDisabledState(node, value)\r\n        }\r\n    },\r\n    _changeCheckboxValue: function(e) {\r\n        var $node = (0, _renderer2.default)(e.element).parent(\".\" + NODE_CLASS);\r\n        var $item = $node.children(\".\" + ITEM_CLASS);\r\n        var item = this._getItemData($item);\r\n        var node = this._getNodeByElement($item);\r\n        var value = e.value;\r\n        if (node && node.internalFields.selected === value) {\r\n            return\r\n        }\r\n        this._updateItemSelection(value, item, e.event)\r\n    },\r\n    _isSingleSelection: function() {\r\n        return \"single\" === this.option(\"selectionMode\")\r\n    },\r\n    _isRecursiveSelection: function() {\r\n        return this.option(\"selectNodesRecursive\") && \"single\" !== this.option(\"selectionMode\")\r\n    },\r\n    _isLastSelectedBranch: function(publicNode, selectedNodesKeys, deep) {\r\n        var keyIndex = selectedNodesKeys.indexOf(publicNode.key);\r\n        if (keyIndex >= 0) {\r\n            selectedNodesKeys.splice(keyIndex, 1)\r\n        }\r\n        if (deep) {\r\n            (0, _iterator.each)(publicNode.children, function(_, childNode) {\r\n                this._isLastSelectedBranch(childNode, selectedNodesKeys, true)\r\n            }.bind(this))\r\n        }\r\n        if (publicNode.parent) {\r\n            this._isLastSelectedBranch(publicNode.parent, selectedNodesKeys)\r\n        }\r\n        return 0 === selectedNodesKeys.length\r\n    },\r\n    _isLastRequired: function(node) {\r\n        var selectionRequired = this.option(\"selectionRequired\");\r\n        var isSingleMode = this._isSingleSelection();\r\n        var selectedNodesKeys = this.getSelectedNodesKeys();\r\n        if (!selectionRequired) {\r\n            return\r\n        }\r\n        if (isSingleMode) {\r\n            return 1 === selectedNodesKeys.length\r\n        } else {\r\n            return this._isLastSelectedBranch(node.internalFields.publicNode, selectedNodesKeys.slice(), true)\r\n        }\r\n    },\r\n    _updateItemSelection: function(value, itemElement, dxEvent) {\r\n        var _this10 = this;\r\n        var node = this._getNode(itemElement);\r\n        if (!node || node.internalFields.selected === value) {\r\n            return\r\n        }\r\n        if (!value && this._isLastRequired(node)) {\r\n            if (this._showCheckboxes()) {\r\n                var $node = this._getNodeElement(node);\r\n                var checkbox = this._getCheckBoxInstance($node);\r\n                checkbox && checkbox.option(\"value\", true)\r\n            }\r\n            return\r\n        }\r\n        var selectedNodesKeys = this.getSelectedNodesKeys();\r\n        if (this._isSingleSelection() && value) {\r\n            (0, _iterator.each)(selectedNodesKeys, function(index, nodeKey) {\r\n                _this10.unselectItem(nodeKey)\r\n            })\r\n        }\r\n        this._dataAdapter.toggleSelection(node.internalFields.key, value);\r\n        this._updateItemsUI();\r\n        var initiator = dxEvent || this._findItemElementByItem(node.internalFields.item);\r\n        var handler = dxEvent ? this._itemDXEventHandler : this._itemEventHandler;\r\n        handler.call(this, initiator, \"onItemSelectionChanged\", {\r\n            node: this._dataAdapter.getPublicNode(node),\r\n            itemData: node.internalFields.item\r\n        });\r\n        this._fireSelectionChanged()\r\n    },\r\n    _getCheckBoxInstance: function($node) {\r\n        return $node.children(\".dx-checkbox\").dxCheckBox(\"instance\")\r\n    },\r\n    _updateItemsUI: function() {\r\n        var _this11 = this;\r\n        var cache = {};\r\n        (0, _iterator.each)(this._dataAdapter.getData(), function(_, node) {\r\n            var $node = _this11._getNodeElement(node, cache);\r\n            var nodeSelection = node.internalFields.selected;\r\n            if (!$node.length) {\r\n                return\r\n            }\r\n            _this11._toggleSelectedClass($node, nodeSelection);\r\n            _this11.setAria(\"selected\", nodeSelection, $node);\r\n            if (_this11._showCheckboxes()) {\r\n                var checkbox = _this11._getCheckBoxInstance($node);\r\n                checkbox.option(\"value\", nodeSelection)\r\n            }\r\n        });\r\n        if (this._selectAllEnabled()) {\r\n            this._$selectAllItem.dxCheckBox(\"instance\").option(\"value\", this._dataAdapter.isAllSelected())\r\n        }\r\n    },\r\n    _updateParentsState: function(node, $node) {\r\n        if (!$node) {\r\n            return\r\n        }\r\n        var parentNode = this._dataAdapter.getNodeByKey(node.internalFields.parentKey);\r\n        var $parentNode = (0, _renderer2.default)($node.parents(\".\" + NODE_CLASS)[0]);\r\n        if (this._showCheckboxes()) {\r\n            var parentValue = parentNode.internalFields.selected;\r\n            this._getCheckBoxInstance($parentNode).option(\"value\", parentValue);\r\n            this._toggleSelectedClass($parentNode, parentValue)\r\n        }\r\n        if (parentNode.internalFields.parentKey !== this.option(\"rootValue\")) {\r\n            this._updateParentsState(parentNode, $parentNode)\r\n        }\r\n    },\r\n    _itemEventHandlerImpl: function(initiator, action, actionArgs) {\r\n        var $itemElement = (0, _renderer2.default)(initiator).closest(\".\" + NODE_CLASS).children(\".\" + ITEM_CLASS);\r\n        return action((0, _extend.extend)(this._extendActionArgs($itemElement), actionArgs))\r\n    },\r\n    _itemContextMenuHandler: function(e) {\r\n        this._createEventHandler(\"onItemContextMenu\", e)\r\n    },\r\n    _itemHoldHandler: function(e) {\r\n        this._createEventHandler(\"onItemHold\", e)\r\n    },\r\n    _createEventHandler: function(eventName, e) {\r\n        var node = this._getNodeByElement(e.currentTarget);\r\n        this._itemDXEventHandler(e, eventName, {\r\n            node: this._dataAdapter.getPublicNode(node)\r\n        })\r\n    },\r\n    _itemClass: function() {\r\n        return ITEM_CLASS\r\n    },\r\n    _itemDataKey: function() {\r\n        return ITEM_DATA_KEY\r\n    },\r\n    _attachClickEvent: function() {\r\n        var clickSelector = \".\" + this._itemClass();\r\n        var pointerDownSelector = \".\" + NODE_CLASS + \", .\" + SELECT_ALL_ITEM_CLASS;\r\n        var eventName = (0, _utils.addNamespace)(_click2.default.name, this.NAME);\r\n        var pointerDownEvent = (0, _utils.addNamespace)(_pointer.down, this.NAME);\r\n        var $itemContainer = this._itemContainer();\r\n        var that = this;\r\n        (0, _events_engine.off)($itemContainer, eventName, clickSelector);\r\n        (0, _events_engine.off)($itemContainer, pointerDownEvent, pointerDownSelector);\r\n        (0, _events_engine.on)($itemContainer, eventName, clickSelector, function(e) {\r\n            that._itemClickHandler(e, (0, _renderer2.default)(this))\r\n        });\r\n        (0, _events_engine.on)($itemContainer, pointerDownEvent, pointerDownSelector, function(e) {\r\n            that._itemPointerDownHandler(e)\r\n        })\r\n    },\r\n    _itemClickHandler: function(e, $item) {\r\n        var itemData = this._getItemData($item);\r\n        var node = this._getNodeByElement($item);\r\n        this._itemDXEventHandler(e, \"onItemClick\", {\r\n            node: this._dataAdapter.getPublicNode(node)\r\n        });\r\n        if (this.option(\"selectByClick\") && !e.isDefaultPrevented()) {\r\n            this._updateItemSelection(!node.internalFields.selected, itemData, e)\r\n        }\r\n    },\r\n    _updateSelectionToFirstItem: function($items, startIndex) {\r\n        var itemIndex = startIndex;\r\n        while (itemIndex >= 0) {\r\n            var $item = (0, _renderer2.default)($items[itemIndex]);\r\n            this._updateItemSelection(true, $item.find(\".\" + ITEM_CLASS).get(0));\r\n            itemIndex--\r\n        }\r\n    },\r\n    _updateSelectionToLastItem: function($items, startIndex) {\r\n        var length = $items.length;\r\n        var itemIndex = startIndex;\r\n        while (itemIndex < length) {\r\n            var $item = (0, _renderer2.default)($items[itemIndex]);\r\n            this._updateItemSelection(true, $item.find(\".\" + ITEM_CLASS).get(0));\r\n            itemIndex++\r\n        }\r\n    },\r\n    _focusInHandler: function(e) {\r\n        var _this12 = this;\r\n        this._updateFocusState(e, true);\r\n        if (this.option(\"focusedElement\")) {\r\n            clearTimeout(this._setFocusedItemTimeout);\r\n            this._setFocusedItemTimeout = setTimeout(function() {\r\n                _this12._setFocusedItem((0, _renderer2.default)(_this12.option(\"focusedElement\")))\r\n            });\r\n            return\r\n        }\r\n        var $activeItem = this._getActiveItem();\r\n        this.option(\"focusedElement\", (0, _dom.getPublicElement)($activeItem.closest(\".\" + NODE_CLASS)))\r\n    },\r\n    _setFocusedItem: function($target) {\r\n        if (!$target || !$target.length) {\r\n            return\r\n        }\r\n        if (!$target.children().hasClass(DISABLED_STATE_CLASS)) {\r\n            this.callBase($target)\r\n        }\r\n        this._scrollableContainer.scrollToElement($target.find(\".\" + ITEM_CLASS).first())\r\n    },\r\n    _itemPointerDownHandler: function(e) {\r\n        if (!this.option(\"focusStateEnabled\")) {\r\n            return\r\n        }\r\n        var $target = (0, _renderer2.default)(e.target).closest(\".\" + NODE_CLASS + \", .\" + SELECT_ALL_ITEM_CLASS);\r\n        if (!$target.length) {\r\n            return\r\n        }\r\n        var itemElement = $target.hasClass(DISABLED_STATE_CLASS) ? null : $target;\r\n        this.option(\"focusedElement\", (0, _dom.getPublicElement)(itemElement))\r\n    },\r\n    _findNonDisabledNodes: function($nodes) {\r\n        return $nodes.not(function() {\r\n            return (0, _renderer2.default)(this).children(\".\" + ITEM_CLASS).hasClass(DISABLED_STATE_CLASS)\r\n        })\r\n    },\r\n    _moveFocus: function(location, e) {\r\n        var FOCUS_UP = \"up\";\r\n        var FOCUS_DOWN = \"down\";\r\n        var FOCUS_FIRST = \"first\";\r\n        var FOCUS_LAST = \"last\";\r\n        var FOCUS_LEFT = this.option(\"rtlEnabled\") ? \"right\" : \"left\";\r\n        var FOCUS_RIGHT = this.option(\"rtlEnabled\") ? \"left\" : \"right\";\r\n        this.$element().find(\".\".concat(NODE_CONTAINER_CLASS)).each(function() {\r\n            _fx2.default.stop(this, true)\r\n        });\r\n        var $items = this._findNonDisabledNodes(this._nodeElements());\r\n        if (!$items || !$items.length) {\r\n            return\r\n        }\r\n        switch (location) {\r\n            case FOCUS_UP:\r\n                var $prevItem = this._prevItem($items);\r\n                this.option(\"focusedElement\", (0, _dom.getPublicElement)($prevItem));\r\n                if (e.shiftKey && this._showCheckboxes()) {\r\n                    this._updateItemSelection(true, $prevItem.find(\".\" + ITEM_CLASS).get(0))\r\n                }\r\n                break;\r\n            case FOCUS_DOWN:\r\n                var $nextItem = this._nextItem($items);\r\n                this.option(\"focusedElement\", (0, _dom.getPublicElement)($nextItem));\r\n                if (e.shiftKey && this._showCheckboxes()) {\r\n                    this._updateItemSelection(true, $nextItem.find(\".\" + ITEM_CLASS).get(0))\r\n                }\r\n                break;\r\n            case FOCUS_FIRST:\r\n                var $firstItem = $items.first();\r\n                if (e.shiftKey && this._showCheckboxes()) {\r\n                    this._updateSelectionToFirstItem($items, $items.index(this._prevItem($items)))\r\n                }\r\n                this.option(\"focusedElement\", (0, _dom.getPublicElement)($firstItem));\r\n                break;\r\n            case FOCUS_LAST:\r\n                var $lastItem = $items.last();\r\n                if (e.shiftKey && this._showCheckboxes()) {\r\n                    this._updateSelectionToLastItem($items, $items.index(this._nextItem($items)))\r\n                }\r\n                this.option(\"focusedElement\", (0, _dom.getPublicElement)($lastItem));\r\n                break;\r\n            case FOCUS_RIGHT:\r\n                this._expandFocusedContainer();\r\n                break;\r\n            case FOCUS_LEFT:\r\n                this._collapseFocusedContainer();\r\n                break;\r\n            default:\r\n                this.callBase.apply(this, arguments);\r\n                return\r\n        }\r\n    },\r\n    _nodeElements: function() {\r\n        return this.$element().find(\".\" + NODE_CLASS).not(\":hidden\")\r\n    },\r\n    _expandFocusedContainer: function() {\r\n        var $focusedNode = (0, _renderer2.default)(this.option(\"focusedElement\"));\r\n        if (!$focusedNode.length || $focusedNode.hasClass(IS_LEAF)) {\r\n            return\r\n        }\r\n        var $node = $focusedNode.find(\".\".concat(NODE_CONTAINER_CLASS)).eq(0);\r\n        if ($node.hasClass(OPENED_NODE_CONTAINER_CLASS)) {\r\n            var $nextItem = this._nextItem(this._findNonDisabledNodes(this._nodeElements()));\r\n            this.option(\"focusedElement\", (0, _dom.getPublicElement)($nextItem));\r\n            return\r\n        }\r\n        var node = this._getNodeByElement($focusedNode.children(\".\" + ITEM_CLASS));\r\n        this._toggleExpandedState(node, true)\r\n    },\r\n    _getClosestNonDisabledNode: function($node) {\r\n        do {\r\n            $node = $node.parent().closest(\".\" + NODE_CLASS)\r\n        } while ($node.children(\".dx-treeview-item.dx-state-disabled\").length);\r\n        return $node\r\n    },\r\n    _collapseFocusedContainer: function() {\r\n        var $focusedNode = (0, _renderer2.default)(this.option(\"focusedElement\"));\r\n        if (!$focusedNode.length) {\r\n            return\r\n        }\r\n        var nodeElement = $focusedNode.find(\".\".concat(NODE_CONTAINER_CLASS)).eq(0);\r\n        if (!$focusedNode.hasClass(IS_LEAF) && nodeElement.hasClass(OPENED_NODE_CONTAINER_CLASS)) {\r\n            var node = this._getNodeByElement($focusedNode.children(\".\" + ITEM_CLASS));\r\n            this._toggleExpandedState(node, false)\r\n        } else {\r\n            var collapsedNode = this._getClosestNonDisabledNode($focusedNode);\r\n            collapsedNode.length && this.option(\"focusedElement\", (0, _dom.getPublicElement)(collapsedNode))\r\n        }\r\n    },\r\n    _encodeString: function(value) {\r\n        return (0, _type.isString)(value) ? encodeURI(value) : value\r\n    },\r\n    _decodeString: function(value) {\r\n        return (0, _type.isString)(value) ? decodeURI(value) : value\r\n    },\r\n    updateDimensions: function() {\r\n        var _this13 = this;\r\n        var deferred = new _deferred.Deferred;\r\n        if (this._scrollableContainer) {\r\n            this._scrollableContainer.update().done(function() {\r\n                deferred.resolveWith(_this13)\r\n            })\r\n        } else {\r\n            deferred.resolveWith(this)\r\n        }\r\n        return deferred.promise()\r\n    },\r\n    selectItem: function(itemElement) {\r\n        this._updateItemSelection(true, itemElement)\r\n    },\r\n    unselectItem: function(itemElement) {\r\n        this._updateItemSelection(false, itemElement)\r\n    },\r\n    expandItem: function(itemElement) {\r\n        this._toggleExpandedState(itemElement, true)\r\n    },\r\n    collapseItem: function(itemElement) {\r\n        this._toggleExpandedState(itemElement, false)\r\n    },\r\n    getNodes: function() {\r\n        return this._dataAdapter.getTreeNodes()\r\n    },\r\n    getSelectedNodesKeys: function() {\r\n        return this._dataAdapter.getSelectedNodesKeys()\r\n    },\r\n    selectAll: function() {\r\n        if (this._selectAllEnabled()) {\r\n            this._$selectAllItem.dxCheckBox(\"instance\").option(\"value\", true)\r\n        } else {\r\n            this._toggleSelectAll({\r\n                value: true\r\n            })\r\n        }\r\n    },\r\n    unselectAll: function() {\r\n        if (this._selectAllEnabled()) {\r\n            this._$selectAllItem.dxCheckBox(\"instance\").option(\"value\", false)\r\n        } else {\r\n            this._toggleSelectAll({\r\n                value: false\r\n            })\r\n        }\r\n    },\r\n    expandAll: function() {\r\n        var dataAdapter = this._dataAdapter;\r\n        (0, _iterator.each)(dataAdapter.getData(), function(_, node) {\r\n            return dataAdapter.toggleExpansion(node.internalFields.key, true)\r\n        });\r\n        this.repaint()\r\n    },\r\n    collapseAll: function() {\r\n        (0, _iterator.each)(this._dataAdapter.getExpandedNodesKeys(), function(_, key) {\r\n            this._toggleExpandedState(key, false)\r\n        }.bind(this))\r\n    }\r\n});\r\nmodule.exports = TreeViewBase;\r\n"]},"metadata":{},"sourceType":"script"}