{"ast":null,"code":"/**\r\n * DevExtreme (ui/pivot_grid/ui.pivot_grid.utils.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar _type = require(\"../../core/utils/type\");\n\nvar _ajax = require(\"../../core/utils/ajax\");\n\nvar _data = require(\"../../core/utils/data\");\n\nvar _iterator = require(\"../../core/utils/iterator\");\n\nvar _extend = require(\"../../core/utils/extend\");\n\nvar _date = require(\"../../localization/date\");\n\nvar _format_helper = require(\"../../format_helper\");\n\nvar _data_source = require(\"../../data/data_source/data_source\");\n\nvar _array_store = require(\"../../data/array_store\");\n\nvar _array_store2 = _interopRequireDefault(_array_store);\n\nvar _deferred = require(\"../../core/utils/deferred\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nvar setFieldProperty = exports.setFieldProperty = function (field, property, value, isInitialization) {\n  var initProperties = field._initProperties = field._initProperties || {};\n  var initValue = isInitialization ? value : field[property];\n\n  if (!Object.prototype.hasOwnProperty.call(initProperties, property) || isInitialization) {\n    initProperties[property] = initValue;\n  }\n\n  field[property] = value;\n};\n\nexports.sendRequest = function (options) {\n  return (0, _ajax.sendRequest)(options);\n};\n\nvar foreachTreeAsyncDate = new Date();\n\nfunction createForeachTreeFunc(isAsync) {\n  var foreachTreeFunc = function foreachTreeFunc(items, callback, parentAtFirst, members, index, isChildrenProcessing) {\n    members = members || [];\n    items = items || [];\n    var item;\n    var i;\n    var deferred;\n    var childrenDeferred;\n    index = index || 0;\n\n    function createForeachTreeAsyncHandler(deferred, i, isChildrenProcessing) {\n      (0, _deferred.when)(foreachTreeFunc(items, callback, parentAtFirst, members, i, isChildrenProcessing)).done(deferred.resolve);\n    }\n\n    for (i = index; i < items.length; i++) {\n      if (isAsync && i > index && i % 1e4 === 0 && new Date() - foreachTreeAsyncDate >= 300) {\n        foreachTreeAsyncDate = new Date();\n        deferred = new _deferred.Deferred();\n        setTimeout(createForeachTreeAsyncHandler(deferred, i, false), 0);\n        return deferred;\n      }\n\n      item = items[i];\n\n      if (!isChildrenProcessing) {\n        members.unshift(item);\n\n        if (parentAtFirst && false === callback(members, i)) {\n          return;\n        }\n\n        if (item.children) {\n          childrenDeferred = foreachTreeFunc(item.children, callback, parentAtFirst, members);\n\n          if (isAsync && childrenDeferred) {\n            deferred = new _deferred.Deferred();\n            childrenDeferred.done(createForeachTreeAsyncHandler(deferred, i, true));\n            return deferred;\n          }\n        }\n      }\n\n      isChildrenProcessing = false;\n\n      if (!parentAtFirst && false === callback(members, i)) {\n        return;\n      }\n\n      members.shift();\n\n      if (items[i] !== item) {\n        i--;\n      }\n    }\n  };\n\n  return foreachTreeFunc;\n}\n\nexports.foreachTree = createForeachTreeFunc(false);\nexports.foreachTreeAsync = createForeachTreeFunc(true);\n\nexports.findField = function (fields, id) {\n  var i;\n  var field;\n\n  if (fields && (0, _type.isDefined)(id)) {\n    for (i = 0; i < fields.length; i++) {\n      field = fields[i];\n\n      if (field.name === id || field.caption === id || field.dataField === id || field.index === id) {\n        return i;\n      }\n    }\n  }\n\n  return -1;\n};\n\nexports.formatValue = function (value, options) {\n  var formatObject = {\n    value: value,\n    valueText: (0, _format_helper.format)(value, options.format) || \"\"\n  };\n  return options.customizeText ? options.customizeText.call(options, formatObject) : formatObject.valueText;\n};\n\nexports.getCompareFunction = function (valueSelector) {\n  return function (a, b) {\n    var result = 0;\n    var valueA = valueSelector(a);\n    var valueB = valueSelector(b);\n    var aIsDefined = (0, _type.isDefined)(valueA);\n    var bIsDefined = (0, _type.isDefined)(valueB);\n\n    if (aIsDefined && bIsDefined) {\n      if (valueA > valueB) {\n        result = 1;\n      } else {\n        if (valueA < valueB) {\n          result = -1;\n        }\n      }\n    }\n\n    if (aIsDefined && !bIsDefined) {\n      result = 1;\n    }\n\n    if (!aIsDefined && bIsDefined) {\n      result = -1;\n    }\n\n    return result;\n  };\n};\n\nexports.createPath = function (items) {\n  var result = [];\n  var i;\n\n  for (i = items.length - 1; i >= 0; i--) {\n    result.push(items[i].key || items[i].value);\n  }\n\n  return result;\n};\n\nexports.foreachDataLevel = function foreachDataLevel(data, callback, index, childrenField) {\n  var item;\n  var i;\n  index = index || 0;\n  childrenField = childrenField || \"children\";\n\n  if (data.length) {\n    callback(data, index);\n  }\n\n  for (i = 0; i < data.length; i++) {\n    item = data[i];\n\n    if (item[childrenField] && item[childrenField].length) {\n      foreachDataLevel(item[childrenField], callback, index + 1, childrenField);\n    }\n  }\n};\n\nexports.mergeArraysByMaxValue = function (values1, values2) {\n  var result = [];\n  var i;\n\n  for (i = 0; i < values1.length; i++) {\n    result.push(Math.max(values1[i] || 0, values2[i] || 0));\n  }\n\n  return result;\n};\n\nexports.getExpandedLevel = function (options, axisName) {\n  var dimensions = options[axisName];\n  var expandLevel = 0;\n  var expandedPaths = (\"columns\" === axisName ? options.columnExpandedPaths : options.rowExpandedPaths) || [];\n\n  if (options.headerName === axisName) {\n    expandLevel = options.path.length;\n  } else {\n    if (options.headerName && options.headerName !== axisName && options.oppositePath) {\n      expandLevel = options.oppositePath.length;\n    } else {\n      (0, _iterator.each)(expandedPaths, function (_, path) {\n        expandLevel = Math.max(expandLevel, path.length);\n      });\n    }\n  }\n\n  while (dimensions[expandLevel + 1] && dimensions[expandLevel].expanded) {\n    expandLevel++;\n  }\n\n  return expandLevel;\n};\n\nfunction createGroupFields(item) {\n  return (0, _iterator.map)([\"year\", \"quarter\", \"month\"], function (value, index) {\n    return (0, _extend.extend)({}, item, {\n      groupInterval: value,\n      groupIndex: index\n    });\n  });\n}\n\nfunction parseFields(dataSource, fieldsList, path, fieldsDataType) {\n  var result = [];\n  (0, _iterator.each)(fieldsList || [], function (field, value) {\n    if (field && 0 === field.indexOf(\"__\")) {\n      return;\n    }\n\n    var dataIndex = 1;\n    var currentPath = path.length ? path + \".\" + field : field;\n    var dataType = fieldsDataType[currentPath];\n    var getter = (0, _data.compileGetter)(currentPath);\n    var items;\n\n    while (!(0, _type.isDefined)(value) && dataSource[dataIndex]) {\n      value = getter(dataSource[dataIndex]);\n      dataIndex++;\n    }\n\n    if (!dataType && (0, _type.isDefined)(value)) {\n      dataType = (0, _type.type)(value);\n    }\n\n    items = [{\n      dataField: currentPath,\n      dataType: dataType,\n      groupName: \"date\" === dataType ? field : void 0,\n      groupInterval: void 0,\n      displayFolder: path\n    }];\n\n    if (\"date\" === dataType) {\n      items = items.concat(createGroupFields(items[0]));\n    } else {\n      if (\"object\" === dataType) {\n        items = parseFields(dataSource, value, currentPath, fieldsDataType);\n      }\n    }\n\n    result.push.apply(result, items);\n  });\n  return result;\n}\n\nexports.discoverObjectFields = function (items, fields) {\n  var fieldsDataType = exports.getFieldsDataType(fields);\n  return parseFields(items, items[0], \"\", fieldsDataType);\n};\n\nexports.getFieldsDataType = function (fields) {\n  var result = {};\n  (0, _iterator.each)(fields, function (_, field) {\n    result[field.dataField] = result[field.dataField] || field.dataType;\n  });\n  return result;\n};\n\nvar DATE_INTERVAL_FORMATS = {\n  month: function month(value) {\n    return (0, _date.getMonthNames)()[value - 1];\n  },\n  quarter: function quarter(value) {\n    return (0, _date.format)(new Date(2e3, 3 * value - 1), \"quarter\");\n  },\n  dayOfWeek: function dayOfWeek(value) {\n    return (0, _date.getDayNames)()[value];\n  }\n};\n\nexports.setDefaultFieldValueFormatting = function (field) {\n  if (\"date\" === field.dataType) {\n    if (!field.format) {\n      setFieldProperty(field, \"format\", DATE_INTERVAL_FORMATS[field.groupInterval]);\n    }\n  } else {\n    if (\"number\" === field.dataType) {\n      var groupInterval = (0, _type.isNumeric)(field.groupInterval) && field.groupInterval > 0 && field.groupInterval;\n\n      if (groupInterval && !field.customizeText) {\n        setFieldProperty(field, \"customizeText\", function (formatObject) {\n          var secondValue = formatObject.value + groupInterval;\n          var secondValueText = (0, _format_helper.format)(secondValue, field.format);\n          return formatObject.valueText && secondValueText ? formatObject.valueText + \" - \" + secondValueText : \"\";\n        });\n      }\n    }\n  }\n};\n\nexports.getFiltersByPath = function (fields, path) {\n  var result = [];\n  path = path || [];\n\n  for (var i = 0; i < path.length; i++) {\n    result.push((0, _extend.extend)({}, fields[i], {\n      groupIndex: null,\n      groupName: null,\n      filterType: \"include\",\n      filterValues: [path[i]]\n    }));\n  }\n\n  return result;\n};\n\nexports.storeDrillDownMixin = {\n  createDrillDownDataSource: function createDrillDownDataSource(descriptions, params) {\n    function createCustomStoreMethod(methodName) {\n      return function (options) {\n        var d;\n\n        if (arrayStore) {\n          d = arrayStore[methodName](options);\n        } else {\n          d = new _deferred.Deferred();\n          (0, _deferred.when)(items).done(function (data) {\n            arrayStore = new _array_store2.default(data);\n            arrayStore[methodName](options).done(d.resolve).fail(d.reject);\n          }).fail(d.reject);\n        }\n\n        return d;\n      };\n    }\n\n    var items = this.getDrillDownItems(descriptions, params);\n    var arrayStore;\n    var dataSource = new _data_source.DataSource({\n      load: createCustomStoreMethod(\"load\"),\n      totalCount: createCustomStoreMethod(\"totalCount\"),\n      key: this.key()\n    });\n    return dataSource;\n  }\n};\n\nexports.capitalizeFirstLetter = function (string) {\n  return string.charAt(0).toUpperCase() + string.slice(1);\n};","map":{"version":3,"sources":["C:/Users/User/Documents/Templates/Angular/black-dashboard-pro-angular-v1.1.1/black-dashboard-pro-angular-v1.1.1/node_modules/devextreme/ui/pivot_grid/ui.pivot_grid.utils.js"],"names":["_type","require","_ajax","_data","_iterator","_extend","_date","_format_helper","_data_source","_array_store","_array_store2","_interopRequireDefault","_deferred","obj","__esModule","setFieldProperty","exports","field","property","value","isInitialization","initProperties","_initProperties","initValue","Object","prototype","hasOwnProperty","call","sendRequest","options","foreachTreeAsyncDate","Date","createForeachTreeFunc","isAsync","foreachTreeFunc","items","callback","parentAtFirst","members","index","isChildrenProcessing","item","i","deferred","childrenDeferred","createForeachTreeAsyncHandler","when","done","resolve","length","Deferred","setTimeout","unshift","children","shift","foreachTree","foreachTreeAsync","findField","fields","id","isDefined","name","caption","dataField","formatValue","formatObject","valueText","format","customizeText","getCompareFunction","valueSelector","a","b","result","valueA","valueB","aIsDefined","bIsDefined","createPath","push","key","foreachDataLevel","data","childrenField","mergeArraysByMaxValue","values1","values2","Math","max","getExpandedLevel","axisName","dimensions","expandLevel","expandedPaths","columnExpandedPaths","rowExpandedPaths","headerName","path","oppositePath","each","_","expanded","createGroupFields","map","extend","groupInterval","groupIndex","parseFields","dataSource","fieldsList","fieldsDataType","indexOf","dataIndex","currentPath","dataType","getter","compileGetter","type","groupName","displayFolder","concat","apply","discoverObjectFields","getFieldsDataType","DATE_INTERVAL_FORMATS","month","getMonthNames","quarter","dayOfWeek","getDayNames","setDefaultFieldValueFormatting","isNumeric","secondValue","secondValueText","getFiltersByPath","filterType","filterValues","storeDrillDownMixin","createDrillDownDataSource","descriptions","params","createCustomStoreMethod","methodName","d","arrayStore","default","fail","reject","getDrillDownItems","DataSource","load","totalCount","capitalizeFirstLetter","string","charAt","toUpperCase","slice"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/pivot_grid/ui.pivot_grid.utils.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar _type = require(\"../../core/utils/type\");\r\nvar _ajax = require(\"../../core/utils/ajax\");\r\nvar _data = require(\"../../core/utils/data\");\r\nvar _iterator = require(\"../../core/utils/iterator\");\r\nvar _extend = require(\"../../core/utils/extend\");\r\nvar _date = require(\"../../localization/date\");\r\nvar _format_helper = require(\"../../format_helper\");\r\nvar _data_source = require(\"../../data/data_source/data_source\");\r\nvar _array_store = require(\"../../data/array_store\");\r\nvar _array_store2 = _interopRequireDefault(_array_store);\r\nvar _deferred = require(\"../../core/utils/deferred\");\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\nvar setFieldProperty = exports.setFieldProperty = function(field, property, value, isInitialization) {\r\n    var initProperties = field._initProperties = field._initProperties || {};\r\n    var initValue = isInitialization ? value : field[property];\r\n    if (!Object.prototype.hasOwnProperty.call(initProperties, property) || isInitialization) {\r\n        initProperties[property] = initValue\r\n    }\r\n    field[property] = value\r\n};\r\nexports.sendRequest = function(options) {\r\n    return (0, _ajax.sendRequest)(options)\r\n};\r\nvar foreachTreeAsyncDate = new Date;\r\n\r\nfunction createForeachTreeFunc(isAsync) {\r\n    var foreachTreeFunc = function foreachTreeFunc(items, callback, parentAtFirst, members, index, isChildrenProcessing) {\r\n        members = members || [];\r\n        items = items || [];\r\n        var item;\r\n        var i;\r\n        var deferred;\r\n        var childrenDeferred;\r\n        index = index || 0;\r\n\r\n        function createForeachTreeAsyncHandler(deferred, i, isChildrenProcessing) {\r\n            (0, _deferred.when)(foreachTreeFunc(items, callback, parentAtFirst, members, i, isChildrenProcessing)).done(deferred.resolve)\r\n        }\r\n        for (i = index; i < items.length; i++) {\r\n            if (isAsync && i > index && i % 1e4 === 0 && new Date - foreachTreeAsyncDate >= 300) {\r\n                foreachTreeAsyncDate = new Date;\r\n                deferred = new _deferred.Deferred;\r\n                setTimeout(createForeachTreeAsyncHandler(deferred, i, false), 0);\r\n                return deferred\r\n            }\r\n            item = items[i];\r\n            if (!isChildrenProcessing) {\r\n                members.unshift(item);\r\n                if (parentAtFirst && false === callback(members, i)) {\r\n                    return\r\n                }\r\n                if (item.children) {\r\n                    childrenDeferred = foreachTreeFunc(item.children, callback, parentAtFirst, members);\r\n                    if (isAsync && childrenDeferred) {\r\n                        deferred = new _deferred.Deferred;\r\n                        childrenDeferred.done(createForeachTreeAsyncHandler(deferred, i, true));\r\n                        return deferred\r\n                    }\r\n                }\r\n            }\r\n            isChildrenProcessing = false;\r\n            if (!parentAtFirst && false === callback(members, i)) {\r\n                return\r\n            }\r\n            members.shift();\r\n            if (items[i] !== item) {\r\n                i--\r\n            }\r\n        }\r\n    };\r\n    return foreachTreeFunc\r\n}\r\nexports.foreachTree = createForeachTreeFunc(false);\r\nexports.foreachTreeAsync = createForeachTreeFunc(true);\r\nexports.findField = function(fields, id) {\r\n    var i;\r\n    var field;\r\n    if (fields && (0, _type.isDefined)(id)) {\r\n        for (i = 0; i < fields.length; i++) {\r\n            field = fields[i];\r\n            if (field.name === id || field.caption === id || field.dataField === id || field.index === id) {\r\n                return i\r\n            }\r\n        }\r\n    }\r\n    return -1\r\n};\r\nexports.formatValue = function(value, options) {\r\n    var formatObject = {\r\n        value: value,\r\n        valueText: (0, _format_helper.format)(value, options.format) || \"\"\r\n    };\r\n    return options.customizeText ? options.customizeText.call(options, formatObject) : formatObject.valueText\r\n};\r\nexports.getCompareFunction = function(valueSelector) {\r\n    return function(a, b) {\r\n        var result = 0;\r\n        var valueA = valueSelector(a);\r\n        var valueB = valueSelector(b);\r\n        var aIsDefined = (0, _type.isDefined)(valueA);\r\n        var bIsDefined = (0, _type.isDefined)(valueB);\r\n        if (aIsDefined && bIsDefined) {\r\n            if (valueA > valueB) {\r\n                result = 1\r\n            } else {\r\n                if (valueA < valueB) {\r\n                    result = -1\r\n                }\r\n            }\r\n        }\r\n        if (aIsDefined && !bIsDefined) {\r\n            result = 1\r\n        }\r\n        if (!aIsDefined && bIsDefined) {\r\n            result = -1\r\n        }\r\n        return result\r\n    }\r\n};\r\nexports.createPath = function(items) {\r\n    var result = [];\r\n    var i;\r\n    for (i = items.length - 1; i >= 0; i--) {\r\n        result.push(items[i].key || items[i].value)\r\n    }\r\n    return result\r\n};\r\nexports.foreachDataLevel = function foreachDataLevel(data, callback, index, childrenField) {\r\n    var item;\r\n    var i;\r\n    index = index || 0;\r\n    childrenField = childrenField || \"children\";\r\n    if (data.length) {\r\n        callback(data, index)\r\n    }\r\n    for (i = 0; i < data.length; i++) {\r\n        item = data[i];\r\n        if (item[childrenField] && item[childrenField].length) {\r\n            foreachDataLevel(item[childrenField], callback, index + 1, childrenField)\r\n        }\r\n    }\r\n};\r\nexports.mergeArraysByMaxValue = function(values1, values2) {\r\n    var result = [];\r\n    var i;\r\n    for (i = 0; i < values1.length; i++) {\r\n        result.push(Math.max(values1[i] || 0, values2[i] || 0))\r\n    }\r\n    return result\r\n};\r\nexports.getExpandedLevel = function(options, axisName) {\r\n    var dimensions = options[axisName];\r\n    var expandLevel = 0;\r\n    var expandedPaths = (\"columns\" === axisName ? options.columnExpandedPaths : options.rowExpandedPaths) || [];\r\n    if (options.headerName === axisName) {\r\n        expandLevel = options.path.length\r\n    } else {\r\n        if (options.headerName && options.headerName !== axisName && options.oppositePath) {\r\n            expandLevel = options.oppositePath.length\r\n        } else {\r\n            (0, _iterator.each)(expandedPaths, function(_, path) {\r\n                expandLevel = Math.max(expandLevel, path.length)\r\n            })\r\n        }\r\n    }\r\n    while (dimensions[expandLevel + 1] && dimensions[expandLevel].expanded) {\r\n        expandLevel++\r\n    }\r\n    return expandLevel\r\n};\r\n\r\nfunction createGroupFields(item) {\r\n    return (0, _iterator.map)([\"year\", \"quarter\", \"month\"], function(value, index) {\r\n        return (0, _extend.extend)({}, item, {\r\n            groupInterval: value,\r\n            groupIndex: index\r\n        })\r\n    })\r\n}\r\n\r\nfunction parseFields(dataSource, fieldsList, path, fieldsDataType) {\r\n    var result = [];\r\n    (0, _iterator.each)(fieldsList || [], function(field, value) {\r\n        if (field && 0 === field.indexOf(\"__\")) {\r\n            return\r\n        }\r\n        var dataIndex = 1;\r\n        var currentPath = path.length ? path + \".\" + field : field;\r\n        var dataType = fieldsDataType[currentPath];\r\n        var getter = (0, _data.compileGetter)(currentPath);\r\n        var items;\r\n        while (!(0, _type.isDefined)(value) && dataSource[dataIndex]) {\r\n            value = getter(dataSource[dataIndex]);\r\n            dataIndex++\r\n        }\r\n        if (!dataType && (0, _type.isDefined)(value)) {\r\n            dataType = (0, _type.type)(value)\r\n        }\r\n        items = [{\r\n            dataField: currentPath,\r\n            dataType: dataType,\r\n            groupName: \"date\" === dataType ? field : void 0,\r\n            groupInterval: void 0,\r\n            displayFolder: path\r\n        }];\r\n        if (\"date\" === dataType) {\r\n            items = items.concat(createGroupFields(items[0]))\r\n        } else {\r\n            if (\"object\" === dataType) {\r\n                items = parseFields(dataSource, value, currentPath, fieldsDataType)\r\n            }\r\n        }\r\n        result.push.apply(result, items)\r\n    });\r\n    return result\r\n}\r\nexports.discoverObjectFields = function(items, fields) {\r\n    var fieldsDataType = exports.getFieldsDataType(fields);\r\n    return parseFields(items, items[0], \"\", fieldsDataType)\r\n};\r\nexports.getFieldsDataType = function(fields) {\r\n    var result = {};\r\n    (0, _iterator.each)(fields, function(_, field) {\r\n        result[field.dataField] = result[field.dataField] || field.dataType\r\n    });\r\n    return result\r\n};\r\nvar DATE_INTERVAL_FORMATS = {\r\n    month: function(value) {\r\n        return (0, _date.getMonthNames)()[value - 1]\r\n    },\r\n    quarter: function(value) {\r\n        return (0, _date.format)(new Date(2e3, 3 * value - 1), \"quarter\")\r\n    },\r\n    dayOfWeek: function(value) {\r\n        return (0, _date.getDayNames)()[value]\r\n    }\r\n};\r\nexports.setDefaultFieldValueFormatting = function(field) {\r\n    if (\"date\" === field.dataType) {\r\n        if (!field.format) {\r\n            setFieldProperty(field, \"format\", DATE_INTERVAL_FORMATS[field.groupInterval])\r\n        }\r\n    } else {\r\n        if (\"number\" === field.dataType) {\r\n            var groupInterval = (0, _type.isNumeric)(field.groupInterval) && field.groupInterval > 0 && field.groupInterval;\r\n            if (groupInterval && !field.customizeText) {\r\n                setFieldProperty(field, \"customizeText\", function(formatObject) {\r\n                    var secondValue = formatObject.value + groupInterval;\r\n                    var secondValueText = (0, _format_helper.format)(secondValue, field.format);\r\n                    return formatObject.valueText && secondValueText ? formatObject.valueText + \" - \" + secondValueText : \"\"\r\n                })\r\n            }\r\n        }\r\n    }\r\n};\r\nexports.getFiltersByPath = function(fields, path) {\r\n    var result = [];\r\n    path = path || [];\r\n    for (var i = 0; i < path.length; i++) {\r\n        result.push((0, _extend.extend)({}, fields[i], {\r\n            groupIndex: null,\r\n            groupName: null,\r\n            filterType: \"include\",\r\n            filterValues: [path[i]]\r\n        }))\r\n    }\r\n    return result\r\n};\r\nexports.storeDrillDownMixin = {\r\n    createDrillDownDataSource: function(descriptions, params) {\r\n        function createCustomStoreMethod(methodName) {\r\n            return function(options) {\r\n                var d;\r\n                if (arrayStore) {\r\n                    d = arrayStore[methodName](options)\r\n                } else {\r\n                    d = new _deferred.Deferred;\r\n                    (0, _deferred.when)(items).done(function(data) {\r\n                        arrayStore = new _array_store2.default(data);\r\n                        arrayStore[methodName](options).done(d.resolve).fail(d.reject)\r\n                    }).fail(d.reject)\r\n                }\r\n                return d\r\n            }\r\n        }\r\n        var items = this.getDrillDownItems(descriptions, params);\r\n        var arrayStore;\r\n        var dataSource = new _data_source.DataSource({\r\n            load: createCustomStoreMethod(\"load\"),\r\n            totalCount: createCustomStoreMethod(\"totalCount\"),\r\n            key: this.key()\r\n        });\r\n        return dataSource\r\n    }\r\n};\r\nexports.capitalizeFirstLetter = function(string) {\r\n    return string.charAt(0).toUpperCase() + string.slice(1)\r\n};\r\n"]},"metadata":{},"sourceType":"script"}