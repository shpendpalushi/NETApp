{"ast":null,"code":"/**\r\n * DevExtreme (viz/tree_map/tree_map.base.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar _common = require(\"./common\");\n\nvar _node = require(\"./node\");\n\nvar _node2 = _interopRequireDefault(_node);\n\nvar _tiling = require(\"./tiling\");\n\nvar _colorizing = require(\"./colorizing\");\n\nvar _utils = require(\"../core/utils\");\n\nvar _common2 = require(\"../../core/utils/common\");\n\nvar _type = require(\"../../core/utils/type\");\n\nvar _extend2 = require(\"../../core/utils/extend\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nvar _max = Math.max;\nvar directions = {\n  lefttoprightbottom: [1, 1],\n  leftbottomrighttop: [1, -1],\n  righttopleftbottom: [-1, 1],\n  rightbottomlefttop: [-1, -1]\n};\n\nrequire(\"./tiling.squarified\");\n\nrequire(\"./tiling\").setDefaultAlgorithm(\"squarified\");\n\nrequire(\"./colorizing.discrete\");\n\nrequire(\"./colorizing\").setDefaultColorizer(\"discrete\");\n\nfunction pickPositiveInteger(val) {\n  return val > 0 ? Math.round(val) : 0;\n}\n\nvar dxTreeMap = require(\"../core/base_widget\").inherit({\n  _handlers: {\n    beginBuildNodes: _common2.noop,\n    buildNode: _common2.noop,\n    endBuildNodes: _common2.noop,\n    setTrackerData: _common2.noop,\n    calculateState: function calculateState(options) {\n      return (0, _common.buildRectAppearance)(options);\n    }\n  },\n  _rootClass: \"dxtm-tree-map\",\n  _rootClassPrefix: \"dxtm\",\n  _getDefaultSize: function _getDefaultSize() {\n    return {\n      width: 400,\n      height: 400\n    };\n  },\n  _setDeprecatedOptions: function _setDeprecatedOptions() {\n    this.callBase.apply(this, arguments);\n    (0, _extend2.extend)(this._deprecatedOptions, {\n      resolveLabelOverflow: {\n        since: \"19.1\",\n        message: \"Use the 'tile.label.overflow' and 'group.label.textOverflow' option instead\"\n      }\n    });\n  },\n  _themeSection: \"treeMap\",\n  _fontFields: [\"tile.label.font\", \"group.label.font\"],\n  _init: function _init() {\n    var that = this;\n    that._rectOffsets = {};\n    that._handlers = Object.create(that._handlers);\n    that._context = {\n      suspend: function suspend() {\n        if (!that._applyingChanges) {\n          that._suspendChanges();\n        }\n      },\n      resume: function resume() {\n        if (!that._applyingChanges) {\n          that._resumeChanges();\n        }\n      },\n      change: function change(codes) {\n        that._change(codes);\n      },\n      settings: [{}, {}],\n      calculateState: that._handlers.calculateState,\n      calculateLabelState: _common.buildTextAppearance\n    };\n    that._root = that._topNode = {\n      nodes: []\n    };\n    that.callBase.apply(that, arguments);\n  },\n  _initialChanges: [\"DATA_SOURCE\"],\n  _initCore: function _initCore() {\n    var that = this;\n    var renderer = that._renderer;\n\n    that._createProxyType();\n\n    that._tilesGroup = renderer.g().linkOn(renderer.root, \"tiles\").linkAppend();\n    that._labelsGroup = renderer.g().linkOn(renderer.root, \"labels\").linkAppend();\n  },\n  _createProxyType: _common2.noop,\n  _disposeCore: function _disposeCore() {\n    var that = this;\n    that._filter && that._filter.dispose();\n\n    that._labelsGroup.linkOff();\n\n    that._tilesGroup.linkOff();\n  },\n  _applySize: function _applySize(rect) {\n    this._tilingRect = rect.slice();\n\n    this._change([\"TILING\"]);\n  },\n  _optionChangesMap: {\n    dataSource: \"DATA_SOURCE\",\n    valueField: \"NODES_CREATE\",\n    childrenField: \"NODES_CREATE\",\n    colorField: \"TILES\",\n    colorizer: \"TILES\",\n    labelField: \"LABELS\",\n    tile: \"TILE_SETTINGS\",\n    group: \"GROUP_SETTINGS\",\n    maxDepth: \"MAX_DEPTH\",\n    layoutAlgorithm: \"TILING\",\n    layoutDirection: \"TILING\",\n    resolveLabelOverflow: \"LABEL_OVERFLOW\"\n  },\n  _themeDependentChanges: [\"TILE_SETTINGS\", \"GROUP_SETTINGS\", \"MAX_DEPTH\"],\n  _changeDataSource: function _changeDataSource() {\n    var that = this;\n    that._isDataExpected = that._isSyncData = true;\n\n    that._updateDataSource();\n\n    that._isSyncData = false;\n\n    if (that._isDataExpected) {\n      that._suspendChanges();\n    }\n  },\n  _dataSourceChangedHandler: function _dataSourceChangedHandler() {\n    var that = this;\n\n    if (that._isDataExpected) {\n      that._isDataExpected = false;\n\n      that._change([\"NODES_CREATE\"]);\n\n      if (!that._isSyncData) {\n        that._resumeChanges();\n      }\n    } else {\n      that._requestChange([\"NODES_CREATE\"]);\n    }\n  },\n  _optionChangesOrder: [\"DATA_SOURCE\", \"TILE_SETTINGS\", \"GROUP_SETTINGS\", \"MAX_DEPTH\", \"LABEL_OVERFLOW\"],\n  _change_DATA_SOURCE: function _change_DATA_SOURCE() {\n    this._changeDataSource();\n  },\n  _change_TILE_SETTINGS: function _change_TILE_SETTINGS() {\n    this._changeTileSettings();\n  },\n  _change_GROUP_SETTINGS: function _change_GROUP_SETTINGS() {\n    this._changeGroupSettings();\n  },\n  _change_LABEL_OVERFLOW: function _change_LABEL_OVERFLOW() {\n    this._changeTileSettings();\n\n    this._changeGroupSettings();\n  },\n  _change_MAX_DEPTH: function _change_MAX_DEPTH() {\n    this._changeMaxDepth();\n  },\n  _customChangesOrder: [\"NODES_CREATE\", \"NODES_RESET\", \"TILES\", \"LABELS\", \"TILING\", \"LABELS_LAYOUT\"],\n  _change_NODES_CREATE: function _change_NODES_CREATE() {\n    this._buildNodes();\n  },\n  _change_NODES_RESET: function _change_NODES_RESET() {\n    this._resetNodes();\n  },\n  _change_TILES: function _change_TILES() {\n    this._applyTilesAppearance();\n  },\n  _change_LABELS: function _change_LABELS() {\n    this._applyLabelsAppearance();\n  },\n  _change_TILING: function _change_TILING() {\n    this._performTiling();\n  },\n  _change_LABELS_LAYOUT: function _change_LABELS_LAYOUT() {\n    this._performLabelsLayout();\n  },\n  _applyChanges: function _applyChanges() {\n    var that = this;\n    that.callBase.apply(that, arguments);\n\n    if (!that._isDataExpected) {\n      that._drawn();\n    }\n\n    that._context.forceReset = false;\n  },\n  _buildNodes: function _buildNodes() {\n    var that = this;\n    var root = that._root = that._topNode = new _node2.default();\n    var processedData;\n    root._id = 0;\n    root.parent = {};\n    root.data = {};\n    root.level = root.index = -1;\n    root.ctx = that._context;\n    root.label = null;\n    that._nodes = [root];\n\n    that._handlers.beginBuildNodes();\n\n    processedData = that._processDataSourceItems(that._dataSourceItems() || []);\n    traverseDataItems(root, processedData.items, 0, {\n      itemsField: !processedData.isPlain && that._getOption(\"childrenField\", true) || \"items\",\n      valueField: that._getOption(\"valueField\", true) || \"value\",\n      buildNode: that._handlers.buildNode,\n      ctx: that._context,\n      nodes: that._nodes\n    });\n\n    that._onNodesCreated();\n\n    that._handlers.endBuildNodes();\n\n    that._change([\"NODES_RESET\"]);\n  },\n  _onNodesCreated: _common2.noop,\n  _processDataSourceItems: function _processDataSourceItems(items) {\n    return {\n      items: items,\n      isPlain: false\n    };\n  },\n  _changeTileSettings: function _changeTileSettings() {\n    var that = this;\n\n    var options = that._getOption(\"tile\");\n\n    var offsets = that._rectOffsets;\n    var borderWidth = pickPositiveInteger(options.border.width);\n    var edgeOffset = borderWidth / 2;\n    var innerOffset = 1 & borderWidth ? .5 : 0;\n    var labelOptions = options.label;\n    var settings = that._context.settings[0];\n\n    that._change([\"TILES\", \"LABELS\"]);\n\n    settings.state = that._handlers.calculateState(options);\n    that._filter = that._filter || that._renderer.shadowFilter(\"-50%\", \"-50%\", \"200%\", \"200%\");\n\n    that._filter.attr(labelOptions.shadow);\n\n    that._calculateLabelSettings(settings, labelOptions, that._filter.id);\n\n    if (offsets.tileEdge !== edgeOffset || offsets.tileInner !== innerOffset) {\n      offsets.tileEdge = edgeOffset;\n      offsets.tileInner = innerOffset;\n\n      that._change([\"TILING\"]);\n    }\n  },\n  _changeGroupSettings: function _changeGroupSettings() {\n    var that = this;\n\n    var options = that._getOption(\"group\");\n\n    var labelOptions = options.label;\n    var offsets = that._rectOffsets;\n    var borderWidth = pickPositiveInteger(options.border.width);\n    var edgeOffset = borderWidth / 2;\n    var innerOffset = 1 & borderWidth ? .5 : 0;\n    var headerHeight = 0;\n    var groupPadding = pickPositiveInteger(options.padding);\n    var settings = that._context.settings[1];\n\n    that._change([\"TILES\", \"LABELS\"]);\n\n    settings.state = that._handlers.calculateState(options);\n\n    that._calculateLabelSettings(settings, labelOptions);\n\n    if (options.headerHeight >= 0) {\n      headerHeight = pickPositiveInteger(options.headerHeight);\n    } else {\n      headerHeight = settings.labelParams.height + 2 * pickPositiveInteger(labelOptions.paddingTopBottom);\n    }\n\n    if (that._headerHeight !== headerHeight) {\n      that._headerHeight = headerHeight;\n\n      that._change([\"TILING\"]);\n    }\n\n    if (that._groupPadding !== groupPadding) {\n      that._groupPadding = groupPadding;\n\n      that._change([\"TILING\"]);\n    }\n\n    if (offsets.headerEdge !== edgeOffset || offsets.headerInner !== innerOffset) {\n      offsets.headerEdge = edgeOffset;\n      offsets.headerInner = innerOffset;\n\n      that._change([\"TILING\"]);\n    }\n  },\n  _calculateLabelSettings: function _calculateLabelSettings(settings, options, filter) {\n    var bBox = this._getTextBBox(options.font);\n\n    var paddingLeftRight = pickPositiveInteger(options.paddingLeftRight);\n    var paddingTopBottom = pickPositiveInteger(options.paddingTopBottom);\n\n    var tileLabelOptions = this._getOption(\"tile.label\");\n\n    var groupLabelOptions = this._getOption(\"group.label\");\n\n    settings.labelState = (0, _common.buildTextAppearance)(options, filter);\n    settings.labelState.visible = !(\"visible\" in options) || !!options.visible;\n    settings.labelParams = {\n      height: bBox.height,\n      rtlEnabled: this._getOption(\"rtlEnabled\", true),\n      paddingTopBottom: paddingTopBottom,\n      paddingLeftRight: paddingLeftRight,\n      resolveLabelOverflow: this._getOptionByStealth(\"resolveLabelOverflow\"),\n      tileLabelWordWrap: tileLabelOptions.wordWrap,\n      tileLabelOverflow: tileLabelOptions.textOverflow,\n      groupLabelOverflow: groupLabelOptions.textOverflow\n    };\n  },\n  _changeMaxDepth: function _changeMaxDepth() {\n    var maxDepth = this._getOption(\"maxDepth\", true);\n\n    maxDepth = maxDepth >= 1 ? Math.round(maxDepth) : 1 / 0;\n\n    if (this._maxDepth !== maxDepth) {\n      this._maxDepth = maxDepth;\n\n      this._change([\"NODES_RESET\"]);\n    }\n  },\n  _resetNodes: function _resetNodes() {\n    var that = this;\n\n    that._tilesGroup.clear();\n\n    that._renderer.initHatching();\n\n    that._context.forceReset = true;\n    that._context.minLevel = that._topNode.level + 1;\n    that._context.maxLevel = that._context.minLevel + that._maxDepth - 1;\n\n    that._change([\"TILES\", \"LABELS\", \"TILING\"]);\n  },\n  _processNodes: function _processNodes(context, process) {\n    processNodes(context, this._topNode, process);\n  },\n  _applyTilesAppearance: function _applyTilesAppearance() {\n    var that = this;\n    var colorizer = (0, _colorizing.getColorizer)(that._getOption(\"colorizer\"), that._themeManager, that._topNode);\n\n    that._processNodes({\n      renderer: that._renderer,\n      group: that._tilesGroup,\n      setTrackerData: that._handlers.setTrackerData,\n      colorField: that._getOption(\"colorField\", true) || \"color\",\n      getColor: colorizer\n    }, processTileAppearance);\n  },\n  _applyLabelsAppearance: function _applyLabelsAppearance() {\n    var that = this;\n\n    that._labelsGroup.clear();\n\n    that._processNodes({\n      renderer: that._renderer,\n      group: that._labelsGroup,\n      setTrackerData: that._handlers.setTrackerData,\n      labelField: that._getOption(\"labelField\", true) || \"name\"\n    }, processLabelAppearance);\n\n    that._change([\"LABELS_LAYOUT\"]);\n  },\n  _performTiling: function _performTiling() {\n    var that = this;\n    var context = {\n      algorithm: (0, _tiling.getAlgorithm)(that._getOption(\"layoutAlgorithm\", true)),\n      directions: directions[String(that._getOption(\"layoutDirection\", true)).toLowerCase()] || directions.lefttoprightbottom,\n      headerHeight: that._headerHeight,\n      groupPadding: that._groupPadding,\n      rectOffsets: that._rectOffsets\n    };\n    that._topNode.innerRect = that._tilingRect;\n    calculateRects(context, that._topNode);\n\n    that._processNodes(context, processTiling);\n\n    that._change([\"LABELS_LAYOUT\"]);\n\n    that._onTilingPerformed();\n  },\n  _onTilingPerformed: _common2.noop,\n  _performLabelsLayout: function _performLabelsLayout() {\n    this._processNodes(null, processLabelsLayout);\n  },\n  _getTextBBox: function _getTextBBox(fontOptions) {\n    var renderer = this._renderer;\n    var text = this._textForCalculations || renderer.text(\"0\", 0, 0);\n    var bBox;\n    this._textForCalculations = text;\n    text.css((0, _utils.patchFontOptions)(fontOptions)).append(renderer.root);\n    bBox = text.getBBox();\n    text.remove();\n    return bBox;\n  }\n});\n\nfunction traverseDataItems(root, dataItems, level, params) {\n  var nodes = [];\n  var allNodes = params.nodes;\n  var node;\n  var i;\n  var ii = dataItems.length;\n  var dataItem;\n  var totalValue = 0;\n  var items;\n\n  for (i = 0; i < ii; ++i) {\n    dataItem = dataItems[i];\n    node = new _node2.default();\n    node._id = allNodes.length;\n    node.ctx = params.ctx;\n    node.parent = root;\n    node.level = level;\n    node.index = nodes.length;\n    node.data = dataItem;\n    params.buildNode(node);\n    allNodes.push(node);\n    nodes.push(node);\n    items = dataItem[params.itemsField];\n\n    if (items && items.length) {\n      traverseDataItems(node, items, level + 1, params);\n    }\n\n    if (dataItem[params.valueField] > 0) {\n      node.value = Number(dataItem[params.valueField]);\n    }\n\n    totalValue += node.value;\n  }\n\n  root.nodes = nodes;\n  root.value = totalValue;\n}\n\nfunction processNodes(context, root, process) {\n  var nodes = root.nodes;\n  var node;\n  var i;\n  var ii = nodes.length;\n\n  for (i = 0; i < ii; ++i) {\n    node = nodes[i];\n    process(context, node);\n\n    if (node.isNode()) {\n      processNodes(context, node, process);\n    }\n  }\n}\n\nfunction processTileAppearance(context, node) {\n  node.color = node.data[context.colorField] || context.getColor(node) || node.parent.color;\n  node.updateStyles();\n  node.tile = !node.ctx.forceReset && node.tile || createTile[Number(node.isNode())](context, node);\n  node.applyState();\n}\n\nvar createTile = [createLeaf, createGroup];\n\nfunction createLeaf(context, node) {\n  var tile = context.renderer.simpleRect().append(context.group);\n  context.setTrackerData(node, tile);\n  return tile;\n}\n\nfunction createGroup(context, node) {\n  var outer = context.renderer.simpleRect().append(context.group);\n  var inner = context.renderer.simpleRect().append(context.group);\n  context.setTrackerData(node, inner);\n  return {\n    outer: outer,\n    inner: inner\n  };\n}\n\nfunction processLabelAppearance(context, node) {\n  node.updateLabelStyle();\n\n  if (node.labelState.visible) {\n    createLabel(context, node, node.labelState, node.labelParams);\n  }\n}\n\nfunction createLabel(context, currentNode, settings, params) {\n  var textData = currentNode.data[context.labelField];\n  currentNode.label = textData ? String(textData) : null;\n  textData = currentNode.customLabel || currentNode.label;\n\n  if (textData) {\n    currentNode.text = context.renderer.text(textData).attr(settings.attr).css(settings.css).append(context.group);\n    context.setTrackerData(currentNode, currentNode.text);\n  }\n}\n\nvar emptyRect = [0, 0, 0, 0];\n\nfunction calculateRects(context, root) {\n  var nodes = root.nodes;\n  var items = [];\n  var rects = [];\n  var sum = 0;\n  var i;\n  var ii = items.length = rects.length = nodes.length;\n\n  for (i = 0; i < ii; ++i) {\n    sum += nodes[i].value;\n    items[i] = {\n      value: nodes[i].value,\n      i: i\n    };\n  }\n\n  if (sum > 0) {\n    context.algorithm({\n      items: items.slice(),\n      sum: sum,\n      rect: root.innerRect.slice(),\n      isRotated: 1 & nodes[0].level,\n      directions: context.directions\n    });\n  }\n\n  for (i = 0; i < ii; ++i) {\n    rects[i] = items[i].rect || emptyRect;\n  }\n\n  root.rects = rects;\n}\n\nfunction processTiling(context, node) {\n  var rect = node.parent.rects[node.index];\n  var rectOffsets = context.rectOffsets;\n  var headerHeight;\n\n  if (node.isNode()) {\n    setRectAttrs(node.tile.outer, buildTileRect(rect, node.parent.innerRect, rectOffsets.headerEdge, rectOffsets.headerInner));\n    rect = marginateRect(rect, context.groupPadding);\n    headerHeight = Math.min(context.headerHeight, rect[3] - rect[1]);\n    node.rect = [rect[0], rect[1], rect[2], rect[1] + headerHeight];\n    setRectAttrs(node.tile.inner, marginateRect(node.rect, rectOffsets.headerEdge));\n    rect[1] += headerHeight;\n    node.innerRect = rect;\n    calculateRects(context, node);\n  } else {\n    node.rect = rect;\n    setRectAttrs(node.tile, buildTileRect(rect, node.parent.innerRect, rectOffsets.tileEdge, rectOffsets.tileInner));\n  }\n}\n\nfunction marginateRect(rect, margin) {\n  return [rect[0] + margin, rect[1] + margin, rect[2] - margin, rect[3] - margin];\n}\n\nfunction buildTileRect(rect, outer, edgeOffset, innerOffset) {\n  return [rect[0] + (rect[0] === outer[0] ? edgeOffset : +innerOffset), rect[1] + (rect[1] === outer[1] ? edgeOffset : +innerOffset), rect[2] - (rect[2] === outer[2] ? edgeOffset : -innerOffset), rect[3] - (rect[3] === outer[3] ? edgeOffset : -innerOffset)];\n}\n\nfunction setRectAttrs(element, rect) {\n  element.attr({\n    x: rect[0],\n    y: rect[1],\n    width: _max(rect[2] - rect[0], 0),\n    height: _max(rect[3] - rect[1], 0)\n  });\n}\n\nfunction processLabelsLayout(context, node) {\n  if (node.text && node.labelState.visible) {\n    layoutTextNode(node, node.labelParams);\n  }\n}\n\nfunction layoutTextNode(node, params) {\n  var rect = node.rect;\n  var text = node.text;\n  var bBox = text.getBBox();\n  var paddingLeftRight = params.paddingLeftRight;\n  var paddingTopBottom = params.paddingTopBottom;\n  var effectiveWidth = rect[2] - rect[0] - 2 * paddingLeftRight;\n  var fitByHeight = bBox.height + paddingTopBottom <= rect[3] - rect[1];\n  var fitByWidth = bBox.width <= effectiveWidth;\n  var resolveLabelOverflow = params.resolveLabelOverflow;\n  var groupLabelOverflow = params.groupLabelOverflow;\n  var tileLabelOverflow = params.tileLabelOverflow;\n  var tileLabelWordWrap = params.tileLabelWordWrap;\n\n  if ((0, _type.isDefined)(resolveLabelOverflow)) {\n    if (\"ellipsis\" === resolveLabelOverflow && fitByHeight) {\n      text.setMaxSize(effectiveWidth, void 0, {\n        wordWrap: \"none\",\n        textOverflow: \"ellipsis\"\n      });\n\n      if (!fitByWidth) {\n        bBox = text.getBBox();\n        fitByWidth = bBox.width <= effectiveWidth;\n      }\n    }\n  } else {\n    fitByWidth = true;\n    fitByHeight = true;\n    text.setMaxSize(effectiveWidth, rect[3] - rect[1] - paddingTopBottom, node.isNode() ? {\n      textOverflow: groupLabelOverflow,\n      wordWrap: \"none\"\n    } : {\n      textOverflow: tileLabelOverflow,\n      wordWrap: tileLabelWordWrap,\n      hideOverflowEllipsis: true\n    });\n  }\n\n  text.attr({\n    visibility: fitByHeight && fitByWidth ? \"visible\" : \"hidden\"\n  });\n\n  if (fitByHeight && fitByWidth) {\n    text.move(params.rtlEnabled ? rect[2] - paddingLeftRight - bBox.x - bBox.width : rect[0] + paddingLeftRight - bBox.x, rect[1] + paddingTopBottom - bBox.y);\n  }\n}\n\nrequire(\"../../core/component_registrator\")(\"dxTreeMap\", dxTreeMap);\n\nmodule.exports = dxTreeMap;\ndxTreeMap.addPlugin(require(\"../core/data_source\").plugin);","map":{"version":3,"sources":["C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/devextreme/viz/tree_map/tree_map.base.js"],"names":["_common","require","_node","_node2","_interopRequireDefault","_tiling","_colorizing","_utils","_common2","_type","_extend2","obj","__esModule","_max","Math","max","directions","lefttoprightbottom","leftbottomrighttop","righttopleftbottom","rightbottomlefttop","setDefaultAlgorithm","setDefaultColorizer","pickPositiveInteger","val","round","dxTreeMap","inherit","_handlers","beginBuildNodes","noop","buildNode","endBuildNodes","setTrackerData","calculateState","options","buildRectAppearance","_rootClass","_rootClassPrefix","_getDefaultSize","width","height","_setDeprecatedOptions","callBase","apply","arguments","extend","_deprecatedOptions","resolveLabelOverflow","since","message","_themeSection","_fontFields","_init","that","_rectOffsets","Object","create","_context","suspend","_applyingChanges","_suspendChanges","resume","_resumeChanges","change","codes","_change","settings","calculateLabelState","buildTextAppearance","_root","_topNode","nodes","_initialChanges","_initCore","renderer","_renderer","_createProxyType","_tilesGroup","g","linkOn","root","linkAppend","_labelsGroup","_disposeCore","_filter","dispose","linkOff","_applySize","rect","_tilingRect","slice","_optionChangesMap","dataSource","valueField","childrenField","colorField","colorizer","labelField","tile","group","maxDepth","layoutAlgorithm","layoutDirection","_themeDependentChanges","_changeDataSource","_isDataExpected","_isSyncData","_updateDataSource","_dataSourceChangedHandler","_requestChange","_optionChangesOrder","_change_DATA_SOURCE","_change_TILE_SETTINGS","_changeTileSettings","_change_GROUP_SETTINGS","_changeGroupSettings","_change_LABEL_OVERFLOW","_change_MAX_DEPTH","_changeMaxDepth","_customChangesOrder","_change_NODES_CREATE","_buildNodes","_change_NODES_RESET","_resetNodes","_change_TILES","_applyTilesAppearance","_change_LABELS","_applyLabelsAppearance","_change_TILING","_performTiling","_change_LABELS_LAYOUT","_performLabelsLayout","_applyChanges","_drawn","forceReset","default","processedData","_id","parent","data","level","index","ctx","label","_nodes","_processDataSourceItems","_dataSourceItems","traverseDataItems","items","itemsField","isPlain","_getOption","_onNodesCreated","offsets","borderWidth","border","edgeOffset","innerOffset","labelOptions","state","shadowFilter","attr","shadow","_calculateLabelSettings","id","tileEdge","tileInner","headerHeight","groupPadding","padding","labelParams","paddingTopBottom","_headerHeight","_groupPadding","headerEdge","headerInner","filter","bBox","_getTextBBox","font","paddingLeftRight","tileLabelOptions","groupLabelOptions","labelState","visible","rtlEnabled","_getOptionByStealth","tileLabelWordWrap","wordWrap","tileLabelOverflow","textOverflow","groupLabelOverflow","_maxDepth","clear","initHatching","minLevel","maxLevel","_processNodes","context","process","processNodes","getColorizer","_themeManager","getColor","processTileAppearance","processLabelAppearance","algorithm","getAlgorithm","String","toLowerCase","rectOffsets","innerRect","calculateRects","processTiling","_onTilingPerformed","processLabelsLayout","fontOptions","text","_textForCalculations","css","patchFontOptions","append","getBBox","remove","dataItems","params","allNodes","node","i","ii","length","dataItem","totalValue","push","value","Number","isNode","color","updateStyles","createTile","applyState","createLeaf","createGroup","simpleRect","outer","inner","updateLabelStyle","createLabel","currentNode","textData","customLabel","emptyRect","rects","sum","isRotated","setRectAttrs","buildTileRect","marginateRect","min","margin","element","x","y","layoutTextNode","effectiveWidth","fitByHeight","fitByWidth","isDefined","setMaxSize","hideOverflowEllipsis","visibility","move","module","exports","addPlugin","plugin"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,IAAIA,OAAO,GAAGC,OAAO,CAAC,UAAD,CAArB;;AACA,IAAIC,KAAK,GAAGD,OAAO,CAAC,QAAD,CAAnB;;AACA,IAAIE,MAAM,GAAGC,sBAAsB,CAACF,KAAD,CAAnC;;AACA,IAAIG,OAAO,GAAGJ,OAAO,CAAC,UAAD,CAArB;;AACA,IAAIK,WAAW,GAAGL,OAAO,CAAC,cAAD,CAAzB;;AACA,IAAIM,MAAM,GAAGN,OAAO,CAAC,eAAD,CAApB;;AACA,IAAIO,QAAQ,GAAGP,OAAO,CAAC,yBAAD,CAAtB;;AACA,IAAIQ,KAAK,GAAGR,OAAO,CAAC,uBAAD,CAAnB;;AACA,IAAIS,QAAQ,GAAGT,OAAO,CAAC,yBAAD,CAAtB;;AAEA,SAASG,sBAAT,CAAgCO,GAAhC,EAAqC;AACjC,SAAOA,GAAG,IAAIA,GAAG,CAACC,UAAX,GAAwBD,GAAxB,GAA8B;AACjC,eAAWA;AADsB,GAArC;AAGH;;AACD,IAAIE,IAAI,GAAGC,IAAI,CAACC,GAAhB;AACA,IAAIC,UAAU,GAAG;AACbC,EAAAA,kBAAkB,EAAE,CAAC,CAAD,EAAI,CAAJ,CADP;AAEbC,EAAAA,kBAAkB,EAAE,CAAC,CAAD,EAAI,CAAC,CAAL,CAFP;AAGbC,EAAAA,kBAAkB,EAAE,CAAC,CAAC,CAAF,EAAK,CAAL,CAHP;AAIbC,EAAAA,kBAAkB,EAAE,CAAC,CAAC,CAAF,EAAK,CAAC,CAAN;AAJP,CAAjB;;AAMAnB,OAAO,CAAC,qBAAD,CAAP;;AACAA,OAAO,CAAC,UAAD,CAAP,CAAoBoB,mBAApB,CAAwC,YAAxC;;AACApB,OAAO,CAAC,uBAAD,CAAP;;AACAA,OAAO,CAAC,cAAD,CAAP,CAAwBqB,mBAAxB,CAA4C,UAA5C;;AAEA,SAASC,mBAAT,CAA6BC,GAA7B,EAAkC;AAC9B,SAAOA,GAAG,GAAG,CAAN,GAAUV,IAAI,CAACW,KAAL,CAAWD,GAAX,CAAV,GAA4B,CAAnC;AACH;;AACD,IAAIE,SAAS,GAAGzB,OAAO,CAAC,qBAAD,CAAP,CAA+B0B,OAA/B,CAAuC;AACnDC,EAAAA,SAAS,EAAE;AACPC,IAAAA,eAAe,EAAErB,QAAQ,CAACsB,IADnB;AAEPC,IAAAA,SAAS,EAAEvB,QAAQ,CAACsB,IAFb;AAGPE,IAAAA,aAAa,EAAExB,QAAQ,CAACsB,IAHjB;AAIPG,IAAAA,cAAc,EAAEzB,QAAQ,CAACsB,IAJlB;AAKPI,IAAAA,cAAc,EAAE,wBAASC,OAAT,EAAkB;AAC9B,aAAO,CAAC,GAAGnC,OAAO,CAACoC,mBAAZ,EAAiCD,OAAjC,CAAP;AACH;AAPM,GADwC;AAUnDE,EAAAA,UAAU,EAAE,eAVuC;AAWnDC,EAAAA,gBAAgB,EAAE,MAXiC;AAYnDC,EAAAA,eAAe,EAAE,2BAAW;AACxB,WAAO;AACHC,MAAAA,KAAK,EAAE,GADJ;AAEHC,MAAAA,MAAM,EAAE;AAFL,KAAP;AAIH,GAjBkD;AAkBnDC,EAAAA,qBAAqB,EAAE,iCAAW;AAC9B,SAAKC,QAAL,CAAcC,KAAd,CAAoB,IAApB,EAA0BC,SAA1B;AACA,KAAC,GAAGnC,QAAQ,CAACoC,MAAb,EAAqB,KAAKC,kBAA1B,EAA8C;AAC1CC,MAAAA,oBAAoB,EAAE;AAClBC,QAAAA,KAAK,EAAE,MADW;AAElBC,QAAAA,OAAO,EAAE;AAFS;AADoB,KAA9C;AAMH,GA1BkD;AA2BnDC,EAAAA,aAAa,EAAE,SA3BoC;AA4BnDC,EAAAA,WAAW,EAAE,CAAC,iBAAD,EAAoB,kBAApB,CA5BsC;AA6BnDC,EAAAA,KAAK,EAAE,iBAAW;AACd,QAAIC,IAAI,GAAG,IAAX;AACAA,IAAAA,IAAI,CAACC,YAAL,GAAoB,EAApB;AACAD,IAAAA,IAAI,CAAC1B,SAAL,GAAiB4B,MAAM,CAACC,MAAP,CAAcH,IAAI,CAAC1B,SAAnB,CAAjB;AACA0B,IAAAA,IAAI,CAACI,QAAL,GAAgB;AACZC,MAAAA,OAAO,EAAE,mBAAW;AAChB,YAAI,CAACL,IAAI,CAACM,gBAAV,EAA4B;AACxBN,UAAAA,IAAI,CAACO,eAAL;AACH;AACJ,OALW;AAMZC,MAAAA,MAAM,EAAE,kBAAW;AACf,YAAI,CAACR,IAAI,CAACM,gBAAV,EAA4B;AACxBN,UAAAA,IAAI,CAACS,cAAL;AACH;AACJ,OAVW;AAWZC,MAAAA,MAAM,EAAE,gBAASC,KAAT,EAAgB;AACpBX,QAAAA,IAAI,CAACY,OAAL,CAAaD,KAAb;AACH,OAbW;AAcZE,MAAAA,QAAQ,EAAE,CAAC,EAAD,EAAK,EAAL,CAdE;AAeZjC,MAAAA,cAAc,EAAEoB,IAAI,CAAC1B,SAAL,CAAeM,cAfnB;AAgBZkC,MAAAA,mBAAmB,EAAEpE,OAAO,CAACqE;AAhBjB,KAAhB;AAkBAf,IAAAA,IAAI,CAACgB,KAAL,GAAahB,IAAI,CAACiB,QAAL,GAAgB;AACzBC,MAAAA,KAAK,EAAE;AADkB,KAA7B;AAGAlB,IAAAA,IAAI,CAACX,QAAL,CAAcC,KAAd,CAAoBU,IAApB,EAA0BT,SAA1B;AACH,GAvDkD;AAwDnD4B,EAAAA,eAAe,EAAE,CAAC,aAAD,CAxDkC;AAyDnDC,EAAAA,SAAS,EAAE,qBAAW;AAClB,QAAIpB,IAAI,GAAG,IAAX;AACA,QAAIqB,QAAQ,GAAGrB,IAAI,CAACsB,SAApB;;AACAtB,IAAAA,IAAI,CAACuB,gBAAL;;AACAvB,IAAAA,IAAI,CAACwB,WAAL,GAAmBH,QAAQ,CAACI,CAAT,GAAaC,MAAb,CAAoBL,QAAQ,CAACM,IAA7B,EAAmC,OAAnC,EAA4CC,UAA5C,EAAnB;AACA5B,IAAAA,IAAI,CAAC6B,YAAL,GAAoBR,QAAQ,CAACI,CAAT,GAAaC,MAAb,CAAoBL,QAAQ,CAACM,IAA7B,EAAmC,QAAnC,EAA6CC,UAA7C,EAApB;AACH,GA/DkD;AAgEnDL,EAAAA,gBAAgB,EAAErE,QAAQ,CAACsB,IAhEwB;AAiEnDsD,EAAAA,YAAY,EAAE,wBAAW;AACrB,QAAI9B,IAAI,GAAG,IAAX;AACAA,IAAAA,IAAI,CAAC+B,OAAL,IAAgB/B,IAAI,CAAC+B,OAAL,CAAaC,OAAb,EAAhB;;AACAhC,IAAAA,IAAI,CAAC6B,YAAL,CAAkBI,OAAlB;;AACAjC,IAAAA,IAAI,CAACwB,WAAL,CAAiBS,OAAjB;AACH,GAtEkD;AAuEnDC,EAAAA,UAAU,EAAE,oBAASC,IAAT,EAAe;AACvB,SAAKC,WAAL,GAAmBD,IAAI,CAACE,KAAL,EAAnB;;AACA,SAAKzB,OAAL,CAAa,CAAC,QAAD,CAAb;AACH,GA1EkD;AA2EnD0B,EAAAA,iBAAiB,EAAE;AACfC,IAAAA,UAAU,EAAE,aADG;AAEfC,IAAAA,UAAU,EAAE,cAFG;AAGfC,IAAAA,aAAa,EAAE,cAHA;AAIfC,IAAAA,UAAU,EAAE,OAJG;AAKfC,IAAAA,SAAS,EAAE,OALI;AAMfC,IAAAA,UAAU,EAAE,QANG;AAOfC,IAAAA,IAAI,EAAE,eAPS;AAQfC,IAAAA,KAAK,EAAE,gBARQ;AASfC,IAAAA,QAAQ,EAAE,WATK;AAUfC,IAAAA,eAAe,EAAE,QAVF;AAWfC,IAAAA,eAAe,EAAE,QAXF;AAYfvD,IAAAA,oBAAoB,EAAE;AAZP,GA3EgC;AAyFnDwD,EAAAA,sBAAsB,EAAE,CAAC,eAAD,EAAkB,gBAAlB,EAAoC,WAApC,CAzF2B;AA0FnDC,EAAAA,iBAAiB,EAAE,6BAAW;AAC1B,QAAInD,IAAI,GAAG,IAAX;AACAA,IAAAA,IAAI,CAACoD,eAAL,GAAuBpD,IAAI,CAACqD,WAAL,GAAmB,IAA1C;;AACArD,IAAAA,IAAI,CAACsD,iBAAL;;AACAtD,IAAAA,IAAI,CAACqD,WAAL,GAAmB,KAAnB;;AACA,QAAIrD,IAAI,CAACoD,eAAT,EAA0B;AACtBpD,MAAAA,IAAI,CAACO,eAAL;AACH;AACJ,GAlGkD;AAmGnDgD,EAAAA,yBAAyB,EAAE,qCAAW;AAClC,QAAIvD,IAAI,GAAG,IAAX;;AACA,QAAIA,IAAI,CAACoD,eAAT,EAA0B;AACtBpD,MAAAA,IAAI,CAACoD,eAAL,GAAuB,KAAvB;;AACApD,MAAAA,IAAI,CAACY,OAAL,CAAa,CAAC,cAAD,CAAb;;AACA,UAAI,CAACZ,IAAI,CAACqD,WAAV,EAAuB;AACnBrD,QAAAA,IAAI,CAACS,cAAL;AACH;AACJ,KAND,MAMO;AACHT,MAAAA,IAAI,CAACwD,cAAL,CAAoB,CAAC,cAAD,CAApB;AACH;AACJ,GA9GkD;AA+GnDC,EAAAA,mBAAmB,EAAE,CAAC,aAAD,EAAgB,eAAhB,EAAiC,gBAAjC,EAAmD,WAAnD,EAAgE,gBAAhE,CA/G8B;AAgHnDC,EAAAA,mBAAmB,EAAE,+BAAW;AAC5B,SAAKP,iBAAL;AACH,GAlHkD;AAmHnDQ,EAAAA,qBAAqB,EAAE,iCAAW;AAC9B,SAAKC,mBAAL;AACH,GArHkD;AAsHnDC,EAAAA,sBAAsB,EAAE,kCAAW;AAC/B,SAAKC,oBAAL;AACH,GAxHkD;AAyHnDC,EAAAA,sBAAsB,EAAE,kCAAW;AAC/B,SAAKH,mBAAL;;AACA,SAAKE,oBAAL;AACH,GA5HkD;AA6HnDE,EAAAA,iBAAiB,EAAE,6BAAW;AAC1B,SAAKC,eAAL;AACH,GA/HkD;AAgInDC,EAAAA,mBAAmB,EAAE,CAAC,cAAD,EAAiB,aAAjB,EAAgC,OAAhC,EAAyC,QAAzC,EAAmD,QAAnD,EAA6D,eAA7D,CAhI8B;AAiInDC,EAAAA,oBAAoB,EAAE,gCAAW;AAC7B,SAAKC,WAAL;AACH,GAnIkD;AAoInDC,EAAAA,mBAAmB,EAAE,+BAAW;AAC5B,SAAKC,WAAL;AACH,GAtIkD;AAuInDC,EAAAA,aAAa,EAAE,yBAAW;AACtB,SAAKC,qBAAL;AACH,GAzIkD;AA0InDC,EAAAA,cAAc,EAAE,0BAAW;AACvB,SAAKC,sBAAL;AACH,GA5IkD;AA6InDC,EAAAA,cAAc,EAAE,0BAAW;AACvB,SAAKC,cAAL;AACH,GA/IkD;AAgJnDC,EAAAA,qBAAqB,EAAE,iCAAW;AAC9B,SAAKC,oBAAL;AACH,GAlJkD;AAmJnDC,EAAAA,aAAa,EAAE,yBAAW;AACtB,QAAI/E,IAAI,GAAG,IAAX;AACAA,IAAAA,IAAI,CAACX,QAAL,CAAcC,KAAd,CAAoBU,IAApB,EAA0BT,SAA1B;;AACA,QAAI,CAACS,IAAI,CAACoD,eAAV,EAA2B;AACvBpD,MAAAA,IAAI,CAACgF,MAAL;AACH;;AACDhF,IAAAA,IAAI,CAACI,QAAL,CAAc6E,UAAd,GAA2B,KAA3B;AACH,GA1JkD;AA2JnDb,EAAAA,WAAW,EAAE,uBAAW;AACpB,QAAIpE,IAAI,GAAG,IAAX;AACA,QAAI2B,IAAI,GAAG3B,IAAI,CAACgB,KAAL,GAAahB,IAAI,CAACiB,QAAL,GAAgB,IAAIpE,MAAM,CAACqI,OAAX,EAAxC;AACA,QAAIC,aAAJ;AACAxD,IAAAA,IAAI,CAACyD,GAAL,GAAW,CAAX;AACAzD,IAAAA,IAAI,CAAC0D,MAAL,GAAc,EAAd;AACA1D,IAAAA,IAAI,CAAC2D,IAAL,GAAY,EAAZ;AACA3D,IAAAA,IAAI,CAAC4D,KAAL,GAAa5D,IAAI,CAAC6D,KAAL,GAAa,CAAC,CAA3B;AACA7D,IAAAA,IAAI,CAAC8D,GAAL,GAAWzF,IAAI,CAACI,QAAhB;AACAuB,IAAAA,IAAI,CAAC+D,KAAL,GAAa,IAAb;AACA1F,IAAAA,IAAI,CAAC2F,MAAL,GAAc,CAAChE,IAAD,CAAd;;AACA3B,IAAAA,IAAI,CAAC1B,SAAL,CAAeC,eAAf;;AACA4G,IAAAA,aAAa,GAAGnF,IAAI,CAAC4F,uBAAL,CAA6B5F,IAAI,CAAC6F,gBAAL,MAA2B,EAAxD,CAAhB;AACAC,IAAAA,iBAAiB,CAACnE,IAAD,EAAOwD,aAAa,CAACY,KAArB,EAA4B,CAA5B,EAA+B;AAC5CC,MAAAA,UAAU,EAAE,CAACb,aAAa,CAACc,OAAf,IAA0BjG,IAAI,CAACkG,UAAL,CAAgB,eAAhB,EAAiC,IAAjC,CAA1B,IAAoE,OADpC;AAE5C1D,MAAAA,UAAU,EAAExC,IAAI,CAACkG,UAAL,CAAgB,YAAhB,EAA8B,IAA9B,KAAuC,OAFP;AAG5CzH,MAAAA,SAAS,EAAEuB,IAAI,CAAC1B,SAAL,CAAeG,SAHkB;AAI5CgH,MAAAA,GAAG,EAAEzF,IAAI,CAACI,QAJkC;AAK5Cc,MAAAA,KAAK,EAAElB,IAAI,CAAC2F;AALgC,KAA/B,CAAjB;;AAOA3F,IAAAA,IAAI,CAACmG,eAAL;;AACAnG,IAAAA,IAAI,CAAC1B,SAAL,CAAeI,aAAf;;AACAsB,IAAAA,IAAI,CAACY,OAAL,CAAa,CAAC,aAAD,CAAb;AACH,GAlLkD;AAmLnDuF,EAAAA,eAAe,EAAEjJ,QAAQ,CAACsB,IAnLyB;AAoLnDoH,EAAAA,uBAAuB,EAAE,iCAASG,KAAT,EAAgB;AACrC,WAAO;AACHA,MAAAA,KAAK,EAAEA,KADJ;AAEHE,MAAAA,OAAO,EAAE;AAFN,KAAP;AAIH,GAzLkD;AA0LnDrC,EAAAA,mBAAmB,EAAE,+BAAW;AAC5B,QAAI5D,IAAI,GAAG,IAAX;;AACA,QAAInB,OAAO,GAAGmB,IAAI,CAACkG,UAAL,CAAgB,MAAhB,CAAd;;AACA,QAAIE,OAAO,GAAGpG,IAAI,CAACC,YAAnB;AACA,QAAIoG,WAAW,GAAGpI,mBAAmB,CAACY,OAAO,CAACyH,MAAR,CAAepH,KAAhB,CAArC;AACA,QAAIqH,UAAU,GAAGF,WAAW,GAAG,CAA/B;AACA,QAAIG,WAAW,GAAG,IAAIH,WAAJ,GAAkB,EAAlB,GAAuB,CAAzC;AACA,QAAII,YAAY,GAAG5H,OAAO,CAAC6G,KAA3B;AACA,QAAI7E,QAAQ,GAAGb,IAAI,CAACI,QAAL,CAAcS,QAAd,CAAuB,CAAvB,CAAf;;AACAb,IAAAA,IAAI,CAACY,OAAL,CAAa,CAAC,OAAD,EAAU,QAAV,CAAb;;AACAC,IAAAA,QAAQ,CAAC6F,KAAT,GAAiB1G,IAAI,CAAC1B,SAAL,CAAeM,cAAf,CAA8BC,OAA9B,CAAjB;AACAmB,IAAAA,IAAI,CAAC+B,OAAL,GAAe/B,IAAI,CAAC+B,OAAL,IAAgB/B,IAAI,CAACsB,SAAL,CAAeqF,YAAf,CAA4B,MAA5B,EAAoC,MAApC,EAA4C,MAA5C,EAAoD,MAApD,CAA/B;;AACA3G,IAAAA,IAAI,CAAC+B,OAAL,CAAa6E,IAAb,CAAkBH,YAAY,CAACI,MAA/B;;AACA7G,IAAAA,IAAI,CAAC8G,uBAAL,CAA6BjG,QAA7B,EAAuC4F,YAAvC,EAAqDzG,IAAI,CAAC+B,OAAL,CAAagF,EAAlE;;AACA,QAAIX,OAAO,CAACY,QAAR,KAAqBT,UAArB,IAAmCH,OAAO,CAACa,SAAR,KAAsBT,WAA7D,EAA0E;AACtEJ,MAAAA,OAAO,CAACY,QAAR,GAAmBT,UAAnB;AACAH,MAAAA,OAAO,CAACa,SAAR,GAAoBT,WAApB;;AACAxG,MAAAA,IAAI,CAACY,OAAL,CAAa,CAAC,QAAD,CAAb;AACH;AACJ,GA7MkD;AA8MnDkD,EAAAA,oBAAoB,EAAE,gCAAW;AAC7B,QAAI9D,IAAI,GAAG,IAAX;;AACA,QAAInB,OAAO,GAAGmB,IAAI,CAACkG,UAAL,CAAgB,OAAhB,CAAd;;AACA,QAAIO,YAAY,GAAG5H,OAAO,CAAC6G,KAA3B;AACA,QAAIU,OAAO,GAAGpG,IAAI,CAACC,YAAnB;AACA,QAAIoG,WAAW,GAAGpI,mBAAmB,CAACY,OAAO,CAACyH,MAAR,CAAepH,KAAhB,CAArC;AACA,QAAIqH,UAAU,GAAGF,WAAW,GAAG,CAA/B;AACA,QAAIG,WAAW,GAAG,IAAIH,WAAJ,GAAkB,EAAlB,GAAuB,CAAzC;AACA,QAAIa,YAAY,GAAG,CAAnB;AACA,QAAIC,YAAY,GAAGlJ,mBAAmB,CAACY,OAAO,CAACuI,OAAT,CAAtC;AACA,QAAIvG,QAAQ,GAAGb,IAAI,CAACI,QAAL,CAAcS,QAAd,CAAuB,CAAvB,CAAf;;AACAb,IAAAA,IAAI,CAACY,OAAL,CAAa,CAAC,OAAD,EAAU,QAAV,CAAb;;AACAC,IAAAA,QAAQ,CAAC6F,KAAT,GAAiB1G,IAAI,CAAC1B,SAAL,CAAeM,cAAf,CAA8BC,OAA9B,CAAjB;;AACAmB,IAAAA,IAAI,CAAC8G,uBAAL,CAA6BjG,QAA7B,EAAuC4F,YAAvC;;AACA,QAAI5H,OAAO,CAACqI,YAAR,IAAwB,CAA5B,EAA+B;AAC3BA,MAAAA,YAAY,GAAGjJ,mBAAmB,CAACY,OAAO,CAACqI,YAAT,CAAlC;AACH,KAFD,MAEO;AACHA,MAAAA,YAAY,GAAGrG,QAAQ,CAACwG,WAAT,CAAqBlI,MAArB,GAA8B,IAAIlB,mBAAmB,CAACwI,YAAY,CAACa,gBAAd,CAApE;AACH;;AACD,QAAItH,IAAI,CAACuH,aAAL,KAAuBL,YAA3B,EAAyC;AACrClH,MAAAA,IAAI,CAACuH,aAAL,GAAqBL,YAArB;;AACAlH,MAAAA,IAAI,CAACY,OAAL,CAAa,CAAC,QAAD,CAAb;AACH;;AACD,QAAIZ,IAAI,CAACwH,aAAL,KAAuBL,YAA3B,EAAyC;AACrCnH,MAAAA,IAAI,CAACwH,aAAL,GAAqBL,YAArB;;AACAnH,MAAAA,IAAI,CAACY,OAAL,CAAa,CAAC,QAAD,CAAb;AACH;;AACD,QAAIwF,OAAO,CAACqB,UAAR,KAAuBlB,UAAvB,IAAqCH,OAAO,CAACsB,WAAR,KAAwBlB,WAAjE,EAA8E;AAC1EJ,MAAAA,OAAO,CAACqB,UAAR,GAAqBlB,UAArB;AACAH,MAAAA,OAAO,CAACsB,WAAR,GAAsBlB,WAAtB;;AACAxG,MAAAA,IAAI,CAACY,OAAL,CAAa,CAAC,QAAD,CAAb;AACH;AACJ,GA9OkD;AA+OnDkG,EAAAA,uBAAuB,EAAE,iCAASjG,QAAT,EAAmBhC,OAAnB,EAA4B8I,MAA5B,EAAoC;AACzD,QAAIC,IAAI,GAAG,KAAKC,YAAL,CAAkBhJ,OAAO,CAACiJ,IAA1B,CAAX;;AACA,QAAIC,gBAAgB,GAAG9J,mBAAmB,CAACY,OAAO,CAACkJ,gBAAT,CAA1C;AACA,QAAIT,gBAAgB,GAAGrJ,mBAAmB,CAACY,OAAO,CAACyI,gBAAT,CAA1C;;AACA,QAAIU,gBAAgB,GAAG,KAAK9B,UAAL,CAAgB,YAAhB,CAAvB;;AACA,QAAI+B,iBAAiB,GAAG,KAAK/B,UAAL,CAAgB,aAAhB,CAAxB;;AACArF,IAAAA,QAAQ,CAACqH,UAAT,GAAsB,CAAC,GAAGxL,OAAO,CAACqE,mBAAZ,EAAiClC,OAAjC,EAA0C8I,MAA1C,CAAtB;AACA9G,IAAAA,QAAQ,CAACqH,UAAT,CAAoBC,OAApB,GAA8B,EAAE,aAAatJ,OAAf,KAA2B,CAAC,CAACA,OAAO,CAACsJ,OAAnE;AACAtH,IAAAA,QAAQ,CAACwG,WAAT,GAAuB;AACnBlI,MAAAA,MAAM,EAAEyI,IAAI,CAACzI,MADM;AAEnBiJ,MAAAA,UAAU,EAAE,KAAKlC,UAAL,CAAgB,YAAhB,EAA8B,IAA9B,CAFO;AAGnBoB,MAAAA,gBAAgB,EAAEA,gBAHC;AAInBS,MAAAA,gBAAgB,EAAEA,gBAJC;AAKnBrI,MAAAA,oBAAoB,EAAE,KAAK2I,mBAAL,CAAyB,sBAAzB,CALH;AAMnBC,MAAAA,iBAAiB,EAAEN,gBAAgB,CAACO,QANjB;AAOnBC,MAAAA,iBAAiB,EAAER,gBAAgB,CAACS,YAPjB;AAQnBC,MAAAA,kBAAkB,EAAET,iBAAiB,CAACQ;AARnB,KAAvB;AAUH,GAjQkD;AAkQnDxE,EAAAA,eAAe,EAAE,2BAAW;AACxB,QAAIlB,QAAQ,GAAG,KAAKmD,UAAL,CAAgB,UAAhB,EAA4B,IAA5B,CAAf;;AACAnD,IAAAA,QAAQ,GAAGA,QAAQ,IAAI,CAAZ,GAAgBvF,IAAI,CAACW,KAAL,CAAW4E,QAAX,CAAhB,GAAuC,IAAI,CAAtD;;AACA,QAAI,KAAK4F,SAAL,KAAmB5F,QAAvB,EAAiC;AAC7B,WAAK4F,SAAL,GAAiB5F,QAAjB;;AACA,WAAKnC,OAAL,CAAa,CAAC,aAAD,CAAb;AACH;AACJ,GAzQkD;AA0QnD0D,EAAAA,WAAW,EAAE,uBAAW;AACpB,QAAItE,IAAI,GAAG,IAAX;;AACAA,IAAAA,IAAI,CAACwB,WAAL,CAAiBoH,KAAjB;;AACA5I,IAAAA,IAAI,CAACsB,SAAL,CAAeuH,YAAf;;AACA7I,IAAAA,IAAI,CAACI,QAAL,CAAc6E,UAAd,GAA2B,IAA3B;AACAjF,IAAAA,IAAI,CAACI,QAAL,CAAc0I,QAAd,GAAyB9I,IAAI,CAACiB,QAAL,CAAcsE,KAAd,GAAsB,CAA/C;AACAvF,IAAAA,IAAI,CAACI,QAAL,CAAc2I,QAAd,GAAyB/I,IAAI,CAACI,QAAL,CAAc0I,QAAd,GAAyB9I,IAAI,CAAC2I,SAA9B,GAA0C,CAAnE;;AACA3I,IAAAA,IAAI,CAACY,OAAL,CAAa,CAAC,OAAD,EAAU,QAAV,EAAoB,QAApB,CAAb;AACH,GAlRkD;AAmRnDoI,EAAAA,aAAa,EAAE,uBAASC,OAAT,EAAkBC,OAAlB,EAA2B;AACtCC,IAAAA,YAAY,CAACF,OAAD,EAAU,KAAKhI,QAAf,EAAyBiI,OAAzB,CAAZ;AACH,GArRkD;AAsRnD1E,EAAAA,qBAAqB,EAAE,iCAAW;AAC9B,QAAIxE,IAAI,GAAG,IAAX;AACA,QAAI2C,SAAS,GAAG,CAAC,GAAG3F,WAAW,CAACoM,YAAhB,EAA8BpJ,IAAI,CAACkG,UAAL,CAAgB,WAAhB,CAA9B,EAA4DlG,IAAI,CAACqJ,aAAjE,EAAgFrJ,IAAI,CAACiB,QAArF,CAAhB;;AACAjB,IAAAA,IAAI,CAACgJ,aAAL,CAAmB;AACf3H,MAAAA,QAAQ,EAAErB,IAAI,CAACsB,SADA;AAEfwB,MAAAA,KAAK,EAAE9C,IAAI,CAACwB,WAFG;AAGf7C,MAAAA,cAAc,EAAEqB,IAAI,CAAC1B,SAAL,CAAeK,cAHhB;AAIf+D,MAAAA,UAAU,EAAE1C,IAAI,CAACkG,UAAL,CAAgB,YAAhB,EAA8B,IAA9B,KAAuC,OAJpC;AAKfoD,MAAAA,QAAQ,EAAE3G;AALK,KAAnB,EAMG4G,qBANH;AAOH,GAhSkD;AAiSnD7E,EAAAA,sBAAsB,EAAE,kCAAW;AAC/B,QAAI1E,IAAI,GAAG,IAAX;;AACAA,IAAAA,IAAI,CAAC6B,YAAL,CAAkB+G,KAAlB;;AACA5I,IAAAA,IAAI,CAACgJ,aAAL,CAAmB;AACf3H,MAAAA,QAAQ,EAAErB,IAAI,CAACsB,SADA;AAEfwB,MAAAA,KAAK,EAAE9C,IAAI,CAAC6B,YAFG;AAGflD,MAAAA,cAAc,EAAEqB,IAAI,CAAC1B,SAAL,CAAeK,cAHhB;AAIfiE,MAAAA,UAAU,EAAE5C,IAAI,CAACkG,UAAL,CAAgB,YAAhB,EAA8B,IAA9B,KAAuC;AAJpC,KAAnB,EAKGsD,sBALH;;AAMAxJ,IAAAA,IAAI,CAACY,OAAL,CAAa,CAAC,eAAD,CAAb;AACH,GA3SkD;AA4SnDgE,EAAAA,cAAc,EAAE,0BAAW;AACvB,QAAI5E,IAAI,GAAG,IAAX;AACA,QAAIiJ,OAAO,GAAG;AACVQ,MAAAA,SAAS,EAAE,CAAC,GAAG1M,OAAO,CAAC2M,YAAZ,EAA0B1J,IAAI,CAACkG,UAAL,CAAgB,iBAAhB,EAAmC,IAAnC,CAA1B,CADD;AAEVxI,MAAAA,UAAU,EAAEA,UAAU,CAACiM,MAAM,CAAC3J,IAAI,CAACkG,UAAL,CAAgB,iBAAhB,EAAmC,IAAnC,CAAD,CAAN,CAAiD0D,WAAjD,EAAD,CAAV,IAA8ElM,UAAU,CAACC,kBAF3F;AAGVuJ,MAAAA,YAAY,EAAElH,IAAI,CAACuH,aAHT;AAIVJ,MAAAA,YAAY,EAAEnH,IAAI,CAACwH,aAJT;AAKVqC,MAAAA,WAAW,EAAE7J,IAAI,CAACC;AALR,KAAd;AAOAD,IAAAA,IAAI,CAACiB,QAAL,CAAc6I,SAAd,GAA0B9J,IAAI,CAACoC,WAA/B;AACA2H,IAAAA,cAAc,CAACd,OAAD,EAAUjJ,IAAI,CAACiB,QAAf,CAAd;;AACAjB,IAAAA,IAAI,CAACgJ,aAAL,CAAmBC,OAAnB,EAA4Be,aAA5B;;AACAhK,IAAAA,IAAI,CAACY,OAAL,CAAa,CAAC,eAAD,CAAb;;AACAZ,IAAAA,IAAI,CAACiK,kBAAL;AACH,GA1TkD;AA2TnDA,EAAAA,kBAAkB,EAAE/M,QAAQ,CAACsB,IA3TsB;AA4TnDsG,EAAAA,oBAAoB,EAAE,gCAAW;AAC7B,SAAKkE,aAAL,CAAmB,IAAnB,EAAyBkB,mBAAzB;AACH,GA9TkD;AA+TnDrC,EAAAA,YAAY,EAAE,sBAASsC,WAAT,EAAsB;AAChC,QAAI9I,QAAQ,GAAG,KAAKC,SAApB;AACA,QAAI8I,IAAI,GAAG,KAAKC,oBAAL,IAA6BhJ,QAAQ,CAAC+I,IAAT,CAAc,GAAd,EAAmB,CAAnB,EAAsB,CAAtB,CAAxC;AACA,QAAIxC,IAAJ;AACA,SAAKyC,oBAAL,GAA4BD,IAA5B;AACAA,IAAAA,IAAI,CAACE,GAAL,CAAS,CAAC,GAAGrN,MAAM,CAACsN,gBAAX,EAA6BJ,WAA7B,CAAT,EAAoDK,MAApD,CAA2DnJ,QAAQ,CAACM,IAApE;AACAiG,IAAAA,IAAI,GAAGwC,IAAI,CAACK,OAAL,EAAP;AACAL,IAAAA,IAAI,CAACM,MAAL;AACA,WAAO9C,IAAP;AACH;AAxUkD,CAAvC,CAAhB;;AA2UA,SAAS9B,iBAAT,CAA2BnE,IAA3B,EAAiCgJ,SAAjC,EAA4CpF,KAA5C,EAAmDqF,MAAnD,EAA2D;AACvD,MAAI1J,KAAK,GAAG,EAAZ;AACA,MAAI2J,QAAQ,GAAGD,MAAM,CAAC1J,KAAtB;AACA,MAAI4J,IAAJ;AACA,MAAIC,CAAJ;AACA,MAAIC,EAAE,GAAGL,SAAS,CAACM,MAAnB;AACA,MAAIC,QAAJ;AACA,MAAIC,UAAU,GAAG,CAAjB;AACA,MAAIpF,KAAJ;;AACA,OAAKgF,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGC,EAAhB,EAAoB,EAAED,CAAtB,EAAyB;AACrBG,IAAAA,QAAQ,GAAGP,SAAS,CAACI,CAAD,CAApB;AACAD,IAAAA,IAAI,GAAG,IAAIjO,MAAM,CAACqI,OAAX,EAAP;AACA4F,IAAAA,IAAI,CAAC1F,GAAL,GAAWyF,QAAQ,CAACI,MAApB;AACAH,IAAAA,IAAI,CAACrF,GAAL,GAAWmF,MAAM,CAACnF,GAAlB;AACAqF,IAAAA,IAAI,CAACzF,MAAL,GAAc1D,IAAd;AACAmJ,IAAAA,IAAI,CAACvF,KAAL,GAAaA,KAAb;AACAuF,IAAAA,IAAI,CAACtF,KAAL,GAAatE,KAAK,CAAC+J,MAAnB;AACAH,IAAAA,IAAI,CAACxF,IAAL,GAAY4F,QAAZ;AACAN,IAAAA,MAAM,CAACnM,SAAP,CAAiBqM,IAAjB;AACAD,IAAAA,QAAQ,CAACO,IAAT,CAAcN,IAAd;AACA5J,IAAAA,KAAK,CAACkK,IAAN,CAAWN,IAAX;AACA/E,IAAAA,KAAK,GAAGmF,QAAQ,CAACN,MAAM,CAAC5E,UAAR,CAAhB;;AACA,QAAID,KAAK,IAAIA,KAAK,CAACkF,MAAnB,EAA2B;AACvBnF,MAAAA,iBAAiB,CAACgF,IAAD,EAAO/E,KAAP,EAAcR,KAAK,GAAG,CAAtB,EAAyBqF,MAAzB,CAAjB;AACH;;AACD,QAAIM,QAAQ,CAACN,MAAM,CAACpI,UAAR,CAAR,GAA8B,CAAlC,EAAqC;AACjCsI,MAAAA,IAAI,CAACO,KAAL,GAAaC,MAAM,CAACJ,QAAQ,CAACN,MAAM,CAACpI,UAAR,CAAT,CAAnB;AACH;;AACD2I,IAAAA,UAAU,IAAIL,IAAI,CAACO,KAAnB;AACH;;AACD1J,EAAAA,IAAI,CAACT,KAAL,GAAaA,KAAb;AACAS,EAAAA,IAAI,CAAC0J,KAAL,GAAaF,UAAb;AACH;;AAED,SAAShC,YAAT,CAAsBF,OAAtB,EAA+BtH,IAA/B,EAAqCuH,OAArC,EAA8C;AAC1C,MAAIhI,KAAK,GAAGS,IAAI,CAACT,KAAjB;AACA,MAAI4J,IAAJ;AACA,MAAIC,CAAJ;AACA,MAAIC,EAAE,GAAG9J,KAAK,CAAC+J,MAAf;;AACA,OAAKF,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGC,EAAhB,EAAoB,EAAED,CAAtB,EAAyB;AACrBD,IAAAA,IAAI,GAAG5J,KAAK,CAAC6J,CAAD,CAAZ;AACA7B,IAAAA,OAAO,CAACD,OAAD,EAAU6B,IAAV,CAAP;;AACA,QAAIA,IAAI,CAACS,MAAL,EAAJ,EAAmB;AACfpC,MAAAA,YAAY,CAACF,OAAD,EAAU6B,IAAV,EAAgB5B,OAAhB,CAAZ;AACH;AACJ;AACJ;;AAED,SAASK,qBAAT,CAA+BN,OAA/B,EAAwC6B,IAAxC,EAA8C;AAC1CA,EAAAA,IAAI,CAACU,KAAL,GAAaV,IAAI,CAACxF,IAAL,CAAU2D,OAAO,CAACvG,UAAlB,KAAiCuG,OAAO,CAACK,QAAR,CAAiBwB,IAAjB,CAAjC,IAA2DA,IAAI,CAACzF,MAAL,CAAYmG,KAApF;AACAV,EAAAA,IAAI,CAACW,YAAL;AACAX,EAAAA,IAAI,CAACjI,IAAL,GAAY,CAACiI,IAAI,CAACrF,GAAL,CAASR,UAAV,IAAwB6F,IAAI,CAACjI,IAA7B,IAAqC6I,UAAU,CAACJ,MAAM,CAACR,IAAI,CAACS,MAAL,EAAD,CAAP,CAAV,CAAkCtC,OAAlC,EAA2C6B,IAA3C,CAAjD;AACAA,EAAAA,IAAI,CAACa,UAAL;AACH;;AACD,IAAID,UAAU,GAAG,CAACE,UAAD,EAAaC,WAAb,CAAjB;;AAEA,SAASD,UAAT,CAAoB3C,OAApB,EAA6B6B,IAA7B,EAAmC;AAC/B,MAAIjI,IAAI,GAAGoG,OAAO,CAAC5H,QAAR,CAAiByK,UAAjB,GAA8BtB,MAA9B,CAAqCvB,OAAO,CAACnG,KAA7C,CAAX;AACAmG,EAAAA,OAAO,CAACtK,cAAR,CAAuBmM,IAAvB,EAA6BjI,IAA7B;AACA,SAAOA,IAAP;AACH;;AAED,SAASgJ,WAAT,CAAqB5C,OAArB,EAA8B6B,IAA9B,EAAoC;AAChC,MAAIiB,KAAK,GAAG9C,OAAO,CAAC5H,QAAR,CAAiByK,UAAjB,GAA8BtB,MAA9B,CAAqCvB,OAAO,CAACnG,KAA7C,CAAZ;AACA,MAAIkJ,KAAK,GAAG/C,OAAO,CAAC5H,QAAR,CAAiByK,UAAjB,GAA8BtB,MAA9B,CAAqCvB,OAAO,CAACnG,KAA7C,CAAZ;AACAmG,EAAAA,OAAO,CAACtK,cAAR,CAAuBmM,IAAvB,EAA6BkB,KAA7B;AACA,SAAO;AACHD,IAAAA,KAAK,EAAEA,KADJ;AAEHC,IAAAA,KAAK,EAAEA;AAFJ,GAAP;AAIH;;AAED,SAASxC,sBAAT,CAAgCP,OAAhC,EAAyC6B,IAAzC,EAA+C;AAC3CA,EAAAA,IAAI,CAACmB,gBAAL;;AACA,MAAInB,IAAI,CAAC5C,UAAL,CAAgBC,OAApB,EAA6B;AACzB+D,IAAAA,WAAW,CAACjD,OAAD,EAAU6B,IAAV,EAAgBA,IAAI,CAAC5C,UAArB,EAAiC4C,IAAI,CAACzD,WAAtC,CAAX;AACH;AACJ;;AAED,SAAS6E,WAAT,CAAqBjD,OAArB,EAA8BkD,WAA9B,EAA2CtL,QAA3C,EAAqD+J,MAArD,EAA6D;AACzD,MAAIwB,QAAQ,GAAGD,WAAW,CAAC7G,IAAZ,CAAiB2D,OAAO,CAACrG,UAAzB,CAAf;AACAuJ,EAAAA,WAAW,CAACzG,KAAZ,GAAoB0G,QAAQ,GAAGzC,MAAM,CAACyC,QAAD,CAAT,GAAsB,IAAlD;AACAA,EAAAA,QAAQ,GAAGD,WAAW,CAACE,WAAZ,IAA2BF,WAAW,CAACzG,KAAlD;;AACA,MAAI0G,QAAJ,EAAc;AACVD,IAAAA,WAAW,CAAC/B,IAAZ,GAAmBnB,OAAO,CAAC5H,QAAR,CAAiB+I,IAAjB,CAAsBgC,QAAtB,EAAgCxF,IAAhC,CAAqC/F,QAAQ,CAAC+F,IAA9C,EAAoD0D,GAApD,CAAwDzJ,QAAQ,CAACyJ,GAAjE,EAAsEE,MAAtE,CAA6EvB,OAAO,CAACnG,KAArF,CAAnB;AACAmG,IAAAA,OAAO,CAACtK,cAAR,CAAuBwN,WAAvB,EAAoCA,WAAW,CAAC/B,IAAhD;AACH;AACJ;;AACD,IAAIkC,SAAS,GAAG,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,CAAhB;;AAEA,SAASvC,cAAT,CAAwBd,OAAxB,EAAiCtH,IAAjC,EAAuC;AACnC,MAAIT,KAAK,GAAGS,IAAI,CAACT,KAAjB;AACA,MAAI6E,KAAK,GAAG,EAAZ;AACA,MAAIwG,KAAK,GAAG,EAAZ;AACA,MAAIC,GAAG,GAAG,CAAV;AACA,MAAIzB,CAAJ;AACA,MAAIC,EAAE,GAAGjF,KAAK,CAACkF,MAAN,GAAesB,KAAK,CAACtB,MAAN,GAAe/J,KAAK,CAAC+J,MAA7C;;AACA,OAAKF,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGC,EAAhB,EAAoB,EAAED,CAAtB,EAAyB;AACrByB,IAAAA,GAAG,IAAItL,KAAK,CAAC6J,CAAD,CAAL,CAASM,KAAhB;AACAtF,IAAAA,KAAK,CAACgF,CAAD,CAAL,GAAW;AACPM,MAAAA,KAAK,EAAEnK,KAAK,CAAC6J,CAAD,CAAL,CAASM,KADT;AAEPN,MAAAA,CAAC,EAAEA;AAFI,KAAX;AAIH;;AACD,MAAIyB,GAAG,GAAG,CAAV,EAAa;AACTvD,IAAAA,OAAO,CAACQ,SAAR,CAAkB;AACd1D,MAAAA,KAAK,EAAEA,KAAK,CAAC1D,KAAN,EADO;AAEdmK,MAAAA,GAAG,EAAEA,GAFS;AAGdrK,MAAAA,IAAI,EAAER,IAAI,CAACmI,SAAL,CAAezH,KAAf,EAHQ;AAIdoK,MAAAA,SAAS,EAAE,IAAIvL,KAAK,CAAC,CAAD,CAAL,CAASqE,KAJV;AAKd7H,MAAAA,UAAU,EAAEuL,OAAO,CAACvL;AALN,KAAlB;AAOH;;AACD,OAAKqN,CAAC,GAAG,CAAT,EAAYA,CAAC,GAAGC,EAAhB,EAAoB,EAAED,CAAtB,EAAyB;AACrBwB,IAAAA,KAAK,CAACxB,CAAD,CAAL,GAAWhF,KAAK,CAACgF,CAAD,CAAL,CAAS5I,IAAT,IAAiBmK,SAA5B;AACH;;AACD3K,EAAAA,IAAI,CAAC4K,KAAL,GAAaA,KAAb;AACH;;AAED,SAASvC,aAAT,CAAuBf,OAAvB,EAAgC6B,IAAhC,EAAsC;AAClC,MAAI3I,IAAI,GAAG2I,IAAI,CAACzF,MAAL,CAAYkH,KAAZ,CAAkBzB,IAAI,CAACtF,KAAvB,CAAX;AACA,MAAIqE,WAAW,GAAGZ,OAAO,CAACY,WAA1B;AACA,MAAI3C,YAAJ;;AACA,MAAI4D,IAAI,CAACS,MAAL,EAAJ,EAAmB;AACfmB,IAAAA,YAAY,CAAC5B,IAAI,CAACjI,IAAL,CAAUkJ,KAAX,EAAkBY,aAAa,CAACxK,IAAD,EAAO2I,IAAI,CAACzF,MAAL,CAAYyE,SAAnB,EAA8BD,WAAW,CAACpC,UAA1C,EAAsDoC,WAAW,CAACnC,WAAlE,CAA/B,CAAZ;AACAvF,IAAAA,IAAI,GAAGyK,aAAa,CAACzK,IAAD,EAAO8G,OAAO,CAAC9B,YAAf,CAApB;AACAD,IAAAA,YAAY,GAAG1J,IAAI,CAACqP,GAAL,CAAS5D,OAAO,CAAC/B,YAAjB,EAA+B/E,IAAI,CAAC,CAAD,CAAJ,GAAUA,IAAI,CAAC,CAAD,CAA7C,CAAf;AACA2I,IAAAA,IAAI,CAAC3I,IAAL,GAAY,CAACA,IAAI,CAAC,CAAD,CAAL,EAAUA,IAAI,CAAC,CAAD,CAAd,EAAmBA,IAAI,CAAC,CAAD,CAAvB,EAA4BA,IAAI,CAAC,CAAD,CAAJ,GAAU+E,YAAtC,CAAZ;AACAwF,IAAAA,YAAY,CAAC5B,IAAI,CAACjI,IAAL,CAAUmJ,KAAX,EAAkBY,aAAa,CAAC9B,IAAI,CAAC3I,IAAN,EAAY0H,WAAW,CAACpC,UAAxB,CAA/B,CAAZ;AACAtF,IAAAA,IAAI,CAAC,CAAD,CAAJ,IAAW+E,YAAX;AACA4D,IAAAA,IAAI,CAAChB,SAAL,GAAiB3H,IAAjB;AACA4H,IAAAA,cAAc,CAACd,OAAD,EAAU6B,IAAV,CAAd;AACH,GATD,MASO;AACHA,IAAAA,IAAI,CAAC3I,IAAL,GAAYA,IAAZ;AACAuK,IAAAA,YAAY,CAAC5B,IAAI,CAACjI,IAAN,EAAY8J,aAAa,CAACxK,IAAD,EAAO2I,IAAI,CAACzF,MAAL,CAAYyE,SAAnB,EAA8BD,WAAW,CAAC7C,QAA1C,EAAoD6C,WAAW,CAAC5C,SAAhE,CAAzB,CAAZ;AACH;AACJ;;AAED,SAAS2F,aAAT,CAAuBzK,IAAvB,EAA6B2K,MAA7B,EAAqC;AACjC,SAAO,CAAC3K,IAAI,CAAC,CAAD,CAAJ,GAAU2K,MAAX,EAAmB3K,IAAI,CAAC,CAAD,CAAJ,GAAU2K,MAA7B,EAAqC3K,IAAI,CAAC,CAAD,CAAJ,GAAU2K,MAA/C,EAAuD3K,IAAI,CAAC,CAAD,CAAJ,GAAU2K,MAAjE,CAAP;AACH;;AAED,SAASH,aAAT,CAAuBxK,IAAvB,EAA6B4J,KAA7B,EAAoCxF,UAApC,EAAgDC,WAAhD,EAA6D;AACzD,SAAO,CAACrE,IAAI,CAAC,CAAD,CAAJ,IAAWA,IAAI,CAAC,CAAD,CAAJ,KAAY4J,KAAK,CAAC,CAAD,CAAjB,GAAuBxF,UAAvB,GAAoC,CAACC,WAAhD,CAAD,EAA+DrE,IAAI,CAAC,CAAD,CAAJ,IAAWA,IAAI,CAAC,CAAD,CAAJ,KAAY4J,KAAK,CAAC,CAAD,CAAjB,GAAuBxF,UAAvB,GAAoC,CAACC,WAAhD,CAA/D,EAA6HrE,IAAI,CAAC,CAAD,CAAJ,IAAWA,IAAI,CAAC,CAAD,CAAJ,KAAY4J,KAAK,CAAC,CAAD,CAAjB,GAAuBxF,UAAvB,GAAoC,CAACC,WAAhD,CAA7H,EAA2LrE,IAAI,CAAC,CAAD,CAAJ,IAAWA,IAAI,CAAC,CAAD,CAAJ,KAAY4J,KAAK,CAAC,CAAD,CAAjB,GAAuBxF,UAAvB,GAAoC,CAACC,WAAhD,CAA3L,CAAP;AACH;;AAED,SAASkG,YAAT,CAAsBK,OAAtB,EAA+B5K,IAA/B,EAAqC;AACjC4K,EAAAA,OAAO,CAACnG,IAAR,CAAa;AACToG,IAAAA,CAAC,EAAE7K,IAAI,CAAC,CAAD,CADE;AAET8K,IAAAA,CAAC,EAAE9K,IAAI,CAAC,CAAD,CAFE;AAGTjD,IAAAA,KAAK,EAAE3B,IAAI,CAAC4E,IAAI,CAAC,CAAD,CAAJ,GAAUA,IAAI,CAAC,CAAD,CAAf,EAAoB,CAApB,CAHF;AAIThD,IAAAA,MAAM,EAAE5B,IAAI,CAAC4E,IAAI,CAAC,CAAD,CAAJ,GAAUA,IAAI,CAAC,CAAD,CAAf,EAAoB,CAApB;AAJH,GAAb;AAMH;;AAED,SAAS+H,mBAAT,CAA6BjB,OAA7B,EAAsC6B,IAAtC,EAA4C;AACxC,MAAIA,IAAI,CAACV,IAAL,IAAaU,IAAI,CAAC5C,UAAL,CAAgBC,OAAjC,EAA0C;AACtC+E,IAAAA,cAAc,CAACpC,IAAD,EAAOA,IAAI,CAACzD,WAAZ,CAAd;AACH;AACJ;;AAED,SAAS6F,cAAT,CAAwBpC,IAAxB,EAA8BF,MAA9B,EAAsC;AAClC,MAAIzI,IAAI,GAAG2I,IAAI,CAAC3I,IAAhB;AACA,MAAIiI,IAAI,GAAGU,IAAI,CAACV,IAAhB;AACA,MAAIxC,IAAI,GAAGwC,IAAI,CAACK,OAAL,EAAX;AACA,MAAI1C,gBAAgB,GAAG6C,MAAM,CAAC7C,gBAA9B;AACA,MAAIT,gBAAgB,GAAGsD,MAAM,CAACtD,gBAA9B;AACA,MAAI6F,cAAc,GAAGhL,IAAI,CAAC,CAAD,CAAJ,GAAUA,IAAI,CAAC,CAAD,CAAd,GAAoB,IAAI4F,gBAA7C;AACA,MAAIqF,WAAW,GAAGxF,IAAI,CAACzI,MAAL,GAAcmI,gBAAd,IAAkCnF,IAAI,CAAC,CAAD,CAAJ,GAAUA,IAAI,CAAC,CAAD,CAAlE;AACA,MAAIkL,UAAU,GAAGzF,IAAI,CAAC1I,KAAL,IAAciO,cAA/B;AACA,MAAIzN,oBAAoB,GAAGkL,MAAM,CAAClL,oBAAlC;AACA,MAAIgJ,kBAAkB,GAAGkC,MAAM,CAAClC,kBAAhC;AACA,MAAIF,iBAAiB,GAAGoC,MAAM,CAACpC,iBAA/B;AACA,MAAIF,iBAAiB,GAAGsC,MAAM,CAACtC,iBAA/B;;AACA,MAAI,CAAC,GAAGnL,KAAK,CAACmQ,SAAV,EAAqB5N,oBAArB,CAAJ,EAAgD;AAC5C,QAAI,eAAeA,oBAAf,IAAuC0N,WAA3C,EAAwD;AACpDhD,MAAAA,IAAI,CAACmD,UAAL,CAAgBJ,cAAhB,EAAgC,KAAK,CAArC,EAAwC;AACpC5E,QAAAA,QAAQ,EAAE,MAD0B;AAEpCE,QAAAA,YAAY,EAAE;AAFsB,OAAxC;;AAIA,UAAI,CAAC4E,UAAL,EAAiB;AACbzF,QAAAA,IAAI,GAAGwC,IAAI,CAACK,OAAL,EAAP;AACA4C,QAAAA,UAAU,GAAGzF,IAAI,CAAC1I,KAAL,IAAciO,cAA3B;AACH;AACJ;AACJ,GAXD,MAWO;AACHE,IAAAA,UAAU,GAAG,IAAb;AACAD,IAAAA,WAAW,GAAG,IAAd;AACAhD,IAAAA,IAAI,CAACmD,UAAL,CAAgBJ,cAAhB,EAAgChL,IAAI,CAAC,CAAD,CAAJ,GAAUA,IAAI,CAAC,CAAD,CAAd,GAAoBmF,gBAApD,EAAsEwD,IAAI,CAACS,MAAL,KAAgB;AAClF9C,MAAAA,YAAY,EAAEC,kBADoE;AAElFH,MAAAA,QAAQ,EAAE;AAFwE,KAAhB,GAGlE;AACAE,MAAAA,YAAY,EAAED,iBADd;AAEAD,MAAAA,QAAQ,EAAED,iBAFV;AAGAkF,MAAAA,oBAAoB,EAAE;AAHtB,KAHJ;AAQH;;AACDpD,EAAAA,IAAI,CAACxD,IAAL,CAAU;AACN6G,IAAAA,UAAU,EAAEL,WAAW,IAAIC,UAAf,GAA4B,SAA5B,GAAwC;AAD9C,GAAV;;AAGA,MAAID,WAAW,IAAIC,UAAnB,EAA+B;AAC3BjD,IAAAA,IAAI,CAACsD,IAAL,CAAU9C,MAAM,CAACxC,UAAP,GAAoBjG,IAAI,CAAC,CAAD,CAAJ,GAAU4F,gBAAV,GAA6BH,IAAI,CAACoF,CAAlC,GAAsCpF,IAAI,CAAC1I,KAA/D,GAAuEiD,IAAI,CAAC,CAAD,CAAJ,GAAU4F,gBAAV,GAA6BH,IAAI,CAACoF,CAAnH,EAAsH7K,IAAI,CAAC,CAAD,CAAJ,GAAUmF,gBAAV,GAA6BM,IAAI,CAACqF,CAAxJ;AACH;AACJ;;AACDtQ,OAAO,CAAC,kCAAD,CAAP,CAA4C,WAA5C,EAAyDyB,SAAzD;;AACAuP,MAAM,CAACC,OAAP,GAAiBxP,SAAjB;AACAA,SAAS,CAACyP,SAAV,CAAoBlR,OAAO,CAAC,qBAAD,CAAP,CAA+BmR,MAAnD","sourcesContent":["/**\r\n * DevExtreme (viz/tree_map/tree_map.base.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar _common = require(\"./common\");\r\nvar _node = require(\"./node\");\r\nvar _node2 = _interopRequireDefault(_node);\r\nvar _tiling = require(\"./tiling\");\r\nvar _colorizing = require(\"./colorizing\");\r\nvar _utils = require(\"../core/utils\");\r\nvar _common2 = require(\"../../core/utils/common\");\r\nvar _type = require(\"../../core/utils/type\");\r\nvar _extend2 = require(\"../../core/utils/extend\");\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\nvar _max = Math.max;\r\nvar directions = {\r\n    lefttoprightbottom: [1, 1],\r\n    leftbottomrighttop: [1, -1],\r\n    righttopleftbottom: [-1, 1],\r\n    rightbottomlefttop: [-1, -1]\r\n};\r\nrequire(\"./tiling.squarified\");\r\nrequire(\"./tiling\").setDefaultAlgorithm(\"squarified\");\r\nrequire(\"./colorizing.discrete\");\r\nrequire(\"./colorizing\").setDefaultColorizer(\"discrete\");\r\n\r\nfunction pickPositiveInteger(val) {\r\n    return val > 0 ? Math.round(val) : 0\r\n}\r\nvar dxTreeMap = require(\"../core/base_widget\").inherit({\r\n    _handlers: {\r\n        beginBuildNodes: _common2.noop,\r\n        buildNode: _common2.noop,\r\n        endBuildNodes: _common2.noop,\r\n        setTrackerData: _common2.noop,\r\n        calculateState: function(options) {\r\n            return (0, _common.buildRectAppearance)(options)\r\n        }\r\n    },\r\n    _rootClass: \"dxtm-tree-map\",\r\n    _rootClassPrefix: \"dxtm\",\r\n    _getDefaultSize: function() {\r\n        return {\r\n            width: 400,\r\n            height: 400\r\n        }\r\n    },\r\n    _setDeprecatedOptions: function() {\r\n        this.callBase.apply(this, arguments);\r\n        (0, _extend2.extend)(this._deprecatedOptions, {\r\n            resolveLabelOverflow: {\r\n                since: \"19.1\",\r\n                message: \"Use the 'tile.label.overflow' and 'group.label.textOverflow' option instead\"\r\n            }\r\n        })\r\n    },\r\n    _themeSection: \"treeMap\",\r\n    _fontFields: [\"tile.label.font\", \"group.label.font\"],\r\n    _init: function() {\r\n        var that = this;\r\n        that._rectOffsets = {};\r\n        that._handlers = Object.create(that._handlers);\r\n        that._context = {\r\n            suspend: function() {\r\n                if (!that._applyingChanges) {\r\n                    that._suspendChanges()\r\n                }\r\n            },\r\n            resume: function() {\r\n                if (!that._applyingChanges) {\r\n                    that._resumeChanges()\r\n                }\r\n            },\r\n            change: function(codes) {\r\n                that._change(codes)\r\n            },\r\n            settings: [{}, {}],\r\n            calculateState: that._handlers.calculateState,\r\n            calculateLabelState: _common.buildTextAppearance\r\n        };\r\n        that._root = that._topNode = {\r\n            nodes: []\r\n        };\r\n        that.callBase.apply(that, arguments)\r\n    },\r\n    _initialChanges: [\"DATA_SOURCE\"],\r\n    _initCore: function() {\r\n        var that = this;\r\n        var renderer = that._renderer;\r\n        that._createProxyType();\r\n        that._tilesGroup = renderer.g().linkOn(renderer.root, \"tiles\").linkAppend();\r\n        that._labelsGroup = renderer.g().linkOn(renderer.root, \"labels\").linkAppend()\r\n    },\r\n    _createProxyType: _common2.noop,\r\n    _disposeCore: function() {\r\n        var that = this;\r\n        that._filter && that._filter.dispose();\r\n        that._labelsGroup.linkOff();\r\n        that._tilesGroup.linkOff()\r\n    },\r\n    _applySize: function(rect) {\r\n        this._tilingRect = rect.slice();\r\n        this._change([\"TILING\"])\r\n    },\r\n    _optionChangesMap: {\r\n        dataSource: \"DATA_SOURCE\",\r\n        valueField: \"NODES_CREATE\",\r\n        childrenField: \"NODES_CREATE\",\r\n        colorField: \"TILES\",\r\n        colorizer: \"TILES\",\r\n        labelField: \"LABELS\",\r\n        tile: \"TILE_SETTINGS\",\r\n        group: \"GROUP_SETTINGS\",\r\n        maxDepth: \"MAX_DEPTH\",\r\n        layoutAlgorithm: \"TILING\",\r\n        layoutDirection: \"TILING\",\r\n        resolveLabelOverflow: \"LABEL_OVERFLOW\"\r\n    },\r\n    _themeDependentChanges: [\"TILE_SETTINGS\", \"GROUP_SETTINGS\", \"MAX_DEPTH\"],\r\n    _changeDataSource: function() {\r\n        var that = this;\r\n        that._isDataExpected = that._isSyncData = true;\r\n        that._updateDataSource();\r\n        that._isSyncData = false;\r\n        if (that._isDataExpected) {\r\n            that._suspendChanges()\r\n        }\r\n    },\r\n    _dataSourceChangedHandler: function() {\r\n        var that = this;\r\n        if (that._isDataExpected) {\r\n            that._isDataExpected = false;\r\n            that._change([\"NODES_CREATE\"]);\r\n            if (!that._isSyncData) {\r\n                that._resumeChanges()\r\n            }\r\n        } else {\r\n            that._requestChange([\"NODES_CREATE\"])\r\n        }\r\n    },\r\n    _optionChangesOrder: [\"DATA_SOURCE\", \"TILE_SETTINGS\", \"GROUP_SETTINGS\", \"MAX_DEPTH\", \"LABEL_OVERFLOW\"],\r\n    _change_DATA_SOURCE: function() {\r\n        this._changeDataSource()\r\n    },\r\n    _change_TILE_SETTINGS: function() {\r\n        this._changeTileSettings()\r\n    },\r\n    _change_GROUP_SETTINGS: function() {\r\n        this._changeGroupSettings()\r\n    },\r\n    _change_LABEL_OVERFLOW: function() {\r\n        this._changeTileSettings();\r\n        this._changeGroupSettings()\r\n    },\r\n    _change_MAX_DEPTH: function() {\r\n        this._changeMaxDepth()\r\n    },\r\n    _customChangesOrder: [\"NODES_CREATE\", \"NODES_RESET\", \"TILES\", \"LABELS\", \"TILING\", \"LABELS_LAYOUT\"],\r\n    _change_NODES_CREATE: function() {\r\n        this._buildNodes()\r\n    },\r\n    _change_NODES_RESET: function() {\r\n        this._resetNodes()\r\n    },\r\n    _change_TILES: function() {\r\n        this._applyTilesAppearance()\r\n    },\r\n    _change_LABELS: function() {\r\n        this._applyLabelsAppearance()\r\n    },\r\n    _change_TILING: function() {\r\n        this._performTiling()\r\n    },\r\n    _change_LABELS_LAYOUT: function() {\r\n        this._performLabelsLayout()\r\n    },\r\n    _applyChanges: function() {\r\n        var that = this;\r\n        that.callBase.apply(that, arguments);\r\n        if (!that._isDataExpected) {\r\n            that._drawn()\r\n        }\r\n        that._context.forceReset = false\r\n    },\r\n    _buildNodes: function() {\r\n        var that = this;\r\n        var root = that._root = that._topNode = new _node2.default;\r\n        var processedData;\r\n        root._id = 0;\r\n        root.parent = {};\r\n        root.data = {};\r\n        root.level = root.index = -1;\r\n        root.ctx = that._context;\r\n        root.label = null;\r\n        that._nodes = [root];\r\n        that._handlers.beginBuildNodes();\r\n        processedData = that._processDataSourceItems(that._dataSourceItems() || []);\r\n        traverseDataItems(root, processedData.items, 0, {\r\n            itemsField: !processedData.isPlain && that._getOption(\"childrenField\", true) || \"items\",\r\n            valueField: that._getOption(\"valueField\", true) || \"value\",\r\n            buildNode: that._handlers.buildNode,\r\n            ctx: that._context,\r\n            nodes: that._nodes\r\n        });\r\n        that._onNodesCreated();\r\n        that._handlers.endBuildNodes();\r\n        that._change([\"NODES_RESET\"])\r\n    },\r\n    _onNodesCreated: _common2.noop,\r\n    _processDataSourceItems: function(items) {\r\n        return {\r\n            items: items,\r\n            isPlain: false\r\n        }\r\n    },\r\n    _changeTileSettings: function() {\r\n        var that = this;\r\n        var options = that._getOption(\"tile\");\r\n        var offsets = that._rectOffsets;\r\n        var borderWidth = pickPositiveInteger(options.border.width);\r\n        var edgeOffset = borderWidth / 2;\r\n        var innerOffset = 1 & borderWidth ? .5 : 0;\r\n        var labelOptions = options.label;\r\n        var settings = that._context.settings[0];\r\n        that._change([\"TILES\", \"LABELS\"]);\r\n        settings.state = that._handlers.calculateState(options);\r\n        that._filter = that._filter || that._renderer.shadowFilter(\"-50%\", \"-50%\", \"200%\", \"200%\");\r\n        that._filter.attr(labelOptions.shadow);\r\n        that._calculateLabelSettings(settings, labelOptions, that._filter.id);\r\n        if (offsets.tileEdge !== edgeOffset || offsets.tileInner !== innerOffset) {\r\n            offsets.tileEdge = edgeOffset;\r\n            offsets.tileInner = innerOffset;\r\n            that._change([\"TILING\"])\r\n        }\r\n    },\r\n    _changeGroupSettings: function() {\r\n        var that = this;\r\n        var options = that._getOption(\"group\");\r\n        var labelOptions = options.label;\r\n        var offsets = that._rectOffsets;\r\n        var borderWidth = pickPositiveInteger(options.border.width);\r\n        var edgeOffset = borderWidth / 2;\r\n        var innerOffset = 1 & borderWidth ? .5 : 0;\r\n        var headerHeight = 0;\r\n        var groupPadding = pickPositiveInteger(options.padding);\r\n        var settings = that._context.settings[1];\r\n        that._change([\"TILES\", \"LABELS\"]);\r\n        settings.state = that._handlers.calculateState(options);\r\n        that._calculateLabelSettings(settings, labelOptions);\r\n        if (options.headerHeight >= 0) {\r\n            headerHeight = pickPositiveInteger(options.headerHeight)\r\n        } else {\r\n            headerHeight = settings.labelParams.height + 2 * pickPositiveInteger(labelOptions.paddingTopBottom)\r\n        }\r\n        if (that._headerHeight !== headerHeight) {\r\n            that._headerHeight = headerHeight;\r\n            that._change([\"TILING\"])\r\n        }\r\n        if (that._groupPadding !== groupPadding) {\r\n            that._groupPadding = groupPadding;\r\n            that._change([\"TILING\"])\r\n        }\r\n        if (offsets.headerEdge !== edgeOffset || offsets.headerInner !== innerOffset) {\r\n            offsets.headerEdge = edgeOffset;\r\n            offsets.headerInner = innerOffset;\r\n            that._change([\"TILING\"])\r\n        }\r\n    },\r\n    _calculateLabelSettings: function(settings, options, filter) {\r\n        var bBox = this._getTextBBox(options.font);\r\n        var paddingLeftRight = pickPositiveInteger(options.paddingLeftRight);\r\n        var paddingTopBottom = pickPositiveInteger(options.paddingTopBottom);\r\n        var tileLabelOptions = this._getOption(\"tile.label\");\r\n        var groupLabelOptions = this._getOption(\"group.label\");\r\n        settings.labelState = (0, _common.buildTextAppearance)(options, filter);\r\n        settings.labelState.visible = !(\"visible\" in options) || !!options.visible;\r\n        settings.labelParams = {\r\n            height: bBox.height,\r\n            rtlEnabled: this._getOption(\"rtlEnabled\", true),\r\n            paddingTopBottom: paddingTopBottom,\r\n            paddingLeftRight: paddingLeftRight,\r\n            resolveLabelOverflow: this._getOptionByStealth(\"resolveLabelOverflow\"),\r\n            tileLabelWordWrap: tileLabelOptions.wordWrap,\r\n            tileLabelOverflow: tileLabelOptions.textOverflow,\r\n            groupLabelOverflow: groupLabelOptions.textOverflow\r\n        }\r\n    },\r\n    _changeMaxDepth: function() {\r\n        var maxDepth = this._getOption(\"maxDepth\", true);\r\n        maxDepth = maxDepth >= 1 ? Math.round(maxDepth) : 1 / 0;\r\n        if (this._maxDepth !== maxDepth) {\r\n            this._maxDepth = maxDepth;\r\n            this._change([\"NODES_RESET\"])\r\n        }\r\n    },\r\n    _resetNodes: function() {\r\n        var that = this;\r\n        that._tilesGroup.clear();\r\n        that._renderer.initHatching();\r\n        that._context.forceReset = true;\r\n        that._context.minLevel = that._topNode.level + 1;\r\n        that._context.maxLevel = that._context.minLevel + that._maxDepth - 1;\r\n        that._change([\"TILES\", \"LABELS\", \"TILING\"])\r\n    },\r\n    _processNodes: function(context, process) {\r\n        processNodes(context, this._topNode, process)\r\n    },\r\n    _applyTilesAppearance: function() {\r\n        var that = this;\r\n        var colorizer = (0, _colorizing.getColorizer)(that._getOption(\"colorizer\"), that._themeManager, that._topNode);\r\n        that._processNodes({\r\n            renderer: that._renderer,\r\n            group: that._tilesGroup,\r\n            setTrackerData: that._handlers.setTrackerData,\r\n            colorField: that._getOption(\"colorField\", true) || \"color\",\r\n            getColor: colorizer\r\n        }, processTileAppearance)\r\n    },\r\n    _applyLabelsAppearance: function() {\r\n        var that = this;\r\n        that._labelsGroup.clear();\r\n        that._processNodes({\r\n            renderer: that._renderer,\r\n            group: that._labelsGroup,\r\n            setTrackerData: that._handlers.setTrackerData,\r\n            labelField: that._getOption(\"labelField\", true) || \"name\"\r\n        }, processLabelAppearance);\r\n        that._change([\"LABELS_LAYOUT\"])\r\n    },\r\n    _performTiling: function() {\r\n        var that = this;\r\n        var context = {\r\n            algorithm: (0, _tiling.getAlgorithm)(that._getOption(\"layoutAlgorithm\", true)),\r\n            directions: directions[String(that._getOption(\"layoutDirection\", true)).toLowerCase()] || directions.lefttoprightbottom,\r\n            headerHeight: that._headerHeight,\r\n            groupPadding: that._groupPadding,\r\n            rectOffsets: that._rectOffsets\r\n        };\r\n        that._topNode.innerRect = that._tilingRect;\r\n        calculateRects(context, that._topNode);\r\n        that._processNodes(context, processTiling);\r\n        that._change([\"LABELS_LAYOUT\"]);\r\n        that._onTilingPerformed()\r\n    },\r\n    _onTilingPerformed: _common2.noop,\r\n    _performLabelsLayout: function() {\r\n        this._processNodes(null, processLabelsLayout)\r\n    },\r\n    _getTextBBox: function(fontOptions) {\r\n        var renderer = this._renderer;\r\n        var text = this._textForCalculations || renderer.text(\"0\", 0, 0);\r\n        var bBox;\r\n        this._textForCalculations = text;\r\n        text.css((0, _utils.patchFontOptions)(fontOptions)).append(renderer.root);\r\n        bBox = text.getBBox();\r\n        text.remove();\r\n        return bBox\r\n    }\r\n});\r\n\r\nfunction traverseDataItems(root, dataItems, level, params) {\r\n    var nodes = [];\r\n    var allNodes = params.nodes;\r\n    var node;\r\n    var i;\r\n    var ii = dataItems.length;\r\n    var dataItem;\r\n    var totalValue = 0;\r\n    var items;\r\n    for (i = 0; i < ii; ++i) {\r\n        dataItem = dataItems[i];\r\n        node = new _node2.default;\r\n        node._id = allNodes.length;\r\n        node.ctx = params.ctx;\r\n        node.parent = root;\r\n        node.level = level;\r\n        node.index = nodes.length;\r\n        node.data = dataItem;\r\n        params.buildNode(node);\r\n        allNodes.push(node);\r\n        nodes.push(node);\r\n        items = dataItem[params.itemsField];\r\n        if (items && items.length) {\r\n            traverseDataItems(node, items, level + 1, params)\r\n        }\r\n        if (dataItem[params.valueField] > 0) {\r\n            node.value = Number(dataItem[params.valueField])\r\n        }\r\n        totalValue += node.value\r\n    }\r\n    root.nodes = nodes;\r\n    root.value = totalValue\r\n}\r\n\r\nfunction processNodes(context, root, process) {\r\n    var nodes = root.nodes;\r\n    var node;\r\n    var i;\r\n    var ii = nodes.length;\r\n    for (i = 0; i < ii; ++i) {\r\n        node = nodes[i];\r\n        process(context, node);\r\n        if (node.isNode()) {\r\n            processNodes(context, node, process)\r\n        }\r\n    }\r\n}\r\n\r\nfunction processTileAppearance(context, node) {\r\n    node.color = node.data[context.colorField] || context.getColor(node) || node.parent.color;\r\n    node.updateStyles();\r\n    node.tile = !node.ctx.forceReset && node.tile || createTile[Number(node.isNode())](context, node);\r\n    node.applyState()\r\n}\r\nvar createTile = [createLeaf, createGroup];\r\n\r\nfunction createLeaf(context, node) {\r\n    var tile = context.renderer.simpleRect().append(context.group);\r\n    context.setTrackerData(node, tile);\r\n    return tile\r\n}\r\n\r\nfunction createGroup(context, node) {\r\n    var outer = context.renderer.simpleRect().append(context.group);\r\n    var inner = context.renderer.simpleRect().append(context.group);\r\n    context.setTrackerData(node, inner);\r\n    return {\r\n        outer: outer,\r\n        inner: inner\r\n    }\r\n}\r\n\r\nfunction processLabelAppearance(context, node) {\r\n    node.updateLabelStyle();\r\n    if (node.labelState.visible) {\r\n        createLabel(context, node, node.labelState, node.labelParams)\r\n    }\r\n}\r\n\r\nfunction createLabel(context, currentNode, settings, params) {\r\n    var textData = currentNode.data[context.labelField];\r\n    currentNode.label = textData ? String(textData) : null;\r\n    textData = currentNode.customLabel || currentNode.label;\r\n    if (textData) {\r\n        currentNode.text = context.renderer.text(textData).attr(settings.attr).css(settings.css).append(context.group);\r\n        context.setTrackerData(currentNode, currentNode.text)\r\n    }\r\n}\r\nvar emptyRect = [0, 0, 0, 0];\r\n\r\nfunction calculateRects(context, root) {\r\n    var nodes = root.nodes;\r\n    var items = [];\r\n    var rects = [];\r\n    var sum = 0;\r\n    var i;\r\n    var ii = items.length = rects.length = nodes.length;\r\n    for (i = 0; i < ii; ++i) {\r\n        sum += nodes[i].value;\r\n        items[i] = {\r\n            value: nodes[i].value,\r\n            i: i\r\n        }\r\n    }\r\n    if (sum > 0) {\r\n        context.algorithm({\r\n            items: items.slice(),\r\n            sum: sum,\r\n            rect: root.innerRect.slice(),\r\n            isRotated: 1 & nodes[0].level,\r\n            directions: context.directions\r\n        })\r\n    }\r\n    for (i = 0; i < ii; ++i) {\r\n        rects[i] = items[i].rect || emptyRect\r\n    }\r\n    root.rects = rects\r\n}\r\n\r\nfunction processTiling(context, node) {\r\n    var rect = node.parent.rects[node.index];\r\n    var rectOffsets = context.rectOffsets;\r\n    var headerHeight;\r\n    if (node.isNode()) {\r\n        setRectAttrs(node.tile.outer, buildTileRect(rect, node.parent.innerRect, rectOffsets.headerEdge, rectOffsets.headerInner));\r\n        rect = marginateRect(rect, context.groupPadding);\r\n        headerHeight = Math.min(context.headerHeight, rect[3] - rect[1]);\r\n        node.rect = [rect[0], rect[1], rect[2], rect[1] + headerHeight];\r\n        setRectAttrs(node.tile.inner, marginateRect(node.rect, rectOffsets.headerEdge));\r\n        rect[1] += headerHeight;\r\n        node.innerRect = rect;\r\n        calculateRects(context, node)\r\n    } else {\r\n        node.rect = rect;\r\n        setRectAttrs(node.tile, buildTileRect(rect, node.parent.innerRect, rectOffsets.tileEdge, rectOffsets.tileInner))\r\n    }\r\n}\r\n\r\nfunction marginateRect(rect, margin) {\r\n    return [rect[0] + margin, rect[1] + margin, rect[2] - margin, rect[3] - margin]\r\n}\r\n\r\nfunction buildTileRect(rect, outer, edgeOffset, innerOffset) {\r\n    return [rect[0] + (rect[0] === outer[0] ? edgeOffset : +innerOffset), rect[1] + (rect[1] === outer[1] ? edgeOffset : +innerOffset), rect[2] - (rect[2] === outer[2] ? edgeOffset : -innerOffset), rect[3] - (rect[3] === outer[3] ? edgeOffset : -innerOffset)]\r\n}\r\n\r\nfunction setRectAttrs(element, rect) {\r\n    element.attr({\r\n        x: rect[0],\r\n        y: rect[1],\r\n        width: _max(rect[2] - rect[0], 0),\r\n        height: _max(rect[3] - rect[1], 0)\r\n    })\r\n}\r\n\r\nfunction processLabelsLayout(context, node) {\r\n    if (node.text && node.labelState.visible) {\r\n        layoutTextNode(node, node.labelParams)\r\n    }\r\n}\r\n\r\nfunction layoutTextNode(node, params) {\r\n    var rect = node.rect;\r\n    var text = node.text;\r\n    var bBox = text.getBBox();\r\n    var paddingLeftRight = params.paddingLeftRight;\r\n    var paddingTopBottom = params.paddingTopBottom;\r\n    var effectiveWidth = rect[2] - rect[0] - 2 * paddingLeftRight;\r\n    var fitByHeight = bBox.height + paddingTopBottom <= rect[3] - rect[1];\r\n    var fitByWidth = bBox.width <= effectiveWidth;\r\n    var resolveLabelOverflow = params.resolveLabelOverflow;\r\n    var groupLabelOverflow = params.groupLabelOverflow;\r\n    var tileLabelOverflow = params.tileLabelOverflow;\r\n    var tileLabelWordWrap = params.tileLabelWordWrap;\r\n    if ((0, _type.isDefined)(resolveLabelOverflow)) {\r\n        if (\"ellipsis\" === resolveLabelOverflow && fitByHeight) {\r\n            text.setMaxSize(effectiveWidth, void 0, {\r\n                wordWrap: \"none\",\r\n                textOverflow: \"ellipsis\"\r\n            });\r\n            if (!fitByWidth) {\r\n                bBox = text.getBBox();\r\n                fitByWidth = bBox.width <= effectiveWidth\r\n            }\r\n        }\r\n    } else {\r\n        fitByWidth = true;\r\n        fitByHeight = true;\r\n        text.setMaxSize(effectiveWidth, rect[3] - rect[1] - paddingTopBottom, node.isNode() ? {\r\n            textOverflow: groupLabelOverflow,\r\n            wordWrap: \"none\"\r\n        } : {\r\n            textOverflow: tileLabelOverflow,\r\n            wordWrap: tileLabelWordWrap,\r\n            hideOverflowEllipsis: true\r\n        })\r\n    }\r\n    text.attr({\r\n        visibility: fitByHeight && fitByWidth ? \"visible\" : \"hidden\"\r\n    });\r\n    if (fitByHeight && fitByWidth) {\r\n        text.move(params.rtlEnabled ? rect[2] - paddingLeftRight - bBox.x - bBox.width : rect[0] + paddingLeftRight - bBox.x, rect[1] + paddingTopBottom - bBox.y)\r\n    }\r\n}\r\nrequire(\"../../core/component_registrator\")(\"dxTreeMap\", dxTreeMap);\r\nmodule.exports = dxTreeMap;\r\ndxTreeMap.addPlugin(require(\"../core/data_source\").plugin);\r\n"]},"metadata":{},"sourceType":"script"}