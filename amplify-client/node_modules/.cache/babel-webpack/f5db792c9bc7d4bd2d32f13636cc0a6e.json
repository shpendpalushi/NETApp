{"ast":null,"code":"/**\r\n * DevExtreme (ui/tree_list/ui.tree_list.selection.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar _renderer = require(\"../../core/renderer\");\n\nvar _renderer2 = _interopRequireDefault(_renderer);\n\nvar _uiTree_list = require(\"./ui.tree_list.core\");\n\nvar _uiTree_list2 = _interopRequireDefault(_uiTree_list);\n\nvar _common = require(\"../../core/utils/common\");\n\nvar _uiGrid_core = require(\"../grid_core/ui.grid_core.selection\");\n\nvar _uiGrid_core2 = _interopRequireDefault(_uiGrid_core);\n\nvar _ui = require(\"../widget/ui.errors\");\n\nvar _ui2 = _interopRequireDefault(_ui);\n\nvar _extend = require(\"../../core/utils/extend\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nvar TREELIST_SELECT_ALL_CLASS = \"dx-treelist-select-all\";\nvar CELL_FOCUS_DISABLED_CLASS = \"dx-cell-focus-disabled\";\nvar SELECT_CHECKBOX_CLASS = \"dx-select-checkbox\";\nvar originalRowClick = _uiGrid_core2.default.extenders.views.rowsView._rowClick;\nvar originalHandleDataChanged = _uiGrid_core2.default.extenders.controllers.data._handleDataChanged;\n\nvar nodeExists = function nodeExists(array, currentKey) {\n  return !!array.filter(function (key) {\n    return key === currentKey;\n  }).length;\n};\n\n_uiTree_list2.default.registerModule(\"selection\", (0, _extend.extend)(true, {}, _uiGrid_core2.default, {\n  defaultOptions: function defaultOptions() {\n    return (0, _extend.extend)(true, _uiGrid_core2.default.defaultOptions(), {\n      selection: {\n        showCheckBoxesMode: \"always\",\n        recursive: false\n      }\n    });\n  },\n  extenders: {\n    controllers: {\n      data: {\n        _handleDataChanged: function _handleDataChanged(e) {\n          var selectionController = this.getController(\"selection\");\n          var isRecursiveSelection = selectionController.isRecursiveSelection();\n\n          if (isRecursiveSelection && (!e || \"updateSelectionState\" !== e.changeType)) {\n            selectionController.updateSelectionState({\n              selectedItemKeys: this.option(\"selectedRowKeys\")\n            });\n          }\n\n          originalHandleDataChanged.apply(this, arguments);\n        },\n        loadDescendants: function loadDescendants() {\n          var that = this;\n          var d = that.callBase.apply(that, arguments);\n          var selectionController = that.getController(\"selection\");\n          var isRecursiveSelection = selectionController.isRecursiveSelection();\n\n          if (isRecursiveSelection) {\n            d.done(function () {\n              selectionController.updateSelectionState({\n                selectedItemKeys: that.option(\"selectedRowKeys\")\n              });\n            });\n          }\n\n          return d;\n        }\n      },\n      selection: {\n        init: function init() {\n          this.callBase.apply(this, arguments);\n          this._selectionStateByKey = {};\n        },\n        _getSelectionConfig: function _getSelectionConfig() {\n          var _arguments = arguments,\n              _this = this;\n\n          var config = this.callBase.apply(this, arguments);\n          var plainItems = config.plainItems;\n\n          config.plainItems = function (all) {\n            if (all) {\n              return _this._dataController.getCachedStoreData() || [];\n            }\n\n            return plainItems.apply(_this, _arguments).map(function (item) {\n              return item.data;\n            });\n          };\n\n          config.isItemSelected = function (item) {\n            var key = _this._dataController.keyOf(item);\n\n            return _this.isRowSelected(key);\n          };\n\n          config.isSelectableItem = function () {\n            return true;\n          };\n\n          config.getItemData = function (item) {\n            return item;\n          };\n\n          return config;\n        },\n        renderSelectCheckBoxContainer: function renderSelectCheckBoxContainer($container, model) {\n          var that = this;\n          var rowsView = that.component.getView(\"rowsView\");\n          $container.addClass(CELL_FOCUS_DISABLED_CLASS);\n\n          var $checkbox = rowsView._renderSelectCheckBox($container, {\n            value: model.row.isSelected,\n            row: model.row,\n            column: model.column\n          });\n\n          rowsView._attachCheckBoxClickEvent($checkbox);\n        },\n        _updateSelectColumn: _common.noop,\n        _getVisibleNodeKeys: function _getVisibleNodeKeys(isRecursiveSelection) {\n          var component = this.component;\n          var root = component.getRootNode();\n          var cache = {};\n          var keys = [];\n          root && _uiTree_list2.default.foreachNodes(root.children, function (node) {\n            if (void 0 !== node.key && (node.visible || isRecursiveSelection)) {\n              keys.push(node.key);\n            }\n\n            return isRecursiveSelection ? false : component.isRowExpanded(node.key, cache);\n          });\n          return keys;\n        },\n        isSelectAll: function isSelectAll() {\n          var component = this.component;\n          var hasIndeterminateState;\n\n          var visibleKeys = this._getVisibleNodeKeys();\n\n          var selectedVisibleKeys = visibleKeys.filter(function (key) {\n            return component.isRowSelected(key);\n          });\n\n          if (!selectedVisibleKeys.length) {\n            hasIndeterminateState = visibleKeys.some(function (key) {\n              return void 0 === component.isRowSelected(key);\n            });\n            return hasIndeterminateState ? void 0 : false;\n          } else {\n            if (selectedVisibleKeys.length === visibleKeys.length) {\n              return true;\n            }\n          }\n        },\n        selectAll: function selectAll() {\n          var that = this;\n          var isRecursiveSelection = that.isRecursiveSelection();\n\n          var visibleKeys = that._getVisibleNodeKeys(isRecursiveSelection).filter(function (key) {\n            return !that.isRowSelected(key);\n          });\n\n          return that.selectRows(visibleKeys, true);\n        },\n        deselectAll: function deselectAll() {\n          var isRecursiveSelection = this.isRecursiveSelection();\n\n          var visibleKeys = this._getVisibleNodeKeys(isRecursiveSelection);\n\n          return this.deselectRows(visibleKeys);\n        },\n        selectedItemKeys: function selectedItemKeys(value, preserve, isDeselect, isSelectAll) {\n          var that = this;\n          var selectedRowKeys = that.option(\"selectedRowKeys\");\n          var isRecursiveSelection = this.isRecursiveSelection();\n\n          var normalizedArgs = isRecursiveSelection && that._normalizeSelectionArgs({\n            keys: value || []\n          }, !isDeselect);\n\n          if (normalizedArgs && !(0, _common.equalByValue)(normalizedArgs.selectedRowKeys, selectedRowKeys)) {\n            that._isSelectionNormalizing = true;\n            return this.callBase(normalizedArgs.selectedRowKeys, false, false, false).always(function () {\n              that._isSelectionNormalizing = false;\n            }).done(function (items) {\n              normalizedArgs.selectedRowsData = items;\n\n              that._fireSelectionChanged(normalizedArgs);\n            });\n          }\n\n          return this.callBase(value, preserve, isDeselect, isSelectAll);\n        },\n        changeItemSelection: function changeItemSelection(itemIndex, keyboardKeys) {\n          var isRecursiveSelection = this.isRecursiveSelection();\n\n          if (isRecursiveSelection && !keyboardKeys.shift) {\n            var key = this._dataController.getKeyByRowIndex(itemIndex);\n\n            return this.selectedItemKeys(key, true, this.isRowSelected(key));\n          }\n\n          return this.callBase.apply(this, arguments);\n        },\n        _updateParentSelectionState: function _updateParentSelectionState(node, isSelected) {\n          var that = this;\n          var state = isSelected;\n          var parentNode = node.parent;\n          var hasNonSelectedState;\n          var hasSelectedState;\n\n          if (parentNode) {\n            if (parentNode.children.length > 1) {\n              if (false === isSelected) {\n                hasSelectedState = parentNode.children.some(function (childNode, index, children) {\n                  return that._selectionStateByKey[childNode.key];\n                });\n                state = hasSelectedState ? void 0 : false;\n              } else {\n                if (true === isSelected) {\n                  hasNonSelectedState = parentNode.children.some(function (childNode) {\n                    return !that._selectionStateByKey[childNode.key];\n                  });\n                  state = hasNonSelectedState ? void 0 : true;\n                }\n              }\n            }\n\n            this._selectionStateByKey[parentNode.key] = state;\n\n            if (parentNode.parent && parentNode.parent.level >= 0) {\n              this._updateParentSelectionState(parentNode, state);\n            }\n          }\n        },\n        _updateChildrenSelectionState: function _updateChildrenSelectionState(node, isSelected) {\n          var that = this;\n          var children = node.children;\n          children && children.forEach(function (childNode) {\n            that._selectionStateByKey[childNode.key] = isSelected;\n\n            if (childNode.children.length > 0) {\n              that._updateChildrenSelectionState(childNode, isSelected);\n            }\n          });\n        },\n        _updateSelectionStateCore: function _updateSelectionStateCore(keys, isSelected) {\n          var node;\n          var dataController = this._dataController;\n\n          for (var i = 0; i < keys.length; i++) {\n            this._selectionStateByKey[keys[i]] = isSelected;\n            node = dataController.getNodeByKey(keys[i]);\n\n            if (node) {\n              this._updateParentSelectionState(node, isSelected);\n\n              this._updateChildrenSelectionState(node, isSelected);\n            }\n          }\n        },\n        _getSelectedParentKeys: function _getSelectedParentKeys(key, selectedItemKeys, useCash) {\n          var isSelected;\n          var selectedParentNode;\n\n          var node = this._dataController.getNodeByKey(key);\n\n          var parentNode = node && node.parent;\n          var result = [];\n\n          while (parentNode && parentNode.level >= 0) {\n            result.unshift(parentNode.key);\n            isSelected = useCash ? !nodeExists(selectedItemKeys, parentNode.key) && this.isRowSelected(parentNode.key) : selectedItemKeys.indexOf(parentNode.key) >= 0;\n\n            if (isSelected) {\n              selectedParentNode = parentNode;\n              result = this._getSelectedParentKeys(selectedParentNode.key, selectedItemKeys, useCash).concat(result);\n              break;\n            } else {\n              if (useCash) {\n                break;\n              }\n            }\n\n            parentNode = parentNode.parent;\n          }\n\n          return selectedParentNode && result || [];\n        },\n        _getSelectedChildKeys: function _getSelectedChildKeys(node, keysToIgnore) {\n          var that = this;\n          var childKeys = [];\n          node && _uiTree_list2.default.foreachNodes(node.children, function (childNode) {\n            var ignoreKeyIndex = keysToIgnore.indexOf(childNode.key);\n\n            if (ignoreKeyIndex < 0) {\n              childKeys.push(childNode.key);\n            }\n\n            return ignoreKeyIndex > 0 || ignoreKeyIndex < 0 && void 0 === that._selectionStateByKey[childNode.key];\n          });\n          return childKeys;\n        },\n        _normalizeParentKeys: function _normalizeParentKeys(key, args) {\n          var that = this;\n          var index;\n          var childKeys;\n          var parentNode;\n          var keysToIgnore = [key];\n\n          var parentNodeKeys = that._getSelectedParentKeys(key, args.selectedRowKeys);\n\n          if (parentNodeKeys.length) {\n            keysToIgnore = keysToIgnore.concat(parentNodeKeys);\n            keysToIgnore.forEach(function (key) {\n              index = args.selectedRowKeys.indexOf(key);\n\n              if (index >= 0) {\n                args.selectedRowKeys.splice(index, 1);\n              }\n            });\n            parentNode = that._dataController.getNodeByKey(parentNodeKeys[0]);\n            childKeys = that._getSelectedChildKeys(parentNode, keysToIgnore);\n            args.selectedRowKeys = args.selectedRowKeys.concat(childKeys);\n          }\n        },\n        _normalizeChildrenKeys: function _normalizeChildrenKeys(key, args) {\n          var that = this;\n          var index;\n\n          var node = that._dataController.getNodeByKey(key);\n\n          node && node.children.forEach(function (childNode) {\n            index = args.selectedRowKeys.indexOf(childNode.key);\n\n            if (index >= 0) {\n              args.selectedRowKeys.splice(index, 1);\n            }\n\n            that._normalizeChildrenKeys(childNode.key, args);\n          });\n        },\n        _normalizeSelectedRowKeysCore: function _normalizeSelectedRowKeysCore(keys, args, isSelect) {\n          var that = this;\n          var index;\n          keys.forEach(function (key) {\n            if (that.isRowSelected(key) === isSelect) {\n              return;\n            }\n\n            that._normalizeChildrenKeys(key, args);\n\n            index = args.selectedRowKeys.indexOf(key);\n\n            if (isSelect) {\n              if (index < 0) {\n                args.selectedRowKeys.push(key);\n              }\n\n              args.currentSelectedRowKeys.push(key);\n            } else {\n              if (index >= 0) {\n                args.selectedRowKeys.splice(index, 1);\n              }\n\n              args.currentDeselectedRowKeys.push(key);\n\n              that._normalizeParentKeys(key, args);\n            }\n          });\n        },\n        _normalizeSelectionArgs: function _normalizeSelectionArgs(args, isSelect) {\n          var result;\n          var keys = Array.isArray(args.keys) ? args.keys : [args.keys];\n          var selectedRowKeys = this.option(\"selectedRowKeys\") || [];\n\n          if (keys.length) {\n            result = {\n              currentSelectedRowKeys: [],\n              currentDeselectedRowKeys: [],\n              selectedRowKeys: selectedRowKeys.slice(0)\n            };\n\n            this._normalizeSelectedRowKeysCore(keys, result, isSelect);\n          }\n\n          return result;\n        },\n        _updateSelectedItems: function _updateSelectedItems(args) {\n          this.updateSelectionState(args);\n          this.callBase(args);\n        },\n        _fireSelectionChanged: function _fireSelectionChanged() {\n          if (!this._isSelectionNormalizing) {\n            this.callBase.apply(this, arguments);\n          }\n        },\n        _isModeLeavesOnly: function _isModeLeavesOnly(mode) {\n          return \"leavesOnly\" === mode || true === mode;\n        },\n        _getAllSelectedRowKeys: function _getAllSelectedRowKeys(parentKeys) {\n          var that = this;\n          var result = [];\n          parentKeys.forEach(function (key) {\n            var insertIndex = result.length;\n\n            var parentKeys = that._getSelectedParentKeys(key, result, true);\n\n            var childKeys = that._dataController.getChildNodeKeys(key);\n\n            result.splice.apply(result, [insertIndex, 0].concat(parentKeys));\n            result.push(key);\n            result = result.concat(childKeys);\n          });\n          return result;\n        },\n        _getParentSelectedRowKeys: function _getParentSelectedRowKeys(keys) {\n          var that = this;\n          var result = [];\n          keys.forEach(function (key) {\n            var parentKeys = that._getSelectedParentKeys(key, keys);\n\n            !parentKeys.length && result.push(key);\n          });\n          return result;\n        },\n        _getLeafSelectedRowKeys: function _getLeafSelectedRowKeys(keys) {\n          var that = this;\n          var result = [];\n          var dataController = that._dataController;\n          keys.forEach(function (key) {\n            var node = dataController.getNodeByKey(key);\n            node && !node.hasChildren && result.push(key);\n          });\n          return result;\n        },\n        isRecursiveSelection: function isRecursiveSelection() {\n          var selectionMode = this.option(\"selection.mode\");\n          var isRecursive = this.option(\"selection.recursive\");\n          return \"multiple\" === selectionMode && isRecursive;\n        },\n        updateSelectionState: function updateSelectionState(options) {\n          var removedItemKeys = options.removedItemKeys || [];\n          var selectedItemKeys = options.selectedItemKeys || [];\n\n          this._updateSelectionStateCore(removedItemKeys, false);\n\n          this._updateSelectionStateCore(selectedItemKeys, true);\n        },\n        isRowSelected: function isRowSelected(key) {\n          var result = this.callBase.apply(this, arguments);\n          var isRecursiveSelection = this.isRecursiveSelection();\n\n          if (!result && isRecursiveSelection) {\n            if (key in this._selectionStateByKey) {\n              return this._selectionStateByKey[key];\n            }\n\n            return false;\n          }\n\n          return result;\n        },\n        getSelectedRowKeys: function getSelectedRowKeys(mode) {\n          var that = this;\n\n          if (!that._dataController) {\n            return [];\n          }\n\n          if (true === mode) {\n            _ui2.default.log(\"W0002\", \"dxTreeList\", \"getSelectedRowKeys(leavesOnly)\", \"18.1\", \"Use the 'getSelectedRowKeys(mode)' method with a string parameter instead\");\n          }\n\n          var selectedRowKeys = that.callBase.apply(that, arguments);\n\n          if (mode) {\n            if (this.isRecursiveSelection()) {\n              selectedRowKeys = this._getAllSelectedRowKeys(selectedRowKeys);\n            }\n\n            if (\"all\" !== mode) {\n              if (\"excludeRecursive\" === mode) {\n                selectedRowKeys = that._getParentSelectedRowKeys(selectedRowKeys);\n              } else {\n                if (that._isModeLeavesOnly(mode)) {\n                  selectedRowKeys = that._getLeafSelectedRowKeys(selectedRowKeys);\n                }\n              }\n            }\n          }\n\n          return selectedRowKeys;\n        },\n        getSelectedRowsData: function getSelectedRowsData(mode) {\n          var that = this;\n          var dataController = that._dataController;\n          var selectedKeys = this.getSelectedRowKeys(mode) || [];\n          var selectedRowsData = [];\n          selectedKeys.forEach(function (key) {\n            var node = dataController.getNodeByKey(key);\n            node && selectedRowsData.push(node.data);\n          });\n          return selectedRowsData;\n        },\n        refresh: function refresh() {\n          this._selectionStateByKey = {};\n          return this.callBase.apply(this, arguments);\n        }\n      }\n    },\n    views: {\n      columnHeadersView: {\n        _processTemplate: function _processTemplate(template, options) {\n          var that = this;\n          var resultTemplate;\n          var renderingTemplate = this.callBase(template, options);\n\n          var firstDataColumnIndex = that._columnsController.getFirstDataColumnIndex();\n\n          if (renderingTemplate && \"header\" === options.rowType && options.column.index === firstDataColumnIndex) {\n            resultTemplate = {\n              render: function render(options) {\n                if (\"multiple\" === that.option(\"selection.mode\")) {\n                  that.renderSelectAll(options.container, options.model);\n                }\n\n                renderingTemplate.render(options);\n              }\n            };\n          } else {\n            resultTemplate = renderingTemplate;\n          }\n\n          return resultTemplate;\n        },\n        renderSelectAll: function renderSelectAll($cell, options) {\n          $cell.addClass(TREELIST_SELECT_ALL_CLASS);\n\n          this._renderSelectAllCheckBox($cell);\n        },\n        _isSortableElement: function _isSortableElement($target) {\n          return this.callBase($target) && !$target.closest(\".\" + SELECT_CHECKBOX_CLASS).length;\n        }\n      },\n      rowsView: {\n        _renderIcons: function _renderIcons($iconContainer, options) {\n          this.callBase.apply(this, arguments);\n\n          if (\"multiple\" === this.option(\"selection.mode\")) {\n            this.getController(\"selection\").renderSelectCheckBoxContainer($iconContainer, options);\n          }\n\n          return $iconContainer;\n        },\n        _rowClick: function _rowClick(e) {\n          var $targetElement = (0, _renderer2.default)(e.event.target);\n\n          if (this.isExpandIcon($targetElement)) {\n            this.callBase.apply(this, arguments);\n          } else {\n            originalRowClick.apply(this, arguments);\n          }\n        }\n      }\n    }\n  }\n}));","map":{"version":3,"sources":["C:/Users/User/Documents/Templates/Angular/black-dashboard-pro-angular-v1.1.1/black-dashboard-pro-angular-v1.1.1/node_modules/devextreme/ui/tree_list/ui.tree_list.selection.js"],"names":["_renderer","require","_renderer2","_interopRequireDefault","_uiTree_list","_uiTree_list2","_common","_uiGrid_core","_uiGrid_core2","_ui","_ui2","_extend","obj","__esModule","TREELIST_SELECT_ALL_CLASS","CELL_FOCUS_DISABLED_CLASS","SELECT_CHECKBOX_CLASS","originalRowClick","default","extenders","views","rowsView","_rowClick","originalHandleDataChanged","controllers","data","_handleDataChanged","nodeExists","array","currentKey","filter","key","length","registerModule","extend","defaultOptions","selection","showCheckBoxesMode","recursive","e","selectionController","getController","isRecursiveSelection","changeType","updateSelectionState","selectedItemKeys","option","apply","arguments","loadDescendants","that","d","callBase","done","init","_selectionStateByKey","_getSelectionConfig","_arguments","_this","config","plainItems","all","_dataController","getCachedStoreData","map","item","isItemSelected","keyOf","isRowSelected","isSelectableItem","getItemData","renderSelectCheckBoxContainer","$container","model","component","getView","addClass","$checkbox","_renderSelectCheckBox","value","row","isSelected","column","_attachCheckBoxClickEvent","_updateSelectColumn","noop","_getVisibleNodeKeys","root","getRootNode","cache","keys","foreachNodes","children","node","visible","push","isRowExpanded","isSelectAll","hasIndeterminateState","visibleKeys","selectedVisibleKeys","some","selectAll","selectRows","deselectAll","deselectRows","preserve","isDeselect","selectedRowKeys","normalizedArgs","_normalizeSelectionArgs","equalByValue","_isSelectionNormalizing","always","items","selectedRowsData","_fireSelectionChanged","changeItemSelection","itemIndex","keyboardKeys","shift","getKeyByRowIndex","_updateParentSelectionState","state","parentNode","parent","hasNonSelectedState","hasSelectedState","childNode","index","level","_updateChildrenSelectionState","forEach","_updateSelectionStateCore","dataController","i","getNodeByKey","_getSelectedParentKeys","useCash","selectedParentNode","result","unshift","indexOf","concat","_getSelectedChildKeys","keysToIgnore","childKeys","ignoreKeyIndex","_normalizeParentKeys","args","parentNodeKeys","splice","_normalizeChildrenKeys","_normalizeSelectedRowKeysCore","isSelect","currentSelectedRowKeys","currentDeselectedRowKeys","Array","isArray","slice","_updateSelectedItems","_isModeLeavesOnly","mode","_getAllSelectedRowKeys","parentKeys","insertIndex","getChildNodeKeys","_getParentSelectedRowKeys","_getLeafSelectedRowKeys","hasChildren","selectionMode","isRecursive","options","removedItemKeys","getSelectedRowKeys","log","getSelectedRowsData","selectedKeys","refresh","columnHeadersView","_processTemplate","template","resultTemplate","renderingTemplate","firstDataColumnIndex","_columnsController","getFirstDataColumnIndex","rowType","render","renderSelectAll","container","$cell","_renderSelectAllCheckBox","_isSortableElement","$target","closest","_renderIcons","$iconContainer","$targetElement","event","target","isExpandIcon"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/tree_list/ui.tree_list.selection.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar _renderer = require(\"../../core/renderer\");\r\nvar _renderer2 = _interopRequireDefault(_renderer);\r\nvar _uiTree_list = require(\"./ui.tree_list.core\");\r\nvar _uiTree_list2 = _interopRequireDefault(_uiTree_list);\r\nvar _common = require(\"../../core/utils/common\");\r\nvar _uiGrid_core = require(\"../grid_core/ui.grid_core.selection\");\r\nvar _uiGrid_core2 = _interopRequireDefault(_uiGrid_core);\r\nvar _ui = require(\"../widget/ui.errors\");\r\nvar _ui2 = _interopRequireDefault(_ui);\r\nvar _extend = require(\"../../core/utils/extend\");\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\nvar TREELIST_SELECT_ALL_CLASS = \"dx-treelist-select-all\";\r\nvar CELL_FOCUS_DISABLED_CLASS = \"dx-cell-focus-disabled\";\r\nvar SELECT_CHECKBOX_CLASS = \"dx-select-checkbox\";\r\nvar originalRowClick = _uiGrid_core2.default.extenders.views.rowsView._rowClick;\r\nvar originalHandleDataChanged = _uiGrid_core2.default.extenders.controllers.data._handleDataChanged;\r\nvar nodeExists = function(array, currentKey) {\r\n    return !!array.filter(function(key) {\r\n        return key === currentKey\r\n    }).length\r\n};\r\n_uiTree_list2.default.registerModule(\"selection\", (0, _extend.extend)(true, {}, _uiGrid_core2.default, {\r\n    defaultOptions: function() {\r\n        return (0, _extend.extend)(true, _uiGrid_core2.default.defaultOptions(), {\r\n            selection: {\r\n                showCheckBoxesMode: \"always\",\r\n                recursive: false\r\n            }\r\n        })\r\n    },\r\n    extenders: {\r\n        controllers: {\r\n            data: {\r\n                _handleDataChanged: function(e) {\r\n                    var selectionController = this.getController(\"selection\");\r\n                    var isRecursiveSelection = selectionController.isRecursiveSelection();\r\n                    if (isRecursiveSelection && (!e || \"updateSelectionState\" !== e.changeType)) {\r\n                        selectionController.updateSelectionState({\r\n                            selectedItemKeys: this.option(\"selectedRowKeys\")\r\n                        })\r\n                    }\r\n                    originalHandleDataChanged.apply(this, arguments)\r\n                },\r\n                loadDescendants: function() {\r\n                    var that = this;\r\n                    var d = that.callBase.apply(that, arguments);\r\n                    var selectionController = that.getController(\"selection\");\r\n                    var isRecursiveSelection = selectionController.isRecursiveSelection();\r\n                    if (isRecursiveSelection) {\r\n                        d.done(function() {\r\n                            selectionController.updateSelectionState({\r\n                                selectedItemKeys: that.option(\"selectedRowKeys\")\r\n                            })\r\n                        })\r\n                    }\r\n                    return d\r\n                }\r\n            },\r\n            selection: {\r\n                init: function() {\r\n                    this.callBase.apply(this, arguments);\r\n                    this._selectionStateByKey = {}\r\n                },\r\n                _getSelectionConfig: function() {\r\n                    var _arguments = arguments,\r\n                        _this = this;\r\n                    var config = this.callBase.apply(this, arguments);\r\n                    var plainItems = config.plainItems;\r\n                    config.plainItems = function(all) {\r\n                        if (all) {\r\n                            return _this._dataController.getCachedStoreData() || []\r\n                        }\r\n                        return plainItems.apply(_this, _arguments).map(function(item) {\r\n                            return item.data\r\n                        })\r\n                    };\r\n                    config.isItemSelected = function(item) {\r\n                        var key = _this._dataController.keyOf(item);\r\n                        return _this.isRowSelected(key)\r\n                    };\r\n                    config.isSelectableItem = function() {\r\n                        return true\r\n                    };\r\n                    config.getItemData = function(item) {\r\n                        return item\r\n                    };\r\n                    return config\r\n                },\r\n                renderSelectCheckBoxContainer: function($container, model) {\r\n                    var that = this;\r\n                    var rowsView = that.component.getView(\"rowsView\");\r\n                    $container.addClass(CELL_FOCUS_DISABLED_CLASS);\r\n                    var $checkbox = rowsView._renderSelectCheckBox($container, {\r\n                        value: model.row.isSelected,\r\n                        row: model.row,\r\n                        column: model.column\r\n                    });\r\n                    rowsView._attachCheckBoxClickEvent($checkbox)\r\n                },\r\n                _updateSelectColumn: _common.noop,\r\n                _getVisibleNodeKeys: function(isRecursiveSelection) {\r\n                    var component = this.component;\r\n                    var root = component.getRootNode();\r\n                    var cache = {};\r\n                    var keys = [];\r\n                    root && _uiTree_list2.default.foreachNodes(root.children, function(node) {\r\n                        if (void 0 !== node.key && (node.visible || isRecursiveSelection)) {\r\n                            keys.push(node.key)\r\n                        }\r\n                        return isRecursiveSelection ? false : component.isRowExpanded(node.key, cache)\r\n                    });\r\n                    return keys\r\n                },\r\n                isSelectAll: function() {\r\n                    var component = this.component;\r\n                    var hasIndeterminateState;\r\n                    var visibleKeys = this._getVisibleNodeKeys();\r\n                    var selectedVisibleKeys = visibleKeys.filter(function(key) {\r\n                        return component.isRowSelected(key)\r\n                    });\r\n                    if (!selectedVisibleKeys.length) {\r\n                        hasIndeterminateState = visibleKeys.some(function(key) {\r\n                            return void 0 === component.isRowSelected(key)\r\n                        });\r\n                        return hasIndeterminateState ? void 0 : false\r\n                    } else {\r\n                        if (selectedVisibleKeys.length === visibleKeys.length) {\r\n                            return true\r\n                        }\r\n                    }\r\n                },\r\n                selectAll: function() {\r\n                    var that = this;\r\n                    var isRecursiveSelection = that.isRecursiveSelection();\r\n                    var visibleKeys = that._getVisibleNodeKeys(isRecursiveSelection).filter(function(key) {\r\n                        return !that.isRowSelected(key)\r\n                    });\r\n                    return that.selectRows(visibleKeys, true)\r\n                },\r\n                deselectAll: function() {\r\n                    var isRecursiveSelection = this.isRecursiveSelection();\r\n                    var visibleKeys = this._getVisibleNodeKeys(isRecursiveSelection);\r\n                    return this.deselectRows(visibleKeys)\r\n                },\r\n                selectedItemKeys: function(value, preserve, isDeselect, isSelectAll) {\r\n                    var that = this;\r\n                    var selectedRowKeys = that.option(\"selectedRowKeys\");\r\n                    var isRecursiveSelection = this.isRecursiveSelection();\r\n                    var normalizedArgs = isRecursiveSelection && that._normalizeSelectionArgs({\r\n                        keys: value || []\r\n                    }, !isDeselect);\r\n                    if (normalizedArgs && !(0, _common.equalByValue)(normalizedArgs.selectedRowKeys, selectedRowKeys)) {\r\n                        that._isSelectionNormalizing = true;\r\n                        return this.callBase(normalizedArgs.selectedRowKeys, false, false, false).always(function() {\r\n                            that._isSelectionNormalizing = false\r\n                        }).done(function(items) {\r\n                            normalizedArgs.selectedRowsData = items;\r\n                            that._fireSelectionChanged(normalizedArgs)\r\n                        })\r\n                    }\r\n                    return this.callBase(value, preserve, isDeselect, isSelectAll)\r\n                },\r\n                changeItemSelection: function(itemIndex, keyboardKeys) {\r\n                    var isRecursiveSelection = this.isRecursiveSelection();\r\n                    if (isRecursiveSelection && !keyboardKeys.shift) {\r\n                        var key = this._dataController.getKeyByRowIndex(itemIndex);\r\n                        return this.selectedItemKeys(key, true, this.isRowSelected(key))\r\n                    }\r\n                    return this.callBase.apply(this, arguments)\r\n                },\r\n                _updateParentSelectionState: function(node, isSelected) {\r\n                    var that = this;\r\n                    var state = isSelected;\r\n                    var parentNode = node.parent;\r\n                    var hasNonSelectedState;\r\n                    var hasSelectedState;\r\n                    if (parentNode) {\r\n                        if (parentNode.children.length > 1) {\r\n                            if (false === isSelected) {\r\n                                hasSelectedState = parentNode.children.some(function(childNode, index, children) {\r\n                                    return that._selectionStateByKey[childNode.key]\r\n                                });\r\n                                state = hasSelectedState ? void 0 : false\r\n                            } else {\r\n                                if (true === isSelected) {\r\n                                    hasNonSelectedState = parentNode.children.some(function(childNode) {\r\n                                        return !that._selectionStateByKey[childNode.key]\r\n                                    });\r\n                                    state = hasNonSelectedState ? void 0 : true\r\n                                }\r\n                            }\r\n                        }\r\n                        this._selectionStateByKey[parentNode.key] = state;\r\n                        if (parentNode.parent && parentNode.parent.level >= 0) {\r\n                            this._updateParentSelectionState(parentNode, state)\r\n                        }\r\n                    }\r\n                },\r\n                _updateChildrenSelectionState: function(node, isSelected) {\r\n                    var that = this;\r\n                    var children = node.children;\r\n                    children && children.forEach(function(childNode) {\r\n                        that._selectionStateByKey[childNode.key] = isSelected;\r\n                        if (childNode.children.length > 0) {\r\n                            that._updateChildrenSelectionState(childNode, isSelected)\r\n                        }\r\n                    })\r\n                },\r\n                _updateSelectionStateCore: function(keys, isSelected) {\r\n                    var node;\r\n                    var dataController = this._dataController;\r\n                    for (var i = 0; i < keys.length; i++) {\r\n                        this._selectionStateByKey[keys[i]] = isSelected;\r\n                        node = dataController.getNodeByKey(keys[i]);\r\n                        if (node) {\r\n                            this._updateParentSelectionState(node, isSelected);\r\n                            this._updateChildrenSelectionState(node, isSelected)\r\n                        }\r\n                    }\r\n                },\r\n                _getSelectedParentKeys: function(key, selectedItemKeys, useCash) {\r\n                    var isSelected;\r\n                    var selectedParentNode;\r\n                    var node = this._dataController.getNodeByKey(key);\r\n                    var parentNode = node && node.parent;\r\n                    var result = [];\r\n                    while (parentNode && parentNode.level >= 0) {\r\n                        result.unshift(parentNode.key);\r\n                        isSelected = useCash ? !nodeExists(selectedItemKeys, parentNode.key) && this.isRowSelected(parentNode.key) : selectedItemKeys.indexOf(parentNode.key) >= 0;\r\n                        if (isSelected) {\r\n                            selectedParentNode = parentNode;\r\n                            result = this._getSelectedParentKeys(selectedParentNode.key, selectedItemKeys, useCash).concat(result);\r\n                            break\r\n                        } else {\r\n                            if (useCash) {\r\n                                break\r\n                            }\r\n                        }\r\n                        parentNode = parentNode.parent\r\n                    }\r\n                    return selectedParentNode && result || []\r\n                },\r\n                _getSelectedChildKeys: function(node, keysToIgnore) {\r\n                    var that = this;\r\n                    var childKeys = [];\r\n                    node && _uiTree_list2.default.foreachNodes(node.children, function(childNode) {\r\n                        var ignoreKeyIndex = keysToIgnore.indexOf(childNode.key);\r\n                        if (ignoreKeyIndex < 0) {\r\n                            childKeys.push(childNode.key)\r\n                        }\r\n                        return ignoreKeyIndex > 0 || ignoreKeyIndex < 0 && void 0 === that._selectionStateByKey[childNode.key]\r\n                    });\r\n                    return childKeys\r\n                },\r\n                _normalizeParentKeys: function(key, args) {\r\n                    var that = this;\r\n                    var index;\r\n                    var childKeys;\r\n                    var parentNode;\r\n                    var keysToIgnore = [key];\r\n                    var parentNodeKeys = that._getSelectedParentKeys(key, args.selectedRowKeys);\r\n                    if (parentNodeKeys.length) {\r\n                        keysToIgnore = keysToIgnore.concat(parentNodeKeys);\r\n                        keysToIgnore.forEach(function(key) {\r\n                            index = args.selectedRowKeys.indexOf(key);\r\n                            if (index >= 0) {\r\n                                args.selectedRowKeys.splice(index, 1)\r\n                            }\r\n                        });\r\n                        parentNode = that._dataController.getNodeByKey(parentNodeKeys[0]);\r\n                        childKeys = that._getSelectedChildKeys(parentNode, keysToIgnore);\r\n                        args.selectedRowKeys = args.selectedRowKeys.concat(childKeys)\r\n                    }\r\n                },\r\n                _normalizeChildrenKeys: function(key, args) {\r\n                    var that = this;\r\n                    var index;\r\n                    var node = that._dataController.getNodeByKey(key);\r\n                    node && node.children.forEach(function(childNode) {\r\n                        index = args.selectedRowKeys.indexOf(childNode.key);\r\n                        if (index >= 0) {\r\n                            args.selectedRowKeys.splice(index, 1)\r\n                        }\r\n                        that._normalizeChildrenKeys(childNode.key, args)\r\n                    })\r\n                },\r\n                _normalizeSelectedRowKeysCore: function(keys, args, isSelect) {\r\n                    var that = this;\r\n                    var index;\r\n                    keys.forEach(function(key) {\r\n                        if (that.isRowSelected(key) === isSelect) {\r\n                            return\r\n                        }\r\n                        that._normalizeChildrenKeys(key, args);\r\n                        index = args.selectedRowKeys.indexOf(key);\r\n                        if (isSelect) {\r\n                            if (index < 0) {\r\n                                args.selectedRowKeys.push(key)\r\n                            }\r\n                            args.currentSelectedRowKeys.push(key)\r\n                        } else {\r\n                            if (index >= 0) {\r\n                                args.selectedRowKeys.splice(index, 1)\r\n                            }\r\n                            args.currentDeselectedRowKeys.push(key);\r\n                            that._normalizeParentKeys(key, args)\r\n                        }\r\n                    })\r\n                },\r\n                _normalizeSelectionArgs: function(args, isSelect) {\r\n                    var result;\r\n                    var keys = Array.isArray(args.keys) ? args.keys : [args.keys];\r\n                    var selectedRowKeys = this.option(\"selectedRowKeys\") || [];\r\n                    if (keys.length) {\r\n                        result = {\r\n                            currentSelectedRowKeys: [],\r\n                            currentDeselectedRowKeys: [],\r\n                            selectedRowKeys: selectedRowKeys.slice(0)\r\n                        };\r\n                        this._normalizeSelectedRowKeysCore(keys, result, isSelect)\r\n                    }\r\n                    return result\r\n                },\r\n                _updateSelectedItems: function(args) {\r\n                    this.updateSelectionState(args);\r\n                    this.callBase(args)\r\n                },\r\n                _fireSelectionChanged: function() {\r\n                    if (!this._isSelectionNormalizing) {\r\n                        this.callBase.apply(this, arguments)\r\n                    }\r\n                },\r\n                _isModeLeavesOnly: function(mode) {\r\n                    return \"leavesOnly\" === mode || true === mode\r\n                },\r\n                _getAllSelectedRowKeys: function(parentKeys) {\r\n                    var that = this;\r\n                    var result = [];\r\n                    parentKeys.forEach(function(key) {\r\n                        var insertIndex = result.length;\r\n                        var parentKeys = that._getSelectedParentKeys(key, result, true);\r\n                        var childKeys = that._dataController.getChildNodeKeys(key);\r\n                        result.splice.apply(result, [insertIndex, 0].concat(parentKeys));\r\n                        result.push(key);\r\n                        result = result.concat(childKeys)\r\n                    });\r\n                    return result\r\n                },\r\n                _getParentSelectedRowKeys: function(keys) {\r\n                    var that = this;\r\n                    var result = [];\r\n                    keys.forEach(function(key) {\r\n                        var parentKeys = that._getSelectedParentKeys(key, keys);\r\n                        !parentKeys.length && result.push(key)\r\n                    });\r\n                    return result\r\n                },\r\n                _getLeafSelectedRowKeys: function(keys) {\r\n                    var that = this;\r\n                    var result = [];\r\n                    var dataController = that._dataController;\r\n                    keys.forEach(function(key) {\r\n                        var node = dataController.getNodeByKey(key);\r\n                        node && !node.hasChildren && result.push(key)\r\n                    });\r\n                    return result\r\n                },\r\n                isRecursiveSelection: function() {\r\n                    var selectionMode = this.option(\"selection.mode\");\r\n                    var isRecursive = this.option(\"selection.recursive\");\r\n                    return \"multiple\" === selectionMode && isRecursive\r\n                },\r\n                updateSelectionState: function(options) {\r\n                    var removedItemKeys = options.removedItemKeys || [];\r\n                    var selectedItemKeys = options.selectedItemKeys || [];\r\n                    this._updateSelectionStateCore(removedItemKeys, false);\r\n                    this._updateSelectionStateCore(selectedItemKeys, true)\r\n                },\r\n                isRowSelected: function(key) {\r\n                    var result = this.callBase.apply(this, arguments);\r\n                    var isRecursiveSelection = this.isRecursiveSelection();\r\n                    if (!result && isRecursiveSelection) {\r\n                        if (key in this._selectionStateByKey) {\r\n                            return this._selectionStateByKey[key]\r\n                        }\r\n                        return false\r\n                    }\r\n                    return result\r\n                },\r\n                getSelectedRowKeys: function(mode) {\r\n                    var that = this;\r\n                    if (!that._dataController) {\r\n                        return []\r\n                    }\r\n                    if (true === mode) {\r\n                        _ui2.default.log(\"W0002\", \"dxTreeList\", \"getSelectedRowKeys(leavesOnly)\", \"18.1\", \"Use the 'getSelectedRowKeys(mode)' method with a string parameter instead\")\r\n                    }\r\n                    var selectedRowKeys = that.callBase.apply(that, arguments);\r\n                    if (mode) {\r\n                        if (this.isRecursiveSelection()) {\r\n                            selectedRowKeys = this._getAllSelectedRowKeys(selectedRowKeys)\r\n                        }\r\n                        if (\"all\" !== mode) {\r\n                            if (\"excludeRecursive\" === mode) {\r\n                                selectedRowKeys = that._getParentSelectedRowKeys(selectedRowKeys)\r\n                            } else {\r\n                                if (that._isModeLeavesOnly(mode)) {\r\n                                    selectedRowKeys = that._getLeafSelectedRowKeys(selectedRowKeys)\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                    return selectedRowKeys\r\n                },\r\n                getSelectedRowsData: function(mode) {\r\n                    var that = this;\r\n                    var dataController = that._dataController;\r\n                    var selectedKeys = this.getSelectedRowKeys(mode) || [];\r\n                    var selectedRowsData = [];\r\n                    selectedKeys.forEach(function(key) {\r\n                        var node = dataController.getNodeByKey(key);\r\n                        node && selectedRowsData.push(node.data)\r\n                    });\r\n                    return selectedRowsData\r\n                },\r\n                refresh: function() {\r\n                    this._selectionStateByKey = {};\r\n                    return this.callBase.apply(this, arguments)\r\n                }\r\n            }\r\n        },\r\n        views: {\r\n            columnHeadersView: {\r\n                _processTemplate: function(template, options) {\r\n                    var that = this;\r\n                    var resultTemplate;\r\n                    var renderingTemplate = this.callBase(template, options);\r\n                    var firstDataColumnIndex = that._columnsController.getFirstDataColumnIndex();\r\n                    if (renderingTemplate && \"header\" === options.rowType && options.column.index === firstDataColumnIndex) {\r\n                        resultTemplate = {\r\n                            render: function(options) {\r\n                                if (\"multiple\" === that.option(\"selection.mode\")) {\r\n                                    that.renderSelectAll(options.container, options.model)\r\n                                }\r\n                                renderingTemplate.render(options)\r\n                            }\r\n                        }\r\n                    } else {\r\n                        resultTemplate = renderingTemplate\r\n                    }\r\n                    return resultTemplate\r\n                },\r\n                renderSelectAll: function($cell, options) {\r\n                    $cell.addClass(TREELIST_SELECT_ALL_CLASS);\r\n                    this._renderSelectAllCheckBox($cell)\r\n                },\r\n                _isSortableElement: function($target) {\r\n                    return this.callBase($target) && !$target.closest(\".\" + SELECT_CHECKBOX_CLASS).length\r\n                }\r\n            },\r\n            rowsView: {\r\n                _renderIcons: function($iconContainer, options) {\r\n                    this.callBase.apply(this, arguments);\r\n                    if (\"multiple\" === this.option(\"selection.mode\")) {\r\n                        this.getController(\"selection\").renderSelectCheckBoxContainer($iconContainer, options)\r\n                    }\r\n                    return $iconContainer\r\n                },\r\n                _rowClick: function(e) {\r\n                    var $targetElement = (0, _renderer2.default)(e.event.target);\r\n                    if (this.isExpandIcon($targetElement)) {\r\n                        this.callBase.apply(this, arguments)\r\n                    } else {\r\n                        originalRowClick.apply(this, arguments)\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n}));\r\n"]},"metadata":{},"sourceType":"script"}