{"ast":null,"code":"/**\r\n * DevExtreme (ui/diagram/ui.diagram.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar _renderer = require(\"../../core/renderer\");\n\nvar _renderer2 = _interopRequireDefault(_renderer);\n\nvar _ui = require(\"../widget/ui.widget\");\n\nvar _ui2 = _interopRequireDefault(_ui);\n\nvar _drawer = require(\"../drawer\");\n\nvar _drawer2 = _interopRequireDefault(_drawer);\n\nvar _load_indicator = require(\"../load_indicator\");\n\nvar _load_indicator2 = _interopRequireDefault(_load_indicator);\n\nvar _component_registrator = require(\"../../core/component_registrator\");\n\nvar _component_registrator2 = _interopRequireDefault(_component_registrator);\n\nvar _extend = require(\"../../core/utils/extend\");\n\nvar _type = require(\"../../core/utils/type\");\n\nvar _type2 = _interopRequireDefault(_type);\n\nvar _data = require(\"../../core/utils/data\");\n\nvar _data2 = _interopRequireDefault(_data);\n\nvar _uiDiagram = require(\"./ui.diagram.toolbar\");\n\nvar _uiDiagram2 = _interopRequireDefault(_uiDiagram);\n\nvar _uiDiagram3 = require(\"./ui.diagram.leftpanel\");\n\nvar _uiDiagram4 = _interopRequireDefault(_uiDiagram3);\n\nvar _uiDiagram5 = require(\"./ui.diagram.rightpanel\");\n\nvar _uiDiagram6 = _interopRequireDefault(_uiDiagram5);\n\nvar _uiDiagram7 = require(\"./ui.diagram.contextmenu\");\n\nvar _uiDiagram8 = _interopRequireDefault(_uiDiagram7);\n\nvar _uiDiagram9 = require(\"./ui.diagram.dialogs\");\n\nvar _uiDiagram10 = _interopRequireDefault(_uiDiagram9);\n\nvar _uiDiagram11 = require(\"./ui.diagram.toolbox\");\n\nvar _uiDiagram12 = _interopRequireDefault(_uiDiagram11);\n\nvar _uiDiagram13 = require(\"./ui.diagram.optionsupdate\");\n\nvar _uiDiagram14 = _interopRequireDefault(_uiDiagram13);\n\nvar _uiDiagram15 = require(\"./ui.diagram.nodes\");\n\nvar _uiDiagram16 = _interopRequireDefault(_uiDiagram15);\n\nvar _uiDiagram17 = require(\"./ui.diagram.edges\");\n\nvar _uiDiagram18 = _interopRequireDefault(_uiDiagram17);\n\nvar _tooltip = require(\"../tooltip\");\n\nvar _tooltip2 = _interopRequireDefault(_tooltip);\n\nvar _diagram_importer = require(\"./diagram_importer\");\n\nvar _window = require(\"../../core/utils/window\");\n\nvar _events_engine = require(\"../../events/core/events_engine\");\n\nvar _events_engine2 = _interopRequireDefault(_events_engine);\n\nvar _utils = require(\"../../events/utils\");\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nvar _message = require(\"../../localization/message\");\n\nvar _message2 = _interopRequireDefault(_message);\n\nvar _number = require(\"../../localization/number\");\n\nvar _number2 = _interopRequireDefault(_number);\n\nvar _uiDiagram19 = require(\"./ui.diagram.dialogmanager\");\n\nvar _uiDiagram20 = _interopRequireDefault(_uiDiagram19);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nfunction _typeof(obj) {\n  if (\"function\" === typeof Symbol && \"symbol\" === typeof Symbol.iterator) {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && \"function\" === typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n\n    if (\"value\" in descriptor) {\n      descriptor.writable = true;\n    }\n\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) {\n    _defineProperties(Constructor.prototype, protoProps);\n  }\n\n  if (staticProps) {\n    _defineProperties(Constructor, staticProps);\n  }\n\n  return Constructor;\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (\"object\" === _typeof(call) || \"function\" === typeof call)) {\n    return call;\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _assertThisInitialized(self) {\n  if (void 0 === self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _get(target, property, receiver) {\n  if (\"undefined\" !== typeof Reflect && Reflect.get) {\n    _get = Reflect.get;\n  } else {\n    _get = function _get(target, property, receiver) {\n      var base = _superPropBase(target, property);\n\n      if (!base) {\n        return;\n      }\n\n      var desc = Object.getOwnPropertyDescriptor(base, property);\n\n      if (desc.get) {\n        return desc.get.call(receiver);\n      }\n\n      return desc.value;\n    };\n  }\n\n  return _get(target, property, receiver || target);\n}\n\nfunction _superPropBase(object, property) {\n  while (!Object.prototype.hasOwnProperty.call(object, property)) {\n    object = _getPrototypeOf(object);\n\n    if (null === object) {\n      break;\n    }\n  }\n\n  return object;\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function (o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nfunction _inherits(subClass, superClass) {\n  if (\"function\" !== typeof superClass && null !== superClass) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n\n  if (superClass) {\n    _setPrototypeOf(subClass, superClass);\n  }\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function (o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nvar DIAGRAM_CLASS = \"dx-diagram\";\nvar DIAGRAM_FULLSCREEN_CLASS = \"dx-diagram-fullscreen\";\nvar DIAGRAM_TOOLBAR_WRAPPER_CLASS = DIAGRAM_CLASS + \"-toolbar-wrapper\";\nvar DIAGRAM_CONTENT_WRAPPER_CLASS = DIAGRAM_CLASS + \"-content-wrapper\";\nvar DIAGRAM_DRAWER_WRAPPER_CLASS = DIAGRAM_CLASS + \"-drawer-wrapper\";\nvar DIAGRAM_CONTENT_CLASS = DIAGRAM_CLASS + \"-content\";\nvar DIAGRAM_LOADING_INDICATOR_CLASS = DIAGRAM_CLASS + \"-loading-indicator\";\nvar DIAGRAM_DEFAULT_UNIT = \"in\";\nvar DIAGRAM_DEFAULT_ZOOMLEVEL = 1;\nvar DIAGRAM_DEFAULT_AUTOZOOM = \"disabled\";\nvar DIAGRAM_DEFAULT_PAGE_ORIENTATION = \"portrait\";\nvar DIAGRAM_DEFAULT_PAGE_COLOR = \"white\";\nvar DIAGRAM_NAMESPACE = \"dxDiagramEvent\";\n\nvar FULLSCREEN_CHANGE_EVENT_NAME = _utils2.default.addNamespace(\"fullscreenchange\", DIAGRAM_NAMESPACE);\n\nvar IE_FULLSCREEN_CHANGE_EVENT_NAME = _utils2.default.addNamespace(\"msfullscreenchange\", DIAGRAM_NAMESPACE);\n\nvar WEBKIT_FULLSCREEN_CHANGE_EVENT_NAME = _utils2.default.addNamespace(\"webkitfullscreenchange\", DIAGRAM_NAMESPACE);\n\nvar MOZ_FULLSCREEN_CHANGE_EVENT_NAME = _utils2.default.addNamespace(\"mozfullscreenchange\", DIAGRAM_NAMESPACE);\n\nvar Diagram = function (_Widget) {\n  _inherits(Diagram, _Widget);\n\n  function Diagram() {\n    _classCallCheck(this, Diagram);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(Diagram).apply(this, arguments));\n  }\n\n  _createClass(Diagram, [{\n    key: \"_init\",\n    value: function value() {\n      this._updateDiagramLockCount = 0;\n\n      _get(_getPrototypeOf(Diagram.prototype), \"_init\", this).call(this);\n\n      this._initDiagram();\n\n      this.optionsUpdateBar = new _uiDiagram14.default(this);\n    }\n  }, {\n    key: \"_initMarkup\",\n    value: function value() {\n      _get(_getPrototypeOf(Diagram.prototype), \"_initMarkup\", this).call(this);\n\n      var isServerSide = !(0, _window.hasWindow)();\n      this.$element().addClass(DIAGRAM_CLASS);\n      this._toolbarInstance = void 0;\n\n      if (this.option(\"toolbar.visible\")) {\n        this._renderToolbar();\n      }\n\n      var $contentWrapper = (0, _renderer2.default)(\"<div>\").addClass(DIAGRAM_CONTENT_WRAPPER_CLASS).appendTo(this.$element());\n      this._leftPanel = void 0;\n\n      if (this.option(\"toolbox.visible\")) {\n        this._renderLeftPanel($contentWrapper);\n      }\n\n      var $drawerWrapper = (0, _renderer2.default)(\"<div>\").addClass(DIAGRAM_DRAWER_WRAPPER_CLASS).appendTo($contentWrapper);\n\n      if (this.option(\"propertiesPanel.enabled\")) {\n        var $drawer = (0, _renderer2.default)(\"<div>\").appendTo($drawerWrapper);\n        this._content = (0, _renderer2.default)(\"<div>\").addClass(DIAGRAM_CONTENT_CLASS).appendTo($drawer);\n\n        this._renderRightPanel($drawer);\n      } else {\n        this._content = (0, _renderer2.default)(\"<div>\").addClass(DIAGRAM_CONTENT_CLASS).appendTo($drawerWrapper);\n      }\n\n      this._contextMenu = void 0;\n\n      if (this.option(\"contextMenu.enabled\")) {\n        this._renderContextMenu(this._content);\n      }\n\n      this._renderDialog(this._content);\n\n      !isServerSide && this._diagramInstance.createDocument(this._content[0]);\n\n      if (this.option(\"zoomLevel\") !== DIAGRAM_DEFAULT_ZOOMLEVEL) {\n        this._updateZoomLevelState();\n      }\n\n      if (this.option(\"autoZoom\") !== DIAGRAM_DEFAULT_AUTOZOOM) {\n        this._updateAutoZoomState();\n      }\n\n      if (this.option(\"simpleView\")) {\n        this._updateSimpleViewState();\n      }\n\n      if (this.option(\"readOnly\") || this.option(\"disabled\")) {\n        this._updateReadOnlyState();\n      }\n\n      if (this.option(\"fullScreen\")) {\n        this._updateFullscreenState();\n      }\n\n      this._diagramInstance.barManager.registerBar(this.optionsUpdateBar);\n    }\n  }, {\n    key: \"notifyBarCommandExecuted\",\n    value: function value() {\n      this._diagramInstance.captureFocus();\n    }\n  }, {\n    key: \"_registerBar\",\n    value: function value(component) {\n      component.bar.onChanged.add(this);\n\n      this._diagramInstance.barManager.registerBar(component.bar);\n    }\n  }, {\n    key: \"_renderToolbar\",\n    value: function value() {\n      var _this = this;\n\n      var $toolbarWrapper = (0, _renderer2.default)(\"<div>\").addClass(DIAGRAM_TOOLBAR_WRAPPER_CLASS).appendTo(this.$element());\n      var toolbarWidgetCommandNames = [];\n\n      if (this.option(\"propertiesPanel.enabled\") && this.option(\"propertiesPanel.collapsible\")) {\n        toolbarWidgetCommandNames.push(\"options\");\n      }\n\n      this._toolbarInstance = this._createComponent($toolbarWrapper, _uiDiagram2.default, {\n        commands: this.option(\"toolbar.commands\"),\n        onContentReady: function onContentReady(e) {\n          return _this._registerBar(e.component);\n        },\n        onPointerUp: this._onPanelPointerUp.bind(this),\n        \"export\": this.option(\"export\"),\n        widgetCommandNames: toolbarWidgetCommandNames\n      });\n    }\n  }, {\n    key: \"_renderLeftPanel\",\n    value: function value($parent) {\n      var _this2 = this;\n\n      var isServerSide = !(0, _window.hasWindow)();\n      var $leftPanel = (0, _renderer2.default)(\"<div>\").appendTo($parent);\n      this._leftPanel = this._createComponent($leftPanel, _uiDiagram4.default, {\n        toolboxGroups: this._getToolboxGroups(),\n        disabled: this.option(\"readOnly\"),\n        onShapeCategoryRendered: function onShapeCategoryRendered(e) {\n          if (isServerSide) {\n            return;\n          }\n\n          var $toolboxContainer = (0, _renderer2.default)(e.$element);\n\n          _this2._diagramInstance.createToolbox($toolboxContainer[0], 40, 8, {\n            \"data-toggle\": \"shape-toolbox-tooltip\"\n          }, e.shapes || e.category, \"texts\" === e.displayMode);\n\n          _this2._createTooltips($parent, $toolboxContainer.find('[data-toggle=\"shape-toolbox-tooltip\"]'));\n        },\n        onPointerUp: this._onPanelPointerUp.bind(this)\n      });\n    }\n  }, {\n    key: \"_createTooltips\",\n    value: function value($container, targets) {\n      var _this3 = this;\n\n      targets.each(function (index, element) {\n        var $target = (0, _renderer2.default)(element);\n        var $tooltip = (0, _renderer2.default)(\"<div>\").html($target.attr(\"title\")).appendTo($container);\n\n        _this3._createComponent($tooltip, _tooltip2.default, {\n          target: $target.get(0),\n          showEvent: \"mouseenter\",\n          hideEvent: \"mouseleave\",\n          position: \"top\",\n          animation: {\n            show: {\n              type: \"fade\",\n              from: 0,\n              to: 1,\n              delay: 500\n            },\n            hide: {\n              type: \"fade\",\n              from: 1,\n              to: 0,\n              delay: 100\n            }\n          }\n        });\n      });\n    }\n  }, {\n    key: \"_invalidateContextMenuCommands\",\n    value: function value() {\n      if (this._contextMenu) {\n        this._contextMenu.option({\n          commands: this.option(\"contextMenu.commands\")\n        });\n      }\n    }\n  }, {\n    key: \"_invalidatePropertiesPanelGroups\",\n    value: function value() {\n      if (this._rightPanel) {\n        this._rightPanel.option({\n          propertyGroups: this.option(\"propertiesPanel.groups\")\n        });\n      }\n    }\n  }, {\n    key: \"_invalidateToolbarCommands\",\n    value: function value() {\n      if (this._toolbarInstance) {\n        this._toolbarInstance.option({\n          commands: this.option(\"toolbar.commands\")\n        });\n      }\n    }\n  }, {\n    key: \"_invalidateToolboxGroups\",\n    value: function value() {\n      if (this._leftPanel) {\n        this._leftPanel.option({\n          toolboxGroups: this._getToolboxGroups()\n        });\n      }\n    }\n  }, {\n    key: \"_setLeftPanelEnabled\",\n    value: function value(enabled) {\n      if (this._leftPanel) {\n        this._leftPanel.option({\n          disabled: !enabled\n        });\n      }\n    }\n  }, {\n    key: \"_renderRightPanel\",\n    value: function value($parent) {\n      var _this4 = this;\n\n      var isCollapsible = this.option(\"propertiesPanel.collapsible\");\n\n      var drawer = this._createComponent($parent, _drawer2.default, {\n        closeOnOutsideClick: isCollapsible,\n        opened: !isCollapsible,\n        openedStateMode: isCollapsible ? \"overlap\" : \"shrink\",\n        position: \"right\",\n        template: function template($options) {\n          _this4._rightPanel = _this4._createComponent($options, _uiDiagram6.default, {\n            propertyGroups: _this4.option(\"propertiesPanel.groups\"),\n            onContentReady: function onContentReady(e) {\n              return _this4._registerBar(e.component);\n            },\n            onPointerUp: _this4._onPanelPointerUp.bind(_this4)\n          });\n        }\n      });\n\n      if (this._toolbarInstance) {\n        this._toolbarInstance.option(\"onWidgetCommand\", function (e) {\n          if (\"options\" === e.name) {\n            drawer.toggle();\n          }\n        });\n      }\n    }\n  }, {\n    key: \"_onPanelPointerUp\",\n    value: function value() {\n      this._diagramInstance.captureFocus();\n    }\n  }, {\n    key: \"_renderContextMenu\",\n    value: function value($mainElement) {\n      var _this5 = this;\n\n      var $contextMenu = (0, _renderer2.default)(\"<div>\").appendTo(this.$element());\n      this._contextMenu = this._createComponent($contextMenu, _uiDiagram8.default, {\n        commands: this.option(\"contextMenu.commands\"),\n        container: $mainElement,\n        onContentReady: function onContentReady(_ref) {\n          var component = _ref.component;\n          return _this5._registerBar(component);\n        },\n        onVisibleChanged: function onVisibleChanged(_ref2) {\n          var component = _ref2.component;\n          return _this5._diagramInstance.barManager.updateBarItemsState(component.bar);\n        },\n        onItemClick: function onItemClick(itemData) {\n          return _this5._onBeforeCommandExecuted(itemData.command);\n        }\n      });\n    }\n  }, {\n    key: \"_onBeforeCommandExecuted\",\n    value: function value(command) {\n      var dialogParameters = _uiDiagram20.default.getDialogParameters(command);\n\n      if (dialogParameters) {\n        this._showDialog(dialogParameters);\n      }\n\n      return !!dialogParameters;\n    }\n  }, {\n    key: \"_renderDialog\",\n    value: function value($mainElement) {\n      var $dialogElement = (0, _renderer2.default)(\"<div>\").appendTo($mainElement);\n      this._dialogInstance = this._createComponent($dialogElement, _uiDiagram10.default, {});\n    }\n  }, {\n    key: \"_showDialog\",\n    value: function value(dialogParameters) {\n      if (this._dialogInstance) {\n        this._dialogInstance.option(\"onGetContent\", dialogParameters.onGetContent);\n\n        this._dialogInstance.option(\"onHidden\", function () {\n          this._diagramInstance.captureFocus();\n        }.bind(this));\n\n        this._dialogInstance.option(\"command\", this._diagramInstance.commandManager.getCommand(dialogParameters.command));\n\n        this._dialogInstance.option(\"title\", dialogParameters.title);\n\n        this._dialogInstance._show();\n      }\n    }\n  }, {\n    key: \"_showLoadingIndicator\",\n    value: function value() {\n      this._loadingIndicator = (0, _renderer2.default)(\"<div>\").addClass(DIAGRAM_LOADING_INDICATOR_CLASS);\n\n      this._createComponent(this._loadingIndicator, _load_indicator2.default, {});\n\n      var $parent = this._content || this.$element();\n      $parent.append(this._loadingIndicator);\n    }\n  }, {\n    key: \"_hideLoadingIndicator\",\n    value: function value() {\n      if (!this._loadingIndicator) {\n        return;\n      }\n\n      this._loadingIndicator.remove();\n\n      this._loadingIndicator = null;\n    }\n  }, {\n    key: \"_initDiagram\",\n    value: function value() {\n      var _getDiagram = (0, _diagram_importer.getDiagram)(),\n          DiagramControl = _getDiagram.DiagramControl;\n\n      this._diagramInstance = new DiagramControl();\n      this._diagramInstance.onChanged = this._raiseDataChangeAction.bind(this);\n      this._diagramInstance.onEdgeInserted = this._raiseEdgeInsertedAction.bind(this);\n      this._diagramInstance.onEdgeUpdated = this._raiseEdgeUpdatedAction.bind(this);\n      this._diagramInstance.onEdgeRemoved = this._raiseEdgeRemovedAction.bind(this);\n      this._diagramInstance.onNodeInserted = this._raiseNodeInsertedAction.bind(this);\n      this._diagramInstance.onNodeUpdated = this._raiseNodeUpdatedAction.bind(this);\n      this._diagramInstance.onNodeRemoved = this._raiseNodeRemovedAction.bind(this);\n      this._diagramInstance.onToolboxDragStart = this._raiseToolboxDragStart.bind(this);\n      this._diagramInstance.onToolboxDragEnd = this._raiseToolboxDragEnd.bind(this);\n      this._diagramInstance.onToggleFullscreen = this._onToggleFullScreen.bind(this);\n      this._diagramInstance.onShowContextMenu = this._onShowContextMenu.bind(this);\n      this._diagramInstance.onHideContextMenu = this._onHideContextMenu.bind(this);\n\n      this._diagramInstance.onNativeAction.add({\n        notifyItemClick: this._raiseItemClickAction.bind(this),\n        notifyItemDblClick: this._raiseItemDblClickAction.bind(this),\n        notifySelectionChanged: this._raiseSelectionChanged.bind(this)\n      });\n\n      this._updateUnitItems();\n\n      this._updateFormatUnitsMethod();\n\n      if (this.option(\"units\") !== DIAGRAM_DEFAULT_UNIT) {\n        this._updateUnitsState();\n      }\n\n      if (this.option(\"pageSize\")) {\n        if (this.option(\"pageSize.items\")) {\n          this._updatePageSizeItemsState();\n        }\n\n        if (this.option(\"pageSize.width\") && this.option(\"pageSize.height\")) {\n          this._updatePageSizeState();\n        }\n      }\n\n      if (this.option(\"pageOrientation\") !== DIAGRAM_DEFAULT_PAGE_ORIENTATION) {\n        this._updatePageOrientationState();\n      }\n\n      if (this.option(\"pageColor\") !== DIAGRAM_DEFAULT_PAGE_COLOR) {\n        this._updatePageColorState();\n      }\n\n      if (this.option(\"viewUnits\") !== DIAGRAM_DEFAULT_UNIT) {\n        this._updateViewUnitsState();\n      }\n\n      if (!this.option(\"showGrid\")) {\n        this._updateShowGridState();\n      }\n\n      if (!this.option(\"snapToGrid\")) {\n        this._updateSnapToGridState();\n      }\n\n      if (this.option(\"gridSize\")) {\n        if (this.option(\"gridSize.items\")) {\n          this._updateGridSizeItemsState();\n        }\n\n        this._updateGridSizeState();\n      }\n\n      if (this.option(\"zoomLevel.items\")) {\n        this._updateZoomLevelItemsState();\n      }\n\n      this._updateCustomShapes(this._getCustomShapes());\n\n      this._refreshDataSources();\n    }\n  }, {\n    key: \"_dispose\",\n    value: function value() {\n      if (this._diagramInstance) {\n        this._diagramInstance.dispose();\n\n        this._diagramInstance = void 0;\n      }\n\n      _get(_getPrototypeOf(Diagram.prototype), \"_dispose\", this).call(this);\n    }\n  }, {\n    key: \"_executeDiagramCommand\",\n    value: function value(command, parameter) {\n      this._diagramInstance.commandManager.getCommand(command).execute(parameter);\n    }\n  }, {\n    key: \"_refreshDataSources\",\n    value: function value() {\n      this._beginUpdateDiagram();\n\n      this._refreshNodesDataSource();\n\n      this._refreshEdgesDataSource();\n\n      this._endUpdateDiagram();\n    }\n  }, {\n    key: \"_refreshNodesDataSource\",\n    value: function value() {\n      if (this._nodesOption) {\n        this._nodesOption._disposeDataSource();\n\n        delete this._nodesOption;\n      }\n\n      if (this.option(\"nodes.dataSource\")) {\n        this._nodesOption = new _uiDiagram16.default(this);\n\n        this._nodesOption.option(\"dataSource\", this.option(\"nodes.dataSource\"));\n\n        this._nodesOption._refreshDataSource();\n      }\n    }\n  }, {\n    key: \"_refreshEdgesDataSource\",\n    value: function value() {\n      if (this._edgesOption) {\n        this._edgesOption._disposeDataSource();\n\n        delete this._edgesOption;\n      }\n\n      if (this.option(\"edges.dataSource\")) {\n        this._edgesOption = new _uiDiagram18.default(this);\n\n        this._edgesOption.option(\"dataSource\", this.option(\"edges.dataSource\"));\n\n        this._edgesOption._refreshDataSource();\n      }\n    }\n  }, {\n    key: \"_getDiagramData\",\n    value: function value() {\n      var value;\n\n      var _getDiagram2 = (0, _diagram_importer.getDiagram)(),\n          DiagramCommand = _getDiagram2.DiagramCommand;\n\n      this._executeDiagramCommand(DiagramCommand.Export, function (data) {\n        value = data;\n      });\n\n      return value;\n    }\n  }, {\n    key: \"_setDiagramData\",\n    value: function value(data, keepExistingItems) {\n      var _getDiagram3 = (0, _diagram_importer.getDiagram)(),\n          DiagramCommand = _getDiagram3.DiagramCommand;\n\n      this._executeDiagramCommand(DiagramCommand.Import, {\n        data: data,\n        keepExistingItems: keepExistingItems\n      });\n    }\n  }, {\n    key: \"_onDataSourceChanged\",\n    value: function value() {\n      this._bindDiagramData();\n    }\n  }, {\n    key: \"_createOptionGetter\",\n    value: function value(optionName) {\n      var expr = this.option(optionName);\n      return expr && _data2.default.compileGetter(expr);\n    }\n  }, {\n    key: \"_createOptionSetter\",\n    value: function value(optionName) {\n      var expr = this.option(optionName);\n\n      if (_type2.default.isFunction(expr)) {\n        return expr;\n      }\n\n      return expr && _data2.default.compileSetter(expr);\n    }\n  }, {\n    key: \"_bindDiagramData\",\n    value: function value() {\n      if (this._updateDiagramLockCount || !this._isBindingMode()) {\n        return;\n      }\n\n      var _getDiagram4 = (0, _diagram_importer.getDiagram)(),\n          DiagramCommand = _getDiagram4.DiagramCommand,\n          ConnectorLineOption = _getDiagram4.ConnectorLineOption,\n          ConnectorLineEnding = _getDiagram4.ConnectorLineEnding;\n\n      var lineOptionGetter;\n      var lineOptionSetter;\n      var startLineEndingGetter;\n      var startLineEndingSetter;\n      var endLineEndingGetter;\n      var endLineEndingSetter;\n      var data = {\n        nodeDataSource: this._nodesOption && this._nodesOption.getItems(),\n        edgeDataSource: this._edgesOption && this._edgesOption.getItems(),\n        nodeDataImporter: {\n          getKey: this._createOptionGetter(\"nodes.keyExpr\"),\n          setKey: this._createOptionSetter(\"nodes.keyExpr\"),\n          getLocked: this._createOptionGetter(\"nodes.lockedExpr\"),\n          setLocked: this._createOptionSetter(\"nodes.lockedExpr\"),\n          getStyle: this._createOptionGetter(\"nodes.styleExpr\"),\n          setStyle: this._createOptionSetter(\"nodes.styleExpr\"),\n          getStyleText: this._createOptionGetter(\"nodes.textStyleExpr\"),\n          setStyleText: this._createOptionSetter(\"nodes.textStyleExpr\"),\n          getZIndex: this._createOptionGetter(\"nodes.zIndexExpr\"),\n          setZIndex: this._createOptionSetter(\"nodes.zIndexExpr\"),\n          getType: this._createOptionGetter(\"nodes.typeExpr\"),\n          setType: this._createOptionSetter(\"nodes.typeExpr\"),\n          getText: this._createOptionGetter(\"nodes.textExpr\"),\n          setText: this._createOptionSetter(\"nodes.textExpr\"),\n          getImage: this._createOptionGetter(\"nodes.imageUrlExpr\"),\n          setImage: this._createOptionSetter(\"nodes.imageUrlExpr\"),\n          getLeft: this._createOptionGetter(\"nodes.leftExpr\"),\n          setLeft: this._createOptionSetter(\"nodes.leftExpr\"),\n          getTop: this._createOptionGetter(\"nodes.topExpr\"),\n          setTop: this._createOptionSetter(\"nodes.topExpr\"),\n          getWidth: this._createOptionGetter(\"nodes.widthExpr\"),\n          setWidth: this._createOptionSetter(\"nodes.widthExpr\"),\n          getHeight: this._createOptionGetter(\"nodes.heightExpr\"),\n          setHeight: this._createOptionSetter(\"nodes.heightExpr\"),\n          getParentKey: this._createOptionGetter(\"nodes.parentKeyExpr\"),\n          setParentKey: this._createOptionSetter(\"nodes.parentKeyExpr\"),\n          getItems: this._createOptionGetter(\"nodes.itemsExpr\"),\n          setItems: this._createOptionSetter(\"nodes.itemsExpr\"),\n          getContainerKey: this._createOptionGetter(\"nodes.containerKeyExpr\"),\n          setContainerKey: this._createOptionSetter(\"nodes.containerKeyExpr\"),\n          getChildren: this._createOptionGetter(\"nodes.childrenExpr\"),\n          setChildren: this._createOptionSetter(\"nodes.childrenExpr\")\n        },\n        edgeDataImporter: {\n          getKey: this._createOptionGetter(\"edges.keyExpr\"),\n          setKey: this._createOptionSetter(\"edges.keyExpr\"),\n          getLocked: this._createOptionGetter(\"edges.lockedExpr\"),\n          setLocked: this._createOptionSetter(\"edges.lockedExpr\"),\n          getStyle: this._createOptionGetter(\"edges.styleExpr\"),\n          setStyle: this._createOptionSetter(\"edges.styleExpr\"),\n          getStyleText: this._createOptionGetter(\"edges.textStyleExpr\"),\n          setStyleText: this._createOptionSetter(\"edges.textStyleExpr\"),\n          getZIndex: this._createOptionGetter(\"edges.zIndexExpr\"),\n          setZIndex: this._createOptionSetter(\"edges.zIndexExpr\"),\n          getFrom: this._createOptionGetter(\"edges.fromExpr\"),\n          setFrom: this._createOptionSetter(\"edges.fromExpr\"),\n          getFromPointIndex: this._createOptionGetter(\"edges.fromPointIndexExpr\"),\n          setFromPointIndex: this._createOptionSetter(\"edges.fromPointIndexExpr\"),\n          getTo: this._createOptionGetter(\"edges.toExpr\"),\n          setTo: this._createOptionSetter(\"edges.toExpr\"),\n          getToPointIndex: this._createOptionGetter(\"edges.toPointIndexExpr\"),\n          setToPointIndex: this._createOptionSetter(\"edges.toPointIndexExpr\"),\n          getPoints: this._createOptionGetter(\"edges.pointsExpr\"),\n          setPoints: this._createOptionSetter(\"edges.pointsExpr\"),\n          getText: this._createOptionGetter(\"edges.textExpr\"),\n          setText: this._createOptionSetter(\"edges.textExpr\"),\n          getLineOption: (lineOptionGetter = this._createOptionGetter(\"edges.lineTypeExpr\")) && function (obj) {\n            var lineType = lineOptionGetter(obj);\n\n            switch (lineType) {\n              case \"straight\":\n                return ConnectorLineOption.Straight;\n\n              default:\n                return ConnectorLineOption.Orthogonal;\n            }\n          }.bind(this),\n          setLineOption: (lineOptionSetter = this._createOptionSetter(\"edges.lineTypeExpr\")) && function (obj, value) {\n            switch (value) {\n              case ConnectorLineOption.Straight:\n                value = \"straight\";\n                break;\n\n              case ConnectorLineOption.Orthogonal:\n                value = \"orthogonal\";\n            }\n\n            lineOptionSetter(obj, value);\n          }.bind(this),\n          getStartLineEnding: (startLineEndingGetter = this._createOptionGetter(\"edges.fromLineEndExpr\")) && function (obj) {\n            var lineType = startLineEndingGetter(obj);\n\n            switch (lineType) {\n              case \"arrow\":\n                return ConnectorLineEnding.Arrow;\n\n              default:\n                return ConnectorLineEnding.None;\n            }\n          }.bind(this),\n          setStartLineEnding: (startLineEndingSetter = this._createOptionSetter(\"edges.fromLineEndExpr\")) && function (obj, value) {\n            switch (value) {\n              case ConnectorLineEnding.Arrow:\n                value = \"arrow\";\n                break;\n\n              case ConnectorLineEnding.None:\n                value = \"none\";\n            }\n\n            startLineEndingSetter(obj, value);\n          }.bind(this),\n          getEndLineEnding: (endLineEndingGetter = this._createOptionGetter(\"edges.toLineEndExpr\")) && function (obj) {\n            var lineType = endLineEndingGetter(obj);\n\n            switch (lineType) {\n              case \"none\":\n                return ConnectorLineEnding.None;\n\n              default:\n                return ConnectorLineEnding.Arrow;\n            }\n          }.bind(this),\n          setEndLineEnding: (endLineEndingSetter = this._createOptionSetter(\"edges.toLineEndExpr\")) && function (obj, value) {\n            switch (value) {\n              case ConnectorLineEnding.Arrow:\n                value = \"arrow\";\n                break;\n\n              case ConnectorLineEnding.None:\n                value = \"none\";\n            }\n\n            endLineEndingSetter(obj, value);\n          }.bind(this)\n        },\n        layoutParameters: this._getDataBindingLayoutParameters()\n      };\n\n      this._executeDiagramCommand(DiagramCommand.BindDocument, data);\n    }\n  }, {\n    key: \"_getDataBindingLayoutParameters\",\n    value: function value() {\n      var _getDiagram5 = (0, _diagram_importer.getDiagram)(),\n          DataLayoutType = _getDiagram5.DataLayoutType,\n          DataLayoutOrientation = _getDiagram5.DataLayoutOrientation;\n\n      var layoutParametersOption = this.option(\"nodes.autoLayout\");\n\n      if (!layoutParametersOption || \"off\" === layoutParametersOption || \"off\" === layoutParametersOption.type) {\n        return;\n      }\n\n      var parameters = {};\n      var layoutType = layoutParametersOption.type || layoutParametersOption;\n\n      if (\"tree\" === layoutType) {\n        parameters.type = DataLayoutType.Tree;\n      } else {\n        if (\"layered\" === layoutType) {\n          parameters.type = DataLayoutType.Sugiyama;\n        }\n      }\n\n      if (\"vertical\" === layoutParametersOption.orientation) {\n        parameters.orientation = DataLayoutOrientation.Vertical;\n      } else {\n        if (\"horizontal\" === layoutParametersOption.orientation) {\n          parameters.orientation = DataLayoutOrientation.Horizontal;\n        }\n      }\n\n      return parameters;\n    }\n  }, {\n    key: \"_getAutoZoomValue\",\n    value: function value(option) {\n      var _getDiagram6 = (0, _diagram_importer.getDiagram)(),\n          AutoZoomMode = _getDiagram6.AutoZoomMode;\n\n      switch (option) {\n        case \"fitContent\":\n          return AutoZoomMode.FitContent;\n\n        case \"fitWidth\":\n          return AutoZoomMode.FitToWidth;\n\n        default:\n          return AutoZoomMode.Disabled;\n      }\n    }\n  }, {\n    key: \"_isBindingMode\",\n    value: function value() {\n      return this._nodesOption && this._nodesOption.hasItems() || this._edgesOption && this._nodesOption.hasItems();\n    }\n  }, {\n    key: \"_beginUpdateDiagram\",\n    value: function value() {\n      this._updateDiagramLockCount++;\n    }\n  }, {\n    key: \"_endUpdateDiagram\",\n    value: function value() {\n      this._updateDiagramLockCount = Math.max(this._updateDiagramLockCount - 1, 0);\n\n      if (!this._updateDiagramLockCount) {\n        this._bindDiagramData();\n      }\n    }\n  }, {\n    key: \"_getCustomShapes\",\n    value: function value() {\n      return this.option(\"customShapes\") || [];\n    }\n  }, {\n    key: \"_getToolboxGroups\",\n    value: function value() {\n      return _uiDiagram12.default.getGroups(this.option(\"toolbox.groups\"));\n    }\n  }, {\n    key: \"_updateCustomShapes\",\n    value: function value(customShapes, prevCustomShapes) {\n      if (Array.isArray(prevCustomShapes)) {\n        this._diagramInstance.removeCustomShapes(prevCustomShapes.map(function (s) {\n          return s.type;\n        }));\n      }\n\n      if (Array.isArray(customShapes)) {\n        this._diagramInstance.addCustomShapes(customShapes.map(function (s) {\n          return {\n            category: s.category,\n            type: s.type,\n            baseType: s.baseType,\n            title: s.title,\n            svgUrl: s.backgroundImageUrl,\n            svgLeft: s.backgroundImageLeft,\n            svgTop: s.backgroundImageTop,\n            svgWidth: s.backgroundImageWidth,\n            svgHeight: s.backgroundImageHeight,\n            defaultWidth: s.defaultWidth,\n            defaultHeight: s.defaultHeight,\n            defaultText: s.defaultText,\n            allowEditText: s.allowEditText,\n            textLeft: s.textLeft,\n            textTop: s.textTop,\n            textWidth: s.textWidth,\n            textHeight: s.textHeight,\n            defaultImageUrl: s.defaultImageUrl,\n            allowEditImage: s.allowEditImage,\n            imageLeft: s.imageLeft,\n            imageTop: s.imageTop,\n            imageWidth: s.imageWidth,\n            imageHeight: s.imageHeight,\n            connectionPoints: s.connectionPoints && s.connectionPoints.map(function (pt) {\n              return {\n                x: pt.x,\n                y: pt.y\n              };\n            })\n          };\n        }));\n      }\n    }\n  }, {\n    key: \"_onToggleFullScreen\",\n    value: function value(fullScreen) {\n      this._changeNativeFullscreen(fullScreen);\n\n      this.$element().toggleClass(DIAGRAM_FULLSCREEN_CLASS, fullScreen);\n\n      this._diagramInstance.updateLayout();\n    }\n  }, {\n    key: \"_changeNativeFullscreen\",\n    value: function value(setModeOn) {\n      var window = (0, _window.getWindow)();\n\n      if (window.self === window.top || setModeOn === this._inNativeFullscreen()) {\n        return;\n      }\n\n      if (setModeOn) {\n        this._subscribeFullscreenNativeChanged();\n      } else {\n        this._unsubscribeFullscreenNativeChanged();\n      }\n\n      this._setNativeFullscreen(setModeOn);\n    }\n  }, {\n    key: \"_setNativeFullscreen\",\n    value: function value(on) {\n      var window = (0, _window.getWindow)();\n      var document = window.self.document;\n      var body = window.self.document.body;\n\n      if (on) {\n        if (body.requestFullscreen) {\n          body.requestFullscreen();\n        } else {\n          if (body.mozRequestFullscreen) {\n            body.mozRequestFullscreen();\n          } else {\n            if (body.webkitRequestFullscreen) {\n              body.webkitRequestFullscreen();\n            } else {\n              if (body.msRequestFullscreen) {\n                body.msRequestFullscreen();\n              }\n            }\n          }\n        }\n      } else {\n        if (document.exitFullscreen) {\n          document.exitFullscreen();\n        } else {\n          if (document.mozCancelFullscreen) {\n            document.mozCancelFullscreen();\n          } else {\n            if (document.webkitExitFullscreen) {\n              document.webkitExitFullscreen();\n            } else {\n              if (document.msExitFullscreen) {\n                document.msExitFullscreen();\n              }\n            }\n          }\n        }\n      }\n    }\n  }, {\n    key: \"_inNativeFullscreen\",\n    value: function value() {\n      var document = (0, _window.getWindow)().document;\n      var fullscreenElement = document.fullscreenElement || document.msFullscreenElement || document.webkitFullscreenElement;\n      var isInFullscreen = fullscreenElement === document.body || document.webkitIsFullscreen;\n      return !!isInFullscreen;\n    }\n  }, {\n    key: \"_subscribeFullscreenNativeChanged\",\n    value: function value() {\n      var document = (0, _window.getWindow)().document;\n\n      var handler = this._onNativeFullscreenChangeHandler.bind(this);\n\n      _events_engine2.default.on(document, FULLSCREEN_CHANGE_EVENT_NAME, handler);\n\n      _events_engine2.default.on(document, IE_FULLSCREEN_CHANGE_EVENT_NAME, handler);\n\n      _events_engine2.default.on(document, WEBKIT_FULLSCREEN_CHANGE_EVENT_NAME, handler);\n\n      _events_engine2.default.on(document, MOZ_FULLSCREEN_CHANGE_EVENT_NAME, handler);\n    }\n  }, {\n    key: \"_unsubscribeFullscreenNativeChanged\",\n    value: function value() {\n      var document = (0, _window.getWindow)().document;\n\n      _events_engine2.default.off(document, FULLSCREEN_CHANGE_EVENT_NAME);\n\n      _events_engine2.default.off(document, IE_FULLSCREEN_CHANGE_EVENT_NAME);\n\n      _events_engine2.default.off(document, WEBKIT_FULLSCREEN_CHANGE_EVENT_NAME);\n\n      _events_engine2.default.off(document, MOZ_FULLSCREEN_CHANGE_EVENT_NAME);\n    }\n  }, {\n    key: \"_onNativeFullscreenChangeHandler\",\n    value: function value() {\n      if (!this._inNativeFullscreen()) {\n        this._unsubscribeFullscreenNativeChanged();\n\n        this._onToggleFullScreen(false);\n      }\n    }\n  }, {\n    key: \"_onShowContextMenu\",\n    value: function value(x, y, selection) {\n      this._contextMenu._show(x, y, selection);\n    }\n  }, {\n    key: \"_onHideContextMenu\",\n    value: function value() {\n      this._contextMenu._hide();\n    }\n  }, {\n    key: \"_getDiagramUnitValue\",\n    value: function value(_value) {\n      var _getDiagram7 = (0, _diagram_importer.getDiagram)(),\n          DiagramUnit = _getDiagram7.DiagramUnit;\n\n      switch (_value) {\n        case \"in\":\n          return DiagramUnit.In;\n\n        case \"cm\":\n          return DiagramUnit.Cm;\n\n        case \"px\":\n          return DiagramUnit.Px;\n\n        default:\n          return DiagramUnit.In;\n      }\n    }\n  }, {\n    key: \"_updateReadOnlyState\",\n    value: function value() {\n      var _getDiagram8 = (0, _diagram_importer.getDiagram)(),\n          DiagramCommand = _getDiagram8.DiagramCommand;\n\n      var readOnly = this.option(\"readOnly\") || this.option(\"disabled\");\n\n      this._executeDiagramCommand(DiagramCommand.ToggleReadOnly, readOnly);\n\n      this._setLeftPanelEnabled(!readOnly);\n    }\n  }, {\n    key: \"_updateZoomLevelState\",\n    value: function value() {\n      var zoomLevel = this.option(\"zoomLevel.value\");\n\n      if (!zoomLevel) {\n        zoomLevel = this.option(\"zoomLevel\");\n      }\n\n      var _getDiagram9 = (0, _diagram_importer.getDiagram)(),\n          DiagramCommand = _getDiagram9.DiagramCommand;\n\n      this._executeDiagramCommand(DiagramCommand.ZoomLevel, zoomLevel);\n    }\n  }, {\n    key: \"_updateZoomLevelItemsState\",\n    value: function value() {\n      var zoomLevelItems = this.option(\"zoomLevel.items\");\n\n      if (!Array.isArray(zoomLevelItems)) {\n        return;\n      }\n\n      var _getDiagram10 = (0, _diagram_importer.getDiagram)(),\n          DiagramCommand = _getDiagram10.DiagramCommand;\n\n      this._executeDiagramCommand(DiagramCommand.ZoomLevelItems, zoomLevelItems);\n    }\n  }, {\n    key: \"_updateAutoZoomState\",\n    value: function value() {\n      var _getDiagram11 = (0, _diagram_importer.getDiagram)(),\n          DiagramCommand = _getDiagram11.DiagramCommand;\n\n      this._executeDiagramCommand(DiagramCommand.SwitchAutoZoom, this._getAutoZoomValue(this.option(\"autoZoom\")));\n    }\n  }, {\n    key: \"_updateSimpleViewState\",\n    value: function value() {\n      var _getDiagram12 = (0, _diagram_importer.getDiagram)(),\n          DiagramCommand = _getDiagram12.DiagramCommand;\n\n      this._executeDiagramCommand(DiagramCommand.ToggleSimpleView, this.option(\"simpleView\"));\n    }\n  }, {\n    key: \"_updateFullscreenState\",\n    value: function value() {\n      var _getDiagram13 = (0, _diagram_importer.getDiagram)(),\n          DiagramCommand = _getDiagram13.DiagramCommand;\n\n      var fullScreen = this.option(\"fullScreen\");\n\n      this._executeDiagramCommand(DiagramCommand.Fullscreen, fullScreen);\n\n      this._onToggleFullScreen(fullScreen);\n    }\n  }, {\n    key: \"_updateShowGridState\",\n    value: function value() {\n      var _getDiagram14 = (0, _diagram_importer.getDiagram)(),\n          DiagramCommand = _getDiagram14.DiagramCommand;\n\n      this._executeDiagramCommand(DiagramCommand.ShowGrid, this.option(\"showGrid\"));\n    }\n  }, {\n    key: \"_updateSnapToGridState\",\n    value: function value() {\n      var _getDiagram15 = (0, _diagram_importer.getDiagram)(),\n          DiagramCommand = _getDiagram15.DiagramCommand;\n\n      this._executeDiagramCommand(DiagramCommand.SnapToGrid, this.option(\"snapToGrid\"));\n    }\n  }, {\n    key: \"_updateGridSizeState\",\n    value: function value() {\n      var gridSize = this.option(\"gridSize.value\");\n\n      if (!gridSize) {\n        gridSize = this.option(\"gridSize\");\n      }\n\n      var _getDiagram16 = (0, _diagram_importer.getDiagram)(),\n          DiagramCommand = _getDiagram16.DiagramCommand;\n\n      this._executeDiagramCommand(DiagramCommand.GridSize, gridSize);\n    }\n  }, {\n    key: \"_updateGridSizeItemsState\",\n    value: function value() {\n      var gridSizeItems = this.option(\"gridSize.items\");\n\n      if (!Array.isArray(gridSizeItems)) {\n        return;\n      }\n\n      var _getDiagram17 = (0, _diagram_importer.getDiagram)(),\n          DiagramCommand = _getDiagram17.DiagramCommand;\n\n      this._executeDiagramCommand(DiagramCommand.GridSizeItems, gridSizeItems);\n    }\n  }, {\n    key: \"_updateUnitItems\",\n    value: function value() {\n      var _getDiagram18 = (0, _diagram_importer.getDiagram)(),\n          DiagramUnit = _getDiagram18.DiagramUnit;\n\n      var items = {};\n      items[DiagramUnit.In] = _message2.default.format(\"dxDiagram-unitIn\");\n      items[DiagramUnit.Cm] = _message2.default.format(\"dxDiagram-unitCm\");\n      items[DiagramUnit.Px] = _message2.default.format(\"dxDiagram-unitPx\");\n      this._diagramInstance.settings.unitItems = items;\n    }\n  }, {\n    key: \"_updateFormatUnitsMethod\",\n    value: function value() {\n      this._diagramInstance.settings.formatUnit = function (value) {\n        return _number2.default.format(value);\n      };\n    }\n  }, {\n    key: \"_updateViewUnitsState\",\n    value: function value() {\n      var _getDiagram19 = (0, _diagram_importer.getDiagram)(),\n          DiagramCommand = _getDiagram19.DiagramCommand;\n\n      this._executeDiagramCommand(DiagramCommand.ViewUnits, this._getDiagramUnitValue(this.option(\"viewUnits\")));\n    }\n  }, {\n    key: \"_updateUnitsState\",\n    value: function value() {\n      var _getDiagram20 = (0, _diagram_importer.getDiagram)(),\n          DiagramCommand = _getDiagram20.DiagramCommand;\n\n      this._executeDiagramCommand(DiagramCommand.Units, this._getDiagramUnitValue(this.option(\"units\")));\n    }\n  }, {\n    key: \"_updatePageSizeState\",\n    value: function value() {\n      var pageSize = this.option(\"pageSize\");\n\n      if (!pageSize || !pageSize.width || !pageSize.height) {\n        return;\n      }\n\n      var _getDiagram21 = (0, _diagram_importer.getDiagram)(),\n          DiagramCommand = _getDiagram21.DiagramCommand;\n\n      this._executeDiagramCommand(DiagramCommand.PageSize, pageSize);\n    }\n  }, {\n    key: \"_updatePageSizeItemsState\",\n    value: function value() {\n      var pageSizeItems = this.option(\"pageSize.items\");\n\n      if (!Array.isArray(pageSizeItems)) {\n        return;\n      }\n\n      var _getDiagram22 = (0, _diagram_importer.getDiagram)(),\n          DiagramCommand = _getDiagram22.DiagramCommand;\n\n      this._executeDiagramCommand(DiagramCommand.PageSizeItems, pageSizeItems);\n    }\n  }, {\n    key: \"_updatePageOrientationState\",\n    value: function value() {\n      var _getDiagram23 = (0, _diagram_importer.getDiagram)(),\n          DiagramCommand = _getDiagram23.DiagramCommand;\n\n      this._executeDiagramCommand(DiagramCommand.PageLandscape, \"landscape\" === this.option(\"pageOrientation\"));\n    }\n  }, {\n    key: \"_updatePageColorState\",\n    value: function value() {\n      var _getDiagram24 = (0, _diagram_importer.getDiagram)(),\n          DiagramCommand = _getDiagram24.DiagramCommand;\n\n      this._executeDiagramCommand(DiagramCommand.PageColor, this.option(\"pageColor\"));\n    }\n  }, {\n    key: \"export\",\n    value: function value() {\n      return this._getDiagramData();\n    }\n  }, {\n    key: \"exportTo\",\n    value: function value(format, callback) {\n      var command = this._getDiagramExportToCommand(format);\n\n      this._executeDiagramCommand(command, callback);\n    }\n  }, {\n    key: \"_getDiagramExportToCommand\",\n    value: function value(format) {\n      var _getDiagram25 = (0, _diagram_importer.getDiagram)(),\n          DiagramCommand = _getDiagram25.DiagramCommand;\n\n      switch (format) {\n        case \"png\":\n          return DiagramCommand.ExportPng;\n\n        case \"jpg\":\n          return DiagramCommand.ExportJpg;\n\n        default:\n          return DiagramCommand.ExportSvg;\n      }\n    }\n  }, {\n    key: \"import\",\n    value: function value(data, updateExistingItemsOnly) {\n      this._setDiagramData(data, updateExistingItemsOnly);\n\n      this._raiseDataChangeAction();\n    }\n  }, {\n    key: \"_getDefaultOptions\",\n    value: function value() {\n      return (0, _extend.extend)(_get(_getPrototypeOf(Diagram.prototype), \"_getDefaultOptions\", this).call(this), {\n        readOnly: false,\n        zoomLevel: DIAGRAM_DEFAULT_ZOOMLEVEL,\n        simpleView: false,\n        autoZoom: DIAGRAM_DEFAULT_AUTOZOOM,\n        fullScreen: false,\n        showGrid: true,\n        snapToGrid: true,\n        units: DIAGRAM_DEFAULT_UNIT,\n        viewUnits: DIAGRAM_DEFAULT_UNIT,\n        pageOrientation: DIAGRAM_DEFAULT_PAGE_ORIENTATION,\n        pageColor: DIAGRAM_DEFAULT_PAGE_COLOR,\n        onDataChanged: null,\n        nodes: {\n          dataSource: null,\n          keyExpr: \"id\",\n          lockedExpr: void 0,\n          styleExpr: void 0,\n          textStyleExpr: void 0,\n          zIndexExpr: void 0,\n          typeExpr: \"type\",\n          textExpr: \"text\",\n          imageUrlExpr: void 0,\n          parentKeyExpr: void 0,\n          itemsExpr: void 0,\n          leftExpr: void 0,\n          topExpr: void 0,\n          widthExpr: void 0,\n          heightExpr: void 0,\n          containerKeyExpr: void 0,\n          childrenExpr: \"children\",\n          autoLayout: \"tree\"\n        },\n        edges: {\n          dataSource: null,\n          keyExpr: \"id\",\n          lockedExpr: void 0,\n          styleExpr: void 0,\n          textStyleExpr: void 0,\n          zIndexExpr: void 0,\n          fromExpr: \"from\",\n          fromPointIndexExpr: void 0,\n          toExpr: \"to\",\n          toPointIndexExpr: void 0,\n          pointsExpr: void 0,\n          textExpr: void 0,\n          lineTypeExpr: void 0,\n          fromLineEndExpr: void 0,\n          toLineEndExpr: void 0\n        },\n        customShapes: [],\n        toolbox: {\n          visible: true\n        },\n        toolbar: {\n          visible: true\n        },\n        contextMenu: {\n          enabled: true\n        },\n        propertiesPanel: {\n          enabled: true,\n          collapsible: true\n        },\n        \"export\": {\n          fileName: \"Diagram\",\n          proxyUrl: void 0\n        },\n        onItemClick: null,\n        onItemDblClick: null,\n        onSelectionChanged: null\n      });\n    }\n  }, {\n    key: \"_createDataChangeAction\",\n    value: function value() {\n      this._dataChangeAction = this._createActionByOption(\"onDataChanged\");\n    }\n  }, {\n    key: \"_raiseDataChangeAction\",\n    value: function value() {\n      if (!this._dataChangeAction) {\n        this._createDataChangeAction();\n      }\n\n      this._dataChangeAction();\n    }\n  }, {\n    key: \"_raiseEdgeInsertedAction\",\n    value: function value(data, callback, errorCallback) {\n      if (this._edgesOption) {\n        this._edgesOption.insert(data, callback, errorCallback);\n      }\n    }\n  }, {\n    key: \"_raiseEdgeUpdatedAction\",\n    value: function value(key, data, callback, errorCallback) {\n      if (this._edgesOption) {\n        this._edgesOption.update(key, data, callback, errorCallback);\n      }\n    }\n  }, {\n    key: \"_raiseEdgeRemovedAction\",\n    value: function value(key, data, callback, errorCallback) {\n      if (this._edgesOption) {\n        this._edgesOption.remove(key, data, callback, errorCallback);\n      }\n    }\n  }, {\n    key: \"_raiseNodeInsertedAction\",\n    value: function value(data, callback, errorCallback) {\n      if (this._nodesOption) {\n        this._nodesOption.insert(data, callback, errorCallback);\n      }\n    }\n  }, {\n    key: \"_raiseNodeUpdatedAction\",\n    value: function value(key, data, callback, errorCallback) {\n      if (this._nodesOption) {\n        this._nodesOption.update(key, data, callback, errorCallback);\n      }\n    }\n  }, {\n    key: \"_raiseNodeRemovedAction\",\n    value: function value(key, data, callback, errorCallback) {\n      if (this._nodesOption) {\n        this._nodesOption.remove(key, data, callback, errorCallback);\n      }\n    }\n  }, {\n    key: \"_raiseToolboxDragStart\",\n    value: function value() {\n      if (this._leftPanel) {\n        this._leftPanel.$element().addClass(\"dx-skip-gesture-event\");\n      }\n    }\n  }, {\n    key: \"_raiseToolboxDragEnd\",\n    value: function value() {\n      if (this._leftPanel) {\n        this._leftPanel.$element().removeClass(\"dx-skip-gesture-event\");\n      }\n    }\n  }, {\n    key: \"_createItemClickAction\",\n    value: function value() {\n      this._itemClickAction = this._createActionByOption(\"onItemClick\");\n    }\n  }, {\n    key: \"_createItemDblClickAction\",\n    value: function value() {\n      this._itemDblClickAction = this._createActionByOption(\"onItemDblClick\");\n    }\n  }, {\n    key: \"_createSelectionChangedAction\",\n    value: function value() {\n      this._selectionChangedAction = this._createActionByOption(\"onSelectionChanged\");\n    }\n  }, {\n    key: \"_raiseItemClickAction\",\n    value: function value(nativeItem) {\n      if (!this._itemClickAction) {\n        this._createItemClickAction();\n      }\n\n      this._itemClickAction({\n        item: this._nativeItemToDiagramItem(nativeItem)\n      });\n    }\n  }, {\n    key: \"_raiseItemDblClickAction\",\n    value: function value(nativeItem) {\n      if (!this._itemDblClickAction) {\n        this._createItemDblClickAction();\n      }\n\n      this._itemDblClickAction({\n        item: this._nativeItemToDiagramItem(nativeItem)\n      });\n    }\n  }, {\n    key: \"_raiseSelectionChanged\",\n    value: function value(nativeItems) {\n      if (!this._selectionChangedAction) {\n        this._createSelectionChangedAction();\n      }\n\n      this._selectionChangedAction({\n        items: nativeItems.map(this._nativeItemToDiagramItem.bind(this))\n      });\n    }\n  }, {\n    key: \"_nativeItemToDiagramItem\",\n    value: function value(nativeItem) {\n      var _getDiagram26 = (0, _diagram_importer.getDiagram)(),\n          NativeShape = _getDiagram26.NativeShape;\n\n      var createMethod = nativeItem instanceof NativeShape ? this._nativeShapeToDiagramShape.bind(this) : this._nativeConnectorToDiagramConnector.bind(this);\n      return (0, _extend.extend)({\n        id: nativeItem.id\n      }, createMethod(nativeItem));\n    }\n  }, {\n    key: \"_nativeShapeToDiagramShape\",\n    value: function value(nativeShape) {\n      return {\n        dataItem: this._nodesOption && this._nodesOption.findItem(nativeShape.key),\n        itemType: \"shape\",\n        text: nativeShape.text,\n        type: nativeShape.type\n      };\n    }\n  }, {\n    key: \"_nativeConnectorToDiagramConnector\",\n    value: function value(nativeConnector) {\n      return {\n        dataItem: this._edgesOption && this._edgesOption.findItem(nativeConnector.key),\n        itemType: \"connector\",\n        texts: nativeConnector.texts,\n        fromKey: nativeConnector.fromKey,\n        toKey: nativeConnector.toKey\n      };\n    }\n  }, {\n    key: \"_optionChanged\",\n    value: function value(args) {\n      if (this.optionsUpdateBar.isUpdateLocked()) {\n        return;\n      }\n\n      this.optionsUpdateBar.beginUpdate();\n\n      try {\n        this._optionChangedCore(args);\n      } finally {\n        this.optionsUpdateBar.endUpdate();\n      }\n    }\n  }, {\n    key: \"_optionChangedCore\",\n    value: function value(args) {\n      switch (args.name) {\n        case \"readOnly\":\n        case \"disabled\":\n          this._updateReadOnlyState();\n\n          break;\n\n        case \"zoomLevel\":\n          if (\"zoomLevel\" === args.fullName || \"zoomLevel.items\" === args.fullName) {\n            this._updateZoomLevelItemsState();\n          }\n\n          if (\"zoomLevel\" === args.fullName || \"zoomLevel.value\" === args.fullName) {\n            this._updateZoomLevelState();\n          }\n\n          break;\n\n        case \"autoZoom\":\n          this._updateAutoZoomState();\n\n          break;\n\n        case \"simpleView\":\n          this._updateSimpleViewState();\n\n          break;\n\n        case \"fullScreen\":\n          this._updateFullscreenState();\n\n          break;\n\n        case \"showGrid\":\n          this._updateShowGridState();\n\n          break;\n\n        case \"snapToGrid\":\n          this._updateSnapToGridState();\n\n          break;\n\n        case \"gridSize\":\n          if (\"gridSize\" === args.fullName || \"gridSize.items\" === args.fullName) {\n            this._updateGridSizeItemsState();\n          }\n\n          if (\"gridSize\" === args.fullName || \"gridSize.value\" === args.fullName) {\n            this._updateGridSizeState();\n          }\n\n          break;\n\n        case \"viewUnits\":\n          this._updateViewUnitsState();\n\n          break;\n\n        case \"units\":\n          this._updateUnitsState();\n\n          break;\n\n        case \"pageSize\":\n          if (\"pageSize\" === args.fullName || \"pageSize.items\" === args.fullName) {\n            this._updatePageSizeItemsState();\n          }\n\n          if (\"pageSize\" === args.fullName || \"pageSize.width\" === args.fullName || \"pageSize.height\" === args.fullName) {\n            this._updatePageSizeState();\n          }\n\n          break;\n\n        case \"pageOrientation\":\n          this._updatePageOrientationState();\n\n          break;\n\n        case \"pageColor\":\n          this._updatePageColorState();\n\n          break;\n\n        case \"nodes\":\n          if (\"nodes.autoLayout\" === args.fullName) {\n            this._refreshDataSources();\n          } else {\n            this._refreshNodesDataSource();\n          }\n\n          break;\n\n        case \"edges\":\n          this._refreshEdgesDataSource();\n\n          break;\n\n        case \"customShapes\":\n          this._updateCustomShapes(args.value, args.previousValue);\n\n          this._invalidate();\n\n          break;\n\n        case \"contextMenu\":\n          if (\"contextMenu.commands\" === args.fullName) {\n            this._invalidateContextMenuCommands();\n          } else {\n            this._invalidate();\n          }\n\n          break;\n\n        case \"propertiesPanel\":\n          if (\"propertiesPanel.groups\" === args.name) {\n            this._invalidatePropertiesPanelGroups();\n          } else {\n            this._invalidate();\n          }\n\n          break;\n\n        case \"toolbox\":\n          if (\"toolbox.groups\" === args.fullName) {\n            this._invalidateToolboxGroups();\n          } else {\n            this._invalidate();\n          }\n\n          break;\n\n        case \"toolbar\":\n          if (\"toolbar.commands\" === args.fullName) {\n            this._invalidateToolbarCommands();\n          } else {\n            this._invalidate();\n          }\n\n          break;\n\n        case \"onDataChanged\":\n          this._createDataChangeAction();\n\n          break;\n\n        case \"onItemClick\":\n          this._createItemClickAction();\n\n          break;\n\n        case \"onItemDblClick\":\n          this._createItemDblClickAction();\n\n          break;\n\n        case \"onSelectionChanged\":\n          this._createSelectionChangedAction();\n\n          break;\n\n        case \"export\":\n          if (this._toolbarInstance) {\n            this._toolbarInstance.option(\"export\", args.value);\n          }\n\n          break;\n\n        default:\n          _get(_getPrototypeOf(Diagram.prototype), \"_optionChanged\", this).call(this, args);\n\n      }\n    }\n  }]);\n\n  return Diagram;\n}(_ui2.default);\n\n(0, _component_registrator2.default)(\"dxDiagram\", Diagram);\nmodule.exports = Diagram;","map":null,"metadata":{},"sourceType":"script"}