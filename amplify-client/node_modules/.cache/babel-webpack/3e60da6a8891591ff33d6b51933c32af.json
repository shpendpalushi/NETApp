{"ast":null,"code":"/**\r\n * DevExtreme (ui/gantt/ui.gantt.dialogs.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.GanttDialog = void 0;\n\nvar _popup = require(\"../popup\");\n\nvar _popup2 = _interopRequireDefault(_popup);\n\nvar _form = require(\"../form\");\n\nvar _form2 = _interopRequireDefault(_form);\n\nrequire(\"../tag_box\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nfunction _typeof(obj) {\n  if (\"function\" === typeof Symbol && \"symbol\" === typeof Symbol.iterator) {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && \"function\" === typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (\"object\" === _typeof(call) || \"function\" === typeof call)) {\n    return call;\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _assertThisInitialized(self) {\n  if (void 0 === self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function (o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nfunction _inherits(subClass, superClass) {\n  if (\"function\" !== typeof superClass && null !== superClass) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n\n  if (superClass) {\n    _setPrototypeOf(subClass, superClass);\n  }\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function (o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n\n    if (\"value\" in descriptor) {\n      descriptor.writable = true;\n    }\n\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) {\n    _defineProperties(Constructor.prototype, protoProps);\n  }\n\n  if (staticProps) {\n    _defineProperties(Constructor, staticProps);\n  }\n\n  return Constructor;\n}\n\nvar GanttDialog = exports.GanttDialog = function () {\n  function GanttDialog(owner, $element) {\n    _classCallCheck(this, GanttDialog);\n\n    this._popupInstance = owner._createComponent($element, _popup2.default);\n    this.infoMap = {\n      TaskEdit: TaskEditDialogInfo,\n      Resources: ResourcesEditDialogInfo\n    };\n  }\n\n  _createClass(GanttDialog, [{\n    key: \"_apply\",\n    value: function value() {\n      var result = this._dialogInfo.getResult();\n\n      this._callback(result);\n\n      this.hide();\n    }\n  }, {\n    key: \"show\",\n    value: function value(name, parameters, callback, editingOptions) {\n      this._callback = callback;\n\n      if (!this.infoMap[name]) {\n        return;\n      }\n\n      this._dialogInfo = new this.infoMap[name](parameters, this._apply.bind(this), this.hide.bind(this), editingOptions);\n\n      this._popupInstance.option({\n        title: this._dialogInfo.getTitle(),\n        toolbarItems: this._dialogInfo.getToolbarItems(),\n        maxWidth: this._dialogInfo.getMaxWidth(),\n        height: this._dialogInfo.getHeight(),\n        contentTemplate: this._dialogInfo.getContentTemplate()\n      });\n\n      this._popupInstance.show();\n    }\n  }, {\n    key: \"hide\",\n    value: function value() {\n      this._popupInstance.hide();\n\n      delete this._dialogInfo;\n    }\n  }]);\n\n  return GanttDialog;\n}();\n\nvar DialogInfoBase = function () {\n  function DialogInfoBase(parameters, applyAction, hideAction, editingOptions) {\n    _classCallCheck(this, DialogInfoBase);\n\n    this._parameters = parameters;\n    this._applyAction = applyAction;\n    this._hideAction = hideAction;\n    this._editingOptions = editingOptions;\n  }\n\n  _createClass(DialogInfoBase, [{\n    key: \"_getFormItems\",\n    value: function value() {\n      return {};\n    }\n  }, {\n    key: \"_updateParameters\",\n    value: function value() {}\n  }, {\n    key: \"_getOkToolbarItem\",\n    value: function value() {\n      return {\n        widget: \"dxButton\",\n        location: \"after\",\n        toolbar: \"bottom\",\n        options: {\n          text: \"Ok\",\n          onClick: this._applyAction\n        }\n      };\n    }\n  }, {\n    key: \"_getCancelToolbarItem\",\n    value: function value() {\n      return {\n        widget: \"dxButton\",\n        location: \"after\",\n        toolbar: \"bottom\",\n        options: {\n          text: \"Cancel\",\n          onClick: this._hideAction\n        }\n      };\n    }\n  }, {\n    key: \"getTitle\",\n    value: function value() {\n      return \"\";\n    }\n  }, {\n    key: \"getToolbarItems\",\n    value: function value() {\n      return this._editingOptions.enabled ? [this._getOkToolbarItem(), this._getCancelToolbarItem()] : [this._getCancelToolbarItem()];\n    }\n  }, {\n    key: \"getMaxWidth\",\n    value: function value() {\n      return 400;\n    }\n  }, {\n    key: \"getHeight\",\n    value: function value() {\n      return \"auto\";\n    }\n  }, {\n    key: \"getContentTemplate\",\n    value: function value() {\n      var _this = this;\n\n      return function (content) {\n        _this._form = new _form2.default(content, {\n          formData: _this._parameters,\n          items: _this._getFormItems()\n        });\n        return content;\n      };\n    }\n  }, {\n    key: \"getResult\",\n    value: function value() {\n      var formData = this._form.option(\"formData\");\n\n      this._updateParameters(formData);\n\n      return this._parameters;\n    }\n  }]);\n\n  return DialogInfoBase;\n}();\n\nvar TaskEditDialogInfo = function (_DialogInfoBase) {\n  _inherits(TaskEditDialogInfo, _DialogInfoBase);\n\n  function TaskEditDialogInfo() {\n    _classCallCheck(this, TaskEditDialogInfo);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(TaskEditDialogInfo).apply(this, arguments));\n  }\n\n  _createClass(TaskEditDialogInfo, [{\n    key: \"getTitle\",\n    value: function value() {\n      return \"Task Details\";\n    }\n  }, {\n    key: \"_getFormItems\",\n    value: function value() {\n      var _this2 = this;\n\n      var readOnly = !this._editingOptions.enabled || !this._editingOptions.allowTaskUpdating;\n      return [{\n        dataField: \"title\",\n        editorType: \"dxTextBox\",\n        label: {\n          text: \"Title\"\n        },\n        editorOptions: {\n          readOnly: readOnly\n        }\n      }, {\n        dataField: \"start\",\n        editorType: \"dxDateBox\",\n        label: {\n          text: \"Start\"\n        },\n        editorOptions: {\n          type: \"datetime\",\n          width: \"100%\",\n          readOnly: readOnly\n        }\n      }, {\n        dataField: \"end\",\n        editorType: \"dxDateBox\",\n        label: {\n          text: \"End\"\n        },\n        editorOptions: {\n          type: \"datetime\",\n          width: \"100%\",\n          readOnly: readOnly\n        }\n      }, {\n        dataField: \"progress\",\n        editorType: \"dxNumberBox\",\n        label: {\n          text: \"Progress\"\n        },\n        editorOptions: {\n          value: this._parameters.progress / 100,\n          showSpinButtons: true,\n          min: 0,\n          max: 1,\n          format: \"#0%\",\n          step: .01,\n          readOnly: readOnly\n        }\n      }, {\n        dataField: \"assigned.items\",\n        editorType: \"dxTagBox\",\n        label: {\n          text: \"Resources\"\n        },\n        editorOptions: {\n          readOnly: readOnly,\n          dataSource: this._parameters.resources.items,\n          displayExpr: \"text\",\n          buttons: [{\n            name: \"editResources\",\n            location: \"after\",\n            options: {\n              text: \"...\",\n              hint: \"Edit Resource List\",\n              onClick: function onClick() {\n                _this2._parameters.showResourcesDialogCommand.execute();\n              }\n            }\n          }]\n        }\n      }];\n    }\n  }, {\n    key: \"_updateParameters\",\n    value: function value(formData) {\n      this._parameters.title = formData.title;\n      this._parameters.start = formData.start;\n      this._parameters.end = formData.end;\n      this._parameters.progress = 100 * formData.progress;\n      this._parameters.assigned = formData.assigned;\n    }\n  }]);\n\n  return TaskEditDialogInfo;\n}(DialogInfoBase);\n\nvar ResourcesEditDialogInfo = function (_DialogInfoBase2) {\n  _inherits(ResourcesEditDialogInfo, _DialogInfoBase2);\n\n  function ResourcesEditDialogInfo() {\n    _classCallCheck(this, ResourcesEditDialogInfo);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(ResourcesEditDialogInfo).apply(this, arguments));\n  }\n\n  _createClass(ResourcesEditDialogInfo, [{\n    key: \"getTitle\",\n    value: function value() {\n      return \"Resources\";\n    }\n  }, {\n    key: \"_getFormItems\",\n    value: function value() {\n      var _this3 = this;\n\n      return [{\n        label: {\n          visible: false\n        },\n        dataField: \"resources.items\",\n        editorType: \"dxList\",\n        editorOptions: {\n          allowItemDeleting: this._editingOptions.enabled && this._editingOptions.allowResourceDeleting,\n          itemDeleteMode: \"static\",\n          selectionMode: \"none\",\n          items: this._parameters.resources.items,\n          height: 250,\n          noDataText: \"No resources\",\n          onInitialized: function onInitialized(e) {\n            _this3.list = e.component;\n          },\n          onItemDeleted: function onItemDeleted(e) {\n            _this3._parameters.resources.remove(e.itemData);\n          }\n        }\n      }, {\n        label: {\n          visible: false\n        },\n        editorType: \"dxTextBox\",\n        editorOptions: {\n          readOnly: !this._editingOptions.enabled || !this._editingOptions.allowResourceAdding,\n          onInitialized: function onInitialized(e) {\n            _this3.textBox = e.component;\n          },\n          onInput: function onInput(e) {\n            var addButton = e.component.getButton(\"addResource\");\n            var resourceName = e.component.option(\"text\");\n            addButton.option(\"disabled\", 0 === resourceName.length);\n          },\n          buttons: [{\n            name: \"addResource\",\n            location: \"after\",\n            options: {\n              text: \"Add\",\n              disabled: true,\n              onClick: function onClick(e) {\n                var newItem = _this3._parameters.resources.createItem();\n\n                newItem.text = _this3.textBox.option(\"text\");\n\n                _this3._parameters.resources.add(newItem);\n\n                _this3.list.option(\"items\", _this3._parameters.resources.items);\n\n                _this3.list.scrollToItem(newItem);\n\n                _this3.textBox.reset();\n\n                e.component.option(\"disabled\", true);\n              }\n            }\n          }]\n        }\n      }];\n    }\n  }]);\n\n  return ResourcesEditDialogInfo;\n}(DialogInfoBase);","map":null,"metadata":{},"sourceType":"script"}