{"ast":null,"code":"/**\r\n * DevExtreme (ui/diagram/ui.diagram.rightpanel.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar _renderer = require(\"../../core/renderer\");\n\nvar _renderer2 = _interopRequireDefault(_renderer);\n\nvar _diagram = require(\"./diagram.panel\");\n\nvar _diagram2 = _interopRequireDefault(_diagram);\n\nvar _accordion = require(\"../accordion\");\n\nvar _accordion2 = _interopRequireDefault(_accordion);\n\nvar _form = require(\"../form\");\n\nvar _form2 = _interopRequireDefault(_form);\n\nvar _uiDiagram = require(\"./ui.diagram.commands\");\n\nvar _uiDiagram2 = _interopRequireDefault(_uiDiagram);\n\nvar _extend = require(\"../../core/utils/extend\");\n\nvar _message = require(\"../../localization/message\");\n\nvar _message2 = _interopRequireDefault(_message);\n\nvar _diagram_bar = require(\"./diagram_bar\");\n\nvar _diagram_bar2 = _interopRequireDefault(_diagram_bar);\n\nvar _scroll_view = require(\"../scroll_view\");\n\nvar _scroll_view2 = _interopRequireDefault(_scroll_view);\n\nvar _deferred = require(\"../../core/utils/deferred\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nfunction _typeof(obj) {\n  if (\"function\" === typeof Symbol && \"symbol\" === typeof Symbol.iterator) {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && \"function\" === typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n\n    if (\"value\" in descriptor) {\n      descriptor.writable = true;\n    }\n\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) {\n    _defineProperties(Constructor.prototype, protoProps);\n  }\n\n  if (staticProps) {\n    _defineProperties(Constructor, staticProps);\n  }\n\n  return Constructor;\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (\"object\" === _typeof(call) || \"function\" === typeof call)) {\n    return call;\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _assertThisInitialized(self) {\n  if (void 0 === self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _get(target, property, receiver) {\n  if (\"undefined\" !== typeof Reflect && Reflect.get) {\n    _get = Reflect.get;\n  } else {\n    _get = function _get(target, property, receiver) {\n      var base = _superPropBase(target, property);\n\n      if (!base) {\n        return;\n      }\n\n      var desc = Object.getOwnPropertyDescriptor(base, property);\n\n      if (desc.get) {\n        return desc.get.call(receiver);\n      }\n\n      return desc.value;\n    };\n  }\n\n  return _get(target, property, receiver || target);\n}\n\nfunction _superPropBase(object, property) {\n  while (!Object.prototype.hasOwnProperty.call(object, property)) {\n    object = _getPrototypeOf(object);\n\n    if (null === object) {\n      break;\n    }\n  }\n\n  return object;\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function (o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nfunction _inherits(subClass, superClass) {\n  if (\"function\" !== typeof superClass && null !== superClass) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n\n  if (superClass) {\n    _setPrototypeOf(subClass, superClass);\n  }\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function (o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nvar DIAGRAM_RIGHT_PANEL_CLASS = \"dx-diagram-right-panel\";\nvar DIAGRAM_RIGHT_PANEL_BEGIN_GROUP_CLASS = \"dx-diagram-right-panel-begin-group\";\n\nvar DiagramRightPanel = function (_DiagramPanel) {\n  _inherits(DiagramRightPanel, _DiagramPanel);\n\n  function DiagramRightPanel() {\n    _classCallCheck(this, DiagramRightPanel);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(DiagramRightPanel).apply(this, arguments));\n  }\n\n  _createClass(DiagramRightPanel, [{\n    key: \"_init\",\n    value: function value() {\n      _get(_getPrototypeOf(DiagramRightPanel.prototype), \"_init\", this).call(this);\n\n      this.bar = new OptionsDiagramBar(this);\n      this._valueConverters = {};\n    }\n  }, {\n    key: \"_initMarkup\",\n    value: function value() {\n      _get(_getPrototypeOf(DiagramRightPanel.prototype), \"_initMarkup\", this).call(this);\n\n      this.$element().addClass(DIAGRAM_RIGHT_PANEL_CLASS);\n      var $scrollViewWrapper = (0, _renderer2.default)(\"<div>\").appendTo(this.$element());\n      this._scrollView = this._createComponent($scrollViewWrapper, _scroll_view2.default);\n      var $accordion = (0, _renderer2.default)(\"<div>\").appendTo(this._scrollView.content());\n\n      this._renderAccordion($accordion);\n    }\n  }, {\n    key: \"_getAccordionDataSource\",\n    value: function value() {\n      return [{\n        title: _message2.default.format(\"dxDiagram-commandProperties\"),\n        onTemplate: function onTemplate(widget, $element) {\n          return widget._renderOptions($element);\n        }\n      }];\n    }\n  }, {\n    key: \"_renderAccordion\",\n    value: function value($container) {\n      var _this = this;\n\n      this._accordionInstance = this._createComponent($container, _accordion2.default, {\n        multiple: true,\n        collapsible: true,\n        displayExpr: \"title\",\n        dataSource: this._getAccordionDataSource(),\n        itemTemplate: function itemTemplate(data, index, $element) {\n          return data.onTemplate(_this, $element);\n        },\n        onContentReady: function onContentReady(e) {\n          _this._updateScrollAnimateSubscription(e.component);\n        }\n      });\n    }\n  }, {\n    key: \"_updateScrollAnimateSubscription\",\n    value: function value(component) {\n      var _this2 = this;\n\n      component._deferredAnimate = new _deferred.Deferred();\n\n      component._deferredAnimate.done(function () {\n        _this2._scrollView.update();\n\n        _this2._updateScrollAnimateSubscription(component);\n      });\n    }\n  }, {\n    key: \"_renderOptions\",\n    value: function value($container) {\n      var _this3 = this;\n\n      var commands = _uiDiagram2.default.getPropertyPanelCommands(this.option(\"propertyGroups\"));\n\n      this._formInstance = this._createComponent($container, _form2.default, {\n        items: commands.map(function (item) {\n          return (0, _extend.extend)(true, {\n            editorType: item.widget,\n            dataField: item.command.toString(),\n            cssClass: item.beginGroup && DIAGRAM_RIGHT_PANEL_BEGIN_GROUP_CLASS,\n            label: {\n              text: item.text\n            },\n            options: {\n              text: item.text,\n              hint: item.hint,\n              icon: item.icon,\n              onInitialized: function onInitialized(e) {\n                return _this3._onToolbarItemInitialized(e.component, item.command);\n              }\n            }\n          }, _this3._createWidgetOptions(item));\n        }),\n        onFieldDataChanged: function onFieldDataChanged(e) {\n          return _this3._onDiagramOptionChanged(e.dataField, e.value);\n        }\n      });\n    }\n  }, {\n    key: \"_createWidgetOptions\",\n    value: function value(item) {\n      if (item.getValue && item.setValue) {\n        this._valueConverters[item.command] = {\n          getValue: item.getValue,\n          setValue: item.setValue\n        };\n      }\n\n      if (\"dxSelectBox\" === item.widget) {\n        return {\n          editorOptions: {\n            dataSource: item.items,\n            displayExpr: \"title\",\n            valueExpr: \"value\"\n          }\n        };\n      }\n    }\n  }, {\n    key: \"_onDiagramOptionChanged\",\n    value: function value(key, _value) {\n      if (!this._updateLocked && void 0 !== _value) {\n        var valueConverter = this._valueConverters[key];\n\n        if (valueConverter) {\n          _value = valueConverter.getValue(_value);\n        }\n\n        this.bar.raiseBarCommandExecuted(parseInt(key), _value);\n      }\n    }\n  }, {\n    key: \"_setItemValue\",\n    value: function value(key, _value2) {\n      var valueConverter = this._valueConverters[key];\n\n      if (valueConverter) {\n        _value2 = valueConverter.setValue(_value2);\n      }\n\n      this._updateLocked = true;\n\n      this._formInstance.updateData(key.toString(), _value2);\n\n      this._updateLocked = false;\n    }\n  }, {\n    key: \"_setItemSubItems\",\n    value: function value(key, items) {\n      this._updateLocked = true;\n\n      var editorInstance = this._formInstance.getEditor(key.toString());\n\n      if (editorInstance) {\n        editorInstance.option(\"items\", items.map(function (item) {\n          var value = \"object\" === _typeof(item.value) ? JSON.stringify(item.value) : item.value;\n          return {\n            value: value,\n            title: item.text\n          };\n        }));\n      }\n\n      this._updateLocked = false;\n    }\n  }, {\n    key: \"_setEnabled\",\n    value: function value(enabled) {\n      this._formInstance.option(\"disabled\", !enabled);\n    }\n  }, {\n    key: \"_setItemEnabled\",\n    value: function value(key, enabled) {\n      var editorInstance = this._formInstance.getEditor(key.toString());\n\n      if (editorInstance) {\n        editorInstance.option(\"disabled\", !enabled);\n      }\n    }\n  }, {\n    key: \"_optionChanged\",\n    value: function value(args) {\n      switch (args.name) {\n        case \"propertyGroups\":\n          this._invalidate();\n\n          break;\n\n        default:\n          _get(_getPrototypeOf(DiagramRightPanel.prototype), \"_optionChanged\", this).call(this, args);\n\n      }\n    }\n  }, {\n    key: \"_getDefaultOptions\",\n    value: function value() {\n      return (0, _extend.extend)(_get(_getPrototypeOf(DiagramRightPanel.prototype), \"_getDefaultOptions\", this).call(this), {\n        container: null\n      });\n    }\n  }]);\n\n  return DiagramRightPanel;\n}(_diagram2.default);\n\nvar OptionsDiagramBar = function (_DiagramBar) {\n  _inherits(OptionsDiagramBar, _DiagramBar);\n\n  function OptionsDiagramBar() {\n    _classCallCheck(this, OptionsDiagramBar);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(OptionsDiagramBar).apply(this, arguments));\n  }\n\n  _createClass(OptionsDiagramBar, [{\n    key: \"getCommandKeys\",\n    value: function value() {\n      return _uiDiagram2.default.getPropertyPanelCommands().map(function (c) {\n        return c.command;\n      });\n    }\n  }, {\n    key: \"setItemValue\",\n    value: function value(key, _value3) {\n      this._owner._setItemValue(key, _value3);\n    }\n  }, {\n    key: \"setEnabled\",\n    value: function value(enabled) {\n      this._owner._setEnabled(enabled);\n    }\n  }, {\n    key: \"setItemEnabled\",\n    value: function value(key, enabled) {\n      this._owner._setItemEnabled(key, enabled);\n    }\n  }, {\n    key: \"setItemSubItems\",\n    value: function value(key, items) {\n      this._owner._setItemSubItems(key, items);\n    }\n  }]);\n\n  return OptionsDiagramBar;\n}(_diagram_bar2.default);\n\nmodule.exports = DiagramRightPanel;","map":null,"metadata":{},"sourceType":"script"}