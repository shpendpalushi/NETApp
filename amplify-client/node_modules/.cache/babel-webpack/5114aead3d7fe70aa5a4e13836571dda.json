{"ast":null,"code":"/**\r\n * DevExtreme (ui/collection/ui.collection_widget.base.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar _renderer = require(\"../../core/renderer\");\n\nvar _renderer2 = _interopRequireDefault(_renderer);\n\nvar _events_engine = require(\"../../events/core/events_engine\");\n\nvar _events_engine2 = _interopRequireDefault(_events_engine);\n\nvar _common = require(\"../../core/utils/common\");\n\nvar _common2 = _interopRequireDefault(_common);\n\nvar _dom = require(\"../../core/utils/dom\");\n\nvar _dom_adapter = require(\"../../core/dom_adapter\");\n\nvar _dom_adapter2 = _interopRequireDefault(_dom_adapter);\n\nvar _type = require(\"../../core/utils/type\");\n\nvar _deferred = require(\"../../core/utils/deferred\");\n\nvar _extend = require(\"../../core/utils/extend\");\n\nvar _array = require(\"../../core/utils/array\");\n\nvar _iterator = require(\"../../core/utils/iterator\");\n\nvar _iterator2 = _interopRequireDefault(_iterator);\n\nvar _action = require(\"../../core/action\");\n\nvar _action2 = _interopRequireDefault(_action);\n\nvar _guid = require(\"../../core/guid\");\n\nvar _guid2 = _interopRequireDefault(_guid);\n\nvar _ui = require(\"../widget/ui.widget\");\n\nvar _ui2 = _interopRequireDefault(_ui);\n\nvar _utils = require(\"../../events/utils\");\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nvar _pointer = require(\"../../events/pointer\");\n\nvar _pointer2 = _interopRequireDefault(_pointer);\n\nvar _data_helper = require(\"../../data_helper\");\n\nvar _data_helper2 = _interopRequireDefault(_data_helper);\n\nvar _item = require(\"./item\");\n\nvar _item2 = _interopRequireDefault(_item);\n\nvar _selectors = require(\"../widget/selectors\");\n\nvar _selectors2 = _interopRequireDefault(_selectors);\n\nvar _message = require(\"../../localization/message\");\n\nvar _message2 = _interopRequireDefault(_message);\n\nvar _hold = require(\"../../events/hold\");\n\nvar _hold2 = _interopRequireDefault(_hold);\n\nvar _data = require(\"../../core/utils/data\");\n\nvar _click = require(\"../../events/click\");\n\nvar _click2 = _interopRequireDefault(_click);\n\nvar _contextmenu = require(\"../../events/contextmenu\");\n\nvar _contextmenu2 = _interopRequireDefault(_contextmenu);\n\nvar _bindable_template = require(\"../../core/templates/bindable_template\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nvar COLLECTION_CLASS = \"dx-collection\";\nvar ITEM_CLASS = \"dx-item\";\nvar CONTENT_CLASS_POSTFIX = \"-content\";\nvar ITEM_CONTENT_PLACEHOLDER_CLASS = \"dx-item-content-placeholder\";\nvar ITEM_DATA_KEY = \"dxItemData\";\nvar ITEM_INDEX_KEY = \"dxItemIndex\";\nvar ITEM_TEMPLATE_ID_PREFIX = \"tmpl-\";\nvar ITEMS_SELECTOR = \"[data-options*='dxItem']\";\nvar SELECTED_ITEM_CLASS = \"dx-item-selected\";\nvar ITEM_RESPONSE_WAIT_CLASS = \"dx-item-response-wait\";\nvar EMPTY_COLLECTION = \"dx-empty-collection\";\nvar TEMPLATE_WRAPPER_CLASS = \"dx-template-wrapper\";\nvar ITEM_PATH_REGEX = /^([^.]+\\[\\d+\\]\\.)+([\\w.]+)$/;\nvar FOCUS_UP = \"up\";\nvar FOCUS_DOWN = \"down\";\nvar FOCUS_LEFT = \"left\";\nvar FOCUS_RIGHT = \"right\";\nvar FOCUS_PAGE_UP = \"pageup\";\nvar FOCUS_PAGE_DOWN = \"pagedown\";\nvar FOCUS_LAST = \"last\";\nvar FOCUS_FIRST = \"first\";\n\nvar CollectionWidget = _ui2.default.inherit({\n  _activeStateUnit: \".\" + ITEM_CLASS,\n  _supportedKeys: function _supportedKeys() {\n    var enter = function enter(e) {\n      var $itemElement = (0, _renderer2.default)(this.option(\"focusedElement\"));\n\n      if (!$itemElement.length) {\n        return;\n      }\n\n      this._itemClickHandler((0, _extend.extend)({}, e, {\n        target: $itemElement,\n        currentTarget: $itemElement\n      }));\n    };\n\n    var space = function space(e) {\n      e.preventDefault();\n      enter.call(this, e);\n    };\n\n    var move = function move(location, e) {\n      e.preventDefault();\n      e.stopPropagation();\n\n      this._moveFocus(location, e);\n    };\n\n    return (0, _extend.extend)(this.callBase(), {\n      space: space,\n      enter: enter,\n      leftArrow: move.bind(this, FOCUS_LEFT),\n      rightArrow: move.bind(this, FOCUS_RIGHT),\n      upArrow: move.bind(this, FOCUS_UP),\n      downArrow: move.bind(this, FOCUS_DOWN),\n      pageUp: move.bind(this, FOCUS_UP),\n      pageDown: move.bind(this, FOCUS_DOWN),\n      home: move.bind(this, FOCUS_FIRST),\n      end: move.bind(this, FOCUS_LAST)\n    });\n  },\n  _getDefaultOptions: function _getDefaultOptions() {\n    return (0, _extend.extend)(this.callBase(), {\n      selectOnFocus: false,\n      loopItemFocus: true,\n      items: [],\n      itemTemplate: \"item\",\n      onItemRendered: null,\n      onItemClick: null,\n      onItemHold: null,\n      itemHoldTimeout: 750,\n      onItemContextMenu: null,\n      onFocusedItemChanged: null,\n      noDataText: _message2.default.format(\"dxCollectionWidget-noDataText\"),\n      dataSource: null,\n      _itemAttributes: {},\n      itemTemplateProperty: \"template\",\n      focusOnSelectedItem: true,\n      focusedElement: null,\n      displayExpr: void 0,\n      disabledExpr: function disabledExpr(data) {\n        return data ? data.disabled : void 0;\n      },\n      visibleExpr: function visibleExpr(data) {\n        return data ? data.visible : void 0;\n      }\n    });\n  },\n  _getAnonymousTemplateName: function _getAnonymousTemplateName() {\n    return \"item\";\n  },\n  _init: function _init() {\n    this._compileDisplayGetter();\n\n    this.callBase();\n\n    this._cleanRenderedItems();\n\n    this._refreshDataSource();\n  },\n  _compileDisplayGetter: function _compileDisplayGetter() {\n    var displayExpr = this.option(\"displayExpr\");\n    this._displayGetter = displayExpr ? (0, _data.compileGetter)(this.option(\"displayExpr\")) : void 0;\n  },\n  _initTemplates: function _initTemplates() {\n    this._initItemsFromMarkup();\n\n    this.callBase();\n\n    this._initDefaultItemTemplate();\n  },\n  _initDefaultItemTemplate: function _initDefaultItemTemplate() {\n    var fieldsMap = this._getFieldsMap();\n\n    this._defaultTemplates.item = new _bindable_template.BindableTemplate(function ($container, data) {\n      if ((0, _type.isPlainObject)(data)) {\n        this._prepareDefaultItemTemplate(data, $container);\n      } else {\n        if (fieldsMap && (0, _type.isFunction)(fieldsMap.text)) {\n          data = fieldsMap.text(data);\n        }\n\n        $container.text(String(_common2.default.ensureDefined(data, \"\")));\n      }\n    }.bind(this), this._getBindableFields(), this.option(\"integrationOptions.watchMethod\"), fieldsMap);\n  },\n  _getBindableFields: function _getBindableFields() {\n    return [\"text\", \"html\"];\n  },\n  _getFieldsMap: function _getFieldsMap() {\n    if (this._displayGetter) {\n      return {\n        text: this._displayGetter\n      };\n    }\n  },\n  _prepareDefaultItemTemplate: function _prepareDefaultItemTemplate(data, $container) {\n    if ((0, _type.isDefined)(data.text)) {\n      $container.text(data.text);\n    }\n\n    if ((0, _type.isDefined)(data.html)) {\n      $container.html(data.html);\n    }\n  },\n  _initItemsFromMarkup: function _initItemsFromMarkup() {\n    var _this = this;\n\n    var $items = this.$element().contents().filter(ITEMS_SELECTOR);\n\n    if (!$items.length || this.option(\"items\").length) {\n      return;\n    }\n\n    var items = [].slice.call($items).map(function (item) {\n      var $item = (0, _renderer2.default)(item);\n      var result = (0, _dom.getElementOptions)(item).dxItem;\n      var isTemplateRequired = $item.html().trim() && !result.template;\n\n      if (isTemplateRequired) {\n        result.template = _this._prepareItemTemplate($item);\n      } else {\n        $item.remove();\n      }\n\n      return result;\n    });\n    this.option(\"items\", items);\n  },\n  _prepareItemTemplate: function _prepareItemTemplate($item) {\n    var templateId = ITEM_TEMPLATE_ID_PREFIX + new _guid2.default();\n    var $template = $item.detach().clone().removeAttr(\"data-options\").addClass(TEMPLATE_WRAPPER_CLASS);\n\n    this._saveTemplate(templateId, $template);\n\n    return templateId;\n  },\n  _dataSourceOptions: function _dataSourceOptions() {\n    return {\n      paginate: false\n    };\n  },\n  _cleanRenderedItems: function _cleanRenderedItems() {\n    this._renderedItemsCount = 0;\n  },\n  _focusTarget: function _focusTarget() {\n    return this.$element();\n  },\n  _focusInHandler: function _focusInHandler(e) {\n    this.callBase.apply(this, arguments);\n\n    if ((0, _array.inArray)(e.target, this._focusTarget()) === -1) {\n      return;\n    }\n\n    var $focusedElement = (0, _renderer2.default)(this.option(\"focusedElement\"));\n\n    if ($focusedElement.length) {\n      this._setFocusedItem($focusedElement);\n    } else {\n      var $activeItem = this._getActiveItem();\n\n      if ($activeItem.length) {\n        this.option(\"focusedElement\", (0, _dom.getPublicElement)($activeItem));\n      }\n    }\n  },\n  _focusOutHandler: function _focusOutHandler() {\n    this.callBase.apply(this, arguments);\n    var $target = (0, _renderer2.default)(this.option(\"focusedElement\"));\n\n    this._updateFocusedItemState($target, false);\n  },\n  _getActiveItem: function _getActiveItem(last) {\n    var $focusedElement = (0, _renderer2.default)(this.option(\"focusedElement\"));\n\n    if ($focusedElement.length) {\n      return $focusedElement;\n    }\n\n    var index = this.option(\"focusOnSelectedItem\") ? this.option(\"selectedIndex\") : 0;\n\n    var activeElements = this._getActiveElement();\n\n    var lastIndex = activeElements.length - 1;\n\n    if (index < 0) {\n      index = last ? lastIndex : 0;\n    }\n\n    return activeElements.eq(index);\n  },\n  _moveFocus: function _moveFocus(location) {\n    var $items = this._getAvailableItems();\n\n    var $newTarget;\n\n    switch (location) {\n      case FOCUS_PAGE_UP:\n      case FOCUS_UP:\n        $newTarget = this._prevItem($items);\n        break;\n\n      case FOCUS_PAGE_DOWN:\n      case FOCUS_DOWN:\n        $newTarget = this._nextItem($items);\n        break;\n\n      case FOCUS_RIGHT:\n        $newTarget = this.option(\"rtlEnabled\") ? this._prevItem($items) : this._nextItem($items);\n        break;\n\n      case FOCUS_LEFT:\n        $newTarget = this.option(\"rtlEnabled\") ? this._nextItem($items) : this._prevItem($items);\n        break;\n\n      case FOCUS_FIRST:\n        $newTarget = $items.first();\n        break;\n\n      case FOCUS_LAST:\n        $newTarget = $items.last();\n        break;\n\n      default:\n        return false;\n    }\n\n    if (0 !== $newTarget.length) {\n      this.option(\"focusedElement\", (0, _dom.getPublicElement)($newTarget));\n    }\n  },\n  _getVisibleItems: function _getVisibleItems($itemElements) {\n    $itemElements = $itemElements || this._itemElements();\n    return $itemElements.filter(\":visible\");\n  },\n  _getAvailableItems: function _getAvailableItems($itemElements) {\n    return this._getVisibleItems($itemElements).not(\".dx-state-disabled\");\n  },\n  _prevItem: function _prevItem($items) {\n    var $target = this._getActiveItem();\n\n    var targetIndex = $items.index($target);\n    var $last = $items.last();\n    var $item = (0, _renderer2.default)($items[targetIndex - 1]);\n    var loop = this.option(\"loopItemFocus\");\n\n    if (0 === $item.length && loop) {\n      $item = $last;\n    }\n\n    return $item;\n  },\n  _nextItem: function _nextItem($items) {\n    var $target = this._getActiveItem(true);\n\n    var targetIndex = $items.index($target);\n    var $first = $items.first();\n    var $item = (0, _renderer2.default)($items[targetIndex + 1]);\n    var loop = this.option(\"loopItemFocus\");\n\n    if (0 === $item.length && loop) {\n      $item = $first;\n    }\n\n    return $item;\n  },\n  _selectFocusedItem: function _selectFocusedItem($target) {\n    this.selectItem($target);\n  },\n  _updateFocusedItemState: function _updateFocusedItemState(target, isFocused, needCleanItemId) {\n    var $target = (0, _renderer2.default)(target);\n\n    if ($target.length) {\n      this._refreshActiveDescendant();\n\n      this._refreshItemId($target, needCleanItemId);\n\n      this._toggleFocusClass(isFocused, $target);\n    }\n  },\n  _refreshActiveDescendant: function _refreshActiveDescendant($target) {\n    this.setAria(\"activedescendant\", (0, _type.isDefined)(this.option(\"focusedElement\")) ? this.getFocusedItemId() : null, $target);\n  },\n  _refreshItemId: function _refreshItemId($target, needCleanItemId) {\n    if (!needCleanItemId && this.option(\"focusedElement\")) {\n      this.setAria(\"id\", this.getFocusedItemId(), $target);\n    } else {\n      this.setAria(\"id\", null, $target);\n    }\n  },\n  _setFocusedItem: function _setFocusedItem($target) {\n    if (!$target || !$target.length) {\n      return;\n    }\n\n    this._updateFocusedItemState($target, true);\n\n    this.onFocusedItemChanged(this.getFocusedItemId());\n\n    if (this.option(\"selectOnFocus\")) {\n      this._selectFocusedItem($target);\n    }\n  },\n  _findItemElementByItem: function _findItemElementByItem(item) {\n    var result = (0, _renderer2.default)();\n    var that = this;\n    this.itemElements().each(function () {\n      var $item = (0, _renderer2.default)(this);\n\n      if ($item.data(that._itemDataKey()) === item) {\n        result = $item;\n        return false;\n      }\n    });\n    return result;\n  },\n  _getIndexByItem: function _getIndexByItem(item) {\n    return this.option(\"items\").indexOf(item);\n  },\n  _itemOptionChanged: function _itemOptionChanged(item, property, value, oldValue) {\n    var $item = this._findItemElementByItem(item);\n\n    if (!$item.length) {\n      return;\n    }\n\n    if (!this.constructor.ItemClass.getInstance($item).setDataField(property, value)) {\n      this._refreshItem($item, item);\n    }\n\n    var isDisabling = \"disabled\" === property && value;\n\n    if (isDisabling) {\n      this._resetItemFocus($item);\n    }\n  },\n  _resetItemFocus: function _resetItemFocus($item) {\n    if ($item.is(this.option(\"focusedElement\"))) {\n      this.option(\"focusedElement\", null);\n    }\n  },\n  _refreshItem: function _refreshItem($item) {\n    var itemData = this._getItemData($item);\n\n    var index = $item.data(this._itemIndexKey());\n\n    this._renderItem(this._renderedItemsCount + index, itemData, null, $item);\n  },\n  _optionChanged: function _optionChanged(args) {\n    if (\"items\" === args.name) {\n      var matches = args.fullName.match(ITEM_PATH_REGEX);\n\n      if (matches && matches.length) {\n        var property = matches[matches.length - 1];\n        var itemPath = args.fullName.replace(\".\" + property, \"\");\n        var item = this.option(itemPath);\n\n        this._itemOptionChanged(item, property, args.value, args.previousValue);\n\n        return;\n      }\n    }\n\n    switch (args.name) {\n      case \"items\":\n      case \"_itemAttributes\":\n      case \"itemTemplateProperty\":\n      case \"showItemDataTitle\":\n        this._cleanRenderedItems();\n\n        this._invalidate();\n\n        break;\n\n      case \"dataSource\":\n        this._refreshDataSource();\n\n        this._renderEmptyMessage();\n\n        break;\n\n      case \"noDataText\":\n        this._renderEmptyMessage();\n\n        break;\n\n      case \"itemTemplate\":\n        this._invalidate();\n\n        break;\n\n      case \"onItemRendered\":\n        this._createItemRenderAction();\n\n        break;\n\n      case \"onItemClick\":\n        break;\n\n      case \"onItemHold\":\n      case \"itemHoldTimeout\":\n        this._attachHoldEvent();\n\n        break;\n\n      case \"onItemContextMenu\":\n        this._attachContextMenuEvent();\n\n        break;\n\n      case \"onFocusedItemChanged\":\n        this.onFocusedItemChanged = this._createActionByOption(\"onFocusedItemChanged\");\n        break;\n\n      case \"selectOnFocus\":\n      case \"loopItemFocus\":\n      case \"focusOnSelectedItem\":\n        break;\n\n      case \"focusedElement\":\n        this._updateFocusedItemState(args.previousValue, false, true);\n\n        this._setFocusedItem((0, _renderer2.default)(args.value));\n\n        break;\n\n      case \"displayExpr\":\n        this._compileDisplayGetter();\n\n        this._initDefaultItemTemplate();\n\n        this._invalidate();\n\n        break;\n\n      case \"visibleExpr\":\n      case \"disabledExpr\":\n        this._invalidate();\n\n        break;\n\n      default:\n        this.callBase(args);\n    }\n  },\n  _invalidate: function _invalidate() {\n    this.option(\"focusedElement\", null);\n    return this.callBase.apply(this, arguments);\n  },\n  _loadNextPage: function _loadNextPage() {\n    var dataSource = this._dataSource;\n\n    this._expectNextPageLoading();\n\n    dataSource.pageIndex(1 + dataSource.pageIndex());\n    return dataSource.load();\n  },\n  _expectNextPageLoading: function _expectNextPageLoading() {\n    this._startIndexForAppendedItems = 0;\n  },\n  _expectLastItemLoading: function _expectLastItemLoading() {\n    this._startIndexForAppendedItems = -1;\n  },\n  _forgetNextPageLoading: function _forgetNextPageLoading() {\n    this._startIndexForAppendedItems = null;\n  },\n  _dataSourceChangedHandler: function _dataSourceChangedHandler(newItems) {\n    var items = this.option(\"items\");\n\n    if (this._initialized && items && this._shouldAppendItems()) {\n      this._renderedItemsCount = items.length;\n\n      if (!this._isLastPage() || this._startIndexForAppendedItems !== -1) {\n        this.option().items = items.concat(newItems.slice(this._startIndexForAppendedItems));\n      }\n\n      this._forgetNextPageLoading();\n\n      this._refreshContent();\n    } else {\n      this.option(\"items\", newItems.slice());\n    }\n  },\n  _refreshContent: function _refreshContent() {\n    this._prepareContent();\n\n    this._renderContent();\n  },\n  _dataSourceLoadErrorHandler: function _dataSourceLoadErrorHandler() {\n    this._forgetNextPageLoading();\n\n    this.option(\"items\", this.option(\"items\"));\n  },\n  _shouldAppendItems: function _shouldAppendItems() {\n    return null != this._startIndexForAppendedItems && this._allowDynamicItemsAppend();\n  },\n  _allowDynamicItemsAppend: function _allowDynamicItemsAppend() {\n    return false;\n  },\n  _clean: function _clean() {\n    this._cleanFocusState();\n\n    this._cleanItemContainer();\n  },\n  _cleanItemContainer: function _cleanItemContainer() {\n    (0, _renderer2.default)(this._itemContainer()).empty();\n  },\n  _dispose: function _dispose() {\n    this.callBase();\n    clearTimeout(this._itemFocusTimeout);\n  },\n  _refresh: function _refresh() {\n    this._cleanRenderedItems();\n\n    this.callBase.apply(this, arguments);\n  },\n  _itemContainer: function _itemContainer() {\n    return this.$element();\n  },\n  _itemClass: function _itemClass() {\n    return ITEM_CLASS;\n  },\n  _itemContentClass: function _itemContentClass() {\n    return this._itemClass() + CONTENT_CLASS_POSTFIX;\n  },\n  _selectedItemClass: function _selectedItemClass() {\n    return SELECTED_ITEM_CLASS;\n  },\n  _itemResponseWaitClass: function _itemResponseWaitClass() {\n    return ITEM_RESPONSE_WAIT_CLASS;\n  },\n  _itemSelector: function _itemSelector() {\n    return \".\" + this._itemClass();\n  },\n  _itemDataKey: function _itemDataKey() {\n    return ITEM_DATA_KEY;\n  },\n  _itemIndexKey: function _itemIndexKey() {\n    return ITEM_INDEX_KEY;\n  },\n  _itemElements: function _itemElements() {\n    return this._itemContainer().find(this._itemSelector());\n  },\n  _initMarkup: function _initMarkup() {\n    this.callBase();\n    this.onFocusedItemChanged = this._createActionByOption(\"onFocusedItemChanged\");\n    this.$element().addClass(COLLECTION_CLASS);\n\n    this._prepareContent();\n  },\n  _prepareContent: _common2.default.deferRenderer(function () {\n    this._renderContentImpl();\n  }),\n  _renderContent: function _renderContent() {\n    this._fireContentReadyAction();\n  },\n  _render: function _render() {\n    this.callBase();\n\n    this._attachClickEvent();\n\n    this._attachHoldEvent();\n\n    this._attachContextMenuEvent();\n  },\n  _attachClickEvent: function _attachClickEvent() {\n    var itemSelector = this._itemSelector();\n\n    var clickEventNamespace = _utils2.default.addNamespace(_click2.default.name, this.NAME);\n\n    var pointerDownEventNamespace = _utils2.default.addNamespace(_pointer2.default.down, this.NAME);\n\n    var that = this;\n    var pointerDownAction = new _action2.default(function (args) {\n      var event = args.event;\n\n      that._itemPointerDownHandler(event);\n    });\n\n    _events_engine2.default.off(this._itemContainer(), clickEventNamespace, itemSelector);\n\n    _events_engine2.default.off(this._itemContainer(), pointerDownEventNamespace, itemSelector);\n\n    _events_engine2.default.on(this._itemContainer(), clickEventNamespace, itemSelector, function (e) {\n      this._itemClickHandler(e);\n    }.bind(this));\n\n    _events_engine2.default.on(this._itemContainer(), pointerDownEventNamespace, itemSelector, function (e) {\n      pointerDownAction.execute({\n        element: (0, _renderer2.default)(e.target),\n        event: e\n      });\n    });\n  },\n  _itemClickHandler: function _itemClickHandler(e, args, config) {\n    this._itemDXEventHandler(e, \"onItemClick\", args, config);\n  },\n  _itemPointerDownHandler: function _itemPointerDownHandler(e) {\n    if (!this.option(\"focusStateEnabled\")) {\n      return;\n    }\n\n    this._itemFocusHandler = function () {\n      clearTimeout(this._itemFocusTimeout);\n      this._itemFocusHandler = null;\n\n      if (e.isDefaultPrevented()) {\n        return;\n      }\n\n      var $target = (0, _renderer2.default)(e.target);\n      var $closestItem = $target.closest(this._itemElements());\n\n      var $closestFocusable = this._closestFocusable($target);\n\n      if ($closestItem.length && $closestFocusable && (0, _array.inArray)($closestFocusable.get(0), this._focusTarget()) !== -1) {\n        this.option(\"focusedElement\", (0, _dom.getPublicElement)($closestItem));\n      }\n    }.bind(this);\n\n    this._itemFocusTimeout = setTimeout(this._forcePointerDownFocus.bind(this));\n  },\n  _closestFocusable: function _closestFocusable($target) {\n    if ($target.is(_selectors2.default.focusable)) {\n      return $target;\n    } else {\n      $target = $target.parent();\n\n      while ($target.length && !_dom_adapter2.default.isDocument($target.get(0))) {\n        if ($target.is(_selectors2.default.focusable)) {\n          return $target;\n        }\n\n        $target = $target.parent();\n      }\n    }\n  },\n  _forcePointerDownFocus: function _forcePointerDownFocus() {\n    this._itemFocusHandler && this._itemFocusHandler();\n  },\n  _updateFocusState: function _updateFocusState() {\n    this.callBase.apply(this, arguments);\n\n    this._forcePointerDownFocus();\n  },\n  _attachHoldEvent: function _attachHoldEvent() {\n    var $itemContainer = this._itemContainer();\n\n    var itemSelector = this._itemSelector();\n\n    var eventName = _utils2.default.addNamespace(_hold2.default.name, this.NAME);\n\n    _events_engine2.default.off($itemContainer, eventName, itemSelector);\n\n    _events_engine2.default.on($itemContainer, eventName, itemSelector, {\n      timeout: this._getHoldTimeout()\n    }, this._itemHoldHandler.bind(this));\n  },\n  _getHoldTimeout: function _getHoldTimeout() {\n    return this.option(\"itemHoldTimeout\");\n  },\n  _shouldFireHoldEvent: function _shouldFireHoldEvent() {\n    return this.hasActionSubscription(\"onItemHold\");\n  },\n  _itemHoldHandler: function _itemHoldHandler(e) {\n    if (this._shouldFireHoldEvent()) {\n      this._itemDXEventHandler(e, \"onItemHold\");\n    } else {\n      e.cancel = true;\n    }\n  },\n  _attachContextMenuEvent: function _attachContextMenuEvent() {\n    var $itemContainer = this._itemContainer();\n\n    var itemSelector = this._itemSelector();\n\n    var eventName = _utils2.default.addNamespace(_contextmenu2.default.name, this.NAME);\n\n    _events_engine2.default.off($itemContainer, eventName, itemSelector);\n\n    _events_engine2.default.on($itemContainer, eventName, itemSelector, this._itemContextMenuHandler.bind(this));\n  },\n  _shouldFireContextMenuEvent: function _shouldFireContextMenuEvent() {\n    return this.hasActionSubscription(\"onItemContextMenu\");\n  },\n  _itemContextMenuHandler: function _itemContextMenuHandler(e) {\n    if (this._shouldFireContextMenuEvent()) {\n      this._itemDXEventHandler(e, \"onItemContextMenu\");\n    } else {\n      e.cancel = true;\n    }\n  },\n  _renderContentImpl: function _renderContentImpl() {\n    var items = this.option(\"items\") || [];\n\n    if (this._renderedItemsCount) {\n      this._renderItems(items.slice(this._renderedItemsCount));\n    } else {\n      this._renderItems(items);\n    }\n  },\n  _renderItems: function _renderItems(items) {\n    if (items.length) {\n      _iterator2.default.each(items, function (index, itemData) {\n        this._renderItem(this._renderedItemsCount + index, itemData);\n      }.bind(this));\n    }\n\n    this._renderEmptyMessage();\n  },\n  _renderItem: function _renderItem(index, itemData, $container, $itemToReplace) {\n    $container = $container || this._itemContainer();\n\n    var $itemFrame = this._renderItemFrame(index, itemData, $container, $itemToReplace);\n\n    this._setElementData($itemFrame, itemData, index);\n\n    $itemFrame.attr(this.option(\"_itemAttributes\"));\n\n    this._attachItemClickEvent(itemData, $itemFrame);\n\n    var $itemContent = this._getItemContent($itemFrame);\n\n    var renderContentPromise = this._renderItemContent({\n      index: index,\n      itemData: itemData,\n      container: (0, _dom.getPublicElement)($itemContent),\n      contentClass: this._itemContentClass(),\n      defaultTemplateName: this.option(\"itemTemplate\")\n    });\n\n    var that = this;\n    (0, _deferred.when)(renderContentPromise).done(function ($itemContent) {\n      that._postprocessRenderItem({\n        itemElement: $itemFrame,\n        itemContent: $itemContent,\n        itemData: itemData,\n        itemIndex: index\n      });\n\n      that._executeItemRenderAction(index, itemData, (0, _dom.getPublicElement)($itemFrame));\n    });\n    return $itemFrame;\n  },\n  _getItemContent: function _getItemContent($itemFrame) {\n    var $itemContent = $itemFrame.find(\".\" + ITEM_CONTENT_PLACEHOLDER_CLASS);\n    $itemContent.removeClass(ITEM_CONTENT_PLACEHOLDER_CLASS);\n    return $itemContent;\n  },\n  _attachItemClickEvent: function _attachItemClickEvent(itemData, $itemElement) {\n    if (!itemData || !itemData.onClick) {\n      return;\n    }\n\n    _events_engine2.default.on($itemElement, _click2.default.name, function (e) {\n      this._itemEventHandlerByHandler($itemElement, itemData.onClick, {\n        event: e\n      });\n    }.bind(this));\n  },\n  _renderItemContent: function _renderItemContent(args) {\n    var itemTemplateName = this._getItemTemplateName(args);\n\n    var itemTemplate = this._getTemplate(itemTemplateName);\n\n    this._addItemContentClasses(args);\n\n    var $templateResult = (0, _renderer2.default)(this._createItemByTemplate(itemTemplate, args));\n\n    if (!$templateResult.hasClass(TEMPLATE_WRAPPER_CLASS)) {\n      return args.container;\n    }\n\n    return this._renderItemContentByNode(args, $templateResult);\n  },\n  _renderItemContentByNode: function _renderItemContentByNode(args, $node) {\n    (0, _renderer2.default)(args.container).replaceWith($node);\n    args.container = (0, _dom.getPublicElement)($node);\n\n    this._addItemContentClasses(args);\n\n    return $node;\n  },\n  _addItemContentClasses: function _addItemContentClasses(args) {\n    var classes = [ITEM_CLASS + CONTENT_CLASS_POSTFIX, args.contentClass];\n    (0, _renderer2.default)(args.container).addClass(classes.join(\" \"));\n  },\n  _appendItemToContainer: function _appendItemToContainer($container, $itemFrame, index) {\n    $itemFrame.appendTo($container);\n  },\n  _renderItemFrame: function _renderItemFrame(index, itemData, $container, $itemToReplace) {\n    var $itemFrame = (0, _renderer2.default)(\"<div>\");\n    new this.constructor.ItemClass($itemFrame, this._itemOptions(), itemData || {});\n\n    if ($itemToReplace && $itemToReplace.length) {\n      $itemToReplace.replaceWith($itemFrame);\n    } else {\n      this._appendItemToContainer.call(this, $container, $itemFrame, index);\n    }\n\n    if (this.option(\"showItemDataTitle\")) {\n      var displayValue = this._displayGetter ? this._displayGetter(itemData) : itemData;\n      $itemFrame.attr(\"title\", displayValue);\n    }\n\n    return $itemFrame;\n  },\n  _itemOptions: function _itemOptions() {\n    var that = this;\n    return {\n      watchMethod: function watchMethod() {\n        return that.option(\"integrationOptions.watchMethod\");\n      },\n      owner: that,\n      fieldGetter: function fieldGetter(field) {\n        var expr = that.option(field + \"Expr\");\n        var getter = (0, _data.compileGetter)(expr);\n        return getter;\n      }\n    };\n  },\n  _postprocessRenderItem: _common2.default.noop,\n  _executeItemRenderAction: function _executeItemRenderAction(index, itemData, itemElement) {\n    this._getItemRenderAction()({\n      itemElement: itemElement,\n      itemIndex: index,\n      itemData: itemData\n    });\n  },\n  _setElementData: function _setElementData(element, data, index) {\n    element.addClass([ITEM_CLASS, this._itemClass()].join(\" \")).data(this._itemDataKey(), data).data(this._itemIndexKey(), index);\n  },\n  _createItemRenderAction: function _createItemRenderAction() {\n    return this._itemRenderAction = this._createActionByOption(\"onItemRendered\", {\n      element: this.element(),\n      excludeValidators: [\"disabled\", \"readOnly\"],\n      category: \"rendering\"\n    });\n  },\n  _getItemRenderAction: function _getItemRenderAction() {\n    return this._itemRenderAction || this._createItemRenderAction();\n  },\n  _getItemTemplateName: function _getItemTemplateName(args) {\n    var data = args.itemData;\n    var templateProperty = args.templateProperty || this.option(\"itemTemplateProperty\");\n    var template = data && data[templateProperty];\n    return template || args.defaultTemplateName;\n  },\n  _createItemByTemplate: function _createItemByTemplate(itemTemplate, renderArgs) {\n    return itemTemplate.render({\n      model: renderArgs.itemData,\n      container: renderArgs.container,\n      index: renderArgs.index\n    });\n  },\n  _emptyMessageContainer: function _emptyMessageContainer() {\n    return this._itemContainer();\n  },\n  _renderEmptyMessage: function _renderEmptyMessage(items) {\n    items = items || this.option(\"items\");\n    var noDataText = this.option(\"noDataText\");\n\n    var hideNoData = !noDataText || items && items.length || this._isDataSourceLoading();\n\n    if (hideNoData && this._$noData) {\n      this._$noData.remove();\n\n      this._$noData = null;\n      this.setAria(\"label\", void 0);\n    }\n\n    if (!hideNoData) {\n      this._$noData = this._$noData || (0, _renderer2.default)(\"<div>\").addClass(\"dx-empty-message\");\n\n      this._$noData.appendTo(this._emptyMessageContainer()).html(noDataText);\n\n      this.setAria(\"label\", noDataText);\n    }\n\n    this.$element().toggleClass(EMPTY_COLLECTION, !hideNoData);\n  },\n  _itemDXEventHandler: function _itemDXEventHandler(dxEvent, handlerOptionName, actionArgs, actionConfig) {\n    this._itemEventHandler(dxEvent.target, handlerOptionName, (0, _extend.extend)(actionArgs, {\n      event: dxEvent\n    }), actionConfig);\n  },\n  _itemEventHandler: function _itemEventHandler(initiator, handlerOptionName, actionArgs, actionConfig) {\n    var action = this._createActionByOption(handlerOptionName, (0, _extend.extend)({\n      validatingTargetName: \"itemElement\"\n    }, actionConfig));\n\n    return this._itemEventHandlerImpl(initiator, action, actionArgs);\n  },\n  _itemEventHandlerByHandler: function _itemEventHandlerByHandler(initiator, handler, actionArgs, actionConfig) {\n    var action = this._createAction(handler, (0, _extend.extend)({\n      validatingTargetName: \"itemElement\"\n    }, actionConfig));\n\n    return this._itemEventHandlerImpl(initiator, action, actionArgs);\n  },\n  _itemEventHandlerImpl: function _itemEventHandlerImpl(initiator, action, actionArgs) {\n    var $itemElement = this._closestItemElement((0, _renderer2.default)(initiator));\n\n    var args = (0, _extend.extend)({}, actionArgs);\n    return action((0, _extend.extend)(actionArgs, this._extendActionArgs($itemElement), args));\n  },\n  _extendActionArgs: function _extendActionArgs($itemElement) {\n    return {\n      itemElement: (0, _dom.getPublicElement)($itemElement),\n      itemIndex: this._itemElements().index($itemElement),\n      itemData: this._getItemData($itemElement)\n    };\n  },\n  _closestItemElement: function _closestItemElement($element) {\n    return (0, _renderer2.default)($element).closest(this._itemSelector());\n  },\n  _getItemData: function _getItemData(itemElement) {\n    return (0, _renderer2.default)(itemElement).data(this._itemDataKey());\n  },\n  _getSummaryItemsWidth: function _getSummaryItemsWidth(items, includeMargin) {\n    var result = 0;\n\n    if (items) {\n      _iterator2.default.each(items, function (_, item) {\n        result += (0, _renderer2.default)(item).outerWidth(includeMargin || false);\n      });\n    }\n\n    return result;\n  },\n  getFocusedItemId: function getFocusedItemId() {\n    if (!this._focusedItemId) {\n      this._focusedItemId = \"dx-\" + new _guid2.default();\n    }\n\n    return this._focusedItemId;\n  },\n  itemElements: function itemElements() {\n    return this._itemElements();\n  },\n  itemsContainer: function itemsContainer() {\n    return this._itemContainer();\n  }\n}).include(_data_helper2.default);\n\nCollectionWidget.ItemClass = _item2.default;\nmodule.exports = CollectionWidget;","map":{"version":3,"sources":["C:/Users/User/Documents/Templates/Angular/black-dashboard-pro-angular-v1.1.1/black-dashboard-pro-angular-v1.1.1/node_modules/devextreme/ui/collection/ui.collection_widget.base.js"],"names":["_renderer","require","_renderer2","_interopRequireDefault","_events_engine","_events_engine2","_common","_common2","_dom","_dom_adapter","_dom_adapter2","_type","_deferred","_extend","_array","_iterator","_iterator2","_action","_action2","_guid","_guid2","_ui","_ui2","_utils","_utils2","_pointer","_pointer2","_data_helper","_data_helper2","_item","_item2","_selectors","_selectors2","_message","_message2","_hold","_hold2","_data","_click","_click2","_contextmenu","_contextmenu2","_bindable_template","obj","__esModule","COLLECTION_CLASS","ITEM_CLASS","CONTENT_CLASS_POSTFIX","ITEM_CONTENT_PLACEHOLDER_CLASS","ITEM_DATA_KEY","ITEM_INDEX_KEY","ITEM_TEMPLATE_ID_PREFIX","ITEMS_SELECTOR","SELECTED_ITEM_CLASS","ITEM_RESPONSE_WAIT_CLASS","EMPTY_COLLECTION","TEMPLATE_WRAPPER_CLASS","ITEM_PATH_REGEX","FOCUS_UP","FOCUS_DOWN","FOCUS_LEFT","FOCUS_RIGHT","FOCUS_PAGE_UP","FOCUS_PAGE_DOWN","FOCUS_LAST","FOCUS_FIRST","CollectionWidget","default","inherit","_activeStateUnit","_supportedKeys","enter","e","$itemElement","option","length","_itemClickHandler","extend","target","currentTarget","space","preventDefault","call","move","location","stopPropagation","_moveFocus","callBase","leftArrow","bind","rightArrow","upArrow","downArrow","pageUp","pageDown","home","end","_getDefaultOptions","selectOnFocus","loopItemFocus","items","itemTemplate","onItemRendered","onItemClick","onItemHold","itemHoldTimeout","onItemContextMenu","onFocusedItemChanged","noDataText","format","dataSource","_itemAttributes","itemTemplateProperty","focusOnSelectedItem","focusedElement","displayExpr","disabledExpr","data","disabled","visibleExpr","visible","_getAnonymousTemplateName","_init","_compileDisplayGetter","_cleanRenderedItems","_refreshDataSource","_displayGetter","compileGetter","_initTemplates","_initItemsFromMarkup","_initDefaultItemTemplate","fieldsMap","_getFieldsMap","_defaultTemplates","item","BindableTemplate","$container","isPlainObject","_prepareDefaultItemTemplate","isFunction","text","String","ensureDefined","_getBindableFields","isDefined","html","_this","$items","$element","contents","filter","slice","map","$item","result","getElementOptions","dxItem","isTemplateRequired","trim","template","_prepareItemTemplate","remove","templateId","$template","detach","clone","removeAttr","addClass","_saveTemplate","_dataSourceOptions","paginate","_renderedItemsCount","_focusTarget","_focusInHandler","apply","arguments","inArray","$focusedElement","_setFocusedItem","$activeItem","_getActiveItem","getPublicElement","_focusOutHandler","$target","_updateFocusedItemState","last","index","activeElements","_getActiveElement","lastIndex","eq","_getAvailableItems","$newTarget","_prevItem","_nextItem","first","_getVisibleItems","$itemElements","_itemElements","not","targetIndex","$last","loop","$first","_selectFocusedItem","selectItem","isFocused","needCleanItemId","_refreshActiveDescendant","_refreshItemId","_toggleFocusClass","setAria","getFocusedItemId","_findItemElementByItem","that","itemElements","each","_itemDataKey","_getIndexByItem","indexOf","_itemOptionChanged","property","value","oldValue","constructor","ItemClass","getInstance","setDataField","_refreshItem","isDisabling","_resetItemFocus","is","itemData","_getItemData","_itemIndexKey","_renderItem","_optionChanged","args","name","matches","fullName","match","itemPath","replace","previousValue","_invalidate","_renderEmptyMessage","_createItemRenderAction","_attachHoldEvent","_attachContextMenuEvent","_createActionByOption","_loadNextPage","_dataSource","_expectNextPageLoading","pageIndex","load","_startIndexForAppendedItems","_expectLastItemLoading","_forgetNextPageLoading","_dataSourceChangedHandler","newItems","_initialized","_shouldAppendItems","_isLastPage","concat","_refreshContent","_prepareContent","_renderContent","_dataSourceLoadErrorHandler","_allowDynamicItemsAppend","_clean","_cleanFocusState","_cleanItemContainer","_itemContainer","empty","_dispose","clearTimeout","_itemFocusTimeout","_refresh","_itemClass","_itemContentClass","_selectedItemClass","_itemResponseWaitClass","_itemSelector","find","_initMarkup","deferRenderer","_renderContentImpl","_fireContentReadyAction","_render","_attachClickEvent","itemSelector","clickEventNamespace","addNamespace","NAME","pointerDownEventNamespace","down","pointerDownAction","event","_itemPointerDownHandler","off","on","execute","element","config","_itemDXEventHandler","_itemFocusHandler","isDefaultPrevented","$closestItem","closest","$closestFocusable","_closestFocusable","get","setTimeout","_forcePointerDownFocus","focusable","parent","isDocument","_updateFocusState","$itemContainer","eventName","timeout","_getHoldTimeout","_itemHoldHandler","_shouldFireHoldEvent","hasActionSubscription","cancel","_itemContextMenuHandler","_shouldFireContextMenuEvent","_renderItems","$itemToReplace","$itemFrame","_renderItemFrame","_setElementData","attr","_attachItemClickEvent","$itemContent","_getItemContent","renderContentPromise","_renderItemContent","container","contentClass","defaultTemplateName","when","done","_postprocessRenderItem","itemElement","itemContent","itemIndex","_executeItemRenderAction","removeClass","onClick","_itemEventHandlerByHandler","itemTemplateName","_getItemTemplateName","_getTemplate","_addItemContentClasses","$templateResult","_createItemByTemplate","hasClass","_renderItemContentByNode","$node","replaceWith","classes","join","_appendItemToContainer","appendTo","_itemOptions","displayValue","watchMethod","owner","fieldGetter","field","expr","getter","noop","_getItemRenderAction","_itemRenderAction","excludeValidators","category","templateProperty","renderArgs","render","model","_emptyMessageContainer","hideNoData","_isDataSourceLoading","_$noData","toggleClass","dxEvent","handlerOptionName","actionArgs","actionConfig","_itemEventHandler","initiator","action","validatingTargetName","_itemEventHandlerImpl","handler","_createAction","_closestItemElement","_extendActionArgs","_getSummaryItemsWidth","includeMargin","_","outerWidth","_focusedItemId","itemsContainer","include","module","exports"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/collection/ui.collection_widget.base.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar _renderer = require(\"../../core/renderer\");\r\nvar _renderer2 = _interopRequireDefault(_renderer);\r\nvar _events_engine = require(\"../../events/core/events_engine\");\r\nvar _events_engine2 = _interopRequireDefault(_events_engine);\r\nvar _common = require(\"../../core/utils/common\");\r\nvar _common2 = _interopRequireDefault(_common);\r\nvar _dom = require(\"../../core/utils/dom\");\r\nvar _dom_adapter = require(\"../../core/dom_adapter\");\r\nvar _dom_adapter2 = _interopRequireDefault(_dom_adapter);\r\nvar _type = require(\"../../core/utils/type\");\r\nvar _deferred = require(\"../../core/utils/deferred\");\r\nvar _extend = require(\"../../core/utils/extend\");\r\nvar _array = require(\"../../core/utils/array\");\r\nvar _iterator = require(\"../../core/utils/iterator\");\r\nvar _iterator2 = _interopRequireDefault(_iterator);\r\nvar _action = require(\"../../core/action\");\r\nvar _action2 = _interopRequireDefault(_action);\r\nvar _guid = require(\"../../core/guid\");\r\nvar _guid2 = _interopRequireDefault(_guid);\r\nvar _ui = require(\"../widget/ui.widget\");\r\nvar _ui2 = _interopRequireDefault(_ui);\r\nvar _utils = require(\"../../events/utils\");\r\nvar _utils2 = _interopRequireDefault(_utils);\r\nvar _pointer = require(\"../../events/pointer\");\r\nvar _pointer2 = _interopRequireDefault(_pointer);\r\nvar _data_helper = require(\"../../data_helper\");\r\nvar _data_helper2 = _interopRequireDefault(_data_helper);\r\nvar _item = require(\"./item\");\r\nvar _item2 = _interopRequireDefault(_item);\r\nvar _selectors = require(\"../widget/selectors\");\r\nvar _selectors2 = _interopRequireDefault(_selectors);\r\nvar _message = require(\"../../localization/message\");\r\nvar _message2 = _interopRequireDefault(_message);\r\nvar _hold = require(\"../../events/hold\");\r\nvar _hold2 = _interopRequireDefault(_hold);\r\nvar _data = require(\"../../core/utils/data\");\r\nvar _click = require(\"../../events/click\");\r\nvar _click2 = _interopRequireDefault(_click);\r\nvar _contextmenu = require(\"../../events/contextmenu\");\r\nvar _contextmenu2 = _interopRequireDefault(_contextmenu);\r\nvar _bindable_template = require(\"../../core/templates/bindable_template\");\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\nvar COLLECTION_CLASS = \"dx-collection\";\r\nvar ITEM_CLASS = \"dx-item\";\r\nvar CONTENT_CLASS_POSTFIX = \"-content\";\r\nvar ITEM_CONTENT_PLACEHOLDER_CLASS = \"dx-item-content-placeholder\";\r\nvar ITEM_DATA_KEY = \"dxItemData\";\r\nvar ITEM_INDEX_KEY = \"dxItemIndex\";\r\nvar ITEM_TEMPLATE_ID_PREFIX = \"tmpl-\";\r\nvar ITEMS_SELECTOR = \"[data-options*='dxItem']\";\r\nvar SELECTED_ITEM_CLASS = \"dx-item-selected\";\r\nvar ITEM_RESPONSE_WAIT_CLASS = \"dx-item-response-wait\";\r\nvar EMPTY_COLLECTION = \"dx-empty-collection\";\r\nvar TEMPLATE_WRAPPER_CLASS = \"dx-template-wrapper\";\r\nvar ITEM_PATH_REGEX = /^([^.]+\\[\\d+\\]\\.)+([\\w.]+)$/;\r\nvar FOCUS_UP = \"up\";\r\nvar FOCUS_DOWN = \"down\";\r\nvar FOCUS_LEFT = \"left\";\r\nvar FOCUS_RIGHT = \"right\";\r\nvar FOCUS_PAGE_UP = \"pageup\";\r\nvar FOCUS_PAGE_DOWN = \"pagedown\";\r\nvar FOCUS_LAST = \"last\";\r\nvar FOCUS_FIRST = \"first\";\r\nvar CollectionWidget = _ui2.default.inherit({\r\n    _activeStateUnit: \".\" + ITEM_CLASS,\r\n    _supportedKeys: function() {\r\n        var enter = function(e) {\r\n            var $itemElement = (0, _renderer2.default)(this.option(\"focusedElement\"));\r\n            if (!$itemElement.length) {\r\n                return\r\n            }\r\n            this._itemClickHandler((0, _extend.extend)({}, e, {\r\n                target: $itemElement,\r\n                currentTarget: $itemElement\r\n            }))\r\n        };\r\n        var space = function(e) {\r\n            e.preventDefault();\r\n            enter.call(this, e)\r\n        };\r\n        var move = function(location, e) {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n            this._moveFocus(location, e)\r\n        };\r\n        return (0, _extend.extend)(this.callBase(), {\r\n            space: space,\r\n            enter: enter,\r\n            leftArrow: move.bind(this, FOCUS_LEFT),\r\n            rightArrow: move.bind(this, FOCUS_RIGHT),\r\n            upArrow: move.bind(this, FOCUS_UP),\r\n            downArrow: move.bind(this, FOCUS_DOWN),\r\n            pageUp: move.bind(this, FOCUS_UP),\r\n            pageDown: move.bind(this, FOCUS_DOWN),\r\n            home: move.bind(this, FOCUS_FIRST),\r\n            end: move.bind(this, FOCUS_LAST)\r\n        })\r\n    },\r\n    _getDefaultOptions: function() {\r\n        return (0, _extend.extend)(this.callBase(), {\r\n            selectOnFocus: false,\r\n            loopItemFocus: true,\r\n            items: [],\r\n            itemTemplate: \"item\",\r\n            onItemRendered: null,\r\n            onItemClick: null,\r\n            onItemHold: null,\r\n            itemHoldTimeout: 750,\r\n            onItemContextMenu: null,\r\n            onFocusedItemChanged: null,\r\n            noDataText: _message2.default.format(\"dxCollectionWidget-noDataText\"),\r\n            dataSource: null,\r\n            _itemAttributes: {},\r\n            itemTemplateProperty: \"template\",\r\n            focusOnSelectedItem: true,\r\n            focusedElement: null,\r\n            displayExpr: void 0,\r\n            disabledExpr: function(data) {\r\n                return data ? data.disabled : void 0\r\n            },\r\n            visibleExpr: function(data) {\r\n                return data ? data.visible : void 0\r\n            }\r\n        })\r\n    },\r\n    _getAnonymousTemplateName: function() {\r\n        return \"item\"\r\n    },\r\n    _init: function() {\r\n        this._compileDisplayGetter();\r\n        this.callBase();\r\n        this._cleanRenderedItems();\r\n        this._refreshDataSource()\r\n    },\r\n    _compileDisplayGetter: function() {\r\n        var displayExpr = this.option(\"displayExpr\");\r\n        this._displayGetter = displayExpr ? (0, _data.compileGetter)(this.option(\"displayExpr\")) : void 0\r\n    },\r\n    _initTemplates: function() {\r\n        this._initItemsFromMarkup();\r\n        this.callBase();\r\n        this._initDefaultItemTemplate()\r\n    },\r\n    _initDefaultItemTemplate: function() {\r\n        var fieldsMap = this._getFieldsMap();\r\n        this._defaultTemplates.item = new _bindable_template.BindableTemplate(function($container, data) {\r\n            if ((0, _type.isPlainObject)(data)) {\r\n                this._prepareDefaultItemTemplate(data, $container)\r\n            } else {\r\n                if (fieldsMap && (0, _type.isFunction)(fieldsMap.text)) {\r\n                    data = fieldsMap.text(data)\r\n                }\r\n                $container.text(String(_common2.default.ensureDefined(data, \"\")))\r\n            }\r\n        }.bind(this), this._getBindableFields(), this.option(\"integrationOptions.watchMethod\"), fieldsMap)\r\n    },\r\n    _getBindableFields: function() {\r\n        return [\"text\", \"html\"]\r\n    },\r\n    _getFieldsMap: function() {\r\n        if (this._displayGetter) {\r\n            return {\r\n                text: this._displayGetter\r\n            }\r\n        }\r\n    },\r\n    _prepareDefaultItemTemplate: function(data, $container) {\r\n        if ((0, _type.isDefined)(data.text)) {\r\n            $container.text(data.text)\r\n        }\r\n        if ((0, _type.isDefined)(data.html)) {\r\n            $container.html(data.html)\r\n        }\r\n    },\r\n    _initItemsFromMarkup: function() {\r\n        var _this = this;\r\n        var $items = this.$element().contents().filter(ITEMS_SELECTOR);\r\n        if (!$items.length || this.option(\"items\").length) {\r\n            return\r\n        }\r\n        var items = [].slice.call($items).map(function(item) {\r\n            var $item = (0, _renderer2.default)(item);\r\n            var result = (0, _dom.getElementOptions)(item).dxItem;\r\n            var isTemplateRequired = $item.html().trim() && !result.template;\r\n            if (isTemplateRequired) {\r\n                result.template = _this._prepareItemTemplate($item)\r\n            } else {\r\n                $item.remove()\r\n            }\r\n            return result\r\n        });\r\n        this.option(\"items\", items)\r\n    },\r\n    _prepareItemTemplate: function($item) {\r\n        var templateId = ITEM_TEMPLATE_ID_PREFIX + new _guid2.default;\r\n        var $template = $item.detach().clone().removeAttr(\"data-options\").addClass(TEMPLATE_WRAPPER_CLASS);\r\n        this._saveTemplate(templateId, $template);\r\n        return templateId\r\n    },\r\n    _dataSourceOptions: function() {\r\n        return {\r\n            paginate: false\r\n        }\r\n    },\r\n    _cleanRenderedItems: function() {\r\n        this._renderedItemsCount = 0\r\n    },\r\n    _focusTarget: function() {\r\n        return this.$element()\r\n    },\r\n    _focusInHandler: function(e) {\r\n        this.callBase.apply(this, arguments);\r\n        if ((0, _array.inArray)(e.target, this._focusTarget()) === -1) {\r\n            return\r\n        }\r\n        var $focusedElement = (0, _renderer2.default)(this.option(\"focusedElement\"));\r\n        if ($focusedElement.length) {\r\n            this._setFocusedItem($focusedElement)\r\n        } else {\r\n            var $activeItem = this._getActiveItem();\r\n            if ($activeItem.length) {\r\n                this.option(\"focusedElement\", (0, _dom.getPublicElement)($activeItem))\r\n            }\r\n        }\r\n    },\r\n    _focusOutHandler: function() {\r\n        this.callBase.apply(this, arguments);\r\n        var $target = (0, _renderer2.default)(this.option(\"focusedElement\"));\r\n        this._updateFocusedItemState($target, false)\r\n    },\r\n    _getActiveItem: function(last) {\r\n        var $focusedElement = (0, _renderer2.default)(this.option(\"focusedElement\"));\r\n        if ($focusedElement.length) {\r\n            return $focusedElement\r\n        }\r\n        var index = this.option(\"focusOnSelectedItem\") ? this.option(\"selectedIndex\") : 0;\r\n        var activeElements = this._getActiveElement();\r\n        var lastIndex = activeElements.length - 1;\r\n        if (index < 0) {\r\n            index = last ? lastIndex : 0\r\n        }\r\n        return activeElements.eq(index)\r\n    },\r\n    _moveFocus: function(location) {\r\n        var $items = this._getAvailableItems();\r\n        var $newTarget;\r\n        switch (location) {\r\n            case FOCUS_PAGE_UP:\r\n            case FOCUS_UP:\r\n                $newTarget = this._prevItem($items);\r\n                break;\r\n            case FOCUS_PAGE_DOWN:\r\n            case FOCUS_DOWN:\r\n                $newTarget = this._nextItem($items);\r\n                break;\r\n            case FOCUS_RIGHT:\r\n                $newTarget = this.option(\"rtlEnabled\") ? this._prevItem($items) : this._nextItem($items);\r\n                break;\r\n            case FOCUS_LEFT:\r\n                $newTarget = this.option(\"rtlEnabled\") ? this._nextItem($items) : this._prevItem($items);\r\n                break;\r\n            case FOCUS_FIRST:\r\n                $newTarget = $items.first();\r\n                break;\r\n            case FOCUS_LAST:\r\n                $newTarget = $items.last();\r\n                break;\r\n            default:\r\n                return false\r\n        }\r\n        if (0 !== $newTarget.length) {\r\n            this.option(\"focusedElement\", (0, _dom.getPublicElement)($newTarget))\r\n        }\r\n    },\r\n    _getVisibleItems: function($itemElements) {\r\n        $itemElements = $itemElements || this._itemElements();\r\n        return $itemElements.filter(\":visible\")\r\n    },\r\n    _getAvailableItems: function($itemElements) {\r\n        return this._getVisibleItems($itemElements).not(\".dx-state-disabled\")\r\n    },\r\n    _prevItem: function($items) {\r\n        var $target = this._getActiveItem();\r\n        var targetIndex = $items.index($target);\r\n        var $last = $items.last();\r\n        var $item = (0, _renderer2.default)($items[targetIndex - 1]);\r\n        var loop = this.option(\"loopItemFocus\");\r\n        if (0 === $item.length && loop) {\r\n            $item = $last\r\n        }\r\n        return $item\r\n    },\r\n    _nextItem: function($items) {\r\n        var $target = this._getActiveItem(true);\r\n        var targetIndex = $items.index($target);\r\n        var $first = $items.first();\r\n        var $item = (0, _renderer2.default)($items[targetIndex + 1]);\r\n        var loop = this.option(\"loopItemFocus\");\r\n        if (0 === $item.length && loop) {\r\n            $item = $first\r\n        }\r\n        return $item\r\n    },\r\n    _selectFocusedItem: function($target) {\r\n        this.selectItem($target)\r\n    },\r\n    _updateFocusedItemState: function(target, isFocused, needCleanItemId) {\r\n        var $target = (0, _renderer2.default)(target);\r\n        if ($target.length) {\r\n            this._refreshActiveDescendant();\r\n            this._refreshItemId($target, needCleanItemId);\r\n            this._toggleFocusClass(isFocused, $target)\r\n        }\r\n    },\r\n    _refreshActiveDescendant: function($target) {\r\n        this.setAria(\"activedescendant\", (0, _type.isDefined)(this.option(\"focusedElement\")) ? this.getFocusedItemId() : null, $target)\r\n    },\r\n    _refreshItemId: function($target, needCleanItemId) {\r\n        if (!needCleanItemId && this.option(\"focusedElement\")) {\r\n            this.setAria(\"id\", this.getFocusedItemId(), $target)\r\n        } else {\r\n            this.setAria(\"id\", null, $target)\r\n        }\r\n    },\r\n    _setFocusedItem: function($target) {\r\n        if (!$target || !$target.length) {\r\n            return\r\n        }\r\n        this._updateFocusedItemState($target, true);\r\n        this.onFocusedItemChanged(this.getFocusedItemId());\r\n        if (this.option(\"selectOnFocus\")) {\r\n            this._selectFocusedItem($target)\r\n        }\r\n    },\r\n    _findItemElementByItem: function(item) {\r\n        var result = (0, _renderer2.default)();\r\n        var that = this;\r\n        this.itemElements().each(function() {\r\n            var $item = (0, _renderer2.default)(this);\r\n            if ($item.data(that._itemDataKey()) === item) {\r\n                result = $item;\r\n                return false\r\n            }\r\n        });\r\n        return result\r\n    },\r\n    _getIndexByItem: function(item) {\r\n        return this.option(\"items\").indexOf(item)\r\n    },\r\n    _itemOptionChanged: function(item, property, value, oldValue) {\r\n        var $item = this._findItemElementByItem(item);\r\n        if (!$item.length) {\r\n            return\r\n        }\r\n        if (!this.constructor.ItemClass.getInstance($item).setDataField(property, value)) {\r\n            this._refreshItem($item, item)\r\n        }\r\n        var isDisabling = \"disabled\" === property && value;\r\n        if (isDisabling) {\r\n            this._resetItemFocus($item)\r\n        }\r\n    },\r\n    _resetItemFocus: function($item) {\r\n        if ($item.is(this.option(\"focusedElement\"))) {\r\n            this.option(\"focusedElement\", null)\r\n        }\r\n    },\r\n    _refreshItem: function($item) {\r\n        var itemData = this._getItemData($item);\r\n        var index = $item.data(this._itemIndexKey());\r\n        this._renderItem(this._renderedItemsCount + index, itemData, null, $item)\r\n    },\r\n    _optionChanged: function(args) {\r\n        if (\"items\" === args.name) {\r\n            var matches = args.fullName.match(ITEM_PATH_REGEX);\r\n            if (matches && matches.length) {\r\n                var property = matches[matches.length - 1];\r\n                var itemPath = args.fullName.replace(\".\" + property, \"\");\r\n                var item = this.option(itemPath);\r\n                this._itemOptionChanged(item, property, args.value, args.previousValue);\r\n                return\r\n            }\r\n        }\r\n        switch (args.name) {\r\n            case \"items\":\r\n            case \"_itemAttributes\":\r\n            case \"itemTemplateProperty\":\r\n            case \"showItemDataTitle\":\r\n                this._cleanRenderedItems();\r\n                this._invalidate();\r\n                break;\r\n            case \"dataSource\":\r\n                this._refreshDataSource();\r\n                this._renderEmptyMessage();\r\n                break;\r\n            case \"noDataText\":\r\n                this._renderEmptyMessage();\r\n                break;\r\n            case \"itemTemplate\":\r\n                this._invalidate();\r\n                break;\r\n            case \"onItemRendered\":\r\n                this._createItemRenderAction();\r\n                break;\r\n            case \"onItemClick\":\r\n                break;\r\n            case \"onItemHold\":\r\n            case \"itemHoldTimeout\":\r\n                this._attachHoldEvent();\r\n                break;\r\n            case \"onItemContextMenu\":\r\n                this._attachContextMenuEvent();\r\n                break;\r\n            case \"onFocusedItemChanged\":\r\n                this.onFocusedItemChanged = this._createActionByOption(\"onFocusedItemChanged\");\r\n                break;\r\n            case \"selectOnFocus\":\r\n            case \"loopItemFocus\":\r\n            case \"focusOnSelectedItem\":\r\n                break;\r\n            case \"focusedElement\":\r\n                this._updateFocusedItemState(args.previousValue, false, true);\r\n                this._setFocusedItem((0, _renderer2.default)(args.value));\r\n                break;\r\n            case \"displayExpr\":\r\n                this._compileDisplayGetter();\r\n                this._initDefaultItemTemplate();\r\n                this._invalidate();\r\n                break;\r\n            case \"visibleExpr\":\r\n            case \"disabledExpr\":\r\n                this._invalidate();\r\n                break;\r\n            default:\r\n                this.callBase(args)\r\n        }\r\n    },\r\n    _invalidate: function() {\r\n        this.option(\"focusedElement\", null);\r\n        return this.callBase.apply(this, arguments)\r\n    },\r\n    _loadNextPage: function() {\r\n        var dataSource = this._dataSource;\r\n        this._expectNextPageLoading();\r\n        dataSource.pageIndex(1 + dataSource.pageIndex());\r\n        return dataSource.load()\r\n    },\r\n    _expectNextPageLoading: function() {\r\n        this._startIndexForAppendedItems = 0\r\n    },\r\n    _expectLastItemLoading: function() {\r\n        this._startIndexForAppendedItems = -1\r\n    },\r\n    _forgetNextPageLoading: function() {\r\n        this._startIndexForAppendedItems = null\r\n    },\r\n    _dataSourceChangedHandler: function(newItems) {\r\n        var items = this.option(\"items\");\r\n        if (this._initialized && items && this._shouldAppendItems()) {\r\n            this._renderedItemsCount = items.length;\r\n            if (!this._isLastPage() || this._startIndexForAppendedItems !== -1) {\r\n                this.option().items = items.concat(newItems.slice(this._startIndexForAppendedItems))\r\n            }\r\n            this._forgetNextPageLoading();\r\n            this._refreshContent()\r\n        } else {\r\n            this.option(\"items\", newItems.slice())\r\n        }\r\n    },\r\n    _refreshContent: function() {\r\n        this._prepareContent();\r\n        this._renderContent()\r\n    },\r\n    _dataSourceLoadErrorHandler: function() {\r\n        this._forgetNextPageLoading();\r\n        this.option(\"items\", this.option(\"items\"))\r\n    },\r\n    _shouldAppendItems: function() {\r\n        return null != this._startIndexForAppendedItems && this._allowDynamicItemsAppend()\r\n    },\r\n    _allowDynamicItemsAppend: function() {\r\n        return false\r\n    },\r\n    _clean: function() {\r\n        this._cleanFocusState();\r\n        this._cleanItemContainer()\r\n    },\r\n    _cleanItemContainer: function() {\r\n        (0, _renderer2.default)(this._itemContainer()).empty()\r\n    },\r\n    _dispose: function() {\r\n        this.callBase();\r\n        clearTimeout(this._itemFocusTimeout)\r\n    },\r\n    _refresh: function() {\r\n        this._cleanRenderedItems();\r\n        this.callBase.apply(this, arguments)\r\n    },\r\n    _itemContainer: function() {\r\n        return this.$element()\r\n    },\r\n    _itemClass: function() {\r\n        return ITEM_CLASS\r\n    },\r\n    _itemContentClass: function() {\r\n        return this._itemClass() + CONTENT_CLASS_POSTFIX\r\n    },\r\n    _selectedItemClass: function() {\r\n        return SELECTED_ITEM_CLASS\r\n    },\r\n    _itemResponseWaitClass: function() {\r\n        return ITEM_RESPONSE_WAIT_CLASS\r\n    },\r\n    _itemSelector: function() {\r\n        return \".\" + this._itemClass()\r\n    },\r\n    _itemDataKey: function() {\r\n        return ITEM_DATA_KEY\r\n    },\r\n    _itemIndexKey: function() {\r\n        return ITEM_INDEX_KEY\r\n    },\r\n    _itemElements: function() {\r\n        return this._itemContainer().find(this._itemSelector())\r\n    },\r\n    _initMarkup: function() {\r\n        this.callBase();\r\n        this.onFocusedItemChanged = this._createActionByOption(\"onFocusedItemChanged\");\r\n        this.$element().addClass(COLLECTION_CLASS);\r\n        this._prepareContent()\r\n    },\r\n    _prepareContent: _common2.default.deferRenderer(function() {\r\n        this._renderContentImpl()\r\n    }),\r\n    _renderContent: function() {\r\n        this._fireContentReadyAction()\r\n    },\r\n    _render: function() {\r\n        this.callBase();\r\n        this._attachClickEvent();\r\n        this._attachHoldEvent();\r\n        this._attachContextMenuEvent()\r\n    },\r\n    _attachClickEvent: function() {\r\n        var itemSelector = this._itemSelector();\r\n        var clickEventNamespace = _utils2.default.addNamespace(_click2.default.name, this.NAME);\r\n        var pointerDownEventNamespace = _utils2.default.addNamespace(_pointer2.default.down, this.NAME);\r\n        var that = this;\r\n        var pointerDownAction = new _action2.default(function(args) {\r\n            var event = args.event;\r\n            that._itemPointerDownHandler(event)\r\n        });\r\n        _events_engine2.default.off(this._itemContainer(), clickEventNamespace, itemSelector);\r\n        _events_engine2.default.off(this._itemContainer(), pointerDownEventNamespace, itemSelector);\r\n        _events_engine2.default.on(this._itemContainer(), clickEventNamespace, itemSelector, function(e) {\r\n            this._itemClickHandler(e)\r\n        }.bind(this));\r\n        _events_engine2.default.on(this._itemContainer(), pointerDownEventNamespace, itemSelector, function(e) {\r\n            pointerDownAction.execute({\r\n                element: (0, _renderer2.default)(e.target),\r\n                event: e\r\n            })\r\n        })\r\n    },\r\n    _itemClickHandler: function(e, args, config) {\r\n        this._itemDXEventHandler(e, \"onItemClick\", args, config)\r\n    },\r\n    _itemPointerDownHandler: function(e) {\r\n        if (!this.option(\"focusStateEnabled\")) {\r\n            return\r\n        }\r\n        this._itemFocusHandler = function() {\r\n            clearTimeout(this._itemFocusTimeout);\r\n            this._itemFocusHandler = null;\r\n            if (e.isDefaultPrevented()) {\r\n                return\r\n            }\r\n            var $target = (0, _renderer2.default)(e.target);\r\n            var $closestItem = $target.closest(this._itemElements());\r\n            var $closestFocusable = this._closestFocusable($target);\r\n            if ($closestItem.length && $closestFocusable && (0, _array.inArray)($closestFocusable.get(0), this._focusTarget()) !== -1) {\r\n                this.option(\"focusedElement\", (0, _dom.getPublicElement)($closestItem))\r\n            }\r\n        }.bind(this);\r\n        this._itemFocusTimeout = setTimeout(this._forcePointerDownFocus.bind(this))\r\n    },\r\n    _closestFocusable: function($target) {\r\n        if ($target.is(_selectors2.default.focusable)) {\r\n            return $target\r\n        } else {\r\n            $target = $target.parent();\r\n            while ($target.length && !_dom_adapter2.default.isDocument($target.get(0))) {\r\n                if ($target.is(_selectors2.default.focusable)) {\r\n                    return $target\r\n                }\r\n                $target = $target.parent()\r\n            }\r\n        }\r\n    },\r\n    _forcePointerDownFocus: function() {\r\n        this._itemFocusHandler && this._itemFocusHandler()\r\n    },\r\n    _updateFocusState: function() {\r\n        this.callBase.apply(this, arguments);\r\n        this._forcePointerDownFocus()\r\n    },\r\n    _attachHoldEvent: function() {\r\n        var $itemContainer = this._itemContainer();\r\n        var itemSelector = this._itemSelector();\r\n        var eventName = _utils2.default.addNamespace(_hold2.default.name, this.NAME);\r\n        _events_engine2.default.off($itemContainer, eventName, itemSelector);\r\n        _events_engine2.default.on($itemContainer, eventName, itemSelector, {\r\n            timeout: this._getHoldTimeout()\r\n        }, this._itemHoldHandler.bind(this))\r\n    },\r\n    _getHoldTimeout: function() {\r\n        return this.option(\"itemHoldTimeout\")\r\n    },\r\n    _shouldFireHoldEvent: function() {\r\n        return this.hasActionSubscription(\"onItemHold\")\r\n    },\r\n    _itemHoldHandler: function(e) {\r\n        if (this._shouldFireHoldEvent()) {\r\n            this._itemDXEventHandler(e, \"onItemHold\")\r\n        } else {\r\n            e.cancel = true\r\n        }\r\n    },\r\n    _attachContextMenuEvent: function() {\r\n        var $itemContainer = this._itemContainer();\r\n        var itemSelector = this._itemSelector();\r\n        var eventName = _utils2.default.addNamespace(_contextmenu2.default.name, this.NAME);\r\n        _events_engine2.default.off($itemContainer, eventName, itemSelector);\r\n        _events_engine2.default.on($itemContainer, eventName, itemSelector, this._itemContextMenuHandler.bind(this))\r\n    },\r\n    _shouldFireContextMenuEvent: function() {\r\n        return this.hasActionSubscription(\"onItemContextMenu\")\r\n    },\r\n    _itemContextMenuHandler: function(e) {\r\n        if (this._shouldFireContextMenuEvent()) {\r\n            this._itemDXEventHandler(e, \"onItemContextMenu\")\r\n        } else {\r\n            e.cancel = true\r\n        }\r\n    },\r\n    _renderContentImpl: function() {\r\n        var items = this.option(\"items\") || [];\r\n        if (this._renderedItemsCount) {\r\n            this._renderItems(items.slice(this._renderedItemsCount))\r\n        } else {\r\n            this._renderItems(items)\r\n        }\r\n    },\r\n    _renderItems: function(items) {\r\n        if (items.length) {\r\n            _iterator2.default.each(items, function(index, itemData) {\r\n                this._renderItem(this._renderedItemsCount + index, itemData)\r\n            }.bind(this))\r\n        }\r\n        this._renderEmptyMessage()\r\n    },\r\n    _renderItem: function(index, itemData, $container, $itemToReplace) {\r\n        $container = $container || this._itemContainer();\r\n        var $itemFrame = this._renderItemFrame(index, itemData, $container, $itemToReplace);\r\n        this._setElementData($itemFrame, itemData, index);\r\n        $itemFrame.attr(this.option(\"_itemAttributes\"));\r\n        this._attachItemClickEvent(itemData, $itemFrame);\r\n        var $itemContent = this._getItemContent($itemFrame);\r\n        var renderContentPromise = this._renderItemContent({\r\n            index: index,\r\n            itemData: itemData,\r\n            container: (0, _dom.getPublicElement)($itemContent),\r\n            contentClass: this._itemContentClass(),\r\n            defaultTemplateName: this.option(\"itemTemplate\")\r\n        });\r\n        var that = this;\r\n        (0, _deferred.when)(renderContentPromise).done(function($itemContent) {\r\n            that._postprocessRenderItem({\r\n                itemElement: $itemFrame,\r\n                itemContent: $itemContent,\r\n                itemData: itemData,\r\n                itemIndex: index\r\n            });\r\n            that._executeItemRenderAction(index, itemData, (0, _dom.getPublicElement)($itemFrame))\r\n        });\r\n        return $itemFrame\r\n    },\r\n    _getItemContent: function($itemFrame) {\r\n        var $itemContent = $itemFrame.find(\".\" + ITEM_CONTENT_PLACEHOLDER_CLASS);\r\n        $itemContent.removeClass(ITEM_CONTENT_PLACEHOLDER_CLASS);\r\n        return $itemContent\r\n    },\r\n    _attachItemClickEvent: function(itemData, $itemElement) {\r\n        if (!itemData || !itemData.onClick) {\r\n            return\r\n        }\r\n        _events_engine2.default.on($itemElement, _click2.default.name, function(e) {\r\n            this._itemEventHandlerByHandler($itemElement, itemData.onClick, {\r\n                event: e\r\n            })\r\n        }.bind(this))\r\n    },\r\n    _renderItemContent: function(args) {\r\n        var itemTemplateName = this._getItemTemplateName(args);\r\n        var itemTemplate = this._getTemplate(itemTemplateName);\r\n        this._addItemContentClasses(args);\r\n        var $templateResult = (0, _renderer2.default)(this._createItemByTemplate(itemTemplate, args));\r\n        if (!$templateResult.hasClass(TEMPLATE_WRAPPER_CLASS)) {\r\n            return args.container\r\n        }\r\n        return this._renderItemContentByNode(args, $templateResult)\r\n    },\r\n    _renderItemContentByNode: function(args, $node) {\r\n        (0, _renderer2.default)(args.container).replaceWith($node);\r\n        args.container = (0, _dom.getPublicElement)($node);\r\n        this._addItemContentClasses(args);\r\n        return $node\r\n    },\r\n    _addItemContentClasses: function(args) {\r\n        var classes = [ITEM_CLASS + CONTENT_CLASS_POSTFIX, args.contentClass];\r\n        (0, _renderer2.default)(args.container).addClass(classes.join(\" \"))\r\n    },\r\n    _appendItemToContainer: function($container, $itemFrame, index) {\r\n        $itemFrame.appendTo($container)\r\n    },\r\n    _renderItemFrame: function(index, itemData, $container, $itemToReplace) {\r\n        var $itemFrame = (0, _renderer2.default)(\"<div>\");\r\n        new this.constructor.ItemClass($itemFrame, this._itemOptions(), itemData || {});\r\n        if ($itemToReplace && $itemToReplace.length) {\r\n            $itemToReplace.replaceWith($itemFrame)\r\n        } else {\r\n            this._appendItemToContainer.call(this, $container, $itemFrame, index)\r\n        }\r\n        if (this.option(\"showItemDataTitle\")) {\r\n            var displayValue = this._displayGetter ? this._displayGetter(itemData) : itemData;\r\n            $itemFrame.attr(\"title\", displayValue)\r\n        }\r\n        return $itemFrame\r\n    },\r\n    _itemOptions: function() {\r\n        var that = this;\r\n        return {\r\n            watchMethod: function() {\r\n                return that.option(\"integrationOptions.watchMethod\")\r\n            },\r\n            owner: that,\r\n            fieldGetter: function(field) {\r\n                var expr = that.option(field + \"Expr\");\r\n                var getter = (0, _data.compileGetter)(expr);\r\n                return getter\r\n            }\r\n        }\r\n    },\r\n    _postprocessRenderItem: _common2.default.noop,\r\n    _executeItemRenderAction: function(index, itemData, itemElement) {\r\n        this._getItemRenderAction()({\r\n            itemElement: itemElement,\r\n            itemIndex: index,\r\n            itemData: itemData\r\n        })\r\n    },\r\n    _setElementData: function(element, data, index) {\r\n        element.addClass([ITEM_CLASS, this._itemClass()].join(\" \")).data(this._itemDataKey(), data).data(this._itemIndexKey(), index)\r\n    },\r\n    _createItemRenderAction: function() {\r\n        return this._itemRenderAction = this._createActionByOption(\"onItemRendered\", {\r\n            element: this.element(),\r\n            excludeValidators: [\"disabled\", \"readOnly\"],\r\n            category: \"rendering\"\r\n        })\r\n    },\r\n    _getItemRenderAction: function() {\r\n        return this._itemRenderAction || this._createItemRenderAction()\r\n    },\r\n    _getItemTemplateName: function(args) {\r\n        var data = args.itemData;\r\n        var templateProperty = args.templateProperty || this.option(\"itemTemplateProperty\");\r\n        var template = data && data[templateProperty];\r\n        return template || args.defaultTemplateName\r\n    },\r\n    _createItemByTemplate: function(itemTemplate, renderArgs) {\r\n        return itemTemplate.render({\r\n            model: renderArgs.itemData,\r\n            container: renderArgs.container,\r\n            index: renderArgs.index\r\n        })\r\n    },\r\n    _emptyMessageContainer: function() {\r\n        return this._itemContainer()\r\n    },\r\n    _renderEmptyMessage: function(items) {\r\n        items = items || this.option(\"items\");\r\n        var noDataText = this.option(\"noDataText\");\r\n        var hideNoData = !noDataText || items && items.length || this._isDataSourceLoading();\r\n        if (hideNoData && this._$noData) {\r\n            this._$noData.remove();\r\n            this._$noData = null;\r\n            this.setAria(\"label\", void 0)\r\n        }\r\n        if (!hideNoData) {\r\n            this._$noData = this._$noData || (0, _renderer2.default)(\"<div>\").addClass(\"dx-empty-message\");\r\n            this._$noData.appendTo(this._emptyMessageContainer()).html(noDataText);\r\n            this.setAria(\"label\", noDataText)\r\n        }\r\n        this.$element().toggleClass(EMPTY_COLLECTION, !hideNoData)\r\n    },\r\n    _itemDXEventHandler: function(dxEvent, handlerOptionName, actionArgs, actionConfig) {\r\n        this._itemEventHandler(dxEvent.target, handlerOptionName, (0, _extend.extend)(actionArgs, {\r\n            event: dxEvent\r\n        }), actionConfig)\r\n    },\r\n    _itemEventHandler: function(initiator, handlerOptionName, actionArgs, actionConfig) {\r\n        var action = this._createActionByOption(handlerOptionName, (0, _extend.extend)({\r\n            validatingTargetName: \"itemElement\"\r\n        }, actionConfig));\r\n        return this._itemEventHandlerImpl(initiator, action, actionArgs)\r\n    },\r\n    _itemEventHandlerByHandler: function(initiator, handler, actionArgs, actionConfig) {\r\n        var action = this._createAction(handler, (0, _extend.extend)({\r\n            validatingTargetName: \"itemElement\"\r\n        }, actionConfig));\r\n        return this._itemEventHandlerImpl(initiator, action, actionArgs)\r\n    },\r\n    _itemEventHandlerImpl: function(initiator, action, actionArgs) {\r\n        var $itemElement = this._closestItemElement((0, _renderer2.default)(initiator));\r\n        var args = (0, _extend.extend)({}, actionArgs);\r\n        return action((0, _extend.extend)(actionArgs, this._extendActionArgs($itemElement), args))\r\n    },\r\n    _extendActionArgs: function($itemElement) {\r\n        return {\r\n            itemElement: (0, _dom.getPublicElement)($itemElement),\r\n            itemIndex: this._itemElements().index($itemElement),\r\n            itemData: this._getItemData($itemElement)\r\n        }\r\n    },\r\n    _closestItemElement: function($element) {\r\n        return (0, _renderer2.default)($element).closest(this._itemSelector())\r\n    },\r\n    _getItemData: function(itemElement) {\r\n        return (0, _renderer2.default)(itemElement).data(this._itemDataKey())\r\n    },\r\n    _getSummaryItemsWidth: function(items, includeMargin) {\r\n        var result = 0;\r\n        if (items) {\r\n            _iterator2.default.each(items, function(_, item) {\r\n                result += (0, _renderer2.default)(item).outerWidth(includeMargin || false)\r\n            })\r\n        }\r\n        return result\r\n    },\r\n    getFocusedItemId: function() {\r\n        if (!this._focusedItemId) {\r\n            this._focusedItemId = \"dx-\" + new _guid2.default\r\n        }\r\n        return this._focusedItemId\r\n    },\r\n    itemElements: function() {\r\n        return this._itemElements()\r\n    },\r\n    itemsContainer: function() {\r\n        return this._itemContainer()\r\n    }\r\n}).include(_data_helper2.default);\r\nCollectionWidget.ItemClass = _item2.default;\r\nmodule.exports = CollectionWidget;\r\n"]},"metadata":{},"sourceType":"script"}