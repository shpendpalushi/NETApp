{"ast":null,"code":"/**\r\n * DevExtreme (ui/select_box.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar $ = require(\"../core/renderer\");\n\nvar commonUtils = require(\"../core/utils/common\");\n\nvar typeUtils = require(\"../core/utils/type\");\n\nvar isDefined = typeUtils.isDefined;\nvar isPromise = typeUtils.isPromise;\n\nvar extend = require(\"../core/utils/extend\").extend;\n\nvar inArray = require(\"../core/utils/array\").inArray;\n\nvar each = require(\"../core/utils/iterator\").each;\n\nvar deferredUtils = require(\"../core/utils/deferred\");\n\nvar getPublicElement = require(\"../core/utils/dom\").getPublicElement;\n\nvar Deferred = deferredUtils.Deferred;\n\nvar errors = require(\"../core/errors\");\n\nvar domAdapter = require(\"../core/dom_adapter\");\n\nvar inkRipple = require(\"./widget/utils.ink_ripple\");\n\nvar messageLocalization = require(\"../localization/message\");\n\nvar registerComponent = require(\"../core/component_registrator\");\n\nvar DropDownList = require(\"./drop_down_editor/ui.drop_down_list\");\n\nvar DISABLED_STATE_SELECTOR = \".dx-state-disabled\";\nvar SELECTBOX_CLASS = \"dx-selectbox\";\nvar SELECTBOX_POPUP_CLASS = \"dx-selectbox-popup\";\nvar SELECTBOX_CONTAINER_CLASS = \"dx-selectbox-container\";\nvar SELECTBOX_POPUP_WRAPPER_CLASS = \"dx-selectbox-popup-wrapper\";\nvar SelectBox = DropDownList.inherit({\n  _supportedKeys: function _supportedKeys() {\n    var that = this;\n    var parent = this.callBase();\n\n    var clearSelectBox = function clearSelectBox(e) {\n      var isEditable = this._isEditable();\n\n      if (!isEditable) {\n        if (this.option(\"showClearButton\")) {\n          e.preventDefault();\n          this.reset();\n        }\n      } else {\n        if (this._valueSubstituted()) {\n          this._preventFiltering = true;\n        }\n      }\n\n      this._preventSubstitution = true;\n    };\n\n    var searchIfNeeded = function searchIfNeeded() {\n      if (that.option(\"searchEnabled\") && that._valueSubstituted()) {\n        that._searchHandler();\n      }\n    };\n\n    return extend({}, parent, {\n      tab: function tab() {\n        if (this.option(\"opened\") && \"instantly\" === this.option(\"applyValueMode\")) {\n          this._cleanInputSelection();\n        }\n\n        if (this._wasSearch()) {\n          this._clearFilter();\n        }\n\n        parent.tab && parent.tab.apply(this, arguments);\n      },\n      upArrow: function upArrow(e) {\n        if (parent.upArrow && parent.upArrow.apply(this, arguments)) {\n          if (!this.option(\"opened\")) {\n            this._setNextValue(e);\n          }\n\n          return true;\n        }\n      },\n      downArrow: function downArrow(e) {\n        if (parent.downArrow && parent.downArrow.apply(this, arguments)) {\n          if (!this.option(\"opened\")) {\n            this._setNextValue(e);\n          }\n\n          return true;\n        }\n      },\n      leftArrow: function leftArrow() {\n        searchIfNeeded();\n        parent.leftArrow && parent.leftArrow.apply(this, arguments);\n      },\n      rightArrow: function rightArrow() {\n        searchIfNeeded();\n        parent.rightArrow && parent.rightArrow.apply(this, arguments);\n      },\n      home: function home() {\n        searchIfNeeded();\n        parent.home && parent.home.apply(this, arguments);\n      },\n      end: function end() {\n        searchIfNeeded();\n        parent.end && parent.end.apply(this, arguments);\n      },\n      escape: function escape() {\n        var result = parent.escape && parent.escape.apply(this, arguments);\n\n        this._cancelEditing();\n\n        return isDefined(result) ? result : true;\n      },\n      enter: function enter(e) {\n        var isOpened = this.option(\"opened\");\n\n        var inputText = this._input().val().trim();\n\n        var isCustomText = inputText && this._list && !this._list.option(\"focusedElement\");\n\n        if (!inputText && this.option(\"value\") && this.option(\"allowClearing\")) {\n          this.option({\n            selectedItem: null,\n            value: null\n          });\n          this.close();\n        } else {\n          if (this.option(\"acceptCustomValue\")) {\n            e.preventDefault();\n\n            if (isCustomText) {\n              this._valueChangeEventHandler(e);\n\n              if (isOpened) {\n                this._toggleOpenState();\n              }\n            }\n\n            return isOpened;\n          }\n\n          if (parent.enter && parent.enter.apply(this, arguments)) {\n            return isOpened;\n          }\n        }\n      },\n      space: function space(e) {\n        var isOpened = this.option(\"opened\");\n        var isSearchEnabled = this.option(\"searchEnabled\");\n        var acceptCustomValue = this.option(\"acceptCustomValue\");\n\n        if (!isOpened || isSearchEnabled || acceptCustomValue) {\n          return;\n        }\n\n        e.preventDefault();\n\n        this._valueChangeEventHandler(e);\n\n        return true;\n      },\n      backspace: clearSelectBox,\n      del: clearSelectBox\n    });\n  },\n  _getDefaultOptions: function _getDefaultOptions() {\n    return extend(this.callBase(), {\n      placeholder: messageLocalization.format(\"Select\"),\n      fieldTemplate: null,\n      valueChangeEvent: \"change\",\n      acceptCustomValue: false,\n      onCustomItemCreating: function onCustomItemCreating(e) {\n        if (!isDefined(e.customItem)) {\n          e.customItem = e.text;\n        }\n      },\n      showSelectionControls: false,\n      autocompletionEnabled: true,\n      allowClearing: true,\n      tooltipEnabled: false,\n      openOnFieldClick: true,\n      showDropDownButton: true,\n      displayCustomValue: false,\n      _isAdaptablePopupPosition: false,\n      useInkRipple: false,\n      useHiddenSubmitElement: true\n    });\n  },\n  _init: function _init() {\n    this.callBase();\n\n    this._initCustomItemCreatingAction();\n  },\n  _initMarkup: function _initMarkup() {\n    this.$element().addClass(SELECTBOX_CLASS);\n\n    this._renderTooltip();\n\n    this.option(\"useInkRipple\") && this._renderInkRipple();\n    this.callBase();\n\n    this._$container.addClass(SELECTBOX_CONTAINER_CLASS);\n  },\n  _renderInkRipple: function _renderInkRipple() {\n    this._inkRipple = inkRipple.render();\n  },\n  _toggleActiveState: function _toggleActiveState($element, value, e) {\n    this.callBase.apply(this, arguments);\n\n    if (!this._inkRipple || this._isEditable()) {\n      return;\n    }\n\n    var config = {\n      element: this._inputWrapper(),\n      event: e\n    };\n\n    if (value) {\n      this._inkRipple.showWave(config);\n    } else {\n      this._inkRipple.hideWave(config);\n    }\n  },\n  _createPopup: function _createPopup() {\n    this.callBase();\n\n    this._popup.$element().addClass(SELECTBOX_POPUP_CLASS);\n  },\n  _popupWrapperClass: function _popupWrapperClass() {\n    return this.callBase() + \" \" + SELECTBOX_POPUP_WRAPPER_CLASS;\n  },\n  _cancelEditing: function _cancelEditing() {\n    if (!this.option(\"searchEnabled\") && this._list) {\n      this._focusListElement(null);\n\n      this._updateField(this.option(\"selectedItem\"));\n    }\n  },\n  _renderOpenedState: function _renderOpenedState() {\n    this.callBase();\n\n    if (this.option(\"opened\")) {\n      this._scrollToSelectedItem();\n\n      this._focusSelectedElement();\n    }\n  },\n  _focusSelectedElement: function _focusSelectedElement() {\n    var searchValue = this._searchValue();\n\n    if (!searchValue) {\n      this._focusListElement(null);\n\n      return;\n    }\n\n    var $listItems = this._list._itemElements();\n\n    var index = inArray(this.option(\"selectedItem\"), this.option(\"items\"));\n    var focusedElement = index >= 0 && !this._isCustomItemSelected() ? $listItems.eq(index) : null;\n\n    this._focusListElement(focusedElement);\n  },\n  _renderFocusedElement: function _renderFocusedElement() {\n    if (!this._list) {\n      return;\n    }\n\n    var searchValue = this._searchValue();\n\n    if (!searchValue || this.option(\"acceptCustomValue\")) {\n      this._focusListElement(null);\n\n      return;\n    }\n\n    var $listItems = this._list._itemElements();\n\n    var focusedElement = $listItems.not(DISABLED_STATE_SELECTOR).eq(0);\n\n    this._focusListElement(focusedElement);\n  },\n  _focusListElement: function _focusListElement(element) {\n    this._preventInputValueRender = true;\n\n    this._list.option(\"focusedElement\", getPublicElement(element));\n\n    delete this._preventInputValueRender;\n  },\n  _scrollToSelectedItem: function _scrollToSelectedItem() {\n    this._list && this._list.scrollToItem(this._list.option(\"selectedItem\"));\n  },\n  _listContentReadyHandler: function _listContentReadyHandler() {\n    this.callBase();\n\n    var isPaginate = this._dataSource && this._dataSource.paginate();\n\n    if (isPaginate && this._needPopupRepaint()) {\n      return;\n    }\n\n    this._scrollToSelectedItem();\n  },\n  _renderValue: function _renderValue() {\n    this._renderInputValue();\n\n    this._setSubmitValue();\n\n    return new Deferred().resolve();\n  },\n  _renderInputValue: function _renderInputValue() {\n    return this.callBase().always(function () {\n      this._renderInputValueAsync();\n    }.bind(this));\n  },\n  _renderInputValueAsync: function _renderInputValueAsync() {\n    this._renderTooltip();\n\n    this._renderInputValueImpl().always(function () {\n      this._refreshSelected();\n    }.bind(this));\n  },\n  _renderInputValueImpl: function _renderInputValueImpl() {\n    this._renderField();\n\n    return new Deferred().resolve();\n  },\n  _setNextItem: function _setNextItem(step) {\n    var item = this._calcNextItem(step);\n\n    var value = this._valueGetter(item);\n\n    this._setValue(value);\n  },\n  _setNextValue: function _setNextValue(e) {\n    var dataSourceIsLoaded = this._dataSource.isLoaded() ? new Deferred().resolve() : this._dataSource.load();\n    dataSourceIsLoaded.done(function () {\n      var selectedIndex = this._getSelectedIndex();\n\n      var hasPages = this._dataSource.pageSize();\n\n      var isLastPage = this._dataSource.isLastPage();\n\n      var isLastItem = selectedIndex === this._items().length - 1;\n\n      this._saveValueChangeEvent(e);\n\n      var step = \"ArrowDown\" === e.key ? 1 : -1;\n\n      if (hasPages && !isLastPage && isLastItem && step > 0) {\n        if (!this._popup) {\n          this._createPopup();\n        }\n\n        this._list._loadNextPage().done(this._setNextItem.bind(this, step));\n      } else {\n        this._setNextItem(step);\n      }\n    }.bind(this));\n  },\n  _setSelectedItem: function _setSelectedItem(item) {\n    var isUnknownItem = !this._isCustomValueAllowed() && void 0 === item;\n    this.callBase(isUnknownItem ? null : item);\n\n    if (!isUnknownItem && (!this._isEditable() || this._isCustomItemSelected())) {\n      this._setListOption(\"selectedItem\", this.option(\"selectedItem\"));\n    }\n  },\n  _isCustomValueAllowed: function _isCustomValueAllowed() {\n    return this.option(\"acceptCustomValue\") || this.callBase();\n  },\n  _displayValue: function _displayValue(item) {\n    item = !isDefined(item) && this._isCustomValueAllowed() ? this.option(\"value\") : item;\n    return this.callBase(item);\n  },\n  _listConfig: function _listConfig() {\n    var result = extend(this.callBase(), {\n      pageLoadMode: \"scrollBottom\",\n      onSelectionChanged: this._getSelectionChangeHandler(),\n      selectedItem: this.option(\"selectedItem\"),\n      onFocusedItemChanged: this._listFocusedItemChangeHandler.bind(this)\n    });\n\n    if (this.option(\"showSelectionControls\")) {\n      extend(result, {\n        showSelectionControls: true,\n        selectionByClick: true\n      });\n    }\n\n    return result;\n  },\n  _listFocusedItemChangeHandler: function _listFocusedItemChangeHandler(e) {\n    if (this._preventInputValueRender) {\n      return;\n    }\n\n    var list = e.component;\n    var focusedElement = $(list.option(\"focusedElement\"));\n\n    var focusedItem = list._getItemData(focusedElement);\n\n    this._updateField(focusedItem);\n  },\n  _updateField: function _updateField(item) {\n    var fieldTemplate = this._getTemplateByOption(\"fieldTemplate\");\n\n    if (!(fieldTemplate && this.option(\"fieldTemplate\"))) {\n      this._renderDisplayText(this._displayGetter(item));\n\n      return;\n    }\n\n    this._renderField();\n  },\n  _getSelectionChangeHandler: function _getSelectionChangeHandler() {\n    return this.option(\"showSelectionControls\") ? this._selectionChangeHandler.bind(this) : commonUtils.noop;\n  },\n  _selectionChangeHandler: function _selectionChangeHandler(e) {\n    each(e.addedItems || [], function (_, addedItem) {\n      this._setValue(this._valueGetter(addedItem));\n    }.bind(this));\n  },\n  _getActualSearchValue: function _getActualSearchValue() {\n    return this._dataSource.searchValue();\n  },\n  _toggleOpenState: function _toggleOpenState(isVisible) {\n    if (this.option(\"disabled\")) {\n      return;\n    }\n\n    isVisible = arguments.length ? isVisible : !this.option(\"opened\");\n\n    if (!isVisible) {\n      this._restoreInputText(true);\n    }\n\n    if (this._wasSearch() && isVisible) {\n      this._wasSearch(false);\n\n      var showDataImmediately = this.option(\"showDataBeforeSearch\") || 0 === this.option(\"minSearchLength\");\n\n      if (showDataImmediately && this._dataSource) {\n        if (this._searchTimer) {\n          return;\n        }\n\n        var searchValue = this._getActualSearchValue();\n\n        searchValue && this._wasSearch(true);\n\n        this._filterDataSource(searchValue || null);\n      } else {\n        this._setListOption(\"items\", []);\n      }\n    }\n\n    if (isVisible) {\n      this._scrollToSelectedItem();\n    }\n\n    this.callBase(isVisible);\n  },\n  _renderTooltip: function _renderTooltip() {\n    if (this.option(\"tooltipEnabled\")) {\n      this.$element().attr(\"title\", this.option(\"displayValue\"));\n    }\n  },\n  _renderDimensions: function _renderDimensions() {\n    this.callBase();\n\n    this._setPopupOption(\"width\");\n  },\n  _isValueEqualInputText: function _isValueEqualInputText() {\n    var initialSelectedItem = this.option(\"selectedItem\");\n\n    var value = this._displayGetter(initialSelectedItem);\n\n    var displayValue = value ? String(value) : \"\";\n\n    var inputText = this._searchValue();\n\n    return displayValue === inputText;\n  },\n  _popupHidingHandler: function _popupHidingHandler() {\n    if (this._isValueEqualInputText()) {\n      this._cancelEditing();\n    }\n\n    this.callBase();\n  },\n  _restoreInputText: function _restoreInputText(saveEditingValue) {\n    if (this.option(\"readOnly\")) {\n      return;\n    }\n\n    this._loadItemDeferred && this._loadItemDeferred.always(function () {\n      var initialSelectedItem = this.option(\"selectedItem\");\n\n      if (this.option(\"acceptCustomValue\")) {\n        if (!saveEditingValue) {\n          this._updateField(initialSelectedItem);\n\n          this._clearFilter();\n        }\n\n        return;\n      }\n\n      if (this.option(\"searchEnabled\")) {\n        if (!this._searchValue() && this.option(\"allowClearing\")) {\n          this._clearTextValue();\n\n          return;\n        }\n      }\n\n      if (this._isValueEqualInputText()) {\n        return;\n      }\n\n      this._renderInputValue().always(function (selectedItem) {\n        var newSelectedItem = commonUtils.ensureDefined(selectedItem, initialSelectedItem);\n\n        this._setSelectedItem(newSelectedItem);\n\n        this._updateField(newSelectedItem);\n\n        this._clearFilter();\n      }.bind(this));\n    }.bind(this));\n  },\n  _focusOutHandler: function _focusOutHandler(e) {\n    if (!this._preventNestedFocusEvent(e)) {\n      this._clearSearchTimer();\n\n      this._restoreInputText();\n\n      if (!this.option(\"acceptCustomValue\") && this.option(\"searchEnabled\") && !this._isOverlayNestedTarget(e.relatedTarget)) {\n        this._searchCanceled();\n      }\n    }\n\n    this.callBase(e);\n  },\n  _isOverlayNestedTarget: function _isOverlayNestedTarget(target) {\n    return !!$(target).closest(\".\".concat(SELECTBOX_POPUP_WRAPPER_CLASS)).length;\n  },\n  _clearTextValue: function _clearTextValue() {\n    this.option(\"value\", null);\n  },\n  _shouldOpenPopup: function _shouldOpenPopup() {\n    return this._needPassDataSourceToList();\n  },\n  _isFocused: function _isFocused() {\n    var activeElement = domAdapter.getActiveElement();\n    return this.callBase() && $(activeElement).closest(this._input()).length > 0;\n  },\n  _renderValueChangeEvent: function _renderValueChangeEvent() {\n    if (this._isEditable()) {\n      this.callBase();\n    }\n  },\n  _isEditable: function _isEditable() {\n    return this.option(\"acceptCustomValue\") || this.option(\"searchEnabled\");\n  },\n  _fieldRenderData: function _fieldRenderData() {\n    var $listFocused = this._list && this.option(\"opened\") && $(this._list.option(\"focusedElement\"));\n\n    if ($listFocused && $listFocused.length) {\n      return this._list._getItemData($listFocused);\n    }\n\n    return this.option(\"selectedItem\");\n  },\n  _readOnlyPropValue: function _readOnlyPropValue() {\n    return !this._isEditable() || this.option(\"readOnly\");\n  },\n  _isSelectedValue: function _isSelectedValue(value) {\n    return this._isValueEquals(value, this.option(\"value\"));\n  },\n  _shouldCloseOnItemClick: function _shouldCloseOnItemClick() {\n    return !(this.option(\"showSelectionControls\") && \"single\" !== this.option(\"selectionMode\"));\n  },\n  _listItemClickHandler: function _listItemClickHandler(e) {\n    var previousValue = this._getCurrentValue();\n\n    this._focusListElement($(e.itemElement));\n\n    this._saveValueChangeEvent(e.event);\n\n    if (this._shouldClearFilter()) {\n      this._clearFilter();\n    }\n\n    this._completeSelection(this._valueGetter(e.itemData));\n\n    if (this._shouldCloseOnItemClick()) {\n      this.option(\"opened\", false);\n    }\n\n    if (this.option(\"searchEnabled\") && previousValue === this._valueGetter(e.itemData)) {\n      this._updateField(e.itemData);\n    }\n  },\n  _shouldClearFilter: function _shouldClearFilter() {\n    return this._wasSearch();\n  },\n  _completeSelection: function _completeSelection(value) {\n    this._setValue(value);\n  },\n  _loadItem: function _loadItem(value, cache) {\n    var that = this;\n    var deferred = new Deferred();\n    this.callBase(value, cache).done(function (item) {\n      deferred.resolve(item);\n    }.bind(this)).fail(function () {\n      var selectedItem = that.option(\"selectedItem\");\n\n      if (that.option(\"acceptCustomValue\") && value === that._valueGetter(selectedItem)) {\n        deferred.resolve(selectedItem);\n      } else {\n        deferred.reject();\n      }\n    }.bind(this));\n    return deferred.promise();\n  },\n  _loadInputValue: function _loadInputValue(value, callback) {\n    this._loadItemDeferred = this._loadItem(value).always(callback);\n    return this._loadItemDeferred;\n  },\n  _isCustomItemSelected: function _isCustomItemSelected() {\n    var selectedItem = this.option(\"selectedItem\");\n\n    var searchValue = this._searchValue();\n\n    var selectedItemText = this._displayGetter(selectedItem);\n\n    return !selectedItemText || searchValue !== selectedItemText.toString();\n  },\n  _valueChangeEventHandler: function _valueChangeEventHandler(e) {\n    if (this.option(\"acceptCustomValue\") && this._isCustomItemSelected()) {\n      this._customItemAddedHandler(e);\n    }\n  },\n  _initCustomItemCreatingAction: function _initCustomItemCreatingAction() {\n    this._customItemCreatingAction = this._createActionByOption(\"onCustomItemCreating\");\n  },\n  _createCustomItem: function _createCustomItem(text) {\n    var params = {\n      text: text\n    };\n\n    var actionResult = this._customItemCreatingAction(params);\n\n    var item = commonUtils.ensureDefined(actionResult, params.customItem);\n\n    if (isDefined(actionResult)) {\n      errors.log(\"W0015\", \"onCustomItemCreating\", \"customItem\");\n    }\n\n    return item;\n  },\n  _customItemAddedHandler: function _customItemAddedHandler(e) {\n    var searchValue = this._searchValue();\n\n    var item = this._createCustomItem(searchValue);\n\n    this._saveValueChangeEvent(e);\n\n    if (void 0 === item) {\n      this._renderValue();\n\n      throw errors.Error(\"E0121\");\n    }\n\n    if (isPromise(item)) {\n      deferredUtils.fromPromise(item).done(this._setCustomItem.bind(this)).fail(this._setCustomItem.bind(this, null));\n    } else {\n      this._setCustomItem(item);\n    }\n  },\n  _setCustomItem: function _setCustomItem(item) {\n    if (this._disposed) {\n      return;\n    }\n\n    item = item || null;\n    this.option(\"selectedItem\", item);\n\n    if (this._shouldClearFilter()) {\n      this._filterDataSource(null);\n    }\n\n    this._setValue(this._valueGetter(item));\n\n    this._renderDisplayText(this._displayGetter(item));\n  },\n  _clearValueHandler: function _clearValueHandler(e) {\n    this.callBase(e);\n    return false;\n  },\n  _wasSearch: function _wasSearch(value) {\n    if (!arguments.length) {\n      return this._wasSearchValue;\n    }\n\n    this._wasSearchValue = value;\n  },\n  _searchHandler: function _searchHandler(e) {\n    if (this._preventFiltering) {\n      delete this._preventFiltering;\n      return;\n    }\n\n    if (this._needPassDataSourceToList()) {\n      this._wasSearch(true);\n    }\n\n    this.callBase(e);\n  },\n  _dataSourceFiltered: function _dataSourceFiltered(searchValue) {\n    this.callBase();\n\n    if (null !== searchValue) {\n      this._renderInputSubstitution();\n\n      this._renderFocusedElement();\n    }\n  },\n  _valueSubstituted: function _valueSubstituted() {\n    var input = this._input().get(0);\n\n    var isAllSelected = 0 === input.selectionStart && input.selectionEnd === this._searchValue().length;\n\n    var inputHasSelection = input.selectionStart !== input.selectionEnd;\n    return this._wasSearch() && inputHasSelection && !isAllSelected;\n  },\n  _shouldSubstitutionBeRendered: function _shouldSubstitutionBeRendered() {\n    return this.option(\"autocompletionEnabled\") && !this._preventSubstitution && this.option(\"searchEnabled\") && !this.option(\"acceptCustomValue\") && \"startswith\" === this.option(\"searchMode\");\n  },\n  _renderInputSubstitution: function _renderInputSubstitution() {\n    if (!this._shouldSubstitutionBeRendered()) {\n      delete this._preventSubstitution;\n      return;\n    }\n\n    var item = this._list && this._getPlainItems(this._list.option(\"items\"))[0];\n\n    if (!item) {\n      return;\n    }\n\n    var $input = this._input();\n\n    var valueLength = $input.val().length;\n\n    if (0 === valueLength) {\n      return;\n    }\n\n    var inputElement = $input.get(0);\n\n    var displayValue = this._displayGetter(item).toString();\n\n    inputElement.value = displayValue;\n\n    this._caret({\n      start: valueLength,\n      end: displayValue.length\n    });\n  },\n  _cleanInputSelection: function _cleanInputSelection() {\n    var inputElement = this._input().get(0);\n\n    var endPosition = inputElement.value.length;\n    inputElement.selectionStart = endPosition;\n    inputElement.selectionEnd = endPosition;\n  },\n  _dispose: function _dispose() {\n    this._renderInputValueAsync = commonUtils.noop;\n    delete this._loadItemDeferred;\n    this.callBase();\n  },\n  _optionChanged: function _optionChanged(args) {\n    switch (args.name) {\n      case \"_isAdaptablePopupPosition\":\n      case \"autocompletionEnabled\":\n        break;\n\n      case \"onCustomItemCreating\":\n        this._initCustomItemCreatingAction();\n\n        break;\n\n      case \"tooltipEnabled\":\n        this._renderTooltip();\n\n        break;\n\n      case \"displayCustomValue\":\n      case \"acceptCustomValue\":\n      case \"showSelectionControls\":\n      case \"useInkRipple\":\n        this._invalidate();\n\n        break;\n\n      case \"selectedItem\":\n        if (args.previousValue !== args.value) {\n          this.callBase(args);\n        }\n\n        break;\n\n      case \"allowClearing\":\n        break;\n\n      default:\n        this.callBase(args);\n    }\n  },\n  _clean: function _clean() {\n    delete this._inkRipple;\n    this.callBase();\n  }\n});\nregisterComponent(\"dxSelectBox\", SelectBox);\nmodule.exports = SelectBox;\nmodule.exports.default = module.exports;","map":{"version":3,"sources":["C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/devextreme/ui/select_box.js"],"names":["$","require","commonUtils","typeUtils","isDefined","isPromise","extend","inArray","each","deferredUtils","getPublicElement","Deferred","errors","domAdapter","inkRipple","messageLocalization","registerComponent","DropDownList","DISABLED_STATE_SELECTOR","SELECTBOX_CLASS","SELECTBOX_POPUP_CLASS","SELECTBOX_CONTAINER_CLASS","SELECTBOX_POPUP_WRAPPER_CLASS","SelectBox","inherit","_supportedKeys","that","parent","callBase","clearSelectBox","e","isEditable","_isEditable","option","preventDefault","reset","_valueSubstituted","_preventFiltering","_preventSubstitution","searchIfNeeded","_searchHandler","tab","_cleanInputSelection","_wasSearch","_clearFilter","apply","arguments","upArrow","_setNextValue","downArrow","leftArrow","rightArrow","home","end","escape","result","_cancelEditing","enter","isOpened","inputText","_input","val","trim","isCustomText","_list","selectedItem","value","close","_valueChangeEventHandler","_toggleOpenState","space","isSearchEnabled","acceptCustomValue","backspace","del","_getDefaultOptions","placeholder","format","fieldTemplate","valueChangeEvent","onCustomItemCreating","customItem","text","showSelectionControls","autocompletionEnabled","allowClearing","tooltipEnabled","openOnFieldClick","showDropDownButton","displayCustomValue","_isAdaptablePopupPosition","useInkRipple","useHiddenSubmitElement","_init","_initCustomItemCreatingAction","_initMarkup","$element","addClass","_renderTooltip","_renderInkRipple","_$container","_inkRipple","render","_toggleActiveState","config","element","_inputWrapper","event","showWave","hideWave","_createPopup","_popup","_popupWrapperClass","_focusListElement","_updateField","_renderOpenedState","_scrollToSelectedItem","_focusSelectedElement","searchValue","_searchValue","$listItems","_itemElements","index","focusedElement","_isCustomItemSelected","eq","_renderFocusedElement","not","_preventInputValueRender","scrollToItem","_listContentReadyHandler","isPaginate","_dataSource","paginate","_needPopupRepaint","_renderValue","_renderInputValue","_setSubmitValue","resolve","always","_renderInputValueAsync","bind","_renderInputValueImpl","_refreshSelected","_renderField","_setNextItem","step","item","_calcNextItem","_valueGetter","_setValue","dataSourceIsLoaded","isLoaded","load","done","selectedIndex","_getSelectedIndex","hasPages","pageSize","isLastPage","isLastItem","_items","length","_saveValueChangeEvent","key","_loadNextPage","_setSelectedItem","isUnknownItem","_isCustomValueAllowed","_setListOption","_displayValue","_listConfig","pageLoadMode","onSelectionChanged","_getSelectionChangeHandler","onFocusedItemChanged","_listFocusedItemChangeHandler","selectionByClick","list","component","focusedItem","_getItemData","_getTemplateByOption","_renderDisplayText","_displayGetter","_selectionChangeHandler","noop","addedItems","_","addedItem","_getActualSearchValue","isVisible","_restoreInputText","showDataImmediately","_searchTimer","_filterDataSource","attr","_renderDimensions","_setPopupOption","_isValueEqualInputText","initialSelectedItem","displayValue","String","_popupHidingHandler","saveEditingValue","_loadItemDeferred","_clearTextValue","newSelectedItem","ensureDefined","_focusOutHandler","_preventNestedFocusEvent","_clearSearchTimer","_isOverlayNestedTarget","relatedTarget","_searchCanceled","target","closest","concat","_shouldOpenPopup","_needPassDataSourceToList","_isFocused","activeElement","getActiveElement","_renderValueChangeEvent","_fieldRenderData","$listFocused","_readOnlyPropValue","_isSelectedValue","_isValueEquals","_shouldCloseOnItemClick","_listItemClickHandler","previousValue","_getCurrentValue","itemElement","_shouldClearFilter","_completeSelection","itemData","_loadItem","cache","deferred","fail","reject","promise","_loadInputValue","callback","selectedItemText","toString","_customItemAddedHandler","_customItemCreatingAction","_createActionByOption","_createCustomItem","params","actionResult","log","Error","fromPromise","_setCustomItem","_disposed","_clearValueHandler","_wasSearchValue","_dataSourceFiltered","_renderInputSubstitution","input","get","isAllSelected","selectionStart","selectionEnd","inputHasSelection","_shouldSubstitutionBeRendered","_getPlainItems","$input","valueLength","inputElement","_caret","start","endPosition","_dispose","_optionChanged","args","name","_invalidate","_clean","module","exports","default"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/select_box.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar $ = require(\"../core/renderer\");\r\nvar commonUtils = require(\"../core/utils/common\");\r\nvar typeUtils = require(\"../core/utils/type\");\r\nvar isDefined = typeUtils.isDefined;\r\nvar isPromise = typeUtils.isPromise;\r\nvar extend = require(\"../core/utils/extend\").extend;\r\nvar inArray = require(\"../core/utils/array\").inArray;\r\nvar each = require(\"../core/utils/iterator\").each;\r\nvar deferredUtils = require(\"../core/utils/deferred\");\r\nvar getPublicElement = require(\"../core/utils/dom\").getPublicElement;\r\nvar Deferred = deferredUtils.Deferred;\r\nvar errors = require(\"../core/errors\");\r\nvar domAdapter = require(\"../core/dom_adapter\");\r\nvar inkRipple = require(\"./widget/utils.ink_ripple\");\r\nvar messageLocalization = require(\"../localization/message\");\r\nvar registerComponent = require(\"../core/component_registrator\");\r\nvar DropDownList = require(\"./drop_down_editor/ui.drop_down_list\");\r\nvar DISABLED_STATE_SELECTOR = \".dx-state-disabled\";\r\nvar SELECTBOX_CLASS = \"dx-selectbox\";\r\nvar SELECTBOX_POPUP_CLASS = \"dx-selectbox-popup\";\r\nvar SELECTBOX_CONTAINER_CLASS = \"dx-selectbox-container\";\r\nvar SELECTBOX_POPUP_WRAPPER_CLASS = \"dx-selectbox-popup-wrapper\";\r\nvar SelectBox = DropDownList.inherit({\r\n    _supportedKeys: function() {\r\n        var that = this;\r\n        var parent = this.callBase();\r\n        var clearSelectBox = function(e) {\r\n            var isEditable = this._isEditable();\r\n            if (!isEditable) {\r\n                if (this.option(\"showClearButton\")) {\r\n                    e.preventDefault();\r\n                    this.reset()\r\n                }\r\n            } else {\r\n                if (this._valueSubstituted()) {\r\n                    this._preventFiltering = true\r\n                }\r\n            }\r\n            this._preventSubstitution = true\r\n        };\r\n        var searchIfNeeded = function() {\r\n            if (that.option(\"searchEnabled\") && that._valueSubstituted()) {\r\n                that._searchHandler()\r\n            }\r\n        };\r\n        return extend({}, parent, {\r\n            tab: function() {\r\n                if (this.option(\"opened\") && \"instantly\" === this.option(\"applyValueMode\")) {\r\n                    this._cleanInputSelection()\r\n                }\r\n                if (this._wasSearch()) {\r\n                    this._clearFilter()\r\n                }\r\n                parent.tab && parent.tab.apply(this, arguments)\r\n            },\r\n            upArrow: function(e) {\r\n                if (parent.upArrow && parent.upArrow.apply(this, arguments)) {\r\n                    if (!this.option(\"opened\")) {\r\n                        this._setNextValue(e)\r\n                    }\r\n                    return true\r\n                }\r\n            },\r\n            downArrow: function(e) {\r\n                if (parent.downArrow && parent.downArrow.apply(this, arguments)) {\r\n                    if (!this.option(\"opened\")) {\r\n                        this._setNextValue(e)\r\n                    }\r\n                    return true\r\n                }\r\n            },\r\n            leftArrow: function() {\r\n                searchIfNeeded();\r\n                parent.leftArrow && parent.leftArrow.apply(this, arguments)\r\n            },\r\n            rightArrow: function() {\r\n                searchIfNeeded();\r\n                parent.rightArrow && parent.rightArrow.apply(this, arguments)\r\n            },\r\n            home: function() {\r\n                searchIfNeeded();\r\n                parent.home && parent.home.apply(this, arguments)\r\n            },\r\n            end: function() {\r\n                searchIfNeeded();\r\n                parent.end && parent.end.apply(this, arguments)\r\n            },\r\n            escape: function() {\r\n                var result = parent.escape && parent.escape.apply(this, arguments);\r\n                this._cancelEditing();\r\n                return isDefined(result) ? result : true\r\n            },\r\n            enter: function(e) {\r\n                var isOpened = this.option(\"opened\");\r\n                var inputText = this._input().val().trim();\r\n                var isCustomText = inputText && this._list && !this._list.option(\"focusedElement\");\r\n                if (!inputText && this.option(\"value\") && this.option(\"allowClearing\")) {\r\n                    this.option({\r\n                        selectedItem: null,\r\n                        value: null\r\n                    });\r\n                    this.close()\r\n                } else {\r\n                    if (this.option(\"acceptCustomValue\")) {\r\n                        e.preventDefault();\r\n                        if (isCustomText) {\r\n                            this._valueChangeEventHandler(e);\r\n                            if (isOpened) {\r\n                                this._toggleOpenState()\r\n                            }\r\n                        }\r\n                        return isOpened\r\n                    }\r\n                    if (parent.enter && parent.enter.apply(this, arguments)) {\r\n                        return isOpened\r\n                    }\r\n                }\r\n            },\r\n            space: function(e) {\r\n                var isOpened = this.option(\"opened\");\r\n                var isSearchEnabled = this.option(\"searchEnabled\");\r\n                var acceptCustomValue = this.option(\"acceptCustomValue\");\r\n                if (!isOpened || isSearchEnabled || acceptCustomValue) {\r\n                    return\r\n                }\r\n                e.preventDefault();\r\n                this._valueChangeEventHandler(e);\r\n                return true\r\n            },\r\n            backspace: clearSelectBox,\r\n            del: clearSelectBox\r\n        })\r\n    },\r\n    _getDefaultOptions: function() {\r\n        return extend(this.callBase(), {\r\n            placeholder: messageLocalization.format(\"Select\"),\r\n            fieldTemplate: null,\r\n            valueChangeEvent: \"change\",\r\n            acceptCustomValue: false,\r\n            onCustomItemCreating: function(e) {\r\n                if (!isDefined(e.customItem)) {\r\n                    e.customItem = e.text\r\n                }\r\n            },\r\n            showSelectionControls: false,\r\n            autocompletionEnabled: true,\r\n            allowClearing: true,\r\n            tooltipEnabled: false,\r\n            openOnFieldClick: true,\r\n            showDropDownButton: true,\r\n            displayCustomValue: false,\r\n            _isAdaptablePopupPosition: false,\r\n            useInkRipple: false,\r\n            useHiddenSubmitElement: true\r\n        })\r\n    },\r\n    _init: function() {\r\n        this.callBase();\r\n        this._initCustomItemCreatingAction()\r\n    },\r\n    _initMarkup: function() {\r\n        this.$element().addClass(SELECTBOX_CLASS);\r\n        this._renderTooltip();\r\n        this.option(\"useInkRipple\") && this._renderInkRipple();\r\n        this.callBase();\r\n        this._$container.addClass(SELECTBOX_CONTAINER_CLASS)\r\n    },\r\n    _renderInkRipple: function() {\r\n        this._inkRipple = inkRipple.render()\r\n    },\r\n    _toggleActiveState: function($element, value, e) {\r\n        this.callBase.apply(this, arguments);\r\n        if (!this._inkRipple || this._isEditable()) {\r\n            return\r\n        }\r\n        var config = {\r\n            element: this._inputWrapper(),\r\n            event: e\r\n        };\r\n        if (value) {\r\n            this._inkRipple.showWave(config)\r\n        } else {\r\n            this._inkRipple.hideWave(config)\r\n        }\r\n    },\r\n    _createPopup: function() {\r\n        this.callBase();\r\n        this._popup.$element().addClass(SELECTBOX_POPUP_CLASS)\r\n    },\r\n    _popupWrapperClass: function() {\r\n        return this.callBase() + \" \" + SELECTBOX_POPUP_WRAPPER_CLASS\r\n    },\r\n    _cancelEditing: function() {\r\n        if (!this.option(\"searchEnabled\") && this._list) {\r\n            this._focusListElement(null);\r\n            this._updateField(this.option(\"selectedItem\"))\r\n        }\r\n    },\r\n    _renderOpenedState: function() {\r\n        this.callBase();\r\n        if (this.option(\"opened\")) {\r\n            this._scrollToSelectedItem();\r\n            this._focusSelectedElement()\r\n        }\r\n    },\r\n    _focusSelectedElement: function() {\r\n        var searchValue = this._searchValue();\r\n        if (!searchValue) {\r\n            this._focusListElement(null);\r\n            return\r\n        }\r\n        var $listItems = this._list._itemElements();\r\n        var index = inArray(this.option(\"selectedItem\"), this.option(\"items\"));\r\n        var focusedElement = index >= 0 && !this._isCustomItemSelected() ? $listItems.eq(index) : null;\r\n        this._focusListElement(focusedElement)\r\n    },\r\n    _renderFocusedElement: function() {\r\n        if (!this._list) {\r\n            return\r\n        }\r\n        var searchValue = this._searchValue();\r\n        if (!searchValue || this.option(\"acceptCustomValue\")) {\r\n            this._focusListElement(null);\r\n            return\r\n        }\r\n        var $listItems = this._list._itemElements();\r\n        var focusedElement = $listItems.not(DISABLED_STATE_SELECTOR).eq(0);\r\n        this._focusListElement(focusedElement)\r\n    },\r\n    _focusListElement: function(element) {\r\n        this._preventInputValueRender = true;\r\n        this._list.option(\"focusedElement\", getPublicElement(element));\r\n        delete this._preventInputValueRender\r\n    },\r\n    _scrollToSelectedItem: function() {\r\n        this._list && this._list.scrollToItem(this._list.option(\"selectedItem\"))\r\n    },\r\n    _listContentReadyHandler: function() {\r\n        this.callBase();\r\n        var isPaginate = this._dataSource && this._dataSource.paginate();\r\n        if (isPaginate && this._needPopupRepaint()) {\r\n            return\r\n        }\r\n        this._scrollToSelectedItem()\r\n    },\r\n    _renderValue: function() {\r\n        this._renderInputValue();\r\n        this._setSubmitValue();\r\n        return (new Deferred).resolve()\r\n    },\r\n    _renderInputValue: function() {\r\n        return this.callBase().always(function() {\r\n            this._renderInputValueAsync()\r\n        }.bind(this))\r\n    },\r\n    _renderInputValueAsync: function() {\r\n        this._renderTooltip();\r\n        this._renderInputValueImpl().always(function() {\r\n            this._refreshSelected()\r\n        }.bind(this))\r\n    },\r\n    _renderInputValueImpl: function() {\r\n        this._renderField();\r\n        return (new Deferred).resolve()\r\n    },\r\n    _setNextItem: function(step) {\r\n        var item = this._calcNextItem(step);\r\n        var value = this._valueGetter(item);\r\n        this._setValue(value)\r\n    },\r\n    _setNextValue: function(e) {\r\n        var dataSourceIsLoaded = this._dataSource.isLoaded() ? (new Deferred).resolve() : this._dataSource.load();\r\n        dataSourceIsLoaded.done(function() {\r\n            var selectedIndex = this._getSelectedIndex();\r\n            var hasPages = this._dataSource.pageSize();\r\n            var isLastPage = this._dataSource.isLastPage();\r\n            var isLastItem = selectedIndex === this._items().length - 1;\r\n            this._saveValueChangeEvent(e);\r\n            var step = \"ArrowDown\" === e.key ? 1 : -1;\r\n            if (hasPages && !isLastPage && isLastItem && step > 0) {\r\n                if (!this._popup) {\r\n                    this._createPopup()\r\n                }\r\n                this._list._loadNextPage().done(this._setNextItem.bind(this, step))\r\n            } else {\r\n                this._setNextItem(step)\r\n            }\r\n        }.bind(this))\r\n    },\r\n    _setSelectedItem: function(item) {\r\n        var isUnknownItem = !this._isCustomValueAllowed() && void 0 === item;\r\n        this.callBase(isUnknownItem ? null : item);\r\n        if (!isUnknownItem && (!this._isEditable() || this._isCustomItemSelected())) {\r\n            this._setListOption(\"selectedItem\", this.option(\"selectedItem\"))\r\n        }\r\n    },\r\n    _isCustomValueAllowed: function() {\r\n        return this.option(\"acceptCustomValue\") || this.callBase()\r\n    },\r\n    _displayValue: function(item) {\r\n        item = !isDefined(item) && this._isCustomValueAllowed() ? this.option(\"value\") : item;\r\n        return this.callBase(item)\r\n    },\r\n    _listConfig: function() {\r\n        var result = extend(this.callBase(), {\r\n            pageLoadMode: \"scrollBottom\",\r\n            onSelectionChanged: this._getSelectionChangeHandler(),\r\n            selectedItem: this.option(\"selectedItem\"),\r\n            onFocusedItemChanged: this._listFocusedItemChangeHandler.bind(this)\r\n        });\r\n        if (this.option(\"showSelectionControls\")) {\r\n            extend(result, {\r\n                showSelectionControls: true,\r\n                selectionByClick: true\r\n            })\r\n        }\r\n        return result\r\n    },\r\n    _listFocusedItemChangeHandler: function(e) {\r\n        if (this._preventInputValueRender) {\r\n            return\r\n        }\r\n        var list = e.component;\r\n        var focusedElement = $(list.option(\"focusedElement\"));\r\n        var focusedItem = list._getItemData(focusedElement);\r\n        this._updateField(focusedItem)\r\n    },\r\n    _updateField: function(item) {\r\n        var fieldTemplate = this._getTemplateByOption(\"fieldTemplate\");\r\n        if (!(fieldTemplate && this.option(\"fieldTemplate\"))) {\r\n            this._renderDisplayText(this._displayGetter(item));\r\n            return\r\n        }\r\n        this._renderField()\r\n    },\r\n    _getSelectionChangeHandler: function() {\r\n        return this.option(\"showSelectionControls\") ? this._selectionChangeHandler.bind(this) : commonUtils.noop\r\n    },\r\n    _selectionChangeHandler: function(e) {\r\n        each(e.addedItems || [], function(_, addedItem) {\r\n            this._setValue(this._valueGetter(addedItem))\r\n        }.bind(this))\r\n    },\r\n    _getActualSearchValue: function() {\r\n        return this._dataSource.searchValue()\r\n    },\r\n    _toggleOpenState: function(isVisible) {\r\n        if (this.option(\"disabled\")) {\r\n            return\r\n        }\r\n        isVisible = arguments.length ? isVisible : !this.option(\"opened\");\r\n        if (!isVisible) {\r\n            this._restoreInputText(true)\r\n        }\r\n        if (this._wasSearch() && isVisible) {\r\n            this._wasSearch(false);\r\n            var showDataImmediately = this.option(\"showDataBeforeSearch\") || 0 === this.option(\"minSearchLength\");\r\n            if (showDataImmediately && this._dataSource) {\r\n                if (this._searchTimer) {\r\n                    return\r\n                }\r\n                var searchValue = this._getActualSearchValue();\r\n                searchValue && this._wasSearch(true);\r\n                this._filterDataSource(searchValue || null)\r\n            } else {\r\n                this._setListOption(\"items\", [])\r\n            }\r\n        }\r\n        if (isVisible) {\r\n            this._scrollToSelectedItem()\r\n        }\r\n        this.callBase(isVisible)\r\n    },\r\n    _renderTooltip: function() {\r\n        if (this.option(\"tooltipEnabled\")) {\r\n            this.$element().attr(\"title\", this.option(\"displayValue\"))\r\n        }\r\n    },\r\n    _renderDimensions: function() {\r\n        this.callBase();\r\n        this._setPopupOption(\"width\")\r\n    },\r\n    _isValueEqualInputText: function() {\r\n        var initialSelectedItem = this.option(\"selectedItem\");\r\n        var value = this._displayGetter(initialSelectedItem);\r\n        var displayValue = value ? String(value) : \"\";\r\n        var inputText = this._searchValue();\r\n        return displayValue === inputText\r\n    },\r\n    _popupHidingHandler: function() {\r\n        if (this._isValueEqualInputText()) {\r\n            this._cancelEditing()\r\n        }\r\n        this.callBase()\r\n    },\r\n    _restoreInputText: function(saveEditingValue) {\r\n        if (this.option(\"readOnly\")) {\r\n            return\r\n        }\r\n        this._loadItemDeferred && this._loadItemDeferred.always(function() {\r\n            var initialSelectedItem = this.option(\"selectedItem\");\r\n            if (this.option(\"acceptCustomValue\")) {\r\n                if (!saveEditingValue) {\r\n                    this._updateField(initialSelectedItem);\r\n                    this._clearFilter()\r\n                }\r\n                return\r\n            }\r\n            if (this.option(\"searchEnabled\")) {\r\n                if (!this._searchValue() && this.option(\"allowClearing\")) {\r\n                    this._clearTextValue();\r\n                    return\r\n                }\r\n            }\r\n            if (this._isValueEqualInputText()) {\r\n                return\r\n            }\r\n            this._renderInputValue().always(function(selectedItem) {\r\n                var newSelectedItem = commonUtils.ensureDefined(selectedItem, initialSelectedItem);\r\n                this._setSelectedItem(newSelectedItem);\r\n                this._updateField(newSelectedItem);\r\n                this._clearFilter()\r\n            }.bind(this))\r\n        }.bind(this))\r\n    },\r\n    _focusOutHandler: function(e) {\r\n        if (!this._preventNestedFocusEvent(e)) {\r\n            this._clearSearchTimer();\r\n            this._restoreInputText();\r\n            if (!this.option(\"acceptCustomValue\") && this.option(\"searchEnabled\") && !this._isOverlayNestedTarget(e.relatedTarget)) {\r\n                this._searchCanceled()\r\n            }\r\n        }\r\n        this.callBase(e)\r\n    },\r\n    _isOverlayNestedTarget: function(target) {\r\n        return !!$(target).closest(\".\".concat(SELECTBOX_POPUP_WRAPPER_CLASS)).length\r\n    },\r\n    _clearTextValue: function() {\r\n        this.option(\"value\", null)\r\n    },\r\n    _shouldOpenPopup: function() {\r\n        return this._needPassDataSourceToList()\r\n    },\r\n    _isFocused: function() {\r\n        var activeElement = domAdapter.getActiveElement();\r\n        return this.callBase() && $(activeElement).closest(this._input()).length > 0\r\n    },\r\n    _renderValueChangeEvent: function() {\r\n        if (this._isEditable()) {\r\n            this.callBase()\r\n        }\r\n    },\r\n    _isEditable: function() {\r\n        return this.option(\"acceptCustomValue\") || this.option(\"searchEnabled\")\r\n    },\r\n    _fieldRenderData: function() {\r\n        var $listFocused = this._list && this.option(\"opened\") && $(this._list.option(\"focusedElement\"));\r\n        if ($listFocused && $listFocused.length) {\r\n            return this._list._getItemData($listFocused)\r\n        }\r\n        return this.option(\"selectedItem\")\r\n    },\r\n    _readOnlyPropValue: function() {\r\n        return !this._isEditable() || this.option(\"readOnly\")\r\n    },\r\n    _isSelectedValue: function(value) {\r\n        return this._isValueEquals(value, this.option(\"value\"))\r\n    },\r\n    _shouldCloseOnItemClick: function() {\r\n        return !(this.option(\"showSelectionControls\") && \"single\" !== this.option(\"selectionMode\"))\r\n    },\r\n    _listItemClickHandler: function(e) {\r\n        var previousValue = this._getCurrentValue();\r\n        this._focusListElement($(e.itemElement));\r\n        this._saveValueChangeEvent(e.event);\r\n        if (this._shouldClearFilter()) {\r\n            this._clearFilter()\r\n        }\r\n        this._completeSelection(this._valueGetter(e.itemData));\r\n        if (this._shouldCloseOnItemClick()) {\r\n            this.option(\"opened\", false)\r\n        }\r\n        if (this.option(\"searchEnabled\") && previousValue === this._valueGetter(e.itemData)) {\r\n            this._updateField(e.itemData)\r\n        }\r\n    },\r\n    _shouldClearFilter: function() {\r\n        return this._wasSearch()\r\n    },\r\n    _completeSelection: function(value) {\r\n        this._setValue(value)\r\n    },\r\n    _loadItem: function(value, cache) {\r\n        var that = this;\r\n        var deferred = new Deferred;\r\n        this.callBase(value, cache).done(function(item) {\r\n            deferred.resolve(item)\r\n        }.bind(this)).fail(function() {\r\n            var selectedItem = that.option(\"selectedItem\");\r\n            if (that.option(\"acceptCustomValue\") && value === that._valueGetter(selectedItem)) {\r\n                deferred.resolve(selectedItem)\r\n            } else {\r\n                deferred.reject()\r\n            }\r\n        }.bind(this));\r\n        return deferred.promise()\r\n    },\r\n    _loadInputValue: function(value, callback) {\r\n        this._loadItemDeferred = this._loadItem(value).always(callback);\r\n        return this._loadItemDeferred\r\n    },\r\n    _isCustomItemSelected: function() {\r\n        var selectedItem = this.option(\"selectedItem\");\r\n        var searchValue = this._searchValue();\r\n        var selectedItemText = this._displayGetter(selectedItem);\r\n        return !selectedItemText || searchValue !== selectedItemText.toString()\r\n    },\r\n    _valueChangeEventHandler: function(e) {\r\n        if (this.option(\"acceptCustomValue\") && this._isCustomItemSelected()) {\r\n            this._customItemAddedHandler(e)\r\n        }\r\n    },\r\n    _initCustomItemCreatingAction: function() {\r\n        this._customItemCreatingAction = this._createActionByOption(\"onCustomItemCreating\")\r\n    },\r\n    _createCustomItem: function(text) {\r\n        var params = {\r\n            text: text\r\n        };\r\n        var actionResult = this._customItemCreatingAction(params);\r\n        var item = commonUtils.ensureDefined(actionResult, params.customItem);\r\n        if (isDefined(actionResult)) {\r\n            errors.log(\"W0015\", \"onCustomItemCreating\", \"customItem\")\r\n        }\r\n        return item\r\n    },\r\n    _customItemAddedHandler: function(e) {\r\n        var searchValue = this._searchValue();\r\n        var item = this._createCustomItem(searchValue);\r\n        this._saveValueChangeEvent(e);\r\n        if (void 0 === item) {\r\n            this._renderValue();\r\n            throw errors.Error(\"E0121\")\r\n        }\r\n        if (isPromise(item)) {\r\n            deferredUtils.fromPromise(item).done(this._setCustomItem.bind(this)).fail(this._setCustomItem.bind(this, null))\r\n        } else {\r\n            this._setCustomItem(item)\r\n        }\r\n    },\r\n    _setCustomItem: function(item) {\r\n        if (this._disposed) {\r\n            return\r\n        }\r\n        item = item || null;\r\n        this.option(\"selectedItem\", item);\r\n        if (this._shouldClearFilter()) {\r\n            this._filterDataSource(null)\r\n        }\r\n        this._setValue(this._valueGetter(item));\r\n        this._renderDisplayText(this._displayGetter(item))\r\n    },\r\n    _clearValueHandler: function(e) {\r\n        this.callBase(e);\r\n        return false\r\n    },\r\n    _wasSearch: function(value) {\r\n        if (!arguments.length) {\r\n            return this._wasSearchValue\r\n        }\r\n        this._wasSearchValue = value\r\n    },\r\n    _searchHandler: function(e) {\r\n        if (this._preventFiltering) {\r\n            delete this._preventFiltering;\r\n            return\r\n        }\r\n        if (this._needPassDataSourceToList()) {\r\n            this._wasSearch(true)\r\n        }\r\n        this.callBase(e)\r\n    },\r\n    _dataSourceFiltered: function(searchValue) {\r\n        this.callBase();\r\n        if (null !== searchValue) {\r\n            this._renderInputSubstitution();\r\n            this._renderFocusedElement()\r\n        }\r\n    },\r\n    _valueSubstituted: function() {\r\n        var input = this._input().get(0);\r\n        var isAllSelected = 0 === input.selectionStart && input.selectionEnd === this._searchValue().length;\r\n        var inputHasSelection = input.selectionStart !== input.selectionEnd;\r\n        return this._wasSearch() && inputHasSelection && !isAllSelected\r\n    },\r\n    _shouldSubstitutionBeRendered: function() {\r\n        return this.option(\"autocompletionEnabled\") && !this._preventSubstitution && this.option(\"searchEnabled\") && !this.option(\"acceptCustomValue\") && \"startswith\" === this.option(\"searchMode\")\r\n    },\r\n    _renderInputSubstitution: function() {\r\n        if (!this._shouldSubstitutionBeRendered()) {\r\n            delete this._preventSubstitution;\r\n            return\r\n        }\r\n        var item = this._list && this._getPlainItems(this._list.option(\"items\"))[0];\r\n        if (!item) {\r\n            return\r\n        }\r\n        var $input = this._input();\r\n        var valueLength = $input.val().length;\r\n        if (0 === valueLength) {\r\n            return\r\n        }\r\n        var inputElement = $input.get(0);\r\n        var displayValue = this._displayGetter(item).toString();\r\n        inputElement.value = displayValue;\r\n        this._caret({\r\n            start: valueLength,\r\n            end: displayValue.length\r\n        })\r\n    },\r\n    _cleanInputSelection: function() {\r\n        var inputElement = this._input().get(0);\r\n        var endPosition = inputElement.value.length;\r\n        inputElement.selectionStart = endPosition;\r\n        inputElement.selectionEnd = endPosition\r\n    },\r\n    _dispose: function() {\r\n        this._renderInputValueAsync = commonUtils.noop;\r\n        delete this._loadItemDeferred;\r\n        this.callBase()\r\n    },\r\n    _optionChanged: function(args) {\r\n        switch (args.name) {\r\n            case \"_isAdaptablePopupPosition\":\r\n            case \"autocompletionEnabled\":\r\n                break;\r\n            case \"onCustomItemCreating\":\r\n                this._initCustomItemCreatingAction();\r\n                break;\r\n            case \"tooltipEnabled\":\r\n                this._renderTooltip();\r\n                break;\r\n            case \"displayCustomValue\":\r\n            case \"acceptCustomValue\":\r\n            case \"showSelectionControls\":\r\n            case \"useInkRipple\":\r\n                this._invalidate();\r\n                break;\r\n            case \"selectedItem\":\r\n                if (args.previousValue !== args.value) {\r\n                    this.callBase(args)\r\n                }\r\n                break;\r\n            case \"allowClearing\":\r\n                break;\r\n            default:\r\n                this.callBase(args)\r\n        }\r\n    },\r\n    _clean: function() {\r\n        delete this._inkRipple;\r\n        this.callBase()\r\n    }\r\n});\r\nregisterComponent(\"dxSelectBox\", SelectBox);\r\nmodule.exports = SelectBox;\r\nmodule.exports.default = module.exports;\r\n"]},"metadata":{},"sourceType":"script"}