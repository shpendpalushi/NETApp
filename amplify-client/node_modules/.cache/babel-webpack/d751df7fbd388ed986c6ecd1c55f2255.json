{"ast":null,"code":"/**\r\n * DevExtreme (viz/vector_map/control_bar.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar _math = Math;\nvar _min = _math.min;\nvar _max = _math.max;\nvar _round = _math.round;\nvar _floor = _math.floor;\nvar _sqrt = _math.sqrt;\n\nvar vizUtils = require(\"../core/utils\");\n\nvar _parseScalar = vizUtils.parseScalar;\nvar parseHorizontalAlignment = vizUtils.enumParser([\"left\", \"center\", \"right\"]);\nvar parseVerticalAlignment = vizUtils.enumParser([\"top\", \"bottom\"]);\nvar COMMAND_RESET = \"command-reset\";\nvar COMMAND_MOVE_UP = \"command-move-up\";\nvar COMMAND_MOVE_RIGHT = \"command-move-right\";\nvar COMMAND_MOVE_DOWN = \"command-move-down\";\nvar COMMAND_MOVE_LEFT = \"command-move-left\";\nvar COMMAND_ZOOM_IN = \"command-zoom-in\";\nvar COMMAND_ZOOM_OUT = \"command-zoom-out\";\nvar COMMAND_ZOOM_DRAG_LINE = \"command-zoom-drag-line\";\nvar COMMAND_ZOOM_DRAG = \"command-zoom-drag\";\nvar EVENT_TARGET_TYPE = \"control-bar\";\nvar FLAG_CENTERING = 1;\nvar FLAG_ZOOMING = 2;\nvar SIZE_OPTIONS = {\n  bigCircleSize: 58,\n  smallCircleSize: 28,\n  buttonSize: 10,\n  arrowButtonOffset: 20,\n  incDecButtonSize: 11,\n  incButtonOffset: 66,\n  decButtonOffset: 227,\n  sliderLineStartOffset: 88.5,\n  sliderLineEndOffset: 205.5,\n  sliderLength: 20,\n  sliderWidth: 8,\n  trackerGap: 4\n};\nvar OFFSET_X = 30.5;\nvar OFFSET_Y = 30.5;\nvar TOTAL_WIDTH = 61;\nvar TOTAL_HEIGHT = 274;\nvar COMMAND_TO_TYPE_MAP = {};\nCOMMAND_TO_TYPE_MAP[COMMAND_RESET] = ResetCommand;\nCOMMAND_TO_TYPE_MAP[COMMAND_MOVE_UP] = COMMAND_TO_TYPE_MAP[COMMAND_MOVE_RIGHT] = COMMAND_TO_TYPE_MAP[COMMAND_MOVE_DOWN] = COMMAND_TO_TYPE_MAP[COMMAND_MOVE_LEFT] = MoveCommand;\nCOMMAND_TO_TYPE_MAP[COMMAND_ZOOM_IN] = COMMAND_TO_TYPE_MAP[COMMAND_ZOOM_OUT] = ZoomCommand;\nCOMMAND_TO_TYPE_MAP[COMMAND_ZOOM_DRAG] = ZoomDragCommand;\n\nfunction ControlBar(parameters) {\n  var that = this;\n  that._params = parameters;\n\n  that._createElements(parameters.renderer, parameters.container, parameters.dataKey);\n\n  parameters.layoutControl.addItem(that);\n\n  that._subscribeToProjection(parameters.projection);\n\n  that._subscribeToTracker(parameters.tracker);\n\n  that._createCallbacks(parameters.projection);\n}\n\nControlBar.prototype = {\n  constructor: ControlBar,\n  _flags: 0,\n  dispose: function dispose() {\n    var that = this;\n\n    that._params.layoutControl.removeItem(that);\n\n    that._root.linkRemove().linkOff();\n\n    that._offProjection();\n\n    that._offTracker();\n\n    that._params = that._root = that._offProjection = that._offTracker = that._callbacks = null;\n  },\n  _subscribeToProjection: function _subscribeToProjection(projection) {\n    var that = this;\n    that._offProjection = projection.on({\n      engine: function engine() {\n        that._update();\n      },\n      zoom: updateZoom,\n      \"max-zoom\": function maxZoom() {\n        that._zoomPartition = projection.getZoomScalePartition();\n        that._sliderUnitLength = that._sliderLineLength / that._zoomPartition;\n        updateZoom();\n      }\n    });\n\n    function updateZoom() {\n      that._adjustZoom(projection.getScaledZoom());\n    }\n  },\n  _subscribeToTracker: function _subscribeToTracker(tracker) {\n    var that = this;\n    var isActive = false;\n    that._offTracker = tracker.on({\n      start: function start(arg) {\n        isActive = arg.data.name === EVENT_TARGET_TYPE;\n\n        if (isActive) {\n          that._processStart(arg.data.index, arg);\n        }\n      },\n      move: function move(arg) {\n        if (isActive) {\n          that._processMove(arg.data.index, arg);\n        }\n      },\n      end: function end() {\n        if (isActive) {\n          that._processEnd();\n\n          isActive = false;\n        }\n      }\n    });\n  },\n  _createCallbacks: function _createCallbacks(projection) {\n    var that = this;\n    that._callbacks = {\n      reset: function reset(isCenter, isZoom) {\n        if (isCenter) {\n          projection.setCenter(null);\n        }\n\n        if (isZoom) {\n          projection.setZoom(null);\n        }\n      },\n      beginMove: function beginMove() {\n        projection.beginMoveCenter();\n      },\n      endMove: function endMove() {\n        projection.endMoveCenter();\n      },\n      move: function move(shift) {\n        projection.moveCenter(shift);\n      },\n      zoom: function zoom(_zoom) {\n        projection.setScaledZoom(_zoom);\n      }\n    };\n  },\n  _createElements: function _createElements(renderer, container, dataKey) {\n    var that = this;\n    var buttonsGroups;\n    var trackersGroup;\n    that._root = renderer.g().attr({\n      \"class\": \"dxm-control-bar\"\n    }).linkOn(container, \"control-bar\");\n    buttonsGroups = that._buttonsGroup = renderer.g().attr({\n      \"class\": \"dxm-control-buttons\"\n    }).append(that._root);\n    trackersGroup = renderer.g().attr({\n      stroke: \"none\",\n      \"stroke-width\": 0,\n      fill: \"#000000\",\n      opacity: 1e-4\n    }).css({\n      cursor: \"pointer\"\n    }).append(that._root);\n\n    that._createButtons(renderer, dataKey, buttonsGroups);\n\n    that._createTrackers(renderer, dataKey, trackersGroup);\n  },\n  _createButtons: function _createButtons(renderer, dataKey, group) {\n    var that = this;\n    var options = SIZE_OPTIONS;\n    var size = options.buttonSize / 2;\n    var offset1 = options.arrowButtonOffset - size;\n    var offset2 = options.arrowButtonOffset;\n    var incDecButtonSize = options.incDecButtonSize / 2;\n    var directionOptions = {\n      \"stroke-linecap\": \"square\",\n      fill: \"none\"\n    };\n    var line = \"line\";\n    renderer.circle(0, 0, options.bigCircleSize / 2).append(group);\n    renderer.circle(0, 0, size).attr({\n      fill: \"none\"\n    }).append(group);\n    renderer.path([-size, -offset1, 0, -offset2, size, -offset1], line).attr(directionOptions).append(group);\n    renderer.path([offset1, -size, offset2, 0, offset1, size], line).attr(directionOptions).append(group);\n    renderer.path([size, offset1, 0, offset2, -size, offset1], line).attr(directionOptions).append(group);\n    renderer.path([-offset1, size, -offset2, 0, -offset1, -size], line).attr(directionOptions).append(group);\n    renderer.circle(0, options.incButtonOffset, options.smallCircleSize / 2).append(group);\n    renderer.path([[-incDecButtonSize, options.incButtonOffset, incDecButtonSize, options.incButtonOffset], [0, options.incButtonOffset - incDecButtonSize, 0, options.incButtonOffset + incDecButtonSize]], \"area\").append(group);\n    renderer.circle(0, options.decButtonOffset, options.smallCircleSize / 2).append(group);\n    renderer.path([-incDecButtonSize, options.decButtonOffset, incDecButtonSize, options.decButtonOffset], \"area\").append(group);\n    that._zoomLine = renderer.path([], \"line\").append(group);\n    that._zoomDrag = renderer.rect(_floor(-options.sliderLength / 2), _floor(options.sliderLineEndOffset - options.sliderWidth / 2), options.sliderLength, options.sliderWidth).append(group);\n    that._sliderLineLength = options.sliderLineEndOffset - options.sliderLineStartOffset;\n  },\n  _createTrackers: function _createTrackers(renderer, dataKey, group) {\n    var options = SIZE_OPTIONS;\n\n    var size = _round((options.arrowButtonOffset - options.trackerGap) / 2);\n\n    var offset1 = options.arrowButtonOffset - size;\n\n    var offset2 = _round(_sqrt(options.bigCircleSize * options.bigCircleSize / 4 - size * size));\n\n    var size2 = offset2 - offset1;\n    renderer.rect(-size, -size, 2 * size, 2 * size).data(dataKey, {\n      index: COMMAND_RESET,\n      name: EVENT_TARGET_TYPE\n    }).append(group);\n    renderer.rect(-size, -offset2, 2 * size, size2).data(dataKey, {\n      index: COMMAND_MOVE_UP,\n      name: EVENT_TARGET_TYPE\n    }).append(group);\n    renderer.rect(offset1, -size, size2, 2 * size).data(dataKey, {\n      index: COMMAND_MOVE_RIGHT,\n      name: EVENT_TARGET_TYPE\n    }).append(group);\n    renderer.rect(-size, offset1, 2 * size, size2).data(dataKey, {\n      index: COMMAND_MOVE_DOWN,\n      name: EVENT_TARGET_TYPE\n    }).append(group);\n    renderer.rect(-offset2, -size, size2, 2 * size).data(dataKey, {\n      index: COMMAND_MOVE_LEFT,\n      name: EVENT_TARGET_TYPE\n    }).append(group);\n    renderer.circle(0, options.incButtonOffset, options.smallCircleSize / 2).data(dataKey, {\n      index: COMMAND_ZOOM_IN,\n      name: EVENT_TARGET_TYPE\n    }).append(group);\n    renderer.circle(0, options.decButtonOffset, options.smallCircleSize / 2).data(dataKey, {\n      index: COMMAND_ZOOM_OUT,\n      name: EVENT_TARGET_TYPE\n    }).append(group);\n    renderer.rect(-2, options.sliderLineStartOffset - 2, 4, options.sliderLineEndOffset - options.sliderLineStartOffset + 4).css({\n      cursor: \"default\"\n    }).data(dataKey, {\n      index: COMMAND_ZOOM_DRAG_LINE,\n      name: EVENT_TARGET_TYPE\n    }).append(group);\n    this._zoomDragTracker = renderer.rect(-options.sliderLength / 2, options.sliderLineEndOffset - options.sliderWidth / 2, options.sliderLength, options.sliderWidth).data(dataKey, {\n      index: COMMAND_ZOOM_DRAG,\n      name: EVENT_TARGET_TYPE\n    }).append(group);\n  },\n  resize: function resize(size) {\n    if (this._isActive) {\n      this._root.attr({\n        visibility: null !== size ? null : \"hidden\"\n      });\n    }\n  },\n  getLayoutOptions: function getLayoutOptions() {\n    return this._isActive ? this._layoutOptions : null;\n  },\n  locate: function locate(x, y) {\n    this._root.attr({\n      translateX: x + this._margin + OFFSET_X,\n      translateY: y + this._margin + OFFSET_Y\n    });\n  },\n  _update: function _update() {\n    var that = this;\n    that._isActive = that._isEnabled && that._flags && that._params.projection.isInvertible();\n\n    if (that._isActive) {\n      that._root.linkAppend();\n    } else {\n      that._root.linkRemove();\n    }\n\n    that._processEnd();\n\n    that.updateLayout();\n  },\n  setInteraction: function setInteraction(interaction) {\n    var that = this;\n\n    if (_parseScalar(interaction.centeringEnabled, true)) {\n      that._flags |= FLAG_CENTERING;\n    } else {\n      that._flags &= ~FLAG_CENTERING;\n    }\n\n    if (_parseScalar(interaction.zoomingEnabled, true)) {\n      that._flags |= FLAG_ZOOMING;\n    } else {\n      that._flags &= ~FLAG_ZOOMING;\n    }\n\n    that._update();\n  },\n  setOptions: function setOptions(options) {\n    var that = this;\n    that._isEnabled = !!_parseScalar(options.enabled, true);\n    that._margin = options.margin || 0;\n    that._layoutOptions = {\n      width: 2 * that._margin + TOTAL_WIDTH,\n      height: 2 * that._margin + TOTAL_HEIGHT,\n      horizontalAlignment: parseHorizontalAlignment(options.horizontalAlignment, \"left\"),\n      verticalAlignment: parseVerticalAlignment(options.verticalAlignment, \"top\")\n    };\n\n    that._buttonsGroup.attr({\n      \"stroke-width\": options.borderWidth,\n      stroke: options.borderColor,\n      fill: options.color,\n      \"fill-opacity\": options.opacity\n    });\n\n    that._update();\n  },\n  _adjustZoom: function _adjustZoom(zoom) {\n    var that = this;\n    var transform;\n    var y;\n    var start = SIZE_OPTIONS.sliderLineStartOffset;\n    var end = SIZE_OPTIONS.sliderLineEndOffset;\n    var h = SIZE_OPTIONS.sliderWidth;\n    that._zoomFactor = _max(_min(_round(zoom), that._zoomPartition), 0);\n    transform = {\n      translateY: -_round(that._zoomFactor * that._sliderUnitLength)\n    };\n    y = end - h / 2 + transform.translateY;\n\n    that._zoomLine.attr({\n      points: [[0, start, 0, _max(start, y)], [0, _min(end, y + h), 0, end]]\n    });\n\n    that._zoomDrag.attr(transform);\n\n    that._zoomDragTracker.attr(transform);\n  },\n  _applyZoom: function _applyZoom() {\n    this._callbacks.zoom(this._zoomFactor);\n  },\n  _processStart: function _processStart(command, arg) {\n    var commandType;\n\n    if (this._isActive) {\n      commandType = COMMAND_TO_TYPE_MAP[command];\n      this._command = commandType && commandType.flags & this._flags ? new commandType(this, command, arg) : null;\n    }\n  },\n  _processMove: function _processMove(command, arg) {\n    this._command && this._command.update(command, arg);\n  },\n  _processEnd: function _processEnd() {\n    this._command && this._command.finish();\n    this._command = null;\n  }\n};\n\nfunction disposeCommand(command) {\n  delete command._owner;\n\n  command.update = function () {};\n\n  command.finish = function () {};\n}\n\nfunction ResetCommand(owner, command) {\n  this._owner = owner;\n  this._command = command;\n}\n\nResetCommand.flags = FLAG_CENTERING | FLAG_ZOOMING;\n\nResetCommand.prototype.update = function (command) {\n  command !== this._command && disposeCommand(this);\n};\n\nResetCommand.prototype.finish = function () {\n  var flags = this._owner._flags;\n\n  this._owner._callbacks.reset(!!(flags & FLAG_CENTERING), !!(flags & FLAG_ZOOMING));\n\n  disposeCommand(this);\n};\n\nfunction MoveCommand(owner, command, arg) {\n  this._command = command;\n  var timeout = null;\n  var interval = 100;\n  var dx = 0;\n  var dy = 0;\n\n  switch (this._command) {\n    case COMMAND_MOVE_UP:\n      dy = -10;\n      break;\n\n    case COMMAND_MOVE_RIGHT:\n      dx = 10;\n      break;\n\n    case COMMAND_MOVE_DOWN:\n      dy = 10;\n      break;\n\n    case COMMAND_MOVE_LEFT:\n      dx = -10;\n  }\n\n  function callback() {\n    owner._callbacks.move([dx, dy]);\n\n    timeout = setTimeout(callback, interval);\n  }\n\n  this._stop = function () {\n    clearTimeout(timeout);\n\n    owner._callbacks.endMove();\n\n    this._stop = owner = null;\n    return this;\n  };\n\n  arg = null;\n\n  owner._callbacks.beginMove();\n\n  callback();\n}\n\nMoveCommand.flags = FLAG_CENTERING;\n\nMoveCommand.prototype.update = function (command) {\n  this._command !== command && this.finish();\n};\n\nMoveCommand.prototype.finish = function () {\n  disposeCommand(this._stop());\n};\n\nfunction ZoomCommand(owner, command) {\n  this._owner = owner;\n  this._command = command;\n  var timeout = null;\n  var interval = 150;\n  var dZoom = this._command === COMMAND_ZOOM_IN ? 1 : -1;\n\n  function callback() {\n    owner._adjustZoom(owner._zoomFactor + dZoom);\n\n    timeout = setTimeout(callback, interval);\n  }\n\n  this._stop = function () {\n    clearTimeout(timeout);\n    this._stop = owner = null;\n    return this;\n  };\n\n  callback();\n}\n\nZoomCommand.flags = FLAG_ZOOMING;\n\nZoomCommand.prototype.update = function (command) {\n  this._command !== command && this.finish();\n};\n\nZoomCommand.prototype.finish = function () {\n  this._owner._applyZoom();\n\n  disposeCommand(this._stop());\n};\n\nfunction ZoomDragCommand(owner, command, arg) {\n  this._owner = owner;\n  this._zoomFactor = owner._zoomFactor;\n  this._pos = arg.y;\n}\n\nZoomDragCommand.flags = FLAG_ZOOMING;\n\nZoomDragCommand.prototype.update = function (command, arg) {\n  var owner = this._owner;\n\n  owner._adjustZoom(this._zoomFactor + owner._zoomPartition * (this._pos - arg.y) / owner._sliderLineLength);\n};\n\nZoomDragCommand.prototype.finish = function () {\n  this._owner._applyZoom();\n\n  disposeCommand(this);\n};\n\nexports.ControlBar = ControlBar;","map":{"version":3,"sources":["C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/devextreme/viz/vector_map/control_bar.js"],"names":["_math","Math","_min","min","_max","max","_round","round","_floor","floor","_sqrt","sqrt","vizUtils","require","_parseScalar","parseScalar","parseHorizontalAlignment","enumParser","parseVerticalAlignment","COMMAND_RESET","COMMAND_MOVE_UP","COMMAND_MOVE_RIGHT","COMMAND_MOVE_DOWN","COMMAND_MOVE_LEFT","COMMAND_ZOOM_IN","COMMAND_ZOOM_OUT","COMMAND_ZOOM_DRAG_LINE","COMMAND_ZOOM_DRAG","EVENT_TARGET_TYPE","FLAG_CENTERING","FLAG_ZOOMING","SIZE_OPTIONS","bigCircleSize","smallCircleSize","buttonSize","arrowButtonOffset","incDecButtonSize","incButtonOffset","decButtonOffset","sliderLineStartOffset","sliderLineEndOffset","sliderLength","sliderWidth","trackerGap","OFFSET_X","OFFSET_Y","TOTAL_WIDTH","TOTAL_HEIGHT","COMMAND_TO_TYPE_MAP","ResetCommand","MoveCommand","ZoomCommand","ZoomDragCommand","ControlBar","parameters","that","_params","_createElements","renderer","container","dataKey","layoutControl","addItem","_subscribeToProjection","projection","_subscribeToTracker","tracker","_createCallbacks","prototype","constructor","_flags","dispose","removeItem","_root","linkRemove","linkOff","_offProjection","_offTracker","_callbacks","on","engine","_update","zoom","updateZoom","_zoomPartition","getZoomScalePartition","_sliderUnitLength","_sliderLineLength","_adjustZoom","getScaledZoom","isActive","start","arg","data","name","_processStart","index","move","_processMove","end","_processEnd","reset","isCenter","isZoom","setCenter","setZoom","beginMove","beginMoveCenter","endMove","endMoveCenter","shift","moveCenter","_zoom","setScaledZoom","buttonsGroups","trackersGroup","g","attr","linkOn","_buttonsGroup","append","stroke","fill","opacity","css","cursor","_createButtons","_createTrackers","group","options","size","offset1","offset2","directionOptions","line","circle","path","_zoomLine","_zoomDrag","rect","size2","_zoomDragTracker","resize","_isActive","visibility","getLayoutOptions","_layoutOptions","locate","x","y","translateX","_margin","translateY","_isEnabled","isInvertible","linkAppend","updateLayout","setInteraction","interaction","centeringEnabled","zoomingEnabled","setOptions","enabled","margin","width","height","horizontalAlignment","verticalAlignment","borderWidth","borderColor","color","transform","h","_zoomFactor","points","_applyZoom","command","commandType","_command","flags","update","finish","disposeCommand","_owner","owner","timeout","interval","dx","dy","callback","setTimeout","_stop","clearTimeout","dZoom","_pos","exports"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,IAAIA,KAAK,GAAGC,IAAZ;AACA,IAAIC,IAAI,GAAGF,KAAK,CAACG,GAAjB;AACA,IAAIC,IAAI,GAAGJ,KAAK,CAACK,GAAjB;AACA,IAAIC,MAAM,GAAGN,KAAK,CAACO,KAAnB;AACA,IAAIC,MAAM,GAAGR,KAAK,CAACS,KAAnB;AACA,IAAIC,KAAK,GAAGV,KAAK,CAACW,IAAlB;;AACA,IAAIC,QAAQ,GAAGC,OAAO,CAAC,eAAD,CAAtB;;AACA,IAAIC,YAAY,GAAGF,QAAQ,CAACG,WAA5B;AACA,IAAIC,wBAAwB,GAAGJ,QAAQ,CAACK,UAAT,CAAoB,CAAC,MAAD,EAAS,QAAT,EAAmB,OAAnB,CAApB,CAA/B;AACA,IAAIC,sBAAsB,GAAGN,QAAQ,CAACK,UAAT,CAAoB,CAAC,KAAD,EAAQ,QAAR,CAApB,CAA7B;AACA,IAAIE,aAAa,GAAG,eAApB;AACA,IAAIC,eAAe,GAAG,iBAAtB;AACA,IAAIC,kBAAkB,GAAG,oBAAzB;AACA,IAAIC,iBAAiB,GAAG,mBAAxB;AACA,IAAIC,iBAAiB,GAAG,mBAAxB;AACA,IAAIC,eAAe,GAAG,iBAAtB;AACA,IAAIC,gBAAgB,GAAG,kBAAvB;AACA,IAAIC,sBAAsB,GAAG,wBAA7B;AACA,IAAIC,iBAAiB,GAAG,mBAAxB;AACA,IAAIC,iBAAiB,GAAG,aAAxB;AACA,IAAIC,cAAc,GAAG,CAArB;AACA,IAAIC,YAAY,GAAG,CAAnB;AACA,IAAIC,YAAY,GAAG;AACfC,EAAAA,aAAa,EAAE,EADA;AAEfC,EAAAA,eAAe,EAAE,EAFF;AAGfC,EAAAA,UAAU,EAAE,EAHG;AAIfC,EAAAA,iBAAiB,EAAE,EAJJ;AAKfC,EAAAA,gBAAgB,EAAE,EALH;AAMfC,EAAAA,eAAe,EAAE,EANF;AAOfC,EAAAA,eAAe,EAAE,GAPF;AAQfC,EAAAA,qBAAqB,EAAE,IARR;AASfC,EAAAA,mBAAmB,EAAE,KATN;AAUfC,EAAAA,YAAY,EAAE,EAVC;AAWfC,EAAAA,WAAW,EAAE,CAXE;AAYfC,EAAAA,UAAU,EAAE;AAZG,CAAnB;AAcA,IAAIC,QAAQ,GAAG,IAAf;AACA,IAAIC,QAAQ,GAAG,IAAf;AACA,IAAIC,WAAW,GAAG,EAAlB;AACA,IAAIC,YAAY,GAAG,GAAnB;AACA,IAAIC,mBAAmB,GAAG,EAA1B;AACAA,mBAAmB,CAAC7B,aAAD,CAAnB,GAAqC8B,YAArC;AACAD,mBAAmB,CAAC5B,eAAD,CAAnB,GAAuC4B,mBAAmB,CAAC3B,kBAAD,CAAnB,GAA0C2B,mBAAmB,CAAC1B,iBAAD,CAAnB,GAAyC0B,mBAAmB,CAACzB,iBAAD,CAAnB,GAAyC2B,WAAnK;AACAF,mBAAmB,CAACxB,eAAD,CAAnB,GAAuCwB,mBAAmB,CAACvB,gBAAD,CAAnB,GAAwC0B,WAA/E;AACAH,mBAAmB,CAACrB,iBAAD,CAAnB,GAAyCyB,eAAzC;;AAEA,SAASC,UAAT,CAAoBC,UAApB,EAAgC;AAC5B,MAAIC,IAAI,GAAG,IAAX;AACAA,EAAAA,IAAI,CAACC,OAAL,GAAeF,UAAf;;AACAC,EAAAA,IAAI,CAACE,eAAL,CAAqBH,UAAU,CAACI,QAAhC,EAA0CJ,UAAU,CAACK,SAArD,EAAgEL,UAAU,CAACM,OAA3E;;AACAN,EAAAA,UAAU,CAACO,aAAX,CAAyBC,OAAzB,CAAiCP,IAAjC;;AACAA,EAAAA,IAAI,CAACQ,sBAAL,CAA4BT,UAAU,CAACU,UAAvC;;AACAT,EAAAA,IAAI,CAACU,mBAAL,CAAyBX,UAAU,CAACY,OAApC;;AACAX,EAAAA,IAAI,CAACY,gBAAL,CAAsBb,UAAU,CAACU,UAAjC;AACH;;AACDX,UAAU,CAACe,SAAX,GAAuB;AACnBC,EAAAA,WAAW,EAAEhB,UADM;AAEnBiB,EAAAA,MAAM,EAAE,CAFW;AAGnBC,EAAAA,OAAO,EAAE,mBAAW;AAChB,QAAIhB,IAAI,GAAG,IAAX;;AACAA,IAAAA,IAAI,CAACC,OAAL,CAAaK,aAAb,CAA2BW,UAA3B,CAAsCjB,IAAtC;;AACAA,IAAAA,IAAI,CAACkB,KAAL,CAAWC,UAAX,GAAwBC,OAAxB;;AACApB,IAAAA,IAAI,CAACqB,cAAL;;AACArB,IAAAA,IAAI,CAACsB,WAAL;;AACAtB,IAAAA,IAAI,CAACC,OAAL,GAAeD,IAAI,CAACkB,KAAL,GAAalB,IAAI,CAACqB,cAAL,GAAsBrB,IAAI,CAACsB,WAAL,GAAmBtB,IAAI,CAACuB,UAAL,GAAkB,IAAvF;AACH,GAVkB;AAWnBf,EAAAA,sBAAsB,EAAE,gCAASC,UAAT,EAAqB;AACzC,QAAIT,IAAI,GAAG,IAAX;AACAA,IAAAA,IAAI,CAACqB,cAAL,GAAsBZ,UAAU,CAACe,EAAX,CAAc;AAChCC,MAAAA,MAAM,EAAE,kBAAW;AACfzB,QAAAA,IAAI,CAAC0B,OAAL;AACH,OAH+B;AAIhCC,MAAAA,IAAI,EAAEC,UAJ0B;AAKhC,kBAAY,mBAAW;AACnB5B,QAAAA,IAAI,CAAC6B,cAAL,GAAsBpB,UAAU,CAACqB,qBAAX,EAAtB;AACA9B,QAAAA,IAAI,CAAC+B,iBAAL,GAAyB/B,IAAI,CAACgC,iBAAL,GAAyBhC,IAAI,CAAC6B,cAAvD;AACAD,QAAAA,UAAU;AACb;AAT+B,KAAd,CAAtB;;AAYA,aAASA,UAAT,GAAsB;AAClB5B,MAAAA,IAAI,CAACiC,WAAL,CAAiBxB,UAAU,CAACyB,aAAX,EAAjB;AACH;AACJ,GA5BkB;AA6BnBxB,EAAAA,mBAAmB,EAAE,6BAASC,OAAT,EAAkB;AACnC,QAAIX,IAAI,GAAG,IAAX;AACA,QAAImC,QAAQ,GAAG,KAAf;AACAnC,IAAAA,IAAI,CAACsB,WAAL,GAAmBX,OAAO,CAACa,EAAR,CAAW;AAC1BY,MAAAA,KAAK,EAAE,eAASC,GAAT,EAAc;AACjBF,QAAAA,QAAQ,GAAGE,GAAG,CAACC,IAAJ,CAASC,IAAT,KAAkBlE,iBAA7B;;AACA,YAAI8D,QAAJ,EAAc;AACVnC,UAAAA,IAAI,CAACwC,aAAL,CAAmBH,GAAG,CAACC,IAAJ,CAASG,KAA5B,EAAmCJ,GAAnC;AACH;AACJ,OANyB;AAO1BK,MAAAA,IAAI,EAAE,cAASL,GAAT,EAAc;AAChB,YAAIF,QAAJ,EAAc;AACVnC,UAAAA,IAAI,CAAC2C,YAAL,CAAkBN,GAAG,CAACC,IAAJ,CAASG,KAA3B,EAAkCJ,GAAlC;AACH;AACJ,OAXyB;AAY1BO,MAAAA,GAAG,EAAE,eAAW;AACZ,YAAIT,QAAJ,EAAc;AACVnC,UAAAA,IAAI,CAAC6C,WAAL;;AACAV,UAAAA,QAAQ,GAAG,KAAX;AACH;AACJ;AAjByB,KAAX,CAAnB;AAmBH,GAnDkB;AAoDnBvB,EAAAA,gBAAgB,EAAE,0BAASH,UAAT,EAAqB;AACnC,QAAIT,IAAI,GAAG,IAAX;AACAA,IAAAA,IAAI,CAACuB,UAAL,GAAkB;AACduB,MAAAA,KAAK,EAAE,eAASC,QAAT,EAAmBC,MAAnB,EAA2B;AAC9B,YAAID,QAAJ,EAAc;AACVtC,UAAAA,UAAU,CAACwC,SAAX,CAAqB,IAArB;AACH;;AACD,YAAID,MAAJ,EAAY;AACRvC,UAAAA,UAAU,CAACyC,OAAX,CAAmB,IAAnB;AACH;AACJ,OARa;AASdC,MAAAA,SAAS,EAAE,qBAAW;AAClB1C,QAAAA,UAAU,CAAC2C,eAAX;AACH,OAXa;AAYdC,MAAAA,OAAO,EAAE,mBAAW;AAChB5C,QAAAA,UAAU,CAAC6C,aAAX;AACH,OAda;AAedZ,MAAAA,IAAI,EAAE,cAASa,KAAT,EAAgB;AAClB9C,QAAAA,UAAU,CAAC+C,UAAX,CAAsBD,KAAtB;AACH,OAjBa;AAkBd5B,MAAAA,IAAI,EAAE,cAAS8B,KAAT,EAAgB;AAClBhD,QAAAA,UAAU,CAACiD,aAAX,CAAyBD,KAAzB;AACH;AApBa,KAAlB;AAsBH,GA5EkB;AA6EnBvD,EAAAA,eAAe,EAAE,yBAASC,QAAT,EAAmBC,SAAnB,EAA8BC,OAA9B,EAAuC;AACpD,QAAIL,IAAI,GAAG,IAAX;AACA,QAAI2D,aAAJ;AACA,QAAIC,aAAJ;AACA5D,IAAAA,IAAI,CAACkB,KAAL,GAAaf,QAAQ,CAAC0D,CAAT,GAAaC,IAAb,CAAkB;AAC3B,eAAS;AADkB,KAAlB,EAEVC,MAFU,CAEH3D,SAFG,EAEQ,aAFR,CAAb;AAGAuD,IAAAA,aAAa,GAAG3D,IAAI,CAACgE,aAAL,GAAqB7D,QAAQ,CAAC0D,CAAT,GAAaC,IAAb,CAAkB;AACnD,eAAS;AAD0C,KAAlB,EAElCG,MAFkC,CAE3BjE,IAAI,CAACkB,KAFsB,CAArC;AAGA0C,IAAAA,aAAa,GAAGzD,QAAQ,CAAC0D,CAAT,GAAaC,IAAb,CAAkB;AAC9BI,MAAAA,MAAM,EAAE,MADsB;AAE9B,sBAAgB,CAFc;AAG9BC,MAAAA,IAAI,EAAE,SAHwB;AAI9BC,MAAAA,OAAO,EAAE;AAJqB,KAAlB,EAKbC,GALa,CAKT;AACHC,MAAAA,MAAM,EAAE;AADL,KALS,EAObL,MAPa,CAONjE,IAAI,CAACkB,KAPC,CAAhB;;AAQAlB,IAAAA,IAAI,CAACuE,cAAL,CAAoBpE,QAApB,EAA8BE,OAA9B,EAAuCsD,aAAvC;;AACA3D,IAAAA,IAAI,CAACwE,eAAL,CAAqBrE,QAArB,EAA+BE,OAA/B,EAAwCuD,aAAxC;AACH,GAjGkB;AAkGnBW,EAAAA,cAAc,EAAE,wBAASpE,QAAT,EAAmBE,OAAnB,EAA4BoE,KAA5B,EAAmC;AAC/C,QAAIzE,IAAI,GAAG,IAAX;AACA,QAAI0E,OAAO,GAAGlG,YAAd;AACA,QAAImG,IAAI,GAAGD,OAAO,CAAC/F,UAAR,GAAqB,CAAhC;AACA,QAAIiG,OAAO,GAAGF,OAAO,CAAC9F,iBAAR,GAA4B+F,IAA1C;AACA,QAAIE,OAAO,GAAGH,OAAO,CAAC9F,iBAAtB;AACA,QAAIC,gBAAgB,GAAG6F,OAAO,CAAC7F,gBAAR,GAA2B,CAAlD;AACA,QAAIiG,gBAAgB,GAAG;AACnB,wBAAkB,QADC;AAEnBX,MAAAA,IAAI,EAAE;AAFa,KAAvB;AAIA,QAAIY,IAAI,GAAG,MAAX;AACA5E,IAAAA,QAAQ,CAAC6E,MAAT,CAAgB,CAAhB,EAAmB,CAAnB,EAAsBN,OAAO,CAACjG,aAAR,GAAwB,CAA9C,EAAiDwF,MAAjD,CAAwDQ,KAAxD;AACAtE,IAAAA,QAAQ,CAAC6E,MAAT,CAAgB,CAAhB,EAAmB,CAAnB,EAAsBL,IAAtB,EAA4Bb,IAA5B,CAAiC;AAC7BK,MAAAA,IAAI,EAAE;AADuB,KAAjC,EAEGF,MAFH,CAEUQ,KAFV;AAGAtE,IAAAA,QAAQ,CAAC8E,IAAT,CAAc,CAAC,CAACN,IAAF,EAAQ,CAACC,OAAT,EAAkB,CAAlB,EAAqB,CAACC,OAAtB,EAA+BF,IAA/B,EAAqC,CAACC,OAAtC,CAAd,EAA8DG,IAA9D,EAAoEjB,IAApE,CAAyEgB,gBAAzE,EAA2Fb,MAA3F,CAAkGQ,KAAlG;AACAtE,IAAAA,QAAQ,CAAC8E,IAAT,CAAc,CAACL,OAAD,EAAU,CAACD,IAAX,EAAiBE,OAAjB,EAA0B,CAA1B,EAA6BD,OAA7B,EAAsCD,IAAtC,CAAd,EAA2DI,IAA3D,EAAiEjB,IAAjE,CAAsEgB,gBAAtE,EAAwFb,MAAxF,CAA+FQ,KAA/F;AACAtE,IAAAA,QAAQ,CAAC8E,IAAT,CAAc,CAACN,IAAD,EAAOC,OAAP,EAAgB,CAAhB,EAAmBC,OAAnB,EAA4B,CAACF,IAA7B,EAAmCC,OAAnC,CAAd,EAA2DG,IAA3D,EAAiEjB,IAAjE,CAAsEgB,gBAAtE,EAAwFb,MAAxF,CAA+FQ,KAA/F;AACAtE,IAAAA,QAAQ,CAAC8E,IAAT,CAAc,CAAC,CAACL,OAAF,EAAWD,IAAX,EAAiB,CAACE,OAAlB,EAA2B,CAA3B,EAA8B,CAACD,OAA/B,EAAwC,CAACD,IAAzC,CAAd,EAA8DI,IAA9D,EAAoEjB,IAApE,CAAyEgB,gBAAzE,EAA2Fb,MAA3F,CAAkGQ,KAAlG;AACAtE,IAAAA,QAAQ,CAAC6E,MAAT,CAAgB,CAAhB,EAAmBN,OAAO,CAAC5F,eAA3B,EAA4C4F,OAAO,CAAChG,eAAR,GAA0B,CAAtE,EAAyEuF,MAAzE,CAAgFQ,KAAhF;AACAtE,IAAAA,QAAQ,CAAC8E,IAAT,CAAc,CACV,CAAC,CAACpG,gBAAF,EAAoB6F,OAAO,CAAC5F,eAA5B,EAA6CD,gBAA7C,EAA+D6F,OAAO,CAAC5F,eAAvE,CADU,EAEV,CAAC,CAAD,EAAI4F,OAAO,CAAC5F,eAAR,GAA0BD,gBAA9B,EAAgD,CAAhD,EAAmD6F,OAAO,CAAC5F,eAAR,GAA0BD,gBAA7E,CAFU,CAAd,EAGG,MAHH,EAGWoF,MAHX,CAGkBQ,KAHlB;AAIAtE,IAAAA,QAAQ,CAAC6E,MAAT,CAAgB,CAAhB,EAAmBN,OAAO,CAAC3F,eAA3B,EAA4C2F,OAAO,CAAChG,eAAR,GAA0B,CAAtE,EAAyEuF,MAAzE,CAAgFQ,KAAhF;AACAtE,IAAAA,QAAQ,CAAC8E,IAAT,CAAc,CAAC,CAACpG,gBAAF,EAAoB6F,OAAO,CAAC3F,eAA5B,EAA6CF,gBAA7C,EAA+D6F,OAAO,CAAC3F,eAAvE,CAAd,EAAuG,MAAvG,EAA+GkF,MAA/G,CAAsHQ,KAAtH;AACAzE,IAAAA,IAAI,CAACkF,SAAL,GAAiB/E,QAAQ,CAAC8E,IAAT,CAAc,EAAd,EAAkB,MAAlB,EAA0BhB,MAA1B,CAAiCQ,KAAjC,CAAjB;AACAzE,IAAAA,IAAI,CAACmF,SAAL,GAAiBhF,QAAQ,CAACiF,IAAT,CAAcnI,MAAM,CAAC,CAACyH,OAAO,CAACxF,YAAT,GAAwB,CAAzB,CAApB,EAAiDjC,MAAM,CAACyH,OAAO,CAACzF,mBAAR,GAA8ByF,OAAO,CAACvF,WAAR,GAAsB,CAArD,CAAvD,EAAgHuF,OAAO,CAACxF,YAAxH,EAAsIwF,OAAO,CAACvF,WAA9I,EAA2J8E,MAA3J,CAAkKQ,KAAlK,CAAjB;AACAzE,IAAAA,IAAI,CAACgC,iBAAL,GAAyB0C,OAAO,CAACzF,mBAAR,GAA8ByF,OAAO,CAAC1F,qBAA/D;AACH,GAhIkB;AAiInBwF,EAAAA,eAAe,EAAE,yBAASrE,QAAT,EAAmBE,OAAnB,EAA4BoE,KAA5B,EAAmC;AAChD,QAAIC,OAAO,GAAGlG,YAAd;;AACA,QAAImG,IAAI,GAAG5H,MAAM,CAAC,CAAC2H,OAAO,CAAC9F,iBAAR,GAA4B8F,OAAO,CAACtF,UAArC,IAAmD,CAApD,CAAjB;;AACA,QAAIwF,OAAO,GAAGF,OAAO,CAAC9F,iBAAR,GAA4B+F,IAA1C;;AACA,QAAIE,OAAO,GAAG9H,MAAM,CAACI,KAAK,CAACuH,OAAO,CAACjG,aAAR,GAAwBiG,OAAO,CAACjG,aAAhC,GAAgD,CAAhD,GAAoDkG,IAAI,GAAGA,IAA5D,CAAN,CAApB;;AACA,QAAIU,KAAK,GAAGR,OAAO,GAAGD,OAAtB;AACAzE,IAAAA,QAAQ,CAACiF,IAAT,CAAc,CAACT,IAAf,EAAqB,CAACA,IAAtB,EAA4B,IAAIA,IAAhC,EAAsC,IAAIA,IAA1C,EAAgDrC,IAAhD,CAAqDjC,OAArD,EAA8D;AAC1DoC,MAAAA,KAAK,EAAE7E,aADmD;AAE1D2E,MAAAA,IAAI,EAAElE;AAFoD,KAA9D,EAGG4F,MAHH,CAGUQ,KAHV;AAIAtE,IAAAA,QAAQ,CAACiF,IAAT,CAAc,CAACT,IAAf,EAAqB,CAACE,OAAtB,EAA+B,IAAIF,IAAnC,EAAyCU,KAAzC,EAAgD/C,IAAhD,CAAqDjC,OAArD,EAA8D;AAC1DoC,MAAAA,KAAK,EAAE5E,eADmD;AAE1D0E,MAAAA,IAAI,EAAElE;AAFoD,KAA9D,EAGG4F,MAHH,CAGUQ,KAHV;AAIAtE,IAAAA,QAAQ,CAACiF,IAAT,CAAcR,OAAd,EAAuB,CAACD,IAAxB,EAA8BU,KAA9B,EAAqC,IAAIV,IAAzC,EAA+CrC,IAA/C,CAAoDjC,OAApD,EAA6D;AACzDoC,MAAAA,KAAK,EAAE3E,kBADkD;AAEzDyE,MAAAA,IAAI,EAAElE;AAFmD,KAA7D,EAGG4F,MAHH,CAGUQ,KAHV;AAIAtE,IAAAA,QAAQ,CAACiF,IAAT,CAAc,CAACT,IAAf,EAAqBC,OAArB,EAA8B,IAAID,IAAlC,EAAwCU,KAAxC,EAA+C/C,IAA/C,CAAoDjC,OAApD,EAA6D;AACzDoC,MAAAA,KAAK,EAAE1E,iBADkD;AAEzDwE,MAAAA,IAAI,EAAElE;AAFmD,KAA7D,EAGG4F,MAHH,CAGUQ,KAHV;AAIAtE,IAAAA,QAAQ,CAACiF,IAAT,CAAc,CAACP,OAAf,EAAwB,CAACF,IAAzB,EAA+BU,KAA/B,EAAsC,IAAIV,IAA1C,EAAgDrC,IAAhD,CAAqDjC,OAArD,EAA8D;AAC1DoC,MAAAA,KAAK,EAAEzE,iBADmD;AAE1DuE,MAAAA,IAAI,EAAElE;AAFoD,KAA9D,EAGG4F,MAHH,CAGUQ,KAHV;AAIAtE,IAAAA,QAAQ,CAAC6E,MAAT,CAAgB,CAAhB,EAAmBN,OAAO,CAAC5F,eAA3B,EAA4C4F,OAAO,CAAChG,eAAR,GAA0B,CAAtE,EAAyE4D,IAAzE,CAA8EjC,OAA9E,EAAuF;AACnFoC,MAAAA,KAAK,EAAExE,eAD4E;AAEnFsE,MAAAA,IAAI,EAAElE;AAF6E,KAAvF,EAGG4F,MAHH,CAGUQ,KAHV;AAIAtE,IAAAA,QAAQ,CAAC6E,MAAT,CAAgB,CAAhB,EAAmBN,OAAO,CAAC3F,eAA3B,EAA4C2F,OAAO,CAAChG,eAAR,GAA0B,CAAtE,EAAyE4D,IAAzE,CAA8EjC,OAA9E,EAAuF;AACnFoC,MAAAA,KAAK,EAAEvE,gBAD4E;AAEnFqE,MAAAA,IAAI,EAAElE;AAF6E,KAAvF,EAGG4F,MAHH,CAGUQ,KAHV;AAIAtE,IAAAA,QAAQ,CAACiF,IAAT,CAAc,CAAC,CAAf,EAAkBV,OAAO,CAAC1F,qBAAR,GAAgC,CAAlD,EAAqD,CAArD,EAAwD0F,OAAO,CAACzF,mBAAR,GAA8ByF,OAAO,CAAC1F,qBAAtC,GAA8D,CAAtH,EAAyHqF,GAAzH,CAA6H;AACzHC,MAAAA,MAAM,EAAE;AADiH,KAA7H,EAEGhC,IAFH,CAEQjC,OAFR,EAEiB;AACboC,MAAAA,KAAK,EAAEtE,sBADM;AAEboE,MAAAA,IAAI,EAAElE;AAFO,KAFjB,EAKG4F,MALH,CAKUQ,KALV;AAMA,SAAKa,gBAAL,GAAwBnF,QAAQ,CAACiF,IAAT,CAAc,CAACV,OAAO,CAACxF,YAAT,GAAwB,CAAtC,EAAyCwF,OAAO,CAACzF,mBAAR,GAA8ByF,OAAO,CAACvF,WAAR,GAAsB,CAA7F,EAAgGuF,OAAO,CAACxF,YAAxG,EAAsHwF,OAAO,CAACvF,WAA9H,EAA2ImD,IAA3I,CAAgJjC,OAAhJ,EAAyJ;AAC7KoC,MAAAA,KAAK,EAAErE,iBADsK;AAE7KmE,MAAAA,IAAI,EAAElE;AAFuK,KAAzJ,EAGrB4F,MAHqB,CAGdQ,KAHc,CAAxB;AAIH,GA7KkB;AA8KnBc,EAAAA,MAAM,EAAE,gBAASZ,IAAT,EAAe;AACnB,QAAI,KAAKa,SAAT,EAAoB;AAChB,WAAKtE,KAAL,CAAW4C,IAAX,CAAgB;AACZ2B,QAAAA,UAAU,EAAE,SAASd,IAAT,GAAgB,IAAhB,GAAuB;AADvB,OAAhB;AAGH;AACJ,GApLkB;AAqLnBe,EAAAA,gBAAgB,EAAE,4BAAW;AACzB,WAAO,KAAKF,SAAL,GAAiB,KAAKG,cAAtB,GAAuC,IAA9C;AACH,GAvLkB;AAwLnBC,EAAAA,MAAM,EAAE,gBAASC,CAAT,EAAYC,CAAZ,EAAe;AACnB,SAAK5E,KAAL,CAAW4C,IAAX,CAAgB;AACZiC,MAAAA,UAAU,EAAEF,CAAC,GAAG,KAAKG,OAAT,GAAmB3G,QADnB;AAEZ4G,MAAAA,UAAU,EAAEH,CAAC,GAAG,KAAKE,OAAT,GAAmB1G;AAFnB,KAAhB;AAIH,GA7LkB;AA8LnBoC,EAAAA,OAAO,EAAE,mBAAW;AAChB,QAAI1B,IAAI,GAAG,IAAX;AACAA,IAAAA,IAAI,CAACwF,SAAL,GAAiBxF,IAAI,CAACkG,UAAL,IAAmBlG,IAAI,CAACe,MAAxB,IAAkCf,IAAI,CAACC,OAAL,CAAaQ,UAAb,CAAwB0F,YAAxB,EAAnD;;AACA,QAAInG,IAAI,CAACwF,SAAT,EAAoB;AAChBxF,MAAAA,IAAI,CAACkB,KAAL,CAAWkF,UAAX;AACH,KAFD,MAEO;AACHpG,MAAAA,IAAI,CAACkB,KAAL,CAAWC,UAAX;AACH;;AACDnB,IAAAA,IAAI,CAAC6C,WAAL;;AACA7C,IAAAA,IAAI,CAACqG,YAAL;AACH,GAxMkB;AAyMnBC,EAAAA,cAAc,EAAE,wBAASC,WAAT,EAAsB;AAClC,QAAIvG,IAAI,GAAG,IAAX;;AACA,QAAIzC,YAAY,CAACgJ,WAAW,CAACC,gBAAb,EAA+B,IAA/B,CAAhB,EAAsD;AAClDxG,MAAAA,IAAI,CAACe,MAAL,IAAezC,cAAf;AACH,KAFD,MAEO;AACH0B,MAAAA,IAAI,CAACe,MAAL,IAAe,CAACzC,cAAhB;AACH;;AACD,QAAIf,YAAY,CAACgJ,WAAW,CAACE,cAAb,EAA6B,IAA7B,CAAhB,EAAoD;AAChDzG,MAAAA,IAAI,CAACe,MAAL,IAAexC,YAAf;AACH,KAFD,MAEO;AACHyB,MAAAA,IAAI,CAACe,MAAL,IAAe,CAACxC,YAAhB;AACH;;AACDyB,IAAAA,IAAI,CAAC0B,OAAL;AACH,GAtNkB;AAuNnBgF,EAAAA,UAAU,EAAE,oBAAShC,OAAT,EAAkB;AAC1B,QAAI1E,IAAI,GAAG,IAAX;AACAA,IAAAA,IAAI,CAACkG,UAAL,GAAkB,CAAC,CAAC3I,YAAY,CAACmH,OAAO,CAACiC,OAAT,EAAkB,IAAlB,CAAhC;AACA3G,IAAAA,IAAI,CAACgG,OAAL,GAAetB,OAAO,CAACkC,MAAR,IAAkB,CAAjC;AACA5G,IAAAA,IAAI,CAAC2F,cAAL,GAAsB;AAClBkB,MAAAA,KAAK,EAAE,IAAI7G,IAAI,CAACgG,OAAT,GAAmBzG,WADR;AAElBuH,MAAAA,MAAM,EAAE,IAAI9G,IAAI,CAACgG,OAAT,GAAmBxG,YAFT;AAGlBuH,MAAAA,mBAAmB,EAAEtJ,wBAAwB,CAACiH,OAAO,CAACqC,mBAAT,EAA8B,MAA9B,CAH3B;AAIlBC,MAAAA,iBAAiB,EAAErJ,sBAAsB,CAAC+G,OAAO,CAACsC,iBAAT,EAA4B,KAA5B;AAJvB,KAAtB;;AAMAhH,IAAAA,IAAI,CAACgE,aAAL,CAAmBF,IAAnB,CAAwB;AACpB,sBAAgBY,OAAO,CAACuC,WADJ;AAEpB/C,MAAAA,MAAM,EAAEQ,OAAO,CAACwC,WAFI;AAGpB/C,MAAAA,IAAI,EAAEO,OAAO,CAACyC,KAHM;AAIpB,sBAAgBzC,OAAO,CAACN;AAJJ,KAAxB;;AAMApE,IAAAA,IAAI,CAAC0B,OAAL;AACH,GAxOkB;AAyOnBO,EAAAA,WAAW,EAAE,qBAASN,IAAT,EAAe;AACxB,QAAI3B,IAAI,GAAG,IAAX;AACA,QAAIoH,SAAJ;AACA,QAAItB,CAAJ;AACA,QAAI1D,KAAK,GAAG5D,YAAY,CAACQ,qBAAzB;AACA,QAAI4D,GAAG,GAAGpE,YAAY,CAACS,mBAAvB;AACA,QAAIoI,CAAC,GAAG7I,YAAY,CAACW,WAArB;AACAa,IAAAA,IAAI,CAACsH,WAAL,GAAmBzK,IAAI,CAACF,IAAI,CAACI,MAAM,CAAC4E,IAAD,CAAP,EAAe3B,IAAI,CAAC6B,cAApB,CAAL,EAA0C,CAA1C,CAAvB;AACAuF,IAAAA,SAAS,GAAG;AACRnB,MAAAA,UAAU,EAAE,CAAClJ,MAAM,CAACiD,IAAI,CAACsH,WAAL,GAAmBtH,IAAI,CAAC+B,iBAAzB;AADX,KAAZ;AAGA+D,IAAAA,CAAC,GAAGlD,GAAG,GAAGyE,CAAC,GAAG,CAAV,GAAcD,SAAS,CAACnB,UAA5B;;AACAjG,IAAAA,IAAI,CAACkF,SAAL,CAAepB,IAAf,CAAoB;AAChByD,MAAAA,MAAM,EAAE,CACJ,CAAC,CAAD,EAAInF,KAAJ,EAAW,CAAX,EAAcvF,IAAI,CAACuF,KAAD,EAAQ0D,CAAR,CAAlB,CADI,EAEJ,CAAC,CAAD,EAAInJ,IAAI,CAACiG,GAAD,EAAMkD,CAAC,GAAGuB,CAAV,CAAR,EAAsB,CAAtB,EAAyBzE,GAAzB,CAFI;AADQ,KAApB;;AAMA5C,IAAAA,IAAI,CAACmF,SAAL,CAAerB,IAAf,CAAoBsD,SAApB;;AACApH,IAAAA,IAAI,CAACsF,gBAAL,CAAsBxB,IAAtB,CAA2BsD,SAA3B;AACH,GA7PkB;AA8PnBI,EAAAA,UAAU,EAAE,sBAAW;AACnB,SAAKjG,UAAL,CAAgBI,IAAhB,CAAqB,KAAK2F,WAA1B;AACH,GAhQkB;AAiQnB9E,EAAAA,aAAa,EAAE,uBAASiF,OAAT,EAAkBpF,GAAlB,EAAuB;AAClC,QAAIqF,WAAJ;;AACA,QAAI,KAAKlC,SAAT,EAAoB;AAChBkC,MAAAA,WAAW,GAAGjI,mBAAmB,CAACgI,OAAD,CAAjC;AACA,WAAKE,QAAL,GAAgBD,WAAW,IAAIA,WAAW,CAACE,KAAZ,GAAoB,KAAK7G,MAAxC,GAAiD,IAAI2G,WAAJ,CAAgB,IAAhB,EAAsBD,OAAtB,EAA+BpF,GAA/B,CAAjD,GAAuF,IAAvG;AACH;AACJ,GAvQkB;AAwQnBM,EAAAA,YAAY,EAAE,sBAAS8E,OAAT,EAAkBpF,GAAlB,EAAuB;AACjC,SAAKsF,QAAL,IAAiB,KAAKA,QAAL,CAAcE,MAAd,CAAqBJ,OAArB,EAA8BpF,GAA9B,CAAjB;AACH,GA1QkB;AA2QnBQ,EAAAA,WAAW,EAAE,uBAAW;AACpB,SAAK8E,QAAL,IAAiB,KAAKA,QAAL,CAAcG,MAAd,EAAjB;AACA,SAAKH,QAAL,GAAgB,IAAhB;AACH;AA9QkB,CAAvB;;AAiRA,SAASI,cAAT,CAAwBN,OAAxB,EAAiC;AAC7B,SAAOA,OAAO,CAACO,MAAf;;AACAP,EAAAA,OAAO,CAACI,MAAR,GAAiB,YAAW,CAAE,CAA9B;;AACAJ,EAAAA,OAAO,CAACK,MAAR,GAAiB,YAAW,CAAE,CAA9B;AACH;;AAED,SAASpI,YAAT,CAAsBuI,KAAtB,EAA6BR,OAA7B,EAAsC;AAClC,OAAKO,MAAL,GAAcC,KAAd;AACA,OAAKN,QAAL,GAAgBF,OAAhB;AACH;;AACD/H,YAAY,CAACkI,KAAb,GAAqBtJ,cAAc,GAAGC,YAAtC;;AACAmB,YAAY,CAACmB,SAAb,CAAuBgH,MAAvB,GAAgC,UAASJ,OAAT,EAAkB;AAC9CA,EAAAA,OAAO,KAAK,KAAKE,QAAjB,IAA6BI,cAAc,CAAC,IAAD,CAA3C;AACH,CAFD;;AAGArI,YAAY,CAACmB,SAAb,CAAuBiH,MAAvB,GAAgC,YAAW;AACvC,MAAIF,KAAK,GAAG,KAAKI,MAAL,CAAYjH,MAAxB;;AACA,OAAKiH,MAAL,CAAYzG,UAAZ,CAAuBuB,KAAvB,CAA6B,CAAC,EAAE8E,KAAK,GAAGtJ,cAAV,CAA9B,EAAyD,CAAC,EAAEsJ,KAAK,GAAGrJ,YAAV,CAA1D;;AACAwJ,EAAAA,cAAc,CAAC,IAAD,CAAd;AACH,CAJD;;AAMA,SAASpI,WAAT,CAAqBsI,KAArB,EAA4BR,OAA5B,EAAqCpF,GAArC,EAA0C;AACtC,OAAKsF,QAAL,GAAgBF,OAAhB;AACA,MAAIS,OAAO,GAAG,IAAd;AACA,MAAIC,QAAQ,GAAG,GAAf;AACA,MAAIC,EAAE,GAAG,CAAT;AACA,MAAIC,EAAE,GAAG,CAAT;;AACA,UAAQ,KAAKV,QAAb;AACI,SAAK9J,eAAL;AACIwK,MAAAA,EAAE,GAAG,CAAC,EAAN;AACA;;AACJ,SAAKvK,kBAAL;AACIsK,MAAAA,EAAE,GAAG,EAAL;AACA;;AACJ,SAAKrK,iBAAL;AACIsK,MAAAA,EAAE,GAAG,EAAL;AACA;;AACJ,SAAKrK,iBAAL;AACIoK,MAAAA,EAAE,GAAG,CAAC,EAAN;AAXR;;AAcA,WAASE,QAAT,GAAoB;AAChBL,IAAAA,KAAK,CAAC1G,UAAN,CAAiBmB,IAAjB,CAAsB,CAAC0F,EAAD,EAAKC,EAAL,CAAtB;;AACAH,IAAAA,OAAO,GAAGK,UAAU,CAACD,QAAD,EAAWH,QAAX,CAApB;AACH;;AACD,OAAKK,KAAL,GAAa,YAAW;AACpBC,IAAAA,YAAY,CAACP,OAAD,CAAZ;;AACAD,IAAAA,KAAK,CAAC1G,UAAN,CAAiB8B,OAAjB;;AACA,SAAKmF,KAAL,GAAaP,KAAK,GAAG,IAArB;AACA,WAAO,IAAP;AACH,GALD;;AAMA5F,EAAAA,GAAG,GAAG,IAAN;;AACA4F,EAAAA,KAAK,CAAC1G,UAAN,CAAiB4B,SAAjB;;AACAmF,EAAAA,QAAQ;AACX;;AACD3I,WAAW,CAACiI,KAAZ,GAAoBtJ,cAApB;;AACAqB,WAAW,CAACkB,SAAZ,CAAsBgH,MAAtB,GAA+B,UAASJ,OAAT,EAAkB;AAC7C,OAAKE,QAAL,KAAkBF,OAAlB,IAA6B,KAAKK,MAAL,EAA7B;AACH,CAFD;;AAGAnI,WAAW,CAACkB,SAAZ,CAAsBiH,MAAtB,GAA+B,YAAW;AACtCC,EAAAA,cAAc,CAAC,KAAKS,KAAL,EAAD,CAAd;AACH,CAFD;;AAIA,SAAS5I,WAAT,CAAqBqI,KAArB,EAA4BR,OAA5B,EAAqC;AACjC,OAAKO,MAAL,GAAcC,KAAd;AACA,OAAKN,QAAL,GAAgBF,OAAhB;AACA,MAAIS,OAAO,GAAG,IAAd;AACA,MAAIC,QAAQ,GAAG,GAAf;AACA,MAAIO,KAAK,GAAG,KAAKf,QAAL,KAAkB1J,eAAlB,GAAoC,CAApC,GAAwC,CAAC,CAArD;;AAEA,WAASqK,QAAT,GAAoB;AAChBL,IAAAA,KAAK,CAAChG,WAAN,CAAkBgG,KAAK,CAACX,WAAN,GAAoBoB,KAAtC;;AACAR,IAAAA,OAAO,GAAGK,UAAU,CAACD,QAAD,EAAWH,QAAX,CAApB;AACH;;AACD,OAAKK,KAAL,GAAa,YAAW;AACpBC,IAAAA,YAAY,CAACP,OAAD,CAAZ;AACA,SAAKM,KAAL,GAAaP,KAAK,GAAG,IAArB;AACA,WAAO,IAAP;AACH,GAJD;;AAKAK,EAAAA,QAAQ;AACX;;AACD1I,WAAW,CAACgI,KAAZ,GAAoBrJ,YAApB;;AACAqB,WAAW,CAACiB,SAAZ,CAAsBgH,MAAtB,GAA+B,UAASJ,OAAT,EAAkB;AAC7C,OAAKE,QAAL,KAAkBF,OAAlB,IAA6B,KAAKK,MAAL,EAA7B;AACH,CAFD;;AAGAlI,WAAW,CAACiB,SAAZ,CAAsBiH,MAAtB,GAA+B,YAAW;AACtC,OAAKE,MAAL,CAAYR,UAAZ;;AACAO,EAAAA,cAAc,CAAC,KAAKS,KAAL,EAAD,CAAd;AACH,CAHD;;AAKA,SAAS3I,eAAT,CAAyBoI,KAAzB,EAAgCR,OAAhC,EAAyCpF,GAAzC,EAA8C;AAC1C,OAAK2F,MAAL,GAAcC,KAAd;AACA,OAAKX,WAAL,GAAmBW,KAAK,CAACX,WAAzB;AACA,OAAKqB,IAAL,GAAYtG,GAAG,CAACyD,CAAhB;AACH;;AACDjG,eAAe,CAAC+H,KAAhB,GAAwBrJ,YAAxB;;AACAsB,eAAe,CAACgB,SAAhB,CAA0BgH,MAA1B,GAAmC,UAASJ,OAAT,EAAkBpF,GAAlB,EAAuB;AACtD,MAAI4F,KAAK,GAAG,KAAKD,MAAjB;;AACAC,EAAAA,KAAK,CAAChG,WAAN,CAAkB,KAAKqF,WAAL,GAAmBW,KAAK,CAACpG,cAAN,IAAwB,KAAK8G,IAAL,GAAYtG,GAAG,CAACyD,CAAxC,IAA6CmC,KAAK,CAACjG,iBAAxF;AACH,CAHD;;AAIAnC,eAAe,CAACgB,SAAhB,CAA0BiH,MAA1B,GAAmC,YAAW;AAC1C,OAAKE,MAAL,CAAYR,UAAZ;;AACAO,EAAAA,cAAc,CAAC,IAAD,CAAd;AACH,CAHD;;AAIAa,OAAO,CAAC9I,UAAR,GAAqBA,UAArB","sourcesContent":["/**\r\n * DevExtreme (viz/vector_map/control_bar.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar _math = Math;\r\nvar _min = _math.min;\r\nvar _max = _math.max;\r\nvar _round = _math.round;\r\nvar _floor = _math.floor;\r\nvar _sqrt = _math.sqrt;\r\nvar vizUtils = require(\"../core/utils\");\r\nvar _parseScalar = vizUtils.parseScalar;\r\nvar parseHorizontalAlignment = vizUtils.enumParser([\"left\", \"center\", \"right\"]);\r\nvar parseVerticalAlignment = vizUtils.enumParser([\"top\", \"bottom\"]);\r\nvar COMMAND_RESET = \"command-reset\";\r\nvar COMMAND_MOVE_UP = \"command-move-up\";\r\nvar COMMAND_MOVE_RIGHT = \"command-move-right\";\r\nvar COMMAND_MOVE_DOWN = \"command-move-down\";\r\nvar COMMAND_MOVE_LEFT = \"command-move-left\";\r\nvar COMMAND_ZOOM_IN = \"command-zoom-in\";\r\nvar COMMAND_ZOOM_OUT = \"command-zoom-out\";\r\nvar COMMAND_ZOOM_DRAG_LINE = \"command-zoom-drag-line\";\r\nvar COMMAND_ZOOM_DRAG = \"command-zoom-drag\";\r\nvar EVENT_TARGET_TYPE = \"control-bar\";\r\nvar FLAG_CENTERING = 1;\r\nvar FLAG_ZOOMING = 2;\r\nvar SIZE_OPTIONS = {\r\n    bigCircleSize: 58,\r\n    smallCircleSize: 28,\r\n    buttonSize: 10,\r\n    arrowButtonOffset: 20,\r\n    incDecButtonSize: 11,\r\n    incButtonOffset: 66,\r\n    decButtonOffset: 227,\r\n    sliderLineStartOffset: 88.5,\r\n    sliderLineEndOffset: 205.5,\r\n    sliderLength: 20,\r\n    sliderWidth: 8,\r\n    trackerGap: 4\r\n};\r\nvar OFFSET_X = 30.5;\r\nvar OFFSET_Y = 30.5;\r\nvar TOTAL_WIDTH = 61;\r\nvar TOTAL_HEIGHT = 274;\r\nvar COMMAND_TO_TYPE_MAP = {};\r\nCOMMAND_TO_TYPE_MAP[COMMAND_RESET] = ResetCommand;\r\nCOMMAND_TO_TYPE_MAP[COMMAND_MOVE_UP] = COMMAND_TO_TYPE_MAP[COMMAND_MOVE_RIGHT] = COMMAND_TO_TYPE_MAP[COMMAND_MOVE_DOWN] = COMMAND_TO_TYPE_MAP[COMMAND_MOVE_LEFT] = MoveCommand;\r\nCOMMAND_TO_TYPE_MAP[COMMAND_ZOOM_IN] = COMMAND_TO_TYPE_MAP[COMMAND_ZOOM_OUT] = ZoomCommand;\r\nCOMMAND_TO_TYPE_MAP[COMMAND_ZOOM_DRAG] = ZoomDragCommand;\r\n\r\nfunction ControlBar(parameters) {\r\n    var that = this;\r\n    that._params = parameters;\r\n    that._createElements(parameters.renderer, parameters.container, parameters.dataKey);\r\n    parameters.layoutControl.addItem(that);\r\n    that._subscribeToProjection(parameters.projection);\r\n    that._subscribeToTracker(parameters.tracker);\r\n    that._createCallbacks(parameters.projection)\r\n}\r\nControlBar.prototype = {\r\n    constructor: ControlBar,\r\n    _flags: 0,\r\n    dispose: function() {\r\n        var that = this;\r\n        that._params.layoutControl.removeItem(that);\r\n        that._root.linkRemove().linkOff();\r\n        that._offProjection();\r\n        that._offTracker();\r\n        that._params = that._root = that._offProjection = that._offTracker = that._callbacks = null\r\n    },\r\n    _subscribeToProjection: function(projection) {\r\n        var that = this;\r\n        that._offProjection = projection.on({\r\n            engine: function() {\r\n                that._update()\r\n            },\r\n            zoom: updateZoom,\r\n            \"max-zoom\": function() {\r\n                that._zoomPartition = projection.getZoomScalePartition();\r\n                that._sliderUnitLength = that._sliderLineLength / that._zoomPartition;\r\n                updateZoom()\r\n            }\r\n        });\r\n\r\n        function updateZoom() {\r\n            that._adjustZoom(projection.getScaledZoom())\r\n        }\r\n    },\r\n    _subscribeToTracker: function(tracker) {\r\n        var that = this;\r\n        var isActive = false;\r\n        that._offTracker = tracker.on({\r\n            start: function(arg) {\r\n                isActive = arg.data.name === EVENT_TARGET_TYPE;\r\n                if (isActive) {\r\n                    that._processStart(arg.data.index, arg)\r\n                }\r\n            },\r\n            move: function(arg) {\r\n                if (isActive) {\r\n                    that._processMove(arg.data.index, arg)\r\n                }\r\n            },\r\n            end: function() {\r\n                if (isActive) {\r\n                    that._processEnd();\r\n                    isActive = false\r\n                }\r\n            }\r\n        })\r\n    },\r\n    _createCallbacks: function(projection) {\r\n        var that = this;\r\n        that._callbacks = {\r\n            reset: function(isCenter, isZoom) {\r\n                if (isCenter) {\r\n                    projection.setCenter(null)\r\n                }\r\n                if (isZoom) {\r\n                    projection.setZoom(null)\r\n                }\r\n            },\r\n            beginMove: function() {\r\n                projection.beginMoveCenter()\r\n            },\r\n            endMove: function() {\r\n                projection.endMoveCenter()\r\n            },\r\n            move: function(shift) {\r\n                projection.moveCenter(shift)\r\n            },\r\n            zoom: function(_zoom) {\r\n                projection.setScaledZoom(_zoom)\r\n            }\r\n        }\r\n    },\r\n    _createElements: function(renderer, container, dataKey) {\r\n        var that = this;\r\n        var buttonsGroups;\r\n        var trackersGroup;\r\n        that._root = renderer.g().attr({\r\n            \"class\": \"dxm-control-bar\"\r\n        }).linkOn(container, \"control-bar\");\r\n        buttonsGroups = that._buttonsGroup = renderer.g().attr({\r\n            \"class\": \"dxm-control-buttons\"\r\n        }).append(that._root);\r\n        trackersGroup = renderer.g().attr({\r\n            stroke: \"none\",\r\n            \"stroke-width\": 0,\r\n            fill: \"#000000\",\r\n            opacity: 1e-4\r\n        }).css({\r\n            cursor: \"pointer\"\r\n        }).append(that._root);\r\n        that._createButtons(renderer, dataKey, buttonsGroups);\r\n        that._createTrackers(renderer, dataKey, trackersGroup)\r\n    },\r\n    _createButtons: function(renderer, dataKey, group) {\r\n        var that = this;\r\n        var options = SIZE_OPTIONS;\r\n        var size = options.buttonSize / 2;\r\n        var offset1 = options.arrowButtonOffset - size;\r\n        var offset2 = options.arrowButtonOffset;\r\n        var incDecButtonSize = options.incDecButtonSize / 2;\r\n        var directionOptions = {\r\n            \"stroke-linecap\": \"square\",\r\n            fill: \"none\"\r\n        };\r\n        var line = \"line\";\r\n        renderer.circle(0, 0, options.bigCircleSize / 2).append(group);\r\n        renderer.circle(0, 0, size).attr({\r\n            fill: \"none\"\r\n        }).append(group);\r\n        renderer.path([-size, -offset1, 0, -offset2, size, -offset1], line).attr(directionOptions).append(group);\r\n        renderer.path([offset1, -size, offset2, 0, offset1, size], line).attr(directionOptions).append(group);\r\n        renderer.path([size, offset1, 0, offset2, -size, offset1], line).attr(directionOptions).append(group);\r\n        renderer.path([-offset1, size, -offset2, 0, -offset1, -size], line).attr(directionOptions).append(group);\r\n        renderer.circle(0, options.incButtonOffset, options.smallCircleSize / 2).append(group);\r\n        renderer.path([\r\n            [-incDecButtonSize, options.incButtonOffset, incDecButtonSize, options.incButtonOffset],\r\n            [0, options.incButtonOffset - incDecButtonSize, 0, options.incButtonOffset + incDecButtonSize]\r\n        ], \"area\").append(group);\r\n        renderer.circle(0, options.decButtonOffset, options.smallCircleSize / 2).append(group);\r\n        renderer.path([-incDecButtonSize, options.decButtonOffset, incDecButtonSize, options.decButtonOffset], \"area\").append(group);\r\n        that._zoomLine = renderer.path([], \"line\").append(group);\r\n        that._zoomDrag = renderer.rect(_floor(-options.sliderLength / 2), _floor(options.sliderLineEndOffset - options.sliderWidth / 2), options.sliderLength, options.sliderWidth).append(group);\r\n        that._sliderLineLength = options.sliderLineEndOffset - options.sliderLineStartOffset\r\n    },\r\n    _createTrackers: function(renderer, dataKey, group) {\r\n        var options = SIZE_OPTIONS;\r\n        var size = _round((options.arrowButtonOffset - options.trackerGap) / 2);\r\n        var offset1 = options.arrowButtonOffset - size;\r\n        var offset2 = _round(_sqrt(options.bigCircleSize * options.bigCircleSize / 4 - size * size));\r\n        var size2 = offset2 - offset1;\r\n        renderer.rect(-size, -size, 2 * size, 2 * size).data(dataKey, {\r\n            index: COMMAND_RESET,\r\n            name: EVENT_TARGET_TYPE\r\n        }).append(group);\r\n        renderer.rect(-size, -offset2, 2 * size, size2).data(dataKey, {\r\n            index: COMMAND_MOVE_UP,\r\n            name: EVENT_TARGET_TYPE\r\n        }).append(group);\r\n        renderer.rect(offset1, -size, size2, 2 * size).data(dataKey, {\r\n            index: COMMAND_MOVE_RIGHT,\r\n            name: EVENT_TARGET_TYPE\r\n        }).append(group);\r\n        renderer.rect(-size, offset1, 2 * size, size2).data(dataKey, {\r\n            index: COMMAND_MOVE_DOWN,\r\n            name: EVENT_TARGET_TYPE\r\n        }).append(group);\r\n        renderer.rect(-offset2, -size, size2, 2 * size).data(dataKey, {\r\n            index: COMMAND_MOVE_LEFT,\r\n            name: EVENT_TARGET_TYPE\r\n        }).append(group);\r\n        renderer.circle(0, options.incButtonOffset, options.smallCircleSize / 2).data(dataKey, {\r\n            index: COMMAND_ZOOM_IN,\r\n            name: EVENT_TARGET_TYPE\r\n        }).append(group);\r\n        renderer.circle(0, options.decButtonOffset, options.smallCircleSize / 2).data(dataKey, {\r\n            index: COMMAND_ZOOM_OUT,\r\n            name: EVENT_TARGET_TYPE\r\n        }).append(group);\r\n        renderer.rect(-2, options.sliderLineStartOffset - 2, 4, options.sliderLineEndOffset - options.sliderLineStartOffset + 4).css({\r\n            cursor: \"default\"\r\n        }).data(dataKey, {\r\n            index: COMMAND_ZOOM_DRAG_LINE,\r\n            name: EVENT_TARGET_TYPE\r\n        }).append(group);\r\n        this._zoomDragTracker = renderer.rect(-options.sliderLength / 2, options.sliderLineEndOffset - options.sliderWidth / 2, options.sliderLength, options.sliderWidth).data(dataKey, {\r\n            index: COMMAND_ZOOM_DRAG,\r\n            name: EVENT_TARGET_TYPE\r\n        }).append(group)\r\n    },\r\n    resize: function(size) {\r\n        if (this._isActive) {\r\n            this._root.attr({\r\n                visibility: null !== size ? null : \"hidden\"\r\n            })\r\n        }\r\n    },\r\n    getLayoutOptions: function() {\r\n        return this._isActive ? this._layoutOptions : null\r\n    },\r\n    locate: function(x, y) {\r\n        this._root.attr({\r\n            translateX: x + this._margin + OFFSET_X,\r\n            translateY: y + this._margin + OFFSET_Y\r\n        })\r\n    },\r\n    _update: function() {\r\n        var that = this;\r\n        that._isActive = that._isEnabled && that._flags && that._params.projection.isInvertible();\r\n        if (that._isActive) {\r\n            that._root.linkAppend()\r\n        } else {\r\n            that._root.linkRemove()\r\n        }\r\n        that._processEnd();\r\n        that.updateLayout()\r\n    },\r\n    setInteraction: function(interaction) {\r\n        var that = this;\r\n        if (_parseScalar(interaction.centeringEnabled, true)) {\r\n            that._flags |= FLAG_CENTERING\r\n        } else {\r\n            that._flags &= ~FLAG_CENTERING\r\n        }\r\n        if (_parseScalar(interaction.zoomingEnabled, true)) {\r\n            that._flags |= FLAG_ZOOMING\r\n        } else {\r\n            that._flags &= ~FLAG_ZOOMING\r\n        }\r\n        that._update()\r\n    },\r\n    setOptions: function(options) {\r\n        var that = this;\r\n        that._isEnabled = !!_parseScalar(options.enabled, true);\r\n        that._margin = options.margin || 0;\r\n        that._layoutOptions = {\r\n            width: 2 * that._margin + TOTAL_WIDTH,\r\n            height: 2 * that._margin + TOTAL_HEIGHT,\r\n            horizontalAlignment: parseHorizontalAlignment(options.horizontalAlignment, \"left\"),\r\n            verticalAlignment: parseVerticalAlignment(options.verticalAlignment, \"top\")\r\n        };\r\n        that._buttonsGroup.attr({\r\n            \"stroke-width\": options.borderWidth,\r\n            stroke: options.borderColor,\r\n            fill: options.color,\r\n            \"fill-opacity\": options.opacity\r\n        });\r\n        that._update()\r\n    },\r\n    _adjustZoom: function(zoom) {\r\n        var that = this;\r\n        var transform;\r\n        var y;\r\n        var start = SIZE_OPTIONS.sliderLineStartOffset;\r\n        var end = SIZE_OPTIONS.sliderLineEndOffset;\r\n        var h = SIZE_OPTIONS.sliderWidth;\r\n        that._zoomFactor = _max(_min(_round(zoom), that._zoomPartition), 0);\r\n        transform = {\r\n            translateY: -_round(that._zoomFactor * that._sliderUnitLength)\r\n        };\r\n        y = end - h / 2 + transform.translateY;\r\n        that._zoomLine.attr({\r\n            points: [\r\n                [0, start, 0, _max(start, y)],\r\n                [0, _min(end, y + h), 0, end]\r\n            ]\r\n        });\r\n        that._zoomDrag.attr(transform);\r\n        that._zoomDragTracker.attr(transform)\r\n    },\r\n    _applyZoom: function() {\r\n        this._callbacks.zoom(this._zoomFactor)\r\n    },\r\n    _processStart: function(command, arg) {\r\n        var commandType;\r\n        if (this._isActive) {\r\n            commandType = COMMAND_TO_TYPE_MAP[command];\r\n            this._command = commandType && commandType.flags & this._flags ? new commandType(this, command, arg) : null\r\n        }\r\n    },\r\n    _processMove: function(command, arg) {\r\n        this._command && this._command.update(command, arg)\r\n    },\r\n    _processEnd: function() {\r\n        this._command && this._command.finish();\r\n        this._command = null\r\n    }\r\n};\r\n\r\nfunction disposeCommand(command) {\r\n    delete command._owner;\r\n    command.update = function() {};\r\n    command.finish = function() {}\r\n}\r\n\r\nfunction ResetCommand(owner, command) {\r\n    this._owner = owner;\r\n    this._command = command\r\n}\r\nResetCommand.flags = FLAG_CENTERING | FLAG_ZOOMING;\r\nResetCommand.prototype.update = function(command) {\r\n    command !== this._command && disposeCommand(this)\r\n};\r\nResetCommand.prototype.finish = function() {\r\n    var flags = this._owner._flags;\r\n    this._owner._callbacks.reset(!!(flags & FLAG_CENTERING), !!(flags & FLAG_ZOOMING));\r\n    disposeCommand(this)\r\n};\r\n\r\nfunction MoveCommand(owner, command, arg) {\r\n    this._command = command;\r\n    var timeout = null;\r\n    var interval = 100;\r\n    var dx = 0;\r\n    var dy = 0;\r\n    switch (this._command) {\r\n        case COMMAND_MOVE_UP:\r\n            dy = -10;\r\n            break;\r\n        case COMMAND_MOVE_RIGHT:\r\n            dx = 10;\r\n            break;\r\n        case COMMAND_MOVE_DOWN:\r\n            dy = 10;\r\n            break;\r\n        case COMMAND_MOVE_LEFT:\r\n            dx = -10\r\n    }\r\n\r\n    function callback() {\r\n        owner._callbacks.move([dx, dy]);\r\n        timeout = setTimeout(callback, interval)\r\n    }\r\n    this._stop = function() {\r\n        clearTimeout(timeout);\r\n        owner._callbacks.endMove();\r\n        this._stop = owner = null;\r\n        return this\r\n    };\r\n    arg = null;\r\n    owner._callbacks.beginMove();\r\n    callback()\r\n}\r\nMoveCommand.flags = FLAG_CENTERING;\r\nMoveCommand.prototype.update = function(command) {\r\n    this._command !== command && this.finish()\r\n};\r\nMoveCommand.prototype.finish = function() {\r\n    disposeCommand(this._stop())\r\n};\r\n\r\nfunction ZoomCommand(owner, command) {\r\n    this._owner = owner;\r\n    this._command = command;\r\n    var timeout = null;\r\n    var interval = 150;\r\n    var dZoom = this._command === COMMAND_ZOOM_IN ? 1 : -1;\r\n\r\n    function callback() {\r\n        owner._adjustZoom(owner._zoomFactor + dZoom);\r\n        timeout = setTimeout(callback, interval)\r\n    }\r\n    this._stop = function() {\r\n        clearTimeout(timeout);\r\n        this._stop = owner = null;\r\n        return this\r\n    };\r\n    callback()\r\n}\r\nZoomCommand.flags = FLAG_ZOOMING;\r\nZoomCommand.prototype.update = function(command) {\r\n    this._command !== command && this.finish()\r\n};\r\nZoomCommand.prototype.finish = function() {\r\n    this._owner._applyZoom();\r\n    disposeCommand(this._stop())\r\n};\r\n\r\nfunction ZoomDragCommand(owner, command, arg) {\r\n    this._owner = owner;\r\n    this._zoomFactor = owner._zoomFactor;\r\n    this._pos = arg.y\r\n}\r\nZoomDragCommand.flags = FLAG_ZOOMING;\r\nZoomDragCommand.prototype.update = function(command, arg) {\r\n    var owner = this._owner;\r\n    owner._adjustZoom(this._zoomFactor + owner._zoomPartition * (this._pos - arg.y) / owner._sliderLineLength)\r\n};\r\nZoomDragCommand.prototype.finish = function() {\r\n    this._owner._applyZoom();\r\n    disposeCommand(this)\r\n};\r\nexports.ControlBar = ControlBar;\r\n"]},"metadata":{},"sourceType":"script"}