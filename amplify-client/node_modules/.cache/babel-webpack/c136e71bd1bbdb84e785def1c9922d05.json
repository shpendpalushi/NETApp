{"ast":null,"code":"/**\r\n * DevExtreme (ui/data_grid/ui.data_grid.grouping.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar _renderer = require(\"../../core/renderer\");\n\nvar _renderer2 = _interopRequireDefault(_renderer);\n\nvar _uiData_grid = require(\"./ui.data_grid.core\");\n\nvar _uiData_grid2 = _interopRequireDefault(_uiData_grid);\n\nvar _uiData_gridGrouping = require(\"./ui.data_grid.grouping.expanded\");\n\nvar _uiData_gridGrouping2 = require(\"./ui.data_grid.grouping.collapsed\");\n\nvar _message = require(\"../../localization/message\");\n\nvar _message2 = _interopRequireDefault(_message);\n\nvar _uiData_grid3 = require(\"./ui.data_grid.data_source_adapter\");\n\nvar _uiData_grid4 = _interopRequireDefault(_uiData_grid3);\n\nvar _type = require(\"../../core/utils/type\");\n\nvar _iterator = require(\"../../core/utils/iterator\");\n\nvar _devices = require(\"../../core/devices\");\n\nvar _devices2 = _interopRequireDefault(_devices);\n\nvar _deferred = require(\"../../core/utils/deferred\");\n\nvar _uiGrid_core = require(\"../grid_core/ui.grid_core.accessibility\");\n\nvar _accessibility = require(\"../shared/accessibility\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nvar DATAGRID_GROUP_PANEL_CLASS = \"dx-datagrid-group-panel\";\nvar DATAGRID_GROUP_PANEL_MESSAGE_CLASS = \"dx-group-panel-message\";\nvar DATAGRID_GROUP_PANEL_ITEM_CLASS = \"dx-group-panel-item\";\nvar DATAGRID_GROUP_PANEL_LABEL_CLASS = \"dx-toolbar-label\";\nvar DATAGRID_EXPAND_CLASS = \"dx-datagrid-expand\";\nvar DATAGRID_GROUP_ROW_CLASS = \"dx-group-row\";\nvar HEADER_FILTER_CLASS_SELECTOR = \".dx-header-filter\";\n\nvar GroupingDataSourceAdapterExtender = function () {\n  return {\n    init: function init() {\n      this.callBase.apply(this, arguments);\n\n      this._initGroupingHelper();\n    },\n    _initGroupingHelper: function _initGroupingHelper(options) {\n      var grouping = this._grouping;\n      var isAutoExpandAll = this.option(\"grouping.autoExpandAll\");\n      var isFocusedRowEnabled = this.option(\"focusedRowEnabled\");\n      var remoteOperations = options ? options.remoteOperations : this.remoteOperations();\n      var isODataRemoteOperations = remoteOperations.filtering && remoteOperations.sorting && remoteOperations.paging;\n\n      if (isODataRemoteOperations && !remoteOperations.grouping && (isAutoExpandAll || !isFocusedRowEnabled)) {\n        if (!grouping || grouping instanceof _uiData_gridGrouping2.GroupingHelper) {\n          this._grouping = new _uiData_gridGrouping.GroupingHelper(this);\n        }\n      } else {\n        if (!grouping || grouping instanceof _uiData_gridGrouping.GroupingHelper) {\n          this._grouping = new _uiData_gridGrouping2.GroupingHelper(this);\n        }\n      }\n    },\n    totalItemsCount: function totalItemsCount() {\n      var that = this;\n      var totalCount = that.callBase();\n      return totalCount > 0 && that._dataSource.group() && that._dataSource.requireTotalCount() ? totalCount + that._grouping.totalCountCorrection() : totalCount;\n    },\n    itemsCount: function itemsCount() {\n      return this._dataSource.group() ? this._grouping.itemsCount() || 0 : this.callBase.apply(this, arguments);\n    },\n    allowCollapseAll: function allowCollapseAll() {\n      return this._grouping.allowCollapseAll();\n    },\n    isGroupItemCountable: function isGroupItemCountable(item) {\n      return this._grouping.isGroupItemCountable(item);\n    },\n    isRowExpanded: function isRowExpanded(key) {\n      var groupInfo = this._grouping.findGroupInfo(key);\n\n      return groupInfo ? groupInfo.isExpanded : !this._grouping.allowCollapseAll();\n    },\n    collapseAll: function collapseAll(groupIndex) {\n      return this._collapseExpandAll(groupIndex, false);\n    },\n    expandAll: function expandAll(groupIndex) {\n      return this._collapseExpandAll(groupIndex, true);\n    },\n    _collapseExpandAll: function _collapseExpandAll(groupIndex, isExpand) {\n      var that = this;\n      var dataSource = that._dataSource;\n      var group = dataSource.group();\n\n      var groups = _uiData_grid2.default.normalizeSortingInfo(group || []);\n\n      var i;\n\n      if (groups.length) {\n        for (i = 0; i < groups.length; i++) {\n          if (void 0 === groupIndex || groupIndex === i) {\n            groups[i].isExpanded = isExpand;\n          } else {\n            if (group && group[i]) {\n              groups[i].isExpanded = group[i].isExpanded;\n            }\n          }\n        }\n\n        dataSource.group(groups);\n\n        that._grouping.foreachGroups(function (groupInfo, parents) {\n          if (void 0 === groupIndex || groupIndex === parents.length - 1) {\n            groupInfo.isExpanded = isExpand;\n          }\n        }, false, true);\n\n        that.resetPagesCache();\n      }\n\n      return true;\n    },\n    refresh: function refresh() {\n      this.callBase.apply(this, arguments);\n      return this._grouping.refresh.apply(this._grouping, arguments);\n    },\n    changeRowExpand: function changeRowExpand(path) {\n      var that = this;\n      var dataSource = that._dataSource;\n\n      if (dataSource.group()) {\n        dataSource.beginLoading();\n\n        if (that._lastLoadOptions) {\n          that._lastLoadOptions.groupExpand = true;\n        }\n\n        return that._changeRowExpandCore(path).always(function () {\n          dataSource.endLoading();\n        });\n      }\n    },\n    _changeRowExpandCore: function _changeRowExpandCore(path) {\n      return this._grouping.changeRowExpand(path);\n    },\n    _hasGroupLevelsExpandState: function _hasGroupLevelsExpandState(group, isExpanded) {\n      if (group && Array.isArray(group)) {\n        for (var i = 0; i < group.length; i++) {\n          if (group[i].isExpanded === isExpanded) {\n            return true;\n          }\n        }\n      }\n    },\n    _customizeRemoteOperations: function _customizeRemoteOperations(options, isReload, operationTypes) {\n      var remoteOperations = options.remoteOperations;\n\n      if (options.storeLoadOptions.group) {\n        if (remoteOperations.grouping && !options.isCustomLoading) {\n          if (!remoteOperations.groupPaging || this._hasGroupLevelsExpandState(options.storeLoadOptions.group, true)) {\n            remoteOperations.paging = false;\n          }\n        }\n\n        if (!remoteOperations.grouping && (!remoteOperations.sorting || !remoteOperations.filtering || options.isCustomLoading || this._hasGroupLevelsExpandState(options.storeLoadOptions.group, false))) {\n          remoteOperations.paging = false;\n        }\n      } else {\n        if (!options.isCustomLoading && remoteOperations.paging && operationTypes.grouping) {\n          this.resetCache();\n        }\n      }\n\n      this.callBase.apply(this, arguments);\n    },\n    _handleDataLoading: function _handleDataLoading(options) {\n      this.callBase(options);\n\n      this._initGroupingHelper(options);\n\n      return this._grouping.handleDataLoading(options);\n    },\n    _handleDataLoaded: function _handleDataLoaded(options) {\n      return this._grouping.handleDataLoaded(options, this.callBase.bind(this));\n    },\n    _handleDataLoadedCore: function _handleDataLoadedCore(options) {\n      return this._grouping.handleDataLoadedCore(options, this.callBase.bind(this));\n    }\n  };\n}();\n\n_uiData_grid4.default.extend(GroupingDataSourceAdapterExtender);\n\nvar GroupingDataControllerExtender = function () {\n  return {\n    init: function init() {\n      var that = this;\n      that.callBase();\n      that.createAction(\"onRowExpanding\");\n      that.createAction(\"onRowExpanded\");\n      that.createAction(\"onRowCollapsing\");\n      that.createAction(\"onRowCollapsed\");\n    },\n    _beforeProcessItems: function _beforeProcessItems(items) {\n      var groupColumns = this._columnsController.getGroupColumns();\n\n      items = this.callBase(items);\n\n      if (items.length && groupColumns.length) {\n        items = this._processGroupItems(items, groupColumns.length);\n      }\n\n      return items;\n    },\n    _processItem: function _processItem(item, options) {\n      if ((0, _type.isDefined)(item.groupIndex) && (0, _type.isString)(item.rowType) && 0 === item.rowType.indexOf(\"group\")) {\n        item = this._processGroupItem(item, options);\n        options.dataIndex = 0;\n      } else {\n        item = this.callBase.apply(this, arguments);\n      }\n\n      return item;\n    },\n    _processGroupItem: function _processGroupItem(item) {\n      return item;\n    },\n    _processGroupItems: function _processGroupItems(items, groupsCount, options) {\n      var that = this;\n\n      var groupedColumns = that._columnsController.getGroupColumns();\n\n      var column = groupedColumns[groupedColumns.length - groupsCount];\n      var scrollingMode;\n      var i;\n      var item;\n      var resultItems;\n\n      if (!options) {\n        scrollingMode = that.option(\"scrolling.mode\");\n        options = {\n          collectContinuationItems: \"virtual\" !== scrollingMode && \"infinite\" !== scrollingMode,\n          resultItems: [],\n          path: [],\n          values: []\n        };\n      }\n\n      resultItems = options.resultItems;\n\n      if (options.data) {\n        if (options.collectContinuationItems || !options.data.isContinuation) {\n          resultItems.push({\n            rowType: \"group\",\n            data: options.data,\n            groupIndex: options.path.length - 1,\n            isExpanded: !!options.data.items,\n            key: options.path.slice(0),\n            values: options.values.slice(0)\n          });\n        }\n      }\n\n      if (items) {\n        if (0 === groupsCount) {\n          resultItems.push.apply(resultItems, items);\n        } else {\n          for (i = 0; i < items.length; i++) {\n            item = items[i];\n\n            if (item && \"items\" in item) {\n              options.data = item;\n              options.path.push(item.key);\n              options.values.push(column && column.deserializeValue && !column.calculateDisplayValue ? column.deserializeValue(item.key) : item.key);\n\n              that._processGroupItems(item.items, groupsCount - 1, options);\n\n              options.data = void 0;\n              options.path.pop();\n              options.values.pop();\n            } else {\n              resultItems.push(item);\n            }\n          }\n        }\n      }\n\n      return resultItems;\n    },\n    publicMethods: function publicMethods() {\n      return this.callBase().concat([\"collapseAll\", \"expandAll\", \"isRowExpanded\", \"expandRow\", \"collapseRow\"]);\n    },\n    collapseAll: function collapseAll(groupIndex) {\n      var dataSource = this._dataSource;\n\n      if (dataSource && dataSource.collapseAll(groupIndex)) {\n        dataSource.pageIndex(0);\n        dataSource.reload();\n      }\n    },\n    expandAll: function expandAll(groupIndex) {\n      var dataSource = this._dataSource;\n\n      if (dataSource && dataSource.expandAll(groupIndex)) {\n        dataSource.pageIndex(0);\n        dataSource.reload();\n      }\n    },\n    changeRowExpand: function changeRowExpand(key) {\n      var that = this;\n      var expanded = that.isRowExpanded(key);\n      var args = {\n        key: key,\n        expanded: expanded\n      };\n      that.executeAction(expanded ? \"onRowCollapsing\" : \"onRowExpanding\", args);\n\n      if (!args.cancel) {\n        return (0, _deferred.when)(that._changeRowExpandCore(key)).done(function () {\n          args.expanded = !expanded;\n          that.executeAction(expanded ? \"onRowCollapsed\" : \"onRowExpanded\", args);\n        });\n      }\n\n      return new _deferred.Deferred().resolve();\n    },\n    _changeRowExpandCore: function _changeRowExpandCore(key) {\n      var that = this;\n      var dataSource = this._dataSource;\n      var d;\n\n      if (!dataSource) {\n        return;\n      }\n\n      d = new _deferred.Deferred();\n      (0, _deferred.when)(dataSource.changeRowExpand(key)).done(function () {\n        that.load().done(d.resolve).fail(d.reject);\n      }).fail(d.reject);\n      return d;\n    },\n    isRowExpanded: function isRowExpanded(key) {\n      var dataSource = this._dataSource;\n      return dataSource && dataSource.isRowExpanded(key);\n    },\n    expandRow: function expandRow(key) {\n      if (!this.isRowExpanded(key)) {\n        return this.changeRowExpand(key);\n      }\n\n      return new _deferred.Deferred().resolve();\n    },\n    collapseRow: function collapseRow(key) {\n      if (this.isRowExpanded(key)) {\n        return this.changeRowExpand(key);\n      }\n\n      return new _deferred.Deferred().resolve();\n    },\n    optionChanged: function optionChanged(args) {\n      if (\"grouping\" === args.name) {\n        args.name = \"dataSource\";\n      }\n\n      this.callBase(args);\n    }\n  };\n}();\n\nvar onGroupingMenuItemClick = function onGroupingMenuItemClick(column, params) {\n  var columnsController = this._columnsController;\n\n  switch (params.itemData.value) {\n    case \"group\":\n      var groups = columnsController._dataSource.group() || [];\n      columnsController.columnOption(column.dataField, \"groupIndex\", groups.length);\n      break;\n\n    case \"ungroup\":\n      columnsController.columnOption(column.dataField, \"groupIndex\", -1);\n      break;\n\n    case \"ungroupAll\":\n      this.component.clearGrouping();\n  }\n};\n\nvar GroupingHeaderPanelExtender = function () {\n  return {\n    _getToolbarItems: function _getToolbarItems() {\n      var items = this.callBase();\n      return this._appendGroupingItem(items);\n    },\n    _appendGroupingItem: function _appendGroupingItem(items) {\n      var that = this;\n      var isRendered = false;\n\n      var groupPanelRenderedCallback = function groupPanelRenderedCallback(e) {\n        var $groupPanel = (0, _renderer2.default)(e.itemElement).find(\".\" + DATAGRID_GROUP_PANEL_CLASS);\n\n        that._updateGroupPanelContent($groupPanel);\n\n        (0, _uiGrid_core.registerKeyboardAction)(\"groupPanel\", that, $groupPanel, void 0, that._handleActionKeyDown.bind(that));\n        isRendered && that.renderCompleted.fire();\n        isRendered = true;\n      };\n\n      if (that._isGroupPanelVisible()) {\n        var toolbarItem = {\n          html: \"<div class='\" + DATAGRID_GROUP_PANEL_CLASS + \"'></div>\",\n          name: \"groupPanel\",\n          onItemRendered: groupPanelRenderedCallback,\n          location: \"before\",\n          locateInMenu: \"never\",\n          sortIndex: 1\n        };\n        items.push(toolbarItem);\n      }\n\n      return items;\n    },\n    _handleActionKeyDown: function _handleActionKeyDown(args) {\n      var event = args.event;\n      var $target = (0, _renderer2.default)(event.target);\n      var groupColumnIndex = $target.closest(\".\".concat(DATAGRID_GROUP_PANEL_ITEM_CLASS)).index();\n\n      var column = this._columnsController.getGroupColumns()[groupColumnIndex];\n\n      var columnIndex = column && column.index;\n\n      if ($target.is(HEADER_FILTER_CLASS_SELECTOR)) {\n        this.getController(\"headerFilter\").showHeaderFilterMenu(columnIndex, true);\n      } else {\n        this._processGroupItemAction(columnIndex);\n      }\n\n      event.preventDefault();\n    },\n    _isGroupPanelVisible: function _isGroupPanelVisible() {\n      var groupPanelOptions = this.option(\"groupPanel\");\n      var isVisible;\n\n      if (groupPanelOptions) {\n        isVisible = groupPanelOptions.visible;\n\n        if (\"auto\" === isVisible) {\n          isVisible = \"desktop\" === _devices2.default.current().deviceType ? true : false;\n        }\n      }\n\n      return isVisible;\n    },\n    _renderGroupPanelItems: function _renderGroupPanelItems($groupPanel, groupColumns) {\n      var that = this;\n      $groupPanel.empty();\n      (0, _iterator.each)(groupColumns, function (index, groupColumn) {\n        that._createGroupPanelItem($groupPanel, groupColumn);\n      });\n      (0, _accessibility.restoreFocus)(this);\n    },\n    _createGroupPanelItem: function _createGroupPanelItem($rootElement, groupColumn) {\n      var $groupPanelItem = (0, _renderer2.default)(\"<div>\").addClass(groupColumn.cssClass).addClass(DATAGRID_GROUP_PANEL_ITEM_CLASS).data(\"columnData\", groupColumn).appendTo($rootElement).text(groupColumn.caption);\n      (0, _accessibility.setTabIndex)(this, $groupPanelItem);\n      return $groupPanelItem;\n    },\n    _columnOptionChanged: function _columnOptionChanged(e) {\n      if (!this._requireReady && !_uiData_grid2.default.checkChanges(e.optionNames, [\"width\", \"visibleWidth\"])) {\n        var $toolbarElement = this.element();\n        var $groupPanel = $toolbarElement && $toolbarElement.find(\".\" + DATAGRID_GROUP_PANEL_CLASS);\n\n        if ($groupPanel && $groupPanel.length) {\n          this._updateGroupPanelContent($groupPanel);\n\n          this.renderCompleted.fire();\n        }\n      }\n\n      this.callBase();\n    },\n    _updateGroupPanelContent: function _updateGroupPanelContent($groupPanel) {\n      var that = this;\n      var groupColumns = that.getController(\"columns\").getGroupColumns();\n      var groupPanelOptions = that.option(\"groupPanel\");\n\n      that._renderGroupPanelItems($groupPanel, groupColumns);\n\n      if (groupPanelOptions.allowColumnDragging && !groupColumns.length) {\n        (0, _renderer2.default)(\"<div>\").addClass(DATAGRID_GROUP_PANEL_MESSAGE_CLASS).text(groupPanelOptions.emptyPanelText).appendTo($groupPanel);\n        $groupPanel.closest(\".\" + DATAGRID_GROUP_PANEL_LABEL_CLASS).css(\"maxWidth\", \"none\");\n        that.updateToolbarDimensions();\n      }\n    },\n    allowDragging: function allowDragging(column) {\n      var groupPanelOptions = this.option(\"groupPanel\");\n      return this._isGroupPanelVisible() && groupPanelOptions.allowColumnDragging && column && column.allowGrouping;\n    },\n    getColumnElements: function getColumnElements() {\n      var $element = this.element();\n      return $element && $element.find(\".\" + DATAGRID_GROUP_PANEL_ITEM_CLASS);\n    },\n    getColumns: function getColumns() {\n      return this.getController(\"columns\").getGroupColumns();\n    },\n    getBoundingRect: function getBoundingRect() {\n      var that = this;\n      var $element = that.element();\n      var offset;\n\n      if ($element && $element.find(\".\" + DATAGRID_GROUP_PANEL_CLASS).length) {\n        offset = $element.offset();\n        return {\n          top: offset.top,\n          bottom: offset.top + $element.height()\n        };\n      }\n\n      return null;\n    },\n    getName: function getName() {\n      return \"group\";\n    },\n    getContextMenuItems: function getContextMenuItems(options) {\n      var that = this;\n      var contextMenuEnabled = that.option(\"grouping.contextMenuEnabled\");\n      var $groupedColumnElement = (0, _renderer2.default)(options.targetElement).closest(\".\" + DATAGRID_GROUP_PANEL_ITEM_CLASS);\n      var items;\n\n      if ($groupedColumnElement.length) {\n        options.column = $groupedColumnElement.data(\"columnData\");\n      }\n\n      if (contextMenuEnabled && options.column) {\n        var column = options.column;\n        var isGroupingAllowed = (0, _type.isDefined)(column.allowGrouping) ? column.allowGrouping : true;\n\n        if (isGroupingAllowed) {\n          var isColumnGrouped = (0, _type.isDefined)(column.groupIndex) && column.groupIndex > -1;\n          var groupingTexts = that.option(\"grouping.texts\");\n          var onItemClick = onGroupingMenuItemClick.bind(that, column);\n          items = [{\n            text: groupingTexts.ungroup,\n            value: \"ungroup\",\n            disabled: !isColumnGrouped,\n            onItemClick: onItemClick\n          }, {\n            text: groupingTexts.ungroupAll,\n            value: \"ungroupAll\",\n            onItemClick: onItemClick\n          }];\n        }\n      }\n\n      return items;\n    },\n    isVisible: function isVisible() {\n      return this.callBase() || this._isGroupPanelVisible();\n    },\n    optionChanged: function optionChanged(args) {\n      if (\"groupPanel\" === args.name) {\n        this._invalidate();\n\n        args.handled = true;\n      } else {\n        this.callBase(args);\n      }\n    }\n  };\n}();\n\nexports.GroupingHeaderPanelExtender = GroupingHeaderPanelExtender;\n\nvar GroupingRowsViewExtender = function () {\n  return {\n    getContextMenuItems: function getContextMenuItems(options) {\n      var that = this;\n      var contextMenuEnabled = that.option(\"grouping.contextMenuEnabled\");\n      var items;\n\n      if (contextMenuEnabled && options.row && \"group\" === options.row.rowType) {\n        var columnsController = that._columnsController;\n        var column = columnsController.columnOption(\"groupIndex:\" + options.row.groupIndex);\n\n        if (column && column.allowGrouping) {\n          var groupingTexts = that.option(\"grouping.texts\");\n          var onItemClick = onGroupingMenuItemClick.bind(that, column);\n          items = [];\n          items.push({\n            text: groupingTexts.ungroup,\n            value: \"ungroup\",\n            onItemClick: onItemClick\n          }, {\n            text: groupingTexts.ungroupAll,\n            value: \"ungroupAll\",\n            onItemClick: onItemClick\n          });\n        }\n      }\n\n      return items;\n    },\n    _rowClick: function _rowClick(e) {\n      var that = this;\n      var expandMode = that.option(\"grouping.expandMode\");\n      var scrollingMode = that.option(\"scrolling.mode\");\n      var isGroupRowStateChanged = \"infinite\" !== scrollingMode && \"rowClick\" === expandMode && (0, _renderer2.default)(e.event.target).closest(\".\" + DATAGRID_GROUP_ROW_CLASS).length;\n      var isExpandButtonClicked = (0, _renderer2.default)(e.event.target).closest(\".\" + DATAGRID_EXPAND_CLASS).length;\n\n      if (isGroupRowStateChanged || isExpandButtonClicked) {\n        that._changeGroupRowState(e);\n      }\n\n      that.callBase(e);\n    },\n    _changeGroupRowState: function _changeGroupRowState(e) {\n      var dataController = this.getController(\"data\");\n      var row = dataController.items()[e.rowIndex];\n\n      var allowCollapsing = this._columnsController.columnOption(\"groupIndex:\" + row.groupIndex, \"allowCollapsing\");\n\n      if (\"data\" === row.rowType || \"group\" === row.rowType && false !== allowCollapsing) {\n        dataController.changeRowExpand(row.key);\n        e.event.preventDefault();\n        e.handled = true;\n      }\n    }\n  };\n}();\n\nvar columnHeadersViewExtender = function () {\n  return {\n    getContextMenuItems: function getContextMenuItems(options) {\n      var that = this;\n      var contextMenuEnabled = that.option(\"grouping.contextMenuEnabled\");\n      var items = that.callBase(options);\n\n      if (contextMenuEnabled && options.row && (\"header\" === options.row.rowType || \"detailAdaptive\" === options.row.rowType)) {\n        var column = options.column;\n\n        if (!column.command && (!(0, _type.isDefined)(column.allowGrouping) || column.allowGrouping)) {\n          var groupingTexts = that.option(\"grouping.texts\");\n          var isColumnGrouped = (0, _type.isDefined)(column.groupIndex) && column.groupIndex > -1;\n          var onItemClick = onGroupingMenuItemClick.bind(that, column);\n          items = items || [];\n          items.push({\n            text: groupingTexts.groupByThisColumn,\n            value: \"group\",\n            beginGroup: true,\n            disabled: isColumnGrouped,\n            onItemClick: onItemClick\n          });\n\n          if (column.showWhenGrouped) {\n            items.push({\n              text: groupingTexts.ungroup,\n              value: \"ungroup\",\n              disabled: !isColumnGrouped,\n              onItemClick: onItemClick\n            });\n          }\n\n          items.push({\n            text: groupingTexts.ungroupAll,\n            value: \"ungroupAll\",\n            onItemClick: onItemClick\n          });\n        }\n      }\n\n      return items;\n    }\n  };\n}();\n\n_uiData_grid2.default.registerModule(\"grouping\", {\n  defaultOptions: function defaultOptions() {\n    return {\n      grouping: {\n        autoExpandAll: true,\n        allowCollapsing: true,\n        contextMenuEnabled: false,\n        expandMode: \"buttonClick\",\n        texts: {\n          groupContinuesMessage: _message2.default.format(\"dxDataGrid-groupContinuesMessage\"),\n          groupContinuedMessage: _message2.default.format(\"dxDataGrid-groupContinuedMessage\"),\n          groupByThisColumn: _message2.default.format(\"dxDataGrid-groupHeaderText\"),\n          ungroup: _message2.default.format(\"dxDataGrid-ungroupHeaderText\"),\n          ungroupAll: _message2.default.format(\"dxDataGrid-ungroupAllText\")\n        }\n      },\n      groupPanel: {\n        visible: false,\n        emptyPanelText: _message2.default.format(\"dxDataGrid-groupPanelEmptyText\"),\n        allowColumnDragging: true\n      }\n    };\n  },\n  extenders: {\n    controllers: {\n      data: GroupingDataControllerExtender,\n      columns: {\n        _getExpandColumnOptions: function _getExpandColumnOptions() {\n          var options = this.callBase.apply(this, arguments);\n          options.cellTemplate = _uiData_grid2.default.getExpandCellTemplate();\n          return options;\n        }\n      }\n    },\n    views: {\n      headerPanel: GroupingHeaderPanelExtender,\n      rowsView: GroupingRowsViewExtender,\n      columnHeadersView: columnHeadersViewExtender\n    }\n  }\n});","map":{"version":3,"sources":["C:/Users/User/Documents/Templates/Angular/black-dashboard-pro-angular-v1.1.1/black-dashboard-pro-angular-v1.1.1/node_modules/devextreme/ui/data_grid/ui.data_grid.grouping.js"],"names":["_renderer","require","_renderer2","_interopRequireDefault","_uiData_grid","_uiData_grid2","_uiData_gridGrouping","_uiData_gridGrouping2","_message","_message2","_uiData_grid3","_uiData_grid4","_type","_iterator","_devices","_devices2","_deferred","_uiGrid_core","_accessibility","obj","__esModule","DATAGRID_GROUP_PANEL_CLASS","DATAGRID_GROUP_PANEL_MESSAGE_CLASS","DATAGRID_GROUP_PANEL_ITEM_CLASS","DATAGRID_GROUP_PANEL_LABEL_CLASS","DATAGRID_EXPAND_CLASS","DATAGRID_GROUP_ROW_CLASS","HEADER_FILTER_CLASS_SELECTOR","GroupingDataSourceAdapterExtender","init","callBase","apply","arguments","_initGroupingHelper","options","grouping","_grouping","isAutoExpandAll","option","isFocusedRowEnabled","remoteOperations","isODataRemoteOperations","filtering","sorting","paging","GroupingHelper","totalItemsCount","that","totalCount","_dataSource","group","requireTotalCount","totalCountCorrection","itemsCount","allowCollapseAll","isGroupItemCountable","item","isRowExpanded","key","groupInfo","findGroupInfo","isExpanded","collapseAll","groupIndex","_collapseExpandAll","expandAll","isExpand","dataSource","groups","default","normalizeSortingInfo","i","length","foreachGroups","parents","resetPagesCache","refresh","changeRowExpand","path","beginLoading","_lastLoadOptions","groupExpand","_changeRowExpandCore","always","endLoading","_hasGroupLevelsExpandState","Array","isArray","_customizeRemoteOperations","isReload","operationTypes","storeLoadOptions","isCustomLoading","groupPaging","resetCache","_handleDataLoading","handleDataLoading","_handleDataLoaded","handleDataLoaded","bind","_handleDataLoadedCore","handleDataLoadedCore","extend","GroupingDataControllerExtender","createAction","_beforeProcessItems","items","groupColumns","_columnsController","getGroupColumns","_processGroupItems","_processItem","isDefined","isString","rowType","indexOf","_processGroupItem","dataIndex","groupsCount","groupedColumns","column","scrollingMode","resultItems","collectContinuationItems","values","data","isContinuation","push","slice","deserializeValue","calculateDisplayValue","pop","publicMethods","concat","pageIndex","reload","expanded","args","executeAction","cancel","when","done","Deferred","resolve","d","load","fail","reject","expandRow","collapseRow","optionChanged","name","onGroupingMenuItemClick","params","columnsController","itemData","value","columnOption","dataField","component","clearGrouping","GroupingHeaderPanelExtender","_getToolbarItems","_appendGroupingItem","isRendered","groupPanelRenderedCallback","e","$groupPanel","itemElement","find","_updateGroupPanelContent","registerKeyboardAction","_handleActionKeyDown","renderCompleted","fire","_isGroupPanelVisible","toolbarItem","html","onItemRendered","location","locateInMenu","sortIndex","event","$target","target","groupColumnIndex","closest","index","columnIndex","is","getController","showHeaderFilterMenu","_processGroupItemAction","preventDefault","groupPanelOptions","isVisible","visible","current","deviceType","_renderGroupPanelItems","empty","each","groupColumn","_createGroupPanelItem","restoreFocus","$rootElement","$groupPanelItem","addClass","cssClass","appendTo","text","caption","setTabIndex","_columnOptionChanged","_requireReady","checkChanges","optionNames","$toolbarElement","element","allowColumnDragging","emptyPanelText","css","updateToolbarDimensions","allowDragging","allowGrouping","getColumnElements","$element","getColumns","getBoundingRect","offset","top","bottom","height","getName","getContextMenuItems","contextMenuEnabled","$groupedColumnElement","targetElement","isGroupingAllowed","isColumnGrouped","groupingTexts","onItemClick","ungroup","disabled","ungroupAll","_invalidate","handled","exports","GroupingRowsViewExtender","row","_rowClick","expandMode","isGroupRowStateChanged","isExpandButtonClicked","_changeGroupRowState","dataController","rowIndex","allowCollapsing","columnHeadersViewExtender","command","groupByThisColumn","beginGroup","showWhenGrouped","registerModule","defaultOptions","autoExpandAll","texts","groupContinuesMessage","format","groupContinuedMessage","groupPanel","extenders","controllers","columns","_getExpandColumnOptions","cellTemplate","getExpandCellTemplate","views","headerPanel","rowsView","columnHeadersView"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/data_grid/ui.data_grid.grouping.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar _renderer = require(\"../../core/renderer\");\r\nvar _renderer2 = _interopRequireDefault(_renderer);\r\nvar _uiData_grid = require(\"./ui.data_grid.core\");\r\nvar _uiData_grid2 = _interopRequireDefault(_uiData_grid);\r\nvar _uiData_gridGrouping = require(\"./ui.data_grid.grouping.expanded\");\r\nvar _uiData_gridGrouping2 = require(\"./ui.data_grid.grouping.collapsed\");\r\nvar _message = require(\"../../localization/message\");\r\nvar _message2 = _interopRequireDefault(_message);\r\nvar _uiData_grid3 = require(\"./ui.data_grid.data_source_adapter\");\r\nvar _uiData_grid4 = _interopRequireDefault(_uiData_grid3);\r\nvar _type = require(\"../../core/utils/type\");\r\nvar _iterator = require(\"../../core/utils/iterator\");\r\nvar _devices = require(\"../../core/devices\");\r\nvar _devices2 = _interopRequireDefault(_devices);\r\nvar _deferred = require(\"../../core/utils/deferred\");\r\nvar _uiGrid_core = require(\"../grid_core/ui.grid_core.accessibility\");\r\nvar _accessibility = require(\"../shared/accessibility\");\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\nvar DATAGRID_GROUP_PANEL_CLASS = \"dx-datagrid-group-panel\";\r\nvar DATAGRID_GROUP_PANEL_MESSAGE_CLASS = \"dx-group-panel-message\";\r\nvar DATAGRID_GROUP_PANEL_ITEM_CLASS = \"dx-group-panel-item\";\r\nvar DATAGRID_GROUP_PANEL_LABEL_CLASS = \"dx-toolbar-label\";\r\nvar DATAGRID_EXPAND_CLASS = \"dx-datagrid-expand\";\r\nvar DATAGRID_GROUP_ROW_CLASS = \"dx-group-row\";\r\nvar HEADER_FILTER_CLASS_SELECTOR = \".dx-header-filter\";\r\nvar GroupingDataSourceAdapterExtender = function() {\r\n    return {\r\n        init: function() {\r\n            this.callBase.apply(this, arguments);\r\n            this._initGroupingHelper()\r\n        },\r\n        _initGroupingHelper: function(options) {\r\n            var grouping = this._grouping;\r\n            var isAutoExpandAll = this.option(\"grouping.autoExpandAll\");\r\n            var isFocusedRowEnabled = this.option(\"focusedRowEnabled\");\r\n            var remoteOperations = options ? options.remoteOperations : this.remoteOperations();\r\n            var isODataRemoteOperations = remoteOperations.filtering && remoteOperations.sorting && remoteOperations.paging;\r\n            if (isODataRemoteOperations && !remoteOperations.grouping && (isAutoExpandAll || !isFocusedRowEnabled)) {\r\n                if (!grouping || grouping instanceof _uiData_gridGrouping2.GroupingHelper) {\r\n                    this._grouping = new _uiData_gridGrouping.GroupingHelper(this)\r\n                }\r\n            } else {\r\n                if (!grouping || grouping instanceof _uiData_gridGrouping.GroupingHelper) {\r\n                    this._grouping = new _uiData_gridGrouping2.GroupingHelper(this)\r\n                }\r\n            }\r\n        },\r\n        totalItemsCount: function() {\r\n            var that = this;\r\n            var totalCount = that.callBase();\r\n            return totalCount > 0 && that._dataSource.group() && that._dataSource.requireTotalCount() ? totalCount + that._grouping.totalCountCorrection() : totalCount\r\n        },\r\n        itemsCount: function() {\r\n            return this._dataSource.group() ? this._grouping.itemsCount() || 0 : this.callBase.apply(this, arguments)\r\n        },\r\n        allowCollapseAll: function() {\r\n            return this._grouping.allowCollapseAll()\r\n        },\r\n        isGroupItemCountable: function(item) {\r\n            return this._grouping.isGroupItemCountable(item)\r\n        },\r\n        isRowExpanded: function(key) {\r\n            var groupInfo = this._grouping.findGroupInfo(key);\r\n            return groupInfo ? groupInfo.isExpanded : !this._grouping.allowCollapseAll()\r\n        },\r\n        collapseAll: function(groupIndex) {\r\n            return this._collapseExpandAll(groupIndex, false)\r\n        },\r\n        expandAll: function(groupIndex) {\r\n            return this._collapseExpandAll(groupIndex, true)\r\n        },\r\n        _collapseExpandAll: function(groupIndex, isExpand) {\r\n            var that = this;\r\n            var dataSource = that._dataSource;\r\n            var group = dataSource.group();\r\n            var groups = _uiData_grid2.default.normalizeSortingInfo(group || []);\r\n            var i;\r\n            if (groups.length) {\r\n                for (i = 0; i < groups.length; i++) {\r\n                    if (void 0 === groupIndex || groupIndex === i) {\r\n                        groups[i].isExpanded = isExpand\r\n                    } else {\r\n                        if (group && group[i]) {\r\n                            groups[i].isExpanded = group[i].isExpanded\r\n                        }\r\n                    }\r\n                }\r\n                dataSource.group(groups);\r\n                that._grouping.foreachGroups(function(groupInfo, parents) {\r\n                    if (void 0 === groupIndex || groupIndex === parents.length - 1) {\r\n                        groupInfo.isExpanded = isExpand\r\n                    }\r\n                }, false, true);\r\n                that.resetPagesCache()\r\n            }\r\n            return true\r\n        },\r\n        refresh: function() {\r\n            this.callBase.apply(this, arguments);\r\n            return this._grouping.refresh.apply(this._grouping, arguments)\r\n        },\r\n        changeRowExpand: function(path) {\r\n            var that = this;\r\n            var dataSource = that._dataSource;\r\n            if (dataSource.group()) {\r\n                dataSource.beginLoading();\r\n                if (that._lastLoadOptions) {\r\n                    that._lastLoadOptions.groupExpand = true\r\n                }\r\n                return that._changeRowExpandCore(path).always(function() {\r\n                    dataSource.endLoading()\r\n                })\r\n            }\r\n        },\r\n        _changeRowExpandCore: function(path) {\r\n            return this._grouping.changeRowExpand(path)\r\n        },\r\n        _hasGroupLevelsExpandState: function(group, isExpanded) {\r\n            if (group && Array.isArray(group)) {\r\n                for (var i = 0; i < group.length; i++) {\r\n                    if (group[i].isExpanded === isExpanded) {\r\n                        return true\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        _customizeRemoteOperations: function(options, isReload, operationTypes) {\r\n            var remoteOperations = options.remoteOperations;\r\n            if (options.storeLoadOptions.group) {\r\n                if (remoteOperations.grouping && !options.isCustomLoading) {\r\n                    if (!remoteOperations.groupPaging || this._hasGroupLevelsExpandState(options.storeLoadOptions.group, true)) {\r\n                        remoteOperations.paging = false\r\n                    }\r\n                }\r\n                if (!remoteOperations.grouping && (!remoteOperations.sorting || !remoteOperations.filtering || options.isCustomLoading || this._hasGroupLevelsExpandState(options.storeLoadOptions.group, false))) {\r\n                    remoteOperations.paging = false\r\n                }\r\n            } else {\r\n                if (!options.isCustomLoading && remoteOperations.paging && operationTypes.grouping) {\r\n                    this.resetCache()\r\n                }\r\n            }\r\n            this.callBase.apply(this, arguments)\r\n        },\r\n        _handleDataLoading: function(options) {\r\n            this.callBase(options);\r\n            this._initGroupingHelper(options);\r\n            return this._grouping.handleDataLoading(options)\r\n        },\r\n        _handleDataLoaded: function(options) {\r\n            return this._grouping.handleDataLoaded(options, this.callBase.bind(this))\r\n        },\r\n        _handleDataLoadedCore: function(options) {\r\n            return this._grouping.handleDataLoadedCore(options, this.callBase.bind(this))\r\n        }\r\n    }\r\n}();\r\n_uiData_grid4.default.extend(GroupingDataSourceAdapterExtender);\r\nvar GroupingDataControllerExtender = function() {\r\n    return {\r\n        init: function() {\r\n            var that = this;\r\n            that.callBase();\r\n            that.createAction(\"onRowExpanding\");\r\n            that.createAction(\"onRowExpanded\");\r\n            that.createAction(\"onRowCollapsing\");\r\n            that.createAction(\"onRowCollapsed\")\r\n        },\r\n        _beforeProcessItems: function(items) {\r\n            var groupColumns = this._columnsController.getGroupColumns();\r\n            items = this.callBase(items);\r\n            if (items.length && groupColumns.length) {\r\n                items = this._processGroupItems(items, groupColumns.length)\r\n            }\r\n            return items\r\n        },\r\n        _processItem: function(item, options) {\r\n            if ((0, _type.isDefined)(item.groupIndex) && (0, _type.isString)(item.rowType) && 0 === item.rowType.indexOf(\"group\")) {\r\n                item = this._processGroupItem(item, options);\r\n                options.dataIndex = 0\r\n            } else {\r\n                item = this.callBase.apply(this, arguments)\r\n            }\r\n            return item\r\n        },\r\n        _processGroupItem: function(item) {\r\n            return item\r\n        },\r\n        _processGroupItems: function(items, groupsCount, options) {\r\n            var that = this;\r\n            var groupedColumns = that._columnsController.getGroupColumns();\r\n            var column = groupedColumns[groupedColumns.length - groupsCount];\r\n            var scrollingMode;\r\n            var i;\r\n            var item;\r\n            var resultItems;\r\n            if (!options) {\r\n                scrollingMode = that.option(\"scrolling.mode\");\r\n                options = {\r\n                    collectContinuationItems: \"virtual\" !== scrollingMode && \"infinite\" !== scrollingMode,\r\n                    resultItems: [],\r\n                    path: [],\r\n                    values: []\r\n                }\r\n            }\r\n            resultItems = options.resultItems;\r\n            if (options.data) {\r\n                if (options.collectContinuationItems || !options.data.isContinuation) {\r\n                    resultItems.push({\r\n                        rowType: \"group\",\r\n                        data: options.data,\r\n                        groupIndex: options.path.length - 1,\r\n                        isExpanded: !!options.data.items,\r\n                        key: options.path.slice(0),\r\n                        values: options.values.slice(0)\r\n                    })\r\n                }\r\n            }\r\n            if (items) {\r\n                if (0 === groupsCount) {\r\n                    resultItems.push.apply(resultItems, items)\r\n                } else {\r\n                    for (i = 0; i < items.length; i++) {\r\n                        item = items[i];\r\n                        if (item && \"items\" in item) {\r\n                            options.data = item;\r\n                            options.path.push(item.key);\r\n                            options.values.push(column && column.deserializeValue && !column.calculateDisplayValue ? column.deserializeValue(item.key) : item.key);\r\n                            that._processGroupItems(item.items, groupsCount - 1, options);\r\n                            options.data = void 0;\r\n                            options.path.pop();\r\n                            options.values.pop()\r\n                        } else {\r\n                            resultItems.push(item)\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            return resultItems\r\n        },\r\n        publicMethods: function() {\r\n            return this.callBase().concat([\"collapseAll\", \"expandAll\", \"isRowExpanded\", \"expandRow\", \"collapseRow\"])\r\n        },\r\n        collapseAll: function(groupIndex) {\r\n            var dataSource = this._dataSource;\r\n            if (dataSource && dataSource.collapseAll(groupIndex)) {\r\n                dataSource.pageIndex(0);\r\n                dataSource.reload()\r\n            }\r\n        },\r\n        expandAll: function(groupIndex) {\r\n            var dataSource = this._dataSource;\r\n            if (dataSource && dataSource.expandAll(groupIndex)) {\r\n                dataSource.pageIndex(0);\r\n                dataSource.reload()\r\n            }\r\n        },\r\n        changeRowExpand: function(key) {\r\n            var that = this;\r\n            var expanded = that.isRowExpanded(key);\r\n            var args = {\r\n                key: key,\r\n                expanded: expanded\r\n            };\r\n            that.executeAction(expanded ? \"onRowCollapsing\" : \"onRowExpanding\", args);\r\n            if (!args.cancel) {\r\n                return (0, _deferred.when)(that._changeRowExpandCore(key)).done(function() {\r\n                    args.expanded = !expanded;\r\n                    that.executeAction(expanded ? \"onRowCollapsed\" : \"onRowExpanded\", args)\r\n                })\r\n            }\r\n            return (new _deferred.Deferred).resolve()\r\n        },\r\n        _changeRowExpandCore: function(key) {\r\n            var that = this;\r\n            var dataSource = this._dataSource;\r\n            var d;\r\n            if (!dataSource) {\r\n                return\r\n            }\r\n            d = new _deferred.Deferred;\r\n            (0, _deferred.when)(dataSource.changeRowExpand(key)).done(function() {\r\n                that.load().done(d.resolve).fail(d.reject)\r\n            }).fail(d.reject);\r\n            return d\r\n        },\r\n        isRowExpanded: function(key) {\r\n            var dataSource = this._dataSource;\r\n            return dataSource && dataSource.isRowExpanded(key)\r\n        },\r\n        expandRow: function(key) {\r\n            if (!this.isRowExpanded(key)) {\r\n                return this.changeRowExpand(key)\r\n            }\r\n            return (new _deferred.Deferred).resolve()\r\n        },\r\n        collapseRow: function(key) {\r\n            if (this.isRowExpanded(key)) {\r\n                return this.changeRowExpand(key)\r\n            }\r\n            return (new _deferred.Deferred).resolve()\r\n        },\r\n        optionChanged: function(args) {\r\n            if (\"grouping\" === args.name) {\r\n                args.name = \"dataSource\"\r\n            }\r\n            this.callBase(args)\r\n        }\r\n    }\r\n}();\r\nvar onGroupingMenuItemClick = function(column, params) {\r\n    var columnsController = this._columnsController;\r\n    switch (params.itemData.value) {\r\n        case \"group\":\r\n            var groups = columnsController._dataSource.group() || [];\r\n            columnsController.columnOption(column.dataField, \"groupIndex\", groups.length);\r\n            break;\r\n        case \"ungroup\":\r\n            columnsController.columnOption(column.dataField, \"groupIndex\", -1);\r\n            break;\r\n        case \"ungroupAll\":\r\n            this.component.clearGrouping()\r\n    }\r\n};\r\nvar GroupingHeaderPanelExtender = function() {\r\n    return {\r\n        _getToolbarItems: function() {\r\n            var items = this.callBase();\r\n            return this._appendGroupingItem(items)\r\n        },\r\n        _appendGroupingItem: function(items) {\r\n            var that = this;\r\n            var isRendered = false;\r\n            var groupPanelRenderedCallback = function(e) {\r\n                var $groupPanel = (0, _renderer2.default)(e.itemElement).find(\".\" + DATAGRID_GROUP_PANEL_CLASS);\r\n                that._updateGroupPanelContent($groupPanel);\r\n                (0, _uiGrid_core.registerKeyboardAction)(\"groupPanel\", that, $groupPanel, void 0, that._handleActionKeyDown.bind(that));\r\n                isRendered && that.renderCompleted.fire();\r\n                isRendered = true\r\n            };\r\n            if (that._isGroupPanelVisible()) {\r\n                var toolbarItem = {\r\n                    html: \"<div class='\" + DATAGRID_GROUP_PANEL_CLASS + \"'></div>\",\r\n                    name: \"groupPanel\",\r\n                    onItemRendered: groupPanelRenderedCallback,\r\n                    location: \"before\",\r\n                    locateInMenu: \"never\",\r\n                    sortIndex: 1\r\n                };\r\n                items.push(toolbarItem)\r\n            }\r\n            return items\r\n        },\r\n        _handleActionKeyDown: function(args) {\r\n            var event = args.event;\r\n            var $target = (0, _renderer2.default)(event.target);\r\n            var groupColumnIndex = $target.closest(\".\".concat(DATAGRID_GROUP_PANEL_ITEM_CLASS)).index();\r\n            var column = this._columnsController.getGroupColumns()[groupColumnIndex];\r\n            var columnIndex = column && column.index;\r\n            if ($target.is(HEADER_FILTER_CLASS_SELECTOR)) {\r\n                this.getController(\"headerFilter\").showHeaderFilterMenu(columnIndex, true)\r\n            } else {\r\n                this._processGroupItemAction(columnIndex)\r\n            }\r\n            event.preventDefault()\r\n        },\r\n        _isGroupPanelVisible: function() {\r\n            var groupPanelOptions = this.option(\"groupPanel\");\r\n            var isVisible;\r\n            if (groupPanelOptions) {\r\n                isVisible = groupPanelOptions.visible;\r\n                if (\"auto\" === isVisible) {\r\n                    isVisible = \"desktop\" === _devices2.default.current().deviceType ? true : false\r\n                }\r\n            }\r\n            return isVisible\r\n        },\r\n        _renderGroupPanelItems: function($groupPanel, groupColumns) {\r\n            var that = this;\r\n            $groupPanel.empty();\r\n            (0, _iterator.each)(groupColumns, function(index, groupColumn) {\r\n                that._createGroupPanelItem($groupPanel, groupColumn)\r\n            });\r\n            (0, _accessibility.restoreFocus)(this)\r\n        },\r\n        _createGroupPanelItem: function($rootElement, groupColumn) {\r\n            var $groupPanelItem = (0, _renderer2.default)(\"<div>\").addClass(groupColumn.cssClass).addClass(DATAGRID_GROUP_PANEL_ITEM_CLASS).data(\"columnData\", groupColumn).appendTo($rootElement).text(groupColumn.caption);\r\n            (0, _accessibility.setTabIndex)(this, $groupPanelItem);\r\n            return $groupPanelItem\r\n        },\r\n        _columnOptionChanged: function(e) {\r\n            if (!this._requireReady && !_uiData_grid2.default.checkChanges(e.optionNames, [\"width\", \"visibleWidth\"])) {\r\n                var $toolbarElement = this.element();\r\n                var $groupPanel = $toolbarElement && $toolbarElement.find(\".\" + DATAGRID_GROUP_PANEL_CLASS);\r\n                if ($groupPanel && $groupPanel.length) {\r\n                    this._updateGroupPanelContent($groupPanel);\r\n                    this.renderCompleted.fire()\r\n                }\r\n            }\r\n            this.callBase()\r\n        },\r\n        _updateGroupPanelContent: function($groupPanel) {\r\n            var that = this;\r\n            var groupColumns = that.getController(\"columns\").getGroupColumns();\r\n            var groupPanelOptions = that.option(\"groupPanel\");\r\n            that._renderGroupPanelItems($groupPanel, groupColumns);\r\n            if (groupPanelOptions.allowColumnDragging && !groupColumns.length) {\r\n                (0, _renderer2.default)(\"<div>\").addClass(DATAGRID_GROUP_PANEL_MESSAGE_CLASS).text(groupPanelOptions.emptyPanelText).appendTo($groupPanel);\r\n                $groupPanel.closest(\".\" + DATAGRID_GROUP_PANEL_LABEL_CLASS).css(\"maxWidth\", \"none\");\r\n                that.updateToolbarDimensions()\r\n            }\r\n        },\r\n        allowDragging: function(column) {\r\n            var groupPanelOptions = this.option(\"groupPanel\");\r\n            return this._isGroupPanelVisible() && groupPanelOptions.allowColumnDragging && column && column.allowGrouping\r\n        },\r\n        getColumnElements: function() {\r\n            var $element = this.element();\r\n            return $element && $element.find(\".\" + DATAGRID_GROUP_PANEL_ITEM_CLASS)\r\n        },\r\n        getColumns: function() {\r\n            return this.getController(\"columns\").getGroupColumns()\r\n        },\r\n        getBoundingRect: function() {\r\n            var that = this;\r\n            var $element = that.element();\r\n            var offset;\r\n            if ($element && $element.find(\".\" + DATAGRID_GROUP_PANEL_CLASS).length) {\r\n                offset = $element.offset();\r\n                return {\r\n                    top: offset.top,\r\n                    bottom: offset.top + $element.height()\r\n                }\r\n            }\r\n            return null\r\n        },\r\n        getName: function() {\r\n            return \"group\"\r\n        },\r\n        getContextMenuItems: function(options) {\r\n            var that = this;\r\n            var contextMenuEnabled = that.option(\"grouping.contextMenuEnabled\");\r\n            var $groupedColumnElement = (0, _renderer2.default)(options.targetElement).closest(\".\" + DATAGRID_GROUP_PANEL_ITEM_CLASS);\r\n            var items;\r\n            if ($groupedColumnElement.length) {\r\n                options.column = $groupedColumnElement.data(\"columnData\")\r\n            }\r\n            if (contextMenuEnabled && options.column) {\r\n                var column = options.column;\r\n                var isGroupingAllowed = (0, _type.isDefined)(column.allowGrouping) ? column.allowGrouping : true;\r\n                if (isGroupingAllowed) {\r\n                    var isColumnGrouped = (0, _type.isDefined)(column.groupIndex) && column.groupIndex > -1;\r\n                    var groupingTexts = that.option(\"grouping.texts\");\r\n                    var onItemClick = onGroupingMenuItemClick.bind(that, column);\r\n                    items = [{\r\n                        text: groupingTexts.ungroup,\r\n                        value: \"ungroup\",\r\n                        disabled: !isColumnGrouped,\r\n                        onItemClick: onItemClick\r\n                    }, {\r\n                        text: groupingTexts.ungroupAll,\r\n                        value: \"ungroupAll\",\r\n                        onItemClick: onItemClick\r\n                    }]\r\n                }\r\n            }\r\n            return items\r\n        },\r\n        isVisible: function() {\r\n            return this.callBase() || this._isGroupPanelVisible()\r\n        },\r\n        optionChanged: function(args) {\r\n            if (\"groupPanel\" === args.name) {\r\n                this._invalidate();\r\n                args.handled = true\r\n            } else {\r\n                this.callBase(args)\r\n            }\r\n        }\r\n    }\r\n}();\r\nexports.GroupingHeaderPanelExtender = GroupingHeaderPanelExtender;\r\nvar GroupingRowsViewExtender = function() {\r\n    return {\r\n        getContextMenuItems: function(options) {\r\n            var that = this;\r\n            var contextMenuEnabled = that.option(\"grouping.contextMenuEnabled\");\r\n            var items;\r\n            if (contextMenuEnabled && options.row && \"group\" === options.row.rowType) {\r\n                var columnsController = that._columnsController;\r\n                var column = columnsController.columnOption(\"groupIndex:\" + options.row.groupIndex);\r\n                if (column && column.allowGrouping) {\r\n                    var groupingTexts = that.option(\"grouping.texts\");\r\n                    var onItemClick = onGroupingMenuItemClick.bind(that, column);\r\n                    items = [];\r\n                    items.push({\r\n                        text: groupingTexts.ungroup,\r\n                        value: \"ungroup\",\r\n                        onItemClick: onItemClick\r\n                    }, {\r\n                        text: groupingTexts.ungroupAll,\r\n                        value: \"ungroupAll\",\r\n                        onItemClick: onItemClick\r\n                    })\r\n                }\r\n            }\r\n            return items\r\n        },\r\n        _rowClick: function(e) {\r\n            var that = this;\r\n            var expandMode = that.option(\"grouping.expandMode\");\r\n            var scrollingMode = that.option(\"scrolling.mode\");\r\n            var isGroupRowStateChanged = \"infinite\" !== scrollingMode && \"rowClick\" === expandMode && (0, _renderer2.default)(e.event.target).closest(\".\" + DATAGRID_GROUP_ROW_CLASS).length;\r\n            var isExpandButtonClicked = (0, _renderer2.default)(e.event.target).closest(\".\" + DATAGRID_EXPAND_CLASS).length;\r\n            if (isGroupRowStateChanged || isExpandButtonClicked) {\r\n                that._changeGroupRowState(e)\r\n            }\r\n            that.callBase(e)\r\n        },\r\n        _changeGroupRowState: function(e) {\r\n            var dataController = this.getController(\"data\");\r\n            var row = dataController.items()[e.rowIndex];\r\n            var allowCollapsing = this._columnsController.columnOption(\"groupIndex:\" + row.groupIndex, \"allowCollapsing\");\r\n            if (\"data\" === row.rowType || \"group\" === row.rowType && false !== allowCollapsing) {\r\n                dataController.changeRowExpand(row.key);\r\n                e.event.preventDefault();\r\n                e.handled = true\r\n            }\r\n        }\r\n    }\r\n}();\r\nvar columnHeadersViewExtender = function() {\r\n    return {\r\n        getContextMenuItems: function(options) {\r\n            var that = this;\r\n            var contextMenuEnabled = that.option(\"grouping.contextMenuEnabled\");\r\n            var items = that.callBase(options);\r\n            if (contextMenuEnabled && options.row && (\"header\" === options.row.rowType || \"detailAdaptive\" === options.row.rowType)) {\r\n                var column = options.column;\r\n                if (!column.command && (!(0, _type.isDefined)(column.allowGrouping) || column.allowGrouping)) {\r\n                    var groupingTexts = that.option(\"grouping.texts\");\r\n                    var isColumnGrouped = (0, _type.isDefined)(column.groupIndex) && column.groupIndex > -1;\r\n                    var onItemClick = onGroupingMenuItemClick.bind(that, column);\r\n                    items = items || [];\r\n                    items.push({\r\n                        text: groupingTexts.groupByThisColumn,\r\n                        value: \"group\",\r\n                        beginGroup: true,\r\n                        disabled: isColumnGrouped,\r\n                        onItemClick: onItemClick\r\n                    });\r\n                    if (column.showWhenGrouped) {\r\n                        items.push({\r\n                            text: groupingTexts.ungroup,\r\n                            value: \"ungroup\",\r\n                            disabled: !isColumnGrouped,\r\n                            onItemClick: onItemClick\r\n                        })\r\n                    }\r\n                    items.push({\r\n                        text: groupingTexts.ungroupAll,\r\n                        value: \"ungroupAll\",\r\n                        onItemClick: onItemClick\r\n                    })\r\n                }\r\n            }\r\n            return items\r\n        }\r\n    }\r\n}();\r\n_uiData_grid2.default.registerModule(\"grouping\", {\r\n    defaultOptions: function() {\r\n        return {\r\n            grouping: {\r\n                autoExpandAll: true,\r\n                allowCollapsing: true,\r\n                contextMenuEnabled: false,\r\n                expandMode: \"buttonClick\",\r\n                texts: {\r\n                    groupContinuesMessage: _message2.default.format(\"dxDataGrid-groupContinuesMessage\"),\r\n                    groupContinuedMessage: _message2.default.format(\"dxDataGrid-groupContinuedMessage\"),\r\n                    groupByThisColumn: _message2.default.format(\"dxDataGrid-groupHeaderText\"),\r\n                    ungroup: _message2.default.format(\"dxDataGrid-ungroupHeaderText\"),\r\n                    ungroupAll: _message2.default.format(\"dxDataGrid-ungroupAllText\")\r\n                }\r\n            },\r\n            groupPanel: {\r\n                visible: false,\r\n                emptyPanelText: _message2.default.format(\"dxDataGrid-groupPanelEmptyText\"),\r\n                allowColumnDragging: true\r\n            }\r\n        }\r\n    },\r\n    extenders: {\r\n        controllers: {\r\n            data: GroupingDataControllerExtender,\r\n            columns: {\r\n                _getExpandColumnOptions: function() {\r\n                    var options = this.callBase.apply(this, arguments);\r\n                    options.cellTemplate = _uiData_grid2.default.getExpandCellTemplate();\r\n                    return options\r\n                }\r\n            }\r\n        },\r\n        views: {\r\n            headerPanel: GroupingHeaderPanelExtender,\r\n            rowsView: GroupingRowsViewExtender,\r\n            columnHeadersView: columnHeadersViewExtender\r\n        }\r\n    }\r\n});\r\n"]},"metadata":{},"sourceType":"script"}