{"ast":null,"code":"/**\r\n * DevExtreme (viz/range_selector/sliders_controller.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar noop = require(\"../../core/utils/common\").noop;\n\nvar commonModule = require(\"./common\");\n\nvar animationSettings = commonModule.utils.animationSettings;\nvar emptySliderMarkerText = commonModule.consts.emptySliderMarkerText;\n\nvar Slider = require(\"./slider\");\n\nvar _normalizeEnum = require(\"../core/utils\").normalizeEnum;\n\nvar typeUtils = require(\"../../core/utils/type\");\n\nvar isNumeric = typeUtils.isNumeric;\n\nvar vizUtils = require(\"../core/utils\");\n\nvar adjust = require(\"../../core/utils/math\").adjust;\n\nfunction buildRectPoints(left, top, right, bottom) {\n  return [left, top, right, top, right, bottom, left, bottom];\n}\n\nfunction valueOf(value) {\n  return value && value.valueOf();\n}\n\nfunction isLess(a, b) {\n  return a < b;\n}\n\nfunction isGreater(a, b) {\n  return a > b;\n}\n\nfunction selectClosestValue(target, values) {\n  var start = 0;\n  var end = values ? values.length - 1 : 0;\n  var middle;\n  var val = target;\n\n  while (end - start > 1) {\n    middle = start + end >> 1;\n    val = values[middle];\n\n    if (val === target) {\n      return target;\n    } else {\n      if (target < val) {\n        end = middle;\n      } else {\n        start = middle;\n      }\n    }\n  }\n\n  if (values) {\n    val = values[target - values[start] <= values[end] - target ? start : end];\n  }\n\n  return val;\n}\n\nfunction dummyProcessSelectionChanged() {\n  this._lastSelectedRange = this.getSelectedRange();\n  delete this._processSelectionChanged;\n}\n\nfunction suppressSetSelectedRange(controller) {\n  controller.setSelectedRange = noop;\n\n  if (controller._processSelectionChanged === dummyProcessSelectionChanged) {\n    controller._processSelectionChanged();\n  }\n}\n\nfunction restoreSetSelectedRange(controller) {\n  delete controller.setSelectedRange;\n}\n\nfunction SlidersController(params) {\n  var that = this;\n  var sliderParams = {\n    renderer: params.renderer,\n    root: params.root,\n    trackersGroup: params.trackersGroup,\n    translator: params.translator\n  };\n  that._params = params;\n  that._areaTracker = params.renderer.path(null, \"area\").attr({\n    \"class\": \"area-tracker\",\n    fill: \"#000000\",\n    opacity: 1e-4\n  }).append(params.trackersGroup);\n  that._selectedAreaTracker = params.renderer.path(null, \"area\").attr({\n    \"class\": \"selected-area-tracker\",\n    fill: \"#000000\",\n    opacity: 1e-4\n  }).append(params.trackersGroup);\n  that._shutter = params.renderer.path(null, \"area\").append(params.root);\n  that._sliders = [new Slider(sliderParams, 0), new Slider(sliderParams, 1)];\n  that._processSelectionChanged = dummyProcessSelectionChanged;\n}\n\nSlidersController.prototype = {\n  constructor: SlidersController,\n  dispose: function dispose() {\n    this._sliders[0].dispose();\n\n    this._sliders[1].dispose();\n  },\n  getTrackerTargets: function getTrackerTargets() {\n    return {\n      area: this._areaTracker,\n      selectedArea: this._selectedAreaTracker,\n      sliders: this._sliders\n    };\n  },\n  _processSelectionChanged: function _processSelectionChanged(e) {\n    var that = this;\n    var selectedRange = that.getSelectedRange();\n\n    if (valueOf(selectedRange.startValue) !== valueOf(that._lastSelectedRange.startValue) || valueOf(selectedRange.endValue) !== valueOf(that._lastSelectedRange.endValue)) {\n      that._params.updateSelectedRange(selectedRange, that._lastSelectedRange, e);\n\n      that._lastSelectedRange = selectedRange;\n    }\n  },\n  update: function update(verticalRange, behavior, isCompactMode, sliderHandleOptions, sliderMarkerOptions, shutterOptions, rangeBounds, fullTicks, selectedRangeColor) {\n    var that = this;\n\n    var screenRange = that._params.translator.getScreenRange();\n\n    that._verticalRange = verticalRange;\n    that._minRange = rangeBounds.minRange;\n    that._maxRange = rangeBounds.maxRange;\n    that._animationEnabled = behavior.animationEnabled && that._params.renderer.animationEnabled();\n    that._allowSlidersSwap = behavior.allowSlidersSwap;\n\n    that._sliders[0].update(verticalRange, sliderHandleOptions, sliderMarkerOptions);\n\n    that._sliders[1].update(verticalRange, sliderHandleOptions, sliderMarkerOptions);\n\n    that._sliders[0]._position = that._sliders[1]._position = screenRange[0];\n    that._values = !that._params.translator.isValueProlonged && behavior.snapToTicks ? fullTicks : null;\n\n    that._areaTracker.attr({\n      points: buildRectPoints(screenRange[0], verticalRange[0], screenRange[1], verticalRange[1])\n    });\n\n    that._isCompactMode = isCompactMode;\n    that._shutterOffset = sliderHandleOptions.width / 2;\n\n    that._updateSelectedView(shutterOptions, selectedRangeColor);\n\n    that._isOnMoving = \"onmoving\" === _normalizeEnum(behavior.callValueChanged);\n\n    that._updateSelectedRange();\n\n    that._applyTotalPosition(false);\n  },\n  _updateSelectedView: function _updateSelectedView(shutterOptions, selectedRangeColor) {\n    var settings = {\n      fill: null,\n      \"fill-opacity\": null,\n      stroke: null,\n      \"stroke-width\": null\n    };\n\n    if (this._isCompactMode) {\n      settings.stroke = selectedRangeColor;\n      settings[\"stroke-width\"] = 3;\n      settings.sharp = \"v\";\n    } else {\n      settings.fill = shutterOptions.color;\n      settings[\"fill-opacity\"] = shutterOptions.opacity;\n    }\n\n    this._shutter.attr(settings);\n  },\n  _updateSelectedRange: function _updateSelectedRange() {\n    var that = this;\n    var sliders = that._sliders;\n    sliders[0].cancelAnimation();\n    sliders[1].cancelAnimation();\n\n    that._shutter.stopAnimation();\n\n    if (that._params.translator.getBusinessRange().isEmpty()) {\n      sliders[0]._setText(emptySliderMarkerText);\n\n      sliders[1]._setText(emptySliderMarkerText);\n\n      sliders[0]._value = sliders[1]._value = void 0;\n      sliders[0]._position = that._params.translator.getScreenRange()[0];\n      sliders[1]._position = that._params.translator.getScreenRange()[1];\n\n      that._applyTotalPosition(false);\n\n      suppressSetSelectedRange(that);\n    } else {\n      restoreSetSelectedRange(that);\n    }\n  },\n  _applyTotalPosition: function _applyTotalPosition(isAnimated) {\n    var sliders = this._sliders;\n    var areOverlapped;\n    isAnimated = this._animationEnabled && isAnimated;\n    sliders[0].applyPosition(isAnimated);\n    sliders[1].applyPosition(isAnimated);\n    areOverlapped = sliders[0].getCloudBorder() > sliders[1].getCloudBorder();\n    sliders[0].setOverlapped(areOverlapped);\n    sliders[1].setOverlapped(areOverlapped);\n\n    this._applyAreaTrackersPosition();\n\n    this._applySelectedRangePosition(isAnimated);\n  },\n  _applyAreaTrackersPosition: function _applyAreaTrackersPosition() {\n    var that = this;\n\n    var position1 = that._sliders[0].getPosition();\n\n    var position2 = that._sliders[1].getPosition();\n\n    that._selectedAreaTracker.attr({\n      points: buildRectPoints(position1, that._verticalRange[0], position2, that._verticalRange[1])\n    }).css({\n      cursor: Math.abs(that._params.translator.getScreenRange()[1] - that._params.translator.getScreenRange()[0] - position2 + position1) < .001 ? \"default\" : \"pointer\"\n    });\n  },\n  _applySelectedRangePosition: function _applySelectedRangePosition(isAnimated) {\n    var that = this;\n    var verticalRange = that._verticalRange;\n\n    var pos1 = that._sliders[0].getPosition();\n\n    var pos2 = that._sliders[1].getPosition();\n\n    var screenRange;\n    var points;\n\n    if (that._isCompactMode) {\n      points = [pos1 + Math.ceil(that._shutterOffset), (verticalRange[0] + verticalRange[1]) / 2, pos2 - Math.floor(that._shutterOffset), (verticalRange[0] + verticalRange[1]) / 2];\n    } else {\n      screenRange = that._params.axis.getVisibleArea();\n      points = [buildRectPoints(screenRange[0], verticalRange[0], Math.max(pos1 - Math.floor(that._shutterOffset), screenRange[0]), verticalRange[1]), buildRectPoints(screenRange[1], verticalRange[0], Math.min(pos2 + Math.ceil(that._shutterOffset), screenRange[1]), verticalRange[1])];\n    }\n\n    if (isAnimated) {\n      that._shutter.animate({\n        points: points\n      }, animationSettings);\n    } else {\n      that._shutter.attr({\n        points: points\n      });\n    }\n  },\n  getSelectedRange: function getSelectedRange() {\n    return {\n      startValue: this._sliders[0].getValue(),\n      endValue: this._sliders[1].getValue()\n    };\n  },\n  setSelectedRange: function setSelectedRange(visualRange, e) {\n    visualRange = visualRange || {};\n    var that = this;\n    var translator = that._params.translator;\n    var businessRange = translator.getBusinessRange();\n    var compare = \"discrete\" === businessRange.axisType ? function (a, b) {\n      return a < b;\n    } : function (a, b) {\n      return a <= b;\n    };\n\n    var _vizUtils$adjustVisua = vizUtils.adjustVisualRange({\n      dataType: businessRange.dataType,\n      axisType: businessRange.axisType,\n      base: businessRange.base\n    }, {\n      startValue: translator.isValid(visualRange.startValue) ? translator.getCorrectValue(visualRange.startValue, 1) : void 0,\n      endValue: translator.isValid(visualRange.endValue) ? translator.getCorrectValue(visualRange.endValue, -1) : void 0,\n      length: visualRange.length\n    }, {\n      min: businessRange.minVisible,\n      max: businessRange.maxVisible,\n      categories: businessRange.categories\n    }),\n        startValue = _vizUtils$adjustVisua.startValue,\n        endValue = _vizUtils$adjustVisua.endValue;\n\n    startValue = isNumeric(startValue) ? adjust(startValue) : startValue;\n    endValue = isNumeric(endValue) ? adjust(endValue) : endValue;\n    var values = compare(translator.to(startValue, -1), translator.to(endValue, 1)) ? [startValue, endValue] : [endValue, startValue];\n\n    that._sliders[0].setDisplayValue(values[0]);\n\n    that._sliders[1].setDisplayValue(values[1]);\n\n    that._sliders[0]._position = translator.to(values[0], -1);\n    that._sliders[1]._position = translator.to(values[1], 1);\n\n    that._applyTotalPosition(true);\n\n    that._processSelectionChanged(e);\n  },\n  beginSelectedAreaMoving: function beginSelectedAreaMoving(initialPosition) {\n    var that = this;\n    var sliders = that._sliders;\n    var offset = (sliders[0].getPosition() + sliders[1].getPosition()) / 2 - initialPosition;\n    var currentPosition = initialPosition;\n\n    move.complete = function (e) {\n      that._dockSelectedArea(e);\n    };\n\n    return move;\n\n    function move(position, e) {\n      if (position !== currentPosition && position > currentPosition === position > (sliders[0].getPosition() + sliders[1].getPosition()) / 2 - offset) {\n        that._moveSelectedArea(position + offset, false, e);\n      }\n\n      currentPosition = position;\n    }\n  },\n  _dockSelectedArea: function _dockSelectedArea(e) {\n    var translator = this._params.translator;\n    var sliders = this._sliders;\n    sliders[0]._position = translator.to(sliders[0].getValue(), -1);\n    sliders[1]._position = translator.to(sliders[1].getValue(), 1);\n\n    this._applyTotalPosition(true);\n\n    this._processSelectionChanged(e);\n  },\n  moveSelectedArea: function moveSelectedArea(screenPosition, e) {\n    this._moveSelectedArea(screenPosition, true, e);\n\n    this._dockSelectedArea(e);\n  },\n  _moveSelectedArea: function _moveSelectedArea(screenPosition, isAnimated, e) {\n    var that = this;\n    var translator = that._params.translator;\n    var sliders = that._sliders;\n    var interval = sliders[1].getPosition() - sliders[0].getPosition();\n    var startPosition = screenPosition - interval / 2;\n    var endPosition = screenPosition + interval / 2;\n    var startValue;\n\n    if (startPosition < translator.getScreenRange()[0]) {\n      startPosition = translator.getScreenRange()[0];\n      endPosition = startPosition + interval;\n    }\n\n    if (endPosition > translator.getScreenRange()[1]) {\n      endPosition = translator.getScreenRange()[1];\n      startPosition = endPosition - interval;\n    }\n\n    startValue = selectClosestValue(translator.from(startPosition, -1), that._values);\n    sliders[0].setDisplayValue(startValue);\n    sliders[1].setDisplayValue(selectClosestValue(translator.from(translator.to(startValue, -1) + interval, 1), that._values));\n    sliders[0]._position = startPosition;\n    sliders[1]._position = endPosition;\n\n    that._applyTotalPosition(isAnimated);\n\n    if (that._isOnMoving) {\n      that._processSelectionChanged(e);\n    }\n  },\n  placeSliderAndBeginMoving: function placeSliderAndBeginMoving(firstPosition, secondPosition, e) {\n    var that = this;\n    var translator = that._params.translator;\n    var sliders = that._sliders;\n    var index = firstPosition < secondPosition ? 0 : 1;\n    var dir = index > 0 ? 1 : -1;\n    var compare = index > 0 ? isGreater : isLess;\n    var antiCompare = index > 0 ? isLess : isGreater;\n    var thresholdPosition;\n    var positions = [];\n    var values = [];\n    var handler;\n    values[index] = translator.from(firstPosition, dir);\n    values[1 - index] = translator.from(secondPosition, -dir);\n    positions[1 - index] = secondPosition;\n\n    if (translator.isValueProlonged) {\n      if (compare(firstPosition, translator.to(values[index], dir))) {\n        values[index] = translator.from(firstPosition, -dir);\n      }\n\n      if (compare(secondPosition, translator.to(values[index], -dir))) {\n        values[1 - index] = values[index];\n      }\n    }\n\n    if (that._minRange) {\n      thresholdPosition = translator.to(translator.add(selectClosestValue(values[index], that._values), that._minRange, -dir), -dir);\n\n      if (compare(secondPosition, thresholdPosition)) {\n        values[1 - index] = translator.add(values[index], that._minRange, -dir);\n      }\n\n      thresholdPosition = translator.to(translator.add(translator.getRange()[1 - index], that._minRange, dir), -dir);\n\n      if (antiCompare(firstPosition, thresholdPosition)) {\n        values[1 - index] = translator.getRange()[1 - index];\n        values[index] = translator.add(values[1 - index], that._minRange, dir);\n        positions[1 - index] = firstPosition;\n      }\n    }\n\n    values[0] = selectClosestValue(values[0], that._values);\n    values[1] = selectClosestValue(values[1], that._values);\n    positions[index] = translator.to(values[index], dir);\n    sliders[0].setDisplayValue(values[0]);\n    sliders[1].setDisplayValue(values[1]);\n    sliders[0]._position = positions[0];\n    sliders[1]._position = positions[1];\n\n    that._applyTotalPosition(true);\n\n    if (that._isOnMoving) {\n      that._processSelectionChanged(e);\n    }\n\n    handler = that.beginSliderMoving(1 - index, secondPosition);\n\n    sliders[1 - index]._sliderGroup.stopAnimation();\n\n    that._shutter.stopAnimation();\n\n    handler(secondPosition);\n    return handler;\n  },\n  beginSliderMoving: function beginSliderMoving(initialIndex, initialPosition) {\n    var that = this;\n    var translator = that._params.translator;\n    var sliders = that._sliders;\n    var minPosition = translator.getScreenRange()[0];\n    var maxPosition = translator.getScreenRange()[1];\n    var index = initialIndex;\n    var staticPosition = sliders[1 - index].getPosition();\n    var currentPosition = initialPosition;\n    var dir = index > 0 ? 1 : -1;\n    var compareMin = index > 0 ? isLess : isGreater;\n    var compareMax = index > 0 ? isGreater : isLess;\n    var moveOffset = sliders[index].getPosition() - initialPosition;\n    var swapOffset = compareMin(sliders[index].getPosition(), initialPosition) ? -moveOffset : moveOffset;\n\n    move.complete = function (e) {\n      sliders[index]._setValid(true);\n\n      that._dockSelectedArea(e);\n    };\n\n    return move;\n\n    function move(position, e) {\n      var isValid;\n      var temp;\n      var pos;\n      var slider;\n      var value;\n\n      if (position !== currentPosition) {\n        if (compareMin(position + swapOffset, staticPosition)) {\n          isValid = that._allowSlidersSwap;\n\n          if (isValid && !translator.isValueProlonged && that._minRange) {\n            isValid = translator.isValid(translator.add(sliders[1 - index].getValue(), that._minRange, -dir));\n          }\n\n          if (isValid) {\n            that._changeMovingSlider(index);\n\n            index = 1 - index;\n            dir = -dir;\n            temp = compareMin;\n            compareMin = compareMax;\n            compareMax = temp;\n            moveOffset = -dir * Math.abs(moveOffset);\n            swapOffset = -moveOffset;\n          }\n        }\n\n        if (compareMax(position + moveOffset, staticPosition)) {\n          isValid = true;\n          slider = sliders[index];\n          value = sliders[1 - index].getValue();\n          pos = Math.max(Math.min(position + moveOffset, maxPosition), minPosition);\n\n          if (isValid && translator.isValueProlonged) {\n            isValid = !compareMin(pos, translator.to(value, dir));\n          }\n\n          if (isValid && that._minRange) {\n            isValid = !compareMin(pos, translator.to(translator.add(value, that._minRange, dir), dir));\n          }\n\n          if (isValid && that._maxRange) {\n            isValid = !compareMax(pos, translator.to(translator.add(value, that._maxRange, dir), dir));\n          }\n\n          slider._setValid(isValid);\n\n          slider.setDisplayValue(isValid ? selectClosestValue(translator.from(pos, dir), that._values) : slider.getValue());\n          slider._position = pos;\n\n          that._applyTotalPosition(false);\n\n          slider.toForeground();\n\n          if (that._isOnMoving) {\n            that._processSelectionChanged(e);\n          }\n        }\n      }\n\n      currentPosition = position;\n    }\n  },\n  _changeMovingSlider: function _changeMovingSlider(index) {\n    var that = this;\n    var translator = that._params.translator;\n    var sliders = that._sliders;\n    var position = sliders[1 - index].getPosition();\n    var dir = index > 0 ? 1 : -1;\n    var newValue;\n    sliders[index].setDisplayValue(selectClosestValue(translator.from(position, dir), that._values));\n    newValue = translator.from(position, -dir);\n\n    if (translator.isValueProlonged) {\n      newValue = translator.from(position, dir);\n    } else {\n      if (that._minRange) {\n        newValue = translator.add(newValue, that._minRange, -dir);\n      }\n    }\n\n    sliders[1 - index].setDisplayValue(selectClosestValue(newValue, that._values));\n\n    sliders[index]._setValid(true);\n\n    sliders[index]._marker._update();\n\n    sliders[0]._position = sliders[1]._position = position;\n  },\n  foregroundSlider: function foregroundSlider(index) {\n    this._sliders[index].toForeground();\n  }\n};\nexports.SlidersController = SlidersController;","map":{"version":3,"sources":["C:/Users/User/Documents/Templates/Angular/black-dashboard-pro-angular-v1.1.1/black-dashboard-pro-angular-v1.1.1/node_modules/devextreme/viz/range_selector/sliders_controller.js"],"names":["noop","require","commonModule","animationSettings","utils","emptySliderMarkerText","consts","Slider","_normalizeEnum","normalizeEnum","typeUtils","isNumeric","vizUtils","adjust","buildRectPoints","left","top","right","bottom","valueOf","value","isLess","a","b","isGreater","selectClosestValue","target","values","start","end","length","middle","val","dummyProcessSelectionChanged","_lastSelectedRange","getSelectedRange","_processSelectionChanged","suppressSetSelectedRange","controller","setSelectedRange","restoreSetSelectedRange","SlidersController","params","that","sliderParams","renderer","root","trackersGroup","translator","_params","_areaTracker","path","attr","fill","opacity","append","_selectedAreaTracker","_shutter","_sliders","prototype","constructor","dispose","getTrackerTargets","area","selectedArea","sliders","e","selectedRange","startValue","endValue","updateSelectedRange","update","verticalRange","behavior","isCompactMode","sliderHandleOptions","sliderMarkerOptions","shutterOptions","rangeBounds","fullTicks","selectedRangeColor","screenRange","getScreenRange","_verticalRange","_minRange","minRange","_maxRange","maxRange","_animationEnabled","animationEnabled","_allowSlidersSwap","allowSlidersSwap","_position","_values","isValueProlonged","snapToTicks","points","_isCompactMode","_shutterOffset","width","_updateSelectedView","_isOnMoving","callValueChanged","_updateSelectedRange","_applyTotalPosition","settings","stroke","sharp","color","cancelAnimation","stopAnimation","getBusinessRange","isEmpty","_setText","_value","isAnimated","areOverlapped","applyPosition","getCloudBorder","setOverlapped","_applyAreaTrackersPosition","_applySelectedRangePosition","position1","getPosition","position2","css","cursor","Math","abs","pos1","pos2","ceil","floor","axis","getVisibleArea","max","min","animate","getValue","visualRange","businessRange","compare","axisType","_vizUtils$adjustVisua","adjustVisualRange","dataType","base","isValid","getCorrectValue","minVisible","maxVisible","categories","to","setDisplayValue","beginSelectedAreaMoving","initialPosition","offset","currentPosition","move","complete","_dockSelectedArea","position","_moveSelectedArea","moveSelectedArea","screenPosition","interval","startPosition","endPosition","from","placeSliderAndBeginMoving","firstPosition","secondPosition","index","dir","antiCompare","thresholdPosition","positions","handler","add","getRange","beginSliderMoving","_sliderGroup","initialIndex","minPosition","maxPosition","staticPosition","compareMin","compareMax","moveOffset","swapOffset","_setValid","temp","pos","slider","_changeMovingSlider","toForeground","newValue","_marker","_update","foregroundSlider","exports"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (viz/range_selector/sliders_controller.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar noop = require(\"../../core/utils/common\").noop;\r\nvar commonModule = require(\"./common\");\r\nvar animationSettings = commonModule.utils.animationSettings;\r\nvar emptySliderMarkerText = commonModule.consts.emptySliderMarkerText;\r\nvar Slider = require(\"./slider\");\r\nvar _normalizeEnum = require(\"../core/utils\").normalizeEnum;\r\nvar typeUtils = require(\"../../core/utils/type\");\r\nvar isNumeric = typeUtils.isNumeric;\r\nvar vizUtils = require(\"../core/utils\");\r\nvar adjust = require(\"../../core/utils/math\").adjust;\r\n\r\nfunction buildRectPoints(left, top, right, bottom) {\r\n    return [left, top, right, top, right, bottom, left, bottom]\r\n}\r\n\r\nfunction valueOf(value) {\r\n    return value && value.valueOf()\r\n}\r\n\r\nfunction isLess(a, b) {\r\n    return a < b\r\n}\r\n\r\nfunction isGreater(a, b) {\r\n    return a > b\r\n}\r\n\r\nfunction selectClosestValue(target, values) {\r\n    var start = 0;\r\n    var end = values ? values.length - 1 : 0;\r\n    var middle;\r\n    var val = target;\r\n    while (end - start > 1) {\r\n        middle = start + end >> 1;\r\n        val = values[middle];\r\n        if (val === target) {\r\n            return target\r\n        } else {\r\n            if (target < val) {\r\n                end = middle\r\n            } else {\r\n                start = middle\r\n            }\r\n        }\r\n    }\r\n    if (values) {\r\n        val = values[target - values[start] <= values[end] - target ? start : end]\r\n    }\r\n    return val\r\n}\r\n\r\nfunction dummyProcessSelectionChanged() {\r\n    this._lastSelectedRange = this.getSelectedRange();\r\n    delete this._processSelectionChanged\r\n}\r\n\r\nfunction suppressSetSelectedRange(controller) {\r\n    controller.setSelectedRange = noop;\r\n    if (controller._processSelectionChanged === dummyProcessSelectionChanged) {\r\n        controller._processSelectionChanged()\r\n    }\r\n}\r\n\r\nfunction restoreSetSelectedRange(controller) {\r\n    delete controller.setSelectedRange\r\n}\r\n\r\nfunction SlidersController(params) {\r\n    var that = this;\r\n    var sliderParams = {\r\n        renderer: params.renderer,\r\n        root: params.root,\r\n        trackersGroup: params.trackersGroup,\r\n        translator: params.translator\r\n    };\r\n    that._params = params;\r\n    that._areaTracker = params.renderer.path(null, \"area\").attr({\r\n        \"class\": \"area-tracker\",\r\n        fill: \"#000000\",\r\n        opacity: 1e-4\r\n    }).append(params.trackersGroup);\r\n    that._selectedAreaTracker = params.renderer.path(null, \"area\").attr({\r\n        \"class\": \"selected-area-tracker\",\r\n        fill: \"#000000\",\r\n        opacity: 1e-4\r\n    }).append(params.trackersGroup);\r\n    that._shutter = params.renderer.path(null, \"area\").append(params.root);\r\n    that._sliders = [new Slider(sliderParams, 0), new Slider(sliderParams, 1)];\r\n    that._processSelectionChanged = dummyProcessSelectionChanged\r\n}\r\nSlidersController.prototype = {\r\n    constructor: SlidersController,\r\n    dispose: function() {\r\n        this._sliders[0].dispose();\r\n        this._sliders[1].dispose()\r\n    },\r\n    getTrackerTargets: function() {\r\n        return {\r\n            area: this._areaTracker,\r\n            selectedArea: this._selectedAreaTracker,\r\n            sliders: this._sliders\r\n        }\r\n    },\r\n    _processSelectionChanged: function(e) {\r\n        var that = this;\r\n        var selectedRange = that.getSelectedRange();\r\n        if (valueOf(selectedRange.startValue) !== valueOf(that._lastSelectedRange.startValue) || valueOf(selectedRange.endValue) !== valueOf(that._lastSelectedRange.endValue)) {\r\n            that._params.updateSelectedRange(selectedRange, that._lastSelectedRange, e);\r\n            that._lastSelectedRange = selectedRange\r\n        }\r\n    },\r\n    update: function(verticalRange, behavior, isCompactMode, sliderHandleOptions, sliderMarkerOptions, shutterOptions, rangeBounds, fullTicks, selectedRangeColor) {\r\n        var that = this;\r\n        var screenRange = that._params.translator.getScreenRange();\r\n        that._verticalRange = verticalRange;\r\n        that._minRange = rangeBounds.minRange;\r\n        that._maxRange = rangeBounds.maxRange;\r\n        that._animationEnabled = behavior.animationEnabled && that._params.renderer.animationEnabled();\r\n        that._allowSlidersSwap = behavior.allowSlidersSwap;\r\n        that._sliders[0].update(verticalRange, sliderHandleOptions, sliderMarkerOptions);\r\n        that._sliders[1].update(verticalRange, sliderHandleOptions, sliderMarkerOptions);\r\n        that._sliders[0]._position = that._sliders[1]._position = screenRange[0];\r\n        that._values = !that._params.translator.isValueProlonged && behavior.snapToTicks ? fullTicks : null;\r\n        that._areaTracker.attr({\r\n            points: buildRectPoints(screenRange[0], verticalRange[0], screenRange[1], verticalRange[1])\r\n        });\r\n        that._isCompactMode = isCompactMode;\r\n        that._shutterOffset = sliderHandleOptions.width / 2;\r\n        that._updateSelectedView(shutterOptions, selectedRangeColor);\r\n        that._isOnMoving = \"onmoving\" === _normalizeEnum(behavior.callValueChanged);\r\n        that._updateSelectedRange();\r\n        that._applyTotalPosition(false)\r\n    },\r\n    _updateSelectedView: function(shutterOptions, selectedRangeColor) {\r\n        var settings = {\r\n            fill: null,\r\n            \"fill-opacity\": null,\r\n            stroke: null,\r\n            \"stroke-width\": null\r\n        };\r\n        if (this._isCompactMode) {\r\n            settings.stroke = selectedRangeColor;\r\n            settings[\"stroke-width\"] = 3;\r\n            settings.sharp = \"v\"\r\n        } else {\r\n            settings.fill = shutterOptions.color;\r\n            settings[\"fill-opacity\"] = shutterOptions.opacity\r\n        }\r\n        this._shutter.attr(settings)\r\n    },\r\n    _updateSelectedRange: function() {\r\n        var that = this;\r\n        var sliders = that._sliders;\r\n        sliders[0].cancelAnimation();\r\n        sliders[1].cancelAnimation();\r\n        that._shutter.stopAnimation();\r\n        if (that._params.translator.getBusinessRange().isEmpty()) {\r\n            sliders[0]._setText(emptySliderMarkerText);\r\n            sliders[1]._setText(emptySliderMarkerText);\r\n            sliders[0]._value = sliders[1]._value = void 0;\r\n            sliders[0]._position = that._params.translator.getScreenRange()[0];\r\n            sliders[1]._position = that._params.translator.getScreenRange()[1];\r\n            that._applyTotalPosition(false);\r\n            suppressSetSelectedRange(that)\r\n        } else {\r\n            restoreSetSelectedRange(that)\r\n        }\r\n    },\r\n    _applyTotalPosition: function(isAnimated) {\r\n        var sliders = this._sliders;\r\n        var areOverlapped;\r\n        isAnimated = this._animationEnabled && isAnimated;\r\n        sliders[0].applyPosition(isAnimated);\r\n        sliders[1].applyPosition(isAnimated);\r\n        areOverlapped = sliders[0].getCloudBorder() > sliders[1].getCloudBorder();\r\n        sliders[0].setOverlapped(areOverlapped);\r\n        sliders[1].setOverlapped(areOverlapped);\r\n        this._applyAreaTrackersPosition();\r\n        this._applySelectedRangePosition(isAnimated)\r\n    },\r\n    _applyAreaTrackersPosition: function() {\r\n        var that = this;\r\n        var position1 = that._sliders[0].getPosition();\r\n        var position2 = that._sliders[1].getPosition();\r\n        that._selectedAreaTracker.attr({\r\n            points: buildRectPoints(position1, that._verticalRange[0], position2, that._verticalRange[1])\r\n        }).css({\r\n            cursor: Math.abs(that._params.translator.getScreenRange()[1] - that._params.translator.getScreenRange()[0] - position2 + position1) < .001 ? \"default\" : \"pointer\"\r\n        })\r\n    },\r\n    _applySelectedRangePosition: function(isAnimated) {\r\n        var that = this;\r\n        var verticalRange = that._verticalRange;\r\n        var pos1 = that._sliders[0].getPosition();\r\n        var pos2 = that._sliders[1].getPosition();\r\n        var screenRange;\r\n        var points;\r\n        if (that._isCompactMode) {\r\n            points = [pos1 + Math.ceil(that._shutterOffset), (verticalRange[0] + verticalRange[1]) / 2, pos2 - Math.floor(that._shutterOffset), (verticalRange[0] + verticalRange[1]) / 2]\r\n        } else {\r\n            screenRange = that._params.axis.getVisibleArea();\r\n            points = [buildRectPoints(screenRange[0], verticalRange[0], Math.max(pos1 - Math.floor(that._shutterOffset), screenRange[0]), verticalRange[1]), buildRectPoints(screenRange[1], verticalRange[0], Math.min(pos2 + Math.ceil(that._shutterOffset), screenRange[1]), verticalRange[1])]\r\n        }\r\n        if (isAnimated) {\r\n            that._shutter.animate({\r\n                points: points\r\n            }, animationSettings)\r\n        } else {\r\n            that._shutter.attr({\r\n                points: points\r\n            })\r\n        }\r\n    },\r\n    getSelectedRange: function() {\r\n        return {\r\n            startValue: this._sliders[0].getValue(),\r\n            endValue: this._sliders[1].getValue()\r\n        }\r\n    },\r\n    setSelectedRange: function(visualRange, e) {\r\n        visualRange = visualRange || {};\r\n        var that = this;\r\n        var translator = that._params.translator;\r\n        var businessRange = translator.getBusinessRange();\r\n        var compare = \"discrete\" === businessRange.axisType ? function(a, b) {\r\n            return a < b\r\n        } : function(a, b) {\r\n            return a <= b\r\n        };\r\n        var _vizUtils$adjustVisua = vizUtils.adjustVisualRange({\r\n                dataType: businessRange.dataType,\r\n                axisType: businessRange.axisType,\r\n                base: businessRange.base\r\n            }, {\r\n                startValue: translator.isValid(visualRange.startValue) ? translator.getCorrectValue(visualRange.startValue, 1) : void 0,\r\n                endValue: translator.isValid(visualRange.endValue) ? translator.getCorrectValue(visualRange.endValue, -1) : void 0,\r\n                length: visualRange.length\r\n            }, {\r\n                min: businessRange.minVisible,\r\n                max: businessRange.maxVisible,\r\n                categories: businessRange.categories\r\n            }),\r\n            startValue = _vizUtils$adjustVisua.startValue,\r\n            endValue = _vizUtils$adjustVisua.endValue;\r\n        startValue = isNumeric(startValue) ? adjust(startValue) : startValue;\r\n        endValue = isNumeric(endValue) ? adjust(endValue) : endValue;\r\n        var values = compare(translator.to(startValue, -1), translator.to(endValue, 1)) ? [startValue, endValue] : [endValue, startValue];\r\n        that._sliders[0].setDisplayValue(values[0]);\r\n        that._sliders[1].setDisplayValue(values[1]);\r\n        that._sliders[0]._position = translator.to(values[0], -1);\r\n        that._sliders[1]._position = translator.to(values[1], 1);\r\n        that._applyTotalPosition(true);\r\n        that._processSelectionChanged(e)\r\n    },\r\n    beginSelectedAreaMoving: function(initialPosition) {\r\n        var that = this;\r\n        var sliders = that._sliders;\r\n        var offset = (sliders[0].getPosition() + sliders[1].getPosition()) / 2 - initialPosition;\r\n        var currentPosition = initialPosition;\r\n        move.complete = function(e) {\r\n            that._dockSelectedArea(e)\r\n        };\r\n        return move;\r\n\r\n        function move(position, e) {\r\n            if (position !== currentPosition && position > currentPosition === position > (sliders[0].getPosition() + sliders[1].getPosition()) / 2 - offset) {\r\n                that._moveSelectedArea(position + offset, false, e)\r\n            }\r\n            currentPosition = position\r\n        }\r\n    },\r\n    _dockSelectedArea: function(e) {\r\n        var translator = this._params.translator;\r\n        var sliders = this._sliders;\r\n        sliders[0]._position = translator.to(sliders[0].getValue(), -1);\r\n        sliders[1]._position = translator.to(sliders[1].getValue(), 1);\r\n        this._applyTotalPosition(true);\r\n        this._processSelectionChanged(e)\r\n    },\r\n    moveSelectedArea: function(screenPosition, e) {\r\n        this._moveSelectedArea(screenPosition, true, e);\r\n        this._dockSelectedArea(e)\r\n    },\r\n    _moveSelectedArea: function(screenPosition, isAnimated, e) {\r\n        var that = this;\r\n        var translator = that._params.translator;\r\n        var sliders = that._sliders;\r\n        var interval = sliders[1].getPosition() - sliders[0].getPosition();\r\n        var startPosition = screenPosition - interval / 2;\r\n        var endPosition = screenPosition + interval / 2;\r\n        var startValue;\r\n        if (startPosition < translator.getScreenRange()[0]) {\r\n            startPosition = translator.getScreenRange()[0];\r\n            endPosition = startPosition + interval\r\n        }\r\n        if (endPosition > translator.getScreenRange()[1]) {\r\n            endPosition = translator.getScreenRange()[1];\r\n            startPosition = endPosition - interval\r\n        }\r\n        startValue = selectClosestValue(translator.from(startPosition, -1), that._values);\r\n        sliders[0].setDisplayValue(startValue);\r\n        sliders[1].setDisplayValue(selectClosestValue(translator.from(translator.to(startValue, -1) + interval, 1), that._values));\r\n        sliders[0]._position = startPosition;\r\n        sliders[1]._position = endPosition;\r\n        that._applyTotalPosition(isAnimated);\r\n        if (that._isOnMoving) {\r\n            that._processSelectionChanged(e)\r\n        }\r\n    },\r\n    placeSliderAndBeginMoving: function(firstPosition, secondPosition, e) {\r\n        var that = this;\r\n        var translator = that._params.translator;\r\n        var sliders = that._sliders;\r\n        var index = firstPosition < secondPosition ? 0 : 1;\r\n        var dir = index > 0 ? 1 : -1;\r\n        var compare = index > 0 ? isGreater : isLess;\r\n        var antiCompare = index > 0 ? isLess : isGreater;\r\n        var thresholdPosition;\r\n        var positions = [];\r\n        var values = [];\r\n        var handler;\r\n        values[index] = translator.from(firstPosition, dir);\r\n        values[1 - index] = translator.from(secondPosition, -dir);\r\n        positions[1 - index] = secondPosition;\r\n        if (translator.isValueProlonged) {\r\n            if (compare(firstPosition, translator.to(values[index], dir))) {\r\n                values[index] = translator.from(firstPosition, -dir)\r\n            }\r\n            if (compare(secondPosition, translator.to(values[index], -dir))) {\r\n                values[1 - index] = values[index]\r\n            }\r\n        }\r\n        if (that._minRange) {\r\n            thresholdPosition = translator.to(translator.add(selectClosestValue(values[index], that._values), that._minRange, -dir), -dir);\r\n            if (compare(secondPosition, thresholdPosition)) {\r\n                values[1 - index] = translator.add(values[index], that._minRange, -dir)\r\n            }\r\n            thresholdPosition = translator.to(translator.add(translator.getRange()[1 - index], that._minRange, dir), -dir);\r\n            if (antiCompare(firstPosition, thresholdPosition)) {\r\n                values[1 - index] = translator.getRange()[1 - index];\r\n                values[index] = translator.add(values[1 - index], that._minRange, dir);\r\n                positions[1 - index] = firstPosition\r\n            }\r\n        }\r\n        values[0] = selectClosestValue(values[0], that._values);\r\n        values[1] = selectClosestValue(values[1], that._values);\r\n        positions[index] = translator.to(values[index], dir);\r\n        sliders[0].setDisplayValue(values[0]);\r\n        sliders[1].setDisplayValue(values[1]);\r\n        sliders[0]._position = positions[0];\r\n        sliders[1]._position = positions[1];\r\n        that._applyTotalPosition(true);\r\n        if (that._isOnMoving) {\r\n            that._processSelectionChanged(e)\r\n        }\r\n        handler = that.beginSliderMoving(1 - index, secondPosition);\r\n        sliders[1 - index]._sliderGroup.stopAnimation();\r\n        that._shutter.stopAnimation();\r\n        handler(secondPosition);\r\n        return handler\r\n    },\r\n    beginSliderMoving: function(initialIndex, initialPosition) {\r\n        var that = this;\r\n        var translator = that._params.translator;\r\n        var sliders = that._sliders;\r\n        var minPosition = translator.getScreenRange()[0];\r\n        var maxPosition = translator.getScreenRange()[1];\r\n        var index = initialIndex;\r\n        var staticPosition = sliders[1 - index].getPosition();\r\n        var currentPosition = initialPosition;\r\n        var dir = index > 0 ? 1 : -1;\r\n        var compareMin = index > 0 ? isLess : isGreater;\r\n        var compareMax = index > 0 ? isGreater : isLess;\r\n        var moveOffset = sliders[index].getPosition() - initialPosition;\r\n        var swapOffset = compareMin(sliders[index].getPosition(), initialPosition) ? -moveOffset : moveOffset;\r\n        move.complete = function(e) {\r\n            sliders[index]._setValid(true);\r\n            that._dockSelectedArea(e)\r\n        };\r\n        return move;\r\n\r\n        function move(position, e) {\r\n            var isValid;\r\n            var temp;\r\n            var pos;\r\n            var slider;\r\n            var value;\r\n            if (position !== currentPosition) {\r\n                if (compareMin(position + swapOffset, staticPosition)) {\r\n                    isValid = that._allowSlidersSwap;\r\n                    if (isValid && !translator.isValueProlonged && that._minRange) {\r\n                        isValid = translator.isValid(translator.add(sliders[1 - index].getValue(), that._minRange, -dir))\r\n                    }\r\n                    if (isValid) {\r\n                        that._changeMovingSlider(index);\r\n                        index = 1 - index;\r\n                        dir = -dir;\r\n                        temp = compareMin;\r\n                        compareMin = compareMax;\r\n                        compareMax = temp;\r\n                        moveOffset = -dir * Math.abs(moveOffset);\r\n                        swapOffset = -moveOffset\r\n                    }\r\n                }\r\n                if (compareMax(position + moveOffset, staticPosition)) {\r\n                    isValid = true;\r\n                    slider = sliders[index];\r\n                    value = sliders[1 - index].getValue();\r\n                    pos = Math.max(Math.min(position + moveOffset, maxPosition), minPosition);\r\n                    if (isValid && translator.isValueProlonged) {\r\n                        isValid = !compareMin(pos, translator.to(value, dir))\r\n                    }\r\n                    if (isValid && that._minRange) {\r\n                        isValid = !compareMin(pos, translator.to(translator.add(value, that._minRange, dir), dir))\r\n                    }\r\n                    if (isValid && that._maxRange) {\r\n                        isValid = !compareMax(pos, translator.to(translator.add(value, that._maxRange, dir), dir))\r\n                    }\r\n                    slider._setValid(isValid);\r\n                    slider.setDisplayValue(isValid ? selectClosestValue(translator.from(pos, dir), that._values) : slider.getValue());\r\n                    slider._position = pos;\r\n                    that._applyTotalPosition(false);\r\n                    slider.toForeground();\r\n                    if (that._isOnMoving) {\r\n                        that._processSelectionChanged(e)\r\n                    }\r\n                }\r\n            }\r\n            currentPosition = position\r\n        }\r\n    },\r\n    _changeMovingSlider: function(index) {\r\n        var that = this;\r\n        var translator = that._params.translator;\r\n        var sliders = that._sliders;\r\n        var position = sliders[1 - index].getPosition();\r\n        var dir = index > 0 ? 1 : -1;\r\n        var newValue;\r\n        sliders[index].setDisplayValue(selectClosestValue(translator.from(position, dir), that._values));\r\n        newValue = translator.from(position, -dir);\r\n        if (translator.isValueProlonged) {\r\n            newValue = translator.from(position, dir)\r\n        } else {\r\n            if (that._minRange) {\r\n                newValue = translator.add(newValue, that._minRange, -dir)\r\n            }\r\n        }\r\n        sliders[1 - index].setDisplayValue(selectClosestValue(newValue, that._values));\r\n        sliders[index]._setValid(true);\r\n        sliders[index]._marker._update();\r\n        sliders[0]._position = sliders[1]._position = position\r\n    },\r\n    foregroundSlider: function(index) {\r\n        this._sliders[index].toForeground()\r\n    }\r\n};\r\nexports.SlidersController = SlidersController;\r\n"]},"metadata":{},"sourceType":"script"}