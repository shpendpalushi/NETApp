{"ast":null,"code":"/**\r\n * DevExtreme (ui/grid_core/ui.grid_core.adaptivity.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar _renderer = require(\"../../core/renderer\");\n\nvar _renderer2 = _interopRequireDefault(_renderer);\n\nvar _events_engine = require(\"../../events/core/events_engine\");\n\nvar _events_engine2 = _interopRequireDefault(_events_engine);\n\nvar _utils = require(\"../../events/utils\");\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nvar _click = require(\"../../events/click\");\n\nvar _click2 = _interopRequireDefault(_click);\n\nvar _type = require(\"../../core/utils/type\");\n\nvar _type2 = _interopRequireDefault(_type);\n\nvar _browser = require(\"../../core/utils/browser\");\n\nvar _browser2 = _interopRequireDefault(_browser);\n\nvar _guid = require(\"../../core/guid\");\n\nvar _guid2 = _interopRequireDefault(_guid);\n\nvar _uiGrid_core = require(\"./ui.grid_core.modules\");\n\nvar _uiGrid_core2 = _interopRequireDefault(_uiGrid_core);\n\nvar _form = require(\"../form\");\n\nvar _form2 = _interopRequireDefault(_form);\n\nvar _uiGrid_core3 = require(\"./ui.grid_core.utils\");\n\nvar _uiGrid_core4 = _interopRequireDefault(_uiGrid_core3);\n\nvar _themes = require(\"../themes\");\n\nvar _themes2 = _interopRequireDefault(_themes);\n\nvar _window = require(\"../../core/utils/window\");\n\nvar _common = require(\"../../core/utils/common\");\n\nvar _iterator = require(\"../../core/utils/iterator\");\n\nvar _extend = require(\"../../core/utils/extend\");\n\nvar _deferred = require(\"../../core/utils/deferred\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nvar COLUMN_HEADERS_VIEW = \"columnHeadersView\";\nvar ROWS_VIEW = \"rowsView\";\nvar FOOTER_VIEW = \"footerView\";\nvar COLUMN_VIEWS = [COLUMN_HEADERS_VIEW, ROWS_VIEW, FOOTER_VIEW];\nvar ADAPTIVE_NAMESPACE = \"dxDataGridAdaptivity\";\nvar HIDDEN_COLUMNS_WIDTH = \"adaptiveHidden\";\nvar ADAPTIVE_ROW_TYPE = \"detailAdaptive\";\nvar FORM_ITEM_CONTENT_CLASS = \"dx-field-item-content\";\nvar FORM_ITEM_MODIFIED = \"dx-item-modified\";\nvar HIDDEN_COLUMN_CLASS = \"hidden-column\";\nvar ADAPTIVE_COLUMN_BUTTON_CLASS = \"adaptive-more\";\nvar ADAPTIVE_COLUMN_NAME_CLASS = \"dx-command-adaptive\";\nvar COMMAND_ADAPTIVE_HIDDEN_CLASS = \"dx-command-adaptive-hidden\";\nvar ADAPTIVE_DETAIL_ROW_CLASS = \"dx-adaptive-detail-row\";\nvar ADAPTIVE_ITEM_TEXT_CLASS = \"dx-adaptive-item-text\";\nvar MASTER_DETAIL_CELL_CLASS = \"dx-master-detail-cell\";\nvar LAST_DATA_CELL_CLASS = \"dx-last-data-cell\";\nvar ADAPTIVE_COLUMN_NAME = \"adaptive\";\nvar EDIT_MODE_BATCH = \"batch\";\nvar EDIT_MODE_ROW = \"row\";\nvar EDIT_MODE_FORM = \"form\";\nvar EDIT_MODE_POPUP = \"popup\";\nvar REVERT_TOOLTIP_CLASS = \"revert-tooltip\";\n\nfunction getColumnId(that, column) {\n  return that._columnsController.getColumnId(column);\n}\n\nfunction getDataCellElements($row) {\n  return $row.find(\"td:not(.dx-datagrid-hidden-column):not([class*='dx-command-'])\");\n}\n\nfunction adaptiveCellTemplate(container, options) {\n  var $adaptiveColumnButton;\n  var $container = (0, _renderer2.default)(container);\n  var adaptiveColumnsController = options.component.getController(\"adaptiveColumns\");\n\n  if (\"data\" === options.rowType) {\n    $adaptiveColumnButton = (0, _renderer2.default)(\"<span>\").addClass(adaptiveColumnsController.addWidgetPrefix(ADAPTIVE_COLUMN_BUTTON_CLASS));\n\n    _events_engine2.default.on($adaptiveColumnButton, _utils2.default.addNamespace(_click2.default.name, ADAPTIVE_NAMESPACE), adaptiveColumnsController.createAction(function () {\n      adaptiveColumnsController.toggleExpandAdaptiveDetailRow(options.key);\n    }));\n\n    $adaptiveColumnButton.appendTo($container);\n  } else {\n    _uiGrid_core4.default.setEmptyText($container);\n  }\n}\n\nvar AdaptiveColumnsController = _uiGrid_core2.default.ViewController.inherit({\n  _isRowEditMode: function _isRowEditMode() {\n    var editMode = this._getEditMode();\n\n    return editMode === EDIT_MODE_ROW;\n  },\n  _isItemModified: function _isItemModified(item, cellOptions) {\n    var columnIndex = this._columnsController.getVisibleIndex(item.column.index);\n\n    var rowIndex = this._dataController.getRowIndexByKey(cellOptions.key);\n\n    var row = this._dataController.items()[rowIndex + 1];\n\n    return row && row.modifiedValues && _type2.default.isDefined(row.modifiedValues[columnIndex]);\n  },\n  _renderFormViewTemplate: function _renderFormViewTemplate(item, cellOptions, $container) {\n    var that = this;\n    var column = item.column;\n    var focusAction = that.createAction(function () {\n      _events_engine2.default.trigger($container, _click2.default.name);\n    });\n    var container;\n    var value = column.calculateCellValue(cellOptions.data);\n\n    var displayValue = _uiGrid_core4.default.getDisplayValue(column, value, cellOptions.data, cellOptions.rowType);\n\n    var text = _uiGrid_core4.default.formatValue(displayValue, column);\n\n    var isCellOrBatchEditMode = this._editingController.isCellOrBatchEditMode();\n\n    if (column.allowEditing && that.getController(\"keyboardNavigation\").isKeyboardEnabled()) {\n      $container.attr(\"tabIndex\", that.option(\"tabIndex\"));\n\n      if (isCellOrBatchEditMode) {\n        _events_engine2.default.off($container, \"focus\", focusAction);\n\n        _events_engine2.default.on($container, \"focus\", focusAction);\n      }\n    }\n\n    if (column.cellTemplate) {\n      var templateOptions = (0, _extend.extend)({}, cellOptions, {\n        value: value,\n        displayValue: displayValue,\n        text: text,\n        column: column\n      });\n\n      that._rowsView.renderTemplate($container, column.cellTemplate, templateOptions, !!$container.closest((0, _window.getWindow)().document).length);\n    } else {\n      container = $container.get(0);\n\n      if (column.encodeHtml) {\n        container.textContent = text;\n      } else {\n        container.innerHTML = text;\n      }\n\n      $container.addClass(ADAPTIVE_ITEM_TEXT_CLASS);\n\n      if (!_type2.default.isDefined(text) || \"\" === text) {\n        $container.html(\"&nbsp;\");\n      }\n\n      if (!that._isRowEditMode()) {\n        if (that._isItemModified(item, cellOptions)) {\n          $container.addClass(FORM_ITEM_MODIFIED);\n        }\n      }\n    }\n\n    that.getView(\"rowsView\")._cellPrepared($container, cellOptions);\n  },\n  _getTemplate: function _getTemplate(item, cellOptions) {\n    var that = this;\n    var column = item.column;\n    var editingController = this.getController(\"editing\");\n    return function (options, container) {\n      var $container = (0, _renderer2.default)(container);\n\n      var columnIndex = that._columnsController.getVisibleIndex(column.visibleIndex);\n\n      var templateOptions = (0, _extend.extend)({}, cellOptions);\n\n      var renderFormTemplate = function renderFormTemplate() {\n        var isItemEdited = that._isItemEdited(item);\n\n        templateOptions.value = cellOptions.row.values[columnIndex];\n\n        if (isItemEdited || column.showEditorAlways) {\n          editingController.renderFormEditTemplate(templateOptions, item, options.component, $container, !isItemEdited);\n        } else {\n          templateOptions.column = column;\n          templateOptions.columnIndex = columnIndex;\n\n          that._renderFormViewTemplate(item, templateOptions, $container);\n        }\n      };\n\n      renderFormTemplate();\n      templateOptions.watch && templateOptions.watch(function () {\n        return {\n          isItemEdited: that._isItemEdited(item),\n          value: cellOptions.row.values[columnIndex]\n        };\n      }, function () {\n        $container.contents().remove();\n        $container.removeClass(ADAPTIVE_ITEM_TEXT_CLASS);\n        renderFormTemplate();\n      });\n    };\n  },\n  _isVisibleColumnsValid: function _isVisibleColumnsValid(visibleColumns) {\n    var getCommandColumnsCount = function getCommandColumnsCount() {\n      var result = 0;\n      var j;\n      var visibleColumn;\n\n      for (j = 0; j < visibleColumns.length; j++) {\n        visibleColumn = visibleColumns[j];\n\n        if (visibleColumn.command) {\n          result++;\n        }\n      }\n\n      return result;\n    };\n\n    if (visibleColumns < 2) {\n      return false;\n    }\n\n    if (visibleColumns.length - getCommandColumnsCount() <= 1) {\n      return false;\n    }\n\n    return true;\n  },\n  _calculatePercentWidths: function _calculatePercentWidths(widths, visibleColumns) {\n    var that = this;\n    var percentWidths = 0;\n    visibleColumns.forEach(function (item, index) {\n      if (widths[index] !== HIDDEN_COLUMNS_WIDTH) {\n        percentWidths += that._getItemPercentWidth(item);\n      }\n    });\n    return percentWidths;\n  },\n  _isPercentWidth: function _isPercentWidth(width) {\n    return _type2.default.isString(width) && \"%\" === width.slice(-1);\n  },\n  _isColumnHidden: function _isColumnHidden(column) {\n    return this._hiddenColumns.filter(function (hiddenColumn) {\n      return hiddenColumn.index === column.index;\n    }).length > 0;\n  },\n  _getAverageColumnsWidth: function _getAverageColumnsWidth(containerWidth, columns, columnsCanFit) {\n    var that = this;\n    var fixedColumnsWidth = 0;\n    var columnsWithoutFixedWidthCount = 0;\n    columns.forEach(function (column) {\n      if (!that._isColumnHidden(column)) {\n        var width = column.width;\n\n        if (_type2.default.isDefined(width) && !isNaN(parseFloat(width))) {\n          fixedColumnsWidth += that._isPercentWidth(width) ? that._calculatePercentWidth({\n            visibleIndex: column.visibleIndex,\n            columnsCount: columns.length,\n            columnsCanFit: columnsCanFit,\n            bestFitWidth: column.bestFitWidth,\n            columnWidth: width,\n            containerWidth: containerWidth\n          }) : parseFloat(width);\n        } else {\n          columnsWithoutFixedWidthCount++;\n        }\n      }\n    });\n    return (containerWidth - fixedColumnsWidth) / columnsWithoutFixedWidthCount;\n  },\n  _calculateColumnWidth: function _calculateColumnWidth(column, containerWidth, contentColumns, columnsCanFit) {\n    var columnId = getColumnId(this, column);\n\n    var widthOption = this._columnsController.columnOption(columnId, \"width\");\n\n    var bestFitWidth = this._columnsController.columnOption(columnId, \"bestFitWidth\");\n\n    var columnsCount = contentColumns.length;\n    var colWidth;\n\n    if (widthOption && \"auto\" !== widthOption) {\n      if (this._isPercentWidth(widthOption)) {\n        colWidth = this._calculatePercentWidth({\n          visibleIndex: column.visibleIndex,\n          columnsCount: columnsCount,\n          columnsCanFit: columnsCanFit,\n          bestFitWidth: bestFitWidth,\n          columnWidth: widthOption,\n          containerWidth: containerWidth\n        });\n      } else {\n        return widthOption;\n      }\n    } else {\n      var columnAutoWidth = this.option(\"columnAutoWidth\");\n      colWidth = columnAutoWidth || !!column.command ? bestFitWidth : this._getAverageColumnsWidth(containerWidth, contentColumns, columnsCanFit);\n    }\n\n    return colWidth;\n  },\n  _calculatePercentWidth: function _calculatePercentWidth(options) {\n    var columnFitted = options.visibleIndex < options.columnsCount - 1 && options.columnsCanFit;\n    var partialWidth = options.containerWidth * parseFloat(options.columnWidth) / 100;\n    var resultWidth = options.columnsCanFit && partialWidth < options.bestFitWidth ? options.bestFitWidth : partialWidth;\n    return columnFitted ? options.containerWidth * parseFloat(options.columnWidth) / 100 : resultWidth;\n  },\n  _getNotTruncatedColumnWidth: function _getNotTruncatedColumnWidth(column, containerWidth, contentColumns, columnsCanFit) {\n    var columnId = getColumnId(this, column);\n\n    var widthOption = this._columnsController.columnOption(columnId, \"width\");\n\n    var bestFitWidth = this._columnsController.columnOption(columnId, \"bestFitWidth\");\n\n    var colWidth;\n\n    if (widthOption && \"auto\" !== widthOption && !this._isPercentWidth(widthOption)) {\n      return parseFloat(widthOption);\n    }\n\n    colWidth = this._calculateColumnWidth(column, containerWidth, contentColumns, columnsCanFit);\n    return colWidth < bestFitWidth ? null : colWidth;\n  },\n  _getItemPercentWidth: function _getItemPercentWidth(item) {\n    var result = 0;\n\n    if (item.width && this._isPercentWidth(item.width)) {\n      result = parseFloat(item.width);\n    }\n\n    return result;\n  },\n  _getCommandColumnsWidth: function _getCommandColumnsWidth() {\n    var that = this;\n\n    var columns = that._columnsController.getVisibleColumns();\n\n    var colWidth = 0;\n    (0, _iterator.each)(columns, function (index, column) {\n      if (column.index < 0 || column.command) {\n        colWidth += that._columnsController.columnOption(getColumnId(that, column), \"bestFitWidth\") || 0;\n      }\n    });\n    return colWidth;\n  },\n  _isItemEdited: function _isItemEdited(item) {\n    if (this.isFormEditMode()) {\n      return false;\n    }\n\n    if (this._isRowEditMode()) {\n      var editRowKey = this._editingController.getEditRowKey();\n\n      if ((0, _common.equalByValue)(editRowKey, this._dataController.adaptiveExpandedKey())) {\n        return true;\n      }\n    } else {\n      var rowIndex = this._dataController.getRowIndexByKey(this._dataController.adaptiveExpandedKey()) + 1;\n\n      var columnIndex = this._columnsController.getVisibleIndex(item.column.index);\n\n      return this._editingController.isEditCell(rowIndex, columnIndex);\n    }\n  },\n  _getFormItemsByHiddenColumns: function _getFormItemsByHiddenColumns(hiddenColumns) {\n    var items = [];\n    (0, _iterator.each)(hiddenColumns, function (_, column) {\n      items.push({\n        column: column,\n        name: column.name,\n        dataField: column.dataField,\n        visibleIndex: column.visibleIndex\n      });\n    });\n    return items;\n  },\n  _getAdaptiveColumnVisibleIndex: function _getAdaptiveColumnVisibleIndex(visibleColumns) {\n    var i;\n    var column;\n\n    for (i = 0; i < visibleColumns.length; i++) {\n      column = visibleColumns[i];\n\n      if (column.command === ADAPTIVE_COLUMN_NAME) {\n        return i;\n      }\n    }\n  },\n  _hideAdaptiveColumn: function _hideAdaptiveColumn(resultWidths, visibleColumns) {\n    var visibleIndex = this._getAdaptiveColumnVisibleIndex(visibleColumns);\n\n    if (_type2.default.isDefined(visibleIndex)) {\n      resultWidths[visibleIndex] = HIDDEN_COLUMNS_WIDTH;\n\n      this._addCssClassToColumn(COMMAND_ADAPTIVE_HIDDEN_CLASS, visibleIndex);\n    }\n  },\n  _removeCssClassFromColumn: function _removeCssClassFromColumn(cssClassName) {\n    var i;\n    var view;\n    var $cells;\n\n    for (i = 0; i < COLUMN_VIEWS.length; i++) {\n      view = this.getView(COLUMN_VIEWS[i]);\n\n      if (view && view.isVisible() && view.element()) {\n        $cells = view.element().find(\".\" + cssClassName);\n        $cells.removeClass(cssClassName);\n      }\n    }\n  },\n  _removeCssClassesFromColumns: function _removeCssClassesFromColumns() {\n    this._removeCssClassFromColumn(COMMAND_ADAPTIVE_HIDDEN_CLASS);\n\n    this._removeCssClassFromColumn(this.addWidgetPrefix(HIDDEN_COLUMN_CLASS));\n  },\n  _isCellValid: function _isCellValid($cell) {\n    return $cell && $cell.length && !$cell.hasClass(MASTER_DETAIL_CELL_CLASS);\n  },\n  _addCssClassToColumn: function _addCssClassToColumn(cssClassName, visibleIndex) {\n    var that = this;\n    COLUMN_VIEWS.forEach(function (viewName) {\n      var view = that.getView(viewName);\n      view && that._addCssClassToViewColumn(view, cssClassName, visibleIndex);\n    });\n  },\n  _addCssClassToViewColumn: function _addCssClassToViewColumn(view, cssClassName, visibleIndex) {\n    var viewName = view.name;\n    var rowsCount;\n    var rowIndex;\n    var $cellElement;\n    var currentVisibleIndex;\n\n    var column = this._columnsController.getVisibleColumns()[visibleIndex];\n\n    var editFormRowIndex = this._editingController && this._editingController.getEditFormRowIndex();\n\n    if (view && view.isVisible() && column) {\n      rowsCount = view.getRowsCount();\n\n      var $rowElements = view._getRowElements();\n\n      for (rowIndex = 0; rowIndex < rowsCount; rowIndex++) {\n        if (rowIndex !== editFormRowIndex || viewName !== ROWS_VIEW) {\n          currentVisibleIndex = viewName === COLUMN_HEADERS_VIEW ? this._columnsController.getVisibleIndex(column.index, rowIndex) : visibleIndex;\n\n          if (currentVisibleIndex >= 0) {\n            $cellElement = $rowElements.eq(rowIndex).children().eq(currentVisibleIndex);\n            this._isCellValid($cellElement) && $cellElement.addClass(cssClassName);\n          }\n        }\n      }\n    }\n  },\n  _getEditMode: function _getEditMode() {\n    return this._editingController.getEditMode();\n  },\n  isFormEditMode: function isFormEditMode() {\n    var editMode = this._getEditMode();\n\n    return editMode === EDIT_MODE_FORM || editMode === EDIT_MODE_POPUP;\n  },\n  hideRedundantColumns: function hideRedundantColumns(resultWidths, visibleColumns, hiddenQueue) {\n    var that = this;\n    var visibleColumn;\n    this._hiddenColumns = [];\n\n    if (that._isVisibleColumnsValid(visibleColumns) && hiddenQueue.length) {\n      var totalWidth = 0;\n      var percentWidths;\n      var $rootElement = that.component.$element();\n\n      var rootElementWidth = $rootElement.width() - that._getCommandColumnsWidth();\n\n      var getVisibleContentColumns = function () {\n        var _this = this;\n\n        return visibleColumns.filter(function (item) {\n          return !item.command && 0 === _this._hiddenColumns.filter(function (i) {\n            return i.dataField === item.dataField;\n          }).length;\n        });\n      }.bind(this);\n\n      var visibleContentColumns = getVisibleContentColumns();\n      var contentColumnsCount = visibleContentColumns.length;\n      var columnsCanFit;\n      var i;\n      var hasHiddenColumns;\n      var needHideColumn;\n\n      do {\n        needHideColumn = false;\n        totalWidth = 0;\n        percentWidths = that._calculatePercentWidths(resultWidths, visibleColumns);\n        columnsCanFit = percentWidths < 100 && 0 !== percentWidths;\n\n        for (i = 0; i < visibleColumns.length; i++) {\n          visibleColumn = visibleColumns[i];\n\n          var columnWidth = that._getNotTruncatedColumnWidth(visibleColumn, rootElementWidth, visibleContentColumns, columnsCanFit);\n\n          var columnId = getColumnId(that, visibleColumn);\n\n          var widthOption = that._columnsController.columnOption(columnId, \"width\");\n\n          var minWidth = that._columnsController.columnOption(columnId, \"minWidth\");\n\n          var columnBestFitWidth = that._columnsController.columnOption(columnId, \"bestFitWidth\");\n\n          if (resultWidths[i] === HIDDEN_COLUMNS_WIDTH) {\n            hasHiddenColumns = true;\n            continue;\n          }\n\n          if (!columnWidth && !visibleColumn.command && !visibleColumn.fixed) {\n            needHideColumn = true;\n            break;\n          }\n\n          if (!widthOption || \"auto\" === widthOption) {\n            columnWidth = Math.max(columnBestFitWidth || 0, minWidth || 0);\n          }\n\n          if (visibleColumn.command !== ADAPTIVE_COLUMN_NAME || hasHiddenColumns) {\n            totalWidth += columnWidth;\n          }\n        }\n\n        needHideColumn = needHideColumn || totalWidth > $rootElement.width();\n\n        if (needHideColumn) {\n          var column = hiddenQueue.pop();\n\n          var visibleIndex = that._columnsController.getVisibleIndex(column.index);\n\n          rootElementWidth += that._calculateColumnWidth(column, rootElementWidth, visibleContentColumns, columnsCanFit);\n\n          that._addCssClassToColumn(that.addWidgetPrefix(HIDDEN_COLUMN_CLASS), visibleIndex);\n\n          resultWidths[visibleIndex] = HIDDEN_COLUMNS_WIDTH;\n\n          this._hiddenColumns.push(column);\n\n          visibleContentColumns = getVisibleContentColumns();\n        }\n      } while (needHideColumn && visibleContentColumns.length > 1 && hiddenQueue.length);\n\n      if (contentColumnsCount === visibleContentColumns.length) {\n        that._hideAdaptiveColumn(resultWidths, visibleColumns);\n      }\n    } else {\n      that._hideAdaptiveColumn(resultWidths, visibleColumns);\n    }\n  },\n  getItemContentByColumnIndex: function getItemContentByColumnIndex(visibleColumnIndex) {\n    var $itemContent;\n    var i;\n    var item;\n\n    for (i = 0; i < this._$itemContents.length; i++) {\n      $itemContent = this._$itemContents.eq(i);\n      item = $itemContent.data(\"dx-form-item\");\n\n      if (item && item.column && this._columnsController.getVisibleIndex(item.column.index) === visibleColumnIndex) {\n        return $itemContent;\n      }\n    }\n  },\n  toggleExpandAdaptiveDetailRow: function toggleExpandAdaptiveDetailRow(key, alwaysExpanded) {\n    if (!(this.isFormEditMode() && this._editingController.isEditing())) {\n      this.getController(\"data\").toggleExpandAdaptiveDetailRow(key, alwaysExpanded);\n    }\n  },\n  createFormByHiddenColumns: function createFormByHiddenColumns(container, options) {\n    var that = this;\n    var $container = (0, _renderer2.default)(container);\n    var userFormOptions = {\n      items: that._getFormItemsByHiddenColumns(that._hiddenColumns),\n      formID: \"dx-\" + new _guid2.default()\n    };\n    var defaultFormOptions = _themes2.default.isMaterial() ? {\n      colCount: 2\n    } : {};\n    this.executeAction(\"onAdaptiveDetailRowPreparing\", {\n      formOptions: userFormOptions\n    });\n    that._$itemContents = null;\n    that._form = that._createComponent((0, _renderer2.default)(\"<div>\").appendTo($container), _form2.default, (0, _extend.extend)(defaultFormOptions, userFormOptions, {\n      customizeItem: function customizeItem(item) {\n        var column = item.column || that._columnsController.columnOption(item.name || item.dataField);\n\n        if (column) {\n          item.label = item.label || {};\n          item.label.text = item.label.text || column.caption;\n          item.column = column;\n          item.template = that._getTemplate(item, options, that.updateForm.bind(that));\n        }\n\n        userFormOptions.customizeItem && userFormOptions.customizeItem.call(this, item);\n      },\n      onContentReady: function onContentReady(e) {\n        userFormOptions.onContentReady && userFormOptions.onContentReady.call(this, e);\n        that._$itemContents = $container.find(\".\" + FORM_ITEM_CONTENT_CLASS);\n      }\n    }));\n  },\n  hasAdaptiveDetailRowExpanded: function hasAdaptiveDetailRowExpanded() {\n    return _type2.default.isDefined(this._dataController.adaptiveExpandedKey());\n  },\n  updateForm: function updateForm(hiddenColumns) {\n    if (this.hasAdaptiveDetailRowExpanded()) {\n      if (this._form && _type2.default.isDefined(this._form._contentReadyAction)) {\n        if (hiddenColumns && hiddenColumns.length) {\n          this._form.option(\"items\", this._getFormItemsByHiddenColumns(hiddenColumns));\n        } else {\n          this._form.repaint();\n        }\n      }\n    }\n  },\n  updateHidingQueue: function updateHidingQueue(columns) {\n    var that = this;\n    var hideableColumns = columns.filter(function (column) {\n      return column.visible && !column.type && !column.fixed && !(_type2.default.isDefined(column.groupIndex) && column.groupIndex >= 0);\n    });\n    var columnsHasHidingPriority;\n    var i;\n    that._hidingColumnsQueue = [];\n\n    if (that.option(\"allowColumnResizing\") && \"widget\" === that.option(\"columnResizingMode\")) {\n      return that._hidingColumnsQueue;\n    }\n\n    for (i = 0; i < hideableColumns.length; i++) {\n      if (_type2.default.isDefined(hideableColumns[i].hidingPriority) && hideableColumns[i].hidingPriority >= 0) {\n        columnsHasHidingPriority = true;\n        that._hidingColumnsQueue[hideableColumns[i].hidingPriority] = hideableColumns[i];\n      }\n    }\n\n    if (columnsHasHidingPriority) {\n      that._hidingColumnsQueue.reverse();\n    } else {\n      if (that.option(\"columnHidingEnabled\")) {\n        for (i = 0; i < hideableColumns.length; i++) {\n          var visibleIndex = that._columnsController.getVisibleIndex(hideableColumns[i].index);\n\n          that._hidingColumnsQueue[visibleIndex] = hideableColumns[i];\n        }\n      }\n    }\n\n    that._hidingColumnsQueue = that._hidingColumnsQueue.filter(Object);\n    return that._hidingColumnsQueue;\n  },\n  getHiddenColumns: function getHiddenColumns() {\n    return this._hiddenColumns;\n  },\n  hasHiddenColumns: function hasHiddenColumns() {\n    return this._hiddenColumns.length > 0;\n  },\n  getHidingColumnsQueue: function getHidingColumnsQueue() {\n    return this._hidingColumnsQueue;\n  },\n  init: function init() {\n    var that = this;\n    that._columnsController = that.getController(\"columns\");\n    that._dataController = that.getController(\"data\");\n    that._rowsView = that.getView(\"rowsView\");\n\n    that._columnsController.addCommandColumn({\n      type: ADAPTIVE_COLUMN_NAME,\n      command: ADAPTIVE_COLUMN_NAME,\n      visible: true,\n      adaptiveHidden: true,\n      cssClass: ADAPTIVE_COLUMN_NAME_CLASS,\n      alignment: \"center\",\n      width: \"auto\",\n      cellTemplate: adaptiveCellTemplate,\n      fixedPosition: \"right\"\n    });\n\n    that._columnsController.columnsChanged.add(function () {\n      var isAdaptiveVisible = !!that.updateHidingQueue(that._columnsController.getColumns()).length;\n\n      that._columnsController.columnOption(\"command:adaptive\", \"adaptiveHidden\", !isAdaptiveVisible, true);\n    });\n\n    that._editingController = that.getController(\"editing\");\n    that._hidingColumnsQueue = [];\n    that._hiddenColumns = [];\n    that.createAction(\"onAdaptiveDetailRowPreparing\");\n    that.callBase();\n  },\n  optionChanged: function optionChanged(args) {\n    if (\"columnHidingEnabled\" === args.name) {\n      this._columnsController.columnOption(\"command:adaptive\", \"adaptiveHidden\", !args.value);\n    }\n\n    this.callBase(args);\n  },\n  publicMethods: function publicMethods() {\n    return [\"isAdaptiveDetailRowExpanded\", \"expandAdaptiveDetailRow\", \"collapseAdaptiveDetailRow\"];\n  },\n  isAdaptiveDetailRowExpanded: function isAdaptiveDetailRowExpanded(key) {\n    return this._dataController.adaptiveExpandedKey() && (0, _common.equalByValue)(this._dataController.adaptiveExpandedKey(), key);\n  },\n  expandAdaptiveDetailRow: function expandAdaptiveDetailRow(key) {\n    if (!this.hasAdaptiveDetailRowExpanded()) {\n      this.toggleExpandAdaptiveDetailRow(key);\n    }\n  },\n  collapseAdaptiveDetailRow: function collapseAdaptiveDetailRow() {\n    if (this.hasAdaptiveDetailRowExpanded()) {\n      this.toggleExpandAdaptiveDetailRow();\n    }\n  }\n});\n\nmodule.exports = {\n  defaultOptions: function defaultOptions() {\n    return {\n      columnHidingEnabled: false,\n      onAdaptiveDetailRowPreparing: null\n    };\n  },\n  controllers: {\n    adaptiveColumns: AdaptiveColumnsController\n  },\n  extenders: {\n    views: {\n      rowsView: {\n        _getCellTemplate: function _getCellTemplate(options) {\n          var that = this;\n          var column = options.column;\n\n          if (options.rowType === ADAPTIVE_ROW_TYPE && \"detail\" === column.command) {\n            return function (container, options) {\n              that._adaptiveColumnsController.createFormByHiddenColumns((0, _renderer2.default)(container), options);\n            };\n          }\n\n          return that.callBase(options);\n        },\n        _createRow: function _createRow(row) {\n          var $row = this.callBase(row);\n\n          if (row && row.rowType === ADAPTIVE_ROW_TYPE && row.key === this._dataController.adaptiveExpandedKey()) {\n            $row.addClass(ADAPTIVE_DETAIL_ROW_CLASS);\n          }\n\n          return $row;\n        },\n        _renderCells: function _renderCells($row, options) {\n          this.callBase($row, options);\n\n          var hidingColumnsQueueLength = this._adaptiveColumnsController.getHidingColumnsQueue().length;\n\n          var hiddenColumnsLength = this._adaptiveColumnsController.getHiddenColumns().length;\n\n          if (hidingColumnsQueueLength && !hiddenColumnsLength) {\n            getDataCellElements($row).last().addClass(LAST_DATA_CELL_CLASS);\n          }\n        },\n        _getColumnIndexByElementCore: function _getColumnIndexByElementCore($element) {\n          var $itemContent = $element.closest(\".\" + FORM_ITEM_CONTENT_CLASS);\n\n          if ($itemContent.length && $itemContent.closest(this.component.$element()).length) {\n            var formItem = $itemContent.length ? $itemContent.first().data(\"dx-form-item\") : null;\n            return formItem && formItem.column && this._columnsController.getVisibleIndex(formItem.column.index);\n          } else {\n            return this.callBase($element);\n          }\n        },\n        _cellPrepared: function _cellPrepared($cell, options) {\n          this.callBase.apply(this, arguments);\n\n          if (options.row.rowType !== ADAPTIVE_ROW_TYPE && options.column.visibleWidth === HIDDEN_COLUMNS_WIDTH) {\n            $cell.addClass(this.addWidgetPrefix(HIDDEN_COLUMN_CLASS));\n          }\n        },\n        _getCellElement: function _getCellElement(rowIndex, columnIdentifier) {\n          var item = this._dataController.items()[rowIndex];\n\n          if (item && item.rowType === ADAPTIVE_ROW_TYPE) {\n            return this._adaptiveColumnsController.getItemContentByColumnIndex(columnIdentifier);\n          } else {\n            return this.callBase(rowIndex, columnIdentifier);\n          }\n        },\n        getContextMenuItems: function getContextMenuItems(options) {\n          if (options.row && \"detailAdaptive\" === options.row.rowType) {\n            var view = this.component.getView(\"columnHeadersView\");\n            var formItem = (0, _renderer2.default)(options.targetElement).closest(\".dx-field-item-label\").next().data(\"dx-form-item\");\n            options.column = formItem ? formItem.column : options.column;\n            return view.getContextMenuItems && view.getContextMenuItems(options);\n          }\n\n          return this.callBase && this.callBase(options);\n        },\n        isClickableElement: function isClickableElement($target) {\n          var isClickable = this.callBase ? this.callBase($target) : false;\n          return isClickable || !!$target.closest(\".\" + ADAPTIVE_COLUMN_NAME_CLASS).length;\n        },\n        init: function init() {\n          this.callBase();\n          this._adaptiveColumnsController = this.getController(\"adaptiveColumns\");\n        }\n      }\n    },\n    controllers: {\n      \"export\": {\n        _updateColumnWidth: function _updateColumnWidth(column, width) {\n          this.callBase(column, column.visibleWidth === HIDDEN_COLUMNS_WIDTH ? column.bestFitWidth : width);\n        }\n      },\n      columnsResizer: {\n        _pointCreated: function _pointCreated(point, cellsLength, columns) {\n          var result = this.callBase(point, cellsLength, columns);\n          var currentColumn = columns[point.columnIndex] || {};\n\n          var nextColumnIndex = this._getNextColumnIndex(point.columnIndex);\n\n          var nextColumn = columns[nextColumnIndex] || {};\n          var hasHiddenColumnsOnly = nextColumnIndex !== point.columnIndex + 1 && nextColumn.command;\n          var hasAdaptiveHiddenWidth = currentColumn.visibleWidth === HIDDEN_COLUMNS_WIDTH || hasHiddenColumnsOnly;\n          return result || hasAdaptiveHiddenWidth;\n        },\n        _getNextColumnIndex: function _getNextColumnIndex(currentColumnIndex) {\n          var visibleColumns = this._columnsController.getVisibleColumns();\n\n          var index = this.callBase(currentColumnIndex);\n\n          while (visibleColumns[index] && visibleColumns[index].visibleWidth === HIDDEN_COLUMNS_WIDTH) {\n            index++;\n          }\n\n          return index;\n        }\n      },\n      draggingHeader: {\n        _pointCreated: function _pointCreated(point, columns, location, sourceColumn) {\n          var result = this.callBase(point, columns, location, sourceColumn);\n          var column = columns[point.columnIndex - 1] || {};\n          var hasAdaptiveHiddenWidth = column.visibleWidth === HIDDEN_COLUMNS_WIDTH;\n          return result || hasAdaptiveHiddenWidth;\n        }\n      },\n      editing: {\n        _isRowEditMode: function _isRowEditMode() {\n          return this.getEditMode() === EDIT_MODE_ROW;\n        },\n        _getFormEditItemTemplate: function _getFormEditItemTemplate(cellOptions, column) {\n          if (this.getEditMode() !== EDIT_MODE_ROW && \"detailAdaptive\" === cellOptions.rowType) {\n            cellOptions.columnIndex = this._columnsController.getVisibleIndex(column.index);\n            return this.getColumnTemplate(cellOptions);\n          }\n\n          return this.callBase(cellOptions, column);\n        },\n        _closeEditItem: function _closeEditItem($targetElement) {\n          var $itemContents = $targetElement.closest(\".\" + FORM_ITEM_CONTENT_CLASS);\n          var rowIndex = this._dataController.getRowIndexByKey(this._dataController.adaptiveExpandedKey()) + 1;\n          var formItem = $itemContents.length ? $itemContents.first().data(\"dx-form-item\") : null;\n\n          var columnIndex = formItem && formItem.column && this._columnsController.getVisibleIndex(formItem.column.index);\n\n          if (!this.isEditCell(rowIndex, columnIndex)) {\n            this.callBase($targetElement);\n          }\n        },\n        _beforeUpdateItems: function _beforeUpdateItems(rowIndices, rowIndex) {\n          if (!this._adaptiveController.isFormEditMode() && this._adaptiveController.hasHiddenColumns()) {\n            var items = this._dataController.items();\n\n            var item = items[rowIndex];\n\n            var oldExpandRowIndex = _uiGrid_core4.default.getIndexByKey(this._dataController.adaptiveExpandedKey(), items);\n\n            this._isForceRowAdaptiveExpand = !this._adaptiveController.hasAdaptiveDetailRowExpanded();\n\n            if (oldExpandRowIndex >= 0 && rowIndex > oldExpandRowIndex) {\n              this._editRowIndex--;\n            }\n\n            if (oldExpandRowIndex >= 0) {\n              rowIndices.push(oldExpandRowIndex + 1);\n            }\n\n            rowIndices.push(rowIndex + 1);\n\n            this._dataController.adaptiveExpandedKey(item.key);\n          }\n        },\n        _afterInsertRow: function _afterInsertRow(options) {\n          this.callBase(options);\n\n          if (this._adaptiveController.hasHiddenColumns()) {\n            this._adaptiveController.toggleExpandAdaptiveDetailRow(options.key, this.isRowEditMode());\n\n            this._isForceRowAdaptiveExpand = true;\n          }\n        },\n        _collapseAdaptiveDetailRow: function _collapseAdaptiveDetailRow() {\n          if (this._isRowEditMode() && this._isForceRowAdaptiveExpand) {\n            this._adaptiveController.collapseAdaptiveDetailRow();\n\n            this._isForceRowAdaptiveExpand = false;\n          }\n        },\n        _cancelEditAdaptiveDetailRow: function _cancelEditAdaptiveDetailRow() {\n          if (this._adaptiveController.hasHiddenColumns()) {\n            this._collapseAdaptiveDetailRow();\n          }\n        },\n        _afterSaveEditData: function _afterSaveEditData() {\n          var _this2 = this;\n\n          this.callBase();\n          var deferred = new _deferred.Deferred();\n\n          if (this._isRowEditMode() && this._adaptiveController.hasHiddenColumns()) {\n            (0, _deferred.when)(this.getController(\"validating\").validate(true)).done(function (isValid) {\n              if (isValid) {\n                _this2._cancelEditAdaptiveDetailRow();\n              }\n\n              deferred.resolve();\n            });\n          } else {\n            deferred.resolve();\n          }\n\n          return deferred.promise();\n        },\n        _beforeCancelEditData: function _beforeCancelEditData() {\n          this.callBase();\n\n          this._cancelEditAdaptiveDetailRow();\n        },\n        _getRowIndicesForCascadeUpdating: function _getRowIndicesForCascadeUpdating(row) {\n          var rowIndices = this.callBase.apply(this, arguments);\n\n          if (this._adaptiveController.isAdaptiveDetailRowExpanded(row.key)) {\n            rowIndices.push(row.rowType === ADAPTIVE_ROW_TYPE ? row.rowIndex - 1 : row.rowIndex + 1);\n          }\n\n          return rowIndices;\n        },\n        _beforeCloseEditCellInBatchMode: function _beforeCloseEditCellInBatchMode(rowIndices) {\n          var expandedKey = this._dataController._adaptiveExpandedKey;\n          var rowIndex;\n\n          if (expandedKey) {\n            rowIndex = _uiGrid_core4.default.getIndexByKey(expandedKey, this._dataController.items());\n\n            if (rowIndex > -1) {\n              rowIndices.unshift(rowIndex);\n            }\n          }\n        },\n        editRow: function editRow(rowIndex) {\n          if (this._adaptiveController.isFormEditMode()) {\n            this._adaptiveController.collapseAdaptiveDetailRow();\n          }\n\n          this.callBase(rowIndex);\n        },\n        deleteRow: function deleteRow(rowIndex) {\n          var rowKey = this._dataController.getKeyByRowIndex(rowIndex);\n\n          if (this.getEditMode() === EDIT_MODE_BATCH && this._adaptiveController.isAdaptiveDetailRowExpanded(rowKey)) {\n            this._adaptiveController.collapseAdaptiveDetailRow();\n          }\n\n          this.callBase(rowIndex);\n        },\n        init: function init() {\n          this.callBase();\n          this._adaptiveController = this.getController(\"adaptiveColumns\");\n        }\n      },\n      resizing: {\n        _needBestFit: function _needBestFit() {\n          return this.callBase() || !!this._adaptiveColumnsController.getHidingColumnsQueue().length;\n        },\n        _updateScrollableForIE: function _updateScrollableForIE() {\n          var that = this;\n\n          if (_browser2.default.msie && parseInt(_browser2.default.version) <= 11) {\n            this._updateScrollableTimeoutID = setTimeout(function () {\n              that.getView(\"rowsView\")._updateScrollable();\n            });\n          }\n        },\n        _correctColumnWidths: function _correctColumnWidths(resultWidths, visibleColumns) {\n          var adaptiveController = this._adaptiveColumnsController;\n          var columnAutoWidth = this.option(\"columnAutoWidth\");\n          var oldHiddenColumns = adaptiveController.getHiddenColumns();\n          var hiddenColumns;\n          var hidingColumnsQueue = adaptiveController.updateHidingQueue(this._columnsController.getColumns());\n          adaptiveController.hideRedundantColumns(resultWidths, visibleColumns, hidingColumnsQueue);\n          hiddenColumns = adaptiveController.getHiddenColumns();\n\n          if (adaptiveController.hasAdaptiveDetailRowExpanded()) {\n            if (oldHiddenColumns.length !== hiddenColumns.length) {\n              adaptiveController.updateForm(hiddenColumns);\n            }\n          }\n\n          !hiddenColumns.length && adaptiveController.collapseAdaptiveDetailRow();\n\n          if (columnAutoWidth && hidingColumnsQueue.length && !hiddenColumns.length) {\n            this._updateScrollableForIE();\n          }\n\n          return this.callBase.apply(this, arguments);\n        },\n        _toggleBestFitMode: function _toggleBestFitMode(isBestFit) {\n          isBestFit && this._adaptiveColumnsController._removeCssClassesFromColumns();\n          this.callBase(isBestFit);\n        },\n        _needStretch: function _needStretch() {\n          var adaptiveColumnsController = this._adaptiveColumnsController;\n          return this.callBase.apply(this, arguments) || adaptiveColumnsController.getHidingColumnsQueue().length || adaptiveColumnsController.hasHiddenColumns();\n        },\n        init: function init() {\n          this._adaptiveColumnsController = this.getController(\"adaptiveColumns\");\n          this.callBase();\n        },\n        dispose: function dispose() {\n          this.callBase.apply(this, arguments);\n          clearTimeout(this._updateScrollableTimeoutID);\n        }\n      },\n      data: {\n        _processItems: function _processItems(items, change) {\n          var that = this;\n          var item;\n          var expandRowIndex;\n          var changeType = change.changeType;\n          items = that.callBase.apply(that, arguments);\n\n          if (\"loadingAll\" === changeType || !_type2.default.isDefined(that._adaptiveExpandedKey)) {\n            return items;\n          }\n\n          expandRowIndex = _uiGrid_core4.default.getIndexByKey(that._adaptiveExpandedKey, items);\n\n          if (expandRowIndex >= 0) {\n            item = items[expandRowIndex];\n            items.splice(expandRowIndex + 1, 0, {\n              visible: true,\n              rowType: ADAPTIVE_ROW_TYPE,\n              key: item.key,\n              data: item.data,\n              modifiedValues: item.modifiedValues,\n              isNewRow: item.isNewRow,\n              values: item.values\n            });\n          } else {\n            if (\"refresh\" === changeType) {\n              that._adaptiveExpandedKey = void 0;\n            }\n          }\n\n          return items;\n        },\n        _getRowIndicesForExpand: function _getRowIndicesForExpand(key) {\n          var rowIndices = this.callBase.apply(this, arguments);\n          var lastRowIndex;\n\n          if (this.getController(\"adaptiveColumns\").isAdaptiveDetailRowExpanded(key)) {\n            lastRowIndex = rowIndices[rowIndices.length - 1];\n            rowIndices.push(lastRowIndex + 1);\n          }\n\n          return rowIndices;\n        },\n        adaptiveExpandedKey: function adaptiveExpandedKey(value) {\n          if (_type2.default.isDefined(value)) {\n            this._adaptiveExpandedKey = value;\n          } else {\n            return this._adaptiveExpandedKey;\n          }\n        },\n        toggleExpandAdaptiveDetailRow: function toggleExpandAdaptiveDetailRow(key, alwaysExpanded) {\n          var that = this;\n\n          var oldExpandLoadedRowIndex = _uiGrid_core4.default.getIndexByKey(that._adaptiveExpandedKey, that._items);\n\n          var newExpandLoadedRowIndex = _uiGrid_core4.default.getIndexByKey(key, that._items);\n\n          if (oldExpandLoadedRowIndex >= 0 && oldExpandLoadedRowIndex === newExpandLoadedRowIndex && !alwaysExpanded) {\n            key = void 0;\n            newExpandLoadedRowIndex = -1;\n          }\n\n          that._adaptiveExpandedKey = key;\n\n          if (oldExpandLoadedRowIndex >= 0) {\n            oldExpandLoadedRowIndex++;\n          }\n\n          if (newExpandLoadedRowIndex >= 0) {\n            newExpandLoadedRowIndex++;\n          }\n\n          var rowIndexDelta = that.getRowIndexDelta();\n          that.updateItems({\n            allowInvisibleRowIndices: true,\n            changeType: \"update\",\n            rowIndices: [oldExpandLoadedRowIndex - rowIndexDelta, newExpandLoadedRowIndex - rowIndexDelta]\n          });\n        },\n        init: function init() {\n          this.callBase();\n          this._adaptiveExpandedKey = void 0;\n        }\n      },\n      editorFactory: {\n        _getFocusCellSelector: function _getFocusCellSelector() {\n          return this.callBase() + \", .dx-adaptive-detail-row .dx-field-item > .dx-field-item-content\";\n        },\n        _getTooltipsSelector: function _getTooltipsSelector() {\n          return this.callBase() + \", .dx-field-item-content .\" + this.addWidgetPrefix(REVERT_TOOLTIP_CLASS);\n        }\n      },\n      columns: {\n        _isColumnVisible: function _isColumnVisible(column) {\n          return this.callBase(column) && !column.adaptiveHidden;\n        }\n      },\n      keyboardNavigation: {\n        _isCellValid: function _isCellValid($cell) {\n          return this.callBase.apply(this, arguments) && !$cell.hasClass(this.addWidgetPrefix(HIDDEN_COLUMN_CLASS));\n        },\n        _processNextCellInMasterDetail: function _processNextCellInMasterDetail($nextCell) {\n          this.callBase($nextCell);\n\n          var isCellOrBatchMode = this._editingController.isCellOrBatchEditMode();\n\n          if (!this._isInsideEditForm($nextCell) && $nextCell && isCellOrBatchMode) {\n            var focusHandler = function focusHandler() {\n              _events_engine2.default.off($nextCell, \"focus\", focusHandler);\n\n              _events_engine2.default.trigger($nextCell, \"dxclick\");\n            };\n\n            _events_engine2.default.on($nextCell, \"focus\", focusHandler);\n          }\n        },\n        _handleTabKeyOnMasterDetailCell: function _handleTabKeyOnMasterDetailCell(eventTarget, direction) {\n          var result = this.callBase(eventTarget, direction);\n\n          var $currentCell = this._getFocusedCell();\n\n          var $row = $currentCell && $currentCell.parent();\n\n          if (!result && $row && $row.length) {\n            var $dataCells = getDataCellElements($row);\n            var $targetCell = \"next\" === direction ? $dataCells.last() : $dataCells.first();\n            var rowIndex = $row.get(0).rowIndex;\n            var adaptiveController = this._adaptiveController;\n\n            var key = this._dataController.getKeyByRowIndex(\"next\" === direction ? rowIndex : rowIndex - 1);\n\n            var isCellElementsEquals = $currentCell && $targetCell && $currentCell.get(0) === $targetCell.get(0);\n            return adaptiveController.isAdaptiveDetailRowExpanded(key) && isCellElementsEquals;\n          }\n\n          return result;\n        },\n        init: function init() {\n          this.callBase();\n          this._adaptiveController = this.getController(\"adaptiveColumns\");\n        }\n      }\n    }\n  }\n};","map":{"version":3,"sources":["C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/devextreme/ui/grid_core/ui.grid_core.adaptivity.js"],"names":["_renderer","require","_renderer2","_interopRequireDefault","_events_engine","_events_engine2","_utils","_utils2","_click","_click2","_type","_type2","_browser","_browser2","_guid","_guid2","_uiGrid_core","_uiGrid_core2","_form","_form2","_uiGrid_core3","_uiGrid_core4","_themes","_themes2","_window","_common","_iterator","_extend","_deferred","obj","__esModule","COLUMN_HEADERS_VIEW","ROWS_VIEW","FOOTER_VIEW","COLUMN_VIEWS","ADAPTIVE_NAMESPACE","HIDDEN_COLUMNS_WIDTH","ADAPTIVE_ROW_TYPE","FORM_ITEM_CONTENT_CLASS","FORM_ITEM_MODIFIED","HIDDEN_COLUMN_CLASS","ADAPTIVE_COLUMN_BUTTON_CLASS","ADAPTIVE_COLUMN_NAME_CLASS","COMMAND_ADAPTIVE_HIDDEN_CLASS","ADAPTIVE_DETAIL_ROW_CLASS","ADAPTIVE_ITEM_TEXT_CLASS","MASTER_DETAIL_CELL_CLASS","LAST_DATA_CELL_CLASS","ADAPTIVE_COLUMN_NAME","EDIT_MODE_BATCH","EDIT_MODE_ROW","EDIT_MODE_FORM","EDIT_MODE_POPUP","REVERT_TOOLTIP_CLASS","getColumnId","that","column","_columnsController","getDataCellElements","$row","find","adaptiveCellTemplate","container","options","$adaptiveColumnButton","$container","default","adaptiveColumnsController","component","getController","rowType","addClass","addWidgetPrefix","on","addNamespace","name","createAction","toggleExpandAdaptiveDetailRow","key","appendTo","setEmptyText","AdaptiveColumnsController","ViewController","inherit","_isRowEditMode","editMode","_getEditMode","_isItemModified","item","cellOptions","columnIndex","getVisibleIndex","index","rowIndex","_dataController","getRowIndexByKey","row","items","modifiedValues","isDefined","_renderFormViewTemplate","focusAction","trigger","value","calculateCellValue","data","displayValue","getDisplayValue","text","formatValue","isCellOrBatchEditMode","_editingController","allowEditing","isKeyboardEnabled","attr","option","off","cellTemplate","templateOptions","extend","_rowsView","renderTemplate","closest","getWindow","document","length","get","encodeHtml","textContent","innerHTML","html","getView","_cellPrepared","_getTemplate","editingController","visibleIndex","renderFormTemplate","isItemEdited","_isItemEdited","values","showEditorAlways","renderFormEditTemplate","watch","contents","remove","removeClass","_isVisibleColumnsValid","visibleColumns","getCommandColumnsCount","result","j","visibleColumn","command","_calculatePercentWidths","widths","percentWidths","forEach","_getItemPercentWidth","_isPercentWidth","width","isString","slice","_isColumnHidden","_hiddenColumns","filter","hiddenColumn","_getAverageColumnsWidth","containerWidth","columns","columnsCanFit","fixedColumnsWidth","columnsWithoutFixedWidthCount","isNaN","parseFloat","_calculatePercentWidth","columnsCount","bestFitWidth","columnWidth","_calculateColumnWidth","contentColumns","columnId","widthOption","columnOption","colWidth","columnAutoWidth","columnFitted","partialWidth","resultWidth","_getNotTruncatedColumnWidth","_getCommandColumnsWidth","getVisibleColumns","each","isFormEditMode","editRowKey","getEditRowKey","equalByValue","adaptiveExpandedKey","isEditCell","_getFormItemsByHiddenColumns","hiddenColumns","_","push","dataField","_getAdaptiveColumnVisibleIndex","i","_hideAdaptiveColumn","resultWidths","_addCssClassToColumn","_removeCssClassFromColumn","cssClassName","view","$cells","isVisible","element","_removeCssClassesFromColumns","_isCellValid","$cell","hasClass","viewName","_addCssClassToViewColumn","rowsCount","$cellElement","currentVisibleIndex","editFormRowIndex","getEditFormRowIndex","getRowsCount","$rowElements","_getRowElements","eq","children","getEditMode","hideRedundantColumns","hiddenQueue","totalWidth","$rootElement","$element","rootElementWidth","getVisibleContentColumns","_this","bind","visibleContentColumns","contentColumnsCount","hasHiddenColumns","needHideColumn","minWidth","columnBestFitWidth","fixed","Math","max","pop","getItemContentByColumnIndex","visibleColumnIndex","$itemContent","_$itemContents","alwaysExpanded","isEditing","createFormByHiddenColumns","userFormOptions","formID","defaultFormOptions","isMaterial","colCount","executeAction","formOptions","_createComponent","customizeItem","label","caption","template","updateForm","call","onContentReady","e","hasAdaptiveDetailRowExpanded","_contentReadyAction","repaint","updateHidingQueue","hideableColumns","visible","type","groupIndex","columnsHasHidingPriority","_hidingColumnsQueue","hidingPriority","reverse","Object","getHiddenColumns","getHidingColumnsQueue","init","addCommandColumn","adaptiveHidden","cssClass","alignment","fixedPosition","columnsChanged","add","isAdaptiveVisible","getColumns","callBase","optionChanged","args","publicMethods","isAdaptiveDetailRowExpanded","expandAdaptiveDetailRow","collapseAdaptiveDetailRow","module","exports","defaultOptions","columnHidingEnabled","onAdaptiveDetailRowPreparing","controllers","adaptiveColumns","extenders","views","rowsView","_getCellTemplate","_adaptiveColumnsController","_createRow","_renderCells","hidingColumnsQueueLength","hiddenColumnsLength","last","_getColumnIndexByElementCore","formItem","first","apply","arguments","visibleWidth","_getCellElement","columnIdentifier","getContextMenuItems","targetElement","next","isClickableElement","$target","isClickable","_updateColumnWidth","columnsResizer","_pointCreated","point","cellsLength","currentColumn","nextColumnIndex","_getNextColumnIndex","nextColumn","hasHiddenColumnsOnly","hasAdaptiveHiddenWidth","currentColumnIndex","draggingHeader","location","sourceColumn","editing","_getFormEditItemTemplate","getColumnTemplate","_closeEditItem","$targetElement","$itemContents","_beforeUpdateItems","rowIndices","_adaptiveController","oldExpandRowIndex","getIndexByKey","_isForceRowAdaptiveExpand","_editRowIndex","_afterInsertRow","isRowEditMode","_collapseAdaptiveDetailRow","_cancelEditAdaptiveDetailRow","_afterSaveEditData","_this2","deferred","Deferred","when","validate","done","isValid","resolve","promise","_beforeCancelEditData","_getRowIndicesForCascadeUpdating","_beforeCloseEditCellInBatchMode","expandedKey","_adaptiveExpandedKey","unshift","editRow","deleteRow","rowKey","getKeyByRowIndex","resizing","_needBestFit","_updateScrollableForIE","msie","parseInt","version","_updateScrollableTimeoutID","setTimeout","_updateScrollable","_correctColumnWidths","adaptiveController","oldHiddenColumns","hidingColumnsQueue","_toggleBestFitMode","isBestFit","_needStretch","dispose","clearTimeout","_processItems","change","expandRowIndex","changeType","splice","isNewRow","_getRowIndicesForExpand","lastRowIndex","oldExpandLoadedRowIndex","_items","newExpandLoadedRowIndex","rowIndexDelta","getRowIndexDelta","updateItems","allowInvisibleRowIndices","editorFactory","_getFocusCellSelector","_getTooltipsSelector","_isColumnVisible","keyboardNavigation","_processNextCellInMasterDetail","$nextCell","isCellOrBatchMode","_isInsideEditForm","focusHandler","_handleTabKeyOnMasterDetailCell","eventTarget","direction","$currentCell","_getFocusedCell","parent","$dataCells","$targetCell","isCellElementsEquals"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/grid_core/ui.grid_core.adaptivity.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar _renderer = require(\"../../core/renderer\");\r\nvar _renderer2 = _interopRequireDefault(_renderer);\r\nvar _events_engine = require(\"../../events/core/events_engine\");\r\nvar _events_engine2 = _interopRequireDefault(_events_engine);\r\nvar _utils = require(\"../../events/utils\");\r\nvar _utils2 = _interopRequireDefault(_utils);\r\nvar _click = require(\"../../events/click\");\r\nvar _click2 = _interopRequireDefault(_click);\r\nvar _type = require(\"../../core/utils/type\");\r\nvar _type2 = _interopRequireDefault(_type);\r\nvar _browser = require(\"../../core/utils/browser\");\r\nvar _browser2 = _interopRequireDefault(_browser);\r\nvar _guid = require(\"../../core/guid\");\r\nvar _guid2 = _interopRequireDefault(_guid);\r\nvar _uiGrid_core = require(\"./ui.grid_core.modules\");\r\nvar _uiGrid_core2 = _interopRequireDefault(_uiGrid_core);\r\nvar _form = require(\"../form\");\r\nvar _form2 = _interopRequireDefault(_form);\r\nvar _uiGrid_core3 = require(\"./ui.grid_core.utils\");\r\nvar _uiGrid_core4 = _interopRequireDefault(_uiGrid_core3);\r\nvar _themes = require(\"../themes\");\r\nvar _themes2 = _interopRequireDefault(_themes);\r\nvar _window = require(\"../../core/utils/window\");\r\nvar _common = require(\"../../core/utils/common\");\r\nvar _iterator = require(\"../../core/utils/iterator\");\r\nvar _extend = require(\"../../core/utils/extend\");\r\nvar _deferred = require(\"../../core/utils/deferred\");\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\nvar COLUMN_HEADERS_VIEW = \"columnHeadersView\";\r\nvar ROWS_VIEW = \"rowsView\";\r\nvar FOOTER_VIEW = \"footerView\";\r\nvar COLUMN_VIEWS = [COLUMN_HEADERS_VIEW, ROWS_VIEW, FOOTER_VIEW];\r\nvar ADAPTIVE_NAMESPACE = \"dxDataGridAdaptivity\";\r\nvar HIDDEN_COLUMNS_WIDTH = \"adaptiveHidden\";\r\nvar ADAPTIVE_ROW_TYPE = \"detailAdaptive\";\r\nvar FORM_ITEM_CONTENT_CLASS = \"dx-field-item-content\";\r\nvar FORM_ITEM_MODIFIED = \"dx-item-modified\";\r\nvar HIDDEN_COLUMN_CLASS = \"hidden-column\";\r\nvar ADAPTIVE_COLUMN_BUTTON_CLASS = \"adaptive-more\";\r\nvar ADAPTIVE_COLUMN_NAME_CLASS = \"dx-command-adaptive\";\r\nvar COMMAND_ADAPTIVE_HIDDEN_CLASS = \"dx-command-adaptive-hidden\";\r\nvar ADAPTIVE_DETAIL_ROW_CLASS = \"dx-adaptive-detail-row\";\r\nvar ADAPTIVE_ITEM_TEXT_CLASS = \"dx-adaptive-item-text\";\r\nvar MASTER_DETAIL_CELL_CLASS = \"dx-master-detail-cell\";\r\nvar LAST_DATA_CELL_CLASS = \"dx-last-data-cell\";\r\nvar ADAPTIVE_COLUMN_NAME = \"adaptive\";\r\nvar EDIT_MODE_BATCH = \"batch\";\r\nvar EDIT_MODE_ROW = \"row\";\r\nvar EDIT_MODE_FORM = \"form\";\r\nvar EDIT_MODE_POPUP = \"popup\";\r\nvar REVERT_TOOLTIP_CLASS = \"revert-tooltip\";\r\n\r\nfunction getColumnId(that, column) {\r\n    return that._columnsController.getColumnId(column)\r\n}\r\n\r\nfunction getDataCellElements($row) {\r\n    return $row.find(\"td:not(.dx-datagrid-hidden-column):not([class*='dx-command-'])\")\r\n}\r\n\r\nfunction adaptiveCellTemplate(container, options) {\r\n    var $adaptiveColumnButton;\r\n    var $container = (0, _renderer2.default)(container);\r\n    var adaptiveColumnsController = options.component.getController(\"adaptiveColumns\");\r\n    if (\"data\" === options.rowType) {\r\n        $adaptiveColumnButton = (0, _renderer2.default)(\"<span>\").addClass(adaptiveColumnsController.addWidgetPrefix(ADAPTIVE_COLUMN_BUTTON_CLASS));\r\n        _events_engine2.default.on($adaptiveColumnButton, _utils2.default.addNamespace(_click2.default.name, ADAPTIVE_NAMESPACE), adaptiveColumnsController.createAction(function() {\r\n            adaptiveColumnsController.toggleExpandAdaptiveDetailRow(options.key)\r\n        }));\r\n        $adaptiveColumnButton.appendTo($container)\r\n    } else {\r\n        _uiGrid_core4.default.setEmptyText($container)\r\n    }\r\n}\r\nvar AdaptiveColumnsController = _uiGrid_core2.default.ViewController.inherit({\r\n    _isRowEditMode: function() {\r\n        var editMode = this._getEditMode();\r\n        return editMode === EDIT_MODE_ROW\r\n    },\r\n    _isItemModified: function(item, cellOptions) {\r\n        var columnIndex = this._columnsController.getVisibleIndex(item.column.index);\r\n        var rowIndex = this._dataController.getRowIndexByKey(cellOptions.key);\r\n        var row = this._dataController.items()[rowIndex + 1];\r\n        return row && row.modifiedValues && _type2.default.isDefined(row.modifiedValues[columnIndex])\r\n    },\r\n    _renderFormViewTemplate: function(item, cellOptions, $container) {\r\n        var that = this;\r\n        var column = item.column;\r\n        var focusAction = that.createAction(function() {\r\n            _events_engine2.default.trigger($container, _click2.default.name)\r\n        });\r\n        var container;\r\n        var value = column.calculateCellValue(cellOptions.data);\r\n        var displayValue = _uiGrid_core4.default.getDisplayValue(column, value, cellOptions.data, cellOptions.rowType);\r\n        var text = _uiGrid_core4.default.formatValue(displayValue, column);\r\n        var isCellOrBatchEditMode = this._editingController.isCellOrBatchEditMode();\r\n        if (column.allowEditing && that.getController(\"keyboardNavigation\").isKeyboardEnabled()) {\r\n            $container.attr(\"tabIndex\", that.option(\"tabIndex\"));\r\n            if (isCellOrBatchEditMode) {\r\n                _events_engine2.default.off($container, \"focus\", focusAction);\r\n                _events_engine2.default.on($container, \"focus\", focusAction)\r\n            }\r\n        }\r\n        if (column.cellTemplate) {\r\n            var templateOptions = (0, _extend.extend)({}, cellOptions, {\r\n                value: value,\r\n                displayValue: displayValue,\r\n                text: text,\r\n                column: column\r\n            });\r\n            that._rowsView.renderTemplate($container, column.cellTemplate, templateOptions, !!$container.closest((0, _window.getWindow)().document).length)\r\n        } else {\r\n            container = $container.get(0);\r\n            if (column.encodeHtml) {\r\n                container.textContent = text\r\n            } else {\r\n                container.innerHTML = text\r\n            }\r\n            $container.addClass(ADAPTIVE_ITEM_TEXT_CLASS);\r\n            if (!_type2.default.isDefined(text) || \"\" === text) {\r\n                $container.html(\"&nbsp;\")\r\n            }\r\n            if (!that._isRowEditMode()) {\r\n                if (that._isItemModified(item, cellOptions)) {\r\n                    $container.addClass(FORM_ITEM_MODIFIED)\r\n                }\r\n            }\r\n        }\r\n        that.getView(\"rowsView\")._cellPrepared($container, cellOptions)\r\n    },\r\n    _getTemplate: function(item, cellOptions) {\r\n        var that = this;\r\n        var column = item.column;\r\n        var editingController = this.getController(\"editing\");\r\n        return function(options, container) {\r\n            var $container = (0, _renderer2.default)(container);\r\n            var columnIndex = that._columnsController.getVisibleIndex(column.visibleIndex);\r\n            var templateOptions = (0, _extend.extend)({}, cellOptions);\r\n            var renderFormTemplate = function() {\r\n                var isItemEdited = that._isItemEdited(item);\r\n                templateOptions.value = cellOptions.row.values[columnIndex];\r\n                if (isItemEdited || column.showEditorAlways) {\r\n                    editingController.renderFormEditTemplate(templateOptions, item, options.component, $container, !isItemEdited)\r\n                } else {\r\n                    templateOptions.column = column;\r\n                    templateOptions.columnIndex = columnIndex;\r\n                    that._renderFormViewTemplate(item, templateOptions, $container)\r\n                }\r\n            };\r\n            renderFormTemplate();\r\n            templateOptions.watch && templateOptions.watch(function() {\r\n                return {\r\n                    isItemEdited: that._isItemEdited(item),\r\n                    value: cellOptions.row.values[columnIndex]\r\n                }\r\n            }, function() {\r\n                $container.contents().remove();\r\n                $container.removeClass(ADAPTIVE_ITEM_TEXT_CLASS);\r\n                renderFormTemplate()\r\n            })\r\n        }\r\n    },\r\n    _isVisibleColumnsValid: function(visibleColumns) {\r\n        var getCommandColumnsCount = function() {\r\n            var result = 0;\r\n            var j;\r\n            var visibleColumn;\r\n            for (j = 0; j < visibleColumns.length; j++) {\r\n                visibleColumn = visibleColumns[j];\r\n                if (visibleColumn.command) {\r\n                    result++\r\n                }\r\n            }\r\n            return result\r\n        };\r\n        if (visibleColumns < 2) {\r\n            return false\r\n        }\r\n        if (visibleColumns.length - getCommandColumnsCount() <= 1) {\r\n            return false\r\n        }\r\n        return true\r\n    },\r\n    _calculatePercentWidths: function(widths, visibleColumns) {\r\n        var that = this;\r\n        var percentWidths = 0;\r\n        visibleColumns.forEach(function(item, index) {\r\n            if (widths[index] !== HIDDEN_COLUMNS_WIDTH) {\r\n                percentWidths += that._getItemPercentWidth(item)\r\n            }\r\n        });\r\n        return percentWidths\r\n    },\r\n    _isPercentWidth: function(width) {\r\n        return _type2.default.isString(width) && \"%\" === width.slice(-1)\r\n    },\r\n    _isColumnHidden: function(column) {\r\n        return this._hiddenColumns.filter(function(hiddenColumn) {\r\n            return hiddenColumn.index === column.index\r\n        }).length > 0\r\n    },\r\n    _getAverageColumnsWidth: function(containerWidth, columns, columnsCanFit) {\r\n        var that = this;\r\n        var fixedColumnsWidth = 0;\r\n        var columnsWithoutFixedWidthCount = 0;\r\n        columns.forEach(function(column) {\r\n            if (!that._isColumnHidden(column)) {\r\n                var width = column.width;\r\n                if (_type2.default.isDefined(width) && !isNaN(parseFloat(width))) {\r\n                    fixedColumnsWidth += that._isPercentWidth(width) ? that._calculatePercentWidth({\r\n                        visibleIndex: column.visibleIndex,\r\n                        columnsCount: columns.length,\r\n                        columnsCanFit: columnsCanFit,\r\n                        bestFitWidth: column.bestFitWidth,\r\n                        columnWidth: width,\r\n                        containerWidth: containerWidth\r\n                    }) : parseFloat(width)\r\n                } else {\r\n                    columnsWithoutFixedWidthCount++\r\n                }\r\n            }\r\n        });\r\n        return (containerWidth - fixedColumnsWidth) / columnsWithoutFixedWidthCount\r\n    },\r\n    _calculateColumnWidth: function(column, containerWidth, contentColumns, columnsCanFit) {\r\n        var columnId = getColumnId(this, column);\r\n        var widthOption = this._columnsController.columnOption(columnId, \"width\");\r\n        var bestFitWidth = this._columnsController.columnOption(columnId, \"bestFitWidth\");\r\n        var columnsCount = contentColumns.length;\r\n        var colWidth;\r\n        if (widthOption && \"auto\" !== widthOption) {\r\n            if (this._isPercentWidth(widthOption)) {\r\n                colWidth = this._calculatePercentWidth({\r\n                    visibleIndex: column.visibleIndex,\r\n                    columnsCount: columnsCount,\r\n                    columnsCanFit: columnsCanFit,\r\n                    bestFitWidth: bestFitWidth,\r\n                    columnWidth: widthOption,\r\n                    containerWidth: containerWidth\r\n                })\r\n            } else {\r\n                return widthOption\r\n            }\r\n        } else {\r\n            var columnAutoWidth = this.option(\"columnAutoWidth\");\r\n            colWidth = columnAutoWidth || !!column.command ? bestFitWidth : this._getAverageColumnsWidth(containerWidth, contentColumns, columnsCanFit)\r\n        }\r\n        return colWidth\r\n    },\r\n    _calculatePercentWidth: function(options) {\r\n        var columnFitted = options.visibleIndex < options.columnsCount - 1 && options.columnsCanFit;\r\n        var partialWidth = options.containerWidth * parseFloat(options.columnWidth) / 100;\r\n        var resultWidth = options.columnsCanFit && partialWidth < options.bestFitWidth ? options.bestFitWidth : partialWidth;\r\n        return columnFitted ? options.containerWidth * parseFloat(options.columnWidth) / 100 : resultWidth\r\n    },\r\n    _getNotTruncatedColumnWidth: function(column, containerWidth, contentColumns, columnsCanFit) {\r\n        var columnId = getColumnId(this, column);\r\n        var widthOption = this._columnsController.columnOption(columnId, \"width\");\r\n        var bestFitWidth = this._columnsController.columnOption(columnId, \"bestFitWidth\");\r\n        var colWidth;\r\n        if (widthOption && \"auto\" !== widthOption && !this._isPercentWidth(widthOption)) {\r\n            return parseFloat(widthOption)\r\n        }\r\n        colWidth = this._calculateColumnWidth(column, containerWidth, contentColumns, columnsCanFit);\r\n        return colWidth < bestFitWidth ? null : colWidth\r\n    },\r\n    _getItemPercentWidth: function(item) {\r\n        var result = 0;\r\n        if (item.width && this._isPercentWidth(item.width)) {\r\n            result = parseFloat(item.width)\r\n        }\r\n        return result\r\n    },\r\n    _getCommandColumnsWidth: function() {\r\n        var that = this;\r\n        var columns = that._columnsController.getVisibleColumns();\r\n        var colWidth = 0;\r\n        (0, _iterator.each)(columns, function(index, column) {\r\n            if (column.index < 0 || column.command) {\r\n                colWidth += that._columnsController.columnOption(getColumnId(that, column), \"bestFitWidth\") || 0\r\n            }\r\n        });\r\n        return colWidth\r\n    },\r\n    _isItemEdited: function(item) {\r\n        if (this.isFormEditMode()) {\r\n            return false\r\n        }\r\n        if (this._isRowEditMode()) {\r\n            var editRowKey = this._editingController.getEditRowKey();\r\n            if ((0, _common.equalByValue)(editRowKey, this._dataController.adaptiveExpandedKey())) {\r\n                return true\r\n            }\r\n        } else {\r\n            var rowIndex = this._dataController.getRowIndexByKey(this._dataController.adaptiveExpandedKey()) + 1;\r\n            var columnIndex = this._columnsController.getVisibleIndex(item.column.index);\r\n            return this._editingController.isEditCell(rowIndex, columnIndex)\r\n        }\r\n    },\r\n    _getFormItemsByHiddenColumns: function(hiddenColumns) {\r\n        var items = [];\r\n        (0, _iterator.each)(hiddenColumns, function(_, column) {\r\n            items.push({\r\n                column: column,\r\n                name: column.name,\r\n                dataField: column.dataField,\r\n                visibleIndex: column.visibleIndex\r\n            })\r\n        });\r\n        return items\r\n    },\r\n    _getAdaptiveColumnVisibleIndex: function(visibleColumns) {\r\n        var i;\r\n        var column;\r\n        for (i = 0; i < visibleColumns.length; i++) {\r\n            column = visibleColumns[i];\r\n            if (column.command === ADAPTIVE_COLUMN_NAME) {\r\n                return i\r\n            }\r\n        }\r\n    },\r\n    _hideAdaptiveColumn: function(resultWidths, visibleColumns) {\r\n        var visibleIndex = this._getAdaptiveColumnVisibleIndex(visibleColumns);\r\n        if (_type2.default.isDefined(visibleIndex)) {\r\n            resultWidths[visibleIndex] = HIDDEN_COLUMNS_WIDTH;\r\n            this._addCssClassToColumn(COMMAND_ADAPTIVE_HIDDEN_CLASS, visibleIndex)\r\n        }\r\n    },\r\n    _removeCssClassFromColumn: function(cssClassName) {\r\n        var i;\r\n        var view;\r\n        var $cells;\r\n        for (i = 0; i < COLUMN_VIEWS.length; i++) {\r\n            view = this.getView(COLUMN_VIEWS[i]);\r\n            if (view && view.isVisible() && view.element()) {\r\n                $cells = view.element().find(\".\" + cssClassName);\r\n                $cells.removeClass(cssClassName)\r\n            }\r\n        }\r\n    },\r\n    _removeCssClassesFromColumns: function() {\r\n        this._removeCssClassFromColumn(COMMAND_ADAPTIVE_HIDDEN_CLASS);\r\n        this._removeCssClassFromColumn(this.addWidgetPrefix(HIDDEN_COLUMN_CLASS))\r\n    },\r\n    _isCellValid: function($cell) {\r\n        return $cell && $cell.length && !$cell.hasClass(MASTER_DETAIL_CELL_CLASS)\r\n    },\r\n    _addCssClassToColumn: function(cssClassName, visibleIndex) {\r\n        var that = this;\r\n        COLUMN_VIEWS.forEach(function(viewName) {\r\n            var view = that.getView(viewName);\r\n            view && that._addCssClassToViewColumn(view, cssClassName, visibleIndex)\r\n        })\r\n    },\r\n    _addCssClassToViewColumn: function(view, cssClassName, visibleIndex) {\r\n        var viewName = view.name;\r\n        var rowsCount;\r\n        var rowIndex;\r\n        var $cellElement;\r\n        var currentVisibleIndex;\r\n        var column = this._columnsController.getVisibleColumns()[visibleIndex];\r\n        var editFormRowIndex = this._editingController && this._editingController.getEditFormRowIndex();\r\n        if (view && view.isVisible() && column) {\r\n            rowsCount = view.getRowsCount();\r\n            var $rowElements = view._getRowElements();\r\n            for (rowIndex = 0; rowIndex < rowsCount; rowIndex++) {\r\n                if (rowIndex !== editFormRowIndex || viewName !== ROWS_VIEW) {\r\n                    currentVisibleIndex = viewName === COLUMN_HEADERS_VIEW ? this._columnsController.getVisibleIndex(column.index, rowIndex) : visibleIndex;\r\n                    if (currentVisibleIndex >= 0) {\r\n                        $cellElement = $rowElements.eq(rowIndex).children().eq(currentVisibleIndex);\r\n                        this._isCellValid($cellElement) && $cellElement.addClass(cssClassName)\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    _getEditMode: function() {\r\n        return this._editingController.getEditMode()\r\n    },\r\n    isFormEditMode: function() {\r\n        var editMode = this._getEditMode();\r\n        return editMode === EDIT_MODE_FORM || editMode === EDIT_MODE_POPUP\r\n    },\r\n    hideRedundantColumns: function(resultWidths, visibleColumns, hiddenQueue) {\r\n        var that = this;\r\n        var visibleColumn;\r\n        this._hiddenColumns = [];\r\n        if (that._isVisibleColumnsValid(visibleColumns) && hiddenQueue.length) {\r\n            var totalWidth = 0;\r\n            var percentWidths;\r\n            var $rootElement = that.component.$element();\r\n            var rootElementWidth = $rootElement.width() - that._getCommandColumnsWidth();\r\n            var getVisibleContentColumns = function() {\r\n                var _this = this;\r\n                return visibleColumns.filter(function(item) {\r\n                    return !item.command && 0 === _this._hiddenColumns.filter(function(i) {\r\n                        return i.dataField === item.dataField\r\n                    }).length\r\n                })\r\n            }.bind(this);\r\n            var visibleContentColumns = getVisibleContentColumns();\r\n            var contentColumnsCount = visibleContentColumns.length;\r\n            var columnsCanFit;\r\n            var i;\r\n            var hasHiddenColumns;\r\n            var needHideColumn;\r\n            do {\r\n                needHideColumn = false;\r\n                totalWidth = 0;\r\n                percentWidths = that._calculatePercentWidths(resultWidths, visibleColumns);\r\n                columnsCanFit = percentWidths < 100 && 0 !== percentWidths;\r\n                for (i = 0; i < visibleColumns.length; i++) {\r\n                    visibleColumn = visibleColumns[i];\r\n                    var columnWidth = that._getNotTruncatedColumnWidth(visibleColumn, rootElementWidth, visibleContentColumns, columnsCanFit);\r\n                    var columnId = getColumnId(that, visibleColumn);\r\n                    var widthOption = that._columnsController.columnOption(columnId, \"width\");\r\n                    var minWidth = that._columnsController.columnOption(columnId, \"minWidth\");\r\n                    var columnBestFitWidth = that._columnsController.columnOption(columnId, \"bestFitWidth\");\r\n                    if (resultWidths[i] === HIDDEN_COLUMNS_WIDTH) {\r\n                        hasHiddenColumns = true;\r\n                        continue\r\n                    }\r\n                    if (!columnWidth && !visibleColumn.command && !visibleColumn.fixed) {\r\n                        needHideColumn = true;\r\n                        break\r\n                    }\r\n                    if (!widthOption || \"auto\" === widthOption) {\r\n                        columnWidth = Math.max(columnBestFitWidth || 0, minWidth || 0)\r\n                    }\r\n                    if (visibleColumn.command !== ADAPTIVE_COLUMN_NAME || hasHiddenColumns) {\r\n                        totalWidth += columnWidth\r\n                    }\r\n                }\r\n                needHideColumn = needHideColumn || totalWidth > $rootElement.width();\r\n                if (needHideColumn) {\r\n                    var column = hiddenQueue.pop();\r\n                    var visibleIndex = that._columnsController.getVisibleIndex(column.index);\r\n                    rootElementWidth += that._calculateColumnWidth(column, rootElementWidth, visibleContentColumns, columnsCanFit);\r\n                    that._addCssClassToColumn(that.addWidgetPrefix(HIDDEN_COLUMN_CLASS), visibleIndex);\r\n                    resultWidths[visibleIndex] = HIDDEN_COLUMNS_WIDTH;\r\n                    this._hiddenColumns.push(column);\r\n                    visibleContentColumns = getVisibleContentColumns()\r\n                }\r\n            } while (needHideColumn && visibleContentColumns.length > 1 && hiddenQueue.length);\r\n            if (contentColumnsCount === visibleContentColumns.length) {\r\n                that._hideAdaptiveColumn(resultWidths, visibleColumns)\r\n            }\r\n        } else {\r\n            that._hideAdaptiveColumn(resultWidths, visibleColumns)\r\n        }\r\n    },\r\n    getItemContentByColumnIndex: function(visibleColumnIndex) {\r\n        var $itemContent;\r\n        var i;\r\n        var item;\r\n        for (i = 0; i < this._$itemContents.length; i++) {\r\n            $itemContent = this._$itemContents.eq(i);\r\n            item = $itemContent.data(\"dx-form-item\");\r\n            if (item && item.column && this._columnsController.getVisibleIndex(item.column.index) === visibleColumnIndex) {\r\n                return $itemContent\r\n            }\r\n        }\r\n    },\r\n    toggleExpandAdaptiveDetailRow: function(key, alwaysExpanded) {\r\n        if (!(this.isFormEditMode() && this._editingController.isEditing())) {\r\n            this.getController(\"data\").toggleExpandAdaptiveDetailRow(key, alwaysExpanded)\r\n        }\r\n    },\r\n    createFormByHiddenColumns: function(container, options) {\r\n        var that = this;\r\n        var $container = (0, _renderer2.default)(container);\r\n        var userFormOptions = {\r\n            items: that._getFormItemsByHiddenColumns(that._hiddenColumns),\r\n            formID: \"dx-\" + new _guid2.default\r\n        };\r\n        var defaultFormOptions = _themes2.default.isMaterial() ? {\r\n            colCount: 2\r\n        } : {};\r\n        this.executeAction(\"onAdaptiveDetailRowPreparing\", {\r\n            formOptions: userFormOptions\r\n        });\r\n        that._$itemContents = null;\r\n        that._form = that._createComponent((0, _renderer2.default)(\"<div>\").appendTo($container), _form2.default, (0, _extend.extend)(defaultFormOptions, userFormOptions, {\r\n            customizeItem: function(item) {\r\n                var column = item.column || that._columnsController.columnOption(item.name || item.dataField);\r\n                if (column) {\r\n                    item.label = item.label || {};\r\n                    item.label.text = item.label.text || column.caption;\r\n                    item.column = column;\r\n                    item.template = that._getTemplate(item, options, that.updateForm.bind(that))\r\n                }\r\n                userFormOptions.customizeItem && userFormOptions.customizeItem.call(this, item)\r\n            },\r\n            onContentReady: function(e) {\r\n                userFormOptions.onContentReady && userFormOptions.onContentReady.call(this, e);\r\n                that._$itemContents = $container.find(\".\" + FORM_ITEM_CONTENT_CLASS)\r\n            }\r\n        }))\r\n    },\r\n    hasAdaptiveDetailRowExpanded: function() {\r\n        return _type2.default.isDefined(this._dataController.adaptiveExpandedKey())\r\n    },\r\n    updateForm: function(hiddenColumns) {\r\n        if (this.hasAdaptiveDetailRowExpanded()) {\r\n            if (this._form && _type2.default.isDefined(this._form._contentReadyAction)) {\r\n                if (hiddenColumns && hiddenColumns.length) {\r\n                    this._form.option(\"items\", this._getFormItemsByHiddenColumns(hiddenColumns))\r\n                } else {\r\n                    this._form.repaint()\r\n                }\r\n            }\r\n        }\r\n    },\r\n    updateHidingQueue: function(columns) {\r\n        var that = this;\r\n        var hideableColumns = columns.filter(function(column) {\r\n            return column.visible && !column.type && !column.fixed && !(_type2.default.isDefined(column.groupIndex) && column.groupIndex >= 0)\r\n        });\r\n        var columnsHasHidingPriority;\r\n        var i;\r\n        that._hidingColumnsQueue = [];\r\n        if (that.option(\"allowColumnResizing\") && \"widget\" === that.option(\"columnResizingMode\")) {\r\n            return that._hidingColumnsQueue\r\n        }\r\n        for (i = 0; i < hideableColumns.length; i++) {\r\n            if (_type2.default.isDefined(hideableColumns[i].hidingPriority) && hideableColumns[i].hidingPriority >= 0) {\r\n                columnsHasHidingPriority = true;\r\n                that._hidingColumnsQueue[hideableColumns[i].hidingPriority] = hideableColumns[i]\r\n            }\r\n        }\r\n        if (columnsHasHidingPriority) {\r\n            that._hidingColumnsQueue.reverse()\r\n        } else {\r\n            if (that.option(\"columnHidingEnabled\")) {\r\n                for (i = 0; i < hideableColumns.length; i++) {\r\n                    var visibleIndex = that._columnsController.getVisibleIndex(hideableColumns[i].index);\r\n                    that._hidingColumnsQueue[visibleIndex] = hideableColumns[i]\r\n                }\r\n            }\r\n        }\r\n        that._hidingColumnsQueue = that._hidingColumnsQueue.filter(Object);\r\n        return that._hidingColumnsQueue\r\n    },\r\n    getHiddenColumns: function() {\r\n        return this._hiddenColumns\r\n    },\r\n    hasHiddenColumns: function() {\r\n        return this._hiddenColumns.length > 0\r\n    },\r\n    getHidingColumnsQueue: function() {\r\n        return this._hidingColumnsQueue\r\n    },\r\n    init: function() {\r\n        var that = this;\r\n        that._columnsController = that.getController(\"columns\");\r\n        that._dataController = that.getController(\"data\");\r\n        that._rowsView = that.getView(\"rowsView\");\r\n        that._columnsController.addCommandColumn({\r\n            type: ADAPTIVE_COLUMN_NAME,\r\n            command: ADAPTIVE_COLUMN_NAME,\r\n            visible: true,\r\n            adaptiveHidden: true,\r\n            cssClass: ADAPTIVE_COLUMN_NAME_CLASS,\r\n            alignment: \"center\",\r\n            width: \"auto\",\r\n            cellTemplate: adaptiveCellTemplate,\r\n            fixedPosition: \"right\"\r\n        });\r\n        that._columnsController.columnsChanged.add(function() {\r\n            var isAdaptiveVisible = !!that.updateHidingQueue(that._columnsController.getColumns()).length;\r\n            that._columnsController.columnOption(\"command:adaptive\", \"adaptiveHidden\", !isAdaptiveVisible, true)\r\n        });\r\n        that._editingController = that.getController(\"editing\");\r\n        that._hidingColumnsQueue = [];\r\n        that._hiddenColumns = [];\r\n        that.createAction(\"onAdaptiveDetailRowPreparing\");\r\n        that.callBase()\r\n    },\r\n    optionChanged: function(args) {\r\n        if (\"columnHidingEnabled\" === args.name) {\r\n            this._columnsController.columnOption(\"command:adaptive\", \"adaptiveHidden\", !args.value)\r\n        }\r\n        this.callBase(args)\r\n    },\r\n    publicMethods: function() {\r\n        return [\"isAdaptiveDetailRowExpanded\", \"expandAdaptiveDetailRow\", \"collapseAdaptiveDetailRow\"]\r\n    },\r\n    isAdaptiveDetailRowExpanded: function(key) {\r\n        return this._dataController.adaptiveExpandedKey() && (0, _common.equalByValue)(this._dataController.adaptiveExpandedKey(), key)\r\n    },\r\n    expandAdaptiveDetailRow: function(key) {\r\n        if (!this.hasAdaptiveDetailRowExpanded()) {\r\n            this.toggleExpandAdaptiveDetailRow(key)\r\n        }\r\n    },\r\n    collapseAdaptiveDetailRow: function() {\r\n        if (this.hasAdaptiveDetailRowExpanded()) {\r\n            this.toggleExpandAdaptiveDetailRow()\r\n        }\r\n    }\r\n});\r\nmodule.exports = {\r\n    defaultOptions: function() {\r\n        return {\r\n            columnHidingEnabled: false,\r\n            onAdaptiveDetailRowPreparing: null\r\n        }\r\n    },\r\n    controllers: {\r\n        adaptiveColumns: AdaptiveColumnsController\r\n    },\r\n    extenders: {\r\n        views: {\r\n            rowsView: {\r\n                _getCellTemplate: function(options) {\r\n                    var that = this;\r\n                    var column = options.column;\r\n                    if (options.rowType === ADAPTIVE_ROW_TYPE && \"detail\" === column.command) {\r\n                        return function(container, options) {\r\n                            that._adaptiveColumnsController.createFormByHiddenColumns((0, _renderer2.default)(container), options)\r\n                        }\r\n                    }\r\n                    return that.callBase(options)\r\n                },\r\n                _createRow: function(row) {\r\n                    var $row = this.callBase(row);\r\n                    if (row && row.rowType === ADAPTIVE_ROW_TYPE && row.key === this._dataController.adaptiveExpandedKey()) {\r\n                        $row.addClass(ADAPTIVE_DETAIL_ROW_CLASS)\r\n                    }\r\n                    return $row\r\n                },\r\n                _renderCells: function($row, options) {\r\n                    this.callBase($row, options);\r\n                    var hidingColumnsQueueLength = this._adaptiveColumnsController.getHidingColumnsQueue().length;\r\n                    var hiddenColumnsLength = this._adaptiveColumnsController.getHiddenColumns().length;\r\n                    if (hidingColumnsQueueLength && !hiddenColumnsLength) {\r\n                        getDataCellElements($row).last().addClass(LAST_DATA_CELL_CLASS)\r\n                    }\r\n                },\r\n                _getColumnIndexByElementCore: function($element) {\r\n                    var $itemContent = $element.closest(\".\" + FORM_ITEM_CONTENT_CLASS);\r\n                    if ($itemContent.length && $itemContent.closest(this.component.$element()).length) {\r\n                        var formItem = $itemContent.length ? $itemContent.first().data(\"dx-form-item\") : null;\r\n                        return formItem && formItem.column && this._columnsController.getVisibleIndex(formItem.column.index)\r\n                    } else {\r\n                        return this.callBase($element)\r\n                    }\r\n                },\r\n                _cellPrepared: function($cell, options) {\r\n                    this.callBase.apply(this, arguments);\r\n                    if (options.row.rowType !== ADAPTIVE_ROW_TYPE && options.column.visibleWidth === HIDDEN_COLUMNS_WIDTH) {\r\n                        $cell.addClass(this.addWidgetPrefix(HIDDEN_COLUMN_CLASS))\r\n                    }\r\n                },\r\n                _getCellElement: function(rowIndex, columnIdentifier) {\r\n                    var item = this._dataController.items()[rowIndex];\r\n                    if (item && item.rowType === ADAPTIVE_ROW_TYPE) {\r\n                        return this._adaptiveColumnsController.getItemContentByColumnIndex(columnIdentifier)\r\n                    } else {\r\n                        return this.callBase(rowIndex, columnIdentifier)\r\n                    }\r\n                },\r\n                getContextMenuItems: function(options) {\r\n                    if (options.row && \"detailAdaptive\" === options.row.rowType) {\r\n                        var view = this.component.getView(\"columnHeadersView\");\r\n                        var formItem = (0, _renderer2.default)(options.targetElement).closest(\".dx-field-item-label\").next().data(\"dx-form-item\");\r\n                        options.column = formItem ? formItem.column : options.column;\r\n                        return view.getContextMenuItems && view.getContextMenuItems(options)\r\n                    }\r\n                    return this.callBase && this.callBase(options)\r\n                },\r\n                isClickableElement: function($target) {\r\n                    var isClickable = this.callBase ? this.callBase($target) : false;\r\n                    return isClickable || !!$target.closest(\".\" + ADAPTIVE_COLUMN_NAME_CLASS).length\r\n                },\r\n                init: function() {\r\n                    this.callBase();\r\n                    this._adaptiveColumnsController = this.getController(\"adaptiveColumns\")\r\n                }\r\n            }\r\n        },\r\n        controllers: {\r\n            \"export\": {\r\n                _updateColumnWidth: function(column, width) {\r\n                    this.callBase(column, column.visibleWidth === HIDDEN_COLUMNS_WIDTH ? column.bestFitWidth : width)\r\n                }\r\n            },\r\n            columnsResizer: {\r\n                _pointCreated: function(point, cellsLength, columns) {\r\n                    var result = this.callBase(point, cellsLength, columns);\r\n                    var currentColumn = columns[point.columnIndex] || {};\r\n                    var nextColumnIndex = this._getNextColumnIndex(point.columnIndex);\r\n                    var nextColumn = columns[nextColumnIndex] || {};\r\n                    var hasHiddenColumnsOnly = nextColumnIndex !== point.columnIndex + 1 && nextColumn.command;\r\n                    var hasAdaptiveHiddenWidth = currentColumn.visibleWidth === HIDDEN_COLUMNS_WIDTH || hasHiddenColumnsOnly;\r\n                    return result || hasAdaptiveHiddenWidth\r\n                },\r\n                _getNextColumnIndex: function(currentColumnIndex) {\r\n                    var visibleColumns = this._columnsController.getVisibleColumns();\r\n                    var index = this.callBase(currentColumnIndex);\r\n                    while (visibleColumns[index] && visibleColumns[index].visibleWidth === HIDDEN_COLUMNS_WIDTH) {\r\n                        index++\r\n                    }\r\n                    return index\r\n                }\r\n            },\r\n            draggingHeader: {\r\n                _pointCreated: function(point, columns, location, sourceColumn) {\r\n                    var result = this.callBase(point, columns, location, sourceColumn);\r\n                    var column = columns[point.columnIndex - 1] || {};\r\n                    var hasAdaptiveHiddenWidth = column.visibleWidth === HIDDEN_COLUMNS_WIDTH;\r\n                    return result || hasAdaptiveHiddenWidth\r\n                }\r\n            },\r\n            editing: {\r\n                _isRowEditMode: function() {\r\n                    return this.getEditMode() === EDIT_MODE_ROW\r\n                },\r\n                _getFormEditItemTemplate: function(cellOptions, column) {\r\n                    if (this.getEditMode() !== EDIT_MODE_ROW && \"detailAdaptive\" === cellOptions.rowType) {\r\n                        cellOptions.columnIndex = this._columnsController.getVisibleIndex(column.index);\r\n                        return this.getColumnTemplate(cellOptions)\r\n                    }\r\n                    return this.callBase(cellOptions, column)\r\n                },\r\n                _closeEditItem: function($targetElement) {\r\n                    var $itemContents = $targetElement.closest(\".\" + FORM_ITEM_CONTENT_CLASS);\r\n                    var rowIndex = this._dataController.getRowIndexByKey(this._dataController.adaptiveExpandedKey()) + 1;\r\n                    var formItem = $itemContents.length ? $itemContents.first().data(\"dx-form-item\") : null;\r\n                    var columnIndex = formItem && formItem.column && this._columnsController.getVisibleIndex(formItem.column.index);\r\n                    if (!this.isEditCell(rowIndex, columnIndex)) {\r\n                        this.callBase($targetElement)\r\n                    }\r\n                },\r\n                _beforeUpdateItems: function(rowIndices, rowIndex) {\r\n                    if (!this._adaptiveController.isFormEditMode() && this._adaptiveController.hasHiddenColumns()) {\r\n                        var items = this._dataController.items();\r\n                        var item = items[rowIndex];\r\n                        var oldExpandRowIndex = _uiGrid_core4.default.getIndexByKey(this._dataController.adaptiveExpandedKey(), items);\r\n                        this._isForceRowAdaptiveExpand = !this._adaptiveController.hasAdaptiveDetailRowExpanded();\r\n                        if (oldExpandRowIndex >= 0 && rowIndex > oldExpandRowIndex) {\r\n                            this._editRowIndex--\r\n                        }\r\n                        if (oldExpandRowIndex >= 0) {\r\n                            rowIndices.push(oldExpandRowIndex + 1)\r\n                        }\r\n                        rowIndices.push(rowIndex + 1);\r\n                        this._dataController.adaptiveExpandedKey(item.key)\r\n                    }\r\n                },\r\n                _afterInsertRow: function(options) {\r\n                    this.callBase(options);\r\n                    if (this._adaptiveController.hasHiddenColumns()) {\r\n                        this._adaptiveController.toggleExpandAdaptiveDetailRow(options.key, this.isRowEditMode());\r\n                        this._isForceRowAdaptiveExpand = true\r\n                    }\r\n                },\r\n                _collapseAdaptiveDetailRow: function() {\r\n                    if (this._isRowEditMode() && this._isForceRowAdaptiveExpand) {\r\n                        this._adaptiveController.collapseAdaptiveDetailRow();\r\n                        this._isForceRowAdaptiveExpand = false\r\n                    }\r\n                },\r\n                _cancelEditAdaptiveDetailRow: function() {\r\n                    if (this._adaptiveController.hasHiddenColumns()) {\r\n                        this._collapseAdaptiveDetailRow()\r\n                    }\r\n                },\r\n                _afterSaveEditData: function() {\r\n                    var _this2 = this;\r\n                    this.callBase();\r\n                    var deferred = new _deferred.Deferred;\r\n                    if (this._isRowEditMode() && this._adaptiveController.hasHiddenColumns()) {\r\n                        (0, _deferred.when)(this.getController(\"validating\").validate(true)).done(function(isValid) {\r\n                            if (isValid) {\r\n                                _this2._cancelEditAdaptiveDetailRow()\r\n                            }\r\n                            deferred.resolve()\r\n                        })\r\n                    } else {\r\n                        deferred.resolve()\r\n                    }\r\n                    return deferred.promise()\r\n                },\r\n                _beforeCancelEditData: function() {\r\n                    this.callBase();\r\n                    this._cancelEditAdaptiveDetailRow()\r\n                },\r\n                _getRowIndicesForCascadeUpdating: function(row) {\r\n                    var rowIndices = this.callBase.apply(this, arguments);\r\n                    if (this._adaptiveController.isAdaptiveDetailRowExpanded(row.key)) {\r\n                        rowIndices.push(row.rowType === ADAPTIVE_ROW_TYPE ? row.rowIndex - 1 : row.rowIndex + 1)\r\n                    }\r\n                    return rowIndices\r\n                },\r\n                _beforeCloseEditCellInBatchMode: function(rowIndices) {\r\n                    var expandedKey = this._dataController._adaptiveExpandedKey;\r\n                    var rowIndex;\r\n                    if (expandedKey) {\r\n                        rowIndex = _uiGrid_core4.default.getIndexByKey(expandedKey, this._dataController.items());\r\n                        if (rowIndex > -1) {\r\n                            rowIndices.unshift(rowIndex)\r\n                        }\r\n                    }\r\n                },\r\n                editRow: function(rowIndex) {\r\n                    if (this._adaptiveController.isFormEditMode()) {\r\n                        this._adaptiveController.collapseAdaptiveDetailRow()\r\n                    }\r\n                    this.callBase(rowIndex)\r\n                },\r\n                deleteRow: function(rowIndex) {\r\n                    var rowKey = this._dataController.getKeyByRowIndex(rowIndex);\r\n                    if (this.getEditMode() === EDIT_MODE_BATCH && this._adaptiveController.isAdaptiveDetailRowExpanded(rowKey)) {\r\n                        this._adaptiveController.collapseAdaptiveDetailRow()\r\n                    }\r\n                    this.callBase(rowIndex)\r\n                },\r\n                init: function() {\r\n                    this.callBase();\r\n                    this._adaptiveController = this.getController(\"adaptiveColumns\")\r\n                }\r\n            },\r\n            resizing: {\r\n                _needBestFit: function() {\r\n                    return this.callBase() || !!this._adaptiveColumnsController.getHidingColumnsQueue().length\r\n                },\r\n                _updateScrollableForIE: function() {\r\n                    var that = this;\r\n                    if (_browser2.default.msie && parseInt(_browser2.default.version) <= 11) {\r\n                        this._updateScrollableTimeoutID = setTimeout(function() {\r\n                            that.getView(\"rowsView\")._updateScrollable()\r\n                        })\r\n                    }\r\n                },\r\n                _correctColumnWidths: function(resultWidths, visibleColumns) {\r\n                    var adaptiveController = this._adaptiveColumnsController;\r\n                    var columnAutoWidth = this.option(\"columnAutoWidth\");\r\n                    var oldHiddenColumns = adaptiveController.getHiddenColumns();\r\n                    var hiddenColumns;\r\n                    var hidingColumnsQueue = adaptiveController.updateHidingQueue(this._columnsController.getColumns());\r\n                    adaptiveController.hideRedundantColumns(resultWidths, visibleColumns, hidingColumnsQueue);\r\n                    hiddenColumns = adaptiveController.getHiddenColumns();\r\n                    if (adaptiveController.hasAdaptiveDetailRowExpanded()) {\r\n                        if (oldHiddenColumns.length !== hiddenColumns.length) {\r\n                            adaptiveController.updateForm(hiddenColumns)\r\n                        }\r\n                    }!hiddenColumns.length && adaptiveController.collapseAdaptiveDetailRow();\r\n                    if (columnAutoWidth && hidingColumnsQueue.length && !hiddenColumns.length) {\r\n                        this._updateScrollableForIE()\r\n                    }\r\n                    return this.callBase.apply(this, arguments)\r\n                },\r\n                _toggleBestFitMode: function(isBestFit) {\r\n                    isBestFit && this._adaptiveColumnsController._removeCssClassesFromColumns();\r\n                    this.callBase(isBestFit)\r\n                },\r\n                _needStretch: function() {\r\n                    var adaptiveColumnsController = this._adaptiveColumnsController;\r\n                    return this.callBase.apply(this, arguments) || adaptiveColumnsController.getHidingColumnsQueue().length || adaptiveColumnsController.hasHiddenColumns()\r\n                },\r\n                init: function() {\r\n                    this._adaptiveColumnsController = this.getController(\"adaptiveColumns\");\r\n                    this.callBase()\r\n                },\r\n                dispose: function() {\r\n                    this.callBase.apply(this, arguments);\r\n                    clearTimeout(this._updateScrollableTimeoutID)\r\n                }\r\n            },\r\n            data: {\r\n                _processItems: function(items, change) {\r\n                    var that = this;\r\n                    var item;\r\n                    var expandRowIndex;\r\n                    var changeType = change.changeType;\r\n                    items = that.callBase.apply(that, arguments);\r\n                    if (\"loadingAll\" === changeType || !_type2.default.isDefined(that._adaptiveExpandedKey)) {\r\n                        return items\r\n                    }\r\n                    expandRowIndex = _uiGrid_core4.default.getIndexByKey(that._adaptiveExpandedKey, items);\r\n                    if (expandRowIndex >= 0) {\r\n                        item = items[expandRowIndex];\r\n                        items.splice(expandRowIndex + 1, 0, {\r\n                            visible: true,\r\n                            rowType: ADAPTIVE_ROW_TYPE,\r\n                            key: item.key,\r\n                            data: item.data,\r\n                            modifiedValues: item.modifiedValues,\r\n                            isNewRow: item.isNewRow,\r\n                            values: item.values\r\n                        })\r\n                    } else {\r\n                        if (\"refresh\" === changeType) {\r\n                            that._adaptiveExpandedKey = void 0\r\n                        }\r\n                    }\r\n                    return items\r\n                },\r\n                _getRowIndicesForExpand: function(key) {\r\n                    var rowIndices = this.callBase.apply(this, arguments);\r\n                    var lastRowIndex;\r\n                    if (this.getController(\"adaptiveColumns\").isAdaptiveDetailRowExpanded(key)) {\r\n                        lastRowIndex = rowIndices[rowIndices.length - 1];\r\n                        rowIndices.push(lastRowIndex + 1)\r\n                    }\r\n                    return rowIndices\r\n                },\r\n                adaptiveExpandedKey: function(value) {\r\n                    if (_type2.default.isDefined(value)) {\r\n                        this._adaptiveExpandedKey = value\r\n                    } else {\r\n                        return this._adaptiveExpandedKey\r\n                    }\r\n                },\r\n                toggleExpandAdaptiveDetailRow: function(key, alwaysExpanded) {\r\n                    var that = this;\r\n                    var oldExpandLoadedRowIndex = _uiGrid_core4.default.getIndexByKey(that._adaptiveExpandedKey, that._items);\r\n                    var newExpandLoadedRowIndex = _uiGrid_core4.default.getIndexByKey(key, that._items);\r\n                    if (oldExpandLoadedRowIndex >= 0 && oldExpandLoadedRowIndex === newExpandLoadedRowIndex && !alwaysExpanded) {\r\n                        key = void 0;\r\n                        newExpandLoadedRowIndex = -1\r\n                    }\r\n                    that._adaptiveExpandedKey = key;\r\n                    if (oldExpandLoadedRowIndex >= 0) {\r\n                        oldExpandLoadedRowIndex++\r\n                    }\r\n                    if (newExpandLoadedRowIndex >= 0) {\r\n                        newExpandLoadedRowIndex++\r\n                    }\r\n                    var rowIndexDelta = that.getRowIndexDelta();\r\n                    that.updateItems({\r\n                        allowInvisibleRowIndices: true,\r\n                        changeType: \"update\",\r\n                        rowIndices: [oldExpandLoadedRowIndex - rowIndexDelta, newExpandLoadedRowIndex - rowIndexDelta]\r\n                    })\r\n                },\r\n                init: function() {\r\n                    this.callBase();\r\n                    this._adaptiveExpandedKey = void 0\r\n                }\r\n            },\r\n            editorFactory: {\r\n                _getFocusCellSelector: function() {\r\n                    return this.callBase() + \", .dx-adaptive-detail-row .dx-field-item > .dx-field-item-content\"\r\n                },\r\n                _getTooltipsSelector: function() {\r\n                    return this.callBase() + \", .dx-field-item-content .\" + this.addWidgetPrefix(REVERT_TOOLTIP_CLASS)\r\n                }\r\n            },\r\n            columns: {\r\n                _isColumnVisible: function(column) {\r\n                    return this.callBase(column) && !column.adaptiveHidden\r\n                }\r\n            },\r\n            keyboardNavigation: {\r\n                _isCellValid: function($cell) {\r\n                    return this.callBase.apply(this, arguments) && !$cell.hasClass(this.addWidgetPrefix(HIDDEN_COLUMN_CLASS))\r\n                },\r\n                _processNextCellInMasterDetail: function($nextCell) {\r\n                    this.callBase($nextCell);\r\n                    var isCellOrBatchMode = this._editingController.isCellOrBatchEditMode();\r\n                    if (!this._isInsideEditForm($nextCell) && $nextCell && isCellOrBatchMode) {\r\n                        var focusHandler = function focusHandler() {\r\n                            _events_engine2.default.off($nextCell, \"focus\", focusHandler);\r\n                            _events_engine2.default.trigger($nextCell, \"dxclick\")\r\n                        };\r\n                        _events_engine2.default.on($nextCell, \"focus\", focusHandler)\r\n                    }\r\n                },\r\n                _handleTabKeyOnMasterDetailCell: function(eventTarget, direction) {\r\n                    var result = this.callBase(eventTarget, direction);\r\n                    var $currentCell = this._getFocusedCell();\r\n                    var $row = $currentCell && $currentCell.parent();\r\n                    if (!result && $row && $row.length) {\r\n                        var $dataCells = getDataCellElements($row);\r\n                        var $targetCell = \"next\" === direction ? $dataCells.last() : $dataCells.first();\r\n                        var rowIndex = $row.get(0).rowIndex;\r\n                        var adaptiveController = this._adaptiveController;\r\n                        var key = this._dataController.getKeyByRowIndex(\"next\" === direction ? rowIndex : rowIndex - 1);\r\n                        var isCellElementsEquals = $currentCell && $targetCell && $currentCell.get(0) === $targetCell.get(0);\r\n                        return adaptiveController.isAdaptiveDetailRowExpanded(key) && isCellElementsEquals\r\n                    }\r\n                    return result\r\n                },\r\n                init: function() {\r\n                    this.callBase();\r\n                    this._adaptiveController = this.getController(\"adaptiveColumns\")\r\n                }\r\n            }\r\n        }\r\n    }\r\n};\r\n"]},"metadata":{},"sourceType":"script"}