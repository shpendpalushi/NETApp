{"ast":null,"code":"/**\r\n * DevExtreme (ui/tree_list/ui.tree_list.editing.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nrequire(\"./ui.tree_list.editor_factory\");\n\nvar _renderer = require(\"../../core/renderer\");\n\nvar _renderer2 = _interopRequireDefault(_renderer);\n\nvar _ui = require(\"../widget/ui.errors\");\n\nvar _ui2 = _interopRequireDefault(_ui);\n\nvar _type = require(\"../../core/utils/type\");\n\nvar _extend = require(\"../../core/utils/extend\");\n\nvar _deferred = require(\"../../core/utils/deferred\");\n\nvar _message = require(\"../../localization/message\");\n\nvar _message2 = _interopRequireDefault(_message);\n\nvar _uiTree_list = require(\"./ui.tree_list.core\");\n\nvar _uiTree_list2 = _interopRequireDefault(_uiTree_list);\n\nvar _uiGrid_core = require(\"../grid_core/ui.grid_core.utils\");\n\nvar _uiGrid_core2 = _interopRequireDefault(_uiGrid_core);\n\nvar _uiGrid_core3 = require(\"../grid_core/ui.grid_core.editing\");\n\nvar _uiGrid_core4 = _interopRequireDefault(_uiGrid_core3);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nvar TREELIST_EXPAND_ICON_CONTAINER_CLASS = \"dx-treelist-icon-container\";\nvar SELECT_CHECKBOX_CLASS = \"dx-select-checkbox\";\nvar DATA_EDIT_DATA_INSERT_TYPE = \"insert\";\n\nvar EditingController = _uiGrid_core4.default.controllers.editing.inherit(function () {\n  return {\n    _generateNewItem: function _generateNewItem(key) {\n      var item = this.callBase(key);\n      item.data = {\n        key: key\n      };\n      item.children = [];\n      item.level = 0;\n      item.parentKey = this.option(\"rootValue\");\n      return item;\n    },\n    _needInsertItem: function _needInsertItem(editData, changeType, items, item) {\n      var parentKey = editData.key.parentKey;\n\n      if (void 0 !== parentKey && parentKey !== this.option(\"rootValue\")) {\n        var rowIndex = _uiGrid_core2.default.getIndexByKey(parentKey, items);\n\n        if (rowIndex >= 0 && this._dataController.isRowExpanded(parentKey)) {\n          items.splice(rowIndex + 1, 0, item);\n        }\n\n        return false;\n      }\n\n      return this.callBase.apply(this, arguments);\n    },\n    _isEditColumnVisible: function _isEditColumnVisible() {\n      var result = this.callBase.apply(this, arguments);\n      var editingOptions = this.option(\"editing\");\n      return result || editingOptions && editingOptions.allowAdding;\n    },\n    _isDefaultButtonVisible: function _isDefaultButtonVisible(button, options) {\n      var result = this.callBase.apply(this, arguments);\n      var row = options.row;\n\n      if (\"add\" === button.name) {\n        return this.allowAdding(options) && row.rowIndex !== this._getVisibleEditRowIndex() && !(row.removed || row.isNewRow);\n      }\n\n      return result;\n    },\n    _getEditingButtons: function _getEditingButtons(options) {\n      var buttons = this.callBase.apply(this, arguments);\n\n      if (!options.column.buttons) {\n        buttons.unshift(this._getButtonConfig(\"add\", options));\n      }\n\n      return buttons;\n    },\n    _beforeSaveEditData: function _beforeSaveEditData(editData) {\n      var key;\n      var store;\n      var dataController = this._dataController;\n      var result = this.callBase.apply(this, arguments);\n\n      if (editData && editData.type !== DATA_EDIT_DATA_INSERT_TYPE) {\n        store = dataController && dataController.store();\n        key = store && store.key();\n\n        if (!(0, _type.isDefined)(key)) {\n          throw _ui2.default.Error(\"E1045\");\n        }\n      }\n\n      return result;\n    },\n    addRowByRowIndex: function addRowByRowIndex(rowIndex) {\n      var dataController = this.getController(\"data\");\n      var row = dataController.getVisibleRows()[rowIndex];\n      return this.addRow(row ? row.key : void 0);\n    },\n    addRow: function addRow(key) {\n      var that = this;\n      var callBase = that.callBase;\n      var dataController = that.getController(\"data\");\n\n      if (void 0 !== key && !dataController.isRowExpanded(key)) {\n        var d = new _deferred.Deferred();\n        dataController.expandRow(key).done(function () {\n          setTimeout(function () {\n            callBase.call(that, key);\n            d.resolve();\n          });\n        }).fail(d.reject);\n        return d;\n      }\n\n      if (void 0 === key) {\n        key = that.option(\"rootValue\");\n      }\n\n      callBase.call(that, key);\n    },\n    _initNewRow: function _initNewRow(options, parentKey) {\n      var dataController = this.getController(\"data\");\n      var dataSourceAdapter = dataController.dataSource();\n      var parentIdSetter = dataSourceAdapter.createParentIdSetter();\n      parentIdSetter(options.data, parentKey);\n      this.callBase.apply(this, arguments);\n    },\n    allowAdding: function allowAdding(options) {\n      return this._allowEditAction(\"allowAdding\", options);\n    },\n    _needToCloseEditableCell: function _needToCloseEditableCell($targetElement) {\n      return this.callBase.apply(this, arguments) || $targetElement.closest(\".\" + TREELIST_EXPAND_ICON_CONTAINER_CLASS).length && this.isEditing();\n    },\n    getButtonLocalizationNames: function getButtonLocalizationNames() {\n      var names = this.callBase.apply(this);\n      names.add = \"dxTreeList-editingAddRowToNode\";\n      return names;\n    }\n  };\n}());\n\nvar originalRowClick = _uiGrid_core4.default.extenders.views.rowsView._rowClick;\nvar originalRowDblClick = _uiGrid_core4.default.extenders.views.rowsView._rowDblClick;\n\nvar validateClick = function validateClick(e) {\n  var $targetElement = (0, _renderer2.default)(e.event.target);\n  var originalClickHandler = \"dxdblclick\" === e.event.type ? originalRowDblClick : originalRowClick;\n\n  if ($targetElement.closest(\".\" + SELECT_CHECKBOX_CLASS).length) {\n    return false;\n  }\n\n  return !needToCallOriginalClickHandler.call(this, e, originalClickHandler);\n};\n\nvar needToCallOriginalClickHandler = function needToCallOriginalClickHandler(e, originalClickHandler) {\n  var $targetElement = (0, _renderer2.default)(e.event.target);\n\n  if (!$targetElement.closest(\".\" + TREELIST_EXPAND_ICON_CONTAINER_CLASS).length) {\n    originalClickHandler.call(this, e);\n    return true;\n  }\n\n  return false;\n};\n\nvar RowsViewExtender = (0, _extend.extend)({}, _uiGrid_core4.default.extenders.views.rowsView, {\n  _renderCellCommandContent: function _renderCellCommandContent($container, options) {\n    var editingController = this._editingController;\n    var isEditRow = options.row && editingController.isEditRow(options.row.rowIndex);\n    var isEditing = options.isEditing || isEditRow;\n\n    if (!isEditing) {\n      return this.callBase.apply(this, arguments);\n    }\n\n    return false;\n  },\n  _rowClick: function _rowClick(e) {\n    if (validateClick.call(this, e)) {\n      this.callBase.apply(this, arguments);\n    }\n  },\n  _rowDblClick: function _rowDblClick(e) {\n    if (validateClick.call(this, e)) {\n      this.callBase.apply(this, arguments);\n    }\n  }\n});\n\n_uiTree_list2.default.registerModule(\"editing\", {\n  defaultOptions: function defaultOptions() {\n    return (0, _extend.extend)(true, _uiGrid_core4.default.defaultOptions(), {\n      editing: {\n        texts: {\n          addRowToNode: _message2.default.format(\"dxTreeList-editingAddRowToNode\")\n        }\n      }\n    });\n  },\n  controllers: {\n    editing: EditingController\n  },\n  extenders: {\n    controllers: (0, _extend.extend)(true, {}, _uiGrid_core4.default.extenders.controllers, {\n      data: {\n        changeRowExpand: function changeRowExpand() {\n          this._editingController.refresh();\n\n          return this.callBase.apply(this, arguments);\n        }\n      }\n    }),\n    views: {\n      rowsView: RowsViewExtender,\n      headerPanel: _uiGrid_core4.default.extenders.views.headerPanel\n    }\n  }\n});","map":{"version":3,"sources":["C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/devextreme/ui/tree_list/ui.tree_list.editing.js"],"names":["require","_renderer","_renderer2","_interopRequireDefault","_ui","_ui2","_type","_extend","_deferred","_message","_message2","_uiTree_list","_uiTree_list2","_uiGrid_core","_uiGrid_core2","_uiGrid_core3","_uiGrid_core4","obj","__esModule","TREELIST_EXPAND_ICON_CONTAINER_CLASS","SELECT_CHECKBOX_CLASS","DATA_EDIT_DATA_INSERT_TYPE","EditingController","default","controllers","editing","inherit","_generateNewItem","key","item","callBase","data","children","level","parentKey","option","_needInsertItem","editData","changeType","items","rowIndex","getIndexByKey","_dataController","isRowExpanded","splice","apply","arguments","_isEditColumnVisible","result","editingOptions","allowAdding","_isDefaultButtonVisible","button","options","row","name","_getVisibleEditRowIndex","removed","isNewRow","_getEditingButtons","buttons","column","unshift","_getButtonConfig","_beforeSaveEditData","store","dataController","type","isDefined","Error","addRowByRowIndex","getController","getVisibleRows","addRow","that","d","Deferred","expandRow","done","setTimeout","call","resolve","fail","reject","_initNewRow","dataSourceAdapter","dataSource","parentIdSetter","createParentIdSetter","_allowEditAction","_needToCloseEditableCell","$targetElement","closest","length","isEditing","getButtonLocalizationNames","names","add","originalRowClick","extenders","views","rowsView","_rowClick","originalRowDblClick","_rowDblClick","validateClick","e","event","target","originalClickHandler","needToCallOriginalClickHandler","RowsViewExtender","extend","_renderCellCommandContent","$container","editingController","_editingController","isEditRow","registerModule","defaultOptions","texts","addRowToNode","format","changeRowExpand","refresh","headerPanel"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/tree_list/ui.tree_list.editing.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nrequire(\"./ui.tree_list.editor_factory\");\r\nvar _renderer = require(\"../../core/renderer\");\r\nvar _renderer2 = _interopRequireDefault(_renderer);\r\nvar _ui = require(\"../widget/ui.errors\");\r\nvar _ui2 = _interopRequireDefault(_ui);\r\nvar _type = require(\"../../core/utils/type\");\r\nvar _extend = require(\"../../core/utils/extend\");\r\nvar _deferred = require(\"../../core/utils/deferred\");\r\nvar _message = require(\"../../localization/message\");\r\nvar _message2 = _interopRequireDefault(_message);\r\nvar _uiTree_list = require(\"./ui.tree_list.core\");\r\nvar _uiTree_list2 = _interopRequireDefault(_uiTree_list);\r\nvar _uiGrid_core = require(\"../grid_core/ui.grid_core.utils\");\r\nvar _uiGrid_core2 = _interopRequireDefault(_uiGrid_core);\r\nvar _uiGrid_core3 = require(\"../grid_core/ui.grid_core.editing\");\r\nvar _uiGrid_core4 = _interopRequireDefault(_uiGrid_core3);\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\nvar TREELIST_EXPAND_ICON_CONTAINER_CLASS = \"dx-treelist-icon-container\";\r\nvar SELECT_CHECKBOX_CLASS = \"dx-select-checkbox\";\r\nvar DATA_EDIT_DATA_INSERT_TYPE = \"insert\";\r\nvar EditingController = _uiGrid_core4.default.controllers.editing.inherit(function() {\r\n    return {\r\n        _generateNewItem: function(key) {\r\n            var item = this.callBase(key);\r\n            item.data = {\r\n                key: key\r\n            };\r\n            item.children = [];\r\n            item.level = 0;\r\n            item.parentKey = this.option(\"rootValue\");\r\n            return item\r\n        },\r\n        _needInsertItem: function(editData, changeType, items, item) {\r\n            var parentKey = editData.key.parentKey;\r\n            if (void 0 !== parentKey && parentKey !== this.option(\"rootValue\")) {\r\n                var rowIndex = _uiGrid_core2.default.getIndexByKey(parentKey, items);\r\n                if (rowIndex >= 0 && this._dataController.isRowExpanded(parentKey)) {\r\n                    items.splice(rowIndex + 1, 0, item)\r\n                }\r\n                return false\r\n            }\r\n            return this.callBase.apply(this, arguments)\r\n        },\r\n        _isEditColumnVisible: function() {\r\n            var result = this.callBase.apply(this, arguments);\r\n            var editingOptions = this.option(\"editing\");\r\n            return result || editingOptions && editingOptions.allowAdding\r\n        },\r\n        _isDefaultButtonVisible: function(button, options) {\r\n            var result = this.callBase.apply(this, arguments);\r\n            var row = options.row;\r\n            if (\"add\" === button.name) {\r\n                return this.allowAdding(options) && row.rowIndex !== this._getVisibleEditRowIndex() && !(row.removed || row.isNewRow)\r\n            }\r\n            return result\r\n        },\r\n        _getEditingButtons: function(options) {\r\n            var buttons = this.callBase.apply(this, arguments);\r\n            if (!options.column.buttons) {\r\n                buttons.unshift(this._getButtonConfig(\"add\", options))\r\n            }\r\n            return buttons\r\n        },\r\n        _beforeSaveEditData: function(editData) {\r\n            var key;\r\n            var store;\r\n            var dataController = this._dataController;\r\n            var result = this.callBase.apply(this, arguments);\r\n            if (editData && editData.type !== DATA_EDIT_DATA_INSERT_TYPE) {\r\n                store = dataController && dataController.store();\r\n                key = store && store.key();\r\n                if (!(0, _type.isDefined)(key)) {\r\n                    throw _ui2.default.Error(\"E1045\")\r\n                }\r\n            }\r\n            return result\r\n        },\r\n        addRowByRowIndex: function(rowIndex) {\r\n            var dataController = this.getController(\"data\");\r\n            var row = dataController.getVisibleRows()[rowIndex];\r\n            return this.addRow(row ? row.key : void 0)\r\n        },\r\n        addRow: function(key) {\r\n            var that = this;\r\n            var callBase = that.callBase;\r\n            var dataController = that.getController(\"data\");\r\n            if (void 0 !== key && !dataController.isRowExpanded(key)) {\r\n                var d = new _deferred.Deferred;\r\n                dataController.expandRow(key).done(function() {\r\n                    setTimeout(function() {\r\n                        callBase.call(that, key);\r\n                        d.resolve()\r\n                    })\r\n                }).fail(d.reject);\r\n                return d\r\n            }\r\n            if (void 0 === key) {\r\n                key = that.option(\"rootValue\")\r\n            }\r\n            callBase.call(that, key)\r\n        },\r\n        _initNewRow: function(options, parentKey) {\r\n            var dataController = this.getController(\"data\");\r\n            var dataSourceAdapter = dataController.dataSource();\r\n            var parentIdSetter = dataSourceAdapter.createParentIdSetter();\r\n            parentIdSetter(options.data, parentKey);\r\n            this.callBase.apply(this, arguments)\r\n        },\r\n        allowAdding: function(options) {\r\n            return this._allowEditAction(\"allowAdding\", options)\r\n        },\r\n        _needToCloseEditableCell: function($targetElement) {\r\n            return this.callBase.apply(this, arguments) || $targetElement.closest(\".\" + TREELIST_EXPAND_ICON_CONTAINER_CLASS).length && this.isEditing()\r\n        },\r\n        getButtonLocalizationNames: function() {\r\n            var names = this.callBase.apply(this);\r\n            names.add = \"dxTreeList-editingAddRowToNode\";\r\n            return names\r\n        }\r\n    }\r\n}());\r\nvar originalRowClick = _uiGrid_core4.default.extenders.views.rowsView._rowClick;\r\nvar originalRowDblClick = _uiGrid_core4.default.extenders.views.rowsView._rowDblClick;\r\nvar validateClick = function(e) {\r\n    var $targetElement = (0, _renderer2.default)(e.event.target);\r\n    var originalClickHandler = \"dxdblclick\" === e.event.type ? originalRowDblClick : originalRowClick;\r\n    if ($targetElement.closest(\".\" + SELECT_CHECKBOX_CLASS).length) {\r\n        return false\r\n    }\r\n    return !needToCallOriginalClickHandler.call(this, e, originalClickHandler)\r\n};\r\nvar needToCallOriginalClickHandler = function(e, originalClickHandler) {\r\n    var $targetElement = (0, _renderer2.default)(e.event.target);\r\n    if (!$targetElement.closest(\".\" + TREELIST_EXPAND_ICON_CONTAINER_CLASS).length) {\r\n        originalClickHandler.call(this, e);\r\n        return true\r\n    }\r\n    return false\r\n};\r\nvar RowsViewExtender = (0, _extend.extend)({}, _uiGrid_core4.default.extenders.views.rowsView, {\r\n    _renderCellCommandContent: function($container, options) {\r\n        var editingController = this._editingController;\r\n        var isEditRow = options.row && editingController.isEditRow(options.row.rowIndex);\r\n        var isEditing = options.isEditing || isEditRow;\r\n        if (!isEditing) {\r\n            return this.callBase.apply(this, arguments)\r\n        }\r\n        return false\r\n    },\r\n    _rowClick: function(e) {\r\n        if (validateClick.call(this, e)) {\r\n            this.callBase.apply(this, arguments)\r\n        }\r\n    },\r\n    _rowDblClick: function(e) {\r\n        if (validateClick.call(this, e)) {\r\n            this.callBase.apply(this, arguments)\r\n        }\r\n    }\r\n});\r\n_uiTree_list2.default.registerModule(\"editing\", {\r\n    defaultOptions: function() {\r\n        return (0, _extend.extend)(true, _uiGrid_core4.default.defaultOptions(), {\r\n            editing: {\r\n                texts: {\r\n                    addRowToNode: _message2.default.format(\"dxTreeList-editingAddRowToNode\")\r\n                }\r\n            }\r\n        })\r\n    },\r\n    controllers: {\r\n        editing: EditingController\r\n    },\r\n    extenders: {\r\n        controllers: (0, _extend.extend)(true, {}, _uiGrid_core4.default.extenders.controllers, {\r\n            data: {\r\n                changeRowExpand: function() {\r\n                    this._editingController.refresh();\r\n                    return this.callBase.apply(this, arguments)\r\n                }\r\n            }\r\n        }),\r\n        views: {\r\n            rowsView: RowsViewExtender,\r\n            headerPanel: _uiGrid_core4.default.extenders.views.headerPanel\r\n        }\r\n    }\r\n});\r\n"]},"metadata":{},"sourceType":"script"}