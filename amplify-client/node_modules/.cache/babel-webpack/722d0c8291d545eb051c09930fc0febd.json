{"ast":null,"code":"/**\r\n * DevExtreme (viz/tree_map/hover.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar proto = require(\"./tree_map.base\").prototype;\n\nvar nodeProto = require(\"./node\").prototype;\n\nvar expand = require(\"../core/helpers\").expand;\n\nvar common = require(\"./common\");\n\nvar _parseScalar = require(\"../core/utils\").parseScalar;\n\nvar _buildRectAppearance = common.buildRectAppearance;\nvar STATE_CODE = 1;\n\nrequire(\"./api\");\n\nrequire(\"./states\");\n\nproto._eventsMap.onHoverChanged = {\n  name: \"hoverChanged\"\n};\nexpand(proto._handlers, \"calculateAdditionalStates\", function (states, options) {\n  states[1] = options.hoverStyle ? _buildRectAppearance(options.hoverStyle) : {};\n});\n\nrequire(\"./tree_map.base\").addChange({\n  code: \"HOVER_ENABLED\",\n  handler: function handler() {\n    var hoverEnabled = _parseScalar(this._getOption(\"hoverEnabled\", true), true);\n\n    if (!hoverEnabled) {\n      this.clearHover();\n    }\n\n    this._hoverEnabled = hoverEnabled;\n  },\n  isThemeDependent: true,\n  isOptionChange: true,\n  option: \"hoverEnabled\"\n});\n\nnodeProto.statesMap[1] = 1;\nnodeProto.additionalStates.push(1);\nexpand(proto, \"_extendProxyType\", function (proto) {\n  var that = this;\n\n  proto.setHover = function () {\n    that._hoverNode(this._id);\n  };\n\n  proto.isHovered = function () {\n    return that._hoverIndex === this._id;\n  };\n});\nexpand(proto, \"_onNodesCreated\", function () {\n  this._hoverIndex = -1;\n});\nexpand(proto, \"_changeGroupSettings\", function () {\n  var that = this;\n  that._groupHoverEnabled = _parseScalar(that._getOption(\"group\").hoverEnabled, true);\n\n  if (!that._groupHoverEnabled) {\n    that.clearHover();\n  }\n});\n\nproto._applyHoverState = function (index, state) {\n  setNodeStateRecursive(this._nodes[index], STATE_CODE, state);\n\n  this._eventTrigger(\"hoverChanged\", {\n    node: this._nodes[index].proxy\n  });\n};\n\nfunction setNodeStateRecursive(node, code, state) {\n  var nodes = node.isNode() && node.nodes;\n  var i;\n  var ii = nodes && nodes.length;\n  node.setState(code, state);\n\n  for (i = 0; i < ii; ++i) {\n    setNodeStateRecursive(nodes[i], code, state);\n  }\n}\n\nproto._hoverNode = function (index) {\n  var that = this;\n  var currentIndex = that._hoverIndex;\n\n  if (that._hoverEnabled && currentIndex !== index) {\n    if (!that._groupHoverEnabled && index >= 0 && that._nodes[index].isNode()) {\n      that.clearHover();\n      return;\n    }\n\n    that._context.suspend();\n\n    that._hoverIndex = -1;\n\n    if (currentIndex >= 0) {\n      that._applyHoverState(currentIndex, false);\n    }\n\n    that._hoverIndex = index;\n\n    if (index >= 0) {\n      that._applyHoverState(index, true);\n    }\n\n    that._context.resume();\n  }\n};\n\nproto.clearHover = function () {\n  this._hoverNode(-1);\n};","map":null,"metadata":{},"sourceType":"script"}