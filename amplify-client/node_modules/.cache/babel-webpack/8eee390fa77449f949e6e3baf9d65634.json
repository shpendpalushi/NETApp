{"ast":null,"code":"/**\r\n * DevExtreme (ui/draggable.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n\n    if (\"value\" in descriptor) {\n      descriptor.writable = true;\n    }\n\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) {\n    _defineProperties(Constructor.prototype, protoProps);\n  }\n\n  if (staticProps) {\n    _defineProperties(Constructor, staticProps);\n  }\n\n  return Constructor;\n}\n\nvar $ = require(\"../core/renderer\");\n\nvar window = require(\"../core/utils/window\").getWindow();\n\nvar eventsEngine = require(\"../events/core/events_engine\");\n\nvar stringUtils = require(\"../core/utils/string\");\n\nvar registerComponent = require(\"../core/component_registrator\");\n\nvar translator = require(\"../animation/translator\");\n\nvar Animator = require(\"./scroll_view/animator\");\n\nvar browser = require(\"../core/utils/browser\");\n\nvar dasherize = require(\"../core/utils/inflector\").dasherize;\n\nvar extend = require(\"../core/utils/extend\").extend;\n\nvar DOMComponentWithTemplate = require(\"../core/dom_component_with_template\");\n\nvar getPublicElement = require(\"../core/utils/dom\").getPublicElement;\n\nvar eventUtils = require(\"../events/utils\");\n\nvar pointerEvents = require(\"../events/pointer\");\n\nvar dragEvents = require(\"../events/drag\");\n\nvar positionUtils = require(\"../animation/position\");\n\nvar typeUtils = require(\"../core/utils/type\");\n\nvar noop = require(\"../core/utils/common\").noop;\n\nvar viewPortUtils = require(\"../core/utils/view_port\");\n\nvar commonUtils = require(\"../core/utils/common\");\n\nvar EmptyTemplate = require(\"../core/templates/empty_template\").EmptyTemplate;\n\nvar deferredUtils = require(\"../core/utils/deferred\");\n\nvar when = deferredUtils.when;\nvar fromPromise = deferredUtils.fromPromise;\nvar DRAGGABLE = \"dxDraggable\";\nvar DRAGSTART_EVENT_NAME = eventUtils.addNamespace(dragEvents.start, DRAGGABLE);\nvar DRAG_EVENT_NAME = eventUtils.addNamespace(dragEvents.move, DRAGGABLE);\nvar DRAGEND_EVENT_NAME = eventUtils.addNamespace(dragEvents.end, DRAGGABLE);\nvar DRAG_ENTER_EVENT_NAME = eventUtils.addNamespace(dragEvents.enter, DRAGGABLE);\nvar DRAGEND_LEAVE_EVENT_NAME = eventUtils.addNamespace(dragEvents.leave, DRAGGABLE);\nvar POINTERDOWN_EVENT_NAME = eventUtils.addNamespace(pointerEvents.down, DRAGGABLE);\nvar CLONE_CLASS = \"clone\";\nvar targetDraggable;\nvar sourceDraggable;\n\nvar ScrollHelper = function () {\n  function ScrollHelper(orientation, component) {\n    _classCallCheck(this, ScrollHelper);\n\n    this._preventScroll = true;\n    this._component = component;\n\n    if (\"vertical\" === orientation) {\n      this._scrollValue = \"scrollTop\";\n      this._overFlowAttr = \"overflowY\";\n      this._sizeAttr = \"height\";\n      this._scrollSizeProp = \"scrollHeight\";\n      this._limitProps = {\n        start: \"top\",\n        end: \"bottom\"\n      };\n    } else {\n      this._scrollValue = \"scrollLeft\";\n      this._overFlowAttr = \"overflowX\";\n      this._sizeAttr = \"width\";\n      this._scrollSizeProp = \"scrollWidth\";\n      this._limitProps = {\n        start: \"left\",\n        end: \"right\"\n      };\n    }\n  }\n\n  _createClass(ScrollHelper, [{\n    key: \"updateScrollable\",\n    value: function value(elements, mousePosition) {\n      var that = this;\n\n      if (!elements.some(function (element) {\n        return that._trySetScrollable(element, mousePosition);\n      })) {\n        that._$scrollable = null;\n        that._scrollSpeed = 0;\n      }\n    }\n  }, {\n    key: \"isScrolling\",\n    value: function value() {\n      return !!this._scrollSpeed;\n    }\n  }, {\n    key: \"isScrollable\",\n    value: function value($element) {\n      var that = this;\n      return (\"auto\" === $element.css(that._overFlowAttr) || $element.hasClass(\"dx-scrollable-container\")) && $element.prop(that._scrollSizeProp) > $element[that._sizeAttr]();\n    }\n  }, {\n    key: \"_trySetScrollable\",\n    value: function value(element, mousePosition) {\n      var that = this;\n      var $element = $(element);\n      var distanceToBorders;\n\n      var sensitivity = that._component.option(\"scrollSensitivity\");\n\n      var isScrollable = that.isScrollable($element);\n\n      if (isScrollable) {\n        distanceToBorders = that._calculateDistanceToBorders($element, mousePosition);\n\n        if (sensitivity > distanceToBorders[that._limitProps.start]) {\n          if (!that._preventScroll) {\n            that._scrollSpeed = -that._calculateScrollSpeed(distanceToBorders[that._limitProps.start]);\n            that._$scrollable = $element;\n          }\n        } else {\n          if (sensitivity > distanceToBorders[that._limitProps.end]) {\n            if (!that._preventScroll) {\n              that._scrollSpeed = that._calculateScrollSpeed(distanceToBorders[that._limitProps.end]);\n              that._$scrollable = $element;\n            }\n          } else {\n            isScrollable = false;\n            that._preventScroll = false;\n          }\n        }\n      }\n\n      return isScrollable;\n    }\n  }, {\n    key: \"_calculateDistanceToBorders\",\n    value: function value($area, mousePosition) {\n      var area = $area.get(0);\n      var areaBoundingRect;\n\n      if (area) {\n        areaBoundingRect = area.getBoundingClientRect();\n        return {\n          left: mousePosition.x - areaBoundingRect.left,\n          top: mousePosition.y - areaBoundingRect.top,\n          right: areaBoundingRect.right - mousePosition.x,\n          bottom: areaBoundingRect.bottom - mousePosition.y\n        };\n      } else {\n        return {};\n      }\n    }\n  }, {\n    key: \"_calculateScrollSpeed\",\n    value: function value(distance) {\n      var component = this._component;\n      var sensitivity = component.option(\"scrollSensitivity\");\n      var maxSpeed = component.option(\"scrollSpeed\");\n      return Math.ceil(Math.pow((sensitivity - distance) / sensitivity, 2) * maxSpeed);\n    }\n  }, {\n    key: \"scrollByStep\",\n    value: function value() {\n      var that = this;\n      var nextScrollPosition;\n\n      if (that._$scrollable && that._scrollSpeed) {\n        if (that._$scrollable.hasClass(\"dx-scrollable-container\")) {\n          var $scrollable = that._$scrollable.closest(\".dx-scrollable\");\n\n          var scrollableInstance = $scrollable.data(\"dxScrollable\") || $scrollable.data(\"dxScrollView\");\n\n          if (scrollableInstance) {\n            nextScrollPosition = scrollableInstance.scrollOffset();\n            nextScrollPosition[that._limitProps.start] += that._scrollSpeed;\n            scrollableInstance.scrollTo(nextScrollPosition);\n          }\n        } else {\n          nextScrollPosition = that._$scrollable[that._scrollValue]() + that._scrollSpeed;\n\n          that._$scrollable[that._scrollValue](nextScrollPosition);\n        }\n\n        var dragMoveArgs = that._component._dragMoveArgs;\n\n        if (dragMoveArgs) {\n          that._component._dragMoveHandler(dragMoveArgs);\n        }\n      }\n    }\n  }, {\n    key: \"reset\",\n    value: function value() {\n      this._$scrollable = null;\n      this._scrollSpeed = 0;\n      this._preventScroll = true;\n    }\n  }, {\n    key: \"isOutsideScrollable\",\n    value: function value(target, event) {\n      var component = this._component;\n\n      if (!component._$scrollable || !target.closest(component._$scrollable).length) {\n        return false;\n      }\n\n      var scrollableSize = component._$scrollable.get(0).getBoundingClientRect();\n\n      var start = scrollableSize[this._limitProps.start];\n      var size = scrollableSize[this._sizeAttr];\n      var location = \"width\" === this._sizeAttr ? event.pageX : event.pageY;\n      return location < start || location > start + size;\n    }\n  }]);\n\n  return ScrollHelper;\n}();\n\nvar ScrollAnimator = Animator.inherit({\n  ctor: function ctor(strategy) {\n    this.callBase();\n    this._strategy = strategy;\n  },\n  _step: function _step() {\n    var horizontalScrollHelper = this._strategy._horizontalScrollHelper;\n    var verticalScrollHelper = this._strategy._verticalScrollHelper;\n    horizontalScrollHelper && horizontalScrollHelper.scrollByStep();\n    verticalScrollHelper && verticalScrollHelper.scrollByStep();\n  }\n});\nvar Draggable = DOMComponentWithTemplate.inherit({\n  reset: noop,\n  dragMove: noop,\n  dragEnter: noop,\n  dragLeave: noop,\n  dragEnd: function dragEnd(sourceEvent) {\n    var sourceDraggable = this._getSourceDraggable();\n\n    sourceDraggable._fireRemoveEvent(sourceEvent);\n  },\n  _fireRemoveEvent: noop,\n  _getDefaultOptions: function _getDefaultOptions() {\n    return extend(this.callBase(), {\n      onDragStart: null,\n      onDragMove: null,\n      onDragEnd: null,\n      onDrop: null,\n      immediate: true,\n      dragDirection: \"both\",\n      boundary: void 0,\n      boundOffset: 0,\n      allowMoveByClick: false,\n      itemData: null,\n      container: void 0,\n      dragTemplate: void 0,\n      contentTemplate: \"content\",\n      handle: \"\",\n      filter: \"\",\n      clone: false,\n      autoScroll: true,\n      scrollSpeed: 30,\n      scrollSensitivity: 60,\n      group: void 0,\n      data: void 0\n    });\n  },\n  _setOptionsByReference: function _setOptionsByReference() {\n    this.callBase.apply(this, arguments);\n    extend(this._optionsByReference, {\n      component: true,\n      group: true,\n      itemData: true,\n      data: true\n    });\n  },\n  _init: function _init() {\n    this.callBase();\n\n    this._attachEventHandlers();\n\n    this._scrollAnimator = new ScrollAnimator(this);\n    this._horizontalScrollHelper = new ScrollHelper(\"horizontal\", this);\n    this._verticalScrollHelper = new ScrollHelper(\"vertical\", this);\n  },\n  _normalizeCursorOffset: function _normalizeCursorOffset(offset) {\n    if (typeUtils.isObject(offset)) {\n      offset = {\n        h: offset.x,\n        v: offset.y\n      };\n    }\n\n    offset = commonUtils.splitPair(offset).map(function (value) {\n      return parseFloat(value);\n    });\n    return {\n      left: offset[0],\n      top: 1 === offset.length ? offset[0] : offset[1]\n    };\n  },\n  _getNormalizedCursorOffset: function _getNormalizedCursorOffset(offset, options) {\n    if (typeUtils.isFunction(offset)) {\n      offset = offset.call(this, options);\n    }\n\n    return this._normalizeCursorOffset(offset);\n  },\n  _calculateElementOffset: function _calculateElementOffset(options) {\n    var elementOffset;\n    var dragElementOffset;\n    var event = options.event;\n    var $element = $(options.itemElement);\n    var $dragElement = $(options.dragElement);\n\n    var isCloned = this._dragElementIsCloned();\n\n    var cursorOffset = this.option(\"cursorOffset\");\n    var normalizedCursorOffset = {\n      left: 0,\n      top: 0\n    };\n    var currentLocate = this._initialLocate = translator.locate($dragElement);\n\n    if (isCloned || options.initialOffset || cursorOffset) {\n      elementOffset = options.initialOffset || $element.offset();\n\n      if (cursorOffset) {\n        normalizedCursorOffset = this._getNormalizedCursorOffset(cursorOffset, options);\n\n        if (isFinite(normalizedCursorOffset.left)) {\n          elementOffset.left = event.pageX;\n        }\n\n        if (isFinite(normalizedCursorOffset.top)) {\n          elementOffset.top = event.pageY;\n        }\n      }\n\n      dragElementOffset = $dragElement.offset();\n      elementOffset.top -= dragElementOffset.top + (normalizedCursorOffset.top || 0) - currentLocate.top;\n      elementOffset.left -= dragElementOffset.left + (normalizedCursorOffset.left || 0) - currentLocate.left;\n    }\n\n    return elementOffset;\n  },\n  _initPosition: function _initPosition(options) {\n    var $dragElement = $(options.dragElement);\n\n    var elementOffset = this._calculateElementOffset(options);\n\n    if (elementOffset) {\n      this._move(elementOffset, $dragElement);\n    }\n\n    this._startPosition = translator.locate($dragElement);\n  },\n  _startAnimator: function _startAnimator() {\n    if (!this._scrollAnimator.inProgress()) {\n      this._scrollAnimator.start();\n    }\n  },\n  _stopAnimator: function _stopAnimator() {\n    this._scrollAnimator.stop();\n  },\n  _addWidgetPrefix: function _addWidgetPrefix(className) {\n    var componentName = this.NAME;\n    return dasherize(componentName) + (className ? \"-\" + className : \"\");\n  },\n  _getItemsSelector: function _getItemsSelector() {\n    return this.option(\"filter\") || \"\";\n  },\n  _$content: function _$content() {\n    var $element = this.$element();\n    var $wrapper = $element.children(\".dx-template-wrapper\");\n    return $wrapper.length ? $wrapper : $element;\n  },\n  _attachEventHandlers: function _attachEventHandlers() {\n    var _this = this;\n\n    if (this.option(\"disabled\")) {\n      return;\n    }\n\n    var $element = this._$content();\n\n    var itemsSelector = this._getItemsSelector();\n\n    var allowMoveByClick = this.option(\"allowMoveByClick\");\n    var data = {\n      direction: this.option(\"dragDirection\"),\n      immediate: this.option(\"immediate\"),\n      checkDropTarget: function checkDropTarget(target, event) {\n        var targetGroup = _this.option(\"group\");\n\n        var sourceGroup = _this._getSourceDraggable().option(\"group\");\n\n        if (_this._verticalScrollHelper.isOutsideScrollable(target, event) || _this._horizontalScrollHelper.isOutsideScrollable(target, event)) {\n          return false;\n        }\n\n        return sourceGroup && sourceGroup === targetGroup;\n      }\n    };\n\n    if (allowMoveByClick) {\n      $element = this._getArea();\n      eventsEngine.on($element, POINTERDOWN_EVENT_NAME, data, this._pointerDownHandler.bind(this));\n    }\n\n    if (\">\" === itemsSelector[0]) {\n      itemsSelector = itemsSelector.slice(1);\n    }\n\n    eventsEngine.on($element, DRAGSTART_EVENT_NAME, itemsSelector, data, this._dragStartHandler.bind(this));\n    eventsEngine.on($element, DRAG_EVENT_NAME, data, this._dragMoveHandler.bind(this));\n    eventsEngine.on($element, DRAGEND_EVENT_NAME, data, this._dragEndHandler.bind(this));\n    eventsEngine.on($element, DRAG_ENTER_EVENT_NAME, data, this._dragEnterHandler.bind(this));\n    eventsEngine.on($element, DRAGEND_LEAVE_EVENT_NAME, data, this._dragLeaveHandler.bind(this));\n  },\n  _dragElementIsCloned: function _dragElementIsCloned() {\n    return this._$dragElement && this._$dragElement.hasClass(this._addWidgetPrefix(CLONE_CLASS));\n  },\n  _getDragTemplateArgs: function _getDragTemplateArgs($element, $container) {\n    return {\n      container: getPublicElement($container),\n      model: {\n        itemData: this.option(\"itemData\"),\n        itemElement: getPublicElement($element)\n      }\n    };\n  },\n  _createDragElement: function _createDragElement($element) {\n    var result = $element;\n    var clone = this.option(\"clone\");\n\n    var $container = this._getContainer();\n\n    var template = this.option(\"dragTemplate\");\n\n    if (template) {\n      template = this._getTemplate(template);\n      result = $(\"<div>\").appendTo($container);\n      template.render(this._getDragTemplateArgs($element, result));\n    } else {\n      if (clone) {\n        result = $(\"<div>\").appendTo($container);\n        $element.clone().css({\n          width: $element.css(\"width\"),\n          height: $element.css(\"height\")\n        }).appendTo(result);\n      }\n    }\n\n    return result.toggleClass(this._addWidgetPrefix(CLONE_CLASS), result.get(0) !== $element.get(0));\n  },\n  _resetDragElement: function _resetDragElement() {\n    if (this._dragElementIsCloned()) {\n      this._$dragElement.remove();\n    } else {\n      this._toggleDraggingClass(false);\n    }\n\n    this._$dragElement = null;\n  },\n  _resetSourceElement: function _resetSourceElement() {\n    this._toggleDragSourceClass(false);\n\n    this._$sourceElement = null;\n  },\n  _detachEventHandlers: function _detachEventHandlers() {\n    eventsEngine.off(this._$content(), \".\" + DRAGGABLE);\n    eventsEngine.off(this._getArea(), \".\" + DRAGGABLE);\n  },\n  _move: function _move(position, $element) {\n    translator.move($element || this._$dragElement, position);\n  },\n  _getDraggableElement: function _getDraggableElement(e) {\n    var $sourceElement = this._getSourceElement();\n\n    if ($sourceElement) {\n      return $sourceElement;\n    }\n\n    var allowMoveByClick = this.option(\"allowMoveByClick\");\n\n    if (allowMoveByClick) {\n      return this.$element();\n    }\n\n    var $target = $(e && e.target);\n\n    var itemsSelector = this._getItemsSelector();\n\n    if (\">\" === itemsSelector[0]) {\n      var $items = this._$content().find(itemsSelector);\n\n      if (!$items.is($target)) {\n        $target = $target.closest($items);\n      }\n    }\n\n    return $target;\n  },\n  _getSourceElement: function _getSourceElement() {\n    var draggable = this._getSourceDraggable();\n\n    return draggable._$sourceElement;\n  },\n  _pointerDownHandler: function _pointerDownHandler(e) {\n    if (eventUtils.needSkipEvent(e)) {\n      return;\n    }\n\n    var position = {};\n    var $element = this.$element();\n    var dragDirection = this.option(\"dragDirection\");\n\n    if (\"horizontal\" === dragDirection || \"both\" === dragDirection) {\n      position.left = e.pageX - $element.offset().left + translator.locate($element).left - $element.width() / 2;\n    }\n\n    if (\"vertical\" === dragDirection || \"both\" === dragDirection) {\n      position.top = e.pageY - $element.offset().top + translator.locate($element).top - $element.height() / 2;\n    }\n\n    this._move(position, $element);\n\n    this._getAction(\"onDragMove\")(this._getEventArgs(e));\n  },\n  _isValidElement: function _isValidElement(event, $element) {\n    var handle = this.option(\"handle\");\n    var $target = $(event.originalEvent && event.originalEvent.target);\n\n    if (handle && !$target.closest(handle).length) {\n      return false;\n    }\n\n    if (!$element.length) {\n      return false;\n    }\n\n    return !$element.is(\".dx-state-disabled, .dx-state-disabled *\");\n  },\n  _dragStartHandler: function _dragStartHandler(e) {\n    var $dragElement;\n    var initialOffset;\n    var isFixedPosition;\n\n    var $element = this._getDraggableElement(e);\n\n    if (this._$sourceElement) {\n      return;\n    }\n\n    if (!this._isValidElement(e, $element)) {\n      e.cancel = true;\n      return;\n    }\n\n    var dragStartArgs = this._getDragStartArgs(e, $element);\n\n    this._getAction(\"onDragStart\")(dragStartArgs);\n\n    if (dragStartArgs.cancel) {\n      e.cancel = true;\n      return;\n    }\n\n    this.option(\"itemData\", dragStartArgs.itemData);\n\n    this._setSourceDraggable();\n\n    this._$sourceElement = $element;\n    initialOffset = $element.offset();\n    $dragElement = this._$dragElement = this._createDragElement($element);\n\n    this._toggleDraggingClass(true);\n\n    this._toggleDragSourceClass(true);\n\n    isFixedPosition = \"fixed\" === $dragElement.css(\"position\");\n\n    this._initPosition(extend({}, dragStartArgs, {\n      dragElement: $dragElement.get(0),\n      initialOffset: isFixedPosition && initialOffset\n    }));\n\n    var $area = this._getArea();\n\n    var areaOffset = this._getAreaOffset($area);\n\n    var boundOffset = this._getBoundOffset();\n\n    var areaWidth = $area.outerWidth();\n    var areaHeight = $area.outerHeight();\n    var elementWidth = $dragElement.width();\n    var elementHeight = $dragElement.height();\n    var startOffset = {\n      left: $dragElement.offset().left - areaOffset.left,\n      top: $dragElement.offset().top - areaOffset.top\n    };\n\n    if ($area.length) {\n      e.maxLeftOffset = startOffset.left - boundOffset.left;\n      e.maxRightOffset = areaWidth - startOffset.left - elementWidth - boundOffset.right;\n      e.maxTopOffset = startOffset.top - boundOffset.top;\n      e.maxBottomOffset = areaHeight - startOffset.top - elementHeight - boundOffset.bottom;\n    }\n\n    if (this.option(\"autoScroll\")) {\n      this._startAnimator();\n    }\n  },\n  _getAreaOffset: function _getAreaOffset($area) {\n    var offset = $area && positionUtils.offset($area);\n    return offset ? offset : {\n      left: 0,\n      top: 0\n    };\n  },\n  _toggleDraggingClass: function _toggleDraggingClass(value) {\n    this._$dragElement && this._$dragElement.toggleClass(this._addWidgetPrefix(\"dragging\"), value);\n  },\n  _toggleDragSourceClass: function _toggleDragSourceClass(value, $element) {\n    var $sourceElement = $element || this._$sourceElement;\n    $sourceElement && $sourceElement.toggleClass(this._addWidgetPrefix(\"source\"), value);\n  },\n  _getBoundOffset: function _getBoundOffset() {\n    var boundOffset = this.option(\"boundOffset\");\n\n    if (typeUtils.isFunction(boundOffset)) {\n      boundOffset = boundOffset.call(this);\n    }\n\n    return stringUtils.quadToObject(boundOffset);\n  },\n  _getArea: function _getArea() {\n    var area = this.option(\"boundary\");\n\n    if (typeUtils.isFunction(area)) {\n      area = area.call(this);\n    }\n\n    return $(area);\n  },\n  _getContainer: function _getContainer() {\n    var container = this.option(\"container\");\n\n    if (void 0 === container) {\n      container = viewPortUtils.value();\n    }\n\n    return $(container);\n  },\n  _dragMoveHandler: function _dragMoveHandler(e) {\n    this._dragMoveArgs = e;\n\n    if (!this._$dragElement) {\n      e.cancel = true;\n      return;\n    }\n\n    var offset = e.offset;\n    var startPosition = this._startPosition;\n\n    this._move({\n      left: startPosition.left + offset.x,\n      top: startPosition.top + offset.y\n    });\n\n    this._updateScrollable(e);\n\n    var eventArgs = this._getEventArgs(e);\n\n    this._getAction(\"onDragMove\")(eventArgs);\n\n    if (true === eventArgs.cancel) {\n      return;\n    }\n\n    var targetDraggable = this._getTargetDraggable();\n\n    targetDraggable.dragMove(e);\n  },\n  _updateScrollable: function _updateScrollable(e) {\n    var that = this;\n\n    var $sourceElement = that._getSourceElement();\n\n    that._$scrollable = null;\n    $sourceElement.parents().toArray().some(function (element) {\n      var $element = $(element);\n\n      if (that._horizontalScrollHelper.isScrollable($element) || that._verticalScrollHelper.isScrollable($element)) {\n        that._$scrollable = $element;\n        return true;\n      }\n    });\n\n    if (that.option(\"autoScroll\")) {\n      var $window = $(window);\n      var mousePosition = {\n        x: e.pageX - $window.scrollLeft(),\n        y: e.pageY - $window.scrollTop()\n      };\n      var allObjects = that.getElementsFromPoint(mousePosition);\n\n      that._verticalScrollHelper.updateScrollable(allObjects, mousePosition);\n\n      that._horizontalScrollHelper.updateScrollable(allObjects, mousePosition);\n    }\n  },\n  getElementsFromPoint: function getElementsFromPoint(position) {\n    var ownerDocument = this._$dragElement.get(0).ownerDocument;\n\n    if (browser.msie) {\n      var msElements = ownerDocument.msElementsFromPoint(position.x, position.y);\n\n      if (msElements) {\n        return Array.prototype.slice.call(msElements);\n      }\n\n      return [];\n    }\n\n    return ownerDocument.elementsFromPoint(position.x, position.y);\n  },\n  _defaultActionArgs: function _defaultActionArgs() {\n    var args = this.callBase.apply(this, arguments);\n    var component = this.option(\"component\");\n\n    if (component) {\n      args.component = component;\n      args.element = component.element();\n    }\n\n    return args;\n  },\n  _getEventArgs: function _getEventArgs(e) {\n    var sourceDraggable = this._getSourceDraggable();\n\n    var targetDraggable = this._getTargetDraggable();\n\n    return {\n      event: e,\n      itemData: sourceDraggable.option(\"itemData\"),\n      itemElement: getPublicElement(sourceDraggable._$sourceElement),\n      fromComponent: sourceDraggable.option(\"component\") || sourceDraggable,\n      toComponent: targetDraggable.option(\"component\") || targetDraggable,\n      fromData: sourceDraggable.option(\"data\"),\n      toData: targetDraggable.option(\"data\")\n    };\n  },\n  _getDragStartArgs: function _getDragStartArgs(e, $itemElement) {\n    var args = this._getEventArgs(e);\n\n    return {\n      event: args.event,\n      itemData: args.itemData,\n      itemElement: $itemElement,\n      fromData: args.fromData\n    };\n  },\n  _revertItemToInitialPosition: function _revertItemToInitialPosition() {\n    !this._dragElementIsCloned() && this._move(this._initialLocate, this._$sourceElement);\n  },\n  _dragEndHandler: function _dragEndHandler(e) {\n    var _this2 = this;\n\n    var dragEndEventArgs = this._getEventArgs(e);\n\n    var dropEventArgs = this._getEventArgs(e);\n\n    var targetDraggable = this._getTargetDraggable();\n\n    var needRevertPosition = true;\n\n    try {\n      this._getAction(\"onDragEnd\")(dragEndEventArgs);\n    } finally {\n      when(fromPromise(dragEndEventArgs.cancel)).done(function (cancel) {\n        if (!cancel) {\n          if (targetDraggable !== _this2) {\n            targetDraggable._getAction(\"onDrop\")(dropEventArgs);\n          }\n\n          if (!dropEventArgs.cancel) {\n            targetDraggable.dragEnd(dragEndEventArgs);\n            needRevertPosition = false;\n          }\n        }\n      }).always(function () {\n        if (needRevertPosition) {\n          _this2._revertItemToInitialPosition();\n        }\n\n        _this2.reset();\n\n        targetDraggable.reset();\n\n        _this2._stopAnimator();\n\n        _this2._horizontalScrollHelper.reset();\n\n        _this2._verticalScrollHelper.reset();\n\n        _this2._resetDragElement();\n\n        _this2._resetSourceElement();\n\n        _this2._resetTargetDraggable();\n\n        _this2._resetSourceDraggable();\n      });\n    }\n  },\n  _dragEnterHandler: function _dragEnterHandler(e) {\n    this._setTargetDraggable();\n\n    var sourceDraggable = this._getSourceDraggable();\n\n    sourceDraggable.dragEnter(e);\n  },\n  _dragLeaveHandler: function _dragLeaveHandler(e) {\n    this._resetTargetDraggable();\n\n    if (this !== this._getSourceDraggable()) {\n      this.reset();\n    }\n\n    var sourceDraggable = this._getSourceDraggable();\n\n    sourceDraggable.dragLeave(e);\n  },\n  _getAction: function _getAction(name) {\n    return this[\"_\" + name + \"Action\"] || this._createActionByOption(name);\n  },\n  _getAnonymousTemplateName: function _getAnonymousTemplateName() {\n    return \"content\";\n  },\n  _initTemplates: function _initTemplates() {\n    if (!this.option(\"contentTemplate\")) {\n      return;\n    }\n\n    this.callBase.apply(this, arguments);\n    this._defaultTemplates.content = new EmptyTemplate();\n  },\n  _render: function _render() {\n    this.callBase();\n    this.$element().addClass(this._addWidgetPrefix());\n    var transclude = this._getAnonymousTemplateName() === this.option(\"contentTemplate\");\n\n    var template = this._getTemplateByOption(\"contentTemplate\");\n\n    if (template) {\n      $(template.render({\n        container: this.element(),\n        transclude: transclude\n      }));\n    }\n  },\n  _optionChanged: function _optionChanged(args) {\n    var name = args.name;\n\n    switch (name) {\n      case \"onDragStart\":\n      case \"onDragMove\":\n      case \"onDragEnd\":\n      case \"onDrop\":\n        this[\"_\" + name + \"Action\"] = this._createActionByOption(name);\n        break;\n\n      case \"dragTemplate\":\n      case \"contentTemplate\":\n      case \"container\":\n      case \"clone\":\n        this._resetDragElement();\n\n        break;\n\n      case \"allowMoveByClick\":\n      case \"dragDirection\":\n      case \"disabled\":\n      case \"boundary\":\n      case \"filter\":\n      case \"immediate\":\n        this._resetDragElement();\n\n        this._detachEventHandlers();\n\n        this._attachEventHandlers();\n\n        break;\n\n      case \"autoScroll\":\n        this._verticalScrollHelper.reset();\n\n        this._horizontalScrollHelper.reset();\n\n        break;\n\n      case \"scrollSensitivity\":\n      case \"scrollSpeed\":\n      case \"boundOffset\":\n      case \"handle\":\n      case \"group\":\n      case \"data\":\n      case \"itemData\":\n        break;\n\n      default:\n        this.callBase(args);\n    }\n  },\n  _getTargetDraggable: function _getTargetDraggable() {\n    return targetDraggable || this;\n  },\n  _getSourceDraggable: function _getSourceDraggable() {\n    return sourceDraggable || this;\n  },\n  _setTargetDraggable: function _setTargetDraggable() {\n    var currentGroup = this.option(\"group\");\n\n    var sourceDraggable = this._getSourceDraggable();\n\n    if (currentGroup && currentGroup === sourceDraggable.option(\"group\")) {\n      targetDraggable = this;\n    }\n  },\n  _setSourceDraggable: function _setSourceDraggable() {\n    sourceDraggable = this;\n  },\n  _resetSourceDraggable: function _resetSourceDraggable() {\n    sourceDraggable = null;\n  },\n  _resetTargetDraggable: function _resetTargetDraggable() {\n    targetDraggable = null;\n  },\n  _dispose: function _dispose() {\n    this.callBase();\n\n    this._detachEventHandlers();\n\n    this._resetDragElement();\n\n    this._resetTargetDraggable();\n\n    this._resetSourceDraggable();\n\n    this._$sourceElement = null;\n\n    this._stopAnimator();\n  }\n});\nregisterComponent(DRAGGABLE, Draggable);\nmodule.exports = Draggable;\nmodule.exports.default = module.exports;","map":{"version":3,"sources":["C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/devextreme/ui/draggable.js"],"names":["_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","_createClass","protoProps","staticProps","prototype","$","require","window","getWindow","eventsEngine","stringUtils","registerComponent","translator","Animator","browser","dasherize","extend","DOMComponentWithTemplate","getPublicElement","eventUtils","pointerEvents","dragEvents","positionUtils","typeUtils","noop","viewPortUtils","commonUtils","EmptyTemplate","deferredUtils","when","fromPromise","DRAGGABLE","DRAGSTART_EVENT_NAME","addNamespace","start","DRAG_EVENT_NAME","move","DRAGEND_EVENT_NAME","end","DRAG_ENTER_EVENT_NAME","enter","DRAGEND_LEAVE_EVENT_NAME","leave","POINTERDOWN_EVENT_NAME","down","CLONE_CLASS","targetDraggable","sourceDraggable","ScrollHelper","orientation","component","_preventScroll","_component","_scrollValue","_overFlowAttr","_sizeAttr","_scrollSizeProp","_limitProps","value","elements","mousePosition","that","some","element","_trySetScrollable","_$scrollable","_scrollSpeed","$element","css","hasClass","prop","distanceToBorders","sensitivity","option","isScrollable","_calculateDistanceToBorders","_calculateScrollSpeed","$area","area","get","areaBoundingRect","getBoundingClientRect","left","x","top","y","right","bottom","distance","maxSpeed","Math","ceil","pow","nextScrollPosition","$scrollable","closest","scrollableInstance","data","scrollOffset","scrollTo","dragMoveArgs","_dragMoveArgs","_dragMoveHandler","event","scrollableSize","size","location","pageX","pageY","ScrollAnimator","inherit","ctor","strategy","callBase","_strategy","_step","horizontalScrollHelper","_horizontalScrollHelper","verticalScrollHelper","_verticalScrollHelper","scrollByStep","Draggable","reset","dragMove","dragEnter","dragLeave","dragEnd","sourceEvent","_getSourceDraggable","_fireRemoveEvent","_getDefaultOptions","onDragStart","onDragMove","onDragEnd","onDrop","immediate","dragDirection","boundary","boundOffset","allowMoveByClick","itemData","container","dragTemplate","contentTemplate","handle","filter","clone","autoScroll","scrollSpeed","scrollSensitivity","group","_setOptionsByReference","apply","arguments","_optionsByReference","_init","_attachEventHandlers","_scrollAnimator","_normalizeCursorOffset","offset","isObject","h","v","splitPair","map","parseFloat","_getNormalizedCursorOffset","options","isFunction","call","_calculateElementOffset","elementOffset","dragElementOffset","itemElement","$dragElement","dragElement","isCloned","_dragElementIsCloned","cursorOffset","normalizedCursorOffset","currentLocate","_initialLocate","locate","initialOffset","isFinite","_initPosition","_move","_startPosition","_startAnimator","inProgress","_stopAnimator","stop","_addWidgetPrefix","className","componentName","NAME","_getItemsSelector","_$content","$wrapper","children","_this","itemsSelector","direction","checkDropTarget","targetGroup","sourceGroup","isOutsideScrollable","_getArea","on","_pointerDownHandler","bind","slice","_dragStartHandler","_dragEndHandler","_dragEnterHandler","_dragLeaveHandler","_$dragElement","_getDragTemplateArgs","$container","model","_createDragElement","result","_getContainer","template","_getTemplate","appendTo","render","width","height","toggleClass","_resetDragElement","remove","_toggleDraggingClass","_resetSourceElement","_toggleDragSourceClass","_$sourceElement","_detachEventHandlers","off","position","_getDraggableElement","e","$sourceElement","_getSourceElement","$target","$items","find","is","draggable","needSkipEvent","_getAction","_getEventArgs","_isValidElement","originalEvent","isFixedPosition","cancel","dragStartArgs","_getDragStartArgs","_setSourceDraggable","areaOffset","_getAreaOffset","_getBoundOffset","areaWidth","outerWidth","areaHeight","outerHeight","elementWidth","elementHeight","startOffset","maxLeftOffset","maxRightOffset","maxTopOffset","maxBottomOffset","quadToObject","startPosition","_updateScrollable","eventArgs","_getTargetDraggable","parents","toArray","$window","scrollLeft","scrollTop","allObjects","getElementsFromPoint","updateScrollable","ownerDocument","msie","msElements","msElementsFromPoint","Array","elementsFromPoint","_defaultActionArgs","args","fromComponent","toComponent","fromData","toData","$itemElement","_revertItemToInitialPosition","_this2","dragEndEventArgs","dropEventArgs","needRevertPosition","done","always","_resetTargetDraggable","_resetSourceDraggable","_setTargetDraggable","name","_createActionByOption","_getAnonymousTemplateName","_initTemplates","_defaultTemplates","content","_render","addClass","transclude","_getTemplateByOption","_optionChanged","currentGroup","_dispose","module","exports","default"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (ui/draggable.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\n\r\nfunction _classCallCheck(instance, Constructor) {\r\n    if (!(instance instanceof Constructor)) {\r\n        throw new TypeError(\"Cannot call a class as a function\")\r\n    }\r\n}\r\n\r\nfunction _defineProperties(target, props) {\r\n    for (var i = 0; i < props.length; i++) {\r\n        var descriptor = props[i];\r\n        descriptor.enumerable = descriptor.enumerable || false;\r\n        descriptor.configurable = true;\r\n        if (\"value\" in descriptor) {\r\n            descriptor.writable = true\r\n        }\r\n        Object.defineProperty(target, descriptor.key, descriptor)\r\n    }\r\n}\r\n\r\nfunction _createClass(Constructor, protoProps, staticProps) {\r\n    if (protoProps) {\r\n        _defineProperties(Constructor.prototype, protoProps)\r\n    }\r\n    if (staticProps) {\r\n        _defineProperties(Constructor, staticProps)\r\n    }\r\n    return Constructor\r\n}\r\nvar $ = require(\"../core/renderer\");\r\nvar window = require(\"../core/utils/window\").getWindow();\r\nvar eventsEngine = require(\"../events/core/events_engine\");\r\nvar stringUtils = require(\"../core/utils/string\");\r\nvar registerComponent = require(\"../core/component_registrator\");\r\nvar translator = require(\"../animation/translator\");\r\nvar Animator = require(\"./scroll_view/animator\");\r\nvar browser = require(\"../core/utils/browser\");\r\nvar dasherize = require(\"../core/utils/inflector\").dasherize;\r\nvar extend = require(\"../core/utils/extend\").extend;\r\nvar DOMComponentWithTemplate = require(\"../core/dom_component_with_template\");\r\nvar getPublicElement = require(\"../core/utils/dom\").getPublicElement;\r\nvar eventUtils = require(\"../events/utils\");\r\nvar pointerEvents = require(\"../events/pointer\");\r\nvar dragEvents = require(\"../events/drag\");\r\nvar positionUtils = require(\"../animation/position\");\r\nvar typeUtils = require(\"../core/utils/type\");\r\nvar noop = require(\"../core/utils/common\").noop;\r\nvar viewPortUtils = require(\"../core/utils/view_port\");\r\nvar commonUtils = require(\"../core/utils/common\");\r\nvar EmptyTemplate = require(\"../core/templates/empty_template\").EmptyTemplate;\r\nvar deferredUtils = require(\"../core/utils/deferred\");\r\nvar when = deferredUtils.when;\r\nvar fromPromise = deferredUtils.fromPromise;\r\nvar DRAGGABLE = \"dxDraggable\";\r\nvar DRAGSTART_EVENT_NAME = eventUtils.addNamespace(dragEvents.start, DRAGGABLE);\r\nvar DRAG_EVENT_NAME = eventUtils.addNamespace(dragEvents.move, DRAGGABLE);\r\nvar DRAGEND_EVENT_NAME = eventUtils.addNamespace(dragEvents.end, DRAGGABLE);\r\nvar DRAG_ENTER_EVENT_NAME = eventUtils.addNamespace(dragEvents.enter, DRAGGABLE);\r\nvar DRAGEND_LEAVE_EVENT_NAME = eventUtils.addNamespace(dragEvents.leave, DRAGGABLE);\r\nvar POINTERDOWN_EVENT_NAME = eventUtils.addNamespace(pointerEvents.down, DRAGGABLE);\r\nvar CLONE_CLASS = \"clone\";\r\nvar targetDraggable;\r\nvar sourceDraggable;\r\nvar ScrollHelper = function() {\r\n    function ScrollHelper(orientation, component) {\r\n        _classCallCheck(this, ScrollHelper);\r\n        this._preventScroll = true;\r\n        this._component = component;\r\n        if (\"vertical\" === orientation) {\r\n            this._scrollValue = \"scrollTop\";\r\n            this._overFlowAttr = \"overflowY\";\r\n            this._sizeAttr = \"height\";\r\n            this._scrollSizeProp = \"scrollHeight\";\r\n            this._limitProps = {\r\n                start: \"top\",\r\n                end: \"bottom\"\r\n            }\r\n        } else {\r\n            this._scrollValue = \"scrollLeft\";\r\n            this._overFlowAttr = \"overflowX\";\r\n            this._sizeAttr = \"width\";\r\n            this._scrollSizeProp = \"scrollWidth\";\r\n            this._limitProps = {\r\n                start: \"left\",\r\n                end: \"right\"\r\n            }\r\n        }\r\n    }\r\n    _createClass(ScrollHelper, [{\r\n        key: \"updateScrollable\",\r\n        value: function(elements, mousePosition) {\r\n            var that = this;\r\n            if (!elements.some(function(element) {\r\n                    return that._trySetScrollable(element, mousePosition)\r\n                })) {\r\n                that._$scrollable = null;\r\n                that._scrollSpeed = 0\r\n            }\r\n        }\r\n    }, {\r\n        key: \"isScrolling\",\r\n        value: function() {\r\n            return !!this._scrollSpeed\r\n        }\r\n    }, {\r\n        key: \"isScrollable\",\r\n        value: function($element) {\r\n            var that = this;\r\n            return (\"auto\" === $element.css(that._overFlowAttr) || $element.hasClass(\"dx-scrollable-container\")) && $element.prop(that._scrollSizeProp) > $element[that._sizeAttr]()\r\n        }\r\n    }, {\r\n        key: \"_trySetScrollable\",\r\n        value: function(element, mousePosition) {\r\n            var that = this;\r\n            var $element = $(element);\r\n            var distanceToBorders;\r\n            var sensitivity = that._component.option(\"scrollSensitivity\");\r\n            var isScrollable = that.isScrollable($element);\r\n            if (isScrollable) {\r\n                distanceToBorders = that._calculateDistanceToBorders($element, mousePosition);\r\n                if (sensitivity > distanceToBorders[that._limitProps.start]) {\r\n                    if (!that._preventScroll) {\r\n                        that._scrollSpeed = -that._calculateScrollSpeed(distanceToBorders[that._limitProps.start]);\r\n                        that._$scrollable = $element\r\n                    }\r\n                } else {\r\n                    if (sensitivity > distanceToBorders[that._limitProps.end]) {\r\n                        if (!that._preventScroll) {\r\n                            that._scrollSpeed = that._calculateScrollSpeed(distanceToBorders[that._limitProps.end]);\r\n                            that._$scrollable = $element\r\n                        }\r\n                    } else {\r\n                        isScrollable = false;\r\n                        that._preventScroll = false\r\n                    }\r\n                }\r\n            }\r\n            return isScrollable\r\n        }\r\n    }, {\r\n        key: \"_calculateDistanceToBorders\",\r\n        value: function($area, mousePosition) {\r\n            var area = $area.get(0);\r\n            var areaBoundingRect;\r\n            if (area) {\r\n                areaBoundingRect = area.getBoundingClientRect();\r\n                return {\r\n                    left: mousePosition.x - areaBoundingRect.left,\r\n                    top: mousePosition.y - areaBoundingRect.top,\r\n                    right: areaBoundingRect.right - mousePosition.x,\r\n                    bottom: areaBoundingRect.bottom - mousePosition.y\r\n                }\r\n            } else {\r\n                return {}\r\n            }\r\n        }\r\n    }, {\r\n        key: \"_calculateScrollSpeed\",\r\n        value: function(distance) {\r\n            var component = this._component;\r\n            var sensitivity = component.option(\"scrollSensitivity\");\r\n            var maxSpeed = component.option(\"scrollSpeed\");\r\n            return Math.ceil(Math.pow((sensitivity - distance) / sensitivity, 2) * maxSpeed)\r\n        }\r\n    }, {\r\n        key: \"scrollByStep\",\r\n        value: function() {\r\n            var that = this;\r\n            var nextScrollPosition;\r\n            if (that._$scrollable && that._scrollSpeed) {\r\n                if (that._$scrollable.hasClass(\"dx-scrollable-container\")) {\r\n                    var $scrollable = that._$scrollable.closest(\".dx-scrollable\");\r\n                    var scrollableInstance = $scrollable.data(\"dxScrollable\") || $scrollable.data(\"dxScrollView\");\r\n                    if (scrollableInstance) {\r\n                        nextScrollPosition = scrollableInstance.scrollOffset();\r\n                        nextScrollPosition[that._limitProps.start] += that._scrollSpeed;\r\n                        scrollableInstance.scrollTo(nextScrollPosition)\r\n                    }\r\n                } else {\r\n                    nextScrollPosition = that._$scrollable[that._scrollValue]() + that._scrollSpeed;\r\n                    that._$scrollable[that._scrollValue](nextScrollPosition)\r\n                }\r\n                var dragMoveArgs = that._component._dragMoveArgs;\r\n                if (dragMoveArgs) {\r\n                    that._component._dragMoveHandler(dragMoveArgs)\r\n                }\r\n            }\r\n        }\r\n    }, {\r\n        key: \"reset\",\r\n        value: function() {\r\n            this._$scrollable = null;\r\n            this._scrollSpeed = 0;\r\n            this._preventScroll = true\r\n        }\r\n    }, {\r\n        key: \"isOutsideScrollable\",\r\n        value: function(target, event) {\r\n            var component = this._component;\r\n            if (!component._$scrollable || !target.closest(component._$scrollable).length) {\r\n                return false\r\n            }\r\n            var scrollableSize = component._$scrollable.get(0).getBoundingClientRect();\r\n            var start = scrollableSize[this._limitProps.start];\r\n            var size = scrollableSize[this._sizeAttr];\r\n            var location = \"width\" === this._sizeAttr ? event.pageX : event.pageY;\r\n            return location < start || location > start + size\r\n        }\r\n    }]);\r\n    return ScrollHelper\r\n}();\r\nvar ScrollAnimator = Animator.inherit({\r\n    ctor: function(strategy) {\r\n        this.callBase();\r\n        this._strategy = strategy\r\n    },\r\n    _step: function() {\r\n        var horizontalScrollHelper = this._strategy._horizontalScrollHelper;\r\n        var verticalScrollHelper = this._strategy._verticalScrollHelper;\r\n        horizontalScrollHelper && horizontalScrollHelper.scrollByStep();\r\n        verticalScrollHelper && verticalScrollHelper.scrollByStep()\r\n    }\r\n});\r\nvar Draggable = DOMComponentWithTemplate.inherit({\r\n    reset: noop,\r\n    dragMove: noop,\r\n    dragEnter: noop,\r\n    dragLeave: noop,\r\n    dragEnd: function(sourceEvent) {\r\n        var sourceDraggable = this._getSourceDraggable();\r\n        sourceDraggable._fireRemoveEvent(sourceEvent)\r\n    },\r\n    _fireRemoveEvent: noop,\r\n    _getDefaultOptions: function() {\r\n        return extend(this.callBase(), {\r\n            onDragStart: null,\r\n            onDragMove: null,\r\n            onDragEnd: null,\r\n            onDrop: null,\r\n            immediate: true,\r\n            dragDirection: \"both\",\r\n            boundary: void 0,\r\n            boundOffset: 0,\r\n            allowMoveByClick: false,\r\n            itemData: null,\r\n            container: void 0,\r\n            dragTemplate: void 0,\r\n            contentTemplate: \"content\",\r\n            handle: \"\",\r\n            filter: \"\",\r\n            clone: false,\r\n            autoScroll: true,\r\n            scrollSpeed: 30,\r\n            scrollSensitivity: 60,\r\n            group: void 0,\r\n            data: void 0\r\n        })\r\n    },\r\n    _setOptionsByReference: function() {\r\n        this.callBase.apply(this, arguments);\r\n        extend(this._optionsByReference, {\r\n            component: true,\r\n            group: true,\r\n            itemData: true,\r\n            data: true\r\n        })\r\n    },\r\n    _init: function() {\r\n        this.callBase();\r\n        this._attachEventHandlers();\r\n        this._scrollAnimator = new ScrollAnimator(this);\r\n        this._horizontalScrollHelper = new ScrollHelper(\"horizontal\", this);\r\n        this._verticalScrollHelper = new ScrollHelper(\"vertical\", this)\r\n    },\r\n    _normalizeCursorOffset: function(offset) {\r\n        if (typeUtils.isObject(offset)) {\r\n            offset = {\r\n                h: offset.x,\r\n                v: offset.y\r\n            }\r\n        }\r\n        offset = commonUtils.splitPair(offset).map(function(value) {\r\n            return parseFloat(value)\r\n        });\r\n        return {\r\n            left: offset[0],\r\n            top: 1 === offset.length ? offset[0] : offset[1]\r\n        }\r\n    },\r\n    _getNormalizedCursorOffset: function(offset, options) {\r\n        if (typeUtils.isFunction(offset)) {\r\n            offset = offset.call(this, options)\r\n        }\r\n        return this._normalizeCursorOffset(offset)\r\n    },\r\n    _calculateElementOffset: function(options) {\r\n        var elementOffset;\r\n        var dragElementOffset;\r\n        var event = options.event;\r\n        var $element = $(options.itemElement);\r\n        var $dragElement = $(options.dragElement);\r\n        var isCloned = this._dragElementIsCloned();\r\n        var cursorOffset = this.option(\"cursorOffset\");\r\n        var normalizedCursorOffset = {\r\n            left: 0,\r\n            top: 0\r\n        };\r\n        var currentLocate = this._initialLocate = translator.locate($dragElement);\r\n        if (isCloned || options.initialOffset || cursorOffset) {\r\n            elementOffset = options.initialOffset || $element.offset();\r\n            if (cursorOffset) {\r\n                normalizedCursorOffset = this._getNormalizedCursorOffset(cursorOffset, options);\r\n                if (isFinite(normalizedCursorOffset.left)) {\r\n                    elementOffset.left = event.pageX\r\n                }\r\n                if (isFinite(normalizedCursorOffset.top)) {\r\n                    elementOffset.top = event.pageY\r\n                }\r\n            }\r\n            dragElementOffset = $dragElement.offset();\r\n            elementOffset.top -= dragElementOffset.top + (normalizedCursorOffset.top || 0) - currentLocate.top;\r\n            elementOffset.left -= dragElementOffset.left + (normalizedCursorOffset.left || 0) - currentLocate.left\r\n        }\r\n        return elementOffset\r\n    },\r\n    _initPosition: function(options) {\r\n        var $dragElement = $(options.dragElement);\r\n        var elementOffset = this._calculateElementOffset(options);\r\n        if (elementOffset) {\r\n            this._move(elementOffset, $dragElement)\r\n        }\r\n        this._startPosition = translator.locate($dragElement)\r\n    },\r\n    _startAnimator: function() {\r\n        if (!this._scrollAnimator.inProgress()) {\r\n            this._scrollAnimator.start()\r\n        }\r\n    },\r\n    _stopAnimator: function() {\r\n        this._scrollAnimator.stop()\r\n    },\r\n    _addWidgetPrefix: function(className) {\r\n        var componentName = this.NAME;\r\n        return dasherize(componentName) + (className ? \"-\" + className : \"\")\r\n    },\r\n    _getItemsSelector: function() {\r\n        return this.option(\"filter\") || \"\"\r\n    },\r\n    _$content: function() {\r\n        var $element = this.$element();\r\n        var $wrapper = $element.children(\".dx-template-wrapper\");\r\n        return $wrapper.length ? $wrapper : $element\r\n    },\r\n    _attachEventHandlers: function() {\r\n        var _this = this;\r\n        if (this.option(\"disabled\")) {\r\n            return\r\n        }\r\n        var $element = this._$content();\r\n        var itemsSelector = this._getItemsSelector();\r\n        var allowMoveByClick = this.option(\"allowMoveByClick\");\r\n        var data = {\r\n            direction: this.option(\"dragDirection\"),\r\n            immediate: this.option(\"immediate\"),\r\n            checkDropTarget: function(target, event) {\r\n                var targetGroup = _this.option(\"group\");\r\n                var sourceGroup = _this._getSourceDraggable().option(\"group\");\r\n                if (_this._verticalScrollHelper.isOutsideScrollable(target, event) || _this._horizontalScrollHelper.isOutsideScrollable(target, event)) {\r\n                    return false\r\n                }\r\n                return sourceGroup && sourceGroup === targetGroup\r\n            }\r\n        };\r\n        if (allowMoveByClick) {\r\n            $element = this._getArea();\r\n            eventsEngine.on($element, POINTERDOWN_EVENT_NAME, data, this._pointerDownHandler.bind(this))\r\n        }\r\n        if (\">\" === itemsSelector[0]) {\r\n            itemsSelector = itemsSelector.slice(1)\r\n        }\r\n        eventsEngine.on($element, DRAGSTART_EVENT_NAME, itemsSelector, data, this._dragStartHandler.bind(this));\r\n        eventsEngine.on($element, DRAG_EVENT_NAME, data, this._dragMoveHandler.bind(this));\r\n        eventsEngine.on($element, DRAGEND_EVENT_NAME, data, this._dragEndHandler.bind(this));\r\n        eventsEngine.on($element, DRAG_ENTER_EVENT_NAME, data, this._dragEnterHandler.bind(this));\r\n        eventsEngine.on($element, DRAGEND_LEAVE_EVENT_NAME, data, this._dragLeaveHandler.bind(this))\r\n    },\r\n    _dragElementIsCloned: function() {\r\n        return this._$dragElement && this._$dragElement.hasClass(this._addWidgetPrefix(CLONE_CLASS))\r\n    },\r\n    _getDragTemplateArgs: function($element, $container) {\r\n        return {\r\n            container: getPublicElement($container),\r\n            model: {\r\n                itemData: this.option(\"itemData\"),\r\n                itemElement: getPublicElement($element)\r\n            }\r\n        }\r\n    },\r\n    _createDragElement: function($element) {\r\n        var result = $element;\r\n        var clone = this.option(\"clone\");\r\n        var $container = this._getContainer();\r\n        var template = this.option(\"dragTemplate\");\r\n        if (template) {\r\n            template = this._getTemplate(template);\r\n            result = $(\"<div>\").appendTo($container);\r\n            template.render(this._getDragTemplateArgs($element, result))\r\n        } else {\r\n            if (clone) {\r\n                result = $(\"<div>\").appendTo($container);\r\n                $element.clone().css({\r\n                    width: $element.css(\"width\"),\r\n                    height: $element.css(\"height\")\r\n                }).appendTo(result)\r\n            }\r\n        }\r\n        return result.toggleClass(this._addWidgetPrefix(CLONE_CLASS), result.get(0) !== $element.get(0))\r\n    },\r\n    _resetDragElement: function() {\r\n        if (this._dragElementIsCloned()) {\r\n            this._$dragElement.remove()\r\n        } else {\r\n            this._toggleDraggingClass(false)\r\n        }\r\n        this._$dragElement = null\r\n    },\r\n    _resetSourceElement: function() {\r\n        this._toggleDragSourceClass(false);\r\n        this._$sourceElement = null\r\n    },\r\n    _detachEventHandlers: function() {\r\n        eventsEngine.off(this._$content(), \".\" + DRAGGABLE);\r\n        eventsEngine.off(this._getArea(), \".\" + DRAGGABLE)\r\n    },\r\n    _move: function(position, $element) {\r\n        translator.move($element || this._$dragElement, position)\r\n    },\r\n    _getDraggableElement: function(e) {\r\n        var $sourceElement = this._getSourceElement();\r\n        if ($sourceElement) {\r\n            return $sourceElement\r\n        }\r\n        var allowMoveByClick = this.option(\"allowMoveByClick\");\r\n        if (allowMoveByClick) {\r\n            return this.$element()\r\n        }\r\n        var $target = $(e && e.target);\r\n        var itemsSelector = this._getItemsSelector();\r\n        if (\">\" === itemsSelector[0]) {\r\n            var $items = this._$content().find(itemsSelector);\r\n            if (!$items.is($target)) {\r\n                $target = $target.closest($items)\r\n            }\r\n        }\r\n        return $target\r\n    },\r\n    _getSourceElement: function() {\r\n        var draggable = this._getSourceDraggable();\r\n        return draggable._$sourceElement\r\n    },\r\n    _pointerDownHandler: function(e) {\r\n        if (eventUtils.needSkipEvent(e)) {\r\n            return\r\n        }\r\n        var position = {};\r\n        var $element = this.$element();\r\n        var dragDirection = this.option(\"dragDirection\");\r\n        if (\"horizontal\" === dragDirection || \"both\" === dragDirection) {\r\n            position.left = e.pageX - $element.offset().left + translator.locate($element).left - $element.width() / 2\r\n        }\r\n        if (\"vertical\" === dragDirection || \"both\" === dragDirection) {\r\n            position.top = e.pageY - $element.offset().top + translator.locate($element).top - $element.height() / 2\r\n        }\r\n        this._move(position, $element);\r\n        this._getAction(\"onDragMove\")(this._getEventArgs(e))\r\n    },\r\n    _isValidElement: function(event, $element) {\r\n        var handle = this.option(\"handle\");\r\n        var $target = $(event.originalEvent && event.originalEvent.target);\r\n        if (handle && !$target.closest(handle).length) {\r\n            return false\r\n        }\r\n        if (!$element.length) {\r\n            return false\r\n        }\r\n        return !$element.is(\".dx-state-disabled, .dx-state-disabled *\")\r\n    },\r\n    _dragStartHandler: function(e) {\r\n        var $dragElement;\r\n        var initialOffset;\r\n        var isFixedPosition;\r\n        var $element = this._getDraggableElement(e);\r\n        if (this._$sourceElement) {\r\n            return\r\n        }\r\n        if (!this._isValidElement(e, $element)) {\r\n            e.cancel = true;\r\n            return\r\n        }\r\n        var dragStartArgs = this._getDragStartArgs(e, $element);\r\n        this._getAction(\"onDragStart\")(dragStartArgs);\r\n        if (dragStartArgs.cancel) {\r\n            e.cancel = true;\r\n            return\r\n        }\r\n        this.option(\"itemData\", dragStartArgs.itemData);\r\n        this._setSourceDraggable();\r\n        this._$sourceElement = $element;\r\n        initialOffset = $element.offset();\r\n        $dragElement = this._$dragElement = this._createDragElement($element);\r\n        this._toggleDraggingClass(true);\r\n        this._toggleDragSourceClass(true);\r\n        isFixedPosition = \"fixed\" === $dragElement.css(\"position\");\r\n        this._initPosition(extend({}, dragStartArgs, {\r\n            dragElement: $dragElement.get(0),\r\n            initialOffset: isFixedPosition && initialOffset\r\n        }));\r\n        var $area = this._getArea();\r\n        var areaOffset = this._getAreaOffset($area);\r\n        var boundOffset = this._getBoundOffset();\r\n        var areaWidth = $area.outerWidth();\r\n        var areaHeight = $area.outerHeight();\r\n        var elementWidth = $dragElement.width();\r\n        var elementHeight = $dragElement.height();\r\n        var startOffset = {\r\n            left: $dragElement.offset().left - areaOffset.left,\r\n            top: $dragElement.offset().top - areaOffset.top\r\n        };\r\n        if ($area.length) {\r\n            e.maxLeftOffset = startOffset.left - boundOffset.left;\r\n            e.maxRightOffset = areaWidth - startOffset.left - elementWidth - boundOffset.right;\r\n            e.maxTopOffset = startOffset.top - boundOffset.top;\r\n            e.maxBottomOffset = areaHeight - startOffset.top - elementHeight - boundOffset.bottom\r\n        }\r\n        if (this.option(\"autoScroll\")) {\r\n            this._startAnimator()\r\n        }\r\n    },\r\n    _getAreaOffset: function($area) {\r\n        var offset = $area && positionUtils.offset($area);\r\n        return offset ? offset : {\r\n            left: 0,\r\n            top: 0\r\n        }\r\n    },\r\n    _toggleDraggingClass: function(value) {\r\n        this._$dragElement && this._$dragElement.toggleClass(this._addWidgetPrefix(\"dragging\"), value)\r\n    },\r\n    _toggleDragSourceClass: function(value, $element) {\r\n        var $sourceElement = $element || this._$sourceElement;\r\n        $sourceElement && $sourceElement.toggleClass(this._addWidgetPrefix(\"source\"), value)\r\n    },\r\n    _getBoundOffset: function() {\r\n        var boundOffset = this.option(\"boundOffset\");\r\n        if (typeUtils.isFunction(boundOffset)) {\r\n            boundOffset = boundOffset.call(this)\r\n        }\r\n        return stringUtils.quadToObject(boundOffset)\r\n    },\r\n    _getArea: function() {\r\n        var area = this.option(\"boundary\");\r\n        if (typeUtils.isFunction(area)) {\r\n            area = area.call(this)\r\n        }\r\n        return $(area)\r\n    },\r\n    _getContainer: function() {\r\n        var container = this.option(\"container\");\r\n        if (void 0 === container) {\r\n            container = viewPortUtils.value()\r\n        }\r\n        return $(container)\r\n    },\r\n    _dragMoveHandler: function(e) {\r\n        this._dragMoveArgs = e;\r\n        if (!this._$dragElement) {\r\n            e.cancel = true;\r\n            return\r\n        }\r\n        var offset = e.offset;\r\n        var startPosition = this._startPosition;\r\n        this._move({\r\n            left: startPosition.left + offset.x,\r\n            top: startPosition.top + offset.y\r\n        });\r\n        this._updateScrollable(e);\r\n        var eventArgs = this._getEventArgs(e);\r\n        this._getAction(\"onDragMove\")(eventArgs);\r\n        if (true === eventArgs.cancel) {\r\n            return\r\n        }\r\n        var targetDraggable = this._getTargetDraggable();\r\n        targetDraggable.dragMove(e)\r\n    },\r\n    _updateScrollable: function(e) {\r\n        var that = this;\r\n        var $sourceElement = that._getSourceElement();\r\n        that._$scrollable = null;\r\n        $sourceElement.parents().toArray().some(function(element) {\r\n            var $element = $(element);\r\n            if (that._horizontalScrollHelper.isScrollable($element) || that._verticalScrollHelper.isScrollable($element)) {\r\n                that._$scrollable = $element;\r\n                return true\r\n            }\r\n        });\r\n        if (that.option(\"autoScroll\")) {\r\n            var $window = $(window);\r\n            var mousePosition = {\r\n                x: e.pageX - $window.scrollLeft(),\r\n                y: e.pageY - $window.scrollTop()\r\n            };\r\n            var allObjects = that.getElementsFromPoint(mousePosition);\r\n            that._verticalScrollHelper.updateScrollable(allObjects, mousePosition);\r\n            that._horizontalScrollHelper.updateScrollable(allObjects, mousePosition)\r\n        }\r\n    },\r\n    getElementsFromPoint: function(position) {\r\n        var ownerDocument = this._$dragElement.get(0).ownerDocument;\r\n        if (browser.msie) {\r\n            var msElements = ownerDocument.msElementsFromPoint(position.x, position.y);\r\n            if (msElements) {\r\n                return Array.prototype.slice.call(msElements)\r\n            }\r\n            return []\r\n        }\r\n        return ownerDocument.elementsFromPoint(position.x, position.y)\r\n    },\r\n    _defaultActionArgs: function() {\r\n        var args = this.callBase.apply(this, arguments);\r\n        var component = this.option(\"component\");\r\n        if (component) {\r\n            args.component = component;\r\n            args.element = component.element()\r\n        }\r\n        return args\r\n    },\r\n    _getEventArgs: function(e) {\r\n        var sourceDraggable = this._getSourceDraggable();\r\n        var targetDraggable = this._getTargetDraggable();\r\n        return {\r\n            event: e,\r\n            itemData: sourceDraggable.option(\"itemData\"),\r\n            itemElement: getPublicElement(sourceDraggable._$sourceElement),\r\n            fromComponent: sourceDraggable.option(\"component\") || sourceDraggable,\r\n            toComponent: targetDraggable.option(\"component\") || targetDraggable,\r\n            fromData: sourceDraggable.option(\"data\"),\r\n            toData: targetDraggable.option(\"data\")\r\n        }\r\n    },\r\n    _getDragStartArgs: function(e, $itemElement) {\r\n        var args = this._getEventArgs(e);\r\n        return {\r\n            event: args.event,\r\n            itemData: args.itemData,\r\n            itemElement: $itemElement,\r\n            fromData: args.fromData\r\n        }\r\n    },\r\n    _revertItemToInitialPosition: function() {\r\n        !this._dragElementIsCloned() && this._move(this._initialLocate, this._$sourceElement)\r\n    },\r\n    _dragEndHandler: function(e) {\r\n        var _this2 = this;\r\n        var dragEndEventArgs = this._getEventArgs(e);\r\n        var dropEventArgs = this._getEventArgs(e);\r\n        var targetDraggable = this._getTargetDraggable();\r\n        var needRevertPosition = true;\r\n        try {\r\n            this._getAction(\"onDragEnd\")(dragEndEventArgs)\r\n        } finally {\r\n            when(fromPromise(dragEndEventArgs.cancel)).done(function(cancel) {\r\n                if (!cancel) {\r\n                    if (targetDraggable !== _this2) {\r\n                        targetDraggable._getAction(\"onDrop\")(dropEventArgs)\r\n                    }\r\n                    if (!dropEventArgs.cancel) {\r\n                        targetDraggable.dragEnd(dragEndEventArgs);\r\n                        needRevertPosition = false\r\n                    }\r\n                }\r\n            }).always(function() {\r\n                if (needRevertPosition) {\r\n                    _this2._revertItemToInitialPosition()\r\n                }\r\n                _this2.reset();\r\n                targetDraggable.reset();\r\n                _this2._stopAnimator();\r\n                _this2._horizontalScrollHelper.reset();\r\n                _this2._verticalScrollHelper.reset();\r\n                _this2._resetDragElement();\r\n                _this2._resetSourceElement();\r\n                _this2._resetTargetDraggable();\r\n                _this2._resetSourceDraggable()\r\n            })\r\n        }\r\n    },\r\n    _dragEnterHandler: function(e) {\r\n        this._setTargetDraggable();\r\n        var sourceDraggable = this._getSourceDraggable();\r\n        sourceDraggable.dragEnter(e)\r\n    },\r\n    _dragLeaveHandler: function(e) {\r\n        this._resetTargetDraggable();\r\n        if (this !== this._getSourceDraggable()) {\r\n            this.reset()\r\n        }\r\n        var sourceDraggable = this._getSourceDraggable();\r\n        sourceDraggable.dragLeave(e)\r\n    },\r\n    _getAction: function(name) {\r\n        return this[\"_\" + name + \"Action\"] || this._createActionByOption(name)\r\n    },\r\n    _getAnonymousTemplateName: function() {\r\n        return \"content\"\r\n    },\r\n    _initTemplates: function() {\r\n        if (!this.option(\"contentTemplate\")) {\r\n            return\r\n        }\r\n        this.callBase.apply(this, arguments);\r\n        this._defaultTemplates.content = new EmptyTemplate\r\n    },\r\n    _render: function() {\r\n        this.callBase();\r\n        this.$element().addClass(this._addWidgetPrefix());\r\n        var transclude = this._getAnonymousTemplateName() === this.option(\"contentTemplate\");\r\n        var template = this._getTemplateByOption(\"contentTemplate\");\r\n        if (template) {\r\n            $(template.render({\r\n                container: this.element(),\r\n                transclude: transclude\r\n            }))\r\n        }\r\n    },\r\n    _optionChanged: function(args) {\r\n        var name = args.name;\r\n        switch (name) {\r\n            case \"onDragStart\":\r\n            case \"onDragMove\":\r\n            case \"onDragEnd\":\r\n            case \"onDrop\":\r\n                this[\"_\" + name + \"Action\"] = this._createActionByOption(name);\r\n                break;\r\n            case \"dragTemplate\":\r\n            case \"contentTemplate\":\r\n            case \"container\":\r\n            case \"clone\":\r\n                this._resetDragElement();\r\n                break;\r\n            case \"allowMoveByClick\":\r\n            case \"dragDirection\":\r\n            case \"disabled\":\r\n            case \"boundary\":\r\n            case \"filter\":\r\n            case \"immediate\":\r\n                this._resetDragElement();\r\n                this._detachEventHandlers();\r\n                this._attachEventHandlers();\r\n                break;\r\n            case \"autoScroll\":\r\n                this._verticalScrollHelper.reset();\r\n                this._horizontalScrollHelper.reset();\r\n                break;\r\n            case \"scrollSensitivity\":\r\n            case \"scrollSpeed\":\r\n            case \"boundOffset\":\r\n            case \"handle\":\r\n            case \"group\":\r\n            case \"data\":\r\n            case \"itemData\":\r\n                break;\r\n            default:\r\n                this.callBase(args)\r\n        }\r\n    },\r\n    _getTargetDraggable: function() {\r\n        return targetDraggable || this\r\n    },\r\n    _getSourceDraggable: function() {\r\n        return sourceDraggable || this\r\n    },\r\n    _setTargetDraggable: function() {\r\n        var currentGroup = this.option(\"group\");\r\n        var sourceDraggable = this._getSourceDraggable();\r\n        if (currentGroup && currentGroup === sourceDraggable.option(\"group\")) {\r\n            targetDraggable = this\r\n        }\r\n    },\r\n    _setSourceDraggable: function() {\r\n        sourceDraggable = this\r\n    },\r\n    _resetSourceDraggable: function() {\r\n        sourceDraggable = null\r\n    },\r\n    _resetTargetDraggable: function() {\r\n        targetDraggable = null\r\n    },\r\n    _dispose: function() {\r\n        this.callBase();\r\n        this._detachEventHandlers();\r\n        this._resetDragElement();\r\n        this._resetTargetDraggable();\r\n        this._resetSourceDraggable();\r\n        this._$sourceElement = null;\r\n        this._stopAnimator()\r\n    }\r\n});\r\nregisterComponent(DRAGGABLE, Draggable);\r\nmodule.exports = Draggable;\r\nmodule.exports.default = module.exports;\r\n"]},"metadata":{},"sourceType":"script"}