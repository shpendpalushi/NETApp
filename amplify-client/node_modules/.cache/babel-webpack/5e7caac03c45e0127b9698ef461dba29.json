{"ast":null,"code":"/**\r\n * DevExtreme (viz/vector_map/tracker.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar _events_engine = require(\"../../events/core/events_engine\");\n\nvar _events_engine2 = _interopRequireDefault(_events_engine);\n\nvar _window = require(\"../../core/utils/window\");\n\nvar _window2 = _interopRequireDefault(_window);\n\nvar _dom_adapter = require(\"../../core/dom_adapter\");\n\nvar _dom_adapter2 = _interopRequireDefault(_dom_adapter);\n\nvar _event_emitter = require(\"./event_emitter\");\n\nvar _event_emitter2 = _interopRequireDefault(_event_emitter);\n\nvar _utils = require(\"../../events/utils\");\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nvar _wheel = require(\"../../events/core/wheel\");\n\nvar _utils3 = require(\"../core/utils\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nvar navigator = _window2.default.getNavigator();\n\nvar _math = Math;\nvar _abs = _math.abs;\nvar _sqrt = _math.sqrt;\nvar _round = _math.round;\nvar _addNamespace = _utils2.default.addNamespace;\nvar _now = Date.now;\nvar _NAME = \"dxVectorMap\";\nvar EVENT_START = \"start\";\nvar EVENT_MOVE = \"move\";\nvar EVENT_END = \"end\";\nvar EVENT_ZOOM = \"zoom\";\nvar EVENT_HOVER_ON = \"hover-on\";\nvar EVENT_HOVER_OFF = \"hover-off\";\nvar EVENT_CLICK = \"click\";\nvar EVENT_FOCUS_ON = \"focus-on\";\nvar EVENT_FOCUS_MOVE = \"focus-move\";\nvar EVENT_FOCUS_OFF = \"focus-off\";\nvar CLICK_TIME_THRESHOLD = 500;\nvar CLICK_COORD_THRESHOLD_MOUSE = 5;\nvar CLICK_COORD_THRESHOLD_TOUCH = 20;\nvar DRAG_COORD_THRESHOLD_MOUSE = 5;\nvar DRAG_COORD_THRESHOLD_TOUCH = 10;\nvar FOCUS_OFF_DELAY = 100;\nvar WHEEL_COOLDOWN = 50;\nvar WHEEL_DIRECTION_COOLDOWN = 300;\nvar EVENTS;\nsetupEvents();\n\nfunction Tracker(parameters) {\n  var that = this;\n  that._root = parameters.root;\n\n  that._createEventHandlers(parameters.dataKey);\n\n  that._createProjectionHandlers(parameters.projection);\n\n  that._initEvents();\n\n  that._focus = new Focus(function (name, arg) {\n    that._fire(name, arg);\n  });\n\n  that._attachHandlers();\n}\n\nTracker.prototype = {\n  constructor: Tracker,\n  dispose: function dispose() {\n    var that = this;\n\n    that._detachHandlers();\n\n    that._disposeEvents();\n\n    that._focus.dispose();\n\n    that._root = that._focus = that._docHandlers = that._rootHandlers = null;\n  },\n  _eventNames: [EVENT_START, EVENT_MOVE, EVENT_END, EVENT_ZOOM, EVENT_CLICK, EVENT_HOVER_ON, EVENT_HOVER_OFF, EVENT_FOCUS_ON, EVENT_FOCUS_OFF, EVENT_FOCUS_MOVE],\n  _startClick: function _startClick(event, data) {\n    if (!data) {\n      return;\n    }\n\n    var coords = getEventCoords(event);\n    this._clickState = {\n      x: coords.x,\n      y: coords.y,\n      threshold: isTouchEvent(event) ? CLICK_COORD_THRESHOLD_TOUCH : CLICK_COORD_THRESHOLD_MOUSE,\n      time: _now()\n    };\n  },\n  _endClick: function _endClick(event, data) {\n    var state = this._clickState;\n    var threshold;\n    var coords;\n\n    if (!state) {\n      return;\n    }\n\n    if (data && _now() - state.time <= CLICK_TIME_THRESHOLD) {\n      threshold = state.threshold;\n      coords = getEventCoords(event);\n\n      if (_abs(coords.x - state.x) <= threshold && _abs(coords.y - state.y) <= threshold) {\n        this._fire(EVENT_CLICK, {\n          data: data,\n          x: coords.x,\n          y: coords.y,\n          $event: event\n        });\n      }\n    }\n\n    this._clickState = null;\n  },\n  _startDrag: function _startDrag(event, data) {\n    if (!data) {\n      return;\n    }\n\n    var coords = getEventCoords(event);\n    var state = this._dragState = {\n      x: coords.x,\n      y: coords.y,\n      data: data\n    };\n\n    this._fire(EVENT_START, {\n      x: state.x,\n      y: state.y,\n      data: state.data\n    });\n  },\n  _moveDrag: function _moveDrag(event, data) {\n    var state = this._dragState;\n    var coords;\n    var threshold;\n\n    if (!state) {\n      return;\n    }\n\n    coords = getEventCoords(event);\n    threshold = isTouchEvent(event) ? DRAG_COORD_THRESHOLD_TOUCH : DRAG_COORD_THRESHOLD_MOUSE;\n\n    if (state.active || _abs(coords.x - state.x) > threshold || _abs(coords.y - state.y) > threshold) {\n      state.x = coords.x;\n      state.y = coords.y;\n      state.active = true;\n      state.data = data || {};\n\n      this._fire(EVENT_MOVE, {\n        x: state.x,\n        y: state.y,\n        data: state.data\n      });\n    }\n  },\n  _endDrag: function _endDrag() {\n    var state = this._dragState;\n\n    if (!state) {\n      return;\n    }\n\n    this._dragState = null;\n\n    this._fire(EVENT_END, {\n      x: state.x,\n      y: state.y,\n      data: state.data\n    });\n  },\n  _wheelZoom: function _wheelZoom(event, data) {\n    if (!data) {\n      return;\n    }\n\n    var that = this;\n    var lock = that._wheelLock;\n\n    var time = _now();\n\n    var delta;\n    var coords;\n\n    if (time - lock.time <= WHEEL_COOLDOWN) {\n      return;\n    }\n\n    if (time - lock.dirTime > WHEEL_DIRECTION_COOLDOWN) {\n      lock.dir = 0;\n    }\n\n    delta = adjustWheelDelta(event.delta / 120 || 0, lock);\n\n    if (0 === delta) {\n      return;\n    }\n\n    coords = getEventCoords(event);\n\n    that._fire(EVENT_ZOOM, {\n      delta: delta,\n      x: coords.x,\n      y: coords.y\n    });\n\n    lock.time = lock.dirTime = time;\n  },\n  _startZoom: function _startZoom(event, data) {\n    if (!isTouchEvent(event) || !data) {\n      return;\n    }\n\n    var state = this._zoomState = this._zoomState || {};\n    var coords;\n    var pointer2;\n\n    if (state.pointer1 && state.pointer2) {\n      return;\n    }\n\n    if (void 0 === state.pointer1) {\n      state.pointer1 = getPointerId(event) || 0;\n      coords = getMultitouchEventCoords(event, state.pointer1);\n      state.x1 = state.x1_0 = coords.x;\n      state.y1 = state.y1_0 = coords.y;\n    }\n\n    if (void 0 === state.pointer2) {\n      pointer2 = getPointerId(event) || 1;\n\n      if (pointer2 !== state.pointer1) {\n        coords = getMultitouchEventCoords(event, pointer2);\n\n        if (coords) {\n          state.x2 = state.x2_0 = coords.x;\n          state.y2 = state.y2_0 = coords.y;\n          state.pointer2 = pointer2;\n          state.ready = true;\n\n          this._endDrag();\n        }\n      }\n    }\n  },\n  _moveZoom: function _moveZoom(event) {\n    var state = this._zoomState;\n    var coords;\n\n    if (!state || !isTouchEvent(event)) {\n      return;\n    }\n\n    if (void 0 !== state.pointer1) {\n      coords = getMultitouchEventCoords(event, state.pointer1);\n\n      if (coords) {\n        state.x1 = coords.x;\n        state.y1 = coords.y;\n      }\n    }\n\n    if (void 0 !== state.pointer2) {\n      coords = getMultitouchEventCoords(event, state.pointer2);\n\n      if (coords) {\n        state.x2 = coords.x;\n        state.y2 = coords.y;\n      }\n    }\n  },\n  _endZoom: function _endZoom(event) {\n    var state = this._zoomState;\n    var startDistance;\n    var currentDistance;\n\n    if (!state || !isTouchEvent(event)) {\n      return;\n    }\n\n    if (state.ready) {\n      startDistance = getDistance(state.x1_0, state.y1_0, state.x2_0, state.y2_0);\n      currentDistance = getDistance(state.x1, state.y1, state.x2, state.y2);\n\n      this._fire(EVENT_ZOOM, {\n        ratio: currentDistance / startDistance,\n        x: (state.x1_0 + state.x2_0) / 2,\n        y: (state.y1_0 + state.y2_0) / 2\n      });\n    }\n\n    this._zoomState = null;\n  },\n  _startHover: function _startHover(event, data) {\n    this._doHover(event, data, true);\n  },\n  _moveHover: function _moveHover(event, data) {\n    this._doHover(event, data, false);\n  },\n  _doHover: function _doHover(event, data, isTouch) {\n    var that = this;\n\n    if (that._dragState && that._dragState.active || that._zoomState && that._zoomState.ready) {\n      that._cancelHover();\n\n      return;\n    }\n\n    if (isTouchEvent(event) !== isTouch || that._hoverTarget === event.target || that._hoverState && that._hoverState.data === data) {\n      return;\n    }\n\n    that._cancelHover();\n\n    if (data) {\n      that._hoverState = {\n        data: data\n      };\n\n      that._fire(EVENT_HOVER_ON, {\n        data: data\n      });\n    }\n\n    that._hoverTarget = event.target;\n  },\n  _cancelHover: function _cancelHover() {\n    var state = this._hoverState;\n    this._hoverState = this._hoverTarget = null;\n\n    if (state) {\n      this._fire(EVENT_HOVER_OFF, {\n        data: state.data\n      });\n    }\n  },\n  _startFocus: function _startFocus(event, data) {\n    this._doFocus(event, data, true);\n  },\n  _moveFocus: function _moveFocus(event, data) {\n    this._doFocus(event, data, false);\n  },\n  _doFocus: function _doFocus(event, data, isTouch) {\n    var that = this;\n\n    if (that._dragState && that._dragState.active || that._zoomState && that._zoomState.ready) {\n      that._cancelFocus();\n\n      return;\n    }\n\n    if (isTouchEvent(event) !== isTouch) {\n      return;\n    }\n\n    that._focus.turnOff();\n\n    data && that._focus.turnOn(data, getEventCoords(event));\n  },\n  _cancelFocus: function _cancelFocus() {\n    this._focus.cancel();\n  },\n  _createEventHandlers: function _createEventHandlers(DATA_KEY) {\n    var that = this;\n    that._docHandlers = {};\n    that._rootHandlers = {};\n\n    that._rootHandlers[EVENTS.start] = that._docHandlers[EVENTS.start] = function (event) {\n      var isTouch = isTouchEvent(event);\n      var data = getData(event);\n\n      if (isTouch && !that._isTouchEnabled) {\n        return;\n      }\n\n      if (data) {\n        event.preventDefault();\n        event.stopPropagation();\n      }\n\n      that._startClick(event, data);\n\n      that._startDrag(event, data);\n\n      that._startZoom(event, data);\n\n      that._startHover(event, data);\n\n      that._startFocus(event, data);\n    };\n\n    that._docHandlers[EVENTS.move] = function (event) {\n      var isTouch = isTouchEvent(event);\n      var data = getData(event);\n\n      if (isTouch && !that._isTouchEnabled) {\n        return;\n      }\n\n      that._moveDrag(event, data);\n\n      that._moveZoom(event, data);\n\n      that._moveHover(event, data);\n\n      that._moveFocus(event, data);\n    };\n\n    that._docHandlers[EVENTS.end] = function (event) {\n      var isTouch = isTouchEvent(event);\n      var data = getData(event);\n\n      if (isTouch && !that._isTouchEnabled) {\n        return;\n      }\n\n      that._endClick(event, data);\n\n      that._endDrag(event, data);\n\n      that._endZoom(event, data);\n    };\n\n    that._rootHandlers[EVENTS.wheel] = function (event) {\n      that._cancelFocus();\n\n      if (!that._isWheelEnabled) {\n        return;\n      }\n\n      var data = getData(event);\n\n      if (data) {\n        event.preventDefault();\n        event.stopPropagation();\n\n        that._wheelZoom(event, data);\n      }\n    };\n\n    that._wheelLock = {\n      dir: 0\n    };\n\n    function getData(event) {\n      var target = event.target;\n      return (\"tspan\" === target.tagName ? target.parentNode : target)[DATA_KEY];\n    }\n  },\n  _createProjectionHandlers: function _createProjectionHandlers(projection) {\n    var that = this;\n    projection.on({\n      center: handler,\n      zoom: handler\n    });\n\n    function handler() {\n      that._cancelFocus();\n    }\n  },\n  reset: function reset() {\n    var that = this;\n    that._clickState = null;\n\n    that._endDrag();\n\n    that._cancelHover();\n\n    that._cancelFocus();\n  },\n  setOptions: function setOptions(options) {\n    var that = this;\n    that.reset();\n\n    that._detachHandlers();\n\n    that._isTouchEnabled = !!(0, _utils3.parseScalar)(options.touchEnabled, true);\n    that._isWheelEnabled = !!(0, _utils3.parseScalar)(options.wheelEnabled, true);\n\n    that._attachHandlers();\n  },\n  _detachHandlers: function _detachHandlers() {\n    var that = this;\n\n    if (that._isTouchEnabled) {\n      that._root.css({\n        \"touch-action\": \"\",\n        \"-webkit-user-select\": \"\"\n      }).off(_addNamespace(\"MSHoldVisual\", _NAME)).off(_addNamespace(\"contextmenu\", _NAME));\n    }\n\n    _events_engine2.default.off(_dom_adapter2.default.getDocument(), that._docHandlers);\n\n    that._root.off(that._rootHandlers);\n  },\n  _attachHandlers: function _attachHandlers() {\n    var that = this;\n\n    if (that._isTouchEnabled) {\n      that._root.css({\n        \"touch-action\": \"none\",\n        \"-webkit-user-select\": \"none\"\n      }).on(_addNamespace(\"MSHoldVisual\", _NAME), function (event) {\n        event.preventDefault();\n      }).on(_addNamespace(\"contextmenu\", _NAME), function (event) {\n        isTouchEvent(event) && event.preventDefault();\n      });\n    }\n\n    _events_engine2.default.on(_dom_adapter2.default.getDocument(), that._docHandlers);\n\n    that._root.on(that._rootHandlers);\n  }\n};\n\nvar Focus = function Focus(fire) {\n  var that = this;\n  var _activeData = null;\n  var _data = null;\n  var _disabled = false;\n  var _offTimer = null;\n\n  var _x;\n\n  var _y;\n\n  that.dispose = function () {\n    clearTimeout(_offTimer);\n    that.turnOn = that.turnOff = that.cancel = that.dispose = that = fire = _activeData = _data = _offTimer = null;\n  };\n\n  that.turnOn = function (data, coords) {\n    if (data === _data && _disabled) {\n      return;\n    }\n\n    _disabled = false;\n    _data = data;\n\n    if (_activeData) {\n      _x = coords.x;\n      _y = coords.y;\n\n      if (_data === _activeData) {\n        fire(EVENT_FOCUS_MOVE, {\n          data: _data,\n          x: _x,\n          y: _y\n        });\n        onCheck(true);\n      } else {\n        fire(EVENT_FOCUS_ON, {\n          data: _data,\n          x: _x,\n          y: _y,\n          done: onCheck\n        });\n      }\n    } else {\n      _x = coords.x;\n      _y = coords.y;\n      fire(EVENT_FOCUS_ON, {\n        data: _data,\n        x: _x,\n        y: _y,\n        done: onCheck\n      });\n    }\n\n    function onCheck(result) {\n      _disabled = !result;\n\n      if (result) {\n        _activeData = _data;\n        clearTimeout(_offTimer);\n        _offTimer = null;\n      }\n    }\n  };\n\n  that.turnOff = function () {\n    _data = null;\n\n    if (_activeData && !_disabled) {\n      _offTimer = _offTimer || setTimeout(function () {\n        _offTimer = null;\n        fire(EVENT_FOCUS_OFF, {\n          data: _activeData\n        });\n        _activeData = null;\n      }, FOCUS_OFF_DELAY);\n    }\n  };\n\n  that.cancel = function () {\n    clearTimeout(_offTimer);\n\n    if (_activeData) {\n      fire(EVENT_FOCUS_OFF, {\n        data: _activeData\n      });\n    }\n\n    _activeData = _data = _offTimer = null;\n  };\n};\n\n_event_emitter2.default.makeEventEmitter(Tracker);\n\nexports.Tracker = Tracker;\n\nfunction getDistance(x1, y1, x2, y2) {\n  return _sqrt((x1 - x2) * (x1 - x2) + (y1 - y2) * (y1 - y2));\n}\n\nfunction isTouchEvent(event) {\n  var type = event.originalEvent.type;\n  var pointerType = event.originalEvent.pointerType;\n  return /^touch/.test(type) || /^MSPointer/.test(type) && 4 !== pointerType || /^pointer/.test(type) && \"mouse\" !== pointerType;\n}\n\nfunction selectItem(flags, items) {\n  var i = 0;\n  var ii = flags.length;\n  var item;\n\n  for (; i < ii; ++i) {\n    if (flags[i]) {\n      item = items[i];\n      break;\n    }\n  }\n\n  return _addNamespace(item || items[i], _NAME);\n}\n\nfunction setupEvents() {\n  var flags = [navigator.pointerEnabled, navigator.msPointerEnabled, _window2.default.hasProperty(\"ontouchstart\")];\n  EVENTS = {\n    start: selectItem(flags, [\"pointerdown\", \"MSPointerDown\", \"touchstart mousedown\", \"mousedown\"]),\n    move: selectItem(flags, [\"pointermove\", \"MSPointerMove\", \"touchmove mousemove\", \"mousemove\"]),\n    end: selectItem(flags, [\"pointerup\", \"MSPointerUp\", \"touchend mouseup\", \"mouseup\"]),\n    wheel: _addNamespace(_wheel.name, _NAME)\n  };\n}\n\nfunction getEventCoords(event) {\n  var originalEvent = event.originalEvent;\n  var touch = originalEvent.touches && originalEvent.touches[0] || {};\n  return {\n    x: touch.pageX || originalEvent.pageX || event.pageX,\n    y: touch.pageY || originalEvent.pageY || event.pageY\n  };\n}\n\nfunction getPointerId(event) {\n  return event.originalEvent.pointerId;\n}\n\nfunction getMultitouchEventCoords(event, pointerId) {\n  var originalEvent = event.originalEvent;\n\n  if (void 0 !== originalEvent.pointerId) {\n    originalEvent = originalEvent.pointerId === pointerId ? originalEvent : null;\n  } else {\n    originalEvent = originalEvent.touches[pointerId];\n  }\n\n  return originalEvent ? {\n    x: originalEvent.pageX || event.pageX,\n    y: originalEvent.pageY || event.pageY\n  } : null;\n}\n\nfunction adjustWheelDelta(delta, lock) {\n  if (0 === delta) {\n    return 0;\n  }\n\n  var _delta = _abs(delta);\n\n  var sign = _round(delta / _delta);\n\n  if (lock.dir && sign !== lock.dir) {\n    return 0;\n  }\n\n  lock.dir = sign;\n\n  if (_delta < .1) {\n    _delta = 0;\n  } else {\n    if (_delta < 1) {\n      _delta = 1;\n    } else {\n      if (_delta > 4) {\n        _delta = 4;\n      } else {\n        _delta = _round(_delta);\n      }\n    }\n  }\n\n  return sign * _delta;\n}","map":{"version":3,"sources":["C:/Users/User/Documents/Personals/Creation/NETApp/amplify-client/node_modules/devextreme/viz/vector_map/tracker.js"],"names":["_events_engine","require","_events_engine2","_interopRequireDefault","_window","_window2","_dom_adapter","_dom_adapter2","_event_emitter","_event_emitter2","_utils","_utils2","_wheel","_utils3","obj","__esModule","navigator","default","getNavigator","_math","Math","_abs","abs","_sqrt","sqrt","_round","round","_addNamespace","addNamespace","_now","Date","now","_NAME","EVENT_START","EVENT_MOVE","EVENT_END","EVENT_ZOOM","EVENT_HOVER_ON","EVENT_HOVER_OFF","EVENT_CLICK","EVENT_FOCUS_ON","EVENT_FOCUS_MOVE","EVENT_FOCUS_OFF","CLICK_TIME_THRESHOLD","CLICK_COORD_THRESHOLD_MOUSE","CLICK_COORD_THRESHOLD_TOUCH","DRAG_COORD_THRESHOLD_MOUSE","DRAG_COORD_THRESHOLD_TOUCH","FOCUS_OFF_DELAY","WHEEL_COOLDOWN","WHEEL_DIRECTION_COOLDOWN","EVENTS","setupEvents","Tracker","parameters","that","_root","root","_createEventHandlers","dataKey","_createProjectionHandlers","projection","_initEvents","_focus","Focus","name","arg","_fire","_attachHandlers","prototype","constructor","dispose","_detachHandlers","_disposeEvents","_docHandlers","_rootHandlers","_eventNames","_startClick","event","data","coords","getEventCoords","_clickState","x","y","threshold","isTouchEvent","time","_endClick","state","$event","_startDrag","_dragState","_moveDrag","active","_endDrag","_wheelZoom","lock","_wheelLock","delta","dirTime","dir","adjustWheelDelta","_startZoom","_zoomState","pointer2","pointer1","getPointerId","getMultitouchEventCoords","x1","x1_0","y1","y1_0","x2","x2_0","y2","y2_0","ready","_moveZoom","_endZoom","startDistance","currentDistance","getDistance","ratio","_startHover","_doHover","_moveHover","isTouch","_cancelHover","_hoverTarget","target","_hoverState","_startFocus","_doFocus","_moveFocus","_cancelFocus","turnOff","turnOn","cancel","DATA_KEY","start","getData","_isTouchEnabled","preventDefault","stopPropagation","move","end","wheel","_isWheelEnabled","tagName","parentNode","on","center","handler","zoom","reset","setOptions","options","parseScalar","touchEnabled","wheelEnabled","css","off","getDocument","fire","_activeData","_data","_disabled","_offTimer","_x","_y","clearTimeout","onCheck","done","result","setTimeout","makeEventEmitter","exports","type","originalEvent","pointerType","test","selectItem","flags","items","i","ii","length","item","pointerEnabled","msPointerEnabled","hasProperty","touch","touches","pageX","pageY","pointerId","_delta","sign"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (viz/vector_map/tracker.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nvar _events_engine = require(\"../../events/core/events_engine\");\r\nvar _events_engine2 = _interopRequireDefault(_events_engine);\r\nvar _window = require(\"../../core/utils/window\");\r\nvar _window2 = _interopRequireDefault(_window);\r\nvar _dom_adapter = require(\"../../core/dom_adapter\");\r\nvar _dom_adapter2 = _interopRequireDefault(_dom_adapter);\r\nvar _event_emitter = require(\"./event_emitter\");\r\nvar _event_emitter2 = _interopRequireDefault(_event_emitter);\r\nvar _utils = require(\"../../events/utils\");\r\nvar _utils2 = _interopRequireDefault(_utils);\r\nvar _wheel = require(\"../../events/core/wheel\");\r\nvar _utils3 = require(\"../core/utils\");\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\nvar navigator = _window2.default.getNavigator();\r\nvar _math = Math;\r\nvar _abs = _math.abs;\r\nvar _sqrt = _math.sqrt;\r\nvar _round = _math.round;\r\nvar _addNamespace = _utils2.default.addNamespace;\r\nvar _now = Date.now;\r\nvar _NAME = \"dxVectorMap\";\r\nvar EVENT_START = \"start\";\r\nvar EVENT_MOVE = \"move\";\r\nvar EVENT_END = \"end\";\r\nvar EVENT_ZOOM = \"zoom\";\r\nvar EVENT_HOVER_ON = \"hover-on\";\r\nvar EVENT_HOVER_OFF = \"hover-off\";\r\nvar EVENT_CLICK = \"click\";\r\nvar EVENT_FOCUS_ON = \"focus-on\";\r\nvar EVENT_FOCUS_MOVE = \"focus-move\";\r\nvar EVENT_FOCUS_OFF = \"focus-off\";\r\nvar CLICK_TIME_THRESHOLD = 500;\r\nvar CLICK_COORD_THRESHOLD_MOUSE = 5;\r\nvar CLICK_COORD_THRESHOLD_TOUCH = 20;\r\nvar DRAG_COORD_THRESHOLD_MOUSE = 5;\r\nvar DRAG_COORD_THRESHOLD_TOUCH = 10;\r\nvar FOCUS_OFF_DELAY = 100;\r\nvar WHEEL_COOLDOWN = 50;\r\nvar WHEEL_DIRECTION_COOLDOWN = 300;\r\nvar EVENTS;\r\nsetupEvents();\r\n\r\nfunction Tracker(parameters) {\r\n    var that = this;\r\n    that._root = parameters.root;\r\n    that._createEventHandlers(parameters.dataKey);\r\n    that._createProjectionHandlers(parameters.projection);\r\n    that._initEvents();\r\n    that._focus = new Focus(function(name, arg) {\r\n        that._fire(name, arg)\r\n    });\r\n    that._attachHandlers()\r\n}\r\nTracker.prototype = {\r\n    constructor: Tracker,\r\n    dispose: function() {\r\n        var that = this;\r\n        that._detachHandlers();\r\n        that._disposeEvents();\r\n        that._focus.dispose();\r\n        that._root = that._focus = that._docHandlers = that._rootHandlers = null\r\n    },\r\n    _eventNames: [EVENT_START, EVENT_MOVE, EVENT_END, EVENT_ZOOM, EVENT_CLICK, EVENT_HOVER_ON, EVENT_HOVER_OFF, EVENT_FOCUS_ON, EVENT_FOCUS_OFF, EVENT_FOCUS_MOVE],\r\n    _startClick: function(event, data) {\r\n        if (!data) {\r\n            return\r\n        }\r\n        var coords = getEventCoords(event);\r\n        this._clickState = {\r\n            x: coords.x,\r\n            y: coords.y,\r\n            threshold: isTouchEvent(event) ? CLICK_COORD_THRESHOLD_TOUCH : CLICK_COORD_THRESHOLD_MOUSE,\r\n            time: _now()\r\n        }\r\n    },\r\n    _endClick: function(event, data) {\r\n        var state = this._clickState;\r\n        var threshold;\r\n        var coords;\r\n        if (!state) {\r\n            return\r\n        }\r\n        if (data && _now() - state.time <= CLICK_TIME_THRESHOLD) {\r\n            threshold = state.threshold;\r\n            coords = getEventCoords(event);\r\n            if (_abs(coords.x - state.x) <= threshold && _abs(coords.y - state.y) <= threshold) {\r\n                this._fire(EVENT_CLICK, {\r\n                    data: data,\r\n                    x: coords.x,\r\n                    y: coords.y,\r\n                    $event: event\r\n                })\r\n            }\r\n        }\r\n        this._clickState = null\r\n    },\r\n    _startDrag: function(event, data) {\r\n        if (!data) {\r\n            return\r\n        }\r\n        var coords = getEventCoords(event);\r\n        var state = this._dragState = {\r\n            x: coords.x,\r\n            y: coords.y,\r\n            data: data\r\n        };\r\n        this._fire(EVENT_START, {\r\n            x: state.x,\r\n            y: state.y,\r\n            data: state.data\r\n        })\r\n    },\r\n    _moveDrag: function(event, data) {\r\n        var state = this._dragState;\r\n        var coords;\r\n        var threshold;\r\n        if (!state) {\r\n            return\r\n        }\r\n        coords = getEventCoords(event);\r\n        threshold = isTouchEvent(event) ? DRAG_COORD_THRESHOLD_TOUCH : DRAG_COORD_THRESHOLD_MOUSE;\r\n        if (state.active || _abs(coords.x - state.x) > threshold || _abs(coords.y - state.y) > threshold) {\r\n            state.x = coords.x;\r\n            state.y = coords.y;\r\n            state.active = true;\r\n            state.data = data || {};\r\n            this._fire(EVENT_MOVE, {\r\n                x: state.x,\r\n                y: state.y,\r\n                data: state.data\r\n            })\r\n        }\r\n    },\r\n    _endDrag: function() {\r\n        var state = this._dragState;\r\n        if (!state) {\r\n            return\r\n        }\r\n        this._dragState = null;\r\n        this._fire(EVENT_END, {\r\n            x: state.x,\r\n            y: state.y,\r\n            data: state.data\r\n        })\r\n    },\r\n    _wheelZoom: function(event, data) {\r\n        if (!data) {\r\n            return\r\n        }\r\n        var that = this;\r\n        var lock = that._wheelLock;\r\n        var time = _now();\r\n        var delta;\r\n        var coords;\r\n        if (time - lock.time <= WHEEL_COOLDOWN) {\r\n            return\r\n        }\r\n        if (time - lock.dirTime > WHEEL_DIRECTION_COOLDOWN) {\r\n            lock.dir = 0\r\n        }\r\n        delta = adjustWheelDelta(event.delta / 120 || 0, lock);\r\n        if (0 === delta) {\r\n            return\r\n        }\r\n        coords = getEventCoords(event);\r\n        that._fire(EVENT_ZOOM, {\r\n            delta: delta,\r\n            x: coords.x,\r\n            y: coords.y\r\n        });\r\n        lock.time = lock.dirTime = time\r\n    },\r\n    _startZoom: function(event, data) {\r\n        if (!isTouchEvent(event) || !data) {\r\n            return\r\n        }\r\n        var state = this._zoomState = this._zoomState || {};\r\n        var coords;\r\n        var pointer2;\r\n        if (state.pointer1 && state.pointer2) {\r\n            return\r\n        }\r\n        if (void 0 === state.pointer1) {\r\n            state.pointer1 = getPointerId(event) || 0;\r\n            coords = getMultitouchEventCoords(event, state.pointer1);\r\n            state.x1 = state.x1_0 = coords.x;\r\n            state.y1 = state.y1_0 = coords.y\r\n        }\r\n        if (void 0 === state.pointer2) {\r\n            pointer2 = getPointerId(event) || 1;\r\n            if (pointer2 !== state.pointer1) {\r\n                coords = getMultitouchEventCoords(event, pointer2);\r\n                if (coords) {\r\n                    state.x2 = state.x2_0 = coords.x;\r\n                    state.y2 = state.y2_0 = coords.y;\r\n                    state.pointer2 = pointer2;\r\n                    state.ready = true;\r\n                    this._endDrag()\r\n                }\r\n            }\r\n        }\r\n    },\r\n    _moveZoom: function(event) {\r\n        var state = this._zoomState;\r\n        var coords;\r\n        if (!state || !isTouchEvent(event)) {\r\n            return\r\n        }\r\n        if (void 0 !== state.pointer1) {\r\n            coords = getMultitouchEventCoords(event, state.pointer1);\r\n            if (coords) {\r\n                state.x1 = coords.x;\r\n                state.y1 = coords.y\r\n            }\r\n        }\r\n        if (void 0 !== state.pointer2) {\r\n            coords = getMultitouchEventCoords(event, state.pointer2);\r\n            if (coords) {\r\n                state.x2 = coords.x;\r\n                state.y2 = coords.y\r\n            }\r\n        }\r\n    },\r\n    _endZoom: function(event) {\r\n        var state = this._zoomState;\r\n        var startDistance;\r\n        var currentDistance;\r\n        if (!state || !isTouchEvent(event)) {\r\n            return\r\n        }\r\n        if (state.ready) {\r\n            startDistance = getDistance(state.x1_0, state.y1_0, state.x2_0, state.y2_0);\r\n            currentDistance = getDistance(state.x1, state.y1, state.x2, state.y2);\r\n            this._fire(EVENT_ZOOM, {\r\n                ratio: currentDistance / startDistance,\r\n                x: (state.x1_0 + state.x2_0) / 2,\r\n                y: (state.y1_0 + state.y2_0) / 2\r\n            })\r\n        }\r\n        this._zoomState = null\r\n    },\r\n    _startHover: function(event, data) {\r\n        this._doHover(event, data, true)\r\n    },\r\n    _moveHover: function(event, data) {\r\n        this._doHover(event, data, false)\r\n    },\r\n    _doHover: function(event, data, isTouch) {\r\n        var that = this;\r\n        if (that._dragState && that._dragState.active || that._zoomState && that._zoomState.ready) {\r\n            that._cancelHover();\r\n            return\r\n        }\r\n        if (isTouchEvent(event) !== isTouch || that._hoverTarget === event.target || that._hoverState && that._hoverState.data === data) {\r\n            return\r\n        }\r\n        that._cancelHover();\r\n        if (data) {\r\n            that._hoverState = {\r\n                data: data\r\n            };\r\n            that._fire(EVENT_HOVER_ON, {\r\n                data: data\r\n            })\r\n        }\r\n        that._hoverTarget = event.target\r\n    },\r\n    _cancelHover: function() {\r\n        var state = this._hoverState;\r\n        this._hoverState = this._hoverTarget = null;\r\n        if (state) {\r\n            this._fire(EVENT_HOVER_OFF, {\r\n                data: state.data\r\n            })\r\n        }\r\n    },\r\n    _startFocus: function(event, data) {\r\n        this._doFocus(event, data, true)\r\n    },\r\n    _moveFocus: function(event, data) {\r\n        this._doFocus(event, data, false)\r\n    },\r\n    _doFocus: function(event, data, isTouch) {\r\n        var that = this;\r\n        if (that._dragState && that._dragState.active || that._zoomState && that._zoomState.ready) {\r\n            that._cancelFocus();\r\n            return\r\n        }\r\n        if (isTouchEvent(event) !== isTouch) {\r\n            return\r\n        }\r\n        that._focus.turnOff();\r\n        data && that._focus.turnOn(data, getEventCoords(event))\r\n    },\r\n    _cancelFocus: function() {\r\n        this._focus.cancel()\r\n    },\r\n    _createEventHandlers: function(DATA_KEY) {\r\n        var that = this;\r\n        that._docHandlers = {};\r\n        that._rootHandlers = {};\r\n        that._rootHandlers[EVENTS.start] = that._docHandlers[EVENTS.start] = function(event) {\r\n            var isTouch = isTouchEvent(event);\r\n            var data = getData(event);\r\n            if (isTouch && !that._isTouchEnabled) {\r\n                return\r\n            }\r\n            if (data) {\r\n                event.preventDefault();\r\n                event.stopPropagation()\r\n            }\r\n            that._startClick(event, data);\r\n            that._startDrag(event, data);\r\n            that._startZoom(event, data);\r\n            that._startHover(event, data);\r\n            that._startFocus(event, data)\r\n        };\r\n        that._docHandlers[EVENTS.move] = function(event) {\r\n            var isTouch = isTouchEvent(event);\r\n            var data = getData(event);\r\n            if (isTouch && !that._isTouchEnabled) {\r\n                return\r\n            }\r\n            that._moveDrag(event, data);\r\n            that._moveZoom(event, data);\r\n            that._moveHover(event, data);\r\n            that._moveFocus(event, data)\r\n        };\r\n        that._docHandlers[EVENTS.end] = function(event) {\r\n            var isTouch = isTouchEvent(event);\r\n            var data = getData(event);\r\n            if (isTouch && !that._isTouchEnabled) {\r\n                return\r\n            }\r\n            that._endClick(event, data);\r\n            that._endDrag(event, data);\r\n            that._endZoom(event, data)\r\n        };\r\n        that._rootHandlers[EVENTS.wheel] = function(event) {\r\n            that._cancelFocus();\r\n            if (!that._isWheelEnabled) {\r\n                return\r\n            }\r\n            var data = getData(event);\r\n            if (data) {\r\n                event.preventDefault();\r\n                event.stopPropagation();\r\n                that._wheelZoom(event, data)\r\n            }\r\n        };\r\n        that._wheelLock = {\r\n            dir: 0\r\n        };\r\n\r\n        function getData(event) {\r\n            var target = event.target;\r\n            return (\"tspan\" === target.tagName ? target.parentNode : target)[DATA_KEY]\r\n        }\r\n    },\r\n    _createProjectionHandlers: function(projection) {\r\n        var that = this;\r\n        projection.on({\r\n            center: handler,\r\n            zoom: handler\r\n        });\r\n\r\n        function handler() {\r\n            that._cancelFocus()\r\n        }\r\n    },\r\n    reset: function() {\r\n        var that = this;\r\n        that._clickState = null;\r\n        that._endDrag();\r\n        that._cancelHover();\r\n        that._cancelFocus()\r\n    },\r\n    setOptions: function(options) {\r\n        var that = this;\r\n        that.reset();\r\n        that._detachHandlers();\r\n        that._isTouchEnabled = !!(0, _utils3.parseScalar)(options.touchEnabled, true);\r\n        that._isWheelEnabled = !!(0, _utils3.parseScalar)(options.wheelEnabled, true);\r\n        that._attachHandlers()\r\n    },\r\n    _detachHandlers: function() {\r\n        var that = this;\r\n        if (that._isTouchEnabled) {\r\n            that._root.css({\r\n                \"touch-action\": \"\",\r\n                \"-webkit-user-select\": \"\"\r\n            }).off(_addNamespace(\"MSHoldVisual\", _NAME)).off(_addNamespace(\"contextmenu\", _NAME))\r\n        }\r\n        _events_engine2.default.off(_dom_adapter2.default.getDocument(), that._docHandlers);\r\n        that._root.off(that._rootHandlers)\r\n    },\r\n    _attachHandlers: function() {\r\n        var that = this;\r\n        if (that._isTouchEnabled) {\r\n            that._root.css({\r\n                \"touch-action\": \"none\",\r\n                \"-webkit-user-select\": \"none\"\r\n            }).on(_addNamespace(\"MSHoldVisual\", _NAME), function(event) {\r\n                event.preventDefault()\r\n            }).on(_addNamespace(\"contextmenu\", _NAME), function(event) {\r\n                isTouchEvent(event) && event.preventDefault()\r\n            })\r\n        }\r\n        _events_engine2.default.on(_dom_adapter2.default.getDocument(), that._docHandlers);\r\n        that._root.on(that._rootHandlers)\r\n    }\r\n};\r\nvar Focus = function(fire) {\r\n    var that = this;\r\n    var _activeData = null;\r\n    var _data = null;\r\n    var _disabled = false;\r\n    var _offTimer = null;\r\n    var _x;\r\n    var _y;\r\n    that.dispose = function() {\r\n        clearTimeout(_offTimer);\r\n        that.turnOn = that.turnOff = that.cancel = that.dispose = that = fire = _activeData = _data = _offTimer = null\r\n    };\r\n    that.turnOn = function(data, coords) {\r\n        if (data === _data && _disabled) {\r\n            return\r\n        }\r\n        _disabled = false;\r\n        _data = data;\r\n        if (_activeData) {\r\n            _x = coords.x;\r\n            _y = coords.y;\r\n            if (_data === _activeData) {\r\n                fire(EVENT_FOCUS_MOVE, {\r\n                    data: _data,\r\n                    x: _x,\r\n                    y: _y\r\n                });\r\n                onCheck(true)\r\n            } else {\r\n                fire(EVENT_FOCUS_ON, {\r\n                    data: _data,\r\n                    x: _x,\r\n                    y: _y,\r\n                    done: onCheck\r\n                })\r\n            }\r\n        } else {\r\n            _x = coords.x;\r\n            _y = coords.y;\r\n            fire(EVENT_FOCUS_ON, {\r\n                data: _data,\r\n                x: _x,\r\n                y: _y,\r\n                done: onCheck\r\n            })\r\n        }\r\n\r\n        function onCheck(result) {\r\n            _disabled = !result;\r\n            if (result) {\r\n                _activeData = _data;\r\n                clearTimeout(_offTimer);\r\n                _offTimer = null\r\n            }\r\n        }\r\n    };\r\n    that.turnOff = function() {\r\n        _data = null;\r\n        if (_activeData && !_disabled) {\r\n            _offTimer = _offTimer || setTimeout(function() {\r\n                _offTimer = null;\r\n                fire(EVENT_FOCUS_OFF, {\r\n                    data: _activeData\r\n                });\r\n                _activeData = null\r\n            }, FOCUS_OFF_DELAY)\r\n        }\r\n    };\r\n    that.cancel = function() {\r\n        clearTimeout(_offTimer);\r\n        if (_activeData) {\r\n            fire(EVENT_FOCUS_OFF, {\r\n                data: _activeData\r\n            })\r\n        }\r\n        _activeData = _data = _offTimer = null\r\n    }\r\n};\r\n_event_emitter2.default.makeEventEmitter(Tracker);\r\nexports.Tracker = Tracker;\r\n\r\nfunction getDistance(x1, y1, x2, y2) {\r\n    return _sqrt((x1 - x2) * (x1 - x2) + (y1 - y2) * (y1 - y2))\r\n}\r\n\r\nfunction isTouchEvent(event) {\r\n    var type = event.originalEvent.type;\r\n    var pointerType = event.originalEvent.pointerType;\r\n    return /^touch/.test(type) || /^MSPointer/.test(type) && 4 !== pointerType || /^pointer/.test(type) && \"mouse\" !== pointerType\r\n}\r\n\r\nfunction selectItem(flags, items) {\r\n    var i = 0;\r\n    var ii = flags.length;\r\n    var item;\r\n    for (; i < ii; ++i) {\r\n        if (flags[i]) {\r\n            item = items[i];\r\n            break\r\n        }\r\n    }\r\n    return _addNamespace(item || items[i], _NAME)\r\n}\r\n\r\nfunction setupEvents() {\r\n    var flags = [navigator.pointerEnabled, navigator.msPointerEnabled, _window2.default.hasProperty(\"ontouchstart\")];\r\n    EVENTS = {\r\n        start: selectItem(flags, [\"pointerdown\", \"MSPointerDown\", \"touchstart mousedown\", \"mousedown\"]),\r\n        move: selectItem(flags, [\"pointermove\", \"MSPointerMove\", \"touchmove mousemove\", \"mousemove\"]),\r\n        end: selectItem(flags, [\"pointerup\", \"MSPointerUp\", \"touchend mouseup\", \"mouseup\"]),\r\n        wheel: _addNamespace(_wheel.name, _NAME)\r\n    }\r\n}\r\n\r\nfunction getEventCoords(event) {\r\n    var originalEvent = event.originalEvent;\r\n    var touch = originalEvent.touches && originalEvent.touches[0] || {};\r\n    return {\r\n        x: touch.pageX || originalEvent.pageX || event.pageX,\r\n        y: touch.pageY || originalEvent.pageY || event.pageY\r\n    }\r\n}\r\n\r\nfunction getPointerId(event) {\r\n    return event.originalEvent.pointerId\r\n}\r\n\r\nfunction getMultitouchEventCoords(event, pointerId) {\r\n    var originalEvent = event.originalEvent;\r\n    if (void 0 !== originalEvent.pointerId) {\r\n        originalEvent = originalEvent.pointerId === pointerId ? originalEvent : null\r\n    } else {\r\n        originalEvent = originalEvent.touches[pointerId]\r\n    }\r\n    return originalEvent ? {\r\n        x: originalEvent.pageX || event.pageX,\r\n        y: originalEvent.pageY || event.pageY\r\n    } : null\r\n}\r\n\r\nfunction adjustWheelDelta(delta, lock) {\r\n    if (0 === delta) {\r\n        return 0\r\n    }\r\n    var _delta = _abs(delta);\r\n    var sign = _round(delta / _delta);\r\n    if (lock.dir && sign !== lock.dir) {\r\n        return 0\r\n    }\r\n    lock.dir = sign;\r\n    if (_delta < .1) {\r\n        _delta = 0\r\n    } else {\r\n        if (_delta < 1) {\r\n            _delta = 1\r\n        } else {\r\n            if (_delta > 4) {\r\n                _delta = 4\r\n            } else {\r\n                _delta = _round(_delta)\r\n            }\r\n        }\r\n    }\r\n    return sign * _delta\r\n}\r\n"]},"metadata":{},"sourceType":"script"}