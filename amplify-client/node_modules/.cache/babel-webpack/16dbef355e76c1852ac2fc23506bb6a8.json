{"ast":null,"code":"/**\r\n * DevExtreme (ui/pivot_grid/ui.pivot_grid.fields_area.js)\r\n * Version: 19.2.6\r\n * Build date: Thu Jan 30 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nvar _renderer = require(\"../../core/renderer\");\n\nvar _renderer2 = _interopRequireDefault(_renderer);\n\nvar _common = require(\"../../core/utils/common\");\n\nvar _iterator = require(\"../../core/utils/iterator\");\n\nvar _uiPivot_grid = require(\"./ui.pivot_grid.area_item\");\n\nvar _uiPivot_grid2 = require(\"./ui.pivot_grid.utils\");\n\nvar _popup = require(\"../popup\");\n\nvar _popup2 = _interopRequireDefault(_popup);\n\nvar _button = require(\"../button\");\n\nvar _button2 = _interopRequireDefault(_button);\n\nrequire(\"./ui.pivot_grid.field_chooser_base\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nvar DIV = \"<div>\";\nvar AREA_DRAG_CLASS = \"dx-pivotgrid-drag-action\";\n\nfunction renderGroupConnector(field, nextField, prevField, $container) {\n  if (prevField && prevField.groupName && prevField.groupName === field.groupName) {\n    (0, _renderer2.default)(DIV).addClass(\"dx-group-connector\").addClass(\"dx-group-connector-prev\").appendTo($container);\n  }\n\n  if (nextField && nextField.groupName && nextField.groupName === field.groupName) {\n    (0, _renderer2.default)(DIV).addClass(\"dx-group-connector\").addClass(\"dx-group-connector-next\").appendTo($container);\n  }\n}\n\nexports.FieldsArea = _uiPivot_grid.AreaItem.inherit({\n  ctor: function ctor(component, area) {\n    this.callBase(component);\n    this._area = area;\n  },\n  _getAreaName: function _getAreaName() {\n    return \"fields\";\n  },\n  _createGroupElement: function _createGroupElement() {\n    return (0, _renderer2.default)(DIV).addClass(\"dx-pivotgrid-fields-area\").addClass(\"dx-area-fields\").addClass(AREA_DRAG_CLASS).attr(\"group\", this._area);\n  },\n  isVisible: function isVisible() {\n    return !!this.option(\"fieldPanel.visible\") && this.option(\"fieldPanel.show\" + (0, _uiPivot_grid2.capitalizeFirstLetter)(this._area) + \"Fields\");\n  },\n  _renderButton: function _renderButton(element) {\n    var that = this;\n    var container = (0, _renderer2.default)(\"<td>\").appendTo((0, _renderer2.default)(\"<tr>\").appendTo(element));\n\n    var button = that.component._createComponent((0, _renderer2.default)(DIV).appendTo(container), _button2.default, {\n      text: \"Fields\",\n      icon: \"menu\",\n      width: \"auto\",\n      onClick: function onClick() {\n        var popup = that.tableElement().find(\".dx-fields-area-popup\").dxPopup(\"instance\");\n\n        if (!popup.option(\"visible\")) {\n          popup.show();\n        }\n      }\n    });\n\n    button.$element().addClass(\"dx-pivotgrid-fields-area-hamburger\");\n  },\n  _getPopupOptions: function _getPopupOptions(row, button) {\n    return {\n      contentTemplate: function contentTemplate() {\n        return (0, _renderer2.default)(\"<table>\").addClass(\"dx-area-field-container\").append((0, _renderer2.default)(\"<thead>\").addClass(\"dx-pivotgrid-fields-area-head\").append(row));\n      },\n      height: \"auto\",\n      width: \"auto\",\n      position: {\n        at: \"left\",\n        my: \"left\",\n        of: button\n      },\n      dragEnabled: false,\n      animation: {\n        show: {\n          type: \"pop\",\n          duration: 200\n        }\n      },\n      shading: false,\n      showTitle: false,\n      closeOnOutsideClick: true,\n      container: button.parent()\n    };\n  },\n  _renderPopup: function _renderPopup(tableElement, row) {\n    var that = this;\n    var button = tableElement.find(\".dx-button\");\n\n    var popupOptions = that._getPopupOptions(row, button);\n\n    var FieldChooserBase = that.component.$element().dxPivotGridFieldChooserBase(\"instance\");\n\n    if (that._rowPopup) {\n      that._rowPopup.$element().remove();\n    }\n\n    that._rowPopup = that.component._createComponent((0, _renderer2.default)(DIV).appendTo(tableElement), _popup2.default, popupOptions);\n\n    that._rowPopup.$element().addClass(\"dx-fields-area-popup\");\n\n    that._rowPopup.content().addClass(\"dx-pivotgrid-fields-container\");\n\n    that._rowPopup.content().parent().attr(\"group\", \"row\");\n\n    FieldChooserBase.subscribeToEvents(that._rowPopup.content());\n    FieldChooserBase.renderSortable(that._rowPopup.content());\n  },\n  _shouldCreateButton: function _shouldCreateButton() {\n    return false;\n  },\n  _renderTableContent: function _renderTableContent(tableElement, data) {\n    var that = this;\n    var groupElement = this.groupElement();\n    var isVisible = this.isVisible();\n    var fieldChooserBase = that.component.$element().dxPivotGridFieldChooserBase(\"instance\");\n    var head = (0, _renderer2.default)(\"<thead>\").addClass(\"dx-pivotgrid-fields-area-head\").appendTo(tableElement);\n    var area = that._area;\n    var row = (0, _renderer2.default)(\"<tr>\");\n    groupElement.toggleClass(\"dx-hidden\", !isVisible);\n    tableElement.addClass(\"dx-area-field-container\");\n\n    if (!isVisible) {\n      return;\n    }\n\n    (0, _iterator.each)(data, function (index, field) {\n      if (field.area === area && false !== field.visible) {\n        var td = (0, _renderer2.default)(\"<td>\").append(fieldChooserBase.renderField(field, \"row\" === field.area));\n        var indicators = td.find(\".dx-column-indicators\");\n\n        if (indicators.length && that._shouldCreateButton()) {\n          indicators.insertAfter(indicators.next());\n        }\n\n        td.appendTo(row);\n        renderGroupConnector(field, data[index + 1], data[index - 1], td);\n      }\n    });\n\n    if (!row.children().length) {\n      (0, _renderer2.default)(\"<td>\").append((0, _renderer2.default)(DIV).addClass(\"dx-empty-area-text\").text(this.option(\"fieldPanel.texts.\" + area + \"FieldArea\"))).appendTo(row);\n    }\n\n    if (that._shouldCreateButton()) {\n      that._renderButton(head);\n\n      that._renderPopup(tableElement, row);\n    } else {\n      head.append(row);\n    }\n  },\n  reset: function reset() {\n    this.callBase();\n    this.groupElement().css(\"marginTop\", 0);\n  },\n  _renderVirtualContent: _common.noop\n});","map":null,"metadata":{},"sourceType":"script"}